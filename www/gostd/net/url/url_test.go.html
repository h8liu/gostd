<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/url</h2>
<ul>
<li><a href="/gostd/net/url/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/url/url.go.html">url.go</a></li>
<li><a href="/gostd/net/url/url_test.go.html" class="current">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8534641">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8534696">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8534750">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8534801">package</span>&nbsp;<span class="ident" id="8534809">url</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8534814">import</span>&nbsp;<span class="op" id="8534821">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8534824">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8534831">&#34;reflect&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8534842">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8534853">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8534863">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8534866">type</span>&nbsp;<span class="ident" id="8534871">URLTest</span>&nbsp;<span class="keyword" id="8534879">struct</span>&nbsp;<span class="op" id="8534886">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8534889">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8534899">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8534907">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8534917">*</span><span class="ident" id="8534918">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8534923">roundtrip</span>&nbsp;<span class="builtintype" id="8534933">string</span>&nbsp;<span class="comment" id="8534940">//&nbsp;expected&nbsp;result&nbsp;of&nbsp;reserializing&nbsp;the&nbsp;URL;&nbsp;empty&nbsp;means&nbsp;same&nbsp;as&nbsp;&#34;in&#34;.</span><br>
<span class="lineno"></span><span class="op" id="8535011">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="8535014">var</span>&nbsp;<span class="ident" id="8535018">urltests</span>&nbsp;<span class="op" id="8535027">=</span>&nbsp;<span class="op" id="8535029">[</span><span class="op" id="8535030">]</span><span class="ident" id="8535031">URLTest</span><span class="op" id="8535038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8535041">//&nbsp;no&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8535057">&#34;http://www.google.com&#34;</span><span class="op" id="8535080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535084">&amp;</span><span class="ident" id="8535085">URL</span><span class="op" id="8535088">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535093">Scheme</span><span class="op" id="8535099">:</span>&nbsp;<span class="string" id="8535101">&#34;http&#34;</span><span class="op" id="8535107">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535112">Host</span><span class="op" id="8535116">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8535120">&#34;www.google.com&#34;</span><span class="op" id="8535136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535140">}</span><span class="op" id="8535141">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8535145">&#34;&#34;</span><span class="op" id="8535147">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535150">}</span><span class="op" id="8535151">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8535154">//&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8535167">&#34;http://www.google.com/&#34;</span><span class="op" id="8535191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535195">&amp;</span><span class="ident" id="8535196">URL</span><span class="op" id="8535199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535204">Scheme</span><span class="op" id="8535210">:</span>&nbsp;<span class="string" id="8535212">&#34;http&#34;</span><span class="op" id="8535218">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535223">Host</span><span class="op" id="8535227">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8535231">&#34;www.google.com&#34;</span><span class="op" id="8535247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535252">Path</span><span class="op" id="8535256">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8535260">&#34;/&#34;</span><span class="op" id="8535263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535267">}</span><span class="op" id="8535268">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8535272">&#34;&#34;</span><span class="op" id="8535274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535277">}</span><span class="op" id="8535278">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8535281">//&nbsp;path&nbsp;with&nbsp;hex&nbsp;escaping</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8535312">&#34;http://www.google.com/file%20one%26two&#34;</span><span class="op" id="8535352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535356">&amp;</span><span class="ident" id="8535357">URL</span><span class="op" id="8535360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535365">Scheme</span><span class="op" id="8535371">:</span>&nbsp;<span class="string" id="8535373">&#34;http&#34;</span><span class="op" id="8535379">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535384">Host</span><span class="op" id="8535388">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8535392">&#34;www.google.com&#34;</span><span class="op" id="8535408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535413">Path</span><span class="op" id="8535417">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8535421">&#34;/file&nbsp;one&amp;two&#34;</span><span class="op" id="8535436">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535440">}</span><span class="op" id="8535441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8535445">&#34;http://www.google.com/file%20one&amp;two&#34;</span><span class="op" id="8535483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535486">}</span><span class="op" id="8535487">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8535490">//&nbsp;user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8535503">&#34;ftp://webmaster@www.google.com/&#34;</span><span class="op" id="8535536">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535540">&amp;</span><span class="ident" id="8535541">URL</span><span class="op" id="8535544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535549">Scheme</span><span class="op" id="8535555">:</span>&nbsp;<span class="string" id="8535557">&#34;ftp&#34;</span><span class="op" id="8535562">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535567">User</span><span class="op" id="8535571">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8535575">User</span><span class="op" id="8535579">(</span><span class="string" id="8535580">&#34;webmaster&#34;</span><span class="op" id="8535591">)</span><span class="op" id="8535592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535597">Host</span><span class="op" id="8535601">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8535605">&#34;www.google.com&#34;</span><span class="op" id="8535621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535626">Path</span><span class="op" id="8535630">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8535634">&#34;/&#34;</span><span class="op" id="8535637">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535641">}</span><span class="op" id="8535642">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8535646">&#34;&#34;</span><span class="op" id="8535648">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535651">}</span><span class="op" id="8535652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8535655">//&nbsp;escape&nbsp;sequence&nbsp;in&nbsp;username</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8535691">&#34;ftp://john%20doe@www.google.com/&#34;</span><span class="op" id="8535725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535729">&amp;</span><span class="ident" id="8535730">URL</span><span class="op" id="8535733">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535738">Scheme</span><span class="op" id="8535744">:</span>&nbsp;<span class="string" id="8535746">&#34;ftp&#34;</span><span class="op" id="8535751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535756">User</span><span class="op" id="8535760">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8535764">User</span><span class="op" id="8535768">(</span><span class="string" id="8535769">&#34;john&nbsp;doe&#34;</span><span class="op" id="8535779">)</span><span class="op" id="8535780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535785">Host</span><span class="op" id="8535789">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8535793">&#34;www.google.com&#34;</span><span class="op" id="8535809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535814">Path</span><span class="op" id="8535818">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8535822">&#34;/&#34;</span><span class="op" id="8535825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535829">}</span><span class="op" id="8535830">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8535834">&#34;ftp://john%20doe@www.google.com/&#34;</span><span class="op" id="8535868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535871">}</span><span class="op" id="8535872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8535875">//&nbsp;query</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8535889">&#34;http://www.google.com/?q=go+language&#34;</span><span class="op" id="8535927">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8535931">&amp;</span><span class="ident" id="8535932">URL</span><span class="op" id="8535935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535940">Scheme</span><span class="op" id="8535946">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8535950">&#34;http&#34;</span><span class="op" id="8535956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535961">Host</span><span class="op" id="8535965">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8535971">&#34;www.google.com&#34;</span><span class="op" id="8535987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8535992">Path</span><span class="op" id="8535996">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536002">&#34;/&#34;</span><span class="op" id="8536005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536010">RawQuery</span><span class="op" id="8536018">:</span>&nbsp;<span class="string" id="8536020">&#34;q=go+language&#34;</span><span class="op" id="8536035">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536039">}</span><span class="op" id="8536040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536044">&#34;&#34;</span><span class="op" id="8536046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536049">}</span><span class="op" id="8536050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8536053">//&nbsp;query&nbsp;with&nbsp;hex&nbsp;escaping:&nbsp;NOT&nbsp;parsed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536093">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536097">&#34;http://www.google.com/?q=go%20language&#34;</span><span class="op" id="8536137">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536141">&amp;</span><span class="ident" id="8536142">URL</span><span class="op" id="8536145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536150">Scheme</span><span class="op" id="8536156">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8536160">&#34;http&#34;</span><span class="op" id="8536166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536171">Host</span><span class="op" id="8536175">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536181">&#34;www.google.com&#34;</span><span class="op" id="8536197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536202">Path</span><span class="op" id="8536206">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536212">&#34;/&#34;</span><span class="op" id="8536215">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536220">RawQuery</span><span class="op" id="8536228">:</span>&nbsp;<span class="string" id="8536230">&#34;q=go%20language&#34;</span><span class="op" id="8536247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536251">}</span><span class="op" id="8536252">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536256">&#34;&#34;</span><span class="op" id="8536258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536261">}</span><span class="op" id="8536262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8536265">//&nbsp;%20&nbsp;outside&nbsp;query</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536291">&#34;http://www.google.com/a%20b?q=c+d&#34;</span><span class="op" id="8536326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536330">&amp;</span><span class="ident" id="8536331">URL</span><span class="op" id="8536334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536339">Scheme</span><span class="op" id="8536345">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8536349">&#34;http&#34;</span><span class="op" id="8536355">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536360">Host</span><span class="op" id="8536364">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536370">&#34;www.google.com&#34;</span><span class="op" id="8536386">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536391">Path</span><span class="op" id="8536395">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536401">&#34;/a&nbsp;b&#34;</span><span class="op" id="8536407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536412">RawQuery</span><span class="op" id="8536420">:</span>&nbsp;<span class="string" id="8536422">&#34;q=c+d&#34;</span><span class="op" id="8536429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536433">}</span><span class="op" id="8536434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536438">&#34;&#34;</span><span class="op" id="8536440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536443">}</span><span class="op" id="8536444">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8536447">//&nbsp;path&nbsp;without&nbsp;leading&nbsp;/,&nbsp;so&nbsp;no&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536493">&#34;http:www.google.com/?q=go+language&#34;</span><span class="op" id="8536529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536533">&amp;</span><span class="ident" id="8536534">URL</span><span class="op" id="8536537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536542">Scheme</span><span class="op" id="8536548">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8536552">&#34;http&#34;</span><span class="op" id="8536558">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536563">Opaque</span><span class="op" id="8536569">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8536573">&#34;www.google.com/&#34;</span><span class="op" id="8536590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536595">RawQuery</span><span class="op" id="8536603">:</span>&nbsp;<span class="string" id="8536605">&#34;q=go+language&#34;</span><span class="op" id="8536620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536624">}</span><span class="op" id="8536625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536629">&#34;http:www.google.com/?q=go+language&#34;</span><span class="op" id="8536665">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536668">}</span><span class="op" id="8536669">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8536672">//&nbsp;path&nbsp;without&nbsp;leading&nbsp;/,&nbsp;so&nbsp;no&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536718">&#34;http:%2f%2fwww.google.com/?q=go+language&#34;</span><span class="op" id="8536760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536764">&amp;</span><span class="ident" id="8536765">URL</span><span class="op" id="8536768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536773">Scheme</span><span class="op" id="8536779">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8536783">&#34;http&#34;</span><span class="op" id="8536789">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536794">Opaque</span><span class="op" id="8536800">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8536804">&#34;%2f%2fwww.google.com/&#34;</span><span class="op" id="8536827">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536832">RawQuery</span><span class="op" id="8536840">:</span>&nbsp;<span class="string" id="8536842">&#34;q=go+language&#34;</span><span class="op" id="8536857">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536861">}</span><span class="op" id="8536862">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536866">&#34;http:%2f%2fwww.google.com/?q=go+language&#34;</span><span class="op" id="8536908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536911">}</span><span class="op" id="8536912">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8536915">//&nbsp;non-authority&nbsp;with&nbsp;path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8536947">&#34;mailto:/webmaster@golang.org&#34;</span><span class="op" id="8536977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8536981">&amp;</span><span class="ident" id="8536982">URL</span><span class="op" id="8536985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8536990">Scheme</span><span class="op" id="8536996">:</span>&nbsp;<span class="string" id="8536998">&#34;mailto&#34;</span><span class="op" id="8537006">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8537011">Path</span><span class="op" id="8537015">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8537019">&#34;/webmaster@golang.org&#34;</span><span class="op" id="8537042">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537046">}</span><span class="op" id="8537047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8537051">&#34;mailto:///webmaster@golang.org&#34;</span><span class="op" id="8537083">,</span>&nbsp;<span class="comment" id="8537085">//&nbsp;unfortunate&nbsp;compromise</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537112">}</span><span class="op" id="8537113">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8537116">//&nbsp;non-authority</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8537138">&#34;mailto:webmaster@golang.org&#34;</span><span class="op" id="8537167">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537171">&amp;</span><span class="ident" id="8537172">URL</span><span class="op" id="8537175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8537180">Scheme</span><span class="op" id="8537186">:</span>&nbsp;<span class="string" id="8537188">&#34;mailto&#34;</span><span class="op" id="8537196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8537201">Opaque</span><span class="op" id="8537207">:</span>&nbsp;<span class="string" id="8537209">&#34;webmaster@golang.org&#34;</span><span class="op" id="8537231">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537235">}</span><span class="op" id="8537236">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8537240">&#34;&#34;</span><span class="op" id="8537242">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537245">}</span><span class="op" id="8537246">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8537249">//&nbsp;unescaped&nbsp;://&nbsp;in&nbsp;query&nbsp;should&nbsp;not&nbsp;create&nbsp;a&nbsp;scheme</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537303">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8537307">&#34;/foo?query=http://bad&#34;</span><span class="op" id="8537330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537334">&amp;</span><span class="ident" id="8537335">URL</span><span class="op" id="8537338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8537343">Path</span><span class="op" id="8537347">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8537353">&#34;/foo&#34;</span><span class="op" id="8537359">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8537364">RawQuery</span><span class="op" id="8537372">:</span>&nbsp;<span class="string" id="8537374">&#34;query=http://bad&#34;</span><span class="op" id="8537392">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537396">}</span><span class="op" id="8537397">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8537401">&#34;&#34;</span><span class="op" id="8537403">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537406">}</span><span class="op" id="8537407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8537410">//&nbsp;leading&nbsp;//&nbsp;without&nbsp;scheme&nbsp;should&nbsp;create&nbsp;an&nbsp;authority</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8537471">&#34;//foo&#34;</span><span class="op" id="8537478">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537482">&amp;</span><span class="ident" id="8537483">URL</span><span class="op" id="8537486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8537491">Host</span><span class="op" id="8537495">:</span>&nbsp;<span class="string" id="8537497">&#34;foo&#34;</span><span class="op" id="8537502">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537506">}</span><span class="op" id="8537507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8537511">&#34;&#34;</span><span class="op" id="8537513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537516">}</span><span class="op" id="8537517">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8537520">//&nbsp;leading&nbsp;//&nbsp;without&nbsp;scheme,&nbsp;with&nbsp;userinfo,&nbsp;path,&nbsp;and&nbsp;query</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8537586">&#34;//user@foo/path?a=b&#34;</span><span class="op" id="8537607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537611">&amp;</span><span class="ident" id="8537612">URL</span><span class="op" id="8537615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8537620">User</span><span class="op" id="8537624">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8537630">User</span><span class="op" id="8537634">(</span><span class="string" id="8537635">&#34;user&#34;</span><span class="op" id="8537641">)</span><span class="op" id="8537642">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8537647">Host</span><span class="op" id="8537651">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8537657">&#34;foo&#34;</span><span class="op" id="8537662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8537667">Path</span><span class="op" id="8537671">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8537677">&#34;/path&#34;</span><span class="op" id="8537684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8537689">RawQuery</span><span class="op" id="8537697">:</span>&nbsp;<span class="string" id="8537699">&#34;a=b&#34;</span><span class="op" id="8537704">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537708">}</span><span class="op" id="8537709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8537713">&#34;&#34;</span><span class="op" id="8537715">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537718">}</span><span class="op" id="8537719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8537722">//&nbsp;Three&nbsp;leading&nbsp;slashes&nbsp;isn&#39;t&nbsp;an&nbsp;authority,&nbsp;but&nbsp;doesn&#39;t&nbsp;return&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8537797">//&nbsp;(We&nbsp;can&#39;t&nbsp;return&nbsp;an&nbsp;error,&nbsp;as&nbsp;this&nbsp;code&nbsp;is&nbsp;also&nbsp;used&nbsp;via</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8537858">//&nbsp;ServeHTTP&nbsp;-&gt;&nbsp;ReadRequest&nbsp;-&gt;&nbsp;Parse,&nbsp;which&nbsp;is&nbsp;arguably&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8537917">//&nbsp;different&nbsp;URL&nbsp;parsing&nbsp;context,&nbsp;but&nbsp;currently&nbsp;shares&nbsp;the</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8537977">//&nbsp;same&nbsp;codepath)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8537996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8538000">&#34;///threeslashes&#34;</span><span class="op" id="8538017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538021">&amp;</span><span class="ident" id="8538022">URL</span><span class="op" id="8538025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538030">Path</span><span class="op" id="8538034">:</span>&nbsp;<span class="string" id="8538036">&#34;///threeslashes&#34;</span><span class="op" id="8538053">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538057">}</span><span class="op" id="8538058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8538062">&#34;&#34;</span><span class="op" id="8538064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538067">}</span><span class="op" id="8538068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8538075">&#34;http://user:password@google.com&#34;</span><span class="op" id="8538108">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538112">&amp;</span><span class="ident" id="8538113">URL</span><span class="op" id="8538116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538121">Scheme</span><span class="op" id="8538127">:</span>&nbsp;<span class="string" id="8538129">&#34;http&#34;</span><span class="op" id="8538135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538140">User</span><span class="op" id="8538144">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8538148">UserPassword</span><span class="op" id="8538160">(</span><span class="string" id="8538161">&#34;user&#34;</span><span class="op" id="8538167">,</span>&nbsp;<span class="string" id="8538169">&#34;password&#34;</span><span class="op" id="8538179">)</span><span class="op" id="8538180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538185">Host</span><span class="op" id="8538189">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8538193">&#34;google.com&#34;</span><span class="op" id="8538205">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538209">}</span><span class="op" id="8538210">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8538214">&#34;http://user:password@google.com&#34;</span><span class="op" id="8538247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538250">}</span><span class="op" id="8538251">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8538254">//&nbsp;unescaped&nbsp;@&nbsp;in&nbsp;username&nbsp;should&nbsp;not&nbsp;confuse&nbsp;host</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8538310">&#34;http://j@ne:password@google.com&#34;</span><span class="op" id="8538343">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538347">&amp;</span><span class="ident" id="8538348">URL</span><span class="op" id="8538351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538356">Scheme</span><span class="op" id="8538362">:</span>&nbsp;<span class="string" id="8538364">&#34;http&#34;</span><span class="op" id="8538370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538375">User</span><span class="op" id="8538379">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8538383">UserPassword</span><span class="op" id="8538395">(</span><span class="string" id="8538396">&#34;j@ne&#34;</span><span class="op" id="8538402">,</span>&nbsp;<span class="string" id="8538404">&#34;password&#34;</span><span class="op" id="8538414">)</span><span class="op" id="8538415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538420">Host</span><span class="op" id="8538424">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8538428">&#34;google.com&#34;</span><span class="op" id="8538440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538444">}</span><span class="op" id="8538445">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8538449">&#34;http://j%40ne:password@google.com&#34;</span><span class="op" id="8538484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538487">}</span><span class="op" id="8538488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8538491">//&nbsp;unescaped&nbsp;@&nbsp;in&nbsp;password&nbsp;should&nbsp;not&nbsp;confuse&nbsp;host</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538543">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8538547">&#34;http://jane:p@ssword@google.com&#34;</span><span class="op" id="8538580">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538584">&amp;</span><span class="ident" id="8538585">URL</span><span class="op" id="8538588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538593">Scheme</span><span class="op" id="8538599">:</span>&nbsp;<span class="string" id="8538601">&#34;http&#34;</span><span class="op" id="8538607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538612">User</span><span class="op" id="8538616">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8538620">UserPassword</span><span class="op" id="8538632">(</span><span class="string" id="8538633">&#34;jane&#34;</span><span class="op" id="8538639">,</span>&nbsp;<span class="string" id="8538641">&#34;p@ssword&#34;</span><span class="op" id="8538651">)</span><span class="op" id="8538652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538657">Host</span><span class="op" id="8538661">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8538665">&#34;google.com&#34;</span><span class="op" id="8538677">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538681">}</span><span class="op" id="8538682">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8538686">&#34;http://jane:p%40ssword@google.com&#34;</span><span class="op" id="8538721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538724">}</span><span class="op" id="8538725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8538732">&#34;http://j@ne:password@google.com/p@th?q=@go&#34;</span><span class="op" id="8538776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538780">&amp;</span><span class="ident" id="8538781">URL</span><span class="op" id="8538784">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538789">Scheme</span><span class="op" id="8538795">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8538799">&#34;http&#34;</span><span class="op" id="8538805">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538810">User</span><span class="op" id="8538814">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538820">UserPassword</span><span class="op" id="8538832">(</span><span class="string" id="8538833">&#34;j@ne&#34;</span><span class="op" id="8538839">,</span>&nbsp;<span class="string" id="8538841">&#34;password&#34;</span><span class="op" id="8538851">)</span><span class="op" id="8538852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538857">Host</span><span class="op" id="8538861">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8538867">&#34;google.com&#34;</span><span class="op" id="8538879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538884">Path</span><span class="op" id="8538888">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8538894">&#34;/p@th&#34;</span><span class="op" id="8538901">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8538906">RawQuery</span><span class="op" id="8538914">:</span>&nbsp;<span class="string" id="8538916">&#34;q=@go&#34;</span><span class="op" id="8538923">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538927">}</span><span class="op" id="8538928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8538932">&#34;http://j%40ne:password@google.com/p@th?q=@go&#34;</span><span class="op" id="8538978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538981">}</span><span class="op" id="8538982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8538985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8538989">&#34;http://www.google.com/?q=go+language#foo&#34;</span><span class="op" id="8539031">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539035">&amp;</span><span class="ident" id="8539036">URL</span><span class="op" id="8539039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539044">Scheme</span><span class="op" id="8539050">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8539054">&#34;http&#34;</span><span class="op" id="8539060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539065">Host</span><span class="op" id="8539069">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8539075">&#34;www.google.com&#34;</span><span class="op" id="8539091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539096">Path</span><span class="op" id="8539100">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8539106">&#34;/&#34;</span><span class="op" id="8539109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539114">RawQuery</span><span class="op" id="8539122">:</span>&nbsp;<span class="string" id="8539124">&#34;q=go+language&#34;</span><span class="op" id="8539139">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539144">Fragment</span><span class="op" id="8539152">:</span>&nbsp;<span class="string" id="8539154">&#34;foo&#34;</span><span class="op" id="8539159">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539163">}</span><span class="op" id="8539164">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8539168">&#34;&#34;</span><span class="op" id="8539170">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539173">}</span><span class="op" id="8539174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539177">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8539181">&#34;http://www.google.com/?q=go+language#foo%26bar&#34;</span><span class="op" id="8539229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539233">&amp;</span><span class="ident" id="8539234">URL</span><span class="op" id="8539237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539242">Scheme</span><span class="op" id="8539248">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8539252">&#34;http&#34;</span><span class="op" id="8539258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539263">Host</span><span class="op" id="8539267">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8539273">&#34;www.google.com&#34;</span><span class="op" id="8539289">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539294">Path</span><span class="op" id="8539298">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8539304">&#34;/&#34;</span><span class="op" id="8539307">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539312">RawQuery</span><span class="op" id="8539320">:</span>&nbsp;<span class="string" id="8539322">&#34;q=go+language&#34;</span><span class="op" id="8539337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539342">Fragment</span><span class="op" id="8539350">:</span>&nbsp;<span class="string" id="8539352">&#34;foo&amp;bar&#34;</span><span class="op" id="8539361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539365">}</span><span class="op" id="8539366">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8539370">&#34;http://www.google.com/?q=go+language#foo&amp;bar&#34;</span><span class="op" id="8539416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539419">}</span><span class="op" id="8539420">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8539427">&#34;file:///home/adg/rabbits&#34;</span><span class="op" id="8539453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539457">&amp;</span><span class="ident" id="8539458">URL</span><span class="op" id="8539461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539466">Scheme</span><span class="op" id="8539472">:</span>&nbsp;<span class="string" id="8539474">&#34;file&#34;</span><span class="op" id="8539480">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539485">Host</span><span class="op" id="8539489">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8539493">&#34;&#34;</span><span class="op" id="8539495">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539500">Path</span><span class="op" id="8539504">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8539508">&#34;/home/adg/rabbits&#34;</span><span class="op" id="8539527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539531">}</span><span class="op" id="8539532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8539536">&#34;file:///home/adg/rabbits&#34;</span><span class="op" id="8539562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539565">}</span><span class="op" id="8539566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8539569">//&nbsp;&#34;Windows&#34;&nbsp;paths&nbsp;are&nbsp;no&nbsp;exception&nbsp;to&nbsp;the&nbsp;rule.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8539619">//&nbsp;See&nbsp;golang.org/issue/6027,&nbsp;especially&nbsp;comment&nbsp;#9.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8539677">&#34;file:///C:/FooBar/Baz.txt&#34;</span><span class="op" id="8539704">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539708">&amp;</span><span class="ident" id="8539709">URL</span><span class="op" id="8539712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539717">Scheme</span><span class="op" id="8539723">:</span>&nbsp;<span class="string" id="8539725">&#34;file&#34;</span><span class="op" id="8539731">,</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539736">Host</span><span class="op" id="8539740">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8539744">&#34;&#34;</span><span class="op" id="8539746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539751">Path</span><span class="op" id="8539755">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8539759">&#34;/C:/FooBar/Baz.txt&#34;</span><span class="op" id="8539779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539783">}</span><span class="op" id="8539784">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8539788">&#34;file:///C:/FooBar/Baz.txt&#34;</span><span class="op" id="8539815">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539818">}</span><span class="op" id="8539819">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8539822">//&nbsp;case-insensitive&nbsp;scheme</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539850">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8539854">&#34;MaIlTo:webmaster@golang.org&#34;</span><span class="op" id="8539883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539887">&amp;</span><span class="ident" id="8539888">URL</span><span class="op" id="8539891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539896">Scheme</span><span class="op" id="8539902">:</span>&nbsp;<span class="string" id="8539904">&#34;mailto&#34;</span><span class="op" id="8539912">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8539917">Opaque</span><span class="op" id="8539923">:</span>&nbsp;<span class="string" id="8539925">&#34;webmaster@golang.org&#34;</span><span class="op" id="8539947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539951">}</span><span class="op" id="8539952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8539956">&#34;mailto:webmaster@golang.org&#34;</span><span class="op" id="8539985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8539988">}</span><span class="op" id="8539989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8539992">//&nbsp;Relative&nbsp;path</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8540010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8540014">&#34;a/b/c&#34;</span><span class="op" id="8540021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8540025">&amp;</span><span class="ident" id="8540026">URL</span><span class="op" id="8540029">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540034">Path</span><span class="op" id="8540038">:</span>&nbsp;<span class="string" id="8540040">&#34;a/b/c&#34;</span><span class="op" id="8540047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8540051">}</span><span class="op" id="8540052">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8540056">&#34;a/b/c&#34;</span><span class="op" id="8540063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8540066">}</span><span class="op" id="8540067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8540070">//&nbsp;escaped&nbsp;&#39;?&#39;&nbsp;in&nbsp;username&nbsp;and&nbsp;password</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8540111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8540115">&#34;http://%3Fam:pa%3Fsword@google.com&#34;</span><span class="op" id="8540151">,</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8540155">&amp;</span><span class="ident" id="8540156">URL</span><span class="op" id="8540159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540164">Scheme</span><span class="op" id="8540170">:</span>&nbsp;<span class="string" id="8540172">&#34;http&#34;</span><span class="op" id="8540178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540183">User</span><span class="op" id="8540187">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8540191">UserPassword</span><span class="op" id="8540203">(</span><span class="string" id="8540204">&#34;?am&#34;</span><span class="op" id="8540209">,</span>&nbsp;<span class="string" id="8540211">&#34;pa?sword&#34;</span><span class="op" id="8540221">)</span><span class="op" id="8540222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540227">Host</span><span class="op" id="8540231">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8540235">&#34;google.com&#34;</span><span class="op" id="8540247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8540251">}</span><span class="op" id="8540252">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8540256">&#34;&#34;</span><span class="op" id="8540258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8540261">}</span><span class="op" id="8540262">,</span><br>
<span class="lineno"></span><span class="op" id="8540264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8540267">//&nbsp;more&nbsp;useful&nbsp;string&nbsp;for&nbsp;debugging&nbsp;than&nbsp;fmt&#39;s&nbsp;struct&nbsp;printer</span><br>
<span class="lineno">295</span><span class="keyword" id="8540329">func</span>&nbsp;<span class="ident" id="8540334">ufmt</span><span class="op" id="8540338">(</span><span class="ident" id="8540339">u</span>&nbsp;<span class="op" id="8540341">*</span><span class="ident" id="8540342">URL</span><span class="op" id="8540345">)</span>&nbsp;<span class="builtintype" id="8540347">string</span>&nbsp;<span class="op" id="8540354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8540357">var</span>&nbsp;<span class="ident" id="8540361">user</span><span class="op" id="8540365">,</span>&nbsp;<span class="ident" id="8540367">pass</span>&nbsp;<span class="keyword" id="8540372">interface</span><span class="op" id="8540381">{</span><span class="op" id="8540382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8540385">if</span>&nbsp;<span class="ident" id="8540388">u</span><span class="op" id="8540389">.</span><span class="ident" id="8540390">User</span>&nbsp;<span class="op" id="8540395">!=</span>&nbsp;<span class="builtintype" id="8540398">nil</span>&nbsp;<span class="op" id="8540402">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540406">user</span>&nbsp;<span class="op" id="8540411">=</span>&nbsp;<span class="ident" id="8540413">u</span><span class="op" id="8540414">.</span><span class="ident" id="8540415">User</span><span class="op" id="8540419">.</span><span class="ident" id="8540420">Username</span><span class="op" id="8540428">(</span><span class="op" id="8540429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8540433">if</span>&nbsp;<span class="ident" id="8540436">p</span><span class="op" id="8540437">,</span>&nbsp;<span class="ident" id="8540439">ok</span>&nbsp;<span class="op" id="8540442">:=</span>&nbsp;<span class="ident" id="8540445">u</span><span class="op" id="8540446">.</span><span class="ident" id="8540447">User</span><span class="op" id="8540451">.</span><span class="ident" id="8540452">Password</span><span class="op" id="8540460">(</span><span class="op" id="8540461">)</span><span class="op" id="8540462">;</span>&nbsp;<span class="ident" id="8540464">ok</span>&nbsp;<span class="op" id="8540467">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540472">pass</span>&nbsp;<span class="op" id="8540477">=</span>&nbsp;<span class="ident" id="8540479">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8540483">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8540486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8540489">return</span>&nbsp;<span class="ident" id="8540496">fmt</span><span class="op" id="8540499">.</span><span class="ident" id="8540500">Sprintf</span><span class="op" id="8540507">(</span><span class="string" id="8540508">&#34;opaque=%q,&nbsp;scheme=%q,&nbsp;user=%#v,&nbsp;pass=%#v,&nbsp;host=%q,&nbsp;path=%q,&nbsp;rawq=%q,&nbsp;frag=%q&#34;</span><span class="op" id="8540586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540590">u</span><span class="op" id="8540591">.</span><span class="ident" id="8540592">Opaque</span><span class="op" id="8540598">,</span>&nbsp;<span class="ident" id="8540600">u</span><span class="op" id="8540601">.</span><span class="ident" id="8540602">Scheme</span><span class="op" id="8540608">,</span>&nbsp;<span class="ident" id="8540610">user</span><span class="op" id="8540614">,</span>&nbsp;<span class="ident" id="8540616">pass</span><span class="op" id="8540620">,</span>&nbsp;<span class="ident" id="8540622">u</span><span class="op" id="8540623">.</span><span class="ident" id="8540624">Host</span><span class="op" id="8540628">,</span>&nbsp;<span class="ident" id="8540630">u</span><span class="op" id="8540631">.</span><span class="ident" id="8540632">Path</span><span class="op" id="8540636">,</span>&nbsp;<span class="ident" id="8540638">u</span><span class="op" id="8540639">.</span><span class="ident" id="8540640">RawQuery</span><span class="op" id="8540648">,</span>&nbsp;<span class="ident" id="8540650">u</span><span class="op" id="8540651">.</span><span class="ident" id="8540652">Fragment</span><span class="op" id="8540660">)</span><br>
<span class="lineno">305</span><span class="op" id="8540662">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8540665">func</span>&nbsp;<span class="ident" id="8540670">DoTest</span><span class="op" id="8540676">(</span><span class="ident" id="8540677">t</span>&nbsp;<span class="op" id="8540679">*</span><span class="ident" id="8540680">testing</span><span class="op" id="8540687">.</span><span class="ident" id="8540688">T</span><span class="op" id="8540689">,</span>&nbsp;<span class="ident" id="8540691">parse</span>&nbsp;<span class="keyword" id="8540697">func</span><span class="op" id="8540701">(</span><span class="builtintype" id="8540702">string</span><span class="op" id="8540708">)</span>&nbsp;<span class="op" id="8540710">(</span><span class="op" id="8540711">*</span><span class="ident" id="8540712">URL</span><span class="op" id="8540715">,</span>&nbsp;<span class="builtintype" id="8540717">error</span><span class="op" id="8540722">)</span><span class="op" id="8540723">,</span>&nbsp;<span class="ident" id="8540725">name</span>&nbsp;<span class="builtintype" id="8540730">string</span><span class="op" id="8540736">,</span>&nbsp;<span class="ident" id="8540738">tests</span>&nbsp;<span class="op" id="8540744">[</span><span class="op" id="8540745">]</span><span class="ident" id="8540746">URLTest</span><span class="op" id="8540753">)</span>&nbsp;<span class="op" id="8540755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8540758">for</span>&nbsp;<span class="ident" id="8540762">_</span><span class="op" id="8540763">,</span>&nbsp;<span class="ident" id="8540765">tt</span>&nbsp;<span class="op" id="8540768">:=</span>&nbsp;<span class="keyword" id="8540771">range</span>&nbsp;<span class="ident" id="8540777">tests</span>&nbsp;<span class="op" id="8540783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540787">u</span><span class="op" id="8540788">,</span>&nbsp;<span class="ident" id="8540790">err</span>&nbsp;<span class="op" id="8540794">:=</span>&nbsp;<span class="ident" id="8540797">parse</span><span class="op" id="8540802">(</span><span class="ident" id="8540803">tt</span><span class="op" id="8540805">.</span><span class="ident" id="8540806">in</span><span class="op" id="8540808">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8540812">if</span>&nbsp;<span class="ident" id="8540815">err</span>&nbsp;<span class="op" id="8540819">!=</span>&nbsp;<span class="builtintype" id="8540822">nil</span>&nbsp;<span class="op" id="8540826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540831">t</span><span class="op" id="8540832">.</span><span class="ident" id="8540833">Errorf</span><span class="op" id="8540839">(</span><span class="string" id="8540840">&#34;%s(%q)&nbsp;returned&nbsp;error&nbsp;%s&#34;</span><span class="op" id="8540866">,</span>&nbsp;<span class="ident" id="8540868">name</span><span class="op" id="8540872">,</span>&nbsp;<span class="ident" id="8540874">tt</span><span class="op" id="8540876">.</span><span class="ident" id="8540877">in</span><span class="op" id="8540879">,</span>&nbsp;<span class="ident" id="8540881">err</span><span class="op" id="8540884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8540889">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8540900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8540904">if</span>&nbsp;<span class="op" id="8540907">!</span><span class="ident" id="8540908">reflect</span><span class="op" id="8540915">.</span><span class="ident" id="8540916">DeepEqual</span><span class="op" id="8540925">(</span><span class="ident" id="8540926">u</span><span class="op" id="8540927">,</span>&nbsp;<span class="ident" id="8540929">tt</span><span class="op" id="8540931">.</span><span class="ident" id="8540932">out</span><span class="op" id="8540935">)</span>&nbsp;<span class="op" id="8540937">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540942">t</span><span class="op" id="8540943">.</span><span class="ident" id="8540944">Errorf</span><span class="op" id="8540950">(</span><span class="string" id="8540951">&#34;%s(%q):\n\thave&nbsp;%v\n\twant&nbsp;%v\n&#34;</span><span class="op" id="8540984">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8540990">name</span><span class="op" id="8540994">,</span>&nbsp;<span class="ident" id="8540996">tt</span><span class="op" id="8540998">.</span><span class="ident" id="8540999">in</span><span class="op" id="8541001">,</span>&nbsp;<span class="ident" id="8541003">ufmt</span><span class="op" id="8541007">(</span><span class="ident" id="8541008">u</span><span class="op" id="8541009">)</span><span class="op" id="8541010">,</span>&nbsp;<span class="ident" id="8541012">ufmt</span><span class="op" id="8541016">(</span><span class="ident" id="8541017">tt</span><span class="op" id="8541019">.</span><span class="ident" id="8541020">out</span><span class="op" id="8541023">)</span><span class="op" id="8541024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8541028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8541031">}</span><br>
<span class="lineno"></span><span class="op" id="8541033">}</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span><span class="keyword" id="8541036">func</span>&nbsp;<span class="ident" id="8541041">BenchmarkString</span><span class="op" id="8541056">(</span><span class="ident" id="8541057">b</span>&nbsp;<span class="op" id="8541059">*</span><span class="ident" id="8541060">testing</span><span class="op" id="8541067">.</span><span class="ident" id="8541068">B</span><span class="op" id="8541069">)</span>&nbsp;<span class="op" id="8541071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8541074">b</span><span class="op" id="8541075">.</span><span class="ident" id="8541076">StopTimer</span><span class="op" id="8541085">(</span><span class="op" id="8541086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8541089">b</span><span class="op" id="8541090">.</span><span class="ident" id="8541091">ReportAllocs</span><span class="op" id="8541103">(</span><span class="op" id="8541104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8541107">for</span>&nbsp;<span class="ident" id="8541111">_</span><span class="op" id="8541112">,</span>&nbsp;<span class="ident" id="8541114">tt</span>&nbsp;<span class="op" id="8541117">:=</span>&nbsp;<span class="keyword" id="8541120">range</span>&nbsp;<span class="ident" id="8541126">urltests</span>&nbsp;<span class="op" id="8541135">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8541139">u</span><span class="op" id="8541140">,</span>&nbsp;<span class="ident" id="8541142">err</span>&nbsp;<span class="op" id="8541146">:=</span>&nbsp;<span class="ident" id="8541149">Parse</span><span class="op" id="8541154">(</span><span class="ident" id="8541155">tt</span><span class="op" id="8541157">.</span><span class="ident" id="8541158">in</span><span class="op" id="8541160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8541164">if</span>&nbsp;<span class="ident" id="8541167">err</span>&nbsp;<span class="op" id="8541171">!=</span>&nbsp;<span class="builtintype" id="8541174">nil</span>&nbsp;<span class="op" id="8541178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8541183">b</span><span class="op" id="8541184">.</span><span class="ident" id="8541185">Errorf</span><span class="op" id="8541191">(</span><span class="string" id="8541192">&#34;Parse(%q)&nbsp;returned&nbsp;error&nbsp;%s&#34;</span><span class="op" id="8541221">,</span>&nbsp;<span class="ident" id="8541223">tt</span><span class="op" id="8541225">.</span><span class="ident" id="8541226">in</span><span class="op" id="8541228">,</span>&nbsp;<span class="ident" id="8541230">err</span><span class="op" id="8541233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8541238">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8541249">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8541253">if</span>&nbsp;<span class="ident" id="8541256">tt</span><span class="op" id="8541258">.</span><span class="ident" id="8541259">roundtrip</span>&nbsp;<span class="op" id="8541269">==</span>&nbsp;<span class="string" id="8541272">&#34;&#34;</span>&nbsp;<span class="op" id="8541275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8541280">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8541291">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8541295">b</span><span class="op" id="8541296">.</span><span class="ident" id="8541297">StartTimer</span><span class="op" id="8541307">(</span><span class="op" id="8541308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8541312">var</span>&nbsp;<span class="ident" id="8541316">g</span>&nbsp;<span class="builtintype" id="8541318">string</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8541327">for</span>&nbsp;<span class="ident" id="8541331">i</span>&nbsp;<span class="op" id="8541333">:=</span>&nbsp;<span class="num" id="8541336">0</span><span class="op" id="8541337">;</span>&nbsp;<span class="ident" id="8541339">i</span>&nbsp;<span class="op" id="8541341">&lt;</span>&nbsp;<span class="ident" id="8541343">b</span><span class="op" id="8541344">.</span><span class="ident" id="8541345">N</span><span class="op" id="8541346">;</span>&nbsp;<span class="ident" id="8541348">i</span><span class="op" id="8541349">++</span>&nbsp;<span class="op" id="8541352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8541357">g</span>&nbsp;<span class="op" id="8541359">=</span>&nbsp;<span class="ident" id="8541361">u</span><span class="op" id="8541362">.</span><span class="ident" id="8541363">String</span><span class="op" id="8541369">(</span><span class="op" id="8541370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8541374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8541378">b</span><span class="op" id="8541379">.</span><span class="ident" id="8541380">StopTimer</span><span class="op" id="8541389">(</span><span class="op" id="8541390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8541394">if</span>&nbsp;<span class="ident" id="8541397">w</span>&nbsp;<span class="op" id="8541399">:=</span>&nbsp;<span class="ident" id="8541402">tt</span><span class="op" id="8541404">.</span><span class="ident" id="8541405">roundtrip</span><span class="op" id="8541414">;</span>&nbsp;<span class="ident" id="8541416">g</span>&nbsp;<span class="op" id="8541418">!=</span>&nbsp;<span class="ident" id="8541421">w</span>&nbsp;<span class="op" id="8541423">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8541428">b</span><span class="op" id="8541429">.</span><span class="ident" id="8541430">Errorf</span><span class="op" id="8541436">(</span><span class="string" id="8541437">&#34;Parse(%q).String()&nbsp;==&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8541472">,</span>&nbsp;<span class="ident" id="8541474">tt</span><span class="op" id="8541476">.</span><span class="ident" id="8541477">in</span><span class="op" id="8541479">,</span>&nbsp;<span class="ident" id="8541481">g</span><span class="op" id="8541482">,</span>&nbsp;<span class="ident" id="8541484">w</span><span class="op" id="8541485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8541489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8541492">}</span><br>
<span class="lineno"></span><span class="op" id="8541494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="8541497">func</span>&nbsp;<span class="ident" id="8541502">TestParse</span><span class="op" id="8541511">(</span><span class="ident" id="8541512">t</span>&nbsp;<span class="op" id="8541514">*</span><span class="ident" id="8541515">testing</span><span class="op" id="8541522">.</span><span class="ident" id="8541523">T</span><span class="op" id="8541524">)</span>&nbsp;<span class="op" id="8541526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8541529">DoTest</span><span class="op" id="8541535">(</span><span class="ident" id="8541536">t</span><span class="op" id="8541537">,</span>&nbsp;<span class="ident" id="8541539">Parse</span><span class="op" id="8541544">,</span>&nbsp;<span class="string" id="8541546">&#34;Parse&#34;</span><span class="op" id="8541553">,</span>&nbsp;<span class="ident" id="8541555">urltests</span><span class="op" id="8541563">)</span><br>
<span class="lineno"></span><span class="op" id="8541565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8541568">const</span>&nbsp;<span class="ident" id="8541574">pathThatLooksSchemeRelative</span>&nbsp;<span class="op" id="8541602">=</span>&nbsp;<span class="string" id="8541604">&#34;//not.a.user@not.a.host/just/a/path&#34;</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span><span class="keyword" id="8541643">var</span>&nbsp;<span class="ident" id="8541647">parseRequestURLTests</span>&nbsp;<span class="op" id="8541668">=</span>&nbsp;<span class="op" id="8541670">[</span><span class="op" id="8541671">]</span><span class="keyword" id="8541672">struct</span>&nbsp;<span class="op" id="8541679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8541682">url</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8541696">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8541704">expectedValid</span>&nbsp;<span class="builtintype" id="8541718">bool</span><br>
<span class="lineno"></span><span class="op" id="8541723">}</span><span class="op" id="8541724">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8541727">{</span><span class="string" id="8541728">&#34;http://foo.com&#34;</span><span class="op" id="8541744">,</span>&nbsp;<span class="builtintype" id="8541746">true</span><span class="op" id="8541750">}</span><span class="op" id="8541751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8541754">{</span><span class="string" id="8541755">&#34;http://foo.com/&#34;</span><span class="op" id="8541772">,</span>&nbsp;<span class="builtintype" id="8541774">true</span><span class="op" id="8541778">}</span><span class="op" id="8541779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8541782">{</span><span class="string" id="8541783">&#34;http://foo.com/path&#34;</span><span class="op" id="8541804">,</span>&nbsp;<span class="builtintype" id="8541806">true</span><span class="op" id="8541810">}</span><span class="op" id="8541811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8541814">{</span><span class="string" id="8541815">&#34;/&#34;</span><span class="op" id="8541818">,</span>&nbsp;<span class="builtintype" id="8541820">true</span><span class="op" id="8541824">}</span><span class="op" id="8541825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8541828">{</span><span class="ident" id="8541829">pathThatLooksSchemeRelative</span><span class="op" id="8541856">,</span>&nbsp;<span class="builtintype" id="8541858">true</span><span class="op" id="8541862">}</span><span class="op" id="8541863">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8541866">{</span><span class="string" id="8541867">&#34;//not.a.user@%66%6f%6f.com/just/a/path/also&#34;</span><span class="op" id="8541912">,</span>&nbsp;<span class="builtintype" id="8541914">true</span><span class="op" id="8541918">}</span><span class="op" id="8541919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8541922">{</span><span class="string" id="8541923">&#34;foo.html&#34;</span><span class="op" id="8541933">,</span>&nbsp;<span class="builtintype" id="8541935">false</span><span class="op" id="8541940">}</span><span class="op" id="8541941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8541944">{</span><span class="string" id="8541945">&#34;../dir/&#34;</span><span class="op" id="8541954">,</span>&nbsp;<span class="builtintype" id="8541956">false</span><span class="op" id="8541961">}</span><span class="op" id="8541962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8541965">{</span><span class="string" id="8541966">&#34;*&#34;</span><span class="op" id="8541969">,</span>&nbsp;<span class="builtintype" id="8541971">true</span><span class="op" id="8541975">}</span><span class="op" id="8541976">,</span><br>
<span class="lineno"></span><span class="op" id="8541978">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="keyword" id="8541981">func</span>&nbsp;<span class="ident" id="8541986">TestParseRequestURI</span><span class="op" id="8542005">(</span><span class="ident" id="8542006">t</span>&nbsp;<span class="op" id="8542008">*</span><span class="ident" id="8542009">testing</span><span class="op" id="8542016">.</span><span class="ident" id="8542017">T</span><span class="op" id="8542018">)</span>&nbsp;<span class="op" id="8542020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8542023">for</span>&nbsp;<span class="ident" id="8542027">_</span><span class="op" id="8542028">,</span>&nbsp;<span class="ident" id="8542030">test</span>&nbsp;<span class="op" id="8542035">:=</span>&nbsp;<span class="keyword" id="8542038">range</span>&nbsp;<span class="ident" id="8542044">parseRequestURLTests</span>&nbsp;<span class="op" id="8542065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8542069">_</span><span class="op" id="8542070">,</span>&nbsp;<span class="ident" id="8542072">err</span>&nbsp;<span class="op" id="8542076">:=</span>&nbsp;<span class="ident" id="8542079">ParseRequestURI</span><span class="op" id="8542094">(</span><span class="ident" id="8542095">test</span><span class="op" id="8542099">.</span><span class="ident" id="8542100">url</span><span class="op" id="8542103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8542107">valid</span>&nbsp;<span class="op" id="8542113">:=</span>&nbsp;<span class="ident" id="8542116">err</span>&nbsp;<span class="op" id="8542120">==</span>&nbsp;<span class="builtintype" id="8542123">nil</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8542129">if</span>&nbsp;<span class="ident" id="8542132">valid</span>&nbsp;<span class="op" id="8542138">!=</span>&nbsp;<span class="ident" id="8542141">test</span><span class="op" id="8542145">.</span><span class="ident" id="8542146">expectedValid</span>&nbsp;<span class="op" id="8542160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8542165">t</span><span class="op" id="8542166">.</span><span class="ident" id="8542167">Errorf</span><span class="op" id="8542173">(</span><span class="string" id="8542174">&#34;Expected&nbsp;valid=%v&nbsp;for&nbsp;%q;&nbsp;got&nbsp;%v&#34;</span><span class="op" id="8542208">,</span>&nbsp;<span class="ident" id="8542210">test</span><span class="op" id="8542214">.</span><span class="ident" id="8542215">expectedValid</span><span class="op" id="8542228">,</span>&nbsp;<span class="ident" id="8542230">test</span><span class="op" id="8542234">.</span><span class="ident" id="8542235">url</span><span class="op" id="8542238">,</span>&nbsp;<span class="ident" id="8542240">valid</span><span class="op" id="8542245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8542249">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8542252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8542256">url</span><span class="op" id="8542259">,</span>&nbsp;<span class="ident" id="8542261">err</span>&nbsp;<span class="op" id="8542265">:=</span>&nbsp;<span class="ident" id="8542268">ParseRequestURI</span><span class="op" id="8542283">(</span><span class="ident" id="8542284">pathThatLooksSchemeRelative</span><span class="op" id="8542311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8542314">if</span>&nbsp;<span class="ident" id="8542317">err</span>&nbsp;<span class="op" id="8542321">!=</span>&nbsp;<span class="builtintype" id="8542324">nil</span>&nbsp;<span class="op" id="8542328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8542332">t</span><span class="op" id="8542333">.</span><span class="ident" id="8542334">Fatalf</span><span class="op" id="8542340">(</span><span class="string" id="8542341">&#34;Unexpected&nbsp;error&nbsp;%v&#34;</span><span class="op" id="8542362">,</span>&nbsp;<span class="ident" id="8542364">err</span><span class="op" id="8542367">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8542370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8542373">if</span>&nbsp;<span class="ident" id="8542376">url</span><span class="op" id="8542379">.</span><span class="ident" id="8542380">Path</span>&nbsp;<span class="op" id="8542385">!=</span>&nbsp;<span class="ident" id="8542388">pathThatLooksSchemeRelative</span>&nbsp;<span class="op" id="8542416">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8542420">t</span><span class="op" id="8542421">.</span><span class="ident" id="8542422">Errorf</span><span class="op" id="8542428">(</span><span class="string" id="8542429">&#34;Expected&nbsp;path&nbsp;%q;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8542455">,</span>&nbsp;<span class="ident" id="8542457">pathThatLooksSchemeRelative</span><span class="op" id="8542484">,</span>&nbsp;<span class="ident" id="8542486">url</span><span class="op" id="8542489">.</span><span class="ident" id="8542490">Path</span><span class="op" id="8542494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8542497">}</span><br>
<span class="lineno"></span><span class="op" id="8542499">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8542502">func</span>&nbsp;<span class="ident" id="8542507">DoTestString</span><span class="op" id="8542519">(</span><span class="ident" id="8542520">t</span>&nbsp;<span class="op" id="8542522">*</span><span class="ident" id="8542523">testing</span><span class="op" id="8542530">.</span><span class="ident" id="8542531">T</span><span class="op" id="8542532">,</span>&nbsp;<span class="ident" id="8542534">parse</span>&nbsp;<span class="keyword" id="8542540">func</span><span class="op" id="8542544">(</span><span class="builtintype" id="8542545">string</span><span class="op" id="8542551">)</span>&nbsp;<span class="op" id="8542553">(</span><span class="op" id="8542554">*</span><span class="ident" id="8542555">URL</span><span class="op" id="8542558">,</span>&nbsp;<span class="builtintype" id="8542560">error</span><span class="op" id="8542565">)</span><span class="op" id="8542566">,</span>&nbsp;<span class="ident" id="8542568">name</span>&nbsp;<span class="builtintype" id="8542573">string</span><span class="op" id="8542579">,</span>&nbsp;<span class="ident" id="8542581">tests</span>&nbsp;<span class="op" id="8542587">[</span><span class="op" id="8542588">]</span><span class="ident" id="8542589">URLTest</span><span class="op" id="8542596">)</span>&nbsp;<span class="op" id="8542598">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8542601">for</span>&nbsp;<span class="ident" id="8542605">_</span><span class="op" id="8542606">,</span>&nbsp;<span class="ident" id="8542608">tt</span>&nbsp;<span class="op" id="8542611">:=</span>&nbsp;<span class="keyword" id="8542614">range</span>&nbsp;<span class="ident" id="8542620">tests</span>&nbsp;<span class="op" id="8542626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8542630">u</span><span class="op" id="8542631">,</span>&nbsp;<span class="ident" id="8542633">err</span>&nbsp;<span class="op" id="8542637">:=</span>&nbsp;<span class="ident" id="8542640">parse</span><span class="op" id="8542645">(</span><span class="ident" id="8542646">tt</span><span class="op" id="8542648">.</span><span class="ident" id="8542649">in</span><span class="op" id="8542651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8542655">if</span>&nbsp;<span class="ident" id="8542658">err</span>&nbsp;<span class="op" id="8542662">!=</span>&nbsp;<span class="builtintype" id="8542665">nil</span>&nbsp;<span class="op" id="8542669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8542674">t</span><span class="op" id="8542675">.</span><span class="ident" id="8542676">Errorf</span><span class="op" id="8542682">(</span><span class="string" id="8542683">&#34;%s(%q)&nbsp;returned&nbsp;error&nbsp;%s&#34;</span><span class="op" id="8542709">,</span>&nbsp;<span class="ident" id="8542711">name</span><span class="op" id="8542715">,</span>&nbsp;<span class="ident" id="8542717">tt</span><span class="op" id="8542719">.</span><span class="ident" id="8542720">in</span><span class="op" id="8542722">,</span>&nbsp;<span class="ident" id="8542724">err</span><span class="op" id="8542727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8542732">continue</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8542743">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8542747">expected</span>&nbsp;<span class="op" id="8542756">:=</span>&nbsp;<span class="ident" id="8542759">tt</span><span class="op" id="8542761">.</span><span class="ident" id="8542762">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8542767">if</span>&nbsp;<span class="builtinfunc" id="8542770">len</span><span class="op" id="8542773">(</span><span class="ident" id="8542774">tt</span><span class="op" id="8542776">.</span><span class="ident" id="8542777">roundtrip</span><span class="op" id="8542786">)</span>&nbsp;<span class="op" id="8542788">&gt;</span>&nbsp;<span class="num" id="8542790">0</span>&nbsp;<span class="op" id="8542792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8542797">expected</span>&nbsp;<span class="op" id="8542806">=</span>&nbsp;<span class="ident" id="8542808">tt</span><span class="op" id="8542810">.</span><span class="ident" id="8542811">roundtrip</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8542823">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8542827">s</span>&nbsp;<span class="op" id="8542829">:=</span>&nbsp;<span class="ident" id="8542832">u</span><span class="op" id="8542833">.</span><span class="ident" id="8542834">String</span><span class="op" id="8542840">(</span><span class="op" id="8542841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8542845">if</span>&nbsp;<span class="ident" id="8542848">s</span>&nbsp;<span class="op" id="8542850">!=</span>&nbsp;<span class="ident" id="8542853">expected</span>&nbsp;<span class="op" id="8542862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8542867">t</span><span class="op" id="8542868">.</span><span class="ident" id="8542869">Errorf</span><span class="op" id="8542875">(</span><span class="string" id="8542876">&#34;%s(%q).String()&nbsp;==&nbsp;%q&nbsp;(expected&nbsp;%q)&#34;</span><span class="op" id="8542913">,</span>&nbsp;<span class="ident" id="8542915">name</span><span class="op" id="8542919">,</span>&nbsp;<span class="ident" id="8542921">tt</span><span class="op" id="8542923">.</span><span class="ident" id="8542924">in</span><span class="op" id="8542926">,</span>&nbsp;<span class="ident" id="8542928">s</span><span class="op" id="8542929">,</span>&nbsp;<span class="ident" id="8542931">expected</span><span class="op" id="8542939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8542943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8542946">}</span><br>
<span class="lineno">400</span><span class="op" id="8542948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8542951">func</span>&nbsp;<span class="ident" id="8542956">TestURLString</span><span class="op" id="8542969">(</span><span class="ident" id="8542970">t</span>&nbsp;<span class="op" id="8542972">*</span><span class="ident" id="8542973">testing</span><span class="op" id="8542980">.</span><span class="ident" id="8542981">T</span><span class="op" id="8542982">)</span>&nbsp;<span class="op" id="8542984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8542987">DoTestString</span><span class="op" id="8542999">(</span><span class="ident" id="8543000">t</span><span class="op" id="8543001">,</span>&nbsp;<span class="ident" id="8543003">Parse</span><span class="op" id="8543008">,</span>&nbsp;<span class="string" id="8543010">&#34;Parse&#34;</span><span class="op" id="8543017">,</span>&nbsp;<span class="ident" id="8543019">urltests</span><span class="op" id="8543027">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8543031">//&nbsp;no&nbsp;leading&nbsp;slash&nbsp;on&nbsp;path&nbsp;should&nbsp;prepend</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8543075">//&nbsp;slash&nbsp;on&nbsp;String()&nbsp;call</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8543102">noslash</span>&nbsp;<span class="op" id="8543110">:=</span>&nbsp;<span class="ident" id="8543113">URLTest</span><span class="op" id="8543120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543124">&#34;http://www.google.com/search&#34;</span><span class="op" id="8543154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543158">&amp;</span><span class="ident" id="8543159">URL</span><span class="op" id="8543162">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8543167">Scheme</span><span class="op" id="8543173">:</span>&nbsp;<span class="string" id="8543175">&#34;http&#34;</span><span class="op" id="8543181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8543186">Host</span><span class="op" id="8543190">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8543194">&#34;www.google.com&#34;</span><span class="op" id="8543210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8543215">Path</span><span class="op" id="8543219">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8543223">&#34;search&#34;</span><span class="op" id="8543231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543235">}</span><span class="op" id="8543236">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543240">&#34;&#34;</span><span class="op" id="8543242">,</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8543248">s</span>&nbsp;<span class="op" id="8543250">:=</span>&nbsp;<span class="ident" id="8543253">noslash</span><span class="op" id="8543260">.</span><span class="ident" id="8543261">out</span><span class="op" id="8543264">.</span><span class="ident" id="8543265">String</span><span class="op" id="8543271">(</span><span class="op" id="8543272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8543275">if</span>&nbsp;<span class="ident" id="8543278">s</span>&nbsp;<span class="op" id="8543280">!=</span>&nbsp;<span class="ident" id="8543283">noslash</span><span class="op" id="8543290">.</span><span class="ident" id="8543291">in</span>&nbsp;<span class="op" id="8543294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8543298">t</span><span class="op" id="8543299">.</span><span class="ident" id="8543300">Errorf</span><span class="op" id="8543306">(</span><span class="string" id="8543307">&#34;Expected&nbsp;%s;&nbsp;go&nbsp;%s&#34;</span><span class="op" id="8543327">,</span>&nbsp;<span class="ident" id="8543329">noslash</span><span class="op" id="8543336">.</span><span class="ident" id="8543337">in</span><span class="op" id="8543339">,</span>&nbsp;<span class="ident" id="8543341">s</span><span class="op" id="8543342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543345">}</span><br>
<span class="lineno">420</span><span class="op" id="8543347">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8543350">type</span>&nbsp;<span class="ident" id="8543355">EscapeTest</span>&nbsp;<span class="keyword" id="8543366">struct</span>&nbsp;<span class="op" id="8543373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8543376">in</span>&nbsp;&nbsp;<span class="builtintype" id="8543380">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8543388">out</span>&nbsp;<span class="builtintype" id="8543392">string</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8543400">err</span>&nbsp;<span class="builtintype" id="8543404">error</span><br>
<span class="lineno"></span><span class="op" id="8543410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8543413">var</span>&nbsp;<span class="ident" id="8543417">unescapeTests</span>&nbsp;<span class="op" id="8543431">=</span>&nbsp;<span class="op" id="8543433">[</span><span class="op" id="8543434">]</span><span class="ident" id="8543435">EscapeTest</span><span class="op" id="8543445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543448">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543452">&#34;&#34;</span><span class="op" id="8543454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543458">&#34;&#34;</span><span class="op" id="8543460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8543464">nil</span><span class="op" id="8543467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543470">}</span><span class="op" id="8543471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543474">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543478">&#34;abc&#34;</span><span class="op" id="8543483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543487">&#34;abc&#34;</span><span class="op" id="8543492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8543496">nil</span><span class="op" id="8543499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543502">}</span><span class="op" id="8543503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543506">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543510">&#34;1%41&#34;</span><span class="op" id="8543516">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543520">&#34;1A&#34;</span><span class="op" id="8543524">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8543528">nil</span><span class="op" id="8543531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543534">}</span><span class="op" id="8543535">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543538">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543542">&#34;1%41%42%43&#34;</span><span class="op" id="8543554">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543558">&#34;1ABC&#34;</span><span class="op" id="8543564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8543568">nil</span><span class="op" id="8543571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543574">}</span><span class="op" id="8543575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543578">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543582">&#34;%4a&#34;</span><span class="op" id="8543587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543591">&#34;J&#34;</span><span class="op" id="8543594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8543598">nil</span><span class="op" id="8543601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543604">}</span><span class="op" id="8543605">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543608">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543612">&#34;%6F&#34;</span><span class="op" id="8543617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543621">&#34;o&#34;</span><span class="op" id="8543624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8543628">nil</span><span class="op" id="8543631">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543634">}</span><span class="op" id="8543635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543638">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543642">&#34;%&#34;</span><span class="op" id="8543645">,</span>&nbsp;<span class="comment" id="8543647">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543682">&#34;&#34;</span><span class="op" id="8543684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8543688">EscapeError</span><span class="op" id="8543699">(</span><span class="string" id="8543700">&#34;%&#34;</span><span class="op" id="8543703">)</span><span class="op" id="8543704">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543707">}</span><span class="op" id="8543708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543711">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543715">&#34;%a&#34;</span><span class="op" id="8543719">,</span>&nbsp;<span class="comment" id="8543721">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543756">&#34;&#34;</span><span class="op" id="8543758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8543762">EscapeError</span><span class="op" id="8543773">(</span><span class="string" id="8543774">&#34;%a&#34;</span><span class="op" id="8543778">)</span><span class="op" id="8543779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543782">}</span><span class="op" id="8543783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543786">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543790">&#34;%1&#34;</span><span class="op" id="8543794">,</span>&nbsp;<span class="comment" id="8543796">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543831">&#34;&#34;</span><span class="op" id="8543833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8543837">EscapeError</span><span class="op" id="8543848">(</span><span class="string" id="8543849">&#34;%1&#34;</span><span class="op" id="8543853">)</span><span class="op" id="8543854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543857">}</span><span class="op" id="8543858">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543861">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543865">&#34;123%45%6&#34;</span><span class="op" id="8543875">,</span>&nbsp;<span class="comment" id="8543877">//&nbsp;not&nbsp;enough&nbsp;characters&nbsp;after&nbsp;%</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543912">&#34;&#34;</span><span class="op" id="8543914">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8543918">EscapeError</span><span class="op" id="8543929">(</span><span class="string" id="8543930">&#34;%6&#34;</span><span class="op" id="8543934">)</span><span class="op" id="8543935">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543938">}</span><span class="op" id="8543939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8543942">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543946">&#34;%zzzzz&#34;</span><span class="op" id="8543954">,</span>&nbsp;<span class="comment" id="8543956">//&nbsp;invalid&nbsp;hex&nbsp;digits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8543980">&#34;&#34;</span><span class="op" id="8543982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8543986">EscapeError</span><span class="op" id="8543997">(</span><span class="string" id="8543998">&#34;%zz&#34;</span><span class="op" id="8544003">)</span><span class="op" id="8544004">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8544007">}</span><span class="op" id="8544008">,</span><br>
<span class="lineno"></span><span class="op" id="8544010">}</span><br>
<span class="lineno">485</span><br>
<span class="lineno"></span><span class="keyword" id="8544013">func</span>&nbsp;<span class="ident" id="8544018">TestUnescape</span><span class="op" id="8544030">(</span><span class="ident" id="8544031">t</span>&nbsp;<span class="op" id="8544033">*</span><span class="ident" id="8544034">testing</span><span class="op" id="8544041">.</span><span class="ident" id="8544042">T</span><span class="op" id="8544043">)</span>&nbsp;<span class="op" id="8544045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8544048">for</span>&nbsp;<span class="ident" id="8544052">_</span><span class="op" id="8544053">,</span>&nbsp;<span class="ident" id="8544055">tt</span>&nbsp;<span class="op" id="8544058">:=</span>&nbsp;<span class="keyword" id="8544061">range</span>&nbsp;<span class="ident" id="8544067">unescapeTests</span>&nbsp;<span class="op" id="8544081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8544085">actual</span><span class="op" id="8544091">,</span>&nbsp;<span class="ident" id="8544093">err</span>&nbsp;<span class="op" id="8544097">:=</span>&nbsp;<span class="ident" id="8544100">QueryUnescape</span><span class="op" id="8544113">(</span><span class="ident" id="8544114">tt</span><span class="op" id="8544116">.</span><span class="ident" id="8544117">in</span><span class="op" id="8544119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8544123">if</span>&nbsp;<span class="ident" id="8544126">actual</span>&nbsp;<span class="op" id="8544133">!=</span>&nbsp;<span class="ident" id="8544136">tt</span><span class="op" id="8544138">.</span><span class="ident" id="8544139">out</span>&nbsp;<span class="op" id="8544143">||</span>&nbsp;<span class="op" id="8544146">(</span><span class="ident" id="8544147">err</span>&nbsp;<span class="op" id="8544151">!=</span>&nbsp;<span class="builtintype" id="8544154">nil</span><span class="op" id="8544157">)</span>&nbsp;<span class="op" id="8544159">!=</span>&nbsp;<span class="op" id="8544162">(</span><span class="ident" id="8544163">tt</span><span class="op" id="8544165">.</span><span class="ident" id="8544166">err</span>&nbsp;<span class="op" id="8544170">!=</span>&nbsp;<span class="builtintype" id="8544173">nil</span><span class="op" id="8544176">)</span>&nbsp;<span class="op" id="8544178">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8544183">t</span><span class="op" id="8544184">.</span><span class="ident" id="8544185">Errorf</span><span class="op" id="8544191">(</span><span class="string" id="8544192">&#34;QueryUnescape(%q)&nbsp;=&nbsp;%q,&nbsp;%s;&nbsp;want&nbsp;%q,&nbsp;%s&#34;</span><span class="op" id="8544233">,</span>&nbsp;<span class="ident" id="8544235">tt</span><span class="op" id="8544237">.</span><span class="ident" id="8544238">in</span><span class="op" id="8544240">,</span>&nbsp;<span class="ident" id="8544242">actual</span><span class="op" id="8544248">,</span>&nbsp;<span class="ident" id="8544250">err</span><span class="op" id="8544253">,</span>&nbsp;<span class="ident" id="8544255">tt</span><span class="op" id="8544257">.</span><span class="ident" id="8544258">out</span><span class="op" id="8544261">,</span>&nbsp;<span class="ident" id="8544263">tt</span><span class="op" id="8544265">.</span><span class="ident" id="8544266">err</span><span class="op" id="8544269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8544273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8544276">}</span><br>
<span class="lineno"></span><span class="op" id="8544278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">495</span><span class="keyword" id="8544281">var</span>&nbsp;<span class="ident" id="8544285">escapeTests</span>&nbsp;<span class="op" id="8544297">=</span>&nbsp;<span class="op" id="8544299">[</span><span class="op" id="8544300">]</span><span class="ident" id="8544301">EscapeTest</span><span class="op" id="8544311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8544314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8544318">&#34;&#34;</span><span class="op" id="8544320">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8544324">&#34;&#34;</span><span class="op" id="8544326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8544330">nil</span><span class="op" id="8544333">,</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8544336">}</span><span class="op" id="8544337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8544340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8544344">&#34;abc&#34;</span><span class="op" id="8544349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8544353">&#34;abc&#34;</span><span class="op" id="8544358">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8544362">nil</span><span class="op" id="8544365">,</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8544368">}</span><span class="op" id="8544369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8544372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8544376">&#34;one&nbsp;two&#34;</span><span class="op" id="8544385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8544389">&#34;one+two&#34;</span><span class="op" id="8544398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8544402">nil</span><span class="op" id="8544405">,</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8544408">}</span><span class="op" id="8544409">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8544412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8544416">&#34;10%&#34;</span><span class="op" id="8544421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8544425">&#34;10%25&#34;</span><span class="op" id="8544432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8544436">nil</span><span class="op" id="8544439">,</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8544442">}</span><span class="op" id="8544443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8544446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8544450">&#34;&nbsp;?&amp;=#+%!&lt;&gt;#\&#34;{}|\\^[]`\t:/@$&#39;()*,;&#34;</span><span class="op" id="8544489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8544493">&#34;+%3F%26%3D%23%2B%25%21%3C%3E%23%22%7B%7D%7C%5C%5E%5B%5D%60%E2%98%BA%09%3A%2F%40%24%27%28%29%2A%2C%3B&#34;</span><span class="op" id="8544595">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8544599">nil</span><span class="op" id="8544602">,</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8544605">}</span><span class="op" id="8544606">,</span><br>
<span class="lineno"></span><span class="op" id="8544608">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8544611">func</span>&nbsp;<span class="ident" id="8544616">TestEscape</span><span class="op" id="8544626">(</span><span class="ident" id="8544627">t</span>&nbsp;<span class="op" id="8544629">*</span><span class="ident" id="8544630">testing</span><span class="op" id="8544637">.</span><span class="ident" id="8544638">T</span><span class="op" id="8544639">)</span>&nbsp;<span class="op" id="8544641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8544644">for</span>&nbsp;<span class="ident" id="8544648">_</span><span class="op" id="8544649">,</span>&nbsp;<span class="ident" id="8544651">tt</span>&nbsp;<span class="op" id="8544654">:=</span>&nbsp;<span class="keyword" id="8544657">range</span>&nbsp;<span class="ident" id="8544663">escapeTests</span>&nbsp;<span class="op" id="8544675">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8544679">actual</span>&nbsp;<span class="op" id="8544686">:=</span>&nbsp;<span class="ident" id="8544689">QueryEscape</span><span class="op" id="8544700">(</span><span class="ident" id="8544701">tt</span><span class="op" id="8544703">.</span><span class="ident" id="8544704">in</span><span class="op" id="8544706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8544710">if</span>&nbsp;<span class="ident" id="8544713">tt</span><span class="op" id="8544715">.</span><span class="ident" id="8544716">out</span>&nbsp;<span class="op" id="8544720">!=</span>&nbsp;<span class="ident" id="8544723">actual</span>&nbsp;<span class="op" id="8544730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8544735">t</span><span class="op" id="8544736">.</span><span class="ident" id="8544737">Errorf</span><span class="op" id="8544743">(</span><span class="string" id="8544744">&#34;QueryEscape(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8544775">,</span>&nbsp;<span class="ident" id="8544777">tt</span><span class="op" id="8544779">.</span><span class="ident" id="8544780">in</span><span class="op" id="8544782">,</span>&nbsp;<span class="ident" id="8544784">actual</span><span class="op" id="8544790">,</span>&nbsp;<span class="ident" id="8544792">tt</span><span class="op" id="8544794">.</span><span class="ident" id="8544795">out</span><span class="op" id="8544798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8544802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8544807">//&nbsp;for&nbsp;bonus&nbsp;points,&nbsp;verify&nbsp;that&nbsp;escape:unescape&nbsp;is&nbsp;an&nbsp;identity.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8544874">roundtrip</span><span class="op" id="8544883">,</span>&nbsp;<span class="ident" id="8544885">err</span>&nbsp;<span class="op" id="8544889">:=</span>&nbsp;<span class="ident" id="8544892">QueryUnescape</span><span class="op" id="8544905">(</span><span class="ident" id="8544906">actual</span><span class="op" id="8544912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8544916">if</span>&nbsp;<span class="ident" id="8544919">roundtrip</span>&nbsp;<span class="op" id="8544929">!=</span>&nbsp;<span class="ident" id="8544932">tt</span><span class="op" id="8544934">.</span><span class="ident" id="8544935">in</span>&nbsp;<span class="op" id="8544938">||</span>&nbsp;<span class="ident" id="8544941">err</span>&nbsp;<span class="op" id="8544945">!=</span>&nbsp;<span class="builtintype" id="8544948">nil</span>&nbsp;<span class="op" id="8544952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8544957">t</span><span class="op" id="8544958">.</span><span class="ident" id="8544959">Errorf</span><span class="op" id="8544965">(</span><span class="string" id="8544966">&#34;QueryUnescape(%q)&nbsp;=&nbsp;%q,&nbsp;%s;&nbsp;want&nbsp;%q,&nbsp;%s&#34;</span><span class="op" id="8545007">,</span>&nbsp;<span class="ident" id="8545009">actual</span><span class="op" id="8545015">,</span>&nbsp;<span class="ident" id="8545017">roundtrip</span><span class="op" id="8545026">,</span>&nbsp;<span class="ident" id="8545028">err</span><span class="op" id="8545031">,</span>&nbsp;<span class="ident" id="8545033">tt</span><span class="op" id="8545035">.</span><span class="ident" id="8545036">in</span><span class="op" id="8545038">,</span>&nbsp;<span class="string" id="8545040">&#34;[no&nbsp;error]&#34;</span><span class="op" id="8545052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8545056">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8545059">}</span><br>
<span class="lineno"></span><span class="op" id="8545061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8545064">//var&nbsp;userinfoTests&nbsp;=&nbsp;[]UserinfoTest{</span><br>
<span class="lineno"></span><span class="comment" id="8545102">//&nbsp;&nbsp;&nbsp;&nbsp;{&#34;user&#34;,&nbsp;&#34;password&#34;,&nbsp;&#34;user:password&#34;},</span><br>
<span class="lineno">540</span><span class="comment" id="8545144">//&nbsp;&nbsp;&nbsp;&nbsp;{&#34;foo:bar&#34;,&nbsp;&#34;~!@#$%^&amp;*()_+{}|[]\\-=`:;&#39;\&#34;&lt;&gt;?,./&#34;,</span><br>
<span class="lineno"></span><span class="comment" id="8545197">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#34;foo%3Abar:~!%40%23$%25%5E&amp;*()_+%7B%7D%7C%5B%5D%5C-=%60%3A;&#39;%22%3C%3E?,.%2F&#34;},</span><br>
<span class="lineno"></span><span class="comment" id="8545280">//}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8545285">type</span>&nbsp;<span class="ident" id="8545290">EncodeQueryTest</span>&nbsp;<span class="keyword" id="8545306">struct</span>&nbsp;<span class="op" id="8545313">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8545316">m</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8545325">Values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8545333">expected</span>&nbsp;<span class="builtintype" id="8545342">string</span><br>
<span class="lineno"></span><span class="op" id="8545349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8545352">var</span>&nbsp;<span class="ident" id="8545356">encodeQueryTests</span>&nbsp;<span class="op" id="8545373">=</span>&nbsp;<span class="op" id="8545375">[</span><span class="op" id="8545376">]</span><span class="ident" id="8545377">EncodeQueryTest</span><span class="op" id="8545392">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8545395">{</span><span class="builtintype" id="8545396">nil</span><span class="op" id="8545399">,</span>&nbsp;<span class="string" id="8545401">&#34;&#34;</span><span class="op" id="8545403">}</span><span class="op" id="8545404">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8545407">{</span><span class="ident" id="8545408">Values</span><span class="op" id="8545414">{</span><span class="string" id="8545415">&#34;q&#34;</span><span class="op" id="8545418">:</span>&nbsp;<span class="op" id="8545420">{</span><span class="string" id="8545421">&#34;puppies&#34;</span><span class="op" id="8545430">}</span><span class="op" id="8545431">,</span>&nbsp;<span class="string" id="8545433">&#34;oe&#34;</span><span class="op" id="8545437">:</span>&nbsp;<span class="op" id="8545439">{</span><span class="string" id="8545440">&#34;utf8&#34;</span><span class="op" id="8545446">}</span><span class="op" id="8545447">}</span><span class="op" id="8545448">,</span>&nbsp;<span class="string" id="8545450">&#34;oe=utf8&amp;q=puppies&#34;</span><span class="op" id="8545469">}</span><span class="op" id="8545470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8545473">{</span><span class="ident" id="8545474">Values</span><span class="op" id="8545480">{</span><span class="string" id="8545481">&#34;q&#34;</span><span class="op" id="8545484">:</span>&nbsp;<span class="op" id="8545486">{</span><span class="string" id="8545487">&#34;dogs&#34;</span><span class="op" id="8545493">,</span>&nbsp;<span class="string" id="8545495">&#34;&amp;&#34;</span><span class="op" id="8545498">,</span>&nbsp;<span class="string" id="8545500">&#34;7&#34;</span><span class="op" id="8545503">}</span><span class="op" id="8545504">}</span><span class="op" id="8545505">,</span>&nbsp;<span class="string" id="8545507">&#34;q=dogs&amp;q=%26&amp;q=7&#34;</span><span class="op" id="8545525">}</span><span class="op" id="8545526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8545529">{</span><span class="ident" id="8545530">Values</span><span class="op" id="8545536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8545540">&#34;a&#34;</span><span class="op" id="8545543">:</span>&nbsp;<span class="op" id="8545545">{</span><span class="string" id="8545546">&#34;a1&#34;</span><span class="op" id="8545550">,</span>&nbsp;<span class="string" id="8545552">&#34;a2&#34;</span><span class="op" id="8545556">,</span>&nbsp;<span class="string" id="8545558">&#34;a3&#34;</span><span class="op" id="8545562">}</span><span class="op" id="8545563">,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8545567">&#34;b&#34;</span><span class="op" id="8545570">:</span>&nbsp;<span class="op" id="8545572">{</span><span class="string" id="8545573">&#34;b1&#34;</span><span class="op" id="8545577">,</span>&nbsp;<span class="string" id="8545579">&#34;b2&#34;</span><span class="op" id="8545583">,</span>&nbsp;<span class="string" id="8545585">&#34;b3&#34;</span><span class="op" id="8545589">}</span><span class="op" id="8545590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8545594">&#34;c&#34;</span><span class="op" id="8545597">:</span>&nbsp;<span class="op" id="8545599">{</span><span class="string" id="8545600">&#34;c1&#34;</span><span class="op" id="8545604">,</span>&nbsp;<span class="string" id="8545606">&#34;c2&#34;</span><span class="op" id="8545610">,</span>&nbsp;<span class="string" id="8545612">&#34;c3&#34;</span><span class="op" id="8545616">}</span><span class="op" id="8545617">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8545620">}</span><span class="op" id="8545621">,</span>&nbsp;<span class="string" id="8545623">&#34;a=a1&amp;a=a2&amp;a=a3&amp;b=b1&amp;b=b2&amp;b=b3&amp;c=c1&amp;c=c2&amp;c=c3&#34;</span><span class="op" id="8545669">}</span><span class="op" id="8545670">,</span><br>
<span class="lineno"></span><span class="op" id="8545672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">560</span><span class="keyword" id="8545675">func</span>&nbsp;<span class="ident" id="8545680">TestEncodeQuery</span><span class="op" id="8545695">(</span><span class="ident" id="8545696">t</span>&nbsp;<span class="op" id="8545698">*</span><span class="ident" id="8545699">testing</span><span class="op" id="8545706">.</span><span class="ident" id="8545707">T</span><span class="op" id="8545708">)</span>&nbsp;<span class="op" id="8545710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8545713">for</span>&nbsp;<span class="ident" id="8545717">_</span><span class="op" id="8545718">,</span>&nbsp;<span class="ident" id="8545720">tt</span>&nbsp;<span class="op" id="8545723">:=</span>&nbsp;<span class="keyword" id="8545726">range</span>&nbsp;<span class="ident" id="8545732">encodeQueryTests</span>&nbsp;<span class="op" id="8545749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8545753">if</span>&nbsp;<span class="ident" id="8545756">q</span>&nbsp;<span class="op" id="8545758">:=</span>&nbsp;<span class="ident" id="8545761">tt</span><span class="op" id="8545763">.</span><span class="ident" id="8545764">m</span><span class="op" id="8545765">.</span><span class="ident" id="8545766">Encode</span><span class="op" id="8545772">(</span><span class="op" id="8545773">)</span><span class="op" id="8545774">;</span>&nbsp;<span class="ident" id="8545776">q</span>&nbsp;<span class="op" id="8545778">!=</span>&nbsp;<span class="ident" id="8545781">tt</span><span class="op" id="8545783">.</span><span class="ident" id="8545784">expected</span>&nbsp;<span class="op" id="8545793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8545798">t</span><span class="op" id="8545799">.</span><span class="ident" id="8545800">Errorf</span><span class="op" id="8545806">(</span><span class="string" id="8545807">`EncodeQuery(%+v)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q`</span><span class="op" id="8545839">,</span>&nbsp;<span class="ident" id="8545841">tt</span><span class="op" id="8545843">.</span><span class="ident" id="8545844">m</span><span class="op" id="8545845">,</span>&nbsp;<span class="ident" id="8545847">q</span><span class="op" id="8545848">,</span>&nbsp;<span class="ident" id="8545850">tt</span><span class="op" id="8545852">.</span><span class="ident" id="8545853">expected</span><span class="op" id="8545861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8545865">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8545868">}</span><br>
<span class="lineno"></span><span class="op" id="8545870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8545873">var</span>&nbsp;<span class="ident" id="8545877">resolvePathTests</span>&nbsp;<span class="op" id="8545894">=</span>&nbsp;<span class="op" id="8545896">[</span><span class="op" id="8545897">]</span><span class="keyword" id="8545898">struct</span>&nbsp;<span class="op" id="8545905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8545908">base</span><span class="op" id="8545912">,</span>&nbsp;<span class="ident" id="8545914">ref</span><span class="op" id="8545917">,</span>&nbsp;<span class="ident" id="8545919">expected</span>&nbsp;<span class="builtintype" id="8545928">string</span><br>
<span class="lineno">570</span><span class="op" id="8545935">}</span><span class="op" id="8545936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8545939">{</span><span class="string" id="8545940">&#34;a/b&#34;</span><span class="op" id="8545945">,</span>&nbsp;<span class="string" id="8545947">&#34;.&#34;</span><span class="op" id="8545950">,</span>&nbsp;<span class="string" id="8545952">&#34;/a/&#34;</span><span class="op" id="8545957">}</span><span class="op" id="8545958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8545961">{</span><span class="string" id="8545962">&#34;a/b&#34;</span><span class="op" id="8545967">,</span>&nbsp;<span class="string" id="8545969">&#34;c&#34;</span><span class="op" id="8545972">,</span>&nbsp;<span class="string" id="8545974">&#34;/a/c&#34;</span><span class="op" id="8545980">}</span><span class="op" id="8545981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8545984">{</span><span class="string" id="8545985">&#34;a/b&#34;</span><span class="op" id="8545990">,</span>&nbsp;<span class="string" id="8545992">&#34;..&#34;</span><span class="op" id="8545996">,</span>&nbsp;<span class="string" id="8545998">&#34;/&#34;</span><span class="op" id="8546001">}</span><span class="op" id="8546002">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8546005">{</span><span class="string" id="8546006">&#34;a/&#34;</span><span class="op" id="8546010">,</span>&nbsp;<span class="string" id="8546012">&#34;..&#34;</span><span class="op" id="8546016">,</span>&nbsp;<span class="string" id="8546018">&#34;/&#34;</span><span class="op" id="8546021">}</span><span class="op" id="8546022">,</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8546025">{</span><span class="string" id="8546026">&#34;a/&#34;</span><span class="op" id="8546030">,</span>&nbsp;<span class="string" id="8546032">&#34;../..&#34;</span><span class="op" id="8546039">,</span>&nbsp;<span class="string" id="8546041">&#34;/&#34;</span><span class="op" id="8546044">}</span><span class="op" id="8546045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8546048">{</span><span class="string" id="8546049">&#34;a/b/c&#34;</span><span class="op" id="8546056">,</span>&nbsp;<span class="string" id="8546058">&#34;..&#34;</span><span class="op" id="8546062">,</span>&nbsp;<span class="string" id="8546064">&#34;/a/&#34;</span><span class="op" id="8546069">}</span><span class="op" id="8546070">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8546073">{</span><span class="string" id="8546074">&#34;a/b/c&#34;</span><span class="op" id="8546081">,</span>&nbsp;<span class="string" id="8546083">&#34;../d&#34;</span><span class="op" id="8546089">,</span>&nbsp;<span class="string" id="8546091">&#34;/a/d&#34;</span><span class="op" id="8546097">}</span><span class="op" id="8546098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8546101">{</span><span class="string" id="8546102">&#34;a/b/c&#34;</span><span class="op" id="8546109">,</span>&nbsp;<span class="string" id="8546111">&#34;.././d&#34;</span><span class="op" id="8546119">,</span>&nbsp;<span class="string" id="8546121">&#34;/a/d&#34;</span><span class="op" id="8546127">}</span><span class="op" id="8546128">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8546131">{</span><span class="string" id="8546132">&#34;a/b&#34;</span><span class="op" id="8546137">,</span>&nbsp;<span class="string" id="8546139">&#34;./..&#34;</span><span class="op" id="8546145">,</span>&nbsp;<span class="string" id="8546147">&#34;/&#34;</span><span class="op" id="8546150">}</span><span class="op" id="8546151">,</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8546154">{</span><span class="string" id="8546155">&#34;a/./b&#34;</span><span class="op" id="8546162">,</span>&nbsp;<span class="string" id="8546164">&#34;.&#34;</span><span class="op" id="8546167">,</span>&nbsp;<span class="string" id="8546169">&#34;/a/&#34;</span><span class="op" id="8546174">}</span><span class="op" id="8546175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8546178">{</span><span class="string" id="8546179">&#34;a/../&#34;</span><span class="op" id="8546186">,</span>&nbsp;<span class="string" id="8546188">&#34;.&#34;</span><span class="op" id="8546191">,</span>&nbsp;<span class="string" id="8546193">&#34;/&#34;</span><span class="op" id="8546196">}</span><span class="op" id="8546197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8546200">{</span><span class="string" id="8546201">&#34;a/.././b&#34;</span><span class="op" id="8546211">,</span>&nbsp;<span class="string" id="8546213">&#34;c&#34;</span><span class="op" id="8546216">,</span>&nbsp;<span class="string" id="8546218">&#34;/c&#34;</span><span class="op" id="8546222">}</span><span class="op" id="8546223">,</span><br>
<span class="lineno"></span><span class="op" id="8546225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="keyword" id="8546228">func</span>&nbsp;<span class="ident" id="8546233">TestResolvePath</span><span class="op" id="8546248">(</span><span class="ident" id="8546249">t</span>&nbsp;<span class="op" id="8546251">*</span><span class="ident" id="8546252">testing</span><span class="op" id="8546259">.</span><span class="ident" id="8546260">T</span><span class="op" id="8546261">)</span>&nbsp;<span class="op" id="8546263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8546266">for</span>&nbsp;<span class="ident" id="8546270">_</span><span class="op" id="8546271">,</span>&nbsp;<span class="ident" id="8546273">test</span>&nbsp;<span class="op" id="8546278">:=</span>&nbsp;<span class="keyword" id="8546281">range</span>&nbsp;<span class="ident" id="8546287">resolvePathTests</span>&nbsp;<span class="op" id="8546304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8546308">got</span>&nbsp;<span class="op" id="8546312">:=</span>&nbsp;<span class="ident" id="8546315">resolvePath</span><span class="op" id="8546326">(</span><span class="ident" id="8546327">test</span><span class="op" id="8546331">.</span><span class="ident" id="8546332">base</span><span class="op" id="8546336">,</span>&nbsp;<span class="ident" id="8546338">test</span><span class="op" id="8546342">.</span><span class="ident" id="8546343">ref</span><span class="op" id="8546346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8546350">if</span>&nbsp;<span class="ident" id="8546353">got</span>&nbsp;<span class="op" id="8546357">!=</span>&nbsp;<span class="ident" id="8546360">test</span><span class="op" id="8546364">.</span><span class="ident" id="8546365">expected</span>&nbsp;<span class="op" id="8546374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8546379">t</span><span class="op" id="8546380">.</span><span class="ident" id="8546381">Errorf</span><span class="op" id="8546387">(</span><span class="string" id="8546388">&#34;For&nbsp;%q&nbsp;+&nbsp;%q&nbsp;got&nbsp;%q;&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="8546421">,</span>&nbsp;<span class="ident" id="8546423">test</span><span class="op" id="8546427">.</span><span class="ident" id="8546428">base</span><span class="op" id="8546432">,</span>&nbsp;<span class="ident" id="8546434">test</span><span class="op" id="8546438">.</span><span class="ident" id="8546439">ref</span><span class="op" id="8546442">,</span>&nbsp;<span class="ident" id="8546444">got</span><span class="op" id="8546447">,</span>&nbsp;<span class="ident" id="8546449">test</span><span class="op" id="8546453">.</span><span class="ident" id="8546454">expected</span><span class="op" id="8546462">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8546466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8546469">}</span><br>
<span class="lineno"></span><span class="op" id="8546471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8546474">var</span>&nbsp;<span class="ident" id="8546478">resolveReferenceTests</span>&nbsp;<span class="op" id="8546500">=</span>&nbsp;<span class="op" id="8546502">[</span><span class="op" id="8546503">]</span><span class="keyword" id="8546504">struct</span>&nbsp;<span class="op" id="8546511">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8546514">base</span><span class="op" id="8546518">,</span>&nbsp;<span class="ident" id="8546520">rel</span><span class="op" id="8546523">,</span>&nbsp;<span class="ident" id="8546525">expected</span>&nbsp;<span class="builtintype" id="8546534">string</span><br>
<span class="lineno"></span><span class="op" id="8546541">}</span><span class="op" id="8546542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8546545">//&nbsp;Absolute&nbsp;URL&nbsp;references</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8546573">{</span><span class="string" id="8546574">&#34;http://foo.com?a=b&#34;</span><span class="op" id="8546594">,</span>&nbsp;<span class="string" id="8546596">&#34;https://bar.com/&#34;</span><span class="op" id="8546614">,</span>&nbsp;<span class="string" id="8546616">&#34;https://bar.com/&#34;</span><span class="op" id="8546634">}</span><span class="op" id="8546635">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8546638">{</span><span class="string" id="8546639">&#34;http://foo.com/&#34;</span><span class="op" id="8546656">,</span>&nbsp;<span class="string" id="8546658">&#34;https://bar.com/?a=b&#34;</span><span class="op" id="8546680">,</span>&nbsp;<span class="string" id="8546682">&#34;https://bar.com/?a=b&#34;</span><span class="op" id="8546704">}</span><span class="op" id="8546705">,</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8546708">{</span><span class="string" id="8546709">&#34;http://foo.com/bar&#34;</span><span class="op" id="8546729">,</span>&nbsp;<span class="string" id="8546731">&#34;mailto:foo@example.com&#34;</span><span class="op" id="8546755">,</span>&nbsp;<span class="string" id="8546757">&#34;mailto:foo@example.com&#34;</span><span class="op" id="8546781">}</span><span class="op" id="8546782">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8546786">//&nbsp;Path-absolute&nbsp;references</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8546815">{</span><span class="string" id="8546816">&#34;http://foo.com/bar&#34;</span><span class="op" id="8546836">,</span>&nbsp;<span class="string" id="8546838">&#34;/baz&#34;</span><span class="op" id="8546844">,</span>&nbsp;<span class="string" id="8546846">&#34;http://foo.com/baz&#34;</span><span class="op" id="8546866">}</span><span class="op" id="8546867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8546870">{</span><span class="string" id="8546871">&#34;http://foo.com/bar?a=b#f&#34;</span><span class="op" id="8546897">,</span>&nbsp;<span class="string" id="8546899">&#34;/baz&#34;</span><span class="op" id="8546905">,</span>&nbsp;<span class="string" id="8546907">&#34;http://foo.com/baz&#34;</span><span class="op" id="8546927">}</span><span class="op" id="8546928">,</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8546931">{</span><span class="string" id="8546932">&#34;http://foo.com/bar?a=b&#34;</span><span class="op" id="8546956">,</span>&nbsp;<span class="string" id="8546958">&#34;/baz?c=d&#34;</span><span class="op" id="8546968">,</span>&nbsp;<span class="string" id="8546970">&#34;http://foo.com/baz?c=d&#34;</span><span class="op" id="8546994">}</span><span class="op" id="8546995">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8546999">//&nbsp;Scheme-relative</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8547019">{</span><span class="string" id="8547020">&#34;https://foo.com/bar?a=b&#34;</span><span class="op" id="8547045">,</span>&nbsp;<span class="string" id="8547047">&#34;//bar.com/quux&#34;</span><span class="op" id="8547063">,</span>&nbsp;<span class="string" id="8547065">&#34;https://bar.com/quux&#34;</span><span class="op" id="8547087">}</span><span class="op" id="8547088">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8547092">//&nbsp;Path-relative&nbsp;references:</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8547123">//&nbsp;...&nbsp;current&nbsp;directory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8547149">{</span><span class="string" id="8547150">&#34;http://foo.com&#34;</span><span class="op" id="8547166">,</span>&nbsp;<span class="string" id="8547168">&#34;.&#34;</span><span class="op" id="8547171">,</span>&nbsp;<span class="string" id="8547173">&#34;http://foo.com/&#34;</span><span class="op" id="8547190">}</span><span class="op" id="8547191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8547194">{</span><span class="string" id="8547195">&#34;http://foo.com/bar&#34;</span><span class="op" id="8547215">,</span>&nbsp;<span class="string" id="8547217">&#34;.&#34;</span><span class="op" id="8547220">,</span>&nbsp;<span class="string" id="8547222">&#34;http://foo.com/&#34;</span><span class="op" id="8547239">}</span><span class="op" id="8547240">,</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8547243">{</span><span class="string" id="8547244">&#34;http://foo.com/bar/&#34;</span><span class="op" id="8547265">,</span>&nbsp;<span class="string" id="8547267">&#34;.&#34;</span><span class="op" id="8547270">,</span>&nbsp;<span class="string" id="8547272">&#34;http://foo.com/bar/&#34;</span><span class="op" id="8547293">}</span><span class="op" id="8547294">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8547298">//&nbsp;...&nbsp;going&nbsp;down</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8547317">{</span><span class="string" id="8547318">&#34;http://foo.com&#34;</span><span class="op" id="8547334">,</span>&nbsp;<span class="string" id="8547336">&#34;bar&#34;</span><span class="op" id="8547341">,</span>&nbsp;<span class="string" id="8547343">&#34;http://foo.com/bar&#34;</span><span class="op" id="8547363">}</span><span class="op" id="8547364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8547367">{</span><span class="string" id="8547368">&#34;http://foo.com/&#34;</span><span class="op" id="8547385">,</span>&nbsp;<span class="string" id="8547387">&#34;bar&#34;</span><span class="op" id="8547392">,</span>&nbsp;<span class="string" id="8547394">&#34;http://foo.com/bar&#34;</span><span class="op" id="8547414">}</span><span class="op" id="8547415">,</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8547418">{</span><span class="string" id="8547419">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8547443">,</span>&nbsp;<span class="string" id="8547445">&#34;quux&#34;</span><span class="op" id="8547451">,</span>&nbsp;<span class="string" id="8547453">&#34;http://foo.com/bar/quux&#34;</span><span class="op" id="8547478">}</span><span class="op" id="8547479">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8547483">//&nbsp;...&nbsp;going&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8547500">{</span><span class="string" id="8547501">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8547525">,</span>&nbsp;<span class="string" id="8547527">&#34;../quux&#34;</span><span class="op" id="8547536">,</span>&nbsp;<span class="string" id="8547538">&#34;http://foo.com/quux&#34;</span><span class="op" id="8547559">}</span><span class="op" id="8547560">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8547563">{</span><span class="string" id="8547564">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8547588">,</span>&nbsp;<span class="string" id="8547590">&#34;../../../../../quux&#34;</span><span class="op" id="8547611">,</span>&nbsp;<span class="string" id="8547613">&#34;http://foo.com/quux&#34;</span><span class="op" id="8547634">}</span><span class="op" id="8547635">,</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8547638">{</span><span class="string" id="8547639">&#34;http://foo.com/bar&#34;</span><span class="op" id="8547659">,</span>&nbsp;<span class="string" id="8547661">&#34;..&#34;</span><span class="op" id="8547665">,</span>&nbsp;<span class="string" id="8547667">&#34;http://foo.com/&#34;</span><span class="op" id="8547684">}</span><span class="op" id="8547685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8547688">{</span><span class="string" id="8547689">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8547713">,</span>&nbsp;<span class="string" id="8547715">&#34;./..&#34;</span><span class="op" id="8547721">,</span>&nbsp;<span class="string" id="8547723">&#34;http://foo.com/&#34;</span><span class="op" id="8547740">}</span><span class="op" id="8547741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8547744">//&nbsp;&#34;..&#34;&nbsp;in&nbsp;the&nbsp;middle&nbsp;(issue&nbsp;3560)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8547780">{</span><span class="string" id="8547781">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8547805">,</span>&nbsp;<span class="string" id="8547807">&#34;quux/dotdot/../tail&#34;</span><span class="op" id="8547828">,</span>&nbsp;<span class="string" id="8547830">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="8547860">}</span><span class="op" id="8547861">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8547864">{</span><span class="string" id="8547865">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8547889">,</span>&nbsp;<span class="string" id="8547891">&#34;quux/./dotdot/../tail&#34;</span><span class="op" id="8547914">,</span>&nbsp;<span class="string" id="8547916">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="8547946">}</span><span class="op" id="8547947">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8547950">{</span><span class="string" id="8547951">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8547975">,</span>&nbsp;<span class="string" id="8547977">&#34;quux/./dotdot/.././tail&#34;</span><span class="op" id="8548002">,</span>&nbsp;<span class="string" id="8548004">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="8548034">}</span><span class="op" id="8548035">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8548038">{</span><span class="string" id="8548039">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8548063">,</span>&nbsp;<span class="string" id="8548065">&#34;quux/./dotdot/./../tail&#34;</span><span class="op" id="8548090">,</span>&nbsp;<span class="string" id="8548092">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="8548122">}</span><span class="op" id="8548123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8548126">{</span><span class="string" id="8548127">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8548151">,</span>&nbsp;<span class="string" id="8548153">&#34;quux/./dotdot/dotdot/././../../tail&#34;</span><span class="op" id="8548190">,</span>&nbsp;<span class="string" id="8548192">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="8548222">}</span><span class="op" id="8548223">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8548226">{</span><span class="string" id="8548227">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8548251">,</span>&nbsp;<span class="string" id="8548253">&#34;quux/./dotdot/dotdot/./.././../tail&#34;</span><span class="op" id="8548290">,</span>&nbsp;<span class="string" id="8548292">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="8548322">}</span><span class="op" id="8548323">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8548326">{</span><span class="string" id="8548327">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8548351">,</span>&nbsp;<span class="string" id="8548353">&#34;quux/./dotdot/dotdot/dotdot/./../../.././././tail&#34;</span><span class="op" id="8548404">,</span>&nbsp;<span class="string" id="8548406">&#34;http://foo.com/bar/quux/tail&#34;</span><span class="op" id="8548436">}</span><span class="op" id="8548437">,</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8548440">{</span><span class="string" id="8548441">&#34;http://foo.com/bar/baz&#34;</span><span class="op" id="8548465">,</span>&nbsp;<span class="string" id="8548467">&#34;quux/./dotdot/../dotdot/../dot/./tail/..&#34;</span><span class="op" id="8548509">,</span>&nbsp;<span class="string" id="8548511">&#34;http://foo.com/bar/quux/dot/&#34;</span><span class="op" id="8548541">}</span><span class="op" id="8548542">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8548546">//&nbsp;Remove&nbsp;any&nbsp;dot-segments&nbsp;prior&nbsp;to&nbsp;forming&nbsp;the&nbsp;target&nbsp;URI.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8548607">//&nbsp;http://tools.ietf.org/html/rfc3986#section-5.2.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8548660">{</span><span class="string" id="8548661">&#34;http://foo.com/dot/./dotdot/../foo/bar&#34;</span><span class="op" id="8548701">,</span>&nbsp;<span class="string" id="8548703">&#34;../baz&#34;</span><span class="op" id="8548711">,</span>&nbsp;<span class="string" id="8548713">&#34;http://foo.com/dot/baz&#34;</span><span class="op" id="8548737">}</span><span class="op" id="8548738">,</span><br>
<span class="lineno">640</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8548742">//&nbsp;Triple&nbsp;dot&nbsp;isn&#39;t&nbsp;special</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8548771">{</span><span class="string" id="8548772">&#34;http://foo.com/bar&#34;</span><span class="op" id="8548792">,</span>&nbsp;<span class="string" id="8548794">&#34;...&#34;</span><span class="op" id="8548799">,</span>&nbsp;<span class="string" id="8548801">&#34;http://foo.com/...&#34;</span><span class="op" id="8548821">}</span><span class="op" id="8548822">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8548826">//&nbsp;Fragment</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8548839">{</span><span class="string" id="8548840">&#34;http://foo.com/bar&#34;</span><span class="op" id="8548860">,</span>&nbsp;<span class="string" id="8548862">&#34;.#frag&#34;</span><span class="op" id="8548870">,</span>&nbsp;<span class="string" id="8548872">&#34;http://foo.com/#frag&#34;</span><span class="op" id="8548894">}</span><span class="op" id="8548895">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8548899">//&nbsp;RFC&nbsp;3986:&nbsp;Normal&nbsp;Examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8548929">//&nbsp;http://tools.ietf.org/html/rfc3986#section-5.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8548982">{</span><span class="string" id="8548983">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549003">,</span>&nbsp;<span class="string" id="8549005">&#34;g:h&#34;</span><span class="op" id="8549010">,</span>&nbsp;<span class="string" id="8549012">&#34;g:h&#34;</span><span class="op" id="8549017">}</span><span class="op" id="8549018">,</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549021">{</span><span class="string" id="8549022">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549042">,</span>&nbsp;<span class="string" id="8549044">&#34;g&#34;</span><span class="op" id="8549047">,</span>&nbsp;<span class="string" id="8549049">&#34;http://a/b/c/g&#34;</span><span class="op" id="8549065">}</span><span class="op" id="8549066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549069">{</span><span class="string" id="8549070">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549090">,</span>&nbsp;<span class="string" id="8549092">&#34;./g&#34;</span><span class="op" id="8549097">,</span>&nbsp;<span class="string" id="8549099">&#34;http://a/b/c/g&#34;</span><span class="op" id="8549115">}</span><span class="op" id="8549116">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549119">{</span><span class="string" id="8549120">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549140">,</span>&nbsp;<span class="string" id="8549142">&#34;g/&#34;</span><span class="op" id="8549146">,</span>&nbsp;<span class="string" id="8549148">&#34;http://a/b/c/g/&#34;</span><span class="op" id="8549165">}</span><span class="op" id="8549166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549169">{</span><span class="string" id="8549170">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549190">,</span>&nbsp;<span class="string" id="8549192">&#34;/g&#34;</span><span class="op" id="8549196">,</span>&nbsp;<span class="string" id="8549198">&#34;http://a/g&#34;</span><span class="op" id="8549210">}</span><span class="op" id="8549211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549214">{</span><span class="string" id="8549215">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549235">,</span>&nbsp;<span class="string" id="8549237">&#34;//g&#34;</span><span class="op" id="8549242">,</span>&nbsp;<span class="string" id="8549244">&#34;http://g&#34;</span><span class="op" id="8549254">}</span><span class="op" id="8549255">,</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549258">{</span><span class="string" id="8549259">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549279">,</span>&nbsp;<span class="string" id="8549281">&#34;?y&#34;</span><span class="op" id="8549285">,</span>&nbsp;<span class="string" id="8549287">&#34;http://a/b/c/d;p?y&#34;</span><span class="op" id="8549307">}</span><span class="op" id="8549308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549311">{</span><span class="string" id="8549312">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549332">,</span>&nbsp;<span class="string" id="8549334">&#34;g?y&#34;</span><span class="op" id="8549339">,</span>&nbsp;<span class="string" id="8549341">&#34;http://a/b/c/g?y&#34;</span><span class="op" id="8549359">}</span><span class="op" id="8549360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549363">{</span><span class="string" id="8549364">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549384">,</span>&nbsp;<span class="string" id="8549386">&#34;#s&#34;</span><span class="op" id="8549390">,</span>&nbsp;<span class="string" id="8549392">&#34;http://a/b/c/d;p?q#s&#34;</span><span class="op" id="8549414">}</span><span class="op" id="8549415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549418">{</span><span class="string" id="8549419">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549439">,</span>&nbsp;<span class="string" id="8549441">&#34;g#s&#34;</span><span class="op" id="8549446">,</span>&nbsp;<span class="string" id="8549448">&#34;http://a/b/c/g#s&#34;</span><span class="op" id="8549466">}</span><span class="op" id="8549467">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549470">{</span><span class="string" id="8549471">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549491">,</span>&nbsp;<span class="string" id="8549493">&#34;g?y#s&#34;</span><span class="op" id="8549500">,</span>&nbsp;<span class="string" id="8549502">&#34;http://a/b/c/g?y#s&#34;</span><span class="op" id="8549522">}</span><span class="op" id="8549523">,</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549526">{</span><span class="string" id="8549527">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549547">,</span>&nbsp;<span class="string" id="8549549">&#34;;x&#34;</span><span class="op" id="8549553">,</span>&nbsp;<span class="string" id="8549555">&#34;http://a/b/c/;x&#34;</span><span class="op" id="8549572">}</span><span class="op" id="8549573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549576">{</span><span class="string" id="8549577">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549597">,</span>&nbsp;<span class="string" id="8549599">&#34;g;x&#34;</span><span class="op" id="8549604">,</span>&nbsp;<span class="string" id="8549606">&#34;http://a/b/c/g;x&#34;</span><span class="op" id="8549624">}</span><span class="op" id="8549625">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549628">{</span><span class="string" id="8549629">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549649">,</span>&nbsp;<span class="string" id="8549651">&#34;g;x?y#s&#34;</span><span class="op" id="8549660">,</span>&nbsp;<span class="string" id="8549662">&#34;http://a/b/c/g;x?y#s&#34;</span><span class="op" id="8549684">}</span><span class="op" id="8549685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549688">{</span><span class="string" id="8549689">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549709">,</span>&nbsp;<span class="string" id="8549711">&#34;&#34;</span><span class="op" id="8549713">,</span>&nbsp;<span class="string" id="8549715">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549735">}</span><span class="op" id="8549736">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549739">{</span><span class="string" id="8549740">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549760">,</span>&nbsp;<span class="string" id="8549762">&#34;.&#34;</span><span class="op" id="8549765">,</span>&nbsp;<span class="string" id="8549767">&#34;http://a/b/c/&#34;</span><span class="op" id="8549782">}</span><span class="op" id="8549783">,</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549786">{</span><span class="string" id="8549787">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549807">,</span>&nbsp;<span class="string" id="8549809">&#34;./&#34;</span><span class="op" id="8549813">,</span>&nbsp;<span class="string" id="8549815">&#34;http://a/b/c/&#34;</span><span class="op" id="8549830">}</span><span class="op" id="8549831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549834">{</span><span class="string" id="8549835">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549855">,</span>&nbsp;<span class="string" id="8549857">&#34;..&#34;</span><span class="op" id="8549861">,</span>&nbsp;<span class="string" id="8549863">&#34;http://a/b/&#34;</span><span class="op" id="8549876">}</span><span class="op" id="8549877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549880">{</span><span class="string" id="8549881">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549901">,</span>&nbsp;<span class="string" id="8549903">&#34;../&#34;</span><span class="op" id="8549908">,</span>&nbsp;<span class="string" id="8549910">&#34;http://a/b/&#34;</span><span class="op" id="8549923">}</span><span class="op" id="8549924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549927">{</span><span class="string" id="8549928">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549948">,</span>&nbsp;<span class="string" id="8549950">&#34;../g&#34;</span><span class="op" id="8549956">,</span>&nbsp;<span class="string" id="8549958">&#34;http://a/b/g&#34;</span><span class="op" id="8549972">}</span><span class="op" id="8549973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8549976">{</span><span class="string" id="8549977">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8549997">,</span>&nbsp;<span class="string" id="8549999">&#34;../..&#34;</span><span class="op" id="8550006">,</span>&nbsp;<span class="string" id="8550008">&#34;http://a/&#34;</span><span class="op" id="8550019">}</span><span class="op" id="8550020">,</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8550023">{</span><span class="string" id="8550024">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8550044">,</span>&nbsp;<span class="string" id="8550046">&#34;../../&#34;</span><span class="op" id="8550054">,</span>&nbsp;<span class="string" id="8550056">&#34;http://a/&#34;</span><span class="op" id="8550067">}</span><span class="op" id="8550068">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8550071">{</span><span class="string" id="8550072">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8550092">,</span>&nbsp;<span class="string" id="8550094">&#34;../../g&#34;</span><span class="op" id="8550103">,</span>&nbsp;<span class="string" id="8550105">&#34;http://a/g&#34;</span><span class="op" id="8550117">}</span><span class="op" id="8550118">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8550122">//&nbsp;RFC&nbsp;3986:&nbsp;Abnormal&nbsp;Examples</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8550154">//&nbsp;http://tools.ietf.org/html/rfc3986#section-5.4.2</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8550207">{</span><span class="string" id="8550208">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8550228">,</span>&nbsp;<span class="string" id="8550230">&#34;../../../g&#34;</span><span class="op" id="8550242">,</span>&nbsp;<span class="string" id="8550244">&#34;http://a/g&#34;</span><span class="op" id="8550256">}</span><span class="op" id="8550257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8550260">{</span><span class="string" id="8550261">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8550281">,</span>&nbsp;<span class="string" id="8550283">&#34;../../../../g&#34;</span><span class="op" id="8550298">,</span>&nbsp;<span class="string" id="8550300">&#34;http://a/g&#34;</span><span class="op" id="8550312">}</span><span class="op" id="8550313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8550316">{</span><span class="string" id="8550317">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8550337">,</span>&nbsp;<span class="string" id="8550339">&#34;/./g&#34;</span><span class="op" id="8550345">,</span>&nbsp;<span class="string" id="8550347">&#34;http://a/g&#34;</span><span class="op" id="8550359">}</span><span class="op" id="8550360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8550363">{</span><span class="string" id="8550364">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8550384">,</span>&nbsp;<span class="string" id="8550386">&#34;/../g&#34;</span><span class="op" id="8550393">,</span>&nbsp;<span class="string" id="8550395">&#34;http://a/g&#34;</span><span class="op" id="8550407">}</span><span class="op" id="8550408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8550411">{</span><span class="string" id="8550412">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8550432">,</span>&nbsp;<span class="string" id="8550434">&#34;g.&#34;</span><span class="op" id="8550438">,</span>&nbsp;<span class="string" id="8550440">&#34;http://a/b/c/g.&#34;</span><span class="op" id="8550457">}</span><span class="op" id="8550458">,</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8550461">{</span><span class="string" id="8550462">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8550482">,</span>&nbsp;<span class="string" id="8550484">&#34;.g&#34;</span><span class="op" id="8550488">,</span>&nbsp;<span class="string" id="8550490">&#34;http://a/b/c/.g&#34;</span><span class="op" id="8550507">}</span><span class="op" id="8550508">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8550511">{</span><span class="string" id="8550512">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8550532">,</span>&nbsp;<span class="string" id="8550534">&#34;g..&#34;</span><span class="op" id="8550539">,</span>&nbsp;<span class="string" id="8550541">&#34;http://a/b/c/g..&#34;</span><span class="op" id="8550559">}</span><span class="op" id="8550560">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8550563">{</span><span class="string" id="8550564">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8550584">,</span>&nbsp;<span class="string" id="8550586">&#34;..g&#34;</span><span class="op" id="8550591">,</span>&nbsp;<span class="string" id="8550593">&#34;http://a/b/c/..g&#34;</span><span class="op" id="8550611">}</span><span class="op" id="8550612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8550615">{</span><span class="string" id="8550616">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8550636">,</span>&nbsp;<span class="string" id="8550638">&#34;./../g&#34;</span><span class="op" id="8550646">,</span>&nbsp;<span class="string" id="8550648">&#34;http://a/b/g&#34;</span><span class="op" id="8550662">}</span><span class="op" id="8550663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8550666">{</span><span class="string" id="8550667">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8550687">,</span>&nbsp;<span class="string" id="8550689">&#34;./g/.&#34;</span><span class="op" id="8550696">,</span>&nbsp;<span class="string" id="8550698">&#34;http://a/b/c/g/&#34;</span><span class="op" id="8550715">}</span><span class="op" id="8550716">,</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8550719">{</span><span class="string" id="8550720">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8550740">,</span>&nbsp;<span class="string" id="8550742">&#34;g/./h&#34;</span><span class="op" id="8550749">,</span>&nbsp;<span class="string" id="8550751">&#34;http://a/b/c/g/h&#34;</span><span class="op" id="8550769">}</span><span class="op" id="8550770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8550773">{</span><span class="string" id="8550774">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8550794">,</span>&nbsp;<span class="string" id="8550796">&#34;g/../h&#34;</span><span class="op" id="8550804">,</span>&nbsp;<span class="string" id="8550806">&#34;http://a/b/c/h&#34;</span><span class="op" id="8550822">}</span><span class="op" id="8550823">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8550826">{</span><span class="string" id="8550827">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8550847">,</span>&nbsp;<span class="string" id="8550849">&#34;g;x=1/./y&#34;</span><span class="op" id="8550860">,</span>&nbsp;<span class="string" id="8550862">&#34;http://a/b/c/g;x=1/y&#34;</span><span class="op" id="8550884">}</span><span class="op" id="8550885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8550888">{</span><span class="string" id="8550889">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8550909">,</span>&nbsp;<span class="string" id="8550911">&#34;g;x=1/../y&#34;</span><span class="op" id="8550923">,</span>&nbsp;<span class="string" id="8550925">&#34;http://a/b/c/y&#34;</span><span class="op" id="8550941">}</span><span class="op" id="8550942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8550945">{</span><span class="string" id="8550946">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8550966">,</span>&nbsp;<span class="string" id="8550968">&#34;g?y/./x&#34;</span><span class="op" id="8550977">,</span>&nbsp;<span class="string" id="8550979">&#34;http://a/b/c/g?y/./x&#34;</span><span class="op" id="8551001">}</span><span class="op" id="8551002">,</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8551005">{</span><span class="string" id="8551006">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8551026">,</span>&nbsp;<span class="string" id="8551028">&#34;g?y/../x&#34;</span><span class="op" id="8551038">,</span>&nbsp;<span class="string" id="8551040">&#34;http://a/b/c/g?y/../x&#34;</span><span class="op" id="8551063">}</span><span class="op" id="8551064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8551067">{</span><span class="string" id="8551068">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8551088">,</span>&nbsp;<span class="string" id="8551090">&#34;g#s/./x&#34;</span><span class="op" id="8551099">,</span>&nbsp;<span class="string" id="8551101">&#34;http://a/b/c/g#s/./x&#34;</span><span class="op" id="8551123">}</span><span class="op" id="8551124">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8551127">{</span><span class="string" id="8551128">&#34;http://a/b/c/d;p?q&#34;</span><span class="op" id="8551148">,</span>&nbsp;<span class="string" id="8551150">&#34;g#s/../x&#34;</span><span class="op" id="8551160">,</span>&nbsp;<span class="string" id="8551162">&#34;http://a/b/c/g#s/../x&#34;</span><span class="op" id="8551185">}</span><span class="op" id="8551186">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8551190">//&nbsp;Extras.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8551202">{</span><span class="string" id="8551203">&#34;https://a/b/c/d;p?q&#34;</span><span class="op" id="8551224">,</span>&nbsp;<span class="string" id="8551226">&#34;//g?q&#34;</span><span class="op" id="8551233">,</span>&nbsp;<span class="string" id="8551235">&#34;https://g?q&#34;</span><span class="op" id="8551248">}</span><span class="op" id="8551249">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8551252">{</span><span class="string" id="8551253">&#34;https://a/b/c/d;p?q&#34;</span><span class="op" id="8551274">,</span>&nbsp;<span class="string" id="8551276">&#34;//g#s&#34;</span><span class="op" id="8551283">,</span>&nbsp;<span class="string" id="8551285">&#34;https://g#s&#34;</span><span class="op" id="8551298">}</span><span class="op" id="8551299">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8551302">{</span><span class="string" id="8551303">&#34;https://a/b/c/d;p?q&#34;</span><span class="op" id="8551324">,</span>&nbsp;<span class="string" id="8551326">&#34;//g/d/e/f?y#s&#34;</span><span class="op" id="8551341">,</span>&nbsp;<span class="string" id="8551343">&#34;https://g/d/e/f?y#s&#34;</span><span class="op" id="8551364">}</span><span class="op" id="8551365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8551368">{</span><span class="string" id="8551369">&#34;https://a/b/c/d;p#s&#34;</span><span class="op" id="8551390">,</span>&nbsp;<span class="string" id="8551392">&#34;?y&#34;</span><span class="op" id="8551396">,</span>&nbsp;<span class="string" id="8551398">&#34;https://a/b/c/d;p?y&#34;</span><span class="op" id="8551419">}</span><span class="op" id="8551420">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8551423">{</span><span class="string" id="8551424">&#34;https://a/b/c/d;p?q#s&#34;</span><span class="op" id="8551447">,</span>&nbsp;<span class="string" id="8551449">&#34;?y&#34;</span><span class="op" id="8551453">,</span>&nbsp;<span class="string" id="8551455">&#34;https://a/b/c/d;p?y&#34;</span><span class="op" id="8551476">}</span><span class="op" id="8551477">,</span><br>
<span class="lineno">700</span><span class="op" id="8551479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8551482">func</span>&nbsp;<span class="ident" id="8551487">TestResolveReference</span><span class="op" id="8551507">(</span><span class="ident" id="8551508">t</span>&nbsp;<span class="op" id="8551510">*</span><span class="ident" id="8551511">testing</span><span class="op" id="8551518">.</span><span class="ident" id="8551519">T</span><span class="op" id="8551520">)</span>&nbsp;<span class="op" id="8551522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8551525">mustParse</span>&nbsp;<span class="op" id="8551535">:=</span>&nbsp;<span class="keyword" id="8551538">func</span><span class="op" id="8551542">(</span><span class="ident" id="8551543">url</span>&nbsp;<span class="builtintype" id="8551547">string</span><span class="op" id="8551553">)</span>&nbsp;<span class="op" id="8551555">*</span><span class="ident" id="8551556">URL</span>&nbsp;<span class="op" id="8551560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8551564">u</span><span class="op" id="8551565">,</span>&nbsp;<span class="ident" id="8551567">err</span>&nbsp;<span class="op" id="8551571">:=</span>&nbsp;<span class="ident" id="8551574">Parse</span><span class="op" id="8551579">(</span><span class="ident" id="8551580">url</span><span class="op" id="8551583">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8551587">if</span>&nbsp;<span class="ident" id="8551590">err</span>&nbsp;<span class="op" id="8551594">!=</span>&nbsp;<span class="builtintype" id="8551597">nil</span>&nbsp;<span class="op" id="8551601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8551606">t</span><span class="op" id="8551607">.</span><span class="ident" id="8551608">Fatalf</span><span class="op" id="8551614">(</span><span class="string" id="8551615">&#34;Expected&nbsp;URL&nbsp;to&nbsp;parse:&nbsp;%q,&nbsp;got&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8551657">,</span>&nbsp;<span class="ident" id="8551659">url</span><span class="op" id="8551662">,</span>&nbsp;<span class="ident" id="8551664">err</span><span class="op" id="8551667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8551671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8551675">return</span>&nbsp;<span class="ident" id="8551682">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8551685">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8551688">opaque</span>&nbsp;<span class="op" id="8551695">:=</span>&nbsp;<span class="op" id="8551698">&amp;</span><span class="ident" id="8551699">URL</span><span class="op" id="8551702">{</span><span class="ident" id="8551703">Scheme</span><span class="op" id="8551709">:</span>&nbsp;<span class="string" id="8551711">&#34;scheme&#34;</span><span class="op" id="8551719">,</span>&nbsp;<span class="ident" id="8551721">Opaque</span><span class="op" id="8551727">:</span>&nbsp;<span class="string" id="8551729">&#34;opaque&#34;</span><span class="op" id="8551737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8551740">for</span>&nbsp;<span class="ident" id="8551744">_</span><span class="op" id="8551745">,</span>&nbsp;<span class="ident" id="8551747">test</span>&nbsp;<span class="op" id="8551752">:=</span>&nbsp;<span class="keyword" id="8551755">range</span>&nbsp;<span class="ident" id="8551761">resolveReferenceTests</span>&nbsp;<span class="op" id="8551783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8551787">base</span>&nbsp;<span class="op" id="8551792">:=</span>&nbsp;<span class="ident" id="8551795">mustParse</span><span class="op" id="8551804">(</span><span class="ident" id="8551805">test</span><span class="op" id="8551809">.</span><span class="ident" id="8551810">base</span><span class="op" id="8551814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8551818">rel</span>&nbsp;<span class="op" id="8551822">:=</span>&nbsp;<span class="ident" id="8551825">mustParse</span><span class="op" id="8551834">(</span><span class="ident" id="8551835">test</span><span class="op" id="8551839">.</span><span class="ident" id="8551840">rel</span><span class="op" id="8551843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8551847">url</span>&nbsp;<span class="op" id="8551851">:=</span>&nbsp;<span class="ident" id="8551854">base</span><span class="op" id="8551858">.</span><span class="ident" id="8551859">ResolveReference</span><span class="op" id="8551875">(</span><span class="ident" id="8551876">rel</span><span class="op" id="8551879">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8551883">if</span>&nbsp;<span class="ident" id="8551886">url</span><span class="op" id="8551889">.</span><span class="ident" id="8551890">String</span><span class="op" id="8551896">(</span><span class="op" id="8551897">)</span>&nbsp;<span class="op" id="8551899">!=</span>&nbsp;<span class="ident" id="8551902">test</span><span class="op" id="8551906">.</span><span class="ident" id="8551907">expected</span>&nbsp;<span class="op" id="8551916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8551921">t</span><span class="op" id="8551922">.</span><span class="ident" id="8551923">Errorf</span><span class="op" id="8551929">(</span><span class="string" id="8551930">&#34;URL(%q).ResolveReference(%q)&nbsp;==&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8551974">,</span>&nbsp;<span class="ident" id="8551976">test</span><span class="op" id="8551980">.</span><span class="ident" id="8551981">base</span><span class="op" id="8551985">,</span>&nbsp;<span class="ident" id="8551987">test</span><span class="op" id="8551991">.</span><span class="ident" id="8551992">rel</span><span class="op" id="8551995">,</span>&nbsp;<span class="ident" id="8551997">test</span><span class="op" id="8552001">.</span><span class="ident" id="8552002">expected</span><span class="op" id="8552010">,</span>&nbsp;<span class="ident" id="8552012">url</span><span class="op" id="8552015">.</span><span class="ident" id="8552016">String</span><span class="op" id="8552022">(</span><span class="op" id="8552023">)</span><span class="op" id="8552024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8552028">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8552032">//&nbsp;Ensure&nbsp;that&nbsp;new&nbsp;instances&nbsp;are&nbsp;returned.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8552077">if</span>&nbsp;<span class="ident" id="8552080">base</span>&nbsp;<span class="op" id="8552085">==</span>&nbsp;<span class="ident" id="8552088">url</span>&nbsp;<span class="op" id="8552092">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8552097">t</span><span class="op" id="8552098">.</span><span class="ident" id="8552099">Errorf</span><span class="op" id="8552105">(</span><span class="string" id="8552106">&#34;Expected&nbsp;URL.ResolveReference&nbsp;to&nbsp;return&nbsp;new&nbsp;URL&nbsp;instance.&#34;</span><span class="op" id="8552165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8552169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8552173">//&nbsp;Test&nbsp;the&nbsp;convenience&nbsp;wrapper&nbsp;too.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8552212">url</span><span class="op" id="8552215">,</span>&nbsp;<span class="ident" id="8552217">err</span>&nbsp;<span class="op" id="8552221">:=</span>&nbsp;<span class="ident" id="8552224">base</span><span class="op" id="8552228">.</span><span class="ident" id="8552229">Parse</span><span class="op" id="8552234">(</span><span class="ident" id="8552235">test</span><span class="op" id="8552239">.</span><span class="ident" id="8552240">rel</span><span class="op" id="8552243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8552247">if</span>&nbsp;<span class="ident" id="8552250">err</span>&nbsp;<span class="op" id="8552254">!=</span>&nbsp;<span class="builtintype" id="8552257">nil</span>&nbsp;<span class="op" id="8552261">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8552266">t</span><span class="op" id="8552267">.</span><span class="ident" id="8552268">Errorf</span><span class="op" id="8552274">(</span><span class="string" id="8552275">&#34;URL(%q).Parse(%q)&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8552305">,</span>&nbsp;<span class="ident" id="8552307">test</span><span class="op" id="8552311">.</span><span class="ident" id="8552312">base</span><span class="op" id="8552316">,</span>&nbsp;<span class="ident" id="8552318">test</span><span class="op" id="8552322">.</span><span class="ident" id="8552323">rel</span><span class="op" id="8552326">,</span>&nbsp;<span class="ident" id="8552328">err</span><span class="op" id="8552331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8552335">}</span>&nbsp;<span class="keyword" id="8552337">else</span>&nbsp;<span class="keyword" id="8552342">if</span>&nbsp;<span class="ident" id="8552345">url</span><span class="op" id="8552348">.</span><span class="ident" id="8552349">String</span><span class="op" id="8552355">(</span><span class="op" id="8552356">)</span>&nbsp;<span class="op" id="8552358">!=</span>&nbsp;<span class="ident" id="8552361">test</span><span class="op" id="8552365">.</span><span class="ident" id="8552366">expected</span>&nbsp;<span class="op" id="8552375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8552380">t</span><span class="op" id="8552381">.</span><span class="ident" id="8552382">Errorf</span><span class="op" id="8552388">(</span><span class="string" id="8552389">&#34;URL(%q).Parse(%q)&nbsp;==&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="8552422">,</span>&nbsp;<span class="ident" id="8552424">test</span><span class="op" id="8552428">.</span><span class="ident" id="8552429">base</span><span class="op" id="8552433">,</span>&nbsp;<span class="ident" id="8552435">test</span><span class="op" id="8552439">.</span><span class="ident" id="8552440">rel</span><span class="op" id="8552443">,</span>&nbsp;<span class="ident" id="8552445">test</span><span class="op" id="8552449">.</span><span class="ident" id="8552450">expected</span><span class="op" id="8552458">,</span>&nbsp;<span class="ident" id="8552460">url</span><span class="op" id="8552463">.</span><span class="ident" id="8552464">String</span><span class="op" id="8552470">(</span><span class="op" id="8552471">)</span><span class="op" id="8552472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8552476">}</span>&nbsp;<span class="keyword" id="8552478">else</span>&nbsp;<span class="keyword" id="8552483">if</span>&nbsp;<span class="ident" id="8552486">base</span>&nbsp;<span class="op" id="8552491">==</span>&nbsp;<span class="ident" id="8552494">url</span>&nbsp;<span class="op" id="8552498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8552503">//&nbsp;Ensure&nbsp;that&nbsp;new&nbsp;instances&nbsp;are&nbsp;returned&nbsp;for&nbsp;the&nbsp;wrapper&nbsp;too.</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8552569">t</span><span class="op" id="8552570">.</span><span class="ident" id="8552571">Errorf</span><span class="op" id="8552577">(</span><span class="string" id="8552578">&#34;Expected&nbsp;URL.Parse&nbsp;to&nbsp;return&nbsp;new&nbsp;URL&nbsp;instance.&#34;</span><span class="op" id="8552626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8552630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8552634">//&nbsp;Ensure&nbsp;Opaque&nbsp;resets&nbsp;the&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8552669">url</span>&nbsp;<span class="op" id="8552673">=</span>&nbsp;<span class="ident" id="8552675">base</span><span class="op" id="8552679">.</span><span class="ident" id="8552680">ResolveReference</span><span class="op" id="8552696">(</span><span class="ident" id="8552697">opaque</span><span class="op" id="8552703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8552707">if</span>&nbsp;<span class="op" id="8552710">*</span><span class="ident" id="8552711">url</span>&nbsp;<span class="op" id="8552715">!=</span>&nbsp;<span class="op" id="8552718">*</span><span class="ident" id="8552719">opaque</span>&nbsp;<span class="op" id="8552726">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8552731">t</span><span class="op" id="8552732">.</span><span class="ident" id="8552733">Errorf</span><span class="op" id="8552739">(</span><span class="string" id="8552740">&#34;ResolveReference&nbsp;failed&nbsp;to&nbsp;resolve&nbsp;opaque&nbsp;URL:&nbsp;want&nbsp;%#v,&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="8552806">,</span>&nbsp;<span class="ident" id="8552808">url</span><span class="op" id="8552811">,</span>&nbsp;<span class="ident" id="8552813">opaque</span><span class="op" id="8552819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8552823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8552827">//&nbsp;Test&nbsp;the&nbsp;convenience&nbsp;wrapper&nbsp;with&nbsp;an&nbsp;opaque&nbsp;URL&nbsp;too.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8552885">url</span><span class="op" id="8552888">,</span>&nbsp;<span class="ident" id="8552890">err</span>&nbsp;<span class="op" id="8552894">=</span>&nbsp;<span class="ident" id="8552896">base</span><span class="op" id="8552900">.</span><span class="ident" id="8552901">Parse</span><span class="op" id="8552906">(</span><span class="string" id="8552907">&#34;scheme:opaque&#34;</span><span class="op" id="8552922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8552926">if</span>&nbsp;<span class="ident" id="8552929">err</span>&nbsp;<span class="op" id="8552933">!=</span>&nbsp;<span class="builtintype" id="8552936">nil</span>&nbsp;<span class="op" id="8552940">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8552945">t</span><span class="op" id="8552946">.</span><span class="ident" id="8552947">Errorf</span><span class="op" id="8552953">(</span><span class="string" id="8552954">`URL(%q).Parse(&#34;scheme:opaque&#34;)&nbsp;failed:&nbsp;%v`</span><span class="op" id="8552997">,</span>&nbsp;<span class="ident" id="8552999">test</span><span class="op" id="8553003">.</span><span class="ident" id="8553004">base</span><span class="op" id="8553008">,</span>&nbsp;<span class="ident" id="8553010">err</span><span class="op" id="8553013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8553017">}</span>&nbsp;<span class="keyword" id="8553019">else</span>&nbsp;<span class="keyword" id="8553024">if</span>&nbsp;<span class="op" id="8553027">*</span><span class="ident" id="8553028">url</span>&nbsp;<span class="op" id="8553032">!=</span>&nbsp;<span class="op" id="8553035">*</span><span class="ident" id="8553036">opaque</span>&nbsp;<span class="op" id="8553043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8553048">t</span><span class="op" id="8553049">.</span><span class="ident" id="8553050">Errorf</span><span class="op" id="8553056">(</span><span class="string" id="8553057">&#34;Parse&nbsp;failed&nbsp;to&nbsp;resolve&nbsp;opaque&nbsp;URL:&nbsp;want&nbsp;%#v,&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="8553112">,</span>&nbsp;<span class="ident" id="8553114">url</span><span class="op" id="8553117">,</span>&nbsp;<span class="ident" id="8553119">opaque</span><span class="op" id="8553125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8553129">}</span>&nbsp;<span class="keyword" id="8553131">else</span>&nbsp;<span class="keyword" id="8553136">if</span>&nbsp;<span class="ident" id="8553139">base</span>&nbsp;<span class="op" id="8553144">==</span>&nbsp;<span class="ident" id="8553147">url</span>&nbsp;<span class="op" id="8553151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8553156">//&nbsp;Ensure&nbsp;that&nbsp;new&nbsp;instances&nbsp;are&nbsp;returned,&nbsp;again.</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8553209">t</span><span class="op" id="8553210">.</span><span class="ident" id="8553211">Errorf</span><span class="op" id="8553217">(</span><span class="string" id="8553218">&#34;Expected&nbsp;URL.Parse&nbsp;to&nbsp;return&nbsp;new&nbsp;URL&nbsp;instance.&#34;</span><span class="op" id="8553266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8553270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8553273">}</span><br>
<span class="lineno"></span><span class="op" id="8553275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">750</span><span class="keyword" id="8553278">func</span>&nbsp;<span class="ident" id="8553283">TestQueryValues</span><span class="op" id="8553298">(</span><span class="ident" id="8553299">t</span>&nbsp;<span class="op" id="8553301">*</span><span class="ident" id="8553302">testing</span><span class="op" id="8553309">.</span><span class="ident" id="8553310">T</span><span class="op" id="8553311">)</span>&nbsp;<span class="op" id="8553313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8553316">u</span><span class="op" id="8553317">,</span>&nbsp;<span class="ident" id="8553319">_</span>&nbsp;<span class="op" id="8553321">:=</span>&nbsp;<span class="ident" id="8553324">Parse</span><span class="op" id="8553329">(</span><span class="string" id="8553330">&#34;http://x.com?foo=bar&amp;bar=1&amp;bar=2&#34;</span><span class="op" id="8553364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8553367">v</span>&nbsp;<span class="op" id="8553369">:=</span>&nbsp;<span class="ident" id="8553372">u</span><span class="op" id="8553373">.</span><span class="ident" id="8553374">Query</span><span class="op" id="8553379">(</span><span class="op" id="8553380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8553383">if</span>&nbsp;<span class="builtinfunc" id="8553386">len</span><span class="op" id="8553389">(</span><span class="ident" id="8553390">v</span><span class="op" id="8553391">)</span>&nbsp;<span class="op" id="8553393">!=</span>&nbsp;<span class="num" id="8553396">2</span>&nbsp;<span class="op" id="8553398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8553402">t</span><span class="op" id="8553403">.</span><span class="ident" id="8553404">Errorf</span><span class="op" id="8553410">(</span><span class="string" id="8553411">&#34;got&nbsp;%d&nbsp;keys&nbsp;in&nbsp;Query&nbsp;values,&nbsp;want&nbsp;2&#34;</span><span class="op" id="8553448">,</span>&nbsp;<span class="builtinfunc" id="8553450">len</span><span class="op" id="8553453">(</span><span class="ident" id="8553454">v</span><span class="op" id="8553455">)</span><span class="op" id="8553456">)</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8553459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8553462">if</span>&nbsp;<span class="ident" id="8553465">g</span><span class="op" id="8553466">,</span>&nbsp;<span class="ident" id="8553468">e</span>&nbsp;<span class="op" id="8553470">:=</span>&nbsp;<span class="ident" id="8553473">v</span><span class="op" id="8553474">.</span><span class="ident" id="8553475">Get</span><span class="op" id="8553478">(</span><span class="string" id="8553479">&#34;foo&#34;</span><span class="op" id="8553484">)</span><span class="op" id="8553485">,</span>&nbsp;<span class="string" id="8553487">&#34;bar&#34;</span><span class="op" id="8553492">;</span>&nbsp;<span class="ident" id="8553494">g</span>&nbsp;<span class="op" id="8553496">!=</span>&nbsp;<span class="ident" id="8553499">e</span>&nbsp;<span class="op" id="8553501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8553505">t</span><span class="op" id="8553506">.</span><span class="ident" id="8553507">Errorf</span><span class="op" id="8553513">(</span><span class="string" id="8553514">&#34;Get(foo)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8553538">,</span>&nbsp;<span class="ident" id="8553540">g</span><span class="op" id="8553541">,</span>&nbsp;<span class="ident" id="8553543">e</span><span class="op" id="8553544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8553547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8553550">//&nbsp;Case&nbsp;sensitive:</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8553570">if</span>&nbsp;<span class="ident" id="8553573">g</span><span class="op" id="8553574">,</span>&nbsp;<span class="ident" id="8553576">e</span>&nbsp;<span class="op" id="8553578">:=</span>&nbsp;<span class="ident" id="8553581">v</span><span class="op" id="8553582">.</span><span class="ident" id="8553583">Get</span><span class="op" id="8553586">(</span><span class="string" id="8553587">&#34;Foo&#34;</span><span class="op" id="8553592">)</span><span class="op" id="8553593">,</span>&nbsp;<span class="string" id="8553595">&#34;&#34;</span><span class="op" id="8553597">;</span>&nbsp;<span class="ident" id="8553599">g</span>&nbsp;<span class="op" id="8553601">!=</span>&nbsp;<span class="ident" id="8553604">e</span>&nbsp;<span class="op" id="8553606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8553610">t</span><span class="op" id="8553611">.</span><span class="ident" id="8553612">Errorf</span><span class="op" id="8553618">(</span><span class="string" id="8553619">&#34;Get(Foo)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8553643">,</span>&nbsp;<span class="ident" id="8553645">g</span><span class="op" id="8553646">,</span>&nbsp;<span class="ident" id="8553648">e</span><span class="op" id="8553649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8553652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8553655">if</span>&nbsp;<span class="ident" id="8553658">g</span><span class="op" id="8553659">,</span>&nbsp;<span class="ident" id="8553661">e</span>&nbsp;<span class="op" id="8553663">:=</span>&nbsp;<span class="ident" id="8553666">v</span><span class="op" id="8553667">.</span><span class="ident" id="8553668">Get</span><span class="op" id="8553671">(</span><span class="string" id="8553672">&#34;bar&#34;</span><span class="op" id="8553677">)</span><span class="op" id="8553678">,</span>&nbsp;<span class="string" id="8553680">&#34;1&#34;</span><span class="op" id="8553683">;</span>&nbsp;<span class="ident" id="8553685">g</span>&nbsp;<span class="op" id="8553687">!=</span>&nbsp;<span class="ident" id="8553690">e</span>&nbsp;<span class="op" id="8553692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8553696">t</span><span class="op" id="8553697">.</span><span class="ident" id="8553698">Errorf</span><span class="op" id="8553704">(</span><span class="string" id="8553705">&#34;Get(bar)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8553729">,</span>&nbsp;<span class="ident" id="8553731">g</span><span class="op" id="8553732">,</span>&nbsp;<span class="ident" id="8553734">e</span><span class="op" id="8553735">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8553738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8553741">if</span>&nbsp;<span class="ident" id="8553744">g</span><span class="op" id="8553745">,</span>&nbsp;<span class="ident" id="8553747">e</span>&nbsp;<span class="op" id="8553749">:=</span>&nbsp;<span class="ident" id="8553752">v</span><span class="op" id="8553753">.</span><span class="ident" id="8553754">Get</span><span class="op" id="8553757">(</span><span class="string" id="8553758">&#34;baz&#34;</span><span class="op" id="8553763">)</span><span class="op" id="8553764">,</span>&nbsp;<span class="string" id="8553766">&#34;&#34;</span><span class="op" id="8553768">;</span>&nbsp;<span class="ident" id="8553770">g</span>&nbsp;<span class="op" id="8553772">!=</span>&nbsp;<span class="ident" id="8553775">e</span>&nbsp;<span class="op" id="8553777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8553781">t</span><span class="op" id="8553782">.</span><span class="ident" id="8553783">Errorf</span><span class="op" id="8553789">(</span><span class="string" id="8553790">&#34;Get(baz)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8553814">,</span>&nbsp;<span class="ident" id="8553816">g</span><span class="op" id="8553817">,</span>&nbsp;<span class="ident" id="8553819">e</span><span class="op" id="8553820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8553823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8553826">v</span><span class="op" id="8553827">.</span><span class="ident" id="8553828">Del</span><span class="op" id="8553831">(</span><span class="string" id="8553832">&#34;bar&#34;</span><span class="op" id="8553837">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8553840">if</span>&nbsp;<span class="ident" id="8553843">g</span><span class="op" id="8553844">,</span>&nbsp;<span class="ident" id="8553846">e</span>&nbsp;<span class="op" id="8553848">:=</span>&nbsp;<span class="ident" id="8553851">v</span><span class="op" id="8553852">.</span><span class="ident" id="8553853">Get</span><span class="op" id="8553856">(</span><span class="string" id="8553857">&#34;bar&#34;</span><span class="op" id="8553862">)</span><span class="op" id="8553863">,</span>&nbsp;<span class="string" id="8553865">&#34;&#34;</span><span class="op" id="8553867">;</span>&nbsp;<span class="ident" id="8553869">g</span>&nbsp;<span class="op" id="8553871">!=</span>&nbsp;<span class="ident" id="8553874">e</span>&nbsp;<span class="op" id="8553876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8553880">t</span><span class="op" id="8553881">.</span><span class="ident" id="8553882">Errorf</span><span class="op" id="8553888">(</span><span class="string" id="8553889">&#34;second&nbsp;Get(bar)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8553920">,</span>&nbsp;<span class="ident" id="8553922">g</span><span class="op" id="8553923">,</span>&nbsp;<span class="ident" id="8553925">e</span><span class="op" id="8553926">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8553929">}</span><br>
<span class="lineno"></span><span class="op" id="8553931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span><span class="keyword" id="8553934">type</span>&nbsp;<span class="ident" id="8553939">parseTest</span>&nbsp;<span class="keyword" id="8553949">struct</span>&nbsp;<span class="op" id="8553956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8553959">query</span>&nbsp;<span class="builtintype" id="8553965">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8553973">out</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8553979">Values</span><br>
<span class="lineno"></span><span class="op" id="8553986">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span><span class="keyword" id="8553989">var</span>&nbsp;<span class="ident" id="8553993">parseTests</span>&nbsp;<span class="op" id="8554004">=</span>&nbsp;<span class="op" id="8554006">[</span><span class="op" id="8554007">]</span><span class="ident" id="8554008">parseTest</span><span class="op" id="8554017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8554020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8554024">query</span><span class="op" id="8554029">:</span>&nbsp;<span class="string" id="8554031">&#34;a=1&amp;b=2&#34;</span><span class="op" id="8554040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8554044">out</span><span class="op" id="8554047">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8554051">Values</span><span class="op" id="8554057">{</span><span class="string" id="8554058">&#34;a&#34;</span><span class="op" id="8554061">:</span>&nbsp;<span class="op" id="8554063">[</span><span class="op" id="8554064">]</span><span class="builtintype" id="8554065">string</span><span class="op" id="8554071">{</span><span class="string" id="8554072">&#34;1&#34;</span><span class="op" id="8554075">}</span><span class="op" id="8554076">,</span>&nbsp;<span class="string" id="8554078">&#34;b&#34;</span><span class="op" id="8554081">:</span>&nbsp;<span class="op" id="8554083">[</span><span class="op" id="8554084">]</span><span class="builtintype" id="8554085">string</span><span class="op" id="8554091">{</span><span class="string" id="8554092">&#34;2&#34;</span><span class="op" id="8554095">}</span><span class="op" id="8554096">}</span><span class="op" id="8554097">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8554100">}</span><span class="op" id="8554101">,</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8554104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8554108">query</span><span class="op" id="8554113">:</span>&nbsp;<span class="string" id="8554115">&#34;a=1&amp;a=2&amp;a=banana&#34;</span><span class="op" id="8554133">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8554137">out</span><span class="op" id="8554140">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8554144">Values</span><span class="op" id="8554150">{</span><span class="string" id="8554151">&#34;a&#34;</span><span class="op" id="8554154">:</span>&nbsp;<span class="op" id="8554156">[</span><span class="op" id="8554157">]</span><span class="builtintype" id="8554158">string</span><span class="op" id="8554164">{</span><span class="string" id="8554165">&#34;1&#34;</span><span class="op" id="8554168">,</span>&nbsp;<span class="string" id="8554170">&#34;2&#34;</span><span class="op" id="8554173">,</span>&nbsp;<span class="string" id="8554175">&#34;banana&#34;</span><span class="op" id="8554183">}</span><span class="op" id="8554184">}</span><span class="op" id="8554185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8554188">}</span><span class="op" id="8554189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8554192">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8554196">query</span><span class="op" id="8554201">:</span>&nbsp;<span class="string" id="8554203">&#34;ascii=%3Ckey%3A+0x90%3E&#34;</span><span class="op" id="8554228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8554232">out</span><span class="op" id="8554235">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8554239">Values</span><span class="op" id="8554245">{</span><span class="string" id="8554246">&#34;ascii&#34;</span><span class="op" id="8554253">:</span>&nbsp;<span class="op" id="8554255">[</span><span class="op" id="8554256">]</span><span class="builtintype" id="8554257">string</span><span class="op" id="8554263">{</span><span class="string" id="8554264">&#34;&lt;key:&nbsp;0x90&gt;&#34;</span><span class="op" id="8554277">}</span><span class="op" id="8554278">}</span><span class="op" id="8554279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8554282">}</span><span class="op" id="8554283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8554286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8554290">query</span><span class="op" id="8554295">:</span>&nbsp;<span class="string" id="8554297">&#34;a=1;b=2&#34;</span><span class="op" id="8554306">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8554310">out</span><span class="op" id="8554313">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8554317">Values</span><span class="op" id="8554323">{</span><span class="string" id="8554324">&#34;a&#34;</span><span class="op" id="8554327">:</span>&nbsp;<span class="op" id="8554329">[</span><span class="op" id="8554330">]</span><span class="builtintype" id="8554331">string</span><span class="op" id="8554337">{</span><span class="string" id="8554338">&#34;1&#34;</span><span class="op" id="8554341">}</span><span class="op" id="8554342">,</span>&nbsp;<span class="string" id="8554344">&#34;b&#34;</span><span class="op" id="8554347">:</span>&nbsp;<span class="op" id="8554349">[</span><span class="op" id="8554350">]</span><span class="builtintype" id="8554351">string</span><span class="op" id="8554357">{</span><span class="string" id="8554358">&#34;2&#34;</span><span class="op" id="8554361">}</span><span class="op" id="8554362">}</span><span class="op" id="8554363">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8554366">}</span><span class="op" id="8554367">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8554370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8554374">query</span><span class="op" id="8554379">:</span>&nbsp;<span class="string" id="8554381">&#34;a=1&amp;a=2;a=banana&#34;</span><span class="op" id="8554399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8554403">out</span><span class="op" id="8554406">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8554410">Values</span><span class="op" id="8554416">{</span><span class="string" id="8554417">&#34;a&#34;</span><span class="op" id="8554420">:</span>&nbsp;<span class="op" id="8554422">[</span><span class="op" id="8554423">]</span><span class="builtintype" id="8554424">string</span><span class="op" id="8554430">{</span><span class="string" id="8554431">&#34;1&#34;</span><span class="op" id="8554434">,</span>&nbsp;<span class="string" id="8554436">&#34;2&#34;</span><span class="op" id="8554439">,</span>&nbsp;<span class="string" id="8554441">&#34;banana&#34;</span><span class="op" id="8554449">}</span><span class="op" id="8554450">}</span><span class="op" id="8554451">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8554454">}</span><span class="op" id="8554455">,</span><br>
<span class="lineno"></span><span class="op" id="8554457">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8554460">func</span>&nbsp;<span class="ident" id="8554465">TestParseQuery</span><span class="op" id="8554479">(</span><span class="ident" id="8554480">t</span>&nbsp;<span class="op" id="8554482">*</span><span class="ident" id="8554483">testing</span><span class="op" id="8554490">.</span><span class="ident" id="8554491">T</span><span class="op" id="8554492">)</span>&nbsp;<span class="op" id="8554494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8554497">for</span>&nbsp;<span class="ident" id="8554501">i</span><span class="op" id="8554502">,</span>&nbsp;<span class="ident" id="8554504">test</span>&nbsp;<span class="op" id="8554509">:=</span>&nbsp;<span class="keyword" id="8554512">range</span>&nbsp;<span class="ident" id="8554518">parseTests</span>&nbsp;<span class="op" id="8554529">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8554533">form</span><span class="op" id="8554537">,</span>&nbsp;<span class="ident" id="8554539">err</span>&nbsp;<span class="op" id="8554543">:=</span>&nbsp;<span class="ident" id="8554546">ParseQuery</span><span class="op" id="8554556">(</span><span class="ident" id="8554557">test</span><span class="op" id="8554561">.</span><span class="ident" id="8554562">query</span><span class="op" id="8554567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8554571">if</span>&nbsp;<span class="ident" id="8554574">err</span>&nbsp;<span class="op" id="8554578">!=</span>&nbsp;<span class="builtintype" id="8554581">nil</span>&nbsp;<span class="op" id="8554585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8554590">t</span><span class="op" id="8554591">.</span><span class="ident" id="8554592">Errorf</span><span class="op" id="8554598">(</span><span class="string" id="8554599">&#34;test&nbsp;%d:&nbsp;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="8554630">,</span>&nbsp;<span class="ident" id="8554632">i</span><span class="op" id="8554633">,</span>&nbsp;<span class="ident" id="8554635">err</span><span class="op" id="8554638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8554643">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8554654">}</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8554658">if</span>&nbsp;<span class="builtinfunc" id="8554661">len</span><span class="op" id="8554664">(</span><span class="ident" id="8554665">form</span><span class="op" id="8554669">)</span>&nbsp;<span class="op" id="8554671">!=</span>&nbsp;<span class="builtinfunc" id="8554674">len</span><span class="op" id="8554677">(</span><span class="ident" id="8554678">test</span><span class="op" id="8554682">.</span><span class="ident" id="8554683">out</span><span class="op" id="8554686">)</span>&nbsp;<span class="op" id="8554688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8554693">t</span><span class="op" id="8554694">.</span><span class="ident" id="8554695">Errorf</span><span class="op" id="8554701">(</span><span class="string" id="8554702">&#34;test&nbsp;%d:&nbsp;len(form)&nbsp;=&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8554736">,</span>&nbsp;<span class="ident" id="8554738">i</span><span class="op" id="8554739">,</span>&nbsp;<span class="builtinfunc" id="8554741">len</span><span class="op" id="8554744">(</span><span class="ident" id="8554745">form</span><span class="op" id="8554749">)</span><span class="op" id="8554750">,</span>&nbsp;<span class="builtinfunc" id="8554752">len</span><span class="op" id="8554755">(</span><span class="ident" id="8554756">test</span><span class="op" id="8554760">.</span><span class="ident" id="8554761">out</span><span class="op" id="8554764">)</span><span class="op" id="8554765">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8554769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8554773">for</span>&nbsp;<span class="ident" id="8554777">k</span><span class="op" id="8554778">,</span>&nbsp;<span class="ident" id="8554780">evs</span>&nbsp;<span class="op" id="8554784">:=</span>&nbsp;<span class="keyword" id="8554787">range</span>&nbsp;<span class="ident" id="8554793">test</span><span class="op" id="8554797">.</span><span class="ident" id="8554798">out</span>&nbsp;<span class="op" id="8554802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8554807">vs</span><span class="op" id="8554809">,</span>&nbsp;<span class="ident" id="8554811">ok</span>&nbsp;<span class="op" id="8554814">:=</span>&nbsp;<span class="ident" id="8554817">form</span><span class="op" id="8554821">[</span><span class="ident" id="8554822">k</span><span class="op" id="8554823">]</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8554828">if</span>&nbsp;<span class="op" id="8554831">!</span><span class="ident" id="8554832">ok</span>&nbsp;<span class="op" id="8554835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8554841">t</span><span class="op" id="8554842">.</span><span class="ident" id="8554843">Errorf</span><span class="op" id="8554849">(</span><span class="string" id="8554850">&#34;test&nbsp;%d:&nbsp;Missing&nbsp;key&nbsp;%q&#34;</span><span class="op" id="8554875">,</span>&nbsp;<span class="ident" id="8554877">i</span><span class="op" id="8554878">,</span>&nbsp;<span class="ident" id="8554880">k</span><span class="op" id="8554881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8554887">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8554899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8554904">if</span>&nbsp;<span class="builtinfunc" id="8554907">len</span><span class="op" id="8554910">(</span><span class="ident" id="8554911">vs</span><span class="op" id="8554913">)</span>&nbsp;<span class="op" id="8554915">!=</span>&nbsp;<span class="builtinfunc" id="8554918">len</span><span class="op" id="8554921">(</span><span class="ident" id="8554922">evs</span><span class="op" id="8554925">)</span>&nbsp;<span class="op" id="8554927">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8554933">t</span><span class="op" id="8554934">.</span><span class="ident" id="8554935">Errorf</span><span class="op" id="8554941">(</span><span class="string" id="8554942">&#34;test&nbsp;%d:&nbsp;len(form[%q])&nbsp;=&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="8554980">,</span>&nbsp;<span class="ident" id="8554982">i</span><span class="op" id="8554983">,</span>&nbsp;<span class="ident" id="8554985">k</span><span class="op" id="8554986">,</span>&nbsp;<span class="builtinfunc" id="8554988">len</span><span class="op" id="8554991">(</span><span class="ident" id="8554992">vs</span><span class="op" id="8554994">)</span><span class="op" id="8554995">,</span>&nbsp;<span class="builtinfunc" id="8554997">len</span><span class="op" id="8555000">(</span><span class="ident" id="8555001">evs</span><span class="op" id="8555004">)</span><span class="op" id="8555005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8555011">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8555028">for</span>&nbsp;<span class="ident" id="8555032">j</span><span class="op" id="8555033">,</span>&nbsp;<span class="ident" id="8555035">ev</span>&nbsp;<span class="op" id="8555038">:=</span>&nbsp;<span class="keyword" id="8555041">range</span>&nbsp;<span class="ident" id="8555047">evs</span>&nbsp;<span class="op" id="8555051">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8555057">if</span>&nbsp;<span class="ident" id="8555060">v</span>&nbsp;<span class="op" id="8555062">:=</span>&nbsp;<span class="ident" id="8555065">vs</span><span class="op" id="8555067">[</span><span class="ident" id="8555068">j</span><span class="op" id="8555069">]</span><span class="op" id="8555070">;</span>&nbsp;<span class="ident" id="8555072">v</span>&nbsp;<span class="op" id="8555074">!=</span>&nbsp;<span class="ident" id="8555077">ev</span>&nbsp;<span class="op" id="8555080">{</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555087">t</span><span class="op" id="8555088">.</span><span class="ident" id="8555089">Errorf</span><span class="op" id="8555095">(</span><span class="string" id="8555096">&#34;test&nbsp;%d:&nbsp;form[%q][%d]&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="8555133">,</span>&nbsp;<span class="ident" id="8555135">i</span><span class="op" id="8555136">,</span>&nbsp;<span class="ident" id="8555138">k</span><span class="op" id="8555139">,</span>&nbsp;<span class="ident" id="8555141">j</span><span class="op" id="8555142">,</span>&nbsp;<span class="ident" id="8555144">v</span><span class="op" id="8555145">,</span>&nbsp;<span class="ident" id="8555147">ev</span><span class="op" id="8555149">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555167">}</span><br>
<span class="lineno">830</span><span class="op" id="8555169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8555172">type</span>&nbsp;<span class="ident" id="8555177">RequestURITest</span>&nbsp;<span class="keyword" id="8555192">struct</span>&nbsp;<span class="op" id="8555199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555202">url</span>&nbsp;<span class="op" id="8555206">*</span><span class="ident" id="8555207">URL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555212">out</span>&nbsp;<span class="builtintype" id="8555216">string</span><br>
<span class="lineno">835</span><span class="op" id="8555223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8555226">var</span>&nbsp;<span class="ident" id="8555230">requritests</span>&nbsp;<span class="op" id="8555242">=</span>&nbsp;<span class="op" id="8555244">[</span><span class="op" id="8555245">]</span><span class="ident" id="8555246">RequestURITest</span><span class="op" id="8555260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555267">&amp;</span><span class="ident" id="8555268">URL</span><span class="op" id="8555271">{</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555276">Scheme</span><span class="op" id="8555282">:</span>&nbsp;<span class="string" id="8555284">&#34;http&#34;</span><span class="op" id="8555290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555295">Host</span><span class="op" id="8555299">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8555303">&#34;example.com&#34;</span><span class="op" id="8555316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555321">Path</span><span class="op" id="8555325">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8555329">&#34;&#34;</span><span class="op" id="8555331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555335">}</span><span class="op" id="8555336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8555340">&#34;/&#34;</span><span class="op" id="8555343">,</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555346">}</span><span class="op" id="8555347">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555354">&amp;</span><span class="ident" id="8555355">URL</span><span class="op" id="8555358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555363">Scheme</span><span class="op" id="8555369">:</span>&nbsp;<span class="string" id="8555371">&#34;http&#34;</span><span class="op" id="8555377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555382">Host</span><span class="op" id="8555386">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8555390">&#34;example.com&#34;</span><span class="op" id="8555403">,</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555408">Path</span><span class="op" id="8555412">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8555416">&#34;/a&nbsp;b&#34;</span><span class="op" id="8555422">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555426">}</span><span class="op" id="8555427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8555431">&#34;/a%20b&#34;</span><span class="op" id="8555439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555442">}</span><span class="op" id="8555443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8555446">//&nbsp;golang.org/issue/4860&nbsp;variant&nbsp;1</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555486">&amp;</span><span class="ident" id="8555487">URL</span><span class="op" id="8555490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555495">Scheme</span><span class="op" id="8555501">:</span>&nbsp;<span class="string" id="8555503">&#34;http&#34;</span><span class="op" id="8555509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555514">Host</span><span class="op" id="8555518">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8555522">&#34;example.com&#34;</span><span class="op" id="8555535">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555540">Opaque</span><span class="op" id="8555546">:</span>&nbsp;<span class="string" id="8555548">&#34;/%2F/%2F/&#34;</span><span class="op" id="8555559">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555563">}</span><span class="op" id="8555564">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8555568">&#34;/%2F/%2F/&#34;</span><span class="op" id="8555579">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555582">}</span><span class="op" id="8555583">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8555586">//&nbsp;golang.org/issue/4860&nbsp;variant&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555622">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555626">&amp;</span><span class="ident" id="8555627">URL</span><span class="op" id="8555630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555635">Scheme</span><span class="op" id="8555641">:</span>&nbsp;<span class="string" id="8555643">&#34;http&#34;</span><span class="op" id="8555649">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555654">Host</span><span class="op" id="8555658">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8555662">&#34;example.com&#34;</span><span class="op" id="8555675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555680">Opaque</span><span class="op" id="8555686">:</span>&nbsp;<span class="string" id="8555688">&#34;//other.example.com/%2F/%2F/&#34;</span><span class="op" id="8555718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555722">}</span><span class="op" id="8555723">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8555727">&#34;http://other.example.com/%2F/%2F/&#34;</span><span class="op" id="8555762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555765">}</span><span class="op" id="8555766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555773">&amp;</span><span class="ident" id="8555774">URL</span><span class="op" id="8555777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555782">Scheme</span><span class="op" id="8555788">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8555792">&#34;http&#34;</span><span class="op" id="8555798">,</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555803">Host</span><span class="op" id="8555807">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8555813">&#34;example.com&#34;</span><span class="op" id="8555826">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555831">Path</span><span class="op" id="8555835">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8555841">&#34;/a&nbsp;b&#34;</span><span class="op" id="8555847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555852">RawQuery</span><span class="op" id="8555860">:</span>&nbsp;<span class="string" id="8555862">&#34;q=go+language&#34;</span><span class="op" id="8555877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555881">}</span><span class="op" id="8555882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8555886">&#34;/a%20b?q=go+language&#34;</span><span class="op" id="8555908">,</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555911">}</span><span class="op" id="8555912">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555919">&amp;</span><span class="ident" id="8555920">URL</span><span class="op" id="8555923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555928">Scheme</span><span class="op" id="8555934">:</span>&nbsp;<span class="string" id="8555936">&#34;myschema&#34;</span><span class="op" id="8555946">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8555951">Opaque</span><span class="op" id="8555957">:</span>&nbsp;<span class="string" id="8555959">&#34;opaque&#34;</span><span class="op" id="8555967">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555971">}</span><span class="op" id="8555972">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8555976">&#34;opaque&#34;</span><span class="op" id="8555984">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555987">}</span><span class="op" id="8555988">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8555995">&amp;</span><span class="ident" id="8555996">URL</span><span class="op" id="8555999">{</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8556004">Scheme</span><span class="op" id="8556010">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8556014">&#34;myschema&#34;</span><span class="op" id="8556024">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8556029">Opaque</span><span class="op" id="8556035">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="8556039">&#34;opaque&#34;</span><span class="op" id="8556047">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8556052">RawQuery</span><span class="op" id="8556060">:</span>&nbsp;<span class="string" id="8556062">&#34;q=go+language&#34;</span><span class="op" id="8556077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8556081">}</span><span class="op" id="8556082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="8556086">&#34;opaque?q=go+language&#34;</span><span class="op" id="8556108">,</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8556111">}</span><span class="op" id="8556112">,</span><br>
<span class="lineno"></span><span class="op" id="8556114">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8556117">func</span>&nbsp;<span class="ident" id="8556122">TestRequestURI</span><span class="op" id="8556136">(</span><span class="ident" id="8556137">t</span>&nbsp;<span class="op" id="8556139">*</span><span class="ident" id="8556140">testing</span><span class="op" id="8556147">.</span><span class="ident" id="8556148">T</span><span class="op" id="8556149">)</span>&nbsp;<span class="op" id="8556151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8556154">for</span>&nbsp;<span class="ident" id="8556158">_</span><span class="op" id="8556159">,</span>&nbsp;<span class="ident" id="8556161">tt</span>&nbsp;<span class="op" id="8556164">:=</span>&nbsp;<span class="keyword" id="8556167">range</span>&nbsp;<span class="ident" id="8556173">requritests</span>&nbsp;<span class="op" id="8556185">{</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8556189">s</span>&nbsp;<span class="op" id="8556191">:=</span>&nbsp;<span class="ident" id="8556194">tt</span><span class="op" id="8556196">.</span><span class="ident" id="8556197">url</span><span class="op" id="8556200">.</span><span class="ident" id="8556201">RequestURI</span><span class="op" id="8556211">(</span><span class="op" id="8556212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8556216">if</span>&nbsp;<span class="ident" id="8556219">s</span>&nbsp;<span class="op" id="8556221">!=</span>&nbsp;<span class="ident" id="8556224">tt</span><span class="op" id="8556226">.</span><span class="ident" id="8556227">out</span>&nbsp;<span class="op" id="8556231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8556236">t</span><span class="op" id="8556237">.</span><span class="ident" id="8556238">Errorf</span><span class="op" id="8556244">(</span><span class="string" id="8556245">&#34;%#v.RequestURI()&nbsp;==&nbsp;%q&nbsp;(expected&nbsp;%q)&#34;</span><span class="op" id="8556283">,</span>&nbsp;<span class="ident" id="8556285">tt</span><span class="op" id="8556287">.</span><span class="ident" id="8556288">url</span><span class="op" id="8556291">,</span>&nbsp;<span class="ident" id="8556293">s</span><span class="op" id="8556294">,</span>&nbsp;<span class="ident" id="8556296">tt</span><span class="op" id="8556298">.</span><span class="ident" id="8556299">out</span><span class="op" id="8556302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8556306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8556309">}</span><br>
<span class="lineno">905</span><span class="op" id="8556311">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8556314">func</span>&nbsp;<span class="ident" id="8556319">TestParseFailure</span><span class="op" id="8556335">(</span><span class="ident" id="8556336">t</span>&nbsp;<span class="op" id="8556338">*</span><span class="ident" id="8556339">testing</span><span class="op" id="8556346">.</span><span class="ident" id="8556347">T</span><span class="op" id="8556348">)</span>&nbsp;<span class="op" id="8556350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8556353">//&nbsp;Test&nbsp;that&nbsp;the&nbsp;first&nbsp;parse&nbsp;error&nbsp;is&nbsp;returned.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8556402">const</span>&nbsp;<span class="ident" id="8556408">url</span>&nbsp;<span class="op" id="8556412">=</span>&nbsp;<span class="string" id="8556414">&#34;%gh&amp;%ij&#34;</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8556425">_</span><span class="op" id="8556426">,</span>&nbsp;<span class="ident" id="8556428">err</span>&nbsp;<span class="op" id="8556432">:=</span>&nbsp;<span class="ident" id="8556435">ParseQuery</span><span class="op" id="8556445">(</span><span class="ident" id="8556446">url</span><span class="op" id="8556449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8556452">errStr</span>&nbsp;<span class="op" id="8556459">:=</span>&nbsp;<span class="ident" id="8556462">fmt</span><span class="op" id="8556465">.</span><span class="ident" id="8556466">Sprint</span><span class="op" id="8556472">(</span><span class="ident" id="8556473">err</span><span class="op" id="8556476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8556479">if</span>&nbsp;<span class="op" id="8556482">!</span><span class="ident" id="8556483">strings</span><span class="op" id="8556490">.</span><span class="ident" id="8556491">Contains</span><span class="op" id="8556499">(</span><span class="ident" id="8556500">errStr</span><span class="op" id="8556506">,</span>&nbsp;<span class="string" id="8556508">&#34;%gh&#34;</span><span class="op" id="8556513">)</span>&nbsp;<span class="op" id="8556515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8556519">t</span><span class="op" id="8556520">.</span><span class="ident" id="8556521">Errorf</span><span class="op" id="8556527">(</span><span class="string" id="8556528">`ParseQuery(%q)&nbsp;returned&nbsp;error&nbsp;%q,&nbsp;want&nbsp;something&nbsp;containing&nbsp;%q&#34;`</span><span class="op" id="8556593">,</span>&nbsp;<span class="ident" id="8556595">url</span><span class="op" id="8556598">,</span>&nbsp;<span class="ident" id="8556600">errStr</span><span class="op" id="8556606">,</span>&nbsp;<span class="string" id="8556608">&#34;%gh&#34;</span><span class="op" id="8556613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8556616">}</span><br>
<span class="lineno">915</span><span class="op" id="8556618">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8556621">type</span>&nbsp;<span class="ident" id="8556626">shouldEscapeTest</span>&nbsp;<span class="keyword" id="8556643">struct</span>&nbsp;<span class="op" id="8556650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8556653">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8556660">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8556666">mode</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="8556673">encoding</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8556683">escape</span>&nbsp;<span class="builtintype" id="8556690">bool</span><br>
<span class="lineno"></span><span class="op" id="8556695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8556698">var</span>&nbsp;<span class="ident" id="8556702">shouldEscapeTests</span>&nbsp;<span class="op" id="8556720">=</span>&nbsp;<span class="op" id="8556722">[</span><span class="op" id="8556723">]</span><span class="ident" id="8556724">shouldEscapeTest</span><span class="op" id="8556740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8556743">//&nbsp;Unreserved&nbsp;characters&nbsp;(2.3)</span><br>
<span class="lineno">925</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8556777">{</span><span class="string" id="8556778">&#39;a&#39;</span><span class="op" id="8556781">,</span>&nbsp;<span class="ident" id="8556783">encodePath</span><span class="op" id="8556793">,</span>&nbsp;<span class="builtintype" id="8556795">false</span><span class="op" id="8556800">}</span><span class="op" id="8556801">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8556804">{</span><span class="string" id="8556805">&#39;a&#39;</span><span class="op" id="8556808">,</span>&nbsp;<span class="ident" id="8556810">encodeUserPassword</span><span class="op" id="8556828">,</span>&nbsp;<span class="builtintype" id="8556830">false</span><span class="op" id="8556835">}</span><span class="op" id="8556836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8556839">{</span><span class="string" id="8556840">&#39;a&#39;</span><span class="op" id="8556843">,</span>&nbsp;<span class="ident" id="8556845">encodeQueryComponent</span><span class="op" id="8556865">,</span>&nbsp;<span class="builtintype" id="8556867">false</span><span class="op" id="8556872">}</span><span class="op" id="8556873">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8556876">{</span><span class="string" id="8556877">&#39;a&#39;</span><span class="op" id="8556880">,</span>&nbsp;<span class="ident" id="8556882">encodeFragment</span><span class="op" id="8556896">,</span>&nbsp;<span class="builtintype" id="8556898">false</span><span class="op" id="8556903">}</span><span class="op" id="8556904">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8556907">{</span><span class="string" id="8556908">&#39;z&#39;</span><span class="op" id="8556911">,</span>&nbsp;<span class="ident" id="8556913">encodePath</span><span class="op" id="8556923">,</span>&nbsp;<span class="builtintype" id="8556925">false</span><span class="op" id="8556930">}</span><span class="op" id="8556931">,</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8556934">{</span><span class="string" id="8556935">&#39;A&#39;</span><span class="op" id="8556938">,</span>&nbsp;<span class="ident" id="8556940">encodePath</span><span class="op" id="8556950">,</span>&nbsp;<span class="builtintype" id="8556952">false</span><span class="op" id="8556957">}</span><span class="op" id="8556958">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8556961">{</span><span class="string" id="8556962">&#39;Z&#39;</span><span class="op" id="8556965">,</span>&nbsp;<span class="ident" id="8556967">encodePath</span><span class="op" id="8556977">,</span>&nbsp;<span class="builtintype" id="8556979">false</span><span class="op" id="8556984">}</span><span class="op" id="8556985">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8556988">{</span><span class="string" id="8556989">&#39;0&#39;</span><span class="op" id="8556992">,</span>&nbsp;<span class="ident" id="8556994">encodePath</span><span class="op" id="8557004">,</span>&nbsp;<span class="builtintype" id="8557006">false</span><span class="op" id="8557011">}</span><span class="op" id="8557012">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557015">{</span><span class="string" id="8557016">&#39;9&#39;</span><span class="op" id="8557019">,</span>&nbsp;<span class="ident" id="8557021">encodePath</span><span class="op" id="8557031">,</span>&nbsp;<span class="builtintype" id="8557033">false</span><span class="op" id="8557038">}</span><span class="op" id="8557039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557042">{</span><span class="string" id="8557043">&#39;-&#39;</span><span class="op" id="8557046">,</span>&nbsp;<span class="ident" id="8557048">encodePath</span><span class="op" id="8557058">,</span>&nbsp;<span class="builtintype" id="8557060">false</span><span class="op" id="8557065">}</span><span class="op" id="8557066">,</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557069">{</span><span class="string" id="8557070">&#39;-&#39;</span><span class="op" id="8557073">,</span>&nbsp;<span class="ident" id="8557075">encodeUserPassword</span><span class="op" id="8557093">,</span>&nbsp;<span class="builtintype" id="8557095">false</span><span class="op" id="8557100">}</span><span class="op" id="8557101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557104">{</span><span class="string" id="8557105">&#39;-&#39;</span><span class="op" id="8557108">,</span>&nbsp;<span class="ident" id="8557110">encodeQueryComponent</span><span class="op" id="8557130">,</span>&nbsp;<span class="builtintype" id="8557132">false</span><span class="op" id="8557137">}</span><span class="op" id="8557138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557141">{</span><span class="string" id="8557142">&#39;-&#39;</span><span class="op" id="8557145">,</span>&nbsp;<span class="ident" id="8557147">encodeFragment</span><span class="op" id="8557161">,</span>&nbsp;<span class="builtintype" id="8557163">false</span><span class="op" id="8557168">}</span><span class="op" id="8557169">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557172">{</span><span class="string" id="8557173">&#39;.&#39;</span><span class="op" id="8557176">,</span>&nbsp;<span class="ident" id="8557178">encodePath</span><span class="op" id="8557188">,</span>&nbsp;<span class="builtintype" id="8557190">false</span><span class="op" id="8557195">}</span><span class="op" id="8557196">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557199">{</span><span class="string" id="8557200">&#39;_&#39;</span><span class="op" id="8557203">,</span>&nbsp;<span class="ident" id="8557205">encodePath</span><span class="op" id="8557215">,</span>&nbsp;<span class="builtintype" id="8557217">false</span><span class="op" id="8557222">}</span><span class="op" id="8557223">,</span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557226">{</span><span class="string" id="8557227">&#39;~&#39;</span><span class="op" id="8557230">,</span>&nbsp;<span class="ident" id="8557232">encodePath</span><span class="op" id="8557242">,</span>&nbsp;<span class="builtintype" id="8557244">false</span><span class="op" id="8557249">}</span><span class="op" id="8557250">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="8557254">//&nbsp;User&nbsp;information&nbsp;(3.2.1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557285">{</span><span class="string" id="8557286">&#39;:&#39;</span><span class="op" id="8557289">,</span>&nbsp;<span class="ident" id="8557291">encodeUserPassword</span><span class="op" id="8557309">,</span>&nbsp;<span class="builtintype" id="8557311">true</span><span class="op" id="8557315">}</span><span class="op" id="8557316">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557319">{</span><span class="string" id="8557320">&#39;/&#39;</span><span class="op" id="8557323">,</span>&nbsp;<span class="ident" id="8557325">encodeUserPassword</span><span class="op" id="8557343">,</span>&nbsp;<span class="builtintype" id="8557345">true</span><span class="op" id="8557349">}</span><span class="op" id="8557350">,</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557353">{</span><span class="string" id="8557354">&#39;?&#39;</span><span class="op" id="8557357">,</span>&nbsp;<span class="ident" id="8557359">encodeUserPassword</span><span class="op" id="8557377">,</span>&nbsp;<span class="builtintype" id="8557379">true</span><span class="op" id="8557383">}</span><span class="op" id="8557384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557387">{</span><span class="string" id="8557388">&#39;@&#39;</span><span class="op" id="8557391">,</span>&nbsp;<span class="ident" id="8557393">encodeUserPassword</span><span class="op" id="8557411">,</span>&nbsp;<span class="builtintype" id="8557413">true</span><span class="op" id="8557417">}</span><span class="op" id="8557418">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557421">{</span><span class="string" id="8557422">&#39;$&#39;</span><span class="op" id="8557425">,</span>&nbsp;<span class="ident" id="8557427">encodeUserPassword</span><span class="op" id="8557445">,</span>&nbsp;<span class="builtintype" id="8557447">false</span><span class="op" id="8557452">}</span><span class="op" id="8557453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557456">{</span><span class="string" id="8557457">&#39;&amp;&#39;</span><span class="op" id="8557460">,</span>&nbsp;<span class="ident" id="8557462">encodeUserPassword</span><span class="op" id="8557480">,</span>&nbsp;<span class="builtintype" id="8557482">false</span><span class="op" id="8557487">}</span><span class="op" id="8557488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557491">{</span><span class="string" id="8557492">&#39;+&#39;</span><span class="op" id="8557495">,</span>&nbsp;<span class="ident" id="8557497">encodeUserPassword</span><span class="op" id="8557515">,</span>&nbsp;<span class="builtintype" id="8557517">false</span><span class="op" id="8557522">}</span><span class="op" id="8557523">,</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557526">{</span><span class="string" id="8557527">&#39;,&#39;</span><span class="op" id="8557530">,</span>&nbsp;<span class="ident" id="8557532">encodeUserPassword</span><span class="op" id="8557550">,</span>&nbsp;<span class="builtintype" id="8557552">false</span><span class="op" id="8557557">}</span><span class="op" id="8557558">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557561">{</span><span class="string" id="8557562">&#39;;&#39;</span><span class="op" id="8557565">,</span>&nbsp;<span class="ident" id="8557567">encodeUserPassword</span><span class="op" id="8557585">,</span>&nbsp;<span class="builtintype" id="8557587">false</span><span class="op" id="8557592">}</span><span class="op" id="8557593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557596">{</span><span class="string" id="8557597">&#39;=&#39;</span><span class="op" id="8557600">,</span>&nbsp;<span class="ident" id="8557602">encodeUserPassword</span><span class="op" id="8557620">,</span>&nbsp;<span class="builtintype" id="8557622">false</span><span class="op" id="8557627">}</span><span class="op" id="8557628">,</span><br>
<span class="lineno"></span><span class="op" id="8557630">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">955</span><span class="keyword" id="8557633">func</span>&nbsp;<span class="ident" id="8557638">TestShouldEscape</span><span class="op" id="8557654">(</span><span class="ident" id="8557655">t</span>&nbsp;<span class="op" id="8557657">*</span><span class="ident" id="8557658">testing</span><span class="op" id="8557665">.</span><span class="ident" id="8557666">T</span><span class="op" id="8557667">)</span>&nbsp;<span class="op" id="8557669">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8557672">for</span>&nbsp;<span class="ident" id="8557676">_</span><span class="op" id="8557677">,</span>&nbsp;<span class="ident" id="8557679">tt</span>&nbsp;<span class="op" id="8557682">:=</span>&nbsp;<span class="keyword" id="8557685">range</span>&nbsp;<span class="ident" id="8557691">shouldEscapeTests</span>&nbsp;<span class="op" id="8557709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="8557713">if</span>&nbsp;<span class="ident" id="8557716">shouldEscape</span><span class="op" id="8557728">(</span><span class="ident" id="8557729">tt</span><span class="op" id="8557731">.</span><span class="ident" id="8557732">in</span><span class="op" id="8557734">,</span>&nbsp;<span class="ident" id="8557736">tt</span><span class="op" id="8557738">.</span><span class="ident" id="8557739">mode</span><span class="op" id="8557743">)</span>&nbsp;<span class="op" id="8557745">!=</span>&nbsp;<span class="ident" id="8557748">tt</span><span class="op" id="8557750">.</span><span class="ident" id="8557751">escape</span>&nbsp;<span class="op" id="8557758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="8557763">t</span><span class="op" id="8557764">.</span><span class="ident" id="8557765">Errorf</span><span class="op" id="8557771">(</span><span class="string" id="8557772">&#34;shouldEscape(%q,&nbsp;%v)&nbsp;returned&nbsp;%v;&nbsp;expected&nbsp;%v&#34;</span><span class="op" id="8557819">,</span>&nbsp;<span class="ident" id="8557821">tt</span><span class="op" id="8557823">.</span><span class="ident" id="8557824">in</span><span class="op" id="8557826">,</span>&nbsp;<span class="ident" id="8557828">tt</span><span class="op" id="8557830">.</span><span class="ident" id="8557831">mode</span><span class="op" id="8557835">,</span>&nbsp;<span class="op" id="8557837">!</span><span class="ident" id="8557838">tt</span><span class="op" id="8557840">.</span><span class="ident" id="8557841">escape</span><span class="op" id="8557847">,</span>&nbsp;<span class="ident" id="8557849">tt</span><span class="op" id="8557851">.</span><span class="ident" id="8557852">escape</span><span class="op" id="8557858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557862">}</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="8557865">}</span><br>
<span class="lineno"></span><span class="op" id="8557867">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
