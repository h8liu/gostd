<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime/multipart</h2>
<ul>
<li><a href="/gostd/mime/multipart/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/mime/multipart/formdata.go.html">formdata.go</a></li>
<li><a href="/gostd/mime/multipart/formdata_test.go.html">formdata_test.go</a></li>
<li><a href="/gostd/mime/multipart/multipart.go.html">multipart.go</a></li>
<li><a href="/gostd/mime/multipart/multipart_test.go.html">multipart_test.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable.go.html">quotedprintable.go</a></li>
<li><a href="/gostd/mime/multipart/quotedprintable_test.go.html" class="current">quotedprintable_test.go</a></li>
<li><a href="/gostd/mime/multipart/writer.go.html">writer.go</a></li>
<li><a href="/gostd/mime/multipart/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6708615">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6708670">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6708724">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6708775">package</span>&nbsp;<span class="ident" id="6708783">multipart</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6708794">import</span>&nbsp;<span class="op" id="6708801">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6708804">&#34;bufio&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6708813">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6708822">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6708832">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6708840">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6708847">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6708853">&#34;os/exec&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6708864">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6708874">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6708882">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6708893">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6708904">&#34;time&#34;</span><br>
<span class="lineno">20</span><span class="op" id="6708911">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6708914">func</span>&nbsp;<span class="ident" id="6708919">TestQuotedPrintable</span><span class="op" id="6708938">(</span><span class="ident" id="6708939">t</span>&nbsp;<span class="op" id="6708941">*</span><span class="ident" id="6708942">testing</span><span class="op" id="6708949">.</span><span class="ident" id="6708950">T</span><span class="op" id="6708951">)</span>&nbsp;<span class="op" id="6708953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6708956">tests</span>&nbsp;<span class="op" id="6708962">:=</span>&nbsp;<span class="op" id="6708965">[</span><span class="op" id="6708966">]</span><span class="keyword" id="6708967">struct</span>&nbsp;<span class="op" id="6708974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6708978">in</span><span class="op" id="6708980">,</span>&nbsp;<span class="ident" id="6708982">want</span>&nbsp;<span class="builtintype" id="6708987">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6708996">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6709005">interface</span><span class="op" id="6709014">{</span><span class="op" id="6709015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709018">}</span><span class="op" id="6709019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709023">{</span><span class="ident" id="6709024">in</span><span class="op" id="6709026">:</span>&nbsp;<span class="string" id="6709028">&#34;&#34;</span><span class="op" id="6709030">,</span>&nbsp;<span class="ident" id="6709032">want</span><span class="op" id="6709036">:</span>&nbsp;<span class="string" id="6709038">&#34;&#34;</span><span class="op" id="6709040">}</span><span class="op" id="6709041">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709045">{</span><span class="ident" id="6709046">in</span><span class="op" id="6709048">:</span>&nbsp;<span class="string" id="6709050">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6709059">,</span>&nbsp;<span class="ident" id="6709061">want</span><span class="op" id="6709065">:</span>&nbsp;<span class="string" id="6709067">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6709076">}</span><span class="op" id="6709077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709081">{</span><span class="ident" id="6709082">in</span><span class="op" id="6709084">:</span>&nbsp;<span class="string" id="6709086">&#34;foo&nbsp;bar=3D&#34;</span><span class="op" id="6709098">,</span>&nbsp;<span class="ident" id="6709100">want</span><span class="op" id="6709104">:</span>&nbsp;<span class="string" id="6709106">&#34;foo&nbsp;bar=&#34;</span><span class="op" id="6709116">}</span><span class="op" id="6709117">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709121">{</span><span class="ident" id="6709122">in</span><span class="op" id="6709124">:</span>&nbsp;<span class="string" id="6709126">&#34;foo&nbsp;bar=\n&#34;</span><span class="op" id="6709138">,</span>&nbsp;<span class="ident" id="6709140">want</span><span class="op" id="6709144">:</span>&nbsp;<span class="string" id="6709146">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6709155">}</span><span class="op" id="6709156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709160">{</span><span class="ident" id="6709161">in</span><span class="op" id="6709163">:</span>&nbsp;<span class="string" id="6709165">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="6709176">,</span>&nbsp;<span class="ident" id="6709178">want</span><span class="op" id="6709182">:</span>&nbsp;<span class="string" id="6709184">&#34;foo&nbsp;bar\n&#34;</span><span class="op" id="6709195">}</span><span class="op" id="6709196">,</span>&nbsp;<span class="comment" id="6709198">//&nbsp;somewhat&nbsp;lax.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709217">{</span><span class="ident" id="6709218">in</span><span class="op" id="6709220">:</span>&nbsp;<span class="string" id="6709222">&#34;foo&nbsp;bar=0&#34;</span><span class="op" id="6709233">,</span>&nbsp;<span class="ident" id="6709235">want</span><span class="op" id="6709239">:</span>&nbsp;<span class="string" id="6709241">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6709250">,</span>&nbsp;<span class="ident" id="6709252">err</span><span class="op" id="6709255">:</span>&nbsp;<span class="ident" id="6709257">io</span><span class="op" id="6709259">.</span><span class="ident" id="6709260">ErrUnexpectedEOF</span><span class="op" id="6709276">}</span><span class="op" id="6709277">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709281">{</span><span class="ident" id="6709282">in</span><span class="op" id="6709284">:</span>&nbsp;<span class="string" id="6709286">&#34;foo&nbsp;bar=ab&#34;</span><span class="op" id="6709298">,</span>&nbsp;<span class="ident" id="6709300">want</span><span class="op" id="6709304">:</span>&nbsp;<span class="string" id="6709306">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6709315">,</span>&nbsp;<span class="ident" id="6709317">err</span><span class="op" id="6709320">:</span>&nbsp;<span class="string" id="6709322">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x61&#34;</span><span class="op" id="6709373">}</span><span class="op" id="6709374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709378">{</span><span class="ident" id="6709379">in</span><span class="op" id="6709381">:</span>&nbsp;<span class="string" id="6709383">&#34;foo&nbsp;bar=0D=0A&#34;</span><span class="op" id="6709398">,</span>&nbsp;<span class="ident" id="6709400">want</span><span class="op" id="6709404">:</span>&nbsp;<span class="string" id="6709406">&#34;foo&nbsp;bar\r\n&#34;</span><span class="op" id="6709419">}</span><span class="op" id="6709420">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709424">{</span><span class="ident" id="6709425">in</span><span class="op" id="6709427">:</span>&nbsp;<span class="string" id="6709429">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="6709450">,</span>&nbsp;<span class="ident" id="6709452">want</span><span class="op" id="6709456">:</span>&nbsp;<span class="string" id="6709458">&#34;&nbsp;A&nbsp;B\r\n&nbsp;C&#34;</span><span class="op" id="6709470">}</span><span class="op" id="6709471">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709475">{</span><span class="ident" id="6709476">in</span><span class="op" id="6709478">:</span>&nbsp;<span class="string" id="6709480">&#34;&nbsp;A&nbsp;B&nbsp;=\r\n&nbsp;C&nbsp;&#34;</span><span class="op" id="6709495">,</span>&nbsp;<span class="ident" id="6709497">want</span><span class="op" id="6709501">:</span>&nbsp;<span class="string" id="6709503">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="6709512">}</span><span class="op" id="6709513">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709517">{</span><span class="ident" id="6709518">in</span><span class="op" id="6709520">:</span>&nbsp;<span class="string" id="6709522">&#34;&nbsp;A&nbsp;B&nbsp;=\n&nbsp;C&nbsp;&#34;</span><span class="op" id="6709535">,</span>&nbsp;<span class="ident" id="6709537">want</span><span class="op" id="6709541">:</span>&nbsp;<span class="string" id="6709543">&#34;&nbsp;A&nbsp;B&nbsp;&nbsp;C&#34;</span><span class="op" id="6709552">}</span><span class="op" id="6709553">,</span>&nbsp;<span class="comment" id="6709555">//&nbsp;lax.&nbsp;treating&nbsp;LF&nbsp;as&nbsp;CRLF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709585">{</span><span class="ident" id="6709586">in</span><span class="op" id="6709588">:</span>&nbsp;<span class="string" id="6709590">&#34;foo=\nbar&#34;</span><span class="op" id="6709601">,</span>&nbsp;<span class="ident" id="6709603">want</span><span class="op" id="6709607">:</span>&nbsp;<span class="string" id="6709609">&#34;foobar&#34;</span><span class="op" id="6709617">}</span><span class="op" id="6709618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709622">{</span><span class="ident" id="6709623">in</span><span class="op" id="6709625">:</span>&nbsp;<span class="string" id="6709627">&#34;foo\x00bar&#34;</span><span class="op" id="6709639">,</span>&nbsp;<span class="ident" id="6709641">want</span><span class="op" id="6709645">:</span>&nbsp;<span class="string" id="6709647">&#34;foo&#34;</span><span class="op" id="6709652">,</span>&nbsp;<span class="ident" id="6709654">err</span><span class="op" id="6709657">:</span>&nbsp;<span class="string" id="6709659">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0x00&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="6709724">}</span><span class="op" id="6709725">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709729">{</span><span class="ident" id="6709730">in</span><span class="op" id="6709732">:</span>&nbsp;<span class="string" id="6709734">&#34;foo&nbsp;bar\xff&#34;</span><span class="op" id="6709747">,</span>&nbsp;<span class="ident" id="6709749">want</span><span class="op" id="6709753">:</span>&nbsp;<span class="string" id="6709755">&#34;foo&nbsp;bar&#34;</span><span class="op" id="6709764">,</span>&nbsp;<span class="ident" id="6709766">err</span><span class="op" id="6709769">:</span>&nbsp;<span class="string" id="6709771">&#34;multipart:&nbsp;invalid&nbsp;unescaped&nbsp;byte&nbsp;0xff&nbsp;in&nbsp;quoted-printable&nbsp;body&#34;</span><span class="op" id="6709836">}</span><span class="op" id="6709837">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6709842">//&nbsp;Equal&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709859">{</span><span class="ident" id="6709860">in</span><span class="op" id="6709862">:</span>&nbsp;<span class="string" id="6709864">&#34;=3D30\n&#34;</span><span class="op" id="6709873">,</span>&nbsp;<span class="ident" id="6709875">want</span><span class="op" id="6709879">:</span>&nbsp;<span class="string" id="6709881">&#34;=30\n&#34;</span><span class="op" id="6709888">}</span><span class="op" id="6709889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709893">{</span><span class="ident" id="6709894">in</span><span class="op" id="6709896">:</span>&nbsp;<span class="string" id="6709898">&#34;=00=FF0=\n&#34;</span><span class="op" id="6709910">,</span>&nbsp;<span class="ident" id="6709912">want</span><span class="op" id="6709916">:</span>&nbsp;<span class="string" id="6709918">&#34;\x00\xff0&#34;</span><span class="op" id="6709929">}</span><span class="op" id="6709930">,</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6709935">//&nbsp;Trailing&nbsp;whitespace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709960">{</span><span class="ident" id="6709961">in</span><span class="op" id="6709963">:</span>&nbsp;<span class="string" id="6709965">&#34;foo&nbsp;&nbsp;\n&#34;</span><span class="op" id="6709974">,</span>&nbsp;<span class="ident" id="6709976">want</span><span class="op" id="6709980">:</span>&nbsp;<span class="string" id="6709982">&#34;foo\n&#34;</span><span class="op" id="6709989">}</span><span class="op" id="6709990">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6709994">{</span><span class="ident" id="6709995">in</span><span class="op" id="6709997">:</span>&nbsp;<span class="string" id="6709999">&#34;foo&nbsp;&nbsp;\n\nfoo&nbsp;=\n\nfoo=20\n\n&#34;</span><span class="op" id="6710029">,</span>&nbsp;<span class="ident" id="6710031">want</span><span class="op" id="6710035">:</span>&nbsp;<span class="string" id="6710037">&#34;foo\n\nfoo&nbsp;\nfoo&nbsp;\n\n&#34;</span><span class="op" id="6710060">}</span><span class="op" id="6710061">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6710066">//&nbsp;Tests&nbsp;that&nbsp;we&nbsp;allow&nbsp;bare&nbsp;\n&nbsp;and&nbsp;\r&nbsp;through,&nbsp;despite&nbsp;it&nbsp;being&nbsp;strictly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6710141">//&nbsp;not&nbsp;permitted&nbsp;per&nbsp;RFC&nbsp;2045,&nbsp;Section&nbsp;6.7&nbsp;Page&nbsp;22&nbsp;bullet&nbsp;(4).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6710206">{</span><span class="ident" id="6710207">in</span><span class="op" id="6710209">:</span>&nbsp;<span class="string" id="6710211">&#34;foo\nbar&#34;</span><span class="op" id="6710221">,</span>&nbsp;<span class="ident" id="6710223">want</span><span class="op" id="6710227">:</span>&nbsp;<span class="string" id="6710229">&#34;foo\nbar&#34;</span><span class="op" id="6710239">}</span><span class="op" id="6710240">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6710244">{</span><span class="ident" id="6710245">in</span><span class="op" id="6710247">:</span>&nbsp;<span class="string" id="6710249">&#34;foo\rbar&#34;</span><span class="op" id="6710259">,</span>&nbsp;<span class="ident" id="6710261">want</span><span class="op" id="6710265">:</span>&nbsp;<span class="string" id="6710267">&#34;foo\rbar&#34;</span><span class="op" id="6710277">}</span><span class="op" id="6710278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6710282">{</span><span class="ident" id="6710283">in</span><span class="op" id="6710285">:</span>&nbsp;<span class="string" id="6710287">&#34;foo\r\nbar&#34;</span><span class="op" id="6710299">,</span>&nbsp;<span class="ident" id="6710301">want</span><span class="op" id="6710305">:</span>&nbsp;<span class="string" id="6710307">&#34;foo\r\nbar&#34;</span><span class="op" id="6710319">}</span><span class="op" id="6710320">,</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6710325">//&nbsp;Different&nbsp;types&nbsp;of&nbsp;soft&nbsp;line-breaks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6710367">{</span><span class="ident" id="6710368">in</span><span class="op" id="6710370">:</span>&nbsp;<span class="string" id="6710372">&#34;foo=\r\nbar&#34;</span><span class="op" id="6710385">,</span>&nbsp;<span class="ident" id="6710387">want</span><span class="op" id="6710391">:</span>&nbsp;<span class="string" id="6710393">&#34;foobar&#34;</span><span class="op" id="6710401">}</span><span class="op" id="6710402">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6710406">{</span><span class="ident" id="6710407">in</span><span class="op" id="6710409">:</span>&nbsp;<span class="string" id="6710411">&#34;foo=\nbar&#34;</span><span class="op" id="6710422">,</span>&nbsp;<span class="ident" id="6710424">want</span><span class="op" id="6710428">:</span>&nbsp;<span class="string" id="6710430">&#34;foobar&#34;</span><span class="op" id="6710438">}</span><span class="op" id="6710439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6710443">{</span><span class="ident" id="6710444">in</span><span class="op" id="6710446">:</span>&nbsp;<span class="string" id="6710448">&#34;foo=\rbar&#34;</span><span class="op" id="6710459">,</span>&nbsp;<span class="ident" id="6710461">want</span><span class="op" id="6710465">:</span>&nbsp;<span class="string" id="6710467">&#34;foo&#34;</span><span class="op" id="6710472">,</span>&nbsp;<span class="ident" id="6710474">err</span><span class="op" id="6710477">:</span>&nbsp;<span class="string" id="6710479">&#34;multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d&#34;</span><span class="op" id="6710530">}</span><span class="op" id="6710531">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6710535">{</span><span class="ident" id="6710536">in</span><span class="op" id="6710538">:</span>&nbsp;<span class="string" id="6710540">&#34;foo=\r\r\r&nbsp;\nbar&#34;</span><span class="op" id="6710558">,</span>&nbsp;<span class="ident" id="6710560">want</span><span class="op" id="6710564">:</span>&nbsp;<span class="string" id="6710566">&#34;foo&#34;</span><span class="op" id="6710571">,</span>&nbsp;<span class="ident" id="6710573">err</span><span class="op" id="6710576">:</span>&nbsp;<span class="string" id="6710578">`multipart:&nbsp;invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;&#34;\r\r\r&nbsp;\n&#34;`</span><span class="op" id="6710625">}</span><span class="op" id="6710626">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6710631">//&nbsp;Example&nbsp;from&nbsp;RFC&nbsp;2045:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6710659">{</span><span class="ident" id="6710660">in</span><span class="op" id="6710662">:</span>&nbsp;<span class="string" id="6710664">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;=\n&#34;</span>&nbsp;<span class="op" id="6710685">+</span>&nbsp;<span class="string" id="6710687">&#34;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come=\n&#34;</span>&nbsp;<span class="op" id="6710713">+</span>&nbsp;<span class="string" id="6710715">&#34;&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="6710746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6710751">want</span><span class="op" id="6710755">:</span>&nbsp;<span class="string" id="6710757">&#34;Now&#39;s&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;folk&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="6710823">}</span><span class="op" id="6710824">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6710827">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6710830">for</span>&nbsp;<span class="ident" id="6710834">_</span><span class="op" id="6710835">,</span>&nbsp;<span class="ident" id="6710837">tt</span>&nbsp;<span class="op" id="6710840">:=</span>&nbsp;<span class="keyword" id="6710843">range</span>&nbsp;<span class="ident" id="6710849">tests</span>&nbsp;<span class="op" id="6710855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6710859">var</span>&nbsp;<span class="ident" id="6710863">buf</span>&nbsp;<span class="ident" id="6710867">bytes</span><span class="op" id="6710872">.</span><span class="ident" id="6710873">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6710882">_</span><span class="op" id="6710883">,</span>&nbsp;<span class="ident" id="6710885">err</span>&nbsp;<span class="op" id="6710889">:=</span>&nbsp;<span class="ident" id="6710892">io</span><span class="op" id="6710894">.</span><span class="ident" id="6710895">Copy</span><span class="op" id="6710899">(</span><span class="op" id="6710900">&amp;</span><span class="ident" id="6710901">buf</span><span class="op" id="6710904">,</span>&nbsp;<span class="ident" id="6710906">newQuotedPrintableReader</span><span class="op" id="6710930">(</span><span class="ident" id="6710931">strings</span><span class="op" id="6710938">.</span><span class="ident" id="6710939">NewReader</span><span class="op" id="6710948">(</span><span class="ident" id="6710949">tt</span><span class="op" id="6710951">.</span><span class="ident" id="6710952">in</span><span class="op" id="6710954">)</span><span class="op" id="6710955">)</span><span class="op" id="6710956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6710960">if</span>&nbsp;<span class="ident" id="6710963">got</span>&nbsp;<span class="op" id="6710967">:=</span>&nbsp;<span class="ident" id="6710970">buf</span><span class="op" id="6710973">.</span><span class="ident" id="6710974">String</span><span class="op" id="6710980">(</span><span class="op" id="6710981">)</span><span class="op" id="6710982">;</span>&nbsp;<span class="ident" id="6710984">got</span>&nbsp;<span class="op" id="6710988">!=</span>&nbsp;<span class="ident" id="6710991">tt</span><span class="op" id="6710993">.</span><span class="ident" id="6710994">want</span>&nbsp;<span class="op" id="6710999">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6711004">t</span><span class="op" id="6711005">.</span><span class="ident" id="6711006">Errorf</span><span class="op" id="6711012">(</span><span class="string" id="6711013">&#34;for&nbsp;%q,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6711038">,</span>&nbsp;<span class="ident" id="6711040">tt</span><span class="op" id="6711042">.</span><span class="ident" id="6711043">in</span><span class="op" id="6711045">,</span>&nbsp;<span class="ident" id="6711047">got</span><span class="op" id="6711050">,</span>&nbsp;<span class="ident" id="6711052">tt</span><span class="op" id="6711054">.</span><span class="ident" id="6711055">want</span><span class="op" id="6711059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6711063">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6711067">switch</span>&nbsp;<span class="ident" id="6711074">verr</span>&nbsp;<span class="op" id="6711079">:=</span>&nbsp;<span class="ident" id="6711082">tt</span><span class="op" id="6711084">.</span><span class="ident" id="6711085">err</span><span class="op" id="6711088">.</span><span class="op" id="6711089">(</span><span class="keyword" id="6711090">type</span><span class="op" id="6711094">)</span>&nbsp;<span class="op" id="6711096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6711100">case</span>&nbsp;<span class="ident" id="6711105">nil</span><span class="op" id="6711108">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6711113">if</span>&nbsp;<span class="ident" id="6711116">err</span>&nbsp;<span class="op" id="6711120">!=</span>&nbsp;<span class="ident" id="6711123">nil</span>&nbsp;<span class="op" id="6711127">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6711133">t</span><span class="op" id="6711134">.</span><span class="ident" id="6711135">Errorf</span><span class="op" id="6711141">(</span><span class="string" id="6711142">&#34;for&nbsp;%q,&nbsp;got&nbsp;unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6711176">,</span>&nbsp;<span class="ident" id="6711178">tt</span><span class="op" id="6711180">.</span><span class="ident" id="6711181">in</span><span class="op" id="6711183">,</span>&nbsp;<span class="ident" id="6711185">err</span><span class="op" id="6711188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6711193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6711197">case</span>&nbsp;<span class="builtintype" id="6711202">string</span><span class="op" id="6711208">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6711213">if</span>&nbsp;<span class="ident" id="6711216">got</span>&nbsp;<span class="op" id="6711220">:=</span>&nbsp;<span class="ident" id="6711223">fmt</span><span class="op" id="6711226">.</span><span class="ident" id="6711227">Sprint</span><span class="op" id="6711233">(</span><span class="ident" id="6711234">err</span><span class="op" id="6711237">)</span><span class="op" id="6711238">;</span>&nbsp;<span class="ident" id="6711240">got</span>&nbsp;<span class="op" id="6711244">!=</span>&nbsp;<span class="ident" id="6711247">verr</span>&nbsp;<span class="op" id="6711252">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6711258">t</span><span class="op" id="6711259">.</span><span class="ident" id="6711260">Errorf</span><span class="op" id="6711266">(</span><span class="string" id="6711267">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6711298">,</span>&nbsp;<span class="ident" id="6711300">tt</span><span class="op" id="6711302">.</span><span class="ident" id="6711303">in</span><span class="op" id="6711305">,</span>&nbsp;<span class="ident" id="6711307">got</span><span class="op" id="6711310">,</span>&nbsp;<span class="ident" id="6711312">verr</span><span class="op" id="6711316">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6711321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6711325">case</span>&nbsp;<span class="builtintype" id="6711330">error</span><span class="op" id="6711335">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6711340">if</span>&nbsp;<span class="ident" id="6711343">err</span>&nbsp;<span class="op" id="6711347">!=</span>&nbsp;<span class="ident" id="6711350">verr</span>&nbsp;<span class="op" id="6711355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6711361">t</span><span class="op" id="6711362">.</span><span class="ident" id="6711363">Errorf</span><span class="op" id="6711369">(</span><span class="string" id="6711370">&#34;for&nbsp;%q,&nbsp;got&nbsp;error&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6711401">,</span>&nbsp;<span class="ident" id="6711403">tt</span><span class="op" id="6711405">.</span><span class="ident" id="6711406">in</span><span class="op" id="6711408">,</span>&nbsp;<span class="ident" id="6711410">err</span><span class="op" id="6711413">,</span>&nbsp;<span class="ident" id="6711415">verr</span><span class="op" id="6711419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6711424">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6711428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6711431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="6711434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="6711437">func</span>&nbsp;<span class="ident" id="6711442">everySequence</span><span class="op" id="6711455">(</span><span class="ident" id="6711456">base</span><span class="op" id="6711460">,</span>&nbsp;<span class="ident" id="6711462">alpha</span>&nbsp;<span class="builtintype" id="6711468">string</span><span class="op" id="6711474">,</span>&nbsp;<span class="ident" id="6711476">length</span>&nbsp;<span class="builtintype" id="6711483">int</span><span class="op" id="6711486">,</span>&nbsp;<span class="ident" id="6711488">fn</span>&nbsp;<span class="keyword" id="6711491">func</span><span class="op" id="6711495">(</span><span class="builtintype" id="6711496">string</span><span class="op" id="6711502">)</span><span class="op" id="6711503">)</span>&nbsp;<span class="op" id="6711505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6711508">if</span>&nbsp;<span class="builtinfunc" id="6711511">len</span><span class="op" id="6711514">(</span><span class="ident" id="6711515">base</span><span class="op" id="6711519">)</span>&nbsp;<span class="op" id="6711521">==</span>&nbsp;<span class="ident" id="6711524">length</span>&nbsp;<span class="op" id="6711531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6711535">fn</span><span class="op" id="6711537">(</span><span class="ident" id="6711538">base</span><span class="op" id="6711542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6711546">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6711554">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6711557">for</span>&nbsp;<span class="ident" id="6711561">i</span>&nbsp;<span class="op" id="6711563">:=</span>&nbsp;<span class="num" id="6711566">0</span><span class="op" id="6711567">;</span>&nbsp;<span class="ident" id="6711569">i</span>&nbsp;<span class="op" id="6711571">&lt;</span>&nbsp;<span class="builtinfunc" id="6711573">len</span><span class="op" id="6711576">(</span><span class="ident" id="6711577">alpha</span><span class="op" id="6711582">)</span><span class="op" id="6711583">;</span>&nbsp;<span class="ident" id="6711585">i</span><span class="op" id="6711586">++</span>&nbsp;<span class="op" id="6711589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6711593">everySequence</span><span class="op" id="6711606">(</span><span class="ident" id="6711607">base</span><span class="op" id="6711611">+</span><span class="ident" id="6711612">alpha</span><span class="op" id="6711617">[</span><span class="ident" id="6711618">i</span><span class="op" id="6711619">:</span><span class="ident" id="6711620">i</span><span class="op" id="6711621">+</span><span class="num" id="6711622">1</span><span class="op" id="6711623">]</span><span class="op" id="6711624">,</span>&nbsp;<span class="ident" id="6711626">alpha</span><span class="op" id="6711631">,</span>&nbsp;<span class="ident" id="6711633">length</span><span class="op" id="6711639">,</span>&nbsp;<span class="ident" id="6711641">fn</span><span class="op" id="6711643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6711646">}</span><br>
<span class="lineno"></span><span class="op" id="6711648">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="6711651">var</span>&nbsp;<span class="ident" id="6711655">useQprint</span>&nbsp;<span class="op" id="6711665">=</span>&nbsp;<span class="ident" id="6711667">flag</span><span class="op" id="6711671">.</span><span class="ident" id="6711672">Bool</span><span class="op" id="6711676">(</span><span class="string" id="6711677">&#34;qprint&#34;</span><span class="op" id="6711685">,</span>&nbsp;<span class="builtintype" id="6711687">false</span><span class="op" id="6711692">,</span>&nbsp;<span class="string" id="6711694">&#34;Compare&nbsp;against&nbsp;the&nbsp;&#39;qprint&#39;&nbsp;program.&#34;</span><span class="op" id="6711733">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6711736">var</span>&nbsp;<span class="ident" id="6711740">badSoftRx</span>&nbsp;<span class="op" id="6711750">=</span>&nbsp;<span class="ident" id="6711752">regexp</span><span class="op" id="6711758">.</span><span class="ident" id="6711759">MustCompile</span><span class="op" id="6711770">(</span><span class="string" id="6711771">`=([^\r\n]+?\n)|([^\r\n]+$)|(\r$)|(\r[^\n]+\n)|(&nbsp;\r\n)`</span><span class="op" id="6711826">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6711829">func</span>&nbsp;<span class="ident" id="6711834">TestQPExhaustive</span><span class="op" id="6711850">(</span><span class="ident" id="6711851">t</span>&nbsp;<span class="op" id="6711853">*</span><span class="ident" id="6711854">testing</span><span class="op" id="6711861">.</span><span class="ident" id="6711862">T</span><span class="op" id="6711863">)</span>&nbsp;<span class="op" id="6711865">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6711868">if</span>&nbsp;<span class="op" id="6711871">*</span><span class="ident" id="6711872">useQprint</span>&nbsp;<span class="op" id="6711882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6711886">_</span><span class="op" id="6711887">,</span>&nbsp;<span class="ident" id="6711889">err</span>&nbsp;<span class="op" id="6711893">:=</span>&nbsp;<span class="ident" id="6711896">exec</span><span class="op" id="6711900">.</span><span class="ident" id="6711901">LookPath</span><span class="op" id="6711909">(</span><span class="string" id="6711910">&#34;qprint&#34;</span><span class="op" id="6711918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6711922">if</span>&nbsp;<span class="ident" id="6711925">err</span>&nbsp;<span class="op" id="6711929">!=</span>&nbsp;<span class="ident" id="6711932">nil</span>&nbsp;<span class="op" id="6711936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6711941">t</span><span class="op" id="6711942">.</span><span class="ident" id="6711943">Fatalf</span><span class="op" id="6711949">(</span><span class="string" id="6711950">&#34;Error&nbsp;looking&nbsp;for&nbsp;qprint:&nbsp;%v&#34;</span><span class="op" id="6711980">,</span>&nbsp;<span class="ident" id="6711982">err</span><span class="op" id="6711985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6711989">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6711992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6711996">var</span>&nbsp;<span class="ident" id="6712000">buf</span>&nbsp;<span class="ident" id="6712004">bytes</span><span class="op" id="6712009">.</span><span class="ident" id="6712010">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6712018">res</span>&nbsp;<span class="op" id="6712022">:=</span>&nbsp;<span class="builtinfunc" id="6712025">make</span><span class="op" id="6712029">(</span><span class="keyword" id="6712030">map</span><span class="op" id="6712033">[</span><span class="builtintype" id="6712034">string</span><span class="op" id="6712040">]</span><span class="builtintype" id="6712041">int</span><span class="op" id="6712044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6712047">everySequence</span><span class="op" id="6712060">(</span><span class="string" id="6712061">&#34;&#34;</span><span class="op" id="6712063">,</span>&nbsp;<span class="string" id="6712065">&#34;0A&nbsp;\r\n=&#34;</span><span class="op" id="6712075">,</span>&nbsp;<span class="num" id="6712077">6</span><span class="op" id="6712078">,</span>&nbsp;<span class="keyword" id="6712080">func</span><span class="op" id="6712084">(</span><span class="ident" id="6712085">s</span>&nbsp;<span class="builtintype" id="6712087">string</span><span class="op" id="6712093">)</span>&nbsp;<span class="op" id="6712095">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6712099">if</span>&nbsp;<span class="ident" id="6712102">strings</span><span class="op" id="6712109">.</span><span class="ident" id="6712110">HasSuffix</span><span class="op" id="6712119">(</span><span class="ident" id="6712120">s</span><span class="op" id="6712121">,</span>&nbsp;<span class="string" id="6712123">&#34;=&#34;</span><span class="op" id="6712126">)</span>&nbsp;<span class="op" id="6712128">||</span>&nbsp;<span class="ident" id="6712131">strings</span><span class="op" id="6712138">.</span><span class="ident" id="6712139">Contains</span><span class="op" id="6712147">(</span><span class="ident" id="6712148">s</span><span class="op" id="6712149">,</span>&nbsp;<span class="string" id="6712151">&#34;==&#34;</span><span class="op" id="6712155">)</span>&nbsp;<span class="op" id="6712157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6712162">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6712171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6712175">buf</span><span class="op" id="6712178">.</span><span class="ident" id="6712179">Reset</span><span class="op" id="6712184">(</span><span class="op" id="6712185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6712189">_</span><span class="op" id="6712190">,</span>&nbsp;<span class="ident" id="6712192">err</span>&nbsp;<span class="op" id="6712196">:=</span>&nbsp;<span class="ident" id="6712199">io</span><span class="op" id="6712201">.</span><span class="ident" id="6712202">Copy</span><span class="op" id="6712206">(</span><span class="op" id="6712207">&amp;</span><span class="ident" id="6712208">buf</span><span class="op" id="6712211">,</span>&nbsp;<span class="ident" id="6712213">newQuotedPrintableReader</span><span class="op" id="6712237">(</span><span class="ident" id="6712238">strings</span><span class="op" id="6712245">.</span><span class="ident" id="6712246">NewReader</span><span class="op" id="6712255">(</span><span class="ident" id="6712256">s</span><span class="op" id="6712257">)</span><span class="op" id="6712258">)</span><span class="op" id="6712259">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6712263">if</span>&nbsp;<span class="ident" id="6712266">err</span>&nbsp;<span class="op" id="6712270">!=</span>&nbsp;<span class="ident" id="6712273">nil</span>&nbsp;<span class="op" id="6712277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6712282">errStr</span>&nbsp;<span class="op" id="6712289">:=</span>&nbsp;<span class="ident" id="6712292">err</span><span class="op" id="6712295">.</span><span class="ident" id="6712296">Error</span><span class="op" id="6712301">(</span><span class="op" id="6712302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6712307">if</span>&nbsp;<span class="ident" id="6712310">strings</span><span class="op" id="6712317">.</span><span class="ident" id="6712318">Contains</span><span class="op" id="6712326">(</span><span class="ident" id="6712327">errStr</span><span class="op" id="6712333">,</span>&nbsp;<span class="string" id="6712335">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=:&#34;</span><span class="op" id="6712359">)</span>&nbsp;<span class="op" id="6712361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6712367">errStr</span>&nbsp;<span class="op" id="6712374">=</span>&nbsp;<span class="string" id="6712376">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6712403">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6712408">res</span><span class="op" id="6712411">[</span><span class="ident" id="6712412">errStr</span><span class="op" id="6712418">]</span><span class="op" id="6712419">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6712425">if</span>&nbsp;<span class="ident" id="6712428">strings</span><span class="op" id="6712435">.</span><span class="ident" id="6712436">Contains</span><span class="op" id="6712444">(</span><span class="ident" id="6712445">errStr</span><span class="op" id="6712451">,</span>&nbsp;<span class="string" id="6712453">&#34;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;&#34;</span><span class="op" id="6712489">)</span>&nbsp;<span class="op" id="6712491">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6712497">if</span>&nbsp;<span class="ident" id="6712500">strings</span><span class="op" id="6712507">.</span><span class="ident" id="6712508">HasSuffix</span><span class="op" id="6712517">(</span><span class="ident" id="6712518">errStr</span><span class="op" id="6712524">,</span>&nbsp;<span class="string" id="6712526">&#34;0x20&#34;</span><span class="op" id="6712532">)</span>&nbsp;<span class="op" id="6712534">&amp;&amp;</span>&nbsp;<span class="op" id="6712537">(</span><span class="ident" id="6712538">strings</span><span class="op" id="6712545">.</span><span class="ident" id="6712546">Contains</span><span class="op" id="6712554">(</span><span class="ident" id="6712555">s</span><span class="op" id="6712556">,</span>&nbsp;<span class="string" id="6712558">&#34;=0&nbsp;&#34;</span><span class="op" id="6712563">)</span>&nbsp;<span class="op" id="6712565">||</span>&nbsp;<span class="ident" id="6712568">strings</span><span class="op" id="6712575">.</span><span class="ident" id="6712576">Contains</span><span class="op" id="6712584">(</span><span class="ident" id="6712585">s</span><span class="op" id="6712586">,</span>&nbsp;<span class="string" id="6712588">&#34;=A&nbsp;&#34;</span><span class="op" id="6712593">)</span>&nbsp;<span class="op" id="6712595">||</span>&nbsp;<span class="ident" id="6712598">strings</span><span class="op" id="6712605">.</span><span class="ident" id="6712606">Contains</span><span class="op" id="6712614">(</span><span class="ident" id="6712615">s</span><span class="op" id="6712616">,</span>&nbsp;<span class="string" id="6712618">&#34;=&nbsp;&#34;</span><span class="op" id="6712622">)</span><span class="op" id="6712623">)</span>&nbsp;<span class="op" id="6712625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6712632">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6712643">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6712649">if</span>&nbsp;<span class="ident" id="6712652">strings</span><span class="op" id="6712659">.</span><span class="ident" id="6712660">HasSuffix</span><span class="op" id="6712669">(</span><span class="ident" id="6712670">errStr</span><span class="op" id="6712676">,</span>&nbsp;<span class="string" id="6712678">&#34;0x3d&#34;</span><span class="op" id="6712684">)</span>&nbsp;<span class="op" id="6712686">&amp;&amp;</span>&nbsp;<span class="op" id="6712689">(</span><span class="ident" id="6712690">strings</span><span class="op" id="6712697">.</span><span class="ident" id="6712698">Contains</span><span class="op" id="6712706">(</span><span class="ident" id="6712707">s</span><span class="op" id="6712708">,</span>&nbsp;<span class="string" id="6712710">&#34;=0=&#34;</span><span class="op" id="6712715">)</span>&nbsp;<span class="op" id="6712717">||</span>&nbsp;<span class="ident" id="6712720">strings</span><span class="op" id="6712727">.</span><span class="ident" id="6712728">Contains</span><span class="op" id="6712736">(</span><span class="ident" id="6712737">s</span><span class="op" id="6712738">,</span>&nbsp;<span class="string" id="6712740">&#34;=A=&#34;</span><span class="op" id="6712745">)</span><span class="op" id="6712746">)</span>&nbsp;<span class="op" id="6712748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6712755">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6712766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6712772">if</span>&nbsp;<span class="ident" id="6712775">strings</span><span class="op" id="6712782">.</span><span class="ident" id="6712783">HasSuffix</span><span class="op" id="6712792">(</span><span class="ident" id="6712793">errStr</span><span class="op" id="6712799">,</span>&nbsp;<span class="string" id="6712801">&#34;0x0a&#34;</span><span class="op" id="6712807">)</span>&nbsp;<span class="op" id="6712809">||</span>&nbsp;<span class="ident" id="6712812">strings</span><span class="op" id="6712819">.</span><span class="ident" id="6712820">HasSuffix</span><span class="op" id="6712829">(</span><span class="ident" id="6712830">errStr</span><span class="op" id="6712836">,</span>&nbsp;<span class="string" id="6712838">&#34;0x0d&#34;</span><span class="op" id="6712844">)</span>&nbsp;<span class="op" id="6712846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6712853">//&nbsp;bunch&nbsp;of&nbsp;cases;&nbsp;since&nbsp;whitespace&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;line&nbsp;before&nbsp;\n&nbsp;is&nbsp;removed.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6712937">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6712948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6712953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6712958">if</span>&nbsp;<span class="ident" id="6712961">strings</span><span class="op" id="6712968">.</span><span class="ident" id="6712969">Contains</span><span class="op" id="6712977">(</span><span class="ident" id="6712978">errStr</span><span class="op" id="6712984">,</span>&nbsp;<span class="string" id="6712986">&#34;unexpected&nbsp;EOF&#34;</span><span class="op" id="6713002">)</span>&nbsp;<span class="op" id="6713004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713010">return</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6713020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713025">if</span>&nbsp;<span class="ident" id="6713028">errStr</span>&nbsp;<span class="op" id="6713035">==</span>&nbsp;<span class="string" id="6713038">&#34;invalid&nbsp;bytes&nbsp;after&nbsp;=&#34;</span>&nbsp;<span class="op" id="6713062">&amp;&amp;</span>&nbsp;<span class="ident" id="6713065">badSoftRx</span><span class="op" id="6713074">.</span><span class="ident" id="6713075">MatchString</span><span class="op" id="6713086">(</span><span class="ident" id="6713087">s</span><span class="op" id="6713088">)</span>&nbsp;<span class="op" id="6713090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713096">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6713106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713111">t</span><span class="op" id="6713112">.</span><span class="ident" id="6713113">Errorf</span><span class="op" id="6713119">(</span><span class="string" id="6713120">&#34;decode(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="6713137">,</span>&nbsp;<span class="ident" id="6713139">s</span><span class="op" id="6713140">,</span>&nbsp;<span class="ident" id="6713142">err</span><span class="op" id="6713145">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713150">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6713159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713163">if</span>&nbsp;<span class="op" id="6713166">*</span><span class="ident" id="6713167">useQprint</span>&nbsp;<span class="op" id="6713177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713182">cmd</span>&nbsp;<span class="op" id="6713186">:=</span>&nbsp;<span class="ident" id="6713189">exec</span><span class="op" id="6713193">.</span><span class="ident" id="6713194">Command</span><span class="op" id="6713201">(</span><span class="string" id="6713202">&#34;qprint&#34;</span><span class="op" id="6713210">,</span>&nbsp;<span class="string" id="6713212">&#34;-d&#34;</span><span class="op" id="6713216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713221">cmd</span><span class="op" id="6713224">.</span><span class="ident" id="6713225">Stdin</span>&nbsp;<span class="op" id="6713231">=</span>&nbsp;<span class="ident" id="6713233">strings</span><span class="op" id="6713240">.</span><span class="ident" id="6713241">NewReader</span><span class="op" id="6713250">(</span><span class="ident" id="6713251">s</span><span class="op" id="6713252">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713257">stderr</span><span class="op" id="6713263">,</span>&nbsp;<span class="ident" id="6713265">err</span>&nbsp;<span class="op" id="6713269">:=</span>&nbsp;<span class="ident" id="6713272">cmd</span><span class="op" id="6713275">.</span><span class="ident" id="6713276">StderrPipe</span><span class="op" id="6713286">(</span><span class="op" id="6713287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713292">if</span>&nbsp;<span class="ident" id="6713295">err</span>&nbsp;<span class="op" id="6713299">!=</span>&nbsp;<span class="ident" id="6713302">nil</span>&nbsp;<span class="op" id="6713306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6713312">panic</span><span class="op" id="6713317">(</span><span class="ident" id="6713318">err</span><span class="op" id="6713321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6713326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713331">qpres</span>&nbsp;<span class="op" id="6713337">:=</span>&nbsp;<span class="builtinfunc" id="6713340">make</span><span class="op" id="6713344">(</span><span class="keyword" id="6713345">chan</span>&nbsp;<span class="keyword" id="6713350">interface</span><span class="op" id="6713359">{</span><span class="op" id="6713360">}</span><span class="op" id="6713361">,</span>&nbsp;<span class="num" id="6713363">2</span><span class="op" id="6713364">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713369">go</span>&nbsp;<span class="keyword" id="6713372">func</span><span class="op" id="6713376">(</span><span class="op" id="6713377">)</span>&nbsp;<span class="op" id="6713379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713385">br</span>&nbsp;<span class="op" id="6713388">:=</span>&nbsp;<span class="ident" id="6713391">bufio</span><span class="op" id="6713396">.</span><span class="ident" id="6713397">NewReader</span><span class="op" id="6713406">(</span><span class="ident" id="6713407">stderr</span><span class="op" id="6713413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713419">s</span><span class="op" id="6713420">,</span>&nbsp;<span class="ident" id="6713422">_</span>&nbsp;<span class="op" id="6713424">:=</span>&nbsp;<span class="ident" id="6713427">br</span><span class="op" id="6713429">.</span><span class="ident" id="6713430">ReadString</span><span class="op" id="6713440">(</span><span class="string" id="6713441">&#39;\n&#39;</span><span class="op" id="6713445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713451">if</span>&nbsp;<span class="ident" id="6713454">s</span>&nbsp;<span class="op" id="6713456">!=</span>&nbsp;<span class="string" id="6713459">&#34;&#34;</span>&nbsp;<span class="op" id="6713462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713469">qpres</span>&nbsp;<span class="op" id="6713475">&lt;-</span>&nbsp;<span class="ident" id="6713478">errors</span><span class="op" id="6713484">.</span><span class="ident" id="6713485">New</span><span class="op" id="6713488">(</span><span class="ident" id="6713489">s</span><span class="op" id="6713490">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713497">if</span>&nbsp;<span class="ident" id="6713500">cmd</span><span class="op" id="6713503">.</span><span class="ident" id="6713504">Process</span>&nbsp;<span class="op" id="6713512">!=</span>&nbsp;<span class="ident" id="6713515">nil</span>&nbsp;<span class="op" id="6713519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6713527">//&nbsp;It&nbsp;can&nbsp;get&nbsp;stuck&nbsp;on&nbsp;invalid&nbsp;input,&nbsp;like:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6713577">//&nbsp;echo&nbsp;-n&nbsp;&#34;0000=&nbsp;&#34;&nbsp;|&nbsp;qprint&nbsp;-d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713615">cmd</span><span class="op" id="6713618">.</span><span class="ident" id="6713619">Process</span><span class="op" id="6713626">.</span><span class="ident" id="6713627">Kill</span><span class="op" id="6713631">(</span><span class="op" id="6713632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6713639">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6713645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6713650">}</span><span class="op" id="6713651">(</span><span class="op" id="6713652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713657">go</span>&nbsp;<span class="keyword" id="6713660">func</span><span class="op" id="6713664">(</span><span class="op" id="6713665">)</span>&nbsp;<span class="op" id="6713667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713673">want</span><span class="op" id="6713677">,</span>&nbsp;<span class="ident" id="6713679">err</span>&nbsp;<span class="op" id="6713683">:=</span>&nbsp;<span class="ident" id="6713686">cmd</span><span class="op" id="6713689">.</span><span class="ident" id="6713690">Output</span><span class="op" id="6713696">(</span><span class="op" id="6713697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713703">if</span>&nbsp;<span class="ident" id="6713706">err</span>&nbsp;<span class="op" id="6713710">==</span>&nbsp;<span class="ident" id="6713713">nil</span>&nbsp;<span class="op" id="6713717">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713724">qpres</span>&nbsp;<span class="op" id="6713730">&lt;-</span>&nbsp;<span class="ident" id="6713733">want</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6713742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6713747">}</span><span class="op" id="6713748">(</span><span class="op" id="6713749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713754">select</span>&nbsp;<span class="op" id="6713761">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713766">case</span>&nbsp;<span class="ident" id="6713771">got</span>&nbsp;<span class="op" id="6713775">:=</span>&nbsp;<span class="op" id="6713778">&lt;-</span><span class="ident" id="6713780">qpres</span><span class="op" id="6713785">:</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713791">if</span>&nbsp;<span class="ident" id="6713794">want</span><span class="op" id="6713798">,</span>&nbsp;<span class="ident" id="6713800">ok</span>&nbsp;<span class="op" id="6713803">:=</span>&nbsp;<span class="ident" id="6713806">got</span><span class="op" id="6713809">.</span><span class="op" id="6713810">(</span><span class="op" id="6713811">[</span><span class="op" id="6713812">]</span><span class="builtintype" id="6713813">byte</span><span class="op" id="6713817">)</span><span class="op" id="6713818">;</span>&nbsp;<span class="ident" id="6713820">ok</span>&nbsp;<span class="op" id="6713823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6713830">if</span>&nbsp;<span class="builtintype" id="6713833">string</span><span class="op" id="6713839">(</span><span class="ident" id="6713840">want</span><span class="op" id="6713844">)</span>&nbsp;<span class="op" id="6713846">!=</span>&nbsp;<span class="ident" id="6713849">buf</span><span class="op" id="6713852">.</span><span class="ident" id="6713853">String</span><span class="op" id="6713859">(</span><span class="op" id="6713860">)</span>&nbsp;<span class="op" id="6713862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713870">t</span><span class="op" id="6713871">.</span><span class="ident" id="6713872">Errorf</span><span class="op" id="6713878">(</span><span class="string" id="6713879">&#34;go&nbsp;decode(%q)&nbsp;=&nbsp;%q;&nbsp;qprint&nbsp;=&nbsp;%q&#34;</span><span class="op" id="6713912">,</span>&nbsp;<span class="ident" id="6713914">s</span><span class="op" id="6713915">,</span>&nbsp;<span class="ident" id="6713917">want</span><span class="op" id="6713921">,</span>&nbsp;<span class="ident" id="6713923">buf</span><span class="op" id="6713926">.</span><span class="ident" id="6713927">String</span><span class="op" id="6713933">(</span><span class="op" id="6713934">)</span><span class="op" id="6713935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6713942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6713948">}</span>&nbsp;<span class="keyword" id="6713950">else</span>&nbsp;<span class="op" id="6713955">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6713962">t</span><span class="op" id="6713963">.</span><span class="ident" id="6713964">Logf</span><span class="op" id="6713968">(</span><span class="string" id="6713969">&#34;qprint&nbsp;-d(%q)&nbsp;=&nbsp;%v&#34;</span><span class="op" id="6713989">,</span>&nbsp;<span class="ident" id="6713991">s</span><span class="op" id="6713992">,</span>&nbsp;<span class="ident" id="6713994">got</span><span class="op" id="6713997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6714003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6714008">case</span>&nbsp;<span class="op" id="6714013">&lt;-</span><span class="ident" id="6714015">time</span><span class="op" id="6714019">.</span><span class="ident" id="6714020">After</span><span class="op" id="6714025">(</span><span class="num" id="6714026">5</span>&nbsp;<span class="op" id="6714028">*</span>&nbsp;<span class="ident" id="6714030">time</span><span class="op" id="6714034">.</span><span class="ident" id="6714035">Second</span><span class="op" id="6714041">)</span><span class="op" id="6714042">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6714048">t</span><span class="op" id="6714049">.</span><span class="ident" id="6714050">Logf</span><span class="op" id="6714054">(</span><span class="string" id="6714055">&#34;qprint&nbsp;timeout&nbsp;on&nbsp;%q&#34;</span><span class="op" id="6714077">,</span>&nbsp;<span class="ident" id="6714079">s</span><span class="op" id="6714080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6714085">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6714089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6714093">res</span><span class="op" id="6714096">[</span><span class="string" id="6714097">&#34;OK&#34;</span><span class="op" id="6714101">]</span><span class="op" id="6714102">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6714106">}</span><span class="op" id="6714107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6714110">var</span>&nbsp;<span class="ident" id="6714114">outcomes</span>&nbsp;<span class="op" id="6714123">[</span><span class="op" id="6714124">]</span><span class="builtintype" id="6714125">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6714133">for</span>&nbsp;<span class="ident" id="6714137">k</span><span class="op" id="6714138">,</span>&nbsp;<span class="ident" id="6714140">v</span>&nbsp;<span class="op" id="6714142">:=</span>&nbsp;<span class="keyword" id="6714145">range</span>&nbsp;<span class="ident" id="6714151">res</span>&nbsp;<span class="op" id="6714155">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6714159">outcomes</span>&nbsp;<span class="op" id="6714168">=</span>&nbsp;<span class="builtinfunc" id="6714170">append</span><span class="op" id="6714176">(</span><span class="ident" id="6714177">outcomes</span><span class="op" id="6714185">,</span>&nbsp;<span class="ident" id="6714187">fmt</span><span class="op" id="6714190">.</span><span class="ident" id="6714191">Sprintf</span><span class="op" id="6714198">(</span><span class="string" id="6714199">&#34;%v:&nbsp;%d&#34;</span><span class="op" id="6714207">,</span>&nbsp;<span class="ident" id="6714209">k</span><span class="op" id="6714210">,</span>&nbsp;<span class="ident" id="6714212">v</span><span class="op" id="6714213">)</span><span class="op" id="6714214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6714217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6714220">sort</span><span class="op" id="6714224">.</span><span class="ident" id="6714225">Strings</span><span class="op" id="6714232">(</span><span class="ident" id="6714233">outcomes</span><span class="op" id="6714241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6714244">got</span>&nbsp;<span class="op" id="6714248">:=</span>&nbsp;<span class="ident" id="6714251">strings</span><span class="op" id="6714258">.</span><span class="ident" id="6714259">Join</span><span class="op" id="6714263">(</span><span class="ident" id="6714264">outcomes</span><span class="op" id="6714272">,</span>&nbsp;<span class="string" id="6714274">&#34;\n&#34;</span><span class="op" id="6714278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6714281">want</span>&nbsp;<span class="op" id="6714286">:=</span>&nbsp;<span class="string" id="6714289">`OK:&nbsp;21576<br>
<span class="lineno">195</span>invalid&nbsp;bytes&nbsp;after&nbsp;=:&nbsp;3397<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0a:&nbsp;1400<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x0d:&nbsp;2700<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x20:&nbsp;2490<br>
<span class="lineno"></span>multipart:&nbsp;invalid&nbsp;quoted-printable&nbsp;hex&nbsp;byte&nbsp;0x3d:&nbsp;440<br>
<span class="lineno">200</span>unexpected&nbsp;EOF:&nbsp;3122`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6714574">if</span>&nbsp;<span class="ident" id="6714577">got</span>&nbsp;<span class="op" id="6714581">!=</span>&nbsp;<span class="ident" id="6714584">want</span>&nbsp;<span class="op" id="6714589">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6714593">t</span><span class="op" id="6714594">.</span><span class="ident" id="6714595">Errorf</span><span class="op" id="6714601">(</span><span class="string" id="6714602">&#34;Got:\n%s\nWant:\n%s&#34;</span><span class="op" id="6714623">,</span>&nbsp;<span class="ident" id="6714625">got</span><span class="op" id="6714628">,</span>&nbsp;<span class="ident" id="6714630">want</span><span class="op" id="6714634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6714637">}</span><br>
<span class="lineno"></span><span class="op" id="6714639">}</span>
</div>
</body>
</html>
