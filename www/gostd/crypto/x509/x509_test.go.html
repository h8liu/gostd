<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html" class="current">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7751485">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7751540">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7751594">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7751645">package</span>&nbsp;<span class="ident" id="7751653">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7751659">import</span>&nbsp;<span class="op" id="7751666">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7751669">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7751678">&#34;crypto/dsa&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7751692">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7751708">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7751727">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7751742">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7751756">_</span>&nbsp;<span class="string" id="7751758">&#34;crypto/sha256&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7751775">_</span>&nbsp;<span class="string" id="7751777">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7751794">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7751814">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7751831">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7751850">&#34;encoding/hex&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7751866">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7751882">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7751894">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7751901">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7751912">&#34;reflect&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7751923">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7751934">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7751945">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7751952">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="7751955">func</span>&nbsp;<span class="ident" id="7751960">TestParsePKCS1PrivateKey</span><span class="op" id="7751984">(</span><span class="ident" id="7751985">t</span>&nbsp;<span class="op" id="7751987">*</span><span class="ident" id="7751988">testing</span><span class="op" id="7751995">.</span><span class="ident" id="7751996">T</span><span class="op" id="7751997">)</span>&nbsp;<span class="op" id="7751999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7752002">block</span><span class="op" id="7752007">,</span>&nbsp;<span class="ident" id="7752009">_</span>&nbsp;<span class="op" id="7752011">:=</span>&nbsp;<span class="ident" id="7752014">pem</span><span class="op" id="7752017">.</span><span class="ident" id="7752018">Decode</span><span class="op" id="7752024">(</span><span class="op" id="7752025">[</span><span class="op" id="7752026">]</span><span class="builtintype" id="7752027">byte</span><span class="op" id="7752031">(</span><span class="ident" id="7752032">pemPrivateKey</span><span class="op" id="7752045">)</span><span class="op" id="7752046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7752049">priv</span><span class="op" id="7752053">,</span>&nbsp;<span class="ident" id="7752055">err</span>&nbsp;<span class="op" id="7752059">:=</span>&nbsp;<span class="ident" id="7752062">ParsePKCS1PrivateKey</span><span class="op" id="7752082">(</span><span class="ident" id="7752083">block</span><span class="op" id="7752088">.</span><span class="ident" id="7752089">Bytes</span><span class="op" id="7752094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7752097">if</span>&nbsp;<span class="ident" id="7752100">err</span>&nbsp;<span class="op" id="7752104">!=</span>&nbsp;<span class="ident" id="7752107">nil</span>&nbsp;<span class="op" id="7752111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7752115">t</span><span class="op" id="7752116">.</span><span class="ident" id="7752117">Errorf</span><span class="op" id="7752123">(</span><span class="string" id="7752124">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7752157">,</span>&nbsp;<span class="ident" id="7752159">err</span><span class="op" id="7752162">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7752166">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7752174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7752177">if</span>&nbsp;<span class="ident" id="7752180">priv</span><span class="op" id="7752184">.</span><span class="ident" id="7752185">PublicKey</span><span class="op" id="7752194">.</span><span class="ident" id="7752195">N</span><span class="op" id="7752196">.</span><span class="ident" id="7752197">Cmp</span><span class="op" id="7752200">(</span><span class="ident" id="7752201">rsaPrivateKey</span><span class="op" id="7752214">.</span><span class="ident" id="7752215">PublicKey</span><span class="op" id="7752224">.</span><span class="ident" id="7752225">N</span><span class="op" id="7752226">)</span>&nbsp;<span class="op" id="7752228">!=</span>&nbsp;<span class="num" id="7752231">0</span>&nbsp;<span class="op" id="7752233">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7752238">priv</span><span class="op" id="7752242">.</span><span class="ident" id="7752243">PublicKey</span><span class="op" id="7752252">.</span><span class="ident" id="7752253">E</span>&nbsp;<span class="op" id="7752255">!=</span>&nbsp;<span class="ident" id="7752258">rsaPrivateKey</span><span class="op" id="7752271">.</span><span class="ident" id="7752272">PublicKey</span><span class="op" id="7752281">.</span><span class="ident" id="7752282">E</span>&nbsp;<span class="op" id="7752284">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7752289">priv</span><span class="op" id="7752293">.</span><span class="ident" id="7752294">D</span><span class="op" id="7752295">.</span><span class="ident" id="7752296">Cmp</span><span class="op" id="7752299">(</span><span class="ident" id="7752300">rsaPrivateKey</span><span class="op" id="7752313">.</span><span class="ident" id="7752314">D</span><span class="op" id="7752315">)</span>&nbsp;<span class="op" id="7752317">!=</span>&nbsp;<span class="num" id="7752320">0</span>&nbsp;<span class="op" id="7752322">||</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7752327">priv</span><span class="op" id="7752331">.</span><span class="ident" id="7752332">Primes</span><span class="op" id="7752338">[</span><span class="num" id="7752339">0</span><span class="op" id="7752340">]</span><span class="op" id="7752341">.</span><span class="ident" id="7752342">Cmp</span><span class="op" id="7752345">(</span><span class="ident" id="7752346">rsaPrivateKey</span><span class="op" id="7752359">.</span><span class="ident" id="7752360">Primes</span><span class="op" id="7752366">[</span><span class="num" id="7752367">0</span><span class="op" id="7752368">]</span><span class="op" id="7752369">)</span>&nbsp;<span class="op" id="7752371">!=</span>&nbsp;<span class="num" id="7752374">0</span>&nbsp;<span class="op" id="7752376">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7752381">priv</span><span class="op" id="7752385">.</span><span class="ident" id="7752386">Primes</span><span class="op" id="7752392">[</span><span class="num" id="7752393">1</span><span class="op" id="7752394">]</span><span class="op" id="7752395">.</span><span class="ident" id="7752396">Cmp</span><span class="op" id="7752399">(</span><span class="ident" id="7752400">rsaPrivateKey</span><span class="op" id="7752413">.</span><span class="ident" id="7752414">Primes</span><span class="op" id="7752420">[</span><span class="num" id="7752421">1</span><span class="op" id="7752422">]</span><span class="op" id="7752423">)</span>&nbsp;<span class="op" id="7752425">!=</span>&nbsp;<span class="num" id="7752428">0</span>&nbsp;<span class="op" id="7752430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7752434">t</span><span class="op" id="7752435">.</span><span class="ident" id="7752436">Errorf</span><span class="op" id="7752442">(</span><span class="string" id="7752443">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="7752461">,</span>&nbsp;<span class="ident" id="7752463">priv</span><span class="op" id="7752467">,</span>&nbsp;<span class="ident" id="7752469">rsaPrivateKey</span><span class="op" id="7752482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7752485">}</span><br>
<span class="lineno"></span><span class="op" id="7752487">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7752490">func</span>&nbsp;<span class="ident" id="7752495">TestParsePKIXPublicKey</span><span class="op" id="7752517">(</span><span class="ident" id="7752518">t</span>&nbsp;<span class="op" id="7752520">*</span><span class="ident" id="7752521">testing</span><span class="op" id="7752528">.</span><span class="ident" id="7752529">T</span><span class="op" id="7752530">)</span>&nbsp;<span class="op" id="7752532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7752535">block</span><span class="op" id="7752540">,</span>&nbsp;<span class="ident" id="7752542">_</span>&nbsp;<span class="op" id="7752544">:=</span>&nbsp;<span class="ident" id="7752547">pem</span><span class="op" id="7752550">.</span><span class="ident" id="7752551">Decode</span><span class="op" id="7752557">(</span><span class="op" id="7752558">[</span><span class="op" id="7752559">]</span><span class="builtintype" id="7752560">byte</span><span class="op" id="7752564">(</span><span class="ident" id="7752565">pemPublicKey</span><span class="op" id="7752577">)</span><span class="op" id="7752578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7752581">pub</span><span class="op" id="7752584">,</span>&nbsp;<span class="ident" id="7752586">err</span>&nbsp;<span class="op" id="7752590">:=</span>&nbsp;<span class="ident" id="7752593">ParsePKIXPublicKey</span><span class="op" id="7752611">(</span><span class="ident" id="7752612">block</span><span class="op" id="7752617">.</span><span class="ident" id="7752618">Bytes</span><span class="op" id="7752623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7752626">if</span>&nbsp;<span class="ident" id="7752629">err</span>&nbsp;<span class="op" id="7752633">!=</span>&nbsp;<span class="ident" id="7752636">nil</span>&nbsp;<span class="op" id="7752640">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7752644">t</span><span class="op" id="7752645">.</span><span class="ident" id="7752646">Errorf</span><span class="op" id="7752652">(</span><span class="string" id="7752653">&#34;Failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;public&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7752689">,</span>&nbsp;<span class="ident" id="7752691">err</span><span class="op" id="7752694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7752698">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7752706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7752709">rsaPub</span><span class="op" id="7752715">,</span>&nbsp;<span class="ident" id="7752717">ok</span>&nbsp;<span class="op" id="7752720">:=</span>&nbsp;<span class="ident" id="7752723">pub</span><span class="op" id="7752726">.</span><span class="op" id="7752727">(</span><span class="op" id="7752728">*</span><span class="ident" id="7752729">rsa</span><span class="op" id="7752732">.</span><span class="ident" id="7752733">PublicKey</span><span class="op" id="7752742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7752745">if</span>&nbsp;<span class="op" id="7752748">!</span><span class="ident" id="7752749">ok</span>&nbsp;<span class="op" id="7752752">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7752756">t</span><span class="op" id="7752757">.</span><span class="ident" id="7752758">Errorf</span><span class="op" id="7752764">(</span><span class="string" id="7752765">&#34;Value&nbsp;returned&nbsp;from&nbsp;ParsePKIXPublicKey&nbsp;was&nbsp;not&nbsp;an&nbsp;RSA&nbsp;public&nbsp;key&#34;</span><span class="op" id="7752831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7752835">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7752843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7752847">pubBytes2</span><span class="op" id="7752856">,</span>&nbsp;<span class="ident" id="7752858">err</span>&nbsp;<span class="op" id="7752862">:=</span>&nbsp;<span class="ident" id="7752865">MarshalPKIXPublicKey</span><span class="op" id="7752885">(</span><span class="ident" id="7752886">rsaPub</span><span class="op" id="7752892">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7752895">if</span>&nbsp;<span class="ident" id="7752898">err</span>&nbsp;<span class="op" id="7752902">!=</span>&nbsp;<span class="ident" id="7752905">nil</span>&nbsp;<span class="op" id="7752909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7752913">t</span><span class="op" id="7752914">.</span><span class="ident" id="7752915">Errorf</span><span class="op" id="7752921">(</span><span class="string" id="7752922">&#34;Failed&nbsp;to&nbsp;marshal&nbsp;RSA&nbsp;public&nbsp;key&nbsp;for&nbsp;the&nbsp;second&nbsp;time:&nbsp;%s&#34;</span><span class="op" id="7752980">,</span>&nbsp;<span class="ident" id="7752982">err</span><span class="op" id="7752985">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7752989">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7752997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7753000">if</span>&nbsp;<span class="op" id="7753003">!</span><span class="ident" id="7753004">bytes</span><span class="op" id="7753009">.</span><span class="ident" id="7753010">Equal</span><span class="op" id="7753015">(</span><span class="ident" id="7753016">pubBytes2</span><span class="op" id="7753025">,</span>&nbsp;<span class="ident" id="7753027">block</span><span class="op" id="7753032">.</span><span class="ident" id="7753033">Bytes</span><span class="op" id="7753038">)</span>&nbsp;<span class="op" id="7753040">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7753044">t</span><span class="op" id="7753045">.</span><span class="ident" id="7753046">Errorf</span><span class="op" id="7753052">(</span><span class="string" id="7753053">&#34;Reserialization&nbsp;of&nbsp;public&nbsp;key&nbsp;didn&#39;t&nbsp;match.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="7753114">,</span>&nbsp;<span class="ident" id="7753116">pubBytes2</span><span class="op" id="7753125">,</span>&nbsp;<span class="ident" id="7753127">block</span><span class="op" id="7753132">.</span><span class="ident" id="7753133">Bytes</span><span class="op" id="7753138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7753141">}</span><br>
<span class="lineno"></span><span class="op" id="7753143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7753146">var</span>&nbsp;<span class="ident" id="7753150">pemPublicKey</span>&nbsp;<span class="op" id="7753163">=</span>&nbsp;<span class="string" id="7753165">`-----BEGIN&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno">70</span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3VoPN9PKUjKFLMwOge6+<br>
<span class="lineno"></span>wnDi8sbETGIx2FKXGgqtAKpzmem53kRGEQg8WeqRmp12wgp74TGpkEXsGae7RS1k<br>
<span class="lineno"></span>enJCnma4fii+noGH7R0qKgHvPrI2Bwa9hzsH8tHxpyM3qrXslOmD45EH9SxIDUBJ<br>
<span class="lineno"></span>FehNdaPbLP1gFyahKMsdfxFJLUvbUycuZSJ2ZnIgeVxwm4qbSvZInL9Iu4FzuPtg<br>
<span class="lineno"></span>fINKcbbovy1qq4KvPIrXzhbY3PWDc6btxCf3SE0JdE1MCPThntB62/bLMSQ7xdDR<br>
<span class="lineno">75</span>FF53oIpvxe/SCOymfWq/LW849Ytv3Xwod0+wzAP8STXG4HSELS4UedPYeHJJJYcZ<br>
<span class="lineno"></span>+QIDAQAB<br>
<span class="lineno"></span>-----END&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="7753620">var</span>&nbsp;<span class="ident" id="7753624">pemPrivateKey</span>&nbsp;<span class="op" id="7753638">=</span>&nbsp;<span class="string" id="7753640">`-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0<br>
<span class="lineno"></span>fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu<br>
<span class="lineno"></span>/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu<br>
<span class="lineno"></span>RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/<br>
<span class="lineno">85</span>EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A<br>
<span class="lineno"></span>IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS<br>
<span class="lineno"></span>tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V<br>
<span class="lineno"></span>-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="7754137">func</span>&nbsp;<span class="ident" id="7754142">bigFromString</span><span class="op" id="7754155">(</span><span class="ident" id="7754156">s</span>&nbsp;<span class="builtintype" id="7754158">string</span><span class="op" id="7754164">)</span>&nbsp;<span class="op" id="7754166">*</span><span class="ident" id="7754167">big</span><span class="op" id="7754170">.</span><span class="ident" id="7754171">Int</span>&nbsp;<span class="op" id="7754175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7754178">ret</span>&nbsp;<span class="op" id="7754182">:=</span>&nbsp;<span class="builtinfunc" id="7754185">new</span><span class="op" id="7754188">(</span><span class="ident" id="7754189">big</span><span class="op" id="7754192">.</span><span class="ident" id="7754193">Int</span><span class="op" id="7754196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7754199">ret</span><span class="op" id="7754202">.</span><span class="ident" id="7754203">SetString</span><span class="op" id="7754212">(</span><span class="ident" id="7754213">s</span><span class="op" id="7754214">,</span>&nbsp;<span class="num" id="7754216">10</span><span class="op" id="7754218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7754221">return</span>&nbsp;<span class="ident" id="7754228">ret</span><br>
<span class="lineno">95</span><span class="op" id="7754232">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7754235">func</span>&nbsp;<span class="ident" id="7754240">fromBase10</span><span class="op" id="7754250">(</span><span class="ident" id="7754251">base10</span>&nbsp;<span class="builtintype" id="7754258">string</span><span class="op" id="7754264">)</span>&nbsp;<span class="op" id="7754266">*</span><span class="ident" id="7754267">big</span><span class="op" id="7754270">.</span><span class="ident" id="7754271">Int</span>&nbsp;<span class="op" id="7754275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7754278">i</span>&nbsp;<span class="op" id="7754280">:=</span>&nbsp;<span class="builtinfunc" id="7754283">new</span><span class="op" id="7754286">(</span><span class="ident" id="7754287">big</span><span class="op" id="7754290">.</span><span class="ident" id="7754291">Int</span><span class="op" id="7754294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7754297">i</span><span class="op" id="7754298">.</span><span class="ident" id="7754299">SetString</span><span class="op" id="7754308">(</span><span class="ident" id="7754309">base10</span><span class="op" id="7754315">,</span>&nbsp;<span class="num" id="7754317">10</span><span class="op" id="7754319">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7754322">return</span>&nbsp;<span class="ident" id="7754329">i</span><br>
<span class="lineno"></span><span class="op" id="7754331">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7754334">func</span>&nbsp;<span class="ident" id="7754339">bigFromHexString</span><span class="op" id="7754355">(</span><span class="ident" id="7754356">s</span>&nbsp;<span class="builtintype" id="7754358">string</span><span class="op" id="7754364">)</span>&nbsp;<span class="op" id="7754366">*</span><span class="ident" id="7754367">big</span><span class="op" id="7754370">.</span><span class="ident" id="7754371">Int</span>&nbsp;<span class="op" id="7754375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7754378">ret</span>&nbsp;<span class="op" id="7754382">:=</span>&nbsp;<span class="builtinfunc" id="7754385">new</span><span class="op" id="7754388">(</span><span class="ident" id="7754389">big</span><span class="op" id="7754392">.</span><span class="ident" id="7754393">Int</span><span class="op" id="7754396">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7754399">ret</span><span class="op" id="7754402">.</span><span class="ident" id="7754403">SetString</span><span class="op" id="7754412">(</span><span class="ident" id="7754413">s</span><span class="op" id="7754414">,</span>&nbsp;<span class="num" id="7754416">16</span><span class="op" id="7754418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7754421">return</span>&nbsp;<span class="ident" id="7754428">ret</span><br>
<span class="lineno"></span><span class="op" id="7754432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7754435">var</span>&nbsp;<span class="ident" id="7754439">rsaPrivateKey</span>&nbsp;<span class="op" id="7754453">=</span>&nbsp;<span class="op" id="7754455">&amp;</span><span class="ident" id="7754456">rsa</span><span class="op" id="7754459">.</span><span class="ident" id="7754460">PrivateKey</span><span class="op" id="7754470">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7754473">PublicKey</span><span class="op" id="7754482">:</span>&nbsp;<span class="ident" id="7754484">rsa</span><span class="op" id="7754487">.</span><span class="ident" id="7754488">PublicKey</span><span class="op" id="7754497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7754501">N</span><span class="op" id="7754502">:</span>&nbsp;<span class="ident" id="7754504">bigFromString</span><span class="op" id="7754517">(</span><span class="string" id="7754518">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="7754674">)</span><span class="op" id="7754675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7754679">E</span><span class="op" id="7754680">:</span>&nbsp;<span class="num" id="7754682">65537</span><span class="op" id="7754687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7754690">}</span><span class="op" id="7754691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7754694">D</span><span class="op" id="7754695">:</span>&nbsp;<span class="ident" id="7754697">bigFromString</span><span class="op" id="7754710">(</span><span class="string" id="7754711">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="7754867">)</span><span class="op" id="7754868">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7754871">Primes</span><span class="op" id="7754877">:</span>&nbsp;<span class="op" id="7754879">[</span><span class="op" id="7754880">]</span><span class="op" id="7754881">*</span><span class="ident" id="7754882">big</span><span class="op" id="7754885">.</span><span class="ident" id="7754886">Int</span><span class="op" id="7754889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7754893">bigFromString</span><span class="op" id="7754906">(</span><span class="string" id="7754907">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="7754986">)</span><span class="op" id="7754987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7754991">bigFromString</span><span class="op" id="7755004">(</span><span class="string" id="7755005">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="7755084">)</span><span class="op" id="7755085">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7755088">}</span><span class="op" id="7755089">,</span><br>
<span class="lineno"></span><span class="op" id="7755091">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="7755094">func</span>&nbsp;<span class="ident" id="7755099">TestMarshalRSAPrivateKey</span><span class="op" id="7755123">(</span><span class="ident" id="7755124">t</span>&nbsp;<span class="op" id="7755126">*</span><span class="ident" id="7755127">testing</span><span class="op" id="7755134">.</span><span class="ident" id="7755135">T</span><span class="op" id="7755136">)</span>&nbsp;<span class="op" id="7755138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7755141">priv</span>&nbsp;<span class="op" id="7755146">:=</span>&nbsp;<span class="op" id="7755149">&amp;</span><span class="ident" id="7755150">rsa</span><span class="op" id="7755153">.</span><span class="ident" id="7755154">PrivateKey</span><span class="op" id="7755164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7755168">PublicKey</span><span class="op" id="7755177">:</span>&nbsp;<span class="ident" id="7755179">rsa</span><span class="op" id="7755182">.</span><span class="ident" id="7755183">PublicKey</span><span class="op" id="7755192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7755197">N</span><span class="op" id="7755198">:</span>&nbsp;<span class="ident" id="7755200">fromBase10</span><span class="op" id="7755210">(</span><span class="string" id="7755211">&#34;16346378922382193400538269749936049106320265317511766357599732575277382844051791096569333808598921852351577762718529818072849191122419410612033592401403764925096136759934497687765453905884149505175426053037420486697072448609022753683683718057795566811401938833367954642951433473337066311978821180526439641496973296037000052546108507805269279414789035461158073156772151892452251106173507240488993608650881929629163465099476849643165682709047462010581308719577053905787496296934240246311806555924593059995202856826239801816771116902778517096212527979497399966526283516447337775509777558018145573127308919204297111496233&#34;</span><span class="op" id="7755830">)</span><span class="op" id="7755831">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7755836">E</span><span class="op" id="7755837">:</span>&nbsp;<span class="num" id="7755839">3</span><span class="op" id="7755840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7755844">}</span><span class="op" id="7755845">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7755849">D</span><span class="op" id="7755850">:</span>&nbsp;<span class="ident" id="7755852">fromBase10</span><span class="op" id="7755862">(</span><span class="string" id="7755863">&#34;10897585948254795600358846499957366070880176878341177571733155050184921896034527397712889205732614568234385175145686545381899460748279607074689061600935843283397424506622998458510302603922766336783617368686090042765718290914099334449154829375179958369993407724946186243249568928237086215759259909861748642124071874879861299389874230489928271621259294894142840428407196932444474088857746123104978617098858619445675532587787023228852383149557470077802718705420275739737958953794088728369933811184572620857678792001136676902250566845618813972833750098806496641114644760255910789397593428910198080271317419213080834885003&#34;</span><span class="op" id="7756482">)</span><span class="op" id="7756483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7756487">Primes</span><span class="op" id="7756493">:</span>&nbsp;<span class="op" id="7756495">[</span><span class="op" id="7756496">]</span><span class="op" id="7756497">*</span><span class="ident" id="7756498">big</span><span class="op" id="7756501">.</span><span class="ident" id="7756502">Int</span><span class="op" id="7756505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7756510">fromBase10</span><span class="op" id="7756520">(</span><span class="string" id="7756521">&#34;1025363189502892836833747188838978207017355117492483312747347695538428729137306368764177201532277413433182799108299960196606011786562992097313508180436744488171474690412562218914213688661311117337381958560443&#34;</span><span class="op" id="7756731">)</span><span class="op" id="7756732">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7756737">fromBase10</span><span class="op" id="7756747">(</span><span class="string" id="7756748">&#34;3467903426626310123395340254094941045497208049900750380025518552334536945536837294961497712862519984786362199788654739924501424784631315081391467293694361474867825728031147665777546570788493758372218019373&#34;</span><span class="op" id="7756955">)</span><span class="op" id="7756956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7756961">fromBase10</span><span class="op" id="7756971">(</span><span class="string" id="7756972">&#34;4597024781409332673052708605078359346966325141767460991205742124888960305710298765592730135879076084498363772408626791576005136245060321874472727132746643162385746062759369754202494417496879741537284589047&#34;</span><span class="op" id="7757179">)</span><span class="op" id="7757180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7757184">}</span><span class="op" id="7757185">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7757188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7757192">derBytes</span>&nbsp;<span class="op" id="7757201">:=</span>&nbsp;<span class="ident" id="7757204">MarshalPKCS1PrivateKey</span><span class="op" id="7757226">(</span><span class="ident" id="7757227">priv</span><span class="op" id="7757231">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7757235">priv2</span><span class="op" id="7757240">,</span>&nbsp;<span class="ident" id="7757242">err</span>&nbsp;<span class="op" id="7757246">:=</span>&nbsp;<span class="ident" id="7757249">ParsePKCS1PrivateKey</span><span class="op" id="7757269">(</span><span class="ident" id="7757270">derBytes</span><span class="op" id="7757278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7757281">if</span>&nbsp;<span class="ident" id="7757284">err</span>&nbsp;<span class="op" id="7757288">!=</span>&nbsp;<span class="ident" id="7757291">nil</span>&nbsp;<span class="op" id="7757295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7757299">t</span><span class="op" id="7757300">.</span><span class="ident" id="7757301">Errorf</span><span class="op" id="7757307">(</span><span class="string" id="7757308">&#34;error&nbsp;parsing&nbsp;serialized&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7757342">,</span>&nbsp;<span class="ident" id="7757344">err</span><span class="op" id="7757347">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7757351">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7757359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7757362">if</span>&nbsp;<span class="ident" id="7757365">priv</span><span class="op" id="7757369">.</span><span class="ident" id="7757370">PublicKey</span><span class="op" id="7757379">.</span><span class="ident" id="7757380">N</span><span class="op" id="7757381">.</span><span class="ident" id="7757382">Cmp</span><span class="op" id="7757385">(</span><span class="ident" id="7757386">priv2</span><span class="op" id="7757391">.</span><span class="ident" id="7757392">PublicKey</span><span class="op" id="7757401">.</span><span class="ident" id="7757402">N</span><span class="op" id="7757403">)</span>&nbsp;<span class="op" id="7757405">!=</span>&nbsp;<span class="num" id="7757408">0</span>&nbsp;<span class="op" id="7757410">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7757415">priv</span><span class="op" id="7757419">.</span><span class="ident" id="7757420">PublicKey</span><span class="op" id="7757429">.</span><span class="ident" id="7757430">E</span>&nbsp;<span class="op" id="7757432">!=</span>&nbsp;<span class="ident" id="7757435">priv2</span><span class="op" id="7757440">.</span><span class="ident" id="7757441">PublicKey</span><span class="op" id="7757450">.</span><span class="ident" id="7757451">E</span>&nbsp;<span class="op" id="7757453">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7757458">priv</span><span class="op" id="7757462">.</span><span class="ident" id="7757463">D</span><span class="op" id="7757464">.</span><span class="ident" id="7757465">Cmp</span><span class="op" id="7757468">(</span><span class="ident" id="7757469">priv2</span><span class="op" id="7757474">.</span><span class="ident" id="7757475">D</span><span class="op" id="7757476">)</span>&nbsp;<span class="op" id="7757478">!=</span>&nbsp;<span class="num" id="7757481">0</span>&nbsp;<span class="op" id="7757483">||</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7757488">len</span><span class="op" id="7757491">(</span><span class="ident" id="7757492">priv2</span><span class="op" id="7757497">.</span><span class="ident" id="7757498">Primes</span><span class="op" id="7757504">)</span>&nbsp;<span class="op" id="7757506">!=</span>&nbsp;<span class="num" id="7757509">3</span>&nbsp;<span class="op" id="7757511">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7757516">priv</span><span class="op" id="7757520">.</span><span class="ident" id="7757521">Primes</span><span class="op" id="7757527">[</span><span class="num" id="7757528">0</span><span class="op" id="7757529">]</span><span class="op" id="7757530">.</span><span class="ident" id="7757531">Cmp</span><span class="op" id="7757534">(</span><span class="ident" id="7757535">priv2</span><span class="op" id="7757540">.</span><span class="ident" id="7757541">Primes</span><span class="op" id="7757547">[</span><span class="num" id="7757548">0</span><span class="op" id="7757549">]</span><span class="op" id="7757550">)</span>&nbsp;<span class="op" id="7757552">!=</span>&nbsp;<span class="num" id="7757555">0</span>&nbsp;<span class="op" id="7757557">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7757562">priv</span><span class="op" id="7757566">.</span><span class="ident" id="7757567">Primes</span><span class="op" id="7757573">[</span><span class="num" id="7757574">1</span><span class="op" id="7757575">]</span><span class="op" id="7757576">.</span><span class="ident" id="7757577">Cmp</span><span class="op" id="7757580">(</span><span class="ident" id="7757581">priv2</span><span class="op" id="7757586">.</span><span class="ident" id="7757587">Primes</span><span class="op" id="7757593">[</span><span class="num" id="7757594">1</span><span class="op" id="7757595">]</span><span class="op" id="7757596">)</span>&nbsp;<span class="op" id="7757598">!=</span>&nbsp;<span class="num" id="7757601">0</span>&nbsp;<span class="op" id="7757603">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7757608">priv</span><span class="op" id="7757612">.</span><span class="ident" id="7757613">Primes</span><span class="op" id="7757619">[</span><span class="num" id="7757620">2</span><span class="op" id="7757621">]</span><span class="op" id="7757622">.</span><span class="ident" id="7757623">Cmp</span><span class="op" id="7757626">(</span><span class="ident" id="7757627">priv2</span><span class="op" id="7757632">.</span><span class="ident" id="7757633">Primes</span><span class="op" id="7757639">[</span><span class="num" id="7757640">2</span><span class="op" id="7757641">]</span><span class="op" id="7757642">)</span>&nbsp;<span class="op" id="7757644">!=</span>&nbsp;<span class="num" id="7757647">0</span>&nbsp;<span class="op" id="7757649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7757653">t</span><span class="op" id="7757654">.</span><span class="ident" id="7757655">Errorf</span><span class="op" id="7757661">(</span><span class="string" id="7757662">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="7757680">,</span>&nbsp;<span class="ident" id="7757682">priv</span><span class="op" id="7757686">,</span>&nbsp;<span class="ident" id="7757688">priv2</span><span class="op" id="7757693">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7757696">}</span><br>
<span class="lineno"></span><span class="op" id="7757698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7757701">type</span>&nbsp;<span class="ident" id="7757706">matchHostnamesTest</span>&nbsp;<span class="keyword" id="7757725">struct</span>&nbsp;<span class="op" id="7757732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7757735">pattern</span><span class="op" id="7757742">,</span>&nbsp;<span class="ident" id="7757744">host</span>&nbsp;<span class="builtintype" id="7757749">string</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7757757">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7757771">bool</span><br>
<span class="lineno"></span><span class="op" id="7757776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7757779">var</span>&nbsp;<span class="ident" id="7757783">matchHostnamesTests</span>&nbsp;<span class="op" id="7757803">=</span>&nbsp;<span class="op" id="7757805">[</span><span class="op" id="7757806">]</span><span class="ident" id="7757807">matchHostnamesTest</span><span class="op" id="7757825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7757828">{</span><span class="string" id="7757829">&#34;a.b.c&#34;</span><span class="op" id="7757836">,</span>&nbsp;<span class="string" id="7757838">&#34;a.b.c&#34;</span><span class="op" id="7757845">,</span>&nbsp;<span class="builtintype" id="7757847">true</span><span class="op" id="7757851">}</span><span class="op" id="7757852">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7757855">{</span><span class="string" id="7757856">&#34;a.b.c&#34;</span><span class="op" id="7757863">,</span>&nbsp;<span class="string" id="7757865">&#34;b.b.c&#34;</span><span class="op" id="7757872">,</span>&nbsp;<span class="builtintype" id="7757874">false</span><span class="op" id="7757879">}</span><span class="op" id="7757880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7757883">{</span><span class="string" id="7757884">&#34;&#34;</span><span class="op" id="7757886">,</span>&nbsp;<span class="string" id="7757888">&#34;b.b.c&#34;</span><span class="op" id="7757895">,</span>&nbsp;<span class="builtintype" id="7757897">false</span><span class="op" id="7757902">}</span><span class="op" id="7757903">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7757906">{</span><span class="string" id="7757907">&#34;a.b.c&#34;</span><span class="op" id="7757914">,</span>&nbsp;<span class="string" id="7757916">&#34;&#34;</span><span class="op" id="7757918">,</span>&nbsp;<span class="builtintype" id="7757920">false</span><span class="op" id="7757925">}</span><span class="op" id="7757926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7757929">{</span><span class="string" id="7757930">&#34;example.com&#34;</span><span class="op" id="7757943">,</span>&nbsp;<span class="string" id="7757945">&#34;example.com&#34;</span><span class="op" id="7757958">,</span>&nbsp;<span class="builtintype" id="7757960">true</span><span class="op" id="7757964">}</span><span class="op" id="7757965">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7757968">{</span><span class="string" id="7757969">&#34;example.com&#34;</span><span class="op" id="7757982">,</span>&nbsp;<span class="string" id="7757984">&#34;www.example.com&#34;</span><span class="op" id="7758001">,</span>&nbsp;<span class="builtintype" id="7758003">false</span><span class="op" id="7758008">}</span><span class="op" id="7758009">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7758012">{</span><span class="string" id="7758013">&#34;*.example.com&#34;</span><span class="op" id="7758028">,</span>&nbsp;<span class="string" id="7758030">&#34;www.example.com&#34;</span><span class="op" id="7758047">,</span>&nbsp;<span class="builtintype" id="7758049">true</span><span class="op" id="7758053">}</span><span class="op" id="7758054">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7758057">{</span><span class="string" id="7758058">&#34;*.example.com&#34;</span><span class="op" id="7758073">,</span>&nbsp;<span class="string" id="7758075">&#34;xyz.www.example.com&#34;</span><span class="op" id="7758096">,</span>&nbsp;<span class="builtintype" id="7758098">false</span><span class="op" id="7758103">}</span><span class="op" id="7758104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7758107">{</span><span class="string" id="7758108">&#34;*.*.example.com&#34;</span><span class="op" id="7758125">,</span>&nbsp;<span class="string" id="7758127">&#34;xyz.www.example.com&#34;</span><span class="op" id="7758148">,</span>&nbsp;<span class="builtintype" id="7758150">true</span><span class="op" id="7758154">}</span><span class="op" id="7758155">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7758158">{</span><span class="string" id="7758159">&#34;*.www.*.com&#34;</span><span class="op" id="7758172">,</span>&nbsp;<span class="string" id="7758174">&#34;xyz.www.example.com&#34;</span><span class="op" id="7758195">,</span>&nbsp;<span class="builtintype" id="7758197">true</span><span class="op" id="7758201">}</span><span class="op" id="7758202">,</span><br>
<span class="lineno"></span><span class="op" id="7758204">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7758207">func</span>&nbsp;<span class="ident" id="7758212">TestMatchHostnames</span><span class="op" id="7758230">(</span><span class="ident" id="7758231">t</span>&nbsp;<span class="op" id="7758233">*</span><span class="ident" id="7758234">testing</span><span class="op" id="7758241">.</span><span class="ident" id="7758242">T</span><span class="op" id="7758243">)</span>&nbsp;<span class="op" id="7758245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7758248">for</span>&nbsp;<span class="ident" id="7758252">i</span><span class="op" id="7758253">,</span>&nbsp;<span class="ident" id="7758255">test</span>&nbsp;<span class="op" id="7758260">:=</span>&nbsp;<span class="keyword" id="7758263">range</span>&nbsp;<span class="ident" id="7758269">matchHostnamesTests</span>&nbsp;<span class="op" id="7758289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7758293">r</span>&nbsp;<span class="op" id="7758295">:=</span>&nbsp;<span class="ident" id="7758298">matchHostnames</span><span class="op" id="7758312">(</span><span class="ident" id="7758313">test</span><span class="op" id="7758317">.</span><span class="ident" id="7758318">pattern</span><span class="op" id="7758325">,</span>&nbsp;<span class="ident" id="7758327">test</span><span class="op" id="7758331">.</span><span class="ident" id="7758332">host</span><span class="op" id="7758336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7758340">if</span>&nbsp;<span class="ident" id="7758343">r</span>&nbsp;<span class="op" id="7758345">!=</span>&nbsp;<span class="ident" id="7758348">test</span><span class="op" id="7758352">.</span><span class="ident" id="7758353">ok</span>&nbsp;<span class="op" id="7758356">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7758361">t</span><span class="op" id="7758362">.</span><span class="ident" id="7758363">Errorf</span><span class="op" id="7758369">(</span><span class="string" id="7758370">&#34;#%d&nbsp;mismatch&nbsp;got:&nbsp;%t&nbsp;want:&nbsp;%t&#34;</span><span class="op" id="7758401">,</span>&nbsp;<span class="ident" id="7758403">i</span><span class="op" id="7758404">,</span>&nbsp;<span class="ident" id="7758406">r</span><span class="op" id="7758407">,</span>&nbsp;<span class="ident" id="7758409">test</span><span class="op" id="7758413">.</span><span class="ident" id="7758414">ok</span><span class="op" id="7758416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7758420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7758423">}</span><br>
<span class="lineno"></span><span class="op" id="7758425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="7758428">func</span>&nbsp;<span class="ident" id="7758433">TestMatchIP</span><span class="op" id="7758444">(</span><span class="ident" id="7758445">t</span>&nbsp;<span class="op" id="7758447">*</span><span class="ident" id="7758448">testing</span><span class="op" id="7758455">.</span><span class="ident" id="7758456">T</span><span class="op" id="7758457">)</span>&nbsp;<span class="op" id="7758459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7758462">//&nbsp;Check&nbsp;that&nbsp;pattern&nbsp;matching&nbsp;is&nbsp;working.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7758506">c</span>&nbsp;<span class="op" id="7758508">:=</span>&nbsp;<span class="op" id="7758511">&amp;</span><span class="ident" id="7758512">Certificate</span><span class="op" id="7758523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7758527">DNSNames</span><span class="op" id="7758535">:</span>&nbsp;<span class="op" id="7758537">[</span><span class="op" id="7758538">]</span><span class="builtintype" id="7758539">string</span><span class="op" id="7758545">{</span><span class="string" id="7758546">&#34;*.foo.bar.baz&#34;</span><span class="op" id="7758561">}</span><span class="op" id="7758562">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7758566">Subject</span><span class="op" id="7758573">:</span>&nbsp;<span class="ident" id="7758575">pkix</span><span class="op" id="7758579">.</span><span class="ident" id="7758580">Name</span><span class="op" id="7758584">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7758589">CommonName</span><span class="op" id="7758599">:</span>&nbsp;<span class="string" id="7758601">&#34;*.foo.bar.baz&#34;</span><span class="op" id="7758616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7758620">}</span><span class="op" id="7758621">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7758624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7758627">err</span>&nbsp;<span class="op" id="7758631">:=</span>&nbsp;<span class="ident" id="7758634">c</span><span class="op" id="7758635">.</span><span class="ident" id="7758636">VerifyHostname</span><span class="op" id="7758650">(</span><span class="string" id="7758651">&#34;quux.foo.bar.baz&#34;</span><span class="op" id="7758669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7758672">if</span>&nbsp;<span class="ident" id="7758675">err</span>&nbsp;<span class="op" id="7758679">!=</span>&nbsp;<span class="ident" id="7758682">nil</span>&nbsp;<span class="op" id="7758686">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7758690">t</span><span class="op" id="7758691">.</span><span class="ident" id="7758692">Fatalf</span><span class="op" id="7758698">(</span><span class="string" id="7758699">&#34;VerifyHostname(quux.foo.bar.baz):&nbsp;%v&#34;</span><span class="op" id="7758737">,</span>&nbsp;<span class="ident" id="7758739">err</span><span class="op" id="7758742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7758745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7758749">//&nbsp;But&nbsp;check&nbsp;that&nbsp;if&nbsp;we&nbsp;change&nbsp;it&nbsp;to&nbsp;be&nbsp;matching&nbsp;against&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7758822">//&nbsp;it&nbsp;is&nbsp;rejected.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7758842">c</span>&nbsp;<span class="op" id="7758844">=</span>&nbsp;<span class="op" id="7758846">&amp;</span><span class="ident" id="7758847">Certificate</span><span class="op" id="7758858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7758862">DNSNames</span><span class="op" id="7758870">:</span>&nbsp;<span class="op" id="7758872">[</span><span class="op" id="7758873">]</span><span class="builtintype" id="7758874">string</span><span class="op" id="7758880">{</span><span class="string" id="7758881">&#34;*.2.3.4&#34;</span><span class="op" id="7758890">}</span><span class="op" id="7758891">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7758895">Subject</span><span class="op" id="7758902">:</span>&nbsp;<span class="ident" id="7758904">pkix</span><span class="op" id="7758908">.</span><span class="ident" id="7758909">Name</span><span class="op" id="7758913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7758918">CommonName</span><span class="op" id="7758928">:</span>&nbsp;<span class="string" id="7758930">&#34;*.2.3.4&#34;</span><span class="op" id="7758939">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7758943">}</span><span class="op" id="7758944">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7758947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7758950">err</span>&nbsp;<span class="op" id="7758954">=</span>&nbsp;<span class="ident" id="7758956">c</span><span class="op" id="7758957">.</span><span class="ident" id="7758958">VerifyHostname</span><span class="op" id="7758972">(</span><span class="string" id="7758973">&#34;1.2.3.4&#34;</span><span class="op" id="7758982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7758985">if</span>&nbsp;<span class="ident" id="7758988">err</span>&nbsp;<span class="op" id="7758992">==</span>&nbsp;<span class="ident" id="7758995">nil</span>&nbsp;<span class="op" id="7758999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7759003">t</span><span class="op" id="7759004">.</span><span class="ident" id="7759005">Fatalf</span><span class="op" id="7759011">(</span><span class="string" id="7759012">&#34;VerifyHostname(1.2.3.4)&nbsp;should&nbsp;have&nbsp;failed,&nbsp;did&nbsp;not&#34;</span><span class="op" id="7759065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7759068">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7759072">c</span>&nbsp;<span class="op" id="7759074">=</span>&nbsp;<span class="op" id="7759076">&amp;</span><span class="ident" id="7759077">Certificate</span><span class="op" id="7759088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7759092">IPAddresses</span><span class="op" id="7759103">:</span>&nbsp;<span class="op" id="7759105">[</span><span class="op" id="7759106">]</span><span class="ident" id="7759107">net</span><span class="op" id="7759110">.</span><span class="ident" id="7759111">IP</span><span class="op" id="7759113">{</span><span class="ident" id="7759114">net</span><span class="op" id="7759117">.</span><span class="ident" id="7759118">ParseIP</span><span class="op" id="7759125">(</span><span class="string" id="7759126">&#34;127.0.0.1&#34;</span><span class="op" id="7759137">)</span><span class="op" id="7759138">,</span>&nbsp;<span class="ident" id="7759140">net</span><span class="op" id="7759143">.</span><span class="ident" id="7759144">ParseIP</span><span class="op" id="7759151">(</span><span class="string" id="7759152">&#34;::1&#34;</span><span class="op" id="7759157">)</span><span class="op" id="7759158">}</span><span class="op" id="7759159">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7759162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7759165">err</span>&nbsp;<span class="op" id="7759169">=</span>&nbsp;<span class="ident" id="7759171">c</span><span class="op" id="7759172">.</span><span class="ident" id="7759173">VerifyHostname</span><span class="op" id="7759187">(</span><span class="string" id="7759188">&#34;127.0.0.1&#34;</span><span class="op" id="7759199">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7759202">if</span>&nbsp;<span class="ident" id="7759205">err</span>&nbsp;<span class="op" id="7759209">!=</span>&nbsp;<span class="ident" id="7759212">nil</span>&nbsp;<span class="op" id="7759216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7759220">t</span><span class="op" id="7759221">.</span><span class="ident" id="7759222">Fatalf</span><span class="op" id="7759228">(</span><span class="string" id="7759229">&#34;VerifyHostname(127.0.0.1):&nbsp;%v&#34;</span><span class="op" id="7759260">,</span>&nbsp;<span class="ident" id="7759262">err</span><span class="op" id="7759265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7759268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7759271">err</span>&nbsp;<span class="op" id="7759275">=</span>&nbsp;<span class="ident" id="7759277">c</span><span class="op" id="7759278">.</span><span class="ident" id="7759279">VerifyHostname</span><span class="op" id="7759293">(</span><span class="string" id="7759294">&#34;::1&#34;</span><span class="op" id="7759299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7759302">if</span>&nbsp;<span class="ident" id="7759305">err</span>&nbsp;<span class="op" id="7759309">!=</span>&nbsp;<span class="ident" id="7759312">nil</span>&nbsp;<span class="op" id="7759316">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7759320">t</span><span class="op" id="7759321">.</span><span class="ident" id="7759322">Fatalf</span><span class="op" id="7759328">(</span><span class="string" id="7759329">&#34;VerifyHostname(::1):&nbsp;%v&#34;</span><span class="op" id="7759354">,</span>&nbsp;<span class="ident" id="7759356">err</span><span class="op" id="7759359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7759362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7759365">err</span>&nbsp;<span class="op" id="7759369">=</span>&nbsp;<span class="ident" id="7759371">c</span><span class="op" id="7759372">.</span><span class="ident" id="7759373">VerifyHostname</span><span class="op" id="7759387">(</span><span class="string" id="7759388">&#34;[::1]&#34;</span><span class="op" id="7759395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7759398">if</span>&nbsp;<span class="ident" id="7759401">err</span>&nbsp;<span class="op" id="7759405">!=</span>&nbsp;<span class="ident" id="7759408">nil</span>&nbsp;<span class="op" id="7759412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7759416">t</span><span class="op" id="7759417">.</span><span class="ident" id="7759418">Fatalf</span><span class="op" id="7759424">(</span><span class="string" id="7759425">&#34;VerifyHostname([::1]):&nbsp;%v&#34;</span><span class="op" id="7759452">,</span>&nbsp;<span class="ident" id="7759454">err</span><span class="op" id="7759457">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7759460">}</span><br>
<span class="lineno"></span><span class="op" id="7759462">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7759465">func</span>&nbsp;<span class="ident" id="7759470">TestCertificateParse</span><span class="op" id="7759490">(</span><span class="ident" id="7759491">t</span>&nbsp;<span class="op" id="7759493">*</span><span class="ident" id="7759494">testing</span><span class="op" id="7759501">.</span><span class="ident" id="7759502">T</span><span class="op" id="7759503">)</span>&nbsp;<span class="op" id="7759505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7759508">s</span><span class="op" id="7759509">,</span>&nbsp;<span class="ident" id="7759511">_</span>&nbsp;<span class="op" id="7759513">:=</span>&nbsp;<span class="ident" id="7759516">hex</span><span class="op" id="7759519">.</span><span class="ident" id="7759520">DecodeString</span><span class="op" id="7759532">(</span><span class="ident" id="7759533">certBytes</span><span class="op" id="7759542">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7759545">certs</span><span class="op" id="7759550">,</span>&nbsp;<span class="ident" id="7759552">err</span>&nbsp;<span class="op" id="7759556">:=</span>&nbsp;<span class="ident" id="7759559">ParseCertificates</span><span class="op" id="7759576">(</span><span class="ident" id="7759577">s</span><span class="op" id="7759578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7759581">if</span>&nbsp;<span class="ident" id="7759584">err</span>&nbsp;<span class="op" id="7759588">!=</span>&nbsp;<span class="ident" id="7759591">nil</span>&nbsp;<span class="op" id="7759595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7759599">t</span><span class="op" id="7759600">.</span><span class="ident" id="7759601">Error</span><span class="op" id="7759606">(</span><span class="ident" id="7759607">err</span><span class="op" id="7759610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7759613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7759616">if</span>&nbsp;<span class="builtinfunc" id="7759619">len</span><span class="op" id="7759622">(</span><span class="ident" id="7759623">certs</span><span class="op" id="7759628">)</span>&nbsp;<span class="op" id="7759630">!=</span>&nbsp;<span class="num" id="7759633">2</span>&nbsp;<span class="op" id="7759635">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7759639">t</span><span class="op" id="7759640">.</span><span class="ident" id="7759641">Errorf</span><span class="op" id="7759647">(</span><span class="string" id="7759648">&#34;Wrong&nbsp;number&nbsp;of&nbsp;certs:&nbsp;got&nbsp;%d&nbsp;want&nbsp;2&#34;</span><span class="op" id="7759686">,</span>&nbsp;<span class="builtinfunc" id="7759688">len</span><span class="op" id="7759691">(</span><span class="ident" id="7759692">certs</span><span class="op" id="7759697">)</span><span class="op" id="7759698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7759702">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7759710">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7759714">err</span>&nbsp;<span class="op" id="7759718">=</span>&nbsp;<span class="ident" id="7759720">certs</span><span class="op" id="7759725">[</span><span class="num" id="7759726">0</span><span class="op" id="7759727">]</span><span class="op" id="7759728">.</span><span class="ident" id="7759729">CheckSignatureFrom</span><span class="op" id="7759747">(</span><span class="ident" id="7759748">certs</span><span class="op" id="7759753">[</span><span class="num" id="7759754">1</span><span class="op" id="7759755">]</span><span class="op" id="7759756">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7759759">if</span>&nbsp;<span class="ident" id="7759762">err</span>&nbsp;<span class="op" id="7759766">!=</span>&nbsp;<span class="ident" id="7759769">nil</span>&nbsp;<span class="op" id="7759773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7759777">t</span><span class="op" id="7759778">.</span><span class="ident" id="7759779">Error</span><span class="op" id="7759784">(</span><span class="ident" id="7759785">err</span><span class="op" id="7759788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7759791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7759795">if</span>&nbsp;<span class="ident" id="7759798">err</span>&nbsp;<span class="op" id="7759802">:=</span>&nbsp;<span class="ident" id="7759805">certs</span><span class="op" id="7759810">[</span><span class="num" id="7759811">0</span><span class="op" id="7759812">]</span><span class="op" id="7759813">.</span><span class="ident" id="7759814">VerifyHostname</span><span class="op" id="7759828">(</span><span class="string" id="7759829">&#34;mail.google.com&#34;</span><span class="op" id="7759846">)</span><span class="op" id="7759847">;</span>&nbsp;<span class="ident" id="7759849">err</span>&nbsp;<span class="op" id="7759853">!=</span>&nbsp;<span class="ident" id="7759856">nil</span>&nbsp;<span class="op" id="7759860">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7759864">t</span><span class="op" id="7759865">.</span><span class="ident" id="7759866">Error</span><span class="op" id="7759871">(</span><span class="ident" id="7759872">err</span><span class="op" id="7759875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7759878">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7759882">const</span>&nbsp;<span class="ident" id="7759888">expectedExtensions</span>&nbsp;<span class="op" id="7759907">=</span>&nbsp;<span class="num" id="7759909">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7759912">if</span>&nbsp;<span class="ident" id="7759915">n</span>&nbsp;<span class="op" id="7759917">:=</span>&nbsp;<span class="builtinfunc" id="7759920">len</span><span class="op" id="7759923">(</span><span class="ident" id="7759924">certs</span><span class="op" id="7759929">[</span><span class="num" id="7759930">0</span><span class="op" id="7759931">]</span><span class="op" id="7759932">.</span><span class="ident" id="7759933">Extensions</span><span class="op" id="7759943">)</span><span class="op" id="7759944">;</span>&nbsp;<span class="ident" id="7759946">n</span>&nbsp;<span class="op" id="7759948">!=</span>&nbsp;<span class="ident" id="7759951">expectedExtensions</span>&nbsp;<span class="op" id="7759970">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7759974">t</span><span class="op" id="7759975">.</span><span class="ident" id="7759976">Errorf</span><span class="op" id="7759982">(</span><span class="string" id="7759983">&#34;want&nbsp;%d&nbsp;extensions,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7760011">,</span>&nbsp;<span class="ident" id="7760013">expectedExtensions</span><span class="op" id="7760031">,</span>&nbsp;<span class="ident" id="7760033">n</span><span class="op" id="7760034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7760037">}</span><br>
<span class="lineno"></span><span class="op" id="7760039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7760042">var</span>&nbsp;<span class="ident" id="7760046">certBytes</span>&nbsp;<span class="op" id="7760056">=</span>&nbsp;<span class="string" id="7760058">&#34;308203223082028ba00302010202106edf0d9499fd4533dd1297fc42a93be1300d06092a864886&#34;</span>&nbsp;<span class="op" id="7760139">+</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7760142">&#34;f70d0101050500304c310b3009060355040613025a4131253023060355040a131c546861777465&#34;</span>&nbsp;<span class="op" id="7760223">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7760226">&#34;20436f6e73756c74696e67202850747929204c74642e311630140603550403130d546861777465&#34;</span>&nbsp;<span class="op" id="7760307">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7760310">&#34;20534743204341301e170d3039303332353136343932395a170d3130303332353136343932395a&#34;</span>&nbsp;<span class="op" id="7760391">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7760394">&#34;3069310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630&#34;</span>&nbsp;<span class="op" id="7760475">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7760478">&#34;140603550407130d4d6f756e7461696e205669657731133011060355040a130a476f6f676c6520&#34;</span>&nbsp;<span class="op" id="7760559">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7760562">&#34;496e63311830160603550403130f6d61696c2e676f6f676c652e636f6d30819f300d06092a8648&#34;</span>&nbsp;<span class="op" id="7760643">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7760646">&#34;86f70d010101050003818d0030818902818100c5d6f892fccaf5614b064149e80a2c9581a218ef&#34;</span>&nbsp;<span class="op" id="7760727">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7760730">&#34;41ec35bd7a58125ae76f9ea54ddc893abbeb029f6b73616bf0ffd868791fba7af9c4aebf3706ba&#34;</span>&nbsp;<span class="op" id="7760811">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7760814">&#34;3eeaeed27435b4ddcfb157c05f351d66aa87fee0de072d66d773affbd36ab78bef090e0cc861a9&#34;</span>&nbsp;<span class="op" id="7760895">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7760898">&#34;03ac90dd98b51c9c41566c017f0beec3bff391051ffba0f5cc6850ad2a590203010001a381e730&#34;</span>&nbsp;<span class="op" id="7760979">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7760982">&#34;81e430280603551d250421301f06082b0601050507030106082b06010505070302060960864801&#34;</span>&nbsp;<span class="op" id="7761063">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7761066">&#34;86f842040130360603551d1f042f302d302ba029a0278625687474703a2f2f63726c2e74686177&#34;</span>&nbsp;<span class="op" id="7761147">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7761150">&#34;74652e636f6d2f54686177746553474343412e63726c307206082b060105050701010466306430&#34;</span>&nbsp;<span class="op" id="7761231">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7761234">&#34;2206082b060105050730018616687474703a2f2f6f6373702e7468617774652e636f6d303e0608&#34;</span>&nbsp;<span class="op" id="7761315">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7761318">&#34;2b060105050730028632687474703a2f2f7777772e7468617774652e636f6d2f7265706f736974&#34;</span>&nbsp;<span class="op" id="7761399">+</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7761402">&#34;6f72792f5468617774655f5347435f43412e637274300c0603551d130101ff04023000300d0609&#34;</span>&nbsp;<span class="op" id="7761483">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7761486">&#34;2a864886f70d01010505000381810062f1f3050ebc105e497c7aedf87e24d2f4a986bb3b837bd1&#34;</span>&nbsp;<span class="op" id="7761567">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7761570">&#34;9b91ebcad98b065992f6bd2b49b7d6d3cb2e427a99d606c7b1d46352527fac39e6a8b6726de5bf&#34;</span>&nbsp;<span class="op" id="7761651">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7761654">&#34;70212a52cba07634a5e332011bd1868e78eb5e3c93cf03072276786f207494feaa0ed9d53b2110&#34;</span>&nbsp;<span class="op" id="7761735">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7761738">&#34;a76571f90209cdae884385c882587030ee15f33d761e2e45a6bc308203233082028ca003020102&#34;</span>&nbsp;<span class="op" id="7761819">+</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7761822">&#34;020430000002300d06092a864886f70d0101050500305f310b3009060355040613025553311730&#34;</span>&nbsp;<span class="op" id="7761903">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7761906">&#34;15060355040a130e566572695369676e2c20496e632e31373035060355040b132e436c61737320&#34;</span>&nbsp;<span class="op" id="7761987">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7761990">&#34;33205075626c6963205072696d6172792043657274696669636174696f6e20417574686f726974&#34;</span>&nbsp;<span class="op" id="7762071">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7762074">&#34;79301e170d3034303531333030303030305a170d3134303531323233353935395a304c310b3009&#34;</span>&nbsp;<span class="op" id="7762155">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7762158">&#34;060355040613025a4131253023060355040a131c54686177746520436f6e73756c74696e672028&#34;</span>&nbsp;<span class="op" id="7762239">+</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7762242">&#34;50747929204c74642e311630140603550403130d5468617774652053474320434130819f300d06&#34;</span>&nbsp;<span class="op" id="7762323">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7762326">&#34;092a864886f70d010101050003818d0030818902818100d4d367d08d157faecd31fe7d1d91a13f&#34;</span>&nbsp;<span class="op" id="7762407">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7762410">&#34;0b713cacccc864fb63fc324b0794bd6f80ba2fe10493c033fc093323e90b742b71c403c6d2cde2&#34;</span>&nbsp;<span class="op" id="7762491">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7762494">&#34;2ff50963cdff48a500bfe0e7f388b72d32de9836e60aad007bc4644a3b847503f270927d0e62f5&#34;</span>&nbsp;<span class="op" id="7762575">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7762578">&#34;21ab693684317590f8bfc76c881b06957cc9e5a8de75a12c7a68dfd5ca1c875860190203010001&#34;</span>&nbsp;<span class="op" id="7762659">+</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7762662">&#34;a381fe3081fb30120603551d130101ff040830060101ff020100300b0603551d0f040403020106&#34;</span>&nbsp;<span class="op" id="7762743">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7762746">&#34;301106096086480186f842010104040302010630280603551d110421301fa41d301b3119301706&#34;</span>&nbsp;<span class="op" id="7762827">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7762830">&#34;035504031310507269766174654c6162656c332d313530310603551d1f042a30283026a024a022&#34;</span>&nbsp;<span class="op" id="7762911">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7762914">&#34;8620687474703a2f2f63726c2e766572697369676e2e636f6d2f706361332e63726c303206082b&#34;</span>&nbsp;<span class="op" id="7762995">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7762998">&#34;0601050507010104263024302206082b060105050730018616687474703a2f2f6f6373702e7468&#34;</span>&nbsp;<span class="op" id="7763079">+</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7763082">&#34;617774652e636f6d30340603551d25042d302b06082b0601050507030106082b06010505070302&#34;</span>&nbsp;<span class="op" id="7763163">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7763166">&#34;06096086480186f8420401060a6086480186f845010801300d06092a864886f70d010105050003&#34;</span>&nbsp;<span class="op" id="7763247">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7763250">&#34;81810055ac63eadea1ddd2905f9f0bce76be13518f93d9052bc81b774bad6950a1eededcfddb07&#34;</span>&nbsp;<span class="op" id="7763331">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7763334">&#34;e9e83994dcab72792f06bfab8170c4a8edea5334edef1e53d906c7562bd15cf4d18a8eb42bb137&#34;</span>&nbsp;<span class="op" id="7763415">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7763418">&#34;9048084225c53e8acb7feb6f04d16dc574a2f7a27c7b603c77cd0ece48027f012fb69b37e02a2a&#34;</span>&nbsp;<span class="op" id="7763499">+</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7763502">&#34;36dcd585d6ace53f546f961e05af&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7763534">func</span>&nbsp;<span class="ident" id="7763539">TestCreateSelfSignedCertificate</span><span class="op" id="7763570">(</span><span class="ident" id="7763571">t</span>&nbsp;<span class="op" id="7763573">*</span><span class="ident" id="7763574">testing</span><span class="op" id="7763581">.</span><span class="ident" id="7763582">T</span><span class="op" id="7763583">)</span>&nbsp;<span class="op" id="7763585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7763588">random</span>&nbsp;<span class="op" id="7763595">:=</span>&nbsp;<span class="ident" id="7763598">rand</span><span class="op" id="7763602">.</span><span class="ident" id="7763603">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7763612">block</span><span class="op" id="7763617">,</span>&nbsp;<span class="ident" id="7763619">_</span>&nbsp;<span class="op" id="7763621">:=</span>&nbsp;<span class="ident" id="7763624">pem</span><span class="op" id="7763627">.</span><span class="ident" id="7763628">Decode</span><span class="op" id="7763634">(</span><span class="op" id="7763635">[</span><span class="op" id="7763636">]</span><span class="builtintype" id="7763637">byte</span><span class="op" id="7763641">(</span><span class="ident" id="7763642">pemPrivateKey</span><span class="op" id="7763655">)</span><span class="op" id="7763656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7763659">rsaPriv</span><span class="op" id="7763666">,</span>&nbsp;<span class="ident" id="7763668">err</span>&nbsp;<span class="op" id="7763672">:=</span>&nbsp;<span class="ident" id="7763675">ParsePKCS1PrivateKey</span><span class="op" id="7763695">(</span><span class="ident" id="7763696">block</span><span class="op" id="7763701">.</span><span class="ident" id="7763702">Bytes</span><span class="op" id="7763707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7763710">if</span>&nbsp;<span class="ident" id="7763713">err</span>&nbsp;<span class="op" id="7763717">!=</span>&nbsp;<span class="ident" id="7763720">nil</span>&nbsp;<span class="op" id="7763724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7763728">t</span><span class="op" id="7763729">.</span><span class="ident" id="7763730">Fatalf</span><span class="op" id="7763736">(</span><span class="string" id="7763737">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7763770">,</span>&nbsp;<span class="ident" id="7763772">err</span><span class="op" id="7763775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7763778">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7763782">ecdsaPriv</span><span class="op" id="7763791">,</span>&nbsp;<span class="ident" id="7763793">err</span>&nbsp;<span class="op" id="7763797">:=</span>&nbsp;<span class="ident" id="7763800">ecdsa</span><span class="op" id="7763805">.</span><span class="ident" id="7763806">GenerateKey</span><span class="op" id="7763817">(</span><span class="ident" id="7763818">elliptic</span><span class="op" id="7763826">.</span><span class="ident" id="7763827">P256</span><span class="op" id="7763831">(</span><span class="op" id="7763832">)</span><span class="op" id="7763833">,</span>&nbsp;<span class="ident" id="7763835">rand</span><span class="op" id="7763839">.</span><span class="ident" id="7763840">Reader</span><span class="op" id="7763846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7763849">if</span>&nbsp;<span class="ident" id="7763852">err</span>&nbsp;<span class="op" id="7763856">!=</span>&nbsp;<span class="ident" id="7763859">nil</span>&nbsp;<span class="op" id="7763863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7763867">t</span><span class="op" id="7763868">.</span><span class="ident" id="7763869">Fatalf</span><span class="op" id="7763875">(</span><span class="string" id="7763876">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7763910">,</span>&nbsp;<span class="ident" id="7763912">err</span><span class="op" id="7763915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7763918">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7763922">tests</span>&nbsp;<span class="op" id="7763928">:=</span>&nbsp;<span class="op" id="7763931">[</span><span class="op" id="7763932">]</span><span class="keyword" id="7763933">struct</span>&nbsp;<span class="op" id="7763940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7763944">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7763954">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7763963">pub</span><span class="op" id="7763966">,</span>&nbsp;<span class="ident" id="7763968">priv</span>&nbsp;<span class="keyword" id="7763973">interface</span><span class="op" id="7763982">{</span><span class="op" id="7763983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7763987">checkSig</span>&nbsp;&nbsp;<span class="builtintype" id="7763997">bool</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7764004">sigAlgo</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7764014">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7764034">}</span><span class="op" id="7764035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7764039">{</span><span class="string" id="7764040">&#34;RSA/RSA&#34;</span><span class="op" id="7764049">,</span>&nbsp;<span class="op" id="7764051">&amp;</span><span class="ident" id="7764052">rsaPriv</span><span class="op" id="7764059">.</span><span class="ident" id="7764060">PublicKey</span><span class="op" id="7764069">,</span>&nbsp;<span class="ident" id="7764071">rsaPriv</span><span class="op" id="7764078">,</span>&nbsp;<span class="builtintype" id="7764080">true</span><span class="op" id="7764084">,</span>&nbsp;<span class="ident" id="7764086">SHA1WithRSA</span><span class="op" id="7764097">}</span><span class="op" id="7764098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7764102">{</span><span class="string" id="7764103">&#34;RSA/ECDSA&#34;</span><span class="op" id="7764114">,</span>&nbsp;<span class="op" id="7764116">&amp;</span><span class="ident" id="7764117">rsaPriv</span><span class="op" id="7764124">.</span><span class="ident" id="7764125">PublicKey</span><span class="op" id="7764134">,</span>&nbsp;<span class="ident" id="7764136">ecdsaPriv</span><span class="op" id="7764145">,</span>&nbsp;<span class="builtintype" id="7764147">false</span><span class="op" id="7764152">,</span>&nbsp;<span class="ident" id="7764154">ECDSAWithSHA384</span><span class="op" id="7764169">}</span><span class="op" id="7764170">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7764174">{</span><span class="string" id="7764175">&#34;ECDSA/RSA&#34;</span><span class="op" id="7764186">,</span>&nbsp;<span class="op" id="7764188">&amp;</span><span class="ident" id="7764189">ecdsaPriv</span><span class="op" id="7764198">.</span><span class="ident" id="7764199">PublicKey</span><span class="op" id="7764208">,</span>&nbsp;<span class="ident" id="7764210">rsaPriv</span><span class="op" id="7764217">,</span>&nbsp;<span class="builtintype" id="7764219">false</span><span class="op" id="7764224">,</span>&nbsp;<span class="ident" id="7764226">SHA256WithRSA</span><span class="op" id="7764239">}</span><span class="op" id="7764240">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7764244">{</span><span class="string" id="7764245">&#34;ECDSA/ECDSA&#34;</span><span class="op" id="7764258">,</span>&nbsp;<span class="op" id="7764260">&amp;</span><span class="ident" id="7764261">ecdsaPriv</span><span class="op" id="7764270">.</span><span class="ident" id="7764271">PublicKey</span><span class="op" id="7764280">,</span>&nbsp;<span class="ident" id="7764282">ecdsaPriv</span><span class="op" id="7764291">,</span>&nbsp;<span class="builtintype" id="7764293">true</span><span class="op" id="7764297">,</span>&nbsp;<span class="ident" id="7764299">ECDSAWithSHA1</span><span class="op" id="7764312">}</span><span class="op" id="7764313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7764316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7764320">testExtKeyUsage</span>&nbsp;<span class="op" id="7764336">:=</span>&nbsp;<span class="op" id="7764339">[</span><span class="op" id="7764340">]</span><span class="ident" id="7764341">ExtKeyUsage</span><span class="op" id="7764352">{</span><span class="ident" id="7764353">ExtKeyUsageClientAuth</span><span class="op" id="7764374">,</span>&nbsp;<span class="ident" id="7764376">ExtKeyUsageServerAuth</span><span class="op" id="7764397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7764400">testUnknownExtKeyUsage</span>&nbsp;<span class="op" id="7764423">:=</span>&nbsp;<span class="op" id="7764426">[</span><span class="op" id="7764427">]</span><span class="ident" id="7764428">asn1</span><span class="op" id="7764432">.</span><span class="ident" id="7764433">ObjectIdentifier</span><span class="op" id="7764449">{</span><span class="op" id="7764450">[</span><span class="op" id="7764451">]</span><span class="builtintype" id="7764452">int</span><span class="op" id="7764455">{</span><span class="num" id="7764456">1</span><span class="op" id="7764457">,</span>&nbsp;<span class="num" id="7764459">2</span><span class="op" id="7764460">,</span>&nbsp;<span class="num" id="7764462">3</span><span class="op" id="7764463">}</span><span class="op" id="7764464">,</span>&nbsp;<span class="op" id="7764466">[</span><span class="op" id="7764467">]</span><span class="builtintype" id="7764468">int</span><span class="op" id="7764471">{</span><span class="num" id="7764472">2</span><span class="op" id="7764473">,</span>&nbsp;<span class="num" id="7764475">59</span><span class="op" id="7764477">,</span>&nbsp;<span class="num" id="7764479">1</span><span class="op" id="7764480">}</span><span class="op" id="7764481">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7764484">extraExtensionData</span>&nbsp;<span class="op" id="7764503">:=</span>&nbsp;<span class="op" id="7764506">[</span><span class="op" id="7764507">]</span><span class="builtintype" id="7764508">byte</span><span class="op" id="7764512">(</span><span class="string" id="7764513">&#34;extra&nbsp;extension&#34;</span><span class="op" id="7764530">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7764534">for</span>&nbsp;<span class="ident" id="7764538">_</span><span class="op" id="7764539">,</span>&nbsp;<span class="ident" id="7764541">test</span>&nbsp;<span class="op" id="7764546">:=</span>&nbsp;<span class="keyword" id="7764549">range</span>&nbsp;<span class="ident" id="7764555">tests</span>&nbsp;<span class="op" id="7764561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7764565">commonName</span>&nbsp;<span class="op" id="7764576">:=</span>&nbsp;<span class="string" id="7764579">&#34;test.example.com&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7764600">template</span>&nbsp;<span class="op" id="7764609">:=</span>&nbsp;<span class="ident" id="7764612">Certificate</span><span class="op" id="7764623">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7764628">SerialNumber</span><span class="op" id="7764640">:</span>&nbsp;<span class="ident" id="7764642">big</span><span class="op" id="7764645">.</span><span class="ident" id="7764646">NewInt</span><span class="op" id="7764652">(</span><span class="num" id="7764653">1</span><span class="op" id="7764654">)</span><span class="op" id="7764655">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7764660">Subject</span><span class="op" id="7764667">:</span>&nbsp;<span class="ident" id="7764669">pkix</span><span class="op" id="7764673">.</span><span class="ident" id="7764674">Name</span><span class="op" id="7764678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7764684">CommonName</span><span class="op" id="7764694">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7764698">commonName</span><span class="op" id="7764708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7764714">Organization</span><span class="op" id="7764726">:</span>&nbsp;<span class="op" id="7764728">[</span><span class="op" id="7764729">]</span><span class="builtintype" id="7764730">string</span><span class="op" id="7764736">{</span><span class="string" id="7764737">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7764749">}</span><span class="op" id="7764750">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7764755">}</span><span class="op" id="7764756">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7764761">NotBefore</span><span class="op" id="7764770">:</span>&nbsp;<span class="ident" id="7764772">time</span><span class="op" id="7764776">.</span><span class="ident" id="7764777">Unix</span><span class="op" id="7764781">(</span><span class="num" id="7764782">1000</span><span class="op" id="7764786">,</span>&nbsp;<span class="num" id="7764788">0</span><span class="op" id="7764789">)</span><span class="op" id="7764790">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7764795">NotAfter</span><span class="op" id="7764803">:</span>&nbsp;&nbsp;<span class="ident" id="7764806">time</span><span class="op" id="7764810">.</span><span class="ident" id="7764811">Unix</span><span class="op" id="7764815">(</span><span class="num" id="7764816">100000</span><span class="op" id="7764822">,</span>&nbsp;<span class="num" id="7764824">0</span><span class="op" id="7764825">)</span><span class="op" id="7764826">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7764832">SignatureAlgorithm</span><span class="op" id="7764850">:</span>&nbsp;<span class="ident" id="7764852">test</span><span class="op" id="7764856">.</span><span class="ident" id="7764857">sigAlgo</span><span class="op" id="7764864">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7764870">SubjectKeyId</span><span class="op" id="7764882">:</span>&nbsp;<span class="op" id="7764884">[</span><span class="op" id="7764885">]</span><span class="builtintype" id="7764886">byte</span><span class="op" id="7764890">{</span><span class="num" id="7764891">1</span><span class="op" id="7764892">,</span>&nbsp;<span class="num" id="7764894">2</span><span class="op" id="7764895">,</span>&nbsp;<span class="num" id="7764897">3</span><span class="op" id="7764898">,</span>&nbsp;<span class="num" id="7764900">4</span><span class="op" id="7764901">}</span><span class="op" id="7764902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7764907">KeyUsage</span><span class="op" id="7764915">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7764921">KeyUsageCertSign</span><span class="op" id="7764937">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7764943">ExtKeyUsage</span><span class="op" id="7764954">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7764963">testExtKeyUsage</span><span class="op" id="7764978">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7764983">UnknownExtKeyUsage</span><span class="op" id="7765001">:</span>&nbsp;<span class="ident" id="7765003">testUnknownExtKeyUsage</span><span class="op" id="7765025">,</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7765031">BasicConstraintsValid</span><span class="op" id="7765052">:</span>&nbsp;<span class="builtintype" id="7765054">true</span><span class="op" id="7765058">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7765063">IsCA</span><span class="op" id="7765067">:</span>&nbsp;<span class="builtintype" id="7765069">true</span><span class="op" id="7765073">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7765079">OCSPServer</span><span class="op" id="7765089">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7765102">[</span><span class="op" id="7765103">]</span><span class="builtintype" id="7765104">string</span><span class="op" id="7765110">{</span><span class="string" id="7765111">&#34;http://ocsp.example.com&#34;</span><span class="op" id="7765136">}</span><span class="op" id="7765137">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7765142">IssuingCertificateURL</span><span class="op" id="7765163">:</span>&nbsp;<span class="op" id="7765165">[</span><span class="op" id="7765166">]</span><span class="builtintype" id="7765167">string</span><span class="op" id="7765173">{</span><span class="string" id="7765174">&#34;http://crt.example.com/ca1.crt&#34;</span><span class="op" id="7765206">}</span><span class="op" id="7765207">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7765213">DNSNames</span><span class="op" id="7765221">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7765229">[</span><span class="op" id="7765230">]</span><span class="builtintype" id="7765231">string</span><span class="op" id="7765237">{</span><span class="string" id="7765238">&#34;test.example.com&#34;</span><span class="op" id="7765256">}</span><span class="op" id="7765257">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7765262">EmailAddresses</span><span class="op" id="7765276">:</span>&nbsp;<span class="op" id="7765278">[</span><span class="op" id="7765279">]</span><span class="builtintype" id="7765280">string</span><span class="op" id="7765286">{</span><span class="string" id="7765287">&#34;gopher@golang.org&#34;</span><span class="op" id="7765306">}</span><span class="op" id="7765307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7765312">IPAddresses</span><span class="op" id="7765323">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7765328">[</span><span class="op" id="7765329">]</span><span class="ident" id="7765330">net</span><span class="op" id="7765333">.</span><span class="ident" id="7765334">IP</span><span class="op" id="7765336">{</span><span class="ident" id="7765337">net</span><span class="op" id="7765340">.</span><span class="ident" id="7765341">IPv4</span><span class="op" id="7765345">(</span><span class="num" id="7765346">127</span><span class="op" id="7765349">,</span>&nbsp;<span class="num" id="7765351">0</span><span class="op" id="7765352">,</span>&nbsp;<span class="num" id="7765354">0</span><span class="op" id="7765355">,</span>&nbsp;<span class="num" id="7765357">1</span><span class="op" id="7765358">)</span><span class="op" id="7765359">.</span><span class="ident" id="7765360">To4</span><span class="op" id="7765363">(</span><span class="op" id="7765364">)</span><span class="op" id="7765365">,</span>&nbsp;<span class="ident" id="7765367">net</span><span class="op" id="7765370">.</span><span class="ident" id="7765371">ParseIP</span><span class="op" id="7765378">(</span><span class="string" id="7765379">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="7765401">)</span><span class="op" id="7765402">}</span><span class="op" id="7765403">,</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7765409">PolicyIdentifiers</span><span class="op" id="7765426">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="7765430">[</span><span class="op" id="7765431">]</span><span class="ident" id="7765432">asn1</span><span class="op" id="7765436">.</span><span class="ident" id="7765437">ObjectIdentifier</span><span class="op" id="7765453">{</span><span class="op" id="7765454">[</span><span class="op" id="7765455">]</span><span class="builtintype" id="7765456">int</span><span class="op" id="7765459">{</span><span class="num" id="7765460">1</span><span class="op" id="7765461">,</span>&nbsp;<span class="num" id="7765463">2</span><span class="op" id="7765464">,</span>&nbsp;<span class="num" id="7765466">3</span><span class="op" id="7765467">}</span><span class="op" id="7765468">}</span><span class="op" id="7765469">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7765474">PermittedDNSDomains</span><span class="op" id="7765493">:</span>&nbsp;<span class="op" id="7765495">[</span><span class="op" id="7765496">]</span><span class="builtintype" id="7765497">string</span><span class="op" id="7765503">{</span><span class="string" id="7765504">&#34;.example.com&#34;</span><span class="op" id="7765518">,</span>&nbsp;<span class="string" id="7765520">&#34;example.com&#34;</span><span class="op" id="7765533">}</span><span class="op" id="7765534">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7765540">CRLDistributionPoints</span><span class="op" id="7765561">:</span>&nbsp;<span class="op" id="7765563">[</span><span class="op" id="7765564">]</span><span class="builtintype" id="7765565">string</span><span class="op" id="7765571">{</span><span class="string" id="7765572">&#34;http://crl1.example.com/ca1.crl&#34;</span><span class="op" id="7765605">,</span>&nbsp;<span class="string" id="7765607">&#34;http://crl2.example.com/ca1.crl&#34;</span><span class="op" id="7765640">}</span><span class="op" id="7765641">,</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7765647">ExtraExtensions</span><span class="op" id="7765662">:</span>&nbsp;<span class="op" id="7765664">[</span><span class="op" id="7765665">]</span><span class="ident" id="7765666">pkix</span><span class="op" id="7765670">.</span><span class="ident" id="7765671">Extension</span><span class="op" id="7765680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7765686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7765693">Id</span><span class="op" id="7765695">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7765700">[</span><span class="op" id="7765701">]</span><span class="builtintype" id="7765702">int</span><span class="op" id="7765705">{</span><span class="num" id="7765706">1</span><span class="op" id="7765707">,</span>&nbsp;<span class="num" id="7765709">2</span><span class="op" id="7765710">,</span>&nbsp;<span class="num" id="7765712">3</span><span class="op" id="7765713">,</span>&nbsp;<span class="num" id="7765715">4</span><span class="op" id="7765716">}</span><span class="op" id="7765717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7765724">Value</span><span class="op" id="7765729">:</span>&nbsp;<span class="ident" id="7765731">extraExtensionData</span><span class="op" id="7765749">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7765755">}</span><span class="op" id="7765756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7765762">//&nbsp;This&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;SubjectKeyId,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7765825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7765832">Id</span><span class="op" id="7765834">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7765842">oidExtensionSubjectKeyId</span><span class="op" id="7765866">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7765873">Critical</span><span class="op" id="7765881">:</span>&nbsp;<span class="builtintype" id="7765883">false</span><span class="op" id="7765888">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7765895">Value</span><span class="op" id="7765900">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7765905">[</span><span class="op" id="7765906">]</span><span class="builtintype" id="7765907">byte</span><span class="op" id="7765911">{</span><span class="num" id="7765912">0x04</span><span class="op" id="7765916">,</span>&nbsp;<span class="num" id="7765918">0x04</span><span class="op" id="7765922">,</span>&nbsp;<span class="num" id="7765924">4</span><span class="op" id="7765925">,</span>&nbsp;<span class="num" id="7765927">3</span><span class="op" id="7765928">,</span>&nbsp;<span class="num" id="7765930">2</span><span class="op" id="7765931">,</span>&nbsp;<span class="num" id="7765933">1</span><span class="op" id="7765934">}</span><span class="op" id="7765935">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7765941">}</span><span class="op" id="7765942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7765947">}</span><span class="op" id="7765948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7765952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7765957">derBytes</span><span class="op" id="7765965">,</span>&nbsp;<span class="ident" id="7765967">err</span>&nbsp;<span class="op" id="7765971">:=</span>&nbsp;<span class="ident" id="7765974">CreateCertificate</span><span class="op" id="7765991">(</span><span class="ident" id="7765992">random</span><span class="op" id="7765998">,</span>&nbsp;<span class="op" id="7766000">&amp;</span><span class="ident" id="7766001">template</span><span class="op" id="7766009">,</span>&nbsp;<span class="op" id="7766011">&amp;</span><span class="ident" id="7766012">template</span><span class="op" id="7766020">,</span>&nbsp;<span class="ident" id="7766022">test</span><span class="op" id="7766026">.</span><span class="ident" id="7766027">pub</span><span class="op" id="7766030">,</span>&nbsp;<span class="ident" id="7766032">test</span><span class="op" id="7766036">.</span><span class="ident" id="7766037">priv</span><span class="op" id="7766041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7766045">if</span>&nbsp;<span class="ident" id="7766048">err</span>&nbsp;<span class="op" id="7766052">!=</span>&nbsp;<span class="ident" id="7766055">nil</span>&nbsp;<span class="op" id="7766059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7766064">t</span><span class="op" id="7766065">.</span><span class="ident" id="7766066">Errorf</span><span class="op" id="7766072">(</span><span class="string" id="7766073">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7766111">,</span>&nbsp;<span class="ident" id="7766113">test</span><span class="op" id="7766117">.</span><span class="ident" id="7766118">name</span><span class="op" id="7766122">,</span>&nbsp;<span class="ident" id="7766124">err</span><span class="op" id="7766127">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7766132">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7766143">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7766148">cert</span><span class="op" id="7766152">,</span>&nbsp;<span class="ident" id="7766154">err</span>&nbsp;<span class="op" id="7766158">:=</span>&nbsp;<span class="ident" id="7766161">ParseCertificate</span><span class="op" id="7766177">(</span><span class="ident" id="7766178">derBytes</span><span class="op" id="7766186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7766190">if</span>&nbsp;<span class="ident" id="7766193">err</span>&nbsp;<span class="op" id="7766197">!=</span>&nbsp;<span class="ident" id="7766200">nil</span>&nbsp;<span class="op" id="7766204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7766209">t</span><span class="op" id="7766210">.</span><span class="ident" id="7766211">Errorf</span><span class="op" id="7766217">(</span><span class="string" id="7766218">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7766255">,</span>&nbsp;<span class="ident" id="7766257">test</span><span class="op" id="7766261">.</span><span class="ident" id="7766262">name</span><span class="op" id="7766266">,</span>&nbsp;<span class="ident" id="7766268">err</span><span class="op" id="7766271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7766276">continue</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7766287">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7766292">if</span>&nbsp;<span class="builtinfunc" id="7766295">len</span><span class="op" id="7766298">(</span><span class="ident" id="7766299">cert</span><span class="op" id="7766303">.</span><span class="ident" id="7766304">PolicyIdentifiers</span><span class="op" id="7766321">)</span>&nbsp;<span class="op" id="7766323">!=</span>&nbsp;<span class="num" id="7766326">1</span>&nbsp;<span class="op" id="7766328">||</span>&nbsp;<span class="op" id="7766331">!</span><span class="ident" id="7766332">cert</span><span class="op" id="7766336">.</span><span class="ident" id="7766337">PolicyIdentifiers</span><span class="op" id="7766354">[</span><span class="num" id="7766355">0</span><span class="op" id="7766356">]</span><span class="op" id="7766357">.</span><span class="ident" id="7766358">Equal</span><span class="op" id="7766363">(</span><span class="ident" id="7766364">template</span><span class="op" id="7766372">.</span><span class="ident" id="7766373">PolicyIdentifiers</span><span class="op" id="7766390">[</span><span class="num" id="7766391">0</span><span class="op" id="7766392">]</span><span class="op" id="7766393">)</span>&nbsp;<span class="op" id="7766395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7766400">t</span><span class="op" id="7766401">.</span><span class="ident" id="7766402">Errorf</span><span class="op" id="7766408">(</span><span class="string" id="7766409">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;policy&nbsp;identifiers:&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="7766467">,</span>&nbsp;<span class="ident" id="7766469">test</span><span class="op" id="7766473">.</span><span class="ident" id="7766474">name</span><span class="op" id="7766478">,</span>&nbsp;<span class="ident" id="7766480">cert</span><span class="op" id="7766484">.</span><span class="ident" id="7766485">PolicyIdentifiers</span><span class="op" id="7766502">,</span>&nbsp;<span class="ident" id="7766504">template</span><span class="op" id="7766512">.</span><span class="ident" id="7766513">PolicyIdentifiers</span><span class="op" id="7766530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7766534">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7766539">if</span>&nbsp;<span class="builtinfunc" id="7766542">len</span><span class="op" id="7766545">(</span><span class="ident" id="7766546">cert</span><span class="op" id="7766550">.</span><span class="ident" id="7766551">PermittedDNSDomains</span><span class="op" id="7766570">)</span>&nbsp;<span class="op" id="7766572">!=</span>&nbsp;<span class="num" id="7766575">2</span>&nbsp;<span class="op" id="7766577">||</span>&nbsp;<span class="ident" id="7766580">cert</span><span class="op" id="7766584">.</span><span class="ident" id="7766585">PermittedDNSDomains</span><span class="op" id="7766604">[</span><span class="num" id="7766605">0</span><span class="op" id="7766606">]</span>&nbsp;<span class="op" id="7766608">!=</span>&nbsp;<span class="string" id="7766611">&#34;.example.com&#34;</span>&nbsp;<span class="op" id="7766626">||</span>&nbsp;<span class="ident" id="7766629">cert</span><span class="op" id="7766633">.</span><span class="ident" id="7766634">PermittedDNSDomains</span><span class="op" id="7766653">[</span><span class="num" id="7766654">1</span><span class="op" id="7766655">]</span>&nbsp;<span class="op" id="7766657">!=</span>&nbsp;<span class="string" id="7766660">&#34;example.com&#34;</span>&nbsp;<span class="op" id="7766674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7766679">t</span><span class="op" id="7766680">.</span><span class="ident" id="7766681">Errorf</span><span class="op" id="7766687">(</span><span class="string" id="7766688">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;name&nbsp;constraints:&nbsp;%#v&#34;</span><span class="op" id="7766731">,</span>&nbsp;<span class="ident" id="7766733">test</span><span class="op" id="7766737">.</span><span class="ident" id="7766738">name</span><span class="op" id="7766742">,</span>&nbsp;<span class="ident" id="7766744">cert</span><span class="op" id="7766748">.</span><span class="ident" id="7766749">PermittedDNSDomains</span><span class="op" id="7766768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7766772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7766777">if</span>&nbsp;<span class="ident" id="7766780">cert</span><span class="op" id="7766784">.</span><span class="ident" id="7766785">Subject</span><span class="op" id="7766792">.</span><span class="ident" id="7766793">CommonName</span>&nbsp;<span class="op" id="7766804">!=</span>&nbsp;<span class="ident" id="7766807">commonName</span>&nbsp;<span class="op" id="7766818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7766823">t</span><span class="op" id="7766824">.</span><span class="ident" id="7766825">Errorf</span><span class="op" id="7766831">(</span><span class="string" id="7766832">&#34;%s:&nbsp;subject&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7766904">,</span>&nbsp;<span class="ident" id="7766906">test</span><span class="op" id="7766910">.</span><span class="ident" id="7766911">name</span><span class="op" id="7766915">,</span>&nbsp;<span class="ident" id="7766917">cert</span><span class="op" id="7766921">.</span><span class="ident" id="7766922">Subject</span><span class="op" id="7766929">.</span><span class="ident" id="7766930">CommonName</span><span class="op" id="7766940">,</span>&nbsp;<span class="ident" id="7766942">commonName</span><span class="op" id="7766952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7766956">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7766961">if</span>&nbsp;<span class="ident" id="7766964">cert</span><span class="op" id="7766968">.</span><span class="ident" id="7766969">Issuer</span><span class="op" id="7766975">.</span><span class="ident" id="7766976">CommonName</span>&nbsp;<span class="op" id="7766987">!=</span>&nbsp;<span class="ident" id="7766990">commonName</span>&nbsp;<span class="op" id="7767001">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7767006">t</span><span class="op" id="7767007">.</span><span class="ident" id="7767008">Errorf</span><span class="op" id="7767014">(</span><span class="string" id="7767015">&#34;%s:&nbsp;issuer&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7767086">,</span>&nbsp;<span class="ident" id="7767088">test</span><span class="op" id="7767092">.</span><span class="ident" id="7767093">name</span><span class="op" id="7767097">,</span>&nbsp;<span class="ident" id="7767099">cert</span><span class="op" id="7767103">.</span><span class="ident" id="7767104">Issuer</span><span class="op" id="7767110">.</span><span class="ident" id="7767111">CommonName</span><span class="op" id="7767121">,</span>&nbsp;<span class="ident" id="7767123">commonName</span><span class="op" id="7767133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7767137">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7767142">if</span>&nbsp;<span class="ident" id="7767145">cert</span><span class="op" id="7767149">.</span><span class="ident" id="7767150">SignatureAlgorithm</span>&nbsp;<span class="op" id="7767169">!=</span>&nbsp;<span class="ident" id="7767172">test</span><span class="op" id="7767176">.</span><span class="ident" id="7767177">sigAlgo</span>&nbsp;<span class="op" id="7767185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7767190">t</span><span class="op" id="7767191">.</span><span class="ident" id="7767192">Errorf</span><span class="op" id="7767198">(</span><span class="string" id="7767199">&#34;%s:&nbsp;SignatureAlgorithm&nbsp;wasn&#39;t&nbsp;copied&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7767268">,</span>&nbsp;<span class="ident" id="7767270">test</span><span class="op" id="7767274">.</span><span class="ident" id="7767275">name</span><span class="op" id="7767279">,</span>&nbsp;<span class="ident" id="7767281">cert</span><span class="op" id="7767285">.</span><span class="ident" id="7767286">SignatureAlgorithm</span><span class="op" id="7767304">,</span>&nbsp;<span class="ident" id="7767306">test</span><span class="op" id="7767310">.</span><span class="ident" id="7767311">sigAlgo</span><span class="op" id="7767318">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7767322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7767327">if</span>&nbsp;<span class="op" id="7767330">!</span><span class="ident" id="7767331">reflect</span><span class="op" id="7767338">.</span><span class="ident" id="7767339">DeepEqual</span><span class="op" id="7767348">(</span><span class="ident" id="7767349">cert</span><span class="op" id="7767353">.</span><span class="ident" id="7767354">ExtKeyUsage</span><span class="op" id="7767365">,</span>&nbsp;<span class="ident" id="7767367">testExtKeyUsage</span><span class="op" id="7767382">)</span>&nbsp;<span class="op" id="7767384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7767389">t</span><span class="op" id="7767390">.</span><span class="ident" id="7767391">Errorf</span><span class="op" id="7767397">(</span><span class="string" id="7767398">&#34;%s:&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7767474">,</span>&nbsp;<span class="ident" id="7767476">test</span><span class="op" id="7767480">.</span><span class="ident" id="7767481">name</span><span class="op" id="7767485">,</span>&nbsp;<span class="ident" id="7767487">cert</span><span class="op" id="7767491">.</span><span class="ident" id="7767492">ExtKeyUsage</span><span class="op" id="7767503">,</span>&nbsp;<span class="ident" id="7767505">testExtKeyUsage</span><span class="op" id="7767520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7767524">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7767529">if</span>&nbsp;<span class="op" id="7767532">!</span><span class="ident" id="7767533">reflect</span><span class="op" id="7767540">.</span><span class="ident" id="7767541">DeepEqual</span><span class="op" id="7767550">(</span><span class="ident" id="7767551">cert</span><span class="op" id="7767555">.</span><span class="ident" id="7767556">UnknownExtKeyUsage</span><span class="op" id="7767574">,</span>&nbsp;<span class="ident" id="7767576">testUnknownExtKeyUsage</span><span class="op" id="7767598">)</span>&nbsp;<span class="op" id="7767600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7767605">t</span><span class="op" id="7767606">.</span><span class="ident" id="7767607">Errorf</span><span class="op" id="7767613">(</span><span class="string" id="7767614">&#34;%s:&nbsp;unknown&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7767698">,</span>&nbsp;<span class="ident" id="7767700">test</span><span class="op" id="7767704">.</span><span class="ident" id="7767705">name</span><span class="op" id="7767709">,</span>&nbsp;<span class="ident" id="7767711">cert</span><span class="op" id="7767715">.</span><span class="ident" id="7767716">UnknownExtKeyUsage</span><span class="op" id="7767734">,</span>&nbsp;<span class="ident" id="7767736">testUnknownExtKeyUsage</span><span class="op" id="7767758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7767762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7767767">if</span>&nbsp;<span class="op" id="7767770">!</span><span class="ident" id="7767771">reflect</span><span class="op" id="7767778">.</span><span class="ident" id="7767779">DeepEqual</span><span class="op" id="7767788">(</span><span class="ident" id="7767789">cert</span><span class="op" id="7767793">.</span><span class="ident" id="7767794">OCSPServer</span><span class="op" id="7767804">,</span>&nbsp;<span class="ident" id="7767806">template</span><span class="op" id="7767814">.</span><span class="ident" id="7767815">OCSPServer</span><span class="op" id="7767825">)</span>&nbsp;<span class="op" id="7767827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7767832">t</span><span class="op" id="7767833">.</span><span class="ident" id="7767834">Errorf</span><span class="op" id="7767840">(</span><span class="string" id="7767841">&#34;%s:&nbsp;OCSP&nbsp;servers&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7767897">,</span>&nbsp;<span class="ident" id="7767899">test</span><span class="op" id="7767903">.</span><span class="ident" id="7767904">name</span><span class="op" id="7767908">,</span>&nbsp;<span class="ident" id="7767910">cert</span><span class="op" id="7767914">.</span><span class="ident" id="7767915">OCSPServer</span><span class="op" id="7767925">,</span>&nbsp;<span class="ident" id="7767927">template</span><span class="op" id="7767935">.</span><span class="ident" id="7767936">OCSPServer</span><span class="op" id="7767946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7767950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7767955">if</span>&nbsp;<span class="op" id="7767958">!</span><span class="ident" id="7767959">reflect</span><span class="op" id="7767966">.</span><span class="ident" id="7767967">DeepEqual</span><span class="op" id="7767976">(</span><span class="ident" id="7767977">cert</span><span class="op" id="7767981">.</span><span class="ident" id="7767982">IssuingCertificateURL</span><span class="op" id="7768003">,</span>&nbsp;<span class="ident" id="7768005">template</span><span class="op" id="7768013">.</span><span class="ident" id="7768014">IssuingCertificateURL</span><span class="op" id="7768035">)</span>&nbsp;<span class="op" id="7768037">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7768042">t</span><span class="op" id="7768043">.</span><span class="ident" id="7768044">Errorf</span><span class="op" id="7768050">(</span><span class="string" id="7768051">&#34;%s:&nbsp;Issuing&nbsp;certificate&nbsp;URLs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7768119">,</span>&nbsp;<span class="ident" id="7768121">test</span><span class="op" id="7768125">.</span><span class="ident" id="7768126">name</span><span class="op" id="7768130">,</span>&nbsp;<span class="ident" id="7768132">cert</span><span class="op" id="7768136">.</span><span class="ident" id="7768137">IssuingCertificateURL</span><span class="op" id="7768158">,</span>&nbsp;<span class="ident" id="7768160">template</span><span class="op" id="7768168">.</span><span class="ident" id="7768169">IssuingCertificateURL</span><span class="op" id="7768190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7768194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7768199">if</span>&nbsp;<span class="op" id="7768202">!</span><span class="ident" id="7768203">reflect</span><span class="op" id="7768210">.</span><span class="ident" id="7768211">DeepEqual</span><span class="op" id="7768220">(</span><span class="ident" id="7768221">cert</span><span class="op" id="7768225">.</span><span class="ident" id="7768226">DNSNames</span><span class="op" id="7768234">,</span>&nbsp;<span class="ident" id="7768236">template</span><span class="op" id="7768244">.</span><span class="ident" id="7768245">DNSNames</span><span class="op" id="7768253">)</span>&nbsp;<span class="op" id="7768255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7768260">t</span><span class="op" id="7768261">.</span><span class="ident" id="7768262">Errorf</span><span class="op" id="7768268">(</span><span class="string" id="7768269">&#34;%s:&nbsp;SAN&nbsp;DNS&nbsp;names&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7768326">,</span>&nbsp;<span class="ident" id="7768328">test</span><span class="op" id="7768332">.</span><span class="ident" id="7768333">name</span><span class="op" id="7768337">,</span>&nbsp;<span class="ident" id="7768339">cert</span><span class="op" id="7768343">.</span><span class="ident" id="7768344">DNSNames</span><span class="op" id="7768352">,</span>&nbsp;<span class="ident" id="7768354">template</span><span class="op" id="7768362">.</span><span class="ident" id="7768363">DNSNames</span><span class="op" id="7768371">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7768375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7768380">if</span>&nbsp;<span class="op" id="7768383">!</span><span class="ident" id="7768384">reflect</span><span class="op" id="7768391">.</span><span class="ident" id="7768392">DeepEqual</span><span class="op" id="7768401">(</span><span class="ident" id="7768402">cert</span><span class="op" id="7768406">.</span><span class="ident" id="7768407">EmailAddresses</span><span class="op" id="7768421">,</span>&nbsp;<span class="ident" id="7768423">template</span><span class="op" id="7768431">.</span><span class="ident" id="7768432">EmailAddresses</span><span class="op" id="7768446">)</span>&nbsp;<span class="op" id="7768448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7768453">t</span><span class="op" id="7768454">.</span><span class="ident" id="7768455">Errorf</span><span class="op" id="7768461">(</span><span class="string" id="7768462">&#34;%s:&nbsp;SAN&nbsp;emails&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7768516">,</span>&nbsp;<span class="ident" id="7768518">test</span><span class="op" id="7768522">.</span><span class="ident" id="7768523">name</span><span class="op" id="7768527">,</span>&nbsp;<span class="ident" id="7768529">cert</span><span class="op" id="7768533">.</span><span class="ident" id="7768534">EmailAddresses</span><span class="op" id="7768548">,</span>&nbsp;<span class="ident" id="7768550">template</span><span class="op" id="7768558">.</span><span class="ident" id="7768559">EmailAddresses</span><span class="op" id="7768573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7768577">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7768582">if</span>&nbsp;<span class="op" id="7768585">!</span><span class="ident" id="7768586">reflect</span><span class="op" id="7768593">.</span><span class="ident" id="7768594">DeepEqual</span><span class="op" id="7768603">(</span><span class="ident" id="7768604">cert</span><span class="op" id="7768608">.</span><span class="ident" id="7768609">IPAddresses</span><span class="op" id="7768620">,</span>&nbsp;<span class="ident" id="7768622">template</span><span class="op" id="7768630">.</span><span class="ident" id="7768631">IPAddresses</span><span class="op" id="7768642">)</span>&nbsp;<span class="op" id="7768644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7768649">t</span><span class="op" id="7768650">.</span><span class="ident" id="7768651">Errorf</span><span class="op" id="7768657">(</span><span class="string" id="7768658">&#34;%s:&nbsp;SAN&nbsp;IPs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7768709">,</span>&nbsp;<span class="ident" id="7768711">test</span><span class="op" id="7768715">.</span><span class="ident" id="7768716">name</span><span class="op" id="7768720">,</span>&nbsp;<span class="ident" id="7768722">cert</span><span class="op" id="7768726">.</span><span class="ident" id="7768727">IPAddresses</span><span class="op" id="7768738">,</span>&nbsp;<span class="ident" id="7768740">template</span><span class="op" id="7768748">.</span><span class="ident" id="7768749">IPAddresses</span><span class="op" id="7768760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7768764">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7768769">if</span>&nbsp;<span class="op" id="7768772">!</span><span class="ident" id="7768773">reflect</span><span class="op" id="7768780">.</span><span class="ident" id="7768781">DeepEqual</span><span class="op" id="7768790">(</span><span class="ident" id="7768791">cert</span><span class="op" id="7768795">.</span><span class="ident" id="7768796">CRLDistributionPoints</span><span class="op" id="7768817">,</span>&nbsp;<span class="ident" id="7768819">template</span><span class="op" id="7768827">.</span><span class="ident" id="7768828">CRLDistributionPoints</span><span class="op" id="7768849">)</span>&nbsp;<span class="op" id="7768851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7768856">t</span><span class="op" id="7768857">.</span><span class="ident" id="7768858">Errorf</span><span class="op" id="7768864">(</span><span class="string" id="7768865">&#34;%s:&nbsp;CRL&nbsp;distribution&nbsp;points&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7768932">,</span>&nbsp;<span class="ident" id="7768934">test</span><span class="op" id="7768938">.</span><span class="ident" id="7768939">name</span><span class="op" id="7768943">,</span>&nbsp;<span class="ident" id="7768945">cert</span><span class="op" id="7768949">.</span><span class="ident" id="7768950">CRLDistributionPoints</span><span class="op" id="7768971">,</span>&nbsp;<span class="ident" id="7768973">template</span><span class="op" id="7768981">.</span><span class="ident" id="7768982">CRLDistributionPoints</span><span class="op" id="7769003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7769007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7769012">if</span>&nbsp;<span class="op" id="7769015">!</span><span class="ident" id="7769016">bytes</span><span class="op" id="7769021">.</span><span class="ident" id="7769022">Equal</span><span class="op" id="7769027">(</span><span class="ident" id="7769028">cert</span><span class="op" id="7769032">.</span><span class="ident" id="7769033">SubjectKeyId</span><span class="op" id="7769045">,</span>&nbsp;<span class="op" id="7769047">[</span><span class="op" id="7769048">]</span><span class="builtintype" id="7769049">byte</span><span class="op" id="7769053">{</span><span class="num" id="7769054">4</span><span class="op" id="7769055">,</span>&nbsp;<span class="num" id="7769057">3</span><span class="op" id="7769058">,</span>&nbsp;<span class="num" id="7769060">2</span><span class="op" id="7769061">,</span>&nbsp;<span class="num" id="7769063">1</span><span class="op" id="7769064">}</span><span class="op" id="7769065">)</span>&nbsp;<span class="op" id="7769067">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7769072">t</span><span class="op" id="7769073">.</span><span class="ident" id="7769074">Errorf</span><span class="op" id="7769080">(</span><span class="string" id="7769081">&#34;%s:&nbsp;ExtraExtensions&nbsp;didn&#39;t&nbsp;override&nbsp;SubjectKeyId&#34;</span><span class="op" id="7769131">,</span>&nbsp;<span class="ident" id="7769133">test</span><span class="op" id="7769137">.</span><span class="ident" id="7769138">name</span><span class="op" id="7769142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7769146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7769151">if</span>&nbsp;<span class="ident" id="7769154">bytes</span><span class="op" id="7769159">.</span><span class="ident" id="7769160">Index</span><span class="op" id="7769165">(</span><span class="ident" id="7769166">derBytes</span><span class="op" id="7769174">,</span>&nbsp;<span class="ident" id="7769176">extraExtensionData</span><span class="op" id="7769194">)</span>&nbsp;<span class="op" id="7769196">==</span>&nbsp;<span class="op" id="7769199">-</span><span class="num" id="7769200">1</span>&nbsp;<span class="op" id="7769202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7769207">t</span><span class="op" id="7769208">.</span><span class="ident" id="7769209">Errorf</span><span class="op" id="7769215">(</span><span class="string" id="7769216">&#34;%s:&nbsp;didn&#39;t&nbsp;find&nbsp;extra&nbsp;extension&nbsp;in&nbsp;DER&nbsp;output&#34;</span><span class="op" id="7769263">,</span>&nbsp;<span class="ident" id="7769265">test</span><span class="op" id="7769269">.</span><span class="ident" id="7769270">name</span><span class="op" id="7769274">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7769278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7769283">if</span>&nbsp;<span class="ident" id="7769286">test</span><span class="op" id="7769290">.</span><span class="ident" id="7769291">checkSig</span>&nbsp;<span class="op" id="7769300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7769305">err</span>&nbsp;<span class="op" id="7769309">=</span>&nbsp;<span class="ident" id="7769311">cert</span><span class="op" id="7769315">.</span><span class="ident" id="7769316">CheckSignatureFrom</span><span class="op" id="7769334">(</span><span class="ident" id="7769335">cert</span><span class="op" id="7769339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7769344">if</span>&nbsp;<span class="ident" id="7769347">err</span>&nbsp;<span class="op" id="7769351">!=</span>&nbsp;<span class="ident" id="7769354">nil</span>&nbsp;<span class="op" id="7769358">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7769364">t</span><span class="op" id="7769365">.</span><span class="ident" id="7769366">Errorf</span><span class="op" id="7769372">(</span><span class="string" id="7769373">&#34;%s:&nbsp;signature&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7769412">,</span>&nbsp;<span class="ident" id="7769414">test</span><span class="op" id="7769418">.</span><span class="ident" id="7769419">name</span><span class="op" id="7769423">,</span>&nbsp;<span class="ident" id="7769425">err</span><span class="op" id="7769428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7769433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7769437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7769440">}</span><br>
<span class="lineno"></span><span class="op" id="7769442">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="comment" id="7769445">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA1&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno"></span><span class="keyword" id="7769506">var</span>&nbsp;<span class="ident" id="7769510">ecdsaSHA1CertPem</span>&nbsp;<span class="op" id="7769527">=</span>&nbsp;<span class="string" id="7769529">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDjCCAbUCCQDF6SfN0nsnrjAJBgcqhkjOPQQBMIGPMQswCQYDVQQGEwJVUzET<br>
<span class="lineno">455</span>MBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNTW91bnRhaW4gVmlldzEVMBMG<br>
<span class="lineno"></span>A1UECgwMR29vZ2xlLCBJbmMuMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIwMjAyMDUw<br>
<span class="lineno"></span>WhcNMjIwNTE4MjAyMDUwWjCBjzELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTATBgNVBAoMDEdvb2dsZSwg<br>
<span class="lineno">460</span>SW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAhBgkqhkiG9w0BCQEWFGdv<br>
<span class="lineno"></span>bGFuZy1kZXZAZ21haWwuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE/Wgn<br>
<span class="lineno"></span>WQDo5+bz71T0327ERgd5SDDXFbXLpzIZDXTkjpe8QTEbsF+ezsQfrekrpDPC4Cd3<br>
<span class="lineno"></span>P9LY0tG+aI8IyVKdUjAJBgcqhkjOPQQBA0gAMEUCIGlsqMcRqWVIWTD6wXwe6Jk2<br>
<span class="lineno"></span>DKxL46r/FLgJYnzBEH99AiEA3fBouObsvV1R3oVkb4BQYnD4/4LeId6lAT43YvyV<br>
<span class="lineno">465</span>a/A=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7770308">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno">470</span><span class="keyword" id="7770371">var</span>&nbsp;<span class="ident" id="7770375">ecdsaSHA256p256CertPem</span>&nbsp;<span class="op" id="7770398">=</span>&nbsp;<span class="string" id="7770400">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDzCCAbYCCQDlsuMWvgQzhTAKBggqhkjOPQQDAjCBjzELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTAT<br>
<span class="lineno"></span>BgNVBAoMDEdvb2dsZSwgSW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAh<br>
<span class="lineno">475</span>BgkqhkiG9w0BCQEWFGdvbGFuZy1kZXZAZ21haWwuY29tMB4XDTEyMDUyMTAwMTkx<br>
<span class="lineno"></span>NloXDTIyMDUxOTAwMTkxNlowgY8xCzAJBgNVBAYTAlVTMRMwEQYDVQQIDApDYWxp<br>
<span class="lineno"></span>Zm9ybmlhMRYwFAYDVQQHDA1Nb3VudGFpbiBWaWV3MRUwEwYDVQQKDAxHb29nbGUs<br>
<span class="lineno"></span>IEluYy4xFzAVBgNVBAMMDnd3dy5nb29nbGUuY29tMSMwIQYJKoZIhvcNAQkBFhRn<br>
<span class="lineno"></span>b2xhbmctZGV2QGdtYWlsLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABPMt<br>
<span class="lineno">480</span>2ErhxAty5EJRu9yM+MTy+hUXm3pdW1ensAv382KoGExSXAFWP7pjJnNtHO+XSwVm<br>
<span class="lineno"></span>YNtqjcAGFKpweoN//kQwCgYIKoZIzj0EAwIDRwAwRAIgIYSaUA/IB81gjbIw/hUV<br>
<span class="lineno"></span>70twxJr5EcgOo0hLp3Jm+EYCIFDO3NNcgmURbJ1kfoS3N/0O+irUtoPw38YoNkqJ<br>
<span class="lineno"></span>h5wi<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno">485</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7771179">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp384r1</span><br>
<span class="lineno"></span><span class="keyword" id="7771242">var</span>&nbsp;<span class="ident" id="7771246">ecdsaSHA256p384CertPem</span>&nbsp;<span class="op" id="7771269">=</span>&nbsp;<span class="string" id="7771271">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno">490</span>MIICSjCCAdECCQDje/no7mXkVzAKBggqhkjOPQQDAjCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMDYxMDM0<br>
<span class="lineno"></span>WhcNMjIwNTE5MDYxMDM0WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno">495</span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno"></span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wdjAQBgcqhkjOPQIBBgUrgQQAIgNiAARRuzRNIKRK<br>
<span class="lineno"></span>jIktEmXanNmrTR/q/FaHXLhWRZ6nHWe26Fw7Rsrbk+VjGy4vfWtNn7xSFKrOu5ze<br>
<span class="lineno"></span>qxKnmE0h5E480MNgrUiRkaGO2GMJJVmxx20aqkXOk59U8yGA4CghE6MwCgYIKoZI<br>
<span class="lineno">500</span>zj0EAwIDZwAwZAIwBZEN8gvmRmfeP/9C1PRLzODIY4JqWub2PLRT4mv9GU+yw3Gr<br>
<span class="lineno"></span>PU9A3CHMdEcdw/MEAjBBO1lId8KOCh9UZunsSMfqXiVurpzmhWd6VYZ/32G+M+Mh<br>
<span class="lineno"></span>3yILeYQzllt/g0rKVRk=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="7772131">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA384&nbsp;&amp;&nbsp;secp521r1</span><br>
<span class="lineno"></span><span class="keyword" id="7772194">var</span>&nbsp;<span class="ident" id="7772198">ecdsaSHA384p521CertPem</span>&nbsp;<span class="op" id="7772221">=</span>&nbsp;<span class="string" id="7772223">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICljCCAfcCCQDhp1AFD/ahKjAKBggqhkjOPQQDAzCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno">510</span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMTUwNDI5<br>
<span class="lineno"></span>WhcNMjIwNTE5MTUwNDI5WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno">515</span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABACqx9Rv<br>
<span class="lineno"></span>IssRs1LWYcNN+WffwlHw4Tv3y8/LIAA9MF1ZScIonU9nRMxt4a2uGJVCPDw6JHpz<br>
<span class="lineno"></span>PaYc0E9puLoE9AfKpwFr59Jkot7dBg55SKPEFkddoip/rvmN7NPAWjMBirOwjOkm<br>
<span class="lineno"></span>8FPthvPhGPqsu9AvgVuHu3PosWiHGNrhh379pva8MzAKBggqhkjOPQQDAwOBjAAw<br>
<span class="lineno">520</span>gYgCQgEHNmswkUdPpHqrVxp9PvLVl+xxPuHBkT+75z9JizyxtqykHQo9Uh6SWCYH<br>
<span class="lineno"></span>BF9KLolo01wMt8DjoYP5Fb3j5MH7xwJCAbWZzTOp4l4DPkIvAh4LeC4VWbwPPyqh<br>
<span class="lineno"></span>kBg71w/iEcSY3wUKgHGcJJrObZw7wys91I5kENljqw/Samdr3ka+jBJa<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="7773184">var</span>&nbsp;<span class="ident" id="7773188">ecdsaTests</span>&nbsp;<span class="op" id="7773199">=</span>&nbsp;<span class="op" id="7773201">[</span><span class="op" id="7773202">]</span><span class="keyword" id="7773203">struct</span>&nbsp;<span class="op" id="7773210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773213">sigAlgo</span>&nbsp;<span class="ident" id="7773221">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773241">pemCert</span>&nbsp;<span class="builtintype" id="7773249">string</span><br>
<span class="lineno"></span><span class="op" id="7773256">}</span><span class="op" id="7773257">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7773260">{</span><span class="ident" id="7773261">ECDSAWithSHA1</span><span class="op" id="7773274">,</span>&nbsp;<span class="ident" id="7773276">ecdsaSHA1CertPem</span><span class="op" id="7773292">}</span><span class="op" id="7773293">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7773296">{</span><span class="ident" id="7773297">ECDSAWithSHA256</span><span class="op" id="7773312">,</span>&nbsp;<span class="ident" id="7773314">ecdsaSHA256p256CertPem</span><span class="op" id="7773336">}</span><span class="op" id="7773337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7773340">{</span><span class="ident" id="7773341">ECDSAWithSHA256</span><span class="op" id="7773356">,</span>&nbsp;<span class="ident" id="7773358">ecdsaSHA256p384CertPem</span><span class="op" id="7773380">}</span><span class="op" id="7773381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7773384">{</span><span class="ident" id="7773385">ECDSAWithSHA384</span><span class="op" id="7773400">,</span>&nbsp;<span class="ident" id="7773402">ecdsaSHA384p521CertPem</span><span class="op" id="7773424">}</span><span class="op" id="7773425">,</span><br>
<span class="lineno"></span><span class="op" id="7773427">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="7773430">func</span>&nbsp;<span class="ident" id="7773435">TestECDSA</span><span class="op" id="7773444">(</span><span class="ident" id="7773445">t</span>&nbsp;<span class="op" id="7773447">*</span><span class="ident" id="7773448">testing</span><span class="op" id="7773455">.</span><span class="ident" id="7773456">T</span><span class="op" id="7773457">)</span>&nbsp;<span class="op" id="7773459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7773462">for</span>&nbsp;<span class="ident" id="7773466">i</span><span class="op" id="7773467">,</span>&nbsp;<span class="ident" id="7773469">test</span>&nbsp;<span class="op" id="7773474">:=</span>&nbsp;<span class="keyword" id="7773477">range</span>&nbsp;<span class="ident" id="7773483">ecdsaTests</span>&nbsp;<span class="op" id="7773494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773498">pemBlock</span><span class="op" id="7773506">,</span>&nbsp;<span class="ident" id="7773508">_</span>&nbsp;<span class="op" id="7773510">:=</span>&nbsp;<span class="ident" id="7773513">pem</span><span class="op" id="7773516">.</span><span class="ident" id="7773517">Decode</span><span class="op" id="7773523">(</span><span class="op" id="7773524">[</span><span class="op" id="7773525">]</span><span class="builtintype" id="7773526">byte</span><span class="op" id="7773530">(</span><span class="ident" id="7773531">test</span><span class="op" id="7773535">.</span><span class="ident" id="7773536">pemCert</span><span class="op" id="7773543">)</span><span class="op" id="7773544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773548">cert</span><span class="op" id="7773552">,</span>&nbsp;<span class="ident" id="7773554">err</span>&nbsp;<span class="op" id="7773558">:=</span>&nbsp;<span class="ident" id="7773561">ParseCertificate</span><span class="op" id="7773577">(</span><span class="ident" id="7773578">pemBlock</span><span class="op" id="7773586">.</span><span class="ident" id="7773587">Bytes</span><span class="op" id="7773592">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7773596">if</span>&nbsp;<span class="ident" id="7773599">err</span>&nbsp;<span class="op" id="7773603">!=</span>&nbsp;<span class="ident" id="7773606">nil</span>&nbsp;<span class="op" id="7773610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773615">t</span><span class="op" id="7773616">.</span><span class="ident" id="7773617">Errorf</span><span class="op" id="7773623">(</span><span class="string" id="7773624">&#34;%d:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7773661">,</span>&nbsp;<span class="ident" id="7773663">i</span><span class="op" id="7773664">,</span>&nbsp;<span class="ident" id="7773666">err</span><span class="op" id="7773669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7773674">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7773685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7773689">if</span>&nbsp;<span class="ident" id="7773692">sa</span>&nbsp;<span class="op" id="7773695">:=</span>&nbsp;<span class="ident" id="7773698">cert</span><span class="op" id="7773702">.</span><span class="ident" id="7773703">SignatureAlgorithm</span><span class="op" id="7773721">;</span>&nbsp;<span class="ident" id="7773723">sa</span>&nbsp;<span class="op" id="7773726">!=</span>&nbsp;<span class="ident" id="7773729">test</span><span class="op" id="7773733">.</span><span class="ident" id="7773734">sigAlgo</span>&nbsp;<span class="op" id="7773742">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773747">t</span><span class="op" id="7773748">.</span><span class="ident" id="7773749">Errorf</span><span class="op" id="7773755">(</span><span class="string" id="7773756">&#34;%d:&nbsp;signature&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="7773796">,</span>&nbsp;<span class="ident" id="7773798">i</span><span class="op" id="7773799">,</span>&nbsp;<span class="ident" id="7773801">sa</span><span class="op" id="7773803">,</span>&nbsp;<span class="ident" id="7773805">test</span><span class="op" id="7773809">.</span><span class="ident" id="7773810">sigAlgo</span><span class="op" id="7773817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7773821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7773825">if</span>&nbsp;<span class="ident" id="7773828">parsedKey</span><span class="op" id="7773837">,</span>&nbsp;<span class="ident" id="7773839">ok</span>&nbsp;<span class="op" id="7773842">:=</span>&nbsp;<span class="ident" id="7773845">cert</span><span class="op" id="7773849">.</span><span class="ident" id="7773850">PublicKey</span><span class="op" id="7773859">.</span><span class="op" id="7773860">(</span><span class="op" id="7773861">*</span><span class="ident" id="7773862">ecdsa</span><span class="op" id="7773867">.</span><span class="ident" id="7773868">PublicKey</span><span class="op" id="7773877">)</span><span class="op" id="7773878">;</span>&nbsp;<span class="op" id="7773880">!</span><span class="ident" id="7773881">ok</span>&nbsp;<span class="op" id="7773884">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7773889">t</span><span class="op" id="7773890">.</span><span class="ident" id="7773891">Errorf</span><span class="op" id="7773897">(</span><span class="string" id="7773898">&#34;%d:&nbsp;wanted&nbsp;an&nbsp;ECDSA&nbsp;public&nbsp;key&nbsp;but&nbsp;found:&nbsp;%#v&#34;</span><span class="op" id="7773945">,</span>&nbsp;<span class="ident" id="7773947">i</span><span class="op" id="7773948">,</span>&nbsp;<span class="ident" id="7773950">parsedKey</span><span class="op" id="7773959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7773963">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7773967">if</span>&nbsp;<span class="ident" id="7773970">pka</span>&nbsp;<span class="op" id="7773974">:=</span>&nbsp;<span class="ident" id="7773977">cert</span><span class="op" id="7773981">.</span><span class="ident" id="7773982">PublicKeyAlgorithm</span><span class="op" id="7774000">;</span>&nbsp;<span class="ident" id="7774002">pka</span>&nbsp;<span class="op" id="7774006">!=</span>&nbsp;<span class="ident" id="7774009">ECDSA</span>&nbsp;<span class="op" id="7774015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774020">t</span><span class="op" id="7774021">.</span><span class="ident" id="7774022">Errorf</span><span class="op" id="7774028">(</span><span class="string" id="7774029">&#34;%d:&nbsp;public&nbsp;key&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;ECDSA&#34;</span><span class="op" id="7774073">,</span>&nbsp;<span class="ident" id="7774075">i</span><span class="op" id="7774076">,</span>&nbsp;<span class="ident" id="7774078">pka</span><span class="op" id="7774081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7774089">if</span>&nbsp;<span class="ident" id="7774092">err</span>&nbsp;<span class="op" id="7774096">=</span>&nbsp;<span class="ident" id="7774098">cert</span><span class="op" id="7774102">.</span><span class="ident" id="7774103">CheckSignatureFrom</span><span class="op" id="7774121">(</span><span class="ident" id="7774122">cert</span><span class="op" id="7774126">)</span><span class="op" id="7774127">;</span>&nbsp;<span class="ident" id="7774129">err</span>&nbsp;<span class="op" id="7774133">!=</span>&nbsp;<span class="ident" id="7774136">nil</span>&nbsp;<span class="op" id="7774140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7774145">t</span><span class="op" id="7774146">.</span><span class="ident" id="7774147">Errorf</span><span class="op" id="7774153">(</span><span class="string" id="7774154">&#34;%d:&nbsp;certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7774195">,</span>&nbsp;<span class="ident" id="7774197">i</span><span class="op" id="7774198">,</span>&nbsp;<span class="ident" id="7774200">err</span><span class="op" id="7774203">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774207">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7774210">}</span><br>
<span class="lineno"></span><span class="op" id="7774212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7774215">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;DSA&nbsp;with&nbsp;SHA1</span><br>
<span class="lineno">560</span><span class="keyword" id="7774262">var</span>&nbsp;<span class="ident" id="7774266">dsaCertPem</span>&nbsp;<span class="op" id="7774277">=</span>&nbsp;<span class="string" id="7774279">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIEDTCCA82gAwIBAgIJALHPghaoxeDhMAkGByqGSM44BAMweTELMAkGA1UEBhMC<br>
<span class="lineno"></span>VVMxCzAJBgNVBAgTAk5DMQ8wDQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2ds<br>
<span class="lineno"></span>ZSwgSW5jMRIwEAYDVQQDEwlKb24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFs<br>
<span class="lineno"></span>bGllQGdvb2dsZS5jb20wHhcNMTEwNTE0MDMwMTQ1WhcNMTEwNjEzMDMwMTQ1WjB5<br>
<span class="lineno">565</span>MQswCQYDVQQGEwJVUzELMAkGA1UECBMCTkMxDzANBgNVBAcTBk5ld3RvbjEUMBIG<br>
<span class="lineno"></span>A1UEChMLR29vZ2xlLCBJbmMxEjAQBgNVBAMTCUpvbiBBbGxpZTEiMCAGCSqGSIb3<br>
<span class="lineno"></span>DQEJARYTam9uYWxsaWVAZ29vZ2xlLmNvbTCCAbcwggEsBgcqhkjOOAQBMIIBHwKB<br>
<span class="lineno"></span>gQC8hLUnQ7FpFYu4WXTj6DKvXvz8QrJkNJCVMTpKAT7uBpobk32S5RrPKXocd4gN<br>
<span class="lineno"></span>8lyGB9ggS03EVlEwXvSmO0DH2MQtke2jl9j1HLydClMf4sbx5V6TV9IFw505U1iW<br>
<span class="lineno">570</span>jL7awRMgxge+FsudtJK254FjMFo03ZnOQ8ZJJ9E6AEDrlwIVAJpnBn9moyP11Ox5<br>
<span class="lineno"></span>Asc/5dnjb6dPAoGBAJFHd4KVv1iTVCvEG6gGiYop5DJh28hUQcN9kul+2A0yPUSC<br>
<span class="lineno"></span>X93oN00P8Vh3eYgSaCWZsha7zDG53MrVJ0Zf6v/X/CoZNhLldeNOepivTRAzn+Rz<br>
<span class="lineno"></span>kKUYy5l1sxYLHQKF0UGNCXfFKZT0PCmgU+PWhYNBBMn6/cIh44vp85ideo5CA4GE<br>
<span class="lineno"></span>AAKBgFmifCafzeRaohYKXJgMGSEaggCVCRq5xdyDCat+wbOkjC4mfG01/um3G8u5<br>
<span class="lineno">575</span>LxasjlWRKTR/tcAL7t0QuokVyQaYdVypZXNaMtx1db7YBuHjj3aP+8JOQRI9xz8c<br>
<span class="lineno"></span>bp5NDJ5pISiFOv4p3GZfqZPcqckDt78AtkQrmnal2txhhjF6o4HeMIHbMB0GA1Ud<br>
<span class="lineno"></span>DgQWBBQVyyr7hO11ZFFpWX50298Sa3V+rzCBqwYDVR0jBIGjMIGggBQVyyr7hO11<br>
<span class="lineno"></span>ZFFpWX50298Sa3V+r6F9pHsweTELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAk5DMQ8w<br>
<span class="lineno"></span>DQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2dsZSwgSW5jMRIwEAYDVQQDEwlK<br>
<span class="lineno">580</span>b24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFsbGllQGdvb2dsZS5jb22CCQCx<br>
<span class="lineno"></span>z4IWqMXg4TAMBgNVHRMEBTADAQH/MAkGByqGSM44BAMDLwAwLAIUPtn/5j8Q1jJI<br>
<span class="lineno"></span>7ggOIsgrhgUdjGQCFCsmDq1H11q9+9Wp9IMeGrTSKHIM<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span><span class="keyword" id="7775747">func</span>&nbsp;<span class="ident" id="7775752">TestParseCertificateWithDsaPublicKey</span><span class="op" id="7775788">(</span><span class="ident" id="7775789">t</span>&nbsp;<span class="op" id="7775791">*</span><span class="ident" id="7775792">testing</span><span class="op" id="7775799">.</span><span class="ident" id="7775800">T</span><span class="op" id="7775801">)</span>&nbsp;<span class="op" id="7775803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7775806">expectedKey</span>&nbsp;<span class="op" id="7775818">:=</span>&nbsp;<span class="op" id="7775821">&amp;</span><span class="ident" id="7775822">dsa</span><span class="op" id="7775825">.</span><span class="ident" id="7775826">PublicKey</span><span class="op" id="7775835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7775839">Parameters</span><span class="op" id="7775849">:</span>&nbsp;<span class="ident" id="7775851">dsa</span><span class="op" id="7775854">.</span><span class="ident" id="7775855">Parameters</span><span class="op" id="7775865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7775870">P</span><span class="op" id="7775871">:</span>&nbsp;<span class="ident" id="7775873">bigFromHexString</span><span class="op" id="7775889">(</span><span class="string" id="7775890">&#34;00BC84B52743B169158BB85974E3E832AF5EFCFC42B264349095313A4A013EEE069A1B937D92E51ACF297A1C77880DF25C8607D8204B4DC45651305EF4A63B40C7D8C42D91EDA397D8F51CBC9D0A531FE2C6F1E55E9357D205C39D395358968CBEDAC11320C607BE16CB9DB492B6E78163305A34DD99CE43C64927D13A0040EB97&#34;</span><span class="op" id="7776150">)</span><span class="op" id="7776151">,</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7776156">Q</span><span class="op" id="7776157">:</span>&nbsp;<span class="ident" id="7776159">bigFromHexString</span><span class="op" id="7776175">(</span><span class="string" id="7776176">&#34;009A67067F66A323F5D4EC7902C73FE5D9E36FA74F&#34;</span><span class="op" id="7776220">)</span><span class="op" id="7776221">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7776226">G</span><span class="op" id="7776227">:</span>&nbsp;<span class="ident" id="7776229">bigFromHexString</span><span class="op" id="7776245">(</span><span class="string" id="7776246">&#34;009147778295BF5893542BC41BA806898A29E43261DBC85441C37D92E97ED80D323D44825FDDE8374D0FF15877798812682599B216BBCC31B9DCCAD527465FEAFFD7FC2A193612E575E34E7A98AF4D10339FE47390A518CB9975B3160B1D0285D1418D0977C52994F43C29A053E3D685834104C9FAFDC221E38BE9F3989D7A8E42&#34;</span><span class="op" id="7776506">)</span><span class="op" id="7776507">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7776511">}</span><span class="op" id="7776512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7776516">Y</span><span class="op" id="7776517">:</span>&nbsp;<span class="ident" id="7776519">bigFromHexString</span><span class="op" id="7776535">(</span><span class="string" id="7776536">&#34;59A27C269FCDE45AA2160A5C980C19211A820095091AB9C5DC8309AB7EC1B3A48C2E267C6D35FEE9B71BCBB92F16AC8E559129347FB5C00BEEDD10BA8915C90698755CA965735A32DC7575BED806E1E38F768FFBC24E41123DC73F1C6E9E4D0C9E692128853AFE29DC665FA993DCA9C903B7BF00B6442B9A76A5DADC6186317A&#34;</span><span class="op" id="7776794">)</span><span class="op" id="7776795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7776798">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7776801">pemBlock</span><span class="op" id="7776809">,</span>&nbsp;<span class="ident" id="7776811">_</span>&nbsp;<span class="op" id="7776813">:=</span>&nbsp;<span class="ident" id="7776816">pem</span><span class="op" id="7776819">.</span><span class="ident" id="7776820">Decode</span><span class="op" id="7776826">(</span><span class="op" id="7776827">[</span><span class="op" id="7776828">]</span><span class="builtintype" id="7776829">byte</span><span class="op" id="7776833">(</span><span class="ident" id="7776834">dsaCertPem</span><span class="op" id="7776844">)</span><span class="op" id="7776845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7776848">cert</span><span class="op" id="7776852">,</span>&nbsp;<span class="ident" id="7776854">err</span>&nbsp;<span class="op" id="7776858">:=</span>&nbsp;<span class="ident" id="7776861">ParseCertificate</span><span class="op" id="7776877">(</span><span class="ident" id="7776878">pemBlock</span><span class="op" id="7776886">.</span><span class="ident" id="7776887">Bytes</span><span class="op" id="7776892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7776895">if</span>&nbsp;<span class="ident" id="7776898">err</span>&nbsp;<span class="op" id="7776902">!=</span>&nbsp;<span class="ident" id="7776905">nil</span>&nbsp;<span class="op" id="7776909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7776913">t</span><span class="op" id="7776914">.</span><span class="ident" id="7776915">Fatalf</span><span class="op" id="7776921">(</span><span class="string" id="7776922">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7776955">,</span>&nbsp;<span class="ident" id="7776957">err</span><span class="op" id="7776960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7776963">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7776966">if</span>&nbsp;<span class="ident" id="7776969">cert</span><span class="op" id="7776973">.</span><span class="ident" id="7776974">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="7776993">!=</span>&nbsp;<span class="ident" id="7776996">DSA</span>&nbsp;<span class="op" id="7777000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7777004">t</span><span class="op" id="7777005">.</span><span class="ident" id="7777006">Errorf</span><span class="op" id="7777012">(</span><span class="string" id="7777013">&#34;Parsed&nbsp;key&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSA&#34;</span><span class="op" id="7777047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7777050">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7777053">parsedKey</span><span class="op" id="7777062">,</span>&nbsp;<span class="ident" id="7777064">ok</span>&nbsp;<span class="op" id="7777067">:=</span>&nbsp;<span class="ident" id="7777070">cert</span><span class="op" id="7777074">.</span><span class="ident" id="7777075">PublicKey</span><span class="op" id="7777084">.</span><span class="op" id="7777085">(</span><span class="op" id="7777086">*</span><span class="ident" id="7777087">dsa</span><span class="op" id="7777090">.</span><span class="ident" id="7777091">PublicKey</span><span class="op" id="7777100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7777103">if</span>&nbsp;<span class="op" id="7777106">!</span><span class="ident" id="7777107">ok</span>&nbsp;<span class="op" id="7777110">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7777114">t</span><span class="op" id="7777115">.</span><span class="ident" id="7777116">Fatalf</span><span class="op" id="7777122">(</span><span class="string" id="7777123">&#34;Parsed&nbsp;key&nbsp;was&nbsp;not&nbsp;a&nbsp;DSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7777157">,</span>&nbsp;<span class="ident" id="7777159">err</span><span class="op" id="7777162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7777165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7777168">if</span>&nbsp;<span class="ident" id="7777171">expectedKey</span><span class="op" id="7777182">.</span><span class="ident" id="7777183">Y</span><span class="op" id="7777184">.</span><span class="ident" id="7777185">Cmp</span><span class="op" id="7777188">(</span><span class="ident" id="7777189">parsedKey</span><span class="op" id="7777198">.</span><span class="ident" id="7777199">Y</span><span class="op" id="7777200">)</span>&nbsp;<span class="op" id="7777202">!=</span>&nbsp;<span class="num" id="7777205">0</span>&nbsp;<span class="op" id="7777207">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7777212">expectedKey</span><span class="op" id="7777223">.</span><span class="ident" id="7777224">P</span><span class="op" id="7777225">.</span><span class="ident" id="7777226">Cmp</span><span class="op" id="7777229">(</span><span class="ident" id="7777230">parsedKey</span><span class="op" id="7777239">.</span><span class="ident" id="7777240">P</span><span class="op" id="7777241">)</span>&nbsp;<span class="op" id="7777243">!=</span>&nbsp;<span class="num" id="7777246">0</span>&nbsp;<span class="op" id="7777248">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7777253">expectedKey</span><span class="op" id="7777264">.</span><span class="ident" id="7777265">Q</span><span class="op" id="7777266">.</span><span class="ident" id="7777267">Cmp</span><span class="op" id="7777270">(</span><span class="ident" id="7777271">parsedKey</span><span class="op" id="7777280">.</span><span class="ident" id="7777281">Q</span><span class="op" id="7777282">)</span>&nbsp;<span class="op" id="7777284">!=</span>&nbsp;<span class="num" id="7777287">0</span>&nbsp;<span class="op" id="7777289">||</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7777294">expectedKey</span><span class="op" id="7777305">.</span><span class="ident" id="7777306">G</span><span class="op" id="7777307">.</span><span class="ident" id="7777308">Cmp</span><span class="op" id="7777311">(</span><span class="ident" id="7777312">parsedKey</span><span class="op" id="7777321">.</span><span class="ident" id="7777322">G</span><span class="op" id="7777323">)</span>&nbsp;<span class="op" id="7777325">!=</span>&nbsp;<span class="num" id="7777328">0</span>&nbsp;<span class="op" id="7777330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7777334">t</span><span class="op" id="7777335">.</span><span class="ident" id="7777336">Fatal</span><span class="op" id="7777341">(</span><span class="string" id="7777342">&#34;Parsed&nbsp;key&nbsp;differs&nbsp;from&nbsp;expected&nbsp;key&#34;</span><span class="op" id="7777380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7777383">}</span><br>
<span class="lineno"></span><span class="op" id="7777385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="7777388">func</span>&nbsp;<span class="ident" id="7777393">TestParseCertificateWithDSASignatureAlgorithm</span><span class="op" id="7777438">(</span><span class="ident" id="7777439">t</span>&nbsp;<span class="op" id="7777441">*</span><span class="ident" id="7777442">testing</span><span class="op" id="7777449">.</span><span class="ident" id="7777450">T</span><span class="op" id="7777451">)</span>&nbsp;<span class="op" id="7777453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7777456">pemBlock</span><span class="op" id="7777464">,</span>&nbsp;<span class="ident" id="7777466">_</span>&nbsp;<span class="op" id="7777468">:=</span>&nbsp;<span class="ident" id="7777471">pem</span><span class="op" id="7777474">.</span><span class="ident" id="7777475">Decode</span><span class="op" id="7777481">(</span><span class="op" id="7777482">[</span><span class="op" id="7777483">]</span><span class="builtintype" id="7777484">byte</span><span class="op" id="7777488">(</span><span class="ident" id="7777489">dsaCertPem</span><span class="op" id="7777499">)</span><span class="op" id="7777500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7777503">cert</span><span class="op" id="7777507">,</span>&nbsp;<span class="ident" id="7777509">err</span>&nbsp;<span class="op" id="7777513">:=</span>&nbsp;<span class="ident" id="7777516">ParseCertificate</span><span class="op" id="7777532">(</span><span class="ident" id="7777533">pemBlock</span><span class="op" id="7777541">.</span><span class="ident" id="7777542">Bytes</span><span class="op" id="7777547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7777550">if</span>&nbsp;<span class="ident" id="7777553">err</span>&nbsp;<span class="op" id="7777557">!=</span>&nbsp;<span class="ident" id="7777560">nil</span>&nbsp;<span class="op" id="7777564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7777568">t</span><span class="op" id="7777569">.</span><span class="ident" id="7777570">Fatalf</span><span class="op" id="7777576">(</span><span class="string" id="7777577">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7777610">,</span>&nbsp;<span class="ident" id="7777612">err</span><span class="op" id="7777615">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7777618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7777621">if</span>&nbsp;<span class="ident" id="7777624">cert</span><span class="op" id="7777628">.</span><span class="ident" id="7777629">SignatureAlgorithm</span>&nbsp;<span class="op" id="7777648">!=</span>&nbsp;<span class="ident" id="7777651">DSAWithSHA1</span>&nbsp;<span class="op" id="7777663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7777667">t</span><span class="op" id="7777668">.</span><span class="ident" id="7777669">Errorf</span><span class="op" id="7777675">(</span><span class="string" id="7777676">&#34;Parsed&nbsp;signature&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSAWithSHA1&#34;</span><span class="op" id="7777724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7777727">}</span><br>
<span class="lineno"></span><span class="op" id="7777729">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="7777732">func</span>&nbsp;<span class="ident" id="7777737">TestVerifyCertificateWithDSASignature</span><span class="op" id="7777774">(</span><span class="ident" id="7777775">t</span>&nbsp;<span class="op" id="7777777">*</span><span class="ident" id="7777778">testing</span><span class="op" id="7777785">.</span><span class="ident" id="7777786">T</span><span class="op" id="7777787">)</span>&nbsp;<span class="op" id="7777789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7777792">pemBlock</span><span class="op" id="7777800">,</span>&nbsp;<span class="ident" id="7777802">_</span>&nbsp;<span class="op" id="7777804">:=</span>&nbsp;<span class="ident" id="7777807">pem</span><span class="op" id="7777810">.</span><span class="ident" id="7777811">Decode</span><span class="op" id="7777817">(</span><span class="op" id="7777818">[</span><span class="op" id="7777819">]</span><span class="builtintype" id="7777820">byte</span><span class="op" id="7777824">(</span><span class="ident" id="7777825">dsaCertPem</span><span class="op" id="7777835">)</span><span class="op" id="7777836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7777839">cert</span><span class="op" id="7777843">,</span>&nbsp;<span class="ident" id="7777845">err</span>&nbsp;<span class="op" id="7777849">:=</span>&nbsp;<span class="ident" id="7777852">ParseCertificate</span><span class="op" id="7777868">(</span><span class="ident" id="7777869">pemBlock</span><span class="op" id="7777877">.</span><span class="ident" id="7777878">Bytes</span><span class="op" id="7777883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7777886">if</span>&nbsp;<span class="ident" id="7777889">err</span>&nbsp;<span class="op" id="7777893">!=</span>&nbsp;<span class="ident" id="7777896">nil</span>&nbsp;<span class="op" id="7777900">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7777904">t</span><span class="op" id="7777905">.</span><span class="ident" id="7777906">Fatalf</span><span class="op" id="7777912">(</span><span class="string" id="7777913">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7777946">,</span>&nbsp;<span class="ident" id="7777948">err</span><span class="op" id="7777951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7777954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7777957">//&nbsp;test&nbsp;cert&nbsp;is&nbsp;self-signed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7777986">if</span>&nbsp;<span class="ident" id="7777989">err</span>&nbsp;<span class="op" id="7777993">=</span>&nbsp;<span class="ident" id="7777995">cert</span><span class="op" id="7777999">.</span><span class="ident" id="7778000">CheckSignatureFrom</span><span class="op" id="7778018">(</span><span class="ident" id="7778019">cert</span><span class="op" id="7778023">)</span><span class="op" id="7778024">;</span>&nbsp;<span class="ident" id="7778026">err</span>&nbsp;<span class="op" id="7778030">!=</span>&nbsp;<span class="ident" id="7778033">nil</span>&nbsp;<span class="op" id="7778037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7778041">t</span><span class="op" id="7778042">.</span><span class="ident" id="7778043">Fatalf</span><span class="op" id="7778049">(</span><span class="string" id="7778050">&#34;DSA&nbsp;Certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="7778091">,</span>&nbsp;<span class="ident" id="7778093">err</span><span class="op" id="7778096">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7778099">}</span><br>
<span class="lineno"></span><span class="op" id="7778101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7778104">const</span>&nbsp;<span class="ident" id="7778110">pemCertificate</span>&nbsp;<span class="op" id="7778125">=</span>&nbsp;<span class="string" id="7778127">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB5DCCAZCgAwIBAgIBATALBgkqhkiG9w0BAQUwLTEQMA4GA1UEChMHQWNtZSBDbzEZMBcGA1UE<br>
<span class="lineno">640</span>AxMQdGVzdC5leGFtcGxlLmNvbTAeFw03MDAxMDEwMDE2NDBaFw03MDAxMDIwMzQ2NDBaMC0xEDAO<br>
<span class="lineno"></span>BgNVBAoTB0FjbWUgQ28xGTAXBgNVBAMTEHRlc3QuZXhhbXBsZS5jb20wWjALBgkqhkiG9w0BAQED<br>
<span class="lineno"></span>SwAwSAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0fd7Ai2KW5ToIwzFo<br>
<span class="lineno"></span>fvJcS/STa6HA5gQenRUCAwEAAaOBnjCBmzAOBgNVHQ8BAf8EBAMCAAQwDwYDVR0TAQH/BAUwAwEB<br>
<span class="lineno"></span>/zANBgNVHQ4EBgQEAQIDBDAPBgNVHSMECDAGgAQBAgMEMBsGA1UdEQQUMBKCEHRlc3QuZXhhbXBs<br>
<span class="lineno">645</span>ZS5jb20wDwYDVR0gBAgwBjAEBgIqAzAqBgNVHR4EIzAhoB8wDoIMLmV4YW1wbGUuY29tMA2CC2V4<br>
<span class="lineno"></span>YW1wbGUuY29tMAsGCSqGSIb3DQEBBQNBAHKZKoS1wEQOGhgklx4+/yFYQlnqwKXvar/ZecQvJwui<br>
<span class="lineno"></span>0seMQnwBhwdBkHfVIU2Fu5VUMRyxlf0ZNaDXcpU581k=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----`</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="keyword" id="7778845">func</span>&nbsp;<span class="ident" id="7778850">TestCRLCreation</span><span class="op" id="7778865">(</span><span class="ident" id="7778866">t</span>&nbsp;<span class="op" id="7778868">*</span><span class="ident" id="7778869">testing</span><span class="op" id="7778876">.</span><span class="ident" id="7778877">T</span><span class="op" id="7778878">)</span>&nbsp;<span class="op" id="7778880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7778883">block</span><span class="op" id="7778888">,</span>&nbsp;<span class="ident" id="7778890">_</span>&nbsp;<span class="op" id="7778892">:=</span>&nbsp;<span class="ident" id="7778895">pem</span><span class="op" id="7778898">.</span><span class="ident" id="7778899">Decode</span><span class="op" id="7778905">(</span><span class="op" id="7778906">[</span><span class="op" id="7778907">]</span><span class="builtintype" id="7778908">byte</span><span class="op" id="7778912">(</span><span class="ident" id="7778913">pemPrivateKey</span><span class="op" id="7778926">)</span><span class="op" id="7778927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7778930">priv</span><span class="op" id="7778934">,</span>&nbsp;<span class="ident" id="7778936">_</span>&nbsp;<span class="op" id="7778938">:=</span>&nbsp;<span class="ident" id="7778941">ParsePKCS1PrivateKey</span><span class="op" id="7778961">(</span><span class="ident" id="7778962">block</span><span class="op" id="7778967">.</span><span class="ident" id="7778968">Bytes</span><span class="op" id="7778973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7778976">block</span><span class="op" id="7778981">,</span>&nbsp;<span class="ident" id="7778983">_</span>&nbsp;<span class="op" id="7778985">=</span>&nbsp;<span class="ident" id="7778987">pem</span><span class="op" id="7778990">.</span><span class="ident" id="7778991">Decode</span><span class="op" id="7778997">(</span><span class="op" id="7778998">[</span><span class="op" id="7778999">]</span><span class="builtintype" id="7779000">byte</span><span class="op" id="7779004">(</span><span class="ident" id="7779005">pemCertificate</span><span class="op" id="7779019">)</span><span class="op" id="7779020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7779023">cert</span><span class="op" id="7779027">,</span>&nbsp;<span class="ident" id="7779029">_</span>&nbsp;<span class="op" id="7779031">:=</span>&nbsp;<span class="ident" id="7779034">ParseCertificate</span><span class="op" id="7779050">(</span><span class="ident" id="7779051">block</span><span class="op" id="7779056">.</span><span class="ident" id="7779057">Bytes</span><span class="op" id="7779062">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7779066">now</span>&nbsp;<span class="op" id="7779070">:=</span>&nbsp;<span class="ident" id="7779073">time</span><span class="op" id="7779077">.</span><span class="ident" id="7779078">Unix</span><span class="op" id="7779082">(</span><span class="num" id="7779083">1000</span><span class="op" id="7779087">,</span>&nbsp;<span class="num" id="7779089">0</span><span class="op" id="7779090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7779093">expiry</span>&nbsp;<span class="op" id="7779100">:=</span>&nbsp;<span class="ident" id="7779103">time</span><span class="op" id="7779107">.</span><span class="ident" id="7779108">Unix</span><span class="op" id="7779112">(</span><span class="num" id="7779113">10000</span><span class="op" id="7779118">,</span>&nbsp;<span class="num" id="7779120">0</span><span class="op" id="7779121">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7779125">revokedCerts</span>&nbsp;<span class="op" id="7779138">:=</span>&nbsp;<span class="op" id="7779141">[</span><span class="op" id="7779142">]</span><span class="ident" id="7779143">pkix</span><span class="op" id="7779147">.</span><span class="ident" id="7779148">RevokedCertificate</span><span class="op" id="7779166">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7779170">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7779175">SerialNumber</span><span class="op" id="7779187">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7779191">big</span><span class="op" id="7779194">.</span><span class="ident" id="7779195">NewInt</span><span class="op" id="7779201">(</span><span class="num" id="7779202">1</span><span class="op" id="7779203">)</span><span class="op" id="7779204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7779209">RevocationTime</span><span class="op" id="7779223">:</span>&nbsp;<span class="ident" id="7779225">now</span><span class="op" id="7779228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7779232">}</span><span class="op" id="7779233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7779237">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7779242">SerialNumber</span><span class="op" id="7779254">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7779258">big</span><span class="op" id="7779261">.</span><span class="ident" id="7779262">NewInt</span><span class="op" id="7779268">(</span><span class="num" id="7779269">42</span><span class="op" id="7779271">)</span><span class="op" id="7779272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7779277">RevocationTime</span><span class="op" id="7779291">:</span>&nbsp;<span class="ident" id="7779293">now</span><span class="op" id="7779296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7779300">}</span><span class="op" id="7779301">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7779304">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7779308">crlBytes</span><span class="op" id="7779316">,</span>&nbsp;<span class="ident" id="7779318">err</span>&nbsp;<span class="op" id="7779322">:=</span>&nbsp;<span class="ident" id="7779325">cert</span><span class="op" id="7779329">.</span><span class="ident" id="7779330">CreateCRL</span><span class="op" id="7779339">(</span><span class="ident" id="7779340">rand</span><span class="op" id="7779344">.</span><span class="ident" id="7779345">Reader</span><span class="op" id="7779351">,</span>&nbsp;<span class="ident" id="7779353">priv</span><span class="op" id="7779357">,</span>&nbsp;<span class="ident" id="7779359">revokedCerts</span><span class="op" id="7779371">,</span>&nbsp;<span class="ident" id="7779373">now</span><span class="op" id="7779376">,</span>&nbsp;<span class="ident" id="7779378">expiry</span><span class="op" id="7779384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7779387">if</span>&nbsp;<span class="ident" id="7779390">err</span>&nbsp;<span class="op" id="7779394">!=</span>&nbsp;<span class="ident" id="7779397">nil</span>&nbsp;<span class="op" id="7779401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7779405">t</span><span class="op" id="7779406">.</span><span class="ident" id="7779407">Errorf</span><span class="op" id="7779413">(</span><span class="string" id="7779414">&#34;error&nbsp;creating&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="7779438">,</span>&nbsp;<span class="ident" id="7779440">err</span><span class="op" id="7779443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7779446">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7779450">_</span><span class="op" id="7779451">,</span>&nbsp;<span class="ident" id="7779453">err</span>&nbsp;<span class="op" id="7779457">=</span>&nbsp;<span class="ident" id="7779459">ParseDERCRL</span><span class="op" id="7779470">(</span><span class="ident" id="7779471">crlBytes</span><span class="op" id="7779479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7779482">if</span>&nbsp;<span class="ident" id="7779485">err</span>&nbsp;<span class="op" id="7779489">!=</span>&nbsp;<span class="ident" id="7779492">nil</span>&nbsp;<span class="op" id="7779496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7779500">t</span><span class="op" id="7779501">.</span><span class="ident" id="7779502">Errorf</span><span class="op" id="7779508">(</span><span class="string" id="7779509">&#34;error&nbsp;reparsing&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="7779534">,</span>&nbsp;<span class="ident" id="7779536">err</span><span class="op" id="7779539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7779542">}</span><br>
<span class="lineno"></span><span class="op" id="7779544">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="7779547">func</span>&nbsp;<span class="ident" id="7779552">fromBase64</span><span class="op" id="7779562">(</span><span class="ident" id="7779563">in</span>&nbsp;<span class="builtintype" id="7779566">string</span><span class="op" id="7779572">)</span>&nbsp;<span class="op" id="7779574">[</span><span class="op" id="7779575">]</span><span class="builtintype" id="7779576">byte</span>&nbsp;<span class="op" id="7779581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7779584">out</span>&nbsp;<span class="op" id="7779588">:=</span>&nbsp;<span class="builtinfunc" id="7779591">make</span><span class="op" id="7779595">(</span><span class="op" id="7779596">[</span><span class="op" id="7779597">]</span><span class="builtintype" id="7779598">byte</span><span class="op" id="7779602">,</span>&nbsp;<span class="ident" id="7779604">base64</span><span class="op" id="7779610">.</span><span class="ident" id="7779611">StdEncoding</span><span class="op" id="7779622">.</span><span class="ident" id="7779623">DecodedLen</span><span class="op" id="7779633">(</span><span class="builtinfunc" id="7779634">len</span><span class="op" id="7779637">(</span><span class="ident" id="7779638">in</span><span class="op" id="7779640">)</span><span class="op" id="7779641">)</span><span class="op" id="7779642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7779645">n</span><span class="op" id="7779646">,</span>&nbsp;<span class="ident" id="7779648">err</span>&nbsp;<span class="op" id="7779652">:=</span>&nbsp;<span class="ident" id="7779655">base64</span><span class="op" id="7779661">.</span><span class="ident" id="7779662">StdEncoding</span><span class="op" id="7779673">.</span><span class="ident" id="7779674">Decode</span><span class="op" id="7779680">(</span><span class="ident" id="7779681">out</span><span class="op" id="7779684">,</span>&nbsp;<span class="op" id="7779686">[</span><span class="op" id="7779687">]</span><span class="builtintype" id="7779688">byte</span><span class="op" id="7779692">(</span><span class="ident" id="7779693">in</span><span class="op" id="7779695">)</span><span class="op" id="7779696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7779699">if</span>&nbsp;<span class="ident" id="7779702">err</span>&nbsp;<span class="op" id="7779706">!=</span>&nbsp;<span class="ident" id="7779709">nil</span>&nbsp;<span class="op" id="7779713">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7779717">panic</span><span class="op" id="7779722">(</span><span class="string" id="7779723">&#34;failed&nbsp;to&nbsp;base64&nbsp;decode&#34;</span><span class="op" id="7779748">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7779751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7779754">return</span>&nbsp;<span class="ident" id="7779761">out</span><span class="op" id="7779764">[</span><span class="op" id="7779765">:</span><span class="ident" id="7779766">n</span><span class="op" id="7779767">]</span><br>
<span class="lineno"></span><span class="op" id="7779769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="7779772">func</span>&nbsp;<span class="ident" id="7779777">TestParseDERCRL</span><span class="op" id="7779792">(</span><span class="ident" id="7779793">t</span>&nbsp;<span class="op" id="7779795">*</span><span class="ident" id="7779796">testing</span><span class="op" id="7779803">.</span><span class="ident" id="7779804">T</span><span class="op" id="7779805">)</span>&nbsp;<span class="op" id="7779807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7779810">derBytes</span>&nbsp;<span class="op" id="7779819">:=</span>&nbsp;<span class="ident" id="7779822">fromBase64</span><span class="op" id="7779832">(</span><span class="ident" id="7779833">derCRLBase64</span><span class="op" id="7779845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7779848">certList</span><span class="op" id="7779856">,</span>&nbsp;<span class="ident" id="7779858">err</span>&nbsp;<span class="op" id="7779862">:=</span>&nbsp;<span class="ident" id="7779865">ParseDERCRL</span><span class="op" id="7779876">(</span><span class="ident" id="7779877">derBytes</span><span class="op" id="7779885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7779888">if</span>&nbsp;<span class="ident" id="7779891">err</span>&nbsp;<span class="op" id="7779895">!=</span>&nbsp;<span class="ident" id="7779898">nil</span>&nbsp;<span class="op" id="7779902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7779906">t</span><span class="op" id="7779907">.</span><span class="ident" id="7779908">Errorf</span><span class="op" id="7779914">(</span><span class="string" id="7779915">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="7779934">,</span>&nbsp;<span class="ident" id="7779936">err</span><span class="op" id="7779939">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7779943">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7779951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7779954">numCerts</span>&nbsp;<span class="op" id="7779963">:=</span>&nbsp;<span class="builtinfunc" id="7779966">len</span><span class="op" id="7779969">(</span><span class="ident" id="7779970">certList</span><span class="op" id="7779978">.</span><span class="ident" id="7779979">TBSCertList</span><span class="op" id="7779990">.</span><span class="ident" id="7779991">RevokedCertificates</span><span class="op" id="7780010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7780013">expected</span>&nbsp;<span class="op" id="7780022">:=</span>&nbsp;<span class="num" id="7780025">88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7780029">if</span>&nbsp;<span class="ident" id="7780032">numCerts</span>&nbsp;<span class="op" id="7780041">!=</span>&nbsp;<span class="ident" id="7780044">expected</span>&nbsp;<span class="op" id="7780053">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7780057">t</span><span class="op" id="7780058">.</span><span class="ident" id="7780059">Errorf</span><span class="op" id="7780065">(</span><span class="string" id="7780066">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="7780120">,</span>&nbsp;<span class="ident" id="7780122">numCerts</span><span class="op" id="7780130">,</span>&nbsp;<span class="ident" id="7780132">expected</span><span class="op" id="7780140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7780143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7780147">if</span>&nbsp;<span class="ident" id="7780150">certList</span><span class="op" id="7780158">.</span><span class="ident" id="7780159">HasExpired</span><span class="op" id="7780169">(</span><span class="ident" id="7780170">time</span><span class="op" id="7780174">.</span><span class="ident" id="7780175">Unix</span><span class="op" id="7780179">(</span><span class="num" id="7780180">1302517272</span><span class="op" id="7780190">,</span>&nbsp;<span class="num" id="7780192">0</span><span class="op" id="7780193">)</span><span class="op" id="7780194">)</span>&nbsp;<span class="op" id="7780196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7780200">t</span><span class="op" id="7780201">.</span><span class="ident" id="7780202">Errorf</span><span class="op" id="7780208">(</span><span class="string" id="7780209">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="7780247">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7780250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7780254">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="7780313">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="7780316">func</span>&nbsp;<span class="ident" id="7780321">TestCRLWithoutExpiry</span><span class="op" id="7780341">(</span><span class="ident" id="7780342">t</span>&nbsp;<span class="op" id="7780344">*</span><span class="ident" id="7780345">testing</span><span class="op" id="7780352">.</span><span class="ident" id="7780353">T</span><span class="op" id="7780354">)</span>&nbsp;<span class="op" id="7780356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7780359">derBytes</span>&nbsp;<span class="op" id="7780368">:=</span>&nbsp;<span class="ident" id="7780371">fromBase64</span><span class="op" id="7780381">(</span><span class="string" id="7780382">&#34;MIHYMIGZMAkGByqGSM44BAMwEjEQMA4GA1UEAxMHQ2FybERTUxcNOTkwODI3MDcwMDAwWjBpMBMCAgDIFw05OTA4MjIwNzAwMDBaMBMCAgDJFw05OTA4MjIwNzAwMDBaMBMCAgDTFw05OTA4MjIwNzAwMDBaMBMCAgDSFw05OTA4MjIwNzAwMDBaMBMCAgDUFw05OTA4MjQwNzAwMDBaMAkGByqGSM44BAMDLwAwLAIUfmVSdjP+NHMX0feW+aDU2G1cfT0CFAJ6W7fVWxjBz4fvftok8yqDnDWh&#34;</span><span class="op" id="7780676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7780679">certList</span><span class="op" id="7780687">,</span>&nbsp;<span class="ident" id="7780689">err</span>&nbsp;<span class="op" id="7780693">:=</span>&nbsp;<span class="ident" id="7780696">ParseDERCRL</span><span class="op" id="7780707">(</span><span class="ident" id="7780708">derBytes</span><span class="op" id="7780716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7780719">if</span>&nbsp;<span class="ident" id="7780722">err</span>&nbsp;<span class="op" id="7780726">!=</span>&nbsp;<span class="ident" id="7780729">nil</span>&nbsp;<span class="op" id="7780733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7780737">t</span><span class="op" id="7780738">.</span><span class="ident" id="7780739">Fatal</span><span class="op" id="7780744">(</span><span class="ident" id="7780745">err</span><span class="op" id="7780748">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7780751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7780754">if</span>&nbsp;<span class="op" id="7780757">!</span><span class="ident" id="7780758">certList</span><span class="op" id="7780766">.</span><span class="ident" id="7780767">TBSCertList</span><span class="op" id="7780778">.</span><span class="ident" id="7780779">NextUpdate</span><span class="op" id="7780789">.</span><span class="ident" id="7780790">IsZero</span><span class="op" id="7780796">(</span><span class="op" id="7780797">)</span>&nbsp;<span class="op" id="7780799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7780803">t</span><span class="op" id="7780804">.</span><span class="ident" id="7780805">Errorf</span><span class="op" id="7780811">(</span><span class="string" id="7780812">&#34;NextUpdate&nbsp;is&nbsp;not&nbsp;the&nbsp;zero&nbsp;value&#34;</span><span class="op" id="7780846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7780849">}</span><br>
<span class="lineno"></span><span class="op" id="7780851">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="7780854">func</span>&nbsp;<span class="ident" id="7780859">TestParsePEMCRL</span><span class="op" id="7780874">(</span><span class="ident" id="7780875">t</span>&nbsp;<span class="op" id="7780877">*</span><span class="ident" id="7780878">testing</span><span class="op" id="7780885">.</span><span class="ident" id="7780886">T</span><span class="op" id="7780887">)</span>&nbsp;<span class="op" id="7780889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7780892">pemBytes</span>&nbsp;<span class="op" id="7780901">:=</span>&nbsp;<span class="ident" id="7780904">fromBase64</span><span class="op" id="7780914">(</span><span class="ident" id="7780915">pemCRLBase64</span><span class="op" id="7780927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7780930">certList</span><span class="op" id="7780938">,</span>&nbsp;<span class="ident" id="7780940">err</span>&nbsp;<span class="op" id="7780944">:=</span>&nbsp;<span class="ident" id="7780947">ParseCRL</span><span class="op" id="7780955">(</span><span class="ident" id="7780956">pemBytes</span><span class="op" id="7780964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7780967">if</span>&nbsp;<span class="ident" id="7780970">err</span>&nbsp;<span class="op" id="7780974">!=</span>&nbsp;<span class="ident" id="7780977">nil</span>&nbsp;<span class="op" id="7780981">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7780985">t</span><span class="op" id="7780986">.</span><span class="ident" id="7780987">Errorf</span><span class="op" id="7780993">(</span><span class="string" id="7780994">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="7781013">,</span>&nbsp;<span class="ident" id="7781015">err</span><span class="op" id="7781018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7781022">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7781030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7781033">numCerts</span>&nbsp;<span class="op" id="7781042">:=</span>&nbsp;<span class="builtinfunc" id="7781045">len</span><span class="op" id="7781048">(</span><span class="ident" id="7781049">certList</span><span class="op" id="7781057">.</span><span class="ident" id="7781058">TBSCertList</span><span class="op" id="7781069">.</span><span class="ident" id="7781070">RevokedCertificates</span><span class="op" id="7781089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7781092">expected</span>&nbsp;<span class="op" id="7781101">:=</span>&nbsp;<span class="num" id="7781104">2</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7781107">if</span>&nbsp;<span class="ident" id="7781110">numCerts</span>&nbsp;<span class="op" id="7781119">!=</span>&nbsp;<span class="ident" id="7781122">expected</span>&nbsp;<span class="op" id="7781131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7781135">t</span><span class="op" id="7781136">.</span><span class="ident" id="7781137">Errorf</span><span class="op" id="7781143">(</span><span class="string" id="7781144">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="7781198">,</span>&nbsp;<span class="ident" id="7781200">numCerts</span><span class="op" id="7781208">,</span>&nbsp;<span class="ident" id="7781210">expected</span><span class="op" id="7781218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7781221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7781225">if</span>&nbsp;<span class="ident" id="7781228">certList</span><span class="op" id="7781236">.</span><span class="ident" id="7781237">HasExpired</span><span class="op" id="7781247">(</span><span class="ident" id="7781248">time</span><span class="op" id="7781252">.</span><span class="ident" id="7781253">Unix</span><span class="op" id="7781257">(</span><span class="num" id="7781258">1302517272</span><span class="op" id="7781268">,</span>&nbsp;<span class="num" id="7781270">0</span><span class="op" id="7781271">)</span><span class="op" id="7781272">)</span>&nbsp;<span class="op" id="7781274">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7781278">t</span><span class="op" id="7781279">.</span><span class="ident" id="7781280">Errorf</span><span class="op" id="7781286">(</span><span class="string" id="7781287">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="7781325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7781328">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7781332">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="7781391">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="7781394">func</span>&nbsp;<span class="ident" id="7781399">TestImports</span><span class="op" id="7781410">(</span><span class="ident" id="7781411">t</span>&nbsp;<span class="op" id="7781413">*</span><span class="ident" id="7781414">testing</span><span class="op" id="7781421">.</span><span class="ident" id="7781422">T</span><span class="op" id="7781423">)</span>&nbsp;<span class="op" id="7781425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7781428">switch</span>&nbsp;<span class="ident" id="7781435">runtime</span><span class="op" id="7781442">.</span><span class="ident" id="7781443">GOOS</span>&nbsp;<span class="op" id="7781448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7781451">case</span>&nbsp;<span class="string" id="7781456">&#34;android&#34;</span><span class="op" id="7781465">,</span>&nbsp;<span class="string" id="7781467">&#34;nacl&#34;</span><span class="op" id="7781473">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7781477">t</span><span class="op" id="7781478">.</span><span class="ident" id="7781479">Skipf</span><span class="op" id="7781484">(</span><span class="string" id="7781485">&#34;skipping&nbsp;on&nbsp;%s&#34;</span><span class="op" id="7781501">,</span>&nbsp;<span class="ident" id="7781503">runtime</span><span class="op" id="7781510">.</span><span class="ident" id="7781511">GOOS</span><span class="op" id="7781515">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7781518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7781522">if</span>&nbsp;<span class="ident" id="7781525">err</span>&nbsp;<span class="op" id="7781529">:=</span>&nbsp;<span class="ident" id="7781532">exec</span><span class="op" id="7781536">.</span><span class="ident" id="7781537">Command</span><span class="op" id="7781544">(</span><span class="string" id="7781545">&#34;go&#34;</span><span class="op" id="7781549">,</span>&nbsp;<span class="string" id="7781551">&#34;run&#34;</span><span class="op" id="7781556">,</span>&nbsp;<span class="string" id="7781558">&#34;x509_test_import.go&#34;</span><span class="op" id="7781579">)</span><span class="op" id="7781580">.</span><span class="ident" id="7781581">Run</span><span class="op" id="7781584">(</span><span class="op" id="7781585">)</span><span class="op" id="7781586">;</span>&nbsp;<span class="ident" id="7781588">err</span>&nbsp;<span class="op" id="7781592">!=</span>&nbsp;<span class="ident" id="7781595">nil</span>&nbsp;<span class="op" id="7781599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7781603">t</span><span class="op" id="7781604">.</span><span class="ident" id="7781605">Errorf</span><span class="op" id="7781611">(</span><span class="string" id="7781612">&#34;failed&nbsp;to&nbsp;run&nbsp;x509_test_import.go:&nbsp;%s&#34;</span><span class="op" id="7781651">,</span>&nbsp;<span class="ident" id="7781653">err</span><span class="op" id="7781656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7781659">}</span><br>
<span class="lineno">750</span><span class="op" id="7781661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7781664">const</span>&nbsp;<span class="ident" id="7781670">derCRLBase64</span>&nbsp;<span class="op" id="7781683">=</span>&nbsp;<span class="string" id="7781685">&#34;MIINqzCCDJMCAQEwDQYJKoZIhvcNAQEFBQAwVjEZMBcGA1UEAxMQUEtJIEZJTk1FQ0NBTklDQTEVMBMGA1UEChMMRklOTUVDQ0FOSUNBMRUwEwYDVQQLEwxGSU5NRUNDQU5JQ0ExCzAJBgNVBAYTAklUFw0xMTA1MDQxNjU3NDJaFw0xMTA1MDQyMDU3NDJaMIIMBzAhAg4Ze1od49Lt1qIXBydAzhcNMDkwNzE2MDg0MzIyWjAAMCECDl0HSL9bcZ1Ci/UHJ0DPFw0wOTA3MTYwODQzMTNaMAAwIQIOESB9tVAmX3cY7QcnQNAXDTA5MDcxNjA4NDUyMlowADAhAg4S1tGAQ3mHt8uVBydA1RcNMDkwODA0MTUyNTIyWjAAMCECDlQ249Y7vtC25ScHJ0DWFw0wOTA4MDQxNTI1MzdaMAAwIQIOISMop3NkA4PfYwcnQNkXDTA5MDgwNDExMDAzNFowADAhAg56/BMoS29KEShTBydA2hcNMDkwODA0MTEwMTAzWjAAMCECDnBp/22HPH5CSWoHJ0DbFw0wOTA4MDQxMDU0NDlaMAAwIQIOV9IP+8CD8bK+XAcnQNwXDTA5MDgwNDEwNTcxN1owADAhAg4v5aRz0IxWqYiXBydA3RcNMDkwODA0MTA1NzQ1WjAAMCECDlOU34VzvZAybQwHJ0DeFw0wOTA4MDQxMDU4MjFaMAAwIAINO4CD9lluIxcwBydBAxcNMDkwNzIyMTUzMTU5WjAAMCECDgOllfO8Y1QA7/wHJ0ExFw0wOTA3MjQxMTQxNDNaMAAwIQIOJBX7jbiCdRdyjgcnQUQXDTA5MDkxNjA5MzAwOFowADAhAg5iYSAgmDrlH/RZBydBRRcNMDkwOTE2MDkzMDE3WjAAMCECDmu6k6srP3jcMaQHJ0FRFw0wOTA4MDQxMDU2NDBaMAAwIQIOX8aHlO0V+WVH4QcnQVMXDTA5MDgwNDEwNTcyOVowADAhAg5flK2rg3NnsRgDBydBzhcNMTEwMjAxMTUzMzQ2WjAAMCECDg35yJDL1jOPTgoHJ0HPFw0xMTAyMDExNTM0MjZaMAAwIQIOMyFJ6+e9iiGVBQcnQdAXDTA5MDkxODEzMjAwNVowADAhAg5Emb/Oykucmn8fBydB1xcNMDkwOTIxMTAxMDQ3WjAAMCECDjQKCncV+MnUavMHJ0HaFw0wOTA5MjIwODE1MjZaMAAwIQIOaxiFUt3dpd+tPwcnQfQXDTEwMDYxODA4NDI1MVowADAhAg5G7P8nO0tkrMt7BydB9RcNMTAwNjE4MDg0MjMwWjAAMCECDmTCC3SXhmDRst4HJ0H2Fw0wOTA5MjgxMjA3MjBaMAAwIQIOHoGhUr/pRwzTKgcnQfcXDTA5MDkyODEyMDcyNFowADAhAg50wrcrCiw8mQmPBydCBBcNMTAwMjE2MTMwMTA2WjAAMCECDifWmkvwyhEqwEcHJ0IFFw0xMDAyMTYxMzAxMjBaMAAwIQIOfgPmlW9fg+osNgcnQhwXDTEwMDQxMzA5NTIwMFowADAhAg4YHAGuA6LgCk7tBydCHRcNMTAwNDEzMDk1MTM4WjAAMCECDi1zH1bxkNJhokAHJ0IsFw0xMDA0MTMwOTU5MzBaMAAwIQIOMipNccsb/wo2fwcnQi0XDTEwMDQxMzA5NTkwMFowADAhAg46lCmvPl4GpP6ABydCShcNMTAwMTE5MDk1MjE3WjAAMCECDjaTcaj+wBpcGAsHJ0JLFw0xMDAxMTkwOTUyMzRaMAAwIQIOOMC13EOrBuxIOQcnQloXDTEwMDIwMTA5NDcwNVowADAhAg5KmZl+krz4RsmrBydCWxcNMTAwMjAxMDk0NjQwWjAAMCECDmLG3zQJ/fzdSsUHJ0JiFw0xMDAzMDEwOTUxNDBaMAAwIQIOP39ksgHdojf4owcnQmMXDTEwMDMwMTA5NTExN1owADAhAg4LDQzvWNRlD6v9BydCZBcNMTAwMzAxMDk0NjIyWjAAMCECDkmNfeclaFhIaaUHJ0JlFw0xMDAzMDEwOTQ2MDVaMAAwIQIOT/qWWfpH/m8NTwcnQpQXDTEwMDUxMTA5MTgyMVowADAhAg5m/ksYxvCEgJSvBydClRcNMTAwNTExMDkxODAxWjAAMCECDgvf3Ohq6JOPU9AHJ0KWFw0xMDA1MTEwOTIxMjNaMAAwIQIOKSPas10z4jNVIQcnQpcXDTEwMDUxMTA5MjEwMlowADAhAg4mCWmhoZ3lyKCDBydCohcNMTEwNDI4MTEwMjI1WjAAMCECDkeiyRsBMK0Gvr4HJ0KjFw0xMTA0MjgxMTAyMDdaMAAwIQIOa09b/nH2+55SSwcnQq4XDTExMDQwMTA4Mjk0NlowADAhAg5O7M7iq7gGplr1BydCrxcNMTEwNDAxMDgzMDE3WjAAMCECDjlT6mJxUjTvyogHJ0K1Fw0xMTAxMjcxNTQ4NTJaMAAwIQIODS/l4UUFLe21NAcnQrYXDTExMDEyNzE1NDgyOFowADAhAg5lPRA0XdOUF6lSBydDHhcNMTEwMTI4MTQzNTA1WjAAMCECDixKX4fFGGpENwgHJ0MfFw0xMTAxMjgxNDM1MzBaMAAwIQIORNBkqsPnpKTtbAcnQ08XDTEwMDkwOTA4NDg0MlowADAhAg5QL+EMM3lohedEBydDUBcNMTAwOTA5MDg0ODE5WjAAMCECDlhDnHK+HiTRAXcHJ0NUFw0xMDEwMTkxNjIxNDBaMAAwIQIOdBFqAzq/INz53gcnQ1UXDTEwMTAxOTE2MjA0NFowADAhAg4OjR7s8MgKles1BydDWhcNMTEwMTI3MTY1MzM2WjAAMCECDmfR/elHee+d0SoHJ0NbFw0xMTAxMjcxNjUzNTZaMAAwIQIOBTKv2ui+KFMI+wcnQ5YXDTEwMDkxNTEwMjE1N1owADAhAg49F3c/GSah+oRUBydDmxcNMTEwMTI3MTczMjMzWjAAMCECDggv4I61WwpKFMMHJ0OcFw0xMTAxMjcxNzMyNTVaMAAwIQIOXx/Y8sEvwS10LAcnQ6UXDTExMDEyODExMjkzN1owADAhAg5LSLbnVrSKaw/9BydDphcNMTEwMTI4MTEyOTIwWjAAMCECDmFFoCuhKUeACQQHJ0PfFw0xMTAxMTExMDE3MzdaMAAwIQIOQTDdFh2fSPF6AAcnQ+AXDTExMDExMTEwMTcxMFowADAhAg5B8AOXX61FpvbbBydD5RcNMTAxMDA2MTAxNDM2WjAAMCECDh41P2Gmi7PkwI4HJ0PmFw0xMDEwMDYxMDE2MjVaMAAwIQIOWUHGLQCd+Ale9gcnQ/0XDTExMDUwMjA3NTYxMFowADAhAg5Z2c9AYkikmgWOBydD/hcNMTEwNTAyMDc1NjM0WjAAMCECDmf/UD+/h8nf+74HJ0QVFw0xMTA0MTUwNzI4MzNaMAAwIQIOICvj4epy3MrqfwcnRBYXDTExMDQxNTA3Mjg1NlowADAhAg4bouRMfOYqgv4xBydEHxcNMTEwMzA4MTYyNDI1WjAAMCECDhebWHGoKiTp7pEHJ0QgFw0xMTAzMDgxNjI0NDhaMAAwIQIOX+qnxxAqJ8LtawcnRDcXDTExMDEzMTE1MTIyOFowADAhAg4j0fICqZ+wkOdqBydEOBcNMTEwMTMxMTUxMTQxWjAAMCECDhmXjsV4SUpWtAMHJ0RLFw0xMTAxMjgxMTI0MTJaMAAwIQIODno/w+zG43kkTwcnREwXDTExMDEyODExMjM1MlowADAhAg4b1gc88767Fr+LBydETxcNMTEwMTI4MTEwMjA4WjAAMCECDn+M3Pa1w2nyFeUHJ0RQFw0xMTAxMjgxMDU4NDVaMAAwIQIOaduoyIH61tqybAcnRJUXDTEwMTIxNTA5NDMyMlowADAhAg4nLqQPkyi3ESAKBydElhcNMTAxMjE1MDk0MzM2WjAAMCECDi504NIMH8578gQHJ0SbFw0xMTAyMTQxNDA1NDFaMAAwIQIOGuaM8PDaC5u1egcnRJwXDTExMDIxNDE0MDYwNFowADAhAg4ehYq/BXGnB5PWBydEnxcNMTEwMjA0MDgwOTUxWjAAMCECDkSD4eS4FxW5H20HJ0SgFw0xMTAyMDQwODA5MjVaMAAwIQIOOCcb6ilYObt1egcnRKEXDTExMDEyNjEwNDEyOVowADAhAg58tISWCCwFnKGnBydEohcNMTEwMjA0MDgxMzQyWjAAMCECDn5rjtabY/L/WL0HJ0TJFw0xMTAyMDQxMTAzNDFaMAAwDQYJKoZIhvcNAQEFBQADggEBAGnF2Gs0+LNiYCW1Ipm83OXQYP/bd5tFFRzyz3iepFqNfYs4D68/QihjFoRHQoXEB0OEe1tvaVnnPGnEOpi6krwekquMxo4H88B5SlyiFIqemCOIss0SxlCFs69LmfRYvPPvPEhoXtQ3ZThe0UvKG83GOklhvGl6OaiRf4Mt+m8zOT4Wox/j6aOBK6cw6qKCdmD+Yj1rrNqFGg1CnSWMoD6S6mwNgkzwdBUJZ22BwrzAAo4RHa2Uy3ef1FjwD0XtU5N3uDSxGGBEDvOe5z82rps3E22FpAA8eYl8kaXtmWqyvYU0epp4brGuTxCuBMCAsxt/OjIjeNNQbBGkwxgfYA0=&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7786361">const</span>&nbsp;<span class="ident" id="7786367">pemCRLBase64</span>&nbsp;<span class="op" id="7786380">=</span>&nbsp;<span class="string" id="7786382">&#34;LS0tLS1CRUdJTiBYNTA5IENSTC0tLS0tDQpNSUlCOWpDQ0FWOENBUUV3RFFZSktvWklodmNOQVFFRkJRQXdiREVhTUJnR0ExVUVDaE1SVWxOQklGTmxZM1Z5DQphWFI1SUVsdVl5NHhIakFjQmdOVkJBTVRGVkpUUVNCUWRXSnNhV01nVW05dmRDQkRRU0IyTVRFdU1Dd0dDU3FHDQpTSWIzRFFFSkFSWWZjbk5oYTJWdmJuSnZiM1J6YVdkdVFISnpZWE5sWTNWeWFYUjVMbU52YlJjTk1URXdNakl6DQpNVGt5T0RNd1doY05NVEV3T0RJeU1Ua3lPRE13V2pDQmpEQktBaEVBckRxb2g5RkhKSFhUN09QZ3V1bjQrQmNODQpNRGt4TVRBeU1UUXlOekE1V2pBbU1Bb0dBMVVkRlFRRENnRUpNQmdHQTFVZEdBUVJHQTh5TURBNU1URXdNakUwDQpNalExTlZvd1BnSVJBTEd6blowOTVQQjVhQU9MUGc1N2ZNTVhEVEF5TVRBeU16RTBOVEF4TkZvd0dqQVlCZ05WDQpIUmdFRVJnUE1qQXdNakV3TWpNeE5EVXdNVFJhb0RBd0xqQWZCZ05WSFNNRUdEQVdnQlQxVERGNlVRTS9MTmVMDQpsNWx2cUhHUXEzZzltekFMQmdOVkhSUUVCQUlDQUlRd0RRWUpLb1pJaHZjTkFRRUZCUUFEZ1lFQUZVNUFzNk16DQpxNVBSc2lmYW9iUVBHaDFhSkx5QytNczVBZ2MwYld5QTNHQWR4dXI1U3BQWmVSV0NCamlQL01FSEJXSkNsQkhQDQpHUmNxNXlJZDNFakRrYUV5eFJhK2k2N0x6dmhJNmMyOUVlNks5cFNZd2ppLzdSVWhtbW5Qclh0VHhsTDBsckxyDQptUVFKNnhoRFJhNUczUUE0Q21VZHNITnZicnpnbUNZcHZWRT0NCi0tLS0tRU5EIFg1MDkgQ1JMLS0tLS0NCg0K&#34;</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="keyword" id="7787386">func</span>&nbsp;<span class="ident" id="7787391">TestCreateCertificateRequest</span><span class="op" id="7787419">(</span><span class="ident" id="7787420">t</span>&nbsp;<span class="op" id="7787422">*</span><span class="ident" id="7787423">testing</span><span class="op" id="7787430">.</span><span class="ident" id="7787431">T</span><span class="op" id="7787432">)</span>&nbsp;<span class="op" id="7787434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7787437">random</span>&nbsp;<span class="op" id="7787444">:=</span>&nbsp;<span class="ident" id="7787447">rand</span><span class="op" id="7787451">.</span><span class="ident" id="7787452">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7787461">block</span><span class="op" id="7787466">,</span>&nbsp;<span class="ident" id="7787468">_</span>&nbsp;<span class="op" id="7787470">:=</span>&nbsp;<span class="ident" id="7787473">pem</span><span class="op" id="7787476">.</span><span class="ident" id="7787477">Decode</span><span class="op" id="7787483">(</span><span class="op" id="7787484">[</span><span class="op" id="7787485">]</span><span class="builtintype" id="7787486">byte</span><span class="op" id="7787490">(</span><span class="ident" id="7787491">pemPrivateKey</span><span class="op" id="7787504">)</span><span class="op" id="7787505">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7787508">rsaPriv</span><span class="op" id="7787515">,</span>&nbsp;<span class="ident" id="7787517">err</span>&nbsp;<span class="op" id="7787521">:=</span>&nbsp;<span class="ident" id="7787524">ParsePKCS1PrivateKey</span><span class="op" id="7787544">(</span><span class="ident" id="7787545">block</span><span class="op" id="7787550">.</span><span class="ident" id="7787551">Bytes</span><span class="op" id="7787556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7787559">if</span>&nbsp;<span class="ident" id="7787562">err</span>&nbsp;<span class="op" id="7787566">!=</span>&nbsp;<span class="ident" id="7787569">nil</span>&nbsp;<span class="op" id="7787573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7787577">t</span><span class="op" id="7787578">.</span><span class="ident" id="7787579">Fatalf</span><span class="op" id="7787585">(</span><span class="string" id="7787586">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7787619">,</span>&nbsp;<span class="ident" id="7787621">err</span><span class="op" id="7787624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7787627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7787631">ecdsa256Priv</span><span class="op" id="7787643">,</span>&nbsp;<span class="ident" id="7787645">err</span>&nbsp;<span class="op" id="7787649">:=</span>&nbsp;<span class="ident" id="7787652">ecdsa</span><span class="op" id="7787657">.</span><span class="ident" id="7787658">GenerateKey</span><span class="op" id="7787669">(</span><span class="ident" id="7787670">elliptic</span><span class="op" id="7787678">.</span><span class="ident" id="7787679">P256</span><span class="op" id="7787683">(</span><span class="op" id="7787684">)</span><span class="op" id="7787685">,</span>&nbsp;<span class="ident" id="7787687">rand</span><span class="op" id="7787691">.</span><span class="ident" id="7787692">Reader</span><span class="op" id="7787698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7787701">if</span>&nbsp;<span class="ident" id="7787704">err</span>&nbsp;<span class="op" id="7787708">!=</span>&nbsp;<span class="ident" id="7787711">nil</span>&nbsp;<span class="op" id="7787715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7787719">t</span><span class="op" id="7787720">.</span><span class="ident" id="7787721">Fatalf</span><span class="op" id="7787727">(</span><span class="string" id="7787728">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7787762">,</span>&nbsp;<span class="ident" id="7787764">err</span><span class="op" id="7787767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7787770">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7787774">ecdsa384Priv</span><span class="op" id="7787786">,</span>&nbsp;<span class="ident" id="7787788">err</span>&nbsp;<span class="op" id="7787792">:=</span>&nbsp;<span class="ident" id="7787795">ecdsa</span><span class="op" id="7787800">.</span><span class="ident" id="7787801">GenerateKey</span><span class="op" id="7787812">(</span><span class="ident" id="7787813">elliptic</span><span class="op" id="7787821">.</span><span class="ident" id="7787822">P384</span><span class="op" id="7787826">(</span><span class="op" id="7787827">)</span><span class="op" id="7787828">,</span>&nbsp;<span class="ident" id="7787830">rand</span><span class="op" id="7787834">.</span><span class="ident" id="7787835">Reader</span><span class="op" id="7787841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7787844">if</span>&nbsp;<span class="ident" id="7787847">err</span>&nbsp;<span class="op" id="7787851">!=</span>&nbsp;<span class="ident" id="7787854">nil</span>&nbsp;<span class="op" id="7787858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7787862">t</span><span class="op" id="7787863">.</span><span class="ident" id="7787864">Fatalf</span><span class="op" id="7787870">(</span><span class="string" id="7787871">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7787905">,</span>&nbsp;<span class="ident" id="7787907">err</span><span class="op" id="7787910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7787913">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7787917">ecdsa521Priv</span><span class="op" id="7787929">,</span>&nbsp;<span class="ident" id="7787931">err</span>&nbsp;<span class="op" id="7787935">:=</span>&nbsp;<span class="ident" id="7787938">ecdsa</span><span class="op" id="7787943">.</span><span class="ident" id="7787944">GenerateKey</span><span class="op" id="7787955">(</span><span class="ident" id="7787956">elliptic</span><span class="op" id="7787964">.</span><span class="ident" id="7787965">P521</span><span class="op" id="7787969">(</span><span class="op" id="7787970">)</span><span class="op" id="7787971">,</span>&nbsp;<span class="ident" id="7787973">rand</span><span class="op" id="7787977">.</span><span class="ident" id="7787978">Reader</span><span class="op" id="7787984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7787987">if</span>&nbsp;<span class="ident" id="7787990">err</span>&nbsp;<span class="op" id="7787994">!=</span>&nbsp;<span class="ident" id="7787997">nil</span>&nbsp;<span class="op" id="7788001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7788005">t</span><span class="op" id="7788006">.</span><span class="ident" id="7788007">Fatalf</span><span class="op" id="7788013">(</span><span class="string" id="7788014">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7788048">,</span>&nbsp;<span class="ident" id="7788050">err</span><span class="op" id="7788053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7788056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7788060">tests</span>&nbsp;<span class="op" id="7788066">:=</span>&nbsp;<span class="op" id="7788069">[</span><span class="op" id="7788070">]</span><span class="keyword" id="7788071">struct</span>&nbsp;<span class="op" id="7788078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7788082">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7788090">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7788099">priv</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7788107">interface</span><span class="op" id="7788116">{</span><span class="op" id="7788117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7788121">sigAlgo</span>&nbsp;<span class="ident" id="7788129">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7788149">}</span><span class="op" id="7788150">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7788154">{</span><span class="string" id="7788155">&#34;RSA&#34;</span><span class="op" id="7788160">,</span>&nbsp;<span class="ident" id="7788162">rsaPriv</span><span class="op" id="7788169">,</span>&nbsp;<span class="ident" id="7788171">SHA1WithRSA</span><span class="op" id="7788182">}</span><span class="op" id="7788183">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7788187">{</span><span class="string" id="7788188">&#34;ECDSA-256&#34;</span><span class="op" id="7788199">,</span>&nbsp;<span class="ident" id="7788201">ecdsa256Priv</span><span class="op" id="7788213">,</span>&nbsp;<span class="ident" id="7788215">ECDSAWithSHA1</span><span class="op" id="7788228">}</span><span class="op" id="7788229">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7788233">{</span><span class="string" id="7788234">&#34;ECDSA-384&#34;</span><span class="op" id="7788245">,</span>&nbsp;<span class="ident" id="7788247">ecdsa384Priv</span><span class="op" id="7788259">,</span>&nbsp;<span class="ident" id="7788261">ECDSAWithSHA1</span><span class="op" id="7788274">}</span><span class="op" id="7788275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7788279">{</span><span class="string" id="7788280">&#34;ECDSA-521&#34;</span><span class="op" id="7788291">,</span>&nbsp;<span class="ident" id="7788293">ecdsa521Priv</span><span class="op" id="7788305">,</span>&nbsp;<span class="ident" id="7788307">ECDSAWithSHA1</span><span class="op" id="7788320">}</span><span class="op" id="7788321">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7788324">}</span><br>
<span class="lineno">790</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7788328">for</span>&nbsp;<span class="ident" id="7788332">_</span><span class="op" id="7788333">,</span>&nbsp;<span class="ident" id="7788335">test</span>&nbsp;<span class="op" id="7788340">:=</span>&nbsp;<span class="keyword" id="7788343">range</span>&nbsp;<span class="ident" id="7788349">tests</span>&nbsp;<span class="op" id="7788355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7788359">template</span>&nbsp;<span class="op" id="7788368">:=</span>&nbsp;<span class="ident" id="7788371">CertificateRequest</span><span class="op" id="7788389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7788394">Subject</span><span class="op" id="7788401">:</span>&nbsp;<span class="ident" id="7788403">pkix</span><span class="op" id="7788407">.</span><span class="ident" id="7788408">Name</span><span class="op" id="7788412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7788418">CommonName</span><span class="op" id="7788428">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7788432">&#34;test.example.com&#34;</span><span class="op" id="7788450">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7788456">Organization</span><span class="op" id="7788468">:</span>&nbsp;<span class="op" id="7788470">[</span><span class="op" id="7788471">]</span><span class="builtintype" id="7788472">string</span><span class="op" id="7788478">{</span><span class="string" id="7788479">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7788491">}</span><span class="op" id="7788492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7788497">}</span><span class="op" id="7788498">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7788503">SignatureAlgorithm</span><span class="op" id="7788521">:</span>&nbsp;<span class="ident" id="7788523">test</span><span class="op" id="7788527">.</span><span class="ident" id="7788528">sigAlgo</span><span class="op" id="7788535">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7788540">DNSNames</span><span class="op" id="7788548">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7788560">[</span><span class="op" id="7788561">]</span><span class="builtintype" id="7788562">string</span><span class="op" id="7788568">{</span><span class="string" id="7788569">&#34;test.example.com&#34;</span><span class="op" id="7788587">}</span><span class="op" id="7788588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7788593">EmailAddresses</span><span class="op" id="7788607">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7788613">[</span><span class="op" id="7788614">]</span><span class="builtintype" id="7788615">string</span><span class="op" id="7788621">{</span><span class="string" id="7788622">&#34;gopher@golang.org&#34;</span><span class="op" id="7788641">}</span><span class="op" id="7788642">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7788647">IPAddresses</span><span class="op" id="7788658">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7788667">[</span><span class="op" id="7788668">]</span><span class="ident" id="7788669">net</span><span class="op" id="7788672">.</span><span class="ident" id="7788673">IP</span><span class="op" id="7788675">{</span><span class="ident" id="7788676">net</span><span class="op" id="7788679">.</span><span class="ident" id="7788680">IPv4</span><span class="op" id="7788684">(</span><span class="num" id="7788685">127</span><span class="op" id="7788688">,</span>&nbsp;<span class="num" id="7788690">0</span><span class="op" id="7788691">,</span>&nbsp;<span class="num" id="7788693">0</span><span class="op" id="7788694">,</span>&nbsp;<span class="num" id="7788696">1</span><span class="op" id="7788697">)</span><span class="op" id="7788698">.</span><span class="ident" id="7788699">To4</span><span class="op" id="7788702">(</span><span class="op" id="7788703">)</span><span class="op" id="7788704">,</span>&nbsp;<span class="ident" id="7788706">net</span><span class="op" id="7788709">.</span><span class="ident" id="7788710">ParseIP</span><span class="op" id="7788717">(</span><span class="string" id="7788718">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="7788740">)</span><span class="op" id="7788741">}</span><span class="op" id="7788742">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7788746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7788751">derBytes</span><span class="op" id="7788759">,</span>&nbsp;<span class="ident" id="7788761">err</span>&nbsp;<span class="op" id="7788765">:=</span>&nbsp;<span class="ident" id="7788768">CreateCertificateRequest</span><span class="op" id="7788792">(</span><span class="ident" id="7788793">random</span><span class="op" id="7788799">,</span>&nbsp;<span class="op" id="7788801">&amp;</span><span class="ident" id="7788802">template</span><span class="op" id="7788810">,</span>&nbsp;<span class="ident" id="7788812">test</span><span class="op" id="7788816">.</span><span class="ident" id="7788817">priv</span><span class="op" id="7788821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7788825">if</span>&nbsp;<span class="ident" id="7788828">err</span>&nbsp;<span class="op" id="7788832">!=</span>&nbsp;<span class="ident" id="7788835">nil</span>&nbsp;<span class="op" id="7788839">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7788844">t</span><span class="op" id="7788845">.</span><span class="ident" id="7788846">Errorf</span><span class="op" id="7788852">(</span><span class="string" id="7788853">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="7788899">,</span>&nbsp;<span class="ident" id="7788901">test</span><span class="op" id="7788905">.</span><span class="ident" id="7788906">name</span><span class="op" id="7788910">,</span>&nbsp;<span class="ident" id="7788912">err</span><span class="op" id="7788915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7788920">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7788931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7788936">out</span><span class="op" id="7788939">,</span>&nbsp;<span class="ident" id="7788941">err</span>&nbsp;<span class="op" id="7788945">:=</span>&nbsp;<span class="ident" id="7788948">ParseCertificateRequest</span><span class="op" id="7788971">(</span><span class="ident" id="7788972">derBytes</span><span class="op" id="7788980">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7788984">if</span>&nbsp;<span class="ident" id="7788987">err</span>&nbsp;<span class="op" id="7788991">!=</span>&nbsp;<span class="ident" id="7788994">nil</span>&nbsp;<span class="op" id="7788998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7789003">t</span><span class="op" id="7789004">.</span><span class="ident" id="7789005">Errorf</span><span class="op" id="7789011">(</span><span class="string" id="7789012">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="7789058">,</span>&nbsp;<span class="ident" id="7789060">test</span><span class="op" id="7789064">.</span><span class="ident" id="7789065">name</span><span class="op" id="7789069">,</span>&nbsp;<span class="ident" id="7789071">err</span><span class="op" id="7789074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7789079">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7789090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7789095">if</span>&nbsp;<span class="ident" id="7789098">out</span><span class="op" id="7789101">.</span><span class="ident" id="7789102">Subject</span><span class="op" id="7789109">.</span><span class="ident" id="7789110">CommonName</span>&nbsp;<span class="op" id="7789121">!=</span>&nbsp;<span class="ident" id="7789124">template</span><span class="op" id="7789132">.</span><span class="ident" id="7789133">Subject</span><span class="op" id="7789140">.</span><span class="ident" id="7789141">CommonName</span>&nbsp;<span class="op" id="7789152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7789157">t</span><span class="op" id="7789158">.</span><span class="ident" id="7789159">Errorf</span><span class="op" id="7789165">(</span><span class="string" id="7789166">&#34;%s:&nbsp;output&nbsp;subject&nbsp;common&nbsp;name&nbsp;and&nbsp;template&nbsp;subject&nbsp;common&nbsp;name&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7789243">,</span>&nbsp;<span class="ident" id="7789245">test</span><span class="op" id="7789249">.</span><span class="ident" id="7789250">name</span><span class="op" id="7789254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7789258">}</span>&nbsp;<span class="keyword" id="7789260">else</span>&nbsp;<span class="keyword" id="7789265">if</span>&nbsp;<span class="builtinfunc" id="7789268">len</span><span class="op" id="7789271">(</span><span class="ident" id="7789272">out</span><span class="op" id="7789275">.</span><span class="ident" id="7789276">Subject</span><span class="op" id="7789283">.</span><span class="ident" id="7789284">Organization</span><span class="op" id="7789296">)</span>&nbsp;<span class="op" id="7789298">!=</span>&nbsp;<span class="builtinfunc" id="7789301">len</span><span class="op" id="7789304">(</span><span class="ident" id="7789305">template</span><span class="op" id="7789313">.</span><span class="ident" id="7789314">Subject</span><span class="op" id="7789321">.</span><span class="ident" id="7789322">Organization</span><span class="op" id="7789334">)</span>&nbsp;<span class="op" id="7789336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7789341">t</span><span class="op" id="7789342">.</span><span class="ident" id="7789343">Errorf</span><span class="op" id="7789349">(</span><span class="string" id="7789350">&#34;%s:&nbsp;output&nbsp;subject&nbsp;organisation&nbsp;and&nbsp;template&nbsp;subject&nbsp;organisation&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7789429">,</span>&nbsp;<span class="ident" id="7789431">test</span><span class="op" id="7789435">.</span><span class="ident" id="7789436">name</span><span class="op" id="7789440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7789444">}</span>&nbsp;<span class="keyword" id="7789446">else</span>&nbsp;<span class="keyword" id="7789451">if</span>&nbsp;<span class="builtinfunc" id="7789454">len</span><span class="op" id="7789457">(</span><span class="ident" id="7789458">out</span><span class="op" id="7789461">.</span><span class="ident" id="7789462">DNSNames</span><span class="op" id="7789470">)</span>&nbsp;<span class="op" id="7789472">!=</span>&nbsp;<span class="builtinfunc" id="7789475">len</span><span class="op" id="7789478">(</span><span class="ident" id="7789479">template</span><span class="op" id="7789487">.</span><span class="ident" id="7789488">DNSNames</span><span class="op" id="7789496">)</span>&nbsp;<span class="op" id="7789498">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7789503">t</span><span class="op" id="7789504">.</span><span class="ident" id="7789505">Errorf</span><span class="op" id="7789511">(</span><span class="string" id="7789512">&#34;%s:&nbsp;output&nbsp;DNS&nbsp;names&nbsp;and&nbsp;template&nbsp;DNS&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7789569">,</span>&nbsp;<span class="ident" id="7789571">test</span><span class="op" id="7789575">.</span><span class="ident" id="7789576">name</span><span class="op" id="7789580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7789584">}</span>&nbsp;<span class="keyword" id="7789586">else</span>&nbsp;<span class="keyword" id="7789591">if</span>&nbsp;<span class="builtinfunc" id="7789594">len</span><span class="op" id="7789597">(</span><span class="ident" id="7789598">out</span><span class="op" id="7789601">.</span><span class="ident" id="7789602">EmailAddresses</span><span class="op" id="7789616">)</span>&nbsp;<span class="op" id="7789618">!=</span>&nbsp;<span class="builtinfunc" id="7789621">len</span><span class="op" id="7789624">(</span><span class="ident" id="7789625">template</span><span class="op" id="7789633">.</span><span class="ident" id="7789634">EmailAddresses</span><span class="op" id="7789648">)</span>&nbsp;<span class="op" id="7789650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7789655">t</span><span class="op" id="7789656">.</span><span class="ident" id="7789657">Errorf</span><span class="op" id="7789663">(</span><span class="string" id="7789664">&#34;%s:&nbsp;output&nbsp;email&nbsp;addresses&nbsp;and&nbsp;template&nbsp;email&nbsp;addresses&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7789733">,</span>&nbsp;<span class="ident" id="7789735">test</span><span class="op" id="7789739">.</span><span class="ident" id="7789740">name</span><span class="op" id="7789744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7789748">}</span>&nbsp;<span class="keyword" id="7789750">else</span>&nbsp;<span class="keyword" id="7789755">if</span>&nbsp;<span class="builtinfunc" id="7789758">len</span><span class="op" id="7789761">(</span><span class="ident" id="7789762">out</span><span class="op" id="7789765">.</span><span class="ident" id="7789766">IPAddresses</span><span class="op" id="7789777">)</span>&nbsp;<span class="op" id="7789779">!=</span>&nbsp;<span class="builtinfunc" id="7789782">len</span><span class="op" id="7789785">(</span><span class="ident" id="7789786">template</span><span class="op" id="7789794">.</span><span class="ident" id="7789795">IPAddresses</span><span class="op" id="7789806">)</span>&nbsp;<span class="op" id="7789808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7789813">t</span><span class="op" id="7789814">.</span><span class="ident" id="7789815">Errorf</span><span class="op" id="7789821">(</span><span class="string" id="7789822">&#34;%s:&nbsp;output&nbsp;IP&nbsp;addresses&nbsp;and&nbsp;template&nbsp;IP&nbsp;addresses&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="7789891">,</span>&nbsp;<span class="ident" id="7789893">test</span><span class="op" id="7789897">.</span><span class="ident" id="7789898">name</span><span class="op" id="7789902">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7789906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7789909">}</span><br>
<span class="lineno"></span><span class="op" id="7789911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7789914">func</span>&nbsp;<span class="ident" id="7789919">marshalAndParseCSR</span><span class="op" id="7789937">(</span><span class="ident" id="7789938">t</span>&nbsp;<span class="op" id="7789940">*</span><span class="ident" id="7789941">testing</span><span class="op" id="7789948">.</span><span class="ident" id="7789949">T</span><span class="op" id="7789950">,</span>&nbsp;<span class="ident" id="7789952">template</span>&nbsp;<span class="op" id="7789961">*</span><span class="ident" id="7789962">CertificateRequest</span><span class="op" id="7789980">)</span>&nbsp;<span class="op" id="7789982">*</span><span class="ident" id="7789983">CertificateRequest</span>&nbsp;<span class="op" id="7790002">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790005">block</span><span class="op" id="7790010">,</span>&nbsp;<span class="ident" id="7790012">_</span>&nbsp;<span class="op" id="7790014">:=</span>&nbsp;<span class="ident" id="7790017">pem</span><span class="op" id="7790020">.</span><span class="ident" id="7790021">Decode</span><span class="op" id="7790027">(</span><span class="op" id="7790028">[</span><span class="op" id="7790029">]</span><span class="builtintype" id="7790030">byte</span><span class="op" id="7790034">(</span><span class="ident" id="7790035">pemPrivateKey</span><span class="op" id="7790048">)</span><span class="op" id="7790049">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790052">rsaPriv</span><span class="op" id="7790059">,</span>&nbsp;<span class="ident" id="7790061">err</span>&nbsp;<span class="op" id="7790065">:=</span>&nbsp;<span class="ident" id="7790068">ParsePKCS1PrivateKey</span><span class="op" id="7790088">(</span><span class="ident" id="7790089">block</span><span class="op" id="7790094">.</span><span class="ident" id="7790095">Bytes</span><span class="op" id="7790100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7790103">if</span>&nbsp;<span class="ident" id="7790106">err</span>&nbsp;<span class="op" id="7790110">!=</span>&nbsp;<span class="ident" id="7790113">nil</span>&nbsp;<span class="op" id="7790117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790121">t</span><span class="op" id="7790122">.</span><span class="ident" id="7790123">Fatal</span><span class="op" id="7790128">(</span><span class="ident" id="7790129">err</span><span class="op" id="7790132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7790135">}</span><br>
<span class="lineno">835</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790139">derBytes</span><span class="op" id="7790147">,</span>&nbsp;<span class="ident" id="7790149">err</span>&nbsp;<span class="op" id="7790153">:=</span>&nbsp;<span class="ident" id="7790156">CreateCertificateRequest</span><span class="op" id="7790180">(</span><span class="ident" id="7790181">rand</span><span class="op" id="7790185">.</span><span class="ident" id="7790186">Reader</span><span class="op" id="7790192">,</span>&nbsp;<span class="ident" id="7790194">template</span><span class="op" id="7790202">,</span>&nbsp;<span class="ident" id="7790204">rsaPriv</span><span class="op" id="7790211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7790214">if</span>&nbsp;<span class="ident" id="7790217">err</span>&nbsp;<span class="op" id="7790221">!=</span>&nbsp;<span class="ident" id="7790224">nil</span>&nbsp;<span class="op" id="7790228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790232">t</span><span class="op" id="7790233">.</span><span class="ident" id="7790234">Fatal</span><span class="op" id="7790239">(</span><span class="ident" id="7790240">err</span><span class="op" id="7790243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7790246">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790250">csr</span><span class="op" id="7790253">,</span>&nbsp;<span class="ident" id="7790255">err</span>&nbsp;<span class="op" id="7790259">:=</span>&nbsp;<span class="ident" id="7790262">ParseCertificateRequest</span><span class="op" id="7790285">(</span><span class="ident" id="7790286">derBytes</span><span class="op" id="7790294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7790297">if</span>&nbsp;<span class="ident" id="7790300">err</span>&nbsp;<span class="op" id="7790304">!=</span>&nbsp;<span class="ident" id="7790307">nil</span>&nbsp;<span class="op" id="7790311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790315">t</span><span class="op" id="7790316">.</span><span class="ident" id="7790317">Fatal</span><span class="op" id="7790322">(</span><span class="ident" id="7790323">err</span><span class="op" id="7790326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7790329">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7790333">return</span>&nbsp;<span class="ident" id="7790340">csr</span><br>
<span class="lineno"></span><span class="op" id="7790344">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7790347">func</span>&nbsp;<span class="ident" id="7790352">TestCertificateRequestOverrides</span><span class="op" id="7790383">(</span><span class="ident" id="7790384">t</span>&nbsp;<span class="op" id="7790386">*</span><span class="ident" id="7790387">testing</span><span class="op" id="7790394">.</span><span class="ident" id="7790395">T</span><span class="op" id="7790396">)</span>&nbsp;<span class="op" id="7790398">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790401">sanContents</span><span class="op" id="7790412">,</span>&nbsp;<span class="ident" id="7790414">err</span>&nbsp;<span class="op" id="7790418">:=</span>&nbsp;<span class="ident" id="7790421">marshalSANs</span><span class="op" id="7790432">(</span><span class="op" id="7790433">[</span><span class="op" id="7790434">]</span><span class="builtintype" id="7790435">string</span><span class="op" id="7790441">{</span><span class="string" id="7790442">&#34;foo.example.com&#34;</span><span class="op" id="7790459">}</span><span class="op" id="7790460">,</span>&nbsp;<span class="ident" id="7790462">nil</span><span class="op" id="7790465">,</span>&nbsp;<span class="ident" id="7790467">nil</span><span class="op" id="7790470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7790473">if</span>&nbsp;<span class="ident" id="7790476">err</span>&nbsp;<span class="op" id="7790480">!=</span>&nbsp;<span class="ident" id="7790483">nil</span>&nbsp;<span class="op" id="7790487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790491">t</span><span class="op" id="7790492">.</span><span class="ident" id="7790493">Fatal</span><span class="op" id="7790498">(</span><span class="ident" id="7790499">err</span><span class="op" id="7790502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7790505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790509">template</span>&nbsp;<span class="op" id="7790518">:=</span>&nbsp;<span class="ident" id="7790521">CertificateRequest</span><span class="op" id="7790539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790543">Subject</span><span class="op" id="7790550">:</span>&nbsp;<span class="ident" id="7790552">pkix</span><span class="op" id="7790556">.</span><span class="ident" id="7790557">Name</span><span class="op" id="7790561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790566">CommonName</span><span class="op" id="7790576">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7790580">&#34;test.example.com&#34;</span><span class="op" id="7790598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790603">Organization</span><span class="op" id="7790615">:</span>&nbsp;<span class="op" id="7790617">[</span><span class="op" id="7790618">]</span><span class="builtintype" id="7790619">string</span><span class="op" id="7790625">{</span><span class="string" id="7790626">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7790638">}</span><span class="op" id="7790639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7790643">}</span><span class="op" id="7790644">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790648">DNSNames</span><span class="op" id="7790656">:</span>&nbsp;<span class="op" id="7790658">[</span><span class="op" id="7790659">]</span><span class="builtintype" id="7790660">string</span><span class="op" id="7790666">{</span><span class="string" id="7790667">&#34;test.example.com&#34;</span><span class="op" id="7790685">}</span><span class="op" id="7790686">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7790691">//&nbsp;An&nbsp;explicit&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;DNSNames&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7790756">//&nbsp;template.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790771">ExtraExtensions</span><span class="op" id="7790786">:</span>&nbsp;<span class="op" id="7790788">[</span><span class="op" id="7790789">]</span><span class="ident" id="7790790">pkix</span><span class="op" id="7790794">.</span><span class="ident" id="7790795">Extension</span><span class="op" id="7790804">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7790809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790815">Id</span><span class="op" id="7790817">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790822">oidExtensionSubjectAltName</span><span class="op" id="7790848">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790854">Value</span><span class="op" id="7790859">:</span>&nbsp;<span class="ident" id="7790861">sanContents</span><span class="op" id="7790872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7790877">}</span><span class="op" id="7790878">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7790882">}</span><span class="op" id="7790883">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7790886">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7790890">csr</span>&nbsp;<span class="op" id="7790894">:=</span>&nbsp;<span class="ident" id="7790897">marshalAndParseCSR</span><span class="op" id="7790915">(</span><span class="ident" id="7790916">t</span><span class="op" id="7790917">,</span>&nbsp;<span class="op" id="7790919">&amp;</span><span class="ident" id="7790920">template</span><span class="op" id="7790928">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7790932">if</span>&nbsp;<span class="builtinfunc" id="7790935">len</span><span class="op" id="7790938">(</span><span class="ident" id="7790939">csr</span><span class="op" id="7790942">.</span><span class="ident" id="7790943">DNSNames</span><span class="op" id="7790951">)</span>&nbsp;<span class="op" id="7790953">!=</span>&nbsp;<span class="num" id="7790956">1</span>&nbsp;<span class="op" id="7790958">||</span>&nbsp;<span class="ident" id="7790961">csr</span><span class="op" id="7790964">.</span><span class="ident" id="7790965">DNSNames</span><span class="op" id="7790973">[</span><span class="num" id="7790974">0</span><span class="op" id="7790975">]</span>&nbsp;<span class="op" id="7790977">!=</span>&nbsp;<span class="string" id="7790980">&#34;foo.example.com&#34;</span>&nbsp;<span class="op" id="7790998">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791002">t</span><span class="op" id="7791003">.</span><span class="ident" id="7791004">Errorf</span><span class="op" id="7791010">(</span><span class="string" id="7791011">&#34;Extension&nbsp;did&nbsp;not&nbsp;override&nbsp;template.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="7791058">,</span>&nbsp;<span class="ident" id="7791060">csr</span><span class="op" id="7791063">.</span><span class="ident" id="7791064">DNSNames</span><span class="op" id="7791072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7791075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7791079">//&nbsp;If&nbsp;there&nbsp;is&nbsp;already&nbsp;an&nbsp;attribute&nbsp;with&nbsp;X.509&nbsp;extensions&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7791147">//&nbsp;extra&nbsp;extensions&nbsp;should&nbsp;be&nbsp;added&nbsp;to&nbsp;it&nbsp;rather&nbsp;than&nbsp;creating&nbsp;a&nbsp;CSR</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7791217">//&nbsp;with&nbsp;two&nbsp;extension&nbsp;attributes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791253">template</span><span class="op" id="7791261">.</span><span class="ident" id="7791262">Attributes</span>&nbsp;<span class="op" id="7791273">=</span>&nbsp;<span class="op" id="7791275">[</span><span class="op" id="7791276">]</span><span class="ident" id="7791277">pkix</span><span class="op" id="7791281">.</span><span class="ident" id="7791282">AttributeTypeAndValueSET</span><span class="op" id="7791306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7791310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791315">Type</span><span class="op" id="7791319">:</span>&nbsp;<span class="ident" id="7791321">oidExtensionRequest</span><span class="op" id="7791340">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791345">Value</span><span class="op" id="7791350">:</span>&nbsp;<span class="op" id="7791352">[</span><span class="op" id="7791353">]</span><span class="op" id="7791354">[</span><span class="op" id="7791355">]</span><span class="ident" id="7791356">pkix</span><span class="op" id="7791360">.</span><span class="ident" id="7791361">AttributeTypeAndValue</span><span class="op" id="7791382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7791388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7791395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791403">Type</span><span class="op" id="7791407">:</span>&nbsp;&nbsp;<span class="ident" id="7791410">oidExtensionAuthorityInfoAccess</span><span class="op" id="7791441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791449">Value</span><span class="op" id="7791454">:</span>&nbsp;<span class="op" id="7791456">[</span><span class="op" id="7791457">]</span><span class="builtintype" id="7791458">byte</span><span class="op" id="7791462">(</span><span class="string" id="7791463">&#34;foo&#34;</span><span class="op" id="7791468">)</span><span class="op" id="7791469">,</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7791476">}</span><span class="op" id="7791477">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7791483">}</span><span class="op" id="7791484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7791489">}</span><span class="op" id="7791490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7791494">}</span><span class="op" id="7791495">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7791498">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791502">csr</span>&nbsp;<span class="op" id="7791506">=</span>&nbsp;<span class="ident" id="7791508">marshalAndParseCSR</span><span class="op" id="7791526">(</span><span class="ident" id="7791527">t</span><span class="op" id="7791528">,</span>&nbsp;<span class="op" id="7791530">&amp;</span><span class="ident" id="7791531">template</span><span class="op" id="7791539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7791542">if</span>&nbsp;<span class="ident" id="7791545">l</span>&nbsp;<span class="op" id="7791547">:=</span>&nbsp;<span class="builtinfunc" id="7791550">len</span><span class="op" id="7791553">(</span><span class="ident" id="7791554">csr</span><span class="op" id="7791557">.</span><span class="ident" id="7791558">Attributes</span><span class="op" id="7791568">)</span><span class="op" id="7791569">;</span>&nbsp;<span class="ident" id="7791571">l</span>&nbsp;<span class="op" id="7791573">!=</span>&nbsp;<span class="num" id="7791576">1</span>&nbsp;<span class="op" id="7791578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791582">t</span><span class="op" id="7791583">.</span><span class="ident" id="7791584">Errorf</span><span class="op" id="7791590">(</span><span class="string" id="7791591">&#34;incorrect&nbsp;number&nbsp;of&nbsp;attributes:&nbsp;%d\n&#34;</span><span class="op" id="7791629">,</span>&nbsp;<span class="ident" id="7791631">l</span><span class="op" id="7791632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7791635">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7791639">if</span>&nbsp;<span class="op" id="7791642">!</span><span class="ident" id="7791643">csr</span><span class="op" id="7791646">.</span><span class="ident" id="7791647">Attributes</span><span class="op" id="7791657">[</span><span class="num" id="7791658">0</span><span class="op" id="7791659">]</span><span class="op" id="7791660">.</span><span class="ident" id="7791661">Type</span><span class="op" id="7791665">.</span><span class="ident" id="7791666">Equal</span><span class="op" id="7791671">(</span><span class="ident" id="7791672">oidExtensionRequest</span><span class="op" id="7791691">)</span>&nbsp;<span class="op" id="7791693">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7791698">len</span><span class="op" id="7791701">(</span><span class="ident" id="7791702">csr</span><span class="op" id="7791705">.</span><span class="ident" id="7791706">Attributes</span><span class="op" id="7791716">[</span><span class="num" id="7791717">0</span><span class="op" id="7791718">]</span><span class="op" id="7791719">.</span><span class="ident" id="7791720">Value</span><span class="op" id="7791725">)</span>&nbsp;<span class="op" id="7791727">!=</span>&nbsp;<span class="num" id="7791730">1</span>&nbsp;<span class="op" id="7791732">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7791737">len</span><span class="op" id="7791740">(</span><span class="ident" id="7791741">csr</span><span class="op" id="7791744">.</span><span class="ident" id="7791745">Attributes</span><span class="op" id="7791755">[</span><span class="num" id="7791756">0</span><span class="op" id="7791757">]</span><span class="op" id="7791758">.</span><span class="ident" id="7791759">Value</span><span class="op" id="7791764">[</span><span class="num" id="7791765">0</span><span class="op" id="7791766">]</span><span class="op" id="7791767">)</span>&nbsp;<span class="op" id="7791769">!=</span>&nbsp;<span class="num" id="7791772">2</span>&nbsp;<span class="op" id="7791774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791778">t</span><span class="op" id="7791779">.</span><span class="ident" id="7791780">Errorf</span><span class="op" id="7791786">(</span><span class="string" id="7791787">&#34;bad&nbsp;attributes:&nbsp;%#v\n&#34;</span><span class="op" id="7791810">,</span>&nbsp;<span class="ident" id="7791812">csr</span><span class="op" id="7791815">.</span><span class="ident" id="7791816">Attributes</span><span class="op" id="7791826">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7791829">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791833">sanContents2</span><span class="op" id="7791845">,</span>&nbsp;<span class="ident" id="7791847">err</span>&nbsp;<span class="op" id="7791851">:=</span>&nbsp;<span class="ident" id="7791854">marshalSANs</span><span class="op" id="7791865">(</span><span class="op" id="7791866">[</span><span class="op" id="7791867">]</span><span class="builtintype" id="7791868">string</span><span class="op" id="7791874">{</span><span class="string" id="7791875">&#34;foo2.example.com&#34;</span><span class="op" id="7791893">}</span><span class="op" id="7791894">,</span>&nbsp;<span class="ident" id="7791896">nil</span><span class="op" id="7791899">,</span>&nbsp;<span class="ident" id="7791901">nil</span><span class="op" id="7791904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7791907">if</span>&nbsp;<span class="ident" id="7791910">err</span>&nbsp;<span class="op" id="7791914">!=</span>&nbsp;<span class="ident" id="7791917">nil</span>&nbsp;<span class="op" id="7791921">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7791925">t</span><span class="op" id="7791926">.</span><span class="ident" id="7791927">Fatal</span><span class="op" id="7791932">(</span><span class="ident" id="7791933">err</span><span class="op" id="7791936">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7791939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7791943">//&nbsp;Extensions&nbsp;in&nbsp;Attributes&nbsp;should&nbsp;override&nbsp;those&nbsp;in&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792014">template</span><span class="op" id="7792022">.</span><span class="ident" id="7792023">Attributes</span><span class="op" id="7792033">[</span><span class="num" id="7792034">0</span><span class="op" id="7792035">]</span><span class="op" id="7792036">.</span><span class="ident" id="7792037">Value</span><span class="op" id="7792042">[</span><span class="num" id="7792043">0</span><span class="op" id="7792044">]</span>&nbsp;<span class="op" id="7792046">=</span>&nbsp;<span class="builtinfunc" id="7792048">append</span><span class="op" id="7792054">(</span><span class="ident" id="7792055">template</span><span class="op" id="7792063">.</span><span class="ident" id="7792064">Attributes</span><span class="op" id="7792074">[</span><span class="num" id="7792075">0</span><span class="op" id="7792076">]</span><span class="op" id="7792077">.</span><span class="ident" id="7792078">Value</span><span class="op" id="7792083">[</span><span class="num" id="7792084">0</span><span class="op" id="7792085">]</span><span class="op" id="7792086">,</span>&nbsp;<span class="ident" id="7792088">pkix</span><span class="op" id="7792092">.</span><span class="ident" id="7792093">AttributeTypeAndValue</span><span class="op" id="7792114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792118">Type</span><span class="op" id="7792122">:</span>&nbsp;&nbsp;<span class="ident" id="7792125">oidExtensionSubjectAltName</span><span class="op" id="7792151">,</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792155">Value</span><span class="op" id="7792160">:</span>&nbsp;<span class="ident" id="7792162">sanContents2</span><span class="op" id="7792174">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7792177">}</span><span class="op" id="7792178">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792182">csr</span>&nbsp;<span class="op" id="7792186">=</span>&nbsp;<span class="ident" id="7792188">marshalAndParseCSR</span><span class="op" id="7792206">(</span><span class="ident" id="7792207">t</span><span class="op" id="7792208">,</span>&nbsp;<span class="op" id="7792210">&amp;</span><span class="ident" id="7792211">template</span><span class="op" id="7792219">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7792223">if</span>&nbsp;<span class="builtinfunc" id="7792226">len</span><span class="op" id="7792229">(</span><span class="ident" id="7792230">csr</span><span class="op" id="7792233">.</span><span class="ident" id="7792234">DNSNames</span><span class="op" id="7792242">)</span>&nbsp;<span class="op" id="7792244">!=</span>&nbsp;<span class="num" id="7792247">1</span>&nbsp;<span class="op" id="7792249">||</span>&nbsp;<span class="ident" id="7792252">csr</span><span class="op" id="7792255">.</span><span class="ident" id="7792256">DNSNames</span><span class="op" id="7792264">[</span><span class="num" id="7792265">0</span><span class="op" id="7792266">]</span>&nbsp;<span class="op" id="7792268">!=</span>&nbsp;<span class="string" id="7792271">&#34;foo2.example.com&#34;</span>&nbsp;<span class="op" id="7792290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792294">t</span><span class="op" id="7792295">.</span><span class="ident" id="7792296">Errorf</span><span class="op" id="7792302">(</span><span class="string" id="7792303">&#34;Attributes&nbsp;did&nbsp;not&nbsp;override&nbsp;ExtraExtensions.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="7792358">,</span>&nbsp;<span class="ident" id="7792360">csr</span><span class="op" id="7792363">.</span><span class="ident" id="7792364">DNSNames</span><span class="op" id="7792372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7792375">}</span><br>
<span class="lineno"></span><span class="op" id="7792377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="7792380">func</span>&nbsp;<span class="ident" id="7792385">TestParseCertificateRequest</span><span class="op" id="7792412">(</span><span class="ident" id="7792413">t</span>&nbsp;<span class="op" id="7792415">*</span><span class="ident" id="7792416">testing</span><span class="op" id="7792423">.</span><span class="ident" id="7792424">T</span><span class="op" id="7792425">)</span>&nbsp;<span class="op" id="7792427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792430">csrBytes</span>&nbsp;<span class="op" id="7792439">:=</span>&nbsp;<span class="ident" id="7792442">fromBase64</span><span class="op" id="7792452">(</span><span class="ident" id="7792453">csrBase64</span><span class="op" id="7792462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792465">csr</span><span class="op" id="7792468">,</span>&nbsp;<span class="ident" id="7792470">err</span>&nbsp;<span class="op" id="7792474">:=</span>&nbsp;<span class="ident" id="7792477">ParseCertificateRequest</span><span class="op" id="7792500">(</span><span class="ident" id="7792501">csrBytes</span><span class="op" id="7792509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7792512">if</span>&nbsp;<span class="ident" id="7792515">err</span>&nbsp;<span class="op" id="7792519">!=</span>&nbsp;<span class="ident" id="7792522">nil</span>&nbsp;<span class="op" id="7792526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792530">t</span><span class="op" id="7792531">.</span><span class="ident" id="7792532">Fatalf</span><span class="op" id="7792538">(</span><span class="string" id="7792539">&#34;failed&nbsp;to&nbsp;parse&nbsp;CSR:&nbsp;%s&#34;</span><span class="op" id="7792564">,</span>&nbsp;<span class="ident" id="7792566">err</span><span class="op" id="7792569">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7792572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7792576">if</span>&nbsp;<span class="builtinfunc" id="7792579">len</span><span class="op" id="7792582">(</span><span class="ident" id="7792583">csr</span><span class="op" id="7792586">.</span><span class="ident" id="7792587">EmailAddresses</span><span class="op" id="7792601">)</span>&nbsp;<span class="op" id="7792603">!=</span>&nbsp;<span class="num" id="7792606">1</span>&nbsp;<span class="op" id="7792608">||</span>&nbsp;<span class="ident" id="7792611">csr</span><span class="op" id="7792614">.</span><span class="ident" id="7792615">EmailAddresses</span><span class="op" id="7792629">[</span><span class="num" id="7792630">0</span><span class="op" id="7792631">]</span>&nbsp;<span class="op" id="7792633">!=</span>&nbsp;<span class="string" id="7792636">&#34;gopher@golang.org&#34;</span>&nbsp;<span class="op" id="7792656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792660">t</span><span class="op" id="7792661">.</span><span class="ident" id="7792662">Errorf</span><span class="op" id="7792668">(</span><span class="string" id="7792669">&#34;incorrect&nbsp;email&nbsp;addresses&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="7792706">,</span>&nbsp;<span class="ident" id="7792708">csr</span><span class="op" id="7792711">.</span><span class="ident" id="7792712">EmailAddresses</span><span class="op" id="7792726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7792729">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7792733">if</span>&nbsp;<span class="builtinfunc" id="7792736">len</span><span class="op" id="7792739">(</span><span class="ident" id="7792740">csr</span><span class="op" id="7792743">.</span><span class="ident" id="7792744">DNSNames</span><span class="op" id="7792752">)</span>&nbsp;<span class="op" id="7792754">!=</span>&nbsp;<span class="num" id="7792757">1</span>&nbsp;<span class="op" id="7792759">||</span>&nbsp;<span class="ident" id="7792762">csr</span><span class="op" id="7792765">.</span><span class="ident" id="7792766">DNSNames</span><span class="op" id="7792774">[</span><span class="num" id="7792775">0</span><span class="op" id="7792776">]</span>&nbsp;<span class="op" id="7792778">!=</span>&nbsp;<span class="string" id="7792781">&#34;test.example.com&#34;</span>&nbsp;<span class="op" id="7792800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792804">t</span><span class="op" id="7792805">.</span><span class="ident" id="7792806">Errorf</span><span class="op" id="7792812">(</span><span class="string" id="7792813">&#34;incorrect&nbsp;DNS&nbsp;names&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="7792844">,</span>&nbsp;<span class="ident" id="7792846">csr</span><span class="op" id="7792849">.</span><span class="ident" id="7792850">DNSNames</span><span class="op" id="7792858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7792861">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7792865">if</span>&nbsp;<span class="builtinfunc" id="7792868">len</span><span class="op" id="7792871">(</span><span class="ident" id="7792872">csr</span><span class="op" id="7792875">.</span><span class="ident" id="7792876">Subject</span><span class="op" id="7792883">.</span><span class="ident" id="7792884">Country</span><span class="op" id="7792891">)</span>&nbsp;<span class="op" id="7792893">!=</span>&nbsp;<span class="num" id="7792896">1</span>&nbsp;<span class="op" id="7792898">||</span>&nbsp;<span class="ident" id="7792901">csr</span><span class="op" id="7792904">.</span><span class="ident" id="7792905">Subject</span><span class="op" id="7792912">.</span><span class="ident" id="7792913">Country</span><span class="op" id="7792920">[</span><span class="num" id="7792921">0</span><span class="op" id="7792922">]</span>&nbsp;<span class="op" id="7792924">!=</span>&nbsp;<span class="string" id="7792927">&#34;AU&#34;</span>&nbsp;<span class="op" id="7792932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792936">t</span><span class="op" id="7792937">.</span><span class="ident" id="7792938">Errorf</span><span class="op" id="7792944">(</span><span class="string" id="7792945">&#34;incorrect&nbsp;Subject&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="7792973">,</span>&nbsp;<span class="ident" id="7792975">csr</span><span class="op" id="7792978">.</span><span class="ident" id="7792979">Subject</span><span class="op" id="7792986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7792989">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7792993">found</span>&nbsp;<span class="op" id="7792999">:=</span>&nbsp;<span class="builtintype" id="7793002">false</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7793009">for</span>&nbsp;<span class="ident" id="7793013">_</span><span class="op" id="7793014">,</span>&nbsp;<span class="ident" id="7793016">e</span>&nbsp;<span class="op" id="7793018">:=</span>&nbsp;<span class="keyword" id="7793021">range</span>&nbsp;<span class="ident" id="7793027">csr</span><span class="op" id="7793030">.</span><span class="ident" id="7793031">Extensions</span>&nbsp;<span class="op" id="7793042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7793046">if</span>&nbsp;<span class="ident" id="7793049">e</span><span class="op" id="7793050">.</span><span class="ident" id="7793051">Id</span><span class="op" id="7793053">.</span><span class="ident" id="7793054">Equal</span><span class="op" id="7793059">(</span><span class="ident" id="7793060">oidExtensionBasicConstraints</span><span class="op" id="7793088">)</span>&nbsp;<span class="op" id="7793090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793095">found</span>&nbsp;<span class="op" id="7793101">=</span>&nbsp;<span class="builtintype" id="7793103">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7793111">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7793119">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7793122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7793125">if</span>&nbsp;<span class="op" id="7793128">!</span><span class="ident" id="7793129">found</span>&nbsp;<span class="op" id="7793135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793139">t</span><span class="op" id="7793140">.</span><span class="ident" id="7793141">Errorf</span><span class="op" id="7793147">(</span><span class="string" id="7793148">&#34;basic&nbsp;constraints&nbsp;extension&nbsp;not&nbsp;found&nbsp;in&nbsp;CSR&#34;</span><span class="op" id="7793194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7793197">}</span><br>
<span class="lineno"></span><span class="op" id="7793199">}</span><br>
<span class="lineno">955</span><br>
<span class="lineno"></span><span class="keyword" id="7793202">func</span>&nbsp;<span class="ident" id="7793207">TestMaxPathLen</span><span class="op" id="7793221">(</span><span class="ident" id="7793222">t</span>&nbsp;<span class="op" id="7793224">*</span><span class="ident" id="7793225">testing</span><span class="op" id="7793232">.</span><span class="ident" id="7793233">T</span><span class="op" id="7793234">)</span>&nbsp;<span class="op" id="7793236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793239">block</span><span class="op" id="7793244">,</span>&nbsp;<span class="ident" id="7793246">_</span>&nbsp;<span class="op" id="7793248">:=</span>&nbsp;<span class="ident" id="7793251">pem</span><span class="op" id="7793254">.</span><span class="ident" id="7793255">Decode</span><span class="op" id="7793261">(</span><span class="op" id="7793262">[</span><span class="op" id="7793263">]</span><span class="builtintype" id="7793264">byte</span><span class="op" id="7793268">(</span><span class="ident" id="7793269">pemPrivateKey</span><span class="op" id="7793282">)</span><span class="op" id="7793283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793286">rsaPriv</span><span class="op" id="7793293">,</span>&nbsp;<span class="ident" id="7793295">err</span>&nbsp;<span class="op" id="7793299">:=</span>&nbsp;<span class="ident" id="7793302">ParsePKCS1PrivateKey</span><span class="op" id="7793322">(</span><span class="ident" id="7793323">block</span><span class="op" id="7793328">.</span><span class="ident" id="7793329">Bytes</span><span class="op" id="7793334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7793337">if</span>&nbsp;<span class="ident" id="7793340">err</span>&nbsp;<span class="op" id="7793344">!=</span>&nbsp;<span class="ident" id="7793347">nil</span>&nbsp;<span class="op" id="7793351">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793355">t</span><span class="op" id="7793356">.</span><span class="ident" id="7793357">Fatalf</span><span class="op" id="7793363">(</span><span class="string" id="7793364">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="7793397">,</span>&nbsp;<span class="ident" id="7793399">err</span><span class="op" id="7793402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7793405">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793409">template</span>&nbsp;<span class="op" id="7793418">:=</span>&nbsp;<span class="op" id="7793421">&amp;</span><span class="ident" id="7793422">Certificate</span><span class="op" id="7793433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793437">SerialNumber</span><span class="op" id="7793449">:</span>&nbsp;<span class="ident" id="7793451">big</span><span class="op" id="7793454">.</span><span class="ident" id="7793455">NewInt</span><span class="op" id="7793461">(</span><span class="num" id="7793462">1</span><span class="op" id="7793463">)</span><span class="op" id="7793464">,</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793468">Subject</span><span class="op" id="7793475">:</span>&nbsp;<span class="ident" id="7793477">pkix</span><span class="op" id="7793481">.</span><span class="ident" id="7793482">Name</span><span class="op" id="7793486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793491">CommonName</span><span class="op" id="7793501">:</span>&nbsp;<span class="string" id="7793503">&#34;&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="7793515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7793519">}</span><span class="op" id="7793520">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793524">NotBefore</span><span class="op" id="7793533">:</span>&nbsp;<span class="ident" id="7793535">time</span><span class="op" id="7793539">.</span><span class="ident" id="7793540">Unix</span><span class="op" id="7793544">(</span><span class="num" id="7793545">1000</span><span class="op" id="7793549">,</span>&nbsp;<span class="num" id="7793551">0</span><span class="op" id="7793552">)</span><span class="op" id="7793553">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793557">NotAfter</span><span class="op" id="7793565">:</span>&nbsp;&nbsp;<span class="ident" id="7793568">time</span><span class="op" id="7793572">.</span><span class="ident" id="7793573">Unix</span><span class="op" id="7793577">(</span><span class="num" id="7793578">100000</span><span class="op" id="7793584">,</span>&nbsp;<span class="num" id="7793586">0</span><span class="op" id="7793587">)</span><span class="op" id="7793588">,</span><br>
<span class="lineno">970</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793593">BasicConstraintsValid</span><span class="op" id="7793614">:</span>&nbsp;<span class="builtintype" id="7793616">true</span><span class="op" id="7793620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793624">IsCA</span><span class="op" id="7793628">:</span>&nbsp;<span class="builtintype" id="7793630">true</span><span class="op" id="7793634">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7793637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793641">serialiseAndParse</span>&nbsp;<span class="op" id="7793659">:=</span>&nbsp;<span class="keyword" id="7793662">func</span><span class="op" id="7793666">(</span><span class="ident" id="7793667">template</span>&nbsp;<span class="op" id="7793676">*</span><span class="ident" id="7793677">Certificate</span><span class="op" id="7793688">)</span>&nbsp;<span class="op" id="7793690">*</span><span class="ident" id="7793691">Certificate</span>&nbsp;<span class="op" id="7793703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793707">derBytes</span><span class="op" id="7793715">,</span>&nbsp;<span class="ident" id="7793717">err</span>&nbsp;<span class="op" id="7793721">:=</span>&nbsp;<span class="ident" id="7793724">CreateCertificate</span><span class="op" id="7793741">(</span><span class="ident" id="7793742">rand</span><span class="op" id="7793746">.</span><span class="ident" id="7793747">Reader</span><span class="op" id="7793753">,</span>&nbsp;<span class="ident" id="7793755">template</span><span class="op" id="7793763">,</span>&nbsp;<span class="ident" id="7793765">template</span><span class="op" id="7793773">,</span>&nbsp;<span class="op" id="7793775">&amp;</span><span class="ident" id="7793776">rsaPriv</span><span class="op" id="7793783">.</span><span class="ident" id="7793784">PublicKey</span><span class="op" id="7793793">,</span>&nbsp;<span class="ident" id="7793795">rsaPriv</span><span class="op" id="7793802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7793806">if</span>&nbsp;<span class="ident" id="7793809">err</span>&nbsp;<span class="op" id="7793813">!=</span>&nbsp;<span class="ident" id="7793816">nil</span>&nbsp;<span class="op" id="7793820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793825">t</span><span class="op" id="7793826">.</span><span class="ident" id="7793827">Fatalf</span><span class="op" id="7793833">(</span><span class="string" id="7793834">&#34;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7793868">,</span>&nbsp;<span class="ident" id="7793870">err</span><span class="op" id="7793873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7793878">return</span>&nbsp;<span class="ident" id="7793885">nil</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7793891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793896">cert</span><span class="op" id="7793900">,</span>&nbsp;<span class="ident" id="7793902">err</span>&nbsp;<span class="op" id="7793906">:=</span>&nbsp;<span class="ident" id="7793909">ParseCertificate</span><span class="op" id="7793925">(</span><span class="ident" id="7793926">derBytes</span><span class="op" id="7793934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7793938">if</span>&nbsp;<span class="ident" id="7793941">err</span>&nbsp;<span class="op" id="7793945">!=</span>&nbsp;<span class="ident" id="7793948">nil</span>&nbsp;<span class="op" id="7793952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7793957">t</span><span class="op" id="7793958">.</span><span class="ident" id="7793959">Fatalf</span><span class="op" id="7793965">(</span><span class="string" id="7793966">&#34;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="7793999">,</span>&nbsp;<span class="ident" id="7794001">err</span><span class="op" id="7794004">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7794009">return</span>&nbsp;<span class="ident" id="7794016">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7794022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7794027">return</span>&nbsp;<span class="ident" id="7794034">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7794040">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794044">cert1</span>&nbsp;<span class="op" id="7794050">:=</span>&nbsp;<span class="ident" id="7794053">serialiseAndParse</span><span class="op" id="7794070">(</span><span class="ident" id="7794071">template</span><span class="op" id="7794079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7794082">if</span>&nbsp;<span class="ident" id="7794085">m</span>&nbsp;<span class="op" id="7794087">:=</span>&nbsp;<span class="ident" id="7794090">cert1</span><span class="op" id="7794095">.</span><span class="ident" id="7794096">MaxPathLen</span><span class="op" id="7794106">;</span>&nbsp;<span class="ident" id="7794108">m</span>&nbsp;<span class="op" id="7794110">!=</span>&nbsp;<span class="op" id="7794113">-</span><span class="num" id="7794114">1</span>&nbsp;<span class="op" id="7794116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794120">t</span><span class="op" id="7794121">.</span><span class="ident" id="7794122">Errorf</span><span class="op" id="7794128">(</span><span class="string" id="7794129">&#34;Omitting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;turn&nbsp;into&nbsp;-1,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7794178">,</span>&nbsp;<span class="ident" id="7794180">m</span><span class="op" id="7794181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7794184">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7794187">if</span>&nbsp;<span class="ident" id="7794190">cert1</span><span class="op" id="7794195">.</span><span class="ident" id="7794196">MaxPathLenZero</span>&nbsp;<span class="op" id="7794211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794215">t</span><span class="op" id="7794216">.</span><span class="ident" id="7794217">Errorf</span><span class="op" id="7794223">(</span><span class="string" id="7794224">&#34;Omitting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7794272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7794275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794279">template</span><span class="op" id="7794287">.</span><span class="ident" id="7794288">MaxPathLen</span>&nbsp;<span class="op" id="7794299">=</span>&nbsp;<span class="num" id="7794301">1</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794304">cert2</span>&nbsp;<span class="op" id="7794310">:=</span>&nbsp;<span class="ident" id="7794313">serialiseAndParse</span><span class="op" id="7794330">(</span><span class="ident" id="7794331">template</span><span class="op" id="7794339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7794342">if</span>&nbsp;<span class="ident" id="7794345">m</span>&nbsp;<span class="op" id="7794347">:=</span>&nbsp;<span class="ident" id="7794350">cert2</span><span class="op" id="7794355">.</span><span class="ident" id="7794356">MaxPathLen</span><span class="op" id="7794366">;</span>&nbsp;<span class="ident" id="7794368">m</span>&nbsp;<span class="op" id="7794370">!=</span>&nbsp;<span class="num" id="7794373">1</span>&nbsp;<span class="op" id="7794375">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794379">t</span><span class="op" id="7794380">.</span><span class="ident" id="7794381">Errorf</span><span class="op" id="7794387">(</span><span class="string" id="7794388">&#34;Setting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;work.&nbsp;Got&nbsp;%d&nbsp;but&nbsp;set&nbsp;1&#34;</span><span class="op" id="7794438">,</span>&nbsp;<span class="ident" id="7794440">m</span><span class="op" id="7794441">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7794444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7794447">if</span>&nbsp;<span class="ident" id="7794450">cert2</span><span class="op" id="7794455">.</span><span class="ident" id="7794456">MaxPathLenZero</span>&nbsp;<span class="op" id="7794471">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794475">t</span><span class="op" id="7794476">.</span><span class="ident" id="7794477">Errorf</span><span class="op" id="7794483">(</span><span class="string" id="7794484">&#34;Setting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7794531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7794534">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794538">template</span><span class="op" id="7794546">.</span><span class="ident" id="7794547">MaxPathLen</span>&nbsp;<span class="op" id="7794558">=</span>&nbsp;<span class="num" id="7794560">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794563">template</span><span class="op" id="7794571">.</span><span class="ident" id="7794572">MaxPathLenZero</span>&nbsp;<span class="op" id="7794587">=</span>&nbsp;<span class="builtintype" id="7794589">true</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794595">cert3</span>&nbsp;<span class="op" id="7794601">:=</span>&nbsp;<span class="ident" id="7794604">serialiseAndParse</span><span class="op" id="7794621">(</span><span class="ident" id="7794622">template</span><span class="op" id="7794630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7794633">if</span>&nbsp;<span class="ident" id="7794636">m</span>&nbsp;<span class="op" id="7794638">:=</span>&nbsp;<span class="ident" id="7794641">cert3</span><span class="op" id="7794646">.</span><span class="ident" id="7794647">MaxPathLen</span><span class="op" id="7794657">;</span>&nbsp;<span class="ident" id="7794659">m</span>&nbsp;<span class="op" id="7794661">!=</span>&nbsp;<span class="num" id="7794664">0</span>&nbsp;<span class="op" id="7794666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794670">t</span><span class="op" id="7794671">.</span><span class="ident" id="7794672">Errorf</span><span class="op" id="7794678">(</span><span class="string" id="7794679">&#34;Setting&nbsp;MaxPathLenZero&nbsp;didn&#39;t&nbsp;work,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7794723">,</span>&nbsp;<span class="ident" id="7794725">m</span><span class="op" id="7794726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7794729">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7794732">if</span>&nbsp;<span class="op" id="7794735">!</span><span class="ident" id="7794736">cert3</span><span class="op" id="7794741">.</span><span class="ident" id="7794742">MaxPathLenZero</span>&nbsp;<span class="op" id="7794757">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7794761">t</span><span class="op" id="7794762">.</span><span class="ident" id="7794763">Errorf</span><span class="op" id="7794769">(</span><span class="string" id="7794770">&#34;Setting&nbsp;MaxPathLen&nbsp;to&nbsp;zero&nbsp;didn&#39;t&nbsp;result&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="7794830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7794833">}</span><br>
<span class="lineno"></span><span class="op" id="7794835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7794838">//&nbsp;This&nbsp;CSR&nbsp;was&nbsp;generated&nbsp;with&nbsp;OpenSSL:</span><br>
<span class="lineno">1020</span><span class="comment" id="7794878">//&nbsp;&nbsp;openssl&nbsp;req&nbsp;-out&nbsp;CSR.csr&nbsp;-new&nbsp;-newkey&nbsp;rsa:2048&nbsp;-nodes&nbsp;-keyout&nbsp;privateKey.key&nbsp;-config&nbsp;openssl.cnf</span><br>
<span class="lineno"></span><span class="comment" id="7794979">//</span><br>
<span class="lineno"></span><span class="comment" id="7794982">//&nbsp;The&nbsp;openssl.cnf&nbsp;needs&nbsp;to&nbsp;include&nbsp;this&nbsp;section:</span><br>
<span class="lineno"></span><span class="comment" id="7795032">//&nbsp;&nbsp;&nbsp;[&nbsp;v3_req&nbsp;]</span><br>
<span class="lineno"></span><span class="comment" id="7795048">//&nbsp;&nbsp;&nbsp;basicConstraints&nbsp;=&nbsp;CA:FALSE</span><br>
<span class="lineno">1025</span><span class="comment" id="7795081">//&nbsp;&nbsp;&nbsp;keyUsage&nbsp;=&nbsp;nonRepudiation,&nbsp;digitalSignature,&nbsp;keyEncipherment</span><br>
<span class="lineno"></span><span class="comment" id="7795147">//&nbsp;&nbsp;&nbsp;subjectAltName&nbsp;=&nbsp;email:gopher@golang.org,DNS:test.example.com</span><br>
<span class="lineno"></span><span class="keyword" id="7795214">const</span>&nbsp;<span class="ident" id="7795220">csrBase64</span>&nbsp;<span class="op" id="7795230">=</span>&nbsp;<span class="string" id="7795232">&#34;MIIC4zCCAcsCAQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoMGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOY+MVedRg2JEnyeLcSzcsMv2VcsTfkB5+Etd6hihAh6MrGezNyASMMKuQN6YhCX1icQDiQtGsDLTtheNnSXK06tAhHjAP/hGlszRJp+5+rP2M58fDBAkUBEhskbCUWwpY14jFtVuGNJ8vF8h8IeczdolvQhX9lVai9G0EUXJMliMKdjA899H0mRs9PzHyidyrXFNiZlQXfD8Kg7gETn2Ny965iyI6ujAIYSCvam6TnxRHYH2MBKyVGvsYGbPYUQJCsgdgyajEg6ekihvQY3SzO1HSAlZAd7d1QYO4VeWJ2mY6Wu3Jpmh+AmG19S9CcHqGjd0bhuAX9cpPOKgnEmqn0CAwEAAaBZMFcGCSqGSIb3DQEJDjFKMEgwCQYDVR0TBAIwADALBgNVHQ8EBAMCBeAwLgYDVR0RBCcwJYERZ29waGVyQGdvbGFuZy5vcmeCEHRlc3QuZXhhbXBsZS5jb20wDQYJKoZIhvcNAQEFBQADggEBAC9+QpKfdabxwCWwf4IEe1cKjdXLS1ScSuw27a3kZzQiPV78WJMa6dB8dqhdH5BRwGZ/qsgLrO6ZHlNeIv2Ib41Ccq71ecHW/nXc94A1BzJ/bVdI9LZcmTUvR1/m1jCpN7UqQ0ml1u9VihK7Pe762hEYxuWDQzYEU0l15S/bXmqeq3eF1A59XT/2jwe5+NV0Wwf4UQlkTXsAQMsJ+KzrQafd8Qv2A49o048uRvmjeJDrXLawGVianZ7D5A6Fpd1rZh6XcjqBpmgLw41DRQWENOdzhy+HyphKRv1MlY8OLkNqpGMhu8DdgJVGoT16DGiickoEa7Z3UCPVNgdTkT9jq7U=&#34;</span>
</div>
</body>
</html>
