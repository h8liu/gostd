<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7529399">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7529454">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7529508">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7529559">package</span>&nbsp;<span class="ident" id="7529567">rc4</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7529572">import</span>&nbsp;<span class="op" id="7529579">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7529582">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7529591">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7529598">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7529608">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7529611">type</span>&nbsp;<span class="ident" id="7529616">rc4Test</span>&nbsp;<span class="keyword" id="7529624">struct</span>&nbsp;<span class="op" id="7529631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7529634">key</span><span class="op" id="7529637">,</span>&nbsp;<span class="ident" id="7529639">keystream</span>&nbsp;<span class="op" id="7529649">[</span><span class="op" id="7529650">]</span><span class="builtintype" id="7529651">byte</span><br>
<span class="lineno">15</span><span class="op" id="7529656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7529659">var</span>&nbsp;<span class="ident" id="7529663">golden</span>&nbsp;<span class="op" id="7529670">=</span>&nbsp;<span class="op" id="7529672">[</span><span class="op" id="7529673">]</span><span class="ident" id="7529674"><a href="/crypto/rc4/rc4_test.go.html#7529616">rc4Test</a></span><span class="op" id="7529681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7529684">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;original&nbsp;cypherpunk&nbsp;posting&nbsp;of&nbsp;ARC4:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7529747">//&nbsp;&nbsp;&nbsp;http://groups.google.com/group/sci.crypt/msg/10a300c9d21afca0?pli=1</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7529821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7529825">[</span><span class="op" id="7529826">]</span><span class="builtintype" id="7529827">byte</span><span class="op" id="7529831">{</span><span class="num" id="7529832">0x01</span><span class="op" id="7529836">,</span>&nbsp;<span class="num" id="7529838">0x23</span><span class="op" id="7529842">,</span>&nbsp;<span class="num" id="7529844">0x45</span><span class="op" id="7529848">,</span>&nbsp;<span class="num" id="7529850">0x67</span><span class="op" id="7529854">,</span>&nbsp;<span class="num" id="7529856">0x89</span><span class="op" id="7529860">,</span>&nbsp;<span class="num" id="7529862">0xab</span><span class="op" id="7529866">,</span>&nbsp;<span class="num" id="7529868">0xcd</span><span class="op" id="7529872">,</span>&nbsp;<span class="num" id="7529874">0xef</span><span class="op" id="7529878">}</span><span class="op" id="7529879">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7529883">[</span><span class="op" id="7529884">]</span><span class="builtintype" id="7529885">byte</span><span class="op" id="7529889">{</span><span class="num" id="7529890">0x74</span><span class="op" id="7529894">,</span>&nbsp;<span class="num" id="7529896">0x94</span><span class="op" id="7529900">,</span>&nbsp;<span class="num" id="7529902">0xc2</span><span class="op" id="7529906">,</span>&nbsp;<span class="num" id="7529908">0xe7</span><span class="op" id="7529912">,</span>&nbsp;<span class="num" id="7529914">0x10</span><span class="op" id="7529918">,</span>&nbsp;<span class="num" id="7529920">0x4b</span><span class="op" id="7529924">,</span>&nbsp;<span class="num" id="7529926">0x08</span><span class="op" id="7529930">,</span>&nbsp;<span class="num" id="7529932">0x79</span><span class="op" id="7529936">}</span><span class="op" id="7529937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7529940">}</span><span class="op" id="7529941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7529944">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7529948">[</span><span class="op" id="7529949">]</span><span class="builtintype" id="7529950">byte</span><span class="op" id="7529954">{</span><span class="num" id="7529955">0x00</span><span class="op" id="7529959">,</span>&nbsp;<span class="num" id="7529961">0x00</span><span class="op" id="7529965">,</span>&nbsp;<span class="num" id="7529967">0x00</span><span class="op" id="7529971">,</span>&nbsp;<span class="num" id="7529973">0x00</span><span class="op" id="7529977">,</span>&nbsp;<span class="num" id="7529979">0x00</span><span class="op" id="7529983">,</span>&nbsp;<span class="num" id="7529985">0x00</span><span class="op" id="7529989">,</span>&nbsp;<span class="num" id="7529991">0x00</span><span class="op" id="7529995">,</span>&nbsp;<span class="num" id="7529997">0x00</span><span class="op" id="7530001">}</span><span class="op" id="7530002">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530006">[</span><span class="op" id="7530007">]</span><span class="builtintype" id="7530008">byte</span><span class="op" id="7530012">{</span><span class="num" id="7530013">0xde</span><span class="op" id="7530017">,</span>&nbsp;<span class="num" id="7530019">0x18</span><span class="op" id="7530023">,</span>&nbsp;<span class="num" id="7530025">0x89</span><span class="op" id="7530029">,</span>&nbsp;<span class="num" id="7530031">0x41</span><span class="op" id="7530035">,</span>&nbsp;<span class="num" id="7530037">0xa3</span><span class="op" id="7530041">,</span>&nbsp;<span class="num" id="7530043">0x37</span><span class="op" id="7530047">,</span>&nbsp;<span class="num" id="7530049">0x5d</span><span class="op" id="7530053">,</span>&nbsp;<span class="num" id="7530055">0x3a</span><span class="op" id="7530059">}</span><span class="op" id="7530060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530063">}</span><span class="op" id="7530064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530071">[</span><span class="op" id="7530072">]</span><span class="builtintype" id="7530073">byte</span><span class="op" id="7530077">{</span><span class="num" id="7530078">0xef</span><span class="op" id="7530082">,</span>&nbsp;<span class="num" id="7530084">0x01</span><span class="op" id="7530088">,</span>&nbsp;<span class="num" id="7530090">0x23</span><span class="op" id="7530094">,</span>&nbsp;<span class="num" id="7530096">0x45</span><span class="op" id="7530100">}</span><span class="op" id="7530101">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530105">[</span><span class="op" id="7530106">]</span><span class="builtintype" id="7530107">byte</span><span class="op" id="7530111">{</span><span class="num" id="7530112">0xd6</span><span class="op" id="7530116">,</span>&nbsp;<span class="num" id="7530118">0xa1</span><span class="op" id="7530122">,</span>&nbsp;<span class="num" id="7530124">0x41</span><span class="op" id="7530128">,</span>&nbsp;<span class="num" id="7530130">0xa7</span><span class="op" id="7530134">,</span>&nbsp;<span class="num" id="7530136">0xec</span><span class="op" id="7530140">,</span>&nbsp;<span class="num" id="7530142">0x3c</span><span class="op" id="7530146">,</span>&nbsp;<span class="num" id="7530148">0x38</span><span class="op" id="7530152">,</span>&nbsp;<span class="num" id="7530154">0xdf</span><span class="op" id="7530158">,</span>&nbsp;<span class="num" id="7530160">0xbd</span><span class="op" id="7530164">,</span>&nbsp;<span class="num" id="7530166">0x61</span><span class="op" id="7530170">}</span><span class="op" id="7530171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530174">}</span><span class="op" id="7530175">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7530179">//&nbsp;Test&nbsp;vectors&nbsp;from&nbsp;the&nbsp;Wikipedia&nbsp;page:&nbsp;http://en.wikipedia.org/wiki/RC4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530254">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530258">[</span><span class="op" id="7530259">]</span><span class="builtintype" id="7530260">byte</span><span class="op" id="7530264">{</span><span class="num" id="7530265">0x4b</span><span class="op" id="7530269">,</span>&nbsp;<span class="num" id="7530271">0x65</span><span class="op" id="7530275">,</span>&nbsp;<span class="num" id="7530277">0x79</span><span class="op" id="7530281">}</span><span class="op" id="7530282">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530286">[</span><span class="op" id="7530287">]</span><span class="builtintype" id="7530288">byte</span><span class="op" id="7530292">{</span><span class="num" id="7530293">0xeb</span><span class="op" id="7530297">,</span>&nbsp;<span class="num" id="7530299">0x9f</span><span class="op" id="7530303">,</span>&nbsp;<span class="num" id="7530305">0x77</span><span class="op" id="7530309">,</span>&nbsp;<span class="num" id="7530311">0x81</span><span class="op" id="7530315">,</span>&nbsp;<span class="num" id="7530317">0xb7</span><span class="op" id="7530321">,</span>&nbsp;<span class="num" id="7530323">0x34</span><span class="op" id="7530327">,</span>&nbsp;<span class="num" id="7530329">0xca</span><span class="op" id="7530333">,</span>&nbsp;<span class="num" id="7530335">0x72</span><span class="op" id="7530339">,</span>&nbsp;<span class="num" id="7530341">0xa7</span><span class="op" id="7530345">,</span>&nbsp;<span class="num" id="7530347">0x19</span><span class="op" id="7530351">}</span><span class="op" id="7530352">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530355">}</span><span class="op" id="7530356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530363">[</span><span class="op" id="7530364">]</span><span class="builtintype" id="7530365">byte</span><span class="op" id="7530369">{</span><span class="num" id="7530370">0x57</span><span class="op" id="7530374">,</span>&nbsp;<span class="num" id="7530376">0x69</span><span class="op" id="7530380">,</span>&nbsp;<span class="num" id="7530382">0x6b</span><span class="op" id="7530386">,</span>&nbsp;<span class="num" id="7530388">0x69</span><span class="op" id="7530392">}</span><span class="op" id="7530393">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530397">[</span><span class="op" id="7530398">]</span><span class="builtintype" id="7530399">byte</span><span class="op" id="7530403">{</span><span class="num" id="7530404">0x60</span><span class="op" id="7530408">,</span>&nbsp;<span class="num" id="7530410">0x44</span><span class="op" id="7530414">,</span>&nbsp;<span class="num" id="7530416">0xdb</span><span class="op" id="7530420">,</span>&nbsp;<span class="num" id="7530422">0x6d</span><span class="op" id="7530426">,</span>&nbsp;<span class="num" id="7530428">0x41</span><span class="op" id="7530432">,</span>&nbsp;<span class="num" id="7530434">0xb7</span><span class="op" id="7530438">}</span><span class="op" id="7530439">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530442">}</span><span class="op" id="7530443">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530450">[</span><span class="op" id="7530451">]</span><span class="builtintype" id="7530452">byte</span><span class="op" id="7530456">{</span><span class="num" id="7530457">0x00</span><span class="op" id="7530461">,</span>&nbsp;<span class="num" id="7530463">0x00</span><span class="op" id="7530467">,</span>&nbsp;<span class="num" id="7530469">0x00</span><span class="op" id="7530473">,</span>&nbsp;<span class="num" id="7530475">0x00</span><span class="op" id="7530479">,</span>&nbsp;<span class="num" id="7530481">0x00</span><span class="op" id="7530485">,</span>&nbsp;<span class="num" id="7530487">0x00</span><span class="op" id="7530491">,</span>&nbsp;<span class="num" id="7530493">0x00</span><span class="op" id="7530497">,</span>&nbsp;<span class="num" id="7530499">0x00</span><span class="op" id="7530503">}</span><span class="op" id="7530504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7530508">[</span><span class="op" id="7530509">]</span><span class="builtintype" id="7530510">byte</span><span class="op" id="7530514">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7530519">0xde</span><span class="op" id="7530523">,</span>&nbsp;<span class="num" id="7530525">0x18</span><span class="op" id="7530529">,</span>&nbsp;<span class="num" id="7530531">0x89</span><span class="op" id="7530535">,</span>&nbsp;<span class="num" id="7530537">0x41</span><span class="op" id="7530541">,</span>&nbsp;<span class="num" id="7530543">0xa3</span><span class="op" id="7530547">,</span>&nbsp;<span class="num" id="7530549">0x37</span><span class="op" id="7530553">,</span>&nbsp;<span class="num" id="7530555">0x5d</span><span class="op" id="7530559">,</span>&nbsp;<span class="num" id="7530561">0x3a</span><span class="op" id="7530565">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7530570">0x8a</span><span class="op" id="7530574">,</span>&nbsp;<span class="num" id="7530576">0x06</span><span class="op" id="7530580">,</span>&nbsp;<span class="num" id="7530582">0x1e</span><span class="op" id="7530586">,</span>&nbsp;<span class="num" id="7530588">0x67</span><span class="op" id="7530592">,</span>&nbsp;<span class="num" id="7530594">0x57</span><span class="op" id="7530598">,</span>&nbsp;<span class="num" id="7530600">0x6e</span><span class="op" id="7530604">,</span>&nbsp;<span class="num" id="7530606">0x92</span><span class="op" id="7530610">,</span>&nbsp;<span class="num" id="7530612">0x6d</span><span class="op" id="7530616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7530621">0xc7</span><span class="op" id="7530625">,</span>&nbsp;<span class="num" id="7530627">0x1a</span><span class="op" id="7530631">,</span>&nbsp;<span class="num" id="7530633">0x7f</span><span class="op" id="7530637">,</span>&nbsp;<span class="num" id="7530639">0xa3</span><span class="op" id="7530643">,</span>&nbsp;<span class="num" id="7530645">0xf0</span><span class="op" id="7530649">,</span>&nbsp;<span class="num" id="7530651">0xcc</span><span class="op" id="7530655">,</span>&nbsp;<span class="num" id="7530657">0xeb</span><span class="op" id="7530661">,</span>&nbsp;<span class="num" id="7530663">0x97</span><span class="op" id="7530667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7530672">0x45</span><span class="op" id="7530676">,</span>&nbsp;<span class="num" id="7530678">0x2b</span><span class="op" id="7530682">,</span>&nbsp;<span class="num" id="7530684">0x4d</span><span class="op" id="7530688">,</span>&nbsp;<span class="num" id="7530690">0x32</span><span class="op" id="7530694">,</span>&nbsp;<span class="num" id="7530696">0x27</span><span class="op" id="7530700">,</span>&nbsp;<span class="num" id="7530702">0x96</span><span class="op" id="7530706">,</span>&nbsp;<span class="num" id="7530708">0x5f</span><span class="op" id="7530712">,</span>&nbsp;<span class="num" id="7530714">0x9e</span><span class="op" id="7530718">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7530723">0xa8</span><span class="op" id="7530727">,</span>&nbsp;<span class="num" id="7530729">0xcc</span><span class="op" id="7530733">,</span>&nbsp;<span class="num" id="7530735">0x75</span><span class="op" id="7530739">,</span>&nbsp;<span class="num" id="7530741">0x07</span><span class="op" id="7530745">,</span>&nbsp;<span class="num" id="7530747">0x6d</span><span class="op" id="7530751">,</span>&nbsp;<span class="num" id="7530753">0x9f</span><span class="op" id="7530757">,</span>&nbsp;<span class="num" id="7530759">0xb9</span><span class="op" id="7530763">,</span>&nbsp;<span class="num" id="7530765">0xc5</span><span class="op" id="7530769">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7530774">0x41</span><span class="op" id="7530778">,</span>&nbsp;<span class="num" id="7530780">0x7a</span><span class="op" id="7530784">,</span>&nbsp;<span class="num" id="7530786">0xa5</span><span class="op" id="7530790">,</span>&nbsp;<span class="num" id="7530792">0xcb</span><span class="op" id="7530796">,</span>&nbsp;<span class="num" id="7530798">0x30</span><span class="op" id="7530802">,</span>&nbsp;<span class="num" id="7530804">0xfc</span><span class="op" id="7530808">,</span>&nbsp;<span class="num" id="7530810">0x22</span><span class="op" id="7530814">,</span>&nbsp;<span class="num" id="7530816">0x19</span><span class="op" id="7530820">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7530825">0x8b</span><span class="op" id="7530829">,</span>&nbsp;<span class="num" id="7530831">0x34</span><span class="op" id="7530835">,</span>&nbsp;<span class="num" id="7530837">0x98</span><span class="op" id="7530841">,</span>&nbsp;<span class="num" id="7530843">0x2d</span><span class="op" id="7530847">,</span>&nbsp;<span class="num" id="7530849">0xbb</span><span class="op" id="7530853">,</span>&nbsp;<span class="num" id="7530855">0x62</span><span class="op" id="7530859">,</span>&nbsp;<span class="num" id="7530861">0x9e</span><span class="op" id="7530865">,</span>&nbsp;<span class="num" id="7530867">0xc0</span><span class="op" id="7530871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7530876">0x4b</span><span class="op" id="7530880">,</span>&nbsp;<span class="num" id="7530882">0x4f</span><span class="op" id="7530886">,</span>&nbsp;<span class="num" id="7530888">0x8b</span><span class="op" id="7530892">,</span>&nbsp;<span class="num" id="7530894">0x05</span><span class="op" id="7530898">,</span>&nbsp;<span class="num" id="7530900">0xa0</span><span class="op" id="7530904">,</span>&nbsp;<span class="num" id="7530906">0x71</span><span class="op" id="7530910">,</span>&nbsp;<span class="num" id="7530912">0x08</span><span class="op" id="7530916">,</span>&nbsp;<span class="num" id="7530918">0x50</span><span class="op" id="7530922">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7530927">0x92</span><span class="op" id="7530931">,</span>&nbsp;<span class="num" id="7530933">0xa0</span><span class="op" id="7530937">,</span>&nbsp;<span class="num" id="7530939">0xc3</span><span class="op" id="7530943">,</span>&nbsp;<span class="num" id="7530945">0x58</span><span class="op" id="7530949">,</span>&nbsp;<span class="num" id="7530951">0x4a</span><span class="op" id="7530955">,</span>&nbsp;<span class="num" id="7530957">0x48</span><span class="op" id="7530961">,</span>&nbsp;<span class="num" id="7530963">0xe4</span><span class="op" id="7530967">,</span>&nbsp;<span class="num" id="7530969">0xa3</span><span class="op" id="7530973">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7530978">0x0a</span><span class="op" id="7530982">,</span>&nbsp;<span class="num" id="7530984">0x39</span><span class="op" id="7530988">,</span>&nbsp;<span class="num" id="7530990">0x7b</span><span class="op" id="7530994">,</span>&nbsp;<span class="num" id="7530996">0x8a</span><span class="op" id="7531000">,</span>&nbsp;<span class="num" id="7531002">0xcd</span><span class="op" id="7531006">,</span>&nbsp;<span class="num" id="7531008">0x1d</span><span class="op" id="7531012">,</span>&nbsp;<span class="num" id="7531014">0x00</span><span class="op" id="7531018">,</span>&nbsp;<span class="num" id="7531020">0x9e</span><span class="op" id="7531024">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7531029">0xc8</span><span class="op" id="7531033">,</span>&nbsp;<span class="num" id="7531035">0x7d</span><span class="op" id="7531039">,</span>&nbsp;<span class="num" id="7531041">0x68</span><span class="op" id="7531045">,</span>&nbsp;<span class="num" id="7531047">0x11</span><span class="op" id="7531051">,</span>&nbsp;<span class="num" id="7531053">0xf2</span><span class="op" id="7531057">,</span>&nbsp;<span class="num" id="7531059">0x2c</span><span class="op" id="7531063">,</span>&nbsp;<span class="num" id="7531065">0xf4</span><span class="op" id="7531069">,</span>&nbsp;<span class="num" id="7531071">0x9c</span><span class="op" id="7531075">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7531080">0xa3</span><span class="op" id="7531084">,</span>&nbsp;<span class="num" id="7531086">0xe5</span><span class="op" id="7531090">,</span>&nbsp;<span class="num" id="7531092">0x93</span><span class="op" id="7531096">,</span>&nbsp;<span class="num" id="7531098">0x54</span><span class="op" id="7531102">,</span>&nbsp;<span class="num" id="7531104">0xb9</span><span class="op" id="7531108">,</span>&nbsp;<span class="num" id="7531110">0x45</span><span class="op" id="7531114">,</span>&nbsp;<span class="num" id="7531116">0x15</span><span class="op" id="7531120">,</span>&nbsp;<span class="num" id="7531122">0x35</span><span class="op" id="7531126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7531131">0xa2</span><span class="op" id="7531135">,</span>&nbsp;<span class="num" id="7531137">0x18</span><span class="op" id="7531141">,</span>&nbsp;<span class="num" id="7531143">0x7a</span><span class="op" id="7531147">,</span>&nbsp;<span class="num" id="7531149">0x86</span><span class="op" id="7531153">,</span>&nbsp;<span class="num" id="7531155">0x42</span><span class="op" id="7531159">,</span>&nbsp;<span class="num" id="7531161">0x6c</span><span class="op" id="7531165">,</span>&nbsp;<span class="num" id="7531167">0xca</span><span class="op" id="7531171">,</span>&nbsp;<span class="num" id="7531173">0x7d</span><span class="op" id="7531177">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7531182">0x5e</span><span class="op" id="7531186">,</span>&nbsp;<span class="num" id="7531188">0x82</span><span class="op" id="7531192">,</span>&nbsp;<span class="num" id="7531194">0x3e</span><span class="op" id="7531198">,</span>&nbsp;<span class="num" id="7531200">0xba</span><span class="op" id="7531204">,</span>&nbsp;<span class="num" id="7531206">0x00</span><span class="op" id="7531210">,</span>&nbsp;<span class="num" id="7531212">0x44</span><span class="op" id="7531216">,</span>&nbsp;<span class="num" id="7531218">0x12</span><span class="op" id="7531222">,</span>&nbsp;<span class="num" id="7531224">0x67</span><span class="op" id="7531228">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7531233">0x12</span><span class="op" id="7531237">,</span>&nbsp;<span class="num" id="7531239">0x57</span><span class="op" id="7531243">,</span>&nbsp;<span class="num" id="7531245">0xb8</span><span class="op" id="7531249">,</span>&nbsp;<span class="num" id="7531251">0xd8</span><span class="op" id="7531255">,</span>&nbsp;<span class="num" id="7531257">0x60</span><span class="op" id="7531261">,</span>&nbsp;<span class="num" id="7531263">0xae</span><span class="op" id="7531267">,</span>&nbsp;<span class="num" id="7531269">0x4c</span><span class="op" id="7531273">,</span>&nbsp;<span class="num" id="7531275">0xbd</span><span class="op" id="7531279">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7531284">0x4c</span><span class="op" id="7531288">,</span>&nbsp;<span class="num" id="7531290">0x49</span><span class="op" id="7531294">,</span>&nbsp;<span class="num" id="7531296">0x06</span><span class="op" id="7531300">,</span>&nbsp;<span class="num" id="7531302">0xbb</span><span class="op" id="7531306">,</span>&nbsp;<span class="num" id="7531308">0xc5</span><span class="op" id="7531312">,</span>&nbsp;<span class="num" id="7531314">0x35</span><span class="op" id="7531318">,</span>&nbsp;<span class="num" id="7531320">0xef</span><span class="op" id="7531324">,</span>&nbsp;<span class="num" id="7531326">0xe1</span><span class="op" id="7531330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7531335">0x58</span><span class="op" id="7531339">,</span>&nbsp;<span class="num" id="7531341">0x7f</span><span class="op" id="7531345">,</span>&nbsp;<span class="num" id="7531347">0x08</span><span class="op" id="7531351">,</span>&nbsp;<span class="num" id="7531353">0xdb</span><span class="op" id="7531357">,</span>&nbsp;<span class="num" id="7531359">0x33</span><span class="op" id="7531363">,</span>&nbsp;<span class="num" id="7531365">0x95</span><span class="op" id="7531369">,</span>&nbsp;<span class="num" id="7531371">0x5c</span><span class="op" id="7531375">,</span>&nbsp;<span class="num" id="7531377">0xdb</span><span class="op" id="7531381">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7531386">0xcb</span><span class="op" id="7531390">,</span>&nbsp;<span class="num" id="7531392">0xad</span><span class="op" id="7531396">,</span>&nbsp;<span class="num" id="7531398">0x9b</span><span class="op" id="7531402">,</span>&nbsp;<span class="num" id="7531404">0x10</span><span class="op" id="7531408">,</span>&nbsp;<span class="num" id="7531410">0xf5</span><span class="op" id="7531414">,</span>&nbsp;<span class="num" id="7531416">0x3f</span><span class="op" id="7531420">,</span>&nbsp;<span class="num" id="7531422">0xc4</span><span class="op" id="7531426">,</span>&nbsp;<span class="num" id="7531428">0xe5</span><span class="op" id="7531432">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7531437">0x2c</span><span class="op" id="7531441">,</span>&nbsp;<span class="num" id="7531443">0x59</span><span class="op" id="7531447">,</span>&nbsp;<span class="num" id="7531449">0x15</span><span class="op" id="7531453">,</span>&nbsp;<span class="num" id="7531455">0x65</span><span class="op" id="7531459">,</span>&nbsp;<span class="num" id="7531461">0x51</span><span class="op" id="7531465">,</span>&nbsp;<span class="num" id="7531467">0x84</span><span class="op" id="7531471">,</span>&nbsp;<span class="num" id="7531473">0x87</span><span class="op" id="7531477">,</span>&nbsp;<span class="num" id="7531479">0xfe</span><span class="op" id="7531483">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7531488">0x08</span><span class="op" id="7531492">,</span>&nbsp;<span class="num" id="7531494">0x4d</span><span class="op" id="7531498">,</span>&nbsp;<span class="num" id="7531500">0x0e</span><span class="op" id="7531504">,</span>&nbsp;<span class="num" id="7531506">0x3f</span><span class="op" id="7531510">,</span>&nbsp;<span class="num" id="7531512">0x03</span><span class="op" id="7531516">,</span>&nbsp;<span class="num" id="7531518">0xde</span><span class="op" id="7531522">,</span>&nbsp;<span class="num" id="7531524">0xbc</span><span class="op" id="7531528">,</span>&nbsp;<span class="num" id="7531530">0xc9</span><span class="op" id="7531534">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7531539">0xda</span><span class="op" id="7531543">,</span>&nbsp;<span class="num" id="7531545">0x1c</span><span class="op" id="7531549">,</span>&nbsp;<span class="num" id="7531551">0xe9</span><span class="op" id="7531555">,</span>&nbsp;<span class="num" id="7531557">0x0d</span><span class="op" id="7531561">,</span>&nbsp;<span class="num" id="7531563">0x08</span><span class="op" id="7531567">,</span>&nbsp;<span class="num" id="7531569">0x5c</span><span class="op" id="7531573">,</span>&nbsp;<span class="num" id="7531575">0x2d</span><span class="op" id="7531579">,</span>&nbsp;<span class="num" id="7531581">0x8a</span><span class="op" id="7531585">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7531590">0x19</span><span class="op" id="7531594">,</span>&nbsp;<span class="num" id="7531596">0xd8</span><span class="op" id="7531600">,</span>&nbsp;<span class="num" id="7531602">0x37</span><span class="op" id="7531606">,</span>&nbsp;<span class="num" id="7531608">0x30</span><span class="op" id="7531612">,</span>&nbsp;<span class="num" id="7531614">0x86</span><span class="op" id="7531618">,</span>&nbsp;<span class="num" id="7531620">0x16</span><span class="op" id="7531624">,</span>&nbsp;<span class="num" id="7531626">0x36</span><span class="op" id="7531630">,</span>&nbsp;<span class="num" id="7531632">0x92</span><span class="op" id="7531636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7531641">0x14</span><span class="op" id="7531645">,</span>&nbsp;<span class="num" id="7531647">0x2b</span><span class="op" id="7531651">,</span>&nbsp;<span class="num" id="7531653">0xd8</span><span class="op" id="7531657">,</span>&nbsp;<span class="num" id="7531659">0xfc</span><span class="op" id="7531663">,</span>&nbsp;<span class="num" id="7531665">0x5d</span><span class="op" id="7531669">,</span>&nbsp;<span class="num" id="7531671">0x7a</span><span class="op" id="7531675">,</span>&nbsp;<span class="num" id="7531677">0x73</span><span class="op" id="7531681">,</span>&nbsp;<span class="num" id="7531683">0x49</span><span class="op" id="7531687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7531692">0x6a</span><span class="op" id="7531696">,</span>&nbsp;<span class="num" id="7531698">0x8e</span><span class="op" id="7531702">,</span>&nbsp;<span class="num" id="7531704">0x59</span><span class="op" id="7531708">,</span>&nbsp;<span class="num" id="7531710">0xee</span><span class="op" id="7531714">,</span>&nbsp;<span class="num" id="7531716">0x7e</span><span class="op" id="7531720">,</span>&nbsp;<span class="num" id="7531722">0xcf</span><span class="op" id="7531726">,</span>&nbsp;<span class="num" id="7531728">0x6b</span><span class="op" id="7531732">,</span>&nbsp;<span class="num" id="7531734">0x94</span><span class="op" id="7531738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7531743">0x06</span><span class="op" id="7531747">,</span>&nbsp;<span class="num" id="7531749">0x63</span><span class="op" id="7531753">,</span>&nbsp;<span class="num" id="7531755">0xf4</span><span class="op" id="7531759">,</span>&nbsp;<span class="num" id="7531761">0xa6</span><span class="op" id="7531765">,</span>&nbsp;<span class="num" id="7531767">0xbe</span><span class="op" id="7531771">,</span>&nbsp;<span class="num" id="7531773">0xe6</span><span class="op" id="7531777">,</span>&nbsp;<span class="num" id="7531779">0x5b</span><span class="op" id="7531783">,</span>&nbsp;<span class="num" id="7531785">0xd2</span><span class="op" id="7531789">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7531794">0xc8</span><span class="op" id="7531798">,</span>&nbsp;<span class="num" id="7531800">0x5c</span><span class="op" id="7531804">,</span>&nbsp;<span class="num" id="7531806">0x46</span><span class="op" id="7531810">,</span>&nbsp;<span class="num" id="7531812">0x98</span><span class="op" id="7531816">,</span>&nbsp;<span class="num" id="7531818">0x6c</span><span class="op" id="7531822">,</span>&nbsp;<span class="num" id="7531824">0x1b</span><span class="op" id="7531828">,</span>&nbsp;<span class="num" id="7531830">0xef</span><span class="op" id="7531834">,</span>&nbsp;<span class="num" id="7531836">0x34</span><span class="op" id="7531840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7531845">0x90</span><span class="op" id="7531849">,</span>&nbsp;<span class="num" id="7531851">0xd3</span><span class="op" id="7531855">,</span>&nbsp;<span class="num" id="7531857">0x7b</span><span class="op" id="7531861">,</span>&nbsp;<span class="num" id="7531863">0x38</span><span class="op" id="7531867">,</span>&nbsp;<span class="num" id="7531869">0xda</span><span class="op" id="7531873">,</span>&nbsp;<span class="num" id="7531875">0x85</span><span class="op" id="7531879">,</span>&nbsp;<span class="num" id="7531881">0xd3</span><span class="op" id="7531885">,</span>&nbsp;<span class="num" id="7531887">0x2e</span><span class="op" id="7531891">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7531896">0x97</span><span class="op" id="7531900">,</span>&nbsp;<span class="num" id="7531902">0x39</span><span class="op" id="7531906">,</span>&nbsp;<span class="num" id="7531908">0xcb</span><span class="op" id="7531912">,</span>&nbsp;<span class="num" id="7531914">0x23</span><span class="op" id="7531918">,</span>&nbsp;<span class="num" id="7531920">0x4a</span><span class="op" id="7531924">,</span>&nbsp;<span class="num" id="7531926">0x2b</span><span class="op" id="7531930">,</span>&nbsp;<span class="num" id="7531932">0xe7</span><span class="op" id="7531936">,</span>&nbsp;<span class="num" id="7531938">0x40</span><span class="op" id="7531942">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7531946">}</span><span class="op" id="7531947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7531950">}</span><span class="op" id="7531951">,</span><br>
<span class="lineno">75</span><span class="op" id="7531953">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7531956">func</span>&nbsp;<span class="ident" id="7531961">testEncrypt</span><span class="op" id="7531972">(</span><span class="ident" id="7531973">t</span>&nbsp;<span class="op" id="7531975">*</span><span class="ident" id="7531976"><a href="/crypto/rc4/rc4_test.go.html#7529598">testing</a></span><span class="op" id="7531983">.</span><span class="ident" id="7531984">T</span><span class="op" id="7531985">,</span>&nbsp;<span class="ident" id="7531987">desc</span>&nbsp;<span class="builtintype" id="7531992">string</span><span class="op" id="7531998">,</span>&nbsp;<span class="ident" id="7532000">c</span>&nbsp;<span class="op" id="7532002">*</span><span class="ident" id="7532003"><a href="/crypto/rc4/rc4.go.html#4273239">Cipher</a></span><span class="op" id="7532009">,</span>&nbsp;<span class="ident" id="7532011">src</span><span class="op" id="7532014">,</span>&nbsp;<span class="ident" id="7532016">expect</span>&nbsp;<span class="op" id="7532023">[</span><span class="op" id="7532024">]</span><span class="builtintype" id="7532025">byte</span><span class="op" id="7532029">)</span>&nbsp;<span class="op" id="7532031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532034">dst</span>&nbsp;<span class="op" id="7532038">:=</span>&nbsp;<span class="builtinfunc" id="7532041">make</span><span class="op" id="7532045">(</span><span class="op" id="7532046">[</span><span class="op" id="7532047">]</span><span class="builtintype" id="7532048">byte</span><span class="op" id="7532052">,</span>&nbsp;<span class="builtinfunc" id="7532054">len</span><span class="op" id="7532057">(</span><span class="ident" id="7532058"><a href="/crypto/rc4/rc4_test.go.html#7532011">src</a></span><span class="op" id="7532061">)</span><span class="op" id="7532062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532065"><a href="/crypto/rc4/rc4_test.go.html#7532000">c</a></span><span class="op" id="7532066">.</span><span class="ident" id="7532067">XORKeyStream</span><span class="op" id="7532079">(</span><span class="ident" id="7532080"><a href="/crypto/rc4/rc4_test.go.html#7532034">dst</a></span><span class="op" id="7532083">,</span>&nbsp;<span class="ident" id="7532085"><a href="/crypto/rc4/rc4_test.go.html#7532011">src</a></span><span class="op" id="7532088">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7532091">for</span>&nbsp;<span class="ident" id="7532095">i</span><span class="op" id="7532096">,</span>&nbsp;<span class="ident" id="7532098">v</span>&nbsp;<span class="op" id="7532100">:=</span>&nbsp;<span class="keyword" id="7532103">range</span>&nbsp;<span class="ident" id="7532109"><a href="/crypto/rc4/rc4_test.go.html#7532034">dst</a></span>&nbsp;<span class="op" id="7532113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7532117">if</span>&nbsp;<span class="ident" id="7532120"><a href="/crypto/rc4/rc4_test.go.html#7532098">v</a></span>&nbsp;<span class="op" id="7532122">!=</span>&nbsp;<span class="ident" id="7532125"><a href="/crypto/rc4/rc4_test.go.html#7532016">expect</a></span><span class="op" id="7532131">[</span><span class="ident" id="7532132"><a href="/crypto/rc4/rc4_test.go.html#7532095">i</a></span><span class="op" id="7532133">]</span>&nbsp;<span class="op" id="7532135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532140"><a href="/crypto/rc4/rc4_test.go.html#7531973">t</a></span><span class="op" id="7532141">.</span><span class="ident" id="7532142">Fatalf</span><span class="op" id="7532148">(</span><span class="string" id="7532149">&#34;%s:&nbsp;mismatch&nbsp;at&nbsp;byte&nbsp;%d:\nhave&nbsp;%x\nwant&nbsp;%x&#34;</span><span class="op" id="7532193">,</span>&nbsp;<span class="ident" id="7532195"><a href="/crypto/rc4/rc4_test.go.html#7531987">desc</a></span><span class="op" id="7532199">,</span>&nbsp;<span class="ident" id="7532201"><a href="/crypto/rc4/rc4_test.go.html#7532095">i</a></span><span class="op" id="7532202">,</span>&nbsp;<span class="ident" id="7532204"><a href="/crypto/rc4/rc4_test.go.html#7532034">dst</a></span><span class="op" id="7532207">,</span>&nbsp;<span class="ident" id="7532209"><a href="/crypto/rc4/rc4_test.go.html#7532016">expect</a></span><span class="op" id="7532215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532222">}</span><br>
<span class="lineno">85</span><span class="op" id="7532224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7532227">func</span>&nbsp;<span class="ident" id="7532232">TestGolden</span><span class="op" id="7532242">(</span><span class="ident" id="7532243">t</span>&nbsp;<span class="op" id="7532245">*</span><span class="ident" id="7532246"><a href="/crypto/rc4/rc4_test.go.html#7529598">testing</a></span><span class="op" id="7532253">.</span><span class="ident" id="7532254">T</span><span class="op" id="7532255">)</span>&nbsp;<span class="op" id="7532257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7532260">for</span>&nbsp;<span class="ident" id="7532264">gi</span><span class="op" id="7532266">,</span>&nbsp;<span class="ident" id="7532268">g</span>&nbsp;<span class="op" id="7532270">:=</span>&nbsp;<span class="keyword" id="7532273">range</span>&nbsp;<span class="ident" id="7532279"><a href="/crypto/rc4/rc4_test.go.html#7529663">golden</a></span>&nbsp;<span class="op" id="7532286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532290">data</span>&nbsp;<span class="op" id="7532295">:=</span>&nbsp;<span class="builtinfunc" id="7532298">make</span><span class="op" id="7532302">(</span><span class="op" id="7532303">[</span><span class="op" id="7532304">]</span><span class="builtintype" id="7532305">byte</span><span class="op" id="7532309">,</span>&nbsp;<span class="builtinfunc" id="7532311">len</span><span class="op" id="7532314">(</span><span class="ident" id="7532315"><a href="/crypto/rc4/rc4_test.go.html#7532268">g</a></span><span class="op" id="7532316">.</span><span class="ident" id="7532317">keystream</span><span class="op" id="7532326">)</span><span class="op" id="7532327">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7532331">for</span>&nbsp;<span class="ident" id="7532335">i</span>&nbsp;<span class="op" id="7532337">:=</span>&nbsp;<span class="keyword" id="7532340">range</span>&nbsp;<span class="ident" id="7532346"><a href="/crypto/rc4/rc4_test.go.html#7532290">data</a></span>&nbsp;<span class="op" id="7532351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532356"><a href="/crypto/rc4/rc4_test.go.html#7532290">data</a></span><span class="op" id="7532360">[</span><span class="ident" id="7532361"><a href="/crypto/rc4/rc4_test.go.html#7532335">i</a></span><span class="op" id="7532362">]</span>&nbsp;<span class="op" id="7532364">=</span>&nbsp;<span class="builtintype" id="7532366">byte</span><span class="op" id="7532370">(</span><span class="ident" id="7532371"><a href="/crypto/rc4/rc4_test.go.html#7532335">i</a></span><span class="op" id="7532372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532381">expect</span>&nbsp;<span class="op" id="7532388">:=</span>&nbsp;<span class="builtinfunc" id="7532391">make</span><span class="op" id="7532395">(</span><span class="op" id="7532396">[</span><span class="op" id="7532397">]</span><span class="builtintype" id="7532398">byte</span><span class="op" id="7532402">,</span>&nbsp;<span class="builtinfunc" id="7532404">len</span><span class="op" id="7532407">(</span><span class="ident" id="7532408"><a href="/crypto/rc4/rc4_test.go.html#7532268">g</a></span><span class="op" id="7532409">.</span><span class="ident" id="7532410">keystream</span><span class="op" id="7532419">)</span><span class="op" id="7532420">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7532424">for</span>&nbsp;<span class="ident" id="7532428">i</span>&nbsp;<span class="op" id="7532430">:=</span>&nbsp;<span class="keyword" id="7532433">range</span>&nbsp;<span class="ident" id="7532439"><a href="/crypto/rc4/rc4_test.go.html#7532381">expect</a></span>&nbsp;<span class="op" id="7532446">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532451"><a href="/crypto/rc4/rc4_test.go.html#7532381">expect</a></span><span class="op" id="7532457">[</span><span class="ident" id="7532458"><a href="/crypto/rc4/rc4_test.go.html#7532428">i</a></span><span class="op" id="7532459">]</span>&nbsp;<span class="op" id="7532461">=</span>&nbsp;<span class="builtintype" id="7532463">byte</span><span class="op" id="7532467">(</span><span class="ident" id="7532468"><a href="/crypto/rc4/rc4_test.go.html#7532428">i</a></span><span class="op" id="7532469">)</span>&nbsp;<span class="op" id="7532471">^</span>&nbsp;<span class="ident" id="7532473"><a href="/crypto/rc4/rc4_test.go.html#7532268">g</a></span><span class="op" id="7532474">.</span><span class="ident" id="7532475">keystream</span><span class="op" id="7532484">[</span><span class="ident" id="7532485"><a href="/crypto/rc4/rc4_test.go.html#7532428">i</a></span><span class="op" id="7532486">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7532495">for</span>&nbsp;<span class="ident" id="7532499">size</span>&nbsp;<span class="op" id="7532504">:=</span>&nbsp;<span class="num" id="7532507">1</span><span class="op" id="7532508">;</span>&nbsp;<span class="ident" id="7532510"><a href="/crypto/rc4/rc4_test.go.html#7532499">size</a></span>&nbsp;<span class="op" id="7532515">&lt;=</span>&nbsp;<span class="builtinfunc" id="7532518">len</span><span class="op" id="7532521">(</span><span class="ident" id="7532522"><a href="/crypto/rc4/rc4_test.go.html#7532268">g</a></span><span class="op" id="7532523">.</span><span class="ident" id="7532524">keystream</span><span class="op" id="7532533">)</span><span class="op" id="7532534">;</span>&nbsp;<span class="ident" id="7532536"><a href="/crypto/rc4/rc4_test.go.html#7532499">size</a></span><span class="op" id="7532540">++</span>&nbsp;<span class="op" id="7532543">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532548">c</span><span class="op" id="7532549">,</span>&nbsp;<span class="ident" id="7532551">err</span>&nbsp;<span class="op" id="7532555">:=</span>&nbsp;<span class="ident" id="7532558"><a href="/crypto/rc4/rc4.go.html#4273551">NewCipher</a></span><span class="op" id="7532567">(</span><span class="ident" id="7532568"><a href="/crypto/rc4/rc4_test.go.html#7532268">g</a></span><span class="op" id="7532569">.</span><span class="ident" id="7532570">key</span><span class="op" id="7532573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7532578">if</span>&nbsp;<span class="ident" id="7532581"><a href="/crypto/rc4/rc4_test.go.html#7532551">err</a></span>&nbsp;<span class="op" id="7532585">!=</span>&nbsp;<span class="ident" id="7532588">nil</span>&nbsp;<span class="op" id="7532592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532598"><a href="/crypto/rc4/rc4_test.go.html#7532243">t</a></span><span class="op" id="7532599">.</span><span class="ident" id="7532600">Fatalf</span><span class="op" id="7532606">(</span><span class="string" id="7532607">&#34;#%d:&nbsp;NewCipher:&nbsp;%v&#34;</span><span class="op" id="7532627">,</span>&nbsp;<span class="ident" id="7532629"><a href="/crypto/rc4/rc4_test.go.html#7532264">gi</a></span><span class="op" id="7532631">,</span>&nbsp;<span class="ident" id="7532633"><a href="/crypto/rc4/rc4_test.go.html#7532551">err</a></span><span class="op" id="7532636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532641">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532647">off</span>&nbsp;<span class="op" id="7532651">:=</span>&nbsp;<span class="num" id="7532654">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7532659">for</span>&nbsp;<span class="ident" id="7532663"><a href="/crypto/rc4/rc4_test.go.html#7532647">off</a></span>&nbsp;<span class="op" id="7532667">&lt;</span>&nbsp;<span class="builtinfunc" id="7532669">len</span><span class="op" id="7532672">(</span><span class="ident" id="7532673"><a href="/crypto/rc4/rc4_test.go.html#7532268">g</a></span><span class="op" id="7532674">.</span><span class="ident" id="7532675">keystream</span><span class="op" id="7532684">)</span>&nbsp;<span class="op" id="7532686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532692">n</span>&nbsp;<span class="op" id="7532694">:=</span>&nbsp;<span class="builtinfunc" id="7532697">len</span><span class="op" id="7532700">(</span><span class="ident" id="7532701"><a href="/crypto/rc4/rc4_test.go.html#7532268">g</a></span><span class="op" id="7532702">.</span><span class="ident" id="7532703">keystream</span><span class="op" id="7532712">)</span>&nbsp;<span class="op" id="7532714">-</span>&nbsp;<span class="ident" id="7532716"><a href="/crypto/rc4/rc4_test.go.html#7532647">off</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7532724">if</span>&nbsp;<span class="ident" id="7532727"><a href="/crypto/rc4/rc4_test.go.html#7532692">n</a></span>&nbsp;<span class="op" id="7532729">&gt;</span>&nbsp;<span class="ident" id="7532731"><a href="/crypto/rc4/rc4_test.go.html#7532499">size</a></span>&nbsp;<span class="op" id="7532736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532743"><a href="/crypto/rc4/rc4_test.go.html#7532692">n</a></span>&nbsp;<span class="op" id="7532745">=</span>&nbsp;<span class="ident" id="7532747"><a href="/crypto/rc4/rc4_test.go.html#7532499">size</a></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532762">desc</span>&nbsp;<span class="op" id="7532767">:=</span>&nbsp;<span class="ident" id="7532770"><a href="/crypto/rc4/rc4_test.go.html#7529591">fmt</a></span><span class="op" id="7532773">.</span><span class="ident" id="7532774">Sprintf</span><span class="op" id="7532781">(</span><span class="string" id="7532782">&#34;#%d@[%d:%d]&#34;</span><span class="op" id="7532795">,</span>&nbsp;<span class="ident" id="7532797"><a href="/crypto/rc4/rc4_test.go.html#7532264">gi</a></span><span class="op" id="7532799">,</span>&nbsp;<span class="ident" id="7532801"><a href="/crypto/rc4/rc4_test.go.html#7532647">off</a></span><span class="op" id="7532804">,</span>&nbsp;<span class="ident" id="7532806"><a href="/crypto/rc4/rc4_test.go.html#7532647">off</a></span><span class="op" id="7532809">+</span><span class="ident" id="7532810"><a href="/crypto/rc4/rc4_test.go.html#7532692">n</a></span><span class="op" id="7532811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532817"><a href="/crypto/rc4/rc4_test.go.html#7531961">testEncrypt</a></span><span class="op" id="7532828">(</span><span class="ident" id="7532829"><a href="/crypto/rc4/rc4_test.go.html#7532243">t</a></span><span class="op" id="7532830">,</span>&nbsp;<span class="ident" id="7532832"><a href="/crypto/rc4/rc4_test.go.html#7532762">desc</a></span><span class="op" id="7532836">,</span>&nbsp;<span class="ident" id="7532838"><a href="/crypto/rc4/rc4_test.go.html#7532548">c</a></span><span class="op" id="7532839">,</span>&nbsp;<span class="ident" id="7532841"><a href="/crypto/rc4/rc4_test.go.html#7532290">data</a></span><span class="op" id="7532845">[</span><span class="ident" id="7532846"><a href="/crypto/rc4/rc4_test.go.html#7532647">off</a></span><span class="op" id="7532849">:</span><span class="ident" id="7532850"><a href="/crypto/rc4/rc4_test.go.html#7532647">off</a></span><span class="op" id="7532853">+</span><span class="ident" id="7532854"><a href="/crypto/rc4/rc4_test.go.html#7532692">n</a></span><span class="op" id="7532855">]</span><span class="op" id="7532856">,</span>&nbsp;<span class="ident" id="7532858"><a href="/crypto/rc4/rc4_test.go.html#7532381">expect</a></span><span class="op" id="7532864">[</span><span class="ident" id="7532865"><a href="/crypto/rc4/rc4_test.go.html#7532647">off</a></span><span class="op" id="7532868">:</span><span class="ident" id="7532869"><a href="/crypto/rc4/rc4_test.go.html#7532647">off</a></span><span class="op" id="7532872">+</span><span class="ident" id="7532873"><a href="/crypto/rc4/rc4_test.go.html#7532692">n</a></span><span class="op" id="7532874">]</span><span class="op" id="7532875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532881"><a href="/crypto/rc4/rc4_test.go.html#7532647">off</a></span>&nbsp;<span class="op" id="7532885">+=</span>&nbsp;<span class="ident" id="7532888"><a href="/crypto/rc4/rc4_test.go.html#7532692">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532893">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7532900">}</span><br>
<span class="lineno"></span><span class="op" id="7532902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7532905">func</span>&nbsp;<span class="ident" id="7532910">TestBlock</span><span class="op" id="7532919">(</span><span class="ident" id="7532920">t</span>&nbsp;<span class="op" id="7532922">*</span><span class="ident" id="7532923"><a href="/crypto/rc4/rc4_test.go.html#7529598">testing</a></span><span class="op" id="7532930">.</span><span class="ident" id="7532931">T</span><span class="op" id="7532932">)</span>&nbsp;<span class="op" id="7532934">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7532937"><a href="/crypto/rc4/rc4_test.go.html#7533208">testBlock</a></span><span class="op" id="7532946">(</span><span class="ident" id="7532947"><a href="/crypto/rc4/rc4_test.go.html#7532920">t</a></span><span class="op" id="7532948">,</span>&nbsp;<span class="op" id="7532950">(</span><span class="op" id="7532951">*</span><span class="ident" id="7532952"><a href="/crypto/rc4/rc4.go.html#4273239">Cipher</a></span><span class="op" id="7532958">)</span><span class="op" id="7532959">.</span><span class="ident" id="7532960">XORKeyStream</span><span class="op" id="7532972">)</span><br>
<span class="lineno"></span><span class="op" id="7532974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7532977">//&nbsp;Test&nbsp;the&nbsp;pure&nbsp;Go&nbsp;version.</span><br>
<span class="lineno"></span><span class="comment" id="7533006">//&nbsp;Because&nbsp;we&nbsp;have&nbsp;assembly&nbsp;for&nbsp;amd64,&nbsp;386,&nbsp;and&nbsp;arm,&nbsp;this&nbsp;prevents</span><br>
<span class="lineno">125</span><span class="comment" id="7533073">//&nbsp;bitrot&nbsp;of&nbsp;the&nbsp;reference&nbsp;implementations.</span><br>
<span class="lineno"></span><span class="keyword" id="7533117">func</span>&nbsp;<span class="ident" id="7533122">TestBlockGeneric</span><span class="op" id="7533138">(</span><span class="ident" id="7533139">t</span>&nbsp;<span class="op" id="7533141">*</span><span class="ident" id="7533142"><a href="/crypto/rc4/rc4_test.go.html#7529598">testing</a></span><span class="op" id="7533149">.</span><span class="ident" id="7533150">T</span><span class="op" id="7533151">)</span>&nbsp;<span class="op" id="7533153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533156"><a href="/crypto/rc4/rc4_test.go.html#7533208">testBlock</a></span><span class="op" id="7533165">(</span><span class="ident" id="7533166"><a href="/crypto/rc4/rc4_test.go.html#7533139">t</a></span><span class="op" id="7533167">,</span>&nbsp;<span class="op" id="7533169">(</span><span class="op" id="7533170">*</span><span class="ident" id="7533171"><a href="/crypto/rc4/rc4.go.html#4273239">Cipher</a></span><span class="op" id="7533177">)</span><span class="op" id="7533178">.</span><span class="ident" id="7533179">xorKeyStreamGeneric</span><span class="op" id="7533198">)</span><br>
<span class="lineno"></span><span class="op" id="7533200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="7533203">func</span>&nbsp;<span class="ident" id="7533208">testBlock</span><span class="op" id="7533217">(</span><span class="ident" id="7533218">t</span>&nbsp;<span class="op" id="7533220">*</span><span class="ident" id="7533221"><a href="/crypto/rc4/rc4_test.go.html#7529598">testing</a></span><span class="op" id="7533228">.</span><span class="ident" id="7533229">T</span><span class="op" id="7533230">,</span>&nbsp;<span class="ident" id="7533232">xor</span>&nbsp;<span class="keyword" id="7533236">func</span><span class="op" id="7533240">(</span><span class="ident" id="7533241">c</span>&nbsp;<span class="op" id="7533243">*</span><span class="ident" id="7533244"><a href="/crypto/rc4/rc4.go.html#4273239">Cipher</a></span><span class="op" id="7533250">,</span>&nbsp;<span class="ident" id="7533252">dst</span><span class="op" id="7533255">,</span>&nbsp;<span class="ident" id="7533257">src</span>&nbsp;<span class="op" id="7533261">[</span><span class="op" id="7533262">]</span><span class="builtintype" id="7533263">byte</span><span class="op" id="7533267">)</span><span class="op" id="7533268">)</span>&nbsp;<span class="op" id="7533270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533273">c1a</span><span class="op" id="7533276">,</span>&nbsp;<span class="ident" id="7533278">_</span>&nbsp;<span class="op" id="7533280">:=</span>&nbsp;<span class="ident" id="7533283"><a href="/crypto/rc4/rc4.go.html#4273551">NewCipher</a></span><span class="op" id="7533292">(</span><span class="ident" id="7533293"><a href="/crypto/rc4/rc4_test.go.html#7529663">golden</a></span><span class="op" id="7533299">[</span><span class="num" id="7533300">0</span><span class="op" id="7533301">]</span><span class="op" id="7533302">.</span><span class="ident" id="7533303">key</span><span class="op" id="7533306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533309">c1b</span><span class="op" id="7533312">,</span>&nbsp;<span class="ident" id="7533314">_</span>&nbsp;<span class="op" id="7533316">:=</span>&nbsp;<span class="ident" id="7533319"><a href="/crypto/rc4/rc4.go.html#4273551">NewCipher</a></span><span class="op" id="7533328">(</span><span class="ident" id="7533329"><a href="/crypto/rc4/rc4_test.go.html#7529663">golden</a></span><span class="op" id="7533335">[</span><span class="num" id="7533336">1</span><span class="op" id="7533337">]</span><span class="op" id="7533338">.</span><span class="ident" id="7533339">key</span><span class="op" id="7533342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533345">data1</span>&nbsp;<span class="op" id="7533351">:=</span>&nbsp;<span class="builtinfunc" id="7533354">make</span><span class="op" id="7533358">(</span><span class="op" id="7533359">[</span><span class="op" id="7533360">]</span><span class="builtintype" id="7533361">byte</span><span class="op" id="7533365">,</span>&nbsp;<span class="num" id="7533367">1</span><span class="op" id="7533368">&lt;&lt;</span><span class="num" id="7533370">20</span><span class="op" id="7533372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7533375">for</span>&nbsp;<span class="ident" id="7533379">i</span>&nbsp;<span class="op" id="7533381">:=</span>&nbsp;<span class="keyword" id="7533384">range</span>&nbsp;<span class="ident" id="7533390"><a href="/crypto/rc4/rc4_test.go.html#7533345">data1</a></span>&nbsp;<span class="op" id="7533396">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533400"><a href="/crypto/rc4/rc4_test.go.html#7533232">xor</a></span><span class="op" id="7533403">(</span><span class="ident" id="7533404"><a href="/crypto/rc4/rc4_test.go.html#7533273">c1a</a></span><span class="op" id="7533407">,</span>&nbsp;<span class="ident" id="7533409"><a href="/crypto/rc4/rc4_test.go.html#7533345">data1</a></span><span class="op" id="7533414">[</span><span class="ident" id="7533415"><a href="/crypto/rc4/rc4_test.go.html#7533379">i</a></span><span class="op" id="7533416">:</span><span class="ident" id="7533417"><a href="/crypto/rc4/rc4_test.go.html#7533379">i</a></span><span class="op" id="7533418">+</span><span class="num" id="7533419">1</span><span class="op" id="7533420">]</span><span class="op" id="7533421">,</span>&nbsp;<span class="ident" id="7533423"><a href="/crypto/rc4/rc4_test.go.html#7533345">data1</a></span><span class="op" id="7533428">[</span><span class="ident" id="7533429"><a href="/crypto/rc4/rc4_test.go.html#7533379">i</a></span><span class="op" id="7533430">:</span><span class="ident" id="7533431"><a href="/crypto/rc4/rc4_test.go.html#7533379">i</a></span><span class="op" id="7533432">+</span><span class="num" id="7533433">1</span><span class="op" id="7533434">]</span><span class="op" id="7533435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533439"><a href="/crypto/rc4/rc4_test.go.html#7533232">xor</a></span><span class="op" id="7533442">(</span><span class="ident" id="7533443"><a href="/crypto/rc4/rc4_test.go.html#7533309">c1b</a></span><span class="op" id="7533446">,</span>&nbsp;<span class="ident" id="7533448"><a href="/crypto/rc4/rc4_test.go.html#7533345">data1</a></span><span class="op" id="7533453">[</span><span class="ident" id="7533454"><a href="/crypto/rc4/rc4_test.go.html#7533379">i</a></span><span class="op" id="7533455">:</span><span class="ident" id="7533456"><a href="/crypto/rc4/rc4_test.go.html#7533379">i</a></span><span class="op" id="7533457">+</span><span class="num" id="7533458">1</span><span class="op" id="7533459">]</span><span class="op" id="7533460">,</span>&nbsp;<span class="ident" id="7533462"><a href="/crypto/rc4/rc4_test.go.html#7533345">data1</a></span><span class="op" id="7533467">[</span><span class="ident" id="7533468"><a href="/crypto/rc4/rc4_test.go.html#7533379">i</a></span><span class="op" id="7533469">:</span><span class="ident" id="7533470"><a href="/crypto/rc4/rc4_test.go.html#7533379">i</a></span><span class="op" id="7533471">+</span><span class="num" id="7533472">1</span><span class="op" id="7533473">]</span><span class="op" id="7533474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7533477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533481">c2a</span><span class="op" id="7533484">,</span>&nbsp;<span class="ident" id="7533486">_</span>&nbsp;<span class="op" id="7533488">:=</span>&nbsp;<span class="ident" id="7533491"><a href="/crypto/rc4/rc4.go.html#4273551">NewCipher</a></span><span class="op" id="7533500">(</span><span class="ident" id="7533501"><a href="/crypto/rc4/rc4_test.go.html#7529663">golden</a></span><span class="op" id="7533507">[</span><span class="num" id="7533508">0</span><span class="op" id="7533509">]</span><span class="op" id="7533510">.</span><span class="ident" id="7533511">key</span><span class="op" id="7533514">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533517">c2b</span><span class="op" id="7533520">,</span>&nbsp;<span class="ident" id="7533522">_</span>&nbsp;<span class="op" id="7533524">:=</span>&nbsp;<span class="ident" id="7533527"><a href="/crypto/rc4/rc4.go.html#4273551">NewCipher</a></span><span class="op" id="7533536">(</span><span class="ident" id="7533537"><a href="/crypto/rc4/rc4_test.go.html#7529663">golden</a></span><span class="op" id="7533543">[</span><span class="num" id="7533544">1</span><span class="op" id="7533545">]</span><span class="op" id="7533546">.</span><span class="ident" id="7533547">key</span><span class="op" id="7533550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533553">data2</span>&nbsp;<span class="op" id="7533559">:=</span>&nbsp;<span class="builtinfunc" id="7533562">make</span><span class="op" id="7533566">(</span><span class="op" id="7533567">[</span><span class="op" id="7533568">]</span><span class="builtintype" id="7533569">byte</span><span class="op" id="7533573">,</span>&nbsp;<span class="num" id="7533575">1</span><span class="op" id="7533576">&lt;&lt;</span><span class="num" id="7533578">20</span><span class="op" id="7533580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533583"><a href="/crypto/rc4/rc4_test.go.html#7533232">xor</a></span><span class="op" id="7533586">(</span><span class="ident" id="7533587"><a href="/crypto/rc4/rc4_test.go.html#7533481">c2a</a></span><span class="op" id="7533590">,</span>&nbsp;<span class="ident" id="7533592"><a href="/crypto/rc4/rc4_test.go.html#7533553">data2</a></span><span class="op" id="7533597">,</span>&nbsp;<span class="ident" id="7533599"><a href="/crypto/rc4/rc4_test.go.html#7533553">data2</a></span><span class="op" id="7533604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533607"><a href="/crypto/rc4/rc4_test.go.html#7533232">xor</a></span><span class="op" id="7533610">(</span><span class="ident" id="7533611"><a href="/crypto/rc4/rc4_test.go.html#7533517">c2b</a></span><span class="op" id="7533614">,</span>&nbsp;<span class="ident" id="7533616"><a href="/crypto/rc4/rc4_test.go.html#7533553">data2</a></span><span class="op" id="7533621">,</span>&nbsp;<span class="ident" id="7533623"><a href="/crypto/rc4/rc4_test.go.html#7533553">data2</a></span><span class="op" id="7533628">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7533632">if</span>&nbsp;<span class="op" id="7533635">!</span><span class="ident" id="7533636"><a href="/crypto/rc4/rc4_test.go.html#7529582">bytes</a></span><span class="op" id="7533641">.</span><span class="ident" id="7533642">Equal</span><span class="op" id="7533647">(</span><span class="ident" id="7533648"><a href="/crypto/rc4/rc4_test.go.html#7533345">data1</a></span><span class="op" id="7533653">,</span>&nbsp;<span class="ident" id="7533655"><a href="/crypto/rc4/rc4_test.go.html#7533553">data2</a></span><span class="op" id="7533660">)</span>&nbsp;<span class="op" id="7533662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533666"><a href="/crypto/rc4/rc4_test.go.html#7533218">t</a></span><span class="op" id="7533667">.</span><span class="ident" id="7533668">Fatalf</span><span class="op" id="7533674">(</span><span class="string" id="7533675">&#34;bad&nbsp;block&#34;</span><span class="op" id="7533686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7533689">}</span><br>
<span class="lineno"></span><span class="op" id="7533691">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="7533694">func</span>&nbsp;<span class="ident" id="7533699">benchmark</span><span class="op" id="7533708">(</span><span class="ident" id="7533709">b</span>&nbsp;<span class="op" id="7533711">*</span><span class="ident" id="7533712"><a href="/crypto/rc4/rc4_test.go.html#7529598">testing</a></span><span class="op" id="7533719">.</span><span class="ident" id="7533720">B</span><span class="op" id="7533721">,</span>&nbsp;<span class="ident" id="7533723">size</span>&nbsp;<span class="ident" id="7533728">int64</span><span class="op" id="7533733">)</span>&nbsp;<span class="op" id="7533735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533738">buf</span>&nbsp;<span class="op" id="7533742">:=</span>&nbsp;<span class="builtinfunc" id="7533745">make</span><span class="op" id="7533749">(</span><span class="op" id="7533750">[</span><span class="op" id="7533751">]</span><span class="builtintype" id="7533752">byte</span><span class="op" id="7533756">,</span>&nbsp;<span class="ident" id="7533758"><a href="/crypto/rc4/rc4_test.go.html#7533723">size</a></span><span class="op" id="7533762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533765">c</span><span class="op" id="7533766">,</span>&nbsp;<span class="ident" id="7533768">err</span>&nbsp;<span class="op" id="7533772">:=</span>&nbsp;<span class="ident" id="7533775"><a href="/crypto/rc4/rc4.go.html#4273551">NewCipher</a></span><span class="op" id="7533784">(</span><span class="ident" id="7533785"><a href="/crypto/rc4/rc4_test.go.html#7529663">golden</a></span><span class="op" id="7533791">[</span><span class="num" id="7533792">0</span><span class="op" id="7533793">]</span><span class="op" id="7533794">.</span><span class="ident" id="7533795">key</span><span class="op" id="7533798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7533801">if</span>&nbsp;<span class="ident" id="7533804"><a href="/crypto/rc4/rc4_test.go.html#7533768">err</a></span>&nbsp;<span class="op" id="7533808">!=</span>&nbsp;<span class="ident" id="7533811">nil</span>&nbsp;<span class="op" id="7533815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7533819">panic</span><span class="op" id="7533824">(</span><span class="ident" id="7533825"><a href="/crypto/rc4/rc4_test.go.html#7533768">err</a></span><span class="op" id="7533828">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7533831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533834"><a href="/crypto/rc4/rc4_test.go.html#7533709">b</a></span><span class="op" id="7533835">.</span><span class="ident" id="7533836">SetBytes</span><span class="op" id="7533844">(</span><span class="ident" id="7533845"><a href="/crypto/rc4/rc4_test.go.html#7533723">size</a></span><span class="op" id="7533849">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7533853">for</span>&nbsp;<span class="ident" id="7533857">i</span>&nbsp;<span class="op" id="7533859">:=</span>&nbsp;<span class="num" id="7533862">0</span><span class="op" id="7533863">;</span>&nbsp;<span class="ident" id="7533865"><a href="/crypto/rc4/rc4_test.go.html#7533857">i</a></span>&nbsp;<span class="op" id="7533867">&lt;</span>&nbsp;<span class="ident" id="7533869"><a href="/crypto/rc4/rc4_test.go.html#7533709">b</a></span><span class="op" id="7533870">.</span><span class="ident" id="7533871">N</span><span class="op" id="7533872">;</span>&nbsp;<span class="ident" id="7533874"><a href="/crypto/rc4/rc4_test.go.html#7533857">i</a></span><span class="op" id="7533875">++</span>&nbsp;<span class="op" id="7533878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533882"><a href="/crypto/rc4/rc4_test.go.html#7533765">c</a></span><span class="op" id="7533883">.</span><span class="ident" id="7533884">XORKeyStream</span><span class="op" id="7533896">(</span><span class="ident" id="7533897"><a href="/crypto/rc4/rc4_test.go.html#7533738">buf</a></span><span class="op" id="7533900">,</span>&nbsp;<span class="ident" id="7533902"><a href="/crypto/rc4/rc4_test.go.html#7533738">buf</a></span><span class="op" id="7533905">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7533908">}</span><br>
<span class="lineno"></span><span class="op" id="7533910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7533913">func</span>&nbsp;<span class="ident" id="7533918">BenchmarkRC4_128</span><span class="op" id="7533934">(</span><span class="ident" id="7533935">b</span>&nbsp;<span class="op" id="7533937">*</span><span class="ident" id="7533938"><a href="/crypto/rc4/rc4_test.go.html#7529598">testing</a></span><span class="op" id="7533945">.</span><span class="ident" id="7533946">B</span><span class="op" id="7533947">)</span>&nbsp;<span class="op" id="7533949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7533952"><a href="/crypto/rc4/rc4_test.go.html#7533699">benchmark</a></span><span class="op" id="7533961">(</span><span class="ident" id="7533962"><a href="/crypto/rc4/rc4_test.go.html#7533935">b</a></span><span class="op" id="7533963">,</span>&nbsp;<span class="num" id="7533965">128</span><span class="op" id="7533968">)</span><br>
<span class="lineno">165</span><span class="op" id="7533970">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7533973">func</span>&nbsp;<span class="ident" id="7533978">BenchmarkRC4_1K</span><span class="op" id="7533993">(</span><span class="ident" id="7533994">b</span>&nbsp;<span class="op" id="7533996">*</span><span class="ident" id="7533997"><a href="/crypto/rc4/rc4_test.go.html#7529598">testing</a></span><span class="op" id="7534004">.</span><span class="ident" id="7534005">B</span><span class="op" id="7534006">)</span>&nbsp;<span class="op" id="7534008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7534011"><a href="/crypto/rc4/rc4_test.go.html#7533699">benchmark</a></span><span class="op" id="7534020">(</span><span class="ident" id="7534021"><a href="/crypto/rc4/rc4_test.go.html#7533994">b</a></span><span class="op" id="7534022">,</span>&nbsp;<span class="num" id="7534024">1024</span><span class="op" id="7534028">)</span><br>
<span class="lineno"></span><span class="op" id="7534030">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="7534033">func</span>&nbsp;<span class="ident" id="7534038">BenchmarkRC4_8K</span><span class="op" id="7534053">(</span><span class="ident" id="7534054">b</span>&nbsp;<span class="op" id="7534056">*</span><span class="ident" id="7534057"><a href="/crypto/rc4/rc4_test.go.html#7529598">testing</a></span><span class="op" id="7534064">.</span><span class="ident" id="7534065">B</span><span class="op" id="7534066">)</span>&nbsp;<span class="op" id="7534068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7534071"><a href="/crypto/rc4/rc4_test.go.html#7533699">benchmark</a></span><span class="op" id="7534080">(</span><span class="ident" id="7534081"><a href="/crypto/rc4/rc4_test.go.html#7534054">b</a></span><span class="op" id="7534082">,</span>&nbsp;<span class="num" id="7534084">8096</span><span class="op" id="7534088">)</span><br>
<span class="lineno"></span><span class="op" id="7534090">}</span>
</div>
</body>
</html>
