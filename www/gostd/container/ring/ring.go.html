<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>container/ring</h2>
<ul>
<li><a href="/gostd/container/ring/ring.go.html" class="current">ring.go</a></li>
<li><a href="/gostd/container/ring/ring_test.go.html">ring_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4448498">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4448553">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4448607">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4448658">//&nbsp;Package&nbsp;ring&nbsp;implements&nbsp;operations&nbsp;on&nbsp;circular&nbsp;lists.</span><br>
<span class="lineno"></span><span class="keyword" id="4448715">package</span>&nbsp;<span class="ident" id="4448723">ring</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4448729">//&nbsp;A&nbsp;Ring&nbsp;is&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;circular&nbsp;list,&nbsp;or&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="4448782">//&nbsp;Rings&nbsp;do&nbsp;not&nbsp;have&nbsp;a&nbsp;beginning&nbsp;or&nbsp;end;&nbsp;a&nbsp;pointer&nbsp;to&nbsp;any&nbsp;ring&nbsp;element</span><br>
<span class="lineno">10</span><span class="comment" id="4448853">//&nbsp;serves&nbsp;as&nbsp;reference&nbsp;to&nbsp;the&nbsp;entire&nbsp;ring.&nbsp;Empty&nbsp;rings&nbsp;are&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="4448924">//&nbsp;as&nbsp;nil&nbsp;Ring&nbsp;pointers.&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Ring&nbsp;is&nbsp;a&nbsp;one-element</span><br>
<span class="lineno"></span><span class="comment" id="4448992">//&nbsp;ring&nbsp;with&nbsp;a&nbsp;nil&nbsp;Value.</span><br>
<span class="lineno"></span><span class="comment" id="4449018">//</span><br>
<span class="lineno"></span><span class="keyword" id="4449021">type</span>&nbsp;<span class="ident" id="4449026">Ring</span>&nbsp;<span class="keyword" id="4449031">struct</span>&nbsp;<span class="op" id="4449038">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4449041">next</span><span class="op" id="4449045">,</span>&nbsp;<span class="ident" id="4449047">prev</span>&nbsp;<span class="op" id="4449052">*</span><span class="ident" id="4449053">Ring</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4449059">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4449070">interface</span><span class="op" id="4449079">{</span><span class="op" id="4449080">}</span>&nbsp;<span class="comment" id="4449082">//&nbsp;for&nbsp;use&nbsp;by&nbsp;client;&nbsp;untouched&nbsp;by&nbsp;this&nbsp;library</span><br>
<span class="lineno"></span><span class="op" id="4449130">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4449133">func</span>&nbsp;<span class="op" id="4449138">(</span><span class="ident" id="4449139">r</span>&nbsp;<span class="op" id="4449141">*</span><span class="ident" id="4449142">Ring</span><span class="op" id="4449146">)</span>&nbsp;<span class="ident" id="4449148">init</span><span class="op" id="4449152">(</span><span class="op" id="4449153">)</span>&nbsp;<span class="op" id="4449155">*</span><span class="ident" id="4449156">Ring</span>&nbsp;<span class="op" id="4449161">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4449164">r</span><span class="op" id="4449165">.</span><span class="ident" id="4449166">next</span>&nbsp;<span class="op" id="4449171">=</span>&nbsp;<span class="ident" id="4449173">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4449176">r</span><span class="op" id="4449177">.</span><span class="ident" id="4449178">prev</span>&nbsp;<span class="op" id="4449183">=</span>&nbsp;<span class="ident" id="4449185">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4449188">return</span>&nbsp;<span class="ident" id="4449195">r</span><br>
<span class="lineno"></span><span class="op" id="4449197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4449200">//&nbsp;Next&nbsp;returns&nbsp;the&nbsp;next&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="4449260">func</span>&nbsp;<span class="op" id="4449265">(</span><span class="ident" id="4449266">r</span>&nbsp;<span class="op" id="4449268">*</span><span class="ident" id="4449269">Ring</span><span class="op" id="4449273">)</span>&nbsp;<span class="ident" id="4449275">Next</span><span class="op" id="4449279">(</span><span class="op" id="4449280">)</span>&nbsp;<span class="op" id="4449282">*</span><span class="ident" id="4449283">Ring</span>&nbsp;<span class="op" id="4449288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4449291">if</span>&nbsp;<span class="ident" id="4449294">r</span><span class="op" id="4449295">.</span><span class="ident" id="4449296">next</span>&nbsp;<span class="op" id="4449301">==</span>&nbsp;<span class="ident" id="4449304">nil</span>&nbsp;<span class="op" id="4449308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4449312">return</span>&nbsp;<span class="ident" id="4449319">r</span><span class="op" id="4449320">.</span><span class="ident" id="4449321">init</span><span class="op" id="4449325">(</span><span class="op" id="4449326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4449329">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4449332">return</span>&nbsp;<span class="ident" id="4449339">r</span><span class="op" id="4449340">.</span><span class="ident" id="4449341">next</span><br>
<span class="lineno"></span><span class="op" id="4449346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4449349">//&nbsp;Prev&nbsp;returns&nbsp;the&nbsp;previous&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="keyword" id="4449413">func</span>&nbsp;<span class="op" id="4449418">(</span><span class="ident" id="4449419">r</span>&nbsp;<span class="op" id="4449421">*</span><span class="ident" id="4449422">Ring</span><span class="op" id="4449426">)</span>&nbsp;<span class="ident" id="4449428">Prev</span><span class="op" id="4449432">(</span><span class="op" id="4449433">)</span>&nbsp;<span class="op" id="4449435">*</span><span class="ident" id="4449436">Ring</span>&nbsp;<span class="op" id="4449441">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4449444">if</span>&nbsp;<span class="ident" id="4449447">r</span><span class="op" id="4449448">.</span><span class="ident" id="4449449">next</span>&nbsp;<span class="op" id="4449454">==</span>&nbsp;<span class="ident" id="4449457">nil</span>&nbsp;<span class="op" id="4449461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4449465">return</span>&nbsp;<span class="ident" id="4449472">r</span><span class="op" id="4449473">.</span><span class="ident" id="4449474">init</span><span class="op" id="4449478">(</span><span class="op" id="4449479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4449482">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4449485">return</span>&nbsp;<span class="ident" id="4449492">r</span><span class="op" id="4449493">.</span><span class="ident" id="4449494">prev</span><br>
<span class="lineno"></span><span class="op" id="4449499">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="4449502">//&nbsp;Move&nbsp;moves&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;backward&nbsp;(n&nbsp;&lt;&nbsp;0)&nbsp;or&nbsp;forward&nbsp;(n&nbsp;&gt;=&nbsp;0)</span><br>
<span class="lineno"></span><span class="comment" id="4449574">//&nbsp;in&nbsp;the&nbsp;ring&nbsp;and&nbsp;returns&nbsp;that&nbsp;ring&nbsp;element.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span><span class="comment" id="4449641">//</span><br>
<span class="lineno"></span><span class="keyword" id="4449644">func</span>&nbsp;<span class="op" id="4449649">(</span><span class="ident" id="4449650">r</span>&nbsp;<span class="op" id="4449652">*</span><span class="ident" id="4449653">Ring</span><span class="op" id="4449657">)</span>&nbsp;<span class="ident" id="4449659">Move</span><span class="op" id="4449663">(</span><span class="ident" id="4449664">n</span>&nbsp;<span class="builtintype" id="4449666">int</span><span class="op" id="4449669">)</span>&nbsp;<span class="op" id="4449671">*</span><span class="ident" id="4449672">Ring</span>&nbsp;<span class="op" id="4449677">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4449680">if</span>&nbsp;<span class="ident" id="4449683">r</span><span class="op" id="4449684">.</span><span class="ident" id="4449685">next</span>&nbsp;<span class="op" id="4449690">==</span>&nbsp;<span class="ident" id="4449693">nil</span>&nbsp;<span class="op" id="4449697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4449701">return</span>&nbsp;<span class="ident" id="4449708">r</span><span class="op" id="4449709">.</span><span class="ident" id="4449710">init</span><span class="op" id="4449714">(</span><span class="op" id="4449715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4449718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4449721">switch</span>&nbsp;<span class="op" id="4449728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4449731">case</span>&nbsp;<span class="ident" id="4449736">n</span>&nbsp;<span class="op" id="4449738">&lt;</span>&nbsp;<span class="num" id="4449740">0</span><span class="op" id="4449741">:</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4449745">for</span>&nbsp;<span class="op" id="4449749">;</span>&nbsp;<span class="ident" id="4449751">n</span>&nbsp;<span class="op" id="4449753">&lt;</span>&nbsp;<span class="num" id="4449755">0</span><span class="op" id="4449756">;</span>&nbsp;<span class="ident" id="4449758">n</span><span class="op" id="4449759">++</span>&nbsp;<span class="op" id="4449762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4449767">r</span>&nbsp;<span class="op" id="4449769">=</span>&nbsp;<span class="ident" id="4449771">r</span><span class="op" id="4449772">.</span><span class="ident" id="4449773">prev</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4449780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4449783">case</span>&nbsp;<span class="ident" id="4449788">n</span>&nbsp;<span class="op" id="4449790">&gt;</span>&nbsp;<span class="num" id="4449792">0</span><span class="op" id="4449793">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4449797">for</span>&nbsp;<span class="op" id="4449801">;</span>&nbsp;<span class="ident" id="4449803">n</span>&nbsp;<span class="op" id="4449805">&gt;</span>&nbsp;<span class="num" id="4449807">0</span><span class="op" id="4449808">;</span>&nbsp;<span class="ident" id="4449810">n</span><span class="op" id="4449811">--</span>&nbsp;<span class="op" id="4449814">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4449819">r</span>&nbsp;<span class="op" id="4449821">=</span>&nbsp;<span class="ident" id="4449823">r</span><span class="op" id="4449824">.</span><span class="ident" id="4449825">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4449832">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4449835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4449838">return</span>&nbsp;<span class="ident" id="4449845">r</span><br>
<span class="lineno"></span><span class="op" id="4449847">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="4449850">//&nbsp;New&nbsp;creates&nbsp;a&nbsp;ring&nbsp;of&nbsp;n&nbsp;elements.</span><br>
<span class="lineno"></span><span class="keyword" id="4449887">func</span>&nbsp;<span class="ident" id="4449892">New</span><span class="op" id="4449895">(</span><span class="ident" id="4449896">n</span>&nbsp;<span class="builtintype" id="4449898">int</span><span class="op" id="4449901">)</span>&nbsp;<span class="op" id="4449903">*</span><span class="ident" id="4449904">Ring</span>&nbsp;<span class="op" id="4449909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4449912">if</span>&nbsp;<span class="ident" id="4449915">n</span>&nbsp;<span class="op" id="4449917">&lt;=</span>&nbsp;<span class="num" id="4449920">0</span>&nbsp;<span class="op" id="4449922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4449926">return</span>&nbsp;<span class="ident" id="4449933">nil</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4449938">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4449941">r</span>&nbsp;<span class="op" id="4449943">:=</span>&nbsp;<span class="builtinfunc" id="4449946">new</span><span class="op" id="4449949">(</span><span class="ident" id="4449950">Ring</span><span class="op" id="4449954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4449957">p</span>&nbsp;<span class="op" id="4449959">:=</span>&nbsp;<span class="ident" id="4449962">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4449965">for</span>&nbsp;<span class="ident" id="4449969">i</span>&nbsp;<span class="op" id="4449971">:=</span>&nbsp;<span class="num" id="4449974">1</span><span class="op" id="4449975">;</span>&nbsp;<span class="ident" id="4449977">i</span>&nbsp;<span class="op" id="4449979">&lt;</span>&nbsp;<span class="ident" id="4449981">n</span><span class="op" id="4449982">;</span>&nbsp;<span class="ident" id="4449984">i</span><span class="op" id="4449985">++</span>&nbsp;<span class="op" id="4449988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4449992">p</span><span class="op" id="4449993">.</span><span class="ident" id="4449994">next</span>&nbsp;<span class="op" id="4449999">=</span>&nbsp;<span class="op" id="4450001">&amp;</span><span class="ident" id="4450002">Ring</span><span class="op" id="4450006">{</span><span class="ident" id="4450007">prev</span><span class="op" id="4450011">:</span>&nbsp;<span class="ident" id="4450013">p</span><span class="op" id="4450014">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4450018">p</span>&nbsp;<span class="op" id="4450020">=</span>&nbsp;<span class="ident" id="4450022">p</span><span class="op" id="4450023">.</span><span class="ident" id="4450024">next</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4450030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4450033">p</span><span class="op" id="4450034">.</span><span class="ident" id="4450035">next</span>&nbsp;<span class="op" id="4450040">=</span>&nbsp;<span class="ident" id="4450042">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4450045">r</span><span class="op" id="4450046">.</span><span class="ident" id="4450047">prev</span>&nbsp;<span class="op" id="4450052">=</span>&nbsp;<span class="ident" id="4450054">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4450057">return</span>&nbsp;<span class="ident" id="4450064">r</span><br>
<span class="lineno">75</span><span class="op" id="4450066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4450069">//&nbsp;Link&nbsp;connects&nbsp;ring&nbsp;r&nbsp;with&nbsp;ring&nbsp;s&nbsp;such&nbsp;that&nbsp;r.Next()</span><br>
<span class="lineno"></span><span class="comment" id="4450124">//&nbsp;becomes&nbsp;s&nbsp;and&nbsp;returns&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next().</span><br>
<span class="lineno"></span><span class="comment" id="4450182">//&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">80</span><span class="comment" id="4450206">//</span><br>
<span class="lineno"></span><span class="comment" id="4450209">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;the&nbsp;same&nbsp;ring,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="4450255">//&nbsp;them&nbsp;removes&nbsp;the&nbsp;elements&nbsp;between&nbsp;r&nbsp;and&nbsp;s&nbsp;from&nbsp;the&nbsp;ring.</span><br>
<span class="lineno"></span><span class="comment" id="4450315">//&nbsp;The&nbsp;removed&nbsp;elements&nbsp;form&nbsp;a&nbsp;subring&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4450374">//&nbsp;reference&nbsp;to&nbsp;that&nbsp;subring&nbsp;(if&nbsp;no&nbsp;elements&nbsp;were&nbsp;removed,</span><br>
<span class="lineno">85</span><span class="comment" id="4450433">//&nbsp;the&nbsp;result&nbsp;is&nbsp;still&nbsp;the&nbsp;original&nbsp;value&nbsp;for&nbsp;r.Next(),</span><br>
<span class="lineno"></span><span class="comment" id="4450489">//&nbsp;and&nbsp;not&nbsp;nil).</span><br>
<span class="lineno"></span><span class="comment" id="4450506">//</span><br>
<span class="lineno"></span><span class="comment" id="4450509">//&nbsp;If&nbsp;r&nbsp;and&nbsp;s&nbsp;point&nbsp;to&nbsp;different&nbsp;rings,&nbsp;linking</span><br>
<span class="lineno"></span><span class="comment" id="4450557">//&nbsp;them&nbsp;creates&nbsp;a&nbsp;single&nbsp;ring&nbsp;with&nbsp;the&nbsp;elements&nbsp;of&nbsp;s&nbsp;inserted</span><br>
<span class="lineno">90</span><span class="comment" id="4450619">//&nbsp;after&nbsp;r.&nbsp;The&nbsp;result&nbsp;points&nbsp;to&nbsp;the&nbsp;element&nbsp;following&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4450678">//&nbsp;last&nbsp;element&nbsp;of&nbsp;s&nbsp;after&nbsp;insertion.</span><br>
<span class="lineno"></span><span class="comment" id="4450716">//</span><br>
<span class="lineno"></span><span class="keyword" id="4450719">func</span>&nbsp;<span class="op" id="4450724">(</span><span class="ident" id="4450725">r</span>&nbsp;<span class="op" id="4450727">*</span><span class="ident" id="4450728">Ring</span><span class="op" id="4450732">)</span>&nbsp;<span class="ident" id="4450734">Link</span><span class="op" id="4450738">(</span><span class="ident" id="4450739">s</span>&nbsp;<span class="op" id="4450741">*</span><span class="ident" id="4450742">Ring</span><span class="op" id="4450746">)</span>&nbsp;<span class="op" id="4450748">*</span><span class="ident" id="4450749">Ring</span>&nbsp;<span class="op" id="4450754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4450757">n</span>&nbsp;<span class="op" id="4450759">:=</span>&nbsp;<span class="ident" id="4450762">r</span><span class="op" id="4450763">.</span><span class="ident" id="4450764">Next</span><span class="op" id="4450768">(</span><span class="op" id="4450769">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4450772">if</span>&nbsp;<span class="ident" id="4450775">s</span>&nbsp;<span class="op" id="4450777">!=</span>&nbsp;<span class="ident" id="4450780">nil</span>&nbsp;<span class="op" id="4450784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4450788">p</span>&nbsp;<span class="op" id="4450790">:=</span>&nbsp;<span class="ident" id="4450793">s</span><span class="op" id="4450794">.</span><span class="ident" id="4450795">Prev</span><span class="op" id="4450799">(</span><span class="op" id="4450800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4450804">//&nbsp;Note:&nbsp;Cannot&nbsp;use&nbsp;multiple&nbsp;assignment&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4450854">//&nbsp;evaluation&nbsp;order&nbsp;of&nbsp;LHS&nbsp;is&nbsp;not&nbsp;specified.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4450901">r</span><span class="op" id="4450902">.</span><span class="ident" id="4450903">next</span>&nbsp;<span class="op" id="4450908">=</span>&nbsp;<span class="ident" id="4450910">s</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4450914">s</span><span class="op" id="4450915">.</span><span class="ident" id="4450916">prev</span>&nbsp;<span class="op" id="4450921">=</span>&nbsp;<span class="ident" id="4450923">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4450927">n</span><span class="op" id="4450928">.</span><span class="ident" id="4450929">prev</span>&nbsp;<span class="op" id="4450934">=</span>&nbsp;<span class="ident" id="4450936">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4450940">p</span><span class="op" id="4450941">.</span><span class="ident" id="4450942">next</span>&nbsp;<span class="op" id="4450947">=</span>&nbsp;<span class="ident" id="4450949">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4450952">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4450955">return</span>&nbsp;<span class="ident" id="4450962">n</span><br>
<span class="lineno">105</span><span class="op" id="4450964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4450967">//&nbsp;Unlink&nbsp;removes&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;elements&nbsp;from&nbsp;the&nbsp;ring&nbsp;r,&nbsp;starting</span><br>
<span class="lineno"></span><span class="comment" id="4451032">//&nbsp;at&nbsp;r.Next().&nbsp;If&nbsp;n&nbsp;%&nbsp;r.Len()&nbsp;==&nbsp;0,&nbsp;r&nbsp;remains&nbsp;unchanged.</span><br>
<span class="lineno"></span><span class="comment" id="4451090">//&nbsp;The&nbsp;result&nbsp;is&nbsp;the&nbsp;removed&nbsp;subring.&nbsp;r&nbsp;must&nbsp;not&nbsp;be&nbsp;empty.</span><br>
<span class="lineno">110</span><span class="comment" id="4451149">//</span><br>
<span class="lineno"></span><span class="keyword" id="4451152">func</span>&nbsp;<span class="op" id="4451157">(</span><span class="ident" id="4451158">r</span>&nbsp;<span class="op" id="4451160">*</span><span class="ident" id="4451161">Ring</span><span class="op" id="4451165">)</span>&nbsp;<span class="ident" id="4451167">Unlink</span><span class="op" id="4451173">(</span><span class="ident" id="4451174">n</span>&nbsp;<span class="builtintype" id="4451176">int</span><span class="op" id="4451179">)</span>&nbsp;<span class="op" id="4451181">*</span><span class="ident" id="4451182">Ring</span>&nbsp;<span class="op" id="4451187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4451190">if</span>&nbsp;<span class="ident" id="4451193">n</span>&nbsp;<span class="op" id="4451195">&lt;=</span>&nbsp;<span class="num" id="4451198">0</span>&nbsp;<span class="op" id="4451200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4451204">return</span>&nbsp;<span class="ident" id="4451211">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4451216">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4451219">return</span>&nbsp;<span class="ident" id="4451226">r</span><span class="op" id="4451227">.</span><span class="ident" id="4451228">Link</span><span class="op" id="4451232">(</span><span class="ident" id="4451233">r</span><span class="op" id="4451234">.</span><span class="ident" id="4451235">Move</span><span class="op" id="4451239">(</span><span class="ident" id="4451240">n</span>&nbsp;<span class="op" id="4451242">+</span>&nbsp;<span class="num" id="4451244">1</span><span class="op" id="4451245">)</span><span class="op" id="4451246">)</span><br>
<span class="lineno"></span><span class="op" id="4451248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4451251">//&nbsp;Len&nbsp;computes&nbsp;the&nbsp;number&nbsp;of&nbsp;elements&nbsp;in&nbsp;ring&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="4451301">//&nbsp;It&nbsp;executes&nbsp;in&nbsp;time&nbsp;proportional&nbsp;to&nbsp;the&nbsp;number&nbsp;of&nbsp;elements.</span><br>
<span class="lineno">120</span><span class="comment" id="4451364">//</span><br>
<span class="lineno"></span><span class="keyword" id="4451367">func</span>&nbsp;<span class="op" id="4451372">(</span><span class="ident" id="4451373">r</span>&nbsp;<span class="op" id="4451375">*</span><span class="ident" id="4451376">Ring</span><span class="op" id="4451380">)</span>&nbsp;<span class="ident" id="4451382">Len</span><span class="op" id="4451385">(</span><span class="op" id="4451386">)</span>&nbsp;<span class="builtintype" id="4451388">int</span>&nbsp;<span class="op" id="4451392">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4451395">n</span>&nbsp;<span class="op" id="4451397">:=</span>&nbsp;<span class="num" id="4451400">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4451403">if</span>&nbsp;<span class="ident" id="4451406">r</span>&nbsp;<span class="op" id="4451408">!=</span>&nbsp;<span class="ident" id="4451411">nil</span>&nbsp;<span class="op" id="4451415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4451419">n</span>&nbsp;<span class="op" id="4451421">=</span>&nbsp;<span class="num" id="4451423">1</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4451427">for</span>&nbsp;<span class="ident" id="4451431">p</span>&nbsp;<span class="op" id="4451433">:=</span>&nbsp;<span class="ident" id="4451436">r</span><span class="op" id="4451437">.</span><span class="ident" id="4451438">Next</span><span class="op" id="4451442">(</span><span class="op" id="4451443">)</span><span class="op" id="4451444">;</span>&nbsp;<span class="ident" id="4451446">p</span>&nbsp;<span class="op" id="4451448">!=</span>&nbsp;<span class="ident" id="4451451">r</span><span class="op" id="4451452">;</span>&nbsp;<span class="ident" id="4451454">p</span>&nbsp;<span class="op" id="4451456">=</span>&nbsp;<span class="ident" id="4451458">p</span><span class="op" id="4451459">.</span><span class="ident" id="4451460">next</span>&nbsp;<span class="op" id="4451465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4451470">n</span><span class="op" id="4451471">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4451476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4451479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4451482">return</span>&nbsp;<span class="ident" id="4451489">n</span><br>
<span class="lineno">130</span><span class="op" id="4451491">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4451494">//&nbsp;Do&nbsp;calls&nbsp;function&nbsp;f&nbsp;on&nbsp;each&nbsp;element&nbsp;of&nbsp;the&nbsp;ring,&nbsp;in&nbsp;forward&nbsp;order.</span><br>
<span class="lineno"></span><span class="comment" id="4451564">//&nbsp;The&nbsp;behavior&nbsp;of&nbsp;Do&nbsp;is&nbsp;undefined&nbsp;if&nbsp;f&nbsp;changes&nbsp;*r.</span><br>
<span class="lineno"></span><span class="keyword" id="4451616">func</span>&nbsp;<span class="op" id="4451621">(</span><span class="ident" id="4451622">r</span>&nbsp;<span class="op" id="4451624">*</span><span class="ident" id="4451625">Ring</span><span class="op" id="4451629">)</span>&nbsp;<span class="ident" id="4451631">Do</span><span class="op" id="4451633">(</span><span class="ident" id="4451634">f</span>&nbsp;<span class="keyword" id="4451636">func</span><span class="op" id="4451640">(</span><span class="keyword" id="4451641">interface</span><span class="op" id="4451650">{</span><span class="op" id="4451651">}</span><span class="op" id="4451652">)</span><span class="op" id="4451653">)</span>&nbsp;<span class="op" id="4451655">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4451658">if</span>&nbsp;<span class="ident" id="4451661">r</span>&nbsp;<span class="op" id="4451663">!=</span>&nbsp;<span class="ident" id="4451666">nil</span>&nbsp;<span class="op" id="4451670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4451674">f</span><span class="op" id="4451675">(</span><span class="ident" id="4451676">r</span><span class="op" id="4451677">.</span><span class="ident" id="4451678">Value</span><span class="op" id="4451683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4451687">for</span>&nbsp;<span class="ident" id="4451691">p</span>&nbsp;<span class="op" id="4451693">:=</span>&nbsp;<span class="ident" id="4451696">r</span><span class="op" id="4451697">.</span><span class="ident" id="4451698">Next</span><span class="op" id="4451702">(</span><span class="op" id="4451703">)</span><span class="op" id="4451704">;</span>&nbsp;<span class="ident" id="4451706">p</span>&nbsp;<span class="op" id="4451708">!=</span>&nbsp;<span class="ident" id="4451711">r</span><span class="op" id="4451712">;</span>&nbsp;<span class="ident" id="4451714">p</span>&nbsp;<span class="op" id="4451716">=</span>&nbsp;<span class="ident" id="4451718">p</span><span class="op" id="4451719">.</span><span class="ident" id="4451720">next</span>&nbsp;<span class="op" id="4451725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4451730">f</span><span class="op" id="4451731">(</span><span class="ident" id="4451732">p</span><span class="op" id="4451733">.</span><span class="ident" id="4451734">Value</span><span class="op" id="4451739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4451743">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4451746">}</span><br>
<span class="lineno"></span><span class="op" id="4451748">}</span>
</div>
</body>
</html>
