<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html" class="current">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5409802">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5409857">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5409911">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5409962">package</span>&nbsp;<span class="ident" id="5409970">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5409977">import</span>&nbsp;<span class="string" id="5409984">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5409992">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="5410052">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="5410122">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="5410180">//</span><br>
<span class="lineno"></span><span class="comment" id="5410183">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="5410231">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="5410295">//</span><br>
<span class="lineno"></span><span class="comment" id="5410298">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="5410359">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5410429">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="5410504">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5410571">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="5410644">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="5410716">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="5410730">//</span><br>
<span class="lineno"></span><span class="comment" id="5410733">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="5410799">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="5410865">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="5410878">//</span><br>
<span class="lineno"></span><span class="comment" id="5410881">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="5410905">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5410935">//&nbsp;Complex&nbsp;square&nbsp;root</span><br>
<span class="lineno"></span><span class="comment" id="5410958">//</span><br>
<span class="lineno"></span><span class="comment" id="5410961">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="5410977">//</span><br>
<span class="lineno">35</span><span class="comment" id="5410980">//&nbsp;If&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,&nbsp;&nbsp;r&nbsp;=&nbsp;|z|,&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="5411013">//</span><br>
<span class="lineno"></span><span class="comment" id="5411016">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1/2</span><br>
<span class="lineno"></span><span class="comment" id="5411045">//&nbsp;Re&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;[&nbsp;(r&nbsp;+&nbsp;x)/2&nbsp;]&nbsp;&nbsp;&nbsp;,</span><br>
<span class="lineno"></span><span class="comment" id="5411075">//</span><br>
<span class="lineno">40</span><span class="comment" id="5411078">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1/2</span><br>
<span class="lineno"></span><span class="comment" id="5411107">//&nbsp;Im&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;[&nbsp;(r&nbsp;-&nbsp;x)/2&nbsp;]&nbsp;&nbsp;&nbsp;.</span><br>
<span class="lineno"></span><span class="comment" id="5411137">//</span><br>
<span class="lineno"></span><span class="comment" id="5411140">//&nbsp;Cancellation&nbsp;error&nbsp;in&nbsp;r-x&nbsp;or&nbsp;r+x&nbsp;is&nbsp;avoided&nbsp;by&nbsp;using&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5411200">//&nbsp;identity&nbsp;&nbsp;2&nbsp;Re&nbsp;w&nbsp;Im&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;y.</span><br>
<span class="lineno">45</span><span class="comment" id="5411232">//</span><br>
<span class="lineno"></span><span class="comment" id="5411235">//&nbsp;Note&nbsp;that&nbsp;-w&nbsp;is&nbsp;also&nbsp;a&nbsp;square&nbsp;root&nbsp;of&nbsp;z.&nbsp;&nbsp;The&nbsp;root&nbsp;chosen</span><br>
<span class="lineno"></span><span class="comment" id="5411296">//&nbsp;is&nbsp;always&nbsp;in&nbsp;the&nbsp;right&nbsp;half&nbsp;plane&nbsp;and&nbsp;Im&nbsp;w&nbsp;has&nbsp;the&nbsp;same&nbsp;sign&nbsp;as&nbsp;y.</span><br>
<span class="lineno"></span><span class="comment" id="5411366">//</span><br>
<span class="lineno"></span><span class="comment" id="5411369">//&nbsp;ACCURACY:</span><br>
<span class="lineno">50</span><span class="comment" id="5411382">//</span><br>
<span class="lineno"></span><span class="comment" id="5411385">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="5411425">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="5411483">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;25000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.6e-18</span><br>
<span class="lineno"></span><span class="comment" id="5411543">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;1,000,000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.9e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.1e-17</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="5411604">//&nbsp;Sqrt&nbsp;returns&nbsp;the&nbsp;square&nbsp;root&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="5411642">//&nbsp;The&nbsp;result&nbsp;r&nbsp;is&nbsp;chosen&nbsp;so&nbsp;that&nbsp;real(r)&nbsp;â‰¥&nbsp;0&nbsp;and&nbsp;imag(r)&nbsp;has&nbsp;the&nbsp;same&nbsp;sign&nbsp;as&nbsp;imag(x).</span><br>
<span class="lineno"></span><span class="keyword" id="5411732">func</span>&nbsp;<span class="ident" id="5411737">Sqrt</span><span class="op" id="5411741">(</span><span class="ident" id="5411742">x</span>&nbsp;<span class="builtintype" id="5411744">complex128</span><span class="op" id="5411754">)</span>&nbsp;<span class="builtintype" id="5411756">complex128</span>&nbsp;<span class="op" id="5411767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5411770">if</span>&nbsp;<span class="builtinfunc" id="5411773">imag</span><span class="op" id="5411777">(</span><span class="ident" id="5411778">x</span><span class="op" id="5411779">)</span>&nbsp;<span class="op" id="5411781">==</span>&nbsp;<span class="num" id="5411784">0</span>&nbsp;<span class="op" id="5411786">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5411790">if</span>&nbsp;<span class="builtinfunc" id="5411793">real</span><span class="op" id="5411797">(</span><span class="ident" id="5411798">x</span><span class="op" id="5411799">)</span>&nbsp;<span class="op" id="5411801">==</span>&nbsp;<span class="num" id="5411804">0</span>&nbsp;<span class="op" id="5411806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5411811">return</span>&nbsp;<span class="builtinfunc" id="5411818">complex</span><span class="op" id="5411825">(</span><span class="num" id="5411826">0</span><span class="op" id="5411827">,</span>&nbsp;<span class="num" id="5411829">0</span><span class="op" id="5411830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5411834">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5411838">if</span>&nbsp;<span class="builtinfunc" id="5411841">real</span><span class="op" id="5411845">(</span><span class="ident" id="5411846">x</span><span class="op" id="5411847">)</span>&nbsp;<span class="op" id="5411849">&lt;</span>&nbsp;<span class="num" id="5411851">0</span>&nbsp;<span class="op" id="5411853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5411858">return</span>&nbsp;<span class="builtinfunc" id="5411865">complex</span><span class="op" id="5411872">(</span><span class="num" id="5411873">0</span><span class="op" id="5411874">,</span>&nbsp;<span class="ident" id="5411876">math</span><span class="op" id="5411880">.</span><span class="ident" id="5411881">Sqrt</span><span class="op" id="5411885">(</span><span class="op" id="5411886">-</span><span class="builtinfunc" id="5411887">real</span><span class="op" id="5411891">(</span><span class="ident" id="5411892">x</span><span class="op" id="5411893">)</span><span class="op" id="5411894">)</span><span class="op" id="5411895">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5411899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5411903">return</span>&nbsp;<span class="builtinfunc" id="5411910">complex</span><span class="op" id="5411917">(</span><span class="ident" id="5411918">math</span><span class="op" id="5411922">.</span><span class="ident" id="5411923">Sqrt</span><span class="op" id="5411927">(</span><span class="builtinfunc" id="5411928">real</span><span class="op" id="5411932">(</span><span class="ident" id="5411933">x</span><span class="op" id="5411934">)</span><span class="op" id="5411935">)</span><span class="op" id="5411936">,</span>&nbsp;<span class="num" id="5411938">0</span><span class="op" id="5411939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5411942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5411945">if</span>&nbsp;<span class="builtinfunc" id="5411948">real</span><span class="op" id="5411952">(</span><span class="ident" id="5411953">x</span><span class="op" id="5411954">)</span>&nbsp;<span class="op" id="5411956">==</span>&nbsp;<span class="num" id="5411959">0</span>&nbsp;<span class="op" id="5411961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5411965">if</span>&nbsp;<span class="builtinfunc" id="5411968">imag</span><span class="op" id="5411972">(</span><span class="ident" id="5411973">x</span><span class="op" id="5411974">)</span>&nbsp;<span class="op" id="5411976">&lt;</span>&nbsp;<span class="num" id="5411978">0</span>&nbsp;<span class="op" id="5411980">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5411985">r</span>&nbsp;<span class="op" id="5411987">:=</span>&nbsp;<span class="ident" id="5411990">math</span><span class="op" id="5411994">.</span><span class="ident" id="5411995">Sqrt</span><span class="op" id="5411999">(</span><span class="op" id="5412000">-</span><span class="num" id="5412001">0.5</span>&nbsp;<span class="op" id="5412005">*</span>&nbsp;<span class="builtinfunc" id="5412007">imag</span><span class="op" id="5412011">(</span><span class="ident" id="5412012">x</span><span class="op" id="5412013">)</span><span class="op" id="5412014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5412019">return</span>&nbsp;<span class="builtinfunc" id="5412026">complex</span><span class="op" id="5412033">(</span><span class="ident" id="5412034">r</span><span class="op" id="5412035">,</span>&nbsp;<span class="op" id="5412037">-</span><span class="ident" id="5412038">r</span><span class="op" id="5412039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5412043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412047">r</span>&nbsp;<span class="op" id="5412049">:=</span>&nbsp;<span class="ident" id="5412052">math</span><span class="op" id="5412056">.</span><span class="ident" id="5412057">Sqrt</span><span class="op" id="5412061">(</span><span class="num" id="5412062">0.5</span>&nbsp;<span class="op" id="5412066">*</span>&nbsp;<span class="builtinfunc" id="5412068">imag</span><span class="op" id="5412072">(</span><span class="ident" id="5412073">x</span><span class="op" id="5412074">)</span><span class="op" id="5412075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5412079">return</span>&nbsp;<span class="builtinfunc" id="5412086">complex</span><span class="op" id="5412093">(</span><span class="ident" id="5412094">r</span><span class="op" id="5412095">,</span>&nbsp;<span class="ident" id="5412097">r</span><span class="op" id="5412098">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5412101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412104">a</span>&nbsp;<span class="op" id="5412106">:=</span>&nbsp;<span class="builtinfunc" id="5412109">real</span><span class="op" id="5412113">(</span><span class="ident" id="5412114">x</span><span class="op" id="5412115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412118">b</span>&nbsp;<span class="op" id="5412120">:=</span>&nbsp;<span class="builtinfunc" id="5412123">imag</span><span class="op" id="5412127">(</span><span class="ident" id="5412128">x</span><span class="op" id="5412129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5412132">var</span>&nbsp;<span class="ident" id="5412136">scale</span>&nbsp;<span class="builtintype" id="5412142">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5412151">//&nbsp;Rescale&nbsp;to&nbsp;avoid&nbsp;internal&nbsp;overflow&nbsp;or&nbsp;underflow.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5412204">if</span>&nbsp;<span class="ident" id="5412207">math</span><span class="op" id="5412211">.</span><span class="ident" id="5412212">Abs</span><span class="op" id="5412215">(</span><span class="ident" id="5412216">a</span><span class="op" id="5412217">)</span>&nbsp;<span class="op" id="5412219">&gt;</span>&nbsp;<span class="num" id="5412221">4</span>&nbsp;<span class="op" id="5412223">||</span>&nbsp;<span class="ident" id="5412226">math</span><span class="op" id="5412230">.</span><span class="ident" id="5412231">Abs</span><span class="op" id="5412234">(</span><span class="ident" id="5412235">b</span><span class="op" id="5412236">)</span>&nbsp;<span class="op" id="5412238">&gt;</span>&nbsp;<span class="num" id="5412240">4</span>&nbsp;<span class="op" id="5412242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412246">a</span>&nbsp;<span class="op" id="5412248">*=</span>&nbsp;<span class="num" id="5412251">0.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412258">b</span>&nbsp;<span class="op" id="5412260">*=</span>&nbsp;<span class="num" id="5412263">0.25</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412270">scale</span>&nbsp;<span class="op" id="5412276">=</span>&nbsp;<span class="num" id="5412278">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5412281">}</span>&nbsp;<span class="keyword" id="5412283">else</span>&nbsp;<span class="op" id="5412288">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412292">a</span>&nbsp;<span class="op" id="5412294">*=</span>&nbsp;<span class="num" id="5412297">1.8014398509481984e16</span>&nbsp;<span class="comment" id="5412319">//&nbsp;2**54</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412330">b</span>&nbsp;<span class="op" id="5412332">*=</span>&nbsp;<span class="num" id="5412335">1.8014398509481984e16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412359">scale</span>&nbsp;<span class="op" id="5412365">=</span>&nbsp;<span class="num" id="5412367">7.450580596923828125e-9</span>&nbsp;<span class="comment" id="5412391">//&nbsp;2**-27</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5412402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412405">r</span>&nbsp;<span class="op" id="5412407">:=</span>&nbsp;<span class="ident" id="5412410">math</span><span class="op" id="5412414">.</span><span class="ident" id="5412415">Hypot</span><span class="op" id="5412420">(</span><span class="ident" id="5412421">a</span><span class="op" id="5412422">,</span>&nbsp;<span class="ident" id="5412424">b</span><span class="op" id="5412425">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5412428">var</span>&nbsp;<span class="ident" id="5412432">t</span>&nbsp;<span class="builtintype" id="5412434">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5412443">if</span>&nbsp;<span class="ident" id="5412446">a</span>&nbsp;<span class="op" id="5412448">&gt;</span>&nbsp;<span class="num" id="5412450">0</span>&nbsp;<span class="op" id="5412452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412456">t</span>&nbsp;<span class="op" id="5412458">=</span>&nbsp;<span class="ident" id="5412460">math</span><span class="op" id="5412464">.</span><span class="ident" id="5412465">Sqrt</span><span class="op" id="5412469">(</span><span class="num" id="5412470">0.5</span><span class="op" id="5412473">*</span><span class="ident" id="5412474">r</span>&nbsp;<span class="op" id="5412476">+</span>&nbsp;<span class="num" id="5412478">0.5</span><span class="op" id="5412481">*</span><span class="ident" id="5412482">a</span><span class="op" id="5412483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412487">r</span>&nbsp;<span class="op" id="5412489">=</span>&nbsp;<span class="ident" id="5412491">scale</span>&nbsp;<span class="op" id="5412497">*</span>&nbsp;<span class="ident" id="5412499">math</span><span class="op" id="5412503">.</span><span class="ident" id="5412504">Abs</span><span class="op" id="5412507">(</span><span class="op" id="5412508">(</span><span class="num" id="5412509">0.5</span><span class="op" id="5412512">*</span><span class="ident" id="5412513">b</span><span class="op" id="5412514">)</span><span class="op" id="5412515">/</span><span class="ident" id="5412516">t</span><span class="op" id="5412517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412521">t</span>&nbsp;<span class="op" id="5412523">*=</span>&nbsp;<span class="ident" id="5412526">scale</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5412533">}</span>&nbsp;<span class="keyword" id="5412535">else</span>&nbsp;<span class="op" id="5412540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412544">r</span>&nbsp;<span class="op" id="5412546">=</span>&nbsp;<span class="ident" id="5412548">math</span><span class="op" id="5412552">.</span><span class="ident" id="5412553">Sqrt</span><span class="op" id="5412557">(</span><span class="num" id="5412558">0.5</span><span class="op" id="5412561">*</span><span class="ident" id="5412562">r</span>&nbsp;<span class="op" id="5412564">-</span>&nbsp;<span class="num" id="5412566">0.5</span><span class="op" id="5412569">*</span><span class="ident" id="5412570">a</span><span class="op" id="5412571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412575">t</span>&nbsp;<span class="op" id="5412577">=</span>&nbsp;<span class="ident" id="5412579">scale</span>&nbsp;<span class="op" id="5412585">*</span>&nbsp;<span class="ident" id="5412587">math</span><span class="op" id="5412591">.</span><span class="ident" id="5412592">Abs</span><span class="op" id="5412595">(</span><span class="op" id="5412596">(</span><span class="num" id="5412597">0.5</span><span class="op" id="5412600">*</span><span class="ident" id="5412601">b</span><span class="op" id="5412602">)</span><span class="op" id="5412603">/</span><span class="ident" id="5412604">r</span><span class="op" id="5412605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5412609">r</span>&nbsp;<span class="op" id="5412611">*=</span>&nbsp;<span class="ident" id="5412614">scale</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5412621">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5412624">if</span>&nbsp;<span class="ident" id="5412627">b</span>&nbsp;<span class="op" id="5412629">&lt;</span>&nbsp;<span class="num" id="5412631">0</span>&nbsp;<span class="op" id="5412633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5412637">return</span>&nbsp;<span class="builtinfunc" id="5412644">complex</span><span class="op" id="5412651">(</span><span class="ident" id="5412652">t</span><span class="op" id="5412653">,</span>&nbsp;<span class="op" id="5412655">-</span><span class="ident" id="5412656">r</span><span class="op" id="5412657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5412660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5412663">return</span>&nbsp;<span class="builtinfunc" id="5412670">complex</span><span class="op" id="5412677">(</span><span class="ident" id="5412678">t</span><span class="op" id="5412679">,</span>&nbsp;<span class="ident" id="5412681">r</span><span class="op" id="5412682">)</span><br>
<span class="lineno"></span><span class="op" id="5412684">}</span>
</div>
</body>
</html>
