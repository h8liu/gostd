<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>regexp/syntax</h2>
<ul>
<li><a href="/gostd/regexp/syntax/compile.go.html">compile.go</a></li>
<li><a href="/gostd/regexp/syntax/doc.go.html">doc.go</a></li>
<li><a href="/gostd/regexp/syntax/parse.go.html">parse.go</a></li>
<li><a href="/gostd/regexp/syntax/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/regexp/syntax/perl_groups.go.html">perl_groups.go</a></li>
<li><a href="/gostd/regexp/syntax/prog.go.html">prog.go</a></li>
<li><a href="/gostd/regexp/syntax/prog_test.go.html">prog_test.go</a></li>
<li><a href="/gostd/regexp/syntax/regexp.go.html">regexp.go</a></li>
<li><a href="/gostd/regexp/syntax/simplify.go.html">simplify.go</a></li>
<li><a href="/gostd/regexp/syntax/simplify_test.go.html">simplify_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7007262">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7007318">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7007372">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7007423">package</span>&nbsp;<span class="ident" id="7007431">syntax</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7007439">import</span>&nbsp;<span class="op" id="7007446">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7007449">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7007458">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7007465">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7007476">&#34;unicode&#34;</span><br>
<span class="lineno"></span><span class="op" id="7007486">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7007489">type</span>&nbsp;<span class="ident" id="7007494">parseTest</span>&nbsp;<span class="keyword" id="7007504">struct</span>&nbsp;<span class="op" id="7007511">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7007514">Regexp</span>&nbsp;<span class="builtintype" id="7007521">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7007529">Dump</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7007536">string</span><br>
<span class="lineno"></span><span class="op" id="7007543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7007546">var</span>&nbsp;<span class="ident" id="7007550">parseTests</span>&nbsp;<span class="op" id="7007561">=</span>&nbsp;<span class="op" id="7007563">[</span><span class="op" id="7007564">]</span><span class="ident" id="7007565">parseTest</span><span class="op" id="7007574">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7007577">//&nbsp;Base&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007592">{</span><span class="string" id="7007593">`a`</span><span class="op" id="7007596">,</span>&nbsp;<span class="string" id="7007598">`lit{a}`</span><span class="op" id="7007606">}</span><span class="op" id="7007607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007610">{</span><span class="string" id="7007611">`a.`</span><span class="op" id="7007615">,</span>&nbsp;<span class="string" id="7007617">`cat{lit{a}dot{}}`</span><span class="op" id="7007635">}</span><span class="op" id="7007636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007639">{</span><span class="string" id="7007640">`a.b`</span><span class="op" id="7007645">,</span>&nbsp;<span class="string" id="7007647">`cat{lit{a}dot{}lit{b}}`</span><span class="op" id="7007671">}</span><span class="op" id="7007672">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007675">{</span><span class="string" id="7007676">`ab`</span><span class="op" id="7007680">,</span>&nbsp;<span class="string" id="7007682">`str{ab}`</span><span class="op" id="7007691">}</span><span class="op" id="7007692">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007695">{</span><span class="string" id="7007696">`a.b.c`</span><span class="op" id="7007703">,</span>&nbsp;<span class="string" id="7007705">`cat{lit{a}dot{}lit{b}dot{}lit{c}}`</span><span class="op" id="7007740">}</span><span class="op" id="7007741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007744">{</span><span class="string" id="7007745">`abc`</span><span class="op" id="7007750">,</span>&nbsp;<span class="string" id="7007752">`str{abc}`</span><span class="op" id="7007762">}</span><span class="op" id="7007763">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007766">{</span><span class="string" id="7007767">`a|^`</span><span class="op" id="7007772">,</span>&nbsp;<span class="string" id="7007774">`alt{lit{a}bol{}}`</span><span class="op" id="7007792">}</span><span class="op" id="7007793">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007796">{</span><span class="string" id="7007797">`a|b`</span><span class="op" id="7007802">,</span>&nbsp;<span class="string" id="7007804">`cc{0x61-0x62}`</span><span class="op" id="7007819">}</span><span class="op" id="7007820">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007823">{</span><span class="string" id="7007824">`(a)`</span><span class="op" id="7007829">,</span>&nbsp;<span class="string" id="7007831">`cap{lit{a}}`</span><span class="op" id="7007844">}</span><span class="op" id="7007845">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007848">{</span><span class="string" id="7007849">`(a)|b`</span><span class="op" id="7007856">,</span>&nbsp;<span class="string" id="7007858">`alt{cap{lit{a}}lit{b}}`</span><span class="op" id="7007882">}</span><span class="op" id="7007883">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007886">{</span><span class="string" id="7007887">`a*`</span><span class="op" id="7007891">,</span>&nbsp;<span class="string" id="7007893">`star{lit{a}}`</span><span class="op" id="7007907">}</span><span class="op" id="7007908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007911">{</span><span class="string" id="7007912">`a+`</span><span class="op" id="7007916">,</span>&nbsp;<span class="string" id="7007918">`plus{lit{a}}`</span><span class="op" id="7007932">}</span><span class="op" id="7007933">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007936">{</span><span class="string" id="7007937">`a?`</span><span class="op" id="7007941">,</span>&nbsp;<span class="string" id="7007943">`que{lit{a}}`</span><span class="op" id="7007956">}</span><span class="op" id="7007957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007960">{</span><span class="string" id="7007961">`a{2}`</span><span class="op" id="7007967">,</span>&nbsp;<span class="string" id="7007969">`rep{2,2&nbsp;lit{a}}`</span><span class="op" id="7007986">}</span><span class="op" id="7007987">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007990">{</span><span class="string" id="7007991">`a{2,3}`</span><span class="op" id="7007999">,</span>&nbsp;<span class="string" id="7008001">`rep{2,3&nbsp;lit{a}}`</span><span class="op" id="7008018">}</span><span class="op" id="7008019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008022">{</span><span class="string" id="7008023">`a{2,}`</span><span class="op" id="7008030">,</span>&nbsp;<span class="string" id="7008032">`rep{2,-1&nbsp;lit{a}}`</span><span class="op" id="7008050">}</span><span class="op" id="7008051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008054">{</span><span class="string" id="7008055">`a*?`</span><span class="op" id="7008060">,</span>&nbsp;<span class="string" id="7008062">`nstar{lit{a}}`</span><span class="op" id="7008077">}</span><span class="op" id="7008078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008081">{</span><span class="string" id="7008082">`a+?`</span><span class="op" id="7008087">,</span>&nbsp;<span class="string" id="7008089">`nplus{lit{a}}`</span><span class="op" id="7008104">}</span><span class="op" id="7008105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008108">{</span><span class="string" id="7008109">`a??`</span><span class="op" id="7008114">,</span>&nbsp;<span class="string" id="7008116">`nque{lit{a}}`</span><span class="op" id="7008130">}</span><span class="op" id="7008131">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008134">{</span><span class="string" id="7008135">`a{2}?`</span><span class="op" id="7008142">,</span>&nbsp;<span class="string" id="7008144">`nrep{2,2&nbsp;lit{a}}`</span><span class="op" id="7008162">}</span><span class="op" id="7008163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008166">{</span><span class="string" id="7008167">`a{2,3}?`</span><span class="op" id="7008176">,</span>&nbsp;<span class="string" id="7008178">`nrep{2,3&nbsp;lit{a}}`</span><span class="op" id="7008196">}</span><span class="op" id="7008197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008200">{</span><span class="string" id="7008201">`a{2,}?`</span><span class="op" id="7008209">,</span>&nbsp;<span class="string" id="7008211">`nrep{2,-1&nbsp;lit{a}}`</span><span class="op" id="7008230">}</span><span class="op" id="7008231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7008234">//&nbsp;Malformed&nbsp;{&nbsp;}&nbsp;are&nbsp;treated&nbsp;as&nbsp;literals.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008277">{</span><span class="string" id="7008278">`x{1001`</span><span class="op" id="7008286">,</span>&nbsp;<span class="string" id="7008288">`str{x{1001}`</span><span class="op" id="7008301">}</span><span class="op" id="7008302">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008305">{</span><span class="string" id="7008306">`x{9876543210`</span><span class="op" id="7008320">,</span>&nbsp;<span class="string" id="7008322">`str{x{9876543210}`</span><span class="op" id="7008341">}</span><span class="op" id="7008342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008345">{</span><span class="string" id="7008346">`x{9876543210,`</span><span class="op" id="7008361">,</span>&nbsp;<span class="string" id="7008363">`str{x{9876543210,}`</span><span class="op" id="7008383">}</span><span class="op" id="7008384">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008387">{</span><span class="string" id="7008388">`x{2,1`</span><span class="op" id="7008395">,</span>&nbsp;<span class="string" id="7008397">`str{x{2,1}`</span><span class="op" id="7008409">}</span><span class="op" id="7008410">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008413">{</span><span class="string" id="7008414">`x{1,9876543210`</span><span class="op" id="7008430">,</span>&nbsp;<span class="string" id="7008432">`str{x{1,9876543210}`</span><span class="op" id="7008453">}</span><span class="op" id="7008454">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008457">{</span><span class="string" id="7008458">``</span><span class="op" id="7008460">,</span>&nbsp;<span class="string" id="7008462">`emp{}`</span><span class="op" id="7008469">}</span><span class="op" id="7008470">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008473">{</span><span class="string" id="7008474">`|`</span><span class="op" id="7008477">,</span>&nbsp;<span class="string" id="7008479">`emp{}`</span><span class="op" id="7008486">}</span><span class="op" id="7008487">,</span>&nbsp;<span class="comment" id="7008489">//&nbsp;alt{emp{}emp{}}&nbsp;but&nbsp;got&nbsp;factored</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008526">{</span><span class="string" id="7008527">`|x|`</span><span class="op" id="7008532">,</span>&nbsp;<span class="string" id="7008534">`alt{emp{}lit{x}emp{}}`</span><span class="op" id="7008557">}</span><span class="op" id="7008558">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008561">{</span><span class="string" id="7008562">`.`</span><span class="op" id="7008565">,</span>&nbsp;<span class="string" id="7008567">`dot{}`</span><span class="op" id="7008574">}</span><span class="op" id="7008575">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008578">{</span><span class="string" id="7008579">`^`</span><span class="op" id="7008582">,</span>&nbsp;<span class="string" id="7008584">`bol{}`</span><span class="op" id="7008591">}</span><span class="op" id="7008592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008595">{</span><span class="string" id="7008596">`$`</span><span class="op" id="7008599">,</span>&nbsp;<span class="string" id="7008601">`eol{}`</span><span class="op" id="7008608">}</span><span class="op" id="7008609">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008612">{</span><span class="string" id="7008613">`\|`</span><span class="op" id="7008617">,</span>&nbsp;<span class="string" id="7008619">`lit{|}`</span><span class="op" id="7008627">}</span><span class="op" id="7008628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008631">{</span><span class="string" id="7008632">`\(`</span><span class="op" id="7008636">,</span>&nbsp;<span class="string" id="7008638">`lit{(}`</span><span class="op" id="7008646">}</span><span class="op" id="7008647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008650">{</span><span class="string" id="7008651">`\)`</span><span class="op" id="7008655">,</span>&nbsp;<span class="string" id="7008657">`lit{)}`</span><span class="op" id="7008665">}</span><span class="op" id="7008666">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008669">{</span><span class="string" id="7008670">`\*`</span><span class="op" id="7008674">,</span>&nbsp;<span class="string" id="7008676">`lit{*}`</span><span class="op" id="7008684">}</span><span class="op" id="7008685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008688">{</span><span class="string" id="7008689">`\+`</span><span class="op" id="7008693">,</span>&nbsp;<span class="string" id="7008695">`lit{+}`</span><span class="op" id="7008703">}</span><span class="op" id="7008704">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008707">{</span><span class="string" id="7008708">`\?`</span><span class="op" id="7008712">,</span>&nbsp;<span class="string" id="7008714">`lit{?}`</span><span class="op" id="7008722">}</span><span class="op" id="7008723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008726">{</span><span class="string" id="7008727">`{`</span><span class="op" id="7008730">,</span>&nbsp;<span class="string" id="7008732">`lit{{}`</span><span class="op" id="7008740">}</span><span class="op" id="7008741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008744">{</span><span class="string" id="7008745">`}`</span><span class="op" id="7008748">,</span>&nbsp;<span class="string" id="7008750">`lit{}}`</span><span class="op" id="7008758">}</span><span class="op" id="7008759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008762">{</span><span class="string" id="7008763">`\.`</span><span class="op" id="7008767">,</span>&nbsp;<span class="string" id="7008769">`lit{.}`</span><span class="op" id="7008777">}</span><span class="op" id="7008778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008781">{</span><span class="string" id="7008782">`\^`</span><span class="op" id="7008786">,</span>&nbsp;<span class="string" id="7008788">`lit{^}`</span><span class="op" id="7008796">}</span><span class="op" id="7008797">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008800">{</span><span class="string" id="7008801">`\$`</span><span class="op" id="7008805">,</span>&nbsp;<span class="string" id="7008807">`lit{$}`</span><span class="op" id="7008815">}</span><span class="op" id="7008816">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008819">{</span><span class="string" id="7008820">`\\`</span><span class="op" id="7008824">,</span>&nbsp;<span class="string" id="7008826">`lit{\}`</span><span class="op" id="7008834">}</span><span class="op" id="7008835">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008838">{</span><span class="string" id="7008839">`[ace]`</span><span class="op" id="7008846">,</span>&nbsp;<span class="string" id="7008848">`cc{0x61&nbsp;0x63&nbsp;0x65}`</span><span class="op" id="7008868">}</span><span class="op" id="7008869">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008872">{</span><span class="string" id="7008873">`[abc]`</span><span class="op" id="7008880">,</span>&nbsp;<span class="string" id="7008882">`cc{0x61-0x63}`</span><span class="op" id="7008897">}</span><span class="op" id="7008898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008901">{</span><span class="string" id="7008902">`[a-z]`</span><span class="op" id="7008909">,</span>&nbsp;<span class="string" id="7008911">`cc{0x61-0x7a}`</span><span class="op" id="7008926">}</span><span class="op" id="7008927">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008930">{</span><span class="string" id="7008931">`[a]`</span><span class="op" id="7008936">,</span>&nbsp;<span class="string" id="7008938">`lit{a}`</span><span class="op" id="7008946">}</span><span class="op" id="7008947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008950">{</span><span class="string" id="7008951">`\-`</span><span class="op" id="7008955">,</span>&nbsp;<span class="string" id="7008957">`lit{-}`</span><span class="op" id="7008965">}</span><span class="op" id="7008966">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008969">{</span><span class="string" id="7008970">`-`</span><span class="op" id="7008973">,</span>&nbsp;<span class="string" id="7008975">`lit{-}`</span><span class="op" id="7008983">}</span><span class="op" id="7008984">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7008987">{</span><span class="string" id="7008988">`\_`</span><span class="op" id="7008992">,</span>&nbsp;<span class="string" id="7008994">`lit{_}`</span><span class="op" id="7009002">}</span><span class="op" id="7009003">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7009006">{</span><span class="string" id="7009007">`abc`</span><span class="op" id="7009012">,</span>&nbsp;<span class="string" id="7009014">`str{abc}`</span><span class="op" id="7009024">}</span><span class="op" id="7009025">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7009028">{</span><span class="string" id="7009029">`abc|def`</span><span class="op" id="7009038">,</span>&nbsp;<span class="string" id="7009040">`alt{str{abc}str{def}}`</span><span class="op" id="7009063">}</span><span class="op" id="7009064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7009067">{</span><span class="string" id="7009068">`abc|def|ghi`</span><span class="op" id="7009081">,</span>&nbsp;<span class="string" id="7009083">`alt{str{abc}str{def}str{ghi}}`</span><span class="op" id="7009114">}</span><span class="op" id="7009115">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7009119">//&nbsp;Posix&nbsp;and&nbsp;Perl&nbsp;extensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7009149">{</span><span class="string" id="7009150">`[[:lower:]]`</span><span class="op" id="7009163">,</span>&nbsp;<span class="string" id="7009165">`cc{0x61-0x7a}`</span><span class="op" id="7009180">}</span><span class="op" id="7009181">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7009184">{</span><span class="string" id="7009185">`[a-z]`</span><span class="op" id="7009192">,</span>&nbsp;<span class="string" id="7009194">`cc{0x61-0x7a}`</span><span class="op" id="7009209">}</span><span class="op" id="7009210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7009213">{</span><span class="string" id="7009214">`[^[:lower:]]`</span><span class="op" id="7009228">,</span>&nbsp;<span class="string" id="7009230">`cc{0x0-0x60&nbsp;0x7b-0x10ffff}`</span><span class="op" id="7009258">}</span><span class="op" id="7009259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7009262">{</span><span class="string" id="7009263">`[[:^lower:]]`</span><span class="op" id="7009277">,</span>&nbsp;<span class="string" id="7009279">`cc{0x0-0x60&nbsp;0x7b-0x10ffff}`</span><span class="op" id="7009307">}</span><span class="op" id="7009308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7009311">{</span><span class="string" id="7009312">`(?i)[[:lower:]]`</span><span class="op" id="7009329">,</span>&nbsp;<span class="string" id="7009331">`cc{0x41-0x5a&nbsp;0x61-0x7a&nbsp;0x17f&nbsp;0x212a}`</span><span class="op" id="7009369">}</span><span class="op" id="7009370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7009373">{</span><span class="string" id="7009374">`(?i)[a-z]`</span><span class="op" id="7009385">,</span>&nbsp;<span class="string" id="7009387">`cc{0x41-0x5a&nbsp;0x61-0x7a&nbsp;0x17f&nbsp;0x212a}`</span><span class="op" id="7009425">}</span><span class="op" id="7009426">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7009429">{</span><span class="string" id="7009430">`(?i)[^[:lower:]]`</span><span class="op" id="7009448">,</span>&nbsp;<span class="string" id="7009450">`cc{0x0-0x40&nbsp;0x5b-0x60&nbsp;0x7b-0x17e&nbsp;0x180-0x2129&nbsp;0x212b-0x10ffff}`</span><span class="op" id="7009514">}</span><span class="op" id="7009515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7009518">{</span><span class="string" id="7009519">`(?i)[[:^lower:]]`</span><span class="op" id="7009537">,</span>&nbsp;<span class="string" id="7009539">`cc{0x0-0x40&nbsp;0x5b-0x60&nbsp;0x7b-0x17e&nbsp;0x180-0x2129&nbsp;0x212b-0x10ffff}`</span><span class="op" id="7009603">}</span><span class="op" id="7009604">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7009607">{</span><span class="string" id="7009608">`\d`</span><span class="op" id="7009612">,</span>&nbsp;<span class="string" id="7009614">`cc{0x30-0x39}`</span><span class="op" id="7009629">}</span><span class="op" id="7009630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7009633">{</span><span class="string" id="7009634">`\D`</span><span class="op" id="7009638">,</span>&nbsp;<span class="string" id="7009640">`cc{0x0-0x2f&nbsp;0x3a-0x10ffff}`</span><span class="op" id="7009668">}</span><span class="op" id="7009669">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7009672">{</span><span class="string" id="7009673">`\s`</span><span class="op" id="7009677">,</span>&nbsp;<span class="string" id="7009679">`cc{0x9-0xa&nbsp;0xc-0xd&nbsp;0x20}`</span><span class="op" id="7009705">}</span><span class="op" id="7009706">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7009709">{</span><span class="string" id="7009710">`\S`</span><span class="op" id="7009714">,</span>&nbsp;<span class="string" id="7009716">`cc{0x0-0x8&nbsp;0xb&nbsp;0xe-0x1f&nbsp;0x21-0x10ffff}`</span><span class="op" id="7009756">}</span><span class="op" id="7009757">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7009760">{</span><span class="string" id="7009761">`\w`</span><span class="op" id="7009765">,</span>&nbsp;<span class="string" id="7009767">`cc{0x30-0x39&nbsp;0x41-0x5a&nbsp;0x5f&nbsp;0x61-0x7a}`</span><span class="op" id="7009807">}</span><span class="op" id="7009808">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7009811">{</span><span class="string" id="7009812">`\W`</span><span class="op" id="7009816">,</span>&nbsp;<span class="string" id="7009818">`cc{0x0-0x2f&nbsp;0x3a-0x40&nbsp;0x5b-0x5e&nbsp;0x60&nbsp;0x7b-0x10ffff}`</span><span class="op" id="7009871">}</span><span class="op" id="7009872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7009875">{</span><span class="string" id="7009876">`(?i)\w`</span><span class="op" id="7009884">,</span>&nbsp;<span class="string" id="7009886">`cc{0x30-0x39&nbsp;0x41-0x5a&nbsp;0x5f&nbsp;0x61-0x7a&nbsp;0x17f&nbsp;0x212a}`</span><span class="op" id="7009939">}</span><span class="op" id="7009940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7009943">{</span><span class="string" id="7009944">`(?i)\W`</span><span class="op" id="7009952">,</span>&nbsp;<span class="string" id="7009954">`cc{0x0-0x2f&nbsp;0x3a-0x40&nbsp;0x5b-0x5e&nbsp;0x60&nbsp;0x7b-0x17e&nbsp;0x180-0x2129&nbsp;0x212b-0x10ffff}`</span><span class="op" id="7010033">}</span><span class="op" id="7010034">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7010037">{</span><span class="string" id="7010038">`[^\\]`</span><span class="op" id="7010045">,</span>&nbsp;<span class="string" id="7010047">`cc{0x0-0x5b&nbsp;0x5d-0x10ffff}`</span><span class="op" id="7010075">}</span><span class="op" id="7010076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7010079">//&nbsp;&nbsp;&nbsp;&nbsp{&nbsp;`\C`,&nbsp;`byte{}`&nbsp;},&nbsp;&nbsp;//&nbsp;probably&nbsp;never</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7010123">//&nbsp;Unicode,&nbsp;negatives,&nbsp;and&nbsp;a&nbsp;double&nbsp;negative.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7010170">{</span><span class="string" id="7010171">`\p{Braille}`</span><span class="op" id="7010184">,</span>&nbsp;<span class="string" id="7010186">`cc{0x2800-0x28ff}`</span><span class="op" id="7010205">}</span><span class="op" id="7010206">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7010209">{</span><span class="string" id="7010210">`\P{Braille}`</span><span class="op" id="7010223">,</span>&nbsp;<span class="string" id="7010225">`cc{0x0-0x27ff&nbsp;0x2900-0x10ffff}`</span><span class="op" id="7010257">}</span><span class="op" id="7010258">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7010261">{</span><span class="string" id="7010262">`\p{^Braille}`</span><span class="op" id="7010276">,</span>&nbsp;<span class="string" id="7010278">`cc{0x0-0x27ff&nbsp;0x2900-0x10ffff}`</span><span class="op" id="7010310">}</span><span class="op" id="7010311">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7010314">{</span><span class="string" id="7010315">`\P{^Braille}`</span><span class="op" id="7010329">,</span>&nbsp;<span class="string" id="7010331">`cc{0x2800-0x28ff}`</span><span class="op" id="7010350">}</span><span class="op" id="7010351">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7010354">{</span><span class="string" id="7010355">`\pZ`</span><span class="op" id="7010360">,</span>&nbsp;<span class="string" id="7010362">`cc{0x20&nbsp;0xa0&nbsp;0x1680&nbsp;0x2000-0x200a&nbsp;0x2028-0x2029&nbsp;0x202f&nbsp;0x205f&nbsp;0x3000}`</span><span class="op" id="7010433">}</span><span class="op" id="7010434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7010437">{</span><span class="string" id="7010438">`[\p{Braille}]`</span><span class="op" id="7010453">,</span>&nbsp;<span class="string" id="7010455">`cc{0x2800-0x28ff}`</span><span class="op" id="7010474">}</span><span class="op" id="7010475">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7010478">{</span><span class="string" id="7010479">`[\P{Braille}]`</span><span class="op" id="7010494">,</span>&nbsp;<span class="string" id="7010496">`cc{0x0-0x27ff&nbsp;0x2900-0x10ffff}`</span><span class="op" id="7010528">}</span><span class="op" id="7010529">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7010532">{</span><span class="string" id="7010533">`[\p{^Braille}]`</span><span class="op" id="7010549">,</span>&nbsp;<span class="string" id="7010551">`cc{0x0-0x27ff&nbsp;0x2900-0x10ffff}`</span><span class="op" id="7010583">}</span><span class="op" id="7010584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7010587">{</span><span class="string" id="7010588">`[\P{^Braille}]`</span><span class="op" id="7010604">,</span>&nbsp;<span class="string" id="7010606">`cc{0x2800-0x28ff}`</span><span class="op" id="7010625">}</span><span class="op" id="7010626">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7010629">{</span><span class="string" id="7010630">`[\pZ]`</span><span class="op" id="7010637">,</span>&nbsp;<span class="string" id="7010639">`cc{0x20&nbsp;0xa0&nbsp;0x1680&nbsp;0x2000-0x200a&nbsp;0x2028-0x2029&nbsp;0x202f&nbsp;0x205f&nbsp;0x3000}`</span><span class="op" id="7010710">}</span><span class="op" id="7010711">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7010714">{</span><span class="string" id="7010715">`\p{Lu}`</span><span class="op" id="7010723">,</span>&nbsp;<span class="ident" id="7010725">mkCharClass</span><span class="op" id="7010736">(</span><span class="ident" id="7010737">unicode</span><span class="op" id="7010744">.</span><span class="ident" id="7010745">IsUpper</span><span class="op" id="7010752">)</span><span class="op" id="7010753">}</span><span class="op" id="7010754">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7010757">{</span><span class="string" id="7010758">`[\p{Lu}]`</span><span class="op" id="7010768">,</span>&nbsp;<span class="ident" id="7010770">mkCharClass</span><span class="op" id="7010781">(</span><span class="ident" id="7010782">unicode</span><span class="op" id="7010789">.</span><span class="ident" id="7010790">IsUpper</span><span class="op" id="7010797">)</span><span class="op" id="7010798">}</span><span class="op" id="7010799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7010802">{</span><span class="string" id="7010803">`(?i)[\p{Lu}]`</span><span class="op" id="7010817">,</span>&nbsp;<span class="ident" id="7010819">mkCharClass</span><span class="op" id="7010830">(</span><span class="ident" id="7010831">isUpperFold</span><span class="op" id="7010842">)</span><span class="op" id="7010843">}</span><span class="op" id="7010844">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7010847">{</span><span class="string" id="7010848">`\p{Any}`</span><span class="op" id="7010857">,</span>&nbsp;<span class="string" id="7010859">`dot{}`</span><span class="op" id="7010866">}</span><span class="op" id="7010867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7010870">{</span><span class="string" id="7010871">`\p{^Any}`</span><span class="op" id="7010881">,</span>&nbsp;<span class="string" id="7010883">`cc{}`</span><span class="op" id="7010889">}</span><span class="op" id="7010890">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7010894">//&nbsp;Hex,&nbsp;octal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7010910">{</span><span class="string" id="7010911">`[\012-\234]\141`</span><span class="op" id="7010928">,</span>&nbsp;<span class="string" id="7010930">`cat{cc{0xa-0x9c}lit{a}}`</span><span class="op" id="7010955">}</span><span class="op" id="7010956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7010959">{</span><span class="string" id="7010960">`[\x{41}-\x7a]\x61`</span><span class="op" id="7010979">,</span>&nbsp;<span class="string" id="7010981">`cat{cc{0x41-0x7a}lit{a}}`</span><span class="op" id="7011007">}</span><span class="op" id="7011008">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7011012">//&nbsp;More&nbsp;interesting&nbsp;regular&nbsp;expressions.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011054">{</span><span class="string" id="7011055">`a{,2}`</span><span class="op" id="7011062">,</span>&nbsp;<span class="string" id="7011064">`str{a{,2}}`</span><span class="op" id="7011076">}</span><span class="op" id="7011077">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011080">{</span><span class="string" id="7011081">`\.\^\$\\`</span><span class="op" id="7011091">,</span>&nbsp;<span class="string" id="7011093">`str{.^$\}`</span><span class="op" id="7011104">}</span><span class="op" id="7011105">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011108">{</span><span class="string" id="7011109">`[a-zABC]`</span><span class="op" id="7011119">,</span>&nbsp;<span class="string" id="7011121">`cc{0x41-0x43&nbsp;0x61-0x7a}`</span><span class="op" id="7011146">}</span><span class="op" id="7011147">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011150">{</span><span class="string" id="7011151">`[^a]`</span><span class="op" id="7011157">,</span>&nbsp;<span class="string" id="7011159">`cc{0x0-0x60&nbsp;0x62-0x10ffff}`</span><span class="op" id="7011187">}</span><span class="op" id="7011188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011191">{</span><span class="string" id="7011192">`[α-ε☺]`</span><span class="op" id="7011204">,</span>&nbsp;<span class="string" id="7011206">`cc{0x3b1-0x3b5&nbsp;0x263a}`</span><span class="op" id="7011230">}</span><span class="op" id="7011231">,</span>&nbsp;<span class="comment" id="7011233">//&nbsp;utf-8</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011243">{</span><span class="string" id="7011244">`a*{`</span><span class="op" id="7011249">,</span>&nbsp;<span class="string" id="7011251">`cat{star{lit{a}}lit{{}}`</span><span class="op" id="7011276">}</span><span class="op" id="7011277">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7011281">//&nbsp;Test&nbsp;precedences</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011302">{</span><span class="string" id="7011303">`(?:ab)*`</span><span class="op" id="7011312">,</span>&nbsp;<span class="string" id="7011314">`star{str{ab}}`</span><span class="op" id="7011329">}</span><span class="op" id="7011330">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011333">{</span><span class="string" id="7011334">`(ab)*`</span><span class="op" id="7011341">,</span>&nbsp;<span class="string" id="7011343">`star{cap{str{ab}}}`</span><span class="op" id="7011363">}</span><span class="op" id="7011364">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011367">{</span><span class="string" id="7011368">`ab|cd`</span><span class="op" id="7011375">,</span>&nbsp;<span class="string" id="7011377">`alt{str{ab}str{cd}}`</span><span class="op" id="7011398">}</span><span class="op" id="7011399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011402">{</span><span class="string" id="7011403">`a(b|c)d`</span><span class="op" id="7011412">,</span>&nbsp;<span class="string" id="7011414">`cat{lit{a}cap{cc{0x62-0x63}}lit{d}}`</span><span class="op" id="7011451">}</span><span class="op" id="7011452">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7011456">//&nbsp;Test&nbsp;flattening.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011477">{</span><span class="string" id="7011478">`(?:a)`</span><span class="op" id="7011485">,</span>&nbsp;<span class="string" id="7011487">`lit{a}`</span><span class="op" id="7011495">}</span><span class="op" id="7011496">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011499">{</span><span class="string" id="7011500">`(?:ab)(?:cd)`</span><span class="op" id="7011514">,</span>&nbsp;<span class="string" id="7011516">`str{abcd}`</span><span class="op" id="7011527">}</span><span class="op" id="7011528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011531">{</span><span class="string" id="7011532">`(?:a+b+)(?:c+d+)`</span><span class="op" id="7011550">,</span>&nbsp;<span class="string" id="7011552">`cat{plus{lit{a}}plus{lit{b}}plus{lit{c}}plus{lit{d}}}`</span><span class="op" id="7011607">}</span><span class="op" id="7011608">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011611">{</span><span class="string" id="7011612">`(?:a+|b+)|(?:c+|d+)`</span><span class="op" id="7011633">,</span>&nbsp;<span class="string" id="7011635">`alt{plus{lit{a}}plus{lit{b}}plus{lit{c}}plus{lit{d}}}`</span><span class="op" id="7011690">}</span><span class="op" id="7011691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011694">{</span><span class="string" id="7011695">`(?:a|b)|(?:c|d)`</span><span class="op" id="7011712">,</span>&nbsp;<span class="string" id="7011714">`cc{0x61-0x64}`</span><span class="op" id="7011729">}</span><span class="op" id="7011730">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011733">{</span><span class="string" id="7011734">`a|.`</span><span class="op" id="7011739">,</span>&nbsp;<span class="string" id="7011741">`dot{}`</span><span class="op" id="7011748">}</span><span class="op" id="7011749">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011752">{</span><span class="string" id="7011753">`.|a`</span><span class="op" id="7011758">,</span>&nbsp;<span class="string" id="7011760">`dot{}`</span><span class="op" id="7011767">}</span><span class="op" id="7011768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011771">{</span><span class="string" id="7011772">`(?:[abc]|A|Z|hello|world)`</span><span class="op" id="7011799">,</span>&nbsp;<span class="string" id="7011801">`alt{cc{0x41&nbsp;0x5a&nbsp;0x61-0x63}str{hello}str{world}}`</span><span class="op" id="7011851">}</span><span class="op" id="7011852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011855">{</span><span class="string" id="7011856">`(?:[abc]|A|Z)`</span><span class="op" id="7011871">,</span>&nbsp;<span class="string" id="7011873">`cc{0x41&nbsp;0x5a&nbsp;0x61-0x63}`</span><span class="op" id="7011898">}</span><span class="op" id="7011899">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7011903">//&nbsp;Test&nbsp;Perl&nbsp;quoted&nbsp;literals</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011933">{</span><span class="string" id="7011934">`\Q+|*?{[\E`</span><span class="op" id="7011946">,</span>&nbsp;<span class="string" id="7011948">`str{+|*?{[}`</span><span class="op" id="7011961">}</span><span class="op" id="7011962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011965">{</span><span class="string" id="7011966">`\Q+\E+`</span><span class="op" id="7011974">,</span>&nbsp;<span class="string" id="7011976">`plus{lit{+}}`</span><span class="op" id="7011990">}</span><span class="op" id="7011991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7011994">{</span><span class="string" id="7011995">`\Q\\E`</span><span class="op" id="7012002">,</span>&nbsp;<span class="string" id="7012004">`lit{\}`</span><span class="op" id="7012012">}</span><span class="op" id="7012013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012016">{</span><span class="string" id="7012017">`\Q\\\E`</span><span class="op" id="7012025">,</span>&nbsp;<span class="string" id="7012027">`str{\\}`</span><span class="op" id="7012036">}</span><span class="op" id="7012037">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7012041">//&nbsp;Test&nbsp;Perl&nbsp;\A&nbsp;and&nbsp;\z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012065">{</span><span class="string" id="7012066">`(?m)^`</span><span class="op" id="7012073">,</span>&nbsp;<span class="string" id="7012075">`bol{}`</span><span class="op" id="7012082">}</span><span class="op" id="7012083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012086">{</span><span class="string" id="7012087">`(?m)$`</span><span class="op" id="7012094">,</span>&nbsp;<span class="string" id="7012096">`eol{}`</span><span class="op" id="7012103">}</span><span class="op" id="7012104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012107">{</span><span class="string" id="7012108">`(?-m)^`</span><span class="op" id="7012116">,</span>&nbsp;<span class="string" id="7012118">`bot{}`</span><span class="op" id="7012125">}</span><span class="op" id="7012126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012129">{</span><span class="string" id="7012130">`(?-m)$`</span><span class="op" id="7012138">,</span>&nbsp;<span class="string" id="7012140">`eot{}`</span><span class="op" id="7012147">}</span><span class="op" id="7012148">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012151">{</span><span class="string" id="7012152">`(?m)\A`</span><span class="op" id="7012160">,</span>&nbsp;<span class="string" id="7012162">`bot{}`</span><span class="op" id="7012169">}</span><span class="op" id="7012170">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012173">{</span><span class="string" id="7012174">`(?m)\z`</span><span class="op" id="7012182">,</span>&nbsp;<span class="string" id="7012184">`eot{\z}`</span><span class="op" id="7012193">}</span><span class="op" id="7012194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012197">{</span><span class="string" id="7012198">`(?-m)\A`</span><span class="op" id="7012207">,</span>&nbsp;<span class="string" id="7012209">`bot{}`</span><span class="op" id="7012216">}</span><span class="op" id="7012217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012220">{</span><span class="string" id="7012221">`(?-m)\z`</span><span class="op" id="7012230">,</span>&nbsp;<span class="string" id="7012232">`eot{\z}`</span><span class="op" id="7012241">}</span><span class="op" id="7012242">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7012246">//&nbsp;Test&nbsp;named&nbsp;captures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012270">{</span><span class="string" id="7012271">`(?P&lt;name&gt;a)`</span><span class="op" id="7012284">,</span>&nbsp;<span class="string" id="7012286">`cap{name:lit{a}}`</span><span class="op" id="7012304">}</span><span class="op" id="7012305">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7012309">//&nbsp;Case-folded&nbsp;literals</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012334">{</span><span class="string" id="7012335">`[Aa]`</span><span class="op" id="7012341">,</span>&nbsp;<span class="string" id="7012343">`litfold{A}`</span><span class="op" id="7012355">}</span><span class="op" id="7012356">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012359">{</span><span class="string" id="7012360">`[\x{100}\x{101}]`</span><span class="op" id="7012378">,</span>&nbsp;<span class="string" id="7012380">`litfold{Ā}`</span><span class="op" id="7012393">}</span><span class="op" id="7012394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012397">{</span><span class="string" id="7012398">`[Δδ]`</span><span class="op" id="7012406">,</span>&nbsp;<span class="string" id="7012408">`litfold{Δ}`</span><span class="op" id="7012421">}</span><span class="op" id="7012422">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7012426">//&nbsp;Strings</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012438">{</span><span class="string" id="7012439">`abcde`</span><span class="op" id="7012446">,</span>&nbsp;<span class="string" id="7012448">`str{abcde}`</span><span class="op" id="7012460">}</span><span class="op" id="7012461">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012464">{</span><span class="string" id="7012465">`[Aa][Bb]cd`</span><span class="op" id="7012477">,</span>&nbsp;<span class="string" id="7012479">`cat{strfold{AB}str{cd}}`</span><span class="op" id="7012504">}</span><span class="op" id="7012505">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7012509">//&nbsp;Factoring.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012524">{</span><span class="string" id="7012525">`abc|abd|aef|bcx|bcy`</span><span class="op" id="7012546">,</span>&nbsp;<span class="string" id="7012548">`alt{cat{lit{a}alt{cat{lit{b}cc{0x63-0x64}}str{ef}}}cat{str{bc}cc{0x78-0x79}}}`</span><span class="op" id="7012627">}</span><span class="op" id="7012628">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012631">{</span><span class="string" id="7012632">`ax+y|ax+z|ay+w`</span><span class="op" id="7012648">,</span>&nbsp;<span class="string" id="7012650">`cat{lit{a}alt{cat{plus{lit{x}}cc{0x79-0x7a}}cat{plus{lit{y}}lit{w}}}}`</span><span class="op" id="7012721">}</span><span class="op" id="7012722">,</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7012726">//&nbsp;Bug&nbsp;fixes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012741">{</span><span class="string" id="7012742">`(?:.)`</span><span class="op" id="7012749">,</span>&nbsp;<span class="string" id="7012751">`dot{}`</span><span class="op" id="7012758">}</span><span class="op" id="7012759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012762">{</span><span class="string" id="7012763">`(?:x|(?:xa))`</span><span class="op" id="7012777">,</span>&nbsp;<span class="string" id="7012779">`cat{lit{x}alt{emp{}lit{a}}}`</span><span class="op" id="7012808">}</span><span class="op" id="7012809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012812">{</span><span class="string" id="7012813">`(?:.|(?:.a))`</span><span class="op" id="7012827">,</span>&nbsp;<span class="string" id="7012829">`cat{dot{}alt{emp{}lit{a}}}`</span><span class="op" id="7012857">}</span><span class="op" id="7012858">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012861">{</span><span class="string" id="7012862">`(?:A(?:A|a))`</span><span class="op" id="7012876">,</span>&nbsp;<span class="string" id="7012878">`cat{lit{A}litfold{A}}`</span><span class="op" id="7012901">}</span><span class="op" id="7012902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012905">{</span><span class="string" id="7012906">`(?:A|a)`</span><span class="op" id="7012915">,</span>&nbsp;<span class="string" id="7012917">`litfold{A}`</span><span class="op" id="7012929">}</span><span class="op" id="7012930">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012933">{</span><span class="string" id="7012934">`A|(?:A|a)`</span><span class="op" id="7012945">,</span>&nbsp;<span class="string" id="7012947">`litfold{A}`</span><span class="op" id="7012959">}</span><span class="op" id="7012960">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012963">{</span><span class="string" id="7012964">`(?s).`</span><span class="op" id="7012971">,</span>&nbsp;<span class="string" id="7012973">`dot{}`</span><span class="op" id="7012980">}</span><span class="op" id="7012981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7012984">{</span><span class="string" id="7012985">`(?-s).`</span><span class="op" id="7012993">,</span>&nbsp;<span class="string" id="7012995">`dnl{}`</span><span class="op" id="7013002">}</span><span class="op" id="7013003">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013006">{</span><span class="string" id="7013007">`(?:(?:^).)`</span><span class="op" id="7013019">,</span>&nbsp;<span class="string" id="7013021">`cat{bol{}dot{}}`</span><span class="op" id="7013038">}</span><span class="op" id="7013039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013042">{</span><span class="string" id="7013043">`(?-s)(?:(?:^).)`</span><span class="op" id="7013060">,</span>&nbsp;<span class="string" id="7013062">`cat{bol{}dnl{}}`</span><span class="op" id="7013079">}</span><span class="op" id="7013080">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7013084">//&nbsp;RE2&nbsp;prefix_tests</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013105">{</span><span class="string" id="7013106">`abc|abd`</span><span class="op" id="7013115">,</span>&nbsp;<span class="string" id="7013117">`cat{str{ab}cc{0x63-0x64}}`</span><span class="op" id="7013144">}</span><span class="op" id="7013145">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013148">{</span><span class="string" id="7013149">`a(?:b)c|abd`</span><span class="op" id="7013162">,</span>&nbsp;<span class="string" id="7013164">`cat{str{ab}cc{0x63-0x64}}`</span><span class="op" id="7013191">}</span><span class="op" id="7013192">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013195">{</span><span class="string" id="7013196">`abc|abd|aef|bcx|bcy`</span><span class="op" id="7013217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7013221">`alt{cat{lit{a}alt{cat{lit{b}cc{0x63-0x64}}str{ef}}}`</span>&nbsp;<span class="op" id="7013275">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7013280">`cat{str{bc}cc{0x78-0x79}}}`</span><span class="op" id="7013308">}</span><span class="op" id="7013309">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013312">{</span><span class="string" id="7013313">`abc|x|abd`</span><span class="op" id="7013324">,</span>&nbsp;<span class="string" id="7013326">`alt{str{abc}lit{x}str{abd}}`</span><span class="op" id="7013355">}</span><span class="op" id="7013356">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013359">{</span><span class="string" id="7013360">`(?i)abc|ABD`</span><span class="op" id="7013373">,</span>&nbsp;<span class="string" id="7013375">`cat{strfold{AB}cc{0x43-0x44&nbsp;0x63-0x64}}`</span><span class="op" id="7013416">}</span><span class="op" id="7013417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013420">{</span><span class="string" id="7013421">`[ab]c|[ab]d`</span><span class="op" id="7013434">,</span>&nbsp;<span class="string" id="7013436">`cat{cc{0x61-0x62}cc{0x63-0x64}}`</span><span class="op" id="7013469">}</span><span class="op" id="7013470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013473">{</span><span class="string" id="7013474">`(?:xx|yy)c|(?:xx|yy)d`</span><span class="op" id="7013497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7013501">`cat{alt{str{xx}str{yy}}cc{0x63-0x64}}`</span><span class="op" id="7013540">}</span><span class="op" id="7013541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013544">{</span><span class="string" id="7013545">`x{2}|x{2}[0-9]`</span><span class="op" id="7013561">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7013565">`cat{rep{2,2&nbsp;lit{x}}alt{emp{}cc{0x30-0x39}}}`</span><span class="op" id="7013610">}</span><span class="op" id="7013611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013614">{</span><span class="string" id="7013615">`x{2}y|x{2}[0-9]y`</span><span class="op" id="7013633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7013637">`cat{rep{2,2&nbsp;lit{x}}alt{lit{y}cat{cc{0x30-0x39}lit{y}}}}`</span><span class="op" id="7013694">}</span><span class="op" id="7013695">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7013699">//&nbsp;Valid&nbsp;repetitions.</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013722">{</span><span class="string" id="7013723">`((((((((((x{2}){2}){2}){2}){2}){2}){2}){2}){2}))`</span><span class="op" id="7013773">,</span>&nbsp;<span class="string" id="7013775">``</span><span class="op" id="7013777">}</span><span class="op" id="7013778">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7013781">{</span><span class="string" id="7013782">`((((((((((x{1}){2}){2}){2}){2}){2}){2}){2}){2}){2})`</span><span class="op" id="7013835">,</span>&nbsp;<span class="string" id="7013837">``</span><span class="op" id="7013839">}</span><span class="op" id="7013840">,</span><br>
<span class="lineno"></span><span class="op" id="7013842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7013845">const</span>&nbsp;<span class="ident" id="7013851">testFlags</span>&nbsp;<span class="op" id="7013861">=</span>&nbsp;<span class="ident" id="7013863">MatchNL</span>&nbsp;<span class="op" id="7013871">|</span>&nbsp;<span class="ident" id="7013873">PerlX</span>&nbsp;<span class="op" id="7013879">|</span>&nbsp;<span class="ident" id="7013881">UnicodeGroups</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="7013896">func</span>&nbsp;<span class="ident" id="7013901">TestParseSimple</span><span class="op" id="7013916">(</span><span class="ident" id="7013917">t</span>&nbsp;<span class="op" id="7013919">*</span><span class="ident" id="7013920">testing</span><span class="op" id="7013927">.</span><span class="ident" id="7013928">T</span><span class="op" id="7013929">)</span>&nbsp;<span class="op" id="7013931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7013934">testParseDump</span><span class="op" id="7013947">(</span><span class="ident" id="7013948">t</span><span class="op" id="7013949">,</span>&nbsp;<span class="ident" id="7013951">parseTests</span><span class="op" id="7013961">,</span>&nbsp;<span class="ident" id="7013963">testFlags</span><span class="op" id="7013972">)</span><br>
<span class="lineno"></span><span class="op" id="7013974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="7013977">var</span>&nbsp;<span class="ident" id="7013981">foldcaseTests</span>&nbsp;<span class="op" id="7013995">=</span>&nbsp;<span class="op" id="7013997">[</span><span class="op" id="7013998">]</span><span class="ident" id="7013999">parseTest</span><span class="op" id="7014008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014011">{</span><span class="string" id="7014012">`AbCdE`</span><span class="op" id="7014019">,</span>&nbsp;<span class="string" id="7014021">`strfold{ABCDE}`</span><span class="op" id="7014037">}</span><span class="op" id="7014038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014041">{</span><span class="string" id="7014042">`[Aa]`</span><span class="op" id="7014048">,</span>&nbsp;<span class="string" id="7014050">`litfold{A}`</span><span class="op" id="7014062">}</span><span class="op" id="7014063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014066">{</span><span class="string" id="7014067">`a`</span><span class="op" id="7014070">,</span>&nbsp;<span class="string" id="7014072">`litfold{A}`</span><span class="op" id="7014084">}</span><span class="op" id="7014085">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7014089">//&nbsp;0x17F&nbsp;is&nbsp;an&nbsp;old&nbsp;English&nbsp;long&nbsp;s&nbsp;(looks&nbsp;like&nbsp;an&nbsp;f)&nbsp;and&nbsp;folds&nbsp;to&nbsp;s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7014158">//&nbsp;0x212A&nbsp;is&nbsp;the&nbsp;Kelvin&nbsp;symbol&nbsp;and&nbsp;folds&nbsp;to&nbsp;k.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014206">{</span><span class="string" id="7014207">`A[F-g]`</span><span class="op" id="7014215">,</span>&nbsp;<span class="string" id="7014217">`cat{litfold{A}cc{0x41-0x7a&nbsp;0x17f&nbsp;0x212a}}`</span><span class="op" id="7014260">}</span><span class="op" id="7014261">,</span>&nbsp;<span class="comment" id="7014263">//&nbsp;[Aa][A-z...]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014280">{</span><span class="string" id="7014281">`[[:upper:]]`</span><span class="op" id="7014294">,</span>&nbsp;<span class="string" id="7014296">`cc{0x41-0x5a&nbsp;0x61-0x7a&nbsp;0x17f&nbsp;0x212a}`</span><span class="op" id="7014334">}</span><span class="op" id="7014335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014338">{</span><span class="string" id="7014339">`[[:lower:]]`</span><span class="op" id="7014352">,</span>&nbsp;<span class="string" id="7014354">`cc{0x41-0x5a&nbsp;0x61-0x7a&nbsp;0x17f&nbsp;0x212a}`</span><span class="op" id="7014392">}</span><span class="op" id="7014393">,</span><br>
<span class="lineno">225</span><span class="op" id="7014395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7014398">func</span>&nbsp;<span class="ident" id="7014403">TestParseFoldCase</span><span class="op" id="7014420">(</span><span class="ident" id="7014421">t</span>&nbsp;<span class="op" id="7014423">*</span><span class="ident" id="7014424">testing</span><span class="op" id="7014431">.</span><span class="ident" id="7014432">T</span><span class="op" id="7014433">)</span>&nbsp;<span class="op" id="7014435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014438">testParseDump</span><span class="op" id="7014451">(</span><span class="ident" id="7014452">t</span><span class="op" id="7014453">,</span>&nbsp;<span class="ident" id="7014455">foldcaseTests</span><span class="op" id="7014468">,</span>&nbsp;<span class="ident" id="7014470">FoldCase</span><span class="op" id="7014478">)</span><br>
<span class="lineno"></span><span class="op" id="7014480">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="7014483">var</span>&nbsp;<span class="ident" id="7014487">literalTests</span>&nbsp;<span class="op" id="7014500">=</span>&nbsp;<span class="op" id="7014502">[</span><span class="op" id="7014503">]</span><span class="ident" id="7014504">parseTest</span><span class="op" id="7014513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014516">{</span><span class="string" id="7014517">&#34;(|)^$.[*+?]{5,10},\\&#34;</span><span class="op" id="7014539">,</span>&nbsp;<span class="string" id="7014541">&#34;str{(|)^$.[*+?]{5,10},\\}&#34;</span><span class="op" id="7014568">}</span><span class="op" id="7014569">,</span><br>
<span class="lineno"></span><span class="op" id="7014571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="7014574">func</span>&nbsp;<span class="ident" id="7014579">TestParseLiteral</span><span class="op" id="7014595">(</span><span class="ident" id="7014596">t</span>&nbsp;<span class="op" id="7014598">*</span><span class="ident" id="7014599">testing</span><span class="op" id="7014606">.</span><span class="ident" id="7014607">T</span><span class="op" id="7014608">)</span>&nbsp;<span class="op" id="7014610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014613">testParseDump</span><span class="op" id="7014626">(</span><span class="ident" id="7014627">t</span><span class="op" id="7014628">,</span>&nbsp;<span class="ident" id="7014630">literalTests</span><span class="op" id="7014642">,</span>&nbsp;<span class="ident" id="7014644">Literal</span><span class="op" id="7014651">)</span><br>
<span class="lineno"></span><span class="op" id="7014653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7014656">var</span>&nbsp;<span class="ident" id="7014660">matchnlTests</span>&nbsp;<span class="op" id="7014673">=</span>&nbsp;<span class="op" id="7014675">[</span><span class="op" id="7014676">]</span><span class="ident" id="7014677">parseTest</span><span class="op" id="7014686">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014689">{</span><span class="string" id="7014690">`.`</span><span class="op" id="7014693">,</span>&nbsp;<span class="string" id="7014695">`dot{}`</span><span class="op" id="7014702">}</span><span class="op" id="7014703">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014706">{</span><span class="string" id="7014707">&#34;\n&#34;</span><span class="op" id="7014711">,</span>&nbsp;<span class="string" id="7014713">&#34;lit{\n}&#34;</span><span class="op" id="7014722">}</span><span class="op" id="7014723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014726">{</span><span class="string" id="7014727">`[^a]`</span><span class="op" id="7014733">,</span>&nbsp;<span class="string" id="7014735">`cc{0x0-0x60&nbsp;0x62-0x10ffff}`</span><span class="op" id="7014763">}</span><span class="op" id="7014764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014767">{</span><span class="string" id="7014768">`[a\n]`</span><span class="op" id="7014775">,</span>&nbsp;<span class="string" id="7014777">`cc{0xa&nbsp;0x61}`</span><span class="op" id="7014791">}</span><span class="op" id="7014792">,</span><br>
<span class="lineno"></span><span class="op" id="7014794">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="7014797">func</span>&nbsp;<span class="ident" id="7014802">TestParseMatchNL</span><span class="op" id="7014818">(</span><span class="ident" id="7014819">t</span>&nbsp;<span class="op" id="7014821">*</span><span class="ident" id="7014822">testing</span><span class="op" id="7014829">.</span><span class="ident" id="7014830">T</span><span class="op" id="7014831">)</span>&nbsp;<span class="op" id="7014833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7014836">testParseDump</span><span class="op" id="7014849">(</span><span class="ident" id="7014850">t</span><span class="op" id="7014851">,</span>&nbsp;<span class="ident" id="7014853">matchnlTests</span><span class="op" id="7014865">,</span>&nbsp;<span class="ident" id="7014867">MatchNL</span><span class="op" id="7014874">)</span><br>
<span class="lineno"></span><span class="op" id="7014876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="7014879">var</span>&nbsp;<span class="ident" id="7014883">nomatchnlTests</span>&nbsp;<span class="op" id="7014898">=</span>&nbsp;<span class="op" id="7014900">[</span><span class="op" id="7014901">]</span><span class="ident" id="7014902">parseTest</span><span class="op" id="7014911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014914">{</span><span class="string" id="7014915">`.`</span><span class="op" id="7014918">,</span>&nbsp;<span class="string" id="7014920">`dnl{}`</span><span class="op" id="7014927">}</span><span class="op" id="7014928">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014931">{</span><span class="string" id="7014932">&#34;\n&#34;</span><span class="op" id="7014936">,</span>&nbsp;<span class="string" id="7014938">&#34;lit{\n}&#34;</span><span class="op" id="7014947">}</span><span class="op" id="7014948">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7014951">{</span><span class="string" id="7014952">`[^a]`</span><span class="op" id="7014958">,</span>&nbsp;<span class="string" id="7014960">`cc{0x0-0x9&nbsp;0xb-0x60&nbsp;0x62-0x10ffff}`</span><span class="op" id="7014996">}</span><span class="op" id="7014997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015000">{</span><span class="string" id="7015001">`[a\n]`</span><span class="op" id="7015008">,</span>&nbsp;<span class="string" id="7015010">`cc{0xa&nbsp;0x61}`</span><span class="op" id="7015024">}</span><span class="op" id="7015025">,</span><br>
<span class="lineno">255</span><span class="op" id="7015027">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7015030">func</span>&nbsp;<span class="ident" id="7015035">TestParseNoMatchNL</span><span class="op" id="7015053">(</span><span class="ident" id="7015054">t</span>&nbsp;<span class="op" id="7015056">*</span><span class="ident" id="7015057">testing</span><span class="op" id="7015064">.</span><span class="ident" id="7015065">T</span><span class="op" id="7015066">)</span>&nbsp;<span class="op" id="7015068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015071">testParseDump</span><span class="op" id="7015084">(</span><span class="ident" id="7015085">t</span><span class="op" id="7015086">,</span>&nbsp;<span class="ident" id="7015088">nomatchnlTests</span><span class="op" id="7015102">,</span>&nbsp;<span class="num" id="7015104">0</span><span class="op" id="7015105">)</span><br>
<span class="lineno"></span><span class="op" id="7015107">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="comment" id="7015110">//&nbsp;Test&nbsp;Parse&nbsp;-&gt;&nbsp;Dump.</span><br>
<span class="lineno"></span><span class="keyword" id="7015133">func</span>&nbsp;<span class="ident" id="7015138">testParseDump</span><span class="op" id="7015151">(</span><span class="ident" id="7015152">t</span>&nbsp;<span class="op" id="7015154">*</span><span class="ident" id="7015155">testing</span><span class="op" id="7015162">.</span><span class="ident" id="7015163">T</span><span class="op" id="7015164">,</span>&nbsp;<span class="ident" id="7015166">tests</span>&nbsp;<span class="op" id="7015172">[</span><span class="op" id="7015173">]</span><span class="ident" id="7015174">parseTest</span><span class="op" id="7015183">,</span>&nbsp;<span class="ident" id="7015185">flags</span>&nbsp;<span class="ident" id="7015191">Flags</span><span class="op" id="7015196">)</span>&nbsp;<span class="op" id="7015198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015201">for</span>&nbsp;<span class="ident" id="7015205">_</span><span class="op" id="7015206">,</span>&nbsp;<span class="ident" id="7015208">tt</span>&nbsp;<span class="op" id="7015211">:=</span>&nbsp;<span class="keyword" id="7015214">range</span>&nbsp;<span class="ident" id="7015220">tests</span>&nbsp;<span class="op" id="7015226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015230">re</span><span class="op" id="7015232">,</span>&nbsp;<span class="ident" id="7015234">err</span>&nbsp;<span class="op" id="7015238">:=</span>&nbsp;<span class="ident" id="7015241">Parse</span><span class="op" id="7015246">(</span><span class="ident" id="7015247">tt</span><span class="op" id="7015249">.</span><span class="ident" id="7015250">Regexp</span><span class="op" id="7015256">,</span>&nbsp;<span class="ident" id="7015258">flags</span><span class="op" id="7015263">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015267">if</span>&nbsp;<span class="ident" id="7015270">err</span>&nbsp;<span class="op" id="7015274">!=</span>&nbsp;<span class="ident" id="7015277">nil</span>&nbsp;<span class="op" id="7015281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015286">t</span><span class="op" id="7015287">.</span><span class="ident" id="7015288">Errorf</span><span class="op" id="7015294">(</span><span class="string" id="7015295">&#34;Parse(%#q):&nbsp;%v&#34;</span><span class="op" id="7015311">,</span>&nbsp;<span class="ident" id="7015313">tt</span><span class="op" id="7015315">.</span><span class="ident" id="7015316">Regexp</span><span class="op" id="7015322">,</span>&nbsp;<span class="ident" id="7015324">err</span><span class="op" id="7015327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015332">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015347">if</span>&nbsp;<span class="ident" id="7015350">tt</span><span class="op" id="7015352">.</span><span class="ident" id="7015353">Dump</span>&nbsp;<span class="op" id="7015358">==</span>&nbsp;<span class="string" id="7015361">&#34;&#34;</span>&nbsp;<span class="op" id="7015364">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7015369">//&nbsp;It&nbsp;parsed.&nbsp;That&#39;s&nbsp;all&nbsp;we&nbsp;care&nbsp;about.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015412">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015427">d</span>&nbsp;<span class="op" id="7015429">:=</span>&nbsp;<span class="ident" id="7015432">dump</span><span class="op" id="7015436">(</span><span class="ident" id="7015437">re</span><span class="op" id="7015439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015443">if</span>&nbsp;<span class="ident" id="7015446">d</span>&nbsp;<span class="op" id="7015448">!=</span>&nbsp;<span class="ident" id="7015451">tt</span><span class="op" id="7015453">.</span><span class="ident" id="7015454">Dump</span>&nbsp;<span class="op" id="7015459">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015464">t</span><span class="op" id="7015465">.</span><span class="ident" id="7015466">Errorf</span><span class="op" id="7015472">(</span><span class="string" id="7015473">&#34;Parse(%#q).Dump()&nbsp;=&nbsp;%#q&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="7015507">,</span>&nbsp;<span class="ident" id="7015509">tt</span><span class="op" id="7015511">.</span><span class="ident" id="7015512">Regexp</span><span class="op" id="7015518">,</span>&nbsp;<span class="ident" id="7015520">d</span><span class="op" id="7015521">,</span>&nbsp;<span class="ident" id="7015523">tt</span><span class="op" id="7015525">.</span><span class="ident" id="7015526">Dump</span><span class="op" id="7015530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015534">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7015537">}</span><br>
<span class="lineno"></span><span class="op" id="7015539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="comment" id="7015542">//&nbsp;dump&nbsp;prints&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;the&nbsp;regexp&nbsp;showing</span><br>
<span class="lineno"></span><span class="comment" id="7015603">//&nbsp;the&nbsp;structure&nbsp;explicitly.</span><br>
<span class="lineno"></span><span class="keyword" id="7015632">func</span>&nbsp;<span class="ident" id="7015637">dump</span><span class="op" id="7015641">(</span><span class="ident" id="7015642">re</span>&nbsp;<span class="op" id="7015645">*</span><span class="ident" id="7015646">Regexp</span><span class="op" id="7015652">)</span>&nbsp;<span class="builtintype" id="7015654">string</span>&nbsp;<span class="op" id="7015661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015664">var</span>&nbsp;<span class="ident" id="7015668">b</span>&nbsp;<span class="ident" id="7015670">bytes</span><span class="op" id="7015675">.</span><span class="ident" id="7015676">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015684">dumpRegexp</span><span class="op" id="7015694">(</span><span class="op" id="7015695">&amp;</span><span class="ident" id="7015696">b</span><span class="op" id="7015697">,</span>&nbsp;<span class="ident" id="7015699">re</span><span class="op" id="7015701">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7015704">return</span>&nbsp;<span class="ident" id="7015711">b</span><span class="op" id="7015712">.</span><span class="ident" id="7015713">String</span><span class="op" id="7015719">(</span><span class="op" id="7015720">)</span><br>
<span class="lineno"></span><span class="op" id="7015722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7015725">var</span>&nbsp;<span class="ident" id="7015729">opNames</span>&nbsp;<span class="op" id="7015737">=</span>&nbsp;<span class="op" id="7015739">[</span><span class="op" id="7015740">]</span><span class="builtintype" id="7015741">string</span><span class="op" id="7015747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015750">OpNoMatch</span><span class="op" id="7015759">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7015768">&#34;no&#34;</span><span class="op" id="7015772">,</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015775">OpEmptyMatch</span><span class="op" id="7015787">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7015793">&#34;emp&#34;</span><span class="op" id="7015798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015801">OpLiteral</span><span class="op" id="7015810">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7015819">&#34;lit&#34;</span><span class="op" id="7015824">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015827">OpCharClass</span><span class="op" id="7015838">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7015845">&#34;cc&#34;</span><span class="op" id="7015849">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015852">OpAnyCharNotNL</span><span class="op" id="7015866">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7015870">&#34;dnl&#34;</span><span class="op" id="7015875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015878">OpAnyChar</span><span class="op" id="7015887">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7015896">&#34;dot&#34;</span><span class="op" id="7015901">,</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015904">OpBeginLine</span><span class="op" id="7015915">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7015922">&#34;bol&#34;</span><span class="op" id="7015927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015930">OpEndLine</span><span class="op" id="7015939">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7015948">&#34;eol&#34;</span><span class="op" id="7015953">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015956">OpBeginText</span><span class="op" id="7015967">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7015974">&#34;bot&#34;</span><span class="op" id="7015979">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7015982">OpEndText</span><span class="op" id="7015991">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7016000">&#34;eot&#34;</span><span class="op" id="7016005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016008">OpWordBoundary</span><span class="op" id="7016022">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="7016026">&#34;wb&#34;</span><span class="op" id="7016030">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016033">OpNoWordBoundary</span><span class="op" id="7016049">:</span>&nbsp;<span class="string" id="7016051">&#34;nwb&#34;</span><span class="op" id="7016056">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016059">OpCapture</span><span class="op" id="7016068">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7016077">&#34;cap&#34;</span><span class="op" id="7016082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016085">OpStar</span><span class="op" id="7016091">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7016103">&#34;star&#34;</span><span class="op" id="7016109">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016112">OpPlus</span><span class="op" id="7016118">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7016130">&#34;plus&#34;</span><span class="op" id="7016136">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016139">OpQuest</span><span class="op" id="7016146">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7016157">&#34;que&#34;</span><span class="op" id="7016162">,</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016165">OpRepeat</span><span class="op" id="7016173">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7016183">&#34;rep&#34;</span><span class="op" id="7016188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016191">OpConcat</span><span class="op" id="7016199">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7016209">&#34;cat&#34;</span><span class="op" id="7016214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016217">OpAlternate</span><span class="op" id="7016228">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7016235">&#34;alt&#34;</span><span class="op" id="7016240">,</span><br>
<span class="lineno"></span><span class="op" id="7016242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="7016245">//&nbsp;dumpRegexp&nbsp;writes&nbsp;an&nbsp;encoding&nbsp;of&nbsp;the&nbsp;syntax&nbsp;tree&nbsp;for&nbsp;the&nbsp;regexp&nbsp;re&nbsp;to&nbsp;b.</span><br>
<span class="lineno"></span><span class="comment" id="7016321">//&nbsp;It&nbsp;is&nbsp;used&nbsp;during&nbsp;testing&nbsp;to&nbsp;distinguish&nbsp;between&nbsp;parses&nbsp;that&nbsp;might&nbsp;print</span><br>
<span class="lineno"></span><span class="comment" id="7016397">//&nbsp;the&nbsp;same&nbsp;using&nbsp;re&#39;s&nbsp;String&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="7016435">func</span>&nbsp;<span class="ident" id="7016440">dumpRegexp</span><span class="op" id="7016450">(</span><span class="ident" id="7016451">b</span>&nbsp;<span class="op" id="7016453">*</span><span class="ident" id="7016454">bytes</span><span class="op" id="7016459">.</span><span class="ident" id="7016460">Buffer</span><span class="op" id="7016466">,</span>&nbsp;<span class="ident" id="7016468">re</span>&nbsp;<span class="op" id="7016471">*</span><span class="ident" id="7016472">Regexp</span><span class="op" id="7016478">)</span>&nbsp;<span class="op" id="7016480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7016483">if</span>&nbsp;<span class="builtintype" id="7016486">int</span><span class="op" id="7016489">(</span><span class="ident" id="7016490">re</span><span class="op" id="7016492">.</span><span class="ident" id="7016493">Op</span><span class="op" id="7016495">)</span>&nbsp;<span class="op" id="7016497">&gt;=</span>&nbsp;<span class="builtinfunc" id="7016500">len</span><span class="op" id="7016503">(</span><span class="ident" id="7016504">opNames</span><span class="op" id="7016511">)</span>&nbsp;<span class="op" id="7016513">||</span>&nbsp;<span class="ident" id="7016516">opNames</span><span class="op" id="7016523">[</span><span class="ident" id="7016524">re</span><span class="op" id="7016526">.</span><span class="ident" id="7016527">Op</span><span class="op" id="7016529">]</span>&nbsp;<span class="op" id="7016531">==</span>&nbsp;<span class="string" id="7016534">&#34;&#34;</span>&nbsp;<span class="op" id="7016537">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016541">fmt</span><span class="op" id="7016544">.</span><span class="ident" id="7016545">Fprintf</span><span class="op" id="7016552">(</span><span class="ident" id="7016553">b</span><span class="op" id="7016554">,</span>&nbsp;<span class="string" id="7016556">&#34;op%d&#34;</span><span class="op" id="7016562">,</span>&nbsp;<span class="ident" id="7016564">re</span><span class="op" id="7016566">.</span><span class="ident" id="7016567">Op</span><span class="op" id="7016569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7016572">}</span>&nbsp;<span class="keyword" id="7016574">else</span>&nbsp;<span class="op" id="7016579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7016583">switch</span>&nbsp;<span class="ident" id="7016590">re</span><span class="op" id="7016592">.</span><span class="ident" id="7016593">Op</span>&nbsp;<span class="op" id="7016596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7016600">default</span><span class="op" id="7016607">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016612">b</span><span class="op" id="7016613">.</span><span class="ident" id="7016614">WriteString</span><span class="op" id="7016625">(</span><span class="ident" id="7016626">opNames</span><span class="op" id="7016633">[</span><span class="ident" id="7016634">re</span><span class="op" id="7016636">.</span><span class="ident" id="7016637">Op</span><span class="op" id="7016639">]</span><span class="op" id="7016640">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7016644">case</span>&nbsp;<span class="ident" id="7016649">OpStar</span><span class="op" id="7016655">,</span>&nbsp;<span class="ident" id="7016657">OpPlus</span><span class="op" id="7016663">,</span>&nbsp;<span class="ident" id="7016665">OpQuest</span><span class="op" id="7016672">,</span>&nbsp;<span class="ident" id="7016674">OpRepeat</span><span class="op" id="7016682">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7016687">if</span>&nbsp;<span class="ident" id="7016690">re</span><span class="op" id="7016692">.</span><span class="ident" id="7016693">Flags</span><span class="op" id="7016698">&amp;</span><span class="ident" id="7016699">NonGreedy</span>&nbsp;<span class="op" id="7016709">!=</span>&nbsp;<span class="num" id="7016712">0</span>&nbsp;<span class="op" id="7016714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016720">b</span><span class="op" id="7016721">.</span><span class="ident" id="7016722">WriteByte</span><span class="op" id="7016731">(</span><span class="string" id="7016732">&#39;n&#39;</span><span class="op" id="7016735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7016740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016745">b</span><span class="op" id="7016746">.</span><span class="ident" id="7016747">WriteString</span><span class="op" id="7016758">(</span><span class="ident" id="7016759">opNames</span><span class="op" id="7016766">[</span><span class="ident" id="7016767">re</span><span class="op" id="7016769">.</span><span class="ident" id="7016770">Op</span><span class="op" id="7016772">]</span><span class="op" id="7016773">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7016777">case</span>&nbsp;<span class="ident" id="7016782">OpLiteral</span><span class="op" id="7016791">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7016796">if</span>&nbsp;<span class="builtinfunc" id="7016799">len</span><span class="op" id="7016802">(</span><span class="ident" id="7016803">re</span><span class="op" id="7016805">.</span><span class="ident" id="7016806">Rune</span><span class="op" id="7016810">)</span>&nbsp;<span class="op" id="7016812">&gt;</span>&nbsp;<span class="num" id="7016814">1</span>&nbsp;<span class="op" id="7016816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016822">b</span><span class="op" id="7016823">.</span><span class="ident" id="7016824">WriteString</span><span class="op" id="7016835">(</span><span class="string" id="7016836">&#34;str&#34;</span><span class="op" id="7016841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7016846">}</span>&nbsp;<span class="keyword" id="7016848">else</span>&nbsp;<span class="op" id="7016853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016859">b</span><span class="op" id="7016860">.</span><span class="ident" id="7016861">WriteString</span><span class="op" id="7016872">(</span><span class="string" id="7016873">&#34;lit&#34;</span><span class="op" id="7016878">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7016883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7016888">if</span>&nbsp;<span class="ident" id="7016891">re</span><span class="op" id="7016893">.</span><span class="ident" id="7016894">Flags</span><span class="op" id="7016899">&amp;</span><span class="ident" id="7016900">FoldCase</span>&nbsp;<span class="op" id="7016909">!=</span>&nbsp;<span class="num" id="7016912">0</span>&nbsp;<span class="op" id="7016914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7016920">for</span>&nbsp;<span class="ident" id="7016924">_</span><span class="op" id="7016925">,</span>&nbsp;<span class="ident" id="7016927">r</span>&nbsp;<span class="op" id="7016929">:=</span>&nbsp;<span class="keyword" id="7016932">range</span>&nbsp;<span class="ident" id="7016938">re</span><span class="op" id="7016940">.</span><span class="ident" id="7016941">Rune</span>&nbsp;<span class="op" id="7016946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7016953">if</span>&nbsp;<span class="ident" id="7016956">unicode</span><span class="op" id="7016963">.</span><span class="ident" id="7016964">SimpleFold</span><span class="op" id="7016974">(</span><span class="ident" id="7016975">r</span><span class="op" id="7016976">)</span>&nbsp;<span class="op" id="7016978">!=</span>&nbsp;<span class="ident" id="7016981">r</span>&nbsp;<span class="op" id="7016983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7016991">b</span><span class="op" id="7016992">.</span><span class="ident" id="7016993">WriteString</span><span class="op" id="7017004">(</span><span class="string" id="7017005">&#34;fold&#34;</span><span class="op" id="7017011">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017019">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017045">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017051">b</span><span class="op" id="7017052">.</span><span class="ident" id="7017053">WriteByte</span><span class="op" id="7017062">(</span><span class="string" id="7017063">&#39;{&#39;</span><span class="op" id="7017066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017069">switch</span>&nbsp;<span class="ident" id="7017076">re</span><span class="op" id="7017078">.</span><span class="ident" id="7017079">Op</span>&nbsp;<span class="op" id="7017082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017085">case</span>&nbsp;<span class="ident" id="7017090">OpEndText</span><span class="op" id="7017099">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017103">if</span>&nbsp;<span class="ident" id="7017106">re</span><span class="op" id="7017108">.</span><span class="ident" id="7017109">Flags</span><span class="op" id="7017114">&amp;</span><span class="ident" id="7017115">WasDollar</span>&nbsp;<span class="op" id="7017125">==</span>&nbsp;<span class="num" id="7017128">0</span>&nbsp;<span class="op" id="7017130">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017135">b</span><span class="op" id="7017136">.</span><span class="ident" id="7017137">WriteString</span><span class="op" id="7017148">(</span><span class="string" id="7017149">`\z`</span><span class="op" id="7017153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017157">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017160">case</span>&nbsp;<span class="ident" id="7017165">OpLiteral</span><span class="op" id="7017174">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017178">for</span>&nbsp;<span class="ident" id="7017182">_</span><span class="op" id="7017183">,</span>&nbsp;<span class="ident" id="7017185">r</span>&nbsp;<span class="op" id="7017187">:=</span>&nbsp;<span class="keyword" id="7017190">range</span>&nbsp;<span class="ident" id="7017196">re</span><span class="op" id="7017198">.</span><span class="ident" id="7017199">Rune</span>&nbsp;<span class="op" id="7017204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017209">b</span><span class="op" id="7017210">.</span><span class="ident" id="7017211">WriteRune</span><span class="op" id="7017220">(</span><span class="ident" id="7017221">r</span><span class="op" id="7017222">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017229">case</span>&nbsp;<span class="ident" id="7017234">OpConcat</span><span class="op" id="7017242">,</span>&nbsp;<span class="ident" id="7017244">OpAlternate</span><span class="op" id="7017255">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017259">for</span>&nbsp;<span class="ident" id="7017263">_</span><span class="op" id="7017264">,</span>&nbsp;<span class="ident" id="7017266">sub</span>&nbsp;<span class="op" id="7017270">:=</span>&nbsp;<span class="keyword" id="7017273">range</span>&nbsp;<span class="ident" id="7017279">re</span><span class="op" id="7017281">.</span><span class="ident" id="7017282">Sub</span>&nbsp;<span class="op" id="7017286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017291">dumpRegexp</span><span class="op" id="7017301">(</span><span class="ident" id="7017302">b</span><span class="op" id="7017303">,</span>&nbsp;<span class="ident" id="7017305">sub</span><span class="op" id="7017308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017312">}</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017315">case</span>&nbsp;<span class="ident" id="7017320">OpStar</span><span class="op" id="7017326">,</span>&nbsp;<span class="ident" id="7017328">OpPlus</span><span class="op" id="7017334">,</span>&nbsp;<span class="ident" id="7017336">OpQuest</span><span class="op" id="7017343">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017347">dumpRegexp</span><span class="op" id="7017357">(</span><span class="ident" id="7017358">b</span><span class="op" id="7017359">,</span>&nbsp;<span class="ident" id="7017361">re</span><span class="op" id="7017363">.</span><span class="ident" id="7017364">Sub</span><span class="op" id="7017367">[</span><span class="num" id="7017368">0</span><span class="op" id="7017369">]</span><span class="op" id="7017370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017373">case</span>&nbsp;<span class="ident" id="7017378">OpRepeat</span><span class="op" id="7017386">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017390">fmt</span><span class="op" id="7017393">.</span><span class="ident" id="7017394">Fprintf</span><span class="op" id="7017401">(</span><span class="ident" id="7017402">b</span><span class="op" id="7017403">,</span>&nbsp;<span class="string" id="7017405">&#34;%d,%d&nbsp;&#34;</span><span class="op" id="7017413">,</span>&nbsp;<span class="ident" id="7017415">re</span><span class="op" id="7017417">.</span><span class="ident" id="7017418">Min</span><span class="op" id="7017421">,</span>&nbsp;<span class="ident" id="7017423">re</span><span class="op" id="7017425">.</span><span class="ident" id="7017426">Max</span><span class="op" id="7017429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017433">dumpRegexp</span><span class="op" id="7017443">(</span><span class="ident" id="7017444">b</span><span class="op" id="7017445">,</span>&nbsp;<span class="ident" id="7017447">re</span><span class="op" id="7017449">.</span><span class="ident" id="7017450">Sub</span><span class="op" id="7017453">[</span><span class="num" id="7017454">0</span><span class="op" id="7017455">]</span><span class="op" id="7017456">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017459">case</span>&nbsp;<span class="ident" id="7017464">OpCapture</span><span class="op" id="7017473">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017477">if</span>&nbsp;<span class="ident" id="7017480">re</span><span class="op" id="7017482">.</span><span class="ident" id="7017483">Name</span>&nbsp;<span class="op" id="7017488">!=</span>&nbsp;<span class="string" id="7017491">&#34;&#34;</span>&nbsp;<span class="op" id="7017494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017499">b</span><span class="op" id="7017500">.</span><span class="ident" id="7017501">WriteString</span><span class="op" id="7017512">(</span><span class="ident" id="7017513">re</span><span class="op" id="7017515">.</span><span class="ident" id="7017516">Name</span><span class="op" id="7017520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017525">b</span><span class="op" id="7017526">.</span><span class="ident" id="7017527">WriteByte</span><span class="op" id="7017536">(</span><span class="string" id="7017537">&#39;:&#39;</span><span class="op" id="7017540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017544">}</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017548">dumpRegexp</span><span class="op" id="7017558">(</span><span class="ident" id="7017559">b</span><span class="op" id="7017560">,</span>&nbsp;<span class="ident" id="7017562">re</span><span class="op" id="7017564">.</span><span class="ident" id="7017565">Sub</span><span class="op" id="7017568">[</span><span class="num" id="7017569">0</span><span class="op" id="7017570">]</span><span class="op" id="7017571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017574">case</span>&nbsp;<span class="ident" id="7017579">OpCharClass</span><span class="op" id="7017590">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017594">sep</span>&nbsp;<span class="op" id="7017598">:=</span>&nbsp;<span class="string" id="7017601">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017606">for</span>&nbsp;<span class="ident" id="7017610">i</span>&nbsp;<span class="op" id="7017612">:=</span>&nbsp;<span class="num" id="7017615">0</span><span class="op" id="7017616">;</span>&nbsp;<span class="ident" id="7017618">i</span>&nbsp;<span class="op" id="7017620">&lt;</span>&nbsp;<span class="builtinfunc" id="7017622">len</span><span class="op" id="7017625">(</span><span class="ident" id="7017626">re</span><span class="op" id="7017628">.</span><span class="ident" id="7017629">Rune</span><span class="op" id="7017633">)</span><span class="op" id="7017634">;</span>&nbsp;<span class="ident" id="7017636">i</span>&nbsp;<span class="op" id="7017638">+=</span>&nbsp;<span class="num" id="7017641">2</span>&nbsp;<span class="op" id="7017643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017648">b</span><span class="op" id="7017649">.</span><span class="ident" id="7017650">WriteString</span><span class="op" id="7017661">(</span><span class="ident" id="7017662">sep</span><span class="op" id="7017665">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017670">sep</span>&nbsp;<span class="op" id="7017674">=</span>&nbsp;<span class="string" id="7017676">&#34;&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017683">lo</span><span class="op" id="7017685">,</span>&nbsp;<span class="ident" id="7017687">hi</span>&nbsp;<span class="op" id="7017690">:=</span>&nbsp;<span class="ident" id="7017693">re</span><span class="op" id="7017695">.</span><span class="ident" id="7017696">Rune</span><span class="op" id="7017700">[</span><span class="ident" id="7017701">i</span><span class="op" id="7017702">]</span><span class="op" id="7017703">,</span>&nbsp;<span class="ident" id="7017705">re</span><span class="op" id="7017707">.</span><span class="ident" id="7017708">Rune</span><span class="op" id="7017712">[</span><span class="ident" id="7017713">i</span><span class="op" id="7017714">+</span><span class="num" id="7017715">1</span><span class="op" id="7017716">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017721">if</span>&nbsp;<span class="ident" id="7017724">lo</span>&nbsp;<span class="op" id="7017727">==</span>&nbsp;<span class="ident" id="7017730">hi</span>&nbsp;<span class="op" id="7017733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017739">fmt</span><span class="op" id="7017742">.</span><span class="ident" id="7017743">Fprintf</span><span class="op" id="7017750">(</span><span class="ident" id="7017751">b</span><span class="op" id="7017752">,</span>&nbsp;<span class="string" id="7017754">&#34;%#x&#34;</span><span class="op" id="7017759">,</span>&nbsp;<span class="ident" id="7017761">lo</span><span class="op" id="7017763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017768">}</span>&nbsp;<span class="keyword" id="7017770">else</span>&nbsp;<span class="op" id="7017775">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017781">fmt</span><span class="op" id="7017784">.</span><span class="ident" id="7017785">Fprintf</span><span class="op" id="7017792">(</span><span class="ident" id="7017793">b</span><span class="op" id="7017794">,</span>&nbsp;<span class="string" id="7017796">&#34;%#x-%#x&#34;</span><span class="op" id="7017805">,</span>&nbsp;<span class="ident" id="7017807">lo</span><span class="op" id="7017809">,</span>&nbsp;<span class="ident" id="7017811">hi</span><span class="op" id="7017813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7017825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017828">b</span><span class="op" id="7017829">.</span><span class="ident" id="7017830">WriteByte</span><span class="op" id="7017839">(</span><span class="string" id="7017840">&#39;}&#39;</span><span class="op" id="7017843">)</span><br>
<span class="lineno">380</span><span class="op" id="7017845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7017848">func</span>&nbsp;<span class="ident" id="7017853">mkCharClass</span><span class="op" id="7017864">(</span><span class="ident" id="7017865">f</span>&nbsp;<span class="keyword" id="7017867">func</span><span class="op" id="7017871">(</span><span class="builtintype" id="7017872">rune</span><span class="op" id="7017876">)</span>&nbsp;<span class="builtintype" id="7017878">bool</span><span class="op" id="7017882">)</span>&nbsp;<span class="builtintype" id="7017884">string</span>&nbsp;<span class="op" id="7017891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017894">re</span>&nbsp;<span class="op" id="7017897">:=</span>&nbsp;<span class="op" id="7017900">&amp;</span><span class="ident" id="7017901">Regexp</span><span class="op" id="7017907">{</span><span class="ident" id="7017908">Op</span><span class="op" id="7017910">:</span>&nbsp;<span class="ident" id="7017912">OpCharClass</span><span class="op" id="7017923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7017926">lo</span>&nbsp;<span class="op" id="7017929">:=</span>&nbsp;<span class="builtintype" id="7017932">rune</span><span class="op" id="7017936">(</span><span class="op" id="7017937">-</span><span class="num" id="7017938">1</span><span class="op" id="7017939">)</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017942">for</span>&nbsp;<span class="ident" id="7017946">i</span>&nbsp;<span class="op" id="7017948">:=</span>&nbsp;<span class="builtintype" id="7017951">rune</span><span class="op" id="7017955">(</span><span class="num" id="7017956">0</span><span class="op" id="7017957">)</span><span class="op" id="7017958">;</span>&nbsp;<span class="ident" id="7017960">i</span>&nbsp;<span class="op" id="7017962">&lt;=</span>&nbsp;<span class="ident" id="7017965">unicode</span><span class="op" id="7017972">.</span><span class="ident" id="7017973">MaxRune</span><span class="op" id="7017980">;</span>&nbsp;<span class="ident" id="7017982">i</span><span class="op" id="7017983">++</span>&nbsp;<span class="op" id="7017986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7017990">if</span>&nbsp;<span class="ident" id="7017993">f</span><span class="op" id="7017994">(</span><span class="ident" id="7017995">i</span><span class="op" id="7017996">)</span>&nbsp;<span class="op" id="7017998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7018003">if</span>&nbsp;<span class="ident" id="7018006">lo</span>&nbsp;<span class="op" id="7018009">&lt;</span>&nbsp;<span class="num" id="7018011">0</span>&nbsp;<span class="op" id="7018013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018019">lo</span>&nbsp;<span class="op" id="7018022">=</span>&nbsp;<span class="ident" id="7018024">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018029">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018033">}</span>&nbsp;<span class="keyword" id="7018035">else</span>&nbsp;<span class="op" id="7018040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7018045">if</span>&nbsp;<span class="ident" id="7018048">lo</span>&nbsp;<span class="op" id="7018051">&gt;=</span>&nbsp;<span class="num" id="7018054">0</span>&nbsp;<span class="op" id="7018056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018062">re</span><span class="op" id="7018064">.</span><span class="ident" id="7018065">Rune</span>&nbsp;<span class="op" id="7018070">=</span>&nbsp;<span class="builtinfunc" id="7018072">append</span><span class="op" id="7018078">(</span><span class="ident" id="7018079">re</span><span class="op" id="7018081">.</span><span class="ident" id="7018082">Rune</span><span class="op" id="7018086">,</span>&nbsp;<span class="ident" id="7018088">lo</span><span class="op" id="7018090">,</span>&nbsp;<span class="ident" id="7018092">i</span><span class="op" id="7018093">-</span><span class="num" id="7018094">1</span><span class="op" id="7018095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018101">lo</span>&nbsp;<span class="op" id="7018104">=</span>&nbsp;<span class="op" id="7018106">-</span><span class="num" id="7018107">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018112">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7018122">if</span>&nbsp;<span class="ident" id="7018125">lo</span>&nbsp;<span class="op" id="7018128">&gt;=</span>&nbsp;<span class="num" id="7018131">0</span>&nbsp;<span class="op" id="7018133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018137">re</span><span class="op" id="7018139">.</span><span class="ident" id="7018140">Rune</span>&nbsp;<span class="op" id="7018145">=</span>&nbsp;<span class="builtinfunc" id="7018147">append</span><span class="op" id="7018153">(</span><span class="ident" id="7018154">re</span><span class="op" id="7018156">.</span><span class="ident" id="7018157">Rune</span><span class="op" id="7018161">,</span>&nbsp;<span class="ident" id="7018163">lo</span><span class="op" id="7018165">,</span>&nbsp;<span class="ident" id="7018167">unicode</span><span class="op" id="7018174">.</span><span class="ident" id="7018175">MaxRune</span><span class="op" id="7018182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018185">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7018188">return</span>&nbsp;<span class="ident" id="7018195">dump</span><span class="op" id="7018199">(</span><span class="ident" id="7018200">re</span><span class="op" id="7018202">)</span><br>
<span class="lineno"></span><span class="op" id="7018204">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7018207">func</span>&nbsp;<span class="ident" id="7018212">isUpperFold</span><span class="op" id="7018223">(</span><span class="ident" id="7018224">r</span>&nbsp;<span class="builtintype" id="7018226">rune</span><span class="op" id="7018230">)</span>&nbsp;<span class="builtintype" id="7018232">bool</span>&nbsp;<span class="op" id="7018237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7018240">if</span>&nbsp;<span class="ident" id="7018243">unicode</span><span class="op" id="7018250">.</span><span class="ident" id="7018251">IsUpper</span><span class="op" id="7018258">(</span><span class="ident" id="7018259">r</span><span class="op" id="7018260">)</span>&nbsp;<span class="op" id="7018262">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7018266">return</span>&nbsp;<span class="builtintype" id="7018273">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018282">c</span>&nbsp;<span class="op" id="7018284">:=</span>&nbsp;<span class="ident" id="7018287">unicode</span><span class="op" id="7018294">.</span><span class="ident" id="7018295">SimpleFold</span><span class="op" id="7018305">(</span><span class="ident" id="7018306">r</span><span class="op" id="7018307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7018310">for</span>&nbsp;<span class="ident" id="7018314">c</span>&nbsp;<span class="op" id="7018316">!=</span>&nbsp;<span class="ident" id="7018319">r</span>&nbsp;<span class="op" id="7018321">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7018325">if</span>&nbsp;<span class="ident" id="7018328">unicode</span><span class="op" id="7018335">.</span><span class="ident" id="7018336">IsUpper</span><span class="op" id="7018343">(</span><span class="ident" id="7018344">c</span><span class="op" id="7018345">)</span>&nbsp;<span class="op" id="7018347">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7018352">return</span>&nbsp;<span class="builtintype" id="7018359">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018366">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018370">c</span>&nbsp;<span class="op" id="7018372">=</span>&nbsp;<span class="ident" id="7018374">unicode</span><span class="op" id="7018381">.</span><span class="ident" id="7018382">SimpleFold</span><span class="op" id="7018392">(</span><span class="ident" id="7018393">c</span><span class="op" id="7018394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7018400">return</span>&nbsp;<span class="builtintype" id="7018407">false</span><br>
<span class="lineno">415</span><span class="op" id="7018413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7018416">func</span>&nbsp;<span class="ident" id="7018421">TestFoldConstants</span><span class="op" id="7018438">(</span><span class="ident" id="7018439">t</span>&nbsp;<span class="op" id="7018441">*</span><span class="ident" id="7018442">testing</span><span class="op" id="7018449">.</span><span class="ident" id="7018450">T</span><span class="op" id="7018451">)</span>&nbsp;<span class="op" id="7018453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018456">last</span>&nbsp;<span class="op" id="7018461">:=</span>&nbsp;<span class="builtintype" id="7018464">rune</span><span class="op" id="7018468">(</span><span class="op" id="7018469">-</span><span class="num" id="7018470">1</span><span class="op" id="7018471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7018474">for</span>&nbsp;<span class="ident" id="7018478">i</span>&nbsp;<span class="op" id="7018480">:=</span>&nbsp;<span class="builtintype" id="7018483">rune</span><span class="op" id="7018487">(</span><span class="num" id="7018488">0</span><span class="op" id="7018489">)</span><span class="op" id="7018490">;</span>&nbsp;<span class="ident" id="7018492">i</span>&nbsp;<span class="op" id="7018494">&lt;=</span>&nbsp;<span class="ident" id="7018497">unicode</span><span class="op" id="7018504">.</span><span class="ident" id="7018505">MaxRune</span><span class="op" id="7018512">;</span>&nbsp;<span class="ident" id="7018514">i</span><span class="op" id="7018515">++</span>&nbsp;<span class="op" id="7018518">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7018522">if</span>&nbsp;<span class="ident" id="7018525">unicode</span><span class="op" id="7018532">.</span><span class="ident" id="7018533">SimpleFold</span><span class="op" id="7018543">(</span><span class="ident" id="7018544">i</span><span class="op" id="7018545">)</span>&nbsp;<span class="op" id="7018547">==</span>&nbsp;<span class="ident" id="7018550">i</span>&nbsp;<span class="op" id="7018552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7018557">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7018572">if</span>&nbsp;<span class="ident" id="7018575">last</span>&nbsp;<span class="op" id="7018580">==</span>&nbsp;<span class="op" id="7018583">-</span><span class="num" id="7018584">1</span>&nbsp;<span class="op" id="7018586">&amp;&amp;</span>&nbsp;<span class="ident" id="7018589">minFold</span>&nbsp;<span class="op" id="7018597">!=</span>&nbsp;<span class="ident" id="7018600">i</span>&nbsp;<span class="op" id="7018602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018607">t</span><span class="op" id="7018608">.</span><span class="ident" id="7018609">Errorf</span><span class="op" id="7018615">(</span><span class="string" id="7018616">&#34;minFold=%#U&nbsp;should&nbsp;be&nbsp;%#U&#34;</span><span class="op" id="7018643">,</span>&nbsp;<span class="ident" id="7018645">minFold</span><span class="op" id="7018652">,</span>&nbsp;<span class="ident" id="7018654">i</span><span class="op" id="7018655">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018663">last</span>&nbsp;<span class="op" id="7018668">=</span>&nbsp;<span class="ident" id="7018670">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7018676">if</span>&nbsp;<span class="ident" id="7018679">maxFold</span>&nbsp;<span class="op" id="7018687">!=</span>&nbsp;<span class="ident" id="7018690">last</span>&nbsp;<span class="op" id="7018695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7018699">t</span><span class="op" id="7018700">.</span><span class="ident" id="7018701">Errorf</span><span class="op" id="7018707">(</span><span class="string" id="7018708">&#34;maxFold=%#U&nbsp;should&nbsp;be&nbsp;%#U&#34;</span><span class="op" id="7018735">,</span>&nbsp;<span class="ident" id="7018737">maxFold</span><span class="op" id="7018744">,</span>&nbsp;<span class="ident" id="7018746">last</span><span class="op" id="7018750">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7018753">}</span><br>
<span class="lineno"></span><span class="op" id="7018755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7018758">func</span>&nbsp;<span class="ident" id="7018763">TestAppendRangeCollapse</span><span class="op" id="7018786">(</span><span class="ident" id="7018787">t</span>&nbsp;<span class="op" id="7018789">*</span><span class="ident" id="7018790">testing</span><span class="op" id="7018797">.</span><span class="ident" id="7018798">T</span><span class="op" id="7018799">)</span>&nbsp;<span class="op" id="7018801">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7018804">//&nbsp;AppendRange&nbsp;should&nbsp;collapse&nbsp;each&nbsp;of&nbsp;the&nbsp;new&nbsp;ranges</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7018859">//&nbsp;into&nbsp;the&nbsp;earlier&nbsp;ones&nbsp;(it&nbsp;looks&nbsp;back&nbsp;two&nbsp;ranges),&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7018921">//&nbsp;the&nbsp;slice&nbsp;never&nbsp;grows&nbsp;very&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7018959">//&nbsp;Note&nbsp;that&nbsp;we&nbsp;are&nbsp;not&nbsp;calling&nbsp;cleanClass.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7019004">var</span>&nbsp;<span class="ident" id="7019008">r</span>&nbsp;<span class="op" id="7019010">[</span><span class="op" id="7019011">]</span><span class="builtintype" id="7019012">rune</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7019018">for</span>&nbsp;<span class="ident" id="7019022">i</span>&nbsp;<span class="op" id="7019024">:=</span>&nbsp;<span class="builtintype" id="7019027">rune</span><span class="op" id="7019031">(</span><span class="string" id="7019032">&#39;A&#39;</span><span class="op" id="7019035">)</span><span class="op" id="7019036">;</span>&nbsp;<span class="ident" id="7019038">i</span>&nbsp;<span class="op" id="7019040">&lt;=</span>&nbsp;<span class="string" id="7019043">&#39;Z&#39;</span><span class="op" id="7019046">;</span>&nbsp;<span class="ident" id="7019048">i</span><span class="op" id="7019049">++</span>&nbsp;<span class="op" id="7019052">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7019056">r</span>&nbsp;<span class="op" id="7019058">=</span>&nbsp;<span class="ident" id="7019060">appendRange</span><span class="op" id="7019071">(</span><span class="ident" id="7019072">r</span><span class="op" id="7019073">,</span>&nbsp;<span class="ident" id="7019075">i</span><span class="op" id="7019076">,</span>&nbsp;<span class="ident" id="7019078">i</span><span class="op" id="7019079">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7019083">r</span>&nbsp;<span class="op" id="7019085">=</span>&nbsp;<span class="ident" id="7019087">appendRange</span><span class="op" id="7019098">(</span><span class="ident" id="7019099">r</span><span class="op" id="7019100">,</span>&nbsp;<span class="ident" id="7019102">i</span><span class="op" id="7019103">+</span><span class="string" id="7019104">&#39;a&#39;</span><span class="op" id="7019107">-</span><span class="string" id="7019108">&#39;A&#39;</span><span class="op" id="7019111">,</span>&nbsp;<span class="ident" id="7019113">i</span><span class="op" id="7019114">+</span><span class="string" id="7019115">&#39;a&#39;</span><span class="op" id="7019118">-</span><span class="string" id="7019119">&#39;A&#39;</span><span class="op" id="7019122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7019125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7019128">if</span>&nbsp;<span class="builtintype" id="7019131">string</span><span class="op" id="7019137">(</span><span class="ident" id="7019138">r</span><span class="op" id="7019139">)</span>&nbsp;<span class="op" id="7019141">!=</span>&nbsp;<span class="string" id="7019144">&#34;AZaz&#34;</span>&nbsp;<span class="op" id="7019151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7019155">t</span><span class="op" id="7019156">.</span><span class="ident" id="7019157">Errorf</span><span class="op" id="7019163">(</span><span class="string" id="7019164">&#34;appendRange&nbsp;interlaced&nbsp;A-Z&nbsp;a-z&nbsp;=&nbsp;%s,&nbsp;want&nbsp;AZaz&#34;</span><span class="op" id="7019212">,</span>&nbsp;<span class="builtintype" id="7019214">string</span><span class="op" id="7019220">(</span><span class="ident" id="7019221">r</span><span class="op" id="7019222">)</span><span class="op" id="7019223">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7019226">}</span><br>
<span class="lineno"></span><span class="op" id="7019228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7019231">var</span>&nbsp;<span class="ident" id="7019235">invalidRegexps</span>&nbsp;<span class="op" id="7019250">=</span>&nbsp;<span class="op" id="7019252">[</span><span class="op" id="7019253">]</span><span class="builtintype" id="7019254">string</span><span class="op" id="7019260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019263">`(`</span><span class="op" id="7019266">,</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019269">`)`</span><span class="op" id="7019272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019275">`(a`</span><span class="op" id="7019279">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019282">`a)`</span><span class="op" id="7019286">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019289">`(a))`</span><span class="op" id="7019295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019298">`(a|b|`</span><span class="op" id="7019305">,</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019308">`a|b|)`</span><span class="op" id="7019315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019318">`(a|b|))`</span><span class="op" id="7019327">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019330">`(a|b`</span><span class="op" id="7019336">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019339">`a|b)`</span><span class="op" id="7019345">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019348">`(a|b))`</span><span class="op" id="7019356">,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019359">`[a-z`</span><span class="op" id="7019365">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019368">`([a-z)`</span><span class="op" id="7019376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019379">`[a-z)`</span><span class="op" id="7019386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019389">`([a-z]))`</span><span class="op" id="7019399">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019402">`x{1001}`</span><span class="op" id="7019411">,</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019414">`x{9876543210}`</span><span class="op" id="7019429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019432">`x{2,1}`</span><span class="op" id="7019440">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019443">`x{1,9876543210}`</span><span class="op" id="7019460">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019463">&#34;\xff&#34;</span><span class="op" id="7019469">,</span>&nbsp;<span class="comment" id="7019471">//&nbsp;Invalid&nbsp;UTF-8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019489">&#34;[\xff]&#34;</span><span class="op" id="7019497">,</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019500">&#34;[\\\xff]&#34;</span><span class="op" id="7019510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019513">&#34;\\\xff&#34;</span><span class="op" id="7019521">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019524">`(?P&lt;name&gt;a`</span><span class="op" id="7019536">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019539">`(?P&lt;name&gt;`</span><span class="op" id="7019550">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019553">`(?P&lt;name`</span><span class="op" id="7019563">,</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019566">`(?P&lt;x&nbsp;y&gt;a)`</span><span class="op" id="7019578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019581">`(?P&lt;&gt;a)`</span><span class="op" id="7019590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019593">`[a-Z]`</span><span class="op" id="7019600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019603">`(?i)[a-Z]`</span><span class="op" id="7019614">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019617">`a{100000}`</span><span class="op" id="7019628">,</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019631">`a{100000,}`</span><span class="op" id="7019643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019646">&#34;((((((((((x{2}){2}){2}){2}){2}){2}){2}){2}){2}){2})&#34;</span><span class="op" id="7019699">,</span><br>
<span class="lineno"></span><span class="op" id="7019701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7019704">var</span>&nbsp;<span class="ident" id="7019708">onlyPerl</span>&nbsp;<span class="op" id="7019717">=</span>&nbsp;<span class="op" id="7019719">[</span><span class="op" id="7019720">]</span><span class="builtintype" id="7019721">string</span><span class="op" id="7019727">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019730">`[a-b-c]`</span><span class="op" id="7019739">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019742">`\Qabc\E`</span><span class="op" id="7019751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019754">`\Q*+?{[\E`</span><span class="op" id="7019765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019768">`\Q\\E`</span><span class="op" id="7019775">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019778">`\Q\\\E`</span><span class="op" id="7019786">,</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019789">`\Q\\\\E`</span><span class="op" id="7019798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019801">`\Q\\\\\E`</span><span class="op" id="7019811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019814">`(?:a)`</span><span class="op" id="7019821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019824">`(?P&lt;name&gt;a)`</span><span class="op" id="7019837">,</span><br>
<span class="lineno"></span><span class="op" id="7019839">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="keyword" id="7019842">var</span>&nbsp;<span class="ident" id="7019846">onlyPOSIX</span>&nbsp;<span class="op" id="7019856">=</span>&nbsp;<span class="op" id="7019858">[</span><span class="op" id="7019859">]</span><span class="builtintype" id="7019860">string</span><span class="op" id="7019866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019869">&#34;a++&#34;</span><span class="op" id="7019874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019877">&#34;a**&#34;</span><span class="op" id="7019882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019885">&#34;a?*&#34;</span><span class="op" id="7019890">,</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019893">&#34;a+*&#34;</span><span class="op" id="7019898">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019901">&#34;a{1}*&#34;</span><span class="op" id="7019908">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7019911">&#34;.{1}{2}.{3}&#34;</span><span class="op" id="7019924">,</span><br>
<span class="lineno"></span><span class="op" id="7019926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">505</span><span class="keyword" id="7019929">func</span>&nbsp;<span class="ident" id="7019934">TestParseInvalidRegexps</span><span class="op" id="7019957">(</span><span class="ident" id="7019958">t</span>&nbsp;<span class="op" id="7019960">*</span><span class="ident" id="7019961">testing</span><span class="op" id="7019968">.</span><span class="ident" id="7019969">T</span><span class="op" id="7019970">)</span>&nbsp;<span class="op" id="7019972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7019975">for</span>&nbsp;<span class="ident" id="7019979">_</span><span class="op" id="7019980">,</span>&nbsp;<span class="ident" id="7019982">regexp</span>&nbsp;<span class="op" id="7019989">:=</span>&nbsp;<span class="keyword" id="7019992">range</span>&nbsp;<span class="ident" id="7019998">invalidRegexps</span>&nbsp;<span class="op" id="7020013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7020017">if</span>&nbsp;<span class="ident" id="7020020">re</span><span class="op" id="7020022">,</span>&nbsp;<span class="ident" id="7020024">err</span>&nbsp;<span class="op" id="7020028">:=</span>&nbsp;<span class="ident" id="7020031">Parse</span><span class="op" id="7020036">(</span><span class="ident" id="7020037">regexp</span><span class="op" id="7020043">,</span>&nbsp;<span class="ident" id="7020045">Perl</span><span class="op" id="7020049">)</span><span class="op" id="7020050">;</span>&nbsp;<span class="ident" id="7020052">err</span>&nbsp;<span class="op" id="7020056">==</span>&nbsp;<span class="ident" id="7020059">nil</span>&nbsp;<span class="op" id="7020063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020068">t</span><span class="op" id="7020069">.</span><span class="ident" id="7020070">Errorf</span><span class="op" id="7020076">(</span><span class="string" id="7020077">&#34;Parse(%#q,&nbsp;Perl)&nbsp;=&nbsp;%s,&nbsp;should&nbsp;have&nbsp;failed&#34;</span><span class="op" id="7020120">,</span>&nbsp;<span class="ident" id="7020122">regexp</span><span class="op" id="7020128">,</span>&nbsp;<span class="ident" id="7020130">dump</span><span class="op" id="7020134">(</span><span class="ident" id="7020135">re</span><span class="op" id="7020137">)</span><span class="op" id="7020138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020142">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7020146">if</span>&nbsp;<span class="ident" id="7020149">re</span><span class="op" id="7020151">,</span>&nbsp;<span class="ident" id="7020153">err</span>&nbsp;<span class="op" id="7020157">:=</span>&nbsp;<span class="ident" id="7020160">Parse</span><span class="op" id="7020165">(</span><span class="ident" id="7020166">regexp</span><span class="op" id="7020172">,</span>&nbsp;<span class="ident" id="7020174">POSIX</span><span class="op" id="7020179">)</span><span class="op" id="7020180">;</span>&nbsp;<span class="ident" id="7020182">err</span>&nbsp;<span class="op" id="7020186">==</span>&nbsp;<span class="ident" id="7020189">nil</span>&nbsp;<span class="op" id="7020193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020198">t</span><span class="op" id="7020199">.</span><span class="ident" id="7020200">Errorf</span><span class="op" id="7020206">(</span><span class="string" id="7020207">&#34;Parse(%#q,&nbsp;POSIX)&nbsp;=&nbsp;%s,&nbsp;should&nbsp;have&nbsp;failed&#34;</span><span class="op" id="7020251">,</span>&nbsp;<span class="ident" id="7020253">regexp</span><span class="op" id="7020259">,</span>&nbsp;<span class="ident" id="7020261">dump</span><span class="op" id="7020265">(</span><span class="ident" id="7020266">re</span><span class="op" id="7020268">)</span><span class="op" id="7020269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7020279">for</span>&nbsp;<span class="ident" id="7020283">_</span><span class="op" id="7020284">,</span>&nbsp;<span class="ident" id="7020286">regexp</span>&nbsp;<span class="op" id="7020293">:=</span>&nbsp;<span class="keyword" id="7020296">range</span>&nbsp;<span class="ident" id="7020302">onlyPerl</span>&nbsp;<span class="op" id="7020311">{</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7020315">if</span>&nbsp;<span class="ident" id="7020318">_</span><span class="op" id="7020319">,</span>&nbsp;<span class="ident" id="7020321">err</span>&nbsp;<span class="op" id="7020325">:=</span>&nbsp;<span class="ident" id="7020328">Parse</span><span class="op" id="7020333">(</span><span class="ident" id="7020334">regexp</span><span class="op" id="7020340">,</span>&nbsp;<span class="ident" id="7020342">Perl</span><span class="op" id="7020346">)</span><span class="op" id="7020347">;</span>&nbsp;<span class="ident" id="7020349">err</span>&nbsp;<span class="op" id="7020353">!=</span>&nbsp;<span class="ident" id="7020356">nil</span>&nbsp;<span class="op" id="7020360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020365">t</span><span class="op" id="7020366">.</span><span class="ident" id="7020367">Errorf</span><span class="op" id="7020373">(</span><span class="string" id="7020374">&#34;Parse(%#q,&nbsp;Perl):&nbsp;%v&#34;</span><span class="op" id="7020396">,</span>&nbsp;<span class="ident" id="7020398">regexp</span><span class="op" id="7020404">,</span>&nbsp;<span class="ident" id="7020406">err</span><span class="op" id="7020409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7020417">if</span>&nbsp;<span class="ident" id="7020420">re</span><span class="op" id="7020422">,</span>&nbsp;<span class="ident" id="7020424">err</span>&nbsp;<span class="op" id="7020428">:=</span>&nbsp;<span class="ident" id="7020431">Parse</span><span class="op" id="7020436">(</span><span class="ident" id="7020437">regexp</span><span class="op" id="7020443">,</span>&nbsp;<span class="ident" id="7020445">POSIX</span><span class="op" id="7020450">)</span><span class="op" id="7020451">;</span>&nbsp;<span class="ident" id="7020453">err</span>&nbsp;<span class="op" id="7020457">==</span>&nbsp;<span class="ident" id="7020460">nil</span>&nbsp;<span class="op" id="7020464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020469">t</span><span class="op" id="7020470">.</span><span class="ident" id="7020471">Errorf</span><span class="op" id="7020477">(</span><span class="string" id="7020478">&#34;Parse(%#q,&nbsp;POSIX)&nbsp;=&nbsp;%s,&nbsp;should&nbsp;have&nbsp;failed&#34;</span><span class="op" id="7020522">,</span>&nbsp;<span class="ident" id="7020524">regexp</span><span class="op" id="7020530">,</span>&nbsp;<span class="ident" id="7020532">dump</span><span class="op" id="7020536">(</span><span class="ident" id="7020537">re</span><span class="op" id="7020539">)</span><span class="op" id="7020540">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7020550">for</span>&nbsp;<span class="ident" id="7020554">_</span><span class="op" id="7020555">,</span>&nbsp;<span class="ident" id="7020557">regexp</span>&nbsp;<span class="op" id="7020564">:=</span>&nbsp;<span class="keyword" id="7020567">range</span>&nbsp;<span class="ident" id="7020573">onlyPOSIX</span>&nbsp;<span class="op" id="7020583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7020587">if</span>&nbsp;<span class="ident" id="7020590">re</span><span class="op" id="7020592">,</span>&nbsp;<span class="ident" id="7020594">err</span>&nbsp;<span class="op" id="7020598">:=</span>&nbsp;<span class="ident" id="7020601">Parse</span><span class="op" id="7020606">(</span><span class="ident" id="7020607">regexp</span><span class="op" id="7020613">,</span>&nbsp;<span class="ident" id="7020615">Perl</span><span class="op" id="7020619">)</span><span class="op" id="7020620">;</span>&nbsp;<span class="ident" id="7020622">err</span>&nbsp;<span class="op" id="7020626">==</span>&nbsp;<span class="ident" id="7020629">nil</span>&nbsp;<span class="op" id="7020633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020638">t</span><span class="op" id="7020639">.</span><span class="ident" id="7020640">Errorf</span><span class="op" id="7020646">(</span><span class="string" id="7020647">&#34;Parse(%#q,&nbsp;Perl)&nbsp;=&nbsp;%s,&nbsp;should&nbsp;have&nbsp;failed&#34;</span><span class="op" id="7020690">,</span>&nbsp;<span class="ident" id="7020692">regexp</span><span class="op" id="7020698">,</span>&nbsp;<span class="ident" id="7020700">dump</span><span class="op" id="7020704">(</span><span class="ident" id="7020705">re</span><span class="op" id="7020707">)</span><span class="op" id="7020708">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7020716">if</span>&nbsp;<span class="ident" id="7020719">_</span><span class="op" id="7020720">,</span>&nbsp;<span class="ident" id="7020722">err</span>&nbsp;<span class="op" id="7020726">:=</span>&nbsp;<span class="ident" id="7020729">Parse</span><span class="op" id="7020734">(</span><span class="ident" id="7020735">regexp</span><span class="op" id="7020741">,</span>&nbsp;<span class="ident" id="7020743">POSIX</span><span class="op" id="7020748">)</span><span class="op" id="7020749">;</span>&nbsp;<span class="ident" id="7020751">err</span>&nbsp;<span class="op" id="7020755">!=</span>&nbsp;<span class="ident" id="7020758">nil</span>&nbsp;<span class="op" id="7020762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020767">t</span><span class="op" id="7020768">.</span><span class="ident" id="7020769">Errorf</span><span class="op" id="7020775">(</span><span class="string" id="7020776">&#34;Parse(%#q,&nbsp;POSIX):&nbsp;%v&#34;</span><span class="op" id="7020799">,</span>&nbsp;<span class="ident" id="7020801">regexp</span><span class="op" id="7020807">,</span>&nbsp;<span class="ident" id="7020809">err</span><span class="op" id="7020812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7020819">}</span><br>
<span class="lineno">530</span><span class="op" id="7020821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7020824">func</span>&nbsp;<span class="ident" id="7020829">TestToStringEquivalentParse</span><span class="op" id="7020856">(</span><span class="ident" id="7020857">t</span>&nbsp;<span class="op" id="7020859">*</span><span class="ident" id="7020860">testing</span><span class="op" id="7020867">.</span><span class="ident" id="7020868">T</span><span class="op" id="7020869">)</span>&nbsp;<span class="op" id="7020871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7020874">for</span>&nbsp;<span class="ident" id="7020878">_</span><span class="op" id="7020879">,</span>&nbsp;<span class="ident" id="7020881">tt</span>&nbsp;<span class="op" id="7020884">:=</span>&nbsp;<span class="keyword" id="7020887">range</span>&nbsp;<span class="ident" id="7020893">parseTests</span>&nbsp;<span class="op" id="7020904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020908">re</span><span class="op" id="7020910">,</span>&nbsp;<span class="ident" id="7020912">err</span>&nbsp;<span class="op" id="7020916">:=</span>&nbsp;<span class="ident" id="7020919">Parse</span><span class="op" id="7020924">(</span><span class="ident" id="7020925">tt</span><span class="op" id="7020927">.</span><span class="ident" id="7020928">Regexp</span><span class="op" id="7020934">,</span>&nbsp;<span class="ident" id="7020936">testFlags</span><span class="op" id="7020945">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7020949">if</span>&nbsp;<span class="ident" id="7020952">err</span>&nbsp;<span class="op" id="7020956">!=</span>&nbsp;<span class="ident" id="7020959">nil</span>&nbsp;<span class="op" id="7020963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7020968">t</span><span class="op" id="7020969">.</span><span class="ident" id="7020970">Errorf</span><span class="op" id="7020976">(</span><span class="string" id="7020977">&#34;Parse(%#q):&nbsp;%v&#34;</span><span class="op" id="7020993">,</span>&nbsp;<span class="ident" id="7020995">tt</span><span class="op" id="7020997">.</span><span class="ident" id="7020998">Regexp</span><span class="op" id="7021004">,</span>&nbsp;<span class="ident" id="7021006">err</span><span class="op" id="7021009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021014">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7021025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021029">if</span>&nbsp;<span class="ident" id="7021032">tt</span><span class="op" id="7021034">.</span><span class="ident" id="7021035">Dump</span>&nbsp;<span class="op" id="7021040">==</span>&nbsp;<span class="string" id="7021043">&#34;&#34;</span>&nbsp;<span class="op" id="7021046">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7021051">//&nbsp;It&nbsp;parsed.&nbsp;That&#39;s&nbsp;all&nbsp;we&nbsp;care&nbsp;about.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021094">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7021105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021109">d</span>&nbsp;<span class="op" id="7021111">:=</span>&nbsp;<span class="ident" id="7021114">dump</span><span class="op" id="7021118">(</span><span class="ident" id="7021119">re</span><span class="op" id="7021121">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021125">if</span>&nbsp;<span class="ident" id="7021128">d</span>&nbsp;<span class="op" id="7021130">!=</span>&nbsp;<span class="ident" id="7021133">tt</span><span class="op" id="7021135">.</span><span class="ident" id="7021136">Dump</span>&nbsp;<span class="op" id="7021141">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021146">t</span><span class="op" id="7021147">.</span><span class="ident" id="7021148">Errorf</span><span class="op" id="7021154">(</span><span class="string" id="7021155">&#34;Parse(%#q).Dump()&nbsp;=&nbsp;%#q&nbsp;want&nbsp;%#q&#34;</span><span class="op" id="7021189">,</span>&nbsp;<span class="ident" id="7021191">tt</span><span class="op" id="7021193">.</span><span class="ident" id="7021194">Regexp</span><span class="op" id="7021200">,</span>&nbsp;<span class="ident" id="7021202">d</span><span class="op" id="7021203">,</span>&nbsp;<span class="ident" id="7021205">tt</span><span class="op" id="7021207">.</span><span class="ident" id="7021208">Dump</span><span class="op" id="7021212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021217">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7021228">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021233">s</span>&nbsp;<span class="op" id="7021235">:=</span>&nbsp;<span class="ident" id="7021238">re</span><span class="op" id="7021240">.</span><span class="ident" id="7021241">String</span><span class="op" id="7021247">(</span><span class="op" id="7021248">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021252">if</span>&nbsp;<span class="ident" id="7021255">s</span>&nbsp;<span class="op" id="7021257">!=</span>&nbsp;<span class="ident" id="7021260">tt</span><span class="op" id="7021262">.</span><span class="ident" id="7021263">Regexp</span>&nbsp;<span class="op" id="7021270">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7021275">//&nbsp;If&nbsp;ToString&nbsp;didn&#39;t&nbsp;return&nbsp;the&nbsp;original&nbsp;regexp,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7021328">//&nbsp;it&nbsp;must&nbsp;have&nbsp;found&nbsp;one&nbsp;with&nbsp;fewer&nbsp;parens.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7021376">//&nbsp;Unfortunately&nbsp;we&nbsp;can&#39;t&nbsp;check&nbsp;the&nbsp;length&nbsp;here,&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7021436">//&nbsp;ToString&nbsp;produces&nbsp;&#34;\\{&#34;&nbsp;for&nbsp;a&nbsp;literal&nbsp;brace,</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7021487">//&nbsp;but&nbsp;&#34;{&#34;&nbsp;is&nbsp;a&nbsp;shorter&nbsp;equivalent&nbsp;in&nbsp;some&nbsp;contexts.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021543">nre</span><span class="op" id="7021546">,</span>&nbsp;<span class="ident" id="7021548">err</span>&nbsp;<span class="op" id="7021552">:=</span>&nbsp;<span class="ident" id="7021555">Parse</span><span class="op" id="7021560">(</span><span class="ident" id="7021561">s</span><span class="op" id="7021562">,</span>&nbsp;<span class="ident" id="7021564">testFlags</span><span class="op" id="7021573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021578">if</span>&nbsp;<span class="ident" id="7021581">err</span>&nbsp;<span class="op" id="7021585">!=</span>&nbsp;<span class="ident" id="7021588">nil</span>&nbsp;<span class="op" id="7021592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021598">t</span><span class="op" id="7021599">.</span><span class="ident" id="7021600">Errorf</span><span class="op" id="7021606">(</span><span class="string" id="7021607">&#34;Parse(%#q.String()&nbsp;=&nbsp;%#q):&nbsp;%v&#34;</span><span class="op" id="7021638">,</span>&nbsp;<span class="ident" id="7021640">tt</span><span class="op" id="7021642">.</span><span class="ident" id="7021643">Regexp</span><span class="op" id="7021649">,</span>&nbsp;<span class="ident" id="7021651">s</span><span class="op" id="7021652">,</span>&nbsp;<span class="ident" id="7021654">err</span><span class="op" id="7021657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021663">continue</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7021675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021680">nd</span>&nbsp;<span class="op" id="7021683">:=</span>&nbsp;<span class="ident" id="7021686">dump</span><span class="op" id="7021690">(</span><span class="ident" id="7021691">nre</span><span class="op" id="7021694">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021699">if</span>&nbsp;<span class="ident" id="7021702">d</span>&nbsp;<span class="op" id="7021704">!=</span>&nbsp;<span class="ident" id="7021707">nd</span>&nbsp;<span class="op" id="7021710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021716">t</span><span class="op" id="7021717">.</span><span class="ident" id="7021718">Errorf</span><span class="op" id="7021724">(</span><span class="string" id="7021725">&#34;Parse(%#q)&nbsp;-&gt;&nbsp;%#q;&nbsp;%#q&nbsp;vs&nbsp;%#q&#34;</span><span class="op" id="7021756">,</span>&nbsp;<span class="ident" id="7021758">tt</span><span class="op" id="7021760">.</span><span class="ident" id="7021761">Regexp</span><span class="op" id="7021767">,</span>&nbsp;<span class="ident" id="7021769">s</span><span class="op" id="7021770">,</span>&nbsp;<span class="ident" id="7021772">d</span><span class="op" id="7021773">,</span>&nbsp;<span class="ident" id="7021775">nd</span><span class="op" id="7021777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7021782">}</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021788">ns</span>&nbsp;<span class="op" id="7021791">:=</span>&nbsp;<span class="ident" id="7021794">nre</span><span class="op" id="7021797">.</span><span class="ident" id="7021798">String</span><span class="op" id="7021804">(</span><span class="op" id="7021805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7021810">if</span>&nbsp;<span class="ident" id="7021813">s</span>&nbsp;<span class="op" id="7021815">!=</span>&nbsp;<span class="ident" id="7021818">ns</span>&nbsp;<span class="op" id="7021821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7021827">t</span><span class="op" id="7021828">.</span><span class="ident" id="7021829">Errorf</span><span class="op" id="7021835">(</span><span class="string" id="7021836">&#34;Parse(%#q)&nbsp;-&gt;&nbsp;%#q&nbsp;-&gt;&nbsp;%#q&#34;</span><span class="op" id="7021862">,</span>&nbsp;<span class="ident" id="7021864">tt</span><span class="op" id="7021866">.</span><span class="ident" id="7021867">Regexp</span><span class="op" id="7021873">,</span>&nbsp;<span class="ident" id="7021875">s</span><span class="op" id="7021876">,</span>&nbsp;<span class="ident" id="7021878">ns</span><span class="op" id="7021880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7021885">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7021889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7021892">}</span><br>
<span class="lineno"></span><span class="op" id="7021894">}</span>
</div>
</body>
</html>
