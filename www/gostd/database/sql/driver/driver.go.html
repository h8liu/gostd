<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>database/sql/driver</h2>
<ul>
<li><a href="/gostd/database/sql/driver/driver.go.html" class="current">driver.go</a></li>
<li><a href="/gostd/database/sql/driver/types.go.html">types.go</a></li>
<li><a href="/gostd/database/sql/driver/types_test.go.html">types_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5825324">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5825379">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5825433">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5825484">//&nbsp;Package&nbsp;driver&nbsp;defines&nbsp;interfaces&nbsp;to&nbsp;be&nbsp;implemented&nbsp;by&nbsp;database</span><br>
<span class="lineno"></span><span class="comment" id="5825551">//&nbsp;drivers&nbsp;as&nbsp;used&nbsp;by&nbsp;package&nbsp;sql.</span><br>
<span class="lineno"></span><span class="comment" id="5825586">//</span><br>
<span class="lineno"></span><span class="comment" id="5825589">//&nbsp;Most&nbsp;code&nbsp;should&nbsp;use&nbsp;package&nbsp;sql.</span><br>
<span class="lineno"></span><span class="keyword" id="5825626">package</span>&nbsp;<span class="ident" id="5825634">driver</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="5825642">import</span>&nbsp;<span class="string" id="5825649">&#34;errors&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5825659">//&nbsp;Value&nbsp;is&nbsp;a&nbsp;value&nbsp;that&nbsp;drivers&nbsp;must&nbsp;be&nbsp;able&nbsp;to&nbsp;handle.</span><br>
<span class="lineno"></span><span class="comment" id="5825716">//&nbsp;It&nbsp;is&nbsp;either&nbsp;nil&nbsp;or&nbsp;an&nbsp;instance&nbsp;of&nbsp;one&nbsp;of&nbsp;these&nbsp;types:</span><br>
<span class="lineno">15</span><span class="comment" id="5825774">//</span><br>
<span class="lineno"></span><span class="comment" id="5825777">//&nbsp;&nbsp;&nbsp;int64</span><br>
<span class="lineno"></span><span class="comment" id="5825788">//&nbsp;&nbsp;&nbsp;float64</span><br>
<span class="lineno"></span><span class="comment" id="5825801">//&nbsp;&nbsp;&nbsp;bool</span><br>
<span class="lineno"></span><span class="comment" id="5825811">//&nbsp;&nbsp;&nbsp;[]byte</span><br>
<span class="lineno">20</span><span class="comment" id="5825823">//&nbsp;&nbsp;&nbsp;string&nbsp;&nbsp;&nbsp;[*]&nbsp;everywhere&nbsp;except&nbsp;from&nbsp;Rows.Next.</span><br>
<span class="lineno"></span><span class="comment" id="5825875">//&nbsp;&nbsp;&nbsp;time.Time</span><br>
<span class="lineno"></span><span class="keyword" id="5825890">type</span>&nbsp;<span class="ident" id="5825895">Value</span>&nbsp;<span class="keyword" id="5825901">interface</span><span class="op" id="5825910">{</span><span class="op" id="5825911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5825914">//&nbsp;Driver&nbsp;is&nbsp;the&nbsp;interface&nbsp;that&nbsp;must&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;database</span><br>
<span class="lineno">25</span><span class="comment" id="5825980">//&nbsp;driver.</span><br>
<span class="lineno"></span><span class="keyword" id="5825991">type</span>&nbsp;<span class="ident" id="5825996">Driver</span>&nbsp;<span class="keyword" id="5826003">interface</span>&nbsp;<span class="op" id="5826013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5826016">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;connection&nbsp;to&nbsp;the&nbsp;database.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5826067">//&nbsp;The&nbsp;name&nbsp;is&nbsp;a&nbsp;string&nbsp;in&nbsp;a&nbsp;driver-specific&nbsp;format.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5826121">//</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5826125">//&nbsp;Open&nbsp;may&nbsp;return&nbsp;a&nbsp;cached&nbsp;connection&nbsp;(one&nbsp;previously</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5826181">//&nbsp;closed),&nbsp;but&nbsp;doing&nbsp;so&nbsp;is&nbsp;unnecessary;&nbsp;the&nbsp;sql&nbsp;package</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5826239">//&nbsp;maintains&nbsp;a&nbsp;pool&nbsp;of&nbsp;idle&nbsp;connections&nbsp;for&nbsp;efficient&nbsp;re-use.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5826302">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5826306">//&nbsp;The&nbsp;returned&nbsp;connection&nbsp;is&nbsp;only&nbsp;used&nbsp;by&nbsp;one&nbsp;goroutine&nbsp;at&nbsp;a</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5826369">//&nbsp;time.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5826379">Open</span><span class="op" id="5826383">(</span><span class="ident" id="5826384">name</span>&nbsp;<span class="builtintype" id="5826389">string</span><span class="op" id="5826395">)</span>&nbsp;<span class="op" id="5826397">(</span><span class="ident" id="5826398">Conn</span><span class="op" id="5826402">,</span>&nbsp;<span class="builtintype" id="5826404">error</span><span class="op" id="5826409">)</span><br>
<span class="lineno"></span><span class="op" id="5826411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5826414">//&nbsp;ErrSkip&nbsp;may&nbsp;be&nbsp;returned&nbsp;by&nbsp;some&nbsp;optional&nbsp;interfaces&#39;&nbsp;methods&nbsp;to</span><br>
<span class="lineno">40</span><span class="comment" id="5826481">//&nbsp;indicate&nbsp;at&nbsp;runtime&nbsp;that&nbsp;the&nbsp;fast&nbsp;path&nbsp;is&nbsp;unavailable&nbsp;and&nbsp;the&nbsp;sql</span><br>
<span class="lineno"></span><span class="comment" id="5826550">//&nbsp;package&nbsp;should&nbsp;continue&nbsp;as&nbsp;if&nbsp;the&nbsp;optional&nbsp;interface&nbsp;was&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5826614">//&nbsp;implemented.&nbsp;ErrSkip&nbsp;is&nbsp;only&nbsp;supported&nbsp;where&nbsp;explicitly</span><br>
<span class="lineno"></span><span class="comment" id="5826673">//&nbsp;documented.</span><br>
<span class="lineno"></span><span class="keyword" id="5826688">var</span>&nbsp;<span class="ident" id="5826692">ErrSkip</span>&nbsp;<span class="op" id="5826700">=</span>&nbsp;<span class="ident" id="5826702">errors</span><span class="op" id="5826708">.</span><span class="ident" id="5826709">New</span><span class="op" id="5826712">(</span><span class="string" id="5826713">&#34;driver:&nbsp;skip&nbsp;fast-path;&nbsp;continue&nbsp;as&nbsp;if&nbsp;unimplemented&#34;</span><span class="op" id="5826767">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="5826770">//&nbsp;ErrBadConn&nbsp;should&nbsp;be&nbsp;returned&nbsp;by&nbsp;a&nbsp;driver&nbsp;to&nbsp;signal&nbsp;to&nbsp;the&nbsp;sql</span><br>
<span class="lineno"></span><span class="comment" id="5826836">//&nbsp;package&nbsp;that&nbsp;a&nbsp;driver.Conn&nbsp;is&nbsp;in&nbsp;a&nbsp;bad&nbsp;state&nbsp;(such&nbsp;as&nbsp;the&nbsp;server</span><br>
<span class="lineno"></span><span class="comment" id="5826904">//&nbsp;having&nbsp;earlier&nbsp;closed&nbsp;the&nbsp;connection)&nbsp;and&nbsp;the&nbsp;sql&nbsp;package&nbsp;should</span><br>
<span class="lineno"></span><span class="comment" id="5826972">//&nbsp;retry&nbsp;on&nbsp;a&nbsp;new&nbsp;connection.</span><br>
<span class="lineno">50</span><span class="comment" id="5827002">//</span><br>
<span class="lineno"></span><span class="comment" id="5827005">//&nbsp;To&nbsp;prevent&nbsp;duplicate&nbsp;operations,&nbsp;ErrBadConn&nbsp;should&nbsp;NOT&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span><span class="comment" id="5827075">//&nbsp;if&nbsp;there&#39;s&nbsp;a&nbsp;possibility&nbsp;that&nbsp;the&nbsp;database&nbsp;server&nbsp;might&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="5827139">//&nbsp;performed&nbsp;the&nbsp;operation.&nbsp;Even&nbsp;if&nbsp;the&nbsp;server&nbsp;sends&nbsp;back&nbsp;an&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="5827207">//&nbsp;you&nbsp;shouldn&#39;t&nbsp;return&nbsp;ErrBadConn.</span><br>
<span class="lineno">55</span><span class="keyword" id="5827243">var</span>&nbsp;<span class="ident" id="5827247">ErrBadConn</span>&nbsp;<span class="op" id="5827258">=</span>&nbsp;<span class="ident" id="5827260">errors</span><span class="op" id="5827266">.</span><span class="ident" id="5827267">New</span><span class="op" id="5827270">(</span><span class="string" id="5827271">&#34;driver:&nbsp;bad&nbsp;connection&#34;</span><span class="op" id="5827295">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5827298">//&nbsp;Execer&nbsp;is&nbsp;an&nbsp;optional&nbsp;interface&nbsp;that&nbsp;may&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="comment" id="5827368">//</span><br>
<span class="lineno"></span><span class="comment" id="5827371">//&nbsp;If&nbsp;a&nbsp;Conn&nbsp;does&nbsp;not&nbsp;implement&nbsp;Execer,&nbsp;the&nbsp;sql&nbsp;package&#39;s&nbsp;DB.Exec&nbsp;will</span><br>
<span class="lineno">60</span><span class="comment" id="5827442">//&nbsp;first&nbsp;prepare&nbsp;a&nbsp;query,&nbsp;execute&nbsp;the&nbsp;statement,&nbsp;and&nbsp;then&nbsp;close&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5827510">//&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5827524">//</span><br>
<span class="lineno"></span><span class="comment" id="5827527">//&nbsp;Exec&nbsp;may&nbsp;return&nbsp;ErrSkip.</span><br>
<span class="lineno"></span><span class="keyword" id="5827555">type</span>&nbsp;<span class="ident" id="5827560">Execer</span>&nbsp;<span class="keyword" id="5827567">interface</span>&nbsp;<span class="op" id="5827577">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5827580">Exec</span><span class="op" id="5827584">(</span><span class="ident" id="5827585">query</span>&nbsp;<span class="builtintype" id="5827591">string</span><span class="op" id="5827597">,</span>&nbsp;<span class="ident" id="5827599">args</span>&nbsp;<span class="op" id="5827604">[</span><span class="op" id="5827605">]</span><span class="ident" id="5827606">Value</span><span class="op" id="5827611">)</span>&nbsp;<span class="op" id="5827613">(</span><span class="ident" id="5827614">Result</span><span class="op" id="5827620">,</span>&nbsp;<span class="builtintype" id="5827622">error</span><span class="op" id="5827627">)</span><br>
<span class="lineno"></span><span class="op" id="5827629">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5827632">//&nbsp;Queryer&nbsp;is&nbsp;an&nbsp;optional&nbsp;interface&nbsp;that&nbsp;may&nbsp;be&nbsp;implemented&nbsp;by&nbsp;a&nbsp;Conn.</span><br>
<span class="lineno"></span><span class="comment" id="5827703">//</span><br>
<span class="lineno">70</span><span class="comment" id="5827706">//&nbsp;If&nbsp;a&nbsp;Conn&nbsp;does&nbsp;not&nbsp;implement&nbsp;Queryer,&nbsp;the&nbsp;sql&nbsp;package&#39;s&nbsp;DB.Query&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="5827779">//&nbsp;first&nbsp;prepare&nbsp;a&nbsp;query,&nbsp;execute&nbsp;the&nbsp;statement,&nbsp;and&nbsp;then&nbsp;close&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5827847">//&nbsp;statement.</span><br>
<span class="lineno"></span><span class="comment" id="5827861">//</span><br>
<span class="lineno"></span><span class="comment" id="5827864">//&nbsp;Query&nbsp;may&nbsp;return&nbsp;ErrSkip.</span><br>
<span class="lineno">75</span><span class="keyword" id="5827893">type</span>&nbsp;<span class="ident" id="5827898">Queryer</span>&nbsp;<span class="keyword" id="5827906">interface</span>&nbsp;<span class="op" id="5827916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5827919">Query</span><span class="op" id="5827924">(</span><span class="ident" id="5827925">query</span>&nbsp;<span class="builtintype" id="5827931">string</span><span class="op" id="5827937">,</span>&nbsp;<span class="ident" id="5827939">args</span>&nbsp;<span class="op" id="5827944">[</span><span class="op" id="5827945">]</span><span class="ident" id="5827946">Value</span><span class="op" id="5827951">)</span>&nbsp;<span class="op" id="5827953">(</span><span class="ident" id="5827954">Rows</span><span class="op" id="5827958">,</span>&nbsp;<span class="builtintype" id="5827960">error</span><span class="op" id="5827965">)</span><br>
<span class="lineno"></span><span class="op" id="5827967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5827970">//&nbsp;Conn&nbsp;is&nbsp;a&nbsp;connection&nbsp;to&nbsp;a&nbsp;database.&nbsp;It&nbsp;is&nbsp;not&nbsp;used&nbsp;concurrently</span><br>
<span class="lineno">80</span><span class="comment" id="5828037">//&nbsp;by&nbsp;multiple&nbsp;goroutines.</span><br>
<span class="lineno"></span><span class="comment" id="5828064">//</span><br>
<span class="lineno"></span><span class="comment" id="5828067">//&nbsp;Conn&nbsp;is&nbsp;assumed&nbsp;to&nbsp;be&nbsp;stateful.</span><br>
<span class="lineno"></span><span class="keyword" id="5828102">type</span>&nbsp;<span class="ident" id="5828107">Conn</span>&nbsp;<span class="keyword" id="5828112">interface</span>&nbsp;<span class="op" id="5828122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828125">//&nbsp;Prepare&nbsp;returns&nbsp;a&nbsp;prepared&nbsp;statement,&nbsp;bound&nbsp;to&nbsp;this&nbsp;connection.</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5828193">Prepare</span><span class="op" id="5828200">(</span><span class="ident" id="5828201">query</span>&nbsp;<span class="builtintype" id="5828207">string</span><span class="op" id="5828213">)</span>&nbsp;<span class="op" id="5828215">(</span><span class="ident" id="5828216">Stmt</span><span class="op" id="5828220">,</span>&nbsp;<span class="builtintype" id="5828222">error</span><span class="op" id="5828227">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828231">//&nbsp;Close&nbsp;invalidates&nbsp;and&nbsp;potentially&nbsp;stops&nbsp;any&nbsp;current</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828287">//&nbsp;prepared&nbsp;statements&nbsp;and&nbsp;transactions,&nbsp;marking&nbsp;this</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828342">//&nbsp;connection&nbsp;as&nbsp;no&nbsp;longer&nbsp;in&nbsp;use.</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828378">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828382">//&nbsp;Because&nbsp;the&nbsp;sql&nbsp;package&nbsp;maintains&nbsp;a&nbsp;free&nbsp;pool&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828435">//&nbsp;connections&nbsp;and&nbsp;only&nbsp;calls&nbsp;Close&nbsp;when&nbsp;there&#39;s&nbsp;a&nbsp;surplus&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828498">//&nbsp;idle&nbsp;connections,&nbsp;it&nbsp;shouldn&#39;t&nbsp;be&nbsp;necessary&nbsp;for&nbsp;drivers&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828561">//&nbsp;do&nbsp;their&nbsp;own&nbsp;connection&nbsp;caching.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5828598">Close</span><span class="op" id="5828603">(</span><span class="op" id="5828604">)</span>&nbsp;<span class="builtintype" id="5828606">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828614">//&nbsp;Begin&nbsp;starts&nbsp;and&nbsp;returns&nbsp;a&nbsp;new&nbsp;transaction.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5828662">Begin</span><span class="op" id="5828667">(</span><span class="op" id="5828668">)</span>&nbsp;<span class="op" id="5828670">(</span><span class="ident" id="5828671">Tx</span><span class="op" id="5828673">,</span>&nbsp;<span class="builtintype" id="5828675">error</span><span class="op" id="5828680">)</span><br>
<span class="lineno"></span><span class="op" id="5828682">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="5828685">//&nbsp;Result&nbsp;is&nbsp;the&nbsp;result&nbsp;of&nbsp;a&nbsp;query&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="5828731">type</span>&nbsp;<span class="ident" id="5828736">Result</span>&nbsp;<span class="keyword" id="5828743">interface</span>&nbsp;<span class="op" id="5828753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828756">//&nbsp;LastInsertId&nbsp;returns&nbsp;the&nbsp;database&#39;s&nbsp;auto-generated&nbsp;ID</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828814">//&nbsp;after,&nbsp;for&nbsp;example,&nbsp;an&nbsp;INSERT&nbsp;into&nbsp;a&nbsp;table&nbsp;with&nbsp;primary</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828874">//&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5828883">LastInsertId</span><span class="op" id="5828895">(</span><span class="op" id="5828896">)</span>&nbsp;<span class="op" id="5828898">(</span><span class="ident" id="5828899">int64</span><span class="op" id="5828904">,</span>&nbsp;<span class="builtintype" id="5828906">error</span><span class="op" id="5828911">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828915">//&nbsp;RowsAffected&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;rows&nbsp;affected&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5828975">//&nbsp;query.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5828986">RowsAffected</span><span class="op" id="5828998">(</span><span class="op" id="5828999">)</span>&nbsp;<span class="op" id="5829001">(</span><span class="ident" id="5829002">int64</span><span class="op" id="5829007">,</span>&nbsp;<span class="builtintype" id="5829009">error</span><span class="op" id="5829014">)</span><br>
<span class="lineno"></span><span class="op" id="5829016">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5829019">//&nbsp;Stmt&nbsp;is&nbsp;a&nbsp;prepared&nbsp;statement.&nbsp;It&nbsp;is&nbsp;bound&nbsp;to&nbsp;a&nbsp;Conn&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="5829082">//&nbsp;used&nbsp;by&nbsp;multiple&nbsp;goroutines&nbsp;concurrently.</span><br>
<span class="lineno">115</span><span class="keyword" id="5829127">type</span>&nbsp;<span class="ident" id="5829132">Stmt</span>&nbsp;<span class="keyword" id="5829137">interface</span>&nbsp;<span class="op" id="5829147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829150">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;statement.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829182">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829186">//&nbsp;As&nbsp;of&nbsp;Go&nbsp;1.1,&nbsp;a&nbsp;Stmt&nbsp;will&nbsp;not&nbsp;be&nbsp;closed&nbsp;if&nbsp;it&#39;s&nbsp;in&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829245">//&nbsp;by&nbsp;any&nbsp;queries.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829265">Close</span><span class="op" id="5829270">(</span><span class="op" id="5829271">)</span>&nbsp;<span class="builtintype" id="5829273">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829281">//&nbsp;NumInput&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;placeholder&nbsp;parameters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829340">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829344">//&nbsp;If&nbsp;NumInput&nbsp;returns&nbsp;&gt;=&nbsp;0,&nbsp;the&nbsp;sql&nbsp;package&nbsp;will&nbsp;sanity&nbsp;check</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829408">//&nbsp;argument&nbsp;counts&nbsp;from&nbsp;callers&nbsp;and&nbsp;return&nbsp;errors&nbsp;to&nbsp;the&nbsp;caller</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829473">//&nbsp;before&nbsp;the&nbsp;statement&#39;s&nbsp;Exec&nbsp;or&nbsp;Query&nbsp;methods&nbsp;are&nbsp;called.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829534">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829538">//&nbsp;NumInput&nbsp;may&nbsp;also&nbsp;return&nbsp;-1,&nbsp;if&nbsp;the&nbsp;driver&nbsp;doesn&#39;t&nbsp;know</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829598">//&nbsp;its&nbsp;number&nbsp;of&nbsp;placeholders.&nbsp;In&nbsp;that&nbsp;case,&nbsp;the&nbsp;sql&nbsp;package</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829660">//&nbsp;will&nbsp;not&nbsp;sanity&nbsp;check&nbsp;Exec&nbsp;or&nbsp;Query&nbsp;argument&nbsp;counts.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829717">NumInput</span><span class="op" id="5829725">(</span><span class="op" id="5829726">)</span>&nbsp;<span class="builtintype" id="5829728">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829734">//&nbsp;Exec&nbsp;executes&nbsp;a&nbsp;query&nbsp;that&nbsp;doesn&#39;t&nbsp;return&nbsp;rows,&nbsp;such</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829791">//&nbsp;as&nbsp;an&nbsp;INSERT&nbsp;or&nbsp;UPDATE.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829819">Exec</span><span class="op" id="5829823">(</span><span class="ident" id="5829824">args</span>&nbsp;<span class="op" id="5829829">[</span><span class="op" id="5829830">]</span><span class="ident" id="5829831">Value</span><span class="op" id="5829836">)</span>&nbsp;<span class="op" id="5829838">(</span><span class="ident" id="5829839">Result</span><span class="op" id="5829845">,</span>&nbsp;<span class="builtintype" id="5829847">error</span><span class="op" id="5829852">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829856">//&nbsp;Query&nbsp;executes&nbsp;a&nbsp;query&nbsp;that&nbsp;may&nbsp;return&nbsp;rows,&nbsp;such&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5829915">//&nbsp;SELECT.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5829927">Query</span><span class="op" id="5829932">(</span><span class="ident" id="5829933">args</span>&nbsp;<span class="op" id="5829938">[</span><span class="op" id="5829939">]</span><span class="ident" id="5829940">Value</span><span class="op" id="5829945">)</span>&nbsp;<span class="op" id="5829947">(</span><span class="ident" id="5829948">Rows</span><span class="op" id="5829952">,</span>&nbsp;<span class="builtintype" id="5829954">error</span><span class="op" id="5829959">)</span><br>
<span class="lineno">140</span><span class="op" id="5829961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5829964">//&nbsp;ColumnConverter&nbsp;may&nbsp;be&nbsp;optionally&nbsp;implemented&nbsp;by&nbsp;Stmt&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5830028">//&nbsp;statement&nbsp;is&nbsp;aware&nbsp;of&nbsp;its&nbsp;own&nbsp;columns&#39;&nbsp;types&nbsp;and&nbsp;can&nbsp;convert&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="5830097">//&nbsp;any&nbsp;type&nbsp;to&nbsp;a&nbsp;driver&nbsp;Value.</span><br>
<span class="lineno">145</span><span class="keyword" id="5830128">type</span>&nbsp;<span class="ident" id="5830133">ColumnConverter</span>&nbsp;<span class="keyword" id="5830149">interface</span>&nbsp;<span class="op" id="5830159">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5830162">//&nbsp;ColumnConverter&nbsp;returns&nbsp;a&nbsp;ValueConverter&nbsp;for&nbsp;the&nbsp;provided</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5830224">//&nbsp;column&nbsp;index.&nbsp;&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;specific&nbsp;column&nbsp;isn&#39;t&nbsp;known</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5830288">//&nbsp;or&nbsp;shouldn&#39;t&nbsp;be&nbsp;handled&nbsp;specially,&nbsp;DefaultValueConverter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5830349">//&nbsp;can&nbsp;be&nbsp;returned.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830370">ColumnConverter</span><span class="op" id="5830385">(</span><span class="ident" id="5830386">idx</span>&nbsp;<span class="builtintype" id="5830390">int</span><span class="op" id="5830393">)</span>&nbsp;<span class="ident" id="5830395">ValueConverter</span><br>
<span class="lineno"></span><span class="op" id="5830410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5830413">//&nbsp;Rows&nbsp;is&nbsp;an&nbsp;iterator&nbsp;over&nbsp;an&nbsp;executed&nbsp;query&#39;s&nbsp;results.</span><br>
<span class="lineno"></span><span class="keyword" id="5830470">type</span>&nbsp;<span class="ident" id="5830475">Rows</span>&nbsp;<span class="keyword" id="5830480">interface</span>&nbsp;<span class="op" id="5830490">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5830493">//&nbsp;Columns&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;the&nbsp;columns.&nbsp;The&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5830553">//&nbsp;columns&nbsp;of&nbsp;the&nbsp;result&nbsp;is&nbsp;inferred&nbsp;from&nbsp;the&nbsp;length&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5830614">//&nbsp;slice.&nbsp;&nbsp;If&nbsp;a&nbsp;particular&nbsp;column&nbsp;name&nbsp;isn&#39;t&nbsp;known,&nbsp;an&nbsp;empty</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5830676">//&nbsp;string&nbsp;should&nbsp;be&nbsp;returned&nbsp;for&nbsp;that&nbsp;entry.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830722">Columns</span><span class="op" id="5830729">(</span><span class="op" id="5830730">)</span>&nbsp;<span class="op" id="5830732">[</span><span class="op" id="5830733">]</span><span class="builtintype" id="5830734">string</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5830743">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;rows&nbsp;iterator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5830779">Close</span><span class="op" id="5830784">(</span><span class="op" id="5830785">)</span>&nbsp;<span class="builtintype" id="5830787">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5830795">//&nbsp;Next&nbsp;is&nbsp;called&nbsp;to&nbsp;populate&nbsp;the&nbsp;next&nbsp;row&nbsp;of&nbsp;data&nbsp;into</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5830852">//&nbsp;the&nbsp;provided&nbsp;slice.&nbsp;The&nbsp;provided&nbsp;slice&nbsp;will&nbsp;be&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5830912">//&nbsp;size&nbsp;as&nbsp;the&nbsp;Columns()&nbsp;are&nbsp;wide.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5830948">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5830952">//&nbsp;The&nbsp;dest&nbsp;slice&nbsp;may&nbsp;be&nbsp;populated&nbsp;only&nbsp;with</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5830998">//&nbsp;a&nbsp;driver&nbsp;Value&nbsp;type,&nbsp;but&nbsp;excluding&nbsp;string.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5831045">//&nbsp;All&nbsp;string&nbsp;values&nbsp;must&nbsp;be&nbsp;converted&nbsp;to&nbsp;[]byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5831096">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5831100">//&nbsp;Next&nbsp;should&nbsp;return&nbsp;io.EOF&nbsp;when&nbsp;there&nbsp;are&nbsp;no&nbsp;more&nbsp;rows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5831159">Next</span><span class="op" id="5831163">(</span><span class="ident" id="5831164">dest</span>&nbsp;<span class="op" id="5831169">[</span><span class="op" id="5831170">]</span><span class="ident" id="5831171">Value</span><span class="op" id="5831176">)</span>&nbsp;<span class="builtintype" id="5831178">error</span><br>
<span class="lineno"></span><span class="op" id="5831184">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="5831187">//&nbsp;Tx&nbsp;is&nbsp;a&nbsp;transaction.</span><br>
<span class="lineno"></span><span class="keyword" id="5831211">type</span>&nbsp;<span class="ident" id="5831216">Tx</span>&nbsp;<span class="keyword" id="5831219">interface</span>&nbsp;<span class="op" id="5831229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5831232">Commit</span><span class="op" id="5831238">(</span><span class="op" id="5831239">)</span>&nbsp;<span class="builtintype" id="5831241">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5831248">Rollback</span><span class="op" id="5831256">(</span><span class="op" id="5831257">)</span>&nbsp;<span class="builtintype" id="5831259">error</span><br>
<span class="lineno">180</span><span class="op" id="5831265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5831268">//&nbsp;RowsAffected&nbsp;implements&nbsp;Result&nbsp;for&nbsp;an&nbsp;INSERT&nbsp;or&nbsp;UPDATE&nbsp;operation</span><br>
<span class="lineno"></span><span class="comment" id="5831336">//&nbsp;which&nbsp;mutates&nbsp;a&nbsp;number&nbsp;of&nbsp;rows.</span><br>
<span class="lineno"></span><span class="keyword" id="5831371">type</span>&nbsp;<span class="ident" id="5831376">RowsAffected</span>&nbsp;<span class="ident" id="5831389">int64</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="5831396">var</span>&nbsp;<span class="ident" id="5831400">_</span>&nbsp;<span class="ident" id="5831402">Result</span>&nbsp;<span class="op" id="5831409">=</span>&nbsp;<span class="ident" id="5831411">RowsAffected</span><span class="op" id="5831423">(</span><span class="num" id="5831424">0</span><span class="op" id="5831425">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5831428">func</span>&nbsp;<span class="op" id="5831433">(</span><span class="ident" id="5831434">RowsAffected</span><span class="op" id="5831446">)</span>&nbsp;<span class="ident" id="5831448">LastInsertId</span><span class="op" id="5831460">(</span><span class="op" id="5831461">)</span>&nbsp;<span class="op" id="5831463">(</span><span class="ident" id="5831464">int64</span><span class="op" id="5831469">,</span>&nbsp;<span class="builtintype" id="5831471">error</span><span class="op" id="5831476">)</span>&nbsp;<span class="op" id="5831478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5831481">return</span>&nbsp;<span class="num" id="5831488">0</span><span class="op" id="5831489">,</span>&nbsp;<span class="ident" id="5831491">errors</span><span class="op" id="5831497">.</span><span class="ident" id="5831498">New</span><span class="op" id="5831501">(</span><span class="string" id="5831502">&#34;no&nbsp;LastInsertId&nbsp;available&#34;</span><span class="op" id="5831529">)</span><br>
<span class="lineno">190</span><span class="op" id="5831531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5831534">func</span>&nbsp;<span class="op" id="5831539">(</span><span class="ident" id="5831540">v</span>&nbsp;<span class="ident" id="5831542">RowsAffected</span><span class="op" id="5831554">)</span>&nbsp;<span class="ident" id="5831556">RowsAffected</span><span class="op" id="5831568">(</span><span class="op" id="5831569">)</span>&nbsp;<span class="op" id="5831571">(</span><span class="ident" id="5831572">int64</span><span class="op" id="5831577">,</span>&nbsp;<span class="builtintype" id="5831579">error</span><span class="op" id="5831584">)</span>&nbsp;<span class="op" id="5831586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5831589">return</span>&nbsp;<span class="ident" id="5831596">int64</span><span class="op" id="5831601">(</span><span class="ident" id="5831602">v</span><span class="op" id="5831603">)</span><span class="op" id="5831604">,</span>&nbsp;<span class="ident" id="5831606">nil</span><br>
<span class="lineno"></span><span class="op" id="5831610">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="comment" id="5831613">//&nbsp;ResultNoRows&nbsp;is&nbsp;a&nbsp;pre-defined&nbsp;Result&nbsp;for&nbsp;drivers&nbsp;to&nbsp;return&nbsp;when&nbsp;a&nbsp;DDL</span><br>
<span class="lineno"></span><span class="comment" id="5831686">//&nbsp;command&nbsp;(such&nbsp;as&nbsp;a&nbsp;CREATE&nbsp;TABLE)&nbsp;succeeds.&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;for&nbsp;both</span><br>
<span class="lineno"></span><span class="comment" id="5831761">//&nbsp;LastInsertId&nbsp;and&nbsp;RowsAffected.</span><br>
<span class="lineno"></span><span class="keyword" id="5831795">var</span>&nbsp;<span class="ident" id="5831799">ResultNoRows</span>&nbsp;<span class="ident" id="5831812">noRows</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="5831820">type</span>&nbsp;<span class="ident" id="5831825">noRows</span>&nbsp;<span class="keyword" id="5831832">struct</span><span class="op" id="5831838">{</span><span class="op" id="5831839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5831842">var</span>&nbsp;<span class="ident" id="5831846">_</span>&nbsp;<span class="ident" id="5831848">Result</span>&nbsp;<span class="op" id="5831855">=</span>&nbsp;<span class="ident" id="5831857">noRows</span><span class="op" id="5831863">{</span><span class="op" id="5831864">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="keyword" id="5831867">func</span>&nbsp;<span class="op" id="5831872">(</span><span class="ident" id="5831873">noRows</span><span class="op" id="5831879">)</span>&nbsp;<span class="ident" id="5831881">LastInsertId</span><span class="op" id="5831893">(</span><span class="op" id="5831894">)</span>&nbsp;<span class="op" id="5831896">(</span><span class="ident" id="5831897">int64</span><span class="op" id="5831902">,</span>&nbsp;<span class="builtintype" id="5831904">error</span><span class="op" id="5831909">)</span>&nbsp;<span class="op" id="5831911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5831914">return</span>&nbsp;<span class="num" id="5831921">0</span><span class="op" id="5831922">,</span>&nbsp;<span class="ident" id="5831924">errors</span><span class="op" id="5831930">.</span><span class="ident" id="5831931">New</span><span class="op" id="5831934">(</span><span class="string" id="5831935">&#34;no&nbsp;LastInsertId&nbsp;available&nbsp;after&nbsp;DDL&nbsp;statement&#34;</span><span class="op" id="5831982">)</span><br>
<span class="lineno"></span><span class="op" id="5831984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5831987">func</span>&nbsp;<span class="op" id="5831992">(</span><span class="ident" id="5831993">noRows</span><span class="op" id="5831999">)</span>&nbsp;<span class="ident" id="5832001">RowsAffected</span><span class="op" id="5832013">(</span><span class="op" id="5832014">)</span>&nbsp;<span class="op" id="5832016">(</span><span class="ident" id="5832017">int64</span><span class="op" id="5832022">,</span>&nbsp;<span class="builtintype" id="5832024">error</span><span class="op" id="5832029">)</span>&nbsp;<span class="op" id="5832031">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5832034">return</span>&nbsp;<span class="num" id="5832041">0</span><span class="op" id="5832042">,</span>&nbsp;<span class="ident" id="5832044">errors</span><span class="op" id="5832050">.</span><span class="ident" id="5832051">New</span><span class="op" id="5832054">(</span><span class="string" id="5832055">&#34;no&nbsp;RowsAffected&nbsp;available&nbsp;after&nbsp;DDL&nbsp;statement&#34;</span><span class="op" id="5832102">)</span><br>
<span class="lineno"></span><span class="op" id="5832104">}</span>
</div>
</body>
</html>
