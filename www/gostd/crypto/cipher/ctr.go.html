<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/cipher</h2>
<ul>
<li><a href="/gostd/crypto/cipher/benchmark_test.go.html">benchmark_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc.go.html">cbc.go</a></li>
<li><a href="/gostd/crypto/cipher/cbc_aes_test.go.html">cbc_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb.go.html">cfb.go</a></li>
<li><a href="/gostd/crypto/cipher/cfb_test.go.html">cfb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/cipher/cipher_test.go.html">cipher_test.go</a></li>
<li><a href="/gostd/crypto/cipher/common_test.go.html">common_test.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr.go.html">ctr.go</a></li>
<li><a href="/gostd/crypto/cipher/ctr_aes_test.go.html">ctr_aes_test.go</a></li>
<li><a href="/gostd/crypto/cipher/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm.go.html">gcm.go</a></li>
<li><a href="/gostd/crypto/cipher/gcm_test.go.html">gcm_test.go</a></li>
<li><a href="/gostd/crypto/cipher/io.go.html">io.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb.go.html">ofb.go</a></li>
<li><a href="/gostd/crypto/cipher/ofb_test.go.html">ofb_test.go</a></li>
<li><a href="/gostd/crypto/cipher/xor.go.html">xor.go</a></li>
<li><a href="/gostd/crypto/cipher/xor_test.go.html">xor_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3926765">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3926820">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3926874">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3926925">//&nbsp;Counter&nbsp;(CTR)&nbsp;mode.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3926949">//&nbsp;CTR&nbsp;converts&nbsp;a&nbsp;block&nbsp;cipher&nbsp;into&nbsp;a&nbsp;stream&nbsp;cipher&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="3927004">//&nbsp;repeatedly&nbsp;encrypting&nbsp;an&nbsp;incrementing&nbsp;counter&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3927057">//&nbsp;xoring&nbsp;the&nbsp;resulting&nbsp;stream&nbsp;of&nbsp;data&nbsp;with&nbsp;the&nbsp;input.</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="3927113">//&nbsp;See&nbsp;NIST&nbsp;SP&nbsp;800-38A,&nbsp;pp&nbsp;13-15</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3927147">package</span>&nbsp;<span class="ident" id="3927155">cipher</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="3927163">type</span>&nbsp;<span class="ident" id="3927168">ctr</span>&nbsp;<span class="keyword" id="3927172">struct</span>&nbsp;<span class="op" id="3927179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927182">b</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3927190">Block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927197">ctr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3927205">[</span><span class="op" id="3927206">]</span><span class="builtintype" id="3927207">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927213">out</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3927221">[</span><span class="op" id="3927222">]</span><span class="builtintype" id="3927223">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927229">outUsed</span>&nbsp;<span class="builtintype" id="3927237">int</span><br>
<span class="lineno">20</span><span class="op" id="3927241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3927244">const</span>&nbsp;<span class="ident" id="3927250">streamBufferSize</span>&nbsp;<span class="op" id="3927267">=</span>&nbsp;<span class="num" id="3927269">512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3927274">//&nbsp;NewCTR&nbsp;returns&nbsp;a&nbsp;Stream&nbsp;which&nbsp;encrypts/decrypts&nbsp;using&nbsp;the&nbsp;given&nbsp;Block&nbsp;in</span><br>
<span class="lineno">25</span><span class="comment" id="3927350">//&nbsp;counter&nbsp;mode.&nbsp;The&nbsp;length&nbsp;of&nbsp;iv&nbsp;must&nbsp;be&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;Block&#39;s&nbsp;block&nbsp;size.</span><br>
<span class="lineno"></span><span class="keyword" id="3927428">func</span>&nbsp;<span class="ident" id="3927433">NewCTR</span><span class="op" id="3927439">(</span><span class="ident" id="3927440">block</span>&nbsp;<span class="ident" id="3927446">Block</span><span class="op" id="3927451">,</span>&nbsp;<span class="ident" id="3927453">iv</span>&nbsp;<span class="op" id="3927456">[</span><span class="op" id="3927457">]</span><span class="builtintype" id="3927458">byte</span><span class="op" id="3927462">)</span>&nbsp;<span class="ident" id="3927464">Stream</span>&nbsp;<span class="op" id="3927471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3927474">if</span>&nbsp;<span class="builtinfunc" id="3927477">len</span><span class="op" id="3927480">(</span><span class="ident" id="3927481">iv</span><span class="op" id="3927483">)</span>&nbsp;<span class="op" id="3927485">!=</span>&nbsp;<span class="ident" id="3927488">block</span><span class="op" id="3927493">.</span><span class="ident" id="3927494">BlockSize</span><span class="op" id="3927503">(</span><span class="op" id="3927504">)</span>&nbsp;<span class="op" id="3927506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3927510">panic</span><span class="op" id="3927515">(</span><span class="string" id="3927516">&#34;cipher.NewCTR:&nbsp;IV&nbsp;length&nbsp;must&nbsp;equal&nbsp;block&nbsp;size&#34;</span><span class="op" id="3927564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3927567">}</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927570">bufSize</span>&nbsp;<span class="op" id="3927578">:=</span>&nbsp;<span class="ident" id="3927581">streamBufferSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3927599">if</span>&nbsp;<span class="ident" id="3927602">bufSize</span>&nbsp;<span class="op" id="3927610">&lt;</span>&nbsp;<span class="ident" id="3927612">block</span><span class="op" id="3927617">.</span><span class="ident" id="3927618">BlockSize</span><span class="op" id="3927627">(</span><span class="op" id="3927628">)</span>&nbsp;<span class="op" id="3927630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927634">bufSize</span>&nbsp;<span class="op" id="3927642">=</span>&nbsp;<span class="ident" id="3927644">block</span><span class="op" id="3927649">.</span><span class="ident" id="3927650">BlockSize</span><span class="op" id="3927659">(</span><span class="op" id="3927660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3927663">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3927666">return</span>&nbsp;<span class="op" id="3927673">&amp;</span><span class="ident" id="3927674">ctr</span><span class="op" id="3927677">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927681">b</span><span class="op" id="3927682">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3927690">block</span><span class="op" id="3927695">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927699">ctr</span><span class="op" id="3927702">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3927708">dup</span><span class="op" id="3927711">(</span><span class="ident" id="3927712">iv</span><span class="op" id="3927714">)</span><span class="op" id="3927715">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927719">out</span><span class="op" id="3927722">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3927728">make</span><span class="op" id="3927732">(</span><span class="op" id="3927733">[</span><span class="op" id="3927734">]</span><span class="builtintype" id="3927735">byte</span><span class="op" id="3927739">,</span>&nbsp;<span class="num" id="3927741">0</span><span class="op" id="3927742">,</span>&nbsp;<span class="ident" id="3927744">bufSize</span><span class="op" id="3927751">)</span><span class="op" id="3927752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927756">outUsed</span><span class="op" id="3927763">:</span>&nbsp;<span class="num" id="3927765">0</span><span class="op" id="3927766">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3927769">}</span><br>
<span class="lineno">40</span><span class="op" id="3927771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3927774">func</span>&nbsp;<span class="op" id="3927779">(</span><span class="ident" id="3927780">x</span>&nbsp;<span class="op" id="3927782">*</span><span class="ident" id="3927783">ctr</span><span class="op" id="3927786">)</span>&nbsp;<span class="ident" id="3927788">refill</span><span class="op" id="3927794">(</span><span class="op" id="3927795">)</span>&nbsp;<span class="op" id="3927797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927800">remain</span>&nbsp;<span class="op" id="3927807">:=</span>&nbsp;<span class="builtinfunc" id="3927810">len</span><span class="op" id="3927813">(</span><span class="ident" id="3927814">x</span><span class="op" id="3927815">.</span><span class="ident" id="3927816">out</span><span class="op" id="3927819">)</span>&nbsp;<span class="op" id="3927821">-</span>&nbsp;<span class="ident" id="3927823">x</span><span class="op" id="3927824">.</span><span class="ident" id="3927825">outUsed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3927834">if</span>&nbsp;<span class="ident" id="3927837">remain</span>&nbsp;<span class="op" id="3927844">&gt;</span>&nbsp;<span class="ident" id="3927846">x</span><span class="op" id="3927847">.</span><span class="ident" id="3927848">outUsed</span>&nbsp;<span class="op" id="3927856">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3927860">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3927868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3927871">copy</span><span class="op" id="3927875">(</span><span class="ident" id="3927876">x</span><span class="op" id="3927877">.</span><span class="ident" id="3927878">out</span><span class="op" id="3927881">,</span>&nbsp;<span class="ident" id="3927883">x</span><span class="op" id="3927884">.</span><span class="ident" id="3927885">out</span><span class="op" id="3927888">[</span><span class="ident" id="3927889">x</span><span class="op" id="3927890">.</span><span class="ident" id="3927891">outUsed</span><span class="op" id="3927898">:</span><span class="op" id="3927899">]</span><span class="op" id="3927900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927903">x</span><span class="op" id="3927904">.</span><span class="ident" id="3927905">out</span>&nbsp;<span class="op" id="3927909">=</span>&nbsp;<span class="ident" id="3927911">x</span><span class="op" id="3927912">.</span><span class="ident" id="3927913">out</span><span class="op" id="3927916">[</span><span class="op" id="3927917">:</span><span class="builtinfunc" id="3927918">cap</span><span class="op" id="3927921">(</span><span class="ident" id="3927922">x</span><span class="op" id="3927923">.</span><span class="ident" id="3927924">out</span><span class="op" id="3927927">)</span><span class="op" id="3927928">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927931">bs</span>&nbsp;<span class="op" id="3927934">:=</span>&nbsp;<span class="ident" id="3927937">x</span><span class="op" id="3927938">.</span><span class="ident" id="3927939">b</span><span class="op" id="3927940">.</span><span class="ident" id="3927941">BlockSize</span><span class="op" id="3927950">(</span><span class="op" id="3927951">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3927954">for</span>&nbsp;<span class="ident" id="3927958">remain</span>&nbsp;<span class="op" id="3927965">&lt;</span>&nbsp;<span class="builtinfunc" id="3927967">len</span><span class="op" id="3927970">(</span><span class="ident" id="3927971">x</span><span class="op" id="3927972">.</span><span class="ident" id="3927973">out</span><span class="op" id="3927976">)</span><span class="op" id="3927977">-</span><span class="ident" id="3927978">bs</span>&nbsp;<span class="op" id="3927981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3927985">x</span><span class="op" id="3927986">.</span><span class="ident" id="3927987">b</span><span class="op" id="3927988">.</span><span class="ident" id="3927989">Encrypt</span><span class="op" id="3927996">(</span><span class="ident" id="3927997">x</span><span class="op" id="3927998">.</span><span class="ident" id="3927999">out</span><span class="op" id="3928002">[</span><span class="ident" id="3928003">remain</span><span class="op" id="3928009">:</span><span class="op" id="3928010">]</span><span class="op" id="3928011">,</span>&nbsp;<span class="ident" id="3928013">x</span><span class="op" id="3928014">.</span><span class="ident" id="3928015">ctr</span><span class="op" id="3928018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3928022">remain</span>&nbsp;<span class="op" id="3928029">+=</span>&nbsp;<span class="ident" id="3928032">bs</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3928038">//&nbsp;Increment&nbsp;counter</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3928061">for</span>&nbsp;<span class="ident" id="3928065">i</span>&nbsp;<span class="op" id="3928067">:=</span>&nbsp;<span class="builtinfunc" id="3928070">len</span><span class="op" id="3928073">(</span><span class="ident" id="3928074">x</span><span class="op" id="3928075">.</span><span class="ident" id="3928076">ctr</span><span class="op" id="3928079">)</span>&nbsp;<span class="op" id="3928081">-</span>&nbsp;<span class="num" id="3928083">1</span><span class="op" id="3928084">;</span>&nbsp;<span class="ident" id="3928086">i</span>&nbsp;<span class="op" id="3928088">&gt;=</span>&nbsp;<span class="num" id="3928091">0</span><span class="op" id="3928092">;</span>&nbsp;<span class="ident" id="3928094">i</span><span class="op" id="3928095">--</span>&nbsp;<span class="op" id="3928098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3928103">x</span><span class="op" id="3928104">.</span><span class="ident" id="3928105">ctr</span><span class="op" id="3928108">[</span><span class="ident" id="3928109">i</span><span class="op" id="3928110">]</span><span class="op" id="3928111">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3928117">if</span>&nbsp;<span class="ident" id="3928120">x</span><span class="op" id="3928121">.</span><span class="ident" id="3928122">ctr</span><span class="op" id="3928125">[</span><span class="ident" id="3928126">i</span><span class="op" id="3928127">]</span>&nbsp;<span class="op" id="3928129">!=</span>&nbsp;<span class="num" id="3928132">0</span>&nbsp;<span class="op" id="3928134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3928140">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3928149">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3928153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3928156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3928159">x</span><span class="op" id="3928160">.</span><span class="ident" id="3928161">out</span>&nbsp;<span class="op" id="3928165">=</span>&nbsp;<span class="ident" id="3928167">x</span><span class="op" id="3928168">.</span><span class="ident" id="3928169">out</span><span class="op" id="3928172">[</span><span class="op" id="3928173">:</span><span class="ident" id="3928174">remain</span><span class="op" id="3928180">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3928183">x</span><span class="op" id="3928184">.</span><span class="ident" id="3928185">outUsed</span>&nbsp;<span class="op" id="3928193">=</span>&nbsp;<span class="num" id="3928195">0</span><br>
<span class="lineno"></span><span class="op" id="3928197">}</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="3928200">func</span>&nbsp;<span class="op" id="3928205">(</span><span class="ident" id="3928206">x</span>&nbsp;<span class="op" id="3928208">*</span><span class="ident" id="3928209">ctr</span><span class="op" id="3928212">)</span>&nbsp;<span class="ident" id="3928214">XORKeyStream</span><span class="op" id="3928226">(</span><span class="ident" id="3928227">dst</span><span class="op" id="3928230">,</span>&nbsp;<span class="ident" id="3928232">src</span>&nbsp;<span class="op" id="3928236">[</span><span class="op" id="3928237">]</span><span class="builtintype" id="3928238">byte</span><span class="op" id="3928242">)</span>&nbsp;<span class="op" id="3928244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3928247">for</span>&nbsp;<span class="builtinfunc" id="3928251">len</span><span class="op" id="3928254">(</span><span class="ident" id="3928255">src</span><span class="op" id="3928258">)</span>&nbsp;<span class="op" id="3928260">&gt;</span>&nbsp;<span class="num" id="3928262">0</span>&nbsp;<span class="op" id="3928264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3928268">if</span>&nbsp;<span class="ident" id="3928271">x</span><span class="op" id="3928272">.</span><span class="ident" id="3928273">outUsed</span>&nbsp;<span class="op" id="3928281">&gt;=</span>&nbsp;<span class="builtinfunc" id="3928284">len</span><span class="op" id="3928287">(</span><span class="ident" id="3928288">x</span><span class="op" id="3928289">.</span><span class="ident" id="3928290">out</span><span class="op" id="3928293">)</span><span class="op" id="3928294">-</span><span class="ident" id="3928295">x</span><span class="op" id="3928296">.</span><span class="ident" id="3928297">b</span><span class="op" id="3928298">.</span><span class="ident" id="3928299">BlockSize</span><span class="op" id="3928308">(</span><span class="op" id="3928309">)</span>&nbsp;<span class="op" id="3928311">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3928316">x</span><span class="op" id="3928317">.</span><span class="ident" id="3928318">refill</span><span class="op" id="3928324">(</span><span class="op" id="3928325">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3928329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3928333">n</span>&nbsp;<span class="op" id="3928335">:=</span>&nbsp;<span class="ident" id="3928338">xorBytes</span><span class="op" id="3928346">(</span><span class="ident" id="3928347">dst</span><span class="op" id="3928350">,</span>&nbsp;<span class="ident" id="3928352">src</span><span class="op" id="3928355">,</span>&nbsp;<span class="ident" id="3928357">x</span><span class="op" id="3928358">.</span><span class="ident" id="3928359">out</span><span class="op" id="3928362">[</span><span class="ident" id="3928363">x</span><span class="op" id="3928364">.</span><span class="ident" id="3928365">outUsed</span><span class="op" id="3928372">:</span><span class="op" id="3928373">]</span><span class="op" id="3928374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3928378">dst</span>&nbsp;<span class="op" id="3928382">=</span>&nbsp;<span class="ident" id="3928384">dst</span><span class="op" id="3928387">[</span><span class="ident" id="3928388">n</span><span class="op" id="3928389">:</span><span class="op" id="3928390">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3928394">src</span>&nbsp;<span class="op" id="3928398">=</span>&nbsp;<span class="ident" id="3928400">src</span><span class="op" id="3928403">[</span><span class="ident" id="3928404">n</span><span class="op" id="3928405">:</span><span class="op" id="3928406">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3928410">x</span><span class="op" id="3928411">.</span><span class="ident" id="3928412">outUsed</span>&nbsp;<span class="op" id="3928420">+=</span>&nbsp;<span class="ident" id="3928423">n</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3928426">}</span><br>
<span class="lineno"></span><span class="op" id="3928428">}</span>
</div>
</body>
</html>
