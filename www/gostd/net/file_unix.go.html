<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html" class="current">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3904384">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3904439">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3904493">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3904544">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;netbsd&nbsp;openbsd&nbsp;solaris</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3904609">package</span>&nbsp;<span class="ident" id="3904617">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3904622">import</span>&nbsp;<span class="op" id="3904629">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3904632">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3904638">&#34;syscall&#34;</span><br>
<span class="lineno"></span><span class="op" id="3904648">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3904651">func</span>&nbsp;<span class="ident" id="3904656">newFileFD</span><span class="op" id="3904665">(</span><span class="ident" id="3904666">f</span>&nbsp;<span class="op" id="3904668">*</span><span class="ident" id="3904669">os</span><span class="op" id="3904671">.</span><span class="ident" id="3904672">File</span><span class="op" id="3904676">)</span>&nbsp;<span class="op" id="3904678">(</span><span class="op" id="3904679">*</span><span class="ident" id="3904680">netFD</span><span class="op" id="3904685">,</span>&nbsp;<span class="builtintype" id="3904687">error</span><span class="op" id="3904692">)</span>&nbsp;<span class="op" id="3904694">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3904697">fd</span><span class="op" id="3904699">,</span>&nbsp;<span class="ident" id="3904701">err</span>&nbsp;<span class="op" id="3904705">:=</span>&nbsp;<span class="ident" id="3904708">dupCloseOnExec</span><span class="op" id="3904722">(</span><span class="builtintype" id="3904723">int</span><span class="op" id="3904726">(</span><span class="ident" id="3904727">f</span><span class="op" id="3904728">.</span><span class="ident" id="3904729">Fd</span><span class="op" id="3904731">(</span><span class="op" id="3904732">)</span><span class="op" id="3904733">)</span><span class="op" id="3904734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3904737">if</span>&nbsp;<span class="ident" id="3904740">err</span>&nbsp;<span class="op" id="3904744">!=</span>&nbsp;<span class="builtintype" id="3904747">nil</span>&nbsp;<span class="op" id="3904751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3904755">return</span>&nbsp;<span class="builtintype" id="3904762">nil</span><span class="op" id="3904765">,</span>&nbsp;<span class="ident" id="3904767">os</span><span class="op" id="3904769">.</span><span class="ident" id="3904770">NewSyscallError</span><span class="op" id="3904785">(</span><span class="string" id="3904786">&#34;dup&#34;</span><span class="op" id="3904791">,</span>&nbsp;<span class="ident" id="3904793">err</span><span class="op" id="3904796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3904799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3904803">if</span>&nbsp;<span class="ident" id="3904806">err</span>&nbsp;<span class="op" id="3904810">=</span>&nbsp;<span class="ident" id="3904812">syscall</span><span class="op" id="3904819">.</span><span class="ident" id="3904820">SetNonblock</span><span class="op" id="3904831">(</span><span class="ident" id="3904832">fd</span><span class="op" id="3904834">,</span>&nbsp;<span class="builtintype" id="3904836">true</span><span class="op" id="3904840">)</span><span class="op" id="3904841">;</span>&nbsp;<span class="ident" id="3904843">err</span>&nbsp;<span class="op" id="3904847">!=</span>&nbsp;<span class="builtintype" id="3904850">nil</span>&nbsp;<span class="op" id="3904854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3904858">closesocket</span><span class="op" id="3904869">(</span><span class="ident" id="3904870">fd</span><span class="op" id="3904872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3904876">return</span>&nbsp;<span class="builtintype" id="3904883">nil</span><span class="op" id="3904886">,</span>&nbsp;<span class="ident" id="3904888">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3904893">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3904897">sotype</span><span class="op" id="3904903">,</span>&nbsp;<span class="ident" id="3904905">err</span>&nbsp;<span class="op" id="3904909">:=</span>&nbsp;<span class="ident" id="3904912">syscall</span><span class="op" id="3904919">.</span><span class="ident" id="3904920">GetsockoptInt</span><span class="op" id="3904933">(</span><span class="ident" id="3904934">fd</span><span class="op" id="3904936">,</span>&nbsp;<span class="ident" id="3904938">syscall</span><span class="op" id="3904945">.</span><span class="ident" id="3904946">SOL_SOCKET</span><span class="op" id="3904956">,</span>&nbsp;<span class="ident" id="3904958">syscall</span><span class="op" id="3904965">.</span><span class="ident" id="3904966">SO_TYPE</span><span class="op" id="3904973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3904976">if</span>&nbsp;<span class="ident" id="3904979">err</span>&nbsp;<span class="op" id="3904983">!=</span>&nbsp;<span class="builtintype" id="3904986">nil</span>&nbsp;<span class="op" id="3904990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3904994">closesocket</span><span class="op" id="3905005">(</span><span class="ident" id="3905006">fd</span><span class="op" id="3905008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3905012">return</span>&nbsp;<span class="builtintype" id="3905019">nil</span><span class="op" id="3905022">,</span>&nbsp;<span class="ident" id="3905024">os</span><span class="op" id="3905026">.</span><span class="ident" id="3905027">NewSyscallError</span><span class="op" id="3905042">(</span><span class="string" id="3905043">&#34;getsockopt&#34;</span><span class="op" id="3905055">,</span>&nbsp;<span class="ident" id="3905057">err</span><span class="op" id="3905060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3905063">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3905067">family</span>&nbsp;<span class="op" id="3905074">:=</span>&nbsp;<span class="ident" id="3905077">syscall</span><span class="op" id="3905084">.</span><span class="ident" id="3905085">AF_UNSPEC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3905096">toAddr</span>&nbsp;<span class="op" id="3905103">:=</span>&nbsp;<span class="ident" id="3905106">sockaddrToTCP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3905121">lsa</span><span class="op" id="3905124">,</span>&nbsp;<span class="ident" id="3905126">_</span>&nbsp;<span class="op" id="3905128">:=</span>&nbsp;<span class="ident" id="3905131">syscall</span><span class="op" id="3905138">.</span><span class="ident" id="3905139">Getsockname</span><span class="op" id="3905150">(</span><span class="ident" id="3905151">fd</span><span class="op" id="3905153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3905156">switch</span>&nbsp;<span class="ident" id="3905163">lsa</span><span class="op" id="3905166">.</span><span class="op" id="3905167">(</span><span class="keyword" id="3905168">type</span><span class="op" id="3905172">)</span>&nbsp;<span class="op" id="3905174">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3905177">default</span><span class="op" id="3905184">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3905188">closesocket</span><span class="op" id="3905199">(</span><span class="ident" id="3905200">fd</span><span class="op" id="3905202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3905206">return</span>&nbsp;<span class="builtintype" id="3905213">nil</span><span class="op" id="3905216">,</span>&nbsp;<span class="ident" id="3905218">syscall</span><span class="op" id="3905225">.</span><span class="ident" id="3905226">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3905234">case</span>&nbsp;<span class="op" id="3905239">*</span><span class="ident" id="3905240">syscall</span><span class="op" id="3905247">.</span><span class="ident" id="3905248">SockaddrInet4</span><span class="op" id="3905261">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3905265">family</span>&nbsp;<span class="op" id="3905272">=</span>&nbsp;<span class="ident" id="3905274">syscall</span><span class="op" id="3905281">.</span><span class="ident" id="3905282">AF_INET</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3905292">if</span>&nbsp;<span class="ident" id="3905295">sotype</span>&nbsp;<span class="op" id="3905302">==</span>&nbsp;<span class="ident" id="3905305">syscall</span><span class="op" id="3905312">.</span><span class="ident" id="3905313">SOCK_DGRAM</span>&nbsp;<span class="op" id="3905324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3905329">toAddr</span>&nbsp;<span class="op" id="3905336">=</span>&nbsp;<span class="ident" id="3905338">sockaddrToUDP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3905354">}</span>&nbsp;<span class="keyword" id="3905356">else</span>&nbsp;<span class="keyword" id="3905361">if</span>&nbsp;<span class="ident" id="3905364">sotype</span>&nbsp;<span class="op" id="3905371">==</span>&nbsp;<span class="ident" id="3905374">syscall</span><span class="op" id="3905381">.</span><span class="ident" id="3905382">SOCK_RAW</span>&nbsp;<span class="op" id="3905391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3905396">toAddr</span>&nbsp;<span class="op" id="3905403">=</span>&nbsp;<span class="ident" id="3905405">sockaddrToIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3905420">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3905423">case</span>&nbsp;<span class="op" id="3905428">*</span><span class="ident" id="3905429">syscall</span><span class="op" id="3905436">.</span><span class="ident" id="3905437">SockaddrInet6</span><span class="op" id="3905450">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3905454">family</span>&nbsp;<span class="op" id="3905461">=</span>&nbsp;<span class="ident" id="3905463">syscall</span><span class="op" id="3905470">.</span><span class="ident" id="3905471">AF_INET6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3905482">if</span>&nbsp;<span class="ident" id="3905485">sotype</span>&nbsp;<span class="op" id="3905492">==</span>&nbsp;<span class="ident" id="3905495">syscall</span><span class="op" id="3905502">.</span><span class="ident" id="3905503">SOCK_DGRAM</span>&nbsp;<span class="op" id="3905514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3905519">toAddr</span>&nbsp;<span class="op" id="3905526">=</span>&nbsp;<span class="ident" id="3905528">sockaddrToUDP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3905544">}</span>&nbsp;<span class="keyword" id="3905546">else</span>&nbsp;<span class="keyword" id="3905551">if</span>&nbsp;<span class="ident" id="3905554">sotype</span>&nbsp;<span class="op" id="3905561">==</span>&nbsp;<span class="ident" id="3905564">syscall</span><span class="op" id="3905571">.</span><span class="ident" id="3905572">SOCK_RAW</span>&nbsp;<span class="op" id="3905581">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3905586">toAddr</span>&nbsp;<span class="op" id="3905593">=</span>&nbsp;<span class="ident" id="3905595">sockaddrToIP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3905610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3905613">case</span>&nbsp;<span class="op" id="3905618">*</span><span class="ident" id="3905619">syscall</span><span class="op" id="3905626">.</span><span class="ident" id="3905627">SockaddrUnix</span><span class="op" id="3905639">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3905643">family</span>&nbsp;<span class="op" id="3905650">=</span>&nbsp;<span class="ident" id="3905652">syscall</span><span class="op" id="3905659">.</span><span class="ident" id="3905660">AF_UNIX</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3905670">toAddr</span>&nbsp;<span class="op" id="3905677">=</span>&nbsp;<span class="ident" id="3905679">sockaddrToUnix</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3905696">if</span>&nbsp;<span class="ident" id="3905699">sotype</span>&nbsp;<span class="op" id="3905706">==</span>&nbsp;<span class="ident" id="3905709">syscall</span><span class="op" id="3905716">.</span><span class="ident" id="3905717">SOCK_DGRAM</span>&nbsp;<span class="op" id="3905728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3905733">toAddr</span>&nbsp;<span class="op" id="3905740">=</span>&nbsp;<span class="ident" id="3905742">sockaddrToUnixgram</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3905763">}</span>&nbsp;<span class="keyword" id="3905765">else</span>&nbsp;<span class="keyword" id="3905770">if</span>&nbsp;<span class="ident" id="3905773">sotype</span>&nbsp;<span class="op" id="3905780">==</span>&nbsp;<span class="ident" id="3905783">syscall</span><span class="op" id="3905790">.</span><span class="ident" id="3905791">SOCK_SEQPACKET</span>&nbsp;<span class="op" id="3905806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3905811">toAddr</span>&nbsp;<span class="op" id="3905818">=</span>&nbsp;<span class="ident" id="3905820">sockaddrToUnixpacket</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3905843">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3905846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3905849">laddr</span>&nbsp;<span class="op" id="3905855">:=</span>&nbsp;<span class="ident" id="3905858">toAddr</span><span class="op" id="3905864">(</span><span class="ident" id="3905865">lsa</span><span class="op" id="3905868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3905871">rsa</span><span class="op" id="3905874">,</span>&nbsp;<span class="ident" id="3905876">_</span>&nbsp;<span class="op" id="3905878">:=</span>&nbsp;<span class="ident" id="3905881">syscall</span><span class="op" id="3905888">.</span><span class="ident" id="3905889">Getpeername</span><span class="op" id="3905900">(</span><span class="ident" id="3905901">fd</span><span class="op" id="3905903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3905906">raddr</span>&nbsp;<span class="op" id="3905912">:=</span>&nbsp;<span class="ident" id="3905915">toAddr</span><span class="op" id="3905921">(</span><span class="ident" id="3905922">rsa</span><span class="op" id="3905925">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3905929">netfd</span><span class="op" id="3905934">,</span>&nbsp;<span class="ident" id="3905936">err</span>&nbsp;<span class="op" id="3905940">:=</span>&nbsp;<span class="ident" id="3905943">newFD</span><span class="op" id="3905948">(</span><span class="ident" id="3905949">fd</span><span class="op" id="3905951">,</span>&nbsp;<span class="ident" id="3905953">family</span><span class="op" id="3905959">,</span>&nbsp;<span class="ident" id="3905961">sotype</span><span class="op" id="3905967">,</span>&nbsp;<span class="ident" id="3905969">laddr</span><span class="op" id="3905974">.</span><span class="ident" id="3905975">Network</span><span class="op" id="3905982">(</span><span class="op" id="3905983">)</span><span class="op" id="3905984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3905987">if</span>&nbsp;<span class="ident" id="3905990">err</span>&nbsp;<span class="op" id="3905994">!=</span>&nbsp;<span class="builtintype" id="3905997">nil</span>&nbsp;<span class="op" id="3906001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3906005">closesocket</span><span class="op" id="3906016">(</span><span class="ident" id="3906017">fd</span><span class="op" id="3906019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3906023">return</span>&nbsp;<span class="builtintype" id="3906030">nil</span><span class="op" id="3906033">,</span>&nbsp;<span class="ident" id="3906035">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3906040">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3906043">if</span>&nbsp;<span class="ident" id="3906046">err</span>&nbsp;<span class="op" id="3906050">:=</span>&nbsp;<span class="ident" id="3906053">netfd</span><span class="op" id="3906058">.</span><span class="ident" id="3906059">init</span><span class="op" id="3906063">(</span><span class="op" id="3906064">)</span><span class="op" id="3906065">;</span>&nbsp;<span class="ident" id="3906067">err</span>&nbsp;<span class="op" id="3906071">!=</span>&nbsp;<span class="builtintype" id="3906074">nil</span>&nbsp;<span class="op" id="3906078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3906082">netfd</span><span class="op" id="3906087">.</span><span class="ident" id="3906088">Close</span><span class="op" id="3906093">(</span><span class="op" id="3906094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3906098">return</span>&nbsp;<span class="builtintype" id="3906105">nil</span><span class="op" id="3906108">,</span>&nbsp;<span class="ident" id="3906110">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3906115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3906118">netfd</span><span class="op" id="3906123">.</span><span class="ident" id="3906124">setAddr</span><span class="op" id="3906131">(</span><span class="ident" id="3906132">laddr</span><span class="op" id="3906137">,</span>&nbsp;<span class="ident" id="3906139">raddr</span><span class="op" id="3906144">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3906147">return</span>&nbsp;<span class="ident" id="3906154">netfd</span><span class="op" id="3906159">,</span>&nbsp;<span class="builtintype" id="3906161">nil</span><br>
<span class="lineno"></span><span class="op" id="3906165">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3906168">//&nbsp;FileConn&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;network&nbsp;connection&nbsp;corresponding&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3906238">//&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when</span><br>
<span class="lineno">80</span><span class="comment" id="3906309">//&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="3906375">//&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="3906388">func</span>&nbsp;<span class="ident" id="3906393">FileConn</span><span class="op" id="3906401">(</span><span class="ident" id="3906402">f</span>&nbsp;<span class="op" id="3906404">*</span><span class="ident" id="3906405">os</span><span class="op" id="3906407">.</span><span class="ident" id="3906408">File</span><span class="op" id="3906412">)</span>&nbsp;<span class="op" id="3906414">(</span><span class="ident" id="3906415">c</span>&nbsp;<span class="ident" id="3906417">Conn</span><span class="op" id="3906421">,</span>&nbsp;<span class="ident" id="3906423">err</span>&nbsp;<span class="builtintype" id="3906427">error</span><span class="op" id="3906432">)</span>&nbsp;<span class="op" id="3906434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3906437">fd</span><span class="op" id="3906439">,</span>&nbsp;<span class="ident" id="3906441">err</span>&nbsp;<span class="op" id="3906445">:=</span>&nbsp;<span class="ident" id="3906448">newFileFD</span><span class="op" id="3906457">(</span><span class="ident" id="3906458">f</span><span class="op" id="3906459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3906462">if</span>&nbsp;<span class="ident" id="3906465">err</span>&nbsp;<span class="op" id="3906469">!=</span>&nbsp;<span class="builtintype" id="3906472">nil</span>&nbsp;<span class="op" id="3906476">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3906480">return</span>&nbsp;<span class="builtintype" id="3906487">nil</span><span class="op" id="3906490">,</span>&nbsp;<span class="ident" id="3906492">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3906497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3906500">switch</span>&nbsp;<span class="ident" id="3906507">fd</span><span class="op" id="3906509">.</span><span class="ident" id="3906510">laddr</span><span class="op" id="3906515">.</span><span class="op" id="3906516">(</span><span class="keyword" id="3906517">type</span><span class="op" id="3906521">)</span>&nbsp;<span class="op" id="3906523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3906526">case</span>&nbsp;<span class="op" id="3906531">*</span><span class="ident" id="3906532">TCPAddr</span><span class="op" id="3906539">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3906543">return</span>&nbsp;<span class="ident" id="3906550">newTCPConn</span><span class="op" id="3906560">(</span><span class="ident" id="3906561">fd</span><span class="op" id="3906563">)</span><span class="op" id="3906564">,</span>&nbsp;<span class="builtintype" id="3906566">nil</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3906571">case</span>&nbsp;<span class="op" id="3906576">*</span><span class="ident" id="3906577">UDPAddr</span><span class="op" id="3906584">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3906588">return</span>&nbsp;<span class="ident" id="3906595">newUDPConn</span><span class="op" id="3906605">(</span><span class="ident" id="3906606">fd</span><span class="op" id="3906608">)</span><span class="op" id="3906609">,</span>&nbsp;<span class="builtintype" id="3906611">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3906616">case</span>&nbsp;<span class="op" id="3906621">*</span><span class="ident" id="3906622">IPAddr</span><span class="op" id="3906628">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3906632">return</span>&nbsp;<span class="ident" id="3906639">newIPConn</span><span class="op" id="3906648">(</span><span class="ident" id="3906649">fd</span><span class="op" id="3906651">)</span><span class="op" id="3906652">,</span>&nbsp;<span class="builtintype" id="3906654">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3906659">case</span>&nbsp;<span class="op" id="3906664">*</span><span class="ident" id="3906665">UnixAddr</span><span class="op" id="3906673">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3906677">return</span>&nbsp;<span class="ident" id="3906684">newUnixConn</span><span class="op" id="3906695">(</span><span class="ident" id="3906696">fd</span><span class="op" id="3906698">)</span><span class="op" id="3906699">,</span>&nbsp;<span class="builtintype" id="3906701">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3906706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3906709">fd</span><span class="op" id="3906711">.</span><span class="ident" id="3906712">Close</span><span class="op" id="3906717">(</span><span class="op" id="3906718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3906721">return</span>&nbsp;<span class="builtintype" id="3906728">nil</span><span class="op" id="3906731">,</span>&nbsp;<span class="ident" id="3906733">syscall</span><span class="op" id="3906740">.</span><span class="ident" id="3906741">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3906748">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="comment" id="3906751">//&nbsp;FileListener&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;network&nbsp;listener&nbsp;corresponding</span><br>
<span class="lineno"></span><span class="comment" id="3906820">//&nbsp;to&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;l</span><br>
<span class="lineno"></span><span class="comment" id="3906889">//&nbsp;when&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;l&nbsp;does&nbsp;not&nbsp;affect&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not</span><br>
<span class="lineno"></span><span class="comment" id="3906960">//&nbsp;affect&nbsp;l.</span><br>
<span class="lineno">105</span><span class="keyword" id="3906973">func</span>&nbsp;<span class="ident" id="3906978">FileListener</span><span class="op" id="3906990">(</span><span class="ident" id="3906991">f</span>&nbsp;<span class="op" id="3906993">*</span><span class="ident" id="3906994">os</span><span class="op" id="3906996">.</span><span class="ident" id="3906997">File</span><span class="op" id="3907001">)</span>&nbsp;<span class="op" id="3907003">(</span><span class="ident" id="3907004">l</span>&nbsp;<span class="ident" id="3907006">Listener</span><span class="op" id="3907014">,</span>&nbsp;<span class="ident" id="3907016">err</span>&nbsp;<span class="builtintype" id="3907020">error</span><span class="op" id="3907025">)</span>&nbsp;<span class="op" id="3907027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3907030">fd</span><span class="op" id="3907032">,</span>&nbsp;<span class="ident" id="3907034">err</span>&nbsp;<span class="op" id="3907038">:=</span>&nbsp;<span class="ident" id="3907041">newFileFD</span><span class="op" id="3907050">(</span><span class="ident" id="3907051">f</span><span class="op" id="3907052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3907055">if</span>&nbsp;<span class="ident" id="3907058">err</span>&nbsp;<span class="op" id="3907062">!=</span>&nbsp;<span class="builtintype" id="3907065">nil</span>&nbsp;<span class="op" id="3907069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3907073">return</span>&nbsp;<span class="builtintype" id="3907080">nil</span><span class="op" id="3907083">,</span>&nbsp;<span class="ident" id="3907085">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3907090">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3907093">switch</span>&nbsp;<span class="ident" id="3907100">laddr</span>&nbsp;<span class="op" id="3907106">:=</span>&nbsp;<span class="ident" id="3907109">fd</span><span class="op" id="3907111">.</span><span class="ident" id="3907112">laddr</span><span class="op" id="3907117">.</span><span class="op" id="3907118">(</span><span class="keyword" id="3907119">type</span><span class="op" id="3907123">)</span>&nbsp;<span class="op" id="3907125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3907128">case</span>&nbsp;<span class="op" id="3907133">*</span><span class="ident" id="3907134">TCPAddr</span><span class="op" id="3907141">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3907145">return</span>&nbsp;<span class="op" id="3907152">&amp;</span><span class="ident" id="3907153">TCPListener</span><span class="op" id="3907164">{</span><span class="ident" id="3907165">fd</span><span class="op" id="3907167">}</span><span class="op" id="3907168">,</span>&nbsp;<span class="builtintype" id="3907170">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3907175">case</span>&nbsp;<span class="op" id="3907180">*</span><span class="ident" id="3907181">UnixAddr</span><span class="op" id="3907189">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3907193">return</span>&nbsp;<span class="op" id="3907200">&amp;</span><span class="ident" id="3907201">UnixListener</span><span class="op" id="3907213">{</span><span class="ident" id="3907214">fd</span><span class="op" id="3907216">,</span>&nbsp;<span class="ident" id="3907218">laddr</span><span class="op" id="3907223">.</span><span class="ident" id="3907224">Name</span><span class="op" id="3907228">}</span><span class="op" id="3907229">,</span>&nbsp;<span class="builtintype" id="3907231">nil</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3907236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3907239">fd</span><span class="op" id="3907241">.</span><span class="ident" id="3907242">Close</span><span class="op" id="3907247">(</span><span class="op" id="3907248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3907251">return</span>&nbsp;<span class="builtintype" id="3907258">nil</span><span class="op" id="3907261">,</span>&nbsp;<span class="ident" id="3907263">syscall</span><span class="op" id="3907270">.</span><span class="ident" id="3907271">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3907278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="3907281">//&nbsp;FilePacketConn&nbsp;returns&nbsp;a&nbsp;copy&nbsp;of&nbsp;the&nbsp;packet&nbsp;network&nbsp;connection</span><br>
<span class="lineno"></span><span class="comment" id="3907347">//&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;open&nbsp;file&nbsp;f.&nbsp;&nbsp;It&nbsp;is&nbsp;the&nbsp;caller&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3907404">//&nbsp;responsibility&nbsp;to&nbsp;close&nbsp;f&nbsp;when&nbsp;finished.&nbsp;&nbsp;Closing&nbsp;c&nbsp;does&nbsp;not&nbsp;affect</span><br>
<span class="lineno"></span><span class="comment" id="3907475">//&nbsp;f,&nbsp;and&nbsp;closing&nbsp;f&nbsp;does&nbsp;not&nbsp;affect&nbsp;c.</span><br>
<span class="lineno"></span><span class="keyword" id="3907514">func</span>&nbsp;<span class="ident" id="3907519">FilePacketConn</span><span class="op" id="3907533">(</span><span class="ident" id="3907534">f</span>&nbsp;<span class="op" id="3907536">*</span><span class="ident" id="3907537">os</span><span class="op" id="3907539">.</span><span class="ident" id="3907540">File</span><span class="op" id="3907544">)</span>&nbsp;<span class="op" id="3907546">(</span><span class="ident" id="3907547">c</span>&nbsp;<span class="ident" id="3907549">PacketConn</span><span class="op" id="3907559">,</span>&nbsp;<span class="ident" id="3907561">err</span>&nbsp;<span class="builtintype" id="3907565">error</span><span class="op" id="3907570">)</span>&nbsp;<span class="op" id="3907572">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3907575">fd</span><span class="op" id="3907577">,</span>&nbsp;<span class="ident" id="3907579">err</span>&nbsp;<span class="op" id="3907583">:=</span>&nbsp;<span class="ident" id="3907586">newFileFD</span><span class="op" id="3907595">(</span><span class="ident" id="3907596">f</span><span class="op" id="3907597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3907600">if</span>&nbsp;<span class="ident" id="3907603">err</span>&nbsp;<span class="op" id="3907607">!=</span>&nbsp;<span class="builtintype" id="3907610">nil</span>&nbsp;<span class="op" id="3907614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3907618">return</span>&nbsp;<span class="builtintype" id="3907625">nil</span><span class="op" id="3907628">,</span>&nbsp;<span class="ident" id="3907630">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3907635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3907638">switch</span>&nbsp;<span class="ident" id="3907645">fd</span><span class="op" id="3907647">.</span><span class="ident" id="3907648">laddr</span><span class="op" id="3907653">.</span><span class="op" id="3907654">(</span><span class="keyword" id="3907655">type</span><span class="op" id="3907659">)</span>&nbsp;<span class="op" id="3907661">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3907664">case</span>&nbsp;<span class="op" id="3907669">*</span><span class="ident" id="3907670">UDPAddr</span><span class="op" id="3907677">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3907681">return</span>&nbsp;<span class="ident" id="3907688">newUDPConn</span><span class="op" id="3907698">(</span><span class="ident" id="3907699">fd</span><span class="op" id="3907701">)</span><span class="op" id="3907702">,</span>&nbsp;<span class="builtintype" id="3907704">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3907709">case</span>&nbsp;<span class="op" id="3907714">*</span><span class="ident" id="3907715">IPAddr</span><span class="op" id="3907721">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3907725">return</span>&nbsp;<span class="ident" id="3907732">newIPConn</span><span class="op" id="3907741">(</span><span class="ident" id="3907742">fd</span><span class="op" id="3907744">)</span><span class="op" id="3907745">,</span>&nbsp;<span class="builtintype" id="3907747">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3907752">case</span>&nbsp;<span class="op" id="3907757">*</span><span class="ident" id="3907758">UnixAddr</span><span class="op" id="3907766">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3907770">return</span>&nbsp;<span class="ident" id="3907777">newUnixConn</span><span class="op" id="3907788">(</span><span class="ident" id="3907789">fd</span><span class="op" id="3907791">)</span><span class="op" id="3907792">,</span>&nbsp;<span class="builtintype" id="3907794">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3907799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3907802">fd</span><span class="op" id="3907804">.</span><span class="ident" id="3907805">Close</span><span class="op" id="3907810">(</span><span class="op" id="3907811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3907814">return</span>&nbsp;<span class="builtintype" id="3907821">nil</span><span class="op" id="3907824">,</span>&nbsp;<span class="ident" id="3907826">syscall</span><span class="op" id="3907833">.</span><span class="ident" id="3907834">EINVAL</span><br>
<span class="lineno"></span><span class="op" id="3907841">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
