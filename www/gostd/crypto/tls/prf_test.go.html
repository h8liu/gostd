<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7960278">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7960333">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7960387">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7960438">package</span>&nbsp;<span class="ident" id="7960446">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7960451">import</span>&nbsp;<span class="op" id="7960458">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7960461">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7960477">&#34;testing&#34;</span><br>
<span class="lineno">10</span><span class="op" id="7960487">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7960490">type</span>&nbsp;<span class="ident" id="7960495">testSplitPreMasterSecretTest</span>&nbsp;<span class="keyword" id="7960524">struct</span>&nbsp;<span class="op" id="7960531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7960534">in</span><span class="op" id="7960536">,</span>&nbsp;<span class="ident" id="7960538">out1</span><span class="op" id="7960542">,</span>&nbsp;<span class="ident" id="7960544">out2</span>&nbsp;<span class="builtintype" id="7960549">string</span><br>
<span class="lineno"></span><span class="op" id="7960556">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7960559">var</span>&nbsp;<span class="ident" id="7960563">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="7960593">=</span>&nbsp;<span class="op" id="7960595">[</span><span class="op" id="7960596">]</span><span class="ident" id="7960597">testSplitPreMasterSecretTest</span><span class="op" id="7960625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7960628">{</span><span class="string" id="7960629">&#34;&#34;</span><span class="op" id="7960631">,</span>&nbsp;<span class="string" id="7960633">&#34;&#34;</span><span class="op" id="7960635">,</span>&nbsp;<span class="string" id="7960637">&#34;&#34;</span><span class="op" id="7960639">}</span><span class="op" id="7960640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7960643">{</span><span class="string" id="7960644">&#34;00&#34;</span><span class="op" id="7960648">,</span>&nbsp;<span class="string" id="7960650">&#34;00&#34;</span><span class="op" id="7960654">,</span>&nbsp;<span class="string" id="7960656">&#34;00&#34;</span><span class="op" id="7960660">}</span><span class="op" id="7960661">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7960664">{</span><span class="string" id="7960665">&#34;0011&#34;</span><span class="op" id="7960671">,</span>&nbsp;<span class="string" id="7960673">&#34;00&#34;</span><span class="op" id="7960677">,</span>&nbsp;<span class="string" id="7960679">&#34;11&#34;</span><span class="op" id="7960683">}</span><span class="op" id="7960684">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7960687">{</span><span class="string" id="7960688">&#34;001122&#34;</span><span class="op" id="7960696">,</span>&nbsp;<span class="string" id="7960698">&#34;0011&#34;</span><span class="op" id="7960704">,</span>&nbsp;<span class="string" id="7960706">&#34;1122&#34;</span><span class="op" id="7960712">}</span><span class="op" id="7960713">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7960716">{</span><span class="string" id="7960717">&#34;00112233&#34;</span><span class="op" id="7960727">,</span>&nbsp;<span class="string" id="7960729">&#34;0011&#34;</span><span class="op" id="7960735">,</span>&nbsp;<span class="string" id="7960737">&#34;2233&#34;</span><span class="op" id="7960743">}</span><span class="op" id="7960744">,</span><br>
<span class="lineno"></span><span class="op" id="7960746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7960749">func</span>&nbsp;<span class="ident" id="7960754">TestSplitPreMasterSecret</span><span class="op" id="7960778">(</span><span class="ident" id="7960779">t</span>&nbsp;<span class="op" id="7960781">*</span><span class="ident" id="7960782">testing</span><span class="op" id="7960789">.</span><span class="ident" id="7960790">T</span><span class="op" id="7960791">)</span>&nbsp;<span class="op" id="7960793">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7960796">for</span>&nbsp;<span class="ident" id="7960800">i</span><span class="op" id="7960801">,</span>&nbsp;<span class="ident" id="7960803">test</span>&nbsp;<span class="op" id="7960808">:=</span>&nbsp;<span class="keyword" id="7960811">range</span>&nbsp;<span class="ident" id="7960817">testSplitPreMasterSecretTests</span>&nbsp;<span class="op" id="7960847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7960851">in</span><span class="op" id="7960853">,</span>&nbsp;<span class="ident" id="7960855">_</span>&nbsp;<span class="op" id="7960857">:=</span>&nbsp;<span class="ident" id="7960860">hex</span><span class="op" id="7960863">.</span><span class="ident" id="7960864">DecodeString</span><span class="op" id="7960876">(</span><span class="ident" id="7960877">test</span><span class="op" id="7960881">.</span><span class="ident" id="7960882">in</span><span class="op" id="7960884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7960888">out1</span><span class="op" id="7960892">,</span>&nbsp;<span class="ident" id="7960894">out2</span>&nbsp;<span class="op" id="7960899">:=</span>&nbsp;<span class="ident" id="7960902">splitPreMasterSecret</span><span class="op" id="7960922">(</span><span class="ident" id="7960923">in</span><span class="op" id="7960925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7960929">s1</span>&nbsp;<span class="op" id="7960932">:=</span>&nbsp;<span class="ident" id="7960935">hex</span><span class="op" id="7960938">.</span><span class="ident" id="7960939">EncodeToString</span><span class="op" id="7960953">(</span><span class="ident" id="7960954">out1</span><span class="op" id="7960958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7960962">s2</span>&nbsp;<span class="op" id="7960965">:=</span>&nbsp;<span class="ident" id="7960968">hex</span><span class="op" id="7960971">.</span><span class="ident" id="7960972">EncodeToString</span><span class="op" id="7960986">(</span><span class="ident" id="7960987">out2</span><span class="op" id="7960991">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7960995">if</span>&nbsp;<span class="ident" id="7960998">s1</span>&nbsp;<span class="op" id="7961001">!=</span>&nbsp;<span class="ident" id="7961004">test</span><span class="op" id="7961008">.</span><span class="ident" id="7961009">out1</span>&nbsp;<span class="op" id="7961014">||</span>&nbsp;<span class="ident" id="7961017">s2</span>&nbsp;<span class="op" id="7961020">!=</span>&nbsp;<span class="ident" id="7961023">test</span><span class="op" id="7961027">.</span><span class="ident" id="7961028">out2</span>&nbsp;<span class="op" id="7961033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7961038">t</span><span class="op" id="7961039">.</span><span class="ident" id="7961040">Errorf</span><span class="op" id="7961046">(</span><span class="string" id="7961047">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s)&#34;</span><span class="op" id="7961082">,</span>&nbsp;<span class="ident" id="7961084">i</span><span class="op" id="7961085">,</span>&nbsp;<span class="ident" id="7961087">s1</span><span class="op" id="7961089">,</span>&nbsp;<span class="ident" id="7961091">s2</span><span class="op" id="7961093">,</span>&nbsp;<span class="ident" id="7961095">test</span><span class="op" id="7961099">.</span><span class="ident" id="7961100">out1</span><span class="op" id="7961104">,</span>&nbsp;<span class="ident" id="7961106">test</span><span class="op" id="7961110">.</span><span class="ident" id="7961111">out2</span><span class="op" id="7961115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7961119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7961122">}</span><br>
<span class="lineno"></span><span class="op" id="7961124">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="7961127">type</span>&nbsp;<span class="ident" id="7961132">testKeysFromTest</span>&nbsp;<span class="keyword" id="7961149">struct</span>&nbsp;<span class="op" id="7961156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7961159">version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7961186">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7961194">preMasterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7961221">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7961229">clientRandom</span><span class="op" id="7961241">,</span>&nbsp;<span class="ident" id="7961243">serverRandom</span>&nbsp;<span class="builtintype" id="7961256">string</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7961264">masterSecret</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7961291">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7961299">clientMAC</span><span class="op" id="7961308">,</span>&nbsp;<span class="ident" id="7961310">serverMAC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7961326">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7961334">clientKey</span><span class="op" id="7961343">,</span>&nbsp;<span class="ident" id="7961345">serverKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7961361">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7961369">macLen</span><span class="op" id="7961375">,</span>&nbsp;<span class="ident" id="7961377">keyLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7961396">int</span><br>
<span class="lineno"></span><span class="op" id="7961400">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7961403">func</span>&nbsp;<span class="ident" id="7961408">TestKeysFromPreMasterSecret</span><span class="op" id="7961435">(</span><span class="ident" id="7961436">t</span>&nbsp;<span class="op" id="7961438">*</span><span class="ident" id="7961439">testing</span><span class="op" id="7961446">.</span><span class="ident" id="7961447">T</span><span class="op" id="7961448">)</span>&nbsp;<span class="op" id="7961450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7961453">for</span>&nbsp;<span class="ident" id="7961457">i</span><span class="op" id="7961458">,</span>&nbsp;<span class="ident" id="7961460">test</span>&nbsp;<span class="op" id="7961465">:=</span>&nbsp;<span class="keyword" id="7961468">range</span>&nbsp;<span class="ident" id="7961474">testKeysFromTests</span>&nbsp;<span class="op" id="7961492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7961496">in</span><span class="op" id="7961498">,</span>&nbsp;<span class="ident" id="7961500">_</span>&nbsp;<span class="op" id="7961502">:=</span>&nbsp;<span class="ident" id="7961505">hex</span><span class="op" id="7961508">.</span><span class="ident" id="7961509">DecodeString</span><span class="op" id="7961521">(</span><span class="ident" id="7961522">test</span><span class="op" id="7961526">.</span><span class="ident" id="7961527">preMasterSecret</span><span class="op" id="7961542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7961546">clientRandom</span><span class="op" id="7961558">,</span>&nbsp;<span class="ident" id="7961560">_</span>&nbsp;<span class="op" id="7961562">:=</span>&nbsp;<span class="ident" id="7961565">hex</span><span class="op" id="7961568">.</span><span class="ident" id="7961569">DecodeString</span><span class="op" id="7961581">(</span><span class="ident" id="7961582">test</span><span class="op" id="7961586">.</span><span class="ident" id="7961587">clientRandom</span><span class="op" id="7961599">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7961603">serverRandom</span><span class="op" id="7961615">,</span>&nbsp;<span class="ident" id="7961617">_</span>&nbsp;<span class="op" id="7961619">:=</span>&nbsp;<span class="ident" id="7961622">hex</span><span class="op" id="7961625">.</span><span class="ident" id="7961626">DecodeString</span><span class="op" id="7961638">(</span><span class="ident" id="7961639">test</span><span class="op" id="7961643">.</span><span class="ident" id="7961644">serverRandom</span><span class="op" id="7961656">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7961661">masterSecret</span>&nbsp;<span class="op" id="7961674">:=</span>&nbsp;<span class="ident" id="7961677">masterFromPreMasterSecret</span><span class="op" id="7961702">(</span><span class="ident" id="7961703">test</span><span class="op" id="7961707">.</span><span class="ident" id="7961708">version</span><span class="op" id="7961715">,</span>&nbsp;<span class="ident" id="7961717">in</span><span class="op" id="7961719">,</span>&nbsp;<span class="ident" id="7961721">clientRandom</span><span class="op" id="7961733">,</span>&nbsp;<span class="ident" id="7961735">serverRandom</span><span class="op" id="7961747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7961751">if</span>&nbsp;<span class="ident" id="7961754">s</span>&nbsp;<span class="op" id="7961756">:=</span>&nbsp;<span class="ident" id="7961759">hex</span><span class="op" id="7961762">.</span><span class="ident" id="7961763">EncodeToString</span><span class="op" id="7961777">(</span><span class="ident" id="7961778">masterSecret</span><span class="op" id="7961790">)</span><span class="op" id="7961791">;</span>&nbsp;<span class="ident" id="7961793">s</span>&nbsp;<span class="op" id="7961795">!=</span>&nbsp;<span class="ident" id="7961798">test</span><span class="op" id="7961802">.</span><span class="ident" id="7961803">masterSecret</span>&nbsp;<span class="op" id="7961816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7961821">t</span><span class="op" id="7961822">.</span><span class="ident" id="7961823">Errorf</span><span class="op" id="7961829">(</span><span class="string" id="7961830">&#34;#%d:&nbsp;bad&nbsp;master&nbsp;secret&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7961866">,</span>&nbsp;<span class="ident" id="7961868">i</span><span class="op" id="7961869">,</span>&nbsp;<span class="ident" id="7961871">s</span><span class="op" id="7961872">,</span>&nbsp;<span class="ident" id="7961874">test</span><span class="op" id="7961878">.</span><span class="ident" id="7961879">masterSecret</span><span class="op" id="7961891">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7961896">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7961907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7961912">clientMAC</span><span class="op" id="7961921">,</span>&nbsp;<span class="ident" id="7961923">serverMAC</span><span class="op" id="7961932">,</span>&nbsp;<span class="ident" id="7961934">clientKey</span><span class="op" id="7961943">,</span>&nbsp;<span class="ident" id="7961945">serverKey</span><span class="op" id="7961954">,</span>&nbsp;<span class="ident" id="7961956">_</span><span class="op" id="7961957">,</span>&nbsp;<span class="ident" id="7961959">_</span>&nbsp;<span class="op" id="7961961">:=</span>&nbsp;<span class="ident" id="7961964">keysFromMasterSecret</span><span class="op" id="7961984">(</span><span class="ident" id="7961985">test</span><span class="op" id="7961989">.</span><span class="ident" id="7961990">version</span><span class="op" id="7961997">,</span>&nbsp;<span class="ident" id="7961999">masterSecret</span><span class="op" id="7962011">,</span>&nbsp;<span class="ident" id="7962013">clientRandom</span><span class="op" id="7962025">,</span>&nbsp;<span class="ident" id="7962027">serverRandom</span><span class="op" id="7962039">,</span>&nbsp;<span class="ident" id="7962041">test</span><span class="op" id="7962045">.</span><span class="ident" id="7962046">macLen</span><span class="op" id="7962052">,</span>&nbsp;<span class="ident" id="7962054">test</span><span class="op" id="7962058">.</span><span class="ident" id="7962059">keyLen</span><span class="op" id="7962065">,</span>&nbsp;<span class="num" id="7962067">0</span><span class="op" id="7962068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7962072">clientMACString</span>&nbsp;<span class="op" id="7962088">:=</span>&nbsp;<span class="ident" id="7962091">hex</span><span class="op" id="7962094">.</span><span class="ident" id="7962095">EncodeToString</span><span class="op" id="7962109">(</span><span class="ident" id="7962110">clientMAC</span><span class="op" id="7962119">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7962123">serverMACString</span>&nbsp;<span class="op" id="7962139">:=</span>&nbsp;<span class="ident" id="7962142">hex</span><span class="op" id="7962145">.</span><span class="ident" id="7962146">EncodeToString</span><span class="op" id="7962160">(</span><span class="ident" id="7962161">serverMAC</span><span class="op" id="7962170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7962174">clientKeyString</span>&nbsp;<span class="op" id="7962190">:=</span>&nbsp;<span class="ident" id="7962193">hex</span><span class="op" id="7962196">.</span><span class="ident" id="7962197">EncodeToString</span><span class="op" id="7962211">(</span><span class="ident" id="7962212">clientKey</span><span class="op" id="7962221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7962225">serverKeyString</span>&nbsp;<span class="op" id="7962241">:=</span>&nbsp;<span class="ident" id="7962244">hex</span><span class="op" id="7962247">.</span><span class="ident" id="7962248">EncodeToString</span><span class="op" id="7962262">(</span><span class="ident" id="7962263">serverKey</span><span class="op" id="7962272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7962276">if</span>&nbsp;<span class="ident" id="7962279">clientMACString</span>&nbsp;<span class="op" id="7962295">!=</span>&nbsp;<span class="ident" id="7962298">test</span><span class="op" id="7962302">.</span><span class="ident" id="7962303">clientMAC</span>&nbsp;<span class="op" id="7962313">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7962319">serverMACString</span>&nbsp;<span class="op" id="7962335">!=</span>&nbsp;<span class="ident" id="7962338">test</span><span class="op" id="7962342">.</span><span class="ident" id="7962343">serverMAC</span>&nbsp;<span class="op" id="7962353">||</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7962359">clientKeyString</span>&nbsp;<span class="op" id="7962375">!=</span>&nbsp;<span class="ident" id="7962378">test</span><span class="op" id="7962382">.</span><span class="ident" id="7962383">clientKey</span>&nbsp;<span class="op" id="7962393">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7962399">serverKeyString</span>&nbsp;<span class="op" id="7962415">!=</span>&nbsp;<span class="ident" id="7962418">test</span><span class="op" id="7962422">.</span><span class="ident" id="7962423">serverKey</span>&nbsp;<span class="op" id="7962433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7962438">t</span><span class="op" id="7962439">.</span><span class="ident" id="7962440">Errorf</span><span class="op" id="7962446">(</span><span class="string" id="7962447">&#34;#%d:&nbsp;got:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&nbsp;want:&nbsp;(%s,&nbsp;%s,&nbsp;%s,&nbsp;%s)&#34;</span><span class="op" id="7962498">,</span>&nbsp;<span class="ident" id="7962500">i</span><span class="op" id="7962501">,</span>&nbsp;<span class="ident" id="7962503">clientMACString</span><span class="op" id="7962518">,</span>&nbsp;<span class="ident" id="7962520">serverMACString</span><span class="op" id="7962535">,</span>&nbsp;<span class="ident" id="7962537">clientKeyString</span><span class="op" id="7962552">,</span>&nbsp;<span class="ident" id="7962554">serverKeyString</span><span class="op" id="7962569">,</span>&nbsp;<span class="ident" id="7962571">test</span><span class="op" id="7962575">.</span><span class="ident" id="7962576">clientMAC</span><span class="op" id="7962585">,</span>&nbsp;<span class="ident" id="7962587">test</span><span class="op" id="7962591">.</span><span class="ident" id="7962592">serverMAC</span><span class="op" id="7962601">,</span>&nbsp;<span class="ident" id="7962603">test</span><span class="op" id="7962607">.</span><span class="ident" id="7962608">clientKey</span><span class="op" id="7962617">,</span>&nbsp;<span class="ident" id="7962619">test</span><span class="op" id="7962623">.</span><span class="ident" id="7962624">serverKey</span><span class="op" id="7962633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7962637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7962640">}</span><br>
<span class="lineno">70</span><span class="op" id="7962642">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7962645">//&nbsp;These&nbsp;test&nbsp;vectors&nbsp;were&nbsp;generated&nbsp;from&nbsp;GnuTLS&nbsp;using&nbsp;`gnutls-cli&nbsp;--insecure&nbsp;-d&nbsp;9&nbsp;`</span><br>
<span class="lineno"></span><span class="keyword" id="7962730">var</span>&nbsp;<span class="ident" id="7962734">testKeysFromTests</span>&nbsp;<span class="op" id="7962752">=</span>&nbsp;<span class="op" id="7962754">[</span><span class="op" id="7962755">]</span><span class="ident" id="7962756">testKeysFromTest</span><span class="op" id="7962772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7962775">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7962779">VersionTLS10</span><span class="op" id="7962791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7962795">&#34;0302cac83ad4b1db3b9ab49ad05957de2a504a634a386fc600889321e1a971f57479466830ac3e6f468e87f5385fa0c5&#34;</span><span class="op" id="7962893">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7962897">&#34;4ae66303755184a3917fcb44880605fcc53baa01912b22ed94473fc69cebd558&#34;</span><span class="op" id="7962963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7962967">&#34;4ae663020ec16e6bb5130be918cfcafd4d765979a3136a5d50c593446e4e44db&#34;</span><span class="op" id="7963033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7963037">&#34;3d851bab6e5556e959a16bc36d66cfae32f672bfa9ecdef6096cbb1b23472df1da63dbbd9827606413221d149ed08ceb&#34;</span><span class="op" id="7963135">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7963139">&#34;805aaa19b3d2c0a0759a4b6c9959890e08480119&#34;</span><span class="op" id="7963181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7963185">&#34;2d22f9fe519c075c16448305ceee209fc24ad109&#34;</span><span class="op" id="7963227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7963231">&#34;d50b5771244f850cd8117a9ccafe2cf1&#34;</span><span class="op" id="7963265">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7963269">&#34;e076e33206b30507a85c32855acd0919&#34;</span><span class="op" id="7963303">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7963307">20</span><span class="op" id="7963309">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7963313">16</span><span class="op" id="7963315">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7963318">}</span><span class="op" id="7963319">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7963322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7963326">VersionTLS10</span><span class="op" id="7963338">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7963342">&#34;03023f7527316bc12cbcd69e4b9e8275d62c028f27e65c745cfcddc7ce01bd3570a111378b63848127f1c36e5f9e4890&#34;</span><span class="op" id="7963440">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7963444">&#34;4ae66364b5ea56b20ce4e25555aed2d7e67f42788dd03f3fee4adae0459ab106&#34;</span><span class="op" id="7963510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7963514">&#34;4ae66363ab815cbf6a248b87d6b556184e945e9b97fbdf247858b0bdafacfa1c&#34;</span><span class="op" id="7963580">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7963584">&#34;7d64be7c80c59b740200b4b9c26d0baaa1c5ae56705acbcf2307fe62beb4728c19392c83f20483801cce022c77645460&#34;</span><span class="op" id="7963682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7963686">&#34;97742ed60a0554ca13f04f97ee193177b971e3b0&#34;</span><span class="op" id="7963728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7963732">&#34;37068751700400e03a8477a5c7eec0813ab9e0dc&#34;</span><span class="op" id="7963774">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7963778">&#34;207cddbc600d2a200abac6502053ee5c&#34;</span><span class="op" id="7963812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7963816">&#34;df3f94f6e1eacc753b815fe16055cd43&#34;</span><span class="op" id="7963850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7963854">20</span><span class="op" id="7963856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7963860">16</span><span class="op" id="7963862">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7963865">}</span><span class="op" id="7963866">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7963869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7963873">VersionTLS10</span><span class="op" id="7963885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7963889">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="7964147">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7964151">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="7964217">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7964221">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="7964287">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7964291">&#34;1aff2e7a2c4279d0126f57a65a77a8d9d0087cf2733366699bec27eb53d5740705a8574bb1acc2abbe90e44f0dd28d6c&#34;</span><span class="op" id="7964389">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7964393">&#34;3c7647c93c1379a31a609542aa44e7f117a70085&#34;</span><span class="op" id="7964435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7964439">&#34;0d73102994be74a575a3ead8532590ca32a526d4&#34;</span><span class="op" id="7964481">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7964485">&#34;ac7581b0b6c10d85bbd905ffbf36c65e&#34;</span><span class="op" id="7964519">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7964523">&#34;ff07edde49682b45466bd2e39464b306&#34;</span><span class="op" id="7964557">,</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7964561">20</span><span class="op" id="7964563">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7964567">16</span><span class="op" id="7964569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7964572">}</span><span class="op" id="7964573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7964576">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7964580">VersionSSL30</span><span class="op" id="7964592">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7964596">&#34;832d515f1d61eebb2be56ba0ef79879efb9b527504abb386fb4310ed5d0e3b1f220d3bb6b455033a2773e6d8bdf951d278a187482b400d45deb88a5d5a6bb7d6a7a1decc04eb9ef0642876cd4a82d374d3b6ff35f0351dc5d411104de431375355addc39bfb1f6329fb163b0bc298d658338930d07d313cd980a7e3d9196cac1&#34;</span><span class="op" id="7964854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7964858">&#34;4ae663b2ee389c0de147c509d8f18f5052afc4aaf9699efe8cb05ece883d3a5e&#34;</span><span class="op" id="7964924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7964928">&#34;4ae664d503fd4cff50cfc1fb8fc606580f87b0fcdac9554ba0e01d785bdf278e&#34;</span><span class="op" id="7964994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7964998">&#34;a614863e56299dcffeea2938f22c2ba023768dbe4b3f6877bc9c346c6ae529b51d9cb87ff9695ea4d01f2205584405b2&#34;</span><span class="op" id="7965096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7965100">&#34;2c450d5b6f6e2013ac6bea6a0b32200d4e1ffb94&#34;</span><span class="op" id="7965142">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7965146">&#34;7a7a7438769536f2fb1ae49a61f0703b79b2dc53&#34;</span><span class="op" id="7965188">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7965192">&#34;f8f6b26c10f12855c9aafb1e0e839ccf&#34;</span><span class="op" id="7965226">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7965230">&#34;2b9d4b4a60cb7f396780ebff50650419&#34;</span><span class="op" id="7965264">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7965268">20</span><span class="op" id="7965270">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="7965274">16</span><span class="op" id="7965276">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7965279">}</span><span class="op" id="7965280">,</span><br>
<span class="lineno"></span><span class="op" id="7965282">}</span>
</div>
</body>
</html>
