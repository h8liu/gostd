<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6224671">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6224726">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6224780">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6224831">package</span>&nbsp;<span class="ident" id="6224839">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6224846">import</span>&nbsp;<span class="string" id="6224853">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6224861">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="6224921">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="6224991">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="6225049">//</span><br>
<span class="lineno"></span><span class="comment" id="6225052">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="6225100">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="6225164">//</span><br>
<span class="lineno"></span><span class="comment" id="6225167">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="6225228">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6225298">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="6225373">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="6225440">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="6225513">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6225585">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="6225599">//</span><br>
<span class="lineno"></span><span class="comment" id="6225602">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="6225668">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="6225734">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="6225747">//</span><br>
<span class="lineno"></span><span class="comment" id="6225750">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="6225774">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6225804">//&nbsp;Complex&nbsp;power&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="6225830">//</span><br>
<span class="lineno"></span><span class="comment" id="6225833">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6225849">//</span><br>
<span class="lineno">35</span><span class="comment" id="6225852">//&nbsp;Raises&nbsp;complex&nbsp;A&nbsp;to&nbsp;the&nbsp;complex&nbsp;Zth&nbsp;power.</span><br>
<span class="lineno"></span><span class="comment" id="6225898">//&nbsp;Definition&nbsp;is&nbsp;per&nbsp;AMS55&nbsp;#&nbsp;4.2.8,</span><br>
<span class="lineno"></span><span class="comment" id="6225934">//&nbsp;analytically&nbsp;equivalent&nbsp;to&nbsp;cpow(a,z)&nbsp;=&nbsp;cexp(z&nbsp;clog(a)).</span><br>
<span class="lineno"></span><span class="comment" id="6225993">//</span><br>
<span class="lineno"></span><span class="comment" id="6225996">//&nbsp;ACCURACY:</span><br>
<span class="lineno">40</span><span class="comment" id="6226009">//</span><br>
<span class="lineno"></span><span class="comment" id="6226012">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6226052">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="6226110">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.4e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.5e-15</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="6226171">//&nbsp;Pow&nbsp;returns&nbsp;x**y,&nbsp;the&nbsp;base-x&nbsp;exponential&nbsp;of&nbsp;y.</span><br>
<span class="lineno"></span><span class="comment" id="6226221">//&nbsp;For&nbsp;generalized&nbsp;compatibility&nbsp;with&nbsp;math.Pow:</span><br>
<span class="lineno"></span><span class="comment" id="6226269">//&nbsp;&nbsp;&nbsp;&nbspPow(0,&nbsp;Â±0)&nbsp;returns&nbsp;1+0i</span><br>
<span class="lineno"></span><span class="comment" id="6226297">//&nbsp;&nbsp;&nbsp;&nbspPow(0,&nbsp;c)&nbsp;for&nbsp;real(c)&lt;0&nbsp;returns&nbsp;Inf+0i&nbsp;if&nbsp;imag(c)&nbsp;is&nbsp;zero,&nbsp;otherwise&nbsp;Inf+Inf&nbsp;i.</span><br>
<span class="lineno"></span><span class="keyword" id="6226380">func</span>&nbsp;<span class="ident" id="6226385">Pow</span><span class="op" id="6226388">(</span><span class="ident" id="6226389">x</span><span class="op" id="6226390">,</span>&nbsp;<span class="ident" id="6226392">y</span>&nbsp;<span class="builtintype" id="6226394">complex128</span><span class="op" id="6226404">)</span>&nbsp;<span class="builtintype" id="6226406">complex128</span>&nbsp;<span class="op" id="6226417">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226420">if</span>&nbsp;<span class="ident" id="6226423">x</span>&nbsp;<span class="op" id="6226425">==</span>&nbsp;<span class="num" id="6226428">0</span>&nbsp;<span class="op" id="6226430">{</span>&nbsp;<span class="comment" id="6226432">//&nbsp;Guaranteed&nbsp;also&nbsp;true&nbsp;for&nbsp;x&nbsp;==&nbsp;-0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226471">r</span><span class="op" id="6226472">,</span>&nbsp;<span class="ident" id="6226474">i</span>&nbsp;<span class="op" id="6226476">:=</span>&nbsp;<span class="builtinfunc" id="6226479">real</span><span class="op" id="6226483">(</span><span class="ident" id="6226484">y</span><span class="op" id="6226485">)</span><span class="op" id="6226486">,</span>&nbsp;<span class="builtinfunc" id="6226488">imag</span><span class="op" id="6226492">(</span><span class="ident" id="6226493">y</span><span class="op" id="6226494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226498">switch</span>&nbsp;<span class="op" id="6226505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226509">case</span>&nbsp;<span class="ident" id="6226514">r</span>&nbsp;<span class="op" id="6226516">==</span>&nbsp;<span class="num" id="6226519">0</span><span class="op" id="6226520">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226525">return</span>&nbsp;<span class="num" id="6226532">1</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226536">case</span>&nbsp;<span class="ident" id="6226541">r</span>&nbsp;<span class="op" id="6226543">&lt;</span>&nbsp;<span class="num" id="6226545">0</span><span class="op" id="6226546">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226551">if</span>&nbsp;<span class="ident" id="6226554">i</span>&nbsp;<span class="op" id="6226556">==</span>&nbsp;<span class="num" id="6226559">0</span>&nbsp;<span class="op" id="6226561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226567">return</span>&nbsp;<span class="builtinfunc" id="6226574">complex</span><span class="op" id="6226581">(</span><span class="ident" id="6226582">math</span><span class="op" id="6226586">.</span><span class="ident" id="6226587">Inf</span><span class="op" id="6226590">(</span><span class="num" id="6226591">1</span><span class="op" id="6226592">)</span><span class="op" id="6226593">,</span>&nbsp;<span class="num" id="6226595">0</span><span class="op" id="6226596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6226601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226606">return</span>&nbsp;<span class="ident" id="6226613">Inf</span><span class="op" id="6226616">(</span><span class="op" id="6226617">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226621">case</span>&nbsp;<span class="ident" id="6226626">r</span>&nbsp;<span class="op" id="6226628">&gt;</span>&nbsp;<span class="num" id="6226630">0</span><span class="op" id="6226631">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226636">return</span>&nbsp;<span class="num" id="6226643">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6226647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6226651">panic</span><span class="op" id="6226656">(</span><span class="string" id="6226657">&#34;not&nbsp;reached&#34;</span><span class="op" id="6226670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6226673">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226676">modulus</span>&nbsp;<span class="op" id="6226684">:=</span>&nbsp;<span class="ident" id="6226687">Abs</span><span class="op" id="6226690">(</span><span class="ident" id="6226691">x</span><span class="op" id="6226692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226695">if</span>&nbsp;<span class="ident" id="6226698">modulus</span>&nbsp;<span class="op" id="6226706">==</span>&nbsp;<span class="num" id="6226709">0</span>&nbsp;<span class="op" id="6226711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226715">return</span>&nbsp;<span class="builtinfunc" id="6226722">complex</span><span class="op" id="6226729">(</span><span class="num" id="6226730">0</span><span class="op" id="6226731">,</span>&nbsp;<span class="num" id="6226733">0</span><span class="op" id="6226734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6226737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226740">r</span>&nbsp;<span class="op" id="6226742">:=</span>&nbsp;<span class="ident" id="6226745">math</span><span class="op" id="6226749">.</span><span class="ident" id="6226750">Pow</span><span class="op" id="6226753">(</span><span class="ident" id="6226754">modulus</span><span class="op" id="6226761">,</span>&nbsp;<span class="builtinfunc" id="6226763">real</span><span class="op" id="6226767">(</span><span class="ident" id="6226768">y</span><span class="op" id="6226769">)</span><span class="op" id="6226770">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226773">arg</span>&nbsp;<span class="op" id="6226777">:=</span>&nbsp;<span class="ident" id="6226780">Phase</span><span class="op" id="6226785">(</span><span class="ident" id="6226786">x</span><span class="op" id="6226787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226790">theta</span>&nbsp;<span class="op" id="6226796">:=</span>&nbsp;<span class="builtinfunc" id="6226799">real</span><span class="op" id="6226803">(</span><span class="ident" id="6226804">y</span><span class="op" id="6226805">)</span>&nbsp;<span class="op" id="6226807">*</span>&nbsp;<span class="ident" id="6226809">arg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226814">if</span>&nbsp;<span class="builtinfunc" id="6226817">imag</span><span class="op" id="6226821">(</span><span class="ident" id="6226822">y</span><span class="op" id="6226823">)</span>&nbsp;<span class="op" id="6226825">!=</span>&nbsp;<span class="num" id="6226828">0</span>&nbsp;<span class="op" id="6226830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226834">r</span>&nbsp;<span class="op" id="6226836">*=</span>&nbsp;<span class="ident" id="6226839">math</span><span class="op" id="6226843">.</span><span class="ident" id="6226844">Exp</span><span class="op" id="6226847">(</span><span class="op" id="6226848">-</span><span class="builtinfunc" id="6226849">imag</span><span class="op" id="6226853">(</span><span class="ident" id="6226854">y</span><span class="op" id="6226855">)</span>&nbsp;<span class="op" id="6226857">*</span>&nbsp;<span class="ident" id="6226859">arg</span><span class="op" id="6226862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226866">theta</span>&nbsp;<span class="op" id="6226872">+=</span>&nbsp;<span class="builtinfunc" id="6226875">imag</span><span class="op" id="6226879">(</span><span class="ident" id="6226880">y</span><span class="op" id="6226881">)</span>&nbsp;<span class="op" id="6226883">*</span>&nbsp;<span class="ident" id="6226885">math</span><span class="op" id="6226889">.</span><span class="ident" id="6226890">Log</span><span class="op" id="6226893">(</span><span class="ident" id="6226894">modulus</span><span class="op" id="6226901">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6226904">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6226907">s</span><span class="op" id="6226908">,</span>&nbsp;<span class="ident" id="6226910">c</span>&nbsp;<span class="op" id="6226912">:=</span>&nbsp;<span class="ident" id="6226915">math</span><span class="op" id="6226919">.</span><span class="ident" id="6226920">Sincos</span><span class="op" id="6226926">(</span><span class="ident" id="6226927">theta</span><span class="op" id="6226932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6226935">return</span>&nbsp;<span class="builtinfunc" id="6226942">complex</span><span class="op" id="6226949">(</span><span class="ident" id="6226950">r</span><span class="op" id="6226951">*</span><span class="ident" id="6226952">c</span><span class="op" id="6226953">,</span>&nbsp;<span class="ident" id="6226955">r</span><span class="op" id="6226956">*</span><span class="ident" id="6226957">s</span><span class="op" id="6226958">)</span><br>
<span class="lineno"></span><span class="op" id="6226960">}</span>
</div>
</body>
</html>
