<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html" class="current">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3548713">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3548768">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3548822">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3548873">package</span>&nbsp;<span class="ident" id="3548881">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3548891">import</span>&nbsp;<span class="op" id="3548898">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3548901">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3548910">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3548917">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3548923">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3548934">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3548945">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3548953">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3548964">&#34;text/template/parse&#34;</span><br>
<span class="lineno"></span><span class="op" id="3548986">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3548989">//&nbsp;state&nbsp;represents&nbsp;the&nbsp;state&nbsp;of&nbsp;an&nbsp;execution.&nbsp;It&#39;s&nbsp;not&nbsp;part&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3549057">//&nbsp;template&nbsp;so&nbsp;that&nbsp;multiple&nbsp;executions&nbsp;of&nbsp;the&nbsp;same&nbsp;template</span><br>
<span class="lineno">20</span><span class="comment" id="3549118">//&nbsp;can&nbsp;execute&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="3549146">type</span>&nbsp;<span class="ident" id="3549151">state</span>&nbsp;<span class="keyword" id="3549157">struct</span>&nbsp;<span class="op" id="3549164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3549167">tmpl</span>&nbsp;<span class="op" id="3549172">*</span><span class="ident" id="3549173">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3549183">wr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3549188">io</span><span class="op" id="3549190">.</span><span class="ident" id="3549191">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3549199">node</span>&nbsp;<span class="ident" id="3549204">parse</span><span class="op" id="3549209">.</span><span class="ident" id="3549210">Node</span>&nbsp;<span class="comment" id="3549215">//&nbsp;current&nbsp;node,&nbsp;for&nbsp;errors</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3549244">vars</span>&nbsp;<span class="op" id="3549249">[</span><span class="op" id="3549250">]</span><span class="ident" id="3549251">variable</span>&nbsp;<span class="comment" id="3549260">//&nbsp;push-down&nbsp;stack&nbsp;of&nbsp;variable&nbsp;values.</span><br>
<span class="lineno"></span><span class="op" id="3549299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3549302">//&nbsp;variable&nbsp;holds&nbsp;the&nbsp;dynamic&nbsp;value&nbsp;of&nbsp;a&nbsp;variable&nbsp;such&nbsp;as&nbsp;$,&nbsp;$x&nbsp;etc.</span><br>
<span class="lineno"></span><span class="keyword" id="3549371">type</span>&nbsp;<span class="ident" id="3549376">variable</span>&nbsp;<span class="keyword" id="3549385">struct</span>&nbsp;<span class="op" id="3549392">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3549395">name</span>&nbsp;&nbsp;<span class="builtintype" id="3549401">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3549409">value</span>&nbsp;<span class="ident" id="3549415">reflect</span><span class="op" id="3549422">.</span><span class="ident" id="3549423">Value</span><br>
<span class="lineno"></span><span class="op" id="3549429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3549432">//&nbsp;push&nbsp;pushes&nbsp;a&nbsp;new&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.</span><br>
<span class="lineno">35</span><span class="keyword" id="3549476">func</span>&nbsp;<span class="op" id="3549481">(</span><span class="ident" id="3549482">s</span>&nbsp;<span class="op" id="3549484">*</span><span class="ident" id="3549485">state</span><span class="op" id="3549490">)</span>&nbsp;<span class="ident" id="3549492">push</span><span class="op" id="3549496">(</span><span class="ident" id="3549497">name</span>&nbsp;<span class="builtintype" id="3549502">string</span><span class="op" id="3549508">,</span>&nbsp;<span class="ident" id="3549510">value</span>&nbsp;<span class="ident" id="3549516">reflect</span><span class="op" id="3549523">.</span><span class="ident" id="3549524">Value</span><span class="op" id="3549529">)</span>&nbsp;<span class="op" id="3549531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3549534">s</span><span class="op" id="3549535">.</span><span class="ident" id="3549536">vars</span>&nbsp;<span class="op" id="3549541">=</span>&nbsp;<span class="builtinfunc" id="3549543">append</span><span class="op" id="3549549">(</span><span class="ident" id="3549550">s</span><span class="op" id="3549551">.</span><span class="ident" id="3549552">vars</span><span class="op" id="3549556">,</span>&nbsp;<span class="ident" id="3549558">variable</span><span class="op" id="3549566">{</span><span class="ident" id="3549567">name</span><span class="op" id="3549571">,</span>&nbsp;<span class="ident" id="3549573">value</span><span class="op" id="3549578">}</span><span class="op" id="3549579">)</span><br>
<span class="lineno"></span><span class="op" id="3549581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3549584">//&nbsp;mark&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;variable&nbsp;stack.</span><br>
<span class="lineno">40</span><span class="keyword" id="3549634">func</span>&nbsp;<span class="op" id="3549639">(</span><span class="ident" id="3549640">s</span>&nbsp;<span class="op" id="3549642">*</span><span class="ident" id="3549643">state</span><span class="op" id="3549648">)</span>&nbsp;<span class="ident" id="3549650">mark</span><span class="op" id="3549654">(</span><span class="op" id="3549655">)</span>&nbsp;<span class="builtintype" id="3549657">int</span>&nbsp;<span class="op" id="3549661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3549664">return</span>&nbsp;<span class="builtinfunc" id="3549671">len</span><span class="op" id="3549674">(</span><span class="ident" id="3549675">s</span><span class="op" id="3549676">.</span><span class="ident" id="3549677">vars</span><span class="op" id="3549681">)</span><br>
<span class="lineno"></span><span class="op" id="3549683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3549686">//&nbsp;pop&nbsp;pops&nbsp;the&nbsp;variable&nbsp;stack&nbsp;up&nbsp;to&nbsp;the&nbsp;mark.</span><br>
<span class="lineno">45</span><span class="keyword" id="3549733">func</span>&nbsp;<span class="op" id="3549738">(</span><span class="ident" id="3549739">s</span>&nbsp;<span class="op" id="3549741">*</span><span class="ident" id="3549742">state</span><span class="op" id="3549747">)</span>&nbsp;<span class="ident" id="3549749">pop</span><span class="op" id="3549752">(</span><span class="ident" id="3549753">mark</span>&nbsp;<span class="builtintype" id="3549758">int</span><span class="op" id="3549761">)</span>&nbsp;<span class="op" id="3549763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3549766">s</span><span class="op" id="3549767">.</span><span class="ident" id="3549768">vars</span>&nbsp;<span class="op" id="3549773">=</span>&nbsp;<span class="ident" id="3549775">s</span><span class="op" id="3549776">.</span><span class="ident" id="3549777">vars</span><span class="op" id="3549781">[</span><span class="num" id="3549782">0</span><span class="op" id="3549783">:</span><span class="ident" id="3549784">mark</span><span class="op" id="3549788">]</span><br>
<span class="lineno"></span><span class="op" id="3549790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3549793">//&nbsp;setVar&nbsp;overwrites&nbsp;the&nbsp;top-nth&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.&nbsp;Used&nbsp;by&nbsp;range&nbsp;iterations.</span><br>
<span class="lineno">50</span><span class="keyword" id="3549875">func</span>&nbsp;<span class="op" id="3549880">(</span><span class="ident" id="3549881">s</span>&nbsp;<span class="op" id="3549883">*</span><span class="ident" id="3549884">state</span><span class="op" id="3549889">)</span>&nbsp;<span class="ident" id="3549891">setVar</span><span class="op" id="3549897">(</span><span class="ident" id="3549898">n</span>&nbsp;<span class="builtintype" id="3549900">int</span><span class="op" id="3549903">,</span>&nbsp;<span class="ident" id="3549905">value</span>&nbsp;<span class="ident" id="3549911">reflect</span><span class="op" id="3549918">.</span><span class="ident" id="3549919">Value</span><span class="op" id="3549924">)</span>&nbsp;<span class="op" id="3549926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3549929">s</span><span class="op" id="3549930">.</span><span class="ident" id="3549931">vars</span><span class="op" id="3549935">[</span><span class="builtinfunc" id="3549936">len</span><span class="op" id="3549939">(</span><span class="ident" id="3549940">s</span><span class="op" id="3549941">.</span><span class="ident" id="3549942">vars</span><span class="op" id="3549946">)</span><span class="op" id="3549947">-</span><span class="ident" id="3549948">n</span><span class="op" id="3549949">]</span><span class="op" id="3549950">.</span><span class="ident" id="3549951">value</span>&nbsp;<span class="op" id="3549957">=</span>&nbsp;<span class="ident" id="3549959">value</span><br>
<span class="lineno"></span><span class="op" id="3549965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3549968">//&nbsp;varValue&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;named&nbsp;variable.</span><br>
<span class="lineno">55</span><span class="keyword" id="3550021">func</span>&nbsp;<span class="op" id="3550026">(</span><span class="ident" id="3550027">s</span>&nbsp;<span class="op" id="3550029">*</span><span class="ident" id="3550030">state</span><span class="op" id="3550035">)</span>&nbsp;<span class="ident" id="3550037">varValue</span><span class="op" id="3550045">(</span><span class="ident" id="3550046">name</span>&nbsp;<span class="builtintype" id="3550051">string</span><span class="op" id="3550057">)</span>&nbsp;<span class="ident" id="3550059">reflect</span><span class="op" id="3550066">.</span><span class="ident" id="3550067">Value</span>&nbsp;<span class="op" id="3550073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550076">for</span>&nbsp;<span class="ident" id="3550080">i</span>&nbsp;<span class="op" id="3550082">:=</span>&nbsp;<span class="ident" id="3550085">s</span><span class="op" id="3550086">.</span><span class="ident" id="3550087">mark</span><span class="op" id="3550091">(</span><span class="op" id="3550092">)</span>&nbsp;<span class="op" id="3550094">-</span>&nbsp;<span class="num" id="3550096">1</span><span class="op" id="3550097">;</span>&nbsp;<span class="ident" id="3550099">i</span>&nbsp;<span class="op" id="3550101">&gt;=</span>&nbsp;<span class="num" id="3550104">0</span><span class="op" id="3550105">;</span>&nbsp;<span class="ident" id="3550107">i</span><span class="op" id="3550108">--</span>&nbsp;<span class="op" id="3550111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550115">if</span>&nbsp;<span class="ident" id="3550118">s</span><span class="op" id="3550119">.</span><span class="ident" id="3550120">vars</span><span class="op" id="3550124">[</span><span class="ident" id="3550125">i</span><span class="op" id="3550126">]</span><span class="op" id="3550127">.</span><span class="ident" id="3550128">name</span>&nbsp;<span class="op" id="3550133">==</span>&nbsp;<span class="ident" id="3550136">name</span>&nbsp;<span class="op" id="3550141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550146">return</span>&nbsp;<span class="ident" id="3550153">s</span><span class="op" id="3550154">.</span><span class="ident" id="3550155">vars</span><span class="op" id="3550159">[</span><span class="ident" id="3550160">i</span><span class="op" id="3550161">]</span><span class="op" id="3550162">.</span><span class="ident" id="3550163">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3550171">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3550174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3550177">s</span><span class="op" id="3550178">.</span><span class="ident" id="3550179">errorf</span><span class="op" id="3550185">(</span><span class="string" id="3550186">&#34;undefined&nbsp;variable:&nbsp;%s&#34;</span><span class="op" id="3550210">,</span>&nbsp;<span class="ident" id="3550212">name</span><span class="op" id="3550216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550219">return</span>&nbsp;<span class="ident" id="3550226">zero</span><br>
<span class="lineno"></span><span class="op" id="3550231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="3550234">var</span>&nbsp;<span class="ident" id="3550238">zero</span>&nbsp;<span class="ident" id="3550243">reflect</span><span class="op" id="3550250">.</span><span class="ident" id="3550251">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3550258">//&nbsp;at&nbsp;marks&nbsp;the&nbsp;state&nbsp;to&nbsp;be&nbsp;on&nbsp;node&nbsp;n,&nbsp;for&nbsp;error&nbsp;reporting.</span><br>
<span class="lineno"></span><span class="keyword" id="3550318">func</span>&nbsp;<span class="op" id="3550323">(</span><span class="ident" id="3550324">s</span>&nbsp;<span class="op" id="3550326">*</span><span class="ident" id="3550327">state</span><span class="op" id="3550332">)</span>&nbsp;<span class="ident" id="3550334">at</span><span class="op" id="3550336">(</span><span class="ident" id="3550337">node</span>&nbsp;<span class="ident" id="3550342">parse</span><span class="op" id="3550347">.</span><span class="ident" id="3550348">Node</span><span class="op" id="3550352">)</span>&nbsp;<span class="op" id="3550354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3550357">s</span><span class="op" id="3550358">.</span><span class="ident" id="3550359">node</span>&nbsp;<span class="op" id="3550364">=</span>&nbsp;<span class="ident" id="3550366">node</span><br>
<span class="lineno">70</span><span class="op" id="3550371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3550374">//&nbsp;doublePercent&nbsp;returns&nbsp;the&nbsp;string&nbsp;with&nbsp;%&#39;s&nbsp;replaced&nbsp;by&nbsp;%%,&nbsp;if&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="3550449">//&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;used&nbsp;safely&nbsp;inside&nbsp;a&nbsp;Printf&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3550508">func</span>&nbsp;<span class="ident" id="3550513">doublePercent</span><span class="op" id="3550526">(</span><span class="ident" id="3550527">str</span>&nbsp;<span class="builtintype" id="3550531">string</span><span class="op" id="3550537">)</span>&nbsp;<span class="builtintype" id="3550539">string</span>&nbsp;<span class="op" id="3550546">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550549">if</span>&nbsp;<span class="ident" id="3550552">strings</span><span class="op" id="3550559">.</span><span class="ident" id="3550560">Contains</span><span class="op" id="3550568">(</span><span class="ident" id="3550569">str</span><span class="op" id="3550572">,</span>&nbsp;<span class="string" id="3550574">&#34;%&#34;</span><span class="op" id="3550577">)</span>&nbsp;<span class="op" id="3550579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3550583">str</span>&nbsp;<span class="op" id="3550587">=</span>&nbsp;<span class="ident" id="3550589">strings</span><span class="op" id="3550596">.</span><span class="ident" id="3550597">Replace</span><span class="op" id="3550604">(</span><span class="ident" id="3550605">str</span><span class="op" id="3550608">,</span>&nbsp;<span class="string" id="3550610">&#34;%&#34;</span><span class="op" id="3550613">,</span>&nbsp;<span class="string" id="3550615">&#34;%%&#34;</span><span class="op" id="3550619">,</span>&nbsp;<span class="op" id="3550621">-</span><span class="num" id="3550622">1</span><span class="op" id="3550623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3550626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550629">return</span>&nbsp;<span class="ident" id="3550636">str</span><br>
<span class="lineno"></span><span class="op" id="3550640">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="3550643">//&nbsp;errorf&nbsp;formats&nbsp;the&nbsp;error&nbsp;and&nbsp;terminates&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="3550698">func</span>&nbsp;<span class="op" id="3550703">(</span><span class="ident" id="3550704">s</span>&nbsp;<span class="op" id="3550706">*</span><span class="ident" id="3550707">state</span><span class="op" id="3550712">)</span>&nbsp;<span class="ident" id="3550714">errorf</span><span class="op" id="3550720">(</span><span class="ident" id="3550721">format</span>&nbsp;<span class="builtintype" id="3550728">string</span><span class="op" id="3550734">,</span>&nbsp;<span class="ident" id="3550736">args</span>&nbsp;<span class="op" id="3550741">...</span><span class="keyword" id="3550744">interface</span><span class="op" id="3550753">{</span><span class="op" id="3550754">}</span><span class="op" id="3550755">)</span>&nbsp;<span class="op" id="3550757">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3550760">name</span>&nbsp;<span class="op" id="3550765">:=</span>&nbsp;<span class="ident" id="3550768">doublePercent</span><span class="op" id="3550781">(</span><span class="ident" id="3550782">s</span><span class="op" id="3550783">.</span><span class="ident" id="3550784">tmpl</span><span class="op" id="3550788">.</span><span class="ident" id="3550789">Name</span><span class="op" id="3550793">(</span><span class="op" id="3550794">)</span><span class="op" id="3550795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3550798">if</span>&nbsp;<span class="ident" id="3550801">s</span><span class="op" id="3550802">.</span><span class="ident" id="3550803">node</span>&nbsp;<span class="op" id="3550808">==</span>&nbsp;<span class="builtintype" id="3550811">nil</span>&nbsp;<span class="op" id="3550815">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3550819">format</span>&nbsp;<span class="op" id="3550826">=</span>&nbsp;<span class="ident" id="3550828">fmt</span><span class="op" id="3550831">.</span><span class="ident" id="3550832">Sprintf</span><span class="op" id="3550839">(</span><span class="string" id="3550840">&#34;template:&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="3550858">,</span>&nbsp;<span class="ident" id="3550860">name</span><span class="op" id="3550864">,</span>&nbsp;<span class="ident" id="3550866">format</span><span class="op" id="3550872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3550875">}</span>&nbsp;<span class="keyword" id="3550877">else</span>&nbsp;<span class="op" id="3550882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3550886">location</span><span class="op" id="3550894">,</span>&nbsp;<span class="ident" id="3550896">context</span>&nbsp;<span class="op" id="3550904">:=</span>&nbsp;<span class="ident" id="3550907">s</span><span class="op" id="3550908">.</span><span class="ident" id="3550909">tmpl</span><span class="op" id="3550913">.</span><span class="ident" id="3550914">ErrorContext</span><span class="op" id="3550926">(</span><span class="ident" id="3550927">s</span><span class="op" id="3550928">.</span><span class="ident" id="3550929">node</span><span class="op" id="3550933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3550937">format</span>&nbsp;<span class="op" id="3550944">=</span>&nbsp;<span class="ident" id="3550946">fmt</span><span class="op" id="3550949">.</span><span class="ident" id="3550950">Sprintf</span><span class="op" id="3550957">(</span><span class="string" id="3550958">&#34;template:&nbsp;%s:&nbsp;executing&nbsp;%q&nbsp;at&nbsp;&lt;%s&gt;:&nbsp;%s&#34;</span><span class="op" id="3550998">,</span>&nbsp;<span class="ident" id="3551000">location</span><span class="op" id="3551008">,</span>&nbsp;<span class="ident" id="3551010">name</span><span class="op" id="3551014">,</span>&nbsp;<span class="ident" id="3551016">doublePercent</span><span class="op" id="3551029">(</span><span class="ident" id="3551030">context</span><span class="op" id="3551037">)</span><span class="op" id="3551038">,</span>&nbsp;<span class="ident" id="3551040">format</span><span class="op" id="3551046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3551049">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3551052">panic</span><span class="op" id="3551057">(</span><span class="ident" id="3551058">fmt</span><span class="op" id="3551061">.</span><span class="ident" id="3551062">Errorf</span><span class="op" id="3551068">(</span><span class="ident" id="3551069">format</span><span class="op" id="3551075">,</span>&nbsp;<span class="ident" id="3551077">args</span><span class="op" id="3551081">...</span><span class="op" id="3551084">)</span><span class="op" id="3551085">)</span><br>
<span class="lineno"></span><span class="op" id="3551087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3551090">//&nbsp;errRecover&nbsp;is&nbsp;the&nbsp;handler&nbsp;that&nbsp;turns&nbsp;panics&nbsp;into&nbsp;returns&nbsp;from&nbsp;the&nbsp;top</span><br>
<span class="lineno"></span><span class="comment" id="3551163">//&nbsp;level&nbsp;of&nbsp;Parse.</span><br>
<span class="lineno">95</span><span class="keyword" id="3551182">func</span>&nbsp;<span class="ident" id="3551187">errRecover</span><span class="op" id="3551197">(</span><span class="ident" id="3551198">errp</span>&nbsp;<span class="op" id="3551203">*</span><span class="builtintype" id="3551204">error</span><span class="op" id="3551209">)</span>&nbsp;<span class="op" id="3551211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3551214">e</span>&nbsp;<span class="op" id="3551216">:=</span>&nbsp;<span class="builtinfunc" id="3551219">recover</span><span class="op" id="3551226">(</span><span class="op" id="3551227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3551230">if</span>&nbsp;<span class="ident" id="3551233">e</span>&nbsp;<span class="op" id="3551235">!=</span>&nbsp;<span class="builtintype" id="3551238">nil</span>&nbsp;<span class="op" id="3551242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3551246">switch</span>&nbsp;<span class="ident" id="3551253">err</span>&nbsp;<span class="op" id="3551257">:=</span>&nbsp;<span class="ident" id="3551260">e</span><span class="op" id="3551261">.</span><span class="op" id="3551262">(</span><span class="keyword" id="3551263">type</span><span class="op" id="3551267">)</span>&nbsp;<span class="op" id="3551269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3551273">case</span>&nbsp;<span class="ident" id="3551278">runtime</span><span class="op" id="3551285">.</span><span class="ident" id="3551286">Error</span><span class="op" id="3551291">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3551296">panic</span><span class="op" id="3551301">(</span><span class="ident" id="3551302">e</span><span class="op" id="3551303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3551307">case</span>&nbsp;<span class="builtintype" id="3551312">error</span><span class="op" id="3551317">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3551322">*</span><span class="ident" id="3551323">errp</span>&nbsp;<span class="op" id="3551328">=</span>&nbsp;<span class="ident" id="3551330">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3551336">default</span><span class="op" id="3551343">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3551348">panic</span><span class="op" id="3551353">(</span><span class="ident" id="3551354">e</span><span class="op" id="3551355">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3551359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3551362">}</span><br>
<span class="lineno"></span><span class="op" id="3551364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3551367">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">110</span><span class="comment" id="3551449">//&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="3551510">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="3551578">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3551651">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="3551673">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno">115</span><span class="keyword" id="3551723">func</span>&nbsp;<span class="op" id="3551728">(</span><span class="ident" id="3551729">t</span>&nbsp;<span class="op" id="3551731">*</span><span class="ident" id="3551732">Template</span><span class="op" id="3551740">)</span>&nbsp;<span class="ident" id="3551742">ExecuteTemplate</span><span class="op" id="3551757">(</span><span class="ident" id="3551758">wr</span>&nbsp;<span class="ident" id="3551761">io</span><span class="op" id="3551763">.</span><span class="ident" id="3551764">Writer</span><span class="op" id="3551770">,</span>&nbsp;<span class="ident" id="3551772">name</span>&nbsp;<span class="builtintype" id="3551777">string</span><span class="op" id="3551783">,</span>&nbsp;<span class="ident" id="3551785">data</span>&nbsp;<span class="keyword" id="3551790">interface</span><span class="op" id="3551799">{</span><span class="op" id="3551800">}</span><span class="op" id="3551801">)</span>&nbsp;<span class="builtintype" id="3551803">error</span>&nbsp;<span class="op" id="3551809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3551812">tmpl</span>&nbsp;<span class="op" id="3551817">:=</span>&nbsp;<span class="ident" id="3551820">t</span><span class="op" id="3551821">.</span><span class="ident" id="3551822">tmpl</span><span class="op" id="3551826">[</span><span class="ident" id="3551827">name</span><span class="op" id="3551831">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3551834">if</span>&nbsp;<span class="ident" id="3551837">tmpl</span>&nbsp;<span class="op" id="3551842">==</span>&nbsp;<span class="builtintype" id="3551845">nil</span>&nbsp;<span class="op" id="3551849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3551853">return</span>&nbsp;<span class="ident" id="3551860">fmt</span><span class="op" id="3551863">.</span><span class="ident" id="3551864">Errorf</span><span class="op" id="3551870">(</span><span class="string" id="3551871">&#34;template:&nbsp;no&nbsp;template&nbsp;%q&nbsp;associated&nbsp;with&nbsp;template&nbsp;%q&#34;</span><span class="op" id="3551925">,</span>&nbsp;<span class="ident" id="3551927">name</span><span class="op" id="3551931">,</span>&nbsp;<span class="ident" id="3551933">t</span><span class="op" id="3551934">.</span><span class="ident" id="3551935">name</span><span class="op" id="3551939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3551942">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3551945">return</span>&nbsp;<span class="ident" id="3551952">tmpl</span><span class="op" id="3551956">.</span><span class="ident" id="3551957">Execute</span><span class="op" id="3551964">(</span><span class="ident" id="3551965">wr</span><span class="op" id="3551967">,</span>&nbsp;<span class="ident" id="3551969">data</span><span class="op" id="3551973">)</span><br>
<span class="lineno"></span><span class="op" id="3551975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3551978">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="3552045">//&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">125</span><span class="comment" id="3552077">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="3552145">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3552218">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="3552240">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="3552290">func</span>&nbsp;<span class="op" id="3552295">(</span><span class="ident" id="3552296">t</span>&nbsp;<span class="op" id="3552298">*</span><span class="ident" id="3552299">Template</span><span class="op" id="3552307">)</span>&nbsp;<span class="ident" id="3552309">Execute</span><span class="op" id="3552316">(</span><span class="ident" id="3552317">wr</span>&nbsp;<span class="ident" id="3552320">io</span><span class="op" id="3552322">.</span><span class="ident" id="3552323">Writer</span><span class="op" id="3552329">,</span>&nbsp;<span class="ident" id="3552331">data</span>&nbsp;<span class="keyword" id="3552336">interface</span><span class="op" id="3552345">{</span><span class="op" id="3552346">}</span><span class="op" id="3552347">)</span>&nbsp;<span class="op" id="3552349">(</span><span class="ident" id="3552350">err</span>&nbsp;<span class="builtintype" id="3552354">error</span><span class="op" id="3552359">)</span>&nbsp;<span class="op" id="3552361">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552364">defer</span>&nbsp;<span class="ident" id="3552370">errRecover</span><span class="op" id="3552380">(</span><span class="op" id="3552381">&amp;</span><span class="ident" id="3552382">err</span><span class="op" id="3552385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552388">value</span>&nbsp;<span class="op" id="3552394">:=</span>&nbsp;<span class="ident" id="3552397">reflect</span><span class="op" id="3552404">.</span><span class="ident" id="3552405">ValueOf</span><span class="op" id="3552412">(</span><span class="ident" id="3552413">data</span><span class="op" id="3552417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552420">state</span>&nbsp;<span class="op" id="3552426">:=</span>&nbsp;<span class="op" id="3552429">&amp;</span><span class="ident" id="3552430">state</span><span class="op" id="3552435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552439">tmpl</span><span class="op" id="3552443">:</span>&nbsp;<span class="ident" id="3552445">t</span><span class="op" id="3552446">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552450">wr</span><span class="op" id="3552452">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3552456">wr</span><span class="op" id="3552458">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552462">vars</span><span class="op" id="3552466">:</span>&nbsp;<span class="op" id="3552468">[</span><span class="op" id="3552469">]</span><span class="ident" id="3552470">variable</span><span class="op" id="3552478">{</span><span class="op" id="3552479">{</span><span class="string" id="3552480">&#34;$&#34;</span><span class="op" id="3552483">,</span>&nbsp;<span class="ident" id="3552485">value</span><span class="op" id="3552490">}</span><span class="op" id="3552491">}</span><span class="op" id="3552492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3552495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552498">t</span><span class="op" id="3552499">.</span><span class="ident" id="3552500">init</span><span class="op" id="3552504">(</span><span class="op" id="3552505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552508">if</span>&nbsp;<span class="ident" id="3552511">t</span><span class="op" id="3552512">.</span><span class="ident" id="3552513">Tree</span>&nbsp;<span class="op" id="3552518">==</span>&nbsp;<span class="builtintype" id="3552521">nil</span>&nbsp;<span class="op" id="3552525">||</span>&nbsp;<span class="ident" id="3552528">t</span><span class="op" id="3552529">.</span><span class="ident" id="3552530">Root</span>&nbsp;<span class="op" id="3552535">==</span>&nbsp;<span class="builtintype" id="3552538">nil</span>&nbsp;<span class="op" id="3552542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552546">var</span>&nbsp;<span class="ident" id="3552550">b</span>&nbsp;<span class="ident" id="3552552">bytes</span><span class="op" id="3552557">.</span><span class="ident" id="3552558">Buffer</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552567">for</span>&nbsp;<span class="ident" id="3552571">name</span><span class="op" id="3552575">,</span>&nbsp;<span class="ident" id="3552577">tmpl</span>&nbsp;<span class="op" id="3552582">:=</span>&nbsp;<span class="keyword" id="3552585">range</span>&nbsp;<span class="ident" id="3552591">t</span><span class="op" id="3552592">.</span><span class="ident" id="3552593">tmpl</span>&nbsp;<span class="op" id="3552598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552603">if</span>&nbsp;<span class="ident" id="3552606">tmpl</span><span class="op" id="3552610">.</span><span class="ident" id="3552611">Tree</span>&nbsp;<span class="op" id="3552616">==</span>&nbsp;<span class="builtintype" id="3552619">nil</span>&nbsp;<span class="op" id="3552623">||</span>&nbsp;<span class="ident" id="3552626">tmpl</span><span class="op" id="3552630">.</span><span class="ident" id="3552631">Root</span>&nbsp;<span class="op" id="3552636">==</span>&nbsp;<span class="builtintype" id="3552639">nil</span>&nbsp;<span class="op" id="3552643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552649">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3552661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552666">if</span>&nbsp;<span class="ident" id="3552669">b</span><span class="op" id="3552670">.</span><span class="ident" id="3552671">Len</span><span class="op" id="3552674">(</span><span class="op" id="3552675">)</span>&nbsp;<span class="op" id="3552677">&gt;</span>&nbsp;<span class="num" id="3552679">0</span>&nbsp;<span class="op" id="3552681">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552687">b</span><span class="op" id="3552688">.</span><span class="ident" id="3552689">WriteString</span><span class="op" id="3552700">(</span><span class="string" id="3552701">&#34;,&nbsp;&#34;</span><span class="op" id="3552705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3552710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552715">fmt</span><span class="op" id="3552718">.</span><span class="ident" id="3552719">Fprintf</span><span class="op" id="3552726">(</span><span class="op" id="3552727">&amp;</span><span class="ident" id="3552728">b</span><span class="op" id="3552729">,</span>&nbsp;<span class="string" id="3552731">&#34;%q&#34;</span><span class="op" id="3552735">,</span>&nbsp;<span class="ident" id="3552737">name</span><span class="op" id="3552741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3552745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552749">var</span>&nbsp;<span class="ident" id="3552753">s</span>&nbsp;<span class="builtintype" id="3552755">string</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552764">if</span>&nbsp;<span class="ident" id="3552767">b</span><span class="op" id="3552768">.</span><span class="ident" id="3552769">Len</span><span class="op" id="3552772">(</span><span class="op" id="3552773">)</span>&nbsp;<span class="op" id="3552775">&gt;</span>&nbsp;<span class="num" id="3552777">0</span>&nbsp;<span class="op" id="3552779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552784">s</span>&nbsp;<span class="op" id="3552786">=</span>&nbsp;<span class="string" id="3552788">&#34;;&nbsp;defined&nbsp;templates&nbsp;are:&nbsp;&#34;</span>&nbsp;<span class="op" id="3552816">+</span>&nbsp;<span class="ident" id="3552818">b</span><span class="op" id="3552819">.</span><span class="ident" id="3552820">String</span><span class="op" id="3552826">(</span><span class="op" id="3552827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3552831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552835">state</span><span class="op" id="3552840">.</span><span class="ident" id="3552841">errorf</span><span class="op" id="3552847">(</span><span class="string" id="3552848">&#34;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;or&nbsp;empty&nbsp;template%s&#34;</span><span class="op" id="3552889">,</span>&nbsp;<span class="ident" id="3552891">t</span><span class="op" id="3552892">.</span><span class="ident" id="3552893">Name</span><span class="op" id="3552897">(</span><span class="op" id="3552898">)</span><span class="op" id="3552899">,</span>&nbsp;<span class="ident" id="3552901">s</span><span class="op" id="3552902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3552905">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3552908">state</span><span class="op" id="3552913">.</span><span class="ident" id="3552914">walk</span><span class="op" id="3552918">(</span><span class="ident" id="3552919">value</span><span class="op" id="3552924">,</span>&nbsp;<span class="ident" id="3552926">t</span><span class="op" id="3552927">.</span><span class="ident" id="3552928">Root</span><span class="op" id="3552932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3552935">return</span><br>
<span class="lineno"></span><span class="op" id="3552942">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3552945">//&nbsp;Walk&nbsp;functions&nbsp;step&nbsp;through&nbsp;the&nbsp;major&nbsp;pieces&nbsp;of&nbsp;the&nbsp;template&nbsp;structure,</span><br>
<span class="lineno">160</span><span class="comment" id="3553020">//&nbsp;generating&nbsp;output&nbsp;as&nbsp;they&nbsp;go.</span><br>
<span class="lineno"></span><span class="keyword" id="3553053">func</span>&nbsp;<span class="op" id="3553058">(</span><span class="ident" id="3553059">s</span>&nbsp;<span class="op" id="3553061">*</span><span class="ident" id="3553062">state</span><span class="op" id="3553067">)</span>&nbsp;<span class="ident" id="3553069">walk</span><span class="op" id="3553073">(</span><span class="ident" id="3553074">dot</span>&nbsp;<span class="ident" id="3553078">reflect</span><span class="op" id="3553085">.</span><span class="ident" id="3553086">Value</span><span class="op" id="3553091">,</span>&nbsp;<span class="ident" id="3553093">node</span>&nbsp;<span class="ident" id="3553098">parse</span><span class="op" id="3553103">.</span><span class="ident" id="3553104">Node</span><span class="op" id="3553108">)</span>&nbsp;<span class="op" id="3553110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3553113">s</span><span class="op" id="3553114">.</span><span class="ident" id="3553115">at</span><span class="op" id="3553117">(</span><span class="ident" id="3553118">node</span><span class="op" id="3553122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3553125">switch</span>&nbsp;<span class="ident" id="3553132">node</span>&nbsp;<span class="op" id="3553137">:=</span>&nbsp;<span class="ident" id="3553140">node</span><span class="op" id="3553144">.</span><span class="op" id="3553145">(</span><span class="keyword" id="3553146">type</span><span class="op" id="3553150">)</span>&nbsp;<span class="op" id="3553152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3553155">case</span>&nbsp;<span class="op" id="3553160">*</span><span class="ident" id="3553161">parse</span><span class="op" id="3553166">.</span><span class="ident" id="3553167">ActionNode</span><span class="op" id="3553177">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3553181">//&nbsp;Do&nbsp;not&nbsp;pop&nbsp;variables&nbsp;so&nbsp;they&nbsp;persist&nbsp;until&nbsp;next&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3553239">//&nbsp;Also,&nbsp;if&nbsp;the&nbsp;action&nbsp;declares&nbsp;variables,&nbsp;don&#39;t&nbsp;print&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3553308">val</span>&nbsp;<span class="op" id="3553312">:=</span>&nbsp;<span class="ident" id="3553315">s</span><span class="op" id="3553316">.</span><span class="ident" id="3553317">evalPipeline</span><span class="op" id="3553329">(</span><span class="ident" id="3553330">dot</span><span class="op" id="3553333">,</span>&nbsp;<span class="ident" id="3553335">node</span><span class="op" id="3553339">.</span><span class="ident" id="3553340">Pipe</span><span class="op" id="3553344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3553348">if</span>&nbsp;<span class="builtinfunc" id="3553351">len</span><span class="op" id="3553354">(</span><span class="ident" id="3553355">node</span><span class="op" id="3553359">.</span><span class="ident" id="3553360">Pipe</span><span class="op" id="3553364">.</span><span class="ident" id="3553365">Decl</span><span class="op" id="3553369">)</span>&nbsp;<span class="op" id="3553371">==</span>&nbsp;<span class="num" id="3553374">0</span>&nbsp;<span class="op" id="3553376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3553381">s</span><span class="op" id="3553382">.</span><span class="ident" id="3553383">printValue</span><span class="op" id="3553393">(</span><span class="ident" id="3553394">node</span><span class="op" id="3553398">,</span>&nbsp;<span class="ident" id="3553400">val</span><span class="op" id="3553403">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3553407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3553410">case</span>&nbsp;<span class="op" id="3553415">*</span><span class="ident" id="3553416">parse</span><span class="op" id="3553421">.</span><span class="ident" id="3553422">IfNode</span><span class="op" id="3553428">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3553432">s</span><span class="op" id="3553433">.</span><span class="ident" id="3553434">walkIfOrWith</span><span class="op" id="3553446">(</span><span class="ident" id="3553447">parse</span><span class="op" id="3553452">.</span><span class="ident" id="3553453">NodeIf</span><span class="op" id="3553459">,</span>&nbsp;<span class="ident" id="3553461">dot</span><span class="op" id="3553464">,</span>&nbsp;<span class="ident" id="3553466">node</span><span class="op" id="3553470">.</span><span class="ident" id="3553471">Pipe</span><span class="op" id="3553475">,</span>&nbsp;<span class="ident" id="3553477">node</span><span class="op" id="3553481">.</span><span class="ident" id="3553482">List</span><span class="op" id="3553486">,</span>&nbsp;<span class="ident" id="3553488">node</span><span class="op" id="3553492">.</span><span class="ident" id="3553493">ElseList</span><span class="op" id="3553501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3553504">case</span>&nbsp;<span class="op" id="3553509">*</span><span class="ident" id="3553510">parse</span><span class="op" id="3553515">.</span><span class="ident" id="3553516">ListNode</span><span class="op" id="3553524">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3553528">for</span>&nbsp;<span class="ident" id="3553532">_</span><span class="op" id="3553533">,</span>&nbsp;<span class="ident" id="3553535">node</span>&nbsp;<span class="op" id="3553540">:=</span>&nbsp;<span class="keyword" id="3553543">range</span>&nbsp;<span class="ident" id="3553549">node</span><span class="op" id="3553553">.</span><span class="ident" id="3553554">Nodes</span>&nbsp;<span class="op" id="3553560">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3553565">s</span><span class="op" id="3553566">.</span><span class="ident" id="3553567">walk</span><span class="op" id="3553571">(</span><span class="ident" id="3553572">dot</span><span class="op" id="3553575">,</span>&nbsp;<span class="ident" id="3553577">node</span><span class="op" id="3553581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3553585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3553588">case</span>&nbsp;<span class="op" id="3553593">*</span><span class="ident" id="3553594">parse</span><span class="op" id="3553599">.</span><span class="ident" id="3553600">RangeNode</span><span class="op" id="3553609">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3553613">s</span><span class="op" id="3553614">.</span><span class="ident" id="3553615">walkRange</span><span class="op" id="3553624">(</span><span class="ident" id="3553625">dot</span><span class="op" id="3553628">,</span>&nbsp;<span class="ident" id="3553630">node</span><span class="op" id="3553634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3553637">case</span>&nbsp;<span class="op" id="3553642">*</span><span class="ident" id="3553643">parse</span><span class="op" id="3553648">.</span><span class="ident" id="3553649">TemplateNode</span><span class="op" id="3553661">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3553665">s</span><span class="op" id="3553666">.</span><span class="ident" id="3553667">walkTemplate</span><span class="op" id="3553679">(</span><span class="ident" id="3553680">dot</span><span class="op" id="3553683">,</span>&nbsp;<span class="ident" id="3553685">node</span><span class="op" id="3553689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3553692">case</span>&nbsp;<span class="op" id="3553697">*</span><span class="ident" id="3553698">parse</span><span class="op" id="3553703">.</span><span class="ident" id="3553704">TextNode</span><span class="op" id="3553712">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3553716">if</span>&nbsp;<span class="ident" id="3553719">_</span><span class="op" id="3553720">,</span>&nbsp;<span class="ident" id="3553722">err</span>&nbsp;<span class="op" id="3553726">:=</span>&nbsp;<span class="ident" id="3553729">s</span><span class="op" id="3553730">.</span><span class="ident" id="3553731">wr</span><span class="op" id="3553733">.</span><span class="ident" id="3553734">Write</span><span class="op" id="3553739">(</span><span class="ident" id="3553740">node</span><span class="op" id="3553744">.</span><span class="ident" id="3553745">Text</span><span class="op" id="3553749">)</span><span class="op" id="3553750">;</span>&nbsp;<span class="ident" id="3553752">err</span>&nbsp;<span class="op" id="3553756">!=</span>&nbsp;<span class="builtintype" id="3553759">nil</span>&nbsp;<span class="op" id="3553763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3553768">s</span><span class="op" id="3553769">.</span><span class="ident" id="3553770">errorf</span><span class="op" id="3553776">(</span><span class="string" id="3553777">&#34;%s&#34;</span><span class="op" id="3553781">,</span>&nbsp;<span class="ident" id="3553783">err</span><span class="op" id="3553786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3553790">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3553793">case</span>&nbsp;<span class="op" id="3553798">*</span><span class="ident" id="3553799">parse</span><span class="op" id="3553804">.</span><span class="ident" id="3553805">WithNode</span><span class="op" id="3553813">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3553817">s</span><span class="op" id="3553818">.</span><span class="ident" id="3553819">walkIfOrWith</span><span class="op" id="3553831">(</span><span class="ident" id="3553832">parse</span><span class="op" id="3553837">.</span><span class="ident" id="3553838">NodeWith</span><span class="op" id="3553846">,</span>&nbsp;<span class="ident" id="3553848">dot</span><span class="op" id="3553851">,</span>&nbsp;<span class="ident" id="3553853">node</span><span class="op" id="3553857">.</span><span class="ident" id="3553858">Pipe</span><span class="op" id="3553862">,</span>&nbsp;<span class="ident" id="3553864">node</span><span class="op" id="3553868">.</span><span class="ident" id="3553869">List</span><span class="op" id="3553873">,</span>&nbsp;<span class="ident" id="3553875">node</span><span class="op" id="3553879">.</span><span class="ident" id="3553880">ElseList</span><span class="op" id="3553888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3553891">default</span><span class="op" id="3553898">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3553902">s</span><span class="op" id="3553903">.</span><span class="ident" id="3553904">errorf</span><span class="op" id="3553910">(</span><span class="string" id="3553911">&#34;unknown&nbsp;node:&nbsp;%s&#34;</span><span class="op" id="3553929">,</span>&nbsp;<span class="ident" id="3553931">node</span><span class="op" id="3553935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3553938">}</span><br>
<span class="lineno">190</span><span class="op" id="3553940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3553943">//&nbsp;walkIfOrWith&nbsp;walks&nbsp;an&nbsp;&#39;if&#39;&nbsp;or&nbsp;&#39;with&#39;&nbsp;node.&nbsp;The&nbsp;two&nbsp;control&nbsp;structures</span><br>
<span class="lineno"></span><span class="comment" id="3554016">//&nbsp;are&nbsp;identical&nbsp;in&nbsp;behavior&nbsp;except&nbsp;that&nbsp;&#39;with&#39;&nbsp;sets&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="3554074">func</span>&nbsp;<span class="op" id="3554079">(</span><span class="ident" id="3554080">s</span>&nbsp;<span class="op" id="3554082">*</span><span class="ident" id="3554083">state</span><span class="op" id="3554088">)</span>&nbsp;<span class="ident" id="3554090">walkIfOrWith</span><span class="op" id="3554102">(</span><span class="ident" id="3554103">typ</span>&nbsp;<span class="ident" id="3554107">parse</span><span class="op" id="3554112">.</span><span class="ident" id="3554113">NodeType</span><span class="op" id="3554121">,</span>&nbsp;<span class="ident" id="3554123">dot</span>&nbsp;<span class="ident" id="3554127">reflect</span><span class="op" id="3554134">.</span><span class="ident" id="3554135">Value</span><span class="op" id="3554140">,</span>&nbsp;<span class="ident" id="3554142">pipe</span>&nbsp;<span class="op" id="3554147">*</span><span class="ident" id="3554148">parse</span><span class="op" id="3554153">.</span><span class="ident" id="3554154">PipeNode</span><span class="op" id="3554162">,</span>&nbsp;<span class="ident" id="3554164">list</span><span class="op" id="3554168">,</span>&nbsp;<span class="ident" id="3554170">elseList</span>&nbsp;<span class="op" id="3554179">*</span><span class="ident" id="3554180">parse</span><span class="op" id="3554185">.</span><span class="ident" id="3554186">ListNode</span><span class="op" id="3554194">)</span>&nbsp;<span class="op" id="3554196">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554199">defer</span>&nbsp;<span class="ident" id="3554205">s</span><span class="op" id="3554206">.</span><span class="ident" id="3554207">pop</span><span class="op" id="3554210">(</span><span class="ident" id="3554211">s</span><span class="op" id="3554212">.</span><span class="ident" id="3554213">mark</span><span class="op" id="3554217">(</span><span class="op" id="3554218">)</span><span class="op" id="3554219">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3554222">val</span>&nbsp;<span class="op" id="3554226">:=</span>&nbsp;<span class="ident" id="3554229">s</span><span class="op" id="3554230">.</span><span class="ident" id="3554231">evalPipeline</span><span class="op" id="3554243">(</span><span class="ident" id="3554244">dot</span><span class="op" id="3554247">,</span>&nbsp;<span class="ident" id="3554249">pipe</span><span class="op" id="3554253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3554256">truth</span><span class="op" id="3554261">,</span>&nbsp;<span class="ident" id="3554263">ok</span>&nbsp;<span class="op" id="3554266">:=</span>&nbsp;<span class="ident" id="3554269">isTrue</span><span class="op" id="3554275">(</span><span class="ident" id="3554276">val</span><span class="op" id="3554279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554282">if</span>&nbsp;<span class="op" id="3554285">!</span><span class="ident" id="3554286">ok</span>&nbsp;<span class="op" id="3554289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3554293">s</span><span class="op" id="3554294">.</span><span class="ident" id="3554295">errorf</span><span class="op" id="3554301">(</span><span class="string" id="3554302">&#34;if/with&nbsp;can&#39;t&nbsp;use&nbsp;%v&#34;</span><span class="op" id="3554324">,</span>&nbsp;<span class="ident" id="3554326">val</span><span class="op" id="3554329">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3554332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554335">if</span>&nbsp;<span class="ident" id="3554338">truth</span>&nbsp;<span class="op" id="3554344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554348">if</span>&nbsp;<span class="ident" id="3554351">typ</span>&nbsp;<span class="op" id="3554355">==</span>&nbsp;<span class="ident" id="3554358">parse</span><span class="op" id="3554363">.</span><span class="ident" id="3554364">NodeWith</span>&nbsp;<span class="op" id="3554373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3554378">s</span><span class="op" id="3554379">.</span><span class="ident" id="3554380">walk</span><span class="op" id="3554384">(</span><span class="ident" id="3554385">val</span><span class="op" id="3554388">,</span>&nbsp;<span class="ident" id="3554390">list</span><span class="op" id="3554394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3554398">}</span>&nbsp;<span class="keyword" id="3554400">else</span>&nbsp;<span class="op" id="3554405">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3554410">s</span><span class="op" id="3554411">.</span><span class="ident" id="3554412">walk</span><span class="op" id="3554416">(</span><span class="ident" id="3554417">dot</span><span class="op" id="3554420">,</span>&nbsp;<span class="ident" id="3554422">list</span><span class="op" id="3554426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3554430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3554433">}</span>&nbsp;<span class="keyword" id="3554435">else</span>&nbsp;<span class="keyword" id="3554440">if</span>&nbsp;<span class="ident" id="3554443">elseList</span>&nbsp;<span class="op" id="3554452">!=</span>&nbsp;<span class="builtintype" id="3554455">nil</span>&nbsp;<span class="op" id="3554459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3554463">s</span><span class="op" id="3554464">.</span><span class="ident" id="3554465">walk</span><span class="op" id="3554469">(</span><span class="ident" id="3554470">dot</span><span class="op" id="3554473">,</span>&nbsp;<span class="ident" id="3554475">elseList</span><span class="op" id="3554483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3554486">}</span><br>
<span class="lineno">210</span><span class="op" id="3554488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3554491">//&nbsp;isTrue&nbsp;reports&nbsp;whether&nbsp;the&nbsp;value&nbsp;is&nbsp;&#39;true&#39;,&nbsp;in&nbsp;the&nbsp;sense&nbsp;of&nbsp;not&nbsp;the&nbsp;zero&nbsp;of&nbsp;its&nbsp;type,</span><br>
<span class="lineno"></span><span class="comment" id="3554580">//&nbsp;and&nbsp;whether&nbsp;the&nbsp;value&nbsp;has&nbsp;a&nbsp;meaningful&nbsp;truth&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="3554635">func</span>&nbsp;<span class="ident" id="3554640">isTrue</span><span class="op" id="3554646">(</span><span class="ident" id="3554647">val</span>&nbsp;<span class="ident" id="3554651">reflect</span><span class="op" id="3554658">.</span><span class="ident" id="3554659">Value</span><span class="op" id="3554664">)</span>&nbsp;<span class="op" id="3554666">(</span><span class="ident" id="3554667">truth</span><span class="op" id="3554672">,</span>&nbsp;<span class="ident" id="3554674">ok</span>&nbsp;<span class="builtintype" id="3554677">bool</span><span class="op" id="3554681">)</span>&nbsp;<span class="op" id="3554683">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554686">if</span>&nbsp;<span class="op" id="3554689">!</span><span class="ident" id="3554690">val</span><span class="op" id="3554693">.</span><span class="ident" id="3554694">IsValid</span><span class="op" id="3554701">(</span><span class="op" id="3554702">)</span>&nbsp;<span class="op" id="3554704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3554708">//&nbsp;Something&nbsp;like&nbsp;var&nbsp;x&nbsp;interface{},&nbsp;never&nbsp;set.&nbsp;It&#39;s&nbsp;a&nbsp;form&nbsp;of&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554778">return</span>&nbsp;<span class="builtintype" id="3554785">false</span><span class="op" id="3554790">,</span>&nbsp;<span class="builtintype" id="3554792">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3554798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554801">switch</span>&nbsp;<span class="ident" id="3554808">val</span><span class="op" id="3554811">.</span><span class="ident" id="3554812">Kind</span><span class="op" id="3554816">(</span><span class="op" id="3554817">)</span>&nbsp;<span class="op" id="3554819">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554822">case</span>&nbsp;<span class="ident" id="3554827">reflect</span><span class="op" id="3554834">.</span><span class="ident" id="3554835">Array</span><span class="op" id="3554840">,</span>&nbsp;<span class="ident" id="3554842">reflect</span><span class="op" id="3554849">.</span><span class="ident" id="3554850">Map</span><span class="op" id="3554853">,</span>&nbsp;<span class="ident" id="3554855">reflect</span><span class="op" id="3554862">.</span><span class="ident" id="3554863">Slice</span><span class="op" id="3554868">,</span>&nbsp;<span class="ident" id="3554870">reflect</span><span class="op" id="3554877">.</span><span class="ident" id="3554878">String</span><span class="op" id="3554884">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3554888">truth</span>&nbsp;<span class="op" id="3554894">=</span>&nbsp;<span class="ident" id="3554896">val</span><span class="op" id="3554899">.</span><span class="ident" id="3554900">Len</span><span class="op" id="3554903">(</span><span class="op" id="3554904">)</span>&nbsp;<span class="op" id="3554906">&gt;</span>&nbsp;<span class="num" id="3554908">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554911">case</span>&nbsp;<span class="ident" id="3554916">reflect</span><span class="op" id="3554923">.</span><span class="ident" id="3554924">Bool</span><span class="op" id="3554928">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3554932">truth</span>&nbsp;<span class="op" id="3554938">=</span>&nbsp;<span class="ident" id="3554940">val</span><span class="op" id="3554943">.</span><span class="ident" id="3554944">Bool</span><span class="op" id="3554948">(</span><span class="op" id="3554949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3554952">case</span>&nbsp;<span class="ident" id="3554957">reflect</span><span class="op" id="3554964">.</span><span class="ident" id="3554965">Complex64</span><span class="op" id="3554974">,</span>&nbsp;<span class="ident" id="3554976">reflect</span><span class="op" id="3554983">.</span><span class="ident" id="3554984">Complex128</span><span class="op" id="3554994">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3554998">truth</span>&nbsp;<span class="op" id="3555004">=</span>&nbsp;<span class="ident" id="3555006">val</span><span class="op" id="3555009">.</span><span class="ident" id="3555010">Complex</span><span class="op" id="3555017">(</span><span class="op" id="3555018">)</span>&nbsp;<span class="op" id="3555020">!=</span>&nbsp;<span class="num" id="3555023">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3555026">case</span>&nbsp;<span class="ident" id="3555031">reflect</span><span class="op" id="3555038">.</span><span class="ident" id="3555039">Chan</span><span class="op" id="3555043">,</span>&nbsp;<span class="ident" id="3555045">reflect</span><span class="op" id="3555052">.</span><span class="ident" id="3555053">Func</span><span class="op" id="3555057">,</span>&nbsp;<span class="ident" id="3555059">reflect</span><span class="op" id="3555066">.</span><span class="ident" id="3555067">Ptr</span><span class="op" id="3555070">,</span>&nbsp;<span class="ident" id="3555072">reflect</span><span class="op" id="3555079">.</span><span class="ident" id="3555080">Interface</span><span class="op" id="3555089">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3555093">truth</span>&nbsp;<span class="op" id="3555099">=</span>&nbsp;<span class="op" id="3555101">!</span><span class="ident" id="3555102">val</span><span class="op" id="3555105">.</span><span class="ident" id="3555106">IsNil</span><span class="op" id="3555111">(</span><span class="op" id="3555112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3555115">case</span>&nbsp;<span class="ident" id="3555120">reflect</span><span class="op" id="3555127">.</span><span class="ident" id="3555128">Int</span><span class="op" id="3555131">,</span>&nbsp;<span class="ident" id="3555133">reflect</span><span class="op" id="3555140">.</span><span class="ident" id="3555141">Int8</span><span class="op" id="3555145">,</span>&nbsp;<span class="ident" id="3555147">reflect</span><span class="op" id="3555154">.</span><span class="ident" id="3555155">Int16</span><span class="op" id="3555160">,</span>&nbsp;<span class="ident" id="3555162">reflect</span><span class="op" id="3555169">.</span><span class="ident" id="3555170">Int32</span><span class="op" id="3555175">,</span>&nbsp;<span class="ident" id="3555177">reflect</span><span class="op" id="3555184">.</span><span class="ident" id="3555185">Int64</span><span class="op" id="3555190">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3555194">truth</span>&nbsp;<span class="op" id="3555200">=</span>&nbsp;<span class="ident" id="3555202">val</span><span class="op" id="3555205">.</span><span class="ident" id="3555206">Int</span><span class="op" id="3555209">(</span><span class="op" id="3555210">)</span>&nbsp;<span class="op" id="3555212">!=</span>&nbsp;<span class="num" id="3555215">0</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3555218">case</span>&nbsp;<span class="ident" id="3555223">reflect</span><span class="op" id="3555230">.</span><span class="ident" id="3555231">Float32</span><span class="op" id="3555238">,</span>&nbsp;<span class="ident" id="3555240">reflect</span><span class="op" id="3555247">.</span><span class="ident" id="3555248">Float64</span><span class="op" id="3555255">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3555259">truth</span>&nbsp;<span class="op" id="3555265">=</span>&nbsp;<span class="ident" id="3555267">val</span><span class="op" id="3555270">.</span><span class="ident" id="3555271">Float</span><span class="op" id="3555276">(</span><span class="op" id="3555277">)</span>&nbsp;<span class="op" id="3555279">!=</span>&nbsp;<span class="num" id="3555282">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3555285">case</span>&nbsp;<span class="ident" id="3555290">reflect</span><span class="op" id="3555297">.</span><span class="ident" id="3555298">Uint</span><span class="op" id="3555302">,</span>&nbsp;<span class="ident" id="3555304">reflect</span><span class="op" id="3555311">.</span><span class="ident" id="3555312">Uint8</span><span class="op" id="3555317">,</span>&nbsp;<span class="ident" id="3555319">reflect</span><span class="op" id="3555326">.</span><span class="ident" id="3555327">Uint16</span><span class="op" id="3555333">,</span>&nbsp;<span class="ident" id="3555335">reflect</span><span class="op" id="3555342">.</span><span class="ident" id="3555343">Uint32</span><span class="op" id="3555349">,</span>&nbsp;<span class="ident" id="3555351">reflect</span><span class="op" id="3555358">.</span><span class="ident" id="3555359">Uint64</span><span class="op" id="3555365">,</span>&nbsp;<span class="ident" id="3555367">reflect</span><span class="op" id="3555374">.</span><span class="ident" id="3555375">Uintptr</span><span class="op" id="3555382">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3555386">truth</span>&nbsp;<span class="op" id="3555392">=</span>&nbsp;<span class="ident" id="3555394">val</span><span class="op" id="3555397">.</span><span class="ident" id="3555398">Uint</span><span class="op" id="3555402">(</span><span class="op" id="3555403">)</span>&nbsp;<span class="op" id="3555405">!=</span>&nbsp;<span class="num" id="3555408">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3555411">case</span>&nbsp;<span class="ident" id="3555416">reflect</span><span class="op" id="3555423">.</span><span class="ident" id="3555424">Struct</span><span class="op" id="3555430">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3555434">truth</span>&nbsp;<span class="op" id="3555440">=</span>&nbsp;<span class="builtintype" id="3555442">true</span>&nbsp;<span class="comment" id="3555447">//&nbsp;Struct&nbsp;values&nbsp;are&nbsp;always&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3555482">default</span><span class="op" id="3555489">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3555493">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3555501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3555504">return</span>&nbsp;<span class="ident" id="3555511">truth</span><span class="op" id="3555516">,</span>&nbsp;<span class="builtintype" id="3555518">true</span><br>
<span class="lineno">240</span><span class="op" id="3555523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3555526">func</span>&nbsp;<span class="op" id="3555531">(</span><span class="ident" id="3555532">s</span>&nbsp;<span class="op" id="3555534">*</span><span class="ident" id="3555535">state</span><span class="op" id="3555540">)</span>&nbsp;<span class="ident" id="3555542">walkRange</span><span class="op" id="3555551">(</span><span class="ident" id="3555552">dot</span>&nbsp;<span class="ident" id="3555556">reflect</span><span class="op" id="3555563">.</span><span class="ident" id="3555564">Value</span><span class="op" id="3555569">,</span>&nbsp;<span class="ident" id="3555571">r</span>&nbsp;<span class="op" id="3555573">*</span><span class="ident" id="3555574">parse</span><span class="op" id="3555579">.</span><span class="ident" id="3555580">RangeNode</span><span class="op" id="3555589">)</span>&nbsp;<span class="op" id="3555591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3555594">s</span><span class="op" id="3555595">.</span><span class="ident" id="3555596">at</span><span class="op" id="3555598">(</span><span class="ident" id="3555599">r</span><span class="op" id="3555600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3555603">defer</span>&nbsp;<span class="ident" id="3555609">s</span><span class="op" id="3555610">.</span><span class="ident" id="3555611">pop</span><span class="op" id="3555614">(</span><span class="ident" id="3555615">s</span><span class="op" id="3555616">.</span><span class="ident" id="3555617">mark</span><span class="op" id="3555621">(</span><span class="op" id="3555622">)</span><span class="op" id="3555623">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3555626">val</span><span class="op" id="3555629">,</span>&nbsp;<span class="ident" id="3555631">_</span>&nbsp;<span class="op" id="3555633">:=</span>&nbsp;<span class="ident" id="3555636">indirect</span><span class="op" id="3555644">(</span><span class="ident" id="3555645">s</span><span class="op" id="3555646">.</span><span class="ident" id="3555647">evalPipeline</span><span class="op" id="3555659">(</span><span class="ident" id="3555660">dot</span><span class="op" id="3555663">,</span>&nbsp;<span class="ident" id="3555665">r</span><span class="op" id="3555666">.</span><span class="ident" id="3555667">Pipe</span><span class="op" id="3555671">)</span><span class="op" id="3555672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3555675">//&nbsp;mark&nbsp;top&nbsp;of&nbsp;stack&nbsp;before&nbsp;any&nbsp;variables&nbsp;in&nbsp;the&nbsp;body&nbsp;are&nbsp;pushed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3555742">mark</span>&nbsp;<span class="op" id="3555747">:=</span>&nbsp;<span class="ident" id="3555750">s</span><span class="op" id="3555751">.</span><span class="ident" id="3555752">mark</span><span class="op" id="3555756">(</span><span class="op" id="3555757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3555760">oneIteration</span>&nbsp;<span class="op" id="3555773">:=</span>&nbsp;<span class="keyword" id="3555776">func</span><span class="op" id="3555780">(</span><span class="ident" id="3555781">index</span><span class="op" id="3555786">,</span>&nbsp;<span class="ident" id="3555788">elem</span>&nbsp;<span class="ident" id="3555793">reflect</span><span class="op" id="3555800">.</span><span class="ident" id="3555801">Value</span><span class="op" id="3555806">)</span>&nbsp;<span class="op" id="3555808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3555812">//&nbsp;Set&nbsp;top&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;second&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;element.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3555885">if</span>&nbsp;<span class="builtinfunc" id="3555888">len</span><span class="op" id="3555891">(</span><span class="ident" id="3555892">r</span><span class="op" id="3555893">.</span><span class="ident" id="3555894">Pipe</span><span class="op" id="3555898">.</span><span class="ident" id="3555899">Decl</span><span class="op" id="3555903">)</span>&nbsp;<span class="op" id="3555905">&gt;</span>&nbsp;<span class="num" id="3555907">0</span>&nbsp;<span class="op" id="3555909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3555914">s</span><span class="op" id="3555915">.</span><span class="ident" id="3555916">setVar</span><span class="op" id="3555922">(</span><span class="num" id="3555923">1</span><span class="op" id="3555924">,</span>&nbsp;<span class="ident" id="3555926">elem</span><span class="op" id="3555930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3555934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3555938">//&nbsp;Set&nbsp;next&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;first&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;index.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556009">if</span>&nbsp;<span class="builtinfunc" id="3556012">len</span><span class="op" id="3556015">(</span><span class="ident" id="3556016">r</span><span class="op" id="3556017">.</span><span class="ident" id="3556018">Pipe</span><span class="op" id="3556022">.</span><span class="ident" id="3556023">Decl</span><span class="op" id="3556027">)</span>&nbsp;<span class="op" id="3556029">&gt;</span>&nbsp;<span class="num" id="3556031">1</span>&nbsp;<span class="op" id="3556033">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556038">s</span><span class="op" id="3556039">.</span><span class="ident" id="3556040">setVar</span><span class="op" id="3556046">(</span><span class="num" id="3556047">2</span><span class="op" id="3556048">,</span>&nbsp;<span class="ident" id="3556050">index</span><span class="op" id="3556055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3556059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556063">s</span><span class="op" id="3556064">.</span><span class="ident" id="3556065">walk</span><span class="op" id="3556069">(</span><span class="ident" id="3556070">elem</span><span class="op" id="3556074">,</span>&nbsp;<span class="ident" id="3556076">r</span><span class="op" id="3556077">.</span><span class="ident" id="3556078">List</span><span class="op" id="3556082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556086">s</span><span class="op" id="3556087">.</span><span class="ident" id="3556088">pop</span><span class="op" id="3556091">(</span><span class="ident" id="3556092">mark</span><span class="op" id="3556096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3556099">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556102">switch</span>&nbsp;<span class="ident" id="3556109">val</span><span class="op" id="3556112">.</span><span class="ident" id="3556113">Kind</span><span class="op" id="3556117">(</span><span class="op" id="3556118">)</span>&nbsp;<span class="op" id="3556120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556123">case</span>&nbsp;<span class="ident" id="3556128">reflect</span><span class="op" id="3556135">.</span><span class="ident" id="3556136">Array</span><span class="op" id="3556141">,</span>&nbsp;<span class="ident" id="3556143">reflect</span><span class="op" id="3556150">.</span><span class="ident" id="3556151">Slice</span><span class="op" id="3556156">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556160">if</span>&nbsp;<span class="ident" id="3556163">val</span><span class="op" id="3556166">.</span><span class="ident" id="3556167">Len</span><span class="op" id="3556170">(</span><span class="op" id="3556171">)</span>&nbsp;<span class="op" id="3556173">==</span>&nbsp;<span class="num" id="3556176">0</span>&nbsp;<span class="op" id="3556178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556183">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3556191">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556195">for</span>&nbsp;<span class="ident" id="3556199">i</span>&nbsp;<span class="op" id="3556201">:=</span>&nbsp;<span class="num" id="3556204">0</span><span class="op" id="3556205">;</span>&nbsp;<span class="ident" id="3556207">i</span>&nbsp;<span class="op" id="3556209">&lt;</span>&nbsp;<span class="ident" id="3556211">val</span><span class="op" id="3556214">.</span><span class="ident" id="3556215">Len</span><span class="op" id="3556218">(</span><span class="op" id="3556219">)</span><span class="op" id="3556220">;</span>&nbsp;<span class="ident" id="3556222">i</span><span class="op" id="3556223">++</span>&nbsp;<span class="op" id="3556226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556231">oneIteration</span><span class="op" id="3556243">(</span><span class="ident" id="3556244">reflect</span><span class="op" id="3556251">.</span><span class="ident" id="3556252">ValueOf</span><span class="op" id="3556259">(</span><span class="ident" id="3556260">i</span><span class="op" id="3556261">)</span><span class="op" id="3556262">,</span>&nbsp;<span class="ident" id="3556264">val</span><span class="op" id="3556267">.</span><span class="ident" id="3556268">Index</span><span class="op" id="3556273">(</span><span class="ident" id="3556274">i</span><span class="op" id="3556275">)</span><span class="op" id="3556276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3556280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556284">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556292">case</span>&nbsp;<span class="ident" id="3556297">reflect</span><span class="op" id="3556304">.</span><span class="ident" id="3556305">Map</span><span class="op" id="3556308">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556312">if</span>&nbsp;<span class="ident" id="3556315">val</span><span class="op" id="3556318">.</span><span class="ident" id="3556319">Len</span><span class="op" id="3556322">(</span><span class="op" id="3556323">)</span>&nbsp;<span class="op" id="3556325">==</span>&nbsp;<span class="num" id="3556328">0</span>&nbsp;<span class="op" id="3556330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556335">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3556343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556347">for</span>&nbsp;<span class="ident" id="3556351">_</span><span class="op" id="3556352">,</span>&nbsp;<span class="ident" id="3556354">key</span>&nbsp;<span class="op" id="3556358">:=</span>&nbsp;<span class="keyword" id="3556361">range</span>&nbsp;<span class="ident" id="3556367">sortKeys</span><span class="op" id="3556375">(</span><span class="ident" id="3556376">val</span><span class="op" id="3556379">.</span><span class="ident" id="3556380">MapKeys</span><span class="op" id="3556387">(</span><span class="op" id="3556388">)</span><span class="op" id="3556389">)</span>&nbsp;<span class="op" id="3556391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556396">oneIteration</span><span class="op" id="3556408">(</span><span class="ident" id="3556409">key</span><span class="op" id="3556412">,</span>&nbsp;<span class="ident" id="3556414">val</span><span class="op" id="3556417">.</span><span class="ident" id="3556418">MapIndex</span><span class="op" id="3556426">(</span><span class="ident" id="3556427">key</span><span class="op" id="3556430">)</span><span class="op" id="3556431">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3556435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556439">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556447">case</span>&nbsp;<span class="ident" id="3556452">reflect</span><span class="op" id="3556459">.</span><span class="ident" id="3556460">Chan</span><span class="op" id="3556464">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556468">if</span>&nbsp;<span class="ident" id="3556471">val</span><span class="op" id="3556474">.</span><span class="ident" id="3556475">IsNil</span><span class="op" id="3556480">(</span><span class="op" id="3556481">)</span>&nbsp;<span class="op" id="3556483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556488">break</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3556496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556500">i</span>&nbsp;<span class="op" id="3556502">:=</span>&nbsp;<span class="num" id="3556505">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556509">for</span>&nbsp;<span class="op" id="3556513">;</span>&nbsp;<span class="op" id="3556515">;</span>&nbsp;<span class="ident" id="3556517">i</span><span class="op" id="3556518">++</span>&nbsp;<span class="op" id="3556521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556526">elem</span><span class="op" id="3556530">,</span>&nbsp;<span class="ident" id="3556532">ok</span>&nbsp;<span class="op" id="3556535">:=</span>&nbsp;<span class="ident" id="3556538">val</span><span class="op" id="3556541">.</span><span class="ident" id="3556542">Recv</span><span class="op" id="3556546">(</span><span class="op" id="3556547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556552">if</span>&nbsp;<span class="op" id="3556555">!</span><span class="ident" id="3556556">ok</span>&nbsp;<span class="op" id="3556559">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556565">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3556574">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556579">oneIteration</span><span class="op" id="3556591">(</span><span class="ident" id="3556592">reflect</span><span class="op" id="3556599">.</span><span class="ident" id="3556600">ValueOf</span><span class="op" id="3556607">(</span><span class="ident" id="3556608">i</span><span class="op" id="3556609">)</span><span class="op" id="3556610">,</span>&nbsp;<span class="ident" id="3556612">elem</span><span class="op" id="3556616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3556620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556624">if</span>&nbsp;<span class="ident" id="3556627">i</span>&nbsp;<span class="op" id="3556629">==</span>&nbsp;<span class="num" id="3556632">0</span>&nbsp;<span class="op" id="3556634">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556639">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3556647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556651">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556659">case</span>&nbsp;<span class="ident" id="3556664">reflect</span><span class="op" id="3556671">.</span><span class="ident" id="3556672">Invalid</span><span class="op" id="3556679">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556683">break</span>&nbsp;<span class="comment" id="3556689">//&nbsp;An&nbsp;invalid&nbsp;value&nbsp;is&nbsp;likely&nbsp;a&nbsp;nil&nbsp;map,&nbsp;etc.&nbsp;and&nbsp;acts&nbsp;like&nbsp;an&nbsp;empty&nbsp;map.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556764">default</span><span class="op" id="3556771">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556775">s</span><span class="op" id="3556776">.</span><span class="ident" id="3556777">errorf</span><span class="op" id="3556783">(</span><span class="string" id="3556784">&#34;range&nbsp;can&#39;t&nbsp;iterate&nbsp;over&nbsp;%v&#34;</span><span class="op" id="3556813">,</span>&nbsp;<span class="ident" id="3556815">val</span><span class="op" id="3556818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3556821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556824">if</span>&nbsp;<span class="ident" id="3556827">r</span><span class="op" id="3556828">.</span><span class="ident" id="3556829">ElseList</span>&nbsp;<span class="op" id="3556838">!=</span>&nbsp;<span class="builtintype" id="3556841">nil</span>&nbsp;<span class="op" id="3556845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556849">s</span><span class="op" id="3556850">.</span><span class="ident" id="3556851">walk</span><span class="op" id="3556855">(</span><span class="ident" id="3556856">dot</span><span class="op" id="3556859">,</span>&nbsp;<span class="ident" id="3556861">r</span><span class="op" id="3556862">.</span><span class="ident" id="3556863">ElseList</span><span class="op" id="3556871">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3556874">}</span><br>
<span class="lineno"></span><span class="op" id="3556876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3556879">func</span>&nbsp;<span class="op" id="3556884">(</span><span class="ident" id="3556885">s</span>&nbsp;<span class="op" id="3556887">*</span><span class="ident" id="3556888">state</span><span class="op" id="3556893">)</span>&nbsp;<span class="ident" id="3556895">walkTemplate</span><span class="op" id="3556907">(</span><span class="ident" id="3556908">dot</span>&nbsp;<span class="ident" id="3556912">reflect</span><span class="op" id="3556919">.</span><span class="ident" id="3556920">Value</span><span class="op" id="3556925">,</span>&nbsp;<span class="ident" id="3556927">t</span>&nbsp;<span class="op" id="3556929">*</span><span class="ident" id="3556930">parse</span><span class="op" id="3556935">.</span><span class="ident" id="3556936">TemplateNode</span><span class="op" id="3556948">)</span>&nbsp;<span class="op" id="3556950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556953">s</span><span class="op" id="3556954">.</span><span class="ident" id="3556955">at</span><span class="op" id="3556957">(</span><span class="ident" id="3556958">t</span><span class="op" id="3556959">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3556962">tmpl</span>&nbsp;<span class="op" id="3556967">:=</span>&nbsp;<span class="ident" id="3556970">s</span><span class="op" id="3556971">.</span><span class="ident" id="3556972">tmpl</span><span class="op" id="3556976">.</span><span class="ident" id="3556977">tmpl</span><span class="op" id="3556981">[</span><span class="ident" id="3556982">t</span><span class="op" id="3556983">.</span><span class="ident" id="3556984">Name</span><span class="op" id="3556988">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3556991">if</span>&nbsp;<span class="ident" id="3556994">tmpl</span>&nbsp;<span class="op" id="3556999">==</span>&nbsp;<span class="builtintype" id="3557002">nil</span>&nbsp;<span class="op" id="3557006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557010">s</span><span class="op" id="3557011">.</span><span class="ident" id="3557012">errorf</span><span class="op" id="3557018">(</span><span class="string" id="3557019">&#34;template&nbsp;%q&nbsp;not&nbsp;defined&#34;</span><span class="op" id="3557044">,</span>&nbsp;<span class="ident" id="3557046">t</span><span class="op" id="3557047">.</span><span class="ident" id="3557048">Name</span><span class="op" id="3557052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3557055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3557058">//&nbsp;Variables&nbsp;declared&nbsp;by&nbsp;the&nbsp;pipeline&nbsp;persist.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557106">dot</span>&nbsp;<span class="op" id="3557110">=</span>&nbsp;<span class="ident" id="3557112">s</span><span class="op" id="3557113">.</span><span class="ident" id="3557114">evalPipeline</span><span class="op" id="3557126">(</span><span class="ident" id="3557127">dot</span><span class="op" id="3557130">,</span>&nbsp;<span class="ident" id="3557132">t</span><span class="op" id="3557133">.</span><span class="ident" id="3557134">Pipe</span><span class="op" id="3557138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557141">newState</span>&nbsp;<span class="op" id="3557150">:=</span>&nbsp;<span class="op" id="3557153">*</span><span class="ident" id="3557154">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557157">newState</span><span class="op" id="3557165">.</span><span class="ident" id="3557166">tmpl</span>&nbsp;<span class="op" id="3557171">=</span>&nbsp;<span class="ident" id="3557173">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3557179">//&nbsp;No&nbsp;dynamic&nbsp;scoping:&nbsp;template&nbsp;invocations&nbsp;inherit&nbsp;no&nbsp;variables.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557246">newState</span><span class="op" id="3557254">.</span><span class="ident" id="3557255">vars</span>&nbsp;<span class="op" id="3557260">=</span>&nbsp;<span class="op" id="3557262">[</span><span class="op" id="3557263">]</span><span class="ident" id="3557264">variable</span><span class="op" id="3557272">{</span><span class="op" id="3557273">{</span><span class="string" id="3557274">&#34;$&#34;</span><span class="op" id="3557277">,</span>&nbsp;<span class="ident" id="3557279">dot</span><span class="op" id="3557282">}</span><span class="op" id="3557283">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557286">newState</span><span class="op" id="3557294">.</span><span class="ident" id="3557295">walk</span><span class="op" id="3557299">(</span><span class="ident" id="3557300">dot</span><span class="op" id="3557303">,</span>&nbsp;<span class="ident" id="3557305">tmpl</span><span class="op" id="3557309">.</span><span class="ident" id="3557310">Root</span><span class="op" id="3557314">)</span><br>
<span class="lineno"></span><span class="op" id="3557316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3557319">//&nbsp;Eval&nbsp;functions&nbsp;evaluate&nbsp;pipelines,&nbsp;commands,&nbsp;and&nbsp;their&nbsp;elements&nbsp;and&nbsp;extract</span><br>
<span class="lineno"></span><span class="comment" id="3557398">//&nbsp;values&nbsp;from&nbsp;the&nbsp;data&nbsp;structure&nbsp;by&nbsp;examining&nbsp;fields,&nbsp;calling&nbsp;methods,&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">320</span><span class="comment" id="3557481">//&nbsp;The&nbsp;printing&nbsp;of&nbsp;those&nbsp;values&nbsp;happens&nbsp;only&nbsp;through&nbsp;walk&nbsp;functions.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3557551">//&nbsp;evalPipeline&nbsp;returns&nbsp;the&nbsp;value&nbsp;acquired&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;pipeline.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3557627">//&nbsp;pipeline&nbsp;has&nbsp;a&nbsp;variable&nbsp;declaration,&nbsp;the&nbsp;variable&nbsp;will&nbsp;be&nbsp;pushed&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="3557702">//&nbsp;stack.&nbsp;Callers&nbsp;should&nbsp;therefore&nbsp;pop&nbsp;the&nbsp;stack&nbsp;after&nbsp;they&nbsp;are&nbsp;finished</span><br>
<span class="lineno">325</span><span class="comment" id="3557775">//&nbsp;executing&nbsp;commands&nbsp;depending&nbsp;on&nbsp;the&nbsp;pipeline&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="3557830">func</span>&nbsp;<span class="op" id="3557835">(</span><span class="ident" id="3557836">s</span>&nbsp;<span class="op" id="3557838">*</span><span class="ident" id="3557839">state</span><span class="op" id="3557844">)</span>&nbsp;<span class="ident" id="3557846">evalPipeline</span><span class="op" id="3557858">(</span><span class="ident" id="3557859">dot</span>&nbsp;<span class="ident" id="3557863">reflect</span><span class="op" id="3557870">.</span><span class="ident" id="3557871">Value</span><span class="op" id="3557876">,</span>&nbsp;<span class="ident" id="3557878">pipe</span>&nbsp;<span class="op" id="3557883">*</span><span class="ident" id="3557884">parse</span><span class="op" id="3557889">.</span><span class="ident" id="3557890">PipeNode</span><span class="op" id="3557898">)</span>&nbsp;<span class="op" id="3557900">(</span><span class="ident" id="3557901">value</span>&nbsp;<span class="ident" id="3557907">reflect</span><span class="op" id="3557914">.</span><span class="ident" id="3557915">Value</span><span class="op" id="3557920">)</span>&nbsp;<span class="op" id="3557922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3557925">if</span>&nbsp;<span class="ident" id="3557928">pipe</span>&nbsp;<span class="op" id="3557933">==</span>&nbsp;<span class="builtintype" id="3557936">nil</span>&nbsp;<span class="op" id="3557940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3557944">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3557952">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3557955">s</span><span class="op" id="3557956">.</span><span class="ident" id="3557957">at</span><span class="op" id="3557959">(</span><span class="ident" id="3557960">pipe</span><span class="op" id="3557964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3557967">for</span>&nbsp;<span class="ident" id="3557971">_</span><span class="op" id="3557972">,</span>&nbsp;<span class="ident" id="3557974">cmd</span>&nbsp;<span class="op" id="3557978">:=</span>&nbsp;<span class="keyword" id="3557981">range</span>&nbsp;<span class="ident" id="3557987">pipe</span><span class="op" id="3557991">.</span><span class="ident" id="3557992">Cmds</span>&nbsp;<span class="op" id="3557997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558001">value</span>&nbsp;<span class="op" id="3558007">=</span>&nbsp;<span class="ident" id="3558009">s</span><span class="op" id="3558010">.</span><span class="ident" id="3558011">evalCommand</span><span class="op" id="3558022">(</span><span class="ident" id="3558023">dot</span><span class="op" id="3558026">,</span>&nbsp;<span class="ident" id="3558028">cmd</span><span class="op" id="3558031">,</span>&nbsp;<span class="ident" id="3558033">value</span><span class="op" id="3558038">)</span>&nbsp;<span class="comment" id="3558040">//&nbsp;previous&nbsp;value&nbsp;is&nbsp;this&nbsp;one&#39;s&nbsp;final&nbsp;arg.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3558085">//&nbsp;If&nbsp;the&nbsp;object&nbsp;has&nbsp;type&nbsp;interface{},&nbsp;dig&nbsp;down&nbsp;one&nbsp;level&nbsp;to&nbsp;the&nbsp;thing&nbsp;inside.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558166">if</span>&nbsp;<span class="ident" id="3558169">value</span><span class="op" id="3558174">.</span><span class="ident" id="3558175">Kind</span><span class="op" id="3558179">(</span><span class="op" id="3558180">)</span>&nbsp;<span class="op" id="3558182">==</span>&nbsp;<span class="ident" id="3558185">reflect</span><span class="op" id="3558192">.</span><span class="ident" id="3558193">Interface</span>&nbsp;<span class="op" id="3558203">&amp;&amp;</span>&nbsp;<span class="ident" id="3558206">value</span><span class="op" id="3558211">.</span><span class="ident" id="3558212">Type</span><span class="op" id="3558216">(</span><span class="op" id="3558217">)</span><span class="op" id="3558218">.</span><span class="ident" id="3558219">NumMethod</span><span class="op" id="3558228">(</span><span class="op" id="3558229">)</span>&nbsp;<span class="op" id="3558231">==</span>&nbsp;<span class="num" id="3558234">0</span>&nbsp;<span class="op" id="3558236">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558241">value</span>&nbsp;<span class="op" id="3558247">=</span>&nbsp;<span class="ident" id="3558249">reflect</span><span class="op" id="3558256">.</span><span class="ident" id="3558257">ValueOf</span><span class="op" id="3558264">(</span><span class="ident" id="3558265">value</span><span class="op" id="3558270">.</span><span class="ident" id="3558271">Interface</span><span class="op" id="3558280">(</span><span class="op" id="3558281">)</span><span class="op" id="3558282">)</span>&nbsp;<span class="comment" id="3558284">//&nbsp;lovely!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3558297">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3558300">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558303">for</span>&nbsp;<span class="ident" id="3558307">_</span><span class="op" id="3558308">,</span>&nbsp;<span class="ident" id="3558310">variable</span>&nbsp;<span class="op" id="3558319">:=</span>&nbsp;<span class="keyword" id="3558322">range</span>&nbsp;<span class="ident" id="3558328">pipe</span><span class="op" id="3558332">.</span><span class="ident" id="3558333">Decl</span>&nbsp;<span class="op" id="3558338">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558342">s</span><span class="op" id="3558343">.</span><span class="ident" id="3558344">push</span><span class="op" id="3558348">(</span><span class="ident" id="3558349">variable</span><span class="op" id="3558357">.</span><span class="ident" id="3558358">Ident</span><span class="op" id="3558363">[</span><span class="num" id="3558364">0</span><span class="op" id="3558365">]</span><span class="op" id="3558366">,</span>&nbsp;<span class="ident" id="3558368">value</span><span class="op" id="3558373">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3558376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558379">return</span>&nbsp;<span class="ident" id="3558386">value</span><br>
<span class="lineno"></span><span class="op" id="3558392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3558395">func</span>&nbsp;<span class="op" id="3558400">(</span><span class="ident" id="3558401">s</span>&nbsp;<span class="op" id="3558403">*</span><span class="ident" id="3558404">state</span><span class="op" id="3558409">)</span>&nbsp;<span class="ident" id="3558411">notAFunction</span><span class="op" id="3558423">(</span><span class="ident" id="3558424">args</span>&nbsp;<span class="op" id="3558429">[</span><span class="op" id="3558430">]</span><span class="ident" id="3558431">parse</span><span class="op" id="3558436">.</span><span class="ident" id="3558437">Node</span><span class="op" id="3558441">,</span>&nbsp;<span class="ident" id="3558443">final</span>&nbsp;<span class="ident" id="3558449">reflect</span><span class="op" id="3558456">.</span><span class="ident" id="3558457">Value</span><span class="op" id="3558462">)</span>&nbsp;<span class="op" id="3558464">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558467">if</span>&nbsp;<span class="builtinfunc" id="3558470">len</span><span class="op" id="3558473">(</span><span class="ident" id="3558474">args</span><span class="op" id="3558478">)</span>&nbsp;<span class="op" id="3558480">&gt;</span>&nbsp;<span class="num" id="3558482">1</span>&nbsp;<span class="op" id="3558484">||</span>&nbsp;<span class="ident" id="3558487">final</span><span class="op" id="3558492">.</span><span class="ident" id="3558493">IsValid</span><span class="op" id="3558500">(</span><span class="op" id="3558501">)</span>&nbsp;<span class="op" id="3558503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558507">s</span><span class="op" id="3558508">.</span><span class="ident" id="3558509">errorf</span><span class="op" id="3558515">(</span><span class="string" id="3558516">&#34;can&#39;t&nbsp;give&nbsp;argument&nbsp;to&nbsp;non-function&nbsp;%s&#34;</span><span class="op" id="3558556">,</span>&nbsp;<span class="ident" id="3558558">args</span><span class="op" id="3558562">[</span><span class="num" id="3558563">0</span><span class="op" id="3558564">]</span><span class="op" id="3558565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3558568">}</span><br>
<span class="lineno"></span><span class="op" id="3558570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="3558573">func</span>&nbsp;<span class="op" id="3558578">(</span><span class="ident" id="3558579">s</span>&nbsp;<span class="op" id="3558581">*</span><span class="ident" id="3558582">state</span><span class="op" id="3558587">)</span>&nbsp;<span class="ident" id="3558589">evalCommand</span><span class="op" id="3558600">(</span><span class="ident" id="3558601">dot</span>&nbsp;<span class="ident" id="3558605">reflect</span><span class="op" id="3558612">.</span><span class="ident" id="3558613">Value</span><span class="op" id="3558618">,</span>&nbsp;<span class="ident" id="3558620">cmd</span>&nbsp;<span class="op" id="3558624">*</span><span class="ident" id="3558625">parse</span><span class="op" id="3558630">.</span><span class="ident" id="3558631">CommandNode</span><span class="op" id="3558642">,</span>&nbsp;<span class="ident" id="3558644">final</span>&nbsp;<span class="ident" id="3558650">reflect</span><span class="op" id="3558657">.</span><span class="ident" id="3558658">Value</span><span class="op" id="3558663">)</span>&nbsp;<span class="ident" id="3558665">reflect</span><span class="op" id="3558672">.</span><span class="ident" id="3558673">Value</span>&nbsp;<span class="op" id="3558679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3558682">firstWord</span>&nbsp;<span class="op" id="3558692">:=</span>&nbsp;<span class="ident" id="3558695">cmd</span><span class="op" id="3558698">.</span><span class="ident" id="3558699">Args</span><span class="op" id="3558703">[</span><span class="num" id="3558704">0</span><span class="op" id="3558705">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558708">switch</span>&nbsp;<span class="ident" id="3558715">n</span>&nbsp;<span class="op" id="3558717">:=</span>&nbsp;<span class="ident" id="3558720">firstWord</span><span class="op" id="3558729">.</span><span class="op" id="3558730">(</span><span class="keyword" id="3558731">type</span><span class="op" id="3558735">)</span>&nbsp;<span class="op" id="3558737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558740">case</span>&nbsp;<span class="op" id="3558745">*</span><span class="ident" id="3558746">parse</span><span class="op" id="3558751">.</span><span class="ident" id="3558752">FieldNode</span><span class="op" id="3558761">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558765">return</span>&nbsp;<span class="ident" id="3558772">s</span><span class="op" id="3558773">.</span><span class="ident" id="3558774">evalFieldNode</span><span class="op" id="3558787">(</span><span class="ident" id="3558788">dot</span><span class="op" id="3558791">,</span>&nbsp;<span class="ident" id="3558793">n</span><span class="op" id="3558794">,</span>&nbsp;<span class="ident" id="3558796">cmd</span><span class="op" id="3558799">.</span><span class="ident" id="3558800">Args</span><span class="op" id="3558804">,</span>&nbsp;<span class="ident" id="3558806">final</span><span class="op" id="3558811">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558814">case</span>&nbsp;<span class="op" id="3558819">*</span><span class="ident" id="3558820">parse</span><span class="op" id="3558825">.</span><span class="ident" id="3558826">ChainNode</span><span class="op" id="3558835">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558839">return</span>&nbsp;<span class="ident" id="3558846">s</span><span class="op" id="3558847">.</span><span class="ident" id="3558848">evalChainNode</span><span class="op" id="3558861">(</span><span class="ident" id="3558862">dot</span><span class="op" id="3558865">,</span>&nbsp;<span class="ident" id="3558867">n</span><span class="op" id="3558868">,</span>&nbsp;<span class="ident" id="3558870">cmd</span><span class="op" id="3558873">.</span><span class="ident" id="3558874">Args</span><span class="op" id="3558878">,</span>&nbsp;<span class="ident" id="3558880">final</span><span class="op" id="3558885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558888">case</span>&nbsp;<span class="op" id="3558893">*</span><span class="ident" id="3558894">parse</span><span class="op" id="3558899">.</span><span class="ident" id="3558900">IdentifierNode</span><span class="op" id="3558914">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3558918">//&nbsp;Must&nbsp;be&nbsp;a&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558943">return</span>&nbsp;<span class="ident" id="3558950">s</span><span class="op" id="3558951">.</span><span class="ident" id="3558952">evalFunction</span><span class="op" id="3558964">(</span><span class="ident" id="3558965">dot</span><span class="op" id="3558968">,</span>&nbsp;<span class="ident" id="3558970">n</span><span class="op" id="3558971">,</span>&nbsp;<span class="ident" id="3558973">cmd</span><span class="op" id="3558976">,</span>&nbsp;<span class="ident" id="3558978">cmd</span><span class="op" id="3558981">.</span><span class="ident" id="3558982">Args</span><span class="op" id="3558986">,</span>&nbsp;<span class="ident" id="3558988">final</span><span class="op" id="3558993">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3558996">case</span>&nbsp;<span class="op" id="3559001">*</span><span class="ident" id="3559002">parse</span><span class="op" id="3559007">.</span><span class="ident" id="3559008">PipeNode</span><span class="op" id="3559016">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3559020">//&nbsp;Parenthesized&nbsp;pipeline.&nbsp;The&nbsp;arguments&nbsp;are&nbsp;all&nbsp;inside&nbsp;the&nbsp;pipeline;&nbsp;final&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559110">return</span>&nbsp;<span class="ident" id="3559117">s</span><span class="op" id="3559118">.</span><span class="ident" id="3559119">evalPipeline</span><span class="op" id="3559131">(</span><span class="ident" id="3559132">dot</span><span class="op" id="3559135">,</span>&nbsp;<span class="ident" id="3559137">n</span><span class="op" id="3559138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559141">case</span>&nbsp;<span class="op" id="3559146">*</span><span class="ident" id="3559147">parse</span><span class="op" id="3559152">.</span><span class="ident" id="3559153">VariableNode</span><span class="op" id="3559165">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559169">return</span>&nbsp;<span class="ident" id="3559176">s</span><span class="op" id="3559177">.</span><span class="ident" id="3559178">evalVariableNode</span><span class="op" id="3559194">(</span><span class="ident" id="3559195">dot</span><span class="op" id="3559198">,</span>&nbsp;<span class="ident" id="3559200">n</span><span class="op" id="3559201">,</span>&nbsp;<span class="ident" id="3559203">cmd</span><span class="op" id="3559206">.</span><span class="ident" id="3559207">Args</span><span class="op" id="3559211">,</span>&nbsp;<span class="ident" id="3559213">final</span><span class="op" id="3559218">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3559221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559224">s</span><span class="op" id="3559225">.</span><span class="ident" id="3559226">at</span><span class="op" id="3559228">(</span><span class="ident" id="3559229">firstWord</span><span class="op" id="3559238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559241">s</span><span class="op" id="3559242">.</span><span class="ident" id="3559243">notAFunction</span><span class="op" id="3559255">(</span><span class="ident" id="3559256">cmd</span><span class="op" id="3559259">.</span><span class="ident" id="3559260">Args</span><span class="op" id="3559264">,</span>&nbsp;<span class="ident" id="3559266">final</span><span class="op" id="3559271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559274">switch</span>&nbsp;<span class="ident" id="3559281">word</span>&nbsp;<span class="op" id="3559286">:=</span>&nbsp;<span class="ident" id="3559289">firstWord</span><span class="op" id="3559298">.</span><span class="op" id="3559299">(</span><span class="keyword" id="3559300">type</span><span class="op" id="3559304">)</span>&nbsp;<span class="op" id="3559306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559309">case</span>&nbsp;<span class="op" id="3559314">*</span><span class="ident" id="3559315">parse</span><span class="op" id="3559320">.</span><span class="ident" id="3559321">BoolNode</span><span class="op" id="3559329">:</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559333">return</span>&nbsp;<span class="ident" id="3559340">reflect</span><span class="op" id="3559347">.</span><span class="ident" id="3559348">ValueOf</span><span class="op" id="3559355">(</span><span class="ident" id="3559356">word</span><span class="op" id="3559360">.</span><span class="ident" id="3559361">True</span><span class="op" id="3559365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559368">case</span>&nbsp;<span class="op" id="3559373">*</span><span class="ident" id="3559374">parse</span><span class="op" id="3559379">.</span><span class="ident" id="3559380">DotNode</span><span class="op" id="3559387">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559391">return</span>&nbsp;<span class="ident" id="3559398">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559403">case</span>&nbsp;<span class="op" id="3559408">*</span><span class="ident" id="3559409">parse</span><span class="op" id="3559414">.</span><span class="ident" id="3559415">NilNode</span><span class="op" id="3559422">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559426">s</span><span class="op" id="3559427">.</span><span class="ident" id="3559428">errorf</span><span class="op" id="3559434">(</span><span class="string" id="3559435">&#34;nil&nbsp;is&nbsp;not&nbsp;a&nbsp;command&#34;</span><span class="op" id="3559457">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559460">case</span>&nbsp;<span class="op" id="3559465">*</span><span class="ident" id="3559466">parse</span><span class="op" id="3559471">.</span><span class="ident" id="3559472">NumberNode</span><span class="op" id="3559482">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559486">return</span>&nbsp;<span class="ident" id="3559493">s</span><span class="op" id="3559494">.</span><span class="ident" id="3559495">idealConstant</span><span class="op" id="3559508">(</span><span class="ident" id="3559509">word</span><span class="op" id="3559513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559516">case</span>&nbsp;<span class="op" id="3559521">*</span><span class="ident" id="3559522">parse</span><span class="op" id="3559527">.</span><span class="ident" id="3559528">StringNode</span><span class="op" id="3559538">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3559542">return</span>&nbsp;<span class="ident" id="3559549">reflect</span><span class="op" id="3559556">.</span><span class="ident" id="3559557">ValueOf</span><span class="op" id="3559564">(</span><span class="ident" id="3559565">word</span><span class="op" id="3559569">.</span><span class="ident" id="3559570">Text</span><span class="op" id="3559574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3559577">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3559580">s</span><span class="op" id="3559581">.</span><span class="ident" id="3559582">errorf</span><span class="op" id="3559588">(</span><span class="string" id="3559589">&#34;can&#39;t&nbsp;evaluate&nbsp;command&nbsp;%q&#34;</span><span class="op" id="3559616">,</span>&nbsp;<span class="ident" id="3559618">firstWord</span><span class="op" id="3559627">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3559630">panic</span><span class="op" id="3559635">(</span><span class="string" id="3559636">&#34;not&nbsp;reached&#34;</span><span class="op" id="3559649">)</span><br>
<span class="lineno"></span><span class="op" id="3559651">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3559654">//&nbsp;idealConstant&nbsp;is&nbsp;called&nbsp;to&nbsp;return&nbsp;the&nbsp;value&nbsp;of&nbsp;a&nbsp;number&nbsp;in&nbsp;a&nbsp;context&nbsp;where</span><br>
<span class="lineno">385</span><span class="comment" id="3559732">//&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type.&nbsp;In&nbsp;that&nbsp;case,&nbsp;the&nbsp;syntax&nbsp;of&nbsp;the&nbsp;number&nbsp;tells&nbsp;us</span><br>
<span class="lineno"></span><span class="comment" id="3559807">//&nbsp;its&nbsp;type,&nbsp;and&nbsp;we&nbsp;use&nbsp;Go&nbsp;rules&nbsp;to&nbsp;resolve.&nbsp;&nbsp;Note&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;thing&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3559884">//&nbsp;a&nbsp;uint&nbsp;ideal&nbsp;constant&nbsp;in&nbsp;this&nbsp;situation&nbsp;-&nbsp;the&nbsp;value&nbsp;must&nbsp;be&nbsp;of&nbsp;int&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3559960">func</span>&nbsp;<span class="op" id="3559965">(</span><span class="ident" id="3559966">s</span>&nbsp;<span class="op" id="3559968">*</span><span class="ident" id="3559969">state</span><span class="op" id="3559974">)</span>&nbsp;<span class="ident" id="3559976">idealConstant</span><span class="op" id="3559989">(</span><span class="ident" id="3559990">constant</span>&nbsp;<span class="op" id="3559999">*</span><span class="ident" id="3560000">parse</span><span class="op" id="3560005">.</span><span class="ident" id="3560006">NumberNode</span><span class="op" id="3560016">)</span>&nbsp;<span class="ident" id="3560018">reflect</span><span class="op" id="3560025">.</span><span class="ident" id="3560026">Value</span>&nbsp;<span class="op" id="3560032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3560035">//&nbsp;These&nbsp;are&nbsp;ideal&nbsp;constants&nbsp;but&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3560092">//&nbsp;and&nbsp;we&nbsp;have&nbsp;no&nbsp;context.&nbsp;&nbsp;(If&nbsp;it&nbsp;was&nbsp;a&nbsp;method&nbsp;argument,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3560151">//&nbsp;we&#39;d&nbsp;know&nbsp;what&nbsp;we&nbsp;need.)&nbsp;The&nbsp;syntax&nbsp;guides&nbsp;us&nbsp;to&nbsp;some&nbsp;extent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560217">s</span><span class="op" id="3560218">.</span><span class="ident" id="3560219">at</span><span class="op" id="3560221">(</span><span class="ident" id="3560222">constant</span><span class="op" id="3560230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560233">switch</span>&nbsp;<span class="op" id="3560240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560243">case</span>&nbsp;<span class="ident" id="3560248">constant</span><span class="op" id="3560256">.</span><span class="ident" id="3560257">IsComplex</span><span class="op" id="3560266">:</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560270">return</span>&nbsp;<span class="ident" id="3560277">reflect</span><span class="op" id="3560284">.</span><span class="ident" id="3560285">ValueOf</span><span class="op" id="3560292">(</span><span class="ident" id="3560293">constant</span><span class="op" id="3560301">.</span><span class="ident" id="3560302">Complex128</span><span class="op" id="3560312">)</span>&nbsp;<span class="comment" id="3560314">//&nbsp;incontrovertible.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560336">case</span>&nbsp;<span class="ident" id="3560341">constant</span><span class="op" id="3560349">.</span><span class="ident" id="3560350">IsFloat</span>&nbsp;<span class="op" id="3560358">&amp;&amp;</span>&nbsp;<span class="op" id="3560361">!</span><span class="ident" id="3560362">isHexConstant</span><span class="op" id="3560375">(</span><span class="ident" id="3560376">constant</span><span class="op" id="3560384">.</span><span class="ident" id="3560385">Text</span><span class="op" id="3560389">)</span>&nbsp;<span class="op" id="3560391">&amp;&amp;</span>&nbsp;<span class="ident" id="3560394">strings</span><span class="op" id="3560401">.</span><span class="ident" id="3560402">IndexAny</span><span class="op" id="3560410">(</span><span class="ident" id="3560411">constant</span><span class="op" id="3560419">.</span><span class="ident" id="3560420">Text</span><span class="op" id="3560424">,</span>&nbsp;<span class="string" id="3560426">&#34;.eE&#34;</span><span class="op" id="3560431">)</span>&nbsp;<span class="op" id="3560433">&gt;=</span>&nbsp;<span class="num" id="3560436">0</span><span class="op" id="3560437">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560441">return</span>&nbsp;<span class="ident" id="3560448">reflect</span><span class="op" id="3560455">.</span><span class="ident" id="3560456">ValueOf</span><span class="op" id="3560463">(</span><span class="ident" id="3560464">constant</span><span class="op" id="3560472">.</span><span class="ident" id="3560473">Float64</span><span class="op" id="3560480">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560483">case</span>&nbsp;<span class="ident" id="3560488">constant</span><span class="op" id="3560496">.</span><span class="ident" id="3560497">IsInt</span><span class="op" id="3560502">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560506">n</span>&nbsp;<span class="op" id="3560508">:=</span>&nbsp;<span class="builtintype" id="3560511">int</span><span class="op" id="3560514">(</span><span class="ident" id="3560515">constant</span><span class="op" id="3560523">.</span><span class="ident" id="3560524">Int64</span><span class="op" id="3560529">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560533">if</span>&nbsp;<span class="ident" id="3560536">int64</span><span class="op" id="3560541">(</span><span class="ident" id="3560542">n</span><span class="op" id="3560543">)</span>&nbsp;<span class="op" id="3560545">!=</span>&nbsp;<span class="ident" id="3560548">constant</span><span class="op" id="3560556">.</span><span class="ident" id="3560557">Int64</span>&nbsp;<span class="op" id="3560563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560568">s</span><span class="op" id="3560569">.</span><span class="ident" id="3560570">errorf</span><span class="op" id="3560576">(</span><span class="string" id="3560577">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="3560595">,</span>&nbsp;<span class="ident" id="3560597">constant</span><span class="op" id="3560605">.</span><span class="ident" id="3560606">Text</span><span class="op" id="3560610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3560614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560618">return</span>&nbsp;<span class="ident" id="3560625">reflect</span><span class="op" id="3560632">.</span><span class="ident" id="3560633">ValueOf</span><span class="op" id="3560640">(</span><span class="ident" id="3560641">n</span><span class="op" id="3560642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560645">case</span>&nbsp;<span class="ident" id="3560650">constant</span><span class="op" id="3560658">.</span><span class="ident" id="3560659">IsUint</span><span class="op" id="3560665">:</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560669">s</span><span class="op" id="3560670">.</span><span class="ident" id="3560671">errorf</span><span class="op" id="3560677">(</span><span class="string" id="3560678">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="3560696">,</span>&nbsp;<span class="ident" id="3560698">constant</span><span class="op" id="3560706">.</span><span class="ident" id="3560707">Text</span><span class="op" id="3560711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3560714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560717">return</span>&nbsp;<span class="ident" id="3560724">zero</span><br>
<span class="lineno"></span><span class="op" id="3560729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="3560732">func</span>&nbsp;<span class="ident" id="3560737">isHexConstant</span><span class="op" id="3560750">(</span><span class="ident" id="3560751">s</span>&nbsp;<span class="builtintype" id="3560753">string</span><span class="op" id="3560759">)</span>&nbsp;<span class="builtintype" id="3560761">bool</span>&nbsp;<span class="op" id="3560766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560769">return</span>&nbsp;<span class="builtinfunc" id="3560776">len</span><span class="op" id="3560779">(</span><span class="ident" id="3560780">s</span><span class="op" id="3560781">)</span>&nbsp;<span class="op" id="3560783">&gt;</span>&nbsp;<span class="num" id="3560785">2</span>&nbsp;<span class="op" id="3560787">&amp;&amp;</span>&nbsp;<span class="ident" id="3560790">s</span><span class="op" id="3560791">[</span><span class="num" id="3560792">0</span><span class="op" id="3560793">]</span>&nbsp;<span class="op" id="3560795">==</span>&nbsp;<span class="string" id="3560798">&#39;0&#39;</span>&nbsp;<span class="op" id="3560802">&amp;&amp;</span>&nbsp;<span class="op" id="3560805">(</span><span class="ident" id="3560806">s</span><span class="op" id="3560807">[</span><span class="num" id="3560808">1</span><span class="op" id="3560809">]</span>&nbsp;<span class="op" id="3560811">==</span>&nbsp;<span class="string" id="3560814">&#39;x&#39;</span>&nbsp;<span class="op" id="3560818">||</span>&nbsp;<span class="ident" id="3560821">s</span><span class="op" id="3560822">[</span><span class="num" id="3560823">1</span><span class="op" id="3560824">]</span>&nbsp;<span class="op" id="3560826">==</span>&nbsp;<span class="string" id="3560829">&#39;X&#39;</span><span class="op" id="3560832">)</span><br>
<span class="lineno"></span><span class="op" id="3560834">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3560837">func</span>&nbsp;<span class="op" id="3560842">(</span><span class="ident" id="3560843">s</span>&nbsp;<span class="op" id="3560845">*</span><span class="ident" id="3560846">state</span><span class="op" id="3560851">)</span>&nbsp;<span class="ident" id="3560853">evalFieldNode</span><span class="op" id="3560866">(</span><span class="ident" id="3560867">dot</span>&nbsp;<span class="ident" id="3560871">reflect</span><span class="op" id="3560878">.</span><span class="ident" id="3560879">Value</span><span class="op" id="3560884">,</span>&nbsp;<span class="ident" id="3560886">field</span>&nbsp;<span class="op" id="3560892">*</span><span class="ident" id="3560893">parse</span><span class="op" id="3560898">.</span><span class="ident" id="3560899">FieldNode</span><span class="op" id="3560908">,</span>&nbsp;<span class="ident" id="3560910">args</span>&nbsp;<span class="op" id="3560915">[</span><span class="op" id="3560916">]</span><span class="ident" id="3560917">parse</span><span class="op" id="3560922">.</span><span class="ident" id="3560923">Node</span><span class="op" id="3560927">,</span>&nbsp;<span class="ident" id="3560929">final</span>&nbsp;<span class="ident" id="3560935">reflect</span><span class="op" id="3560942">.</span><span class="ident" id="3560943">Value</span><span class="op" id="3560948">)</span>&nbsp;<span class="ident" id="3560950">reflect</span><span class="op" id="3560957">.</span><span class="ident" id="3560958">Value</span>&nbsp;<span class="op" id="3560964">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3560967">s</span><span class="op" id="3560968">.</span><span class="ident" id="3560969">at</span><span class="op" id="3560971">(</span><span class="ident" id="3560972">field</span><span class="op" id="3560977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3560980">return</span>&nbsp;<span class="ident" id="3560987">s</span><span class="op" id="3560988">.</span><span class="ident" id="3560989">evalFieldChain</span><span class="op" id="3561003">(</span><span class="ident" id="3561004">dot</span><span class="op" id="3561007">,</span>&nbsp;<span class="ident" id="3561009">dot</span><span class="op" id="3561012">,</span>&nbsp;<span class="ident" id="3561014">field</span><span class="op" id="3561019">,</span>&nbsp;<span class="ident" id="3561021">field</span><span class="op" id="3561026">.</span><span class="ident" id="3561027">Ident</span><span class="op" id="3561032">,</span>&nbsp;<span class="ident" id="3561034">args</span><span class="op" id="3561038">,</span>&nbsp;<span class="ident" id="3561040">final</span><span class="op" id="3561045">)</span><br>
<span class="lineno"></span><span class="op" id="3561047">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3561050">func</span>&nbsp;<span class="op" id="3561055">(</span><span class="ident" id="3561056">s</span>&nbsp;<span class="op" id="3561058">*</span><span class="ident" id="3561059">state</span><span class="op" id="3561064">)</span>&nbsp;<span class="ident" id="3561066">evalChainNode</span><span class="op" id="3561079">(</span><span class="ident" id="3561080">dot</span>&nbsp;<span class="ident" id="3561084">reflect</span><span class="op" id="3561091">.</span><span class="ident" id="3561092">Value</span><span class="op" id="3561097">,</span>&nbsp;<span class="ident" id="3561099">chain</span>&nbsp;<span class="op" id="3561105">*</span><span class="ident" id="3561106">parse</span><span class="op" id="3561111">.</span><span class="ident" id="3561112">ChainNode</span><span class="op" id="3561121">,</span>&nbsp;<span class="ident" id="3561123">args</span>&nbsp;<span class="op" id="3561128">[</span><span class="op" id="3561129">]</span><span class="ident" id="3561130">parse</span><span class="op" id="3561135">.</span><span class="ident" id="3561136">Node</span><span class="op" id="3561140">,</span>&nbsp;<span class="ident" id="3561142">final</span>&nbsp;<span class="ident" id="3561148">reflect</span><span class="op" id="3561155">.</span><span class="ident" id="3561156">Value</span><span class="op" id="3561161">)</span>&nbsp;<span class="ident" id="3561163">reflect</span><span class="op" id="3561170">.</span><span class="ident" id="3561171">Value</span>&nbsp;<span class="op" id="3561177">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3561180">s</span><span class="op" id="3561181">.</span><span class="ident" id="3561182">at</span><span class="op" id="3561184">(</span><span class="ident" id="3561185">chain</span><span class="op" id="3561190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3561193">//&nbsp;(pipe).Field1.Field2&nbsp;has&nbsp;pipe&nbsp;as&nbsp;.Node,&nbsp;fields&nbsp;as&nbsp;.Field.&nbsp;Eval&nbsp;the&nbsp;pipeline,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3561291">pipe</span>&nbsp;<span class="op" id="3561296">:=</span>&nbsp;<span class="ident" id="3561299">s</span><span class="op" id="3561300">.</span><span class="ident" id="3561301">evalArg</span><span class="op" id="3561308">(</span><span class="ident" id="3561309">dot</span><span class="op" id="3561312">,</span>&nbsp;<span class="builtintype" id="3561314">nil</span><span class="op" id="3561317">,</span>&nbsp;<span class="ident" id="3561319">chain</span><span class="op" id="3561324">.</span><span class="ident" id="3561325">Node</span><span class="op" id="3561329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3561332">if</span>&nbsp;<span class="builtinfunc" id="3561335">len</span><span class="op" id="3561338">(</span><span class="ident" id="3561339">chain</span><span class="op" id="3561344">.</span><span class="ident" id="3561345">Field</span><span class="op" id="3561350">)</span>&nbsp;<span class="op" id="3561352">==</span>&nbsp;<span class="num" id="3561355">0</span>&nbsp;<span class="op" id="3561357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3561361">s</span><span class="op" id="3561362">.</span><span class="ident" id="3561363">errorf</span><span class="op" id="3561369">(</span><span class="string" id="3561370">&#34;internal&nbsp;error:&nbsp;no&nbsp;fields&nbsp;in&nbsp;evalChainNode&#34;</span><span class="op" id="3561414">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3561417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3561420">return</span>&nbsp;<span class="ident" id="3561427">s</span><span class="op" id="3561428">.</span><span class="ident" id="3561429">evalFieldChain</span><span class="op" id="3561443">(</span><span class="ident" id="3561444">dot</span><span class="op" id="3561447">,</span>&nbsp;<span class="ident" id="3561449">pipe</span><span class="op" id="3561453">,</span>&nbsp;<span class="ident" id="3561455">chain</span><span class="op" id="3561460">,</span>&nbsp;<span class="ident" id="3561462">chain</span><span class="op" id="3561467">.</span><span class="ident" id="3561468">Field</span><span class="op" id="3561473">,</span>&nbsp;<span class="ident" id="3561475">args</span><span class="op" id="3561479">,</span>&nbsp;<span class="ident" id="3561481">final</span><span class="op" id="3561486">)</span><br>
<span class="lineno"></span><span class="op" id="3561488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3561491">func</span>&nbsp;<span class="op" id="3561496">(</span><span class="ident" id="3561497">s</span>&nbsp;<span class="op" id="3561499">*</span><span class="ident" id="3561500">state</span><span class="op" id="3561505">)</span>&nbsp;<span class="ident" id="3561507">evalVariableNode</span><span class="op" id="3561523">(</span><span class="ident" id="3561524">dot</span>&nbsp;<span class="ident" id="3561528">reflect</span><span class="op" id="3561535">.</span><span class="ident" id="3561536">Value</span><span class="op" id="3561541">,</span>&nbsp;<span class="ident" id="3561543">variable</span>&nbsp;<span class="op" id="3561552">*</span><span class="ident" id="3561553">parse</span><span class="op" id="3561558">.</span><span class="ident" id="3561559">VariableNode</span><span class="op" id="3561571">,</span>&nbsp;<span class="ident" id="3561573">args</span>&nbsp;<span class="op" id="3561578">[</span><span class="op" id="3561579">]</span><span class="ident" id="3561580">parse</span><span class="op" id="3561585">.</span><span class="ident" id="3561586">Node</span><span class="op" id="3561590">,</span>&nbsp;<span class="ident" id="3561592">final</span>&nbsp;<span class="ident" id="3561598">reflect</span><span class="op" id="3561605">.</span><span class="ident" id="3561606">Value</span><span class="op" id="3561611">)</span>&nbsp;<span class="ident" id="3561613">reflect</span><span class="op" id="3561620">.</span><span class="ident" id="3561621">Value</span>&nbsp;<span class="op" id="3561627">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3561630">//&nbsp;$x.Field&nbsp;has&nbsp;$x&nbsp;as&nbsp;the&nbsp;first&nbsp;ident,&nbsp;Field&nbsp;as&nbsp;the&nbsp;second.&nbsp;Eval&nbsp;the&nbsp;var,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3561722">s</span><span class="op" id="3561723">.</span><span class="ident" id="3561724">at</span><span class="op" id="3561726">(</span><span class="ident" id="3561727">variable</span><span class="op" id="3561735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3561738">value</span>&nbsp;<span class="op" id="3561744">:=</span>&nbsp;<span class="ident" id="3561747">s</span><span class="op" id="3561748">.</span><span class="ident" id="3561749">varValue</span><span class="op" id="3561757">(</span><span class="ident" id="3561758">variable</span><span class="op" id="3561766">.</span><span class="ident" id="3561767">Ident</span><span class="op" id="3561772">[</span><span class="num" id="3561773">0</span><span class="op" id="3561774">]</span><span class="op" id="3561775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3561778">if</span>&nbsp;<span class="builtinfunc" id="3561781">len</span><span class="op" id="3561784">(</span><span class="ident" id="3561785">variable</span><span class="op" id="3561793">.</span><span class="ident" id="3561794">Ident</span><span class="op" id="3561799">)</span>&nbsp;<span class="op" id="3561801">==</span>&nbsp;<span class="num" id="3561804">1</span>&nbsp;<span class="op" id="3561806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3561810">s</span><span class="op" id="3561811">.</span><span class="ident" id="3561812">notAFunction</span><span class="op" id="3561824">(</span><span class="ident" id="3561825">args</span><span class="op" id="3561829">,</span>&nbsp;<span class="ident" id="3561831">final</span><span class="op" id="3561836">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3561840">return</span>&nbsp;<span class="ident" id="3561847">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3561854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3561857">return</span>&nbsp;<span class="ident" id="3561864">s</span><span class="op" id="3561865">.</span><span class="ident" id="3561866">evalFieldChain</span><span class="op" id="3561880">(</span><span class="ident" id="3561881">dot</span><span class="op" id="3561884">,</span>&nbsp;<span class="ident" id="3561886">value</span><span class="op" id="3561891">,</span>&nbsp;<span class="ident" id="3561893">variable</span><span class="op" id="3561901">,</span>&nbsp;<span class="ident" id="3561903">variable</span><span class="op" id="3561911">.</span><span class="ident" id="3561912">Ident</span><span class="op" id="3561917">[</span><span class="num" id="3561918">1</span><span class="op" id="3561919">:</span><span class="op" id="3561920">]</span><span class="op" id="3561921">,</span>&nbsp;<span class="ident" id="3561923">args</span><span class="op" id="3561927">,</span>&nbsp;<span class="ident" id="3561929">final</span><span class="op" id="3561934">)</span><br>
<span class="lineno"></span><span class="op" id="3561936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="3561939">//&nbsp;evalFieldChain&nbsp;evaluates&nbsp;.X.Y.Z&nbsp;possibly&nbsp;followed&nbsp;by&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="3562006">//&nbsp;dot&nbsp;is&nbsp;the&nbsp;environment&nbsp;in&nbsp;which&nbsp;to&nbsp;evaluate&nbsp;arguments,&nbsp;while</span><br>
<span class="lineno"></span><span class="comment" id="3562070">//&nbsp;receiver&nbsp;is&nbsp;the&nbsp;value&nbsp;being&nbsp;walked&nbsp;along&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="3562125">func</span>&nbsp;<span class="op" id="3562130">(</span><span class="ident" id="3562131">s</span>&nbsp;<span class="op" id="3562133">*</span><span class="ident" id="3562134">state</span><span class="op" id="3562139">)</span>&nbsp;<span class="ident" id="3562141">evalFieldChain</span><span class="op" id="3562155">(</span><span class="ident" id="3562156">dot</span><span class="op" id="3562159">,</span>&nbsp;<span class="ident" id="3562161">receiver</span>&nbsp;<span class="ident" id="3562170">reflect</span><span class="op" id="3562177">.</span><span class="ident" id="3562178">Value</span><span class="op" id="3562183">,</span>&nbsp;<span class="ident" id="3562185">node</span>&nbsp;<span class="ident" id="3562190">parse</span><span class="op" id="3562195">.</span><span class="ident" id="3562196">Node</span><span class="op" id="3562200">,</span>&nbsp;<span class="ident" id="3562202">ident</span>&nbsp;<span class="op" id="3562208">[</span><span class="op" id="3562209">]</span><span class="builtintype" id="3562210">string</span><span class="op" id="3562216">,</span>&nbsp;<span class="ident" id="3562218">args</span>&nbsp;<span class="op" id="3562223">[</span><span class="op" id="3562224">]</span><span class="ident" id="3562225">parse</span><span class="op" id="3562230">.</span><span class="ident" id="3562231">Node</span><span class="op" id="3562235">,</span>&nbsp;<span class="ident" id="3562237">final</span>&nbsp;<span class="ident" id="3562243">reflect</span><span class="op" id="3562250">.</span><span class="ident" id="3562251">Value</span><span class="op" id="3562256">)</span>&nbsp;<span class="ident" id="3562258">reflect</span><span class="op" id="3562265">.</span><span class="ident" id="3562266">Value</span>&nbsp;<span class="op" id="3562272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3562275">n</span>&nbsp;<span class="op" id="3562277">:=</span>&nbsp;<span class="builtinfunc" id="3562280">len</span><span class="op" id="3562283">(</span><span class="ident" id="3562284">ident</span><span class="op" id="3562289">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3562292">for</span>&nbsp;<span class="ident" id="3562296">i</span>&nbsp;<span class="op" id="3562298">:=</span>&nbsp;<span class="num" id="3562301">0</span><span class="op" id="3562302">;</span>&nbsp;<span class="ident" id="3562304">i</span>&nbsp;<span class="op" id="3562306">&lt;</span>&nbsp;<span class="ident" id="3562308">n</span><span class="op" id="3562309">-</span><span class="num" id="3562310">1</span><span class="op" id="3562311">;</span>&nbsp;<span class="ident" id="3562313">i</span><span class="op" id="3562314">++</span>&nbsp;<span class="op" id="3562317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3562321">receiver</span>&nbsp;<span class="op" id="3562330">=</span>&nbsp;<span class="ident" id="3562332">s</span><span class="op" id="3562333">.</span><span class="ident" id="3562334">evalField</span><span class="op" id="3562343">(</span><span class="ident" id="3562344">dot</span><span class="op" id="3562347">,</span>&nbsp;<span class="ident" id="3562349">ident</span><span class="op" id="3562354">[</span><span class="ident" id="3562355">i</span><span class="op" id="3562356">]</span><span class="op" id="3562357">,</span>&nbsp;<span class="ident" id="3562359">node</span><span class="op" id="3562363">,</span>&nbsp;<span class="builtintype" id="3562365">nil</span><span class="op" id="3562368">,</span>&nbsp;<span class="ident" id="3562370">zero</span><span class="op" id="3562374">,</span>&nbsp;<span class="ident" id="3562376">receiver</span><span class="op" id="3562384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3562387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3562390">//&nbsp;Now&nbsp;if&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;it&nbsp;gets&nbsp;the&nbsp;arguments.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3562439">return</span>&nbsp;<span class="ident" id="3562446">s</span><span class="op" id="3562447">.</span><span class="ident" id="3562448">evalField</span><span class="op" id="3562457">(</span><span class="ident" id="3562458">dot</span><span class="op" id="3562461">,</span>&nbsp;<span class="ident" id="3562463">ident</span><span class="op" id="3562468">[</span><span class="ident" id="3562469">n</span><span class="op" id="3562470">-</span><span class="num" id="3562471">1</span><span class="op" id="3562472">]</span><span class="op" id="3562473">,</span>&nbsp;<span class="ident" id="3562475">node</span><span class="op" id="3562479">,</span>&nbsp;<span class="ident" id="3562481">args</span><span class="op" id="3562485">,</span>&nbsp;<span class="ident" id="3562487">final</span><span class="op" id="3562492">,</span>&nbsp;<span class="ident" id="3562494">receiver</span><span class="op" id="3562502">)</span><br>
<span class="lineno">450</span><span class="op" id="3562504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3562507">func</span>&nbsp;<span class="op" id="3562512">(</span><span class="ident" id="3562513">s</span>&nbsp;<span class="op" id="3562515">*</span><span class="ident" id="3562516">state</span><span class="op" id="3562521">)</span>&nbsp;<span class="ident" id="3562523">evalFunction</span><span class="op" id="3562535">(</span><span class="ident" id="3562536">dot</span>&nbsp;<span class="ident" id="3562540">reflect</span><span class="op" id="3562547">.</span><span class="ident" id="3562548">Value</span><span class="op" id="3562553">,</span>&nbsp;<span class="ident" id="3562555">node</span>&nbsp;<span class="op" id="3562560">*</span><span class="ident" id="3562561">parse</span><span class="op" id="3562566">.</span><span class="ident" id="3562567">IdentifierNode</span><span class="op" id="3562581">,</span>&nbsp;<span class="ident" id="3562583">cmd</span>&nbsp;<span class="ident" id="3562587">parse</span><span class="op" id="3562592">.</span><span class="ident" id="3562593">Node</span><span class="op" id="3562597">,</span>&nbsp;<span class="ident" id="3562599">args</span>&nbsp;<span class="op" id="3562604">[</span><span class="op" id="3562605">]</span><span class="ident" id="3562606">parse</span><span class="op" id="3562611">.</span><span class="ident" id="3562612">Node</span><span class="op" id="3562616">,</span>&nbsp;<span class="ident" id="3562618">final</span>&nbsp;<span class="ident" id="3562624">reflect</span><span class="op" id="3562631">.</span><span class="ident" id="3562632">Value</span><span class="op" id="3562637">)</span>&nbsp;<span class="ident" id="3562639">reflect</span><span class="op" id="3562646">.</span><span class="ident" id="3562647">Value</span>&nbsp;<span class="op" id="3562653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3562656">s</span><span class="op" id="3562657">.</span><span class="ident" id="3562658">at</span><span class="op" id="3562660">(</span><span class="ident" id="3562661">node</span><span class="op" id="3562665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3562668">name</span>&nbsp;<span class="op" id="3562673">:=</span>&nbsp;<span class="ident" id="3562676">node</span><span class="op" id="3562680">.</span><span class="ident" id="3562681">Ident</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3562688">function</span><span class="op" id="3562696">,</span>&nbsp;<span class="ident" id="3562698">ok</span>&nbsp;<span class="op" id="3562701">:=</span>&nbsp;<span class="ident" id="3562704">findFunction</span><span class="op" id="3562716">(</span><span class="ident" id="3562717">name</span><span class="op" id="3562721">,</span>&nbsp;<span class="ident" id="3562723">s</span><span class="op" id="3562724">.</span><span class="ident" id="3562725">tmpl</span><span class="op" id="3562729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3562732">if</span>&nbsp;<span class="op" id="3562735">!</span><span class="ident" id="3562736">ok</span>&nbsp;<span class="op" id="3562739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3562743">s</span><span class="op" id="3562744">.</span><span class="ident" id="3562745">errorf</span><span class="op" id="3562751">(</span><span class="string" id="3562752">&#34;%q&nbsp;is&nbsp;not&nbsp;a&nbsp;defined&nbsp;function&#34;</span><span class="op" id="3562782">,</span>&nbsp;<span class="ident" id="3562784">name</span><span class="op" id="3562788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3562791">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3562794">return</span>&nbsp;<span class="ident" id="3562801">s</span><span class="op" id="3562802">.</span><span class="ident" id="3562803">evalCall</span><span class="op" id="3562811">(</span><span class="ident" id="3562812">dot</span><span class="op" id="3562815">,</span>&nbsp;<span class="ident" id="3562817">function</span><span class="op" id="3562825">,</span>&nbsp;<span class="ident" id="3562827">cmd</span><span class="op" id="3562830">,</span>&nbsp;<span class="ident" id="3562832">name</span><span class="op" id="3562836">,</span>&nbsp;<span class="ident" id="3562838">args</span><span class="op" id="3562842">,</span>&nbsp;<span class="ident" id="3562844">final</span><span class="op" id="3562849">)</span><br>
<span class="lineno">460</span><span class="op" id="3562851">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3562854">//&nbsp;evalField&nbsp;evaluates&nbsp;an&nbsp;expression&nbsp;like&nbsp;(.Field)&nbsp;or&nbsp;(.Field&nbsp;arg1&nbsp;arg2).</span><br>
<span class="lineno"></span><span class="comment" id="3562928">//&nbsp;The&nbsp;&#39;final&#39;&nbsp;argument&nbsp;represents&nbsp;the&nbsp;return&nbsp;value&nbsp;from&nbsp;the&nbsp;preceding</span><br>
<span class="lineno"></span><span class="comment" id="3562999">//&nbsp;value&nbsp;of&nbsp;the&nbsp;pipeline,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">465</span><span class="keyword" id="3563033">func</span>&nbsp;<span class="op" id="3563038">(</span><span class="ident" id="3563039">s</span>&nbsp;<span class="op" id="3563041">*</span><span class="ident" id="3563042">state</span><span class="op" id="3563047">)</span>&nbsp;<span class="ident" id="3563049">evalField</span><span class="op" id="3563058">(</span><span class="ident" id="3563059">dot</span>&nbsp;<span class="ident" id="3563063">reflect</span><span class="op" id="3563070">.</span><span class="ident" id="3563071">Value</span><span class="op" id="3563076">,</span>&nbsp;<span class="ident" id="3563078">fieldName</span>&nbsp;<span class="builtintype" id="3563088">string</span><span class="op" id="3563094">,</span>&nbsp;<span class="ident" id="3563096">node</span>&nbsp;<span class="ident" id="3563101">parse</span><span class="op" id="3563106">.</span><span class="ident" id="3563107">Node</span><span class="op" id="3563111">,</span>&nbsp;<span class="ident" id="3563113">args</span>&nbsp;<span class="op" id="3563118">[</span><span class="op" id="3563119">]</span><span class="ident" id="3563120">parse</span><span class="op" id="3563125">.</span><span class="ident" id="3563126">Node</span><span class="op" id="3563130">,</span>&nbsp;<span class="ident" id="3563132">final</span><span class="op" id="3563137">,</span>&nbsp;<span class="ident" id="3563139">receiver</span>&nbsp;<span class="ident" id="3563148">reflect</span><span class="op" id="3563155">.</span><span class="ident" id="3563156">Value</span><span class="op" id="3563161">)</span>&nbsp;<span class="ident" id="3563163">reflect</span><span class="op" id="3563170">.</span><span class="ident" id="3563171">Value</span>&nbsp;<span class="op" id="3563177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563180">if</span>&nbsp;<span class="op" id="3563183">!</span><span class="ident" id="3563184">receiver</span><span class="op" id="3563192">.</span><span class="ident" id="3563193">IsValid</span><span class="op" id="3563200">(</span><span class="op" id="3563201">)</span>&nbsp;<span class="op" id="3563203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563207">return</span>&nbsp;<span class="ident" id="3563214">zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3563220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3563223">typ</span>&nbsp;<span class="op" id="3563227">:=</span>&nbsp;<span class="ident" id="3563230">receiver</span><span class="op" id="3563238">.</span><span class="ident" id="3563239">Type</span><span class="op" id="3563243">(</span><span class="op" id="3563244">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3563247">receiver</span><span class="op" id="3563255">,</span>&nbsp;<span class="ident" id="3563257">_</span>&nbsp;<span class="op" id="3563259">=</span>&nbsp;<span class="ident" id="3563261">indirect</span><span class="op" id="3563269">(</span><span class="ident" id="3563270">receiver</span><span class="op" id="3563278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3563281">//&nbsp;Unless&nbsp;it&#39;s&nbsp;an&nbsp;interface,&nbsp;need&nbsp;to&nbsp;get&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;*T&nbsp;to&nbsp;guarantee</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3563358">//&nbsp;we&nbsp;see&nbsp;all&nbsp;methods&nbsp;of&nbsp;T&nbsp;and&nbsp;*T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3563394">ptr</span>&nbsp;<span class="op" id="3563398">:=</span>&nbsp;<span class="ident" id="3563401">receiver</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563411">if</span>&nbsp;<span class="ident" id="3563414">ptr</span><span class="op" id="3563417">.</span><span class="ident" id="3563418">Kind</span><span class="op" id="3563422">(</span><span class="op" id="3563423">)</span>&nbsp;<span class="op" id="3563425">!=</span>&nbsp;<span class="ident" id="3563428">reflect</span><span class="op" id="3563435">.</span><span class="ident" id="3563436">Interface</span>&nbsp;<span class="op" id="3563446">&amp;&amp;</span>&nbsp;<span class="ident" id="3563449">ptr</span><span class="op" id="3563452">.</span><span class="ident" id="3563453">CanAddr</span><span class="op" id="3563460">(</span><span class="op" id="3563461">)</span>&nbsp;<span class="op" id="3563463">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3563467">ptr</span>&nbsp;<span class="op" id="3563471">=</span>&nbsp;<span class="ident" id="3563473">ptr</span><span class="op" id="3563476">.</span><span class="ident" id="3563477">Addr</span><span class="op" id="3563481">(</span><span class="op" id="3563482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3563485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563488">if</span>&nbsp;<span class="ident" id="3563491">method</span>&nbsp;<span class="op" id="3563498">:=</span>&nbsp;<span class="ident" id="3563501">ptr</span><span class="op" id="3563504">.</span><span class="ident" id="3563505">MethodByName</span><span class="op" id="3563517">(</span><span class="ident" id="3563518">fieldName</span><span class="op" id="3563527">)</span><span class="op" id="3563528">;</span>&nbsp;<span class="ident" id="3563530">method</span><span class="op" id="3563536">.</span><span class="ident" id="3563537">IsValid</span><span class="op" id="3563544">(</span><span class="op" id="3563545">)</span>&nbsp;<span class="op" id="3563547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563551">return</span>&nbsp;<span class="ident" id="3563558">s</span><span class="op" id="3563559">.</span><span class="ident" id="3563560">evalCall</span><span class="op" id="3563568">(</span><span class="ident" id="3563569">dot</span><span class="op" id="3563572">,</span>&nbsp;<span class="ident" id="3563574">method</span><span class="op" id="3563580">,</span>&nbsp;<span class="ident" id="3563582">node</span><span class="op" id="3563586">,</span>&nbsp;<span class="ident" id="3563588">fieldName</span><span class="op" id="3563597">,</span>&nbsp;<span class="ident" id="3563599">args</span><span class="op" id="3563603">,</span>&nbsp;<span class="ident" id="3563605">final</span><span class="op" id="3563610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3563613">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3563616">hasArgs</span>&nbsp;<span class="op" id="3563624">:=</span>&nbsp;<span class="builtinfunc" id="3563627">len</span><span class="op" id="3563630">(</span><span class="ident" id="3563631">args</span><span class="op" id="3563635">)</span>&nbsp;<span class="op" id="3563637">&gt;</span>&nbsp;<span class="num" id="3563639">1</span>&nbsp;<span class="op" id="3563641">||</span>&nbsp;<span class="ident" id="3563644">final</span><span class="op" id="3563649">.</span><span class="ident" id="3563650">IsValid</span><span class="op" id="3563657">(</span><span class="op" id="3563658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3563661">//&nbsp;It&#39;s&nbsp;not&nbsp;a&nbsp;method;&nbsp;must&nbsp;be&nbsp;a&nbsp;field&nbsp;of&nbsp;a&nbsp;struct&nbsp;or&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;map.&nbsp;The&nbsp;receiver&nbsp;must&nbsp;not&nbsp;be&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3563766">receiver</span><span class="op" id="3563774">,</span>&nbsp;<span class="ident" id="3563776">isNil</span>&nbsp;<span class="op" id="3563782">:=</span>&nbsp;<span class="ident" id="3563785">indirect</span><span class="op" id="3563793">(</span><span class="ident" id="3563794">receiver</span><span class="op" id="3563802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563805">if</span>&nbsp;<span class="ident" id="3563808">isNil</span>&nbsp;<span class="op" id="3563814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3563818">s</span><span class="op" id="3563819">.</span><span class="ident" id="3563820">errorf</span><span class="op" id="3563826">(</span><span class="string" id="3563827">&#34;nil&nbsp;pointer&nbsp;evaluating&nbsp;%s.%s&#34;</span><span class="op" id="3563857">,</span>&nbsp;<span class="ident" id="3563859">typ</span><span class="op" id="3563862">,</span>&nbsp;<span class="ident" id="3563864">fieldName</span><span class="op" id="3563873">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3563876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563879">switch</span>&nbsp;<span class="ident" id="3563886">receiver</span><span class="op" id="3563894">.</span><span class="ident" id="3563895">Kind</span><span class="op" id="3563899">(</span><span class="op" id="3563900">)</span>&nbsp;<span class="op" id="3563902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563905">case</span>&nbsp;<span class="ident" id="3563910">reflect</span><span class="op" id="3563917">.</span><span class="ident" id="3563918">Struct</span><span class="op" id="3563924">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3563928">tField</span><span class="op" id="3563934">,</span>&nbsp;<span class="ident" id="3563936">ok</span>&nbsp;<span class="op" id="3563939">:=</span>&nbsp;<span class="ident" id="3563942">receiver</span><span class="op" id="3563950">.</span><span class="ident" id="3563951">Type</span><span class="op" id="3563955">(</span><span class="op" id="3563956">)</span><span class="op" id="3563957">.</span><span class="ident" id="3563958">FieldByName</span><span class="op" id="3563969">(</span><span class="ident" id="3563970">fieldName</span><span class="op" id="3563979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3563983">if</span>&nbsp;<span class="ident" id="3563986">ok</span>&nbsp;<span class="op" id="3563989">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3563994">field</span>&nbsp;<span class="op" id="3564000">:=</span>&nbsp;<span class="ident" id="3564003">receiver</span><span class="op" id="3564011">.</span><span class="ident" id="3564012">FieldByIndex</span><span class="op" id="3564024">(</span><span class="ident" id="3564025">tField</span><span class="op" id="3564031">.</span><span class="ident" id="3564032">Index</span><span class="op" id="3564037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3564042">if</span>&nbsp;<span class="ident" id="3564045">tField</span><span class="op" id="3564051">.</span><span class="ident" id="3564052">PkgPath</span>&nbsp;<span class="op" id="3564060">!=</span>&nbsp;<span class="string" id="3564063">&#34;&#34;</span>&nbsp;<span class="op" id="3564066">{</span>&nbsp;<span class="comment" id="3564068">//&nbsp;field&nbsp;is&nbsp;unexported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3564095">s</span><span class="op" id="3564096">.</span><span class="ident" id="3564097">errorf</span><span class="op" id="3564103">(</span><span class="string" id="3564104">&#34;%s&nbsp;is&nbsp;an&nbsp;unexported&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3564149">,</span>&nbsp;<span class="ident" id="3564151">fieldName</span><span class="op" id="3564160">,</span>&nbsp;<span class="ident" id="3564162">typ</span><span class="op" id="3564165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3564170">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3564175">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;function,&nbsp;we&nbsp;must&nbsp;call&nbsp;it.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3564218">if</span>&nbsp;<span class="ident" id="3564221">hasArgs</span>&nbsp;<span class="op" id="3564229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3564235">s</span><span class="op" id="3564236">.</span><span class="ident" id="3564237">errorf</span><span class="op" id="3564243">(</span><span class="string" id="3564244">&#34;%s&nbsp;has&nbsp;arguments&nbsp;but&nbsp;cannot&nbsp;be&nbsp;invoked&nbsp;as&nbsp;function&#34;</span><span class="op" id="3564296">,</span>&nbsp;<span class="ident" id="3564298">fieldName</span><span class="op" id="3564307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3564312">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3564317">return</span>&nbsp;<span class="ident" id="3564324">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3564332">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3564336">s</span><span class="op" id="3564337">.</span><span class="ident" id="3564338">errorf</span><span class="op" id="3564344">(</span><span class="string" id="3564345">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3564382">,</span>&nbsp;<span class="ident" id="3564384">fieldName</span><span class="op" id="3564393">,</span>&nbsp;<span class="ident" id="3564395">typ</span><span class="op" id="3564398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3564401">case</span>&nbsp;<span class="ident" id="3564406">reflect</span><span class="op" id="3564413">.</span><span class="ident" id="3564414">Map</span><span class="op" id="3564417">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3564421">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;map,&nbsp;attempt&nbsp;to&nbsp;use&nbsp;the&nbsp;field&nbsp;name&nbsp;as&nbsp;a&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3564481">nameVal</span>&nbsp;<span class="op" id="3564489">:=</span>&nbsp;<span class="ident" id="3564492">reflect</span><span class="op" id="3564499">.</span><span class="ident" id="3564500">ValueOf</span><span class="op" id="3564507">(</span><span class="ident" id="3564508">fieldName</span><span class="op" id="3564517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3564521">if</span>&nbsp;<span class="ident" id="3564524">nameVal</span><span class="op" id="3564531">.</span><span class="ident" id="3564532">Type</span><span class="op" id="3564536">(</span><span class="op" id="3564537">)</span><span class="op" id="3564538">.</span><span class="ident" id="3564539">AssignableTo</span><span class="op" id="3564551">(</span><span class="ident" id="3564552">receiver</span><span class="op" id="3564560">.</span><span class="ident" id="3564561">Type</span><span class="op" id="3564565">(</span><span class="op" id="3564566">)</span><span class="op" id="3564567">.</span><span class="ident" id="3564568">Key</span><span class="op" id="3564571">(</span><span class="op" id="3564572">)</span><span class="op" id="3564573">)</span>&nbsp;<span class="op" id="3564575">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3564580">if</span>&nbsp;<span class="ident" id="3564583">hasArgs</span>&nbsp;<span class="op" id="3564591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3564597">s</span><span class="op" id="3564598">.</span><span class="ident" id="3564599">errorf</span><span class="op" id="3564605">(</span><span class="string" id="3564606">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;method&nbsp;but&nbsp;has&nbsp;arguments&#34;</span><span class="op" id="3564644">,</span>&nbsp;<span class="ident" id="3564646">fieldName</span><span class="op" id="3564655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3564660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3564665">return</span>&nbsp;<span class="ident" id="3564672">receiver</span><span class="op" id="3564680">.</span><span class="ident" id="3564681">MapIndex</span><span class="op" id="3564689">(</span><span class="ident" id="3564690">nameVal</span><span class="op" id="3564697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3564701">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3564704">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3564707">s</span><span class="op" id="3564708">.</span><span class="ident" id="3564709">errorf</span><span class="op" id="3564715">(</span><span class="string" id="3564716">&#34;can&#39;t&nbsp;evaluate&nbsp;field&nbsp;%s&nbsp;in&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3564752">,</span>&nbsp;<span class="ident" id="3564754">fieldName</span><span class="op" id="3564763">,</span>&nbsp;<span class="ident" id="3564765">typ</span><span class="op" id="3564768">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3564771">panic</span><span class="op" id="3564776">(</span><span class="string" id="3564777">&#34;not&nbsp;reached&#34;</span><span class="op" id="3564790">)</span><br>
<span class="lineno"></span><span class="op" id="3564792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="3564795">var</span>&nbsp;<span class="op" id="3564799">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3564802">errorType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3564818">=</span>&nbsp;<span class="ident" id="3564820">reflect</span><span class="op" id="3564827">.</span><span class="ident" id="3564828">TypeOf</span><span class="op" id="3564834">(</span><span class="op" id="3564835">(</span><span class="op" id="3564836">*</span><span class="builtintype" id="3564837">error</span><span class="op" id="3564842">)</span><span class="op" id="3564843">(</span><span class="builtintype" id="3564844">nil</span><span class="op" id="3564847">)</span><span class="op" id="3564848">)</span><span class="op" id="3564849">.</span><span class="ident" id="3564850">Elem</span><span class="op" id="3564854">(</span><span class="op" id="3564855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3564858">fmtStringerType</span>&nbsp;<span class="op" id="3564874">=</span>&nbsp;<span class="ident" id="3564876">reflect</span><span class="op" id="3564883">.</span><span class="ident" id="3564884">TypeOf</span><span class="op" id="3564890">(</span><span class="op" id="3564891">(</span><span class="op" id="3564892">*</span><span class="ident" id="3564893">fmt</span><span class="op" id="3564896">.</span><span class="ident" id="3564897">Stringer</span><span class="op" id="3564905">)</span><span class="op" id="3564906">(</span><span class="builtintype" id="3564907">nil</span><span class="op" id="3564910">)</span><span class="op" id="3564911">)</span><span class="op" id="3564912">.</span><span class="ident" id="3564913">Elem</span><span class="op" id="3564917">(</span><span class="op" id="3564918">)</span><br>
<span class="lineno"></span><span class="op" id="3564920">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="comment" id="3564923">//&nbsp;evalCall&nbsp;executes&nbsp;a&nbsp;function&nbsp;or&nbsp;method&nbsp;call.&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;fun&nbsp;already&nbsp;has&nbsp;the&nbsp;receiver&nbsp;bound,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="3565028">//&nbsp;it&nbsp;looks&nbsp;just&nbsp;like&nbsp;a&nbsp;function&nbsp;call.&nbsp;&nbsp;The&nbsp;arg&nbsp;list,&nbsp;if&nbsp;non-nil,&nbsp;includes&nbsp;(in&nbsp;the&nbsp;manner&nbsp;of&nbsp;the&nbsp;shell),&nbsp;arg[0]</span><br>
<span class="lineno"></span><span class="comment" id="3565140">//&nbsp;as&nbsp;the&nbsp;function&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="3565167">func</span>&nbsp;<span class="op" id="3565172">(</span><span class="ident" id="3565173">s</span>&nbsp;<span class="op" id="3565175">*</span><span class="ident" id="3565176">state</span><span class="op" id="3565181">)</span>&nbsp;<span class="ident" id="3565183">evalCall</span><span class="op" id="3565191">(</span><span class="ident" id="3565192">dot</span><span class="op" id="3565195">,</span>&nbsp;<span class="ident" id="3565197">fun</span>&nbsp;<span class="ident" id="3565201">reflect</span><span class="op" id="3565208">.</span><span class="ident" id="3565209">Value</span><span class="op" id="3565214">,</span>&nbsp;<span class="ident" id="3565216">node</span>&nbsp;<span class="ident" id="3565221">parse</span><span class="op" id="3565226">.</span><span class="ident" id="3565227">Node</span><span class="op" id="3565231">,</span>&nbsp;<span class="ident" id="3565233">name</span>&nbsp;<span class="builtintype" id="3565238">string</span><span class="op" id="3565244">,</span>&nbsp;<span class="ident" id="3565246">args</span>&nbsp;<span class="op" id="3565251">[</span><span class="op" id="3565252">]</span><span class="ident" id="3565253">parse</span><span class="op" id="3565258">.</span><span class="ident" id="3565259">Node</span><span class="op" id="3565263">,</span>&nbsp;<span class="ident" id="3565265">final</span>&nbsp;<span class="ident" id="3565271">reflect</span><span class="op" id="3565278">.</span><span class="ident" id="3565279">Value</span><span class="op" id="3565284">)</span>&nbsp;<span class="ident" id="3565286">reflect</span><span class="op" id="3565293">.</span><span class="ident" id="3565294">Value</span>&nbsp;<span class="op" id="3565300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3565303">if</span>&nbsp;<span class="ident" id="3565306">args</span>&nbsp;<span class="op" id="3565311">!=</span>&nbsp;<span class="builtintype" id="3565314">nil</span>&nbsp;<span class="op" id="3565318">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3565322">args</span>&nbsp;<span class="op" id="3565327">=</span>&nbsp;<span class="ident" id="3565329">args</span><span class="op" id="3565333">[</span><span class="num" id="3565334">1</span><span class="op" id="3565335">:</span><span class="op" id="3565336">]</span>&nbsp;<span class="comment" id="3565338">//&nbsp;Zeroth&nbsp;arg&nbsp;is&nbsp;function&nbsp;name/node;&nbsp;not&nbsp;passed&nbsp;to&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3565400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3565403">typ</span>&nbsp;<span class="op" id="3565407">:=</span>&nbsp;<span class="ident" id="3565410">fun</span><span class="op" id="3565413">.</span><span class="ident" id="3565414">Type</span><span class="op" id="3565418">(</span><span class="op" id="3565419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3565422">numIn</span>&nbsp;<span class="op" id="3565428">:=</span>&nbsp;<span class="builtinfunc" id="3565431">len</span><span class="op" id="3565434">(</span><span class="ident" id="3565435">args</span><span class="op" id="3565439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3565442">if</span>&nbsp;<span class="ident" id="3565445">final</span><span class="op" id="3565450">.</span><span class="ident" id="3565451">IsValid</span><span class="op" id="3565458">(</span><span class="op" id="3565459">)</span>&nbsp;<span class="op" id="3565461">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3565465">numIn</span><span class="op" id="3565470">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3565474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3565477">numFixed</span>&nbsp;<span class="op" id="3565486">:=</span>&nbsp;<span class="builtinfunc" id="3565489">len</span><span class="op" id="3565492">(</span><span class="ident" id="3565493">args</span><span class="op" id="3565497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3565500">if</span>&nbsp;<span class="ident" id="3565503">typ</span><span class="op" id="3565506">.</span><span class="ident" id="3565507">IsVariadic</span><span class="op" id="3565517">(</span><span class="op" id="3565518">)</span>&nbsp;<span class="op" id="3565520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3565524">numFixed</span>&nbsp;<span class="op" id="3565533">=</span>&nbsp;<span class="ident" id="3565535">typ</span><span class="op" id="3565538">.</span><span class="ident" id="3565539">NumIn</span><span class="op" id="3565544">(</span><span class="op" id="3565545">)</span>&nbsp;<span class="op" id="3565547">-</span>&nbsp;<span class="num" id="3565549">1</span>&nbsp;<span class="comment" id="3565551">//&nbsp;last&nbsp;arg&nbsp;is&nbsp;the&nbsp;variadic&nbsp;one.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3565586">if</span>&nbsp;<span class="ident" id="3565589">numIn</span>&nbsp;<span class="op" id="3565595">&lt;</span>&nbsp;<span class="ident" id="3565597">numFixed</span>&nbsp;<span class="op" id="3565606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3565611">s</span><span class="op" id="3565612">.</span><span class="ident" id="3565613">errorf</span><span class="op" id="3565619">(</span><span class="string" id="3565620">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;at&nbsp;least&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="3565674">,</span>&nbsp;<span class="ident" id="3565676">name</span><span class="op" id="3565680">,</span>&nbsp;<span class="ident" id="3565682">typ</span><span class="op" id="3565685">.</span><span class="ident" id="3565686">NumIn</span><span class="op" id="3565691">(</span><span class="op" id="3565692">)</span><span class="op" id="3565693">-</span><span class="num" id="3565694">1</span><span class="op" id="3565695">,</span>&nbsp;<span class="builtinfunc" id="3565697">len</span><span class="op" id="3565700">(</span><span class="ident" id="3565701">args</span><span class="op" id="3565705">)</span><span class="op" id="3565706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3565710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3565713">}</span>&nbsp;<span class="keyword" id="3565715">else</span>&nbsp;<span class="keyword" id="3565720">if</span>&nbsp;<span class="ident" id="3565723">numIn</span>&nbsp;<span class="op" id="3565729">&lt;</span>&nbsp;<span class="ident" id="3565731">typ</span><span class="op" id="3565734">.</span><span class="ident" id="3565735">NumIn</span><span class="op" id="3565740">(</span><span class="op" id="3565741">)</span><span class="op" id="3565742">-</span><span class="num" id="3565743">1</span>&nbsp;<span class="op" id="3565745">||</span>&nbsp;<span class="op" id="3565748">!</span><span class="ident" id="3565749">typ</span><span class="op" id="3565752">.</span><span class="ident" id="3565753">IsVariadic</span><span class="op" id="3565763">(</span><span class="op" id="3565764">)</span>&nbsp;<span class="op" id="3565766">&amp;&amp;</span>&nbsp;<span class="ident" id="3565769">numIn</span>&nbsp;<span class="op" id="3565775">!=</span>&nbsp;<span class="ident" id="3565778">typ</span><span class="op" id="3565781">.</span><span class="ident" id="3565782">NumIn</span><span class="op" id="3565787">(</span><span class="op" id="3565788">)</span>&nbsp;<span class="op" id="3565790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3565794">s</span><span class="op" id="3565795">.</span><span class="ident" id="3565796">errorf</span><span class="op" id="3565802">(</span><span class="string" id="3565803">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="3565848">,</span>&nbsp;<span class="ident" id="3565850">name</span><span class="op" id="3565854">,</span>&nbsp;<span class="ident" id="3565856">typ</span><span class="op" id="3565859">.</span><span class="ident" id="3565860">NumIn</span><span class="op" id="3565865">(</span><span class="op" id="3565866">)</span><span class="op" id="3565867">,</span>&nbsp;<span class="builtinfunc" id="3565869">len</span><span class="op" id="3565872">(</span><span class="ident" id="3565873">args</span><span class="op" id="3565877">)</span><span class="op" id="3565878">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3565881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3565884">if</span>&nbsp;<span class="op" id="3565887">!</span><span class="ident" id="3565888">goodFunc</span><span class="op" id="3565896">(</span><span class="ident" id="3565897">typ</span><span class="op" id="3565900">)</span>&nbsp;<span class="op" id="3565902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3565906">//&nbsp;TODO:&nbsp;This&nbsp;could&nbsp;still&nbsp;be&nbsp;a&nbsp;confusing&nbsp;error;&nbsp;maybe&nbsp;goodFunc&nbsp;should&nbsp;provide&nbsp;info.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3565992">s</span><span class="op" id="3565993">.</span><span class="ident" id="3565994">errorf</span><span class="op" id="3566000">(</span><span class="string" id="3566001">&#34;can&#39;t&nbsp;call&nbsp;method/function&nbsp;%q&nbsp;with&nbsp;%d&nbsp;results&#34;</span><span class="op" id="3566048">,</span>&nbsp;<span class="ident" id="3566050">name</span><span class="op" id="3566054">,</span>&nbsp;<span class="ident" id="3566056">typ</span><span class="op" id="3566059">.</span><span class="ident" id="3566060">NumOut</span><span class="op" id="3566066">(</span><span class="op" id="3566067">)</span><span class="op" id="3566068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3566071">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3566074">//&nbsp;Build&nbsp;the&nbsp;arg&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3566098">argv</span>&nbsp;<span class="op" id="3566103">:=</span>&nbsp;<span class="builtinfunc" id="3566106">make</span><span class="op" id="3566110">(</span><span class="op" id="3566111">[</span><span class="op" id="3566112">]</span><span class="ident" id="3566113">reflect</span><span class="op" id="3566120">.</span><span class="ident" id="3566121">Value</span><span class="op" id="3566126">,</span>&nbsp;<span class="ident" id="3566128">numIn</span><span class="op" id="3566133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3566136">//&nbsp;Args&nbsp;must&nbsp;be&nbsp;evaluated.&nbsp;Fixed&nbsp;args&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3566182">i</span>&nbsp;<span class="op" id="3566184">:=</span>&nbsp;<span class="num" id="3566187">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3566190">for</span>&nbsp;<span class="op" id="3566194">;</span>&nbsp;<span class="ident" id="3566196">i</span>&nbsp;<span class="op" id="3566198">&lt;</span>&nbsp;<span class="ident" id="3566200">numFixed</span>&nbsp;<span class="op" id="3566209">&amp;&amp;</span>&nbsp;<span class="ident" id="3566212">i</span>&nbsp;<span class="op" id="3566214">&lt;</span>&nbsp;<span class="builtinfunc" id="3566216">len</span><span class="op" id="3566219">(</span><span class="ident" id="3566220">args</span><span class="op" id="3566224">)</span><span class="op" id="3566225">;</span>&nbsp;<span class="ident" id="3566227">i</span><span class="op" id="3566228">++</span>&nbsp;<span class="op" id="3566231">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3566235">argv</span><span class="op" id="3566239">[</span><span class="ident" id="3566240">i</span><span class="op" id="3566241">]</span>&nbsp;<span class="op" id="3566243">=</span>&nbsp;<span class="ident" id="3566245">s</span><span class="op" id="3566246">.</span><span class="ident" id="3566247">evalArg</span><span class="op" id="3566254">(</span><span class="ident" id="3566255">dot</span><span class="op" id="3566258">,</span>&nbsp;<span class="ident" id="3566260">typ</span><span class="op" id="3566263">.</span><span class="ident" id="3566264">In</span><span class="op" id="3566266">(</span><span class="ident" id="3566267">i</span><span class="op" id="3566268">)</span><span class="op" id="3566269">,</span>&nbsp;<span class="ident" id="3566271">args</span><span class="op" id="3566275">[</span><span class="ident" id="3566276">i</span><span class="op" id="3566277">]</span><span class="op" id="3566278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3566281">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3566284">//&nbsp;Now&nbsp;the&nbsp;...&nbsp;args.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3566306">if</span>&nbsp;<span class="ident" id="3566309">typ</span><span class="op" id="3566312">.</span><span class="ident" id="3566313">IsVariadic</span><span class="op" id="3566323">(</span><span class="op" id="3566324">)</span>&nbsp;<span class="op" id="3566326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3566330">argType</span>&nbsp;<span class="op" id="3566338">:=</span>&nbsp;<span class="ident" id="3566341">typ</span><span class="op" id="3566344">.</span><span class="ident" id="3566345">In</span><span class="op" id="3566347">(</span><span class="ident" id="3566348">typ</span><span class="op" id="3566351">.</span><span class="ident" id="3566352">NumIn</span><span class="op" id="3566357">(</span><span class="op" id="3566358">)</span>&nbsp;<span class="op" id="3566360">-</span>&nbsp;<span class="num" id="3566362">1</span><span class="op" id="3566363">)</span><span class="op" id="3566364">.</span><span class="ident" id="3566365">Elem</span><span class="op" id="3566369">(</span><span class="op" id="3566370">)</span>&nbsp;<span class="comment" id="3566372">//&nbsp;Argument&nbsp;is&nbsp;a&nbsp;slice.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3566398">for</span>&nbsp;<span class="op" id="3566402">;</span>&nbsp;<span class="ident" id="3566404">i</span>&nbsp;<span class="op" id="3566406">&lt;</span>&nbsp;<span class="builtinfunc" id="3566408">len</span><span class="op" id="3566411">(</span><span class="ident" id="3566412">args</span><span class="op" id="3566416">)</span><span class="op" id="3566417">;</span>&nbsp;<span class="ident" id="3566419">i</span><span class="op" id="3566420">++</span>&nbsp;<span class="op" id="3566423">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3566428">argv</span><span class="op" id="3566432">[</span><span class="ident" id="3566433">i</span><span class="op" id="3566434">]</span>&nbsp;<span class="op" id="3566436">=</span>&nbsp;<span class="ident" id="3566438">s</span><span class="op" id="3566439">.</span><span class="ident" id="3566440">evalArg</span><span class="op" id="3566447">(</span><span class="ident" id="3566448">dot</span><span class="op" id="3566451">,</span>&nbsp;<span class="ident" id="3566453">argType</span><span class="op" id="3566460">,</span>&nbsp;<span class="ident" id="3566462">args</span><span class="op" id="3566466">[</span><span class="ident" id="3566467">i</span><span class="op" id="3566468">]</span><span class="op" id="3566469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3566473">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3566476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3566479">//&nbsp;Add&nbsp;final&nbsp;value&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3566513">if</span>&nbsp;<span class="ident" id="3566516">final</span><span class="op" id="3566521">.</span><span class="ident" id="3566522">IsValid</span><span class="op" id="3566529">(</span><span class="op" id="3566530">)</span>&nbsp;<span class="op" id="3566532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3566536">t</span>&nbsp;<span class="op" id="3566538">:=</span>&nbsp;<span class="ident" id="3566541">typ</span><span class="op" id="3566544">.</span><span class="ident" id="3566545">In</span><span class="op" id="3566547">(</span><span class="ident" id="3566548">typ</span><span class="op" id="3566551">.</span><span class="ident" id="3566552">NumIn</span><span class="op" id="3566557">(</span><span class="op" id="3566558">)</span>&nbsp;<span class="op" id="3566560">-</span>&nbsp;<span class="num" id="3566562">1</span><span class="op" id="3566563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3566567">if</span>&nbsp;<span class="ident" id="3566570">typ</span><span class="op" id="3566573">.</span><span class="ident" id="3566574">IsVariadic</span><span class="op" id="3566584">(</span><span class="op" id="3566585">)</span>&nbsp;<span class="op" id="3566587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3566592">t</span>&nbsp;<span class="op" id="3566594">=</span>&nbsp;<span class="ident" id="3566596">t</span><span class="op" id="3566597">.</span><span class="ident" id="3566598">Elem</span><span class="op" id="3566602">(</span><span class="op" id="3566603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3566607">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3566611">argv</span><span class="op" id="3566615">[</span><span class="ident" id="3566616">i</span><span class="op" id="3566617">]</span>&nbsp;<span class="op" id="3566619">=</span>&nbsp;<span class="ident" id="3566621">s</span><span class="op" id="3566622">.</span><span class="ident" id="3566623">validateType</span><span class="op" id="3566635">(</span><span class="ident" id="3566636">final</span><span class="op" id="3566641">,</span>&nbsp;<span class="ident" id="3566643">t</span><span class="op" id="3566644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3566647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3566650">result</span>&nbsp;<span class="op" id="3566657">:=</span>&nbsp;<span class="ident" id="3566660">fun</span><span class="op" id="3566663">.</span><span class="ident" id="3566664">Call</span><span class="op" id="3566668">(</span><span class="ident" id="3566669">argv</span><span class="op" id="3566673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3566676">//&nbsp;If&nbsp;we&nbsp;have&nbsp;an&nbsp;error&nbsp;that&nbsp;is&nbsp;not&nbsp;nil,&nbsp;stop&nbsp;execution&nbsp;and&nbsp;return&nbsp;that&nbsp;error&nbsp;to&nbsp;the&nbsp;caller.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3566769">if</span>&nbsp;<span class="builtinfunc" id="3566772">len</span><span class="op" id="3566775">(</span><span class="ident" id="3566776">result</span><span class="op" id="3566782">)</span>&nbsp;<span class="op" id="3566784">==</span>&nbsp;<span class="num" id="3566787">2</span>&nbsp;<span class="op" id="3566789">&amp;&amp;</span>&nbsp;<span class="op" id="3566792">!</span><span class="ident" id="3566793">result</span><span class="op" id="3566799">[</span><span class="num" id="3566800">1</span><span class="op" id="3566801">]</span><span class="op" id="3566802">.</span><span class="ident" id="3566803">IsNil</span><span class="op" id="3566808">(</span><span class="op" id="3566809">)</span>&nbsp;<span class="op" id="3566811">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3566815">s</span><span class="op" id="3566816">.</span><span class="ident" id="3566817">at</span><span class="op" id="3566819">(</span><span class="ident" id="3566820">node</span><span class="op" id="3566824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3566828">s</span><span class="op" id="3566829">.</span><span class="ident" id="3566830">errorf</span><span class="op" id="3566836">(</span><span class="string" id="3566837">&#34;error&nbsp;calling&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="3566859">,</span>&nbsp;<span class="ident" id="3566861">name</span><span class="op" id="3566865">,</span>&nbsp;<span class="ident" id="3566867">result</span><span class="op" id="3566873">[</span><span class="num" id="3566874">1</span><span class="op" id="3566875">]</span><span class="op" id="3566876">.</span><span class="ident" id="3566877">Interface</span><span class="op" id="3566886">(</span><span class="op" id="3566887">)</span><span class="op" id="3566888">.</span><span class="op" id="3566889">(</span><span class="builtintype" id="3566890">error</span><span class="op" id="3566895">)</span><span class="op" id="3566896">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3566899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3566902">return</span>&nbsp;<span class="ident" id="3566909">result</span><span class="op" id="3566915">[</span><span class="num" id="3566916">0</span><span class="op" id="3566917">]</span><br>
<span class="lineno"></span><span class="op" id="3566919">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="3566922">//&nbsp;canBeNil&nbsp;reports&nbsp;whether&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;can&nbsp;be&nbsp;assigned&nbsp;to&nbsp;the&nbsp;type.&nbsp;See&nbsp;reflect.Zero.</span><br>
<span class="lineno"></span><span class="keyword" id="3567012">func</span>&nbsp;<span class="ident" id="3567017">canBeNil</span><span class="op" id="3567025">(</span><span class="ident" id="3567026">typ</span>&nbsp;<span class="ident" id="3567030">reflect</span><span class="op" id="3567037">.</span><span class="ident" id="3567038">Type</span><span class="op" id="3567042">)</span>&nbsp;<span class="builtintype" id="3567044">bool</span>&nbsp;<span class="op" id="3567049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3567052">switch</span>&nbsp;<span class="ident" id="3567059">typ</span><span class="op" id="3567062">.</span><span class="ident" id="3567063">Kind</span><span class="op" id="3567067">(</span><span class="op" id="3567068">)</span>&nbsp;<span class="op" id="3567070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3567073">case</span>&nbsp;<span class="ident" id="3567078">reflect</span><span class="op" id="3567085">.</span><span class="ident" id="3567086">Chan</span><span class="op" id="3567090">,</span>&nbsp;<span class="ident" id="3567092">reflect</span><span class="op" id="3567099">.</span><span class="ident" id="3567100">Func</span><span class="op" id="3567104">,</span>&nbsp;<span class="ident" id="3567106">reflect</span><span class="op" id="3567113">.</span><span class="ident" id="3567114">Interface</span><span class="op" id="3567123">,</span>&nbsp;<span class="ident" id="3567125">reflect</span><span class="op" id="3567132">.</span><span class="ident" id="3567133">Map</span><span class="op" id="3567136">,</span>&nbsp;<span class="ident" id="3567138">reflect</span><span class="op" id="3567145">.</span><span class="ident" id="3567146">Ptr</span><span class="op" id="3567149">,</span>&nbsp;<span class="ident" id="3567151">reflect</span><span class="op" id="3567158">.</span><span class="ident" id="3567159">Slice</span><span class="op" id="3567164">:</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3567168">return</span>&nbsp;<span class="builtintype" id="3567175">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3567181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3567184">return</span>&nbsp;<span class="builtintype" id="3567191">false</span><br>
<span class="lineno"></span><span class="op" id="3567197">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="comment" id="3567200">//&nbsp;validateType&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;value&nbsp;is&nbsp;valid&nbsp;and&nbsp;assignable&nbsp;to&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="3567279">func</span>&nbsp;<span class="op" id="3567284">(</span><span class="ident" id="3567285">s</span>&nbsp;<span class="op" id="3567287">*</span><span class="ident" id="3567288">state</span><span class="op" id="3567293">)</span>&nbsp;<span class="ident" id="3567295">validateType</span><span class="op" id="3567307">(</span><span class="ident" id="3567308">value</span>&nbsp;<span class="ident" id="3567314">reflect</span><span class="op" id="3567321">.</span><span class="ident" id="3567322">Value</span><span class="op" id="3567327">,</span>&nbsp;<span class="ident" id="3567329">typ</span>&nbsp;<span class="ident" id="3567333">reflect</span><span class="op" id="3567340">.</span><span class="ident" id="3567341">Type</span><span class="op" id="3567345">)</span>&nbsp;<span class="ident" id="3567347">reflect</span><span class="op" id="3567354">.</span><span class="ident" id="3567355">Value</span>&nbsp;<span class="op" id="3567361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3567364">if</span>&nbsp;<span class="op" id="3567367">!</span><span class="ident" id="3567368">value</span><span class="op" id="3567373">.</span><span class="ident" id="3567374">IsValid</span><span class="op" id="3567381">(</span><span class="op" id="3567382">)</span>&nbsp;<span class="op" id="3567384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3567388">if</span>&nbsp;<span class="ident" id="3567391">typ</span>&nbsp;<span class="op" id="3567395">==</span>&nbsp;<span class="builtintype" id="3567398">nil</span>&nbsp;<span class="op" id="3567402">||</span>&nbsp;<span class="ident" id="3567405">canBeNil</span><span class="op" id="3567413">(</span><span class="ident" id="3567414">typ</span><span class="op" id="3567417">)</span>&nbsp;<span class="op" id="3567419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3567424">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;interface{}.&nbsp;Accept&nbsp;as&nbsp;a&nbsp;proper&nbsp;nil&nbsp;value.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3567488">return</span>&nbsp;<span class="ident" id="3567495">reflect</span><span class="op" id="3567502">.</span><span class="ident" id="3567503">Zero</span><span class="op" id="3567507">(</span><span class="ident" id="3567508">typ</span><span class="op" id="3567511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3567515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3567519">s</span><span class="op" id="3567520">.</span><span class="ident" id="3567521">errorf</span><span class="op" id="3567527">(</span><span class="string" id="3567528">&#34;invalid&nbsp;value;&nbsp;expected&nbsp;%s&#34;</span><span class="op" id="3567556">,</span>&nbsp;<span class="ident" id="3567558">typ</span><span class="op" id="3567561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3567564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3567567">if</span>&nbsp;<span class="ident" id="3567570">typ</span>&nbsp;<span class="op" id="3567574">!=</span>&nbsp;<span class="builtintype" id="3567577">nil</span>&nbsp;<span class="op" id="3567581">&amp;&amp;</span>&nbsp;<span class="op" id="3567584">!</span><span class="ident" id="3567585">value</span><span class="op" id="3567590">.</span><span class="ident" id="3567591">Type</span><span class="op" id="3567595">(</span><span class="op" id="3567596">)</span><span class="op" id="3567597">.</span><span class="ident" id="3567598">AssignableTo</span><span class="op" id="3567610">(</span><span class="ident" id="3567611">typ</span><span class="op" id="3567614">)</span>&nbsp;<span class="op" id="3567616">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3567620">if</span>&nbsp;<span class="ident" id="3567623">value</span><span class="op" id="3567628">.</span><span class="ident" id="3567629">Kind</span><span class="op" id="3567633">(</span><span class="op" id="3567634">)</span>&nbsp;<span class="op" id="3567636">==</span>&nbsp;<span class="ident" id="3567639">reflect</span><span class="op" id="3567646">.</span><span class="ident" id="3567647">Interface</span>&nbsp;<span class="op" id="3567657">&amp;&amp;</span>&nbsp;<span class="op" id="3567660">!</span><span class="ident" id="3567661">value</span><span class="op" id="3567666">.</span><span class="ident" id="3567667">IsNil</span><span class="op" id="3567672">(</span><span class="op" id="3567673">)</span>&nbsp;<span class="op" id="3567675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3567680">value</span>&nbsp;<span class="op" id="3567686">=</span>&nbsp;<span class="ident" id="3567688">value</span><span class="op" id="3567693">.</span><span class="ident" id="3567694">Elem</span><span class="op" id="3567698">(</span><span class="op" id="3567699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3567704">if</span>&nbsp;<span class="ident" id="3567707">value</span><span class="op" id="3567712">.</span><span class="ident" id="3567713">Type</span><span class="op" id="3567717">(</span><span class="op" id="3567718">)</span><span class="op" id="3567719">.</span><span class="ident" id="3567720">AssignableTo</span><span class="op" id="3567732">(</span><span class="ident" id="3567733">typ</span><span class="op" id="3567736">)</span>&nbsp;<span class="op" id="3567738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3567744">return</span>&nbsp;<span class="ident" id="3567751">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3567760">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3567765">//&nbsp;fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3567782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3567786">//&nbsp;Does&nbsp;one&nbsp;dereference&nbsp;or&nbsp;indirection&nbsp;work?&nbsp;We&nbsp;could&nbsp;do&nbsp;more,&nbsp;as&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3567857">//&nbsp;do&nbsp;with&nbsp;method&nbsp;receivers,&nbsp;but&nbsp;that&nbsp;gets&nbsp;messy&nbsp;and&nbsp;method&nbsp;receivers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3567929">//&nbsp;are&nbsp;much&nbsp;more&nbsp;constrained,&nbsp;so&nbsp;it&nbsp;makes&nbsp;more&nbsp;sense&nbsp;there&nbsp;than&nbsp;here.</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3568001">//&nbsp;Besides,&nbsp;one&nbsp;is&nbsp;almost&nbsp;always&nbsp;all&nbsp;you&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3568050">switch</span>&nbsp;<span class="op" id="3568057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3568061">case</span>&nbsp;<span class="ident" id="3568066">value</span><span class="op" id="3568071">.</span><span class="ident" id="3568072">Kind</span><span class="op" id="3568076">(</span><span class="op" id="3568077">)</span>&nbsp;<span class="op" id="3568079">==</span>&nbsp;<span class="ident" id="3568082">reflect</span><span class="op" id="3568089">.</span><span class="ident" id="3568090">Ptr</span>&nbsp;<span class="op" id="3568094">&amp;&amp;</span>&nbsp;<span class="ident" id="3568097">value</span><span class="op" id="3568102">.</span><span class="ident" id="3568103">Type</span><span class="op" id="3568107">(</span><span class="op" id="3568108">)</span><span class="op" id="3568109">.</span><span class="ident" id="3568110">Elem</span><span class="op" id="3568114">(</span><span class="op" id="3568115">)</span><span class="op" id="3568116">.</span><span class="ident" id="3568117">AssignableTo</span><span class="op" id="3568129">(</span><span class="ident" id="3568130">typ</span><span class="op" id="3568133">)</span><span class="op" id="3568134">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3568139">value</span>&nbsp;<span class="op" id="3568145">=</span>&nbsp;<span class="ident" id="3568147">value</span><span class="op" id="3568152">.</span><span class="ident" id="3568153">Elem</span><span class="op" id="3568157">(</span><span class="op" id="3568158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3568163">if</span>&nbsp;<span class="op" id="3568166">!</span><span class="ident" id="3568167">value</span><span class="op" id="3568172">.</span><span class="ident" id="3568173">IsValid</span><span class="op" id="3568180">(</span><span class="op" id="3568181">)</span>&nbsp;<span class="op" id="3568183">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3568189">s</span><span class="op" id="3568190">.</span><span class="ident" id="3568191">errorf</span><span class="op" id="3568197">(</span><span class="string" id="3568198">&#34;dereference&nbsp;of&nbsp;nil&nbsp;pointer&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3568237">,</span>&nbsp;<span class="ident" id="3568239">typ</span><span class="op" id="3568242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3568247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3568251">case</span>&nbsp;<span class="ident" id="3568256">reflect</span><span class="op" id="3568263">.</span><span class="ident" id="3568264">PtrTo</span><span class="op" id="3568269">(</span><span class="ident" id="3568270">value</span><span class="op" id="3568275">.</span><span class="ident" id="3568276">Type</span><span class="op" id="3568280">(</span><span class="op" id="3568281">)</span><span class="op" id="3568282">)</span><span class="op" id="3568283">.</span><span class="ident" id="3568284">AssignableTo</span><span class="op" id="3568296">(</span><span class="ident" id="3568297">typ</span><span class="op" id="3568300">)</span>&nbsp;<span class="op" id="3568302">&amp;&amp;</span>&nbsp;<span class="ident" id="3568305">value</span><span class="op" id="3568310">.</span><span class="ident" id="3568311">CanAddr</span><span class="op" id="3568318">(</span><span class="op" id="3568319">)</span><span class="op" id="3568320">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3568325">value</span>&nbsp;<span class="op" id="3568331">=</span>&nbsp;<span class="ident" id="3568333">value</span><span class="op" id="3568338">.</span><span class="ident" id="3568339">Addr</span><span class="op" id="3568343">(</span><span class="op" id="3568344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3568348">default</span><span class="op" id="3568355">:</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3568360">s</span><span class="op" id="3568361">.</span><span class="ident" id="3568362">errorf</span><span class="op" id="3568368">(</span><span class="string" id="3568369">&#34;wrong&nbsp;type&nbsp;for&nbsp;value;&nbsp;expected&nbsp;%s;&nbsp;got&nbsp;%s&#34;</span><span class="op" id="3568412">,</span>&nbsp;<span class="ident" id="3568414">typ</span><span class="op" id="3568417">,</span>&nbsp;<span class="ident" id="3568419">value</span><span class="op" id="3568424">.</span><span class="ident" id="3568425">Type</span><span class="op" id="3568429">(</span><span class="op" id="3568430">)</span><span class="op" id="3568431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3568435">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3568438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3568441">return</span>&nbsp;<span class="ident" id="3568448">value</span><br>
<span class="lineno"></span><span class="op" id="3568454">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="3568457">func</span>&nbsp;<span class="op" id="3568462">(</span><span class="ident" id="3568463">s</span>&nbsp;<span class="op" id="3568465">*</span><span class="ident" id="3568466">state</span><span class="op" id="3568471">)</span>&nbsp;<span class="ident" id="3568473">evalArg</span><span class="op" id="3568480">(</span><span class="ident" id="3568481">dot</span>&nbsp;<span class="ident" id="3568485">reflect</span><span class="op" id="3568492">.</span><span class="ident" id="3568493">Value</span><span class="op" id="3568498">,</span>&nbsp;<span class="ident" id="3568500">typ</span>&nbsp;<span class="ident" id="3568504">reflect</span><span class="op" id="3568511">.</span><span class="ident" id="3568512">Type</span><span class="op" id="3568516">,</span>&nbsp;<span class="ident" id="3568518">n</span>&nbsp;<span class="ident" id="3568520">parse</span><span class="op" id="3568525">.</span><span class="ident" id="3568526">Node</span><span class="op" id="3568530">)</span>&nbsp;<span class="ident" id="3568532">reflect</span><span class="op" id="3568539">.</span><span class="ident" id="3568540">Value</span>&nbsp;<span class="op" id="3568546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3568549">s</span><span class="op" id="3568550">.</span><span class="ident" id="3568551">at</span><span class="op" id="3568553">(</span><span class="ident" id="3568554">n</span><span class="op" id="3568555">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3568558">switch</span>&nbsp;<span class="ident" id="3568565">arg</span>&nbsp;<span class="op" id="3568569">:=</span>&nbsp;<span class="ident" id="3568572">n</span><span class="op" id="3568573">.</span><span class="op" id="3568574">(</span><span class="keyword" id="3568575">type</span><span class="op" id="3568579">)</span>&nbsp;<span class="op" id="3568581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3568584">case</span>&nbsp;<span class="op" id="3568589">*</span><span class="ident" id="3568590">parse</span><span class="op" id="3568595">.</span><span class="ident" id="3568596">DotNode</span><span class="op" id="3568603">:</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3568607">return</span>&nbsp;<span class="ident" id="3568614">s</span><span class="op" id="3568615">.</span><span class="ident" id="3568616">validateType</span><span class="op" id="3568628">(</span><span class="ident" id="3568629">dot</span><span class="op" id="3568632">,</span>&nbsp;<span class="ident" id="3568634">typ</span><span class="op" id="3568637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3568640">case</span>&nbsp;<span class="op" id="3568645">*</span><span class="ident" id="3568646">parse</span><span class="op" id="3568651">.</span><span class="ident" id="3568652">NilNode</span><span class="op" id="3568659">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3568663">if</span>&nbsp;<span class="ident" id="3568666">canBeNil</span><span class="op" id="3568674">(</span><span class="ident" id="3568675">typ</span><span class="op" id="3568678">)</span>&nbsp;<span class="op" id="3568680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3568685">return</span>&nbsp;<span class="ident" id="3568692">reflect</span><span class="op" id="3568699">.</span><span class="ident" id="3568700">Zero</span><span class="op" id="3568704">(</span><span class="ident" id="3568705">typ</span><span class="op" id="3568708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3568712">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3568716">s</span><span class="op" id="3568717">.</span><span class="ident" id="3568718">errorf</span><span class="op" id="3568724">(</span><span class="string" id="3568725">&#34;cannot&nbsp;assign&nbsp;nil&nbsp;to&nbsp;%s&#34;</span><span class="op" id="3568750">,</span>&nbsp;<span class="ident" id="3568752">typ</span><span class="op" id="3568755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3568758">case</span>&nbsp;<span class="op" id="3568763">*</span><span class="ident" id="3568764">parse</span><span class="op" id="3568769">.</span><span class="ident" id="3568770">FieldNode</span><span class="op" id="3568779">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3568783">return</span>&nbsp;<span class="ident" id="3568790">s</span><span class="op" id="3568791">.</span><span class="ident" id="3568792">validateType</span><span class="op" id="3568804">(</span><span class="ident" id="3568805">s</span><span class="op" id="3568806">.</span><span class="ident" id="3568807">evalFieldNode</span><span class="op" id="3568820">(</span><span class="ident" id="3568821">dot</span><span class="op" id="3568824">,</span>&nbsp;<span class="ident" id="3568826">arg</span><span class="op" id="3568829">,</span>&nbsp;<span class="op" id="3568831">[</span><span class="op" id="3568832">]</span><span class="ident" id="3568833">parse</span><span class="op" id="3568838">.</span><span class="ident" id="3568839">Node</span><span class="op" id="3568843">{</span><span class="ident" id="3568844">n</span><span class="op" id="3568845">}</span><span class="op" id="3568846">,</span>&nbsp;<span class="ident" id="3568848">zero</span><span class="op" id="3568852">)</span><span class="op" id="3568853">,</span>&nbsp;<span class="ident" id="3568855">typ</span><span class="op" id="3568858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3568861">case</span>&nbsp;<span class="op" id="3568866">*</span><span class="ident" id="3568867">parse</span><span class="op" id="3568872">.</span><span class="ident" id="3568873">VariableNode</span><span class="op" id="3568885">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3568889">return</span>&nbsp;<span class="ident" id="3568896">s</span><span class="op" id="3568897">.</span><span class="ident" id="3568898">validateType</span><span class="op" id="3568910">(</span><span class="ident" id="3568911">s</span><span class="op" id="3568912">.</span><span class="ident" id="3568913">evalVariableNode</span><span class="op" id="3568929">(</span><span class="ident" id="3568930">dot</span><span class="op" id="3568933">,</span>&nbsp;<span class="ident" id="3568935">arg</span><span class="op" id="3568938">,</span>&nbsp;<span class="builtintype" id="3568940">nil</span><span class="op" id="3568943">,</span>&nbsp;<span class="ident" id="3568945">zero</span><span class="op" id="3568949">)</span><span class="op" id="3568950">,</span>&nbsp;<span class="ident" id="3568952">typ</span><span class="op" id="3568955">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3568958">case</span>&nbsp;<span class="op" id="3568963">*</span><span class="ident" id="3568964">parse</span><span class="op" id="3568969">.</span><span class="ident" id="3568970">PipeNode</span><span class="op" id="3568978">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3568982">return</span>&nbsp;<span class="ident" id="3568989">s</span><span class="op" id="3568990">.</span><span class="ident" id="3568991">validateType</span><span class="op" id="3569003">(</span><span class="ident" id="3569004">s</span><span class="op" id="3569005">.</span><span class="ident" id="3569006">evalPipeline</span><span class="op" id="3569018">(</span><span class="ident" id="3569019">dot</span><span class="op" id="3569022">,</span>&nbsp;<span class="ident" id="3569024">arg</span><span class="op" id="3569027">)</span><span class="op" id="3569028">,</span>&nbsp;<span class="ident" id="3569030">typ</span><span class="op" id="3569033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569036">case</span>&nbsp;<span class="op" id="3569041">*</span><span class="ident" id="3569042">parse</span><span class="op" id="3569047">.</span><span class="ident" id="3569048">IdentifierNode</span><span class="op" id="3569062">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569066">return</span>&nbsp;<span class="ident" id="3569073">s</span><span class="op" id="3569074">.</span><span class="ident" id="3569075">evalFunction</span><span class="op" id="3569087">(</span><span class="ident" id="3569088">dot</span><span class="op" id="3569091">,</span>&nbsp;<span class="ident" id="3569093">arg</span><span class="op" id="3569096">,</span>&nbsp;<span class="ident" id="3569098">arg</span><span class="op" id="3569101">,</span>&nbsp;<span class="builtintype" id="3569103">nil</span><span class="op" id="3569106">,</span>&nbsp;<span class="ident" id="3569108">zero</span><span class="op" id="3569112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569115">case</span>&nbsp;<span class="op" id="3569120">*</span><span class="ident" id="3569121">parse</span><span class="op" id="3569126">.</span><span class="ident" id="3569127">ChainNode</span><span class="op" id="3569136">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569140">return</span>&nbsp;<span class="ident" id="3569147">s</span><span class="op" id="3569148">.</span><span class="ident" id="3569149">validateType</span><span class="op" id="3569161">(</span><span class="ident" id="3569162">s</span><span class="op" id="3569163">.</span><span class="ident" id="3569164">evalChainNode</span><span class="op" id="3569177">(</span><span class="ident" id="3569178">dot</span><span class="op" id="3569181">,</span>&nbsp;<span class="ident" id="3569183">arg</span><span class="op" id="3569186">,</span>&nbsp;<span class="builtintype" id="3569188">nil</span><span class="op" id="3569191">,</span>&nbsp;<span class="ident" id="3569193">zero</span><span class="op" id="3569197">)</span><span class="op" id="3569198">,</span>&nbsp;<span class="ident" id="3569200">typ</span><span class="op" id="3569203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3569206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569209">switch</span>&nbsp;<span class="ident" id="3569216">typ</span><span class="op" id="3569219">.</span><span class="ident" id="3569220">Kind</span><span class="op" id="3569224">(</span><span class="op" id="3569225">)</span>&nbsp;<span class="op" id="3569227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569230">case</span>&nbsp;<span class="ident" id="3569235">reflect</span><span class="op" id="3569242">.</span><span class="ident" id="3569243">Bool</span><span class="op" id="3569247">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569251">return</span>&nbsp;<span class="ident" id="3569258">s</span><span class="op" id="3569259">.</span><span class="ident" id="3569260">evalBool</span><span class="op" id="3569268">(</span><span class="ident" id="3569269">typ</span><span class="op" id="3569272">,</span>&nbsp;<span class="ident" id="3569274">n</span><span class="op" id="3569275">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569278">case</span>&nbsp;<span class="ident" id="3569283">reflect</span><span class="op" id="3569290">.</span><span class="ident" id="3569291">Complex64</span><span class="op" id="3569300">,</span>&nbsp;<span class="ident" id="3569302">reflect</span><span class="op" id="3569309">.</span><span class="ident" id="3569310">Complex128</span><span class="op" id="3569320">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569324">return</span>&nbsp;<span class="ident" id="3569331">s</span><span class="op" id="3569332">.</span><span class="ident" id="3569333">evalComplex</span><span class="op" id="3569344">(</span><span class="ident" id="3569345">typ</span><span class="op" id="3569348">,</span>&nbsp;<span class="ident" id="3569350">n</span><span class="op" id="3569351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569354">case</span>&nbsp;<span class="ident" id="3569359">reflect</span><span class="op" id="3569366">.</span><span class="ident" id="3569367">Float32</span><span class="op" id="3569374">,</span>&nbsp;<span class="ident" id="3569376">reflect</span><span class="op" id="3569383">.</span><span class="ident" id="3569384">Float64</span><span class="op" id="3569391">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569395">return</span>&nbsp;<span class="ident" id="3569402">s</span><span class="op" id="3569403">.</span><span class="ident" id="3569404">evalFloat</span><span class="op" id="3569413">(</span><span class="ident" id="3569414">typ</span><span class="op" id="3569417">,</span>&nbsp;<span class="ident" id="3569419">n</span><span class="op" id="3569420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569423">case</span>&nbsp;<span class="ident" id="3569428">reflect</span><span class="op" id="3569435">.</span><span class="ident" id="3569436">Int</span><span class="op" id="3569439">,</span>&nbsp;<span class="ident" id="3569441">reflect</span><span class="op" id="3569448">.</span><span class="ident" id="3569449">Int8</span><span class="op" id="3569453">,</span>&nbsp;<span class="ident" id="3569455">reflect</span><span class="op" id="3569462">.</span><span class="ident" id="3569463">Int16</span><span class="op" id="3569468">,</span>&nbsp;<span class="ident" id="3569470">reflect</span><span class="op" id="3569477">.</span><span class="ident" id="3569478">Int32</span><span class="op" id="3569483">,</span>&nbsp;<span class="ident" id="3569485">reflect</span><span class="op" id="3569492">.</span><span class="ident" id="3569493">Int64</span><span class="op" id="3569498">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569502">return</span>&nbsp;<span class="ident" id="3569509">s</span><span class="op" id="3569510">.</span><span class="ident" id="3569511">evalInteger</span><span class="op" id="3569522">(</span><span class="ident" id="3569523">typ</span><span class="op" id="3569526">,</span>&nbsp;<span class="ident" id="3569528">n</span><span class="op" id="3569529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569532">case</span>&nbsp;<span class="ident" id="3569537">reflect</span><span class="op" id="3569544">.</span><span class="ident" id="3569545">Interface</span><span class="op" id="3569554">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569558">if</span>&nbsp;<span class="ident" id="3569561">typ</span><span class="op" id="3569564">.</span><span class="ident" id="3569565">NumMethod</span><span class="op" id="3569574">(</span><span class="op" id="3569575">)</span>&nbsp;<span class="op" id="3569577">==</span>&nbsp;<span class="num" id="3569580">0</span>&nbsp;<span class="op" id="3569582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569587">return</span>&nbsp;<span class="ident" id="3569594">s</span><span class="op" id="3569595">.</span><span class="ident" id="3569596">evalEmptyInterface</span><span class="op" id="3569614">(</span><span class="ident" id="3569615">dot</span><span class="op" id="3569618">,</span>&nbsp;<span class="ident" id="3569620">n</span><span class="op" id="3569621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3569625">}</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569628">case</span>&nbsp;<span class="ident" id="3569633">reflect</span><span class="op" id="3569640">.</span><span class="ident" id="3569641">String</span><span class="op" id="3569647">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569651">return</span>&nbsp;<span class="ident" id="3569658">s</span><span class="op" id="3569659">.</span><span class="ident" id="3569660">evalString</span><span class="op" id="3569670">(</span><span class="ident" id="3569671">typ</span><span class="op" id="3569674">,</span>&nbsp;<span class="ident" id="3569676">n</span><span class="op" id="3569677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569680">case</span>&nbsp;<span class="ident" id="3569685">reflect</span><span class="op" id="3569692">.</span><span class="ident" id="3569693">Uint</span><span class="op" id="3569697">,</span>&nbsp;<span class="ident" id="3569699">reflect</span><span class="op" id="3569706">.</span><span class="ident" id="3569707">Uint8</span><span class="op" id="3569712">,</span>&nbsp;<span class="ident" id="3569714">reflect</span><span class="op" id="3569721">.</span><span class="ident" id="3569722">Uint16</span><span class="op" id="3569728">,</span>&nbsp;<span class="ident" id="3569730">reflect</span><span class="op" id="3569737">.</span><span class="ident" id="3569738">Uint32</span><span class="op" id="3569744">,</span>&nbsp;<span class="ident" id="3569746">reflect</span><span class="op" id="3569753">.</span><span class="ident" id="3569754">Uint64</span><span class="op" id="3569760">,</span>&nbsp;<span class="ident" id="3569762">reflect</span><span class="op" id="3569769">.</span><span class="ident" id="3569770">Uintptr</span><span class="op" id="3569777">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569781">return</span>&nbsp;<span class="ident" id="3569788">s</span><span class="op" id="3569789">.</span><span class="ident" id="3569790">evalUnsignedInteger</span><span class="op" id="3569809">(</span><span class="ident" id="3569810">typ</span><span class="op" id="3569813">,</span>&nbsp;<span class="ident" id="3569815">n</span><span class="op" id="3569816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3569819">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3569822">s</span><span class="op" id="3569823">.</span><span class="ident" id="3569824">errorf</span><span class="op" id="3569830">(</span><span class="string" id="3569831">&#34;can&#39;t&nbsp;handle&nbsp;%s&nbsp;for&nbsp;arg&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3569867">,</span>&nbsp;<span class="ident" id="3569869">n</span><span class="op" id="3569870">,</span>&nbsp;<span class="ident" id="3569872">typ</span><span class="op" id="3569875">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3569878">panic</span><span class="op" id="3569883">(</span><span class="string" id="3569884">&#34;not&nbsp;reached&#34;</span><span class="op" id="3569897">)</span><br>
<span class="lineno"></span><span class="op" id="3569899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3569902">func</span>&nbsp;<span class="op" id="3569907">(</span><span class="ident" id="3569908">s</span>&nbsp;<span class="op" id="3569910">*</span><span class="ident" id="3569911">state</span><span class="op" id="3569916">)</span>&nbsp;<span class="ident" id="3569918">evalBool</span><span class="op" id="3569926">(</span><span class="ident" id="3569927">typ</span>&nbsp;<span class="ident" id="3569931">reflect</span><span class="op" id="3569938">.</span><span class="ident" id="3569939">Type</span><span class="op" id="3569943">,</span>&nbsp;<span class="ident" id="3569945">n</span>&nbsp;<span class="ident" id="3569947">parse</span><span class="op" id="3569952">.</span><span class="ident" id="3569953">Node</span><span class="op" id="3569957">)</span>&nbsp;<span class="ident" id="3569959">reflect</span><span class="op" id="3569966">.</span><span class="ident" id="3569967">Value</span>&nbsp;<span class="op" id="3569973">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3569976">s</span><span class="op" id="3569977">.</span><span class="ident" id="3569978">at</span><span class="op" id="3569980">(</span><span class="ident" id="3569981">n</span><span class="op" id="3569982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3569985">if</span>&nbsp;<span class="ident" id="3569988">n</span><span class="op" id="3569989">,</span>&nbsp;<span class="ident" id="3569991">ok</span>&nbsp;<span class="op" id="3569994">:=</span>&nbsp;<span class="ident" id="3569997">n</span><span class="op" id="3569998">.</span><span class="op" id="3569999">(</span><span class="op" id="3570000">*</span><span class="ident" id="3570001">parse</span><span class="op" id="3570006">.</span><span class="ident" id="3570007">BoolNode</span><span class="op" id="3570015">)</span><span class="op" id="3570016">;</span>&nbsp;<span class="ident" id="3570018">ok</span>&nbsp;<span class="op" id="3570021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3570025">value</span>&nbsp;<span class="op" id="3570031">:=</span>&nbsp;<span class="ident" id="3570034">reflect</span><span class="op" id="3570041">.</span><span class="ident" id="3570042">New</span><span class="op" id="3570045">(</span><span class="ident" id="3570046">typ</span><span class="op" id="3570049">)</span><span class="op" id="3570050">.</span><span class="ident" id="3570051">Elem</span><span class="op" id="3570055">(</span><span class="op" id="3570056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3570060">value</span><span class="op" id="3570065">.</span><span class="ident" id="3570066">SetBool</span><span class="op" id="3570073">(</span><span class="ident" id="3570074">n</span><span class="op" id="3570075">.</span><span class="ident" id="3570076">True</span><span class="op" id="3570080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3570084">return</span>&nbsp;<span class="ident" id="3570091">value</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3570098">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3570101">s</span><span class="op" id="3570102">.</span><span class="ident" id="3570103">errorf</span><span class="op" id="3570109">(</span><span class="string" id="3570110">&#34;expected&nbsp;bool;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3570135">,</span>&nbsp;<span class="ident" id="3570137">n</span><span class="op" id="3570138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3570141">panic</span><span class="op" id="3570146">(</span><span class="string" id="3570147">&#34;not&nbsp;reached&#34;</span><span class="op" id="3570160">)</span><br>
<span class="lineno"></span><span class="op" id="3570162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="3570165">func</span>&nbsp;<span class="op" id="3570170">(</span><span class="ident" id="3570171">s</span>&nbsp;<span class="op" id="3570173">*</span><span class="ident" id="3570174">state</span><span class="op" id="3570179">)</span>&nbsp;<span class="ident" id="3570181">evalString</span><span class="op" id="3570191">(</span><span class="ident" id="3570192">typ</span>&nbsp;<span class="ident" id="3570196">reflect</span><span class="op" id="3570203">.</span><span class="ident" id="3570204">Type</span><span class="op" id="3570208">,</span>&nbsp;<span class="ident" id="3570210">n</span>&nbsp;<span class="ident" id="3570212">parse</span><span class="op" id="3570217">.</span><span class="ident" id="3570218">Node</span><span class="op" id="3570222">)</span>&nbsp;<span class="ident" id="3570224">reflect</span><span class="op" id="3570231">.</span><span class="ident" id="3570232">Value</span>&nbsp;<span class="op" id="3570238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3570241">s</span><span class="op" id="3570242">.</span><span class="ident" id="3570243">at</span><span class="op" id="3570245">(</span><span class="ident" id="3570246">n</span><span class="op" id="3570247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3570250">if</span>&nbsp;<span class="ident" id="3570253">n</span><span class="op" id="3570254">,</span>&nbsp;<span class="ident" id="3570256">ok</span>&nbsp;<span class="op" id="3570259">:=</span>&nbsp;<span class="ident" id="3570262">n</span><span class="op" id="3570263">.</span><span class="op" id="3570264">(</span><span class="op" id="3570265">*</span><span class="ident" id="3570266">parse</span><span class="op" id="3570271">.</span><span class="ident" id="3570272">StringNode</span><span class="op" id="3570282">)</span><span class="op" id="3570283">;</span>&nbsp;<span class="ident" id="3570285">ok</span>&nbsp;<span class="op" id="3570288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3570292">value</span>&nbsp;<span class="op" id="3570298">:=</span>&nbsp;<span class="ident" id="3570301">reflect</span><span class="op" id="3570308">.</span><span class="ident" id="3570309">New</span><span class="op" id="3570312">(</span><span class="ident" id="3570313">typ</span><span class="op" id="3570316">)</span><span class="op" id="3570317">.</span><span class="ident" id="3570318">Elem</span><span class="op" id="3570322">(</span><span class="op" id="3570323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3570327">value</span><span class="op" id="3570332">.</span><span class="ident" id="3570333">SetString</span><span class="op" id="3570342">(</span><span class="ident" id="3570343">n</span><span class="op" id="3570344">.</span><span class="ident" id="3570345">Text</span><span class="op" id="3570349">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3570353">return</span>&nbsp;<span class="ident" id="3570360">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3570367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3570370">s</span><span class="op" id="3570371">.</span><span class="ident" id="3570372">errorf</span><span class="op" id="3570378">(</span><span class="string" id="3570379">&#34;expected&nbsp;string;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3570406">,</span>&nbsp;<span class="ident" id="3570408">n</span><span class="op" id="3570409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3570412">panic</span><span class="op" id="3570417">(</span><span class="string" id="3570418">&#34;not&nbsp;reached&#34;</span><span class="op" id="3570431">)</span><br>
<span class="lineno"></span><span class="op" id="3570433">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="3570436">func</span>&nbsp;<span class="op" id="3570441">(</span><span class="ident" id="3570442">s</span>&nbsp;<span class="op" id="3570444">*</span><span class="ident" id="3570445">state</span><span class="op" id="3570450">)</span>&nbsp;<span class="ident" id="3570452">evalInteger</span><span class="op" id="3570463">(</span><span class="ident" id="3570464">typ</span>&nbsp;<span class="ident" id="3570468">reflect</span><span class="op" id="3570475">.</span><span class="ident" id="3570476">Type</span><span class="op" id="3570480">,</span>&nbsp;<span class="ident" id="3570482">n</span>&nbsp;<span class="ident" id="3570484">parse</span><span class="op" id="3570489">.</span><span class="ident" id="3570490">Node</span><span class="op" id="3570494">)</span>&nbsp;<span class="ident" id="3570496">reflect</span><span class="op" id="3570503">.</span><span class="ident" id="3570504">Value</span>&nbsp;<span class="op" id="3570510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3570513">s</span><span class="op" id="3570514">.</span><span class="ident" id="3570515">at</span><span class="op" id="3570517">(</span><span class="ident" id="3570518">n</span><span class="op" id="3570519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3570522">if</span>&nbsp;<span class="ident" id="3570525">n</span><span class="op" id="3570526">,</span>&nbsp;<span class="ident" id="3570528">ok</span>&nbsp;<span class="op" id="3570531">:=</span>&nbsp;<span class="ident" id="3570534">n</span><span class="op" id="3570535">.</span><span class="op" id="3570536">(</span><span class="op" id="3570537">*</span><span class="ident" id="3570538">parse</span><span class="op" id="3570543">.</span><span class="ident" id="3570544">NumberNode</span><span class="op" id="3570554">)</span><span class="op" id="3570555">;</span>&nbsp;<span class="ident" id="3570557">ok</span>&nbsp;<span class="op" id="3570560">&amp;&amp;</span>&nbsp;<span class="ident" id="3570563">n</span><span class="op" id="3570564">.</span><span class="ident" id="3570565">IsInt</span>&nbsp;<span class="op" id="3570571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3570575">value</span>&nbsp;<span class="op" id="3570581">:=</span>&nbsp;<span class="ident" id="3570584">reflect</span><span class="op" id="3570591">.</span><span class="ident" id="3570592">New</span><span class="op" id="3570595">(</span><span class="ident" id="3570596">typ</span><span class="op" id="3570599">)</span><span class="op" id="3570600">.</span><span class="ident" id="3570601">Elem</span><span class="op" id="3570605">(</span><span class="op" id="3570606">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3570610">value</span><span class="op" id="3570615">.</span><span class="ident" id="3570616">SetInt</span><span class="op" id="3570622">(</span><span class="ident" id="3570623">n</span><span class="op" id="3570624">.</span><span class="ident" id="3570625">Int64</span><span class="op" id="3570630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3570634">return</span>&nbsp;<span class="ident" id="3570641">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3570648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3570651">s</span><span class="op" id="3570652">.</span><span class="ident" id="3570653">errorf</span><span class="op" id="3570659">(</span><span class="string" id="3570660">&#34;expected&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3570688">,</span>&nbsp;<span class="ident" id="3570690">n</span><span class="op" id="3570691">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3570694">panic</span><span class="op" id="3570699">(</span><span class="string" id="3570700">&#34;not&nbsp;reached&#34;</span><span class="op" id="3570713">)</span><br>
<span class="lineno">695</span><span class="op" id="3570715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3570718">func</span>&nbsp;<span class="op" id="3570723">(</span><span class="ident" id="3570724">s</span>&nbsp;<span class="op" id="3570726">*</span><span class="ident" id="3570727">state</span><span class="op" id="3570732">)</span>&nbsp;<span class="ident" id="3570734">evalUnsignedInteger</span><span class="op" id="3570753">(</span><span class="ident" id="3570754">typ</span>&nbsp;<span class="ident" id="3570758">reflect</span><span class="op" id="3570765">.</span><span class="ident" id="3570766">Type</span><span class="op" id="3570770">,</span>&nbsp;<span class="ident" id="3570772">n</span>&nbsp;<span class="ident" id="3570774">parse</span><span class="op" id="3570779">.</span><span class="ident" id="3570780">Node</span><span class="op" id="3570784">)</span>&nbsp;<span class="ident" id="3570786">reflect</span><span class="op" id="3570793">.</span><span class="ident" id="3570794">Value</span>&nbsp;<span class="op" id="3570800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3570803">s</span><span class="op" id="3570804">.</span><span class="ident" id="3570805">at</span><span class="op" id="3570807">(</span><span class="ident" id="3570808">n</span><span class="op" id="3570809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3570812">if</span>&nbsp;<span class="ident" id="3570815">n</span><span class="op" id="3570816">,</span>&nbsp;<span class="ident" id="3570818">ok</span>&nbsp;<span class="op" id="3570821">:=</span>&nbsp;<span class="ident" id="3570824">n</span><span class="op" id="3570825">.</span><span class="op" id="3570826">(</span><span class="op" id="3570827">*</span><span class="ident" id="3570828">parse</span><span class="op" id="3570833">.</span><span class="ident" id="3570834">NumberNode</span><span class="op" id="3570844">)</span><span class="op" id="3570845">;</span>&nbsp;<span class="ident" id="3570847">ok</span>&nbsp;<span class="op" id="3570850">&amp;&amp;</span>&nbsp;<span class="ident" id="3570853">n</span><span class="op" id="3570854">.</span><span class="ident" id="3570855">IsUint</span>&nbsp;<span class="op" id="3570862">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3570866">value</span>&nbsp;<span class="op" id="3570872">:=</span>&nbsp;<span class="ident" id="3570875">reflect</span><span class="op" id="3570882">.</span><span class="ident" id="3570883">New</span><span class="op" id="3570886">(</span><span class="ident" id="3570887">typ</span><span class="op" id="3570890">)</span><span class="op" id="3570891">.</span><span class="ident" id="3570892">Elem</span><span class="op" id="3570896">(</span><span class="op" id="3570897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3570901">value</span><span class="op" id="3570906">.</span><span class="ident" id="3570907">SetUint</span><span class="op" id="3570914">(</span><span class="ident" id="3570915">n</span><span class="op" id="3570916">.</span><span class="ident" id="3570917">Uint64</span><span class="op" id="3570923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3570927">return</span>&nbsp;<span class="ident" id="3570934">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3570941">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3570944">s</span><span class="op" id="3570945">.</span><span class="ident" id="3570946">errorf</span><span class="op" id="3570952">(</span><span class="string" id="3570953">&#34;expected&nbsp;unsigned&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3570990">,</span>&nbsp;<span class="ident" id="3570992">n</span><span class="op" id="3570993">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3570996">panic</span><span class="op" id="3571001">(</span><span class="string" id="3571002">&#34;not&nbsp;reached&#34;</span><span class="op" id="3571015">)</span><br>
<span class="lineno"></span><span class="op" id="3571017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3571020">func</span>&nbsp;<span class="op" id="3571025">(</span><span class="ident" id="3571026">s</span>&nbsp;<span class="op" id="3571028">*</span><span class="ident" id="3571029">state</span><span class="op" id="3571034">)</span>&nbsp;<span class="ident" id="3571036">evalFloat</span><span class="op" id="3571045">(</span><span class="ident" id="3571046">typ</span>&nbsp;<span class="ident" id="3571050">reflect</span><span class="op" id="3571057">.</span><span class="ident" id="3571058">Type</span><span class="op" id="3571062">,</span>&nbsp;<span class="ident" id="3571064">n</span>&nbsp;<span class="ident" id="3571066">parse</span><span class="op" id="3571071">.</span><span class="ident" id="3571072">Node</span><span class="op" id="3571076">)</span>&nbsp;<span class="ident" id="3571078">reflect</span><span class="op" id="3571085">.</span><span class="ident" id="3571086">Value</span>&nbsp;<span class="op" id="3571092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3571095">s</span><span class="op" id="3571096">.</span><span class="ident" id="3571097">at</span><span class="op" id="3571099">(</span><span class="ident" id="3571100">n</span><span class="op" id="3571101">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3571104">if</span>&nbsp;<span class="ident" id="3571107">n</span><span class="op" id="3571108">,</span>&nbsp;<span class="ident" id="3571110">ok</span>&nbsp;<span class="op" id="3571113">:=</span>&nbsp;<span class="ident" id="3571116">n</span><span class="op" id="3571117">.</span><span class="op" id="3571118">(</span><span class="op" id="3571119">*</span><span class="ident" id="3571120">parse</span><span class="op" id="3571125">.</span><span class="ident" id="3571126">NumberNode</span><span class="op" id="3571136">)</span><span class="op" id="3571137">;</span>&nbsp;<span class="ident" id="3571139">ok</span>&nbsp;<span class="op" id="3571142">&amp;&amp;</span>&nbsp;<span class="ident" id="3571145">n</span><span class="op" id="3571146">.</span><span class="ident" id="3571147">IsFloat</span>&nbsp;<span class="op" id="3571155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3571159">value</span>&nbsp;<span class="op" id="3571165">:=</span>&nbsp;<span class="ident" id="3571168">reflect</span><span class="op" id="3571175">.</span><span class="ident" id="3571176">New</span><span class="op" id="3571179">(</span><span class="ident" id="3571180">typ</span><span class="op" id="3571183">)</span><span class="op" id="3571184">.</span><span class="ident" id="3571185">Elem</span><span class="op" id="3571189">(</span><span class="op" id="3571190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3571194">value</span><span class="op" id="3571199">.</span><span class="ident" id="3571200">SetFloat</span><span class="op" id="3571208">(</span><span class="ident" id="3571209">n</span><span class="op" id="3571210">.</span><span class="ident" id="3571211">Float64</span><span class="op" id="3571218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3571222">return</span>&nbsp;<span class="ident" id="3571229">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3571236">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3571239">s</span><span class="op" id="3571240">.</span><span class="ident" id="3571241">errorf</span><span class="op" id="3571247">(</span><span class="string" id="3571248">&#34;expected&nbsp;float;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3571274">,</span>&nbsp;<span class="ident" id="3571276">n</span><span class="op" id="3571277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3571280">panic</span><span class="op" id="3571285">(</span><span class="string" id="3571286">&#34;not&nbsp;reached&#34;</span><span class="op" id="3571299">)</span><br>
<span class="lineno"></span><span class="op" id="3571301">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3571304">func</span>&nbsp;<span class="op" id="3571309">(</span><span class="ident" id="3571310">s</span>&nbsp;<span class="op" id="3571312">*</span><span class="ident" id="3571313">state</span><span class="op" id="3571318">)</span>&nbsp;<span class="ident" id="3571320">evalComplex</span><span class="op" id="3571331">(</span><span class="ident" id="3571332">typ</span>&nbsp;<span class="ident" id="3571336">reflect</span><span class="op" id="3571343">.</span><span class="ident" id="3571344">Type</span><span class="op" id="3571348">,</span>&nbsp;<span class="ident" id="3571350">n</span>&nbsp;<span class="ident" id="3571352">parse</span><span class="op" id="3571357">.</span><span class="ident" id="3571358">Node</span><span class="op" id="3571362">)</span>&nbsp;<span class="ident" id="3571364">reflect</span><span class="op" id="3571371">.</span><span class="ident" id="3571372">Value</span>&nbsp;<span class="op" id="3571378">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3571381">if</span>&nbsp;<span class="ident" id="3571384">n</span><span class="op" id="3571385">,</span>&nbsp;<span class="ident" id="3571387">ok</span>&nbsp;<span class="op" id="3571390">:=</span>&nbsp;<span class="ident" id="3571393">n</span><span class="op" id="3571394">.</span><span class="op" id="3571395">(</span><span class="op" id="3571396">*</span><span class="ident" id="3571397">parse</span><span class="op" id="3571402">.</span><span class="ident" id="3571403">NumberNode</span><span class="op" id="3571413">)</span><span class="op" id="3571414">;</span>&nbsp;<span class="ident" id="3571416">ok</span>&nbsp;<span class="op" id="3571419">&amp;&amp;</span>&nbsp;<span class="ident" id="3571422">n</span><span class="op" id="3571423">.</span><span class="ident" id="3571424">IsComplex</span>&nbsp;<span class="op" id="3571434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3571438">value</span>&nbsp;<span class="op" id="3571444">:=</span>&nbsp;<span class="ident" id="3571447">reflect</span><span class="op" id="3571454">.</span><span class="ident" id="3571455">New</span><span class="op" id="3571458">(</span><span class="ident" id="3571459">typ</span><span class="op" id="3571462">)</span><span class="op" id="3571463">.</span><span class="ident" id="3571464">Elem</span><span class="op" id="3571468">(</span><span class="op" id="3571469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3571473">value</span><span class="op" id="3571478">.</span><span class="ident" id="3571479">SetComplex</span><span class="op" id="3571489">(</span><span class="ident" id="3571490">n</span><span class="op" id="3571491">.</span><span class="ident" id="3571492">Complex128</span><span class="op" id="3571502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3571506">return</span>&nbsp;<span class="ident" id="3571513">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3571520">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3571523">s</span><span class="op" id="3571524">.</span><span class="ident" id="3571525">errorf</span><span class="op" id="3571531">(</span><span class="string" id="3571532">&#34;expected&nbsp;complex;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="3571560">,</span>&nbsp;<span class="ident" id="3571562">n</span><span class="op" id="3571563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3571566">panic</span><span class="op" id="3571571">(</span><span class="string" id="3571572">&#34;not&nbsp;reached&#34;</span><span class="op" id="3571585">)</span><br>
<span class="lineno"></span><span class="op" id="3571587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3571590">func</span>&nbsp;<span class="op" id="3571595">(</span><span class="ident" id="3571596">s</span>&nbsp;<span class="op" id="3571598">*</span><span class="ident" id="3571599">state</span><span class="op" id="3571604">)</span>&nbsp;<span class="ident" id="3571606">evalEmptyInterface</span><span class="op" id="3571624">(</span><span class="ident" id="3571625">dot</span>&nbsp;<span class="ident" id="3571629">reflect</span><span class="op" id="3571636">.</span><span class="ident" id="3571637">Value</span><span class="op" id="3571642">,</span>&nbsp;<span class="ident" id="3571644">n</span>&nbsp;<span class="ident" id="3571646">parse</span><span class="op" id="3571651">.</span><span class="ident" id="3571652">Node</span><span class="op" id="3571656">)</span>&nbsp;<span class="ident" id="3571658">reflect</span><span class="op" id="3571665">.</span><span class="ident" id="3571666">Value</span>&nbsp;<span class="op" id="3571672">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3571675">s</span><span class="op" id="3571676">.</span><span class="ident" id="3571677">at</span><span class="op" id="3571679">(</span><span class="ident" id="3571680">n</span><span class="op" id="3571681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3571684">switch</span>&nbsp;<span class="ident" id="3571691">n</span>&nbsp;<span class="op" id="3571693">:=</span>&nbsp;<span class="ident" id="3571696">n</span><span class="op" id="3571697">.</span><span class="op" id="3571698">(</span><span class="keyword" id="3571699">type</span><span class="op" id="3571703">)</span>&nbsp;<span class="op" id="3571705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3571708">case</span>&nbsp;<span class="op" id="3571713">*</span><span class="ident" id="3571714">parse</span><span class="op" id="3571719">.</span><span class="ident" id="3571720">BoolNode</span><span class="op" id="3571728">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3571732">return</span>&nbsp;<span class="ident" id="3571739">reflect</span><span class="op" id="3571746">.</span><span class="ident" id="3571747">ValueOf</span><span class="op" id="3571754">(</span><span class="ident" id="3571755">n</span><span class="op" id="3571756">.</span><span class="ident" id="3571757">True</span><span class="op" id="3571761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3571764">case</span>&nbsp;<span class="op" id="3571769">*</span><span class="ident" id="3571770">parse</span><span class="op" id="3571775">.</span><span class="ident" id="3571776">DotNode</span><span class="op" id="3571783">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3571787">return</span>&nbsp;<span class="ident" id="3571794">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3571799">case</span>&nbsp;<span class="op" id="3571804">*</span><span class="ident" id="3571805">parse</span><span class="op" id="3571810">.</span><span class="ident" id="3571811">FieldNode</span><span class="op" id="3571820">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3571824">return</span>&nbsp;<span class="ident" id="3571831">s</span><span class="op" id="3571832">.</span><span class="ident" id="3571833">evalFieldNode</span><span class="op" id="3571846">(</span><span class="ident" id="3571847">dot</span><span class="op" id="3571850">,</span>&nbsp;<span class="ident" id="3571852">n</span><span class="op" id="3571853">,</span>&nbsp;<span class="builtintype" id="3571855">nil</span><span class="op" id="3571858">,</span>&nbsp;<span class="ident" id="3571860">zero</span><span class="op" id="3571864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3571867">case</span>&nbsp;<span class="op" id="3571872">*</span><span class="ident" id="3571873">parse</span><span class="op" id="3571878">.</span><span class="ident" id="3571879">IdentifierNode</span><span class="op" id="3571893">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3571897">return</span>&nbsp;<span class="ident" id="3571904">s</span><span class="op" id="3571905">.</span><span class="ident" id="3571906">evalFunction</span><span class="op" id="3571918">(</span><span class="ident" id="3571919">dot</span><span class="op" id="3571922">,</span>&nbsp;<span class="ident" id="3571924">n</span><span class="op" id="3571925">,</span>&nbsp;<span class="ident" id="3571927">n</span><span class="op" id="3571928">,</span>&nbsp;<span class="builtintype" id="3571930">nil</span><span class="op" id="3571933">,</span>&nbsp;<span class="ident" id="3571935">zero</span><span class="op" id="3571939">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3571942">case</span>&nbsp;<span class="op" id="3571947">*</span><span class="ident" id="3571948">parse</span><span class="op" id="3571953">.</span><span class="ident" id="3571954">NilNode</span><span class="op" id="3571961">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3571965">//&nbsp;NilNode&nbsp;is&nbsp;handled&nbsp;in&nbsp;evalArg,&nbsp;the&nbsp;only&nbsp;place&nbsp;that&nbsp;calls&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3572033">s</span><span class="op" id="3572034">.</span><span class="ident" id="3572035">errorf</span><span class="op" id="3572041">(</span><span class="string" id="3572042">&#34;evalEmptyInterface:&nbsp;nil&nbsp;(can&#39;t&nbsp;happen)&#34;</span><span class="op" id="3572082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3572085">case</span>&nbsp;<span class="op" id="3572090">*</span><span class="ident" id="3572091">parse</span><span class="op" id="3572096">.</span><span class="ident" id="3572097">NumberNode</span><span class="op" id="3572107">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3572111">return</span>&nbsp;<span class="ident" id="3572118">s</span><span class="op" id="3572119">.</span><span class="ident" id="3572120">idealConstant</span><span class="op" id="3572133">(</span><span class="ident" id="3572134">n</span><span class="op" id="3572135">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3572138">case</span>&nbsp;<span class="op" id="3572143">*</span><span class="ident" id="3572144">parse</span><span class="op" id="3572149">.</span><span class="ident" id="3572150">StringNode</span><span class="op" id="3572160">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3572164">return</span>&nbsp;<span class="ident" id="3572171">reflect</span><span class="op" id="3572178">.</span><span class="ident" id="3572179">ValueOf</span><span class="op" id="3572186">(</span><span class="ident" id="3572187">n</span><span class="op" id="3572188">.</span><span class="ident" id="3572189">Text</span><span class="op" id="3572193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3572196">case</span>&nbsp;<span class="op" id="3572201">*</span><span class="ident" id="3572202">parse</span><span class="op" id="3572207">.</span><span class="ident" id="3572208">VariableNode</span><span class="op" id="3572220">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3572224">return</span>&nbsp;<span class="ident" id="3572231">s</span><span class="op" id="3572232">.</span><span class="ident" id="3572233">evalVariableNode</span><span class="op" id="3572249">(</span><span class="ident" id="3572250">dot</span><span class="op" id="3572253">,</span>&nbsp;<span class="ident" id="3572255">n</span><span class="op" id="3572256">,</span>&nbsp;<span class="builtintype" id="3572258">nil</span><span class="op" id="3572261">,</span>&nbsp;<span class="ident" id="3572263">zero</span><span class="op" id="3572267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3572270">case</span>&nbsp;<span class="op" id="3572275">*</span><span class="ident" id="3572276">parse</span><span class="op" id="3572281">.</span><span class="ident" id="3572282">PipeNode</span><span class="op" id="3572290">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3572294">return</span>&nbsp;<span class="ident" id="3572301">s</span><span class="op" id="3572302">.</span><span class="ident" id="3572303">evalPipeline</span><span class="op" id="3572315">(</span><span class="ident" id="3572316">dot</span><span class="op" id="3572319">,</span>&nbsp;<span class="ident" id="3572321">n</span><span class="op" id="3572322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3572325">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3572328">s</span><span class="op" id="3572329">.</span><span class="ident" id="3572330">errorf</span><span class="op" id="3572336">(</span><span class="string" id="3572337">&#34;can&#39;t&nbsp;handle&nbsp;assignment&nbsp;of&nbsp;%s&nbsp;to&nbsp;empty&nbsp;interface&nbsp;argument&#34;</span><span class="op" id="3572396">,</span>&nbsp;<span class="ident" id="3572398">n</span><span class="op" id="3572399">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3572402">panic</span><span class="op" id="3572407">(</span><span class="string" id="3572408">&#34;not&nbsp;reached&#34;</span><span class="op" id="3572421">)</span><br>
<span class="lineno"></span><span class="op" id="3572423">}</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="comment" id="3572426">//&nbsp;indirect&nbsp;returns&nbsp;the&nbsp;item&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;indirection,&nbsp;and&nbsp;a&nbsp;bool&nbsp;to&nbsp;indicate&nbsp;if&nbsp;it&#39;s&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="3572518">//&nbsp;We&nbsp;indirect&nbsp;through&nbsp;pointers&nbsp;and&nbsp;empty&nbsp;interfaces&nbsp;(only)&nbsp;because</span><br>
<span class="lineno"></span><span class="comment" id="3572586">//&nbsp;non-empty&nbsp;interfaces&nbsp;have&nbsp;methods&nbsp;we&nbsp;might&nbsp;need.</span><br>
<span class="lineno"></span><span class="keyword" id="3572638">func</span>&nbsp;<span class="ident" id="3572643">indirect</span><span class="op" id="3572651">(</span><span class="ident" id="3572652">v</span>&nbsp;<span class="ident" id="3572654">reflect</span><span class="op" id="3572661">.</span><span class="ident" id="3572662">Value</span><span class="op" id="3572667">)</span>&nbsp;<span class="op" id="3572669">(</span><span class="ident" id="3572670">rv</span>&nbsp;<span class="ident" id="3572673">reflect</span><span class="op" id="3572680">.</span><span class="ident" id="3572681">Value</span><span class="op" id="3572686">,</span>&nbsp;<span class="ident" id="3572688">isNil</span>&nbsp;<span class="builtintype" id="3572694">bool</span><span class="op" id="3572698">)</span>&nbsp;<span class="op" id="3572700">{</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3572703">for</span>&nbsp;<span class="op" id="3572707">;</span>&nbsp;<span class="ident" id="3572709">v</span><span class="op" id="3572710">.</span><span class="ident" id="3572711">Kind</span><span class="op" id="3572715">(</span><span class="op" id="3572716">)</span>&nbsp;<span class="op" id="3572718">==</span>&nbsp;<span class="ident" id="3572721">reflect</span><span class="op" id="3572728">.</span><span class="ident" id="3572729">Ptr</span>&nbsp;<span class="op" id="3572733">||</span>&nbsp;<span class="ident" id="3572736">v</span><span class="op" id="3572737">.</span><span class="ident" id="3572738">Kind</span><span class="op" id="3572742">(</span><span class="op" id="3572743">)</span>&nbsp;<span class="op" id="3572745">==</span>&nbsp;<span class="ident" id="3572748">reflect</span><span class="op" id="3572755">.</span><span class="ident" id="3572756">Interface</span><span class="op" id="3572765">;</span>&nbsp;<span class="ident" id="3572767">v</span>&nbsp;<span class="op" id="3572769">=</span>&nbsp;<span class="ident" id="3572771">v</span><span class="op" id="3572772">.</span><span class="ident" id="3572773">Elem</span><span class="op" id="3572777">(</span><span class="op" id="3572778">)</span>&nbsp;<span class="op" id="3572780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3572784">if</span>&nbsp;<span class="ident" id="3572787">v</span><span class="op" id="3572788">.</span><span class="ident" id="3572789">IsNil</span><span class="op" id="3572794">(</span><span class="op" id="3572795">)</span>&nbsp;<span class="op" id="3572797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3572802">return</span>&nbsp;<span class="ident" id="3572809">v</span><span class="op" id="3572810">,</span>&nbsp;<span class="builtintype" id="3572812">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3572819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3572823">if</span>&nbsp;<span class="ident" id="3572826">v</span><span class="op" id="3572827">.</span><span class="ident" id="3572828">Kind</span><span class="op" id="3572832">(</span><span class="op" id="3572833">)</span>&nbsp;<span class="op" id="3572835">==</span>&nbsp;<span class="ident" id="3572838">reflect</span><span class="op" id="3572845">.</span><span class="ident" id="3572846">Interface</span>&nbsp;<span class="op" id="3572856">&amp;&amp;</span>&nbsp;<span class="ident" id="3572859">v</span><span class="op" id="3572860">.</span><span class="ident" id="3572861">NumMethod</span><span class="op" id="3572870">(</span><span class="op" id="3572871">)</span>&nbsp;<span class="op" id="3572873">&gt;</span>&nbsp;<span class="num" id="3572875">0</span>&nbsp;<span class="op" id="3572877">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3572882">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3572890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3572893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3572896">return</span>&nbsp;<span class="ident" id="3572903">v</span><span class="op" id="3572904">,</span>&nbsp;<span class="builtintype" id="3572906">false</span><br>
<span class="lineno"></span><span class="op" id="3572912">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span><span class="comment" id="3572915">//&nbsp;printValue&nbsp;writes&nbsp;the&nbsp;textual&nbsp;representation&nbsp;of&nbsp;the&nbsp;value&nbsp;to&nbsp;the&nbsp;output&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3572993">//&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="3573010">func</span>&nbsp;<span class="op" id="3573015">(</span><span class="ident" id="3573016">s</span>&nbsp;<span class="op" id="3573018">*</span><span class="ident" id="3573019">state</span><span class="op" id="3573024">)</span>&nbsp;<span class="ident" id="3573026">printValue</span><span class="op" id="3573036">(</span><span class="ident" id="3573037">n</span>&nbsp;<span class="ident" id="3573039">parse</span><span class="op" id="3573044">.</span><span class="ident" id="3573045">Node</span><span class="op" id="3573049">,</span>&nbsp;<span class="ident" id="3573051">v</span>&nbsp;<span class="ident" id="3573053">reflect</span><span class="op" id="3573060">.</span><span class="ident" id="3573061">Value</span><span class="op" id="3573066">)</span>&nbsp;<span class="op" id="3573068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3573071">s</span><span class="op" id="3573072">.</span><span class="ident" id="3573073">at</span><span class="op" id="3573075">(</span><span class="ident" id="3573076">n</span><span class="op" id="3573077">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3573080">iface</span><span class="op" id="3573085">,</span>&nbsp;<span class="ident" id="3573087">ok</span>&nbsp;<span class="op" id="3573090">:=</span>&nbsp;<span class="ident" id="3573093">printableValue</span><span class="op" id="3573107">(</span><span class="ident" id="3573108">v</span><span class="op" id="3573109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3573112">if</span>&nbsp;<span class="op" id="3573115">!</span><span class="ident" id="3573116">ok</span>&nbsp;<span class="op" id="3573119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3573123">s</span><span class="op" id="3573124">.</span><span class="ident" id="3573125">errorf</span><span class="op" id="3573131">(</span><span class="string" id="3573132">&#34;can&#39;t&nbsp;print&nbsp;%s&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="3573159">,</span>&nbsp;<span class="ident" id="3573161">n</span><span class="op" id="3573162">,</span>&nbsp;<span class="ident" id="3573164">v</span><span class="op" id="3573165">.</span><span class="ident" id="3573166">Type</span><span class="op" id="3573170">(</span><span class="op" id="3573171">)</span><span class="op" id="3573172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3573175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3573178">fmt</span><span class="op" id="3573181">.</span><span class="ident" id="3573182">Fprint</span><span class="op" id="3573188">(</span><span class="ident" id="3573189">s</span><span class="op" id="3573190">.</span><span class="ident" id="3573191">wr</span><span class="op" id="3573193">,</span>&nbsp;<span class="ident" id="3573195">iface</span><span class="op" id="3573200">)</span><br>
<span class="lineno">780</span><span class="op" id="3573202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3573205">//&nbsp;printableValue&nbsp;returns&nbsp;the,&nbsp;possibly&nbsp;indirected,&nbsp;interface&nbsp;value&nbsp;inside&nbsp;v&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="3573287">//&nbsp;is&nbsp;best&nbsp;for&nbsp;a&nbsp;call&nbsp;to&nbsp;formatted&nbsp;printer.</span><br>
<span class="lineno"></span><span class="keyword" id="3573331">func</span>&nbsp;<span class="ident" id="3573336">printableValue</span><span class="op" id="3573350">(</span><span class="ident" id="3573351">v</span>&nbsp;<span class="ident" id="3573353">reflect</span><span class="op" id="3573360">.</span><span class="ident" id="3573361">Value</span><span class="op" id="3573366">)</span>&nbsp;<span class="op" id="3573368">(</span><span class="keyword" id="3573369">interface</span><span class="op" id="3573378">{</span><span class="op" id="3573379">}</span><span class="op" id="3573380">,</span>&nbsp;<span class="builtintype" id="3573382">bool</span><span class="op" id="3573386">)</span>&nbsp;<span class="op" id="3573388">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3573391">if</span>&nbsp;<span class="ident" id="3573394">v</span><span class="op" id="3573395">.</span><span class="ident" id="3573396">Kind</span><span class="op" id="3573400">(</span><span class="op" id="3573401">)</span>&nbsp;<span class="op" id="3573403">==</span>&nbsp;<span class="ident" id="3573406">reflect</span><span class="op" id="3573413">.</span><span class="ident" id="3573414">Ptr</span>&nbsp;<span class="op" id="3573418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3573422">v</span><span class="op" id="3573423">,</span>&nbsp;<span class="ident" id="3573425">_</span>&nbsp;<span class="op" id="3573427">=</span>&nbsp;<span class="ident" id="3573429">indirect</span><span class="op" id="3573437">(</span><span class="ident" id="3573438">v</span><span class="op" id="3573439">)</span>&nbsp;<span class="comment" id="3573441">//&nbsp;fmt.Fprint&nbsp;handles&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3573469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3573472">if</span>&nbsp;<span class="op" id="3573475">!</span><span class="ident" id="3573476">v</span><span class="op" id="3573477">.</span><span class="ident" id="3573478">IsValid</span><span class="op" id="3573485">(</span><span class="op" id="3573486">)</span>&nbsp;<span class="op" id="3573488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3573492">return</span>&nbsp;<span class="string" id="3573499">&#34;&lt;no&nbsp;value&gt;&#34;</span><span class="op" id="3573511">,</span>&nbsp;<span class="builtintype" id="3573513">true</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3573519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3573523">if</span>&nbsp;<span class="op" id="3573526">!</span><span class="ident" id="3573527">v</span><span class="op" id="3573528">.</span><span class="ident" id="3573529">Type</span><span class="op" id="3573533">(</span><span class="op" id="3573534">)</span><span class="op" id="3573535">.</span><span class="ident" id="3573536">Implements</span><span class="op" id="3573546">(</span><span class="ident" id="3573547">errorType</span><span class="op" id="3573556">)</span>&nbsp;<span class="op" id="3573558">&amp;&amp;</span>&nbsp;<span class="op" id="3573561">!</span><span class="ident" id="3573562">v</span><span class="op" id="3573563">.</span><span class="ident" id="3573564">Type</span><span class="op" id="3573568">(</span><span class="op" id="3573569">)</span><span class="op" id="3573570">.</span><span class="ident" id="3573571">Implements</span><span class="op" id="3573581">(</span><span class="ident" id="3573582">fmtStringerType</span><span class="op" id="3573597">)</span>&nbsp;<span class="op" id="3573599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3573603">if</span>&nbsp;<span class="ident" id="3573606">v</span><span class="op" id="3573607">.</span><span class="ident" id="3573608">CanAddr</span><span class="op" id="3573615">(</span><span class="op" id="3573616">)</span>&nbsp;<span class="op" id="3573618">&amp;&amp;</span>&nbsp;<span class="op" id="3573621">(</span><span class="ident" id="3573622">reflect</span><span class="op" id="3573629">.</span><span class="ident" id="3573630">PtrTo</span><span class="op" id="3573635">(</span><span class="ident" id="3573636">v</span><span class="op" id="3573637">.</span><span class="ident" id="3573638">Type</span><span class="op" id="3573642">(</span><span class="op" id="3573643">)</span><span class="op" id="3573644">)</span><span class="op" id="3573645">.</span><span class="ident" id="3573646">Implements</span><span class="op" id="3573656">(</span><span class="ident" id="3573657">errorType</span><span class="op" id="3573666">)</span>&nbsp;<span class="op" id="3573668">||</span>&nbsp;<span class="ident" id="3573671">reflect</span><span class="op" id="3573678">.</span><span class="ident" id="3573679">PtrTo</span><span class="op" id="3573684">(</span><span class="ident" id="3573685">v</span><span class="op" id="3573686">.</span><span class="ident" id="3573687">Type</span><span class="op" id="3573691">(</span><span class="op" id="3573692">)</span><span class="op" id="3573693">)</span><span class="op" id="3573694">.</span><span class="ident" id="3573695">Implements</span><span class="op" id="3573705">(</span><span class="ident" id="3573706">fmtStringerType</span><span class="op" id="3573721">)</span><span class="op" id="3573722">)</span>&nbsp;<span class="op" id="3573724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3573729">v</span>&nbsp;<span class="op" id="3573731">=</span>&nbsp;<span class="ident" id="3573733">v</span><span class="op" id="3573734">.</span><span class="ident" id="3573735">Addr</span><span class="op" id="3573739">(</span><span class="op" id="3573740">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3573744">}</span>&nbsp;<span class="keyword" id="3573746">else</span>&nbsp;<span class="op" id="3573751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3573756">switch</span>&nbsp;<span class="ident" id="3573763">v</span><span class="op" id="3573764">.</span><span class="ident" id="3573765">Kind</span><span class="op" id="3573769">(</span><span class="op" id="3573770">)</span>&nbsp;<span class="op" id="3573772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3573777">case</span>&nbsp;<span class="ident" id="3573782">reflect</span><span class="op" id="3573789">.</span><span class="ident" id="3573790">Chan</span><span class="op" id="3573794">,</span>&nbsp;<span class="ident" id="3573796">reflect</span><span class="op" id="3573803">.</span><span class="ident" id="3573804">Func</span><span class="op" id="3573808">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3573814">return</span>&nbsp;<span class="builtintype" id="3573821">nil</span><span class="op" id="3573824">,</span>&nbsp;<span class="builtintype" id="3573826">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3573835">}</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3573839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3573842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3573845">return</span>&nbsp;<span class="ident" id="3573852">v</span><span class="op" id="3573853">.</span><span class="ident" id="3573854">Interface</span><span class="op" id="3573863">(</span><span class="op" id="3573864">)</span><span class="op" id="3573865">,</span>&nbsp;<span class="builtintype" id="3573867">true</span><br>
<span class="lineno"></span><span class="op" id="3573872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="comment" id="3573875">//&nbsp;Types&nbsp;to&nbsp;help&nbsp;sort&nbsp;the&nbsp;keys&nbsp;in&nbsp;a&nbsp;map&nbsp;for&nbsp;reproducible&nbsp;output.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3573941">type</span>&nbsp;<span class="ident" id="3573946">rvs</span>&nbsp;<span class="op" id="3573950">[</span><span class="op" id="3573951">]</span><span class="ident" id="3573952">reflect</span><span class="op" id="3573959">.</span><span class="ident" id="3573960">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3573967">func</span>&nbsp;<span class="op" id="3573972">(</span><span class="ident" id="3573973">x</span>&nbsp;<span class="ident" id="3573975">rvs</span><span class="op" id="3573978">)</span>&nbsp;<span class="ident" id="3573980">Len</span><span class="op" id="3573983">(</span><span class="op" id="3573984">)</span>&nbsp;<span class="builtintype" id="3573986">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3573995">{</span>&nbsp;<span class="keyword" id="3573997">return</span>&nbsp;<span class="builtinfunc" id="3574004">len</span><span class="op" id="3574007">(</span><span class="ident" id="3574008">x</span><span class="op" id="3574009">)</span>&nbsp;<span class="op" id="3574011">}</span><br>
<span class="lineno">810</span><span class="keyword" id="3574013">func</span>&nbsp;<span class="op" id="3574018">(</span><span class="ident" id="3574019">x</span>&nbsp;<span class="ident" id="3574021">rvs</span><span class="op" id="3574024">)</span>&nbsp;<span class="ident" id="3574026">Swap</span><span class="op" id="3574030">(</span><span class="ident" id="3574031">i</span><span class="op" id="3574032">,</span>&nbsp;<span class="ident" id="3574034">j</span>&nbsp;<span class="builtintype" id="3574036">int</span><span class="op" id="3574039">)</span>&nbsp;<span class="op" id="3574041">{</span>&nbsp;<span class="ident" id="3574043">x</span><span class="op" id="3574044">[</span><span class="ident" id="3574045">i</span><span class="op" id="3574046">]</span><span class="op" id="3574047">,</span>&nbsp;<span class="ident" id="3574049">x</span><span class="op" id="3574050">[</span><span class="ident" id="3574051">j</span><span class="op" id="3574052">]</span>&nbsp;<span class="op" id="3574054">=</span>&nbsp;<span class="ident" id="3574056">x</span><span class="op" id="3574057">[</span><span class="ident" id="3574058">j</span><span class="op" id="3574059">]</span><span class="op" id="3574060">,</span>&nbsp;<span class="ident" id="3574062">x</span><span class="op" id="3574063">[</span><span class="ident" id="3574064">i</span><span class="op" id="3574065">]</span>&nbsp;<span class="op" id="3574067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3574070">type</span>&nbsp;<span class="ident" id="3574075">rvInts</span>&nbsp;<span class="keyword" id="3574082">struct</span><span class="op" id="3574088">{</span>&nbsp;<span class="ident" id="3574090">rvs</span>&nbsp;<span class="op" id="3574094">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3574097">func</span>&nbsp;<span class="op" id="3574102">(</span><span class="ident" id="3574103">x</span>&nbsp;<span class="ident" id="3574105">rvInts</span><span class="op" id="3574111">)</span>&nbsp;<span class="ident" id="3574113">Less</span><span class="op" id="3574117">(</span><span class="ident" id="3574118">i</span><span class="op" id="3574119">,</span>&nbsp;<span class="ident" id="3574121">j</span>&nbsp;<span class="builtintype" id="3574123">int</span><span class="op" id="3574126">)</span>&nbsp;<span class="builtintype" id="3574128">bool</span>&nbsp;<span class="op" id="3574133">{</span>&nbsp;<span class="keyword" id="3574135">return</span>&nbsp;<span class="ident" id="3574142">x</span><span class="op" id="3574143">.</span><span class="ident" id="3574144">rvs</span><span class="op" id="3574147">[</span><span class="ident" id="3574148">i</span><span class="op" id="3574149">]</span><span class="op" id="3574150">.</span><span class="ident" id="3574151">Int</span><span class="op" id="3574154">(</span><span class="op" id="3574155">)</span>&nbsp;<span class="op" id="3574157">&lt;</span>&nbsp;<span class="ident" id="3574159">x</span><span class="op" id="3574160">.</span><span class="ident" id="3574161">rvs</span><span class="op" id="3574164">[</span><span class="ident" id="3574165">j</span><span class="op" id="3574166">]</span><span class="op" id="3574167">.</span><span class="ident" id="3574168">Int</span><span class="op" id="3574171">(</span><span class="op" id="3574172">)</span>&nbsp;<span class="op" id="3574174">}</span><br>
<span class="lineno">815</span><br>
<span class="lineno"></span><span class="keyword" id="3574177">type</span>&nbsp;<span class="ident" id="3574182">rvUints</span>&nbsp;<span class="keyword" id="3574190">struct</span><span class="op" id="3574196">{</span>&nbsp;<span class="ident" id="3574198">rvs</span>&nbsp;<span class="op" id="3574202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3574205">func</span>&nbsp;<span class="op" id="3574210">(</span><span class="ident" id="3574211">x</span>&nbsp;<span class="ident" id="3574213">rvUints</span><span class="op" id="3574220">)</span>&nbsp;<span class="ident" id="3574222">Less</span><span class="op" id="3574226">(</span><span class="ident" id="3574227">i</span><span class="op" id="3574228">,</span>&nbsp;<span class="ident" id="3574230">j</span>&nbsp;<span class="builtintype" id="3574232">int</span><span class="op" id="3574235">)</span>&nbsp;<span class="builtintype" id="3574237">bool</span>&nbsp;<span class="op" id="3574242">{</span>&nbsp;<span class="keyword" id="3574244">return</span>&nbsp;<span class="ident" id="3574251">x</span><span class="op" id="3574252">.</span><span class="ident" id="3574253">rvs</span><span class="op" id="3574256">[</span><span class="ident" id="3574257">i</span><span class="op" id="3574258">]</span><span class="op" id="3574259">.</span><span class="ident" id="3574260">Uint</span><span class="op" id="3574264">(</span><span class="op" id="3574265">)</span>&nbsp;<span class="op" id="3574267">&lt;</span>&nbsp;<span class="ident" id="3574269">x</span><span class="op" id="3574270">.</span><span class="ident" id="3574271">rvs</span><span class="op" id="3574274">[</span><span class="ident" id="3574275">j</span><span class="op" id="3574276">]</span><span class="op" id="3574277">.</span><span class="ident" id="3574278">Uint</span><span class="op" id="3574282">(</span><span class="op" id="3574283">)</span>&nbsp;<span class="op" id="3574285">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">820</span><span class="keyword" id="3574288">type</span>&nbsp;<span class="ident" id="3574293">rvFloats</span>&nbsp;<span class="keyword" id="3574302">struct</span><span class="op" id="3574308">{</span>&nbsp;<span class="ident" id="3574310">rvs</span>&nbsp;<span class="op" id="3574314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3574317">func</span>&nbsp;<span class="op" id="3574322">(</span><span class="ident" id="3574323">x</span>&nbsp;<span class="ident" id="3574325">rvFloats</span><span class="op" id="3574333">)</span>&nbsp;<span class="ident" id="3574335">Less</span><span class="op" id="3574339">(</span><span class="ident" id="3574340">i</span><span class="op" id="3574341">,</span>&nbsp;<span class="ident" id="3574343">j</span>&nbsp;<span class="builtintype" id="3574345">int</span><span class="op" id="3574348">)</span>&nbsp;<span class="builtintype" id="3574350">bool</span>&nbsp;<span class="op" id="3574355">{</span>&nbsp;<span class="keyword" id="3574357">return</span>&nbsp;<span class="ident" id="3574364">x</span><span class="op" id="3574365">.</span><span class="ident" id="3574366">rvs</span><span class="op" id="3574369">[</span><span class="ident" id="3574370">i</span><span class="op" id="3574371">]</span><span class="op" id="3574372">.</span><span class="ident" id="3574373">Float</span><span class="op" id="3574378">(</span><span class="op" id="3574379">)</span>&nbsp;<span class="op" id="3574381">&lt;</span>&nbsp;<span class="ident" id="3574383">x</span><span class="op" id="3574384">.</span><span class="ident" id="3574385">rvs</span><span class="op" id="3574388">[</span><span class="ident" id="3574389">j</span><span class="op" id="3574390">]</span><span class="op" id="3574391">.</span><span class="ident" id="3574392">Float</span><span class="op" id="3574397">(</span><span class="op" id="3574398">)</span>&nbsp;<span class="op" id="3574400">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3574403">type</span>&nbsp;<span class="ident" id="3574408">rvStrings</span>&nbsp;<span class="keyword" id="3574418">struct</span><span class="op" id="3574424">{</span>&nbsp;<span class="ident" id="3574426">rvs</span>&nbsp;<span class="op" id="3574430">}</span><br>
<span class="lineno">825</span><br>
<span class="lineno"></span><span class="keyword" id="3574433">func</span>&nbsp;<span class="op" id="3574438">(</span><span class="ident" id="3574439">x</span>&nbsp;<span class="ident" id="3574441">rvStrings</span><span class="op" id="3574450">)</span>&nbsp;<span class="ident" id="3574452">Less</span><span class="op" id="3574456">(</span><span class="ident" id="3574457">i</span><span class="op" id="3574458">,</span>&nbsp;<span class="ident" id="3574460">j</span>&nbsp;<span class="builtintype" id="3574462">int</span><span class="op" id="3574465">)</span>&nbsp;<span class="builtintype" id="3574467">bool</span>&nbsp;<span class="op" id="3574472">{</span>&nbsp;<span class="keyword" id="3574474">return</span>&nbsp;<span class="ident" id="3574481">x</span><span class="op" id="3574482">.</span><span class="ident" id="3574483">rvs</span><span class="op" id="3574486">[</span><span class="ident" id="3574487">i</span><span class="op" id="3574488">]</span><span class="op" id="3574489">.</span><span class="ident" id="3574490">String</span><span class="op" id="3574496">(</span><span class="op" id="3574497">)</span>&nbsp;<span class="op" id="3574499">&lt;</span>&nbsp;<span class="ident" id="3574501">x</span><span class="op" id="3574502">.</span><span class="ident" id="3574503">rvs</span><span class="op" id="3574506">[</span><span class="ident" id="3574507">j</span><span class="op" id="3574508">]</span><span class="op" id="3574509">.</span><span class="ident" id="3574510">String</span><span class="op" id="3574516">(</span><span class="op" id="3574517">)</span>&nbsp;<span class="op" id="3574519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3574522">//&nbsp;sortKeys&nbsp;sorts&nbsp;(if&nbsp;it&nbsp;can)&nbsp;the&nbsp;slice&nbsp;of&nbsp;reflect.Values,&nbsp;which&nbsp;is&nbsp;a&nbsp;slice&nbsp;of&nbsp;map&nbsp;keys.</span><br>
<span class="lineno"></span><span class="keyword" id="3574611">func</span>&nbsp;<span class="ident" id="3574616">sortKeys</span><span class="op" id="3574624">(</span><span class="ident" id="3574625">v</span>&nbsp;<span class="op" id="3574627">[</span><span class="op" id="3574628">]</span><span class="ident" id="3574629">reflect</span><span class="op" id="3574636">.</span><span class="ident" id="3574637">Value</span><span class="op" id="3574642">)</span>&nbsp;<span class="op" id="3574644">[</span><span class="op" id="3574645">]</span><span class="ident" id="3574646">reflect</span><span class="op" id="3574653">.</span><span class="ident" id="3574654">Value</span>&nbsp;<span class="op" id="3574660">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3574663">if</span>&nbsp;<span class="builtinfunc" id="3574666">len</span><span class="op" id="3574669">(</span><span class="ident" id="3574670">v</span><span class="op" id="3574671">)</span>&nbsp;<span class="op" id="3574673">&lt;=</span>&nbsp;<span class="num" id="3574676">1</span>&nbsp;<span class="op" id="3574678">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3574682">return</span>&nbsp;<span class="ident" id="3574689">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3574692">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3574695">switch</span>&nbsp;<span class="ident" id="3574702">v</span><span class="op" id="3574703">[</span><span class="num" id="3574704">0</span><span class="op" id="3574705">]</span><span class="op" id="3574706">.</span><span class="ident" id="3574707">Kind</span><span class="op" id="3574711">(</span><span class="op" id="3574712">)</span>&nbsp;<span class="op" id="3574714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3574717">case</span>&nbsp;<span class="ident" id="3574722">reflect</span><span class="op" id="3574729">.</span><span class="ident" id="3574730">Float32</span><span class="op" id="3574737">,</span>&nbsp;<span class="ident" id="3574739">reflect</span><span class="op" id="3574746">.</span><span class="ident" id="3574747">Float64</span><span class="op" id="3574754">:</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3574758">sort</span><span class="op" id="3574762">.</span><span class="ident" id="3574763">Sort</span><span class="op" id="3574767">(</span><span class="ident" id="3574768">rvFloats</span><span class="op" id="3574776">{</span><span class="ident" id="3574777">v</span><span class="op" id="3574778">}</span><span class="op" id="3574779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3574782">case</span>&nbsp;<span class="ident" id="3574787">reflect</span><span class="op" id="3574794">.</span><span class="ident" id="3574795">Int</span><span class="op" id="3574798">,</span>&nbsp;<span class="ident" id="3574800">reflect</span><span class="op" id="3574807">.</span><span class="ident" id="3574808">Int8</span><span class="op" id="3574812">,</span>&nbsp;<span class="ident" id="3574814">reflect</span><span class="op" id="3574821">.</span><span class="ident" id="3574822">Int16</span><span class="op" id="3574827">,</span>&nbsp;<span class="ident" id="3574829">reflect</span><span class="op" id="3574836">.</span><span class="ident" id="3574837">Int32</span><span class="op" id="3574842">,</span>&nbsp;<span class="ident" id="3574844">reflect</span><span class="op" id="3574851">.</span><span class="ident" id="3574852">Int64</span><span class="op" id="3574857">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3574861">sort</span><span class="op" id="3574865">.</span><span class="ident" id="3574866">Sort</span><span class="op" id="3574870">(</span><span class="ident" id="3574871">rvInts</span><span class="op" id="3574877">{</span><span class="ident" id="3574878">v</span><span class="op" id="3574879">}</span><span class="op" id="3574880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3574883">case</span>&nbsp;<span class="ident" id="3574888">reflect</span><span class="op" id="3574895">.</span><span class="ident" id="3574896">String</span><span class="op" id="3574902">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3574906">sort</span><span class="op" id="3574910">.</span><span class="ident" id="3574911">Sort</span><span class="op" id="3574915">(</span><span class="ident" id="3574916">rvStrings</span><span class="op" id="3574925">{</span><span class="ident" id="3574926">v</span><span class="op" id="3574927">}</span><span class="op" id="3574928">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3574931">case</span>&nbsp;<span class="ident" id="3574936">reflect</span><span class="op" id="3574943">.</span><span class="ident" id="3574944">Uint</span><span class="op" id="3574948">,</span>&nbsp;<span class="ident" id="3574950">reflect</span><span class="op" id="3574957">.</span><span class="ident" id="3574958">Uint8</span><span class="op" id="3574963">,</span>&nbsp;<span class="ident" id="3574965">reflect</span><span class="op" id="3574972">.</span><span class="ident" id="3574973">Uint16</span><span class="op" id="3574979">,</span>&nbsp;<span class="ident" id="3574981">reflect</span><span class="op" id="3574988">.</span><span class="ident" id="3574989">Uint32</span><span class="op" id="3574995">,</span>&nbsp;<span class="ident" id="3574997">reflect</span><span class="op" id="3575004">.</span><span class="ident" id="3575005">Uint64</span><span class="op" id="3575011">,</span>&nbsp;<span class="ident" id="3575013">reflect</span><span class="op" id="3575020">.</span><span class="ident" id="3575021">Uintptr</span><span class="op" id="3575028">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3575032">sort</span><span class="op" id="3575036">.</span><span class="ident" id="3575037">Sort</span><span class="op" id="3575041">(</span><span class="ident" id="3575042">rvUints</span><span class="op" id="3575049">{</span><span class="ident" id="3575050">v</span><span class="op" id="3575051">}</span><span class="op" id="3575052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3575055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3575058">return</span>&nbsp;<span class="ident" id="3575065">v</span><br>
<span class="lineno"></span><span class="op" id="3575067">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
