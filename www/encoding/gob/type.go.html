<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5138178">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5138233">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5138287">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5138338">package</span>&nbsp;<span class="ident" id="5138346">gob</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5138351">import</span>&nbsp;<span class="op" id="5138358">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5138361">&#34;encoding&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5138373">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5138383">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5138390">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5138396">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5138407">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5138415">&#34;sync/atomic&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5138430">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5138441">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5138456">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5138459">//&nbsp;userTypeInfo&nbsp;stores&nbsp;the&nbsp;information&nbsp;associated&nbsp;with&nbsp;a&nbsp;type&nbsp;the&nbsp;user&nbsp;has&nbsp;handed</span><br>
<span class="lineno">20</span><span class="comment" id="5138541">//&nbsp;to&nbsp;the&nbsp;package.&nbsp;&nbsp;It&#39;s&nbsp;computed&nbsp;once&nbsp;and&nbsp;stored&nbsp;in&nbsp;a&nbsp;map&nbsp;keyed&nbsp;by&nbsp;reflection</span><br>
<span class="lineno"></span><span class="comment" id="5138620">//&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="5138629">type</span>&nbsp;<span class="ident" id="5138634">userTypeInfo</span>&nbsp;<span class="keyword" id="5138647">struct</span>&nbsp;<span class="op" id="5138654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138657">user</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138669"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5138676">.</span><span class="ident" id="5138677">Type</span>&nbsp;<span class="comment" id="5138682">//&nbsp;the&nbsp;type&nbsp;the&nbsp;user&nbsp;handed&nbsp;us</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138714">base</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5138726"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5138733">.</span><span class="ident" id="5138734">Type</span>&nbsp;<span class="comment" id="5138739">//&nbsp;the&nbsp;base&nbsp;type&nbsp;after&nbsp;all&nbsp;indirections</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138780">indir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5138792">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5138805">//&nbsp;number&nbsp;of&nbsp;indirections&nbsp;to&nbsp;reach&nbsp;the&nbsp;base&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138855">externalEnc</span>&nbsp;<span class="builtintype" id="5138867">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5138880">//&nbsp;xGob,&nbsp;xBinary,&nbsp;or&nbsp;xText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138908">externalDec</span>&nbsp;<span class="builtintype" id="5138920">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5138933">//&nbsp;xGob,&nbsp;xBinary&nbsp;or&nbsp;xText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5138960">encIndir</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5138972">int8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5138985">//&nbsp;number&nbsp;of&nbsp;indirections&nbsp;to&nbsp;reach&nbsp;the&nbsp;receiver&nbsp;type;&nbsp;may&nbsp;be&nbsp;negative</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139056">decIndir</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5139068">int8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5139081">//&nbsp;number&nbsp;of&nbsp;indirections&nbsp;to&nbsp;reach&nbsp;the&nbsp;receiver&nbsp;type;&nbsp;may&nbsp;be&nbsp;negative</span><br>
<span class="lineno">30</span><span class="op" id="5139151">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5139154">//&nbsp;externalEncoding&nbsp;bits</span><br>
<span class="lineno"></span><span class="keyword" id="5139179">const</span>&nbsp;<span class="op" id="5139185">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139188">xGob</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5139196">=</span>&nbsp;<span class="num" id="5139198">1</span>&nbsp;<span class="op" id="5139200">+</span>&nbsp;<span class="ident" id="5139202">iota</span>&nbsp;<span class="comment" id="5139207">//&nbsp;GobEncoder&nbsp;or&nbsp;GobDecoder</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139236">xBinary</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5139255">//&nbsp;encoding.BinaryMarshaler&nbsp;or&nbsp;encoding.BinaryUnmarshaler</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139314">xText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5139333">//&nbsp;encoding.TextMarshaler&nbsp;or&nbsp;encoding.TextUnmarshaler</span><br>
<span class="lineno"></span><span class="op" id="5139387">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5139390">var</span>&nbsp;<span class="op" id="5139394">(</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5139397">//&nbsp;Protected&nbsp;by&nbsp;an&nbsp;RWMutex&nbsp;because&nbsp;we&nbsp;read&nbsp;it&nbsp;a&nbsp;lot&nbsp;and&nbsp;write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5139460">//&nbsp;it&nbsp;only&nbsp;when&nbsp;we&nbsp;see&nbsp;a&nbsp;new&nbsp;type,&nbsp;typically&nbsp;when&nbsp;compiling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139522">userTypeLock</span>&nbsp;&nbsp;<span class="ident" id="5139536"><a href="/encoding/gob/type.go.html#5138407">sync</a></span><span class="op" id="5139540">.</span><span class="ident" id="5139541">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139550">userTypeCache</span>&nbsp;<span class="op" id="5139564">=</span>&nbsp;<span class="builtinfunc" id="5139566">make</span><span class="op" id="5139570">(</span><span class="keyword" id="5139571">map</span><span class="op" id="5139574">[</span><span class="ident" id="5139575"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5139582">.</span><span class="ident" id="5139583">Type</span><span class="op" id="5139587">]</span><span class="op" id="5139588">*</span><span class="ident" id="5139589"><a href="/encoding/gob/type.go.html#5138634">userTypeInfo</a></span><span class="op" id="5139601">)</span><br>
<span class="lineno"></span><span class="op" id="5139603">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="5139606">//&nbsp;validType&nbsp;returns,&nbsp;and&nbsp;saves,&nbsp;the&nbsp;information&nbsp;associated&nbsp;with&nbsp;user-provided&nbsp;type&nbsp;rt.</span><br>
<span class="lineno"></span><span class="comment" id="5139694">//&nbsp;If&nbsp;the&nbsp;user&nbsp;type&nbsp;is&nbsp;not&nbsp;valid,&nbsp;err&nbsp;will&nbsp;be&nbsp;non-nil.&nbsp;&nbsp;To&nbsp;be&nbsp;used&nbsp;when&nbsp;the&nbsp;error&nbsp;handler</span><br>
<span class="lineno"></span><span class="comment" id="5139784">//&nbsp;is&nbsp;not&nbsp;set&nbsp;up.</span><br>
<span class="lineno"></span><span class="keyword" id="5139802">func</span>&nbsp;<span class="ident" id="5139807">validUserType</span><span class="op" id="5139820">(</span><span class="ident" id="5139821">rt</span>&nbsp;<span class="ident" id="5139824"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5139831">.</span><span class="ident" id="5139832">Type</span><span class="op" id="5139836">)</span>&nbsp;<span class="op" id="5139838">(</span><span class="ident" id="5139839">ut</span>&nbsp;<span class="op" id="5139842">*</span><span class="ident" id="5139843"><a href="/encoding/gob/type.go.html#5138634">userTypeInfo</a></span><span class="op" id="5139855">,</span>&nbsp;<span class="ident" id="5139857">err</span>&nbsp;<span class="builtintype" id="5139861">error</span><span class="op" id="5139866">)</span>&nbsp;<span class="op" id="5139868">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139871"><a href="/encoding/gob/type.go.html#5139522">userTypeLock</a></span><span class="op" id="5139883">.</span><span class="ident" id="5139884">RLock</span><span class="op" id="5139889">(</span><span class="op" id="5139890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139893"><a href="/encoding/gob/type.go.html#5139839">ut</a></span>&nbsp;<span class="op" id="5139896">=</span>&nbsp;<span class="ident" id="5139898"><a href="/encoding/gob/type.go.html#5139550">userTypeCache</a></span><span class="op" id="5139911">[</span><span class="ident" id="5139912"><a href="/encoding/gob/type.go.html#5139821">rt</a></span><span class="op" id="5139914">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5139917"><a href="/encoding/gob/type.go.html#5139522">userTypeLock</a></span><span class="op" id="5139929">.</span><span class="ident" id="5139930">RUnlock</span><span class="op" id="5139937">(</span><span class="op" id="5139938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5139941">if</span>&nbsp;<span class="ident" id="5139944"><a href="/encoding/gob/type.go.html#5139839">ut</a></span>&nbsp;<span class="op" id="5139947">!=</span>&nbsp;<span class="ident" id="5139950">nil</span>&nbsp;<span class="op" id="5139954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5139958">return</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5139966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5139969">//&nbsp;Now&nbsp;set&nbsp;the&nbsp;value&nbsp;under&nbsp;the&nbsp;write&nbsp;lock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140013"><a href="/encoding/gob/type.go.html#5139522">userTypeLock</a></span><span class="op" id="5140025">.</span><span class="ident" id="5140026">Lock</span><span class="op" id="5140030">(</span><span class="op" id="5140031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140034">defer</span>&nbsp;<span class="ident" id="5140040"><a href="/encoding/gob/type.go.html#5139522">userTypeLock</a></span><span class="op" id="5140052">.</span><span class="ident" id="5140053">Unlock</span><span class="op" id="5140059">(</span><span class="op" id="5140060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140063">if</span>&nbsp;<span class="ident" id="5140066"><a href="/encoding/gob/type.go.html#5139839">ut</a></span>&nbsp;<span class="op" id="5140069">=</span>&nbsp;<span class="ident" id="5140071"><a href="/encoding/gob/type.go.html#5139550">userTypeCache</a></span><span class="op" id="5140084">[</span><span class="ident" id="5140085"><a href="/encoding/gob/type.go.html#5139821">rt</a></span><span class="op" id="5140087">]</span><span class="op" id="5140088">;</span>&nbsp;<span class="ident" id="5140090"><a href="/encoding/gob/type.go.html#5139839">ut</a></span>&nbsp;<span class="op" id="5140093">!=</span>&nbsp;<span class="ident" id="5140096">nil</span>&nbsp;<span class="op" id="5140100">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140104">//&nbsp;Lost&nbsp;the&nbsp;race;&nbsp;not&nbsp;a&nbsp;problem.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140139">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5140147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140150"><a href="/encoding/gob/type.go.html#5139839">ut</a></span>&nbsp;<span class="op" id="5140153">=</span>&nbsp;<span class="builtinfunc" id="5140155">new</span><span class="op" id="5140158">(</span><span class="ident" id="5140159"><a href="/encoding/gob/type.go.html#5138634">userTypeInfo</a></span><span class="op" id="5140171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140174"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5140176">.</span><span class="ident" id="5140177">base</span>&nbsp;<span class="op" id="5140182">=</span>&nbsp;<span class="ident" id="5140184"><a href="/encoding/gob/type.go.html#5139821">rt</a></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140188"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5140190">.</span><span class="ident" id="5140191">user</span>&nbsp;<span class="op" id="5140196">=</span>&nbsp;<span class="ident" id="5140198"><a href="/encoding/gob/type.go.html#5139821">rt</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140202">//&nbsp;A&nbsp;type&nbsp;that&nbsp;is&nbsp;just&nbsp;a&nbsp;cycle&nbsp;of&nbsp;pointers&nbsp;(such&nbsp;as&nbsp;type&nbsp;T&nbsp;*T)&nbsp;cannot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140273">//&nbsp;be&nbsp;represented&nbsp;in&nbsp;gobs,&nbsp;which&nbsp;need&nbsp;some&nbsp;concrete&nbsp;data.&nbsp;&nbsp;We&nbsp;use&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140342">//&nbsp;cycle&nbsp;detection&nbsp;algorithm&nbsp;from&nbsp;Knuth,&nbsp;Vol&nbsp;2,&nbsp;Section&nbsp;3.1,&nbsp;Ex&nbsp;6,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140410">//&nbsp;pp&nbsp;539-540.&nbsp;&nbsp;As&nbsp;we&nbsp;step&nbsp;through&nbsp;indirections,&nbsp;run&nbsp;another&nbsp;type&nbsp;at</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140480">//&nbsp;half&nbsp;speed.&nbsp;If&nbsp;they&nbsp;meet&nbsp;up,&nbsp;there&#39;s&nbsp;a&nbsp;cycle.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140530">slowpoke</span>&nbsp;<span class="op" id="5140539">:=</span>&nbsp;<span class="ident" id="5140542"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5140544">.</span><span class="ident" id="5140545">base</span>&nbsp;<span class="comment" id="5140550">//&nbsp;walks&nbsp;half&nbsp;as&nbsp;fast&nbsp;as&nbsp;ut.base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140584">for</span>&nbsp;<span class="op" id="5140588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140592">pt</span>&nbsp;<span class="op" id="5140595">:=</span>&nbsp;<span class="ident" id="5140598"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5140600">.</span><span class="ident" id="5140601">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140608">if</span>&nbsp;<span class="ident" id="5140611"><a href="/encoding/gob/type.go.html#5140592">pt</a></span><span class="op" id="5140613">.</span><span class="ident" id="5140614">Kind</span><span class="op" id="5140618">(</span><span class="op" id="5140619">)</span>&nbsp;<span class="op" id="5140621">!=</span>&nbsp;<span class="ident" id="5140624"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5140631">.</span><span class="ident" id="5140632">Ptr</span>&nbsp;<span class="op" id="5140636">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140641">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5140649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140653"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5140655">.</span><span class="ident" id="5140656">base</span>&nbsp;<span class="op" id="5140661">=</span>&nbsp;<span class="ident" id="5140663"><a href="/encoding/gob/type.go.html#5140592">pt</a></span><span class="op" id="5140665">.</span><span class="ident" id="5140666">Elem</span><span class="op" id="5140670">(</span><span class="op" id="5140671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140675">if</span>&nbsp;<span class="ident" id="5140678"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5140680">.</span><span class="ident" id="5140681">base</span>&nbsp;<span class="op" id="5140686">==</span>&nbsp;<span class="ident" id="5140689"><a href="/encoding/gob/type.go.html#5140530">slowpoke</a></span>&nbsp;<span class="op" id="5140698">{</span>&nbsp;<span class="comment" id="5140700">//&nbsp;ut.base&nbsp;lapped&nbsp;slowpoke</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5140730">//&nbsp;recursive&nbsp;pointer&nbsp;type.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140760">return</span>&nbsp;<span class="ident" id="5140767">nil</span><span class="op" id="5140770">,</span>&nbsp;<span class="ident" id="5140772"><a href="/encoding/gob/type.go.html#5138373">errors</a></span><span class="op" id="5140778">.</span><span class="ident" id="5140779">New</span><span class="op" id="5140782">(</span><span class="string" id="5140783">&#34;can&#39;t&nbsp;represent&nbsp;recursive&nbsp;pointer&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="5140825">+</span>&nbsp;<span class="ident" id="5140827"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5140829">.</span><span class="ident" id="5140830">base</span><span class="op" id="5140834">.</span><span class="ident" id="5140835">String</span><span class="op" id="5140841">(</span><span class="op" id="5140842">)</span><span class="op" id="5140843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5140847">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140851">if</span>&nbsp;<span class="ident" id="5140854"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5140856">.</span><span class="ident" id="5140857">indir</span><span class="op" id="5140862">%</span><span class="num" id="5140863">2</span>&nbsp;<span class="op" id="5140865">==</span>&nbsp;<span class="num" id="5140868">0</span>&nbsp;<span class="op" id="5140870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140875"><a href="/encoding/gob/type.go.html#5140530">slowpoke</a></span>&nbsp;<span class="op" id="5140884">=</span>&nbsp;<span class="ident" id="5140886"><a href="/encoding/gob/type.go.html#5140530">slowpoke</a></span><span class="op" id="5140894">.</span><span class="ident" id="5140895">Elem</span><span class="op" id="5140899">(</span><span class="op" id="5140900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5140904">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5140908"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5140910">.</span><span class="ident" id="5140911">indir</span><span class="op" id="5140916">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5140920">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5140924">if</span>&nbsp;<span class="ident" id="5140927">ok</span><span class="op" id="5140929">,</span>&nbsp;<span class="ident" id="5140931">indir</span>&nbsp;<span class="op" id="5140937">:=</span>&nbsp;<span class="ident" id="5140940"><a href="/encoding/gob/type.go.html#5142655">implementsInterface</a></span><span class="op" id="5140959">(</span><span class="ident" id="5140960"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5140962">.</span><span class="ident" id="5140963">user</span><span class="op" id="5140967">,</span>&nbsp;<span class="ident" id="5140969"><a href="/encoding/gob/type.go.html#5141949">gobEncoderInterfaceType</a></span><span class="op" id="5140992">)</span><span class="op" id="5140993">;</span>&nbsp;<span class="ident" id="5140995"><a href="/encoding/gob/type.go.html#5140927">ok</a></span>&nbsp;<span class="op" id="5140998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141002"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5141004">.</span><span class="ident" id="5141005">externalEnc</span><span class="op" id="5141016">,</span>&nbsp;<span class="ident" id="5141018"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5141020">.</span><span class="ident" id="5141021">encIndir</span>&nbsp;<span class="op" id="5141030">=</span>&nbsp;<span class="ident" id="5141032"><a href="/encoding/gob/type.go.html#5139188">xGob</a></span><span class="op" id="5141036">,</span>&nbsp;<span class="ident" id="5141038"><a href="/encoding/gob/type.go.html#5140931">indir</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5141045">}</span>&nbsp;<span class="keyword" id="5141047">else</span>&nbsp;<span class="keyword" id="5141052">if</span>&nbsp;<span class="ident" id="5141055">ok</span><span class="op" id="5141057">,</span>&nbsp;<span class="ident" id="5141059">indir</span>&nbsp;<span class="op" id="5141065">:=</span>&nbsp;<span class="ident" id="5141068"><a href="/encoding/gob/type.go.html#5142655">implementsInterface</a></span><span class="op" id="5141087">(</span><span class="ident" id="5141088"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5141090">.</span><span class="ident" id="5141091">user</span><span class="op" id="5141095">,</span>&nbsp;<span class="ident" id="5141097"><a href="/encoding/gob/type.go.html#5142101">binaryMarshalerInterfaceType</a></span><span class="op" id="5141125">)</span><span class="op" id="5141126">;</span>&nbsp;<span class="ident" id="5141128"><a href="/encoding/gob/type.go.html#5141055">ok</a></span>&nbsp;<span class="op" id="5141131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141135"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5141137">.</span><span class="ident" id="5141138">externalEnc</span><span class="op" id="5141149">,</span>&nbsp;<span class="ident" id="5141151"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5141153">.</span><span class="ident" id="5141154">encIndir</span>&nbsp;<span class="op" id="5141163">=</span>&nbsp;<span class="ident" id="5141165"><a href="/encoding/gob/type.go.html#5139236">xBinary</a></span><span class="op" id="5141172">,</span>&nbsp;<span class="ident" id="5141174"><a href="/encoding/gob/type.go.html#5141059">indir</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5141181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5141185">//&nbsp;NOTE(rsc):&nbsp;Would&nbsp;like&nbsp;to&nbsp;allow&nbsp;MarshalText&nbsp;here,&nbsp;but&nbsp;results&nbsp;in&nbsp;incompatibility</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5141269">//&nbsp;with&nbsp;older&nbsp;encodings&nbsp;for&nbsp;net.IP.&nbsp;See&nbsp;golang.org/issue/6760.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5141333">//&nbsp;}&nbsp;else&nbsp;if&nbsp;ok,&nbsp;indir&nbsp;:=&nbsp;implementsInterface(ut.user,&nbsp;textMarshalerInterfaceType);&nbsp;ok&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5141423">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsput.externalEnc,&nbsp;ut.encIndir&nbsp;=&nbsp;xText,&nbsp;indir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5141471">//&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141478">if</span>&nbsp;<span class="ident" id="5141481">ok</span><span class="op" id="5141483">,</span>&nbsp;<span class="ident" id="5141485">indir</span>&nbsp;<span class="op" id="5141491">:=</span>&nbsp;<span class="ident" id="5141494"><a href="/encoding/gob/type.go.html#5142655">implementsInterface</a></span><span class="op" id="5141513">(</span><span class="ident" id="5141514"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5141516">.</span><span class="ident" id="5141517">user</span><span class="op" id="5141521">,</span>&nbsp;<span class="ident" id="5141523"><a href="/encoding/gob/type.go.html#5142025">gobDecoderInterfaceType</a></span><span class="op" id="5141546">)</span><span class="op" id="5141547">;</span>&nbsp;<span class="ident" id="5141549"><a href="/encoding/gob/type.go.html#5141481">ok</a></span>&nbsp;<span class="op" id="5141552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141556"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5141558">.</span><span class="ident" id="5141559">externalDec</span><span class="op" id="5141570">,</span>&nbsp;<span class="ident" id="5141572"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5141574">.</span><span class="ident" id="5141575">decIndir</span>&nbsp;<span class="op" id="5141584">=</span>&nbsp;<span class="ident" id="5141586"><a href="/encoding/gob/type.go.html#5139188">xGob</a></span><span class="op" id="5141590">,</span>&nbsp;<span class="ident" id="5141592"><a href="/encoding/gob/type.go.html#5141485">indir</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5141599">}</span>&nbsp;<span class="keyword" id="5141601">else</span>&nbsp;<span class="keyword" id="5141606">if</span>&nbsp;<span class="ident" id="5141609">ok</span><span class="op" id="5141611">,</span>&nbsp;<span class="ident" id="5141613">indir</span>&nbsp;<span class="op" id="5141619">:=</span>&nbsp;<span class="ident" id="5141622"><a href="/encoding/gob/type.go.html#5142655">implementsInterface</a></span><span class="op" id="5141641">(</span><span class="ident" id="5141642"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5141644">.</span><span class="ident" id="5141645">user</span><span class="op" id="5141649">,</span>&nbsp;<span class="ident" id="5141651"><a href="/encoding/gob/type.go.html#5142191">binaryUnmarshalerInterfaceType</a></span><span class="op" id="5141681">)</span><span class="op" id="5141682">;</span>&nbsp;<span class="ident" id="5141684"><a href="/encoding/gob/type.go.html#5141609">ok</a></span>&nbsp;<span class="op" id="5141687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141691"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5141693">.</span><span class="ident" id="5141694">externalDec</span><span class="op" id="5141705">,</span>&nbsp;<span class="ident" id="5141707"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><span class="op" id="5141709">.</span><span class="ident" id="5141710">decIndir</span>&nbsp;<span class="op" id="5141719">=</span>&nbsp;<span class="ident" id="5141721"><a href="/encoding/gob/type.go.html#5139236">xBinary</a></span><span class="op" id="5141728">,</span>&nbsp;<span class="ident" id="5141730"><a href="/encoding/gob/type.go.html#5141613">indir</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5141737">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5141741">//&nbsp;See&nbsp;note&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5141761">//&nbsp;}&nbsp;else&nbsp;if&nbsp;ok,&nbsp;indir&nbsp;:=&nbsp;implementsInterface(ut.user,&nbsp;textUnmarshalerInterfaceType);&nbsp;ok&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5141853">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsput.externalDec,&nbsp;ut.decIndir&nbsp;=&nbsp;xText,&nbsp;indir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5141901">//&nbsp;}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141908"><a href="/encoding/gob/type.go.html#5139550">userTypeCache</a></span><span class="op" id="5141921">[</span><span class="ident" id="5141922"><a href="/encoding/gob/type.go.html#5139821">rt</a></span><span class="op" id="5141924">]</span>&nbsp;<span class="op" id="5141926">=</span>&nbsp;<span class="ident" id="5141928"><a href="/encoding/gob/type.go.html#5139839">ut</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5141932">return</span><br>
<span class="lineno"></span><span class="op" id="5141939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="5141942">var</span>&nbsp;<span class="op" id="5141946">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5141949">gobEncoderInterfaceType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5141980">=</span>&nbsp;<span class="ident" id="5141982"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5141989">.</span><span class="ident" id="5141990">TypeOf</span><span class="op" id="5141996">(</span><span class="op" id="5141997">(</span><span class="op" id="5141998">*</span><span class="ident" id="5141999"><a href="/encoding/gob/type.go.html#5161535">GobEncoder</a></span><span class="op" id="5142009">)</span><span class="op" id="5142010">(</span><span class="ident" id="5142011">nil</span><span class="op" id="5142014">)</span><span class="op" id="5142015">)</span><span class="op" id="5142016">.</span><span class="ident" id="5142017">Elem</span><span class="op" id="5142021">(</span><span class="op" id="5142022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142025">gobDecoderInterfaceType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5142056">=</span>&nbsp;<span class="ident" id="5142058"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5142065">.</span><span class="ident" id="5142066">TypeOf</span><span class="op" id="5142072">(</span><span class="op" id="5142073">(</span><span class="op" id="5142074">*</span><span class="ident" id="5142075"><a href="/encoding/gob/type.go.html#5161883">GobDecoder</a></span><span class="op" id="5142085">)</span><span class="op" id="5142086">(</span><span class="ident" id="5142087">nil</span><span class="op" id="5142090">)</span><span class="op" id="5142091">)</span><span class="op" id="5142092">.</span><span class="ident" id="5142093">Elem</span><span class="op" id="5142097">(</span><span class="op" id="5142098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142101">binaryMarshalerInterfaceType</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5142132">=</span>&nbsp;<span class="ident" id="5142134"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5142141">.</span><span class="ident" id="5142142">TypeOf</span><span class="op" id="5142148">(</span><span class="op" id="5142149">(</span><span class="op" id="5142150">*</span><span class="ident" id="5142151"><a href="/encoding/gob/type.go.html#5138361">encoding</a></span><span class="op" id="5142159">.</span><span class="ident" id="5142160">BinaryMarshaler</span><span class="op" id="5142175">)</span><span class="op" id="5142176">(</span><span class="ident" id="5142177">nil</span><span class="op" id="5142180">)</span><span class="op" id="5142181">)</span><span class="op" id="5142182">.</span><span class="ident" id="5142183">Elem</span><span class="op" id="5142187">(</span><span class="op" id="5142188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142191">binaryUnmarshalerInterfaceType</span>&nbsp;<span class="op" id="5142222">=</span>&nbsp;<span class="ident" id="5142224"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5142231">.</span><span class="ident" id="5142232">TypeOf</span><span class="op" id="5142238">(</span><span class="op" id="5142239">(</span><span class="op" id="5142240">*</span><span class="ident" id="5142241"><a href="/encoding/gob/type.go.html#5138361">encoding</a></span><span class="op" id="5142249">.</span><span class="ident" id="5142250">BinaryUnmarshaler</span><span class="op" id="5142267">)</span><span class="op" id="5142268">(</span><span class="ident" id="5142269">nil</span><span class="op" id="5142272">)</span><span class="op" id="5142273">)</span><span class="op" id="5142274">.</span><span class="ident" id="5142275">Elem</span><span class="op" id="5142279">(</span><span class="op" id="5142280">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142283">textMarshalerInterfaceType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5142314">=</span>&nbsp;<span class="ident" id="5142316"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5142323">.</span><span class="ident" id="5142324">TypeOf</span><span class="op" id="5142330">(</span><span class="op" id="5142331">(</span><span class="op" id="5142332">*</span><span class="ident" id="5142333"><a href="/encoding/gob/type.go.html#5138361">encoding</a></span><span class="op" id="5142341">.</span><span class="ident" id="5142342">TextMarshaler</span><span class="op" id="5142355">)</span><span class="op" id="5142356">(</span><span class="ident" id="5142357">nil</span><span class="op" id="5142360">)</span><span class="op" id="5142361">)</span><span class="op" id="5142362">.</span><span class="ident" id="5142363">Elem</span><span class="op" id="5142367">(</span><span class="op" id="5142368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142371">textUnmarshalerInterfaceType</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5142402">=</span>&nbsp;<span class="ident" id="5142404"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5142411">.</span><span class="ident" id="5142412">TypeOf</span><span class="op" id="5142418">(</span><span class="op" id="5142419">(</span><span class="op" id="5142420">*</span><span class="ident" id="5142421"><a href="/encoding/gob/type.go.html#5138361">encoding</a></span><span class="op" id="5142429">.</span><span class="ident" id="5142430">TextUnmarshaler</span><span class="op" id="5142445">)</span><span class="op" id="5142446">(</span><span class="ident" id="5142447">nil</span><span class="op" id="5142450">)</span><span class="op" id="5142451">)</span><span class="op" id="5142452">.</span><span class="ident" id="5142453">Elem</span><span class="op" id="5142457">(</span><span class="op" id="5142458">)</span><br>
<span class="lineno"></span><span class="op" id="5142460">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5142463">//&nbsp;implementsInterface&nbsp;reports&nbsp;whether&nbsp;the&nbsp;type&nbsp;implements&nbsp;the</span><br>
<span class="lineno">125</span><span class="comment" id="5142526">//&nbsp;gobEncoder/gobDecoder&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="5142562">//&nbsp;It&nbsp;also&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;indirections&nbsp;required&nbsp;to&nbsp;get&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5142631">//&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="keyword" id="5142650">func</span>&nbsp;<span class="ident" id="5142655">implementsInterface</span><span class="op" id="5142674">(</span><span class="ident" id="5142675">typ</span><span class="op" id="5142678">,</span>&nbsp;<span class="ident" id="5142680">gobEncDecType</span>&nbsp;<span class="ident" id="5142694"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5142701">.</span><span class="ident" id="5142702">Type</span><span class="op" id="5142706">)</span>&nbsp;<span class="op" id="5142708">(</span><span class="ident" id="5142709">success</span>&nbsp;<span class="builtintype" id="5142717">bool</span><span class="op" id="5142721">,</span>&nbsp;<span class="ident" id="5142723">indir</span>&nbsp;<span class="builtintype" id="5142729">int8</span><span class="op" id="5142733">)</span>&nbsp;<span class="op" id="5142735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142738">if</span>&nbsp;<span class="ident" id="5142741"><a href="/encoding/gob/type.go.html#5142675">typ</a></span>&nbsp;<span class="op" id="5142745">==</span>&nbsp;<span class="ident" id="5142748">nil</span>&nbsp;<span class="op" id="5142752">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142756">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5142764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5142767">rt</span>&nbsp;<span class="op" id="5142770">:=</span>&nbsp;<span class="ident" id="5142773"><a href="/encoding/gob/type.go.html#5142675">typ</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5142778">//&nbsp;The&nbsp;type&nbsp;might&nbsp;be&nbsp;a&nbsp;pointer&nbsp;and&nbsp;we&nbsp;need&nbsp;to&nbsp;keep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5142830">//&nbsp;dereferencing&nbsp;to&nbsp;the&nbsp;base&nbsp;type&nbsp;until&nbsp;we&nbsp;find&nbsp;an&nbsp;implementation.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142898">for</span>&nbsp;<span class="op" id="5142902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142906">if</span>&nbsp;<span class="ident" id="5142909"><a href="/encoding/gob/type.go.html#5142767">rt</a></span><span class="op" id="5142911">.</span><span class="ident" id="5142912">Implements</span><span class="op" id="5142922">(</span><span class="ident" id="5142923"><a href="/encoding/gob/type.go.html#5142680">gobEncDecType</a></span><span class="op" id="5142936">)</span>&nbsp;<span class="op" id="5142938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142943">return</span>&nbsp;<span class="ident" id="5142950">true</span><span class="op" id="5142954">,</span>&nbsp;<span class="ident" id="5142956"><a href="/encoding/gob/type.go.html#5142723">indir</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5142964">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5142968">if</span>&nbsp;<span class="ident" id="5142971">p</span>&nbsp;<span class="op" id="5142973">:=</span>&nbsp;<span class="ident" id="5142976"><a href="/encoding/gob/type.go.html#5142767">rt</a></span><span class="op" id="5142978">;</span>&nbsp;<span class="ident" id="5142980"><a href="/encoding/gob/type.go.html#5142971">p</a></span><span class="op" id="5142981">.</span><span class="ident" id="5142982">Kind</span><span class="op" id="5142986">(</span><span class="op" id="5142987">)</span>&nbsp;<span class="op" id="5142989">==</span>&nbsp;<span class="ident" id="5142992"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5142999">.</span><span class="ident" id="5143000">Ptr</span>&nbsp;<span class="op" id="5143004">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5143009"><a href="/encoding/gob/type.go.html#5142723">indir</a></span><span class="op" id="5143014">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5143020">if</span>&nbsp;<span class="ident" id="5143023"><a href="/encoding/gob/type.go.html#5142723">indir</a></span>&nbsp;<span class="op" id="5143029">&gt;</span>&nbsp;<span class="num" id="5143031">100</span>&nbsp;<span class="op" id="5143035">{</span>&nbsp;<span class="comment" id="5143037">//&nbsp;insane&nbsp;number&nbsp;of&nbsp;indirections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5143074">return</span>&nbsp;<span class="ident" id="5143081">false</span><span class="op" id="5143086">,</span>&nbsp;<span class="num" id="5143088">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5143093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5143098"><a href="/encoding/gob/type.go.html#5142767">rt</a></span>&nbsp;<span class="op" id="5143101">=</span>&nbsp;<span class="ident" id="5143103"><a href="/encoding/gob/type.go.html#5142971">p</a></span><span class="op" id="5143104">.</span><span class="ident" id="5143105">Elem</span><span class="op" id="5143109">(</span><span class="op" id="5143110">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5143115">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5143126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5143130">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5143137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5143140">//&nbsp;No&nbsp;luck&nbsp;yet,&nbsp;but&nbsp;if&nbsp;this&nbsp;is&nbsp;a&nbsp;base&nbsp;type&nbsp;(non-pointer),&nbsp;the&nbsp;pointer&nbsp;might&nbsp;satisfy.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5143226">if</span>&nbsp;<span class="ident" id="5143229"><a href="/encoding/gob/type.go.html#5142675">typ</a></span><span class="op" id="5143232">.</span><span class="ident" id="5143233">Kind</span><span class="op" id="5143237">(</span><span class="op" id="5143238">)</span>&nbsp;<span class="op" id="5143240">!=</span>&nbsp;<span class="ident" id="5143243"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5143250">.</span><span class="ident" id="5143251">Ptr</span>&nbsp;<span class="op" id="5143255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5143259">//&nbsp;Not&nbsp;a&nbsp;pointer,&nbsp;but&nbsp;does&nbsp;the&nbsp;pointer&nbsp;work?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5143306">if</span>&nbsp;<span class="ident" id="5143309"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5143316">.</span><span class="ident" id="5143317">PtrTo</span><span class="op" id="5143322">(</span><span class="ident" id="5143323"><a href="/encoding/gob/type.go.html#5142675">typ</a></span><span class="op" id="5143326">)</span><span class="op" id="5143327">.</span><span class="ident" id="5143328">Implements</span><span class="op" id="5143338">(</span><span class="ident" id="5143339"><a href="/encoding/gob/type.go.html#5142680">gobEncDecType</a></span><span class="op" id="5143352">)</span>&nbsp;<span class="op" id="5143354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5143359">return</span>&nbsp;<span class="ident" id="5143366">true</span><span class="op" id="5143370">,</span>&nbsp;<span class="op" id="5143372">-</span><span class="num" id="5143373">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5143377">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5143380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5143383">return</span>&nbsp;<span class="ident" id="5143390">false</span><span class="op" id="5143395">,</span>&nbsp;<span class="num" id="5143397">0</span><br>
<span class="lineno"></span><span class="op" id="5143399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5143402">//&nbsp;userType&nbsp;returns,&nbsp;and&nbsp;saves,&nbsp;the&nbsp;information&nbsp;associated&nbsp;with&nbsp;user-provided&nbsp;type&nbsp;rt.</span><br>
<span class="lineno">160</span><span class="comment" id="5143489">//&nbsp;If&nbsp;the&nbsp;user&nbsp;type&nbsp;is&nbsp;not&nbsp;valid,&nbsp;it&nbsp;calls&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5143539">func</span>&nbsp;<span class="ident" id="5143544">userType</span><span class="op" id="5143552">(</span><span class="ident" id="5143553">rt</span>&nbsp;<span class="ident" id="5143556"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5143563">.</span><span class="ident" id="5143564">Type</span><span class="op" id="5143568">)</span>&nbsp;<span class="op" id="5143570">*</span><span class="ident" id="5143571"><a href="/encoding/gob/type.go.html#5138634">userTypeInfo</a></span>&nbsp;<span class="op" id="5143584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5143587">ut</span><span class="op" id="5143589">,</span>&nbsp;<span class="ident" id="5143591">err</span>&nbsp;<span class="op" id="5143595">:=</span>&nbsp;<span class="ident" id="5143598"><a href="/encoding/gob/type.go.html#5139807">validUserType</a></span><span class="op" id="5143611">(</span><span class="ident" id="5143612"><a href="/encoding/gob/type.go.html#5143553">rt</a></span><span class="op" id="5143614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5143617">if</span>&nbsp;<span class="ident" id="5143620"><a href="/encoding/gob/type.go.html#5143591">err</a></span>&nbsp;<span class="op" id="5143624">!=</span>&nbsp;<span class="ident" id="5143627">nil</span>&nbsp;<span class="op" id="5143631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5143635"><a href="/encoding/gob/error.go.html#5137812">error_</a></span><span class="op" id="5143641">(</span><span class="ident" id="5143642"><a href="/encoding/gob/type.go.html#5143591">err</a></span><span class="op" id="5143645">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5143648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5143651">return</span>&nbsp;<span class="ident" id="5143658"><a href="/encoding/gob/type.go.html#5143587">ut</a></span><br>
<span class="lineno"></span><span class="op" id="5143661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5143664">//&nbsp;A&nbsp;typeId&nbsp;represents&nbsp;a&nbsp;gob&nbsp;Type&nbsp;as&nbsp;an&nbsp;integer&nbsp;that&nbsp;can&nbsp;be&nbsp;passed&nbsp;on&nbsp;the&nbsp;wire.</span><br>
<span class="lineno">170</span><span class="comment" id="5143744">//&nbsp;Internally,&nbsp;typeIds&nbsp;are&nbsp;used&nbsp;as&nbsp;keys&nbsp;to&nbsp;a&nbsp;map&nbsp;to&nbsp;recover&nbsp;the&nbsp;underlying&nbsp;type&nbsp;info.</span><br>
<span class="lineno"></span><span class="keyword" id="5143830">type</span>&nbsp;<span class="ident" id="5143835">typeId</span>&nbsp;<span class="builtintype" id="5143842">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5143849">var</span>&nbsp;<span class="ident" id="5143853">nextId</span>&nbsp;<span class="ident" id="5143860"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5143873">//&nbsp;incremented&nbsp;for&nbsp;each&nbsp;new&nbsp;type&nbsp;we&nbsp;build</span><br>
<span class="lineno"></span><span class="keyword" id="5143915">var</span>&nbsp;<span class="ident" id="5143919">typeLock</span>&nbsp;<span class="ident" id="5143928"><a href="/encoding/gob/type.go.html#5138407">sync</a></span><span class="op" id="5143932">.</span><span class="ident" id="5143933">Mutex</span>&nbsp;<span class="comment" id="5143939">//&nbsp;set&nbsp;while&nbsp;building&nbsp;a&nbsp;type</span><br>
<span class="lineno">175</span><span class="keyword" id="5143968">const</span>&nbsp;<span class="ident" id="5143974">firstUserId</span>&nbsp;<span class="op" id="5143986">=</span>&nbsp;<span class="num" id="5143988">64</span>&nbsp;&nbsp;<span class="comment" id="5143992">//&nbsp;lowest&nbsp;id&nbsp;number&nbsp;granted&nbsp;to&nbsp;user</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5144029">type</span>&nbsp;<span class="ident" id="5144034">gobType</span>&nbsp;<span class="keyword" id="5144042">interface</span>&nbsp;<span class="op" id="5144052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5144055">id</span><span class="op" id="5144057">(</span><span class="op" id="5144058">)</span>&nbsp;<span class="ident" id="5144060"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5144068">setId</span><span class="op" id="5144073">(</span><span class="ident" id="5144074">id</span>&nbsp;<span class="ident" id="5144077"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5144083">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5144086">name</span><span class="op" id="5144090">(</span><span class="op" id="5144091">)</span>&nbsp;<span class="builtintype" id="5144093">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="5144101">string</span><span class="op" id="5144107">(</span><span class="op" id="5144108">)</span>&nbsp;<span class="builtintype" id="5144110">string</span>&nbsp;<span class="comment" id="5144117">//&nbsp;not&nbsp;public;&nbsp;only&nbsp;for&nbsp;debugging</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5144152">safeString</span><span class="op" id="5144162">(</span><span class="ident" id="5144163">seen</span>&nbsp;<span class="keyword" id="5144168">map</span><span class="op" id="5144171">[</span><span class="ident" id="5144172"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5144178">]</span><span class="builtintype" id="5144179">bool</span><span class="op" id="5144183">)</span>&nbsp;<span class="builtintype" id="5144185">string</span><br>
<span class="lineno"></span><span class="op" id="5144192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="5144195">var</span>&nbsp;<span class="ident" id="5144199">types</span>&nbsp;<span class="op" id="5144205">=</span>&nbsp;<span class="builtinfunc" id="5144207">make</span><span class="op" id="5144211">(</span><span class="keyword" id="5144212">map</span><span class="op" id="5144215">[</span><span class="ident" id="5144216"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5144223">.</span><span class="ident" id="5144224">Type</span><span class="op" id="5144228">]</span><span class="ident" id="5144229"><a href="/encoding/gob/type.go.html#5144034">gobType</a></span><span class="op" id="5144236">)</span><br>
<span class="lineno"></span><span class="keyword" id="5144238">var</span>&nbsp;<span class="ident" id="5144242">idToType</span>&nbsp;<span class="op" id="5144251">=</span>&nbsp;<span class="builtinfunc" id="5144253">make</span><span class="op" id="5144257">(</span><span class="keyword" id="5144258">map</span><span class="op" id="5144261">[</span><span class="ident" id="5144262"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5144268">]</span><span class="ident" id="5144269"><a href="/encoding/gob/type.go.html#5144034">gobType</a></span><span class="op" id="5144276">)</span><br>
<span class="lineno"></span><span class="keyword" id="5144278">var</span>&nbsp;<span class="ident" id="5144282">builtinIdToType</span>&nbsp;<span class="keyword" id="5144298">map</span><span class="op" id="5144301">[</span><span class="ident" id="5144302"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5144308">]</span><span class="ident" id="5144309"><a href="/encoding/gob/type.go.html#5144034">gobType</a></span>&nbsp;<span class="comment" id="5144317">//&nbsp;set&nbsp;in&nbsp;init()&nbsp;after&nbsp;builtins&nbsp;are&nbsp;established</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5144366">func</span>&nbsp;<span class="ident" id="5144371">setTypeId</span><span class="op" id="5144380">(</span><span class="ident" id="5144381">typ</span>&nbsp;<span class="ident" id="5144385"><a href="/encoding/gob/type.go.html#5144034">gobType</a></span><span class="op" id="5144392">)</span>&nbsp;<span class="op" id="5144394">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5144397">//&nbsp;When&nbsp;building&nbsp;recursive&nbsp;types,&nbsp;someone&nbsp;may&nbsp;get&nbsp;there&nbsp;before&nbsp;us.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5144465">if</span>&nbsp;<span class="ident" id="5144468"><a href="/encoding/gob/type.go.html#5144381">typ</a></span><span class="op" id="5144471">.</span><span class="ident" id="5144472">id</span><span class="op" id="5144474">(</span><span class="op" id="5144475">)</span>&nbsp;<span class="op" id="5144477">!=</span>&nbsp;<span class="num" id="5144480">0</span>&nbsp;<span class="op" id="5144482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5144486">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5144494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5144497"><a href="/encoding/gob/type.go.html#5143853">nextId</a></span><span class="op" id="5144503">++</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5144507"><a href="/encoding/gob/type.go.html#5144381">typ</a></span><span class="op" id="5144510">.</span><span class="ident" id="5144511">setId</span><span class="op" id="5144516">(</span><span class="ident" id="5144517"><a href="/encoding/gob/type.go.html#5143853">nextId</a></span><span class="op" id="5144523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5144526"><a href="/encoding/gob/type.go.html#5144242">idToType</a></span><span class="op" id="5144534">[</span><span class="ident" id="5144535"><a href="/encoding/gob/type.go.html#5143853">nextId</a></span><span class="op" id="5144541">]</span>&nbsp;<span class="op" id="5144543">=</span>&nbsp;<span class="ident" id="5144545"><a href="/encoding/gob/type.go.html#5144381">typ</a></span><br>
<span class="lineno"></span><span class="op" id="5144549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5144552">func</span>&nbsp;<span class="op" id="5144557">(</span><span class="ident" id="5144558">t</span>&nbsp;<span class="ident" id="5144560"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5144566">)</span>&nbsp;<span class="ident" id="5144568">gobType</span><span class="op" id="5144575">(</span><span class="op" id="5144576">)</span>&nbsp;<span class="ident" id="5144578"><a href="/encoding/gob/type.go.html#5144034">gobType</a></span>&nbsp;<span class="op" id="5144586">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5144589">if</span>&nbsp;<span class="ident" id="5144592"><a href="/encoding/gob/type.go.html#5144558">t</a></span>&nbsp;<span class="op" id="5144594">==</span>&nbsp;<span class="num" id="5144597">0</span>&nbsp;<span class="op" id="5144599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5144603">return</span>&nbsp;<span class="ident" id="5144610">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5144615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5144618">return</span>&nbsp;<span class="ident" id="5144625"><a href="/encoding/gob/type.go.html#5144242">idToType</a></span><span class="op" id="5144633">[</span><span class="ident" id="5144634"><a href="/encoding/gob/type.go.html#5144558">t</a></span><span class="op" id="5144635">]</span><br>
<span class="lineno"></span><span class="op" id="5144637">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="5144640">//&nbsp;string&nbsp;returns&nbsp;the&nbsp;string&nbsp;representation&nbsp;of&nbsp;the&nbsp;type&nbsp;associated&nbsp;with&nbsp;the&nbsp;typeId.</span><br>
<span class="lineno"></span><span class="keyword" id="5144724">func</span>&nbsp;<span class="op" id="5144729">(</span><span class="ident" id="5144730">t</span>&nbsp;<span class="ident" id="5144732"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5144738">)</span>&nbsp;<span class="builtintype" id="5144740">string</span><span class="op" id="5144746">(</span><span class="op" id="5144747">)</span>&nbsp;<span class="builtintype" id="5144749">string</span>&nbsp;<span class="op" id="5144756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5144759">if</span>&nbsp;<span class="ident" id="5144762"><a href="/encoding/gob/type.go.html#5144730">t</a></span><span class="op" id="5144763">.</span><span class="ident" id="5144764">gobType</span><span class="op" id="5144771">(</span><span class="op" id="5144772">)</span>&nbsp;<span class="op" id="5144774">==</span>&nbsp;<span class="ident" id="5144777">nil</span>&nbsp;<span class="op" id="5144781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5144785">return</span>&nbsp;<span class="string" id="5144792">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5144801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5144804">return</span>&nbsp;<span class="ident" id="5144811"><a href="/encoding/gob/type.go.html#5144730">t</a></span><span class="op" id="5144812">.</span><span class="ident" id="5144813">gobType</span><span class="op" id="5144820">(</span><span class="op" id="5144821">)</span><span class="op" id="5144822">.</span><span class="builtintype" id="5144823">string</span><span class="op" id="5144829">(</span><span class="op" id="5144830">)</span><br>
<span class="lineno"></span><span class="op" id="5144832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5144835">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;type&nbsp;associated&nbsp;with&nbsp;the&nbsp;typeId.</span><br>
<span class="lineno">215</span><span class="keyword" id="5144900">func</span>&nbsp;<span class="op" id="5144905">(</span><span class="ident" id="5144906">t</span>&nbsp;<span class="ident" id="5144908"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5144914">)</span>&nbsp;<span class="ident" id="5144916">name</span><span class="op" id="5144920">(</span><span class="op" id="5144921">)</span>&nbsp;<span class="builtintype" id="5144923">string</span>&nbsp;<span class="op" id="5144930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5144933">if</span>&nbsp;<span class="ident" id="5144936"><a href="/encoding/gob/type.go.html#5144906">t</a></span><span class="op" id="5144937">.</span><span class="ident" id="5144938">gobType</span><span class="op" id="5144945">(</span><span class="op" id="5144946">)</span>&nbsp;<span class="op" id="5144948">==</span>&nbsp;<span class="ident" id="5144951">nil</span>&nbsp;<span class="op" id="5144955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5144959">return</span>&nbsp;<span class="string" id="5144966">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5144975">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5144978">return</span>&nbsp;<span class="ident" id="5144985"><a href="/encoding/gob/type.go.html#5144906">t</a></span><span class="op" id="5144986">.</span><span class="ident" id="5144987">gobType</span><span class="op" id="5144994">(</span><span class="op" id="5144995">)</span><span class="op" id="5144996">.</span><span class="ident" id="5144997">name</span><span class="op" id="5145001">(</span><span class="op" id="5145002">)</span><br>
<span class="lineno">220</span><span class="op" id="5145004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5145007">//&nbsp;CommonType&nbsp;holds&nbsp;elements&nbsp;of&nbsp;all&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="5145050">//&nbsp;It&nbsp;is&nbsp;a&nbsp;historical&nbsp;artifact,&nbsp;kept&nbsp;for&nbsp;binary&nbsp;compatibility&nbsp;and&nbsp;exported</span><br>
<span class="lineno"></span><span class="comment" id="5145125">//&nbsp;only&nbsp;for&nbsp;the&nbsp;benefit&nbsp;of&nbsp;the&nbsp;package&#39;s&nbsp;encoding&nbsp;of&nbsp;type&nbsp;descriptors.&nbsp;It&nbsp;is</span><br>
<span class="lineno">225</span><span class="comment" id="5145202">//&nbsp;not&nbsp;intended&nbsp;for&nbsp;direct&nbsp;use&nbsp;by&nbsp;clients.</span><br>
<span class="lineno"></span><span class="keyword" id="5145245">type</span>&nbsp;<span class="ident" id="5145250">CommonType</span>&nbsp;<span class="keyword" id="5145261">struct</span>&nbsp;<span class="op" id="5145268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5145271">Name</span>&nbsp;<span class="builtintype" id="5145276">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5145284">Id</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5145289"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><br>
<span class="lineno"></span><span class="op" id="5145296">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="5145299">func</span>&nbsp;<span class="op" id="5145304">(</span><span class="ident" id="5145305">t</span>&nbsp;<span class="op" id="5145307">*</span><span class="ident" id="5145308"><a href="/encoding/gob/type.go.html#5145250">CommonType</a></span><span class="op" id="5145318">)</span>&nbsp;<span class="ident" id="5145320">id</span><span class="op" id="5145322">(</span><span class="op" id="5145323">)</span>&nbsp;<span class="ident" id="5145325"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span>&nbsp;<span class="op" id="5145332">{</span>&nbsp;<span class="keyword" id="5145334">return</span>&nbsp;<span class="ident" id="5145341"><a href="/encoding/gob/type.go.html#5145305">t</a></span><span class="op" id="5145342">.</span><span class="ident" id="5145343">Id</span>&nbsp;<span class="op" id="5145346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5145349">func</span>&nbsp;<span class="op" id="5145354">(</span><span class="ident" id="5145355">t</span>&nbsp;<span class="op" id="5145357">*</span><span class="ident" id="5145358"><a href="/encoding/gob/type.go.html#5145250">CommonType</a></span><span class="op" id="5145368">)</span>&nbsp;<span class="ident" id="5145370">setId</span><span class="op" id="5145375">(</span><span class="ident" id="5145376">id</span>&nbsp;<span class="ident" id="5145379"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5145385">)</span>&nbsp;<span class="op" id="5145387">{</span>&nbsp;<span class="ident" id="5145389"><a href="/encoding/gob/type.go.html#5145355">t</a></span><span class="op" id="5145390">.</span><span class="ident" id="5145391">Id</span>&nbsp;<span class="op" id="5145394">=</span>&nbsp;<span class="ident" id="5145396"><a href="/encoding/gob/type.go.html#5145376">id</a></span>&nbsp;<span class="op" id="5145399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="5145402">func</span>&nbsp;<span class="op" id="5145407">(</span><span class="ident" id="5145408">t</span>&nbsp;<span class="op" id="5145410">*</span><span class="ident" id="5145411"><a href="/encoding/gob/type.go.html#5145250">CommonType</a></span><span class="op" id="5145421">)</span>&nbsp;<span class="builtintype" id="5145423">string</span><span class="op" id="5145429">(</span><span class="op" id="5145430">)</span>&nbsp;<span class="builtintype" id="5145432">string</span>&nbsp;<span class="op" id="5145439">{</span>&nbsp;<span class="keyword" id="5145441">return</span>&nbsp;<span class="ident" id="5145448"><a href="/encoding/gob/type.go.html#5145408">t</a></span><span class="op" id="5145449">.</span><span class="ident" id="5145450">Name</span>&nbsp;<span class="op" id="5145455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5145458">func</span>&nbsp;<span class="op" id="5145463">(</span><span class="ident" id="5145464">t</span>&nbsp;<span class="op" id="5145466">*</span><span class="ident" id="5145467"><a href="/encoding/gob/type.go.html#5145250">CommonType</a></span><span class="op" id="5145477">)</span>&nbsp;<span class="ident" id="5145479">safeString</span><span class="op" id="5145489">(</span><span class="ident" id="5145490">seen</span>&nbsp;<span class="keyword" id="5145495">map</span><span class="op" id="5145498">[</span><span class="ident" id="5145499"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5145505">]</span><span class="builtintype" id="5145506">bool</span><span class="op" id="5145510">)</span>&nbsp;<span class="builtintype" id="5145512">string</span>&nbsp;<span class="op" id="5145519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5145522">return</span>&nbsp;<span class="ident" id="5145529"><a href="/encoding/gob/type.go.html#5145464">t</a></span><span class="op" id="5145530">.</span><span class="ident" id="5145531">Name</span><br>
<span class="lineno"></span><span class="op" id="5145536">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="keyword" id="5145539">func</span>&nbsp;<span class="op" id="5145544">(</span><span class="ident" id="5145545">t</span>&nbsp;<span class="op" id="5145547">*</span><span class="ident" id="5145548"><a href="/encoding/gob/type.go.html#5145250">CommonType</a></span><span class="op" id="5145558">)</span>&nbsp;<span class="ident" id="5145560">name</span><span class="op" id="5145564">(</span><span class="op" id="5145565">)</span>&nbsp;<span class="builtintype" id="5145567">string</span>&nbsp;<span class="op" id="5145574">{</span>&nbsp;<span class="keyword" id="5145576">return</span>&nbsp;<span class="ident" id="5145583"><a href="/encoding/gob/type.go.html#5145545">t</a></span><span class="op" id="5145584">.</span><span class="ident" id="5145585">Name</span>&nbsp;<span class="op" id="5145590">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5145593">//&nbsp;Create&nbsp;and&nbsp;check&nbsp;predefined&nbsp;types</span><br>
<span class="lineno"></span><span class="comment" id="5145630">//&nbsp;The&nbsp;string&nbsp;for&nbsp;tBytes&nbsp;is&nbsp;&#34;bytes&#34;&nbsp;not&nbsp;&#34;[]byte&#34;&nbsp;to&nbsp;signify&nbsp;its&nbsp;specialness.</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="5145708">var</span>&nbsp;<span class="op" id="5145712">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5145715">//&nbsp;Primordial&nbsp;types,&nbsp;needed&nbsp;during&nbsp;initialization.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5145767">//&nbsp;Always&nbsp;passed&nbsp;as&nbsp;pointers&nbsp;so&nbsp;the&nbsp;interface{}&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5145821">//&nbsp;goes&nbsp;through&nbsp;without&nbsp;losing&nbsp;its&nbsp;interfaceness.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5145872">tBool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5145883">=</span>&nbsp;<span class="ident" id="5145885"><a href="/encoding/gob/type.go.html#5156443">bootstrapType</a></span><span class="op" id="5145898">(</span><span class="string" id="5145899">&#34;bool&#34;</span><span class="op" id="5145905">,</span>&nbsp;<span class="op" id="5145907">(</span><span class="op" id="5145908">*</span><span class="builtintype" id="5145909">bool</span><span class="op" id="5145913">)</span><span class="op" id="5145914">(</span><span class="ident" id="5145915">nil</span><span class="op" id="5145918">)</span><span class="op" id="5145919">,</span>&nbsp;<span class="num" id="5145921">1</span><span class="op" id="5145922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5145925">tInt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5145936">=</span>&nbsp;<span class="ident" id="5145938"><a href="/encoding/gob/type.go.html#5156443">bootstrapType</a></span><span class="op" id="5145951">(</span><span class="string" id="5145952">&#34;int&#34;</span><span class="op" id="5145957">,</span>&nbsp;<span class="op" id="5145959">(</span><span class="op" id="5145960">*</span><span class="builtintype" id="5145961">int</span><span class="op" id="5145964">)</span><span class="op" id="5145965">(</span><span class="ident" id="5145966">nil</span><span class="op" id="5145969">)</span><span class="op" id="5145970">,</span>&nbsp;<span class="num" id="5145972">2</span><span class="op" id="5145973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5145976">tUint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5145987">=</span>&nbsp;<span class="ident" id="5145989"><a href="/encoding/gob/type.go.html#5156443">bootstrapType</a></span><span class="op" id="5146002">(</span><span class="string" id="5146003">&#34;uint&#34;</span><span class="op" id="5146009">,</span>&nbsp;<span class="op" id="5146011">(</span><span class="op" id="5146012">*</span><span class="builtintype" id="5146013">uint</span><span class="op" id="5146017">)</span><span class="op" id="5146018">(</span><span class="ident" id="5146019">nil</span><span class="op" id="5146022">)</span><span class="op" id="5146023">,</span>&nbsp;<span class="num" id="5146025">3</span><span class="op" id="5146026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146029">tFloat</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5146040">=</span>&nbsp;<span class="ident" id="5146042"><a href="/encoding/gob/type.go.html#5156443">bootstrapType</a></span><span class="op" id="5146055">(</span><span class="string" id="5146056">&#34;float&#34;</span><span class="op" id="5146063">,</span>&nbsp;<span class="op" id="5146065">(</span><span class="op" id="5146066">*</span><span class="builtintype" id="5146067">float64</span><span class="op" id="5146074">)</span><span class="op" id="5146075">(</span><span class="ident" id="5146076">nil</span><span class="op" id="5146079">)</span><span class="op" id="5146080">,</span>&nbsp;<span class="num" id="5146082">4</span><span class="op" id="5146083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146086">tBytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5146097">=</span>&nbsp;<span class="ident" id="5146099"><a href="/encoding/gob/type.go.html#5156443">bootstrapType</a></span><span class="op" id="5146112">(</span><span class="string" id="5146113">&#34;bytes&#34;</span><span class="op" id="5146120">,</span>&nbsp;<span class="op" id="5146122">(</span><span class="op" id="5146123">*</span><span class="op" id="5146124">[</span><span class="op" id="5146125">]</span><span class="builtintype" id="5146126">byte</span><span class="op" id="5146130">)</span><span class="op" id="5146131">(</span><span class="ident" id="5146132">nil</span><span class="op" id="5146135">)</span><span class="op" id="5146136">,</span>&nbsp;<span class="num" id="5146138">5</span><span class="op" id="5146139">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146142">tString</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5146153">=</span>&nbsp;<span class="ident" id="5146155"><a href="/encoding/gob/type.go.html#5156443">bootstrapType</a></span><span class="op" id="5146168">(</span><span class="string" id="5146169">&#34;string&#34;</span><span class="op" id="5146177">,</span>&nbsp;<span class="op" id="5146179">(</span><span class="op" id="5146180">*</span><span class="builtintype" id="5146181">string</span><span class="op" id="5146187">)</span><span class="op" id="5146188">(</span><span class="ident" id="5146189">nil</span><span class="op" id="5146192">)</span><span class="op" id="5146193">,</span>&nbsp;<span class="num" id="5146195">6</span><span class="op" id="5146196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146199">tComplex</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5146210">=</span>&nbsp;<span class="ident" id="5146212"><a href="/encoding/gob/type.go.html#5156443">bootstrapType</a></span><span class="op" id="5146225">(</span><span class="string" id="5146226">&#34;complex&#34;</span><span class="op" id="5146235">,</span>&nbsp;<span class="op" id="5146237">(</span><span class="op" id="5146238">*</span><span class="builtintype" id="5146239">complex128</span><span class="op" id="5146249">)</span><span class="op" id="5146250">(</span><span class="ident" id="5146251">nil</span><span class="op" id="5146254">)</span><span class="op" id="5146255">,</span>&nbsp;<span class="num" id="5146257">7</span><span class="op" id="5146258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146261">tInterface</span>&nbsp;<span class="op" id="5146272">=</span>&nbsp;<span class="ident" id="5146274"><a href="/encoding/gob/type.go.html#5156443">bootstrapType</a></span><span class="op" id="5146287">(</span><span class="string" id="5146288">&#34;interface&#34;</span><span class="op" id="5146299">,</span>&nbsp;<span class="op" id="5146301">(</span><span class="op" id="5146302">*</span><span class="keyword" id="5146303">interface</span><span class="op" id="5146312">{</span><span class="op" id="5146313">}</span><span class="op" id="5146314">)</span><span class="op" id="5146315">(</span><span class="ident" id="5146316">nil</span><span class="op" id="5146319">)</span><span class="op" id="5146320">,</span>&nbsp;<span class="num" id="5146322">8</span><span class="op" id="5146323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5146326">//&nbsp;Reserve&nbsp;some&nbsp;Ids&nbsp;for&nbsp;compatible&nbsp;expansion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146372">tReserved7</span>&nbsp;<span class="op" id="5146383">=</span>&nbsp;<span class="ident" id="5146385"><a href="/encoding/gob/type.go.html#5156443">bootstrapType</a></span><span class="op" id="5146398">(</span><span class="string" id="5146399">&#34;_reserved1&#34;</span><span class="op" id="5146411">,</span>&nbsp;<span class="op" id="5146413">(</span><span class="op" id="5146414">*</span><span class="keyword" id="5146415">struct</span><span class="op" id="5146421">{</span>&nbsp;<span class="ident" id="5146423">r7</span>&nbsp;<span class="builtintype" id="5146426">int</span>&nbsp;<span class="op" id="5146430">}</span><span class="op" id="5146431">)</span><span class="op" id="5146432">(</span><span class="ident" id="5146433">nil</span><span class="op" id="5146436">)</span><span class="op" id="5146437">,</span>&nbsp;<span class="num" id="5146439">9</span><span class="op" id="5146440">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146443">tReserved6</span>&nbsp;<span class="op" id="5146454">=</span>&nbsp;<span class="ident" id="5146456"><a href="/encoding/gob/type.go.html#5156443">bootstrapType</a></span><span class="op" id="5146469">(</span><span class="string" id="5146470">&#34;_reserved1&#34;</span><span class="op" id="5146482">,</span>&nbsp;<span class="op" id="5146484">(</span><span class="op" id="5146485">*</span><span class="keyword" id="5146486">struct</span><span class="op" id="5146492">{</span>&nbsp;<span class="ident" id="5146494">r6</span>&nbsp;<span class="builtintype" id="5146497">int</span>&nbsp;<span class="op" id="5146501">}</span><span class="op" id="5146502">)</span><span class="op" id="5146503">(</span><span class="ident" id="5146504">nil</span><span class="op" id="5146507">)</span><span class="op" id="5146508">,</span>&nbsp;<span class="num" id="5146510">10</span><span class="op" id="5146512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146515">tReserved5</span>&nbsp;<span class="op" id="5146526">=</span>&nbsp;<span class="ident" id="5146528"><a href="/encoding/gob/type.go.html#5156443">bootstrapType</a></span><span class="op" id="5146541">(</span><span class="string" id="5146542">&#34;_reserved1&#34;</span><span class="op" id="5146554">,</span>&nbsp;<span class="op" id="5146556">(</span><span class="op" id="5146557">*</span><span class="keyword" id="5146558">struct</span><span class="op" id="5146564">{</span>&nbsp;<span class="ident" id="5146566">r5</span>&nbsp;<span class="builtintype" id="5146569">int</span>&nbsp;<span class="op" id="5146573">}</span><span class="op" id="5146574">)</span><span class="op" id="5146575">(</span><span class="ident" id="5146576">nil</span><span class="op" id="5146579">)</span><span class="op" id="5146580">,</span>&nbsp;<span class="num" id="5146582">11</span><span class="op" id="5146584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146587">tReserved4</span>&nbsp;<span class="op" id="5146598">=</span>&nbsp;<span class="ident" id="5146600"><a href="/encoding/gob/type.go.html#5156443">bootstrapType</a></span><span class="op" id="5146613">(</span><span class="string" id="5146614">&#34;_reserved1&#34;</span><span class="op" id="5146626">,</span>&nbsp;<span class="op" id="5146628">(</span><span class="op" id="5146629">*</span><span class="keyword" id="5146630">struct</span><span class="op" id="5146636">{</span>&nbsp;<span class="ident" id="5146638">r4</span>&nbsp;<span class="builtintype" id="5146641">int</span>&nbsp;<span class="op" id="5146645">}</span><span class="op" id="5146646">)</span><span class="op" id="5146647">(</span><span class="ident" id="5146648">nil</span><span class="op" id="5146651">)</span><span class="op" id="5146652">,</span>&nbsp;<span class="num" id="5146654">12</span><span class="op" id="5146656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146659">tReserved3</span>&nbsp;<span class="op" id="5146670">=</span>&nbsp;<span class="ident" id="5146672"><a href="/encoding/gob/type.go.html#5156443">bootstrapType</a></span><span class="op" id="5146685">(</span><span class="string" id="5146686">&#34;_reserved1&#34;</span><span class="op" id="5146698">,</span>&nbsp;<span class="op" id="5146700">(</span><span class="op" id="5146701">*</span><span class="keyword" id="5146702">struct</span><span class="op" id="5146708">{</span>&nbsp;<span class="ident" id="5146710">r3</span>&nbsp;<span class="builtintype" id="5146713">int</span>&nbsp;<span class="op" id="5146717">}</span><span class="op" id="5146718">)</span><span class="op" id="5146719">(</span><span class="ident" id="5146720">nil</span><span class="op" id="5146723">)</span><span class="op" id="5146724">,</span>&nbsp;<span class="num" id="5146726">13</span><span class="op" id="5146728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146731">tReserved2</span>&nbsp;<span class="op" id="5146742">=</span>&nbsp;<span class="ident" id="5146744"><a href="/encoding/gob/type.go.html#5156443">bootstrapType</a></span><span class="op" id="5146757">(</span><span class="string" id="5146758">&#34;_reserved1&#34;</span><span class="op" id="5146770">,</span>&nbsp;<span class="op" id="5146772">(</span><span class="op" id="5146773">*</span><span class="keyword" id="5146774">struct</span><span class="op" id="5146780">{</span>&nbsp;<span class="ident" id="5146782">r2</span>&nbsp;<span class="builtintype" id="5146785">int</span>&nbsp;<span class="op" id="5146789">}</span><span class="op" id="5146790">)</span><span class="op" id="5146791">(</span><span class="ident" id="5146792">nil</span><span class="op" id="5146795">)</span><span class="op" id="5146796">,</span>&nbsp;<span class="num" id="5146798">14</span><span class="op" id="5146800">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5146803">tReserved1</span>&nbsp;<span class="op" id="5146814">=</span>&nbsp;<span class="ident" id="5146816"><a href="/encoding/gob/type.go.html#5156443">bootstrapType</a></span><span class="op" id="5146829">(</span><span class="string" id="5146830">&#34;_reserved1&#34;</span><span class="op" id="5146842">,</span>&nbsp;<span class="op" id="5146844">(</span><span class="op" id="5146845">*</span><span class="keyword" id="5146846">struct</span><span class="op" id="5146852">{</span>&nbsp;<span class="ident" id="5146854">r1</span>&nbsp;<span class="builtintype" id="5146857">int</span>&nbsp;<span class="op" id="5146861">}</span><span class="op" id="5146862">)</span><span class="op" id="5146863">(</span><span class="ident" id="5146864">nil</span><span class="op" id="5146867">)</span><span class="op" id="5146868">,</span>&nbsp;<span class="num" id="5146870">15</span><span class="op" id="5146872">)</span><br>
<span class="lineno"></span><span class="op" id="5146874">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5146877">//&nbsp;Predefined&nbsp;because&nbsp;it&#39;s&nbsp;needed&nbsp;by&nbsp;the&nbsp;Decoder</span><br>
<span class="lineno"></span><span class="keyword" id="5146926">var</span>&nbsp;<span class="ident" id="5146930">tWireType</span>&nbsp;<span class="op" id="5146940">=</span>&nbsp;<span class="ident" id="5146942"><a href="/encoding/gob/type.go.html#5160730">mustGetTypeInfo</a></span><span class="op" id="5146957">(</span><span class="ident" id="5146958"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5146965">.</span><span class="ident" id="5146966">TypeOf</span><span class="op" id="5146972">(</span><span class="ident" id="5146973"><a href="/encoding/gob/type.go.html#5157489">wireType</a></span><span class="op" id="5146981">{</span><span class="op" id="5146982">}</span><span class="op" id="5146983">)</span><span class="op" id="5146984">)</span><span class="op" id="5146985">.</span><span class="ident" id="5146986">id</span><br>
<span class="lineno">270</span><span class="keyword" id="5146989">var</span>&nbsp;<span class="ident" id="5146993">wireTypeUserInfo</span>&nbsp;<span class="op" id="5147010">*</span><span class="ident" id="5147011"><a href="/encoding/gob/type.go.html#5138634">userTypeInfo</a></span>&nbsp;<span class="comment" id="5147024">//&nbsp;userTypeInfo&nbsp;of&nbsp;(*wireType)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5147056">func</span>&nbsp;<span class="ident" id="5147061">init</span><span class="op" id="5147065">(</span><span class="op" id="5147066">)</span>&nbsp;<span class="op" id="5147068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147071">//&nbsp;Some&nbsp;magic&nbsp;numbers&nbsp;to&nbsp;make&nbsp;sure&nbsp;there&nbsp;are&nbsp;no&nbsp;surprises.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147131"><a href="/encoding/gob/type.go.html#5156095">checkId</a></span><span class="op" id="5147138">(</span><span class="num" id="5147139">16</span><span class="op" id="5147141">,</span>&nbsp;<span class="ident" id="5147143"><a href="/encoding/gob/type.go.html#5146930">tWireType</a></span><span class="op" id="5147152">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147155"><a href="/encoding/gob/type.go.html#5156095">checkId</a></span><span class="op" id="5147162">(</span><span class="num" id="5147163">17</span><span class="op" id="5147165">,</span>&nbsp;<span class="ident" id="5147167"><a href="/encoding/gob/type.go.html#5160730">mustGetTypeInfo</a></span><span class="op" id="5147182">(</span><span class="ident" id="5147183"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5147190">.</span><span class="ident" id="5147191">TypeOf</span><span class="op" id="5147197">(</span><span class="ident" id="5147198"><a href="/encoding/gob/type.go.html#5147947">arrayType</a></span><span class="op" id="5147207">{</span><span class="op" id="5147208">}</span><span class="op" id="5147209">)</span><span class="op" id="5147210">)</span><span class="op" id="5147211">.</span><span class="ident" id="5147212">id</span><span class="op" id="5147214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147217"><a href="/encoding/gob/type.go.html#5156095">checkId</a></span><span class="op" id="5147224">(</span><span class="num" id="5147225">18</span><span class="op" id="5147227">,</span>&nbsp;<span class="ident" id="5147229"><a href="/encoding/gob/type.go.html#5160730">mustGetTypeInfo</a></span><span class="op" id="5147244">(</span><span class="ident" id="5147245"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5147252">.</span><span class="ident" id="5147253">TypeOf</span><span class="op" id="5147259">(</span><span class="ident" id="5147260"><a href="/encoding/gob/type.go.html#5145250">CommonType</a></span><span class="op" id="5147270">{</span><span class="op" id="5147271">}</span><span class="op" id="5147272">)</span><span class="op" id="5147273">)</span><span class="op" id="5147274">.</span><span class="ident" id="5147275">id</span><span class="op" id="5147277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147280"><a href="/encoding/gob/type.go.html#5156095">checkId</a></span><span class="op" id="5147287">(</span><span class="num" id="5147288">19</span><span class="op" id="5147290">,</span>&nbsp;<span class="ident" id="5147292"><a href="/encoding/gob/type.go.html#5160730">mustGetTypeInfo</a></span><span class="op" id="5147307">(</span><span class="ident" id="5147308"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5147315">.</span><span class="ident" id="5147316">TypeOf</span><span class="op" id="5147322">(</span><span class="ident" id="5147323"><a href="/encoding/gob/type.go.html#5149641">sliceType</a></span><span class="op" id="5147332">{</span><span class="op" id="5147333">}</span><span class="op" id="5147334">)</span><span class="op" id="5147335">)</span><span class="op" id="5147336">.</span><span class="ident" id="5147337">id</span><span class="op" id="5147339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147342"><a href="/encoding/gob/type.go.html#5156095">checkId</a></span><span class="op" id="5147349">(</span><span class="num" id="5147350">20</span><span class="op" id="5147352">,</span>&nbsp;<span class="ident" id="5147354"><a href="/encoding/gob/type.go.html#5160730">mustGetTypeInfo</a></span><span class="op" id="5147369">(</span><span class="ident" id="5147370"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5147377">.</span><span class="ident" id="5147378">TypeOf</span><span class="op" id="5147384">(</span><span class="ident" id="5147385"><a href="/encoding/gob/type.go.html#5150424">structType</a></span><span class="op" id="5147395">{</span><span class="op" id="5147396">}</span><span class="op" id="5147397">)</span><span class="op" id="5147398">)</span><span class="op" id="5147399">.</span><span class="ident" id="5147400">id</span><span class="op" id="5147402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147405"><a href="/encoding/gob/type.go.html#5156095">checkId</a></span><span class="op" id="5147412">(</span><span class="num" id="5147413">21</span><span class="op" id="5147415">,</span>&nbsp;<span class="ident" id="5147417"><a href="/encoding/gob/type.go.html#5160730">mustGetTypeInfo</a></span><span class="op" id="5147432">(</span><span class="ident" id="5147433"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5147440">.</span><span class="ident" id="5147441">TypeOf</span><span class="op" id="5147447">(</span><span class="ident" id="5147448"><a href="/encoding/gob/type.go.html#5150371">fieldType</a></span><span class="op" id="5147457">{</span><span class="op" id="5147458">}</span><span class="op" id="5147459">)</span><span class="op" id="5147460">)</span><span class="op" id="5147461">.</span><span class="ident" id="5147462">id</span><span class="op" id="5147464">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147467"><a href="/encoding/gob/type.go.html#5156095">checkId</a></span><span class="op" id="5147474">(</span><span class="num" id="5147475">23</span><span class="op" id="5147477">,</span>&nbsp;<span class="ident" id="5147479"><a href="/encoding/gob/type.go.html#5160730">mustGetTypeInfo</a></span><span class="op" id="5147494">(</span><span class="ident" id="5147495"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5147502">.</span><span class="ident" id="5147503">TypeOf</span><span class="op" id="5147509">(</span><span class="ident" id="5147510"><a href="/encoding/gob/type.go.html#5148964">mapType</a></span><span class="op" id="5147517">{</span><span class="op" id="5147518">}</span><span class="op" id="5147519">)</span><span class="op" id="5147520">)</span><span class="op" id="5147521">.</span><span class="ident" id="5147522">id</span><span class="op" id="5147524">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147528"><a href="/encoding/gob/type.go.html#5144282">builtinIdToType</a></span>&nbsp;<span class="op" id="5147544">=</span>&nbsp;<span class="builtinfunc" id="5147546">make</span><span class="op" id="5147550">(</span><span class="keyword" id="5147551">map</span><span class="op" id="5147554">[</span><span class="ident" id="5147555"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5147561">]</span><span class="ident" id="5147562"><a href="/encoding/gob/type.go.html#5144034">gobType</a></span><span class="op" id="5147569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5147572">for</span>&nbsp;<span class="ident" id="5147576">k</span><span class="op" id="5147577">,</span>&nbsp;<span class="ident" id="5147579">v</span>&nbsp;<span class="op" id="5147581">:=</span>&nbsp;<span class="keyword" id="5147584">range</span>&nbsp;<span class="ident" id="5147590"><a href="/encoding/gob/type.go.html#5144242">idToType</a></span>&nbsp;<span class="op" id="5147599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147603"><a href="/encoding/gob/type.go.html#5144282">builtinIdToType</a></span><span class="op" id="5147618">[</span><span class="ident" id="5147619"><a href="/encoding/gob/type.go.html#5147576">k</a></span><span class="op" id="5147620">]</span>&nbsp;<span class="op" id="5147622">=</span>&nbsp;<span class="ident" id="5147624"><a href="/encoding/gob/type.go.html#5147579">v</a></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5147627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147631">//&nbsp;Move&nbsp;the&nbsp;id&nbsp;space&nbsp;upwards&nbsp;to&nbsp;allow&nbsp;for&nbsp;growth&nbsp;in&nbsp;the&nbsp;predefined&nbsp;world</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5147705">//&nbsp;without&nbsp;breaking&nbsp;existing&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5147742">if</span>&nbsp;<span class="ident" id="5147745"><a href="/encoding/gob/type.go.html#5143853">nextId</a></span>&nbsp;<span class="op" id="5147752">&gt;</span>&nbsp;<span class="ident" id="5147754"><a href="/encoding/gob/type.go.html#5143974">firstUserId</a></span>&nbsp;<span class="op" id="5147766">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5147770">panic</span><span class="op" id="5147775">(</span><span class="ident" id="5147776"><a href="/encoding/gob/type.go.html#5138383">fmt</a></span><span class="op" id="5147779">.</span><span class="ident" id="5147780">Sprintln</span><span class="op" id="5147788">(</span><span class="string" id="5147789">&#34;nextId&nbsp;too&nbsp;large:&#34;</span><span class="op" id="5147808">,</span>&nbsp;<span class="ident" id="5147810"><a href="/encoding/gob/type.go.html#5143853">nextId</a></span><span class="op" id="5147816">)</span><span class="op" id="5147817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5147820">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147823"><a href="/encoding/gob/type.go.html#5143853">nextId</a></span>&nbsp;<span class="op" id="5147830">=</span>&nbsp;<span class="ident" id="5147832"><a href="/encoding/gob/type.go.html#5143974">firstUserId</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147845"><a href="/encoding/gob/type.go.html#5164847">registerBasics</a></span><span class="op" id="5147859">(</span><span class="op" id="5147860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147863"><a href="/encoding/gob/type.go.html#5146993">wireTypeUserInfo</a></span>&nbsp;<span class="op" id="5147880">=</span>&nbsp;<span class="ident" id="5147882"><a href="/encoding/gob/type.go.html#5143544">userType</a></span><span class="op" id="5147890">(</span><span class="ident" id="5147891"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5147898">.</span><span class="ident" id="5147899">TypeOf</span><span class="op" id="5147905">(</span><span class="op" id="5147906">(</span><span class="op" id="5147907">*</span><span class="ident" id="5147908"><a href="/encoding/gob/type.go.html#5157489">wireType</a></span><span class="op" id="5147916">)</span><span class="op" id="5147917">(</span><span class="ident" id="5147918">nil</span><span class="op" id="5147921">)</span><span class="op" id="5147922">)</span><span class="op" id="5147923">)</span><br>
<span class="lineno">295</span><span class="op" id="5147925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5147928">//&nbsp;Array&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="5147942">type</span>&nbsp;<span class="ident" id="5147947">arrayType</span>&nbsp;<span class="keyword" id="5147957">struct</span>&nbsp;<span class="op" id="5147964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147967"><a href="/encoding/gob/type.go.html#5145250">CommonType</a></span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147979">Elem</span>&nbsp;<span class="ident" id="5147984"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5147992">Len</span>&nbsp;&nbsp;<span class="builtintype" id="5147997">int</span><br>
<span class="lineno"></span><span class="op" id="5148001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5148004">func</span>&nbsp;<span class="ident" id="5148009">newArrayType</span><span class="op" id="5148021">(</span><span class="ident" id="5148022">name</span>&nbsp;<span class="builtintype" id="5148027">string</span><span class="op" id="5148033">)</span>&nbsp;<span class="op" id="5148035">*</span><span class="ident" id="5148036"><a href="/encoding/gob/type.go.html#5147947">arrayType</a></span>&nbsp;<span class="op" id="5148046">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148049">a</span>&nbsp;<span class="op" id="5148051">:=</span>&nbsp;<span class="op" id="5148054">&amp;</span><span class="ident" id="5148055"><a href="/encoding/gob/type.go.html#5147947">arrayType</a></span><span class="op" id="5148064">{</span><span class="ident" id="5148065"><a href="/encoding/gob/type.go.html#5145250">CommonType</a></span><span class="op" id="5148075">{</span><span class="ident" id="5148076">Name</span><span class="op" id="5148080">:</span>&nbsp;<span class="ident" id="5148082"><a href="/encoding/gob/type.go.html#5148022">name</a></span><span class="op" id="5148086">}</span><span class="op" id="5148087">,</span>&nbsp;<span class="num" id="5148089">0</span><span class="op" id="5148090">,</span>&nbsp;<span class="num" id="5148092">0</span><span class="op" id="5148093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5148096">return</span>&nbsp;<span class="ident" id="5148103"><a href="/encoding/gob/type.go.html#5148049">a</a></span><br>
<span class="lineno"></span><span class="op" id="5148105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5148108">func</span>&nbsp;<span class="op" id="5148113">(</span><span class="ident" id="5148114">a</span>&nbsp;<span class="op" id="5148116">*</span><span class="ident" id="5148117"><a href="/encoding/gob/type.go.html#5147947">arrayType</a></span><span class="op" id="5148126">)</span>&nbsp;<span class="ident" id="5148128">init</span><span class="op" id="5148132">(</span><span class="ident" id="5148133">elem</span>&nbsp;<span class="ident" id="5148138"><a href="/encoding/gob/type.go.html#5144034">gobType</a></span><span class="op" id="5148145">,</span>&nbsp;<span class="builtinfunc" id="5148147">len</span>&nbsp;<span class="builtintype" id="5148151">int</span><span class="op" id="5148154">)</span>&nbsp;<span class="op" id="5148156">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5148159">//&nbsp;Set&nbsp;our&nbsp;type&nbsp;id&nbsp;before&nbsp;evaluating&nbsp;the&nbsp;element&#39;s,&nbsp;in&nbsp;case&nbsp;it&#39;s&nbsp;our&nbsp;own.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148234"><a href="/encoding/gob/type.go.html#5144371">setTypeId</a></span><span class="op" id="5148243">(</span><span class="ident" id="5148244"><a href="/encoding/gob/type.go.html#5148114">a</a></span><span class="op" id="5148245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148248"><a href="/encoding/gob/type.go.html#5148114">a</a></span><span class="op" id="5148249">.</span><span class="ident" id="5148250">Elem</span>&nbsp;<span class="op" id="5148255">=</span>&nbsp;<span class="ident" id="5148257"><a href="/encoding/gob/type.go.html#5148133">elem</a></span><span class="op" id="5148261">.</span><span class="ident" id="5148262">id</span><span class="op" id="5148264">(</span><span class="op" id="5148265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148268"><a href="/encoding/gob/type.go.html#5148114">a</a></span><span class="op" id="5148269">.</span><span class="ident" id="5148270">Len</span>&nbsp;<span class="op" id="5148274">=</span>&nbsp;<span class="builtinfunc" id="5148276"><a href="/encoding/gob/type.go.html#5148147">len</a></span><br>
<span class="lineno"></span><span class="op" id="5148280">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="5148283">func</span>&nbsp;<span class="op" id="5148288">(</span><span class="ident" id="5148289">a</span>&nbsp;<span class="op" id="5148291">*</span><span class="ident" id="5148292"><a href="/encoding/gob/type.go.html#5147947">arrayType</a></span><span class="op" id="5148301">)</span>&nbsp;<span class="ident" id="5148303">safeString</span><span class="op" id="5148313">(</span><span class="ident" id="5148314">seen</span>&nbsp;<span class="keyword" id="5148319">map</span><span class="op" id="5148322">[</span><span class="ident" id="5148323"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5148329">]</span><span class="builtintype" id="5148330">bool</span><span class="op" id="5148334">)</span>&nbsp;<span class="builtintype" id="5148336">string</span>&nbsp;<span class="op" id="5148343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5148346">if</span>&nbsp;<span class="ident" id="5148349"><a href="/encoding/gob/type.go.html#5148314">seen</a></span><span class="op" id="5148353">[</span><span class="ident" id="5148354"><a href="/encoding/gob/type.go.html#5148289">a</a></span><span class="op" id="5148355">.</span><span class="ident" id="5148356">Id</span><span class="op" id="5148358">]</span>&nbsp;<span class="op" id="5148360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5148364">return</span>&nbsp;<span class="ident" id="5148371"><a href="/encoding/gob/type.go.html#5148289">a</a></span><span class="op" id="5148372">.</span><span class="ident" id="5148373">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5148379">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148382"><a href="/encoding/gob/type.go.html#5148314">seen</a></span><span class="op" id="5148386">[</span><span class="ident" id="5148387"><a href="/encoding/gob/type.go.html#5148289">a</a></span><span class="op" id="5148388">.</span><span class="ident" id="5148389">Id</span><span class="op" id="5148391">]</span>&nbsp;<span class="op" id="5148393">=</span>&nbsp;<span class="ident" id="5148395">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5148401">return</span>&nbsp;<span class="ident" id="5148408"><a href="/encoding/gob/type.go.html#5138383">fmt</a></span><span class="op" id="5148411">.</span><span class="ident" id="5148412">Sprintf</span><span class="op" id="5148419">(</span><span class="string" id="5148420">&#34;[%d]%s&#34;</span><span class="op" id="5148428">,</span>&nbsp;<span class="ident" id="5148430"><a href="/encoding/gob/type.go.html#5148289">a</a></span><span class="op" id="5148431">.</span><span class="ident" id="5148432">Len</span><span class="op" id="5148435">,</span>&nbsp;<span class="ident" id="5148437"><a href="/encoding/gob/type.go.html#5148289">a</a></span><span class="op" id="5148438">.</span><span class="ident" id="5148439">Elem</span><span class="op" id="5148443">.</span><span class="ident" id="5148444">gobType</span><span class="op" id="5148451">(</span><span class="op" id="5148452">)</span><span class="op" id="5148453">.</span><span class="ident" id="5148454">safeString</span><span class="op" id="5148464">(</span><span class="ident" id="5148465"><a href="/encoding/gob/type.go.html#5148314">seen</a></span><span class="op" id="5148469">)</span><span class="op" id="5148470">)</span><br>
<span class="lineno"></span><span class="op" id="5148472">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5148475">func</span>&nbsp;<span class="op" id="5148480">(</span><span class="ident" id="5148481">a</span>&nbsp;<span class="op" id="5148483">*</span><span class="ident" id="5148484"><a href="/encoding/gob/type.go.html#5147947">arrayType</a></span><span class="op" id="5148493">)</span>&nbsp;<span class="builtintype" id="5148495">string</span><span class="op" id="5148501">(</span><span class="op" id="5148502">)</span>&nbsp;<span class="builtintype" id="5148504">string</span>&nbsp;<span class="op" id="5148511">{</span>&nbsp;<span class="keyword" id="5148513">return</span>&nbsp;<span class="ident" id="5148520"><a href="/encoding/gob/type.go.html#5148481">a</a></span><span class="op" id="5148521">.</span><span class="ident" id="5148522">safeString</span><span class="op" id="5148532">(</span><span class="builtinfunc" id="5148533">make</span><span class="op" id="5148537">(</span><span class="keyword" id="5148538">map</span><span class="op" id="5148541">[</span><span class="ident" id="5148542"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5148548">]</span><span class="builtintype" id="5148549">bool</span><span class="op" id="5148553">)</span><span class="op" id="5148554">)</span>&nbsp;<span class="op" id="5148556">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="comment" id="5148559">//&nbsp;GobEncoder&nbsp;type&nbsp;(something&nbsp;that&nbsp;implements&nbsp;the&nbsp;GobEncoder&nbsp;interface)</span><br>
<span class="lineno"></span><span class="keyword" id="5148631">type</span>&nbsp;<span class="ident" id="5148636">gobEncoderType</span>&nbsp;<span class="keyword" id="5148651">struct</span>&nbsp;<span class="op" id="5148658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148661"><a href="/encoding/gob/type.go.html#5145250">CommonType</a></span><br>
<span class="lineno"></span><span class="op" id="5148672">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="5148675">func</span>&nbsp;<span class="ident" id="5148680">newGobEncoderType</span><span class="op" id="5148697">(</span><span class="ident" id="5148698">name</span>&nbsp;<span class="builtintype" id="5148703">string</span><span class="op" id="5148709">)</span>&nbsp;<span class="op" id="5148711">*</span><span class="ident" id="5148712"><a href="/encoding/gob/type.go.html#5148636">gobEncoderType</a></span>&nbsp;<span class="op" id="5148727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148730">g</span>&nbsp;<span class="op" id="5148732">:=</span>&nbsp;<span class="op" id="5148735">&amp;</span><span class="ident" id="5148736"><a href="/encoding/gob/type.go.html#5148636">gobEncoderType</a></span><span class="op" id="5148750">{</span><span class="ident" id="5148751"><a href="/encoding/gob/type.go.html#5145250">CommonType</a></span><span class="op" id="5148761">{</span><span class="ident" id="5148762">Name</span><span class="op" id="5148766">:</span>&nbsp;<span class="ident" id="5148768"><a href="/encoding/gob/type.go.html#5148698">name</a></span><span class="op" id="5148772">}</span><span class="op" id="5148773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148776"><a href="/encoding/gob/type.go.html#5144371">setTypeId</a></span><span class="op" id="5148785">(</span><span class="ident" id="5148786"><a href="/encoding/gob/type.go.html#5148730">g</a></span><span class="op" id="5148787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5148790">return</span>&nbsp;<span class="ident" id="5148797"><a href="/encoding/gob/type.go.html#5148730">g</a></span><br>
<span class="lineno">335</span><span class="op" id="5148799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5148802">func</span>&nbsp;<span class="op" id="5148807">(</span><span class="ident" id="5148808">g</span>&nbsp;<span class="op" id="5148810">*</span><span class="ident" id="5148811"><a href="/encoding/gob/type.go.html#5148636">gobEncoderType</a></span><span class="op" id="5148825">)</span>&nbsp;<span class="ident" id="5148827">safeString</span><span class="op" id="5148837">(</span><span class="ident" id="5148838">seen</span>&nbsp;<span class="keyword" id="5148843">map</span><span class="op" id="5148846">[</span><span class="ident" id="5148847"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5148853">]</span><span class="builtintype" id="5148854">bool</span><span class="op" id="5148858">)</span>&nbsp;<span class="builtintype" id="5148860">string</span>&nbsp;<span class="op" id="5148867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5148870">return</span>&nbsp;<span class="ident" id="5148877"><a href="/encoding/gob/type.go.html#5148808">g</a></span><span class="op" id="5148878">.</span><span class="ident" id="5148879">Name</span><br>
<span class="lineno"></span><span class="op" id="5148884">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="keyword" id="5148887">func</span>&nbsp;<span class="op" id="5148892">(</span><span class="ident" id="5148893">g</span>&nbsp;<span class="op" id="5148895">*</span><span class="ident" id="5148896"><a href="/encoding/gob/type.go.html#5148636">gobEncoderType</a></span><span class="op" id="5148910">)</span>&nbsp;<span class="builtintype" id="5148912">string</span><span class="op" id="5148918">(</span><span class="op" id="5148919">)</span>&nbsp;<span class="builtintype" id="5148921">string</span>&nbsp;<span class="op" id="5148928">{</span>&nbsp;<span class="keyword" id="5148930">return</span>&nbsp;<span class="ident" id="5148937"><a href="/encoding/gob/type.go.html#5148893">g</a></span><span class="op" id="5148938">.</span><span class="ident" id="5148939">Name</span>&nbsp;<span class="op" id="5148944">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5148947">//&nbsp;Map&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="5148959">type</span>&nbsp;<span class="ident" id="5148964">mapType</span>&nbsp;<span class="keyword" id="5148972">struct</span>&nbsp;<span class="op" id="5148979">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148982"><a href="/encoding/gob/type.go.html#5145250">CommonType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5148994">Key</span>&nbsp;&nbsp;<span class="ident" id="5148999"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149007">Elem</span>&nbsp;<span class="ident" id="5149012"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><br>
<span class="lineno"></span><span class="op" id="5149019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="5149022">func</span>&nbsp;<span class="ident" id="5149027">newMapType</span><span class="op" id="5149037">(</span><span class="ident" id="5149038">name</span>&nbsp;<span class="builtintype" id="5149043">string</span><span class="op" id="5149049">)</span>&nbsp;<span class="op" id="5149051">*</span><span class="ident" id="5149052"><a href="/encoding/gob/type.go.html#5148964">mapType</a></span>&nbsp;<span class="op" id="5149060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149063">m</span>&nbsp;<span class="op" id="5149065">:=</span>&nbsp;<span class="op" id="5149068">&amp;</span><span class="ident" id="5149069"><a href="/encoding/gob/type.go.html#5148964">mapType</a></span><span class="op" id="5149076">{</span><span class="ident" id="5149077"><a href="/encoding/gob/type.go.html#5145250">CommonType</a></span><span class="op" id="5149087">{</span><span class="ident" id="5149088">Name</span><span class="op" id="5149092">:</span>&nbsp;<span class="ident" id="5149094"><a href="/encoding/gob/type.go.html#5149038">name</a></span><span class="op" id="5149098">}</span><span class="op" id="5149099">,</span>&nbsp;<span class="num" id="5149101">0</span><span class="op" id="5149102">,</span>&nbsp;<span class="num" id="5149104">0</span><span class="op" id="5149105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149108">return</span>&nbsp;<span class="ident" id="5149115"><a href="/encoding/gob/type.go.html#5149063">m</a></span><br>
<span class="lineno"></span><span class="op" id="5149117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="5149120">func</span>&nbsp;<span class="op" id="5149125">(</span><span class="ident" id="5149126">m</span>&nbsp;<span class="op" id="5149128">*</span><span class="ident" id="5149129"><a href="/encoding/gob/type.go.html#5148964">mapType</a></span><span class="op" id="5149136">)</span>&nbsp;<span class="ident" id="5149138">init</span><span class="op" id="5149142">(</span><span class="ident" id="5149143">key</span><span class="op" id="5149146">,</span>&nbsp;<span class="ident" id="5149148">elem</span>&nbsp;<span class="ident" id="5149153"><a href="/encoding/gob/type.go.html#5144034">gobType</a></span><span class="op" id="5149160">)</span>&nbsp;<span class="op" id="5149162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5149165">//&nbsp;Set&nbsp;our&nbsp;type&nbsp;id&nbsp;before&nbsp;evaluating&nbsp;the&nbsp;element&#39;s,&nbsp;in&nbsp;case&nbsp;it&#39;s&nbsp;our&nbsp;own.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149240"><a href="/encoding/gob/type.go.html#5144371">setTypeId</a></span><span class="op" id="5149249">(</span><span class="ident" id="5149250"><a href="/encoding/gob/type.go.html#5149126">m</a></span><span class="op" id="5149251">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149254"><a href="/encoding/gob/type.go.html#5149126">m</a></span><span class="op" id="5149255">.</span><span class="ident" id="5149256">Key</span>&nbsp;<span class="op" id="5149260">=</span>&nbsp;<span class="ident" id="5149262"><a href="/encoding/gob/type.go.html#5149143">key</a></span><span class="op" id="5149265">.</span><span class="ident" id="5149266">id</span><span class="op" id="5149268">(</span><span class="op" id="5149269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149272"><a href="/encoding/gob/type.go.html#5149126">m</a></span><span class="op" id="5149273">.</span><span class="ident" id="5149274">Elem</span>&nbsp;<span class="op" id="5149279">=</span>&nbsp;<span class="ident" id="5149281"><a href="/encoding/gob/type.go.html#5149148">elem</a></span><span class="op" id="5149285">.</span><span class="ident" id="5149286">id</span><span class="op" id="5149288">(</span><span class="op" id="5149289">)</span><br>
<span class="lineno">360</span><span class="op" id="5149291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5149294">func</span>&nbsp;<span class="op" id="5149299">(</span><span class="ident" id="5149300">m</span>&nbsp;<span class="op" id="5149302">*</span><span class="ident" id="5149303"><a href="/encoding/gob/type.go.html#5148964">mapType</a></span><span class="op" id="5149310">)</span>&nbsp;<span class="ident" id="5149312">safeString</span><span class="op" id="5149322">(</span><span class="ident" id="5149323">seen</span>&nbsp;<span class="keyword" id="5149328">map</span><span class="op" id="5149331">[</span><span class="ident" id="5149332"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5149338">]</span><span class="builtintype" id="5149339">bool</span><span class="op" id="5149343">)</span>&nbsp;<span class="builtintype" id="5149345">string</span>&nbsp;<span class="op" id="5149352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149355">if</span>&nbsp;<span class="ident" id="5149358"><a href="/encoding/gob/type.go.html#5149323">seen</a></span><span class="op" id="5149362">[</span><span class="ident" id="5149363"><a href="/encoding/gob/type.go.html#5149300">m</a></span><span class="op" id="5149364">.</span><span class="ident" id="5149365">Id</span><span class="op" id="5149367">]</span>&nbsp;<span class="op" id="5149369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149373">return</span>&nbsp;<span class="ident" id="5149380"><a href="/encoding/gob/type.go.html#5149300">m</a></span><span class="op" id="5149381">.</span><span class="ident" id="5149382">Name</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5149388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149391"><a href="/encoding/gob/type.go.html#5149323">seen</a></span><span class="op" id="5149395">[</span><span class="ident" id="5149396"><a href="/encoding/gob/type.go.html#5149300">m</a></span><span class="op" id="5149397">.</span><span class="ident" id="5149398">Id</span><span class="op" id="5149400">]</span>&nbsp;<span class="op" id="5149402">=</span>&nbsp;<span class="ident" id="5149404">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149410">key</span>&nbsp;<span class="op" id="5149414">:=</span>&nbsp;<span class="ident" id="5149417"><a href="/encoding/gob/type.go.html#5149300">m</a></span><span class="op" id="5149418">.</span><span class="ident" id="5149419">Key</span><span class="op" id="5149422">.</span><span class="ident" id="5149423">gobType</span><span class="op" id="5149430">(</span><span class="op" id="5149431">)</span><span class="op" id="5149432">.</span><span class="ident" id="5149433">safeString</span><span class="op" id="5149443">(</span><span class="ident" id="5149444"><a href="/encoding/gob/type.go.html#5149323">seen</a></span><span class="op" id="5149448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149451">elem</span>&nbsp;<span class="op" id="5149456">:=</span>&nbsp;<span class="ident" id="5149459"><a href="/encoding/gob/type.go.html#5149300">m</a></span><span class="op" id="5149460">.</span><span class="ident" id="5149461">Elem</span><span class="op" id="5149465">.</span><span class="ident" id="5149466">gobType</span><span class="op" id="5149473">(</span><span class="op" id="5149474">)</span><span class="op" id="5149475">.</span><span class="ident" id="5149476">safeString</span><span class="op" id="5149486">(</span><span class="ident" id="5149487"><a href="/encoding/gob/type.go.html#5149323">seen</a></span><span class="op" id="5149491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149494">return</span>&nbsp;<span class="ident" id="5149501"><a href="/encoding/gob/type.go.html#5138383">fmt</a></span><span class="op" id="5149504">.</span><span class="ident" id="5149505">Sprintf</span><span class="op" id="5149512">(</span><span class="string" id="5149513">&#34;map[%s]%s&#34;</span><span class="op" id="5149524">,</span>&nbsp;<span class="ident" id="5149526"><a href="/encoding/gob/type.go.html#5149410">key</a></span><span class="op" id="5149529">,</span>&nbsp;<span class="ident" id="5149531"><a href="/encoding/gob/type.go.html#5149451">elem</a></span><span class="op" id="5149535">)</span><br>
<span class="lineno">370</span><span class="op" id="5149537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5149540">func</span>&nbsp;<span class="op" id="5149545">(</span><span class="ident" id="5149546">m</span>&nbsp;<span class="op" id="5149548">*</span><span class="ident" id="5149549"><a href="/encoding/gob/type.go.html#5148964">mapType</a></span><span class="op" id="5149556">)</span>&nbsp;<span class="builtintype" id="5149558">string</span><span class="op" id="5149564">(</span><span class="op" id="5149565">)</span>&nbsp;<span class="builtintype" id="5149567">string</span>&nbsp;<span class="op" id="5149574">{</span>&nbsp;<span class="keyword" id="5149576">return</span>&nbsp;<span class="ident" id="5149583"><a href="/encoding/gob/type.go.html#5149546">m</a></span><span class="op" id="5149584">.</span><span class="ident" id="5149585">safeString</span><span class="op" id="5149595">(</span><span class="builtinfunc" id="5149596">make</span><span class="op" id="5149600">(</span><span class="keyword" id="5149601">map</span><span class="op" id="5149604">[</span><span class="ident" id="5149605"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5149611">]</span><span class="builtintype" id="5149612">bool</span><span class="op" id="5149616">)</span><span class="op" id="5149617">)</span>&nbsp;<span class="op" id="5149619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5149622">//&nbsp;Slice&nbsp;type</span><br>
<span class="lineno">375</span><span class="keyword" id="5149636">type</span>&nbsp;<span class="ident" id="5149641">sliceType</span>&nbsp;<span class="keyword" id="5149651">struct</span>&nbsp;<span class="op" id="5149658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149661"><a href="/encoding/gob/type.go.html#5145250">CommonType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149673">Elem</span>&nbsp;<span class="ident" id="5149678"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><br>
<span class="lineno"></span><span class="op" id="5149685">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">380</span><span class="keyword" id="5149688">func</span>&nbsp;<span class="ident" id="5149693">newSliceType</span><span class="op" id="5149705">(</span><span class="ident" id="5149706">name</span>&nbsp;<span class="builtintype" id="5149711">string</span><span class="op" id="5149717">)</span>&nbsp;<span class="op" id="5149719">*</span><span class="ident" id="5149720"><a href="/encoding/gob/type.go.html#5149641">sliceType</a></span>&nbsp;<span class="op" id="5149730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149733">s</span>&nbsp;<span class="op" id="5149735">:=</span>&nbsp;<span class="op" id="5149738">&amp;</span><span class="ident" id="5149739"><a href="/encoding/gob/type.go.html#5149641">sliceType</a></span><span class="op" id="5149748">{</span><span class="ident" id="5149749"><a href="/encoding/gob/type.go.html#5145250">CommonType</a></span><span class="op" id="5149759">{</span><span class="ident" id="5149760">Name</span><span class="op" id="5149764">:</span>&nbsp;<span class="ident" id="5149766"><a href="/encoding/gob/type.go.html#5149706">name</a></span><span class="op" id="5149770">}</span><span class="op" id="5149771">,</span>&nbsp;<span class="num" id="5149773">0</span><span class="op" id="5149774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5149777">return</span>&nbsp;<span class="ident" id="5149784"><a href="/encoding/gob/type.go.html#5149733">s</a></span><br>
<span class="lineno"></span><span class="op" id="5149786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="5149789">func</span>&nbsp;<span class="op" id="5149794">(</span><span class="ident" id="5149795">s</span>&nbsp;<span class="op" id="5149797">*</span><span class="ident" id="5149798"><a href="/encoding/gob/type.go.html#5149641">sliceType</a></span><span class="op" id="5149807">)</span>&nbsp;<span class="ident" id="5149809">init</span><span class="op" id="5149813">(</span><span class="ident" id="5149814">elem</span>&nbsp;<span class="ident" id="5149819"><a href="/encoding/gob/type.go.html#5144034">gobType</a></span><span class="op" id="5149826">)</span>&nbsp;<span class="op" id="5149828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5149831">//&nbsp;Set&nbsp;our&nbsp;type&nbsp;id&nbsp;before&nbsp;evaluating&nbsp;the&nbsp;element&#39;s,&nbsp;in&nbsp;case&nbsp;it&#39;s&nbsp;our&nbsp;own.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5149906"><a href="/encoding/gob/type.go.html#5144371">setTypeId</a></span><span class="op" id="5149915">(</span><span class="ident" id="5149916"><a href="/encoding/gob/type.go.html#5149795">s</a></span><span class="op" id="5149917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5149920">//&nbsp;See&nbsp;the&nbsp;comments&nbsp;about&nbsp;ids&nbsp;in&nbsp;newTypeObject.&nbsp;Only&nbsp;slices&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5149985">//&nbsp;structs&nbsp;have&nbsp;mutual&nbsp;recursion.</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150020">if</span>&nbsp;<span class="ident" id="5150023"><a href="/encoding/gob/type.go.html#5149814">elem</a></span><span class="op" id="5150027">.</span><span class="ident" id="5150028">id</span><span class="op" id="5150030">(</span><span class="op" id="5150031">)</span>&nbsp;<span class="op" id="5150033">==</span>&nbsp;<span class="num" id="5150036">0</span>&nbsp;<span class="op" id="5150038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150042"><a href="/encoding/gob/type.go.html#5144371">setTypeId</a></span><span class="op" id="5150051">(</span><span class="ident" id="5150052"><a href="/encoding/gob/type.go.html#5149814">elem</a></span><span class="op" id="5150056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5150059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150062"><a href="/encoding/gob/type.go.html#5149795">s</a></span><span class="op" id="5150063">.</span><span class="ident" id="5150064">Elem</span>&nbsp;<span class="op" id="5150069">=</span>&nbsp;<span class="ident" id="5150071"><a href="/encoding/gob/type.go.html#5149814">elem</a></span><span class="op" id="5150075">.</span><span class="ident" id="5150076">id</span><span class="op" id="5150078">(</span><span class="op" id="5150079">)</span><br>
<span class="lineno"></span><span class="op" id="5150081">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="keyword" id="5150084">func</span>&nbsp;<span class="op" id="5150089">(</span><span class="ident" id="5150090">s</span>&nbsp;<span class="op" id="5150092">*</span><span class="ident" id="5150093"><a href="/encoding/gob/type.go.html#5149641">sliceType</a></span><span class="op" id="5150102">)</span>&nbsp;<span class="ident" id="5150104">safeString</span><span class="op" id="5150114">(</span><span class="ident" id="5150115">seen</span>&nbsp;<span class="keyword" id="5150120">map</span><span class="op" id="5150123">[</span><span class="ident" id="5150124"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5150130">]</span><span class="builtintype" id="5150131">bool</span><span class="op" id="5150135">)</span>&nbsp;<span class="builtintype" id="5150137">string</span>&nbsp;<span class="op" id="5150144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150147">if</span>&nbsp;<span class="ident" id="5150150"><a href="/encoding/gob/type.go.html#5150115">seen</a></span><span class="op" id="5150154">[</span><span class="ident" id="5150155"><a href="/encoding/gob/type.go.html#5150090">s</a></span><span class="op" id="5150156">.</span><span class="ident" id="5150157">Id</span><span class="op" id="5150159">]</span>&nbsp;<span class="op" id="5150161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150165">return</span>&nbsp;<span class="ident" id="5150172"><a href="/encoding/gob/type.go.html#5150090">s</a></span><span class="op" id="5150173">.</span><span class="ident" id="5150174">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5150180">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150183"><a href="/encoding/gob/type.go.html#5150115">seen</a></span><span class="op" id="5150187">[</span><span class="ident" id="5150188"><a href="/encoding/gob/type.go.html#5150090">s</a></span><span class="op" id="5150189">.</span><span class="ident" id="5150190">Id</span><span class="op" id="5150192">]</span>&nbsp;<span class="op" id="5150194">=</span>&nbsp;<span class="ident" id="5150196">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150202">return</span>&nbsp;<span class="ident" id="5150209"><a href="/encoding/gob/type.go.html#5138383">fmt</a></span><span class="op" id="5150212">.</span><span class="ident" id="5150213">Sprintf</span><span class="op" id="5150220">(</span><span class="string" id="5150221">&#34;[]%s&#34;</span><span class="op" id="5150227">,</span>&nbsp;<span class="ident" id="5150229"><a href="/encoding/gob/type.go.html#5150090">s</a></span><span class="op" id="5150230">.</span><span class="ident" id="5150231">Elem</span><span class="op" id="5150235">.</span><span class="ident" id="5150236">gobType</span><span class="op" id="5150243">(</span><span class="op" id="5150244">)</span><span class="op" id="5150245">.</span><span class="ident" id="5150246">safeString</span><span class="op" id="5150256">(</span><span class="ident" id="5150257"><a href="/encoding/gob/type.go.html#5150115">seen</a></span><span class="op" id="5150261">)</span><span class="op" id="5150262">)</span><br>
<span class="lineno"></span><span class="op" id="5150264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5150267">func</span>&nbsp;<span class="op" id="5150272">(</span><span class="ident" id="5150273">s</span>&nbsp;<span class="op" id="5150275">*</span><span class="ident" id="5150276"><a href="/encoding/gob/type.go.html#5149641">sliceType</a></span><span class="op" id="5150285">)</span>&nbsp;<span class="builtintype" id="5150287">string</span><span class="op" id="5150293">(</span><span class="op" id="5150294">)</span>&nbsp;<span class="builtintype" id="5150296">string</span>&nbsp;<span class="op" id="5150303">{</span>&nbsp;<span class="keyword" id="5150305">return</span>&nbsp;<span class="ident" id="5150312"><a href="/encoding/gob/type.go.html#5150273">s</a></span><span class="op" id="5150313">.</span><span class="ident" id="5150314">safeString</span><span class="op" id="5150324">(</span><span class="builtinfunc" id="5150325">make</span><span class="op" id="5150329">(</span><span class="keyword" id="5150330">map</span><span class="op" id="5150333">[</span><span class="ident" id="5150334"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5150340">]</span><span class="builtintype" id="5150341">bool</span><span class="op" id="5150345">)</span><span class="op" id="5150346">)</span>&nbsp;<span class="op" id="5150348">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="comment" id="5150351">//&nbsp;Struct&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="5150366">type</span>&nbsp;<span class="ident" id="5150371">fieldType</span>&nbsp;<span class="keyword" id="5150381">struct</span>&nbsp;<span class="op" id="5150388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150391">Name</span>&nbsp;<span class="builtintype" id="5150396">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150404">Id</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5150409"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><br>
<span class="lineno">410</span><span class="op" id="5150416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5150419">type</span>&nbsp;<span class="ident" id="5150424">structType</span>&nbsp;<span class="keyword" id="5150435">struct</span>&nbsp;<span class="op" id="5150442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150445"><a href="/encoding/gob/type.go.html#5145250">CommonType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150457">Field</span>&nbsp;<span class="op" id="5150463">[</span><span class="op" id="5150464">]</span><span class="op" id="5150465">*</span><span class="ident" id="5150466"><a href="/encoding/gob/type.go.html#5150371">fieldType</a></span><br>
<span class="lineno">415</span><span class="op" id="5150476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5150479">func</span>&nbsp;<span class="op" id="5150484">(</span><span class="ident" id="5150485">s</span>&nbsp;<span class="op" id="5150487">*</span><span class="ident" id="5150488"><a href="/encoding/gob/type.go.html#5150424">structType</a></span><span class="op" id="5150498">)</span>&nbsp;<span class="ident" id="5150500">safeString</span><span class="op" id="5150510">(</span><span class="ident" id="5150511">seen</span>&nbsp;<span class="keyword" id="5150516">map</span><span class="op" id="5150519">[</span><span class="ident" id="5150520"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5150526">]</span><span class="builtintype" id="5150527">bool</span><span class="op" id="5150531">)</span>&nbsp;<span class="builtintype" id="5150533">string</span>&nbsp;<span class="op" id="5150540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150543">if</span>&nbsp;<span class="ident" id="5150546"><a href="/encoding/gob/type.go.html#5150485">s</a></span>&nbsp;<span class="op" id="5150548">==</span>&nbsp;<span class="ident" id="5150551">nil</span>&nbsp;<span class="op" id="5150555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150559">return</span>&nbsp;<span class="string" id="5150566">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5150575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150578">if</span>&nbsp;<span class="ident" id="5150581">_</span><span class="op" id="5150582">,</span>&nbsp;<span class="ident" id="5150584">ok</span>&nbsp;<span class="op" id="5150587">:=</span>&nbsp;<span class="ident" id="5150590"><a href="/encoding/gob/type.go.html#5150511">seen</a></span><span class="op" id="5150594">[</span><span class="ident" id="5150595"><a href="/encoding/gob/type.go.html#5150485">s</a></span><span class="op" id="5150596">.</span><span class="ident" id="5150597">Id</span><span class="op" id="5150599">]</span><span class="op" id="5150600">;</span>&nbsp;<span class="ident" id="5150602"><a href="/encoding/gob/type.go.html#5150584">ok</a></span>&nbsp;<span class="op" id="5150605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150609">return</span>&nbsp;<span class="ident" id="5150616"><a href="/encoding/gob/type.go.html#5150485">s</a></span><span class="op" id="5150617">.</span><span class="ident" id="5150618">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5150624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150627"><a href="/encoding/gob/type.go.html#5150511">seen</a></span><span class="op" id="5150631">[</span><span class="ident" id="5150632"><a href="/encoding/gob/type.go.html#5150485">s</a></span><span class="op" id="5150633">.</span><span class="ident" id="5150634">Id</span><span class="op" id="5150636">]</span>&nbsp;<span class="op" id="5150638">=</span>&nbsp;<span class="ident" id="5150640">true</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150646">str</span>&nbsp;<span class="op" id="5150650">:=</span>&nbsp;<span class="ident" id="5150653"><a href="/encoding/gob/type.go.html#5150485">s</a></span><span class="op" id="5150654">.</span><span class="ident" id="5150655">Name</span>&nbsp;<span class="op" id="5150660">+</span>&nbsp;<span class="string" id="5150662">&#34;&nbsp;=&nbsp;struct&nbsp;{&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150678">for</span>&nbsp;<span class="ident" id="5150682">_</span><span class="op" id="5150683">,</span>&nbsp;<span class="ident" id="5150685">f</span>&nbsp;<span class="op" id="5150687">:=</span>&nbsp;<span class="keyword" id="5150690">range</span>&nbsp;<span class="ident" id="5150696"><a href="/encoding/gob/type.go.html#5150485">s</a></span><span class="op" id="5150697">.</span><span class="ident" id="5150698">Field</span>&nbsp;<span class="op" id="5150704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150708"><a href="/encoding/gob/type.go.html#5150646">str</a></span>&nbsp;<span class="op" id="5150712">+=</span>&nbsp;<span class="ident" id="5150715"><a href="/encoding/gob/type.go.html#5138383">fmt</a></span><span class="op" id="5150718">.</span><span class="ident" id="5150719">Sprintf</span><span class="op" id="5150726">(</span><span class="string" id="5150727">&#34;%s&nbsp;%s;&nbsp;&#34;</span><span class="op" id="5150736">,</span>&nbsp;<span class="ident" id="5150738"><a href="/encoding/gob/type.go.html#5150685">f</a></span><span class="op" id="5150739">.</span><span class="ident" id="5150740">Name</span><span class="op" id="5150744">,</span>&nbsp;<span class="ident" id="5150746"><a href="/encoding/gob/type.go.html#5150685">f</a></span><span class="op" id="5150747">.</span><span class="ident" id="5150748">Id</span><span class="op" id="5150750">.</span><span class="ident" id="5150751">gobType</span><span class="op" id="5150758">(</span><span class="op" id="5150759">)</span><span class="op" id="5150760">.</span><span class="ident" id="5150761">safeString</span><span class="op" id="5150771">(</span><span class="ident" id="5150772"><a href="/encoding/gob/type.go.html#5150511">seen</a></span><span class="op" id="5150776">)</span><span class="op" id="5150777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5150780">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150783"><a href="/encoding/gob/type.go.html#5150646">str</a></span>&nbsp;<span class="op" id="5150787">+=</span>&nbsp;<span class="string" id="5150790">&#34;}&#34;</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5150795">return</span>&nbsp;<span class="ident" id="5150802"><a href="/encoding/gob/type.go.html#5150646">str</a></span><br>
<span class="lineno"></span><span class="op" id="5150806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5150809">func</span>&nbsp;<span class="op" id="5150814">(</span><span class="ident" id="5150815">s</span>&nbsp;<span class="op" id="5150817">*</span><span class="ident" id="5150818"><a href="/encoding/gob/type.go.html#5150424">structType</a></span><span class="op" id="5150828">)</span>&nbsp;<span class="builtintype" id="5150830">string</span><span class="op" id="5150836">(</span><span class="op" id="5150837">)</span>&nbsp;<span class="builtintype" id="5150839">string</span>&nbsp;<span class="op" id="5150846">{</span>&nbsp;<span class="keyword" id="5150848">return</span>&nbsp;<span class="ident" id="5150855"><a href="/encoding/gob/type.go.html#5150815">s</a></span><span class="op" id="5150856">.</span><span class="ident" id="5150857">safeString</span><span class="op" id="5150867">(</span><span class="builtinfunc" id="5150868">make</span><span class="op" id="5150872">(</span><span class="keyword" id="5150873">map</span><span class="op" id="5150876">[</span><span class="ident" id="5150877"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5150883">]</span><span class="builtintype" id="5150884">bool</span><span class="op" id="5150888">)</span><span class="op" id="5150889">)</span>&nbsp;<span class="op" id="5150891">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="keyword" id="5150894">func</span>&nbsp;<span class="ident" id="5150899">newStructType</span><span class="op" id="5150912">(</span><span class="ident" id="5150913">name</span>&nbsp;<span class="builtintype" id="5150918">string</span><span class="op" id="5150924">)</span>&nbsp;<span class="op" id="5150926">*</span><span class="ident" id="5150927"><a href="/encoding/gob/type.go.html#5150424">structType</a></span>&nbsp;<span class="op" id="5150938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5150941">s</span>&nbsp;<span class="op" id="5150943">:=</span>&nbsp;<span class="op" id="5150946">&amp;</span><span class="ident" id="5150947"><a href="/encoding/gob/type.go.html#5150424">structType</a></span><span class="op" id="5150957">{</span><span class="ident" id="5150958"><a href="/encoding/gob/type.go.html#5145250">CommonType</a></span><span class="op" id="5150968">{</span><span class="ident" id="5150969">Name</span><span class="op" id="5150973">:</span>&nbsp;<span class="ident" id="5150975"><a href="/encoding/gob/type.go.html#5150913">name</a></span><span class="op" id="5150979">}</span><span class="op" id="5150980">,</span>&nbsp;<span class="ident" id="5150982">nil</span><span class="op" id="5150985">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5150988">//&nbsp;For&nbsp;historical&nbsp;reasons&nbsp;we&nbsp;set&nbsp;the&nbsp;id&nbsp;here&nbsp;rather&nbsp;than&nbsp;init.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5151052">//&nbsp;See&nbsp;the&nbsp;comment&nbsp;in&nbsp;newTypeObject&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5151102"><a href="/encoding/gob/type.go.html#5144371">setTypeId</a></span><span class="op" id="5151111">(</span><span class="ident" id="5151112"><a href="/encoding/gob/type.go.html#5150941">s</a></span><span class="op" id="5151113">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151116">return</span>&nbsp;<span class="ident" id="5151123"><a href="/encoding/gob/type.go.html#5150941">s</a></span><br>
<span class="lineno"></span><span class="op" id="5151125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5151128">//&nbsp;newTypeObject&nbsp;allocates&nbsp;a&nbsp;gobType&nbsp;for&nbsp;the&nbsp;reflection&nbsp;type&nbsp;rt.</span><br>
<span class="lineno"></span><span class="comment" id="5151193">//&nbsp;Unless&nbsp;ut&nbsp;represents&nbsp;a&nbsp;GobEncoder,&nbsp;rt&nbsp;should&nbsp;be&nbsp;the&nbsp;base&nbsp;type</span><br>
<span class="lineno">445</span><span class="comment" id="5151258">//&nbsp;of&nbsp;ut.</span><br>
<span class="lineno"></span><span class="comment" id="5151268">//&nbsp;This&nbsp;is&nbsp;only&nbsp;called&nbsp;from&nbsp;the&nbsp;encoding&nbsp;side.&nbsp;The&nbsp;decoding&nbsp;side</span><br>
<span class="lineno"></span><span class="comment" id="5151333">//&nbsp;works&nbsp;through&nbsp;typeIds&nbsp;and&nbsp;userTypeInfos&nbsp;alone.</span><br>
<span class="lineno"></span><span class="keyword" id="5151383">func</span>&nbsp;<span class="ident" id="5151388">newTypeObject</span><span class="op" id="5151401">(</span><span class="ident" id="5151402">name</span>&nbsp;<span class="builtintype" id="5151407">string</span><span class="op" id="5151413">,</span>&nbsp;<span class="ident" id="5151415">ut</span>&nbsp;<span class="op" id="5151418">*</span><span class="ident" id="5151419"><a href="/encoding/gob/type.go.html#5138634">userTypeInfo</a></span><span class="op" id="5151431">,</span>&nbsp;<span class="ident" id="5151433">rt</span>&nbsp;<span class="ident" id="5151436"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5151443">.</span><span class="ident" id="5151444">Type</span><span class="op" id="5151448">)</span>&nbsp;<span class="op" id="5151450">(</span><span class="ident" id="5151451"><a href="/encoding/gob/type.go.html#5144034">gobType</a></span><span class="op" id="5151458">,</span>&nbsp;<span class="builtintype" id="5151460">error</span><span class="op" id="5151465">)</span>&nbsp;<span class="op" id="5151467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5151470">//&nbsp;Does&nbsp;this&nbsp;type&nbsp;implement&nbsp;GobEncoder?</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151511">if</span>&nbsp;<span class="ident" id="5151514"><a href="/encoding/gob/type.go.html#5151415">ut</a></span><span class="op" id="5151516">.</span><span class="ident" id="5151517">externalEnc</span>&nbsp;<span class="op" id="5151529">!=</span>&nbsp;<span class="num" id="5151532">0</span>&nbsp;<span class="op" id="5151534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151538">return</span>&nbsp;<span class="ident" id="5151545"><a href="/encoding/gob/type.go.html#5148680">newGobEncoderType</a></span><span class="op" id="5151562">(</span><span class="ident" id="5151563"><a href="/encoding/gob/type.go.html#5151402">name</a></span><span class="op" id="5151567">)</span><span class="op" id="5151568">,</span>&nbsp;<span class="ident" id="5151570">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5151575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151578">var</span>&nbsp;<span class="ident" id="5151582">err</span>&nbsp;<span class="builtintype" id="5151586">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151593">var</span>&nbsp;<span class="ident" id="5151597">type0</span><span class="op" id="5151602">,</span>&nbsp;<span class="ident" id="5151604">type1</span>&nbsp;<span class="ident" id="5151610"><a href="/encoding/gob/type.go.html#5144034">gobType</a></span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151619">defer</span>&nbsp;<span class="keyword" id="5151625">func</span><span class="op" id="5151629">(</span><span class="op" id="5151630">)</span>&nbsp;<span class="op" id="5151632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151636">if</span>&nbsp;<span class="ident" id="5151639"><a href="/encoding/gob/type.go.html#5151582">err</a></span>&nbsp;<span class="op" id="5151643">!=</span>&nbsp;<span class="ident" id="5151646">nil</span>&nbsp;<span class="op" id="5151650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5151655">delete</span><span class="op" id="5151661">(</span><span class="ident" id="5151662"><a href="/encoding/gob/type.go.html#5144199">types</a></span><span class="op" id="5151667">,</span>&nbsp;<span class="ident" id="5151669"><a href="/encoding/gob/type.go.html#5151433">rt</a></span><span class="op" id="5151671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5151675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5151678">}</span><span class="op" id="5151679">(</span><span class="op" id="5151680">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5151683">//&nbsp;Install&nbsp;the&nbsp;top-level&nbsp;type&nbsp;before&nbsp;the&nbsp;subtypes&nbsp;(e.g.&nbsp;struct&nbsp;before</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5151754">//&nbsp;fields)&nbsp;so&nbsp;recursive&nbsp;types&nbsp;can&nbsp;be&nbsp;constructed&nbsp;safely.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151812">switch</span>&nbsp;<span class="ident" id="5151819">t</span>&nbsp;<span class="op" id="5151821">:=</span>&nbsp;<span class="ident" id="5151824"><a href="/encoding/gob/type.go.html#5151433">rt</a></span><span class="op" id="5151826">;</span>&nbsp;<span class="ident" id="5151828"><a href="/encoding/gob/type.go.html#5151819">t</a></span><span class="op" id="5151829">.</span><span class="ident" id="5151830">Kind</span><span class="op" id="5151834">(</span><span class="op" id="5151835">)</span>&nbsp;<span class="op" id="5151837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5151840">//&nbsp;All&nbsp;basic&nbsp;types&nbsp;are&nbsp;easy:&nbsp;they&nbsp;are&nbsp;predefined.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151891">case</span>&nbsp;<span class="ident" id="5151896"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5151903">.</span><span class="ident" id="5151904">Bool</span><span class="op" id="5151908">:</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151912">return</span>&nbsp;<span class="ident" id="5151919"><a href="/encoding/gob/type.go.html#5145872">tBool</a></span><span class="op" id="5151924">.</span><span class="ident" id="5151925">gobType</span><span class="op" id="5151932">(</span><span class="op" id="5151933">)</span><span class="op" id="5151934">,</span>&nbsp;<span class="ident" id="5151936">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5151942">case</span>&nbsp;<span class="ident" id="5151947"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5151954">.</span><span class="ident" id="5151955">Int</span><span class="op" id="5151958">,</span>&nbsp;<span class="ident" id="5151960"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5151967">.</span><span class="ident" id="5151968">Int8</span><span class="op" id="5151972">,</span>&nbsp;<span class="ident" id="5151974"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5151981">.</span><span class="ident" id="5151982">Int16</span><span class="op" id="5151987">,</span>&nbsp;<span class="ident" id="5151989"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5151996">.</span><span class="ident" id="5151997">Int32</span><span class="op" id="5152002">,</span>&nbsp;<span class="ident" id="5152004"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5152011">.</span><span class="ident" id="5152012">Int64</span><span class="op" id="5152017">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152021">return</span>&nbsp;<span class="ident" id="5152028"><a href="/encoding/gob/type.go.html#5145925">tInt</a></span><span class="op" id="5152032">.</span><span class="ident" id="5152033">gobType</span><span class="op" id="5152040">(</span><span class="op" id="5152041">)</span><span class="op" id="5152042">,</span>&nbsp;<span class="ident" id="5152044">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152050">case</span>&nbsp;<span class="ident" id="5152055"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5152062">.</span><span class="ident" id="5152063">Uint</span><span class="op" id="5152067">,</span>&nbsp;<span class="ident" id="5152069"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5152076">.</span><span class="ident" id="5152077">Uint8</span><span class="op" id="5152082">,</span>&nbsp;<span class="ident" id="5152084"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5152091">.</span><span class="ident" id="5152092">Uint16</span><span class="op" id="5152098">,</span>&nbsp;<span class="ident" id="5152100"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5152107">.</span><span class="ident" id="5152108">Uint32</span><span class="op" id="5152114">,</span>&nbsp;<span class="ident" id="5152116"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5152123">.</span><span class="ident" id="5152124">Uint64</span><span class="op" id="5152130">,</span>&nbsp;<span class="ident" id="5152132"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5152139">.</span><span class="ident" id="5152140">Uintptr</span><span class="op" id="5152147">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152151">return</span>&nbsp;<span class="ident" id="5152158"><a href="/encoding/gob/type.go.html#5145976">tUint</a></span><span class="op" id="5152163">.</span><span class="ident" id="5152164">gobType</span><span class="op" id="5152171">(</span><span class="op" id="5152172">)</span><span class="op" id="5152173">,</span>&nbsp;<span class="ident" id="5152175">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152181">case</span>&nbsp;<span class="ident" id="5152186"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5152193">.</span><span class="ident" id="5152194">Float32</span><span class="op" id="5152201">,</span>&nbsp;<span class="ident" id="5152203"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5152210">.</span><span class="ident" id="5152211">Float64</span><span class="op" id="5152218">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152222">return</span>&nbsp;<span class="ident" id="5152229"><a href="/encoding/gob/type.go.html#5146029">tFloat</a></span><span class="op" id="5152235">.</span><span class="ident" id="5152236">gobType</span><span class="op" id="5152243">(</span><span class="op" id="5152244">)</span><span class="op" id="5152245">,</span>&nbsp;<span class="ident" id="5152247">nil</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152253">case</span>&nbsp;<span class="ident" id="5152258"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5152265">.</span><span class="ident" id="5152266">Complex64</span><span class="op" id="5152275">,</span>&nbsp;<span class="ident" id="5152277"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5152284">.</span><span class="ident" id="5152285">Complex128</span><span class="op" id="5152295">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152299">return</span>&nbsp;<span class="ident" id="5152306"><a href="/encoding/gob/type.go.html#5146199">tComplex</a></span><span class="op" id="5152314">.</span><span class="ident" id="5152315">gobType</span><span class="op" id="5152322">(</span><span class="op" id="5152323">)</span><span class="op" id="5152324">,</span>&nbsp;<span class="ident" id="5152326">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152332">case</span>&nbsp;<span class="ident" id="5152337"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5152344">.</span><span class="ident" id="5152345">String</span><span class="op" id="5152351">:</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152355">return</span>&nbsp;<span class="ident" id="5152362"><a href="/encoding/gob/type.go.html#5146142">tString</a></span><span class="op" id="5152369">.</span><span class="ident" id="5152370">gobType</span><span class="op" id="5152377">(</span><span class="op" id="5152378">)</span><span class="op" id="5152379">,</span>&nbsp;<span class="ident" id="5152381">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152387">case</span>&nbsp;<span class="ident" id="5152392"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5152399">.</span><span class="ident" id="5152400">Interface</span><span class="op" id="5152409">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152413">return</span>&nbsp;<span class="ident" id="5152420"><a href="/encoding/gob/type.go.html#5146261">tInterface</a></span><span class="op" id="5152430">.</span><span class="ident" id="5152431">gobType</span><span class="op" id="5152438">(</span><span class="op" id="5152439">)</span><span class="op" id="5152440">,</span>&nbsp;<span class="ident" id="5152442">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152448">case</span>&nbsp;<span class="ident" id="5152453"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5152460">.</span><span class="ident" id="5152461">Array</span><span class="op" id="5152466">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152470">at</span>&nbsp;<span class="op" id="5152473">:=</span>&nbsp;<span class="ident" id="5152476"><a href="/encoding/gob/type.go.html#5148009">newArrayType</a></span><span class="op" id="5152488">(</span><span class="ident" id="5152489"><a href="/encoding/gob/type.go.html#5151402">name</a></span><span class="op" id="5152493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152497"><a href="/encoding/gob/type.go.html#5144199">types</a></span><span class="op" id="5152502">[</span><span class="ident" id="5152503"><a href="/encoding/gob/type.go.html#5151433">rt</a></span><span class="op" id="5152505">]</span>&nbsp;<span class="op" id="5152507">=</span>&nbsp;<span class="ident" id="5152509"><a href="/encoding/gob/type.go.html#5152470">at</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5152514"><a href="/encoding/gob/type.go.html#5151597">type0</a></span><span class="op" id="5152519">,</span>&nbsp;<span class="ident" id="5152521"><a href="/encoding/gob/type.go.html#5151582">err</a></span>&nbsp;<span class="op" id="5152525">=</span>&nbsp;<span class="ident" id="5152527"><a href="/encoding/gob/type.go.html#5155478">getBaseType</a></span><span class="op" id="5152538">(</span><span class="string" id="5152539">&#34;&#34;</span><span class="op" id="5152541">,</span>&nbsp;<span class="ident" id="5152543"><a href="/encoding/gob/type.go.html#5151819">t</a></span><span class="op" id="5152544">.</span><span class="ident" id="5152545">Elem</span><span class="op" id="5152549">(</span><span class="op" id="5152550">)</span><span class="op" id="5152551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152555">if</span>&nbsp;<span class="ident" id="5152558"><a href="/encoding/gob/type.go.html#5151582">err</a></span>&nbsp;<span class="op" id="5152562">!=</span>&nbsp;<span class="ident" id="5152565">nil</span>&nbsp;<span class="op" id="5152569">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5152574">return</span>&nbsp;<span class="ident" id="5152581">nil</span><span class="op" id="5152584">,</span>&nbsp;<span class="ident" id="5152586"><a href="/encoding/gob/type.go.html#5151582">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5152592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5152596">//&nbsp;Historical&nbsp;aside:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5152619">//&nbsp;For&nbsp;arrays,&nbsp;maps,&nbsp;and&nbsp;slices,&nbsp;we&nbsp;set&nbsp;the&nbsp;type&nbsp;id&nbsp;after&nbsp;the&nbsp;elements</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5152692">//&nbsp;are&nbsp;constructed.&nbsp;This&nbsp;is&nbsp;to&nbsp;retain&nbsp;the&nbsp;order&nbsp;of&nbsp;type&nbsp;id&nbsp;allocation&nbsp;after</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5152770">//&nbsp;a&nbsp;fix&nbsp;made&nbsp;to&nbsp;handle&nbsp;recursive&nbsp;types,&nbsp;which&nbsp;changed&nbsp;the&nbsp;order&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5152840">//&nbsp;which&nbsp;types&nbsp;are&nbsp;built.&nbsp;&nbsp;Delaying&nbsp;the&nbsp;setting&nbsp;in&nbsp;this&nbsp;way&nbsp;preserves</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5152912">//&nbsp;type&nbsp;ids&nbsp;while&nbsp;allowing&nbsp;recursive&nbsp;types&nbsp;to&nbsp;be&nbsp;described.&nbsp;Structs,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5152983">//&nbsp;done&nbsp;below,&nbsp;were&nbsp;already&nbsp;handling&nbsp;recursion&nbsp;correctly&nbsp;so&nbsp;they</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5153050">//&nbsp;assign&nbsp;the&nbsp;top-level&nbsp;id&nbsp;before&nbsp;those&nbsp;of&nbsp;the&nbsp;field.</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153106"><a href="/encoding/gob/type.go.html#5152470">at</a></span><span class="op" id="5153108">.</span><span class="ident" id="5153109">init</span><span class="op" id="5153113">(</span><span class="ident" id="5153114"><a href="/encoding/gob/type.go.html#5151597">type0</a></span><span class="op" id="5153119">,</span>&nbsp;<span class="ident" id="5153121"><a href="/encoding/gob/type.go.html#5151819">t</a></span><span class="op" id="5153122">.</span><span class="ident" id="5153123">Len</span><span class="op" id="5153126">(</span><span class="op" id="5153127">)</span><span class="op" id="5153128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153132">return</span>&nbsp;<span class="ident" id="5153139"><a href="/encoding/gob/type.go.html#5152470">at</a></span><span class="op" id="5153141">,</span>&nbsp;<span class="ident" id="5153143">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153149">case</span>&nbsp;<span class="ident" id="5153154"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5153161">.</span><span class="ident" id="5153162">Map</span><span class="op" id="5153165">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153169">mt</span>&nbsp;<span class="op" id="5153172">:=</span>&nbsp;<span class="ident" id="5153175"><a href="/encoding/gob/type.go.html#5149027">newMapType</a></span><span class="op" id="5153185">(</span><span class="ident" id="5153186"><a href="/encoding/gob/type.go.html#5151402">name</a></span><span class="op" id="5153190">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153194"><a href="/encoding/gob/type.go.html#5144199">types</a></span><span class="op" id="5153199">[</span><span class="ident" id="5153200"><a href="/encoding/gob/type.go.html#5151433">rt</a></span><span class="op" id="5153202">]</span>&nbsp;<span class="op" id="5153204">=</span>&nbsp;<span class="ident" id="5153206"><a href="/encoding/gob/type.go.html#5153169">mt</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153211"><a href="/encoding/gob/type.go.html#5151597">type0</a></span><span class="op" id="5153216">,</span>&nbsp;<span class="ident" id="5153218"><a href="/encoding/gob/type.go.html#5151582">err</a></span>&nbsp;<span class="op" id="5153222">=</span>&nbsp;<span class="ident" id="5153224"><a href="/encoding/gob/type.go.html#5155478">getBaseType</a></span><span class="op" id="5153235">(</span><span class="string" id="5153236">&#34;&#34;</span><span class="op" id="5153238">,</span>&nbsp;<span class="ident" id="5153240"><a href="/encoding/gob/type.go.html#5151819">t</a></span><span class="op" id="5153241">.</span><span class="ident" id="5153242">Key</span><span class="op" id="5153245">(</span><span class="op" id="5153246">)</span><span class="op" id="5153247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153251">if</span>&nbsp;<span class="ident" id="5153254"><a href="/encoding/gob/type.go.html#5151582">err</a></span>&nbsp;<span class="op" id="5153258">!=</span>&nbsp;<span class="ident" id="5153261">nil</span>&nbsp;<span class="op" id="5153265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153270">return</span>&nbsp;<span class="ident" id="5153277">nil</span><span class="op" id="5153280">,</span>&nbsp;<span class="ident" id="5153282"><a href="/encoding/gob/type.go.html#5151582">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153288">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153292"><a href="/encoding/gob/type.go.html#5151604">type1</a></span><span class="op" id="5153297">,</span>&nbsp;<span class="ident" id="5153299"><a href="/encoding/gob/type.go.html#5151582">err</a></span>&nbsp;<span class="op" id="5153303">=</span>&nbsp;<span class="ident" id="5153305"><a href="/encoding/gob/type.go.html#5155478">getBaseType</a></span><span class="op" id="5153316">(</span><span class="string" id="5153317">&#34;&#34;</span><span class="op" id="5153319">,</span>&nbsp;<span class="ident" id="5153321"><a href="/encoding/gob/type.go.html#5151819">t</a></span><span class="op" id="5153322">.</span><span class="ident" id="5153323">Elem</span><span class="op" id="5153327">(</span><span class="op" id="5153328">)</span><span class="op" id="5153329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153333">if</span>&nbsp;<span class="ident" id="5153336"><a href="/encoding/gob/type.go.html#5151582">err</a></span>&nbsp;<span class="op" id="5153340">!=</span>&nbsp;<span class="ident" id="5153343">nil</span>&nbsp;<span class="op" id="5153347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153352">return</span>&nbsp;<span class="ident" id="5153359">nil</span><span class="op" id="5153362">,</span>&nbsp;<span class="ident" id="5153364"><a href="/encoding/gob/type.go.html#5151582">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153374"><a href="/encoding/gob/type.go.html#5153169">mt</a></span><span class="op" id="5153376">.</span><span class="ident" id="5153377">init</span><span class="op" id="5153381">(</span><span class="ident" id="5153382"><a href="/encoding/gob/type.go.html#5151597">type0</a></span><span class="op" id="5153387">,</span>&nbsp;<span class="ident" id="5153389"><a href="/encoding/gob/type.go.html#5151604">type1</a></span><span class="op" id="5153394">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153398">return</span>&nbsp;<span class="ident" id="5153405"><a href="/encoding/gob/type.go.html#5153169">mt</a></span><span class="op" id="5153407">,</span>&nbsp;<span class="ident" id="5153409">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153415">case</span>&nbsp;<span class="ident" id="5153420"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5153427">.</span><span class="ident" id="5153428">Slice</span><span class="op" id="5153433">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5153437">//&nbsp;[]byte&nbsp;==&nbsp;[]uint8&nbsp;is&nbsp;a&nbsp;special&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153478">if</span>&nbsp;<span class="ident" id="5153481"><a href="/encoding/gob/type.go.html#5151819">t</a></span><span class="op" id="5153482">.</span><span class="ident" id="5153483">Elem</span><span class="op" id="5153487">(</span><span class="op" id="5153488">)</span><span class="op" id="5153489">.</span><span class="ident" id="5153490">Kind</span><span class="op" id="5153494">(</span><span class="op" id="5153495">)</span>&nbsp;<span class="op" id="5153497">==</span>&nbsp;<span class="ident" id="5153500"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5153507">.</span><span class="ident" id="5153508">Uint8</span>&nbsp;<span class="op" id="5153514">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153519">return</span>&nbsp;<span class="ident" id="5153526"><a href="/encoding/gob/type.go.html#5146086">tBytes</a></span><span class="op" id="5153532">.</span><span class="ident" id="5153533">gobType</span><span class="op" id="5153540">(</span><span class="op" id="5153541">)</span><span class="op" id="5153542">,</span>&nbsp;<span class="ident" id="5153544">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153554">st</span>&nbsp;<span class="op" id="5153557">:=</span>&nbsp;<span class="ident" id="5153560"><a href="/encoding/gob/type.go.html#5149693">newSliceType</a></span><span class="op" id="5153572">(</span><span class="ident" id="5153573"><a href="/encoding/gob/type.go.html#5151402">name</a></span><span class="op" id="5153577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153581"><a href="/encoding/gob/type.go.html#5144199">types</a></span><span class="op" id="5153586">[</span><span class="ident" id="5153587"><a href="/encoding/gob/type.go.html#5151433">rt</a></span><span class="op" id="5153589">]</span>&nbsp;<span class="op" id="5153591">=</span>&nbsp;<span class="ident" id="5153593"><a href="/encoding/gob/type.go.html#5153554">st</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153598"><a href="/encoding/gob/type.go.html#5151597">type0</a></span><span class="op" id="5153603">,</span>&nbsp;<span class="ident" id="5153605"><a href="/encoding/gob/type.go.html#5151582">err</a></span>&nbsp;<span class="op" id="5153609">=</span>&nbsp;<span class="ident" id="5153611"><a href="/encoding/gob/type.go.html#5155478">getBaseType</a></span><span class="op" id="5153622">(</span><span class="ident" id="5153623"><a href="/encoding/gob/type.go.html#5151819">t</a></span><span class="op" id="5153624">.</span><span class="ident" id="5153625">Elem</span><span class="op" id="5153629">(</span><span class="op" id="5153630">)</span><span class="op" id="5153631">.</span><span class="ident" id="5153632">Name</span><span class="op" id="5153636">(</span><span class="op" id="5153637">)</span><span class="op" id="5153638">,</span>&nbsp;<span class="ident" id="5153640"><a href="/encoding/gob/type.go.html#5151819">t</a></span><span class="op" id="5153641">.</span><span class="ident" id="5153642">Elem</span><span class="op" id="5153646">(</span><span class="op" id="5153647">)</span><span class="op" id="5153648">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153652">if</span>&nbsp;<span class="ident" id="5153655"><a href="/encoding/gob/type.go.html#5151582">err</a></span>&nbsp;<span class="op" id="5153659">!=</span>&nbsp;<span class="ident" id="5153662">nil</span>&nbsp;<span class="op" id="5153666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153671">return</span>&nbsp;<span class="ident" id="5153678">nil</span><span class="op" id="5153681">,</span>&nbsp;<span class="ident" id="5153683"><a href="/encoding/gob/type.go.html#5151582">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153693"><a href="/encoding/gob/type.go.html#5153554">st</a></span><span class="op" id="5153695">.</span><span class="ident" id="5153696">init</span><span class="op" id="5153700">(</span><span class="ident" id="5153701"><a href="/encoding/gob/type.go.html#5151597">type0</a></span><span class="op" id="5153706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153710">return</span>&nbsp;<span class="ident" id="5153717"><a href="/encoding/gob/type.go.html#5153554">st</a></span><span class="op" id="5153719">,</span>&nbsp;<span class="ident" id="5153721">nil</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153727">case</span>&nbsp;<span class="ident" id="5153732"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5153739">.</span><span class="ident" id="5153740">Struct</span><span class="op" id="5153746">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153750">st</span>&nbsp;<span class="op" id="5153753">:=</span>&nbsp;<span class="ident" id="5153756"><a href="/encoding/gob/type.go.html#5150899">newStructType</a></span><span class="op" id="5153769">(</span><span class="ident" id="5153770"><a href="/encoding/gob/type.go.html#5151402">name</a></span><span class="op" id="5153774">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153778"><a href="/encoding/gob/type.go.html#5144199">types</a></span><span class="op" id="5153783">[</span><span class="ident" id="5153784"><a href="/encoding/gob/type.go.html#5151433">rt</a></span><span class="op" id="5153786">]</span>&nbsp;<span class="op" id="5153788">=</span>&nbsp;<span class="ident" id="5153790"><a href="/encoding/gob/type.go.html#5153750">st</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153795"><a href="/encoding/gob/type.go.html#5144242">idToType</a></span><span class="op" id="5153803">[</span><span class="ident" id="5153804"><a href="/encoding/gob/type.go.html#5153750">st</a></span><span class="op" id="5153806">.</span><span class="ident" id="5153807">id</span><span class="op" id="5153809">(</span><span class="op" id="5153810">)</span><span class="op" id="5153811">]</span>&nbsp;<span class="op" id="5153813">=</span>&nbsp;<span class="ident" id="5153815"><a href="/encoding/gob/type.go.html#5153750">st</a></span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153820">for</span>&nbsp;<span class="ident" id="5153824">i</span>&nbsp;<span class="op" id="5153826">:=</span>&nbsp;<span class="num" id="5153829">0</span><span class="op" id="5153830">;</span>&nbsp;<span class="ident" id="5153832"><a href="/encoding/gob/type.go.html#5153824">i</a></span>&nbsp;<span class="op" id="5153834">&lt;</span>&nbsp;<span class="ident" id="5153836"><a href="/encoding/gob/type.go.html#5151819">t</a></span><span class="op" id="5153837">.</span><span class="ident" id="5153838">NumField</span><span class="op" id="5153846">(</span><span class="op" id="5153847">)</span><span class="op" id="5153848">;</span>&nbsp;<span class="ident" id="5153850"><a href="/encoding/gob/type.go.html#5153824">i</a></span><span class="op" id="5153851">++</span>&nbsp;<span class="op" id="5153854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153859">f</span>&nbsp;<span class="op" id="5153861">:=</span>&nbsp;<span class="ident" id="5153864"><a href="/encoding/gob/type.go.html#5151819">t</a></span><span class="op" id="5153865">.</span><span class="ident" id="5153866">Field</span><span class="op" id="5153871">(</span><span class="ident" id="5153872"><a href="/encoding/gob/type.go.html#5153824">i</a></span><span class="op" id="5153873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153878">if</span>&nbsp;<span class="op" id="5153881">!</span><span class="ident" id="5153882"><a href="/encoding/gob/type.go.html#5154985">isSent</a></span><span class="op" id="5153888">(</span><span class="op" id="5153889">&amp;</span><span class="ident" id="5153890"><a href="/encoding/gob/type.go.html#5153859">f</a></span><span class="op" id="5153891">)</span>&nbsp;<span class="op" id="5153893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153899">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5153911">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153916">typ</span>&nbsp;<span class="op" id="5153920">:=</span>&nbsp;<span class="ident" id="5153923"><a href="/encoding/gob/type.go.html#5143544">userType</a></span><span class="op" id="5153931">(</span><span class="ident" id="5153932"><a href="/encoding/gob/type.go.html#5153859">f</a></span><span class="op" id="5153933">.</span><span class="ident" id="5153934">Type</span><span class="op" id="5153938">)</span><span class="op" id="5153939">.</span><span class="ident" id="5153940">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153948">tname</span>&nbsp;<span class="op" id="5153954">:=</span>&nbsp;<span class="ident" id="5153957"><a href="/encoding/gob/type.go.html#5153916">typ</a></span><span class="op" id="5153960">.</span><span class="ident" id="5153961">Name</span><span class="op" id="5153965">(</span><span class="op" id="5153966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5153971">if</span>&nbsp;<span class="ident" id="5153974"><a href="/encoding/gob/type.go.html#5153948">tname</a></span>&nbsp;<span class="op" id="5153980">==</span>&nbsp;<span class="string" id="5153983">&#34;&#34;</span>&nbsp;<span class="op" id="5153986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5153992">t</span>&nbsp;<span class="op" id="5153994">:=</span>&nbsp;<span class="ident" id="5153997"><a href="/encoding/gob/type.go.html#5143544">userType</a></span><span class="op" id="5154005">(</span><span class="ident" id="5154006"><a href="/encoding/gob/type.go.html#5153859">f</a></span><span class="op" id="5154007">.</span><span class="ident" id="5154008">Type</span><span class="op" id="5154012">)</span><span class="op" id="5154013">.</span><span class="ident" id="5154014">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154023"><a href="/encoding/gob/type.go.html#5153948">tname</a></span>&nbsp;<span class="op" id="5154029">=</span>&nbsp;<span class="ident" id="5154031"><a href="/encoding/gob/type.go.html#5153992">t</a></span><span class="op" id="5154032">.</span><span class="ident" id="5154033">String</span><span class="op" id="5154039">(</span><span class="op" id="5154040">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154050">gt</span><span class="op" id="5154052">,</span>&nbsp;<span class="ident" id="5154054">err</span>&nbsp;<span class="op" id="5154058">:=</span>&nbsp;<span class="ident" id="5154061"><a href="/encoding/gob/type.go.html#5155478">getBaseType</a></span><span class="op" id="5154072">(</span><span class="ident" id="5154073"><a href="/encoding/gob/type.go.html#5153948">tname</a></span><span class="op" id="5154078">,</span>&nbsp;<span class="ident" id="5154080"><a href="/encoding/gob/type.go.html#5153859">f</a></span><span class="op" id="5154081">.</span><span class="ident" id="5154082">Type</span><span class="op" id="5154086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154091">if</span>&nbsp;<span class="ident" id="5154094"><a href="/encoding/gob/type.go.html#5154054">err</a></span>&nbsp;<span class="op" id="5154098">!=</span>&nbsp;<span class="ident" id="5154101">nil</span>&nbsp;<span class="op" id="5154105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154111">return</span>&nbsp;<span class="ident" id="5154118">nil</span><span class="op" id="5154121">,</span>&nbsp;<span class="ident" id="5154123"><a href="/encoding/gob/type.go.html#5154054">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154130">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5154135">//&nbsp;Some&nbsp;mutually&nbsp;recursive&nbsp;types&nbsp;can&nbsp;cause&nbsp;us&nbsp;to&nbsp;be&nbsp;here&nbsp;while</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5154201">//&nbsp;still&nbsp;defining&nbsp;the&nbsp;element.&nbsp;Fix&nbsp;the&nbsp;element&nbsp;type&nbsp;id&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5154265">//&nbsp;We&nbsp;could&nbsp;do&nbsp;this&nbsp;more&nbsp;neatly&nbsp;by&nbsp;setting&nbsp;the&nbsp;id&nbsp;at&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5154334">//&nbsp;building&nbsp;every&nbsp;type,&nbsp;but&nbsp;that&nbsp;would&nbsp;break&nbsp;binary&nbsp;compatibility.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154404">if</span>&nbsp;<span class="ident" id="5154407"><a href="/encoding/gob/type.go.html#5154050">gt</a></span><span class="op" id="5154409">.</span><span class="ident" id="5154410">id</span><span class="op" id="5154412">(</span><span class="op" id="5154413">)</span>&nbsp;<span class="op" id="5154415">==</span>&nbsp;<span class="num" id="5154418">0</span>&nbsp;<span class="op" id="5154420">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154426"><a href="/encoding/gob/type.go.html#5144371">setTypeId</a></span><span class="op" id="5154435">(</span><span class="ident" id="5154436"><a href="/encoding/gob/type.go.html#5154050">gt</a></span><span class="op" id="5154438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5154448"><a href="/encoding/gob/type.go.html#5153750">st</a></span><span class="op" id="5154450">.</span><span class="ident" id="5154451">Field</span>&nbsp;<span class="op" id="5154457">=</span>&nbsp;<span class="builtinfunc" id="5154459">append</span><span class="op" id="5154465">(</span><span class="ident" id="5154466"><a href="/encoding/gob/type.go.html#5153750">st</a></span><span class="op" id="5154468">.</span><span class="ident" id="5154469">Field</span><span class="op" id="5154474">,</span>&nbsp;<span class="op" id="5154476">&amp;</span><span class="ident" id="5154477"><a href="/encoding/gob/type.go.html#5150371">fieldType</a></span><span class="op" id="5154486">{</span><span class="ident" id="5154487"><a href="/encoding/gob/type.go.html#5153859">f</a></span><span class="op" id="5154488">.</span><span class="ident" id="5154489">Name</span><span class="op" id="5154493">,</span>&nbsp;<span class="ident" id="5154495"><a href="/encoding/gob/type.go.html#5154050">gt</a></span><span class="op" id="5154497">.</span><span class="ident" id="5154498">id</span><span class="op" id="5154500">(</span><span class="op" id="5154501">)</span><span class="op" id="5154502">}</span><span class="op" id="5154503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154511">return</span>&nbsp;<span class="ident" id="5154518"><a href="/encoding/gob/type.go.html#5153750">st</a></span><span class="op" id="5154520">,</span>&nbsp;<span class="ident" id="5154522">nil</span><br>
<span class="lineno">560</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154528">default</span><span class="op" id="5154535">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154539">return</span>&nbsp;<span class="ident" id="5154546">nil</span><span class="op" id="5154549">,</span>&nbsp;<span class="ident" id="5154551"><a href="/encoding/gob/type.go.html#5138373">errors</a></span><span class="op" id="5154557">.</span><span class="ident" id="5154558">New</span><span class="op" id="5154561">(</span><span class="string" id="5154562">&#34;gob&nbsp;NewTypeObject&nbsp;can&#39;t&nbsp;handle&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="5154602">+</span>&nbsp;<span class="ident" id="5154604"><a href="/encoding/gob/type.go.html#5151433">rt</a></span><span class="op" id="5154606">.</span><span class="ident" id="5154607">String</span><span class="op" id="5154613">(</span><span class="op" id="5154614">)</span><span class="op" id="5154615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5154618">}</span><br>
<span class="lineno"></span><span class="op" id="5154620">}</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span><span class="comment" id="5154623">//&nbsp;isExported&nbsp;reports&nbsp;whether&nbsp;this&nbsp;is&nbsp;an&nbsp;exported&nbsp;-&nbsp;upper&nbsp;case&nbsp;-&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="5154694">func</span>&nbsp;<span class="ident" id="5154699">isExported</span><span class="op" id="5154709">(</span><span class="ident" id="5154710">name</span>&nbsp;<span class="builtintype" id="5154715">string</span><span class="op" id="5154721">)</span>&nbsp;<span class="builtintype" id="5154723">bool</span>&nbsp;<span class="op" id="5154728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="5154731">rune</span><span class="op" id="5154735">,</span>&nbsp;<span class="ident" id="5154737">_</span>&nbsp;<span class="op" id="5154739">:=</span>&nbsp;<span class="ident" id="5154742"><a href="/encoding/gob/type.go.html#5138441">utf8</a></span><span class="op" id="5154746">.</span><span class="ident" id="5154747">DecodeRuneInString</span><span class="op" id="5154765">(</span><span class="ident" id="5154766"><a href="/encoding/gob/type.go.html#5154710">name</a></span><span class="op" id="5154770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5154773">return</span>&nbsp;<span class="ident" id="5154780"><a href="/encoding/gob/type.go.html#5138430">unicode</a></span><span class="op" id="5154787">.</span><span class="ident" id="5154788">IsUpper</span><span class="op" id="5154795">(</span><span class="builtintype" id="5154796"><a href="/encoding/gob/type.go.html#5154731">rune</a></span><span class="op" id="5154800">)</span><br>
<span class="lineno">570</span><span class="op" id="5154802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5154805">//&nbsp;isSent&nbsp;reports&nbsp;whether&nbsp;this&nbsp;struct&nbsp;field&nbsp;is&nbsp;to&nbsp;be&nbsp;transmitted.</span><br>
<span class="lineno"></span><span class="comment" id="5154871">//&nbsp;It&nbsp;will&nbsp;be&nbsp;transmitted&nbsp;only&nbsp;if&nbsp;it&nbsp;is&nbsp;exported&nbsp;and&nbsp;not&nbsp;a&nbsp;chan&nbsp;or&nbsp;func&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="5154949">//&nbsp;or&nbsp;pointer&nbsp;to&nbsp;chan&nbsp;or&nbsp;func.</span><br>
<span class="lineno">575</span><span class="keyword" id="5154980">func</span>&nbsp;<span class="ident" id="5154985">isSent</span><span class="op" id="5154991">(</span><span class="ident" id="5154992">field</span>&nbsp;<span class="op" id="5154998">*</span><span class="ident" id="5154999"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5155006">.</span><span class="ident" id="5155007">StructField</span><span class="op" id="5155018">)</span>&nbsp;<span class="builtintype" id="5155020">bool</span>&nbsp;<span class="op" id="5155025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155028">if</span>&nbsp;<span class="op" id="5155031">!</span><span class="ident" id="5155032"><a href="/encoding/gob/type.go.html#5154699">isExported</a></span><span class="op" id="5155042">(</span><span class="ident" id="5155043"><a href="/encoding/gob/type.go.html#5154992">field</a></span><span class="op" id="5155048">.</span><span class="ident" id="5155049">Name</span><span class="op" id="5155053">)</span>&nbsp;<span class="op" id="5155055">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155059">return</span>&nbsp;<span class="ident" id="5155066">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5155073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5155076">//&nbsp;If&nbsp;the&nbsp;field&nbsp;is&nbsp;a&nbsp;chan&nbsp;or&nbsp;func&nbsp;or&nbsp;pointer&nbsp;thereto,&nbsp;don&#39;t&nbsp;send&nbsp;it.</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5155146">//&nbsp;That&nbsp;is,&nbsp;treat&nbsp;it&nbsp;like&nbsp;an&nbsp;unexported&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155194">typ</span>&nbsp;<span class="op" id="5155198">:=</span>&nbsp;<span class="ident" id="5155201"><a href="/encoding/gob/type.go.html#5154992">field</a></span><span class="op" id="5155206">.</span><span class="ident" id="5155207">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155213">for</span>&nbsp;<span class="ident" id="5155217"><a href="/encoding/gob/type.go.html#5155194">typ</a></span><span class="op" id="5155220">.</span><span class="ident" id="5155221">Kind</span><span class="op" id="5155225">(</span><span class="op" id="5155226">)</span>&nbsp;<span class="op" id="5155228">==</span>&nbsp;<span class="ident" id="5155231"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5155238">.</span><span class="ident" id="5155239">Ptr</span>&nbsp;<span class="op" id="5155243">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155247"><a href="/encoding/gob/type.go.html#5155194">typ</a></span>&nbsp;<span class="op" id="5155251">=</span>&nbsp;<span class="ident" id="5155253"><a href="/encoding/gob/type.go.html#5155194">typ</a></span><span class="op" id="5155256">.</span><span class="ident" id="5155257">Elem</span><span class="op" id="5155261">(</span><span class="op" id="5155262">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5155265">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155268">if</span>&nbsp;<span class="ident" id="5155271"><a href="/encoding/gob/type.go.html#5155194">typ</a></span><span class="op" id="5155274">.</span><span class="ident" id="5155275">Kind</span><span class="op" id="5155279">(</span><span class="op" id="5155280">)</span>&nbsp;<span class="op" id="5155282">==</span>&nbsp;<span class="ident" id="5155285"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5155292">.</span><span class="ident" id="5155293">Chan</span>&nbsp;<span class="op" id="5155298">||</span>&nbsp;<span class="ident" id="5155301"><a href="/encoding/gob/type.go.html#5155194">typ</a></span><span class="op" id="5155304">.</span><span class="ident" id="5155305">Kind</span><span class="op" id="5155309">(</span><span class="op" id="5155310">)</span>&nbsp;<span class="op" id="5155312">==</span>&nbsp;<span class="ident" id="5155315"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5155322">.</span><span class="ident" id="5155323">Func</span>&nbsp;<span class="op" id="5155328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155332">return</span>&nbsp;<span class="ident" id="5155339">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5155346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155349">return</span>&nbsp;<span class="ident" id="5155356">true</span><br>
<span class="lineno"></span><span class="op" id="5155361">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="5155364">//&nbsp;getBaseType&nbsp;returns&nbsp;the&nbsp;Gob&nbsp;type&nbsp;describing&nbsp;the&nbsp;given&nbsp;reflect.Type&#39;s&nbsp;base&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="5155447">//&nbsp;typeLock&nbsp;must&nbsp;be&nbsp;held.</span><br>
<span class="lineno"></span><span class="keyword" id="5155473">func</span>&nbsp;<span class="ident" id="5155478">getBaseType</span><span class="op" id="5155489">(</span><span class="ident" id="5155490">name</span>&nbsp;<span class="builtintype" id="5155495">string</span><span class="op" id="5155501">,</span>&nbsp;<span class="ident" id="5155503">rt</span>&nbsp;<span class="ident" id="5155506"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5155513">.</span><span class="ident" id="5155514">Type</span><span class="op" id="5155518">)</span>&nbsp;<span class="op" id="5155520">(</span><span class="ident" id="5155521"><a href="/encoding/gob/type.go.html#5144034">gobType</a></span><span class="op" id="5155528">,</span>&nbsp;<span class="builtintype" id="5155530">error</span><span class="op" id="5155535">)</span>&nbsp;<span class="op" id="5155537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155540">ut</span>&nbsp;<span class="op" id="5155543">:=</span>&nbsp;<span class="ident" id="5155546"><a href="/encoding/gob/type.go.html#5143544">userType</a></span><span class="op" id="5155554">(</span><span class="ident" id="5155555"><a href="/encoding/gob/type.go.html#5155503">rt</a></span><span class="op" id="5155557">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155560">return</span>&nbsp;<span class="ident" id="5155567"><a href="/encoding/gob/type.go.html#5155854">getType</a></span><span class="op" id="5155574">(</span><span class="ident" id="5155575"><a href="/encoding/gob/type.go.html#5155490">name</a></span><span class="op" id="5155579">,</span>&nbsp;<span class="ident" id="5155581"><a href="/encoding/gob/type.go.html#5155540">ut</a></span><span class="op" id="5155583">,</span>&nbsp;<span class="ident" id="5155585"><a href="/encoding/gob/type.go.html#5155540">ut</a></span><span class="op" id="5155587">.</span><span class="ident" id="5155588">base</span><span class="op" id="5155592">)</span><br>
<span class="lineno"></span><span class="op" id="5155594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5155597">//&nbsp;getType&nbsp;returns&nbsp;the&nbsp;Gob&nbsp;type&nbsp;describing&nbsp;the&nbsp;given&nbsp;reflect.Type.</span><br>
<span class="lineno"></span><span class="comment" id="5155664">//&nbsp;Should&nbsp;be&nbsp;called&nbsp;only&nbsp;when&nbsp;handling&nbsp;GobEncoders/Decoders,</span><br>
<span class="lineno">600</span><span class="comment" id="5155725">//&nbsp;which&nbsp;may&nbsp;be&nbsp;pointers.&nbsp;&nbsp;All&nbsp;other&nbsp;types&nbsp;are&nbsp;handled&nbsp;through&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5155792">//&nbsp;base&nbsp;type,&nbsp;never&nbsp;a&nbsp;pointer.</span><br>
<span class="lineno"></span><span class="comment" id="5155823">//&nbsp;typeLock&nbsp;must&nbsp;be&nbsp;held.</span><br>
<span class="lineno"></span><span class="keyword" id="5155849">func</span>&nbsp;<span class="ident" id="5155854">getType</span><span class="op" id="5155861">(</span><span class="ident" id="5155862">name</span>&nbsp;<span class="builtintype" id="5155867">string</span><span class="op" id="5155873">,</span>&nbsp;<span class="ident" id="5155875">ut</span>&nbsp;<span class="op" id="5155878">*</span><span class="ident" id="5155879"><a href="/encoding/gob/type.go.html#5138634">userTypeInfo</a></span><span class="op" id="5155891">,</span>&nbsp;<span class="ident" id="5155893">rt</span>&nbsp;<span class="ident" id="5155896"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5155903">.</span><span class="ident" id="5155904">Type</span><span class="op" id="5155908">)</span>&nbsp;<span class="op" id="5155910">(</span><span class="ident" id="5155911"><a href="/encoding/gob/type.go.html#5144034">gobType</a></span><span class="op" id="5155918">,</span>&nbsp;<span class="builtintype" id="5155920">error</span><span class="op" id="5155925">)</span>&nbsp;<span class="op" id="5155927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155930">typ</span><span class="op" id="5155933">,</span>&nbsp;<span class="ident" id="5155935">present</span>&nbsp;<span class="op" id="5155943">:=</span>&nbsp;<span class="ident" id="5155946"><a href="/encoding/gob/type.go.html#5144199">types</a></span><span class="op" id="5155951">[</span><span class="ident" id="5155952"><a href="/encoding/gob/type.go.html#5155893">rt</a></span><span class="op" id="5155954">]</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155957">if</span>&nbsp;<span class="ident" id="5155960"><a href="/encoding/gob/type.go.html#5155935">present</a></span>&nbsp;<span class="op" id="5155968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5155972">return</span>&nbsp;<span class="ident" id="5155979"><a href="/encoding/gob/type.go.html#5155930">typ</a></span><span class="op" id="5155982">,</span>&nbsp;<span class="ident" id="5155984">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5155989">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5155992"><a href="/encoding/gob/type.go.html#5155930">typ</a></span><span class="op" id="5155995">,</span>&nbsp;<span class="ident" id="5155997">err</span>&nbsp;<span class="op" id="5156001">:=</span>&nbsp;<span class="ident" id="5156004"><a href="/encoding/gob/type.go.html#5151388">newTypeObject</a></span><span class="op" id="5156017">(</span><span class="ident" id="5156018"><a href="/encoding/gob/type.go.html#5155862">name</a></span><span class="op" id="5156022">,</span>&nbsp;<span class="ident" id="5156024"><a href="/encoding/gob/type.go.html#5155875">ut</a></span><span class="op" id="5156026">,</span>&nbsp;<span class="ident" id="5156028"><a href="/encoding/gob/type.go.html#5155893">rt</a></span><span class="op" id="5156030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156033">if</span>&nbsp;<span class="ident" id="5156036"><a href="/encoding/gob/type.go.html#5155997">err</a></span>&nbsp;<span class="op" id="5156040">==</span>&nbsp;<span class="ident" id="5156043">nil</span>&nbsp;<span class="op" id="5156047">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156051"><a href="/encoding/gob/type.go.html#5144199">types</a></span><span class="op" id="5156056">[</span><span class="ident" id="5156057"><a href="/encoding/gob/type.go.html#5155893">rt</a></span><span class="op" id="5156059">]</span>&nbsp;<span class="op" id="5156061">=</span>&nbsp;<span class="ident" id="5156063"><a href="/encoding/gob/type.go.html#5155930">typ</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5156068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156071">return</span>&nbsp;<span class="ident" id="5156078"><a href="/encoding/gob/type.go.html#5155930">typ</a></span><span class="op" id="5156081">,</span>&nbsp;<span class="ident" id="5156083"><a href="/encoding/gob/type.go.html#5155997">err</a></span><br>
<span class="lineno"></span><span class="op" id="5156087">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="5156090">func</span>&nbsp;<span class="ident" id="5156095">checkId</span><span class="op" id="5156102">(</span><span class="ident" id="5156103">want</span><span class="op" id="5156107">,</span>&nbsp;<span class="ident" id="5156109">got</span>&nbsp;<span class="ident" id="5156113"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5156119">)</span>&nbsp;<span class="op" id="5156121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156124">if</span>&nbsp;<span class="ident" id="5156127"><a href="/encoding/gob/type.go.html#5156103">want</a></span>&nbsp;<span class="op" id="5156132">!=</span>&nbsp;<span class="ident" id="5156135"><a href="/encoding/gob/type.go.html#5156109">got</a></span>&nbsp;<span class="op" id="5156139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156143"><a href="/encoding/gob/type.go.html#5138383">fmt</a></span><span class="op" id="5156146">.</span><span class="ident" id="5156147">Fprintf</span><span class="op" id="5156154">(</span><span class="ident" id="5156155"><a href="/encoding/gob/type.go.html#5138390">os</a></span><span class="op" id="5156157">.</span><span class="ident" id="5156158">Stderr</span><span class="op" id="5156164">,</span>&nbsp;<span class="string" id="5156166">&#34;checkId:&nbsp;%d&nbsp;should&nbsp;be&nbsp;%d\n&#34;</span><span class="op" id="5156194">,</span>&nbsp;<span class="builtintype" id="5156196">int</span><span class="op" id="5156199">(</span><span class="ident" id="5156200"><a href="/encoding/gob/type.go.html#5156109">got</a></span><span class="op" id="5156203">)</span><span class="op" id="5156204">,</span>&nbsp;<span class="builtintype" id="5156206">int</span><span class="op" id="5156209">(</span><span class="ident" id="5156210"><a href="/encoding/gob/type.go.html#5156103">want</a></span><span class="op" id="5156214">)</span><span class="op" id="5156215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5156219">panic</span><span class="op" id="5156224">(</span><span class="string" id="5156225">&#34;bootstrap&nbsp;type&nbsp;wrong&nbsp;id:&nbsp;&#34;</span>&nbsp;<span class="op" id="5156253">+</span>&nbsp;<span class="ident" id="5156255"><a href="/encoding/gob/type.go.html#5156109">got</a></span><span class="op" id="5156258">.</span><span class="ident" id="5156259">name</span><span class="op" id="5156263">(</span><span class="op" id="5156264">)</span>&nbsp;<span class="op" id="5156266">+</span>&nbsp;<span class="string" id="5156268">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="5156272">+</span>&nbsp;<span class="ident" id="5156274"><a href="/encoding/gob/type.go.html#5156109">got</a></span><span class="op" id="5156277">.</span><span class="builtintype" id="5156278">string</span><span class="op" id="5156284">(</span><span class="op" id="5156285">)</span>&nbsp;<span class="op" id="5156287">+</span>&nbsp;<span class="string" id="5156289">&#34;&nbsp;not&nbsp;&#34;</span>&nbsp;<span class="op" id="5156297">+</span>&nbsp;<span class="ident" id="5156299"><a href="/encoding/gob/type.go.html#5156103">want</a></span><span class="op" id="5156303">.</span><span class="builtintype" id="5156304">string</span><span class="op" id="5156310">(</span><span class="op" id="5156311">)</span><span class="op" id="5156312">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5156315">}</span><br>
<span class="lineno">620</span><span class="op" id="5156317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5156320">//&nbsp;used&nbsp;for&nbsp;building&nbsp;the&nbsp;basic&nbsp;types;&nbsp;called&nbsp;only&nbsp;from&nbsp;init().&nbsp;&nbsp;the&nbsp;incoming</span><br>
<span class="lineno"></span><span class="comment" id="5156397">//&nbsp;interface&nbsp;always&nbsp;refers&nbsp;to&nbsp;a&nbsp;pointer.</span><br>
<span class="lineno"></span><span class="keyword" id="5156438">func</span>&nbsp;<span class="ident" id="5156443">bootstrapType</span><span class="op" id="5156456">(</span><span class="ident" id="5156457">name</span>&nbsp;<span class="builtintype" id="5156462">string</span><span class="op" id="5156468">,</span>&nbsp;<span class="ident" id="5156470">e</span>&nbsp;<span class="keyword" id="5156472">interface</span><span class="op" id="5156481">{</span><span class="op" id="5156482">}</span><span class="op" id="5156483">,</span>&nbsp;<span class="ident" id="5156485">expect</span>&nbsp;<span class="ident" id="5156492"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><span class="op" id="5156498">)</span>&nbsp;<span class="ident" id="5156500"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span>&nbsp;<span class="op" id="5156507">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156510">rt</span>&nbsp;<span class="op" id="5156513">:=</span>&nbsp;<span class="ident" id="5156516"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5156523">.</span><span class="ident" id="5156524">TypeOf</span><span class="op" id="5156530">(</span><span class="ident" id="5156531"><a href="/encoding/gob/type.go.html#5156470">e</a></span><span class="op" id="5156532">)</span><span class="op" id="5156533">.</span><span class="ident" id="5156534">Elem</span><span class="op" id="5156538">(</span><span class="op" id="5156539">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156542">_</span><span class="op" id="5156543">,</span>&nbsp;<span class="ident" id="5156545">present</span>&nbsp;<span class="op" id="5156553">:=</span>&nbsp;<span class="ident" id="5156556"><a href="/encoding/gob/type.go.html#5144199">types</a></span><span class="op" id="5156561">[</span><span class="ident" id="5156562"><a href="/encoding/gob/type.go.html#5156510">rt</a></span><span class="op" id="5156564">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156567">if</span>&nbsp;<span class="ident" id="5156570"><a href="/encoding/gob/type.go.html#5156545">present</a></span>&nbsp;<span class="op" id="5156578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5156582">panic</span><span class="op" id="5156587">(</span><span class="string" id="5156588">&#34;bootstrap&nbsp;type&nbsp;already&nbsp;present:&nbsp;&#34;</span>&nbsp;<span class="op" id="5156623">+</span>&nbsp;<span class="ident" id="5156625"><a href="/encoding/gob/type.go.html#5156457">name</a></span>&nbsp;<span class="op" id="5156630">+</span>&nbsp;<span class="string" id="5156632">&#34;,&nbsp;&#34;</span>&nbsp;<span class="op" id="5156637">+</span>&nbsp;<span class="ident" id="5156639"><a href="/encoding/gob/type.go.html#5156510">rt</a></span><span class="op" id="5156641">.</span><span class="ident" id="5156642">String</span><span class="op" id="5156648">(</span><span class="op" id="5156649">)</span><span class="op" id="5156650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5156653">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156656">typ</span>&nbsp;<span class="op" id="5156660">:=</span>&nbsp;<span class="op" id="5156663">&amp;</span><span class="ident" id="5156664"><a href="/encoding/gob/type.go.html#5145250">CommonType</a></span><span class="op" id="5156674">{</span><span class="ident" id="5156675">Name</span><span class="op" id="5156679">:</span>&nbsp;<span class="ident" id="5156681"><a href="/encoding/gob/type.go.html#5156457">name</a></span><span class="op" id="5156685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156688"><a href="/encoding/gob/type.go.html#5144199">types</a></span><span class="op" id="5156693">[</span><span class="ident" id="5156694"><a href="/encoding/gob/type.go.html#5156510">rt</a></span><span class="op" id="5156696">]</span>&nbsp;<span class="op" id="5156698">=</span>&nbsp;<span class="ident" id="5156700"><a href="/encoding/gob/type.go.html#5156656">typ</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156705"><a href="/encoding/gob/type.go.html#5144371">setTypeId</a></span><span class="op" id="5156714">(</span><span class="ident" id="5156715"><a href="/encoding/gob/type.go.html#5156656">typ</a></span><span class="op" id="5156718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156721"><a href="/encoding/gob/type.go.html#5156095">checkId</a></span><span class="op" id="5156728">(</span><span class="ident" id="5156729"><a href="/encoding/gob/type.go.html#5156485">expect</a></span><span class="op" id="5156735">,</span>&nbsp;<span class="ident" id="5156737"><a href="/encoding/gob/type.go.html#5143853">nextId</a></span><span class="op" id="5156743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5156746"><a href="/encoding/gob/type.go.html#5143544">userType</a></span><span class="op" id="5156754">(</span><span class="ident" id="5156755"><a href="/encoding/gob/type.go.html#5156510">rt</a></span><span class="op" id="5156757">)</span>&nbsp;<span class="comment" id="5156759">//&nbsp;might&nbsp;as&nbsp;well&nbsp;cache&nbsp;it&nbsp;now</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5156790">return</span>&nbsp;<span class="ident" id="5156797"><a href="/encoding/gob/type.go.html#5143853">nextId</a></span><br>
<span class="lineno"></span><span class="op" id="5156804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5156807">//&nbsp;Representation&nbsp;of&nbsp;the&nbsp;information&nbsp;we&nbsp;send&nbsp;and&nbsp;receive&nbsp;about&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="5156881">//&nbsp;Each&nbsp;value&nbsp;we&nbsp;send&nbsp;is&nbsp;preceded&nbsp;by&nbsp;its&nbsp;type&nbsp;definition:&nbsp;an&nbsp;encoded&nbsp;int.</span><br>
<span class="lineno">640</span><span class="comment" id="5156955">//&nbsp;However,&nbsp;the&nbsp;very&nbsp;first&nbsp;time&nbsp;we&nbsp;send&nbsp;the&nbsp;value,&nbsp;we&nbsp;first&nbsp;send&nbsp;the&nbsp;pair</span><br>
<span class="lineno"></span><span class="comment" id="5157029">//&nbsp;(-id,&nbsp;wireType).</span><br>
<span class="lineno"></span><span class="comment" id="5157049">//&nbsp;For&nbsp;bootstrapping&nbsp;purposes,&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;recipient&nbsp;knows&nbsp;how</span><br>
<span class="lineno"></span><span class="comment" id="5157119">//&nbsp;to&nbsp;decode&nbsp;a&nbsp;wireType;&nbsp;it&nbsp;is&nbsp;exactly&nbsp;the&nbsp;wireType&nbsp;struct&nbsp;here,&nbsp;interpreted</span><br>
<span class="lineno"></span><span class="comment" id="5157196">//&nbsp;using&nbsp;the&nbsp;gob&nbsp;rules&nbsp;for&nbsp;sending&nbsp;a&nbsp;structure,&nbsp;except&nbsp;that&nbsp;we&nbsp;assume&nbsp;the</span><br>
<span class="lineno">645</span><span class="comment" id="5157270">//&nbsp;ids&nbsp;for&nbsp;wireType&nbsp;and&nbsp;structType&nbsp;etc.&nbsp;are&nbsp;known.&nbsp;&nbsp;The&nbsp;relevant&nbsp;pieces</span><br>
<span class="lineno"></span><span class="comment" id="5157342">//&nbsp;are&nbsp;built&nbsp;in&nbsp;encode.go&#39;s&nbsp;init()&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="5157387">//&nbsp;To&nbsp;maintain&nbsp;binary&nbsp;compatibility,&nbsp;if&nbsp;you&nbsp;extend&nbsp;this&nbsp;type,&nbsp;always&nbsp;put</span><br>
<span class="lineno"></span><span class="comment" id="5157460">//&nbsp;the&nbsp;new&nbsp;fields&nbsp;last.</span><br>
<span class="lineno"></span><span class="keyword" id="5157484">type</span>&nbsp;<span class="ident" id="5157489">wireType</span>&nbsp;<span class="keyword" id="5157498">struct</span>&nbsp;<span class="op" id="5157505">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157508">ArrayT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5157525">*</span><span class="ident" id="5157526"><a href="/encoding/gob/type.go.html#5147947">arrayType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157537">SliceT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5157554">*</span><span class="ident" id="5157555"><a href="/encoding/gob/type.go.html#5149641">sliceType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157566">StructT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5157583">*</span><span class="ident" id="5157584"><a href="/encoding/gob/type.go.html#5150424">structType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157596">MapT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5157613">*</span><span class="ident" id="5157614"><a href="/encoding/gob/type.go.html#5148964">mapType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157623">GobEncoderT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5157640">*</span><span class="ident" id="5157641"><a href="/encoding/gob/type.go.html#5148636">gobEncoderType</a></span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157657">BinaryMarshalerT</span>&nbsp;<span class="op" id="5157674">*</span><span class="ident" id="5157675"><a href="/encoding/gob/type.go.html#5148636">gobEncoderType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5157691">TextMarshalerT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5157708">*</span><span class="ident" id="5157709"><a href="/encoding/gob/type.go.html#5148636">gobEncoderType</a></span><br>
<span class="lineno"></span><span class="op" id="5157724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5157727">func</span>&nbsp;<span class="op" id="5157732">(</span><span class="ident" id="5157733">w</span>&nbsp;<span class="op" id="5157735">*</span><span class="ident" id="5157736"><a href="/encoding/gob/type.go.html#5157489">wireType</a></span><span class="op" id="5157744">)</span>&nbsp;<span class="builtintype" id="5157746">string</span><span class="op" id="5157752">(</span><span class="op" id="5157753">)</span>&nbsp;<span class="builtintype" id="5157755">string</span>&nbsp;<span class="op" id="5157762">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157765">const</span>&nbsp;<span class="ident" id="5157771">unknown</span>&nbsp;<span class="op" id="5157779">=</span>&nbsp;<span class="string" id="5157781">&#34;unknown&nbsp;type&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157797">if</span>&nbsp;<span class="ident" id="5157800"><a href="/encoding/gob/type.go.html#5157733">w</a></span>&nbsp;<span class="op" id="5157802">==</span>&nbsp;<span class="ident" id="5157805">nil</span>&nbsp;<span class="op" id="5157809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157813">return</span>&nbsp;<span class="ident" id="5157820"><a href="/encoding/gob/type.go.html#5157771">unknown</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5157829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157832">switch</span>&nbsp;<span class="op" id="5157839">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157842">case</span>&nbsp;<span class="ident" id="5157847"><a href="/encoding/gob/type.go.html#5157733">w</a></span><span class="op" id="5157848">.</span><span class="ident" id="5157849">ArrayT</span>&nbsp;<span class="op" id="5157856">!=</span>&nbsp;<span class="ident" id="5157859">nil</span><span class="op" id="5157862">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157866">return</span>&nbsp;<span class="ident" id="5157873"><a href="/encoding/gob/type.go.html#5157733">w</a></span><span class="op" id="5157874">.</span><span class="ident" id="5157875">ArrayT</span><span class="op" id="5157881">.</span><span class="ident" id="5157882">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157888">case</span>&nbsp;<span class="ident" id="5157893"><a href="/encoding/gob/type.go.html#5157733">w</a></span><span class="op" id="5157894">.</span><span class="ident" id="5157895">SliceT</span>&nbsp;<span class="op" id="5157902">!=</span>&nbsp;<span class="ident" id="5157905">nil</span><span class="op" id="5157908">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157912">return</span>&nbsp;<span class="ident" id="5157919"><a href="/encoding/gob/type.go.html#5157733">w</a></span><span class="op" id="5157920">.</span><span class="ident" id="5157921">SliceT</span><span class="op" id="5157927">.</span><span class="ident" id="5157928">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157934">case</span>&nbsp;<span class="ident" id="5157939"><a href="/encoding/gob/type.go.html#5157733">w</a></span><span class="op" id="5157940">.</span><span class="ident" id="5157941">StructT</span>&nbsp;<span class="op" id="5157949">!=</span>&nbsp;<span class="ident" id="5157952">nil</span><span class="op" id="5157955">:</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157959">return</span>&nbsp;<span class="ident" id="5157966"><a href="/encoding/gob/type.go.html#5157733">w</a></span><span class="op" id="5157967">.</span><span class="ident" id="5157968">StructT</span><span class="op" id="5157975">.</span><span class="ident" id="5157976">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5157982">case</span>&nbsp;<span class="ident" id="5157987"><a href="/encoding/gob/type.go.html#5157733">w</a></span><span class="op" id="5157988">.</span><span class="ident" id="5157989">MapT</span>&nbsp;<span class="op" id="5157994">!=</span>&nbsp;<span class="ident" id="5157997">nil</span><span class="op" id="5158000">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158004">return</span>&nbsp;<span class="ident" id="5158011"><a href="/encoding/gob/type.go.html#5157733">w</a></span><span class="op" id="5158012">.</span><span class="ident" id="5158013">MapT</span><span class="op" id="5158017">.</span><span class="ident" id="5158018">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158024">case</span>&nbsp;<span class="ident" id="5158029"><a href="/encoding/gob/type.go.html#5157733">w</a></span><span class="op" id="5158030">.</span><span class="ident" id="5158031">GobEncoderT</span>&nbsp;<span class="op" id="5158043">!=</span>&nbsp;<span class="ident" id="5158046">nil</span><span class="op" id="5158049">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158053">return</span>&nbsp;<span class="ident" id="5158060"><a href="/encoding/gob/type.go.html#5157733">w</a></span><span class="op" id="5158061">.</span><span class="ident" id="5158062">GobEncoderT</span><span class="op" id="5158073">.</span><span class="ident" id="5158074">Name</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158080">case</span>&nbsp;<span class="ident" id="5158085"><a href="/encoding/gob/type.go.html#5157733">w</a></span><span class="op" id="5158086">.</span><span class="ident" id="5158087">BinaryMarshalerT</span>&nbsp;<span class="op" id="5158104">!=</span>&nbsp;<span class="ident" id="5158107">nil</span><span class="op" id="5158110">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158114">return</span>&nbsp;<span class="ident" id="5158121"><a href="/encoding/gob/type.go.html#5157733">w</a></span><span class="op" id="5158122">.</span><span class="ident" id="5158123">BinaryMarshalerT</span><span class="op" id="5158139">.</span><span class="ident" id="5158140">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158146">case</span>&nbsp;<span class="ident" id="5158151"><a href="/encoding/gob/type.go.html#5157733">w</a></span><span class="op" id="5158152">.</span><span class="ident" id="5158153">TextMarshalerT</span>&nbsp;<span class="op" id="5158168">!=</span>&nbsp;<span class="ident" id="5158171">nil</span><span class="op" id="5158174">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158178">return</span>&nbsp;<span class="ident" id="5158185"><a href="/encoding/gob/type.go.html#5157733">w</a></span><span class="op" id="5158186">.</span><span class="ident" id="5158187">TextMarshalerT</span><span class="op" id="5158201">.</span><span class="ident" id="5158202">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5158208">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158211">return</span>&nbsp;<span class="ident" id="5158218"><a href="/encoding/gob/type.go.html#5157771">unknown</a></span><br>
<span class="lineno"></span><span class="op" id="5158226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5158229">type</span>&nbsp;<span class="ident" id="5158234">typeInfo</span>&nbsp;<span class="keyword" id="5158243">struct</span>&nbsp;<span class="op" id="5158250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158253">id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5158261"><a href="/encoding/gob/type.go.html#5143835">typeId</a></span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158269">encInit</span>&nbsp;<span class="ident" id="5158277"><a href="/encoding/gob/type.go.html#5138407">sync</a></span><span class="op" id="5158281">.</span><span class="ident" id="5158282">Mutex</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5158290">//&nbsp;protects&nbsp;creation&nbsp;of&nbsp;encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158323">encoder</span>&nbsp;<span class="ident" id="5158331"><a href="/encoding/gob/type.go.html#5138415">atomic</a></span><span class="op" id="5158337">.</span><span class="ident" id="5158338">Value</span>&nbsp;<span class="comment" id="5158344">//&nbsp;*encEngine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158359">wire</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5158367">*</span><span class="ident" id="5158368"><a href="/encoding/gob/type.go.html#5157489">wireType</a></span><br>
<span class="lineno"></span><span class="op" id="5158377">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="comment" id="5158380">//&nbsp;typeInfoMap&nbsp;is&nbsp;an&nbsp;atomic&nbsp;pointer&nbsp;to&nbsp;map[reflect.Type]*typeInfo.</span><br>
<span class="lineno"></span><span class="comment" id="5158447">//&nbsp;It&#39;s&nbsp;updated&nbsp;copy-on-write.&nbsp;Readers&nbsp;just&nbsp;do&nbsp;an&nbsp;atomic&nbsp;load</span><br>
<span class="lineno"></span><span class="comment" id="5158509">//&nbsp;to&nbsp;get&nbsp;the&nbsp;current&nbsp;version&nbsp;of&nbsp;the&nbsp;map.&nbsp;Writers&nbsp;make&nbsp;a&nbsp;full&nbsp;copy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5158579">//&nbsp;the&nbsp;map&nbsp;and&nbsp;atomically&nbsp;update&nbsp;the&nbsp;pointer&nbsp;to&nbsp;point&nbsp;to&nbsp;the&nbsp;new&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="5158649">//&nbsp;Under&nbsp;heavy&nbsp;read&nbsp;contention,&nbsp;this&nbsp;is&nbsp;significantly&nbsp;faster&nbsp;than&nbsp;a&nbsp;map</span><br>
<span class="lineno">695</span><span class="comment" id="5158721">//&nbsp;protected&nbsp;by&nbsp;a&nbsp;mutex.</span><br>
<span class="lineno"></span><span class="keyword" id="5158746">var</span>&nbsp;<span class="ident" id="5158750">typeInfoMap</span>&nbsp;<span class="ident" id="5158762"><a href="/encoding/gob/type.go.html#5138415">atomic</a></span><span class="op" id="5158768">.</span><span class="ident" id="5158769">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5158776">func</span>&nbsp;<span class="ident" id="5158781">lookupTypeInfo</span><span class="op" id="5158795">(</span><span class="ident" id="5158796">rt</span>&nbsp;<span class="ident" id="5158799"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5158806">.</span><span class="ident" id="5158807">Type</span><span class="op" id="5158811">)</span>&nbsp;<span class="op" id="5158813">*</span><span class="ident" id="5158814"><a href="/encoding/gob/type.go.html#5158234">typeInfo</a></span>&nbsp;<span class="op" id="5158823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158826">m</span><span class="op" id="5158827">,</span>&nbsp;<span class="ident" id="5158829">_</span>&nbsp;<span class="op" id="5158831">:=</span>&nbsp;<span class="ident" id="5158834"><a href="/encoding/gob/type.go.html#5158750">typeInfoMap</a></span><span class="op" id="5158845">.</span><span class="ident" id="5158846">Load</span><span class="op" id="5158850">(</span><span class="op" id="5158851">)</span><span class="op" id="5158852">.</span><span class="op" id="5158853">(</span><span class="keyword" id="5158854">map</span><span class="op" id="5158857">[</span><span class="ident" id="5158858"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5158865">.</span><span class="ident" id="5158866">Type</span><span class="op" id="5158870">]</span><span class="op" id="5158871">*</span><span class="ident" id="5158872"><a href="/encoding/gob/type.go.html#5158234">typeInfo</a></span><span class="op" id="5158880">)</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158883">return</span>&nbsp;<span class="ident" id="5158890"><a href="/encoding/gob/type.go.html#5158826">m</a></span><span class="op" id="5158891">[</span><span class="ident" id="5158892"><a href="/encoding/gob/type.go.html#5158796">rt</a></span><span class="op" id="5158894">]</span><br>
<span class="lineno"></span><span class="op" id="5158896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5158899">func</span>&nbsp;<span class="ident" id="5158904">getTypeInfo</span><span class="op" id="5158915">(</span><span class="ident" id="5158916">ut</span>&nbsp;<span class="op" id="5158919">*</span><span class="ident" id="5158920"><a href="/encoding/gob/type.go.html#5138634">userTypeInfo</a></span><span class="op" id="5158932">)</span>&nbsp;<span class="op" id="5158934">(</span><span class="op" id="5158935">*</span><span class="ident" id="5158936"><a href="/encoding/gob/type.go.html#5158234">typeInfo</a></span><span class="op" id="5158944">,</span>&nbsp;<span class="builtintype" id="5158946">error</span><span class="op" id="5158951">)</span>&nbsp;<span class="op" id="5158953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5158956">rt</span>&nbsp;<span class="op" id="5158959">:=</span>&nbsp;<span class="ident" id="5158962"><a href="/encoding/gob/type.go.html#5158916">ut</a></span><span class="op" id="5158964">.</span><span class="ident" id="5158965">base</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5158971">if</span>&nbsp;<span class="ident" id="5158974"><a href="/encoding/gob/type.go.html#5158916">ut</a></span><span class="op" id="5158976">.</span><span class="ident" id="5158977">externalEnc</span>&nbsp;<span class="op" id="5158989">!=</span>&nbsp;<span class="num" id="5158992">0</span>&nbsp;<span class="op" id="5158994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5158998">//&nbsp;We&nbsp;want&nbsp;the&nbsp;user&nbsp;type,&nbsp;not&nbsp;the&nbsp;base&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159045"><a href="/encoding/gob/type.go.html#5158956">rt</a></span>&nbsp;<span class="op" id="5159048">=</span>&nbsp;<span class="ident" id="5159050"><a href="/encoding/gob/type.go.html#5158916">ut</a></span><span class="op" id="5159052">.</span><span class="ident" id="5159053">user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159059">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159062">if</span>&nbsp;<span class="ident" id="5159065">info</span>&nbsp;<span class="op" id="5159070">:=</span>&nbsp;<span class="ident" id="5159073"><a href="/encoding/gob/type.go.html#5158781">lookupTypeInfo</a></span><span class="op" id="5159087">(</span><span class="ident" id="5159088"><a href="/encoding/gob/type.go.html#5158956">rt</a></span><span class="op" id="5159090">)</span><span class="op" id="5159091">;</span>&nbsp;<span class="ident" id="5159093"><a href="/encoding/gob/type.go.html#5159065">info</a></span>&nbsp;<span class="op" id="5159098">!=</span>&nbsp;<span class="ident" id="5159101">nil</span>&nbsp;<span class="op" id="5159105">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159109">return</span>&nbsp;<span class="ident" id="5159116"><a href="/encoding/gob/type.go.html#5159065">info</a></span><span class="op" id="5159120">,</span>&nbsp;<span class="ident" id="5159122">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159130">return</span>&nbsp;<span class="ident" id="5159137"><a href="/encoding/gob/type.go.html#5159268">buildTypeInfo</a></span><span class="op" id="5159150">(</span><span class="ident" id="5159151"><a href="/encoding/gob/type.go.html#5158916">ut</a></span><span class="op" id="5159153">,</span>&nbsp;<span class="ident" id="5159155"><a href="/encoding/gob/type.go.html#5158956">rt</a></span><span class="op" id="5159157">)</span><br>
<span class="lineno"></span><span class="op" id="5159159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span><span class="comment" id="5159162">//&nbsp;buildTypeInfo&nbsp;constructs&nbsp;the&nbsp;type&nbsp;information&nbsp;for&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="5159224">//&nbsp;and&nbsp;stores&nbsp;it&nbsp;in&nbsp;the&nbsp;type&nbsp;info&nbsp;map.</span><br>
<span class="lineno"></span><span class="keyword" id="5159263">func</span>&nbsp;<span class="ident" id="5159268">buildTypeInfo</span><span class="op" id="5159281">(</span><span class="ident" id="5159282">ut</span>&nbsp;<span class="op" id="5159285">*</span><span class="ident" id="5159286"><a href="/encoding/gob/type.go.html#5138634">userTypeInfo</a></span><span class="op" id="5159298">,</span>&nbsp;<span class="ident" id="5159300">rt</span>&nbsp;<span class="ident" id="5159303"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5159310">.</span><span class="ident" id="5159311">Type</span><span class="op" id="5159315">)</span>&nbsp;<span class="op" id="5159317">(</span><span class="op" id="5159318">*</span><span class="ident" id="5159319"><a href="/encoding/gob/type.go.html#5158234">typeInfo</a></span><span class="op" id="5159327">,</span>&nbsp;<span class="builtintype" id="5159329">error</span><span class="op" id="5159334">)</span>&nbsp;<span class="op" id="5159336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159339"><a href="/encoding/gob/type.go.html#5143919">typeLock</a></span><span class="op" id="5159347">.</span><span class="ident" id="5159348">Lock</span><span class="op" id="5159352">(</span><span class="op" id="5159353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159356">defer</span>&nbsp;<span class="ident" id="5159362"><a href="/encoding/gob/type.go.html#5143919">typeLock</a></span><span class="op" id="5159370">.</span><span class="ident" id="5159371">Unlock</span><span class="op" id="5159377">(</span><span class="op" id="5159378">)</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159382">if</span>&nbsp;<span class="ident" id="5159385">info</span>&nbsp;<span class="op" id="5159390">:=</span>&nbsp;<span class="ident" id="5159393"><a href="/encoding/gob/type.go.html#5158781">lookupTypeInfo</a></span><span class="op" id="5159407">(</span><span class="ident" id="5159408"><a href="/encoding/gob/type.go.html#5159300">rt</a></span><span class="op" id="5159410">)</span><span class="op" id="5159411">;</span>&nbsp;<span class="ident" id="5159413"><a href="/encoding/gob/type.go.html#5159385">info</a></span>&nbsp;<span class="op" id="5159418">!=</span>&nbsp;<span class="ident" id="5159421">nil</span>&nbsp;<span class="op" id="5159425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159429">return</span>&nbsp;<span class="ident" id="5159436"><a href="/encoding/gob/type.go.html#5159385">info</a></span><span class="op" id="5159440">,</span>&nbsp;<span class="ident" id="5159442">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159451">gt</span><span class="op" id="5159453">,</span>&nbsp;<span class="ident" id="5159455">err</span>&nbsp;<span class="op" id="5159459">:=</span>&nbsp;<span class="ident" id="5159462"><a href="/encoding/gob/type.go.html#5155478">getBaseType</a></span><span class="op" id="5159473">(</span><span class="ident" id="5159474"><a href="/encoding/gob/type.go.html#5159300">rt</a></span><span class="op" id="5159476">.</span><span class="ident" id="5159477">Name</span><span class="op" id="5159481">(</span><span class="op" id="5159482">)</span><span class="op" id="5159483">,</span>&nbsp;<span class="ident" id="5159485"><a href="/encoding/gob/type.go.html#5159300">rt</a></span><span class="op" id="5159487">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159490">if</span>&nbsp;<span class="ident" id="5159493"><a href="/encoding/gob/type.go.html#5159455">err</a></span>&nbsp;<span class="op" id="5159497">!=</span>&nbsp;<span class="ident" id="5159500">nil</span>&nbsp;<span class="op" id="5159504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159508">return</span>&nbsp;<span class="ident" id="5159515">nil</span><span class="op" id="5159518">,</span>&nbsp;<span class="ident" id="5159520"><a href="/encoding/gob/type.go.html#5159455">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159528">info</span>&nbsp;<span class="op" id="5159533">:=</span>&nbsp;<span class="op" id="5159536">&amp;</span><span class="ident" id="5159537"><a href="/encoding/gob/type.go.html#5158234">typeInfo</a></span><span class="op" id="5159545">{</span><span class="ident" id="5159546">id</span><span class="op" id="5159548">:</span>&nbsp;<span class="ident" id="5159550"><a href="/encoding/gob/type.go.html#5159451">gt</a></span><span class="op" id="5159552">.</span><span class="ident" id="5159553">id</span><span class="op" id="5159555">(</span><span class="op" id="5159556">)</span><span class="op" id="5159557">}</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159561">if</span>&nbsp;<span class="ident" id="5159564"><a href="/encoding/gob/type.go.html#5159282">ut</a></span><span class="op" id="5159566">.</span><span class="ident" id="5159567">externalEnc</span>&nbsp;<span class="op" id="5159579">!=</span>&nbsp;<span class="num" id="5159582">0</span>&nbsp;<span class="op" id="5159584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159588">userType</span><span class="op" id="5159596">,</span>&nbsp;<span class="ident" id="5159598">err</span>&nbsp;<span class="op" id="5159602">:=</span>&nbsp;<span class="ident" id="5159605"><a href="/encoding/gob/type.go.html#5155854">getType</a></span><span class="op" id="5159612">(</span><span class="ident" id="5159613"><a href="/encoding/gob/type.go.html#5159300">rt</a></span><span class="op" id="5159615">.</span><span class="ident" id="5159616">Name</span><span class="op" id="5159620">(</span><span class="op" id="5159621">)</span><span class="op" id="5159622">,</span>&nbsp;<span class="ident" id="5159624"><a href="/encoding/gob/type.go.html#5159282">ut</a></span><span class="op" id="5159626">,</span>&nbsp;<span class="ident" id="5159628"><a href="/encoding/gob/type.go.html#5159300">rt</a></span><span class="op" id="5159630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159634">if</span>&nbsp;<span class="ident" id="5159637"><a href="/encoding/gob/type.go.html#5159598">err</a></span>&nbsp;<span class="op" id="5159641">!=</span>&nbsp;<span class="ident" id="5159644">nil</span>&nbsp;<span class="op" id="5159648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159653">return</span>&nbsp;<span class="ident" id="5159660">nil</span><span class="op" id="5159663">,</span>&nbsp;<span class="ident" id="5159665"><a href="/encoding/gob/type.go.html#5159598">err</a></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159671">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159675">gt</span>&nbsp;<span class="op" id="5159678">:=</span>&nbsp;<span class="ident" id="5159681"><a href="/encoding/gob/type.go.html#5159588">userType</a></span><span class="op" id="5159689">.</span><span class="ident" id="5159690">id</span><span class="op" id="5159692">(</span><span class="op" id="5159693">)</span><span class="op" id="5159694">.</span><span class="ident" id="5159695">gobType</span><span class="op" id="5159702">(</span><span class="op" id="5159703">)</span><span class="op" id="5159704">.</span><span class="op" id="5159705">(</span><span class="op" id="5159706">*</span><span class="ident" id="5159707"><a href="/encoding/gob/type.go.html#5148636">gobEncoderType</a></span><span class="op" id="5159721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159725">switch</span>&nbsp;<span class="ident" id="5159732"><a href="/encoding/gob/type.go.html#5159282">ut</a></span><span class="op" id="5159734">.</span><span class="ident" id="5159735">externalEnc</span>&nbsp;<span class="op" id="5159747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159751">case</span>&nbsp;<span class="ident" id="5159756"><a href="/encoding/gob/type.go.html#5139188">xGob</a></span><span class="op" id="5159760">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159765"><a href="/encoding/gob/type.go.html#5159528">info</a></span><span class="op" id="5159769">.</span><span class="ident" id="5159770">wire</span>&nbsp;<span class="op" id="5159775">=</span>&nbsp;<span class="op" id="5159777">&amp;</span><span class="ident" id="5159778"><a href="/encoding/gob/type.go.html#5157489">wireType</a></span><span class="op" id="5159786">{</span><span class="ident" id="5159787">GobEncoderT</span><span class="op" id="5159798">:</span>&nbsp;<span class="ident" id="5159800"><a href="/encoding/gob/type.go.html#5159675">gt</a></span><span class="op" id="5159802">}</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159806">case</span>&nbsp;<span class="ident" id="5159811"><a href="/encoding/gob/type.go.html#5139236">xBinary</a></span><span class="op" id="5159818">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159823"><a href="/encoding/gob/type.go.html#5159528">info</a></span><span class="op" id="5159827">.</span><span class="ident" id="5159828">wire</span>&nbsp;<span class="op" id="5159833">=</span>&nbsp;<span class="op" id="5159835">&amp;</span><span class="ident" id="5159836"><a href="/encoding/gob/type.go.html#5157489">wireType</a></span><span class="op" id="5159844">{</span><span class="ident" id="5159845">BinaryMarshalerT</span><span class="op" id="5159861">:</span>&nbsp;<span class="ident" id="5159863"><a href="/encoding/gob/type.go.html#5159675">gt</a></span><span class="op" id="5159865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159869">case</span>&nbsp;<span class="ident" id="5159874"><a href="/encoding/gob/type.go.html#5139314">xText</a></span><span class="op" id="5159879">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159884"><a href="/encoding/gob/type.go.html#5159528">info</a></span><span class="op" id="5159888">.</span><span class="ident" id="5159889">wire</span>&nbsp;<span class="op" id="5159894">=</span>&nbsp;<span class="op" id="5159896">&amp;</span><span class="ident" id="5159897"><a href="/encoding/gob/type.go.html#5157489">wireType</a></span><span class="op" id="5159905">{</span><span class="ident" id="5159906">TextMarshalerT</span><span class="op" id="5159920">:</span>&nbsp;<span class="ident" id="5159922"><a href="/encoding/gob/type.go.html#5159675">gt</a></span><span class="op" id="5159924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159928">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159932"><a href="/encoding/gob/type.go.html#5159300">rt</a></span>&nbsp;<span class="op" id="5159935">=</span>&nbsp;<span class="ident" id="5159937"><a href="/encoding/gob/type.go.html#5159282">ut</a></span><span class="op" id="5159939">.</span><span class="ident" id="5159940">user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5159946">}</span>&nbsp;<span class="keyword" id="5159948">else</span>&nbsp;<span class="op" id="5159953">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5159957">t</span>&nbsp;<span class="op" id="5159959">:=</span>&nbsp;<span class="ident" id="5159962"><a href="/encoding/gob/type.go.html#5159528">info</a></span><span class="op" id="5159966">.</span><span class="ident" id="5159967">id</span><span class="op" id="5159969">.</span><span class="ident" id="5159970">gobType</span><span class="op" id="5159977">(</span><span class="op" id="5159978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5159982">switch</span>&nbsp;<span class="ident" id="5159989">typ</span>&nbsp;<span class="op" id="5159993">:=</span>&nbsp;<span class="ident" id="5159996"><a href="/encoding/gob/type.go.html#5159300">rt</a></span><span class="op" id="5159998">;</span>&nbsp;<span class="ident" id="5160000"><a href="/encoding/gob/type.go.html#5159989">typ</a></span><span class="op" id="5160003">.</span><span class="ident" id="5160004">Kind</span><span class="op" id="5160008">(</span><span class="op" id="5160009">)</span>&nbsp;<span class="op" id="5160011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160015">case</span>&nbsp;<span class="ident" id="5160020"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5160027">.</span><span class="ident" id="5160028">Array</span><span class="op" id="5160033">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160038"><a href="/encoding/gob/type.go.html#5159528">info</a></span><span class="op" id="5160042">.</span><span class="ident" id="5160043">wire</span>&nbsp;<span class="op" id="5160048">=</span>&nbsp;<span class="op" id="5160050">&amp;</span><span class="ident" id="5160051"><a href="/encoding/gob/type.go.html#5157489">wireType</a></span><span class="op" id="5160059">{</span><span class="ident" id="5160060">ArrayT</span><span class="op" id="5160066">:</span>&nbsp;<span class="ident" id="5160068"><a href="/encoding/gob/type.go.html#5159957">t</a></span><span class="op" id="5160069">.</span><span class="op" id="5160070">(</span><span class="op" id="5160071">*</span><span class="ident" id="5160072"><a href="/encoding/gob/type.go.html#5147947">arrayType</a></span><span class="op" id="5160081">)</span><span class="op" id="5160082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160086">case</span>&nbsp;<span class="ident" id="5160091"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5160098">.</span><span class="ident" id="5160099">Map</span><span class="op" id="5160102">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160107"><a href="/encoding/gob/type.go.html#5159528">info</a></span><span class="op" id="5160111">.</span><span class="ident" id="5160112">wire</span>&nbsp;<span class="op" id="5160117">=</span>&nbsp;<span class="op" id="5160119">&amp;</span><span class="ident" id="5160120"><a href="/encoding/gob/type.go.html#5157489">wireType</a></span><span class="op" id="5160128">{</span><span class="ident" id="5160129">MapT</span><span class="op" id="5160133">:</span>&nbsp;<span class="ident" id="5160135"><a href="/encoding/gob/type.go.html#5159957">t</a></span><span class="op" id="5160136">.</span><span class="op" id="5160137">(</span><span class="op" id="5160138">*</span><span class="ident" id="5160139"><a href="/encoding/gob/type.go.html#5148964">mapType</a></span><span class="op" id="5160146">)</span><span class="op" id="5160147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160151">case</span>&nbsp;<span class="ident" id="5160156"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5160163">.</span><span class="ident" id="5160164">Slice</span><span class="op" id="5160169">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5160174">//&nbsp;[]byte&nbsp;==&nbsp;[]uint8&nbsp;is&nbsp;a&nbsp;special&nbsp;case&nbsp;handled&nbsp;separately</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160235">if</span>&nbsp;<span class="ident" id="5160238"><a href="/encoding/gob/type.go.html#5159989">typ</a></span><span class="op" id="5160241">.</span><span class="ident" id="5160242">Elem</span><span class="op" id="5160246">(</span><span class="op" id="5160247">)</span><span class="op" id="5160248">.</span><span class="ident" id="5160249">Kind</span><span class="op" id="5160253">(</span><span class="op" id="5160254">)</span>&nbsp;<span class="op" id="5160256">!=</span>&nbsp;<span class="ident" id="5160259"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5160266">.</span><span class="ident" id="5160267">Uint8</span>&nbsp;<span class="op" id="5160273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160279"><a href="/encoding/gob/type.go.html#5159528">info</a></span><span class="op" id="5160283">.</span><span class="ident" id="5160284">wire</span>&nbsp;<span class="op" id="5160289">=</span>&nbsp;<span class="op" id="5160291">&amp;</span><span class="ident" id="5160292"><a href="/encoding/gob/type.go.html#5157489">wireType</a></span><span class="op" id="5160300">{</span><span class="ident" id="5160301">SliceT</span><span class="op" id="5160307">:</span>&nbsp;<span class="ident" id="5160309"><a href="/encoding/gob/type.go.html#5159957">t</a></span><span class="op" id="5160310">.</span><span class="op" id="5160311">(</span><span class="op" id="5160312">*</span><span class="ident" id="5160313"><a href="/encoding/gob/type.go.html#5149641">sliceType</a></span><span class="op" id="5160322">)</span><span class="op" id="5160323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160332">case</span>&nbsp;<span class="ident" id="5160337"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5160344">.</span><span class="ident" id="5160345">Struct</span><span class="op" id="5160351">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160356"><a href="/encoding/gob/type.go.html#5159528">info</a></span><span class="op" id="5160360">.</span><span class="ident" id="5160361">wire</span>&nbsp;<span class="op" id="5160366">=</span>&nbsp;<span class="op" id="5160368">&amp;</span><span class="ident" id="5160369"><a href="/encoding/gob/type.go.html#5157489">wireType</a></span><span class="op" id="5160377">{</span><span class="ident" id="5160378">StructT</span><span class="op" id="5160385">:</span>&nbsp;<span class="ident" id="5160387"><a href="/encoding/gob/type.go.html#5159957">t</a></span><span class="op" id="5160388">.</span><span class="op" id="5160389">(</span><span class="op" id="5160390">*</span><span class="ident" id="5160391"><a href="/encoding/gob/type.go.html#5150424">structType</a></span><span class="op" id="5160401">)</span><span class="op" id="5160402">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5160413">//&nbsp;Create&nbsp;new&nbsp;map&nbsp;with&nbsp;old&nbsp;contents&nbsp;plus&nbsp;new&nbsp;entry.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160466">newm</span>&nbsp;<span class="op" id="5160471">:=</span>&nbsp;<span class="builtinfunc" id="5160474">make</span><span class="op" id="5160478">(</span><span class="keyword" id="5160479">map</span><span class="op" id="5160482">[</span><span class="ident" id="5160483"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5160490">.</span><span class="ident" id="5160491">Type</span><span class="op" id="5160495">]</span><span class="op" id="5160496">*</span><span class="ident" id="5160497"><a href="/encoding/gob/type.go.html#5158234">typeInfo</a></span><span class="op" id="5160505">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160508">m</span><span class="op" id="5160509">,</span>&nbsp;<span class="ident" id="5160511">_</span>&nbsp;<span class="op" id="5160513">:=</span>&nbsp;<span class="ident" id="5160516"><a href="/encoding/gob/type.go.html#5158750">typeInfoMap</a></span><span class="op" id="5160527">.</span><span class="ident" id="5160528">Load</span><span class="op" id="5160532">(</span><span class="op" id="5160533">)</span><span class="op" id="5160534">.</span><span class="op" id="5160535">(</span><span class="keyword" id="5160536">map</span><span class="op" id="5160539">[</span><span class="ident" id="5160540"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5160547">.</span><span class="ident" id="5160548">Type</span><span class="op" id="5160552">]</span><span class="op" id="5160553">*</span><span class="ident" id="5160554"><a href="/encoding/gob/type.go.html#5158234">typeInfo</a></span><span class="op" id="5160562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160565">for</span>&nbsp;<span class="ident" id="5160569">k</span><span class="op" id="5160570">,</span>&nbsp;<span class="ident" id="5160572">v</span>&nbsp;<span class="op" id="5160574">:=</span>&nbsp;<span class="keyword" id="5160577">range</span>&nbsp;<span class="ident" id="5160583"><a href="/encoding/gob/type.go.html#5160508">m</a></span>&nbsp;<span class="op" id="5160585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160589"><a href="/encoding/gob/type.go.html#5160466">newm</a></span><span class="op" id="5160593">[</span><span class="ident" id="5160594"><a href="/encoding/gob/type.go.html#5160569">k</a></span><span class="op" id="5160595">]</span>&nbsp;<span class="op" id="5160597">=</span>&nbsp;<span class="ident" id="5160599"><a href="/encoding/gob/type.go.html#5160572">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160605"><a href="/encoding/gob/type.go.html#5160466">newm</a></span><span class="op" id="5160609">[</span><span class="ident" id="5160610"><a href="/encoding/gob/type.go.html#5159300">rt</a></span><span class="op" id="5160612">]</span>&nbsp;<span class="op" id="5160614">=</span>&nbsp;<span class="ident" id="5160616"><a href="/encoding/gob/type.go.html#5159528">info</a></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160622"><a href="/encoding/gob/type.go.html#5158750">typeInfoMap</a></span><span class="op" id="5160633">.</span><span class="ident" id="5160634">Store</span><span class="op" id="5160639">(</span><span class="ident" id="5160640"><a href="/encoding/gob/type.go.html#5160466">newm</a></span><span class="op" id="5160644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160647">return</span>&nbsp;<span class="ident" id="5160654"><a href="/encoding/gob/type.go.html#5159528">info</a></span><span class="op" id="5160658">,</span>&nbsp;<span class="ident" id="5160660">nil</span><br>
<span class="lineno"></span><span class="op" id="5160664">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5160667">//&nbsp;Called&nbsp;only&nbsp;when&nbsp;a&nbsp;panic&nbsp;is&nbsp;acceptable&nbsp;and&nbsp;unexpected.</span><br>
<span class="lineno">775</span><span class="keyword" id="5160725">func</span>&nbsp;<span class="ident" id="5160730">mustGetTypeInfo</span><span class="op" id="5160745">(</span><span class="ident" id="5160746">rt</span>&nbsp;<span class="ident" id="5160749"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5160756">.</span><span class="ident" id="5160757">Type</span><span class="op" id="5160761">)</span>&nbsp;<span class="op" id="5160763">*</span><span class="ident" id="5160764"><a href="/encoding/gob/type.go.html#5158234">typeInfo</a></span>&nbsp;<span class="op" id="5160773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5160776">t</span><span class="op" id="5160777">,</span>&nbsp;<span class="ident" id="5160779">err</span>&nbsp;<span class="op" id="5160783">:=</span>&nbsp;<span class="ident" id="5160786"><a href="/encoding/gob/type.go.html#5158904">getTypeInfo</a></span><span class="op" id="5160797">(</span><span class="ident" id="5160798"><a href="/encoding/gob/type.go.html#5143544">userType</a></span><span class="op" id="5160806">(</span><span class="ident" id="5160807"><a href="/encoding/gob/type.go.html#5160746">rt</a></span><span class="op" id="5160809">)</span><span class="op" id="5160810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160813">if</span>&nbsp;<span class="ident" id="5160816"><a href="/encoding/gob/type.go.html#5160779">err</a></span>&nbsp;<span class="op" id="5160820">!=</span>&nbsp;<span class="ident" id="5160823">nil</span>&nbsp;<span class="op" id="5160827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5160831">panic</span><span class="op" id="5160836">(</span><span class="string" id="5160837">&#34;getTypeInfo:&nbsp;&#34;</span>&nbsp;<span class="op" id="5160853">+</span>&nbsp;<span class="ident" id="5160855"><a href="/encoding/gob/type.go.html#5160779">err</a></span><span class="op" id="5160858">.</span><span class="ident" id="5160859">Error</span><span class="op" id="5160864">(</span><span class="op" id="5160865">)</span><span class="op" id="5160866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5160869">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5160872">return</span>&nbsp;<span class="ident" id="5160879"><a href="/encoding/gob/type.go.html#5160776">t</a></span><br>
<span class="lineno"></span><span class="op" id="5160881">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5160884">//&nbsp;GobEncoder&nbsp;is&nbsp;the&nbsp;interface&nbsp;describing&nbsp;data&nbsp;that&nbsp;provides&nbsp;its&nbsp;own</span><br>
<span class="lineno"></span><span class="comment" id="5160953">//&nbsp;representation&nbsp;for&nbsp;encoding&nbsp;values&nbsp;for&nbsp;transmission&nbsp;to&nbsp;a&nbsp;GobDecoder.</span><br>
<span class="lineno">785</span><span class="comment" id="5161025">//&nbsp;A&nbsp;type&nbsp;that&nbsp;implements&nbsp;GobEncoder&nbsp;and&nbsp;GobDecoder&nbsp;has&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="5161090">//&nbsp;control&nbsp;over&nbsp;the&nbsp;representation&nbsp;of&nbsp;its&nbsp;data&nbsp;and&nbsp;may&nbsp;therefore</span><br>
<span class="lineno"></span><span class="comment" id="5161155">//&nbsp;contain&nbsp;things&nbsp;such&nbsp;as&nbsp;private&nbsp;fields,&nbsp;channels,&nbsp;and&nbsp;functions,</span><br>
<span class="lineno"></span><span class="comment" id="5161222">//&nbsp;which&nbsp;are&nbsp;not&nbsp;usually&nbsp;transmissible&nbsp;in&nbsp;gob&nbsp;streams.</span><br>
<span class="lineno"></span><span class="comment" id="5161277">//</span><br>
<span class="lineno">790</span><span class="comment" id="5161280">//&nbsp;Note:&nbsp;Since&nbsp;gobs&nbsp;can&nbsp;be&nbsp;stored&nbsp;permanently,&nbsp;It&nbsp;is&nbsp;good&nbsp;design</span><br>
<span class="lineno"></span><span class="comment" id="5161345">//&nbsp;to&nbsp;guarantee&nbsp;the&nbsp;encoding&nbsp;used&nbsp;by&nbsp;a&nbsp;GobEncoder&nbsp;is&nbsp;stable&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5161412">//&nbsp;software&nbsp;evolves.&nbsp;&nbsp;For&nbsp;instance,&nbsp;it&nbsp;might&nbsp;make&nbsp;sense&nbsp;for&nbsp;GobEncode</span><br>
<span class="lineno"></span><span class="comment" id="5161482">//&nbsp;to&nbsp;include&nbsp;a&nbsp;version&nbsp;number&nbsp;in&nbsp;the&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="keyword" id="5161530">type</span>&nbsp;<span class="ident" id="5161535">GobEncoder</span>&nbsp;<span class="keyword" id="5161546">interface</span>&nbsp;<span class="op" id="5161556">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5161559">//&nbsp;GobEncode&nbsp;returns&nbsp;a&nbsp;byte&nbsp;slice&nbsp;representing&nbsp;the&nbsp;encoding&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5161627">//&nbsp;receiver&nbsp;for&nbsp;transmission&nbsp;to&nbsp;a&nbsp;GobDecoder,&nbsp;usually&nbsp;of&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5161694">//&nbsp;concrete&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5161713">GobEncode</span><span class="op" id="5161722">(</span><span class="op" id="5161723">)</span>&nbsp;<span class="op" id="5161725">(</span><span class="op" id="5161726">[</span><span class="op" id="5161727">]</span><span class="builtintype" id="5161728">byte</span><span class="op" id="5161732">,</span>&nbsp;<span class="builtintype" id="5161734">error</span><span class="op" id="5161739">)</span><br>
<span class="lineno"></span><span class="op" id="5161741">}</span><br>
<span class="lineno">800</span><br>
<span class="lineno"></span><span class="comment" id="5161744">//&nbsp;GobDecoder&nbsp;is&nbsp;the&nbsp;interface&nbsp;describing&nbsp;data&nbsp;that&nbsp;provides&nbsp;its&nbsp;own</span><br>
<span class="lineno"></span><span class="comment" id="5161813">//&nbsp;routine&nbsp;for&nbsp;decoding&nbsp;transmitted&nbsp;values&nbsp;sent&nbsp;by&nbsp;a&nbsp;GobEncoder.</span><br>
<span class="lineno"></span><span class="keyword" id="5161878">type</span>&nbsp;<span class="ident" id="5161883">GobDecoder</span>&nbsp;<span class="keyword" id="5161894">interface</span>&nbsp;<span class="op" id="5161904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5161907">//&nbsp;GobDecode&nbsp;overwrites&nbsp;the&nbsp;receiver,&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;pointer,</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5161971">//&nbsp;with&nbsp;the&nbsp;value&nbsp;represented&nbsp;by&nbsp;the&nbsp;byte&nbsp;slice,&nbsp;which&nbsp;was&nbsp;written</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5162039">//&nbsp;by&nbsp;GobEncode,&nbsp;usually&nbsp;for&nbsp;the&nbsp;same&nbsp;concrete&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162093">GobDecode</span><span class="op" id="5162102">(</span><span class="op" id="5162103">[</span><span class="op" id="5162104">]</span><span class="builtintype" id="5162105">byte</span><span class="op" id="5162109">)</span>&nbsp;<span class="builtintype" id="5162111">error</span><br>
<span class="lineno"></span><span class="op" id="5162117">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">810</span><span class="keyword" id="5162120">var</span>&nbsp;<span class="op" id="5162124">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162127">registerLock</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5162146"><a href="/encoding/gob/type.go.html#5138407">sync</a></span><span class="op" id="5162150">.</span><span class="ident" id="5162151">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162160">nameToConcreteType</span>&nbsp;<span class="op" id="5162179">=</span>&nbsp;<span class="builtinfunc" id="5162181">make</span><span class="op" id="5162185">(</span><span class="keyword" id="5162186">map</span><span class="op" id="5162189">[</span><span class="builtintype" id="5162190">string</span><span class="op" id="5162196">]</span><span class="ident" id="5162197"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5162204">.</span><span class="ident" id="5162205">Type</span><span class="op" id="5162209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162212">concreteTypeToName</span>&nbsp;<span class="op" id="5162231">=</span>&nbsp;<span class="builtinfunc" id="5162233">make</span><span class="op" id="5162237">(</span><span class="keyword" id="5162238">map</span><span class="op" id="5162241">[</span><span class="ident" id="5162242"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5162249">.</span><span class="ident" id="5162250">Type</span><span class="op" id="5162254">]</span><span class="builtintype" id="5162255">string</span><span class="op" id="5162261">)</span><br>
<span class="lineno"></span><span class="op" id="5162263">)</span><br>
<span class="lineno">815</span><br>
<span class="lineno"></span><span class="comment" id="5162266">//&nbsp;RegisterName&nbsp;is&nbsp;like&nbsp;Register&nbsp;but&nbsp;uses&nbsp;the&nbsp;provided&nbsp;name&nbsp;rather&nbsp;than&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5162342">//&nbsp;type&#39;s&nbsp;default.</span><br>
<span class="lineno"></span><span class="keyword" id="5162361">func</span>&nbsp;<span class="ident" id="5162366">RegisterName</span><span class="op" id="5162378">(</span><span class="ident" id="5162379">name</span>&nbsp;<span class="builtintype" id="5162384">string</span><span class="op" id="5162390">,</span>&nbsp;<span class="ident" id="5162392">value</span>&nbsp;<span class="keyword" id="5162398">interface</span><span class="op" id="5162407">{</span><span class="op" id="5162408">}</span><span class="op" id="5162409">)</span>&nbsp;<span class="op" id="5162411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5162414">if</span>&nbsp;<span class="ident" id="5162417"><a href="/encoding/gob/type.go.html#5162379">name</a></span>&nbsp;<span class="op" id="5162422">==</span>&nbsp;<span class="string" id="5162425">&#34;&#34;</span>&nbsp;<span class="op" id="5162428">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5162432">//&nbsp;reserved&nbsp;for&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5162454">panic</span><span class="op" id="5162459">(</span><span class="string" id="5162460">&#34;attempt&nbsp;to&nbsp;register&nbsp;empty&nbsp;name&#34;</span><span class="op" id="5162492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5162495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162498"><a href="/encoding/gob/type.go.html#5162127">registerLock</a></span><span class="op" id="5162510">.</span><span class="ident" id="5162511">Lock</span><span class="op" id="5162515">(</span><span class="op" id="5162516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5162519">defer</span>&nbsp;<span class="ident" id="5162525"><a href="/encoding/gob/type.go.html#5162127">registerLock</a></span><span class="op" id="5162537">.</span><span class="ident" id="5162538">Unlock</span><span class="op" id="5162544">(</span><span class="op" id="5162545">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5162548">ut</span>&nbsp;<span class="op" id="5162551">:=</span>&nbsp;<span class="ident" id="5162554"><a href="/encoding/gob/type.go.html#5143544">userType</a></span><span class="op" id="5162562">(</span><span class="ident" id="5162563"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5162570">.</span><span class="ident" id="5162571">TypeOf</span><span class="op" id="5162577">(</span><span class="ident" id="5162578"><a href="/encoding/gob/type.go.html#5162392">value</a></span><span class="op" id="5162583">)</span><span class="op" id="5162584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5162587">//&nbsp;Check&nbsp;for&nbsp;incompatible&nbsp;duplicates.&nbsp;The&nbsp;name&nbsp;must&nbsp;refer&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5162653">//&nbsp;same&nbsp;user&nbsp;type,&nbsp;and&nbsp;vice&nbsp;versa.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5162689">if</span>&nbsp;<span class="ident" id="5162692">t</span><span class="op" id="5162693">,</span>&nbsp;<span class="ident" id="5162695">ok</span>&nbsp;<span class="op" id="5162698">:=</span>&nbsp;<span class="ident" id="5162701"><a href="/encoding/gob/type.go.html#5162160">nameToConcreteType</a></span><span class="op" id="5162719">[</span><span class="ident" id="5162720"><a href="/encoding/gob/type.go.html#5162379">name</a></span><span class="op" id="5162724">]</span><span class="op" id="5162725">;</span>&nbsp;<span class="ident" id="5162727"><a href="/encoding/gob/type.go.html#5162695">ok</a></span>&nbsp;<span class="op" id="5162730">&amp;&amp;</span>&nbsp;<span class="ident" id="5162733"><a href="/encoding/gob/type.go.html#5162692">t</a></span>&nbsp;<span class="op" id="5162735">!=</span>&nbsp;<span class="ident" id="5162738"><a href="/encoding/gob/type.go.html#5162548">ut</a></span><span class="op" id="5162740">.</span><span class="ident" id="5162741">user</span>&nbsp;<span class="op" id="5162746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5162750">panic</span><span class="op" id="5162755">(</span><span class="ident" id="5162756"><a href="/encoding/gob/type.go.html#5138383">fmt</a></span><span class="op" id="5162759">.</span><span class="ident" id="5162760">Sprintf</span><span class="op" id="5162767">(</span><span class="string" id="5162768">&#34;gob:&nbsp;registering&nbsp;duplicate&nbsp;types&nbsp;for&nbsp;%q:&nbsp;%s&nbsp;!=&nbsp;%s&#34;</span><span class="op" id="5162819">,</span>&nbsp;<span class="ident" id="5162821"><a href="/encoding/gob/type.go.html#5162379">name</a></span><span class="op" id="5162825">,</span>&nbsp;<span class="ident" id="5162827"><a href="/encoding/gob/type.go.html#5162692">t</a></span><span class="op" id="5162828">,</span>&nbsp;<span class="ident" id="5162830"><a href="/encoding/gob/type.go.html#5162548">ut</a></span><span class="op" id="5162832">.</span><span class="ident" id="5162833">user</span><span class="op" id="5162837">)</span><span class="op" id="5162838">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5162841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5162844">if</span>&nbsp;<span class="ident" id="5162847">n</span><span class="op" id="5162848">,</span>&nbsp;<span class="ident" id="5162850">ok</span>&nbsp;<span class="op" id="5162853">:=</span>&nbsp;<span class="ident" id="5162856"><a href="/encoding/gob/type.go.html#5162212">concreteTypeToName</a></span><span class="op" id="5162874">[</span><span class="ident" id="5162875"><a href="/encoding/gob/type.go.html#5162548">ut</a></span><span class="op" id="5162877">.</span><span class="ident" id="5162878">base</span><span class="op" id="5162882">]</span><span class="op" id="5162883">;</span>&nbsp;<span class="ident" id="5162885"><a href="/encoding/gob/type.go.html#5162850">ok</a></span>&nbsp;<span class="op" id="5162888">&amp;&amp;</span>&nbsp;<span class="ident" id="5162891"><a href="/encoding/gob/type.go.html#5162847">n</a></span>&nbsp;<span class="op" id="5162893">!=</span>&nbsp;<span class="ident" id="5162896"><a href="/encoding/gob/type.go.html#5162379">name</a></span>&nbsp;<span class="op" id="5162901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5162905">panic</span><span class="op" id="5162910">(</span><span class="ident" id="5162911"><a href="/encoding/gob/type.go.html#5138383">fmt</a></span><span class="op" id="5162914">.</span><span class="ident" id="5162915">Sprintf</span><span class="op" id="5162922">(</span><span class="string" id="5162923">&#34;gob:&nbsp;registering&nbsp;duplicate&nbsp;names&nbsp;for&nbsp;%s:&nbsp;%q&nbsp;!=&nbsp;%q&#34;</span><span class="op" id="5162974">,</span>&nbsp;<span class="ident" id="5162976"><a href="/encoding/gob/type.go.html#5162548">ut</a></span><span class="op" id="5162978">.</span><span class="ident" id="5162979">user</span><span class="op" id="5162983">,</span>&nbsp;<span class="ident" id="5162985"><a href="/encoding/gob/type.go.html#5162847">n</a></span><span class="op" id="5162986">,</span>&nbsp;<span class="ident" id="5162988"><a href="/encoding/gob/type.go.html#5162379">name</a></span><span class="op" id="5162992">)</span><span class="op" id="5162993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5162996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5162999">//&nbsp;Store&nbsp;the&nbsp;name&nbsp;and&nbsp;type&nbsp;provided&nbsp;by&nbsp;the&nbsp;user....</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163052"><a href="/encoding/gob/type.go.html#5162160">nameToConcreteType</a></span><span class="op" id="5163070">[</span><span class="ident" id="5163071"><a href="/encoding/gob/type.go.html#5162379">name</a></span><span class="op" id="5163075">]</span>&nbsp;<span class="op" id="5163077">=</span>&nbsp;<span class="ident" id="5163079"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5163086">.</span><span class="ident" id="5163087">TypeOf</span><span class="op" id="5163093">(</span><span class="ident" id="5163094"><a href="/encoding/gob/type.go.html#5162392">value</a></span><span class="op" id="5163099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5163102">//&nbsp;but&nbsp;the&nbsp;flattened&nbsp;type&nbsp;in&nbsp;the&nbsp;type&nbsp;table,&nbsp;since&nbsp;that&#39;s&nbsp;what&nbsp;decode&nbsp;needs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163180"><a href="/encoding/gob/type.go.html#5162212">concreteTypeToName</a></span><span class="op" id="5163198">[</span><span class="ident" id="5163199"><a href="/encoding/gob/type.go.html#5162548">ut</a></span><span class="op" id="5163201">.</span><span class="ident" id="5163202">base</span><span class="op" id="5163206">]</span>&nbsp;<span class="op" id="5163208">=</span>&nbsp;<span class="ident" id="5163210"><a href="/encoding/gob/type.go.html#5162379">name</a></span><br>
<span class="lineno"></span><span class="op" id="5163215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="5163218">//&nbsp;Register&nbsp;records&nbsp;a&nbsp;type,&nbsp;identified&nbsp;by&nbsp;a&nbsp;value&nbsp;for&nbsp;that&nbsp;type,&nbsp;under&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="5163293">//&nbsp;internal&nbsp;type&nbsp;name.&nbsp;&nbsp;That&nbsp;name&nbsp;will&nbsp;identify&nbsp;the&nbsp;concrete&nbsp;type&nbsp;of&nbsp;a&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="5163370">//&nbsp;sent&nbsp;or&nbsp;received&nbsp;as&nbsp;an&nbsp;interface&nbsp;variable.&nbsp;&nbsp;Only&nbsp;types&nbsp;that&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5163441">//&nbsp;transferred&nbsp;as&nbsp;implementations&nbsp;of&nbsp;interface&nbsp;values&nbsp;need&nbsp;to&nbsp;be&nbsp;registered.</span><br>
<span class="lineno"></span><span class="comment" id="5163518">//&nbsp;Expecting&nbsp;to&nbsp;be&nbsp;used&nbsp;only&nbsp;during&nbsp;initialization,&nbsp;it&nbsp;panics&nbsp;if&nbsp;the&nbsp;mapping</span><br>
<span class="lineno">845</span><span class="comment" id="5163595">//&nbsp;between&nbsp;types&nbsp;and&nbsp;names&nbsp;is&nbsp;not&nbsp;a&nbsp;bijection.</span><br>
<span class="lineno"></span><span class="keyword" id="5163642">func</span>&nbsp;<span class="ident" id="5163647">Register</span><span class="op" id="5163655">(</span><span class="ident" id="5163656">value</span>&nbsp;<span class="keyword" id="5163662">interface</span><span class="op" id="5163671">{</span><span class="op" id="5163672">}</span><span class="op" id="5163673">)</span>&nbsp;<span class="op" id="5163675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5163678">//&nbsp;Default&nbsp;to&nbsp;printed&nbsp;representation&nbsp;for&nbsp;unnamed&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163734">rt</span>&nbsp;<span class="op" id="5163737">:=</span>&nbsp;<span class="ident" id="5163740"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5163747">.</span><span class="ident" id="5163748">TypeOf</span><span class="op" id="5163754">(</span><span class="ident" id="5163755"><a href="/encoding/gob/type.go.html#5163656">value</a></span><span class="op" id="5163760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163763">name</span>&nbsp;<span class="op" id="5163768">:=</span>&nbsp;<span class="ident" id="5163771"><a href="/encoding/gob/type.go.html#5163734">rt</a></span><span class="op" id="5163773">.</span><span class="ident" id="5163774">String</span><span class="op" id="5163780">(</span><span class="op" id="5163781">)</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5163785">//&nbsp;But&nbsp;for&nbsp;named&nbsp;types&nbsp;(or&nbsp;pointers&nbsp;to&nbsp;them),&nbsp;qualify&nbsp;with&nbsp;import&nbsp;path&nbsp;(but&nbsp;see&nbsp;inner&nbsp;comment).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5163882">//&nbsp;Dereference&nbsp;one&nbsp;pointer&nbsp;looking&nbsp;for&nbsp;a&nbsp;named&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5163936">star</span>&nbsp;<span class="op" id="5163941">:=</span>&nbsp;<span class="string" id="5163944">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5163948">if</span>&nbsp;<span class="ident" id="5163951"><a href="/encoding/gob/type.go.html#5163734">rt</a></span><span class="op" id="5163953">.</span><span class="ident" id="5163954">Name</span><span class="op" id="5163958">(</span><span class="op" id="5163959">)</span>&nbsp;<span class="op" id="5163961">==</span>&nbsp;<span class="string" id="5163964">&#34;&#34;</span>&nbsp;<span class="op" id="5163967">{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5163971">if</span>&nbsp;<span class="ident" id="5163974">pt</span>&nbsp;<span class="op" id="5163977">:=</span>&nbsp;<span class="ident" id="5163980"><a href="/encoding/gob/type.go.html#5163734">rt</a></span><span class="op" id="5163982">;</span>&nbsp;<span class="ident" id="5163984"><a href="/encoding/gob/type.go.html#5163974">pt</a></span><span class="op" id="5163986">.</span><span class="ident" id="5163987">Kind</span><span class="op" id="5163991">(</span><span class="op" id="5163992">)</span>&nbsp;<span class="op" id="5163994">==</span>&nbsp;<span class="ident" id="5163997"><a href="/encoding/gob/type.go.html#5138396">reflect</a></span><span class="op" id="5164004">.</span><span class="ident" id="5164005">Ptr</span>&nbsp;<span class="op" id="5164009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164014"><a href="/encoding/gob/type.go.html#5163936">star</a></span>&nbsp;<span class="op" id="5164019">=</span>&nbsp;<span class="string" id="5164021">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164028">//&nbsp;NOTE:&nbsp;The&nbsp;following&nbsp;line&nbsp;should&nbsp;be&nbsp;rt&nbsp;=&nbsp;pt.Elem()&nbsp;to&nbsp;implement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164097">//&nbsp;what&nbsp;the&nbsp;comment&nbsp;above&nbsp;claims,&nbsp;but&nbsp;fixing&nbsp;it&nbsp;would&nbsp;break&nbsp;compatibility</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164174">//&nbsp;with&nbsp;existing&nbsp;gobs.</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164200">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164206">//&nbsp;Given&nbsp;package&nbsp;p&nbsp;imported&nbsp;as&nbsp;&#34;full/p&#34;&nbsp;with&nbsp;these&nbsp;definitions:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164273">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164293">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;T1&nbsp;struct&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164326">//&nbsp;this&nbsp;table&nbsp;shows&nbsp;the&nbsp;intended&nbsp;and&nbsp;actual&nbsp;strings&nbsp;used&nbsp;by&nbsp;gob&nbsp;to</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164396">//&nbsp;name&nbsp;the&nbsp;types:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164418">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164424">//&nbsp;Type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Correct&nbsp;string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Actual&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164473">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164479">//&nbsp;T1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;full/p.T1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;full/p.T1</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164524">//&nbsp;*T1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*full/p.T1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*p.T1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164565">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5164571">//&nbsp;The&nbsp;missing&nbsp;full&nbsp;path&nbsp;cannot&nbsp;be&nbsp;fixed&nbsp;without&nbsp;breaking&nbsp;existing&nbsp;gob&nbsp;decoders.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164655"><a href="/encoding/gob/type.go.html#5163734">rt</a></span>&nbsp;<span class="op" id="5164658">=</span>&nbsp;<span class="ident" id="5164660"><a href="/encoding/gob/type.go.html#5163974">pt</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5164665">}</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5164668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164671">if</span>&nbsp;<span class="ident" id="5164674"><a href="/encoding/gob/type.go.html#5163734">rt</a></span><span class="op" id="5164676">.</span><span class="ident" id="5164677">Name</span><span class="op" id="5164681">(</span><span class="op" id="5164682">)</span>&nbsp;<span class="op" id="5164684">!=</span>&nbsp;<span class="string" id="5164687">&#34;&#34;</span>&nbsp;<span class="op" id="5164690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5164694">if</span>&nbsp;<span class="ident" id="5164697"><a href="/encoding/gob/type.go.html#5163734">rt</a></span><span class="op" id="5164699">.</span><span class="ident" id="5164700">PkgPath</span><span class="op" id="5164707">(</span><span class="op" id="5164708">)</span>&nbsp;<span class="op" id="5164710">==</span>&nbsp;<span class="string" id="5164713">&#34;&#34;</span>&nbsp;<span class="op" id="5164716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164721"><a href="/encoding/gob/type.go.html#5163763">name</a></span>&nbsp;<span class="op" id="5164726">=</span>&nbsp;<span class="ident" id="5164728"><a href="/encoding/gob/type.go.html#5163936">star</a></span>&nbsp;<span class="op" id="5164733">+</span>&nbsp;<span class="ident" id="5164735"><a href="/encoding/gob/type.go.html#5163734">rt</a></span><span class="op" id="5164737">.</span><span class="ident" id="5164738">Name</span><span class="op" id="5164742">(</span><span class="op" id="5164743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5164747">}</span>&nbsp;<span class="keyword" id="5164749">else</span>&nbsp;<span class="op" id="5164754">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164759"><a href="/encoding/gob/type.go.html#5163763">name</a></span>&nbsp;<span class="op" id="5164764">=</span>&nbsp;<span class="ident" id="5164766"><a href="/encoding/gob/type.go.html#5163936">star</a></span>&nbsp;<span class="op" id="5164771">+</span>&nbsp;<span class="ident" id="5164773"><a href="/encoding/gob/type.go.html#5163734">rt</a></span><span class="op" id="5164775">.</span><span class="ident" id="5164776">PkgPath</span><span class="op" id="5164783">(</span><span class="op" id="5164784">)</span>&nbsp;<span class="op" id="5164786">+</span>&nbsp;<span class="string" id="5164788">&#34;.&#34;</span>&nbsp;<span class="op" id="5164792">+</span>&nbsp;<span class="ident" id="5164794"><a href="/encoding/gob/type.go.html#5163734">rt</a></span><span class="op" id="5164796">.</span><span class="ident" id="5164797">Name</span><span class="op" id="5164801">(</span><span class="op" id="5164802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5164806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5164809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164813"><a href="/encoding/gob/type.go.html#5162366">RegisterName</a></span><span class="op" id="5164825">(</span><span class="ident" id="5164826"><a href="/encoding/gob/type.go.html#5163763">name</a></span><span class="op" id="5164830">,</span>&nbsp;<span class="ident" id="5164832"><a href="/encoding/gob/type.go.html#5163656">value</a></span><span class="op" id="5164837">)</span><br>
<span class="lineno">885</span><span class="op" id="5164839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5164842">func</span>&nbsp;<span class="ident" id="5164847">registerBasics</span><span class="op" id="5164861">(</span><span class="op" id="5164862">)</span>&nbsp;<span class="op" id="5164864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164867"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5164875">(</span><span class="builtintype" id="5164876">int</span><span class="op" id="5164879">(</span><span class="num" id="5164880">0</span><span class="op" id="5164881">)</span><span class="op" id="5164882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164885"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5164893">(</span><span class="builtintype" id="5164894">int8</span><span class="op" id="5164898">(</span><span class="num" id="5164899">0</span><span class="op" id="5164900">)</span><span class="op" id="5164901">)</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164904"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5164912">(</span><span class="builtintype" id="5164913">int16</span><span class="op" id="5164918">(</span><span class="num" id="5164919">0</span><span class="op" id="5164920">)</span><span class="op" id="5164921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164924"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5164932">(</span><span class="builtintype" id="5164933">int32</span><span class="op" id="5164938">(</span><span class="num" id="5164939">0</span><span class="op" id="5164940">)</span><span class="op" id="5164941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164944"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5164952">(</span><span class="ident" id="5164953">int64</span><span class="op" id="5164958">(</span><span class="num" id="5164959">0</span><span class="op" id="5164960">)</span><span class="op" id="5164961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164964"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5164972">(</span><span class="builtintype" id="5164973">uint</span><span class="op" id="5164977">(</span><span class="num" id="5164978">0</span><span class="op" id="5164979">)</span><span class="op" id="5164980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5164983"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5164991">(</span><span class="builtintype" id="5164992">uint8</span><span class="op" id="5164997">(</span><span class="num" id="5164998">0</span><span class="op" id="5164999">)</span><span class="op" id="5165000">)</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165003"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165011">(</span><span class="builtintype" id="5165012">uint16</span><span class="op" id="5165018">(</span><span class="num" id="5165019">0</span><span class="op" id="5165020">)</span><span class="op" id="5165021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165024"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165032">(</span><span class="builtintype" id="5165033">uint32</span><span class="op" id="5165039">(</span><span class="num" id="5165040">0</span><span class="op" id="5165041">)</span><span class="op" id="5165042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165045"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165053">(</span><span class="ident" id="5165054">uint64</span><span class="op" id="5165060">(</span><span class="num" id="5165061">0</span><span class="op" id="5165062">)</span><span class="op" id="5165063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165066"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165074">(</span><span class="builtintype" id="5165075">float32</span><span class="op" id="5165082">(</span><span class="num" id="5165083">0</span><span class="op" id="5165084">)</span><span class="op" id="5165085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165088"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165096">(</span><span class="builtintype" id="5165097">float64</span><span class="op" id="5165104">(</span><span class="num" id="5165105">0</span><span class="op" id="5165106">)</span><span class="op" id="5165107">)</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165110"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165118">(</span><span class="builtintype" id="5165119">complex64</span><span class="op" id="5165128">(</span><span class="num" id="5165129">0i</span><span class="op" id="5165131">)</span><span class="op" id="5165132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165135"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165143">(</span><span class="builtintype" id="5165144">complex128</span><span class="op" id="5165154">(</span><span class="num" id="5165155">0i</span><span class="op" id="5165157">)</span><span class="op" id="5165158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165161"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165169">(</span><span class="builtintype" id="5165170">uintptr</span><span class="op" id="5165177">(</span><span class="num" id="5165178">0</span><span class="op" id="5165179">)</span><span class="op" id="5165180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165183"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165191">(</span><span class="ident" id="5165192">false</span><span class="op" id="5165197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165200"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165208">(</span><span class="string" id="5165209">&#34;&#34;</span><span class="op" id="5165211">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165214"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165222">(</span><span class="op" id="5165223">[</span><span class="op" id="5165224">]</span><span class="builtintype" id="5165225">byte</span><span class="op" id="5165229">(</span><span class="ident" id="5165230">nil</span><span class="op" id="5165233">)</span><span class="op" id="5165234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165237"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165245">(</span><span class="op" id="5165246">[</span><span class="op" id="5165247">]</span><span class="builtintype" id="5165248">int</span><span class="op" id="5165251">(</span><span class="ident" id="5165252">nil</span><span class="op" id="5165255">)</span><span class="op" id="5165256">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165259"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165267">(</span><span class="op" id="5165268">[</span><span class="op" id="5165269">]</span><span class="builtintype" id="5165270">int8</span><span class="op" id="5165274">(</span><span class="ident" id="5165275">nil</span><span class="op" id="5165278">)</span><span class="op" id="5165279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165282"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165290">(</span><span class="op" id="5165291">[</span><span class="op" id="5165292">]</span><span class="builtintype" id="5165293">int16</span><span class="op" id="5165298">(</span><span class="ident" id="5165299">nil</span><span class="op" id="5165302">)</span><span class="op" id="5165303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165306"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165314">(</span><span class="op" id="5165315">[</span><span class="op" id="5165316">]</span><span class="builtintype" id="5165317">int32</span><span class="op" id="5165322">(</span><span class="ident" id="5165323">nil</span><span class="op" id="5165326">)</span><span class="op" id="5165327">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165330"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165338">(</span><span class="op" id="5165339">[</span><span class="op" id="5165340">]</span><span class="ident" id="5165341">int64</span><span class="op" id="5165346">(</span><span class="ident" id="5165347">nil</span><span class="op" id="5165350">)</span><span class="op" id="5165351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165354"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165362">(</span><span class="op" id="5165363">[</span><span class="op" id="5165364">]</span><span class="builtintype" id="5165365">uint</span><span class="op" id="5165369">(</span><span class="ident" id="5165370">nil</span><span class="op" id="5165373">)</span><span class="op" id="5165374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165377"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165385">(</span><span class="op" id="5165386">[</span><span class="op" id="5165387">]</span><span class="builtintype" id="5165388">uint8</span><span class="op" id="5165393">(</span><span class="ident" id="5165394">nil</span><span class="op" id="5165397">)</span><span class="op" id="5165398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165401"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165409">(</span><span class="op" id="5165410">[</span><span class="op" id="5165411">]</span><span class="builtintype" id="5165412">uint16</span><span class="op" id="5165418">(</span><span class="ident" id="5165419">nil</span><span class="op" id="5165422">)</span><span class="op" id="5165423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165426"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165434">(</span><span class="op" id="5165435">[</span><span class="op" id="5165436">]</span><span class="builtintype" id="5165437">uint32</span><span class="op" id="5165443">(</span><span class="ident" id="5165444">nil</span><span class="op" id="5165447">)</span><span class="op" id="5165448">)</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165451"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165459">(</span><span class="op" id="5165460">[</span><span class="op" id="5165461">]</span><span class="ident" id="5165462">uint64</span><span class="op" id="5165468">(</span><span class="ident" id="5165469">nil</span><span class="op" id="5165472">)</span><span class="op" id="5165473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165476"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165484">(</span><span class="op" id="5165485">[</span><span class="op" id="5165486">]</span><span class="builtintype" id="5165487">float32</span><span class="op" id="5165494">(</span><span class="ident" id="5165495">nil</span><span class="op" id="5165498">)</span><span class="op" id="5165499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165502"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165510">(</span><span class="op" id="5165511">[</span><span class="op" id="5165512">]</span><span class="builtintype" id="5165513">float64</span><span class="op" id="5165520">(</span><span class="ident" id="5165521">nil</span><span class="op" id="5165524">)</span><span class="op" id="5165525">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165528"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165536">(</span><span class="op" id="5165537">[</span><span class="op" id="5165538">]</span><span class="builtintype" id="5165539">complex64</span><span class="op" id="5165548">(</span><span class="ident" id="5165549">nil</span><span class="op" id="5165552">)</span><span class="op" id="5165553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165556"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165564">(</span><span class="op" id="5165565">[</span><span class="op" id="5165566">]</span><span class="builtintype" id="5165567">complex128</span><span class="op" id="5165577">(</span><span class="ident" id="5165578">nil</span><span class="op" id="5165581">)</span><span class="op" id="5165582">)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165585"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165593">(</span><span class="op" id="5165594">[</span><span class="op" id="5165595">]</span><span class="builtintype" id="5165596">uintptr</span><span class="op" id="5165603">(</span><span class="ident" id="5165604">nil</span><span class="op" id="5165607">)</span><span class="op" id="5165608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165611"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165619">(</span><span class="op" id="5165620">[</span><span class="op" id="5165621">]</span><span class="builtintype" id="5165622">bool</span><span class="op" id="5165626">(</span><span class="ident" id="5165627">nil</span><span class="op" id="5165630">)</span><span class="op" id="5165631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5165634"><a href="/encoding/gob/type.go.html#5163647">Register</a></span><span class="op" id="5165642">(</span><span class="op" id="5165643">[</span><span class="op" id="5165644">]</span><span class="builtintype" id="5165645">string</span><span class="op" id="5165651">(</span><span class="ident" id="5165652">nil</span><span class="op" id="5165655">)</span><span class="op" id="5165656">)</span><br>
<span class="lineno"></span><span class="op" id="5165658">}</span>
</div>
</body>
</html>
