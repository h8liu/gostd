<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html" class="current">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4347394">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4347449">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4347503">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4347554">package</span>&nbsp;<span class="ident" id="4347562">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4347568">import</span>&nbsp;<span class="op" id="4347575">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4347578">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span><span class="op" id="4347593">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="4347596">//&nbsp;CertPool&nbsp;is&nbsp;a&nbsp;set&nbsp;of&nbsp;certificates.</span><br>
<span class="lineno"></span><span class="keyword" id="4347634">type</span>&nbsp;<span class="ident" id="4347639">CertPool</span>&nbsp;<span class="keyword" id="4347648">struct</span>&nbsp;<span class="op" id="4347655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4347658">bySubjectKeyId</span>&nbsp;<span class="keyword" id="4347673">map</span><span class="op" id="4347676">[</span><span class="builtintype" id="4347677">string</span><span class="op" id="4347683">]</span><span class="op" id="4347684">[</span><span class="op" id="4347685">]</span><span class="builtintype" id="4347686">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4347691">byName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4347706">map</span><span class="op" id="4347709">[</span><span class="builtintype" id="4347710">string</span><span class="op" id="4347716">]</span><span class="op" id="4347717">[</span><span class="op" id="4347718">]</span><span class="builtintype" id="4347719">int</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4347724">certs</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4347739">[</span><span class="op" id="4347740">]</span><span class="op" id="4347741">*</span><span class="ident" id="4347742">Certificate</span><br>
<span class="lineno"></span><span class="op" id="4347754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4347757">//&nbsp;NewCertPool&nbsp;returns&nbsp;a&nbsp;new,&nbsp;empty&nbsp;CertPool.</span><br>
<span class="lineno"></span><span class="keyword" id="4347803">func</span>&nbsp;<span class="ident" id="4347808">NewCertPool</span><span class="op" id="4347819">(</span><span class="op" id="4347820">)</span>&nbsp;<span class="op" id="4347822">*</span><span class="ident" id="4347823">CertPool</span>&nbsp;<span class="op" id="4347832">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4347835">return</span>&nbsp;<span class="op" id="4347842">&amp;</span><span class="ident" id="4347843">CertPool</span><span class="op" id="4347851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4347855">make</span><span class="op" id="4347859">(</span><span class="keyword" id="4347860">map</span><span class="op" id="4347863">[</span><span class="builtintype" id="4347864">string</span><span class="op" id="4347870">]</span><span class="op" id="4347871">[</span><span class="op" id="4347872">]</span><span class="builtintype" id="4347873">int</span><span class="op" id="4347876">)</span><span class="op" id="4347877">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4347881">make</span><span class="op" id="4347885">(</span><span class="keyword" id="4347886">map</span><span class="op" id="4347889">[</span><span class="builtintype" id="4347890">string</span><span class="op" id="4347896">]</span><span class="op" id="4347897">[</span><span class="op" id="4347898">]</span><span class="builtintype" id="4347899">int</span><span class="op" id="4347902">)</span><span class="op" id="4347903">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4347907">nil</span><span class="op" id="4347910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4347913">}</span><br>
<span class="lineno">25</span><span class="op" id="4347915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4347918">//&nbsp;findVerifiedParents&nbsp;attempts&nbsp;to&nbsp;find&nbsp;certificates&nbsp;in&nbsp;s&nbsp;which&nbsp;have&nbsp;signed&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4347998">//&nbsp;given&nbsp;certificate.&nbsp;If&nbsp;any&nbsp;candidates&nbsp;were&nbsp;rejected&nbsp;then&nbsp;errCert&nbsp;will&nbsp;be&nbsp;set</span><br>
<span class="lineno"></span><span class="comment" id="4348077">//&nbsp;to&nbsp;one&nbsp;of&nbsp;them,&nbsp;arbitrarily,&nbsp;and&nbsp;err&nbsp;will&nbsp;contain&nbsp;the&nbsp;reason&nbsp;that&nbsp;it&nbsp;was</span><br>
<span class="lineno">30</span><span class="comment" id="4348153">//&nbsp;rejected.</span><br>
<span class="lineno"></span><span class="keyword" id="4348166">func</span>&nbsp;<span class="op" id="4348171">(</span><span class="ident" id="4348172">s</span>&nbsp;<span class="op" id="4348174">*</span><span class="ident" id="4348175">CertPool</span><span class="op" id="4348183">)</span>&nbsp;<span class="ident" id="4348185">findVerifiedParents</span><span class="op" id="4348204">(</span><span class="ident" id="4348205">cert</span>&nbsp;<span class="op" id="4348210">*</span><span class="ident" id="4348211">Certificate</span><span class="op" id="4348222">)</span>&nbsp;<span class="op" id="4348224">(</span><span class="ident" id="4348225">parents</span>&nbsp;<span class="op" id="4348233">[</span><span class="op" id="4348234">]</span><span class="builtintype" id="4348235">int</span><span class="op" id="4348238">,</span>&nbsp;<span class="ident" id="4348240">errCert</span>&nbsp;<span class="op" id="4348248">*</span><span class="ident" id="4348249">Certificate</span><span class="op" id="4348260">,</span>&nbsp;<span class="ident" id="4348262">err</span>&nbsp;<span class="builtintype" id="4348266">error</span><span class="op" id="4348271">)</span>&nbsp;<span class="op" id="4348273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4348276">if</span>&nbsp;<span class="ident" id="4348279">s</span>&nbsp;<span class="op" id="4348281">==</span>&nbsp;<span class="builtintype" id="4348284">nil</span>&nbsp;<span class="op" id="4348288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4348292">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4348300">}</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4348303">var</span>&nbsp;<span class="ident" id="4348307">candidates</span>&nbsp;<span class="op" id="4348318">[</span><span class="op" id="4348319">]</span><span class="builtintype" id="4348320">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4348326">if</span>&nbsp;<span class="builtinfunc" id="4348329">len</span><span class="op" id="4348332">(</span><span class="ident" id="4348333">cert</span><span class="op" id="4348337">.</span><span class="ident" id="4348338">AuthorityKeyId</span><span class="op" id="4348352">)</span>&nbsp;<span class="op" id="4348354">&gt;</span>&nbsp;<span class="num" id="4348356">0</span>&nbsp;<span class="op" id="4348358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4348362">candidates</span>&nbsp;<span class="op" id="4348373">=</span>&nbsp;<span class="ident" id="4348375">s</span><span class="op" id="4348376">.</span><span class="ident" id="4348377">bySubjectKeyId</span><span class="op" id="4348391">[</span><span class="builtintype" id="4348392">string</span><span class="op" id="4348398">(</span><span class="ident" id="4348399">cert</span><span class="op" id="4348403">.</span><span class="ident" id="4348404">AuthorityKeyId</span><span class="op" id="4348418">)</span><span class="op" id="4348419">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4348422">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4348425">if</span>&nbsp;<span class="builtinfunc" id="4348428">len</span><span class="op" id="4348431">(</span><span class="ident" id="4348432">candidates</span><span class="op" id="4348442">)</span>&nbsp;<span class="op" id="4348444">==</span>&nbsp;<span class="num" id="4348447">0</span>&nbsp;<span class="op" id="4348449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4348453">candidates</span>&nbsp;<span class="op" id="4348464">=</span>&nbsp;<span class="ident" id="4348466">s</span><span class="op" id="4348467">.</span><span class="ident" id="4348468">byName</span><span class="op" id="4348474">[</span><span class="builtintype" id="4348475">string</span><span class="op" id="4348481">(</span><span class="ident" id="4348482">cert</span><span class="op" id="4348486">.</span><span class="ident" id="4348487">RawIssuer</span><span class="op" id="4348496">)</span><span class="op" id="4348497">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4348500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4348504">for</span>&nbsp;<span class="ident" id="4348508">_</span><span class="op" id="4348509">,</span>&nbsp;<span class="ident" id="4348511">c</span>&nbsp;<span class="op" id="4348513">:=</span>&nbsp;<span class="keyword" id="4348516">range</span>&nbsp;<span class="ident" id="4348522">candidates</span>&nbsp;<span class="op" id="4348533">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4348537">if</span>&nbsp;<span class="ident" id="4348540">err</span>&nbsp;<span class="op" id="4348544">=</span>&nbsp;<span class="ident" id="4348546">cert</span><span class="op" id="4348550">.</span><span class="ident" id="4348551">CheckSignatureFrom</span><span class="op" id="4348569">(</span><span class="ident" id="4348570">s</span><span class="op" id="4348571">.</span><span class="ident" id="4348572">certs</span><span class="op" id="4348577">[</span><span class="ident" id="4348578">c</span><span class="op" id="4348579">]</span><span class="op" id="4348580">)</span><span class="op" id="4348581">;</span>&nbsp;<span class="ident" id="4348583">err</span>&nbsp;<span class="op" id="4348587">==</span>&nbsp;<span class="builtintype" id="4348590">nil</span>&nbsp;<span class="op" id="4348594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4348599">parents</span>&nbsp;<span class="op" id="4348607">=</span>&nbsp;<span class="builtinfunc" id="4348609">append</span><span class="op" id="4348615">(</span><span class="ident" id="4348616">parents</span><span class="op" id="4348623">,</span>&nbsp;<span class="ident" id="4348625">c</span><span class="op" id="4348626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4348630">}</span>&nbsp;<span class="keyword" id="4348632">else</span>&nbsp;<span class="op" id="4348637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4348642">errCert</span>&nbsp;<span class="op" id="4348650">=</span>&nbsp;<span class="ident" id="4348652">s</span><span class="op" id="4348653">.</span><span class="ident" id="4348654">certs</span><span class="op" id="4348659">[</span><span class="ident" id="4348660">c</span><span class="op" id="4348661">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4348665">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4348668">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4348672">return</span><br>
<span class="lineno"></span><span class="op" id="4348679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="4348682">//&nbsp;AddCert&nbsp;adds&nbsp;a&nbsp;certificate&nbsp;to&nbsp;a&nbsp;pool.</span><br>
<span class="lineno"></span><span class="keyword" id="4348723">func</span>&nbsp;<span class="op" id="4348728">(</span><span class="ident" id="4348729">s</span>&nbsp;<span class="op" id="4348731">*</span><span class="ident" id="4348732">CertPool</span><span class="op" id="4348740">)</span>&nbsp;<span class="ident" id="4348742">AddCert</span><span class="op" id="4348749">(</span><span class="ident" id="4348750">cert</span>&nbsp;<span class="op" id="4348755">*</span><span class="ident" id="4348756">Certificate</span><span class="op" id="4348767">)</span>&nbsp;<span class="op" id="4348769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4348772">if</span>&nbsp;<span class="ident" id="4348775">cert</span>&nbsp;<span class="op" id="4348780">==</span>&nbsp;<span class="builtintype" id="4348783">nil</span>&nbsp;<span class="op" id="4348787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4348791">panic</span><span class="op" id="4348796">(</span><span class="string" id="4348797">&#34;adding&nbsp;nil&nbsp;Certificate&nbsp;to&nbsp;CertPool&#34;</span><span class="op" id="4348833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4348836">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4348840">//&nbsp;Check&nbsp;that&nbsp;the&nbsp;certificate&nbsp;isn&#39;t&nbsp;being&nbsp;added&nbsp;twice.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4348896">for</span>&nbsp;<span class="ident" id="4348900">_</span><span class="op" id="4348901">,</span>&nbsp;<span class="ident" id="4348903">c</span>&nbsp;<span class="op" id="4348905">:=</span>&nbsp;<span class="keyword" id="4348908">range</span>&nbsp;<span class="ident" id="4348914">s</span><span class="op" id="4348915">.</span><span class="ident" id="4348916">certs</span>&nbsp;<span class="op" id="4348922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4348926">if</span>&nbsp;<span class="ident" id="4348929">c</span><span class="op" id="4348930">.</span><span class="ident" id="4348931">Equal</span><span class="op" id="4348936">(</span><span class="ident" id="4348937">cert</span><span class="op" id="4348941">)</span>&nbsp;<span class="op" id="4348943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4348948">return</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4348957">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4348960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4348964">n</span>&nbsp;<span class="op" id="4348966">:=</span>&nbsp;<span class="builtinfunc" id="4348969">len</span><span class="op" id="4348972">(</span><span class="ident" id="4348973">s</span><span class="op" id="4348974">.</span><span class="ident" id="4348975">certs</span><span class="op" id="4348980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4348983">s</span><span class="op" id="4348984">.</span><span class="ident" id="4348985">certs</span>&nbsp;<span class="op" id="4348991">=</span>&nbsp;<span class="builtinfunc" id="4348993">append</span><span class="op" id="4348999">(</span><span class="ident" id="4349000">s</span><span class="op" id="4349001">.</span><span class="ident" id="4349002">certs</span><span class="op" id="4349007">,</span>&nbsp;<span class="ident" id="4349009">cert</span><span class="op" id="4349013">)</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4349017">if</span>&nbsp;<span class="builtinfunc" id="4349020">len</span><span class="op" id="4349023">(</span><span class="ident" id="4349024">cert</span><span class="op" id="4349028">.</span><span class="ident" id="4349029">SubjectKeyId</span><span class="op" id="4349041">)</span>&nbsp;<span class="op" id="4349043">&gt;</span>&nbsp;<span class="num" id="4349045">0</span>&nbsp;<span class="op" id="4349047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4349051">keyId</span>&nbsp;<span class="op" id="4349057">:=</span>&nbsp;<span class="builtintype" id="4349060">string</span><span class="op" id="4349066">(</span><span class="ident" id="4349067">cert</span><span class="op" id="4349071">.</span><span class="ident" id="4349072">SubjectKeyId</span><span class="op" id="4349084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4349088">s</span><span class="op" id="4349089">.</span><span class="ident" id="4349090">bySubjectKeyId</span><span class="op" id="4349104">[</span><span class="ident" id="4349105">keyId</span><span class="op" id="4349110">]</span>&nbsp;<span class="op" id="4349112">=</span>&nbsp;<span class="builtinfunc" id="4349114">append</span><span class="op" id="4349120">(</span><span class="ident" id="4349121">s</span><span class="op" id="4349122">.</span><span class="ident" id="4349123">bySubjectKeyId</span><span class="op" id="4349137">[</span><span class="ident" id="4349138">keyId</span><span class="op" id="4349143">]</span><span class="op" id="4349144">,</span>&nbsp;<span class="ident" id="4349146">n</span><span class="op" id="4349147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4349150">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4349153">name</span>&nbsp;<span class="op" id="4349158">:=</span>&nbsp;<span class="builtintype" id="4349161">string</span><span class="op" id="4349167">(</span><span class="ident" id="4349168">cert</span><span class="op" id="4349172">.</span><span class="ident" id="4349173">RawSubject</span><span class="op" id="4349183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4349186">s</span><span class="op" id="4349187">.</span><span class="ident" id="4349188">byName</span><span class="op" id="4349194">[</span><span class="ident" id="4349195">name</span><span class="op" id="4349199">]</span>&nbsp;<span class="op" id="4349201">=</span>&nbsp;<span class="builtinfunc" id="4349203">append</span><span class="op" id="4349209">(</span><span class="ident" id="4349210">s</span><span class="op" id="4349211">.</span><span class="ident" id="4349212">byName</span><span class="op" id="4349218">[</span><span class="ident" id="4349219">name</span><span class="op" id="4349223">]</span><span class="op" id="4349224">,</span>&nbsp;<span class="ident" id="4349226">n</span><span class="op" id="4349227">)</span><br>
<span class="lineno"></span><span class="op" id="4349229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4349232">//&nbsp;AppendCertsFromPEM&nbsp;attempts&nbsp;to&nbsp;parse&nbsp;a&nbsp;series&nbsp;of&nbsp;PEM&nbsp;encoded&nbsp;certificates.</span><br>
<span class="lineno">80</span><span class="comment" id="4349310">//&nbsp;It&nbsp;appends&nbsp;any&nbsp;certificates&nbsp;found&nbsp;to&nbsp;s&nbsp;and&nbsp;returns&nbsp;true&nbsp;if&nbsp;any&nbsp;certificates</span><br>
<span class="lineno"></span><span class="comment" id="4349389">//&nbsp;were&nbsp;successfully&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="comment" id="4349418">//</span><br>
<span class="lineno"></span><span class="comment" id="4349421">//&nbsp;On&nbsp;many&nbsp;Linux&nbsp;systems,&nbsp;/etc/ssl/cert.pem&nbsp;will&nbsp;contain&nbsp;the&nbsp;system&nbsp;wide&nbsp;set</span><br>
<span class="lineno"></span><span class="comment" id="4349498">//&nbsp;of&nbsp;root&nbsp;CAs&nbsp;in&nbsp;a&nbsp;format&nbsp;suitable&nbsp;for&nbsp;this&nbsp;function.</span><br>
<span class="lineno">85</span><span class="keyword" id="4349553">func</span>&nbsp;<span class="op" id="4349558">(</span><span class="ident" id="4349559">s</span>&nbsp;<span class="op" id="4349561">*</span><span class="ident" id="4349562">CertPool</span><span class="op" id="4349570">)</span>&nbsp;<span class="ident" id="4349572">AppendCertsFromPEM</span><span class="op" id="4349590">(</span><span class="ident" id="4349591">pemCerts</span>&nbsp;<span class="op" id="4349600">[</span><span class="op" id="4349601">]</span><span class="builtintype" id="4349602">byte</span><span class="op" id="4349606">)</span>&nbsp;<span class="op" id="4349608">(</span><span class="ident" id="4349609">ok</span>&nbsp;<span class="builtintype" id="4349612">bool</span><span class="op" id="4349616">)</span>&nbsp;<span class="op" id="4349618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4349621">for</span>&nbsp;<span class="builtinfunc" id="4349625">len</span><span class="op" id="4349628">(</span><span class="ident" id="4349629">pemCerts</span><span class="op" id="4349637">)</span>&nbsp;<span class="op" id="4349639">&gt;</span>&nbsp;<span class="num" id="4349641">0</span>&nbsp;<span class="op" id="4349643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4349647">var</span>&nbsp;<span class="ident" id="4349651">block</span>&nbsp;<span class="op" id="4349657">*</span><span class="ident" id="4349658">pem</span><span class="op" id="4349661">.</span><span class="ident" id="4349662">Block</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4349670">block</span><span class="op" id="4349675">,</span>&nbsp;<span class="ident" id="4349677">pemCerts</span>&nbsp;<span class="op" id="4349686">=</span>&nbsp;<span class="ident" id="4349688">pem</span><span class="op" id="4349691">.</span><span class="ident" id="4349692">Decode</span><span class="op" id="4349698">(</span><span class="ident" id="4349699">pemCerts</span><span class="op" id="4349707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4349711">if</span>&nbsp;<span class="ident" id="4349714">block</span>&nbsp;<span class="op" id="4349720">==</span>&nbsp;<span class="builtintype" id="4349723">nil</span>&nbsp;<span class="op" id="4349727">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4349732">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4349740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4349744">if</span>&nbsp;<span class="ident" id="4349747">block</span><span class="op" id="4349752">.</span><span class="ident" id="4349753">Type</span>&nbsp;<span class="op" id="4349758">!=</span>&nbsp;<span class="string" id="4349761">&#34;CERTIFICATE&#34;</span>&nbsp;<span class="op" id="4349775">||</span>&nbsp;<span class="builtinfunc" id="4349778">len</span><span class="op" id="4349781">(</span><span class="ident" id="4349782">block</span><span class="op" id="4349787">.</span><span class="ident" id="4349788">Headers</span><span class="op" id="4349795">)</span>&nbsp;<span class="op" id="4349797">!=</span>&nbsp;<span class="num" id="4349800">0</span>&nbsp;<span class="op" id="4349802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4349807">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4349818">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4349823">cert</span><span class="op" id="4349827">,</span>&nbsp;<span class="ident" id="4349829">err</span>&nbsp;<span class="op" id="4349833">:=</span>&nbsp;<span class="ident" id="4349836">ParseCertificate</span><span class="op" id="4349852">(</span><span class="ident" id="4349853">block</span><span class="op" id="4349858">.</span><span class="ident" id="4349859">Bytes</span><span class="op" id="4349864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4349868">if</span>&nbsp;<span class="ident" id="4349871">err</span>&nbsp;<span class="op" id="4349875">!=</span>&nbsp;<span class="builtintype" id="4349878">nil</span>&nbsp;<span class="op" id="4349882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4349887">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4349898">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4349903">s</span><span class="op" id="4349904">.</span><span class="ident" id="4349905">AddCert</span><span class="op" id="4349912">(</span><span class="ident" id="4349913">cert</span><span class="op" id="4349917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4349921">ok</span>&nbsp;<span class="op" id="4349924">=</span>&nbsp;<span class="builtintype" id="4349926">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4349932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4349936">return</span><br>
<span class="lineno"></span><span class="op" id="4349943">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4349946">//&nbsp;Subjects&nbsp;returns&nbsp;a&nbsp;list&nbsp;of&nbsp;the&nbsp;DER-encoded&nbsp;subjects&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4350004">//&nbsp;all&nbsp;of&nbsp;the&nbsp;certificates&nbsp;in&nbsp;the&nbsp;pool.</span><br>
<span class="lineno">110</span><span class="keyword" id="4350044">func</span>&nbsp;<span class="op" id="4350049">(</span><span class="ident" id="4350050">s</span>&nbsp;<span class="op" id="4350052">*</span><span class="ident" id="4350053">CertPool</span><span class="op" id="4350061">)</span>&nbsp;<span class="ident" id="4350063">Subjects</span><span class="op" id="4350071">(</span><span class="op" id="4350072">)</span>&nbsp;<span class="op" id="4350074">(</span><span class="ident" id="4350075">res</span>&nbsp;<span class="op" id="4350079">[</span><span class="op" id="4350080">]</span><span class="op" id="4350081">[</span><span class="op" id="4350082">]</span><span class="builtintype" id="4350083">byte</span><span class="op" id="4350087">)</span>&nbsp;<span class="op" id="4350089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4350092">res</span>&nbsp;<span class="op" id="4350096">=</span>&nbsp;<span class="builtinfunc" id="4350098">make</span><span class="op" id="4350102">(</span><span class="op" id="4350103">[</span><span class="op" id="4350104">]</span><span class="op" id="4350105">[</span><span class="op" id="4350106">]</span><span class="builtintype" id="4350107">byte</span><span class="op" id="4350111">,</span>&nbsp;<span class="builtinfunc" id="4350113">len</span><span class="op" id="4350116">(</span><span class="ident" id="4350117">s</span><span class="op" id="4350118">.</span><span class="ident" id="4350119">certs</span><span class="op" id="4350124">)</span><span class="op" id="4350125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4350128">for</span>&nbsp;<span class="ident" id="4350132">i</span><span class="op" id="4350133">,</span>&nbsp;<span class="ident" id="4350135">c</span>&nbsp;<span class="op" id="4350137">:=</span>&nbsp;<span class="keyword" id="4350140">range</span>&nbsp;<span class="ident" id="4350146">s</span><span class="op" id="4350147">.</span><span class="ident" id="4350148">certs</span>&nbsp;<span class="op" id="4350154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4350158">res</span><span class="op" id="4350161">[</span><span class="ident" id="4350162">i</span><span class="op" id="4350163">]</span>&nbsp;<span class="op" id="4350165">=</span>&nbsp;<span class="ident" id="4350167">c</span><span class="op" id="4350168">.</span><span class="ident" id="4350169">RawSubject</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4350181">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4350184">return</span><br>
<span class="lineno"></span><span class="op" id="4350191">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
