<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3828796">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3828851">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3828905">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3828956">package</span>&nbsp;<span class="ident" id="3828964">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3828969">import</span>&nbsp;<span class="string" id="3828976">&#34;bytes&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3828985">type</span>&nbsp;<span class="ident" id="3828990">clientHelloMsg</span>&nbsp;<span class="keyword" id="3829005">struct</span>&nbsp;<span class="op" id="3829012">{</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829015">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3829035">[</span><span class="op" id="3829036">]</span><span class="builtintype" id="3829037">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829043">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3829063">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829071">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3829091">[</span><span class="op" id="3829092">]</span><span class="builtintype" id="3829093">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829099">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3829119">[</span><span class="op" id="3829120">]</span><span class="builtintype" id="3829121">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829127">cipherSuites</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3829147">[</span><span class="op" id="3829148">]</span><span class="builtintype" id="3829149">uint16</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829157">compressionMethods</span>&nbsp;&nbsp;<span class="op" id="3829177">[</span><span class="op" id="3829178">]</span><span class="builtintype" id="3829179">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829186">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3829206">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829212">serverName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3829232">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829240">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3829260">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829266">supportedCurves</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3829286">[</span><span class="op" id="3829287">]</span><span class="ident" id="3829288">CurveID</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829297">supportedPoints</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3829317">[</span><span class="op" id="3829318">]</span><span class="builtintype" id="3829319">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829326">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3829346">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829352">sessionTicket</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3829372">[</span><span class="op" id="3829373">]</span><span class="builtintype" id="3829374">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829381">signatureAndHashes</span>&nbsp;&nbsp;<span class="op" id="3829401">[</span><span class="op" id="3829402">]</span><span class="ident" id="3829403">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829421">secureRenegotiation</span>&nbsp;<span class="builtintype" id="3829441">bool</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829447">alpnProtocols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3829467">[</span><span class="op" id="3829468">]</span><span class="builtintype" id="3829469">string</span><br>
<span class="lineno"></span><span class="op" id="3829476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3829479">func</span>&nbsp;<span class="op" id="3829484">(</span><span class="ident" id="3829485">m</span>&nbsp;<span class="op" id="3829487">*</span><span class="ident" id="3829488">clientHelloMsg</span><span class="op" id="3829502">)</span>&nbsp;<span class="ident" id="3829504">equal</span><span class="op" id="3829509">(</span><span class="ident" id="3829510">i</span>&nbsp;<span class="keyword" id="3829512">interface</span><span class="op" id="3829521">{</span><span class="op" id="3829522">}</span><span class="op" id="3829523">)</span>&nbsp;<span class="builtintype" id="3829525">bool</span>&nbsp;<span class="op" id="3829530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829533">m1</span><span class="op" id="3829535">,</span>&nbsp;<span class="ident" id="3829537">ok</span>&nbsp;<span class="op" id="3829540">:=</span>&nbsp;<span class="ident" id="3829543">i</span><span class="op" id="3829544">.</span><span class="op" id="3829545">(</span><span class="op" id="3829546">*</span><span class="ident" id="3829547">clientHelloMsg</span><span class="op" id="3829561">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3829564">if</span>&nbsp;<span class="op" id="3829567">!</span><span class="ident" id="3829568">ok</span>&nbsp;<span class="op" id="3829571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3829575">return</span>&nbsp;<span class="builtintype" id="3829582">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3829589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3829593">return</span>&nbsp;<span class="ident" id="3829600">bytes</span><span class="op" id="3829605">.</span><span class="ident" id="3829606">Equal</span><span class="op" id="3829611">(</span><span class="ident" id="3829612">m</span><span class="op" id="3829613">.</span><span class="ident" id="3829614">raw</span><span class="op" id="3829617">,</span>&nbsp;<span class="ident" id="3829619">m1</span><span class="op" id="3829621">.</span><span class="ident" id="3829622">raw</span><span class="op" id="3829625">)</span>&nbsp;<span class="op" id="3829627">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829632">m</span><span class="op" id="3829633">.</span><span class="ident" id="3829634">vers</span>&nbsp;<span class="op" id="3829639">==</span>&nbsp;<span class="ident" id="3829642">m1</span><span class="op" id="3829644">.</span><span class="ident" id="3829645">vers</span>&nbsp;<span class="op" id="3829650">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829655">bytes</span><span class="op" id="3829660">.</span><span class="ident" id="3829661">Equal</span><span class="op" id="3829666">(</span><span class="ident" id="3829667">m</span><span class="op" id="3829668">.</span><span class="ident" id="3829669">random</span><span class="op" id="3829675">,</span>&nbsp;<span class="ident" id="3829677">m1</span><span class="op" id="3829679">.</span><span class="ident" id="3829680">random</span><span class="op" id="3829686">)</span>&nbsp;<span class="op" id="3829688">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829693">bytes</span><span class="op" id="3829698">.</span><span class="ident" id="3829699">Equal</span><span class="op" id="3829704">(</span><span class="ident" id="3829705">m</span><span class="op" id="3829706">.</span><span class="ident" id="3829707">sessionId</span><span class="op" id="3829716">,</span>&nbsp;<span class="ident" id="3829718">m1</span><span class="op" id="3829720">.</span><span class="ident" id="3829721">sessionId</span><span class="op" id="3829730">)</span>&nbsp;<span class="op" id="3829732">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829737">eqUint16s</span><span class="op" id="3829746">(</span><span class="ident" id="3829747">m</span><span class="op" id="3829748">.</span><span class="ident" id="3829749">cipherSuites</span><span class="op" id="3829761">,</span>&nbsp;<span class="ident" id="3829763">m1</span><span class="op" id="3829765">.</span><span class="ident" id="3829766">cipherSuites</span><span class="op" id="3829778">)</span>&nbsp;<span class="op" id="3829780">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829785">bytes</span><span class="op" id="3829790">.</span><span class="ident" id="3829791">Equal</span><span class="op" id="3829796">(</span><span class="ident" id="3829797">m</span><span class="op" id="3829798">.</span><span class="ident" id="3829799">compressionMethods</span><span class="op" id="3829817">,</span>&nbsp;<span class="ident" id="3829819">m1</span><span class="op" id="3829821">.</span><span class="ident" id="3829822">compressionMethods</span><span class="op" id="3829840">)</span>&nbsp;<span class="op" id="3829842">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829847">m</span><span class="op" id="3829848">.</span><span class="ident" id="3829849">nextProtoNeg</span>&nbsp;<span class="op" id="3829862">==</span>&nbsp;<span class="ident" id="3829865">m1</span><span class="op" id="3829867">.</span><span class="ident" id="3829868">nextProtoNeg</span>&nbsp;<span class="op" id="3829881">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829886">m</span><span class="op" id="3829887">.</span><span class="ident" id="3829888">serverName</span>&nbsp;<span class="op" id="3829899">==</span>&nbsp;<span class="ident" id="3829902">m1</span><span class="op" id="3829904">.</span><span class="ident" id="3829905">serverName</span>&nbsp;<span class="op" id="3829916">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829921">m</span><span class="op" id="3829922">.</span><span class="ident" id="3829923">ocspStapling</span>&nbsp;<span class="op" id="3829936">==</span>&nbsp;<span class="ident" id="3829939">m1</span><span class="op" id="3829941">.</span><span class="ident" id="3829942">ocspStapling</span>&nbsp;<span class="op" id="3829955">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3829960">eqCurveIDs</span><span class="op" id="3829970">(</span><span class="ident" id="3829971">m</span><span class="op" id="3829972">.</span><span class="ident" id="3829973">supportedCurves</span><span class="op" id="3829988">,</span>&nbsp;<span class="ident" id="3829990">m1</span><span class="op" id="3829992">.</span><span class="ident" id="3829993">supportedCurves</span><span class="op" id="3830008">)</span>&nbsp;<span class="op" id="3830010">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830015">bytes</span><span class="op" id="3830020">.</span><span class="ident" id="3830021">Equal</span><span class="op" id="3830026">(</span><span class="ident" id="3830027">m</span><span class="op" id="3830028">.</span><span class="ident" id="3830029">supportedPoints</span><span class="op" id="3830044">,</span>&nbsp;<span class="ident" id="3830046">m1</span><span class="op" id="3830048">.</span><span class="ident" id="3830049">supportedPoints</span><span class="op" id="3830064">)</span>&nbsp;<span class="op" id="3830066">&amp;&amp;</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830071">m</span><span class="op" id="3830072">.</span><span class="ident" id="3830073">ticketSupported</span>&nbsp;<span class="op" id="3830089">==</span>&nbsp;<span class="ident" id="3830092">m1</span><span class="op" id="3830094">.</span><span class="ident" id="3830095">ticketSupported</span>&nbsp;<span class="op" id="3830111">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830116">bytes</span><span class="op" id="3830121">.</span><span class="ident" id="3830122">Equal</span><span class="op" id="3830127">(</span><span class="ident" id="3830128">m</span><span class="op" id="3830129">.</span><span class="ident" id="3830130">sessionTicket</span><span class="op" id="3830143">,</span>&nbsp;<span class="ident" id="3830145">m1</span><span class="op" id="3830147">.</span><span class="ident" id="3830148">sessionTicket</span><span class="op" id="3830161">)</span>&nbsp;<span class="op" id="3830163">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830168">eqSignatureAndHashes</span><span class="op" id="3830188">(</span><span class="ident" id="3830189">m</span><span class="op" id="3830190">.</span><span class="ident" id="3830191">signatureAndHashes</span><span class="op" id="3830209">,</span>&nbsp;<span class="ident" id="3830211">m1</span><span class="op" id="3830213">.</span><span class="ident" id="3830214">signatureAndHashes</span><span class="op" id="3830232">)</span>&nbsp;<span class="op" id="3830234">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830239">m</span><span class="op" id="3830240">.</span><span class="ident" id="3830241">secureRenegotiation</span>&nbsp;<span class="op" id="3830261">==</span>&nbsp;<span class="ident" id="3830264">m1</span><span class="op" id="3830266">.</span><span class="ident" id="3830267">secureRenegotiation</span>&nbsp;<span class="op" id="3830287">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830292">eqStrings</span><span class="op" id="3830301">(</span><span class="ident" id="3830302">m</span><span class="op" id="3830303">.</span><span class="ident" id="3830304">alpnProtocols</span><span class="op" id="3830317">,</span>&nbsp;<span class="ident" id="3830319">m1</span><span class="op" id="3830321">.</span><span class="ident" id="3830322">alpnProtocols</span><span class="op" id="3830335">)</span><br>
<span class="lineno">50</span><span class="op" id="3830337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3830340">func</span>&nbsp;<span class="op" id="3830345">(</span><span class="ident" id="3830346">m</span>&nbsp;<span class="op" id="3830348">*</span><span class="ident" id="3830349">clientHelloMsg</span><span class="op" id="3830363">)</span>&nbsp;<span class="ident" id="3830365">marshal</span><span class="op" id="3830372">(</span><span class="op" id="3830373">)</span>&nbsp;<span class="op" id="3830375">[</span><span class="op" id="3830376">]</span><span class="builtintype" id="3830377">byte</span>&nbsp;<span class="op" id="3830382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830385">if</span>&nbsp;<span class="ident" id="3830388">m</span><span class="op" id="3830389">.</span><span class="ident" id="3830390">raw</span>&nbsp;<span class="op" id="3830394">!=</span>&nbsp;<span class="ident" id="3830397">nil</span>&nbsp;<span class="op" id="3830401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830405">return</span>&nbsp;<span class="ident" id="3830412">m</span><span class="op" id="3830413">.</span><span class="ident" id="3830414">raw</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3830419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830423">length</span>&nbsp;<span class="op" id="3830430">:=</span>&nbsp;<span class="num" id="3830433">2</span>&nbsp;<span class="op" id="3830435">+</span>&nbsp;<span class="num" id="3830437">32</span>&nbsp;<span class="op" id="3830440">+</span>&nbsp;<span class="num" id="3830442">1</span>&nbsp;<span class="op" id="3830444">+</span>&nbsp;<span class="builtinfunc" id="3830446">len</span><span class="op" id="3830449">(</span><span class="ident" id="3830450">m</span><span class="op" id="3830451">.</span><span class="ident" id="3830452">sessionId</span><span class="op" id="3830461">)</span>&nbsp;<span class="op" id="3830463">+</span>&nbsp;<span class="num" id="3830465">2</span>&nbsp;<span class="op" id="3830467">+</span>&nbsp;<span class="builtinfunc" id="3830469">len</span><span class="op" id="3830472">(</span><span class="ident" id="3830473">m</span><span class="op" id="3830474">.</span><span class="ident" id="3830475">cipherSuites</span><span class="op" id="3830487">)</span><span class="op" id="3830488">*</span><span class="num" id="3830489">2</span>&nbsp;<span class="op" id="3830491">+</span>&nbsp;<span class="num" id="3830493">1</span>&nbsp;<span class="op" id="3830495">+</span>&nbsp;<span class="builtinfunc" id="3830497">len</span><span class="op" id="3830500">(</span><span class="ident" id="3830501">m</span><span class="op" id="3830502">.</span><span class="ident" id="3830503">compressionMethods</span><span class="op" id="3830521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830524">numExtensions</span>&nbsp;<span class="op" id="3830538">:=</span>&nbsp;<span class="num" id="3830541">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830544">extensionsLength</span>&nbsp;<span class="op" id="3830561">:=</span>&nbsp;<span class="num" id="3830564">0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830567">if</span>&nbsp;<span class="ident" id="3830570">m</span><span class="op" id="3830571">.</span><span class="ident" id="3830572">nextProtoNeg</span>&nbsp;<span class="op" id="3830585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830589">numExtensions</span><span class="op" id="3830602">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3830606">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830609">if</span>&nbsp;<span class="ident" id="3830612">m</span><span class="op" id="3830613">.</span><span class="ident" id="3830614">ocspStapling</span>&nbsp;<span class="op" id="3830627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830631">extensionsLength</span>&nbsp;<span class="op" id="3830648">+=</span>&nbsp;<span class="num" id="3830651">1</span>&nbsp;<span class="op" id="3830653">+</span>&nbsp;<span class="num" id="3830655">2</span>&nbsp;<span class="op" id="3830657">+</span>&nbsp;<span class="num" id="3830659">2</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830663">numExtensions</span><span class="op" id="3830676">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3830680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830683">if</span>&nbsp;<span class="builtinfunc" id="3830686">len</span><span class="op" id="3830689">(</span><span class="ident" id="3830690">m</span><span class="op" id="3830691">.</span><span class="ident" id="3830692">serverName</span><span class="op" id="3830702">)</span>&nbsp;<span class="op" id="3830704">&gt;</span>&nbsp;<span class="num" id="3830706">0</span>&nbsp;<span class="op" id="3830708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830712">extensionsLength</span>&nbsp;<span class="op" id="3830729">+=</span>&nbsp;<span class="num" id="3830732">5</span>&nbsp;<span class="op" id="3830734">+</span>&nbsp;<span class="builtinfunc" id="3830736">len</span><span class="op" id="3830739">(</span><span class="ident" id="3830740">m</span><span class="op" id="3830741">.</span><span class="ident" id="3830742">serverName</span><span class="op" id="3830752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830756">numExtensions</span><span class="op" id="3830769">++</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3830773">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830776">if</span>&nbsp;<span class="builtinfunc" id="3830779">len</span><span class="op" id="3830782">(</span><span class="ident" id="3830783">m</span><span class="op" id="3830784">.</span><span class="ident" id="3830785">supportedCurves</span><span class="op" id="3830800">)</span>&nbsp;<span class="op" id="3830802">&gt;</span>&nbsp;<span class="num" id="3830804">0</span>&nbsp;<span class="op" id="3830806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830810">extensionsLength</span>&nbsp;<span class="op" id="3830827">+=</span>&nbsp;<span class="num" id="3830830">2</span>&nbsp;<span class="op" id="3830832">+</span>&nbsp;<span class="num" id="3830834">2</span><span class="op" id="3830835">*</span><span class="builtinfunc" id="3830836">len</span><span class="op" id="3830839">(</span><span class="ident" id="3830840">m</span><span class="op" id="3830841">.</span><span class="ident" id="3830842">supportedCurves</span><span class="op" id="3830857">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830861">numExtensions</span><span class="op" id="3830874">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3830878">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830881">if</span>&nbsp;<span class="builtinfunc" id="3830884">len</span><span class="op" id="3830887">(</span><span class="ident" id="3830888">m</span><span class="op" id="3830889">.</span><span class="ident" id="3830890">supportedPoints</span><span class="op" id="3830905">)</span>&nbsp;<span class="op" id="3830907">&gt;</span>&nbsp;<span class="num" id="3830909">0</span>&nbsp;<span class="op" id="3830911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830915">extensionsLength</span>&nbsp;<span class="op" id="3830932">+=</span>&nbsp;<span class="num" id="3830935">1</span>&nbsp;<span class="op" id="3830937">+</span>&nbsp;<span class="builtinfunc" id="3830939">len</span><span class="op" id="3830942">(</span><span class="ident" id="3830943">m</span><span class="op" id="3830944">.</span><span class="ident" id="3830945">supportedPoints</span><span class="op" id="3830960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3830964">numExtensions</span><span class="op" id="3830977">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3830981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3830984">if</span>&nbsp;<span class="ident" id="3830987">m</span><span class="op" id="3830988">.</span><span class="ident" id="3830989">ticketSupported</span>&nbsp;<span class="op" id="3831005">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831009">extensionsLength</span>&nbsp;<span class="op" id="3831026">+=</span>&nbsp;<span class="builtinfunc" id="3831029">len</span><span class="op" id="3831032">(</span><span class="ident" id="3831033">m</span><span class="op" id="3831034">.</span><span class="ident" id="3831035">sessionTicket</span><span class="op" id="3831048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831052">numExtensions</span><span class="op" id="3831065">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831072">if</span>&nbsp;<span class="builtinfunc" id="3831075">len</span><span class="op" id="3831078">(</span><span class="ident" id="3831079">m</span><span class="op" id="3831080">.</span><span class="ident" id="3831081">signatureAndHashes</span><span class="op" id="3831099">)</span>&nbsp;<span class="op" id="3831101">&gt;</span>&nbsp;<span class="num" id="3831103">0</span>&nbsp;<span class="op" id="3831105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831109">extensionsLength</span>&nbsp;<span class="op" id="3831126">+=</span>&nbsp;<span class="num" id="3831129">2</span>&nbsp;<span class="op" id="3831131">+</span>&nbsp;<span class="num" id="3831133">2</span><span class="op" id="3831134">*</span><span class="builtinfunc" id="3831135">len</span><span class="op" id="3831138">(</span><span class="ident" id="3831139">m</span><span class="op" id="3831140">.</span><span class="ident" id="3831141">signatureAndHashes</span><span class="op" id="3831159">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831163">numExtensions</span><span class="op" id="3831176">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831183">if</span>&nbsp;<span class="ident" id="3831186">m</span><span class="op" id="3831187">.</span><span class="ident" id="3831188">secureRenegotiation</span>&nbsp;<span class="op" id="3831208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831212">extensionsLength</span>&nbsp;<span class="op" id="3831229">+=</span>&nbsp;<span class="num" id="3831232">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831236">numExtensions</span><span class="op" id="3831249">++</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831253">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831256">if</span>&nbsp;<span class="builtinfunc" id="3831259">len</span><span class="op" id="3831262">(</span><span class="ident" id="3831263">m</span><span class="op" id="3831264">.</span><span class="ident" id="3831265">alpnProtocols</span><span class="op" id="3831278">)</span>&nbsp;<span class="op" id="3831280">&gt;</span>&nbsp;<span class="num" id="3831282">0</span>&nbsp;<span class="op" id="3831284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831288">extensionsLength</span>&nbsp;<span class="op" id="3831305">+=</span>&nbsp;<span class="num" id="3831308">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831312">for</span>&nbsp;<span class="ident" id="3831316">_</span><span class="op" id="3831317">,</span>&nbsp;<span class="ident" id="3831319">s</span>&nbsp;<span class="op" id="3831321">:=</span>&nbsp;<span class="keyword" id="3831324">range</span>&nbsp;<span class="ident" id="3831330">m</span><span class="op" id="3831331">.</span><span class="ident" id="3831332">alpnProtocols</span>&nbsp;<span class="op" id="3831346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831351">if</span>&nbsp;<span class="ident" id="3831354">l</span>&nbsp;<span class="op" id="3831356">:=</span>&nbsp;<span class="builtinfunc" id="3831359">len</span><span class="op" id="3831362">(</span><span class="ident" id="3831363">s</span><span class="op" id="3831364">)</span><span class="op" id="3831365">;</span>&nbsp;<span class="ident" id="3831367">l</span>&nbsp;<span class="op" id="3831369">==</span>&nbsp;<span class="num" id="3831372">0</span>&nbsp;<span class="op" id="3831374">||</span>&nbsp;<span class="ident" id="3831377">l</span>&nbsp;<span class="op" id="3831379">&gt;</span>&nbsp;<span class="num" id="3831381">255</span>&nbsp;<span class="op" id="3831385">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3831391">panic</span><span class="op" id="3831396">(</span><span class="string" id="3831397">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="3831420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831430">extensionsLength</span><span class="op" id="3831446">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831452">extensionsLength</span>&nbsp;<span class="op" id="3831469">+=</span>&nbsp;<span class="builtinfunc" id="3831472">len</span><span class="op" id="3831475">(</span><span class="ident" id="3831476">s</span><span class="op" id="3831477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831481">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831485">numExtensions</span><span class="op" id="3831498">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831505">if</span>&nbsp;<span class="ident" id="3831508">numExtensions</span>&nbsp;<span class="op" id="3831522">&gt;</span>&nbsp;<span class="num" id="3831524">0</span>&nbsp;<span class="op" id="3831526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831530">extensionsLength</span>&nbsp;<span class="op" id="3831547">+=</span>&nbsp;<span class="num" id="3831550">4</span>&nbsp;<span class="op" id="3831552">*</span>&nbsp;<span class="ident" id="3831554">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831570">length</span>&nbsp;<span class="op" id="3831577">+=</span>&nbsp;<span class="num" id="3831580">2</span>&nbsp;<span class="op" id="3831582">+</span>&nbsp;<span class="ident" id="3831584">extensionsLength</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3831602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831606">x</span>&nbsp;<span class="op" id="3831608">:=</span>&nbsp;<span class="builtinfunc" id="3831611">make</span><span class="op" id="3831615">(</span><span class="op" id="3831616">[</span><span class="op" id="3831617">]</span><span class="builtintype" id="3831618">byte</span><span class="op" id="3831622">,</span>&nbsp;<span class="num" id="3831624">4</span><span class="op" id="3831625">+</span><span class="ident" id="3831626">length</span><span class="op" id="3831632">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831635">x</span><span class="op" id="3831636">[</span><span class="num" id="3831637">0</span><span class="op" id="3831638">]</span>&nbsp;<span class="op" id="3831640">=</span>&nbsp;<span class="ident" id="3831642">typeClientHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831659">x</span><span class="op" id="3831660">[</span><span class="num" id="3831661">1</span><span class="op" id="3831662">]</span>&nbsp;<span class="op" id="3831664">=</span>&nbsp;<span class="builtintype" id="3831666">uint8</span><span class="op" id="3831671">(</span><span class="ident" id="3831672">length</span>&nbsp;<span class="op" id="3831679">&gt;&gt;</span>&nbsp;<span class="num" id="3831682">16</span><span class="op" id="3831684">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831687">x</span><span class="op" id="3831688">[</span><span class="num" id="3831689">2</span><span class="op" id="3831690">]</span>&nbsp;<span class="op" id="3831692">=</span>&nbsp;<span class="builtintype" id="3831694">uint8</span><span class="op" id="3831699">(</span><span class="ident" id="3831700">length</span>&nbsp;<span class="op" id="3831707">&gt;&gt;</span>&nbsp;<span class="num" id="3831710">8</span><span class="op" id="3831711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831714">x</span><span class="op" id="3831715">[</span><span class="num" id="3831716">3</span><span class="op" id="3831717">]</span>&nbsp;<span class="op" id="3831719">=</span>&nbsp;<span class="builtintype" id="3831721">uint8</span><span class="op" id="3831726">(</span><span class="ident" id="3831727">length</span><span class="op" id="3831733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831736">x</span><span class="op" id="3831737">[</span><span class="num" id="3831738">4</span><span class="op" id="3831739">]</span>&nbsp;<span class="op" id="3831741">=</span>&nbsp;<span class="builtintype" id="3831743">uint8</span><span class="op" id="3831748">(</span><span class="ident" id="3831749">m</span><span class="op" id="3831750">.</span><span class="ident" id="3831751">vers</span>&nbsp;<span class="op" id="3831756">&gt;&gt;</span>&nbsp;<span class="num" id="3831759">8</span><span class="op" id="3831760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831763">x</span><span class="op" id="3831764">[</span><span class="num" id="3831765">5</span><span class="op" id="3831766">]</span>&nbsp;<span class="op" id="3831768">=</span>&nbsp;<span class="builtintype" id="3831770">uint8</span><span class="op" id="3831775">(</span><span class="ident" id="3831776">m</span><span class="op" id="3831777">.</span><span class="ident" id="3831778">vers</span><span class="op" id="3831782">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3831785">copy</span><span class="op" id="3831789">(</span><span class="ident" id="3831790">x</span><span class="op" id="3831791">[</span><span class="num" id="3831792">6</span><span class="op" id="3831793">:</span><span class="num" id="3831794">38</span><span class="op" id="3831796">]</span><span class="op" id="3831797">,</span>&nbsp;<span class="ident" id="3831799">m</span><span class="op" id="3831800">.</span><span class="ident" id="3831801">random</span><span class="op" id="3831807">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831810">x</span><span class="op" id="3831811">[</span><span class="num" id="3831812">38</span><span class="op" id="3831814">]</span>&nbsp;<span class="op" id="3831816">=</span>&nbsp;<span class="builtintype" id="3831818">uint8</span><span class="op" id="3831823">(</span><span class="builtinfunc" id="3831824">len</span><span class="op" id="3831827">(</span><span class="ident" id="3831828">m</span><span class="op" id="3831829">.</span><span class="ident" id="3831830">sessionId</span><span class="op" id="3831839">)</span><span class="op" id="3831840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3831843">copy</span><span class="op" id="3831847">(</span><span class="ident" id="3831848">x</span><span class="op" id="3831849">[</span><span class="num" id="3831850">39</span><span class="op" id="3831852">:</span><span class="num" id="3831853">39</span><span class="op" id="3831855">+</span><span class="builtinfunc" id="3831856">len</span><span class="op" id="3831859">(</span><span class="ident" id="3831860">m</span><span class="op" id="3831861">.</span><span class="ident" id="3831862">sessionId</span><span class="op" id="3831871">)</span><span class="op" id="3831872">]</span><span class="op" id="3831873">,</span>&nbsp;<span class="ident" id="3831875">m</span><span class="op" id="3831876">.</span><span class="ident" id="3831877">sessionId</span><span class="op" id="3831886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831889">y</span>&nbsp;<span class="op" id="3831891">:=</span>&nbsp;<span class="ident" id="3831894">x</span><span class="op" id="3831895">[</span><span class="num" id="3831896">39</span><span class="op" id="3831898">+</span><span class="builtinfunc" id="3831899">len</span><span class="op" id="3831902">(</span><span class="ident" id="3831903">m</span><span class="op" id="3831904">.</span><span class="ident" id="3831905">sessionId</span><span class="op" id="3831914">)</span><span class="op" id="3831915">:</span><span class="op" id="3831916">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831919">y</span><span class="op" id="3831920">[</span><span class="num" id="3831921">0</span><span class="op" id="3831922">]</span>&nbsp;<span class="op" id="3831924">=</span>&nbsp;<span class="builtintype" id="3831926">uint8</span><span class="op" id="3831931">(</span><span class="builtinfunc" id="3831932">len</span><span class="op" id="3831935">(</span><span class="ident" id="3831936">m</span><span class="op" id="3831937">.</span><span class="ident" id="3831938">cipherSuites</span><span class="op" id="3831950">)</span>&nbsp;<span class="op" id="3831952">&gt;&gt;</span>&nbsp;<span class="num" id="3831955">7</span><span class="op" id="3831956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3831959">y</span><span class="op" id="3831960">[</span><span class="num" id="3831961">1</span><span class="op" id="3831962">]</span>&nbsp;<span class="op" id="3831964">=</span>&nbsp;<span class="builtintype" id="3831966">uint8</span><span class="op" id="3831971">(</span><span class="builtinfunc" id="3831972">len</span><span class="op" id="3831975">(</span><span class="ident" id="3831976">m</span><span class="op" id="3831977">.</span><span class="ident" id="3831978">cipherSuites</span><span class="op" id="3831990">)</span>&nbsp;<span class="op" id="3831992">&lt;&lt;</span>&nbsp;<span class="num" id="3831995">1</span><span class="op" id="3831996">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3831999">for</span>&nbsp;<span class="ident" id="3832003">i</span><span class="op" id="3832004">,</span>&nbsp;<span class="ident" id="3832006">suite</span>&nbsp;<span class="op" id="3832012">:=</span>&nbsp;<span class="keyword" id="3832015">range</span>&nbsp;<span class="ident" id="3832021">m</span><span class="op" id="3832022">.</span><span class="ident" id="3832023">cipherSuites</span>&nbsp;<span class="op" id="3832036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832040">y</span><span class="op" id="3832041">[</span><span class="num" id="3832042">2</span><span class="op" id="3832043">+</span><span class="ident" id="3832044">i</span><span class="op" id="3832045">*</span><span class="num" id="3832046">2</span><span class="op" id="3832047">]</span>&nbsp;<span class="op" id="3832049">=</span>&nbsp;<span class="builtintype" id="3832051">uint8</span><span class="op" id="3832056">(</span><span class="ident" id="3832057">suite</span>&nbsp;<span class="op" id="3832063">&gt;&gt;</span>&nbsp;<span class="num" id="3832066">8</span><span class="op" id="3832067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832071">y</span><span class="op" id="3832072">[</span><span class="num" id="3832073">3</span><span class="op" id="3832074">+</span><span class="ident" id="3832075">i</span><span class="op" id="3832076">*</span><span class="num" id="3832077">2</span><span class="op" id="3832078">]</span>&nbsp;<span class="op" id="3832080">=</span>&nbsp;<span class="builtintype" id="3832082">uint8</span><span class="op" id="3832087">(</span><span class="ident" id="3832088">suite</span><span class="op" id="3832093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3832096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832099">z</span>&nbsp;<span class="op" id="3832101">:=</span>&nbsp;<span class="ident" id="3832104">y</span><span class="op" id="3832105">[</span><span class="num" id="3832106">2</span><span class="op" id="3832107">+</span><span class="builtinfunc" id="3832108">len</span><span class="op" id="3832111">(</span><span class="ident" id="3832112">m</span><span class="op" id="3832113">.</span><span class="ident" id="3832114">cipherSuites</span><span class="op" id="3832126">)</span><span class="op" id="3832127">*</span><span class="num" id="3832128">2</span><span class="op" id="3832129">:</span><span class="op" id="3832130">]</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832133">z</span><span class="op" id="3832134">[</span><span class="num" id="3832135">0</span><span class="op" id="3832136">]</span>&nbsp;<span class="op" id="3832138">=</span>&nbsp;<span class="builtintype" id="3832140">uint8</span><span class="op" id="3832145">(</span><span class="builtinfunc" id="3832146">len</span><span class="op" id="3832149">(</span><span class="ident" id="3832150">m</span><span class="op" id="3832151">.</span><span class="ident" id="3832152">compressionMethods</span><span class="op" id="3832170">)</span><span class="op" id="3832171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3832174">copy</span><span class="op" id="3832178">(</span><span class="ident" id="3832179">z</span><span class="op" id="3832180">[</span><span class="num" id="3832181">1</span><span class="op" id="3832182">:</span><span class="op" id="3832183">]</span><span class="op" id="3832184">,</span>&nbsp;<span class="ident" id="3832186">m</span><span class="op" id="3832187">.</span><span class="ident" id="3832188">compressionMethods</span><span class="op" id="3832206">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832210">z</span>&nbsp;<span class="op" id="3832212">=</span>&nbsp;<span class="ident" id="3832214">z</span><span class="op" id="3832215">[</span><span class="num" id="3832216">1</span><span class="op" id="3832217">+</span><span class="builtinfunc" id="3832218">len</span><span class="op" id="3832221">(</span><span class="ident" id="3832222">m</span><span class="op" id="3832223">.</span><span class="ident" id="3832224">compressionMethods</span><span class="op" id="3832242">)</span><span class="op" id="3832243">:</span><span class="op" id="3832244">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3832247">if</span>&nbsp;<span class="ident" id="3832250">numExtensions</span>&nbsp;<span class="op" id="3832264">&gt;</span>&nbsp;<span class="num" id="3832266">0</span>&nbsp;<span class="op" id="3832268">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832272">z</span><span class="op" id="3832273">[</span><span class="num" id="3832274">0</span><span class="op" id="3832275">]</span>&nbsp;<span class="op" id="3832277">=</span>&nbsp;<span class="builtintype" id="3832279">byte</span><span class="op" id="3832283">(</span><span class="ident" id="3832284">extensionsLength</span>&nbsp;<span class="op" id="3832301">&gt;&gt;</span>&nbsp;<span class="num" id="3832304">8</span><span class="op" id="3832305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832309">z</span><span class="op" id="3832310">[</span><span class="num" id="3832311">1</span><span class="op" id="3832312">]</span>&nbsp;<span class="op" id="3832314">=</span>&nbsp;<span class="builtintype" id="3832316">byte</span><span class="op" id="3832320">(</span><span class="ident" id="3832321">extensionsLength</span><span class="op" id="3832337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832341">z</span>&nbsp;<span class="op" id="3832343">=</span>&nbsp;<span class="ident" id="3832345">z</span><span class="op" id="3832346">[</span><span class="num" id="3832347">2</span><span class="op" id="3832348">:</span><span class="op" id="3832349">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3832352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3832355">if</span>&nbsp;<span class="ident" id="3832358">m</span><span class="op" id="3832359">.</span><span class="ident" id="3832360">nextProtoNeg</span>&nbsp;<span class="op" id="3832373">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832377">z</span><span class="op" id="3832378">[</span><span class="num" id="3832379">0</span><span class="op" id="3832380">]</span>&nbsp;<span class="op" id="3832382">=</span>&nbsp;<span class="builtintype" id="3832384">byte</span><span class="op" id="3832388">(</span><span class="ident" id="3832389">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3832411">&gt;&gt;</span>&nbsp;<span class="num" id="3832414">8</span><span class="op" id="3832415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832419">z</span><span class="op" id="3832420">[</span><span class="num" id="3832421">1</span><span class="op" id="3832422">]</span>&nbsp;<span class="op" id="3832424">=</span>&nbsp;<span class="builtintype" id="3832426">byte</span><span class="op" id="3832430">(</span><span class="ident" id="3832431">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3832453">&amp;</span>&nbsp;<span class="num" id="3832455">0xff</span><span class="op" id="3832459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832463">//&nbsp;The&nbsp;length&nbsp;is&nbsp;always&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832491">z</span>&nbsp;<span class="op" id="3832493">=</span>&nbsp;<span class="ident" id="3832495">z</span><span class="op" id="3832496">[</span><span class="num" id="3832497">4</span><span class="op" id="3832498">:</span><span class="op" id="3832499">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3832502">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3832505">if</span>&nbsp;<span class="builtinfunc" id="3832508">len</span><span class="op" id="3832511">(</span><span class="ident" id="3832512">m</span><span class="op" id="3832513">.</span><span class="ident" id="3832514">serverName</span><span class="op" id="3832524">)</span>&nbsp;<span class="op" id="3832526">&gt;</span>&nbsp;<span class="num" id="3832528">0</span>&nbsp;<span class="op" id="3832530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832534">z</span><span class="op" id="3832535">[</span><span class="num" id="3832536">0</span><span class="op" id="3832537">]</span>&nbsp;<span class="op" id="3832539">=</span>&nbsp;<span class="builtintype" id="3832541">byte</span><span class="op" id="3832545">(</span><span class="ident" id="3832546">extensionServerName</span>&nbsp;<span class="op" id="3832566">&gt;&gt;</span>&nbsp;<span class="num" id="3832569">8</span><span class="op" id="3832570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832574">z</span><span class="op" id="3832575">[</span><span class="num" id="3832576">1</span><span class="op" id="3832577">]</span>&nbsp;<span class="op" id="3832579">=</span>&nbsp;<span class="builtintype" id="3832581">byte</span><span class="op" id="3832585">(</span><span class="ident" id="3832586">extensionServerName</span>&nbsp;<span class="op" id="3832606">&amp;</span>&nbsp;<span class="num" id="3832608">0xff</span><span class="op" id="3832612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832616">l</span>&nbsp;<span class="op" id="3832618">:=</span>&nbsp;<span class="builtinfunc" id="3832621">len</span><span class="op" id="3832624">(</span><span class="ident" id="3832625">m</span><span class="op" id="3832626">.</span><span class="ident" id="3832627">serverName</span><span class="op" id="3832637">)</span>&nbsp;<span class="op" id="3832639">+</span>&nbsp;<span class="num" id="3832641">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832645">z</span><span class="op" id="3832646">[</span><span class="num" id="3832647">2</span><span class="op" id="3832648">]</span>&nbsp;<span class="op" id="3832650">=</span>&nbsp;<span class="builtintype" id="3832652">byte</span><span class="op" id="3832656">(</span><span class="ident" id="3832657">l</span>&nbsp;<span class="op" id="3832659">&gt;&gt;</span>&nbsp;<span class="num" id="3832662">8</span><span class="op" id="3832663">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832667">z</span><span class="op" id="3832668">[</span><span class="num" id="3832669">3</span><span class="op" id="3832670">]</span>&nbsp;<span class="op" id="3832672">=</span>&nbsp;<span class="builtintype" id="3832674">byte</span><span class="op" id="3832678">(</span><span class="ident" id="3832679">l</span><span class="op" id="3832680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3832684">z</span>&nbsp;<span class="op" id="3832686">=</span>&nbsp;<span class="ident" id="3832688">z</span><span class="op" id="3832689">[</span><span class="num" id="3832690">4</span><span class="op" id="3832691">:</span><span class="op" id="3832692">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832697">//&nbsp;RFC&nbsp;3546,&nbsp;section&nbsp;3.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832724">//</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832729">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832743">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NameType&nbsp;name_type;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832772">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;select&nbsp;(name_type)&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832802">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;case&nbsp;host_name:&nbsp;HostName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832841">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;name;</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832858">//&nbsp;}&nbsp;ServerName;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832877">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832882">//&nbsp;enum&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832894">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host_name(0),&nbsp;(255)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832923">//&nbsp;}&nbsp;NameType;</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832940">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832945">//&nbsp;opaque&nbsp;HostName&lt;1..2^16-1&gt;;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832978">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832983">//&nbsp;struct&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3832997">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ServerName&nbsp;server_name_list&lt;1..2^16-1&gt;</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833045">//&nbsp;}&nbsp;ServerNameList;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833069">z</span><span class="op" id="3833070">[</span><span class="num" id="3833071">0</span><span class="op" id="3833072">]</span>&nbsp;<span class="op" id="3833074">=</span>&nbsp;<span class="builtintype" id="3833076">byte</span><span class="op" id="3833080">(</span><span class="op" id="3833081">(</span><span class="builtinfunc" id="3833082">len</span><span class="op" id="3833085">(</span><span class="ident" id="3833086">m</span><span class="op" id="3833087">.</span><span class="ident" id="3833088">serverName</span><span class="op" id="3833098">)</span>&nbsp;<span class="op" id="3833100">+</span>&nbsp;<span class="num" id="3833102">3</span><span class="op" id="3833103">)</span>&nbsp;<span class="op" id="3833105">&gt;&gt;</span>&nbsp;<span class="num" id="3833108">8</span><span class="op" id="3833109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833113">z</span><span class="op" id="3833114">[</span><span class="num" id="3833115">1</span><span class="op" id="3833116">]</span>&nbsp;<span class="op" id="3833118">=</span>&nbsp;<span class="builtintype" id="3833120">byte</span><span class="op" id="3833124">(</span><span class="builtinfunc" id="3833125">len</span><span class="op" id="3833128">(</span><span class="ident" id="3833129">m</span><span class="op" id="3833130">.</span><span class="ident" id="3833131">serverName</span><span class="op" id="3833141">)</span>&nbsp;<span class="op" id="3833143">+</span>&nbsp;<span class="num" id="3833145">3</span><span class="op" id="3833146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833150">z</span><span class="op" id="3833151">[</span><span class="num" id="3833152">3</span><span class="op" id="3833153">]</span>&nbsp;<span class="op" id="3833155">=</span>&nbsp;<span class="builtintype" id="3833157">byte</span><span class="op" id="3833161">(</span><span class="builtinfunc" id="3833162">len</span><span class="op" id="3833165">(</span><span class="ident" id="3833166">m</span><span class="op" id="3833167">.</span><span class="ident" id="3833168">serverName</span><span class="op" id="3833178">)</span>&nbsp;<span class="op" id="3833180">&gt;&gt;</span>&nbsp;<span class="num" id="3833183">8</span><span class="op" id="3833184">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833188">z</span><span class="op" id="3833189">[</span><span class="num" id="3833190">4</span><span class="op" id="3833191">]</span>&nbsp;<span class="op" id="3833193">=</span>&nbsp;<span class="builtintype" id="3833195">byte</span><span class="op" id="3833199">(</span><span class="builtinfunc" id="3833200">len</span><span class="op" id="3833203">(</span><span class="ident" id="3833204">m</span><span class="op" id="3833205">.</span><span class="ident" id="3833206">serverName</span><span class="op" id="3833216">)</span><span class="op" id="3833217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3833221">copy</span><span class="op" id="3833225">(</span><span class="ident" id="3833226">z</span><span class="op" id="3833227">[</span><span class="num" id="3833228">5</span><span class="op" id="3833229">:</span><span class="op" id="3833230">]</span><span class="op" id="3833231">,</span>&nbsp;<span class="op" id="3833233">[</span><span class="op" id="3833234">]</span><span class="builtintype" id="3833235">byte</span><span class="op" id="3833239">(</span><span class="ident" id="3833240">m</span><span class="op" id="3833241">.</span><span class="ident" id="3833242">serverName</span><span class="op" id="3833252">)</span><span class="op" id="3833253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833257">z</span>&nbsp;<span class="op" id="3833259">=</span>&nbsp;<span class="ident" id="3833261">z</span><span class="op" id="3833262">[</span><span class="ident" id="3833263">l</span><span class="op" id="3833264">:</span><span class="op" id="3833265">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3833268">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3833271">if</span>&nbsp;<span class="ident" id="3833274">m</span><span class="op" id="3833275">.</span><span class="ident" id="3833276">ocspStapling</span>&nbsp;<span class="op" id="3833289">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833293">//&nbsp;RFC&nbsp;4366,&nbsp;section&nbsp;3.6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833320">z</span><span class="op" id="3833321">[</span><span class="num" id="3833322">0</span><span class="op" id="3833323">]</span>&nbsp;<span class="op" id="3833325">=</span>&nbsp;<span class="builtintype" id="3833327">byte</span><span class="op" id="3833331">(</span><span class="ident" id="3833332">extensionStatusRequest</span>&nbsp;<span class="op" id="3833355">&gt;&gt;</span>&nbsp;<span class="num" id="3833358">8</span><span class="op" id="3833359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833363">z</span><span class="op" id="3833364">[</span><span class="num" id="3833365">1</span><span class="op" id="3833366">]</span>&nbsp;<span class="op" id="3833368">=</span>&nbsp;<span class="builtintype" id="3833370">byte</span><span class="op" id="3833374">(</span><span class="ident" id="3833375">extensionStatusRequest</span><span class="op" id="3833397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833401">z</span><span class="op" id="3833402">[</span><span class="num" id="3833403">2</span><span class="op" id="3833404">]</span>&nbsp;<span class="op" id="3833406">=</span>&nbsp;<span class="num" id="3833408">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833412">z</span><span class="op" id="3833413">[</span><span class="num" id="3833414">3</span><span class="op" id="3833415">]</span>&nbsp;<span class="op" id="3833417">=</span>&nbsp;<span class="num" id="3833419">5</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833423">z</span><span class="op" id="3833424">[</span><span class="num" id="3833425">4</span><span class="op" id="3833426">]</span>&nbsp;<span class="op" id="3833428">=</span>&nbsp;<span class="num" id="3833430">1</span>&nbsp;<span class="comment" id="3833432">//&nbsp;OCSP&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833447">//&nbsp;Two&nbsp;zero&nbsp;valued&nbsp;uint16s&nbsp;for&nbsp;the&nbsp;two&nbsp;lengths.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833497">z</span>&nbsp;<span class="op" id="3833499">=</span>&nbsp;<span class="ident" id="3833501">z</span><span class="op" id="3833502">[</span><span class="num" id="3833503">9</span><span class="op" id="3833504">:</span><span class="op" id="3833505">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3833508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3833511">if</span>&nbsp;<span class="builtinfunc" id="3833514">len</span><span class="op" id="3833517">(</span><span class="ident" id="3833518">m</span><span class="op" id="3833519">.</span><span class="ident" id="3833520">supportedCurves</span><span class="op" id="3833535">)</span>&nbsp;<span class="op" id="3833537">&gt;</span>&nbsp;<span class="num" id="3833539">0</span>&nbsp;<span class="op" id="3833541">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833545">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833599">z</span><span class="op" id="3833600">[</span><span class="num" id="3833601">0</span><span class="op" id="3833602">]</span>&nbsp;<span class="op" id="3833604">=</span>&nbsp;<span class="builtintype" id="3833606">byte</span><span class="op" id="3833610">(</span><span class="ident" id="3833611">extensionSupportedCurves</span>&nbsp;<span class="op" id="3833636">&gt;&gt;</span>&nbsp;<span class="num" id="3833639">8</span><span class="op" id="3833640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833644">z</span><span class="op" id="3833645">[</span><span class="num" id="3833646">1</span><span class="op" id="3833647">]</span>&nbsp;<span class="op" id="3833649">=</span>&nbsp;<span class="builtintype" id="3833651">byte</span><span class="op" id="3833655">(</span><span class="ident" id="3833656">extensionSupportedCurves</span><span class="op" id="3833680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833684">l</span>&nbsp;<span class="op" id="3833686">:=</span>&nbsp;<span class="num" id="3833689">2</span>&nbsp;<span class="op" id="3833691">+</span>&nbsp;<span class="num" id="3833693">2</span><span class="op" id="3833694">*</span><span class="builtinfunc" id="3833695">len</span><span class="op" id="3833698">(</span><span class="ident" id="3833699">m</span><span class="op" id="3833700">.</span><span class="ident" id="3833701">supportedCurves</span><span class="op" id="3833716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833720">z</span><span class="op" id="3833721">[</span><span class="num" id="3833722">2</span><span class="op" id="3833723">]</span>&nbsp;<span class="op" id="3833725">=</span>&nbsp;<span class="builtintype" id="3833727">byte</span><span class="op" id="3833731">(</span><span class="ident" id="3833732">l</span>&nbsp;<span class="op" id="3833734">&gt;&gt;</span>&nbsp;<span class="num" id="3833737">8</span><span class="op" id="3833738">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833742">z</span><span class="op" id="3833743">[</span><span class="num" id="3833744">3</span><span class="op" id="3833745">]</span>&nbsp;<span class="op" id="3833747">=</span>&nbsp;<span class="builtintype" id="3833749">byte</span><span class="op" id="3833753">(</span><span class="ident" id="3833754">l</span><span class="op" id="3833755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833759">l</span>&nbsp;<span class="op" id="3833761">-=</span>&nbsp;<span class="num" id="3833764">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833768">z</span><span class="op" id="3833769">[</span><span class="num" id="3833770">4</span><span class="op" id="3833771">]</span>&nbsp;<span class="op" id="3833773">=</span>&nbsp;<span class="builtintype" id="3833775">byte</span><span class="op" id="3833779">(</span><span class="ident" id="3833780">l</span>&nbsp;<span class="op" id="3833782">&gt;&gt;</span>&nbsp;<span class="num" id="3833785">8</span><span class="op" id="3833786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833790">z</span><span class="op" id="3833791">[</span><span class="num" id="3833792">5</span><span class="op" id="3833793">]</span>&nbsp;<span class="op" id="3833795">=</span>&nbsp;<span class="builtintype" id="3833797">byte</span><span class="op" id="3833801">(</span><span class="ident" id="3833802">l</span><span class="op" id="3833803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833807">z</span>&nbsp;<span class="op" id="3833809">=</span>&nbsp;<span class="ident" id="3833811">z</span><span class="op" id="3833812">[</span><span class="num" id="3833813">6</span><span class="op" id="3833814">:</span><span class="op" id="3833815">]</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3833819">for</span>&nbsp;<span class="ident" id="3833823">_</span><span class="op" id="3833824">,</span>&nbsp;<span class="ident" id="3833826">curve</span>&nbsp;<span class="op" id="3833832">:=</span>&nbsp;<span class="keyword" id="3833835">range</span>&nbsp;<span class="ident" id="3833841">m</span><span class="op" id="3833842">.</span><span class="ident" id="3833843">supportedCurves</span>&nbsp;<span class="op" id="3833859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833864">z</span><span class="op" id="3833865">[</span><span class="num" id="3833866">0</span><span class="op" id="3833867">]</span>&nbsp;<span class="op" id="3833869">=</span>&nbsp;<span class="builtintype" id="3833871">byte</span><span class="op" id="3833875">(</span><span class="ident" id="3833876">curve</span>&nbsp;<span class="op" id="3833882">&gt;&gt;</span>&nbsp;<span class="num" id="3833885">8</span><span class="op" id="3833886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833891">z</span><span class="op" id="3833892">[</span><span class="num" id="3833893">1</span><span class="op" id="3833894">]</span>&nbsp;<span class="op" id="3833896">=</span>&nbsp;<span class="builtintype" id="3833898">byte</span><span class="op" id="3833902">(</span><span class="ident" id="3833903">curve</span><span class="op" id="3833908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3833913">z</span>&nbsp;<span class="op" id="3833915">=</span>&nbsp;<span class="ident" id="3833917">z</span><span class="op" id="3833918">[</span><span class="num" id="3833919">2</span><span class="op" id="3833920">:</span><span class="op" id="3833921">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3833925">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3833928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3833931">if</span>&nbsp;<span class="builtinfunc" id="3833934">len</span><span class="op" id="3833937">(</span><span class="ident" id="3833938">m</span><span class="op" id="3833939">.</span><span class="ident" id="3833940">supportedPoints</span><span class="op" id="3833955">)</span>&nbsp;<span class="op" id="3833957">&gt;</span>&nbsp;<span class="num" id="3833959">0</span>&nbsp;<span class="op" id="3833961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3833965">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834019">z</span><span class="op" id="3834020">[</span><span class="num" id="3834021">0</span><span class="op" id="3834022">]</span>&nbsp;<span class="op" id="3834024">=</span>&nbsp;<span class="builtintype" id="3834026">byte</span><span class="op" id="3834030">(</span><span class="ident" id="3834031">extensionSupportedPoints</span>&nbsp;<span class="op" id="3834056">&gt;&gt;</span>&nbsp;<span class="num" id="3834059">8</span><span class="op" id="3834060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834064">z</span><span class="op" id="3834065">[</span><span class="num" id="3834066">1</span><span class="op" id="3834067">]</span>&nbsp;<span class="op" id="3834069">=</span>&nbsp;<span class="builtintype" id="3834071">byte</span><span class="op" id="3834075">(</span><span class="ident" id="3834076">extensionSupportedPoints</span><span class="op" id="3834100">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834104">l</span>&nbsp;<span class="op" id="3834106">:=</span>&nbsp;<span class="num" id="3834109">1</span>&nbsp;<span class="op" id="3834111">+</span>&nbsp;<span class="builtinfunc" id="3834113">len</span><span class="op" id="3834116">(</span><span class="ident" id="3834117">m</span><span class="op" id="3834118">.</span><span class="ident" id="3834119">supportedPoints</span><span class="op" id="3834134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834138">z</span><span class="op" id="3834139">[</span><span class="num" id="3834140">2</span><span class="op" id="3834141">]</span>&nbsp;<span class="op" id="3834143">=</span>&nbsp;<span class="builtintype" id="3834145">byte</span><span class="op" id="3834149">(</span><span class="ident" id="3834150">l</span>&nbsp;<span class="op" id="3834152">&gt;&gt;</span>&nbsp;<span class="num" id="3834155">8</span><span class="op" id="3834156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834160">z</span><span class="op" id="3834161">[</span><span class="num" id="3834162">3</span><span class="op" id="3834163">]</span>&nbsp;<span class="op" id="3834165">=</span>&nbsp;<span class="builtintype" id="3834167">byte</span><span class="op" id="3834171">(</span><span class="ident" id="3834172">l</span><span class="op" id="3834173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834177">l</span><span class="op" id="3834178">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834183">z</span><span class="op" id="3834184">[</span><span class="num" id="3834185">4</span><span class="op" id="3834186">]</span>&nbsp;<span class="op" id="3834188">=</span>&nbsp;<span class="builtintype" id="3834190">byte</span><span class="op" id="3834194">(</span><span class="ident" id="3834195">l</span><span class="op" id="3834196">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834200">z</span>&nbsp;<span class="op" id="3834202">=</span>&nbsp;<span class="ident" id="3834204">z</span><span class="op" id="3834205">[</span><span class="num" id="3834206">5</span><span class="op" id="3834207">:</span><span class="op" id="3834208">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3834212">for</span>&nbsp;<span class="ident" id="3834216">_</span><span class="op" id="3834217">,</span>&nbsp;<span class="ident" id="3834219">pointFormat</span>&nbsp;<span class="op" id="3834231">:=</span>&nbsp;<span class="keyword" id="3834234">range</span>&nbsp;<span class="ident" id="3834240">m</span><span class="op" id="3834241">.</span><span class="ident" id="3834242">supportedPoints</span>&nbsp;<span class="op" id="3834258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834263">z</span><span class="op" id="3834264">[</span><span class="num" id="3834265">0</span><span class="op" id="3834266">]</span>&nbsp;<span class="op" id="3834268">=</span>&nbsp;<span class="builtintype" id="3834270">byte</span><span class="op" id="3834274">(</span><span class="ident" id="3834275">pointFormat</span><span class="op" id="3834286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834291">z</span>&nbsp;<span class="op" id="3834293">=</span>&nbsp;<span class="ident" id="3834295">z</span><span class="op" id="3834296">[</span><span class="num" id="3834297">1</span><span class="op" id="3834298">:</span><span class="op" id="3834299">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3834303">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3834306">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3834309">if</span>&nbsp;<span class="ident" id="3834312">m</span><span class="op" id="3834313">.</span><span class="ident" id="3834314">ticketSupported</span>&nbsp;<span class="op" id="3834330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3834334">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834386">z</span><span class="op" id="3834387">[</span><span class="num" id="3834388">0</span><span class="op" id="3834389">]</span>&nbsp;<span class="op" id="3834391">=</span>&nbsp;<span class="builtintype" id="3834393">byte</span><span class="op" id="3834397">(</span><span class="ident" id="3834398">extensionSessionTicket</span>&nbsp;<span class="op" id="3834421">&gt;&gt;</span>&nbsp;<span class="num" id="3834424">8</span><span class="op" id="3834425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834429">z</span><span class="op" id="3834430">[</span><span class="num" id="3834431">1</span><span class="op" id="3834432">]</span>&nbsp;<span class="op" id="3834434">=</span>&nbsp;<span class="builtintype" id="3834436">byte</span><span class="op" id="3834440">(</span><span class="ident" id="3834441">extensionSessionTicket</span><span class="op" id="3834463">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834467">l</span>&nbsp;<span class="op" id="3834469">:=</span>&nbsp;<span class="builtinfunc" id="3834472">len</span><span class="op" id="3834475">(</span><span class="ident" id="3834476">m</span><span class="op" id="3834477">.</span><span class="ident" id="3834478">sessionTicket</span><span class="op" id="3834491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834495">z</span><span class="op" id="3834496">[</span><span class="num" id="3834497">2</span><span class="op" id="3834498">]</span>&nbsp;<span class="op" id="3834500">=</span>&nbsp;<span class="builtintype" id="3834502">byte</span><span class="op" id="3834506">(</span><span class="ident" id="3834507">l</span>&nbsp;<span class="op" id="3834509">&gt;&gt;</span>&nbsp;<span class="num" id="3834512">8</span><span class="op" id="3834513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834517">z</span><span class="op" id="3834518">[</span><span class="num" id="3834519">3</span><span class="op" id="3834520">]</span>&nbsp;<span class="op" id="3834522">=</span>&nbsp;<span class="builtintype" id="3834524">byte</span><span class="op" id="3834528">(</span><span class="ident" id="3834529">l</span><span class="op" id="3834530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834534">z</span>&nbsp;<span class="op" id="3834536">=</span>&nbsp;<span class="ident" id="3834538">z</span><span class="op" id="3834539">[</span><span class="num" id="3834540">4</span><span class="op" id="3834541">:</span><span class="op" id="3834542">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3834546">copy</span><span class="op" id="3834550">(</span><span class="ident" id="3834551">z</span><span class="op" id="3834552">,</span>&nbsp;<span class="ident" id="3834554">m</span><span class="op" id="3834555">.</span><span class="ident" id="3834556">sessionTicket</span><span class="op" id="3834569">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834573">z</span>&nbsp;<span class="op" id="3834575">=</span>&nbsp;<span class="ident" id="3834577">z</span><span class="op" id="3834578">[</span><span class="builtinfunc" id="3834579">len</span><span class="op" id="3834582">(</span><span class="ident" id="3834583">m</span><span class="op" id="3834584">.</span><span class="ident" id="3834585">sessionTicket</span><span class="op" id="3834598">)</span><span class="op" id="3834599">:</span><span class="op" id="3834600">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3834603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3834606">if</span>&nbsp;<span class="builtinfunc" id="3834609">len</span><span class="op" id="3834612">(</span><span class="ident" id="3834613">m</span><span class="op" id="3834614">.</span><span class="ident" id="3834615">signatureAndHashes</span><span class="op" id="3834633">)</span>&nbsp;<span class="op" id="3834635">&gt;</span>&nbsp;<span class="num" id="3834637">0</span>&nbsp;<span class="op" id="3834639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3834643">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834702">z</span><span class="op" id="3834703">[</span><span class="num" id="3834704">0</span><span class="op" id="3834705">]</span>&nbsp;<span class="op" id="3834707">=</span>&nbsp;<span class="builtintype" id="3834709">byte</span><span class="op" id="3834713">(</span><span class="ident" id="3834714">extensionSignatureAlgorithms</span>&nbsp;<span class="op" id="3834743">&gt;&gt;</span>&nbsp;<span class="num" id="3834746">8</span><span class="op" id="3834747">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834751">z</span><span class="op" id="3834752">[</span><span class="num" id="3834753">1</span><span class="op" id="3834754">]</span>&nbsp;<span class="op" id="3834756">=</span>&nbsp;<span class="builtintype" id="3834758">byte</span><span class="op" id="3834762">(</span><span class="ident" id="3834763">extensionSignatureAlgorithms</span><span class="op" id="3834791">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834795">l</span>&nbsp;<span class="op" id="3834797">:=</span>&nbsp;<span class="num" id="3834800">2</span>&nbsp;<span class="op" id="3834802">+</span>&nbsp;<span class="num" id="3834804">2</span><span class="op" id="3834805">*</span><span class="builtinfunc" id="3834806">len</span><span class="op" id="3834809">(</span><span class="ident" id="3834810">m</span><span class="op" id="3834811">.</span><span class="ident" id="3834812">signatureAndHashes</span><span class="op" id="3834830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834834">z</span><span class="op" id="3834835">[</span><span class="num" id="3834836">2</span><span class="op" id="3834837">]</span>&nbsp;<span class="op" id="3834839">=</span>&nbsp;<span class="builtintype" id="3834841">byte</span><span class="op" id="3834845">(</span><span class="ident" id="3834846">l</span>&nbsp;<span class="op" id="3834848">&gt;&gt;</span>&nbsp;<span class="num" id="3834851">8</span><span class="op" id="3834852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834856">z</span><span class="op" id="3834857">[</span><span class="num" id="3834858">3</span><span class="op" id="3834859">]</span>&nbsp;<span class="op" id="3834861">=</span>&nbsp;<span class="builtintype" id="3834863">byte</span><span class="op" id="3834867">(</span><span class="ident" id="3834868">l</span><span class="op" id="3834869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834873">z</span>&nbsp;<span class="op" id="3834875">=</span>&nbsp;<span class="ident" id="3834877">z</span><span class="op" id="3834878">[</span><span class="num" id="3834879">4</span><span class="op" id="3834880">:</span><span class="op" id="3834881">]</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834886">l</span>&nbsp;<span class="op" id="3834888">-=</span>&nbsp;<span class="num" id="3834891">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834895">z</span><span class="op" id="3834896">[</span><span class="num" id="3834897">0</span><span class="op" id="3834898">]</span>&nbsp;<span class="op" id="3834900">=</span>&nbsp;<span class="builtintype" id="3834902">byte</span><span class="op" id="3834906">(</span><span class="ident" id="3834907">l</span>&nbsp;<span class="op" id="3834909">&gt;&gt;</span>&nbsp;<span class="num" id="3834912">8</span><span class="op" id="3834913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834917">z</span><span class="op" id="3834918">[</span><span class="num" id="3834919">1</span><span class="op" id="3834920">]</span>&nbsp;<span class="op" id="3834922">=</span>&nbsp;<span class="builtintype" id="3834924">byte</span><span class="op" id="3834928">(</span><span class="ident" id="3834929">l</span><span class="op" id="3834930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834934">z</span>&nbsp;<span class="op" id="3834936">=</span>&nbsp;<span class="ident" id="3834938">z</span><span class="op" id="3834939">[</span><span class="num" id="3834940">2</span><span class="op" id="3834941">:</span><span class="op" id="3834942">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3834946">for</span>&nbsp;<span class="ident" id="3834950">_</span><span class="op" id="3834951">,</span>&nbsp;<span class="ident" id="3834953">sigAndHash</span>&nbsp;<span class="op" id="3834964">:=</span>&nbsp;<span class="keyword" id="3834967">range</span>&nbsp;<span class="ident" id="3834973">m</span><span class="op" id="3834974">.</span><span class="ident" id="3834975">signatureAndHashes</span>&nbsp;<span class="op" id="3834994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3834999">z</span><span class="op" id="3835000">[</span><span class="num" id="3835001">0</span><span class="op" id="3835002">]</span>&nbsp;<span class="op" id="3835004">=</span>&nbsp;<span class="ident" id="3835006">sigAndHash</span><span class="op" id="3835016">.</span><span class="ident" id="3835017">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835025">z</span><span class="op" id="3835026">[</span><span class="num" id="3835027">1</span><span class="op" id="3835028">]</span>&nbsp;<span class="op" id="3835030">=</span>&nbsp;<span class="ident" id="3835032">sigAndHash</span><span class="op" id="3835042">.</span><span class="ident" id="3835043">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835056">z</span>&nbsp;<span class="op" id="3835058">=</span>&nbsp;<span class="ident" id="3835060">z</span><span class="op" id="3835061">[</span><span class="num" id="3835062">2</span><span class="op" id="3835063">:</span><span class="op" id="3835064">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3835068">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3835071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835074">if</span>&nbsp;<span class="ident" id="3835077">m</span><span class="op" id="3835078">.</span><span class="ident" id="3835079">secureRenegotiation</span>&nbsp;<span class="op" id="3835099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835103">z</span><span class="op" id="3835104">[</span><span class="num" id="3835105">0</span><span class="op" id="3835106">]</span>&nbsp;<span class="op" id="3835108">=</span>&nbsp;<span class="builtintype" id="3835110">byte</span><span class="op" id="3835114">(</span><span class="ident" id="3835115">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3835142">&gt;&gt;</span>&nbsp;<span class="num" id="3835145">8</span><span class="op" id="3835146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835150">z</span><span class="op" id="3835151">[</span><span class="num" id="3835152">1</span><span class="op" id="3835153">]</span>&nbsp;<span class="op" id="3835155">=</span>&nbsp;<span class="builtintype" id="3835157">byte</span><span class="op" id="3835161">(</span><span class="ident" id="3835162">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3835189">&amp;</span>&nbsp;<span class="num" id="3835191">0xff</span><span class="op" id="3835195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835199">z</span><span class="op" id="3835200">[</span><span class="num" id="3835201">2</span><span class="op" id="3835202">]</span>&nbsp;<span class="op" id="3835204">=</span>&nbsp;<span class="num" id="3835206">0</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835210">z</span><span class="op" id="3835211">[</span><span class="num" id="3835212">3</span><span class="op" id="3835213">]</span>&nbsp;<span class="op" id="3835215">=</span>&nbsp;<span class="num" id="3835217">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835221">z</span>&nbsp;<span class="op" id="3835223">=</span>&nbsp;<span class="ident" id="3835225">z</span><span class="op" id="3835226">[</span><span class="num" id="3835227">5</span><span class="op" id="3835228">:</span><span class="op" id="3835229">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3835232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835235">if</span>&nbsp;<span class="builtinfunc" id="3835238">len</span><span class="op" id="3835241">(</span><span class="ident" id="3835242">m</span><span class="op" id="3835243">.</span><span class="ident" id="3835244">alpnProtocols</span><span class="op" id="3835257">)</span>&nbsp;<span class="op" id="3835259">&gt;</span>&nbsp;<span class="num" id="3835261">0</span>&nbsp;<span class="op" id="3835263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835267">z</span><span class="op" id="3835268">[</span><span class="num" id="3835269">0</span><span class="op" id="3835270">]</span>&nbsp;<span class="op" id="3835272">=</span>&nbsp;<span class="builtintype" id="3835274">byte</span><span class="op" id="3835278">(</span><span class="ident" id="3835279">extensionALPN</span>&nbsp;<span class="op" id="3835293">&gt;&gt;</span>&nbsp;<span class="num" id="3835296">8</span><span class="op" id="3835297">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835301">z</span><span class="op" id="3835302">[</span><span class="num" id="3835303">1</span><span class="op" id="3835304">]</span>&nbsp;<span class="op" id="3835306">=</span>&nbsp;<span class="builtintype" id="3835308">byte</span><span class="op" id="3835312">(</span><span class="ident" id="3835313">extensionALPN</span>&nbsp;<span class="op" id="3835327">&amp;</span>&nbsp;<span class="num" id="3835329">0xff</span><span class="op" id="3835333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835337">lengths</span>&nbsp;<span class="op" id="3835345">:=</span>&nbsp;<span class="ident" id="3835348">z</span><span class="op" id="3835349">[</span><span class="num" id="3835350">2</span><span class="op" id="3835351">:</span><span class="op" id="3835352">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835356">z</span>&nbsp;<span class="op" id="3835358">=</span>&nbsp;<span class="ident" id="3835360">z</span><span class="op" id="3835361">[</span><span class="num" id="3835362">6</span><span class="op" id="3835363">:</span><span class="op" id="3835364">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835369">stringsLength</span>&nbsp;<span class="op" id="3835383">:=</span>&nbsp;<span class="num" id="3835386">0</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835390">for</span>&nbsp;<span class="ident" id="3835394">_</span><span class="op" id="3835395">,</span>&nbsp;<span class="ident" id="3835397">s</span>&nbsp;<span class="op" id="3835399">:=</span>&nbsp;<span class="keyword" id="3835402">range</span>&nbsp;<span class="ident" id="3835408">m</span><span class="op" id="3835409">.</span><span class="ident" id="3835410">alpnProtocols</span>&nbsp;<span class="op" id="3835424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835429">l</span>&nbsp;<span class="op" id="3835431">:=</span>&nbsp;<span class="builtinfunc" id="3835434">len</span><span class="op" id="3835437">(</span><span class="ident" id="3835438">s</span><span class="op" id="3835439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835444">z</span><span class="op" id="3835445">[</span><span class="num" id="3835446">0</span><span class="op" id="3835447">]</span>&nbsp;<span class="op" id="3835449">=</span>&nbsp;<span class="builtintype" id="3835451">byte</span><span class="op" id="3835455">(</span><span class="ident" id="3835456">l</span><span class="op" id="3835457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3835462">copy</span><span class="op" id="3835466">(</span><span class="ident" id="3835467">z</span><span class="op" id="3835468">[</span><span class="num" id="3835469">1</span><span class="op" id="3835470">:</span><span class="op" id="3835471">]</span><span class="op" id="3835472">,</span>&nbsp;<span class="ident" id="3835474">s</span><span class="op" id="3835475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835480">z</span>&nbsp;<span class="op" id="3835482">=</span>&nbsp;<span class="ident" id="3835484">z</span><span class="op" id="3835485">[</span><span class="num" id="3835486">1</span><span class="op" id="3835487">+</span><span class="ident" id="3835488">l</span><span class="op" id="3835489">:</span><span class="op" id="3835490">]</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835495">stringsLength</span>&nbsp;<span class="op" id="3835509">+=</span>&nbsp;<span class="num" id="3835512">1</span>&nbsp;<span class="op" id="3835514">+</span>&nbsp;<span class="ident" id="3835516">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3835520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835525">lengths</span><span class="op" id="3835532">[</span><span class="num" id="3835533">2</span><span class="op" id="3835534">]</span>&nbsp;<span class="op" id="3835536">=</span>&nbsp;<span class="builtintype" id="3835538">byte</span><span class="op" id="3835542">(</span><span class="ident" id="3835543">stringsLength</span>&nbsp;<span class="op" id="3835557">&gt;&gt;</span>&nbsp;<span class="num" id="3835560">8</span><span class="op" id="3835561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835565">lengths</span><span class="op" id="3835572">[</span><span class="num" id="3835573">3</span><span class="op" id="3835574">]</span>&nbsp;<span class="op" id="3835576">=</span>&nbsp;<span class="builtintype" id="3835578">byte</span><span class="op" id="3835582">(</span><span class="ident" id="3835583">stringsLength</span><span class="op" id="3835596">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835600">stringsLength</span>&nbsp;<span class="op" id="3835614">+=</span>&nbsp;<span class="num" id="3835617">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835621">lengths</span><span class="op" id="3835628">[</span><span class="num" id="3835629">0</span><span class="op" id="3835630">]</span>&nbsp;<span class="op" id="3835632">=</span>&nbsp;<span class="builtintype" id="3835634">byte</span><span class="op" id="3835638">(</span><span class="ident" id="3835639">stringsLength</span>&nbsp;<span class="op" id="3835653">&gt;&gt;</span>&nbsp;<span class="num" id="3835656">8</span><span class="op" id="3835657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835661">lengths</span><span class="op" id="3835668">[</span><span class="num" id="3835669">1</span><span class="op" id="3835670">]</span>&nbsp;<span class="op" id="3835672">=</span>&nbsp;<span class="builtintype" id="3835674">byte</span><span class="op" id="3835678">(</span><span class="ident" id="3835679">stringsLength</span><span class="op" id="3835692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3835695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835699">m</span><span class="op" id="3835700">.</span><span class="ident" id="3835701">raw</span>&nbsp;<span class="op" id="3835705">=</span>&nbsp;<span class="ident" id="3835707">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835711">return</span>&nbsp;<span class="ident" id="3835718">x</span><br>
<span class="lineno"></span><span class="op" id="3835720">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="3835723">func</span>&nbsp;<span class="op" id="3835728">(</span><span class="ident" id="3835729">m</span>&nbsp;<span class="op" id="3835731">*</span><span class="ident" id="3835732">clientHelloMsg</span><span class="op" id="3835746">)</span>&nbsp;<span class="ident" id="3835748">unmarshal</span><span class="op" id="3835757">(</span><span class="ident" id="3835758">data</span>&nbsp;<span class="op" id="3835763">[</span><span class="op" id="3835764">]</span><span class="builtintype" id="3835765">byte</span><span class="op" id="3835769">)</span>&nbsp;<span class="builtintype" id="3835771">bool</span>&nbsp;<span class="op" id="3835776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835779">if</span>&nbsp;<span class="builtinfunc" id="3835782">len</span><span class="op" id="3835785">(</span><span class="ident" id="3835786">data</span><span class="op" id="3835790">)</span>&nbsp;<span class="op" id="3835792">&lt;</span>&nbsp;<span class="num" id="3835794">42</span>&nbsp;<span class="op" id="3835797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835801">return</span>&nbsp;<span class="builtintype" id="3835808">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3835815">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835818">m</span><span class="op" id="3835819">.</span><span class="ident" id="3835820">raw</span>&nbsp;<span class="op" id="3835824">=</span>&nbsp;<span class="ident" id="3835826">data</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835832">m</span><span class="op" id="3835833">.</span><span class="ident" id="3835834">vers</span>&nbsp;<span class="op" id="3835839">=</span>&nbsp;<span class="builtintype" id="3835841">uint16</span><span class="op" id="3835847">(</span><span class="ident" id="3835848">data</span><span class="op" id="3835852">[</span><span class="num" id="3835853">4</span><span class="op" id="3835854">]</span><span class="op" id="3835855">)</span><span class="op" id="3835856">&lt;&lt;</span><span class="num" id="3835858">8</span>&nbsp;<span class="op" id="3835860">|</span>&nbsp;<span class="builtintype" id="3835862">uint16</span><span class="op" id="3835868">(</span><span class="ident" id="3835869">data</span><span class="op" id="3835873">[</span><span class="num" id="3835874">5</span><span class="op" id="3835875">]</span><span class="op" id="3835876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835879">m</span><span class="op" id="3835880">.</span><span class="ident" id="3835881">random</span>&nbsp;<span class="op" id="3835888">=</span>&nbsp;<span class="ident" id="3835890">data</span><span class="op" id="3835894">[</span><span class="num" id="3835895">6</span><span class="op" id="3835896">:</span><span class="num" id="3835897">38</span><span class="op" id="3835899">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3835902">sessionIdLen</span>&nbsp;<span class="op" id="3835915">:=</span>&nbsp;<span class="builtintype" id="3835918">int</span><span class="op" id="3835921">(</span><span class="ident" id="3835922">data</span><span class="op" id="3835926">[</span><span class="num" id="3835927">38</span><span class="op" id="3835929">]</span><span class="op" id="3835930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835933">if</span>&nbsp;<span class="ident" id="3835936">sessionIdLen</span>&nbsp;<span class="op" id="3835949">&gt;</span>&nbsp;<span class="num" id="3835951">32</span>&nbsp;<span class="op" id="3835954">||</span>&nbsp;<span class="builtinfunc" id="3835957">len</span><span class="op" id="3835960">(</span><span class="ident" id="3835961">data</span><span class="op" id="3835965">)</span>&nbsp;<span class="op" id="3835967">&lt;</span>&nbsp;<span class="num" id="3835969">39</span><span class="op" id="3835971">+</span><span class="ident" id="3835972">sessionIdLen</span>&nbsp;<span class="op" id="3835985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3835989">return</span>&nbsp;<span class="builtintype" id="3835996">false</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3836003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836006">m</span><span class="op" id="3836007">.</span><span class="ident" id="3836008">sessionId</span>&nbsp;<span class="op" id="3836018">=</span>&nbsp;<span class="ident" id="3836020">data</span><span class="op" id="3836024">[</span><span class="num" id="3836025">39</span>&nbsp;<span class="op" id="3836028">:</span>&nbsp;<span class="num" id="3836030">39</span><span class="op" id="3836032">+</span><span class="ident" id="3836033">sessionIdLen</span><span class="op" id="3836045">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836048">data</span>&nbsp;<span class="op" id="3836053">=</span>&nbsp;<span class="ident" id="3836055">data</span><span class="op" id="3836059">[</span><span class="num" id="3836060">39</span><span class="op" id="3836062">+</span><span class="ident" id="3836063">sessionIdLen</span><span class="op" id="3836075">:</span><span class="op" id="3836076">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836079">if</span>&nbsp;<span class="builtinfunc" id="3836082">len</span><span class="op" id="3836085">(</span><span class="ident" id="3836086">data</span><span class="op" id="3836090">)</span>&nbsp;<span class="op" id="3836092">&lt;</span>&nbsp;<span class="num" id="3836094">2</span>&nbsp;<span class="op" id="3836096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836100">return</span>&nbsp;<span class="builtintype" id="3836107">false</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3836114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3836117">//&nbsp;cipherSuiteLen&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;of&nbsp;cipher&nbsp;suite&nbsp;numbers.&nbsp;Since</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3836190">//&nbsp;they&nbsp;are&nbsp;uint16s,&nbsp;the&nbsp;number&nbsp;must&nbsp;be&nbsp;even.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836237">cipherSuiteLen</span>&nbsp;<span class="op" id="3836252">:=</span>&nbsp;<span class="builtintype" id="3836255">int</span><span class="op" id="3836258">(</span><span class="ident" id="3836259">data</span><span class="op" id="3836263">[</span><span class="num" id="3836264">0</span><span class="op" id="3836265">]</span><span class="op" id="3836266">)</span><span class="op" id="3836267">&lt;&lt;</span><span class="num" id="3836269">8</span>&nbsp;<span class="op" id="3836271">|</span>&nbsp;<span class="builtintype" id="3836273">int</span><span class="op" id="3836276">(</span><span class="ident" id="3836277">data</span><span class="op" id="3836281">[</span><span class="num" id="3836282">1</span><span class="op" id="3836283">]</span><span class="op" id="3836284">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836287">if</span>&nbsp;<span class="ident" id="3836290">cipherSuiteLen</span><span class="op" id="3836304">%</span><span class="num" id="3836305">2</span>&nbsp;<span class="op" id="3836307">==</span>&nbsp;<span class="num" id="3836310">1</span>&nbsp;<span class="op" id="3836312">||</span>&nbsp;<span class="builtinfunc" id="3836315">len</span><span class="op" id="3836318">(</span><span class="ident" id="3836319">data</span><span class="op" id="3836323">)</span>&nbsp;<span class="op" id="3836325">&lt;</span>&nbsp;<span class="num" id="3836327">2</span><span class="op" id="3836328">+</span><span class="ident" id="3836329">cipherSuiteLen</span>&nbsp;<span class="op" id="3836344">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836348">return</span>&nbsp;<span class="builtintype" id="3836355">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3836362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836365">numCipherSuites</span>&nbsp;<span class="op" id="3836381">:=</span>&nbsp;<span class="ident" id="3836384">cipherSuiteLen</span>&nbsp;<span class="op" id="3836399">/</span>&nbsp;<span class="num" id="3836401">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836404">m</span><span class="op" id="3836405">.</span><span class="ident" id="3836406">cipherSuites</span>&nbsp;<span class="op" id="3836419">=</span>&nbsp;<span class="builtinfunc" id="3836421">make</span><span class="op" id="3836425">(</span><span class="op" id="3836426">[</span><span class="op" id="3836427">]</span><span class="builtintype" id="3836428">uint16</span><span class="op" id="3836434">,</span>&nbsp;<span class="ident" id="3836436">numCipherSuites</span><span class="op" id="3836451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836454">for</span>&nbsp;<span class="ident" id="3836458">i</span>&nbsp;<span class="op" id="3836460">:=</span>&nbsp;<span class="num" id="3836463">0</span><span class="op" id="3836464">;</span>&nbsp;<span class="ident" id="3836466">i</span>&nbsp;<span class="op" id="3836468">&lt;</span>&nbsp;<span class="ident" id="3836470">numCipherSuites</span><span class="op" id="3836485">;</span>&nbsp;<span class="ident" id="3836487">i</span><span class="op" id="3836488">++</span>&nbsp;<span class="op" id="3836491">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836495">m</span><span class="op" id="3836496">.</span><span class="ident" id="3836497">cipherSuites</span><span class="op" id="3836509">[</span><span class="ident" id="3836510">i</span><span class="op" id="3836511">]</span>&nbsp;<span class="op" id="3836513">=</span>&nbsp;<span class="builtintype" id="3836515">uint16</span><span class="op" id="3836521">(</span><span class="ident" id="3836522">data</span><span class="op" id="3836526">[</span><span class="num" id="3836527">2</span><span class="op" id="3836528">+</span><span class="num" id="3836529">2</span><span class="op" id="3836530">*</span><span class="ident" id="3836531">i</span><span class="op" id="3836532">]</span><span class="op" id="3836533">)</span><span class="op" id="3836534">&lt;&lt;</span><span class="num" id="3836536">8</span>&nbsp;<span class="op" id="3836538">|</span>&nbsp;<span class="builtintype" id="3836540">uint16</span><span class="op" id="3836546">(</span><span class="ident" id="3836547">data</span><span class="op" id="3836551">[</span><span class="num" id="3836552">3</span><span class="op" id="3836553">+</span><span class="num" id="3836554">2</span><span class="op" id="3836555">*</span><span class="ident" id="3836556">i</span><span class="op" id="3836557">]</span><span class="op" id="3836558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836562">if</span>&nbsp;<span class="ident" id="3836565">m</span><span class="op" id="3836566">.</span><span class="ident" id="3836567">cipherSuites</span><span class="op" id="3836579">[</span><span class="ident" id="3836580">i</span><span class="op" id="3836581">]</span>&nbsp;<span class="op" id="3836583">==</span>&nbsp;<span class="ident" id="3836586">scsvRenegotiation</span>&nbsp;<span class="op" id="3836604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836609">m</span><span class="op" id="3836610">.</span><span class="ident" id="3836611">secureRenegotiation</span>&nbsp;<span class="op" id="3836631">=</span>&nbsp;<span class="builtintype" id="3836633">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3836640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3836643">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836646">data</span>&nbsp;<span class="op" id="3836651">=</span>&nbsp;<span class="ident" id="3836653">data</span><span class="op" id="3836657">[</span><span class="num" id="3836658">2</span><span class="op" id="3836659">+</span><span class="ident" id="3836660">cipherSuiteLen</span><span class="op" id="3836674">:</span><span class="op" id="3836675">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836678">if</span>&nbsp;<span class="builtinfunc" id="3836681">len</span><span class="op" id="3836684">(</span><span class="ident" id="3836685">data</span><span class="op" id="3836689">)</span>&nbsp;<span class="op" id="3836691">&lt;</span>&nbsp;<span class="num" id="3836693">1</span>&nbsp;<span class="op" id="3836695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836699">return</span>&nbsp;<span class="builtintype" id="3836706">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3836713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836716">compressionMethodsLen</span>&nbsp;<span class="op" id="3836738">:=</span>&nbsp;<span class="builtintype" id="3836741">int</span><span class="op" id="3836744">(</span><span class="ident" id="3836745">data</span><span class="op" id="3836749">[</span><span class="num" id="3836750">0</span><span class="op" id="3836751">]</span><span class="op" id="3836752">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836755">if</span>&nbsp;<span class="builtinfunc" id="3836758">len</span><span class="op" id="3836761">(</span><span class="ident" id="3836762">data</span><span class="op" id="3836766">)</span>&nbsp;<span class="op" id="3836768">&lt;</span>&nbsp;<span class="num" id="3836770">1</span><span class="op" id="3836771">+</span><span class="ident" id="3836772">compressionMethodsLen</span>&nbsp;<span class="op" id="3836794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3836798">return</span>&nbsp;<span class="builtintype" id="3836805">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3836812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836815">m</span><span class="op" id="3836816">.</span><span class="ident" id="3836817">compressionMethods</span>&nbsp;<span class="op" id="3836836">=</span>&nbsp;<span class="ident" id="3836838">data</span><span class="op" id="3836842">[</span><span class="num" id="3836843">1</span>&nbsp;<span class="op" id="3836845">:</span>&nbsp;<span class="num" id="3836847">1</span><span class="op" id="3836848">+</span><span class="ident" id="3836849">compressionMethodsLen</span><span class="op" id="3836870">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836874">data</span>&nbsp;<span class="op" id="3836879">=</span>&nbsp;<span class="ident" id="3836881">data</span><span class="op" id="3836885">[</span><span class="num" id="3836886">1</span><span class="op" id="3836887">+</span><span class="ident" id="3836888">compressionMethodsLen</span><span class="op" id="3836909">:</span><span class="op" id="3836910">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836914">m</span><span class="op" id="3836915">.</span><span class="ident" id="3836916">nextProtoNeg</span>&nbsp;<span class="op" id="3836929">=</span>&nbsp;<span class="builtintype" id="3836931">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836938">m</span><span class="op" id="3836939">.</span><span class="ident" id="3836940">serverName</span>&nbsp;<span class="op" id="3836951">=</span>&nbsp;<span class="string" id="3836953">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836957">m</span><span class="op" id="3836958">.</span><span class="ident" id="3836959">ocspStapling</span>&nbsp;<span class="op" id="3836972">=</span>&nbsp;<span class="builtintype" id="3836974">false</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3836981">m</span><span class="op" id="3836982">.</span><span class="ident" id="3836983">ticketSupported</span>&nbsp;<span class="op" id="3836999">=</span>&nbsp;<span class="builtintype" id="3837001">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837008">m</span><span class="op" id="3837009">.</span><span class="ident" id="3837010">sessionTicket</span>&nbsp;<span class="op" id="3837024">=</span>&nbsp;<span class="ident" id="3837026">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837031">m</span><span class="op" id="3837032">.</span><span class="ident" id="3837033">signatureAndHashes</span>&nbsp;<span class="op" id="3837052">=</span>&nbsp;<span class="ident" id="3837054">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837059">m</span><span class="op" id="3837060">.</span><span class="ident" id="3837061">alpnProtocols</span>&nbsp;<span class="op" id="3837075">=</span>&nbsp;<span class="ident" id="3837077">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837083">if</span>&nbsp;<span class="builtinfunc" id="3837086">len</span><span class="op" id="3837089">(</span><span class="ident" id="3837090">data</span><span class="op" id="3837094">)</span>&nbsp;<span class="op" id="3837096">==</span>&nbsp;<span class="num" id="3837099">0</span>&nbsp;<span class="op" id="3837101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3837105">//&nbsp;ClientHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837163">return</span>&nbsp;<span class="builtintype" id="3837170">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837176">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837179">if</span>&nbsp;<span class="builtinfunc" id="3837182">len</span><span class="op" id="3837185">(</span><span class="ident" id="3837186">data</span><span class="op" id="3837190">)</span>&nbsp;<span class="op" id="3837192">&lt;</span>&nbsp;<span class="num" id="3837194">2</span>&nbsp;<span class="op" id="3837196">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837200">return</span>&nbsp;<span class="builtintype" id="3837207">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837218">extensionsLength</span>&nbsp;<span class="op" id="3837235">:=</span>&nbsp;<span class="builtintype" id="3837238">int</span><span class="op" id="3837241">(</span><span class="ident" id="3837242">data</span><span class="op" id="3837246">[</span><span class="num" id="3837247">0</span><span class="op" id="3837248">]</span><span class="op" id="3837249">)</span><span class="op" id="3837250">&lt;&lt;</span><span class="num" id="3837252">8</span>&nbsp;<span class="op" id="3837254">|</span>&nbsp;<span class="builtintype" id="3837256">int</span><span class="op" id="3837259">(</span><span class="ident" id="3837260">data</span><span class="op" id="3837264">[</span><span class="num" id="3837265">1</span><span class="op" id="3837266">]</span><span class="op" id="3837267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837270">data</span>&nbsp;<span class="op" id="3837275">=</span>&nbsp;<span class="ident" id="3837277">data</span><span class="op" id="3837281">[</span><span class="num" id="3837282">2</span><span class="op" id="3837283">:</span><span class="op" id="3837284">]</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837287">if</span>&nbsp;<span class="ident" id="3837290">extensionsLength</span>&nbsp;<span class="op" id="3837307">!=</span>&nbsp;<span class="builtinfunc" id="3837310">len</span><span class="op" id="3837313">(</span><span class="ident" id="3837314">data</span><span class="op" id="3837318">)</span>&nbsp;<span class="op" id="3837320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837324">return</span>&nbsp;<span class="builtintype" id="3837331">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837342">for</span>&nbsp;<span class="builtinfunc" id="3837346">len</span><span class="op" id="3837349">(</span><span class="ident" id="3837350">data</span><span class="op" id="3837354">)</span>&nbsp;<span class="op" id="3837356">!=</span>&nbsp;<span class="num" id="3837359">0</span>&nbsp;<span class="op" id="3837361">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837365">if</span>&nbsp;<span class="builtinfunc" id="3837368">len</span><span class="op" id="3837371">(</span><span class="ident" id="3837372">data</span><span class="op" id="3837376">)</span>&nbsp;<span class="op" id="3837378">&lt;</span>&nbsp;<span class="num" id="3837380">4</span>&nbsp;<span class="op" id="3837382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837387">return</span>&nbsp;<span class="builtintype" id="3837394">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837402">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837406">extension</span>&nbsp;<span class="op" id="3837416">:=</span>&nbsp;<span class="builtintype" id="3837419">uint16</span><span class="op" id="3837425">(</span><span class="ident" id="3837426">data</span><span class="op" id="3837430">[</span><span class="num" id="3837431">0</span><span class="op" id="3837432">]</span><span class="op" id="3837433">)</span><span class="op" id="3837434">&lt;&lt;</span><span class="num" id="3837436">8</span>&nbsp;<span class="op" id="3837438">|</span>&nbsp;<span class="builtintype" id="3837440">uint16</span><span class="op" id="3837446">(</span><span class="ident" id="3837447">data</span><span class="op" id="3837451">[</span><span class="num" id="3837452">1</span><span class="op" id="3837453">]</span><span class="op" id="3837454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837458">length</span>&nbsp;<span class="op" id="3837465">:=</span>&nbsp;<span class="builtintype" id="3837468">int</span><span class="op" id="3837471">(</span><span class="ident" id="3837472">data</span><span class="op" id="3837476">[</span><span class="num" id="3837477">2</span><span class="op" id="3837478">]</span><span class="op" id="3837479">)</span><span class="op" id="3837480">&lt;&lt;</span><span class="num" id="3837482">8</span>&nbsp;<span class="op" id="3837484">|</span>&nbsp;<span class="builtintype" id="3837486">int</span><span class="op" id="3837489">(</span><span class="ident" id="3837490">data</span><span class="op" id="3837494">[</span><span class="num" id="3837495">3</span><span class="op" id="3837496">]</span><span class="op" id="3837497">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837501">data</span>&nbsp;<span class="op" id="3837506">=</span>&nbsp;<span class="ident" id="3837508">data</span><span class="op" id="3837512">[</span><span class="num" id="3837513">4</span><span class="op" id="3837514">:</span><span class="op" id="3837515">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837519">if</span>&nbsp;<span class="builtinfunc" id="3837522">len</span><span class="op" id="3837525">(</span><span class="ident" id="3837526">data</span><span class="op" id="3837530">)</span>&nbsp;<span class="op" id="3837532">&lt;</span>&nbsp;<span class="ident" id="3837534">length</span>&nbsp;<span class="op" id="3837541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837546">return</span>&nbsp;<span class="builtintype" id="3837553">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837566">switch</span>&nbsp;<span class="ident" id="3837573">extension</span>&nbsp;<span class="op" id="3837583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837587">case</span>&nbsp;<span class="ident" id="3837592">extensionServerName</span><span class="op" id="3837611">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837616">if</span>&nbsp;<span class="ident" id="3837619">length</span>&nbsp;<span class="op" id="3837626">&lt;</span>&nbsp;<span class="num" id="3837628">2</span>&nbsp;<span class="op" id="3837630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837636">return</span>&nbsp;<span class="builtintype" id="3837643">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837652">}</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837657">numNames</span>&nbsp;<span class="op" id="3837666">:=</span>&nbsp;<span class="builtintype" id="3837669">int</span><span class="op" id="3837672">(</span><span class="ident" id="3837673">data</span><span class="op" id="3837677">[</span><span class="num" id="3837678">0</span><span class="op" id="3837679">]</span><span class="op" id="3837680">)</span><span class="op" id="3837681">&lt;&lt;</span><span class="num" id="3837683">8</span>&nbsp;<span class="op" id="3837685">|</span>&nbsp;<span class="builtintype" id="3837687">int</span><span class="op" id="3837690">(</span><span class="ident" id="3837691">data</span><span class="op" id="3837695">[</span><span class="num" id="3837696">1</span><span class="op" id="3837697">]</span><span class="op" id="3837698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837703">d</span>&nbsp;<span class="op" id="3837705">:=</span>&nbsp;<span class="ident" id="3837708">data</span><span class="op" id="3837712">[</span><span class="num" id="3837713">2</span><span class="op" id="3837714">:</span><span class="op" id="3837715">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837720">for</span>&nbsp;<span class="ident" id="3837724">i</span>&nbsp;<span class="op" id="3837726">:=</span>&nbsp;<span class="num" id="3837729">0</span><span class="op" id="3837730">;</span>&nbsp;<span class="ident" id="3837732">i</span>&nbsp;<span class="op" id="3837734">&lt;</span>&nbsp;<span class="ident" id="3837736">numNames</span><span class="op" id="3837744">;</span>&nbsp;<span class="ident" id="3837746">i</span><span class="op" id="3837747">++</span>&nbsp;<span class="op" id="3837750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837756">if</span>&nbsp;<span class="builtinfunc" id="3837759">len</span><span class="op" id="3837762">(</span><span class="ident" id="3837763">d</span><span class="op" id="3837764">)</span>&nbsp;<span class="op" id="3837766">&lt;</span>&nbsp;<span class="num" id="3837768">3</span>&nbsp;<span class="op" id="3837770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837777">return</span>&nbsp;<span class="builtintype" id="3837784">false</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837800">nameType</span>&nbsp;<span class="op" id="3837809">:=</span>&nbsp;<span class="ident" id="3837812">d</span><span class="op" id="3837813">[</span><span class="num" id="3837814">0</span><span class="op" id="3837815">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837821">nameLen</span>&nbsp;<span class="op" id="3837829">:=</span>&nbsp;<span class="builtintype" id="3837832">int</span><span class="op" id="3837835">(</span><span class="ident" id="3837836">d</span><span class="op" id="3837837">[</span><span class="num" id="3837838">1</span><span class="op" id="3837839">]</span><span class="op" id="3837840">)</span><span class="op" id="3837841">&lt;&lt;</span><span class="num" id="3837843">8</span>&nbsp;<span class="op" id="3837845">|</span>&nbsp;<span class="builtintype" id="3837847">int</span><span class="op" id="3837850">(</span><span class="ident" id="3837851">d</span><span class="op" id="3837852">[</span><span class="num" id="3837853">2</span><span class="op" id="3837854">]</span><span class="op" id="3837855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837861">d</span>&nbsp;<span class="op" id="3837863">=</span>&nbsp;<span class="ident" id="3837865">d</span><span class="op" id="3837866">[</span><span class="num" id="3837867">3</span><span class="op" id="3837868">:</span><span class="op" id="3837869">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837875">if</span>&nbsp;<span class="builtinfunc" id="3837878">len</span><span class="op" id="3837881">(</span><span class="ident" id="3837882">d</span><span class="op" id="3837883">)</span>&nbsp;<span class="op" id="3837885">&lt;</span>&nbsp;<span class="ident" id="3837887">nameLen</span>&nbsp;<span class="op" id="3837895">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837902">return</span>&nbsp;<span class="builtintype" id="3837909">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3837919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837925">if</span>&nbsp;<span class="ident" id="3837928">nameType</span>&nbsp;<span class="op" id="3837937">==</span>&nbsp;<span class="num" id="3837940">0</span>&nbsp;<span class="op" id="3837942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3837949">m</span><span class="op" id="3837950">.</span><span class="ident" id="3837951">serverName</span>&nbsp;<span class="op" id="3837962">=</span>&nbsp;<span class="builtintype" id="3837964">string</span><span class="op" id="3837970">(</span><span class="ident" id="3837971">d</span><span class="op" id="3837972">[</span><span class="num" id="3837973">0</span><span class="op" id="3837974">:</span><span class="ident" id="3837975">nameLen</span><span class="op" id="3837982">]</span><span class="op" id="3837983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3837990">break</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3838000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3838006">d</span>&nbsp;<span class="op" id="3838008">=</span>&nbsp;<span class="ident" id="3838010">d</span><span class="op" id="3838011">[</span><span class="ident" id="3838012">nameLen</span><span class="op" id="3838019">:</span><span class="op" id="3838020">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3838025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838029">case</span>&nbsp;<span class="ident" id="3838034">extensionNextProtoNeg</span><span class="op" id="3838055">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838060">if</span>&nbsp;<span class="ident" id="3838063">length</span>&nbsp;<span class="op" id="3838070">&gt;</span>&nbsp;<span class="num" id="3838072">0</span>&nbsp;<span class="op" id="3838074">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838080">return</span>&nbsp;<span class="builtintype" id="3838087">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3838096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3838101">m</span><span class="op" id="3838102">.</span><span class="ident" id="3838103">nextProtoNeg</span>&nbsp;<span class="op" id="3838116">=</span>&nbsp;<span class="builtintype" id="3838118">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838125">case</span>&nbsp;<span class="ident" id="3838130">extensionStatusRequest</span><span class="op" id="3838152">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3838157">m</span><span class="op" id="3838158">.</span><span class="ident" id="3838159">ocspStapling</span>&nbsp;<span class="op" id="3838172">=</span>&nbsp;<span class="ident" id="3838174">length</span>&nbsp;<span class="op" id="3838181">&gt;</span>&nbsp;<span class="num" id="3838183">0</span>&nbsp;<span class="op" id="3838185">&amp;&amp;</span>&nbsp;<span class="ident" id="3838188">data</span><span class="op" id="3838192">[</span><span class="num" id="3838193">0</span><span class="op" id="3838194">]</span>&nbsp;<span class="op" id="3838196">==</span>&nbsp;<span class="ident" id="3838199">statusTypeOCSP</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838216">case</span>&nbsp;<span class="ident" id="3838221">extensionSupportedCurves</span><span class="op" id="3838245">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3838250">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838305">if</span>&nbsp;<span class="ident" id="3838308">length</span>&nbsp;<span class="op" id="3838315">&lt;</span>&nbsp;<span class="num" id="3838317">2</span>&nbsp;<span class="op" id="3838319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838325">return</span>&nbsp;<span class="builtintype" id="3838332">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3838341">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3838346">l</span>&nbsp;<span class="op" id="3838348">:=</span>&nbsp;<span class="builtintype" id="3838351">int</span><span class="op" id="3838354">(</span><span class="ident" id="3838355">data</span><span class="op" id="3838359">[</span><span class="num" id="3838360">0</span><span class="op" id="3838361">]</span><span class="op" id="3838362">)</span><span class="op" id="3838363">&lt;&lt;</span><span class="num" id="3838365">8</span>&nbsp;<span class="op" id="3838367">|</span>&nbsp;<span class="builtintype" id="3838369">int</span><span class="op" id="3838372">(</span><span class="ident" id="3838373">data</span><span class="op" id="3838377">[</span><span class="num" id="3838378">1</span><span class="op" id="3838379">]</span><span class="op" id="3838380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838385">if</span>&nbsp;<span class="ident" id="3838388">l</span><span class="op" id="3838389">%</span><span class="num" id="3838390">2</span>&nbsp;<span class="op" id="3838392">==</span>&nbsp;<span class="num" id="3838395">1</span>&nbsp;<span class="op" id="3838397">||</span>&nbsp;<span class="ident" id="3838400">length</span>&nbsp;<span class="op" id="3838407">!=</span>&nbsp;<span class="ident" id="3838410">l</span><span class="op" id="3838411">+</span><span class="num" id="3838412">2</span>&nbsp;<span class="op" id="3838414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838420">return</span>&nbsp;<span class="builtintype" id="3838427">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3838436">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3838441">numCurves</span>&nbsp;<span class="op" id="3838451">:=</span>&nbsp;<span class="ident" id="3838454">l</span>&nbsp;<span class="op" id="3838456">/</span>&nbsp;<span class="num" id="3838458">2</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3838463">m</span><span class="op" id="3838464">.</span><span class="ident" id="3838465">supportedCurves</span>&nbsp;<span class="op" id="3838481">=</span>&nbsp;<span class="builtinfunc" id="3838483">make</span><span class="op" id="3838487">(</span><span class="op" id="3838488">[</span><span class="op" id="3838489">]</span><span class="ident" id="3838490">CurveID</span><span class="op" id="3838497">,</span>&nbsp;<span class="ident" id="3838499">numCurves</span><span class="op" id="3838508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3838513">d</span>&nbsp;<span class="op" id="3838515">:=</span>&nbsp;<span class="ident" id="3838518">data</span><span class="op" id="3838522">[</span><span class="num" id="3838523">2</span><span class="op" id="3838524">:</span><span class="op" id="3838525">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838530">for</span>&nbsp;<span class="ident" id="3838534">i</span>&nbsp;<span class="op" id="3838536">:=</span>&nbsp;<span class="num" id="3838539">0</span><span class="op" id="3838540">;</span>&nbsp;<span class="ident" id="3838542">i</span>&nbsp;<span class="op" id="3838544">&lt;</span>&nbsp;<span class="ident" id="3838546">numCurves</span><span class="op" id="3838555">;</span>&nbsp;<span class="ident" id="3838557">i</span><span class="op" id="3838558">++</span>&nbsp;<span class="op" id="3838561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3838567">m</span><span class="op" id="3838568">.</span><span class="ident" id="3838569">supportedCurves</span><span class="op" id="3838584">[</span><span class="ident" id="3838585">i</span><span class="op" id="3838586">]</span>&nbsp;<span class="op" id="3838588">=</span>&nbsp;<span class="ident" id="3838590">CurveID</span><span class="op" id="3838597">(</span><span class="ident" id="3838598">d</span><span class="op" id="3838599">[</span><span class="num" id="3838600">0</span><span class="op" id="3838601">]</span><span class="op" id="3838602">)</span><span class="op" id="3838603">&lt;&lt;</span><span class="num" id="3838605">8</span>&nbsp;<span class="op" id="3838607">|</span>&nbsp;<span class="ident" id="3838609">CurveID</span><span class="op" id="3838616">(</span><span class="ident" id="3838617">d</span><span class="op" id="3838618">[</span><span class="num" id="3838619">1</span><span class="op" id="3838620">]</span><span class="op" id="3838621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3838627">d</span>&nbsp;<span class="op" id="3838629">=</span>&nbsp;<span class="ident" id="3838631">d</span><span class="op" id="3838632">[</span><span class="num" id="3838633">2</span><span class="op" id="3838634">:</span><span class="op" id="3838635">]</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3838640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838644">case</span>&nbsp;<span class="ident" id="3838649">extensionSupportedPoints</span><span class="op" id="3838673">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3838678">//&nbsp;http://tools.ietf.org/html/rfc4492#section-5.5.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838733">if</span>&nbsp;<span class="ident" id="3838736">length</span>&nbsp;<span class="op" id="3838743">&lt;</span>&nbsp;<span class="num" id="3838745">1</span>&nbsp;<span class="op" id="3838747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838753">return</span>&nbsp;<span class="builtintype" id="3838760">false</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3838769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3838774">l</span>&nbsp;<span class="op" id="3838776">:=</span>&nbsp;<span class="builtintype" id="3838779">int</span><span class="op" id="3838782">(</span><span class="ident" id="3838783">data</span><span class="op" id="3838787">[</span><span class="num" id="3838788">0</span><span class="op" id="3838789">]</span><span class="op" id="3838790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838795">if</span>&nbsp;<span class="ident" id="3838798">length</span>&nbsp;<span class="op" id="3838805">!=</span>&nbsp;<span class="ident" id="3838808">l</span><span class="op" id="3838809">+</span><span class="num" id="3838810">1</span>&nbsp;<span class="op" id="3838812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838818">return</span>&nbsp;<span class="builtintype" id="3838825">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3838834">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3838839">m</span><span class="op" id="3838840">.</span><span class="ident" id="3838841">supportedPoints</span>&nbsp;<span class="op" id="3838857">=</span>&nbsp;<span class="builtinfunc" id="3838859">make</span><span class="op" id="3838863">(</span><span class="op" id="3838864">[</span><span class="op" id="3838865">]</span><span class="builtintype" id="3838866">uint8</span><span class="op" id="3838871">,</span>&nbsp;<span class="ident" id="3838873">l</span><span class="op" id="3838874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3838879">copy</span><span class="op" id="3838883">(</span><span class="ident" id="3838884">m</span><span class="op" id="3838885">.</span><span class="ident" id="3838886">supportedPoints</span><span class="op" id="3838901">,</span>&nbsp;<span class="ident" id="3838903">data</span><span class="op" id="3838907">[</span><span class="num" id="3838908">1</span><span class="op" id="3838909">:</span><span class="op" id="3838910">]</span><span class="op" id="3838911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3838915">case</span>&nbsp;<span class="ident" id="3838920">extensionSessionTicket</span><span class="op" id="3838942">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3838947">//&nbsp;http://tools.ietf.org/html/rfc5077#section-3.2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839000">m</span><span class="op" id="3839001">.</span><span class="ident" id="3839002">ticketSupported</span>&nbsp;<span class="op" id="3839018">=</span>&nbsp;<span class="builtintype" id="3839020">true</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839028">m</span><span class="op" id="3839029">.</span><span class="ident" id="3839030">sessionTicket</span>&nbsp;<span class="op" id="3839044">=</span>&nbsp;<span class="ident" id="3839046">data</span><span class="op" id="3839050">[</span><span class="op" id="3839051">:</span><span class="ident" id="3839052">length</span><span class="op" id="3839058">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839062">case</span>&nbsp;<span class="ident" id="3839067">extensionSignatureAlgorithms</span><span class="op" id="3839095">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3839100">//&nbsp;https://tools.ietf.org/html/rfc5246#section-7.4.1.4.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839160">if</span>&nbsp;<span class="ident" id="3839163">length</span>&nbsp;<span class="op" id="3839170">&lt;</span>&nbsp;<span class="num" id="3839172">2</span>&nbsp;<span class="op" id="3839174">||</span>&nbsp;<span class="ident" id="3839177">length</span><span class="op" id="3839183">&amp;</span><span class="num" id="3839184">1</span>&nbsp;<span class="op" id="3839186">!=</span>&nbsp;<span class="num" id="3839189">0</span>&nbsp;<span class="op" id="3839191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839197">return</span>&nbsp;<span class="builtintype" id="3839204">false</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3839213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839218">l</span>&nbsp;<span class="op" id="3839220">:=</span>&nbsp;<span class="builtintype" id="3839223">int</span><span class="op" id="3839226">(</span><span class="ident" id="3839227">data</span><span class="op" id="3839231">[</span><span class="num" id="3839232">0</span><span class="op" id="3839233">]</span><span class="op" id="3839234">)</span><span class="op" id="3839235">&lt;&lt;</span><span class="num" id="3839237">8</span>&nbsp;<span class="op" id="3839239">|</span>&nbsp;<span class="builtintype" id="3839241">int</span><span class="op" id="3839244">(</span><span class="ident" id="3839245">data</span><span class="op" id="3839249">[</span><span class="num" id="3839250">1</span><span class="op" id="3839251">]</span><span class="op" id="3839252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839257">if</span>&nbsp;<span class="ident" id="3839260">l</span>&nbsp;<span class="op" id="3839262">!=</span>&nbsp;<span class="ident" id="3839265">length</span><span class="op" id="3839271">-</span><span class="num" id="3839272">2</span>&nbsp;<span class="op" id="3839274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839280">return</span>&nbsp;<span class="builtintype" id="3839287">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3839296">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839301">n</span>&nbsp;<span class="op" id="3839303">:=</span>&nbsp;<span class="ident" id="3839306">l</span>&nbsp;<span class="op" id="3839308">/</span>&nbsp;<span class="num" id="3839310">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839315">d</span>&nbsp;<span class="op" id="3839317">:=</span>&nbsp;<span class="ident" id="3839320">data</span><span class="op" id="3839324">[</span><span class="num" id="3839325">2</span><span class="op" id="3839326">:</span><span class="op" id="3839327">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839332">m</span><span class="op" id="3839333">.</span><span class="ident" id="3839334">signatureAndHashes</span>&nbsp;<span class="op" id="3839353">=</span>&nbsp;<span class="builtinfunc" id="3839355">make</span><span class="op" id="3839359">(</span><span class="op" id="3839360">[</span><span class="op" id="3839361">]</span><span class="ident" id="3839362">signatureAndHash</span><span class="op" id="3839378">,</span>&nbsp;<span class="ident" id="3839380">n</span><span class="op" id="3839381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839386">for</span>&nbsp;<span class="ident" id="3839390">i</span>&nbsp;<span class="op" id="3839392">:=</span>&nbsp;<span class="keyword" id="3839395">range</span>&nbsp;<span class="ident" id="3839401">m</span><span class="op" id="3839402">.</span><span class="ident" id="3839403">signatureAndHashes</span>&nbsp;<span class="op" id="3839422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839428">m</span><span class="op" id="3839429">.</span><span class="ident" id="3839430">signatureAndHashes</span><span class="op" id="3839448">[</span><span class="ident" id="3839449">i</span><span class="op" id="3839450">]</span><span class="op" id="3839451">.</span><span class="ident" id="3839452">hash</span>&nbsp;<span class="op" id="3839457">=</span>&nbsp;<span class="ident" id="3839459">d</span><span class="op" id="3839460">[</span><span class="num" id="3839461">0</span><span class="op" id="3839462">]</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839468">m</span><span class="op" id="3839469">.</span><span class="ident" id="3839470">signatureAndHashes</span><span class="op" id="3839488">[</span><span class="ident" id="3839489">i</span><span class="op" id="3839490">]</span><span class="op" id="3839491">.</span><span class="ident" id="3839492">signature</span>&nbsp;<span class="op" id="3839502">=</span>&nbsp;<span class="ident" id="3839504">d</span><span class="op" id="3839505">[</span><span class="num" id="3839506">1</span><span class="op" id="3839507">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839513">d</span>&nbsp;<span class="op" id="3839515">=</span>&nbsp;<span class="ident" id="3839517">d</span><span class="op" id="3839518">[</span><span class="num" id="3839519">2</span><span class="op" id="3839520">:</span><span class="op" id="3839521">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3839526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839530">case</span>&nbsp;<span class="ident" id="3839535">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3839562">+</span>&nbsp;<span class="num" id="3839564">1</span><span class="op" id="3839565">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839570">if</span>&nbsp;<span class="ident" id="3839573">length</span>&nbsp;<span class="op" id="3839580">!=</span>&nbsp;<span class="num" id="3839583">1</span>&nbsp;<span class="op" id="3839585">||</span>&nbsp;<span class="ident" id="3839588">data</span><span class="op" id="3839592">[</span><span class="num" id="3839593">0</span><span class="op" id="3839594">]</span>&nbsp;<span class="op" id="3839596">!=</span>&nbsp;<span class="num" id="3839599">0</span>&nbsp;<span class="op" id="3839601">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839607">return</span>&nbsp;<span class="builtintype" id="3839614">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3839623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839628">m</span><span class="op" id="3839629">.</span><span class="ident" id="3839630">secureRenegotiation</span>&nbsp;<span class="op" id="3839650">=</span>&nbsp;<span class="builtintype" id="3839652">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839659">case</span>&nbsp;<span class="ident" id="3839664">extensionALPN</span><span class="op" id="3839677">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839682">if</span>&nbsp;<span class="ident" id="3839685">length</span>&nbsp;<span class="op" id="3839692">&lt;</span>&nbsp;<span class="num" id="3839694">2</span>&nbsp;<span class="op" id="3839696">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839702">return</span>&nbsp;<span class="builtintype" id="3839709">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3839718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839723">l</span>&nbsp;<span class="op" id="3839725">:=</span>&nbsp;<span class="builtintype" id="3839728">int</span><span class="op" id="3839731">(</span><span class="ident" id="3839732">data</span><span class="op" id="3839736">[</span><span class="num" id="3839737">0</span><span class="op" id="3839738">]</span><span class="op" id="3839739">)</span><span class="op" id="3839740">&lt;&lt;</span><span class="num" id="3839742">8</span>&nbsp;<span class="op" id="3839744">|</span>&nbsp;<span class="builtintype" id="3839746">int</span><span class="op" id="3839749">(</span><span class="ident" id="3839750">data</span><span class="op" id="3839754">[</span><span class="num" id="3839755">1</span><span class="op" id="3839756">]</span><span class="op" id="3839757">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839762">if</span>&nbsp;<span class="ident" id="3839765">l</span>&nbsp;<span class="op" id="3839767">!=</span>&nbsp;<span class="ident" id="3839770">length</span><span class="op" id="3839776">-</span><span class="num" id="3839777">2</span>&nbsp;<span class="op" id="3839779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839785">return</span>&nbsp;<span class="builtintype" id="3839792">false</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3839801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839806">d</span>&nbsp;<span class="op" id="3839808">:=</span>&nbsp;<span class="ident" id="3839811">data</span><span class="op" id="3839815">[</span><span class="num" id="3839816">2</span><span class="op" id="3839817">:</span><span class="ident" id="3839818">length</span><span class="op" id="3839824">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839829">for</span>&nbsp;<span class="builtinfunc" id="3839833">len</span><span class="op" id="3839836">(</span><span class="ident" id="3839837">d</span><span class="op" id="3839838">)</span>&nbsp;<span class="op" id="3839840">!=</span>&nbsp;<span class="num" id="3839843">0</span>&nbsp;<span class="op" id="3839845">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839851">stringLen</span>&nbsp;<span class="op" id="3839861">:=</span>&nbsp;<span class="builtintype" id="3839864">int</span><span class="op" id="3839867">(</span><span class="ident" id="3839868">d</span><span class="op" id="3839869">[</span><span class="num" id="3839870">0</span><span class="op" id="3839871">]</span><span class="op" id="3839872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839878">d</span>&nbsp;<span class="op" id="3839880">=</span>&nbsp;<span class="ident" id="3839882">d</span><span class="op" id="3839883">[</span><span class="num" id="3839884">1</span><span class="op" id="3839885">:</span><span class="op" id="3839886">]</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839892">if</span>&nbsp;<span class="ident" id="3839895">stringLen</span>&nbsp;<span class="op" id="3839905">==</span>&nbsp;<span class="num" id="3839908">0</span>&nbsp;<span class="op" id="3839910">||</span>&nbsp;<span class="ident" id="3839913">stringLen</span>&nbsp;<span class="op" id="3839923">&gt;</span>&nbsp;<span class="builtinfunc" id="3839925">len</span><span class="op" id="3839928">(</span><span class="ident" id="3839929">d</span><span class="op" id="3839930">)</span>&nbsp;<span class="op" id="3839932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3839939">return</span>&nbsp;<span class="builtintype" id="3839946">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3839956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3839962">m</span><span class="op" id="3839963">.</span><span class="ident" id="3839964">alpnProtocols</span>&nbsp;<span class="op" id="3839978">=</span>&nbsp;<span class="builtinfunc" id="3839980">append</span><span class="op" id="3839986">(</span><span class="ident" id="3839987">m</span><span class="op" id="3839988">.</span><span class="ident" id="3839989">alpnProtocols</span><span class="op" id="3840002">,</span>&nbsp;<span class="builtintype" id="3840004">string</span><span class="op" id="3840010">(</span><span class="ident" id="3840011">d</span><span class="op" id="3840012">[</span><span class="op" id="3840013">:</span><span class="ident" id="3840014">stringLen</span><span class="op" id="3840023">]</span><span class="op" id="3840024">)</span><span class="op" id="3840025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840031">d</span>&nbsp;<span class="op" id="3840033">=</span>&nbsp;<span class="ident" id="3840035">d</span><span class="op" id="3840036">[</span><span class="ident" id="3840037">stringLen</span><span class="op" id="3840046">:</span><span class="op" id="3840047">]</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3840052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3840056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840060">data</span>&nbsp;<span class="op" id="3840065">=</span>&nbsp;<span class="ident" id="3840067">data</span><span class="op" id="3840071">[</span><span class="ident" id="3840072">length</span><span class="op" id="3840078">:</span><span class="op" id="3840079">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3840082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840086">return</span>&nbsp;<span class="builtintype" id="3840093">true</span><br>
<span class="lineno"></span><span class="op" id="3840098">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3840101">type</span>&nbsp;<span class="ident" id="3840106">serverHelloMsg</span>&nbsp;<span class="keyword" id="3840121">struct</span>&nbsp;<span class="op" id="3840128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840131">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3840151">[</span><span class="op" id="3840152">]</span><span class="builtintype" id="3840153">byte</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840159">vers</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3840179">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840187">random</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3840207">[</span><span class="op" id="3840208">]</span><span class="builtintype" id="3840209">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840215">sessionId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3840235">[</span><span class="op" id="3840236">]</span><span class="builtintype" id="3840237">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840243">cipherSuite</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3840263">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840271">compressionMethod</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3840291">uint8</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840298">nextProtoNeg</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3840318">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840324">nextProtos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3840344">[</span><span class="op" id="3840345">]</span><span class="builtintype" id="3840346">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840354">ocspStapling</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3840374">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840380">ticketSupported</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3840400">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840406">secureRenegotiation</span>&nbsp;<span class="builtintype" id="3840426">bool</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840432">alpnProtocol</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3840452">string</span><br>
<span class="lineno"></span><span class="op" id="3840459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3840462">func</span>&nbsp;<span class="op" id="3840467">(</span><span class="ident" id="3840468">m</span>&nbsp;<span class="op" id="3840470">*</span><span class="ident" id="3840471">serverHelloMsg</span><span class="op" id="3840485">)</span>&nbsp;<span class="ident" id="3840487">equal</span><span class="op" id="3840492">(</span><span class="ident" id="3840493">i</span>&nbsp;<span class="keyword" id="3840495">interface</span><span class="op" id="3840504">{</span><span class="op" id="3840505">}</span><span class="op" id="3840506">)</span>&nbsp;<span class="builtintype" id="3840508">bool</span>&nbsp;<span class="op" id="3840513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840516">m1</span><span class="op" id="3840518">,</span>&nbsp;<span class="ident" id="3840520">ok</span>&nbsp;<span class="op" id="3840523">:=</span>&nbsp;<span class="ident" id="3840526">i</span><span class="op" id="3840527">.</span><span class="op" id="3840528">(</span><span class="op" id="3840529">*</span><span class="ident" id="3840530">serverHelloMsg</span><span class="op" id="3840544">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840547">if</span>&nbsp;<span class="op" id="3840550">!</span><span class="ident" id="3840551">ok</span>&nbsp;<span class="op" id="3840554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840558">return</span>&nbsp;<span class="builtintype" id="3840565">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3840572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3840576">return</span>&nbsp;<span class="ident" id="3840583">bytes</span><span class="op" id="3840588">.</span><span class="ident" id="3840589">Equal</span><span class="op" id="3840594">(</span><span class="ident" id="3840595">m</span><span class="op" id="3840596">.</span><span class="ident" id="3840597">raw</span><span class="op" id="3840600">,</span>&nbsp;<span class="ident" id="3840602">m1</span><span class="op" id="3840604">.</span><span class="ident" id="3840605">raw</span><span class="op" id="3840608">)</span>&nbsp;<span class="op" id="3840610">&amp;&amp;</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840615">m</span><span class="op" id="3840616">.</span><span class="ident" id="3840617">vers</span>&nbsp;<span class="op" id="3840622">==</span>&nbsp;<span class="ident" id="3840625">m1</span><span class="op" id="3840627">.</span><span class="ident" id="3840628">vers</span>&nbsp;<span class="op" id="3840633">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840638">bytes</span><span class="op" id="3840643">.</span><span class="ident" id="3840644">Equal</span><span class="op" id="3840649">(</span><span class="ident" id="3840650">m</span><span class="op" id="3840651">.</span><span class="ident" id="3840652">random</span><span class="op" id="3840658">,</span>&nbsp;<span class="ident" id="3840660">m1</span><span class="op" id="3840662">.</span><span class="ident" id="3840663">random</span><span class="op" id="3840669">)</span>&nbsp;<span class="op" id="3840671">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840676">bytes</span><span class="op" id="3840681">.</span><span class="ident" id="3840682">Equal</span><span class="op" id="3840687">(</span><span class="ident" id="3840688">m</span><span class="op" id="3840689">.</span><span class="ident" id="3840690">sessionId</span><span class="op" id="3840699">,</span>&nbsp;<span class="ident" id="3840701">m1</span><span class="op" id="3840703">.</span><span class="ident" id="3840704">sessionId</span><span class="op" id="3840713">)</span>&nbsp;<span class="op" id="3840715">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840720">m</span><span class="op" id="3840721">.</span><span class="ident" id="3840722">cipherSuite</span>&nbsp;<span class="op" id="3840734">==</span>&nbsp;<span class="ident" id="3840737">m1</span><span class="op" id="3840739">.</span><span class="ident" id="3840740">cipherSuite</span>&nbsp;<span class="op" id="3840752">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840757">m</span><span class="op" id="3840758">.</span><span class="ident" id="3840759">compressionMethod</span>&nbsp;<span class="op" id="3840777">==</span>&nbsp;<span class="ident" id="3840780">m1</span><span class="op" id="3840782">.</span><span class="ident" id="3840783">compressionMethod</span>&nbsp;<span class="op" id="3840801">&amp;&amp;</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840806">m</span><span class="op" id="3840807">.</span><span class="ident" id="3840808">nextProtoNeg</span>&nbsp;<span class="op" id="3840821">==</span>&nbsp;<span class="ident" id="3840824">m1</span><span class="op" id="3840826">.</span><span class="ident" id="3840827">nextProtoNeg</span>&nbsp;<span class="op" id="3840840">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840845">eqStrings</span><span class="op" id="3840854">(</span><span class="ident" id="3840855">m</span><span class="op" id="3840856">.</span><span class="ident" id="3840857">nextProtos</span><span class="op" id="3840867">,</span>&nbsp;<span class="ident" id="3840869">m1</span><span class="op" id="3840871">.</span><span class="ident" id="3840872">nextProtos</span><span class="op" id="3840882">)</span>&nbsp;<span class="op" id="3840884">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840889">m</span><span class="op" id="3840890">.</span><span class="ident" id="3840891">ocspStapling</span>&nbsp;<span class="op" id="3840904">==</span>&nbsp;<span class="ident" id="3840907">m1</span><span class="op" id="3840909">.</span><span class="ident" id="3840910">ocspStapling</span>&nbsp;<span class="op" id="3840923">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840928">m</span><span class="op" id="3840929">.</span><span class="ident" id="3840930">ticketSupported</span>&nbsp;<span class="op" id="3840946">==</span>&nbsp;<span class="ident" id="3840949">m1</span><span class="op" id="3840951">.</span><span class="ident" id="3840952">ticketSupported</span>&nbsp;<span class="op" id="3840968">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3840973">m</span><span class="op" id="3840974">.</span><span class="ident" id="3840975">secureRenegotiation</span>&nbsp;<span class="op" id="3840995">==</span>&nbsp;<span class="ident" id="3840998">m1</span><span class="op" id="3841000">.</span><span class="ident" id="3841001">secureRenegotiation</span>&nbsp;<span class="op" id="3841021">&amp;&amp;</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841026">m</span><span class="op" id="3841027">.</span><span class="ident" id="3841028">alpnProtocol</span>&nbsp;<span class="op" id="3841041">==</span>&nbsp;<span class="ident" id="3841044">m1</span><span class="op" id="3841046">.</span><span class="ident" id="3841047">alpnProtocol</span><br>
<span class="lineno"></span><span class="op" id="3841060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3841063">func</span>&nbsp;<span class="op" id="3841068">(</span><span class="ident" id="3841069">m</span>&nbsp;<span class="op" id="3841071">*</span><span class="ident" id="3841072">serverHelloMsg</span><span class="op" id="3841086">)</span>&nbsp;<span class="ident" id="3841088">marshal</span><span class="op" id="3841095">(</span><span class="op" id="3841096">)</span>&nbsp;<span class="op" id="3841098">[</span><span class="op" id="3841099">]</span><span class="builtintype" id="3841100">byte</span>&nbsp;<span class="op" id="3841105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3841108">if</span>&nbsp;<span class="ident" id="3841111">m</span><span class="op" id="3841112">.</span><span class="ident" id="3841113">raw</span>&nbsp;<span class="op" id="3841117">!=</span>&nbsp;<span class="ident" id="3841120">nil</span>&nbsp;<span class="op" id="3841124">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3841128">return</span>&nbsp;<span class="ident" id="3841135">m</span><span class="op" id="3841136">.</span><span class="ident" id="3841137">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3841142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841146">length</span>&nbsp;<span class="op" id="3841153">:=</span>&nbsp;<span class="num" id="3841156">38</span>&nbsp;<span class="op" id="3841159">+</span>&nbsp;<span class="builtinfunc" id="3841161">len</span><span class="op" id="3841164">(</span><span class="ident" id="3841165">m</span><span class="op" id="3841166">.</span><span class="ident" id="3841167">sessionId</span><span class="op" id="3841176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841179">numExtensions</span>&nbsp;<span class="op" id="3841193">:=</span>&nbsp;<span class="num" id="3841196">0</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841199">extensionsLength</span>&nbsp;<span class="op" id="3841216">:=</span>&nbsp;<span class="num" id="3841219">0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841223">nextProtoLen</span>&nbsp;<span class="op" id="3841236">:=</span>&nbsp;<span class="num" id="3841239">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3841242">if</span>&nbsp;<span class="ident" id="3841245">m</span><span class="op" id="3841246">.</span><span class="ident" id="3841247">nextProtoNeg</span>&nbsp;<span class="op" id="3841260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841264">numExtensions</span><span class="op" id="3841277">++</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3841282">for</span>&nbsp;<span class="ident" id="3841286">_</span><span class="op" id="3841287">,</span>&nbsp;<span class="ident" id="3841289">v</span>&nbsp;<span class="op" id="3841291">:=</span>&nbsp;<span class="keyword" id="3841294">range</span>&nbsp;<span class="ident" id="3841300">m</span><span class="op" id="3841301">.</span><span class="ident" id="3841302">nextProtos</span>&nbsp;<span class="op" id="3841313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841318">nextProtoLen</span>&nbsp;<span class="op" id="3841331">+=</span>&nbsp;<span class="builtinfunc" id="3841334">len</span><span class="op" id="3841337">(</span><span class="ident" id="3841338">v</span><span class="op" id="3841339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3841343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841347">nextProtoLen</span>&nbsp;<span class="op" id="3841360">+=</span>&nbsp;<span class="builtinfunc" id="3841363">len</span><span class="op" id="3841366">(</span><span class="ident" id="3841367">m</span><span class="op" id="3841368">.</span><span class="ident" id="3841369">nextProtos</span><span class="op" id="3841379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841383">extensionsLength</span>&nbsp;<span class="op" id="3841400">+=</span>&nbsp;<span class="ident" id="3841403">nextProtoLen</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3841417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3841420">if</span>&nbsp;<span class="ident" id="3841423">m</span><span class="op" id="3841424">.</span><span class="ident" id="3841425">ocspStapling</span>&nbsp;<span class="op" id="3841438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841442">numExtensions</span><span class="op" id="3841455">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3841459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3841462">if</span>&nbsp;<span class="ident" id="3841465">m</span><span class="op" id="3841466">.</span><span class="ident" id="3841467">ticketSupported</span>&nbsp;<span class="op" id="3841483">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841487">numExtensions</span><span class="op" id="3841500">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3841504">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3841507">if</span>&nbsp;<span class="ident" id="3841510">m</span><span class="op" id="3841511">.</span><span class="ident" id="3841512">secureRenegotiation</span>&nbsp;<span class="op" id="3841532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841536">extensionsLength</span>&nbsp;<span class="op" id="3841553">+=</span>&nbsp;<span class="num" id="3841556">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841560">numExtensions</span><span class="op" id="3841573">++</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3841577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3841580">if</span>&nbsp;<span class="ident" id="3841583">alpnLen</span>&nbsp;<span class="op" id="3841591">:=</span>&nbsp;<span class="builtinfunc" id="3841594">len</span><span class="op" id="3841597">(</span><span class="ident" id="3841598">m</span><span class="op" id="3841599">.</span><span class="ident" id="3841600">alpnProtocol</span><span class="op" id="3841612">)</span><span class="op" id="3841613">;</span>&nbsp;<span class="ident" id="3841615">alpnLen</span>&nbsp;<span class="op" id="3841623">&gt;</span>&nbsp;<span class="num" id="3841625">0</span>&nbsp;<span class="op" id="3841627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3841631">if</span>&nbsp;<span class="ident" id="3841634">alpnLen</span>&nbsp;<span class="op" id="3841642">&gt;=</span>&nbsp;<span class="num" id="3841645">256</span>&nbsp;<span class="op" id="3841649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3841654">panic</span><span class="op" id="3841659">(</span><span class="string" id="3841660">&#34;invalid&nbsp;ALPN&nbsp;protocol&#34;</span><span class="op" id="3841683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3841687">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841691">extensionsLength</span>&nbsp;<span class="op" id="3841708">+=</span>&nbsp;<span class="num" id="3841711">2</span>&nbsp;<span class="op" id="3841713">+</span>&nbsp;<span class="num" id="3841715">1</span>&nbsp;<span class="op" id="3841717">+</span>&nbsp;<span class="ident" id="3841719">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841729">numExtensions</span><span class="op" id="3841742">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3841746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3841750">if</span>&nbsp;<span class="ident" id="3841753">numExtensions</span>&nbsp;<span class="op" id="3841767">&gt;</span>&nbsp;<span class="num" id="3841769">0</span>&nbsp;<span class="op" id="3841771">{</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841775">extensionsLength</span>&nbsp;<span class="op" id="3841792">+=</span>&nbsp;<span class="num" id="3841795">4</span>&nbsp;<span class="op" id="3841797">*</span>&nbsp;<span class="ident" id="3841799">numExtensions</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841815">length</span>&nbsp;<span class="op" id="3841822">+=</span>&nbsp;<span class="num" id="3841825">2</span>&nbsp;<span class="op" id="3841827">+</span>&nbsp;<span class="ident" id="3841829">extensionsLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3841847">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841851">x</span>&nbsp;<span class="op" id="3841853">:=</span>&nbsp;<span class="builtinfunc" id="3841856">make</span><span class="op" id="3841860">(</span><span class="op" id="3841861">[</span><span class="op" id="3841862">]</span><span class="builtintype" id="3841863">byte</span><span class="op" id="3841867">,</span>&nbsp;<span class="num" id="3841869">4</span><span class="op" id="3841870">+</span><span class="ident" id="3841871">length</span><span class="op" id="3841877">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841880">x</span><span class="op" id="3841881">[</span><span class="num" id="3841882">0</span><span class="op" id="3841883">]</span>&nbsp;<span class="op" id="3841885">=</span>&nbsp;<span class="ident" id="3841887">typeServerHello</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841904">x</span><span class="op" id="3841905">[</span><span class="num" id="3841906">1</span><span class="op" id="3841907">]</span>&nbsp;<span class="op" id="3841909">=</span>&nbsp;<span class="builtintype" id="3841911">uint8</span><span class="op" id="3841916">(</span><span class="ident" id="3841917">length</span>&nbsp;<span class="op" id="3841924">&gt;&gt;</span>&nbsp;<span class="num" id="3841927">16</span><span class="op" id="3841929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841932">x</span><span class="op" id="3841933">[</span><span class="num" id="3841934">2</span><span class="op" id="3841935">]</span>&nbsp;<span class="op" id="3841937">=</span>&nbsp;<span class="builtintype" id="3841939">uint8</span><span class="op" id="3841944">(</span><span class="ident" id="3841945">length</span>&nbsp;<span class="op" id="3841952">&gt;&gt;</span>&nbsp;<span class="num" id="3841955">8</span><span class="op" id="3841956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841959">x</span><span class="op" id="3841960">[</span><span class="num" id="3841961">3</span><span class="op" id="3841962">]</span>&nbsp;<span class="op" id="3841964">=</span>&nbsp;<span class="builtintype" id="3841966">uint8</span><span class="op" id="3841971">(</span><span class="ident" id="3841972">length</span><span class="op" id="3841978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3841981">x</span><span class="op" id="3841982">[</span><span class="num" id="3841983">4</span><span class="op" id="3841984">]</span>&nbsp;<span class="op" id="3841986">=</span>&nbsp;<span class="builtintype" id="3841988">uint8</span><span class="op" id="3841993">(</span><span class="ident" id="3841994">m</span><span class="op" id="3841995">.</span><span class="ident" id="3841996">vers</span>&nbsp;<span class="op" id="3842001">&gt;&gt;</span>&nbsp;<span class="num" id="3842004">8</span><span class="op" id="3842005">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842008">x</span><span class="op" id="3842009">[</span><span class="num" id="3842010">5</span><span class="op" id="3842011">]</span>&nbsp;<span class="op" id="3842013">=</span>&nbsp;<span class="builtintype" id="3842015">uint8</span><span class="op" id="3842020">(</span><span class="ident" id="3842021">m</span><span class="op" id="3842022">.</span><span class="ident" id="3842023">vers</span><span class="op" id="3842027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3842030">copy</span><span class="op" id="3842034">(</span><span class="ident" id="3842035">x</span><span class="op" id="3842036">[</span><span class="num" id="3842037">6</span><span class="op" id="3842038">:</span><span class="num" id="3842039">38</span><span class="op" id="3842041">]</span><span class="op" id="3842042">,</span>&nbsp;<span class="ident" id="3842044">m</span><span class="op" id="3842045">.</span><span class="ident" id="3842046">random</span><span class="op" id="3842052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842055">x</span><span class="op" id="3842056">[</span><span class="num" id="3842057">38</span><span class="op" id="3842059">]</span>&nbsp;<span class="op" id="3842061">=</span>&nbsp;<span class="builtintype" id="3842063">uint8</span><span class="op" id="3842068">(</span><span class="builtinfunc" id="3842069">len</span><span class="op" id="3842072">(</span><span class="ident" id="3842073">m</span><span class="op" id="3842074">.</span><span class="ident" id="3842075">sessionId</span><span class="op" id="3842084">)</span><span class="op" id="3842085">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3842088">copy</span><span class="op" id="3842092">(</span><span class="ident" id="3842093">x</span><span class="op" id="3842094">[</span><span class="num" id="3842095">39</span><span class="op" id="3842097">:</span><span class="num" id="3842098">39</span><span class="op" id="3842100">+</span><span class="builtinfunc" id="3842101">len</span><span class="op" id="3842104">(</span><span class="ident" id="3842105">m</span><span class="op" id="3842106">.</span><span class="ident" id="3842107">sessionId</span><span class="op" id="3842116">)</span><span class="op" id="3842117">]</span><span class="op" id="3842118">,</span>&nbsp;<span class="ident" id="3842120">m</span><span class="op" id="3842121">.</span><span class="ident" id="3842122">sessionId</span><span class="op" id="3842131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842134">z</span>&nbsp;<span class="op" id="3842136">:=</span>&nbsp;<span class="ident" id="3842139">x</span><span class="op" id="3842140">[</span><span class="num" id="3842141">39</span><span class="op" id="3842143">+</span><span class="builtinfunc" id="3842144">len</span><span class="op" id="3842147">(</span><span class="ident" id="3842148">m</span><span class="op" id="3842149">.</span><span class="ident" id="3842150">sessionId</span><span class="op" id="3842159">)</span><span class="op" id="3842160">:</span><span class="op" id="3842161">]</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842164">z</span><span class="op" id="3842165">[</span><span class="num" id="3842166">0</span><span class="op" id="3842167">]</span>&nbsp;<span class="op" id="3842169">=</span>&nbsp;<span class="builtintype" id="3842171">uint8</span><span class="op" id="3842176">(</span><span class="ident" id="3842177">m</span><span class="op" id="3842178">.</span><span class="ident" id="3842179">cipherSuite</span>&nbsp;<span class="op" id="3842191">&gt;&gt;</span>&nbsp;<span class="num" id="3842194">8</span><span class="op" id="3842195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842198">z</span><span class="op" id="3842199">[</span><span class="num" id="3842200">1</span><span class="op" id="3842201">]</span>&nbsp;<span class="op" id="3842203">=</span>&nbsp;<span class="builtintype" id="3842205">uint8</span><span class="op" id="3842210">(</span><span class="ident" id="3842211">m</span><span class="op" id="3842212">.</span><span class="ident" id="3842213">cipherSuite</span><span class="op" id="3842224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842227">z</span><span class="op" id="3842228">[</span><span class="num" id="3842229">2</span><span class="op" id="3842230">]</span>&nbsp;<span class="op" id="3842232">=</span>&nbsp;<span class="builtintype" id="3842234">uint8</span><span class="op" id="3842239">(</span><span class="ident" id="3842240">m</span><span class="op" id="3842241">.</span><span class="ident" id="3842242">compressionMethod</span><span class="op" id="3842259">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842263">z</span>&nbsp;<span class="op" id="3842265">=</span>&nbsp;<span class="ident" id="3842267">z</span><span class="op" id="3842268">[</span><span class="num" id="3842269">3</span><span class="op" id="3842270">:</span><span class="op" id="3842271">]</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3842274">if</span>&nbsp;<span class="ident" id="3842277">numExtensions</span>&nbsp;<span class="op" id="3842291">&gt;</span>&nbsp;<span class="num" id="3842293">0</span>&nbsp;<span class="op" id="3842295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842299">z</span><span class="op" id="3842300">[</span><span class="num" id="3842301">0</span><span class="op" id="3842302">]</span>&nbsp;<span class="op" id="3842304">=</span>&nbsp;<span class="builtintype" id="3842306">byte</span><span class="op" id="3842310">(</span><span class="ident" id="3842311">extensionsLength</span>&nbsp;<span class="op" id="3842328">&gt;&gt;</span>&nbsp;<span class="num" id="3842331">8</span><span class="op" id="3842332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842336">z</span><span class="op" id="3842337">[</span><span class="num" id="3842338">1</span><span class="op" id="3842339">]</span>&nbsp;<span class="op" id="3842341">=</span>&nbsp;<span class="builtintype" id="3842343">byte</span><span class="op" id="3842347">(</span><span class="ident" id="3842348">extensionsLength</span><span class="op" id="3842364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842368">z</span>&nbsp;<span class="op" id="3842370">=</span>&nbsp;<span class="ident" id="3842372">z</span><span class="op" id="3842373">[</span><span class="num" id="3842374">2</span><span class="op" id="3842375">:</span><span class="op" id="3842376">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3842379">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3842382">if</span>&nbsp;<span class="ident" id="3842385">m</span><span class="op" id="3842386">.</span><span class="ident" id="3842387">nextProtoNeg</span>&nbsp;<span class="op" id="3842400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842404">z</span><span class="op" id="3842405">[</span><span class="num" id="3842406">0</span><span class="op" id="3842407">]</span>&nbsp;<span class="op" id="3842409">=</span>&nbsp;<span class="builtintype" id="3842411">byte</span><span class="op" id="3842415">(</span><span class="ident" id="3842416">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3842438">&gt;&gt;</span>&nbsp;<span class="num" id="3842441">8</span><span class="op" id="3842442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842446">z</span><span class="op" id="3842447">[</span><span class="num" id="3842448">1</span><span class="op" id="3842449">]</span>&nbsp;<span class="op" id="3842451">=</span>&nbsp;<span class="builtintype" id="3842453">byte</span><span class="op" id="3842457">(</span><span class="ident" id="3842458">extensionNextProtoNeg</span>&nbsp;<span class="op" id="3842480">&amp;</span>&nbsp;<span class="num" id="3842482">0xff</span><span class="op" id="3842486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842490">z</span><span class="op" id="3842491">[</span><span class="num" id="3842492">2</span><span class="op" id="3842493">]</span>&nbsp;<span class="op" id="3842495">=</span>&nbsp;<span class="builtintype" id="3842497">byte</span><span class="op" id="3842501">(</span><span class="ident" id="3842502">nextProtoLen</span>&nbsp;<span class="op" id="3842515">&gt;&gt;</span>&nbsp;<span class="num" id="3842518">8</span><span class="op" id="3842519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842523">z</span><span class="op" id="3842524">[</span><span class="num" id="3842525">3</span><span class="op" id="3842526">]</span>&nbsp;<span class="op" id="3842528">=</span>&nbsp;<span class="builtintype" id="3842530">byte</span><span class="op" id="3842534">(</span><span class="ident" id="3842535">nextProtoLen</span><span class="op" id="3842547">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842551">z</span>&nbsp;<span class="op" id="3842553">=</span>&nbsp;<span class="ident" id="3842555">z</span><span class="op" id="3842556">[</span><span class="num" id="3842557">4</span><span class="op" id="3842558">:</span><span class="op" id="3842559">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3842564">for</span>&nbsp;<span class="ident" id="3842568">_</span><span class="op" id="3842569">,</span>&nbsp;<span class="ident" id="3842571">v</span>&nbsp;<span class="op" id="3842573">:=</span>&nbsp;<span class="keyword" id="3842576">range</span>&nbsp;<span class="ident" id="3842582">m</span><span class="op" id="3842583">.</span><span class="ident" id="3842584">nextProtos</span>&nbsp;<span class="op" id="3842595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842600">l</span>&nbsp;<span class="op" id="3842602">:=</span>&nbsp;<span class="builtinfunc" id="3842605">len</span><span class="op" id="3842608">(</span><span class="ident" id="3842609">v</span><span class="op" id="3842610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3842615">if</span>&nbsp;<span class="ident" id="3842618">l</span>&nbsp;<span class="op" id="3842620">&gt;</span>&nbsp;<span class="num" id="3842622">255</span>&nbsp;<span class="op" id="3842626">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842632">l</span>&nbsp;<span class="op" id="3842634">=</span>&nbsp;<span class="num" id="3842636">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3842643">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842648">z</span><span class="op" id="3842649">[</span><span class="num" id="3842650">0</span><span class="op" id="3842651">]</span>&nbsp;<span class="op" id="3842653">=</span>&nbsp;<span class="builtintype" id="3842655">byte</span><span class="op" id="3842659">(</span><span class="ident" id="3842660">l</span><span class="op" id="3842661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3842666">copy</span><span class="op" id="3842670">(</span><span class="ident" id="3842671">z</span><span class="op" id="3842672">[</span><span class="num" id="3842673">1</span><span class="op" id="3842674">:</span><span class="op" id="3842675">]</span><span class="op" id="3842676">,</span>&nbsp;<span class="op" id="3842678">[</span><span class="op" id="3842679">]</span><span class="builtintype" id="3842680">byte</span><span class="op" id="3842684">(</span><span class="ident" id="3842685">v</span><span class="op" id="3842686">[</span><span class="num" id="3842687">0</span><span class="op" id="3842688">:</span><span class="ident" id="3842689">l</span><span class="op" id="3842690">]</span><span class="op" id="3842691">)</span><span class="op" id="3842692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842697">z</span>&nbsp;<span class="op" id="3842699">=</span>&nbsp;<span class="ident" id="3842701">z</span><span class="op" id="3842702">[</span><span class="num" id="3842703">1</span><span class="op" id="3842704">+</span><span class="ident" id="3842705">l</span><span class="op" id="3842706">:</span><span class="op" id="3842707">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3842711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3842714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3842717">if</span>&nbsp;<span class="ident" id="3842720">m</span><span class="op" id="3842721">.</span><span class="ident" id="3842722">ocspStapling</span>&nbsp;<span class="op" id="3842735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842739">z</span><span class="op" id="3842740">[</span><span class="num" id="3842741">0</span><span class="op" id="3842742">]</span>&nbsp;<span class="op" id="3842744">=</span>&nbsp;<span class="builtintype" id="3842746">byte</span><span class="op" id="3842750">(</span><span class="ident" id="3842751">extensionStatusRequest</span>&nbsp;<span class="op" id="3842774">&gt;&gt;</span>&nbsp;<span class="num" id="3842777">8</span><span class="op" id="3842778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842782">z</span><span class="op" id="3842783">[</span><span class="num" id="3842784">1</span><span class="op" id="3842785">]</span>&nbsp;<span class="op" id="3842787">=</span>&nbsp;<span class="builtintype" id="3842789">byte</span><span class="op" id="3842793">(</span><span class="ident" id="3842794">extensionStatusRequest</span><span class="op" id="3842816">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842820">z</span>&nbsp;<span class="op" id="3842822">=</span>&nbsp;<span class="ident" id="3842824">z</span><span class="op" id="3842825">[</span><span class="num" id="3842826">4</span><span class="op" id="3842827">:</span><span class="op" id="3842828">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3842831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3842834">if</span>&nbsp;<span class="ident" id="3842837">m</span><span class="op" id="3842838">.</span><span class="ident" id="3842839">ticketSupported</span>&nbsp;<span class="op" id="3842855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842859">z</span><span class="op" id="3842860">[</span><span class="num" id="3842861">0</span><span class="op" id="3842862">]</span>&nbsp;<span class="op" id="3842864">=</span>&nbsp;<span class="builtintype" id="3842866">byte</span><span class="op" id="3842870">(</span><span class="ident" id="3842871">extensionSessionTicket</span>&nbsp;<span class="op" id="3842894">&gt;&gt;</span>&nbsp;<span class="num" id="3842897">8</span><span class="op" id="3842898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842902">z</span><span class="op" id="3842903">[</span><span class="num" id="3842904">1</span><span class="op" id="3842905">]</span>&nbsp;<span class="op" id="3842907">=</span>&nbsp;<span class="builtintype" id="3842909">byte</span><span class="op" id="3842913">(</span><span class="ident" id="3842914">extensionSessionTicket</span><span class="op" id="3842936">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842940">z</span>&nbsp;<span class="op" id="3842942">=</span>&nbsp;<span class="ident" id="3842944">z</span><span class="op" id="3842945">[</span><span class="num" id="3842946">4</span><span class="op" id="3842947">:</span><span class="op" id="3842948">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3842951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3842954">if</span>&nbsp;<span class="ident" id="3842957">m</span><span class="op" id="3842958">.</span><span class="ident" id="3842959">secureRenegotiation</span>&nbsp;<span class="op" id="3842979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3842983">z</span><span class="op" id="3842984">[</span><span class="num" id="3842985">0</span><span class="op" id="3842986">]</span>&nbsp;<span class="op" id="3842988">=</span>&nbsp;<span class="builtintype" id="3842990">byte</span><span class="op" id="3842994">(</span><span class="ident" id="3842995">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3843022">&gt;&gt;</span>&nbsp;<span class="num" id="3843025">8</span><span class="op" id="3843026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843030">z</span><span class="op" id="3843031">[</span><span class="num" id="3843032">1</span><span class="op" id="3843033">]</span>&nbsp;<span class="op" id="3843035">=</span>&nbsp;<span class="builtintype" id="3843037">byte</span><span class="op" id="3843041">(</span><span class="ident" id="3843042">extensionRenegotiationInfo</span>&nbsp;<span class="op" id="3843069">&amp;</span>&nbsp;<span class="num" id="3843071">0xff</span><span class="op" id="3843075">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843079">z</span><span class="op" id="3843080">[</span><span class="num" id="3843081">2</span><span class="op" id="3843082">]</span>&nbsp;<span class="op" id="3843084">=</span>&nbsp;<span class="num" id="3843086">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843090">z</span><span class="op" id="3843091">[</span><span class="num" id="3843092">3</span><span class="op" id="3843093">]</span>&nbsp;<span class="op" id="3843095">=</span>&nbsp;<span class="num" id="3843097">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843101">z</span>&nbsp;<span class="op" id="3843103">=</span>&nbsp;<span class="ident" id="3843105">z</span><span class="op" id="3843106">[</span><span class="num" id="3843107">5</span><span class="op" id="3843108">:</span><span class="op" id="3843109">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3843115">if</span>&nbsp;<span class="ident" id="3843118">alpnLen</span>&nbsp;<span class="op" id="3843126">:=</span>&nbsp;<span class="builtinfunc" id="3843129">len</span><span class="op" id="3843132">(</span><span class="ident" id="3843133">m</span><span class="op" id="3843134">.</span><span class="ident" id="3843135">alpnProtocol</span><span class="op" id="3843147">)</span><span class="op" id="3843148">;</span>&nbsp;<span class="ident" id="3843150">alpnLen</span>&nbsp;<span class="op" id="3843158">&gt;</span>&nbsp;<span class="num" id="3843160">0</span>&nbsp;<span class="op" id="3843162">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843166">z</span><span class="op" id="3843167">[</span><span class="num" id="3843168">0</span><span class="op" id="3843169">]</span>&nbsp;<span class="op" id="3843171">=</span>&nbsp;<span class="builtintype" id="3843173">byte</span><span class="op" id="3843177">(</span><span class="ident" id="3843178">extensionALPN</span>&nbsp;<span class="op" id="3843192">&gt;&gt;</span>&nbsp;<span class="num" id="3843195">8</span><span class="op" id="3843196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843200">z</span><span class="op" id="3843201">[</span><span class="num" id="3843202">1</span><span class="op" id="3843203">]</span>&nbsp;<span class="op" id="3843205">=</span>&nbsp;<span class="builtintype" id="3843207">byte</span><span class="op" id="3843211">(</span><span class="ident" id="3843212">extensionALPN</span>&nbsp;<span class="op" id="3843226">&amp;</span>&nbsp;<span class="num" id="3843228">0xff</span><span class="op" id="3843232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843236">l</span>&nbsp;<span class="op" id="3843238">:=</span>&nbsp;<span class="num" id="3843241">2</span>&nbsp;<span class="op" id="3843243">+</span>&nbsp;<span class="num" id="3843245">1</span>&nbsp;<span class="op" id="3843247">+</span>&nbsp;<span class="ident" id="3843249">alpnLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843259">z</span><span class="op" id="3843260">[</span><span class="num" id="3843261">2</span><span class="op" id="3843262">]</span>&nbsp;<span class="op" id="3843264">=</span>&nbsp;<span class="builtintype" id="3843266">byte</span><span class="op" id="3843270">(</span><span class="ident" id="3843271">l</span>&nbsp;<span class="op" id="3843273">&gt;&gt;</span>&nbsp;<span class="num" id="3843276">8</span><span class="op" id="3843277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843281">z</span><span class="op" id="3843282">[</span><span class="num" id="3843283">3</span><span class="op" id="3843284">]</span>&nbsp;<span class="op" id="3843286">=</span>&nbsp;<span class="builtintype" id="3843288">byte</span><span class="op" id="3843292">(</span><span class="ident" id="3843293">l</span><span class="op" id="3843294">)</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843298">l</span>&nbsp;<span class="op" id="3843300">-=</span>&nbsp;<span class="num" id="3843303">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843307">z</span><span class="op" id="3843308">[</span><span class="num" id="3843309">4</span><span class="op" id="3843310">]</span>&nbsp;<span class="op" id="3843312">=</span>&nbsp;<span class="builtintype" id="3843314">byte</span><span class="op" id="3843318">(</span><span class="ident" id="3843319">l</span>&nbsp;<span class="op" id="3843321">&gt;&gt;</span>&nbsp;<span class="num" id="3843324">8</span><span class="op" id="3843325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843329">z</span><span class="op" id="3843330">[</span><span class="num" id="3843331">5</span><span class="op" id="3843332">]</span>&nbsp;<span class="op" id="3843334">=</span>&nbsp;<span class="builtintype" id="3843336">byte</span><span class="op" id="3843340">(</span><span class="ident" id="3843341">l</span><span class="op" id="3843342">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843346">l</span>&nbsp;<span class="op" id="3843348">-=</span>&nbsp;<span class="num" id="3843351">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843355">z</span><span class="op" id="3843356">[</span><span class="num" id="3843357">6</span><span class="op" id="3843358">]</span>&nbsp;<span class="op" id="3843360">=</span>&nbsp;<span class="builtintype" id="3843362">byte</span><span class="op" id="3843366">(</span><span class="ident" id="3843367">l</span><span class="op" id="3843368">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3843372">copy</span><span class="op" id="3843376">(</span><span class="ident" id="3843377">z</span><span class="op" id="3843378">[</span><span class="num" id="3843379">7</span><span class="op" id="3843380">:</span><span class="op" id="3843381">]</span><span class="op" id="3843382">,</span>&nbsp;<span class="op" id="3843384">[</span><span class="op" id="3843385">]</span><span class="builtintype" id="3843386">byte</span><span class="op" id="3843390">(</span><span class="ident" id="3843391">m</span><span class="op" id="3843392">.</span><span class="ident" id="3843393">alpnProtocol</span><span class="op" id="3843405">)</span><span class="op" id="3843406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843410">z</span>&nbsp;<span class="op" id="3843412">=</span>&nbsp;<span class="ident" id="3843414">z</span><span class="op" id="3843415">[</span><span class="num" id="3843416">7</span><span class="op" id="3843417">+</span><span class="ident" id="3843418">alpnLen</span><span class="op" id="3843425">:</span><span class="op" id="3843426">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843433">m</span><span class="op" id="3843434">.</span><span class="ident" id="3843435">raw</span>&nbsp;<span class="op" id="3843439">=</span>&nbsp;<span class="ident" id="3843441">x</span><br>
<span class="lineno">610</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3843445">return</span>&nbsp;<span class="ident" id="3843452">x</span><br>
<span class="lineno"></span><span class="op" id="3843454">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3843457">func</span>&nbsp;<span class="op" id="3843462">(</span><span class="ident" id="3843463">m</span>&nbsp;<span class="op" id="3843465">*</span><span class="ident" id="3843466">serverHelloMsg</span><span class="op" id="3843480">)</span>&nbsp;<span class="ident" id="3843482">unmarshal</span><span class="op" id="3843491">(</span><span class="ident" id="3843492">data</span>&nbsp;<span class="op" id="3843497">[</span><span class="op" id="3843498">]</span><span class="builtintype" id="3843499">byte</span><span class="op" id="3843503">)</span>&nbsp;<span class="builtintype" id="3843505">bool</span>&nbsp;<span class="op" id="3843510">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3843513">if</span>&nbsp;<span class="builtinfunc" id="3843516">len</span><span class="op" id="3843519">(</span><span class="ident" id="3843520">data</span><span class="op" id="3843524">)</span>&nbsp;<span class="op" id="3843526">&lt;</span>&nbsp;<span class="num" id="3843528">42</span>&nbsp;<span class="op" id="3843531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3843535">return</span>&nbsp;<span class="builtintype" id="3843542">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843552">m</span><span class="op" id="3843553">.</span><span class="ident" id="3843554">raw</span>&nbsp;<span class="op" id="3843558">=</span>&nbsp;<span class="ident" id="3843560">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843566">m</span><span class="op" id="3843567">.</span><span class="ident" id="3843568">vers</span>&nbsp;<span class="op" id="3843573">=</span>&nbsp;<span class="builtintype" id="3843575">uint16</span><span class="op" id="3843581">(</span><span class="ident" id="3843582">data</span><span class="op" id="3843586">[</span><span class="num" id="3843587">4</span><span class="op" id="3843588">]</span><span class="op" id="3843589">)</span><span class="op" id="3843590">&lt;&lt;</span><span class="num" id="3843592">8</span>&nbsp;<span class="op" id="3843594">|</span>&nbsp;<span class="builtintype" id="3843596">uint16</span><span class="op" id="3843602">(</span><span class="ident" id="3843603">data</span><span class="op" id="3843607">[</span><span class="num" id="3843608">5</span><span class="op" id="3843609">]</span><span class="op" id="3843610">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843613">m</span><span class="op" id="3843614">.</span><span class="ident" id="3843615">random</span>&nbsp;<span class="op" id="3843622">=</span>&nbsp;<span class="ident" id="3843624">data</span><span class="op" id="3843628">[</span><span class="num" id="3843629">6</span><span class="op" id="3843630">:</span><span class="num" id="3843631">38</span><span class="op" id="3843633">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843636">sessionIdLen</span>&nbsp;<span class="op" id="3843649">:=</span>&nbsp;<span class="builtintype" id="3843652">int</span><span class="op" id="3843655">(</span><span class="ident" id="3843656">data</span><span class="op" id="3843660">[</span><span class="num" id="3843661">38</span><span class="op" id="3843663">]</span><span class="op" id="3843664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3843667">if</span>&nbsp;<span class="ident" id="3843670">sessionIdLen</span>&nbsp;<span class="op" id="3843683">&gt;</span>&nbsp;<span class="num" id="3843685">32</span>&nbsp;<span class="op" id="3843688">||</span>&nbsp;<span class="builtinfunc" id="3843691">len</span><span class="op" id="3843694">(</span><span class="ident" id="3843695">data</span><span class="op" id="3843699">)</span>&nbsp;<span class="op" id="3843701">&lt;</span>&nbsp;<span class="num" id="3843703">39</span><span class="op" id="3843705">+</span><span class="ident" id="3843706">sessionIdLen</span>&nbsp;<span class="op" id="3843719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3843723">return</span>&nbsp;<span class="builtintype" id="3843730">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843737">}</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843740">m</span><span class="op" id="3843741">.</span><span class="ident" id="3843742">sessionId</span>&nbsp;<span class="op" id="3843752">=</span>&nbsp;<span class="ident" id="3843754">data</span><span class="op" id="3843758">[</span><span class="num" id="3843759">39</span>&nbsp;<span class="op" id="3843762">:</span>&nbsp;<span class="num" id="3843764">39</span><span class="op" id="3843766">+</span><span class="ident" id="3843767">sessionIdLen</span><span class="op" id="3843779">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843782">data</span>&nbsp;<span class="op" id="3843787">=</span>&nbsp;<span class="ident" id="3843789">data</span><span class="op" id="3843793">[</span><span class="num" id="3843794">39</span><span class="op" id="3843796">+</span><span class="ident" id="3843797">sessionIdLen</span><span class="op" id="3843809">:</span><span class="op" id="3843810">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3843813">if</span>&nbsp;<span class="builtinfunc" id="3843816">len</span><span class="op" id="3843819">(</span><span class="ident" id="3843820">data</span><span class="op" id="3843824">)</span>&nbsp;<span class="op" id="3843826">&lt;</span>&nbsp;<span class="num" id="3843828">3</span>&nbsp;<span class="op" id="3843830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3843834">return</span>&nbsp;<span class="builtintype" id="3843841">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3843848">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843851">m</span><span class="op" id="3843852">.</span><span class="ident" id="3843853">cipherSuite</span>&nbsp;<span class="op" id="3843865">=</span>&nbsp;<span class="builtintype" id="3843867">uint16</span><span class="op" id="3843873">(</span><span class="ident" id="3843874">data</span><span class="op" id="3843878">[</span><span class="num" id="3843879">0</span><span class="op" id="3843880">]</span><span class="op" id="3843881">)</span><span class="op" id="3843882">&lt;&lt;</span><span class="num" id="3843884">8</span>&nbsp;<span class="op" id="3843886">|</span>&nbsp;<span class="builtintype" id="3843888">uint16</span><span class="op" id="3843894">(</span><span class="ident" id="3843895">data</span><span class="op" id="3843899">[</span><span class="num" id="3843900">1</span><span class="op" id="3843901">]</span><span class="op" id="3843902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843905">m</span><span class="op" id="3843906">.</span><span class="ident" id="3843907">compressionMethod</span>&nbsp;<span class="op" id="3843925">=</span>&nbsp;<span class="ident" id="3843927">data</span><span class="op" id="3843931">[</span><span class="num" id="3843932">2</span><span class="op" id="3843933">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843936">data</span>&nbsp;<span class="op" id="3843941">=</span>&nbsp;<span class="ident" id="3843943">data</span><span class="op" id="3843947">[</span><span class="num" id="3843948">3</span><span class="op" id="3843949">:</span><span class="op" id="3843950">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843954">m</span><span class="op" id="3843955">.</span><span class="ident" id="3843956">nextProtoNeg</span>&nbsp;<span class="op" id="3843969">=</span>&nbsp;<span class="builtintype" id="3843971">false</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843978">m</span><span class="op" id="3843979">.</span><span class="ident" id="3843980">nextProtos</span>&nbsp;<span class="op" id="3843991">=</span>&nbsp;<span class="ident" id="3843993">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3843998">m</span><span class="op" id="3843999">.</span><span class="ident" id="3844000">ocspStapling</span>&nbsp;<span class="op" id="3844013">=</span>&nbsp;<span class="builtintype" id="3844015">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844022">m</span><span class="op" id="3844023">.</span><span class="ident" id="3844024">ticketSupported</span>&nbsp;<span class="op" id="3844040">=</span>&nbsp;<span class="builtintype" id="3844042">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844049">m</span><span class="op" id="3844050">.</span><span class="ident" id="3844051">alpnProtocol</span>&nbsp;<span class="op" id="3844064">=</span>&nbsp;<span class="string" id="3844066">&#34;&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844071">if</span>&nbsp;<span class="builtinfunc" id="3844074">len</span><span class="op" id="3844077">(</span><span class="ident" id="3844078">data</span><span class="op" id="3844082">)</span>&nbsp;<span class="op" id="3844084">==</span>&nbsp;<span class="num" id="3844087">0</span>&nbsp;<span class="op" id="3844089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3844093">//&nbsp;ServerHello&nbsp;is&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;extension&nbsp;data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844151">return</span>&nbsp;<span class="builtintype" id="3844158">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3844164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844167">if</span>&nbsp;<span class="builtinfunc" id="3844170">len</span><span class="op" id="3844173">(</span><span class="ident" id="3844174">data</span><span class="op" id="3844178">)</span>&nbsp;<span class="op" id="3844180">&lt;</span>&nbsp;<span class="num" id="3844182">2</span>&nbsp;<span class="op" id="3844184">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844188">return</span>&nbsp;<span class="builtintype" id="3844195">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3844202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844206">extensionsLength</span>&nbsp;<span class="op" id="3844223">:=</span>&nbsp;<span class="builtintype" id="3844226">int</span><span class="op" id="3844229">(</span><span class="ident" id="3844230">data</span><span class="op" id="3844234">[</span><span class="num" id="3844235">0</span><span class="op" id="3844236">]</span><span class="op" id="3844237">)</span><span class="op" id="3844238">&lt;&lt;</span><span class="num" id="3844240">8</span>&nbsp;<span class="op" id="3844242">|</span>&nbsp;<span class="builtintype" id="3844244">int</span><span class="op" id="3844247">(</span><span class="ident" id="3844248">data</span><span class="op" id="3844252">[</span><span class="num" id="3844253">1</span><span class="op" id="3844254">]</span><span class="op" id="3844255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844258">data</span>&nbsp;<span class="op" id="3844263">=</span>&nbsp;<span class="ident" id="3844265">data</span><span class="op" id="3844269">[</span><span class="num" id="3844270">2</span><span class="op" id="3844271">:</span><span class="op" id="3844272">]</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844275">if</span>&nbsp;<span class="builtinfunc" id="3844278">len</span><span class="op" id="3844281">(</span><span class="ident" id="3844282">data</span><span class="op" id="3844286">)</span>&nbsp;<span class="op" id="3844288">!=</span>&nbsp;<span class="ident" id="3844291">extensionsLength</span>&nbsp;<span class="op" id="3844308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844312">return</span>&nbsp;<span class="builtintype" id="3844319">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3844326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844330">for</span>&nbsp;<span class="builtinfunc" id="3844334">len</span><span class="op" id="3844337">(</span><span class="ident" id="3844338">data</span><span class="op" id="3844342">)</span>&nbsp;<span class="op" id="3844344">!=</span>&nbsp;<span class="num" id="3844347">0</span>&nbsp;<span class="op" id="3844349">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844353">if</span>&nbsp;<span class="builtinfunc" id="3844356">len</span><span class="op" id="3844359">(</span><span class="ident" id="3844360">data</span><span class="op" id="3844364">)</span>&nbsp;<span class="op" id="3844366">&lt;</span>&nbsp;<span class="num" id="3844368">4</span>&nbsp;<span class="op" id="3844370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844375">return</span>&nbsp;<span class="builtintype" id="3844382">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3844390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844394">extension</span>&nbsp;<span class="op" id="3844404">:=</span>&nbsp;<span class="builtintype" id="3844407">uint16</span><span class="op" id="3844413">(</span><span class="ident" id="3844414">data</span><span class="op" id="3844418">[</span><span class="num" id="3844419">0</span><span class="op" id="3844420">]</span><span class="op" id="3844421">)</span><span class="op" id="3844422">&lt;&lt;</span><span class="num" id="3844424">8</span>&nbsp;<span class="op" id="3844426">|</span>&nbsp;<span class="builtintype" id="3844428">uint16</span><span class="op" id="3844434">(</span><span class="ident" id="3844435">data</span><span class="op" id="3844439">[</span><span class="num" id="3844440">1</span><span class="op" id="3844441">]</span><span class="op" id="3844442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844446">length</span>&nbsp;<span class="op" id="3844453">:=</span>&nbsp;<span class="builtintype" id="3844456">int</span><span class="op" id="3844459">(</span><span class="ident" id="3844460">data</span><span class="op" id="3844464">[</span><span class="num" id="3844465">2</span><span class="op" id="3844466">]</span><span class="op" id="3844467">)</span><span class="op" id="3844468">&lt;&lt;</span><span class="num" id="3844470">8</span>&nbsp;<span class="op" id="3844472">|</span>&nbsp;<span class="builtintype" id="3844474">int</span><span class="op" id="3844477">(</span><span class="ident" id="3844478">data</span><span class="op" id="3844482">[</span><span class="num" id="3844483">3</span><span class="op" id="3844484">]</span><span class="op" id="3844485">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844489">data</span>&nbsp;<span class="op" id="3844494">=</span>&nbsp;<span class="ident" id="3844496">data</span><span class="op" id="3844500">[</span><span class="num" id="3844501">4</span><span class="op" id="3844502">:</span><span class="op" id="3844503">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844507">if</span>&nbsp;<span class="builtinfunc" id="3844510">len</span><span class="op" id="3844513">(</span><span class="ident" id="3844514">data</span><span class="op" id="3844518">)</span>&nbsp;<span class="op" id="3844520">&lt;</span>&nbsp;<span class="ident" id="3844522">length</span>&nbsp;<span class="op" id="3844529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844534">return</span>&nbsp;<span class="builtintype" id="3844541">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3844549">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844554">switch</span>&nbsp;<span class="ident" id="3844561">extension</span>&nbsp;<span class="op" id="3844571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844575">case</span>&nbsp;<span class="ident" id="3844580">extensionNextProtoNeg</span><span class="op" id="3844601">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844606">m</span><span class="op" id="3844607">.</span><span class="ident" id="3844608">nextProtoNeg</span>&nbsp;<span class="op" id="3844621">=</span>&nbsp;<span class="builtintype" id="3844623">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844631">d</span>&nbsp;<span class="op" id="3844633">:=</span>&nbsp;<span class="ident" id="3844636">data</span><span class="op" id="3844640">[</span><span class="op" id="3844641">:</span><span class="ident" id="3844642">length</span><span class="op" id="3844648">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844653">for</span>&nbsp;<span class="builtinfunc" id="3844657">len</span><span class="op" id="3844660">(</span><span class="ident" id="3844661">d</span><span class="op" id="3844662">)</span>&nbsp;<span class="op" id="3844664">&gt;</span>&nbsp;<span class="num" id="3844666">0</span>&nbsp;<span class="op" id="3844668">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844674">l</span>&nbsp;<span class="op" id="3844676">:=</span>&nbsp;<span class="builtintype" id="3844679">int</span><span class="op" id="3844682">(</span><span class="ident" id="3844683">d</span><span class="op" id="3844684">[</span><span class="num" id="3844685">0</span><span class="op" id="3844686">]</span><span class="op" id="3844687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844693">d</span>&nbsp;<span class="op" id="3844695">=</span>&nbsp;<span class="ident" id="3844697">d</span><span class="op" id="3844698">[</span><span class="num" id="3844699">1</span><span class="op" id="3844700">:</span><span class="op" id="3844701">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844707">if</span>&nbsp;<span class="ident" id="3844710">l</span>&nbsp;<span class="op" id="3844712">==</span>&nbsp;<span class="num" id="3844715">0</span>&nbsp;<span class="op" id="3844717">||</span>&nbsp;<span class="ident" id="3844720">l</span>&nbsp;<span class="op" id="3844722">&gt;</span>&nbsp;<span class="builtinfunc" id="3844724">len</span><span class="op" id="3844727">(</span><span class="ident" id="3844728">d</span><span class="op" id="3844729">)</span>&nbsp;<span class="op" id="3844731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844738">return</span>&nbsp;<span class="builtintype" id="3844745">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3844755">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844761">m</span><span class="op" id="3844762">.</span><span class="ident" id="3844763">nextProtos</span>&nbsp;<span class="op" id="3844774">=</span>&nbsp;<span class="builtinfunc" id="3844776">append</span><span class="op" id="3844782">(</span><span class="ident" id="3844783">m</span><span class="op" id="3844784">.</span><span class="ident" id="3844785">nextProtos</span><span class="op" id="3844795">,</span>&nbsp;<span class="builtintype" id="3844797">string</span><span class="op" id="3844803">(</span><span class="ident" id="3844804">d</span><span class="op" id="3844805">[</span><span class="op" id="3844806">:</span><span class="ident" id="3844807">l</span><span class="op" id="3844808">]</span><span class="op" id="3844809">)</span><span class="op" id="3844810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844816">d</span>&nbsp;<span class="op" id="3844818">=</span>&nbsp;<span class="ident" id="3844820">d</span><span class="op" id="3844821">[</span><span class="ident" id="3844822">l</span><span class="op" id="3844823">:</span><span class="op" id="3844824">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3844829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844833">case</span>&nbsp;<span class="ident" id="3844838">extensionStatusRequest</span><span class="op" id="3844860">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844865">if</span>&nbsp;<span class="ident" id="3844868">length</span>&nbsp;<span class="op" id="3844875">&gt;</span>&nbsp;<span class="num" id="3844877">0</span>&nbsp;<span class="op" id="3844879">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844885">return</span>&nbsp;<span class="builtintype" id="3844892">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3844901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3844906">m</span><span class="op" id="3844907">.</span><span class="ident" id="3844908">ocspStapling</span>&nbsp;<span class="op" id="3844921">=</span>&nbsp;<span class="builtintype" id="3844923">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844930">case</span>&nbsp;<span class="ident" id="3844935">extensionSessionTicket</span><span class="op" id="3844957">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844962">if</span>&nbsp;<span class="ident" id="3844965">length</span>&nbsp;<span class="op" id="3844972">&gt;</span>&nbsp;<span class="num" id="3844974">0</span>&nbsp;<span class="op" id="3844976">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3844982">return</span>&nbsp;<span class="builtintype" id="3844989">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3844998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845003">m</span><span class="op" id="3845004">.</span><span class="ident" id="3845005">ticketSupported</span>&nbsp;<span class="op" id="3845021">=</span>&nbsp;<span class="builtintype" id="3845023">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3845030">case</span>&nbsp;<span class="ident" id="3845035">extensionRenegotiationInfo</span><span class="op" id="3845061">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3845066">if</span>&nbsp;<span class="ident" id="3845069">length</span>&nbsp;<span class="op" id="3845076">!=</span>&nbsp;<span class="num" id="3845079">1</span>&nbsp;<span class="op" id="3845081">||</span>&nbsp;<span class="ident" id="3845084">data</span><span class="op" id="3845088">[</span><span class="num" id="3845089">0</span><span class="op" id="3845090">]</span>&nbsp;<span class="op" id="3845092">!=</span>&nbsp;<span class="num" id="3845095">0</span>&nbsp;<span class="op" id="3845097">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3845103">return</span>&nbsp;<span class="builtintype" id="3845110">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3845119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845124">m</span><span class="op" id="3845125">.</span><span class="ident" id="3845126">secureRenegotiation</span>&nbsp;<span class="op" id="3845146">=</span>&nbsp;<span class="builtintype" id="3845148">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3845155">case</span>&nbsp;<span class="ident" id="3845160">extensionALPN</span><span class="op" id="3845173">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845178">d</span>&nbsp;<span class="op" id="3845180">:=</span>&nbsp;<span class="ident" id="3845183">data</span><span class="op" id="3845187">[</span><span class="op" id="3845188">:</span><span class="ident" id="3845189">length</span><span class="op" id="3845195">]</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3845200">if</span>&nbsp;<span class="builtinfunc" id="3845203">len</span><span class="op" id="3845206">(</span><span class="ident" id="3845207">d</span><span class="op" id="3845208">)</span>&nbsp;<span class="op" id="3845210">&lt;</span>&nbsp;<span class="num" id="3845212">3</span>&nbsp;<span class="op" id="3845214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3845220">return</span>&nbsp;<span class="builtintype" id="3845227">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3845236">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845241">l</span>&nbsp;<span class="op" id="3845243">:=</span>&nbsp;<span class="builtintype" id="3845246">int</span><span class="op" id="3845249">(</span><span class="ident" id="3845250">d</span><span class="op" id="3845251">[</span><span class="num" id="3845252">0</span><span class="op" id="3845253">]</span><span class="op" id="3845254">)</span><span class="op" id="3845255">&lt;&lt;</span><span class="num" id="3845257">8</span>&nbsp;<span class="op" id="3845259">|</span>&nbsp;<span class="builtintype" id="3845261">int</span><span class="op" id="3845264">(</span><span class="ident" id="3845265">d</span><span class="op" id="3845266">[</span><span class="num" id="3845267">1</span><span class="op" id="3845268">]</span><span class="op" id="3845269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3845274">if</span>&nbsp;<span class="ident" id="3845277">l</span>&nbsp;<span class="op" id="3845279">!=</span>&nbsp;<span class="builtinfunc" id="3845282">len</span><span class="op" id="3845285">(</span><span class="ident" id="3845286">d</span><span class="op" id="3845287">)</span><span class="op" id="3845288">-</span><span class="num" id="3845289">2</span>&nbsp;<span class="op" id="3845291">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3845297">return</span>&nbsp;<span class="builtintype" id="3845304">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3845313">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845318">d</span>&nbsp;<span class="op" id="3845320">=</span>&nbsp;<span class="ident" id="3845322">d</span><span class="op" id="3845323">[</span><span class="num" id="3845324">2</span><span class="op" id="3845325">:</span><span class="op" id="3845326">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845331">l</span>&nbsp;<span class="op" id="3845333">=</span>&nbsp;<span class="builtintype" id="3845335">int</span><span class="op" id="3845338">(</span><span class="ident" id="3845339">d</span><span class="op" id="3845340">[</span><span class="num" id="3845341">0</span><span class="op" id="3845342">]</span><span class="op" id="3845343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3845348">if</span>&nbsp;<span class="ident" id="3845351">l</span>&nbsp;<span class="op" id="3845353">!=</span>&nbsp;<span class="builtinfunc" id="3845356">len</span><span class="op" id="3845359">(</span><span class="ident" id="3845360">d</span><span class="op" id="3845361">)</span><span class="op" id="3845362">-</span><span class="num" id="3845363">1</span>&nbsp;<span class="op" id="3845365">{</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3845371">return</span>&nbsp;<span class="builtintype" id="3845378">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3845387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845392">d</span>&nbsp;<span class="op" id="3845394">=</span>&nbsp;<span class="ident" id="3845396">d</span><span class="op" id="3845397">[</span><span class="num" id="3845398">1</span><span class="op" id="3845399">:</span><span class="op" id="3845400">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845405">m</span><span class="op" id="3845406">.</span><span class="ident" id="3845407">alpnProtocol</span>&nbsp;<span class="op" id="3845420">=</span>&nbsp;<span class="builtintype" id="3845422">string</span><span class="op" id="3845428">(</span><span class="ident" id="3845429">d</span><span class="op" id="3845430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3845434">}</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845438">data</span>&nbsp;<span class="op" id="3845443">=</span>&nbsp;<span class="ident" id="3845445">data</span><span class="op" id="3845449">[</span><span class="ident" id="3845450">length</span><span class="op" id="3845456">:</span><span class="op" id="3845457">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3845460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3845464">return</span>&nbsp;<span class="builtintype" id="3845471">true</span><br>
<span class="lineno"></span><span class="op" id="3845476">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="3845479">type</span>&nbsp;<span class="ident" id="3845484">certificateMsg</span>&nbsp;<span class="keyword" id="3845499">struct</span>&nbsp;<span class="op" id="3845506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845509">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3845522">[</span><span class="op" id="3845523">]</span><span class="builtintype" id="3845524">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845530">certificates</span>&nbsp;<span class="op" id="3845543">[</span><span class="op" id="3845544">]</span><span class="op" id="3845545">[</span><span class="op" id="3845546">]</span><span class="builtintype" id="3845547">byte</span><br>
<span class="lineno"></span><span class="op" id="3845552">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="3845555">func</span>&nbsp;<span class="op" id="3845560">(</span><span class="ident" id="3845561">m</span>&nbsp;<span class="op" id="3845563">*</span><span class="ident" id="3845564">certificateMsg</span><span class="op" id="3845578">)</span>&nbsp;<span class="ident" id="3845580">equal</span><span class="op" id="3845585">(</span><span class="ident" id="3845586">i</span>&nbsp;<span class="keyword" id="3845588">interface</span><span class="op" id="3845597">{</span><span class="op" id="3845598">}</span><span class="op" id="3845599">)</span>&nbsp;<span class="builtintype" id="3845601">bool</span>&nbsp;<span class="op" id="3845606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845609">m1</span><span class="op" id="3845611">,</span>&nbsp;<span class="ident" id="3845613">ok</span>&nbsp;<span class="op" id="3845616">:=</span>&nbsp;<span class="ident" id="3845619">i</span><span class="op" id="3845620">.</span><span class="op" id="3845621">(</span><span class="op" id="3845622">*</span><span class="ident" id="3845623">certificateMsg</span><span class="op" id="3845637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3845640">if</span>&nbsp;<span class="op" id="3845643">!</span><span class="ident" id="3845644">ok</span>&nbsp;<span class="op" id="3845647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3845651">return</span>&nbsp;<span class="builtintype" id="3845658">false</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3845665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3845669">return</span>&nbsp;<span class="ident" id="3845676">bytes</span><span class="op" id="3845681">.</span><span class="ident" id="3845682">Equal</span><span class="op" id="3845687">(</span><span class="ident" id="3845688">m</span><span class="op" id="3845689">.</span><span class="ident" id="3845690">raw</span><span class="op" id="3845693">,</span>&nbsp;<span class="ident" id="3845695">m1</span><span class="op" id="3845697">.</span><span class="ident" id="3845698">raw</span><span class="op" id="3845701">)</span>&nbsp;<span class="op" id="3845703">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845708">eqByteSlices</span><span class="op" id="3845720">(</span><span class="ident" id="3845721">m</span><span class="op" id="3845722">.</span><span class="ident" id="3845723">certificates</span><span class="op" id="3845735">,</span>&nbsp;<span class="ident" id="3845737">m1</span><span class="op" id="3845739">.</span><span class="ident" id="3845740">certificates</span><span class="op" id="3845752">)</span><br>
<span class="lineno"></span><span class="op" id="3845754">}</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span><span class="keyword" id="3845757">func</span>&nbsp;<span class="op" id="3845762">(</span><span class="ident" id="3845763">m</span>&nbsp;<span class="op" id="3845765">*</span><span class="ident" id="3845766">certificateMsg</span><span class="op" id="3845780">)</span>&nbsp;<span class="ident" id="3845782">marshal</span><span class="op" id="3845789">(</span><span class="op" id="3845790">)</span>&nbsp;<span class="op" id="3845792">(</span><span class="ident" id="3845793">x</span>&nbsp;<span class="op" id="3845795">[</span><span class="op" id="3845796">]</span><span class="builtintype" id="3845797">byte</span><span class="op" id="3845801">)</span>&nbsp;<span class="op" id="3845803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3845806">if</span>&nbsp;<span class="ident" id="3845809">m</span><span class="op" id="3845810">.</span><span class="ident" id="3845811">raw</span>&nbsp;<span class="op" id="3845815">!=</span>&nbsp;<span class="ident" id="3845818">nil</span>&nbsp;<span class="op" id="3845822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3845826">return</span>&nbsp;<span class="ident" id="3845833">m</span><span class="op" id="3845834">.</span><span class="ident" id="3845835">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3845840">}</span><br>
<span class="lineno">735</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3845844">var</span>&nbsp;<span class="ident" id="3845848">i</span>&nbsp;<span class="builtintype" id="3845850">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3845855">for</span>&nbsp;<span class="ident" id="3845859">_</span><span class="op" id="3845860">,</span>&nbsp;<span class="ident" id="3845862">slice</span>&nbsp;<span class="op" id="3845868">:=</span>&nbsp;<span class="keyword" id="3845871">range</span>&nbsp;<span class="ident" id="3845877">m</span><span class="op" id="3845878">.</span><span class="ident" id="3845879">certificates</span>&nbsp;<span class="op" id="3845892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845896">i</span>&nbsp;<span class="op" id="3845898">+=</span>&nbsp;<span class="builtinfunc" id="3845901">len</span><span class="op" id="3845904">(</span><span class="ident" id="3845905">slice</span><span class="op" id="3845910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3845913">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845917">length</span>&nbsp;<span class="op" id="3845924">:=</span>&nbsp;<span class="num" id="3845927">3</span>&nbsp;<span class="op" id="3845929">+</span>&nbsp;<span class="num" id="3845931">3</span><span class="op" id="3845932">*</span><span class="builtinfunc" id="3845933">len</span><span class="op" id="3845936">(</span><span class="ident" id="3845937">m</span><span class="op" id="3845938">.</span><span class="ident" id="3845939">certificates</span><span class="op" id="3845951">)</span>&nbsp;<span class="op" id="3845953">+</span>&nbsp;<span class="ident" id="3845955">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845958">x</span>&nbsp;<span class="op" id="3845960">=</span>&nbsp;<span class="builtinfunc" id="3845962">make</span><span class="op" id="3845966">(</span><span class="op" id="3845967">[</span><span class="op" id="3845968">]</span><span class="builtintype" id="3845969">byte</span><span class="op" id="3845973">,</span>&nbsp;<span class="num" id="3845975">4</span><span class="op" id="3845976">+</span><span class="ident" id="3845977">length</span><span class="op" id="3845983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3845986">x</span><span class="op" id="3845987">[</span><span class="num" id="3845988">0</span><span class="op" id="3845989">]</span>&nbsp;<span class="op" id="3845991">=</span>&nbsp;<span class="ident" id="3845993">typeCertificate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846010">x</span><span class="op" id="3846011">[</span><span class="num" id="3846012">1</span><span class="op" id="3846013">]</span>&nbsp;<span class="op" id="3846015">=</span>&nbsp;<span class="builtintype" id="3846017">uint8</span><span class="op" id="3846022">(</span><span class="ident" id="3846023">length</span>&nbsp;<span class="op" id="3846030">&gt;&gt;</span>&nbsp;<span class="num" id="3846033">16</span><span class="op" id="3846035">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846038">x</span><span class="op" id="3846039">[</span><span class="num" id="3846040">2</span><span class="op" id="3846041">]</span>&nbsp;<span class="op" id="3846043">=</span>&nbsp;<span class="builtintype" id="3846045">uint8</span><span class="op" id="3846050">(</span><span class="ident" id="3846051">length</span>&nbsp;<span class="op" id="3846058">&gt;&gt;</span>&nbsp;<span class="num" id="3846061">8</span><span class="op" id="3846062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846065">x</span><span class="op" id="3846066">[</span><span class="num" id="3846067">3</span><span class="op" id="3846068">]</span>&nbsp;<span class="op" id="3846070">=</span>&nbsp;<span class="builtintype" id="3846072">uint8</span><span class="op" id="3846077">(</span><span class="ident" id="3846078">length</span><span class="op" id="3846084">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846088">certificateOctets</span>&nbsp;<span class="op" id="3846106">:=</span>&nbsp;<span class="ident" id="3846109">length</span>&nbsp;<span class="op" id="3846116">-</span>&nbsp;<span class="num" id="3846118">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846121">x</span><span class="op" id="3846122">[</span><span class="num" id="3846123">4</span><span class="op" id="3846124">]</span>&nbsp;<span class="op" id="3846126">=</span>&nbsp;<span class="builtintype" id="3846128">uint8</span><span class="op" id="3846133">(</span><span class="ident" id="3846134">certificateOctets</span>&nbsp;<span class="op" id="3846152">&gt;&gt;</span>&nbsp;<span class="num" id="3846155">16</span><span class="op" id="3846157">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846160">x</span><span class="op" id="3846161">[</span><span class="num" id="3846162">5</span><span class="op" id="3846163">]</span>&nbsp;<span class="op" id="3846165">=</span>&nbsp;<span class="builtintype" id="3846167">uint8</span><span class="op" id="3846172">(</span><span class="ident" id="3846173">certificateOctets</span>&nbsp;<span class="op" id="3846191">&gt;&gt;</span>&nbsp;<span class="num" id="3846194">8</span><span class="op" id="3846195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846198">x</span><span class="op" id="3846199">[</span><span class="num" id="3846200">6</span><span class="op" id="3846201">]</span>&nbsp;<span class="op" id="3846203">=</span>&nbsp;<span class="builtintype" id="3846205">uint8</span><span class="op" id="3846210">(</span><span class="ident" id="3846211">certificateOctets</span><span class="op" id="3846228">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846232">y</span>&nbsp;<span class="op" id="3846234">:=</span>&nbsp;<span class="ident" id="3846237">x</span><span class="op" id="3846238">[</span><span class="num" id="3846239">7</span><span class="op" id="3846240">:</span><span class="op" id="3846241">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3846244">for</span>&nbsp;<span class="ident" id="3846248">_</span><span class="op" id="3846249">,</span>&nbsp;<span class="ident" id="3846251">slice</span>&nbsp;<span class="op" id="3846257">:=</span>&nbsp;<span class="keyword" id="3846260">range</span>&nbsp;<span class="ident" id="3846266">m</span><span class="op" id="3846267">.</span><span class="ident" id="3846268">certificates</span>&nbsp;<span class="op" id="3846281">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846285">y</span><span class="op" id="3846286">[</span><span class="num" id="3846287">0</span><span class="op" id="3846288">]</span>&nbsp;<span class="op" id="3846290">=</span>&nbsp;<span class="builtintype" id="3846292">uint8</span><span class="op" id="3846297">(</span><span class="builtinfunc" id="3846298">len</span><span class="op" id="3846301">(</span><span class="ident" id="3846302">slice</span><span class="op" id="3846307">)</span>&nbsp;<span class="op" id="3846309">&gt;&gt;</span>&nbsp;<span class="num" id="3846312">16</span><span class="op" id="3846314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846318">y</span><span class="op" id="3846319">[</span><span class="num" id="3846320">1</span><span class="op" id="3846321">]</span>&nbsp;<span class="op" id="3846323">=</span>&nbsp;<span class="builtintype" id="3846325">uint8</span><span class="op" id="3846330">(</span><span class="builtinfunc" id="3846331">len</span><span class="op" id="3846334">(</span><span class="ident" id="3846335">slice</span><span class="op" id="3846340">)</span>&nbsp;<span class="op" id="3846342">&gt;&gt;</span>&nbsp;<span class="num" id="3846345">8</span><span class="op" id="3846346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846350">y</span><span class="op" id="3846351">[</span><span class="num" id="3846352">2</span><span class="op" id="3846353">]</span>&nbsp;<span class="op" id="3846355">=</span>&nbsp;<span class="builtintype" id="3846357">uint8</span><span class="op" id="3846362">(</span><span class="builtinfunc" id="3846363">len</span><span class="op" id="3846366">(</span><span class="ident" id="3846367">slice</span><span class="op" id="3846372">)</span><span class="op" id="3846373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3846377">copy</span><span class="op" id="3846381">(</span><span class="ident" id="3846382">y</span><span class="op" id="3846383">[</span><span class="num" id="3846384">3</span><span class="op" id="3846385">:</span><span class="op" id="3846386">]</span><span class="op" id="3846387">,</span>&nbsp;<span class="ident" id="3846389">slice</span><span class="op" id="3846394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846398">y</span>&nbsp;<span class="op" id="3846400">=</span>&nbsp;<span class="ident" id="3846402">y</span><span class="op" id="3846403">[</span><span class="num" id="3846404">3</span><span class="op" id="3846405">+</span><span class="builtinfunc" id="3846406">len</span><span class="op" id="3846409">(</span><span class="ident" id="3846410">slice</span><span class="op" id="3846415">)</span><span class="op" id="3846416">:</span><span class="op" id="3846417">]</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3846420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846424">m</span><span class="op" id="3846425">.</span><span class="ident" id="3846426">raw</span>&nbsp;<span class="op" id="3846430">=</span>&nbsp;<span class="ident" id="3846432">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3846435">return</span><br>
<span class="lineno"></span><span class="op" id="3846442">}</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span><span class="keyword" id="3846445">func</span>&nbsp;<span class="op" id="3846450">(</span><span class="ident" id="3846451">m</span>&nbsp;<span class="op" id="3846453">*</span><span class="ident" id="3846454">certificateMsg</span><span class="op" id="3846468">)</span>&nbsp;<span class="ident" id="3846470">unmarshal</span><span class="op" id="3846479">(</span><span class="ident" id="3846480">data</span>&nbsp;<span class="op" id="3846485">[</span><span class="op" id="3846486">]</span><span class="builtintype" id="3846487">byte</span><span class="op" id="3846491">)</span>&nbsp;<span class="builtintype" id="3846493">bool</span>&nbsp;<span class="op" id="3846498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3846501">if</span>&nbsp;<span class="builtinfunc" id="3846504">len</span><span class="op" id="3846507">(</span><span class="ident" id="3846508">data</span><span class="op" id="3846512">)</span>&nbsp;<span class="op" id="3846514">&lt;</span>&nbsp;<span class="num" id="3846516">7</span>&nbsp;<span class="op" id="3846518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3846522">return</span>&nbsp;<span class="builtintype" id="3846529">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3846536">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846540">m</span><span class="op" id="3846541">.</span><span class="ident" id="3846542">raw</span>&nbsp;<span class="op" id="3846546">=</span>&nbsp;<span class="ident" id="3846548">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846554">certsLen</span>&nbsp;<span class="op" id="3846563">:=</span>&nbsp;<span class="builtintype" id="3846566">uint32</span><span class="op" id="3846572">(</span><span class="ident" id="3846573">data</span><span class="op" id="3846577">[</span><span class="num" id="3846578">4</span><span class="op" id="3846579">]</span><span class="op" id="3846580">)</span><span class="op" id="3846581">&lt;&lt;</span><span class="num" id="3846583">16</span>&nbsp;<span class="op" id="3846586">|</span>&nbsp;<span class="builtintype" id="3846588">uint32</span><span class="op" id="3846594">(</span><span class="ident" id="3846595">data</span><span class="op" id="3846599">[</span><span class="num" id="3846600">5</span><span class="op" id="3846601">]</span><span class="op" id="3846602">)</span><span class="op" id="3846603">&lt;&lt;</span><span class="num" id="3846605">8</span>&nbsp;<span class="op" id="3846607">|</span>&nbsp;<span class="builtintype" id="3846609">uint32</span><span class="op" id="3846615">(</span><span class="ident" id="3846616">data</span><span class="op" id="3846620">[</span><span class="num" id="3846621">6</span><span class="op" id="3846622">]</span><span class="op" id="3846623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3846626">if</span>&nbsp;<span class="builtintype" id="3846629">uint32</span><span class="op" id="3846635">(</span><span class="builtinfunc" id="3846636">len</span><span class="op" id="3846639">(</span><span class="ident" id="3846640">data</span><span class="op" id="3846644">)</span><span class="op" id="3846645">)</span>&nbsp;<span class="op" id="3846647">!=</span>&nbsp;<span class="ident" id="3846650">certsLen</span><span class="op" id="3846658">+</span><span class="num" id="3846659">7</span>&nbsp;<span class="op" id="3846661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3846665">return</span>&nbsp;<span class="builtintype" id="3846672">false</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3846679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846683">numCerts</span>&nbsp;<span class="op" id="3846692">:=</span>&nbsp;<span class="num" id="3846695">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846698">d</span>&nbsp;<span class="op" id="3846700">:=</span>&nbsp;<span class="ident" id="3846703">data</span><span class="op" id="3846707">[</span><span class="num" id="3846708">7</span><span class="op" id="3846709">:</span><span class="op" id="3846710">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3846713">for</span>&nbsp;<span class="ident" id="3846717">certsLen</span>&nbsp;<span class="op" id="3846726">&gt;</span>&nbsp;<span class="num" id="3846728">0</span>&nbsp;<span class="op" id="3846730">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3846734">if</span>&nbsp;<span class="builtinfunc" id="3846737">len</span><span class="op" id="3846740">(</span><span class="ident" id="3846741">d</span><span class="op" id="3846742">)</span>&nbsp;<span class="op" id="3846744">&lt;</span>&nbsp;<span class="num" id="3846746">4</span>&nbsp;<span class="op" id="3846748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3846753">return</span>&nbsp;<span class="builtintype" id="3846760">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3846768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846772">certLen</span>&nbsp;<span class="op" id="3846780">:=</span>&nbsp;<span class="builtintype" id="3846783">uint32</span><span class="op" id="3846789">(</span><span class="ident" id="3846790">d</span><span class="op" id="3846791">[</span><span class="num" id="3846792">0</span><span class="op" id="3846793">]</span><span class="op" id="3846794">)</span><span class="op" id="3846795">&lt;&lt;</span><span class="num" id="3846797">16</span>&nbsp;<span class="op" id="3846800">|</span>&nbsp;<span class="builtintype" id="3846802">uint32</span><span class="op" id="3846808">(</span><span class="ident" id="3846809">d</span><span class="op" id="3846810">[</span><span class="num" id="3846811">1</span><span class="op" id="3846812">]</span><span class="op" id="3846813">)</span><span class="op" id="3846814">&lt;&lt;</span><span class="num" id="3846816">8</span>&nbsp;<span class="op" id="3846818">|</span>&nbsp;<span class="builtintype" id="3846820">uint32</span><span class="op" id="3846826">(</span><span class="ident" id="3846827">d</span><span class="op" id="3846828">[</span><span class="num" id="3846829">2</span><span class="op" id="3846830">]</span><span class="op" id="3846831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3846835">if</span>&nbsp;<span class="builtintype" id="3846838">uint32</span><span class="op" id="3846844">(</span><span class="builtinfunc" id="3846845">len</span><span class="op" id="3846848">(</span><span class="ident" id="3846849">d</span><span class="op" id="3846850">)</span><span class="op" id="3846851">)</span>&nbsp;<span class="op" id="3846853">&lt;</span>&nbsp;<span class="num" id="3846855">3</span><span class="op" id="3846856">+</span><span class="ident" id="3846857">certLen</span>&nbsp;<span class="op" id="3846865">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3846870">return</span>&nbsp;<span class="builtintype" id="3846877">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3846885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846889">d</span>&nbsp;<span class="op" id="3846891">=</span>&nbsp;<span class="ident" id="3846893">d</span><span class="op" id="3846894">[</span><span class="num" id="3846895">3</span><span class="op" id="3846896">+</span><span class="ident" id="3846897">certLen</span><span class="op" id="3846904">:</span><span class="op" id="3846905">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846909">certsLen</span>&nbsp;<span class="op" id="3846918">-=</span>&nbsp;<span class="num" id="3846921">3</span>&nbsp;<span class="op" id="3846923">+</span>&nbsp;<span class="ident" id="3846925">certLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846935">numCerts</span><span class="op" id="3846943">++</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3846947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846951">m</span><span class="op" id="3846952">.</span><span class="ident" id="3846953">certificates</span>&nbsp;<span class="op" id="3846966">=</span>&nbsp;<span class="builtinfunc" id="3846968">make</span><span class="op" id="3846972">(</span><span class="op" id="3846973">[</span><span class="op" id="3846974">]</span><span class="op" id="3846975">[</span><span class="op" id="3846976">]</span><span class="builtintype" id="3846977">byte</span><span class="op" id="3846981">,</span>&nbsp;<span class="ident" id="3846983">numCerts</span><span class="op" id="3846991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3846994">d</span>&nbsp;<span class="op" id="3846996">=</span>&nbsp;<span class="ident" id="3846998">data</span><span class="op" id="3847002">[</span><span class="num" id="3847003">7</span><span class="op" id="3847004">:</span><span class="op" id="3847005">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3847008">for</span>&nbsp;<span class="ident" id="3847012">i</span>&nbsp;<span class="op" id="3847014">:=</span>&nbsp;<span class="num" id="3847017">0</span><span class="op" id="3847018">;</span>&nbsp;<span class="ident" id="3847020">i</span>&nbsp;<span class="op" id="3847022">&lt;</span>&nbsp;<span class="ident" id="3847024">numCerts</span><span class="op" id="3847032">;</span>&nbsp;<span class="ident" id="3847034">i</span><span class="op" id="3847035">++</span>&nbsp;<span class="op" id="3847038">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3847042">certLen</span>&nbsp;<span class="op" id="3847050">:=</span>&nbsp;<span class="builtintype" id="3847053">uint32</span><span class="op" id="3847059">(</span><span class="ident" id="3847060">d</span><span class="op" id="3847061">[</span><span class="num" id="3847062">0</span><span class="op" id="3847063">]</span><span class="op" id="3847064">)</span><span class="op" id="3847065">&lt;&lt;</span><span class="num" id="3847067">16</span>&nbsp;<span class="op" id="3847070">|</span>&nbsp;<span class="builtintype" id="3847072">uint32</span><span class="op" id="3847078">(</span><span class="ident" id="3847079">d</span><span class="op" id="3847080">[</span><span class="num" id="3847081">1</span><span class="op" id="3847082">]</span><span class="op" id="3847083">)</span><span class="op" id="3847084">&lt;&lt;</span><span class="num" id="3847086">8</span>&nbsp;<span class="op" id="3847088">|</span>&nbsp;<span class="builtintype" id="3847090">uint32</span><span class="op" id="3847096">(</span><span class="ident" id="3847097">d</span><span class="op" id="3847098">[</span><span class="num" id="3847099">2</span><span class="op" id="3847100">]</span><span class="op" id="3847101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3847105">m</span><span class="op" id="3847106">.</span><span class="ident" id="3847107">certificates</span><span class="op" id="3847119">[</span><span class="ident" id="3847120">i</span><span class="op" id="3847121">]</span>&nbsp;<span class="op" id="3847123">=</span>&nbsp;<span class="ident" id="3847125">d</span><span class="op" id="3847126">[</span><span class="num" id="3847127">3</span>&nbsp;<span class="op" id="3847129">:</span>&nbsp;<span class="num" id="3847131">3</span><span class="op" id="3847132">+</span><span class="ident" id="3847133">certLen</span><span class="op" id="3847140">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3847144">d</span>&nbsp;<span class="op" id="3847146">=</span>&nbsp;<span class="ident" id="3847148">d</span><span class="op" id="3847149">[</span><span class="num" id="3847150">3</span><span class="op" id="3847151">+</span><span class="ident" id="3847152">certLen</span><span class="op" id="3847159">:</span><span class="op" id="3847160">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3847163">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3847167">return</span>&nbsp;<span class="builtintype" id="3847174">true</span><br>
<span class="lineno"></span><span class="op" id="3847179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3847182">type</span>&nbsp;<span class="ident" id="3847187">serverKeyExchangeMsg</span>&nbsp;<span class="keyword" id="3847208">struct</span>&nbsp;<span class="op" id="3847215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3847218">raw</span>&nbsp;<span class="op" id="3847222">[</span><span class="op" id="3847223">]</span><span class="builtintype" id="3847224">byte</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3847230">key</span>&nbsp;<span class="op" id="3847234">[</span><span class="op" id="3847235">]</span><span class="builtintype" id="3847236">byte</span><br>
<span class="lineno"></span><span class="op" id="3847241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3847244">func</span>&nbsp;<span class="op" id="3847249">(</span><span class="ident" id="3847250">m</span>&nbsp;<span class="op" id="3847252">*</span><span class="ident" id="3847253">serverKeyExchangeMsg</span><span class="op" id="3847273">)</span>&nbsp;<span class="ident" id="3847275">equal</span><span class="op" id="3847280">(</span><span class="ident" id="3847281">i</span>&nbsp;<span class="keyword" id="3847283">interface</span><span class="op" id="3847292">{</span><span class="op" id="3847293">}</span><span class="op" id="3847294">)</span>&nbsp;<span class="builtintype" id="3847296">bool</span>&nbsp;<span class="op" id="3847301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3847304">m1</span><span class="op" id="3847306">,</span>&nbsp;<span class="ident" id="3847308">ok</span>&nbsp;<span class="op" id="3847311">:=</span>&nbsp;<span class="ident" id="3847314">i</span><span class="op" id="3847315">.</span><span class="op" id="3847316">(</span><span class="op" id="3847317">*</span><span class="ident" id="3847318">serverKeyExchangeMsg</span><span class="op" id="3847338">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3847341">if</span>&nbsp;<span class="op" id="3847344">!</span><span class="ident" id="3847345">ok</span>&nbsp;<span class="op" id="3847348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3847352">return</span>&nbsp;<span class="builtintype" id="3847359">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3847366">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3847370">return</span>&nbsp;<span class="ident" id="3847377">bytes</span><span class="op" id="3847382">.</span><span class="ident" id="3847383">Equal</span><span class="op" id="3847388">(</span><span class="ident" id="3847389">m</span><span class="op" id="3847390">.</span><span class="ident" id="3847391">raw</span><span class="op" id="3847394">,</span>&nbsp;<span class="ident" id="3847396">m1</span><span class="op" id="3847398">.</span><span class="ident" id="3847399">raw</span><span class="op" id="3847402">)</span>&nbsp;<span class="op" id="3847404">&amp;&amp;</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3847409">bytes</span><span class="op" id="3847414">.</span><span class="ident" id="3847415">Equal</span><span class="op" id="3847420">(</span><span class="ident" id="3847421">m</span><span class="op" id="3847422">.</span><span class="ident" id="3847423">key</span><span class="op" id="3847426">,</span>&nbsp;<span class="ident" id="3847428">m1</span><span class="op" id="3847430">.</span><span class="ident" id="3847431">key</span><span class="op" id="3847434">)</span><br>
<span class="lineno"></span><span class="op" id="3847436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3847439">func</span>&nbsp;<span class="op" id="3847444">(</span><span class="ident" id="3847445">m</span>&nbsp;<span class="op" id="3847447">*</span><span class="ident" id="3847448">serverKeyExchangeMsg</span><span class="op" id="3847468">)</span>&nbsp;<span class="ident" id="3847470">marshal</span><span class="op" id="3847477">(</span><span class="op" id="3847478">)</span>&nbsp;<span class="op" id="3847480">[</span><span class="op" id="3847481">]</span><span class="builtintype" id="3847482">byte</span>&nbsp;<span class="op" id="3847487">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3847490">if</span>&nbsp;<span class="ident" id="3847493">m</span><span class="op" id="3847494">.</span><span class="ident" id="3847495">raw</span>&nbsp;<span class="op" id="3847499">!=</span>&nbsp;<span class="ident" id="3847502">nil</span>&nbsp;<span class="op" id="3847506">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3847510">return</span>&nbsp;<span class="ident" id="3847517">m</span><span class="op" id="3847518">.</span><span class="ident" id="3847519">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3847524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3847527">length</span>&nbsp;<span class="op" id="3847534">:=</span>&nbsp;<span class="builtinfunc" id="3847537">len</span><span class="op" id="3847540">(</span><span class="ident" id="3847541">m</span><span class="op" id="3847542">.</span><span class="ident" id="3847543">key</span><span class="op" id="3847546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3847549">x</span>&nbsp;<span class="op" id="3847551">:=</span>&nbsp;<span class="builtinfunc" id="3847554">make</span><span class="op" id="3847558">(</span><span class="op" id="3847559">[</span><span class="op" id="3847560">]</span><span class="builtintype" id="3847561">byte</span><span class="op" id="3847565">,</span>&nbsp;<span class="ident" id="3847567">length</span><span class="op" id="3847573">+</span><span class="num" id="3847574">4</span><span class="op" id="3847575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3847578">x</span><span class="op" id="3847579">[</span><span class="num" id="3847580">0</span><span class="op" id="3847581">]</span>&nbsp;<span class="op" id="3847583">=</span>&nbsp;<span class="ident" id="3847585">typeServerKeyExchange</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3847608">x</span><span class="op" id="3847609">[</span><span class="num" id="3847610">1</span><span class="op" id="3847611">]</span>&nbsp;<span class="op" id="3847613">=</span>&nbsp;<span class="builtintype" id="3847615">uint8</span><span class="op" id="3847620">(</span><span class="ident" id="3847621">length</span>&nbsp;<span class="op" id="3847628">&gt;&gt;</span>&nbsp;<span class="num" id="3847631">16</span><span class="op" id="3847633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3847636">x</span><span class="op" id="3847637">[</span><span class="num" id="3847638">2</span><span class="op" id="3847639">]</span>&nbsp;<span class="op" id="3847641">=</span>&nbsp;<span class="builtintype" id="3847643">uint8</span><span class="op" id="3847648">(</span><span class="ident" id="3847649">length</span>&nbsp;<span class="op" id="3847656">&gt;&gt;</span>&nbsp;<span class="num" id="3847659">8</span><span class="op" id="3847660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3847663">x</span><span class="op" id="3847664">[</span><span class="num" id="3847665">3</span><span class="op" id="3847666">]</span>&nbsp;<span class="op" id="3847668">=</span>&nbsp;<span class="builtintype" id="3847670">uint8</span><span class="op" id="3847675">(</span><span class="ident" id="3847676">length</span><span class="op" id="3847682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3847685">copy</span><span class="op" id="3847689">(</span><span class="ident" id="3847690">x</span><span class="op" id="3847691">[</span><span class="num" id="3847692">4</span><span class="op" id="3847693">:</span><span class="op" id="3847694">]</span><span class="op" id="3847695">,</span>&nbsp;<span class="ident" id="3847697">m</span><span class="op" id="3847698">.</span><span class="ident" id="3847699">key</span><span class="op" id="3847702">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3847706">m</span><span class="op" id="3847707">.</span><span class="ident" id="3847708">raw</span>&nbsp;<span class="op" id="3847712">=</span>&nbsp;<span class="ident" id="3847714">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3847717">return</span>&nbsp;<span class="ident" id="3847724">x</span><br>
<span class="lineno"></span><span class="op" id="3847726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3847729">func</span>&nbsp;<span class="op" id="3847734">(</span><span class="ident" id="3847735">m</span>&nbsp;<span class="op" id="3847737">*</span><span class="ident" id="3847738">serverKeyExchangeMsg</span><span class="op" id="3847758">)</span>&nbsp;<span class="ident" id="3847760">unmarshal</span><span class="op" id="3847769">(</span><span class="ident" id="3847770">data</span>&nbsp;<span class="op" id="3847775">[</span><span class="op" id="3847776">]</span><span class="builtintype" id="3847777">byte</span><span class="op" id="3847781">)</span>&nbsp;<span class="builtintype" id="3847783">bool</span>&nbsp;<span class="op" id="3847788">{</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3847791">m</span><span class="op" id="3847792">.</span><span class="ident" id="3847793">raw</span>&nbsp;<span class="op" id="3847797">=</span>&nbsp;<span class="ident" id="3847799">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3847805">if</span>&nbsp;<span class="builtinfunc" id="3847808">len</span><span class="op" id="3847811">(</span><span class="ident" id="3847812">data</span><span class="op" id="3847816">)</span>&nbsp;<span class="op" id="3847818">&lt;</span>&nbsp;<span class="num" id="3847820">4</span>&nbsp;<span class="op" id="3847822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3847826">return</span>&nbsp;<span class="builtintype" id="3847833">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3847840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3847843">m</span><span class="op" id="3847844">.</span><span class="ident" id="3847845">key</span>&nbsp;<span class="op" id="3847849">=</span>&nbsp;<span class="ident" id="3847851">data</span><span class="op" id="3847855">[</span><span class="num" id="3847856">4</span><span class="op" id="3847857">:</span><span class="op" id="3847858">]</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3847861">return</span>&nbsp;<span class="builtintype" id="3847868">true</span><br>
<span class="lineno"></span><span class="op" id="3847873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3847876">type</span>&nbsp;<span class="ident" id="3847881">certificateStatusMsg</span>&nbsp;<span class="keyword" id="3847902">struct</span>&nbsp;<span class="op" id="3847909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3847912">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3847923">[</span><span class="op" id="3847924">]</span><span class="builtintype" id="3847925">byte</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3847931">statusType</span>&nbsp;<span class="builtintype" id="3847942">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3847949">response</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3847960">[</span><span class="op" id="3847961">]</span><span class="builtintype" id="3847962">byte</span><br>
<span class="lineno"></span><span class="op" id="3847967">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3847970">func</span>&nbsp;<span class="op" id="3847975">(</span><span class="ident" id="3847976">m</span>&nbsp;<span class="op" id="3847978">*</span><span class="ident" id="3847979">certificateStatusMsg</span><span class="op" id="3847999">)</span>&nbsp;<span class="ident" id="3848001">equal</span><span class="op" id="3848006">(</span><span class="ident" id="3848007">i</span>&nbsp;<span class="keyword" id="3848009">interface</span><span class="op" id="3848018">{</span><span class="op" id="3848019">}</span><span class="op" id="3848020">)</span>&nbsp;<span class="builtintype" id="3848022">bool</span>&nbsp;<span class="op" id="3848027">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848030">m1</span><span class="op" id="3848032">,</span>&nbsp;<span class="ident" id="3848034">ok</span>&nbsp;<span class="op" id="3848037">:=</span>&nbsp;<span class="ident" id="3848040">i</span><span class="op" id="3848041">.</span><span class="op" id="3848042">(</span><span class="op" id="3848043">*</span><span class="ident" id="3848044">certificateStatusMsg</span><span class="op" id="3848064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3848067">if</span>&nbsp;<span class="op" id="3848070">!</span><span class="ident" id="3848071">ok</span>&nbsp;<span class="op" id="3848074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3848078">return</span>&nbsp;<span class="builtintype" id="3848085">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3848092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3848096">return</span>&nbsp;<span class="ident" id="3848103">bytes</span><span class="op" id="3848108">.</span><span class="ident" id="3848109">Equal</span><span class="op" id="3848114">(</span><span class="ident" id="3848115">m</span><span class="op" id="3848116">.</span><span class="ident" id="3848117">raw</span><span class="op" id="3848120">,</span>&nbsp;<span class="ident" id="3848122">m1</span><span class="op" id="3848124">.</span><span class="ident" id="3848125">raw</span><span class="op" id="3848128">)</span>&nbsp;<span class="op" id="3848130">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848135">m</span><span class="op" id="3848136">.</span><span class="ident" id="3848137">statusType</span>&nbsp;<span class="op" id="3848148">==</span>&nbsp;<span class="ident" id="3848151">m1</span><span class="op" id="3848153">.</span><span class="ident" id="3848154">statusType</span>&nbsp;<span class="op" id="3848165">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848170">bytes</span><span class="op" id="3848175">.</span><span class="ident" id="3848176">Equal</span><span class="op" id="3848181">(</span><span class="ident" id="3848182">m</span><span class="op" id="3848183">.</span><span class="ident" id="3848184">response</span><span class="op" id="3848192">,</span>&nbsp;<span class="ident" id="3848194">m1</span><span class="op" id="3848196">.</span><span class="ident" id="3848197">response</span><span class="op" id="3848205">)</span><br>
<span class="lineno"></span><span class="op" id="3848207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="3848210">func</span>&nbsp;<span class="op" id="3848215">(</span><span class="ident" id="3848216">m</span>&nbsp;<span class="op" id="3848218">*</span><span class="ident" id="3848219">certificateStatusMsg</span><span class="op" id="3848239">)</span>&nbsp;<span class="ident" id="3848241">marshal</span><span class="op" id="3848248">(</span><span class="op" id="3848249">)</span>&nbsp;<span class="op" id="3848251">[</span><span class="op" id="3848252">]</span><span class="builtintype" id="3848253">byte</span>&nbsp;<span class="op" id="3848258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3848261">if</span>&nbsp;<span class="ident" id="3848264">m</span><span class="op" id="3848265">.</span><span class="ident" id="3848266">raw</span>&nbsp;<span class="op" id="3848270">!=</span>&nbsp;<span class="ident" id="3848273">nil</span>&nbsp;<span class="op" id="3848277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3848281">return</span>&nbsp;<span class="ident" id="3848288">m</span><span class="op" id="3848289">.</span><span class="ident" id="3848290">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3848295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3848299">var</span>&nbsp;<span class="ident" id="3848303">x</span>&nbsp;<span class="op" id="3848305">[</span><span class="op" id="3848306">]</span><span class="builtintype" id="3848307">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3848313">if</span>&nbsp;<span class="ident" id="3848316">m</span><span class="op" id="3848317">.</span><span class="ident" id="3848318">statusType</span>&nbsp;<span class="op" id="3848329">==</span>&nbsp;<span class="ident" id="3848332">statusTypeOCSP</span>&nbsp;<span class="op" id="3848347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848351">x</span>&nbsp;<span class="op" id="3848353">=</span>&nbsp;<span class="builtinfunc" id="3848355">make</span><span class="op" id="3848359">(</span><span class="op" id="3848360">[</span><span class="op" id="3848361">]</span><span class="builtintype" id="3848362">byte</span><span class="op" id="3848366">,</span>&nbsp;<span class="num" id="3848368">4</span><span class="op" id="3848369">+</span><span class="num" id="3848370">4</span><span class="op" id="3848371">+</span><span class="builtinfunc" id="3848372">len</span><span class="op" id="3848375">(</span><span class="ident" id="3848376">m</span><span class="op" id="3848377">.</span><span class="ident" id="3848378">response</span><span class="op" id="3848386">)</span><span class="op" id="3848387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848391">x</span><span class="op" id="3848392">[</span><span class="num" id="3848393">0</span><span class="op" id="3848394">]</span>&nbsp;<span class="op" id="3848396">=</span>&nbsp;<span class="ident" id="3848398">typeCertificateStatus</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848422">l</span>&nbsp;<span class="op" id="3848424">:=</span>&nbsp;<span class="builtinfunc" id="3848427">len</span><span class="op" id="3848430">(</span><span class="ident" id="3848431">m</span><span class="op" id="3848432">.</span><span class="ident" id="3848433">response</span><span class="op" id="3848441">)</span>&nbsp;<span class="op" id="3848443">+</span>&nbsp;<span class="num" id="3848445">4</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848449">x</span><span class="op" id="3848450">[</span><span class="num" id="3848451">1</span><span class="op" id="3848452">]</span>&nbsp;<span class="op" id="3848454">=</span>&nbsp;<span class="builtintype" id="3848456">byte</span><span class="op" id="3848460">(</span><span class="ident" id="3848461">l</span>&nbsp;<span class="op" id="3848463">&gt;&gt;</span>&nbsp;<span class="num" id="3848466">16</span><span class="op" id="3848468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848472">x</span><span class="op" id="3848473">[</span><span class="num" id="3848474">2</span><span class="op" id="3848475">]</span>&nbsp;<span class="op" id="3848477">=</span>&nbsp;<span class="builtintype" id="3848479">byte</span><span class="op" id="3848483">(</span><span class="ident" id="3848484">l</span>&nbsp;<span class="op" id="3848486">&gt;&gt;</span>&nbsp;<span class="num" id="3848489">8</span><span class="op" id="3848490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848494">x</span><span class="op" id="3848495">[</span><span class="num" id="3848496">3</span><span class="op" id="3848497">]</span>&nbsp;<span class="op" id="3848499">=</span>&nbsp;<span class="builtintype" id="3848501">byte</span><span class="op" id="3848505">(</span><span class="ident" id="3848506">l</span><span class="op" id="3848507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848511">x</span><span class="op" id="3848512">[</span><span class="num" id="3848513">4</span><span class="op" id="3848514">]</span>&nbsp;<span class="op" id="3848516">=</span>&nbsp;<span class="ident" id="3848518">statusTypeOCSP</span><br>
<span class="lineno"></span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848536">l</span>&nbsp;<span class="op" id="3848538">-=</span>&nbsp;<span class="num" id="3848541">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848545">x</span><span class="op" id="3848546">[</span><span class="num" id="3848547">5</span><span class="op" id="3848548">]</span>&nbsp;<span class="op" id="3848550">=</span>&nbsp;<span class="builtintype" id="3848552">byte</span><span class="op" id="3848556">(</span><span class="ident" id="3848557">l</span>&nbsp;<span class="op" id="3848559">&gt;&gt;</span>&nbsp;<span class="num" id="3848562">16</span><span class="op" id="3848564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848568">x</span><span class="op" id="3848569">[</span><span class="num" id="3848570">6</span><span class="op" id="3848571">]</span>&nbsp;<span class="op" id="3848573">=</span>&nbsp;<span class="builtintype" id="3848575">byte</span><span class="op" id="3848579">(</span><span class="ident" id="3848580">l</span>&nbsp;<span class="op" id="3848582">&gt;&gt;</span>&nbsp;<span class="num" id="3848585">8</span><span class="op" id="3848586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848590">x</span><span class="op" id="3848591">[</span><span class="num" id="3848592">7</span><span class="op" id="3848593">]</span>&nbsp;<span class="op" id="3848595">=</span>&nbsp;<span class="builtintype" id="3848597">byte</span><span class="op" id="3848601">(</span><span class="ident" id="3848602">l</span><span class="op" id="3848603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3848607">copy</span><span class="op" id="3848611">(</span><span class="ident" id="3848612">x</span><span class="op" id="3848613">[</span><span class="num" id="3848614">8</span><span class="op" id="3848615">:</span><span class="op" id="3848616">]</span><span class="op" id="3848617">,</span>&nbsp;<span class="ident" id="3848619">m</span><span class="op" id="3848620">.</span><span class="ident" id="3848621">response</span><span class="op" id="3848629">)</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3848632">}</span>&nbsp;<span class="keyword" id="3848634">else</span>&nbsp;<span class="op" id="3848639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848643">x</span>&nbsp;<span class="op" id="3848645">=</span>&nbsp;<span class="op" id="3848647">[</span><span class="op" id="3848648">]</span><span class="builtintype" id="3848649">byte</span><span class="op" id="3848653">{</span><span class="ident" id="3848654">typeCertificateStatus</span><span class="op" id="3848675">,</span>&nbsp;<span class="num" id="3848677">0</span><span class="op" id="3848678">,</span>&nbsp;<span class="num" id="3848680">0</span><span class="op" id="3848681">,</span>&nbsp;<span class="num" id="3848683">1</span><span class="op" id="3848684">,</span>&nbsp;<span class="ident" id="3848686">m</span><span class="op" id="3848687">.</span><span class="ident" id="3848688">statusType</span><span class="op" id="3848698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3848701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848705">m</span><span class="op" id="3848706">.</span><span class="ident" id="3848707">raw</span>&nbsp;<span class="op" id="3848711">=</span>&nbsp;<span class="ident" id="3848713">x</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3848716">return</span>&nbsp;<span class="ident" id="3848723">x</span><br>
<span class="lineno"></span><span class="op" id="3848725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3848728">func</span>&nbsp;<span class="op" id="3848733">(</span><span class="ident" id="3848734">m</span>&nbsp;<span class="op" id="3848736">*</span><span class="ident" id="3848737">certificateStatusMsg</span><span class="op" id="3848757">)</span>&nbsp;<span class="ident" id="3848759">unmarshal</span><span class="op" id="3848768">(</span><span class="ident" id="3848769">data</span>&nbsp;<span class="op" id="3848774">[</span><span class="op" id="3848775">]</span><span class="builtintype" id="3848776">byte</span><span class="op" id="3848780">)</span>&nbsp;<span class="builtintype" id="3848782">bool</span>&nbsp;<span class="op" id="3848787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848790">m</span><span class="op" id="3848791">.</span><span class="ident" id="3848792">raw</span>&nbsp;<span class="op" id="3848796">=</span>&nbsp;<span class="ident" id="3848798">data</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3848804">if</span>&nbsp;<span class="builtinfunc" id="3848807">len</span><span class="op" id="3848810">(</span><span class="ident" id="3848811">data</span><span class="op" id="3848815">)</span>&nbsp;<span class="op" id="3848817">&lt;</span>&nbsp;<span class="num" id="3848819">5</span>&nbsp;<span class="op" id="3848821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3848825">return</span>&nbsp;<span class="builtintype" id="3848832">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3848839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848842">m</span><span class="op" id="3848843">.</span><span class="ident" id="3848844">statusType</span>&nbsp;<span class="op" id="3848855">=</span>&nbsp;<span class="ident" id="3848857">data</span><span class="op" id="3848861">[</span><span class="num" id="3848862">4</span><span class="op" id="3848863">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848867">m</span><span class="op" id="3848868">.</span><span class="ident" id="3848869">response</span>&nbsp;<span class="op" id="3848878">=</span>&nbsp;<span class="ident" id="3848880">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3848885">if</span>&nbsp;<span class="ident" id="3848888">m</span><span class="op" id="3848889">.</span><span class="ident" id="3848890">statusType</span>&nbsp;<span class="op" id="3848901">==</span>&nbsp;<span class="ident" id="3848904">statusTypeOCSP</span>&nbsp;<span class="op" id="3848919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3848923">if</span>&nbsp;<span class="builtinfunc" id="3848926">len</span><span class="op" id="3848929">(</span><span class="ident" id="3848930">data</span><span class="op" id="3848934">)</span>&nbsp;<span class="op" id="3848936">&lt;</span>&nbsp;<span class="num" id="3848938">8</span>&nbsp;<span class="op" id="3848940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3848945">return</span>&nbsp;<span class="builtintype" id="3848952">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3848960">}</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3848964">respLen</span>&nbsp;<span class="op" id="3848972">:=</span>&nbsp;<span class="builtintype" id="3848975">uint32</span><span class="op" id="3848981">(</span><span class="ident" id="3848982">data</span><span class="op" id="3848986">[</span><span class="num" id="3848987">5</span><span class="op" id="3848988">]</span><span class="op" id="3848989">)</span><span class="op" id="3848990">&lt;&lt;</span><span class="num" id="3848992">16</span>&nbsp;<span class="op" id="3848995">|</span>&nbsp;<span class="builtintype" id="3848997">uint32</span><span class="op" id="3849003">(</span><span class="ident" id="3849004">data</span><span class="op" id="3849008">[</span><span class="num" id="3849009">6</span><span class="op" id="3849010">]</span><span class="op" id="3849011">)</span><span class="op" id="3849012">&lt;&lt;</span><span class="num" id="3849014">8</span>&nbsp;<span class="op" id="3849016">|</span>&nbsp;<span class="builtintype" id="3849018">uint32</span><span class="op" id="3849024">(</span><span class="ident" id="3849025">data</span><span class="op" id="3849029">[</span><span class="num" id="3849030">7</span><span class="op" id="3849031">]</span><span class="op" id="3849032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3849036">if</span>&nbsp;<span class="builtintype" id="3849039">uint32</span><span class="op" id="3849045">(</span><span class="builtinfunc" id="3849046">len</span><span class="op" id="3849049">(</span><span class="ident" id="3849050">data</span><span class="op" id="3849054">)</span><span class="op" id="3849055">)</span>&nbsp;<span class="op" id="3849057">!=</span>&nbsp;<span class="num" id="3849060">4</span><span class="op" id="3849061">+</span><span class="num" id="3849062">4</span><span class="op" id="3849063">+</span><span class="ident" id="3849064">respLen</span>&nbsp;<span class="op" id="3849072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3849077">return</span>&nbsp;<span class="builtintype" id="3849084">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3849092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3849096">m</span><span class="op" id="3849097">.</span><span class="ident" id="3849098">response</span>&nbsp;<span class="op" id="3849107">=</span>&nbsp;<span class="ident" id="3849109">data</span><span class="op" id="3849113">[</span><span class="num" id="3849114">8</span><span class="op" id="3849115">:</span><span class="op" id="3849116">]</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3849119">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3849122">return</span>&nbsp;<span class="builtintype" id="3849129">true</span><br>
<span class="lineno"></span><span class="op" id="3849134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3849137">type</span>&nbsp;<span class="ident" id="3849142">serverHelloDoneMsg</span>&nbsp;<span class="keyword" id="3849161">struct</span><span class="op" id="3849167">{</span><span class="op" id="3849168">}</span><br>
<span class="lineno">910</span><br>
<span class="lineno"></span><span class="keyword" id="3849171">func</span>&nbsp;<span class="op" id="3849176">(</span><span class="ident" id="3849177">m</span>&nbsp;<span class="op" id="3849179">*</span><span class="ident" id="3849180">serverHelloDoneMsg</span><span class="op" id="3849198">)</span>&nbsp;<span class="ident" id="3849200">equal</span><span class="op" id="3849205">(</span><span class="ident" id="3849206">i</span>&nbsp;<span class="keyword" id="3849208">interface</span><span class="op" id="3849217">{</span><span class="op" id="3849218">}</span><span class="op" id="3849219">)</span>&nbsp;<span class="builtintype" id="3849221">bool</span>&nbsp;<span class="op" id="3849226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3849229">_</span><span class="op" id="3849230">,</span>&nbsp;<span class="ident" id="3849232">ok</span>&nbsp;<span class="op" id="3849235">:=</span>&nbsp;<span class="ident" id="3849238">i</span><span class="op" id="3849239">.</span><span class="op" id="3849240">(</span><span class="op" id="3849241">*</span><span class="ident" id="3849242">serverHelloDoneMsg</span><span class="op" id="3849260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3849263">return</span>&nbsp;<span class="ident" id="3849270">ok</span><br>
<span class="lineno"></span><span class="op" id="3849273">}</span><br>
<span class="lineno">915</span><br>
<span class="lineno"></span><span class="keyword" id="3849276">func</span>&nbsp;<span class="op" id="3849281">(</span><span class="ident" id="3849282">m</span>&nbsp;<span class="op" id="3849284">*</span><span class="ident" id="3849285">serverHelloDoneMsg</span><span class="op" id="3849303">)</span>&nbsp;<span class="ident" id="3849305">marshal</span><span class="op" id="3849312">(</span><span class="op" id="3849313">)</span>&nbsp;<span class="op" id="3849315">[</span><span class="op" id="3849316">]</span><span class="builtintype" id="3849317">byte</span>&nbsp;<span class="op" id="3849322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3849325">x</span>&nbsp;<span class="op" id="3849327">:=</span>&nbsp;<span class="builtinfunc" id="3849330">make</span><span class="op" id="3849334">(</span><span class="op" id="3849335">[</span><span class="op" id="3849336">]</span><span class="builtintype" id="3849337">byte</span><span class="op" id="3849341">,</span>&nbsp;<span class="num" id="3849343">4</span><span class="op" id="3849344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3849347">x</span><span class="op" id="3849348">[</span><span class="num" id="3849349">0</span><span class="op" id="3849350">]</span>&nbsp;<span class="op" id="3849352">=</span>&nbsp;<span class="ident" id="3849354">typeServerHelloDone</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3849375">return</span>&nbsp;<span class="ident" id="3849382">x</span><br>
<span class="lineno">920</span><span class="op" id="3849384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3849387">func</span>&nbsp;<span class="op" id="3849392">(</span><span class="ident" id="3849393">m</span>&nbsp;<span class="op" id="3849395">*</span><span class="ident" id="3849396">serverHelloDoneMsg</span><span class="op" id="3849414">)</span>&nbsp;<span class="ident" id="3849416">unmarshal</span><span class="op" id="3849425">(</span><span class="ident" id="3849426">data</span>&nbsp;<span class="op" id="3849431">[</span><span class="op" id="3849432">]</span><span class="builtintype" id="3849433">byte</span><span class="op" id="3849437">)</span>&nbsp;<span class="builtintype" id="3849439">bool</span>&nbsp;<span class="op" id="3849444">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3849447">return</span>&nbsp;<span class="builtinfunc" id="3849454">len</span><span class="op" id="3849457">(</span><span class="ident" id="3849458">data</span><span class="op" id="3849462">)</span>&nbsp;<span class="op" id="3849464">==</span>&nbsp;<span class="num" id="3849467">4</span><br>
<span class="lineno"></span><span class="op" id="3849469">}</span><br>
<span class="lineno">925</span><br>
<span class="lineno"></span><span class="keyword" id="3849472">type</span>&nbsp;<span class="ident" id="3849477">clientKeyExchangeMsg</span>&nbsp;<span class="keyword" id="3849498">struct</span>&nbsp;<span class="op" id="3849505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3849508">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3849519">[</span><span class="op" id="3849520">]</span><span class="builtintype" id="3849521">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3849527">ciphertext</span>&nbsp;<span class="op" id="3849538">[</span><span class="op" id="3849539">]</span><span class="builtintype" id="3849540">byte</span><br>
<span class="lineno"></span><span class="op" id="3849545">}</span><br>
<span class="lineno">930</span><br>
<span class="lineno"></span><span class="keyword" id="3849548">func</span>&nbsp;<span class="op" id="3849553">(</span><span class="ident" id="3849554">m</span>&nbsp;<span class="op" id="3849556">*</span><span class="ident" id="3849557">clientKeyExchangeMsg</span><span class="op" id="3849577">)</span>&nbsp;<span class="ident" id="3849579">equal</span><span class="op" id="3849584">(</span><span class="ident" id="3849585">i</span>&nbsp;<span class="keyword" id="3849587">interface</span><span class="op" id="3849596">{</span><span class="op" id="3849597">}</span><span class="op" id="3849598">)</span>&nbsp;<span class="builtintype" id="3849600">bool</span>&nbsp;<span class="op" id="3849605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3849608">m1</span><span class="op" id="3849610">,</span>&nbsp;<span class="ident" id="3849612">ok</span>&nbsp;<span class="op" id="3849615">:=</span>&nbsp;<span class="ident" id="3849618">i</span><span class="op" id="3849619">.</span><span class="op" id="3849620">(</span><span class="op" id="3849621">*</span><span class="ident" id="3849622">clientKeyExchangeMsg</span><span class="op" id="3849642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3849645">if</span>&nbsp;<span class="op" id="3849648">!</span><span class="ident" id="3849649">ok</span>&nbsp;<span class="op" id="3849652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3849656">return</span>&nbsp;<span class="builtintype" id="3849663">false</span><br>
<span class="lineno">935</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3849670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3849674">return</span>&nbsp;<span class="ident" id="3849681">bytes</span><span class="op" id="3849686">.</span><span class="ident" id="3849687">Equal</span><span class="op" id="3849692">(</span><span class="ident" id="3849693">m</span><span class="op" id="3849694">.</span><span class="ident" id="3849695">raw</span><span class="op" id="3849698">,</span>&nbsp;<span class="ident" id="3849700">m1</span><span class="op" id="3849702">.</span><span class="ident" id="3849703">raw</span><span class="op" id="3849706">)</span>&nbsp;<span class="op" id="3849708">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3849713">bytes</span><span class="op" id="3849718">.</span><span class="ident" id="3849719">Equal</span><span class="op" id="3849724">(</span><span class="ident" id="3849725">m</span><span class="op" id="3849726">.</span><span class="ident" id="3849727">ciphertext</span><span class="op" id="3849737">,</span>&nbsp;<span class="ident" id="3849739">m1</span><span class="op" id="3849741">.</span><span class="ident" id="3849742">ciphertext</span><span class="op" id="3849752">)</span><br>
<span class="lineno"></span><span class="op" id="3849754">}</span><br>
<span class="lineno">940</span><br>
<span class="lineno"></span><span class="keyword" id="3849757">func</span>&nbsp;<span class="op" id="3849762">(</span><span class="ident" id="3849763">m</span>&nbsp;<span class="op" id="3849765">*</span><span class="ident" id="3849766">clientKeyExchangeMsg</span><span class="op" id="3849786">)</span>&nbsp;<span class="ident" id="3849788">marshal</span><span class="op" id="3849795">(</span><span class="op" id="3849796">)</span>&nbsp;<span class="op" id="3849798">[</span><span class="op" id="3849799">]</span><span class="builtintype" id="3849800">byte</span>&nbsp;<span class="op" id="3849805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3849808">if</span>&nbsp;<span class="ident" id="3849811">m</span><span class="op" id="3849812">.</span><span class="ident" id="3849813">raw</span>&nbsp;<span class="op" id="3849817">!=</span>&nbsp;<span class="ident" id="3849820">nil</span>&nbsp;<span class="op" id="3849824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3849828">return</span>&nbsp;<span class="ident" id="3849835">m</span><span class="op" id="3849836">.</span><span class="ident" id="3849837">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3849842">}</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3849845">length</span>&nbsp;<span class="op" id="3849852">:=</span>&nbsp;<span class="builtinfunc" id="3849855">len</span><span class="op" id="3849858">(</span><span class="ident" id="3849859">m</span><span class="op" id="3849860">.</span><span class="ident" id="3849861">ciphertext</span><span class="op" id="3849871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3849874">x</span>&nbsp;<span class="op" id="3849876">:=</span>&nbsp;<span class="builtinfunc" id="3849879">make</span><span class="op" id="3849883">(</span><span class="op" id="3849884">[</span><span class="op" id="3849885">]</span><span class="builtintype" id="3849886">byte</span><span class="op" id="3849890">,</span>&nbsp;<span class="ident" id="3849892">length</span><span class="op" id="3849898">+</span><span class="num" id="3849899">4</span><span class="op" id="3849900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3849903">x</span><span class="op" id="3849904">[</span><span class="num" id="3849905">0</span><span class="op" id="3849906">]</span>&nbsp;<span class="op" id="3849908">=</span>&nbsp;<span class="ident" id="3849910">typeClientKeyExchange</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3849933">x</span><span class="op" id="3849934">[</span><span class="num" id="3849935">1</span><span class="op" id="3849936">]</span>&nbsp;<span class="op" id="3849938">=</span>&nbsp;<span class="builtintype" id="3849940">uint8</span><span class="op" id="3849945">(</span><span class="ident" id="3849946">length</span>&nbsp;<span class="op" id="3849953">&gt;&gt;</span>&nbsp;<span class="num" id="3849956">16</span><span class="op" id="3849958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3849961">x</span><span class="op" id="3849962">[</span><span class="num" id="3849963">2</span><span class="op" id="3849964">]</span>&nbsp;<span class="op" id="3849966">=</span>&nbsp;<span class="builtintype" id="3849968">uint8</span><span class="op" id="3849973">(</span><span class="ident" id="3849974">length</span>&nbsp;<span class="op" id="3849981">&gt;&gt;</span>&nbsp;<span class="num" id="3849984">8</span><span class="op" id="3849985">)</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3849988">x</span><span class="op" id="3849989">[</span><span class="num" id="3849990">3</span><span class="op" id="3849991">]</span>&nbsp;<span class="op" id="3849993">=</span>&nbsp;<span class="builtintype" id="3849995">uint8</span><span class="op" id="3850000">(</span><span class="ident" id="3850001">length</span><span class="op" id="3850007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3850010">copy</span><span class="op" id="3850014">(</span><span class="ident" id="3850015">x</span><span class="op" id="3850016">[</span><span class="num" id="3850017">4</span><span class="op" id="3850018">:</span><span class="op" id="3850019">]</span><span class="op" id="3850020">,</span>&nbsp;<span class="ident" id="3850022">m</span><span class="op" id="3850023">.</span><span class="ident" id="3850024">ciphertext</span><span class="op" id="3850034">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3850038">m</span><span class="op" id="3850039">.</span><span class="ident" id="3850040">raw</span>&nbsp;<span class="op" id="3850044">=</span>&nbsp;<span class="ident" id="3850046">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850049">return</span>&nbsp;<span class="ident" id="3850056">x</span><br>
<span class="lineno">955</span><span class="op" id="3850058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3850061">func</span>&nbsp;<span class="op" id="3850066">(</span><span class="ident" id="3850067">m</span>&nbsp;<span class="op" id="3850069">*</span><span class="ident" id="3850070">clientKeyExchangeMsg</span><span class="op" id="3850090">)</span>&nbsp;<span class="ident" id="3850092">unmarshal</span><span class="op" id="3850101">(</span><span class="ident" id="3850102">data</span>&nbsp;<span class="op" id="3850107">[</span><span class="op" id="3850108">]</span><span class="builtintype" id="3850109">byte</span><span class="op" id="3850113">)</span>&nbsp;<span class="builtintype" id="3850115">bool</span>&nbsp;<span class="op" id="3850120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3850123">m</span><span class="op" id="3850124">.</span><span class="ident" id="3850125">raw</span>&nbsp;<span class="op" id="3850129">=</span>&nbsp;<span class="ident" id="3850131">data</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850137">if</span>&nbsp;<span class="builtinfunc" id="3850140">len</span><span class="op" id="3850143">(</span><span class="ident" id="3850144">data</span><span class="op" id="3850148">)</span>&nbsp;<span class="op" id="3850150">&lt;</span>&nbsp;<span class="num" id="3850152">4</span>&nbsp;<span class="op" id="3850154">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850158">return</span>&nbsp;<span class="builtintype" id="3850165">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3850172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3850175">l</span>&nbsp;<span class="op" id="3850177">:=</span>&nbsp;<span class="builtintype" id="3850180">int</span><span class="op" id="3850183">(</span><span class="ident" id="3850184">data</span><span class="op" id="3850188">[</span><span class="num" id="3850189">1</span><span class="op" id="3850190">]</span><span class="op" id="3850191">)</span><span class="op" id="3850192">&lt;&lt;</span><span class="num" id="3850194">16</span>&nbsp;<span class="op" id="3850197">|</span>&nbsp;<span class="builtintype" id="3850199">int</span><span class="op" id="3850202">(</span><span class="ident" id="3850203">data</span><span class="op" id="3850207">[</span><span class="num" id="3850208">2</span><span class="op" id="3850209">]</span><span class="op" id="3850210">)</span><span class="op" id="3850211">&lt;&lt;</span><span class="num" id="3850213">8</span>&nbsp;<span class="op" id="3850215">|</span>&nbsp;<span class="builtintype" id="3850217">int</span><span class="op" id="3850220">(</span><span class="ident" id="3850221">data</span><span class="op" id="3850225">[</span><span class="num" id="3850226">3</span><span class="op" id="3850227">]</span><span class="op" id="3850228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850231">if</span>&nbsp;<span class="ident" id="3850234">l</span>&nbsp;<span class="op" id="3850236">!=</span>&nbsp;<span class="builtinfunc" id="3850239">len</span><span class="op" id="3850242">(</span><span class="ident" id="3850243">data</span><span class="op" id="3850247">)</span><span class="op" id="3850248">-</span><span class="num" id="3850249">4</span>&nbsp;<span class="op" id="3850251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850255">return</span>&nbsp;<span class="builtintype" id="3850262">false</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3850269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3850272">m</span><span class="op" id="3850273">.</span><span class="ident" id="3850274">ciphertext</span>&nbsp;<span class="op" id="3850285">=</span>&nbsp;<span class="ident" id="3850287">data</span><span class="op" id="3850291">[</span><span class="num" id="3850292">4</span><span class="op" id="3850293">:</span><span class="op" id="3850294">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850297">return</span>&nbsp;<span class="builtintype" id="3850304">true</span><br>
<span class="lineno"></span><span class="op" id="3850309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">970</span><span class="keyword" id="3850312">type</span>&nbsp;<span class="ident" id="3850317">finishedMsg</span>&nbsp;<span class="keyword" id="3850329">struct</span>&nbsp;<span class="op" id="3850336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3850339">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3850350">[</span><span class="op" id="3850351">]</span><span class="builtintype" id="3850352">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3850358">verifyData</span>&nbsp;<span class="op" id="3850369">[</span><span class="op" id="3850370">]</span><span class="builtintype" id="3850371">byte</span><br>
<span class="lineno"></span><span class="op" id="3850376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span><span class="keyword" id="3850379">func</span>&nbsp;<span class="op" id="3850384">(</span><span class="ident" id="3850385">m</span>&nbsp;<span class="op" id="3850387">*</span><span class="ident" id="3850388">finishedMsg</span><span class="op" id="3850399">)</span>&nbsp;<span class="ident" id="3850401">equal</span><span class="op" id="3850406">(</span><span class="ident" id="3850407">i</span>&nbsp;<span class="keyword" id="3850409">interface</span><span class="op" id="3850418">{</span><span class="op" id="3850419">}</span><span class="op" id="3850420">)</span>&nbsp;<span class="builtintype" id="3850422">bool</span>&nbsp;<span class="op" id="3850427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3850430">m1</span><span class="op" id="3850432">,</span>&nbsp;<span class="ident" id="3850434">ok</span>&nbsp;<span class="op" id="3850437">:=</span>&nbsp;<span class="ident" id="3850440">i</span><span class="op" id="3850441">.</span><span class="op" id="3850442">(</span><span class="op" id="3850443">*</span><span class="ident" id="3850444">finishedMsg</span><span class="op" id="3850455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850458">if</span>&nbsp;<span class="op" id="3850461">!</span><span class="ident" id="3850462">ok</span>&nbsp;<span class="op" id="3850465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850469">return</span>&nbsp;<span class="builtintype" id="3850476">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3850483">}</span><br>
<span class="lineno">980</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850487">return</span>&nbsp;<span class="ident" id="3850494">bytes</span><span class="op" id="3850499">.</span><span class="ident" id="3850500">Equal</span><span class="op" id="3850505">(</span><span class="ident" id="3850506">m</span><span class="op" id="3850507">.</span><span class="ident" id="3850508">raw</span><span class="op" id="3850511">,</span>&nbsp;<span class="ident" id="3850513">m1</span><span class="op" id="3850515">.</span><span class="ident" id="3850516">raw</span><span class="op" id="3850519">)</span>&nbsp;<span class="op" id="3850521">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3850526">bytes</span><span class="op" id="3850531">.</span><span class="ident" id="3850532">Equal</span><span class="op" id="3850537">(</span><span class="ident" id="3850538">m</span><span class="op" id="3850539">.</span><span class="ident" id="3850540">verifyData</span><span class="op" id="3850550">,</span>&nbsp;<span class="ident" id="3850552">m1</span><span class="op" id="3850554">.</span><span class="ident" id="3850555">verifyData</span><span class="op" id="3850565">)</span><br>
<span class="lineno"></span><span class="op" id="3850567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">985</span><span class="keyword" id="3850570">func</span>&nbsp;<span class="op" id="3850575">(</span><span class="ident" id="3850576">m</span>&nbsp;<span class="op" id="3850578">*</span><span class="ident" id="3850579">finishedMsg</span><span class="op" id="3850590">)</span>&nbsp;<span class="ident" id="3850592">marshal</span><span class="op" id="3850599">(</span><span class="op" id="3850600">)</span>&nbsp;<span class="op" id="3850602">(</span><span class="ident" id="3850603">x</span>&nbsp;<span class="op" id="3850605">[</span><span class="op" id="3850606">]</span><span class="builtintype" id="3850607">byte</span><span class="op" id="3850611">)</span>&nbsp;<span class="op" id="3850613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850616">if</span>&nbsp;<span class="ident" id="3850619">m</span><span class="op" id="3850620">.</span><span class="ident" id="3850621">raw</span>&nbsp;<span class="op" id="3850625">!=</span>&nbsp;<span class="ident" id="3850628">nil</span>&nbsp;<span class="op" id="3850632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850636">return</span>&nbsp;<span class="ident" id="3850643">m</span><span class="op" id="3850644">.</span><span class="ident" id="3850645">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3850650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">990</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3850654">x</span>&nbsp;<span class="op" id="3850656">=</span>&nbsp;<span class="builtinfunc" id="3850658">make</span><span class="op" id="3850662">(</span><span class="op" id="3850663">[</span><span class="op" id="3850664">]</span><span class="builtintype" id="3850665">byte</span><span class="op" id="3850669">,</span>&nbsp;<span class="num" id="3850671">4</span><span class="op" id="3850672">+</span><span class="builtinfunc" id="3850673">len</span><span class="op" id="3850676">(</span><span class="ident" id="3850677">m</span><span class="op" id="3850678">.</span><span class="ident" id="3850679">verifyData</span><span class="op" id="3850689">)</span><span class="op" id="3850690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3850693">x</span><span class="op" id="3850694">[</span><span class="num" id="3850695">0</span><span class="op" id="3850696">]</span>&nbsp;<span class="op" id="3850698">=</span>&nbsp;<span class="ident" id="3850700">typeFinished</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3850714">x</span><span class="op" id="3850715">[</span><span class="num" id="3850716">3</span><span class="op" id="3850717">]</span>&nbsp;<span class="op" id="3850719">=</span>&nbsp;<span class="builtintype" id="3850721">byte</span><span class="op" id="3850725">(</span><span class="builtinfunc" id="3850726">len</span><span class="op" id="3850729">(</span><span class="ident" id="3850730">m</span><span class="op" id="3850731">.</span><span class="ident" id="3850732">verifyData</span><span class="op" id="3850742">)</span><span class="op" id="3850743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3850746">copy</span><span class="op" id="3850750">(</span><span class="ident" id="3850751">x</span><span class="op" id="3850752">[</span><span class="num" id="3850753">4</span><span class="op" id="3850754">:</span><span class="op" id="3850755">]</span><span class="op" id="3850756">,</span>&nbsp;<span class="ident" id="3850758">m</span><span class="op" id="3850759">.</span><span class="ident" id="3850760">verifyData</span><span class="op" id="3850770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3850773">m</span><span class="op" id="3850774">.</span><span class="ident" id="3850775">raw</span>&nbsp;<span class="op" id="3850779">=</span>&nbsp;<span class="ident" id="3850781">x</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850784">return</span><br>
<span class="lineno"></span><span class="op" id="3850791">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3850794">func</span>&nbsp;<span class="op" id="3850799">(</span><span class="ident" id="3850800">m</span>&nbsp;<span class="op" id="3850802">*</span><span class="ident" id="3850803">finishedMsg</span><span class="op" id="3850814">)</span>&nbsp;<span class="ident" id="3850816">unmarshal</span><span class="op" id="3850825">(</span><span class="ident" id="3850826">data</span>&nbsp;<span class="op" id="3850831">[</span><span class="op" id="3850832">]</span><span class="builtintype" id="3850833">byte</span><span class="op" id="3850837">)</span>&nbsp;<span class="builtintype" id="3850839">bool</span>&nbsp;<span class="op" id="3850844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3850847">m</span><span class="op" id="3850848">.</span><span class="ident" id="3850849">raw</span>&nbsp;<span class="op" id="3850853">=</span>&nbsp;<span class="ident" id="3850855">data</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850861">if</span>&nbsp;<span class="builtinfunc" id="3850864">len</span><span class="op" id="3850867">(</span><span class="ident" id="3850868">data</span><span class="op" id="3850872">)</span>&nbsp;<span class="op" id="3850874">&lt;</span>&nbsp;<span class="num" id="3850876">4</span>&nbsp;<span class="op" id="3850878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850882">return</span>&nbsp;<span class="builtintype" id="3850889">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3850896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3850899">m</span><span class="op" id="3850900">.</span><span class="ident" id="3850901">verifyData</span>&nbsp;<span class="op" id="3850912">=</span>&nbsp;<span class="ident" id="3850914">data</span><span class="op" id="3850918">[</span><span class="num" id="3850919">4</span><span class="op" id="3850920">:</span><span class="op" id="3850921">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3850924">return</span>&nbsp;<span class="builtintype" id="3850931">true</span><br>
<span class="lineno">1005</span><span class="op" id="3850936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3850939">type</span>&nbsp;<span class="ident" id="3850944">nextProtoMsg</span>&nbsp;<span class="keyword" id="3850957">struct</span>&nbsp;<span class="op" id="3850964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3850967">raw</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3850973">[</span><span class="op" id="3850974">]</span><span class="builtintype" id="3850975">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3850981">proto</span>&nbsp;<span class="builtintype" id="3850987">string</span><br>
<span class="lineno">1010</span><span class="op" id="3850994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3850997">func</span>&nbsp;<span class="op" id="3851002">(</span><span class="ident" id="3851003">m</span>&nbsp;<span class="op" id="3851005">*</span><span class="ident" id="3851006">nextProtoMsg</span><span class="op" id="3851018">)</span>&nbsp;<span class="ident" id="3851020">equal</span><span class="op" id="3851025">(</span><span class="ident" id="3851026">i</span>&nbsp;<span class="keyword" id="3851028">interface</span><span class="op" id="3851037">{</span><span class="op" id="3851038">}</span><span class="op" id="3851039">)</span>&nbsp;<span class="builtintype" id="3851041">bool</span>&nbsp;<span class="op" id="3851046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851049">m1</span><span class="op" id="3851051">,</span>&nbsp;<span class="ident" id="3851053">ok</span>&nbsp;<span class="op" id="3851056">:=</span>&nbsp;<span class="ident" id="3851059">i</span><span class="op" id="3851060">.</span><span class="op" id="3851061">(</span><span class="op" id="3851062">*</span><span class="ident" id="3851063">nextProtoMsg</span><span class="op" id="3851075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851078">if</span>&nbsp;<span class="op" id="3851081">!</span><span class="ident" id="3851082">ok</span>&nbsp;<span class="op" id="3851085">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851089">return</span>&nbsp;<span class="builtintype" id="3851096">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3851103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851107">return</span>&nbsp;<span class="ident" id="3851114">bytes</span><span class="op" id="3851119">.</span><span class="ident" id="3851120">Equal</span><span class="op" id="3851125">(</span><span class="ident" id="3851126">m</span><span class="op" id="3851127">.</span><span class="ident" id="3851128">raw</span><span class="op" id="3851131">,</span>&nbsp;<span class="ident" id="3851133">m1</span><span class="op" id="3851135">.</span><span class="ident" id="3851136">raw</span><span class="op" id="3851139">)</span>&nbsp;<span class="op" id="3851141">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851146">m</span><span class="op" id="3851147">.</span><span class="ident" id="3851148">proto</span>&nbsp;<span class="op" id="3851154">==</span>&nbsp;<span class="ident" id="3851157">m1</span><span class="op" id="3851159">.</span><span class="ident" id="3851160">proto</span><br>
<span class="lineno">1020</span><span class="op" id="3851166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3851169">func</span>&nbsp;<span class="op" id="3851174">(</span><span class="ident" id="3851175">m</span>&nbsp;<span class="op" id="3851177">*</span><span class="ident" id="3851178">nextProtoMsg</span><span class="op" id="3851190">)</span>&nbsp;<span class="ident" id="3851192">marshal</span><span class="op" id="3851199">(</span><span class="op" id="3851200">)</span>&nbsp;<span class="op" id="3851202">[</span><span class="op" id="3851203">]</span><span class="builtintype" id="3851204">byte</span>&nbsp;<span class="op" id="3851209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851212">if</span>&nbsp;<span class="ident" id="3851215">m</span><span class="op" id="3851216">.</span><span class="ident" id="3851217">raw</span>&nbsp;<span class="op" id="3851221">!=</span>&nbsp;<span class="ident" id="3851224">nil</span>&nbsp;<span class="op" id="3851228">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851232">return</span>&nbsp;<span class="ident" id="3851239">m</span><span class="op" id="3851240">.</span><span class="ident" id="3851241">raw</span><br>
<span class="lineno">1025</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3851246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851249">l</span>&nbsp;<span class="op" id="3851251">:=</span>&nbsp;<span class="builtinfunc" id="3851254">len</span><span class="op" id="3851257">(</span><span class="ident" id="3851258">m</span><span class="op" id="3851259">.</span><span class="ident" id="3851260">proto</span><span class="op" id="3851265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851268">if</span>&nbsp;<span class="ident" id="3851271">l</span>&nbsp;<span class="op" id="3851273">&gt;</span>&nbsp;<span class="num" id="3851275">255</span>&nbsp;<span class="op" id="3851279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851283">l</span>&nbsp;<span class="op" id="3851285">=</span>&nbsp;<span class="num" id="3851287">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3851292">}</span><br>
<span class="lineno">1030</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851296">padding</span>&nbsp;<span class="op" id="3851304">:=</span>&nbsp;<span class="num" id="3851307">32</span>&nbsp;<span class="op" id="3851310">-</span>&nbsp;<span class="op" id="3851312">(</span><span class="ident" id="3851313">l</span><span class="op" id="3851314">+</span><span class="num" id="3851315">2</span><span class="op" id="3851316">)</span><span class="op" id="3851317">%</span><span class="num" id="3851318">32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851322">length</span>&nbsp;<span class="op" id="3851329">:=</span>&nbsp;<span class="ident" id="3851332">l</span>&nbsp;<span class="op" id="3851334">+</span>&nbsp;<span class="ident" id="3851336">padding</span>&nbsp;<span class="op" id="3851344">+</span>&nbsp;<span class="num" id="3851346">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851349">x</span>&nbsp;<span class="op" id="3851351">:=</span>&nbsp;<span class="builtinfunc" id="3851354">make</span><span class="op" id="3851358">(</span><span class="op" id="3851359">[</span><span class="op" id="3851360">]</span><span class="builtintype" id="3851361">byte</span><span class="op" id="3851365">,</span>&nbsp;<span class="ident" id="3851367">length</span><span class="op" id="3851373">+</span><span class="num" id="3851374">4</span><span class="op" id="3851375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851378">x</span><span class="op" id="3851379">[</span><span class="num" id="3851380">0</span><span class="op" id="3851381">]</span>&nbsp;<span class="op" id="3851383">=</span>&nbsp;<span class="ident" id="3851385">typeNextProtocol</span><br>
<span class="lineno">1035</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851403">x</span><span class="op" id="3851404">[</span><span class="num" id="3851405">1</span><span class="op" id="3851406">]</span>&nbsp;<span class="op" id="3851408">=</span>&nbsp;<span class="builtintype" id="3851410">uint8</span><span class="op" id="3851415">(</span><span class="ident" id="3851416">length</span>&nbsp;<span class="op" id="3851423">&gt;&gt;</span>&nbsp;<span class="num" id="3851426">16</span><span class="op" id="3851428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851431">x</span><span class="op" id="3851432">[</span><span class="num" id="3851433">2</span><span class="op" id="3851434">]</span>&nbsp;<span class="op" id="3851436">=</span>&nbsp;<span class="builtintype" id="3851438">uint8</span><span class="op" id="3851443">(</span><span class="ident" id="3851444">length</span>&nbsp;<span class="op" id="3851451">&gt;&gt;</span>&nbsp;<span class="num" id="3851454">8</span><span class="op" id="3851455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851458">x</span><span class="op" id="3851459">[</span><span class="num" id="3851460">3</span><span class="op" id="3851461">]</span>&nbsp;<span class="op" id="3851463">=</span>&nbsp;<span class="builtintype" id="3851465">uint8</span><span class="op" id="3851470">(</span><span class="ident" id="3851471">length</span><span class="op" id="3851477">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851481">y</span>&nbsp;<span class="op" id="3851483">:=</span>&nbsp;<span class="ident" id="3851486">x</span><span class="op" id="3851487">[</span><span class="num" id="3851488">4</span><span class="op" id="3851489">:</span><span class="op" id="3851490">]</span><br>
<span class="lineno">1040</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851493">y</span><span class="op" id="3851494">[</span><span class="num" id="3851495">0</span><span class="op" id="3851496">]</span>&nbsp;<span class="op" id="3851498">=</span>&nbsp;<span class="builtintype" id="3851500">byte</span><span class="op" id="3851504">(</span><span class="ident" id="3851505">l</span><span class="op" id="3851506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3851509">copy</span><span class="op" id="3851513">(</span><span class="ident" id="3851514">y</span><span class="op" id="3851515">[</span><span class="num" id="3851516">1</span><span class="op" id="3851517">:</span><span class="op" id="3851518">]</span><span class="op" id="3851519">,</span>&nbsp;<span class="op" id="3851521">[</span><span class="op" id="3851522">]</span><span class="builtintype" id="3851523">byte</span><span class="op" id="3851527">(</span><span class="ident" id="3851528">m</span><span class="op" id="3851529">.</span><span class="ident" id="3851530">proto</span><span class="op" id="3851535">[</span><span class="num" id="3851536">0</span><span class="op" id="3851537">:</span><span class="ident" id="3851538">l</span><span class="op" id="3851539">]</span><span class="op" id="3851540">)</span><span class="op" id="3851541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851544">y</span>&nbsp;<span class="op" id="3851546">=</span>&nbsp;<span class="ident" id="3851548">y</span><span class="op" id="3851549">[</span><span class="num" id="3851550">1</span><span class="op" id="3851551">+</span><span class="ident" id="3851552">l</span><span class="op" id="3851553">:</span><span class="op" id="3851554">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851557">y</span><span class="op" id="3851558">[</span><span class="num" id="3851559">0</span><span class="op" id="3851560">]</span>&nbsp;<span class="op" id="3851562">=</span>&nbsp;<span class="builtintype" id="3851564">byte</span><span class="op" id="3851568">(</span><span class="ident" id="3851569">padding</span><span class="op" id="3851576">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">1045</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851580">m</span><span class="op" id="3851581">.</span><span class="ident" id="3851582">raw</span>&nbsp;<span class="op" id="3851586">=</span>&nbsp;<span class="ident" id="3851588">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851592">return</span>&nbsp;<span class="ident" id="3851599">x</span><br>
<span class="lineno"></span><span class="op" id="3851601">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1050</span><span class="keyword" id="3851604">func</span>&nbsp;<span class="op" id="3851609">(</span><span class="ident" id="3851610">m</span>&nbsp;<span class="op" id="3851612">*</span><span class="ident" id="3851613">nextProtoMsg</span><span class="op" id="3851625">)</span>&nbsp;<span class="ident" id="3851627">unmarshal</span><span class="op" id="3851636">(</span><span class="ident" id="3851637">data</span>&nbsp;<span class="op" id="3851642">[</span><span class="op" id="3851643">]</span><span class="builtintype" id="3851644">byte</span><span class="op" id="3851648">)</span>&nbsp;<span class="builtintype" id="3851650">bool</span>&nbsp;<span class="op" id="3851655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851658">m</span><span class="op" id="3851659">.</span><span class="ident" id="3851660">raw</span>&nbsp;<span class="op" id="3851664">=</span>&nbsp;<span class="ident" id="3851666">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851673">if</span>&nbsp;<span class="builtinfunc" id="3851676">len</span><span class="op" id="3851679">(</span><span class="ident" id="3851680">data</span><span class="op" id="3851684">)</span>&nbsp;<span class="op" id="3851686">&lt;</span>&nbsp;<span class="num" id="3851688">5</span>&nbsp;<span class="op" id="3851690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851694">return</span>&nbsp;<span class="builtintype" id="3851701">false</span><br>
<span class="lineno">1055</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3851708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851711">data</span>&nbsp;<span class="op" id="3851716">=</span>&nbsp;<span class="ident" id="3851718">data</span><span class="op" id="3851722">[</span><span class="num" id="3851723">4</span><span class="op" id="3851724">:</span><span class="op" id="3851725">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851728">protoLen</span>&nbsp;<span class="op" id="3851737">:=</span>&nbsp;<span class="builtintype" id="3851740">int</span><span class="op" id="3851743">(</span><span class="ident" id="3851744">data</span><span class="op" id="3851748">[</span><span class="num" id="3851749">0</span><span class="op" id="3851750">]</span><span class="op" id="3851751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851754">data</span>&nbsp;<span class="op" id="3851759">=</span>&nbsp;<span class="ident" id="3851761">data</span><span class="op" id="3851765">[</span><span class="num" id="3851766">1</span><span class="op" id="3851767">:</span><span class="op" id="3851768">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851771">if</span>&nbsp;<span class="builtinfunc" id="3851774">len</span><span class="op" id="3851777">(</span><span class="ident" id="3851778">data</span><span class="op" id="3851782">)</span>&nbsp;<span class="op" id="3851784">&lt;</span>&nbsp;<span class="ident" id="3851786">protoLen</span>&nbsp;<span class="op" id="3851795">{</span><br>
<span class="lineno">1060</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851799">return</span>&nbsp;<span class="builtintype" id="3851806">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3851813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851816">m</span><span class="op" id="3851817">.</span><span class="ident" id="3851818">proto</span>&nbsp;<span class="op" id="3851824">=</span>&nbsp;<span class="builtintype" id="3851826">string</span><span class="op" id="3851832">(</span><span class="ident" id="3851833">data</span><span class="op" id="3851837">[</span><span class="num" id="3851838">0</span><span class="op" id="3851839">:</span><span class="ident" id="3851840">protoLen</span><span class="op" id="3851848">]</span><span class="op" id="3851849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851852">data</span>&nbsp;<span class="op" id="3851857">=</span>&nbsp;<span class="ident" id="3851859">data</span><span class="op" id="3851863">[</span><span class="ident" id="3851864">protoLen</span><span class="op" id="3851872">:</span><span class="op" id="3851873">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">1065</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851877">if</span>&nbsp;<span class="builtinfunc" id="3851880">len</span><span class="op" id="3851883">(</span><span class="ident" id="3851884">data</span><span class="op" id="3851888">)</span>&nbsp;<span class="op" id="3851890">&lt;</span>&nbsp;<span class="num" id="3851892">1</span>&nbsp;<span class="op" id="3851894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851898">return</span>&nbsp;<span class="builtintype" id="3851905">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3851912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851915">paddingLen</span>&nbsp;<span class="op" id="3851926">:=</span>&nbsp;<span class="builtintype" id="3851929">int</span><span class="op" id="3851932">(</span><span class="ident" id="3851933">data</span><span class="op" id="3851937">[</span><span class="num" id="3851938">0</span><span class="op" id="3851939">]</span><span class="op" id="3851940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851943">data</span>&nbsp;<span class="op" id="3851948">=</span>&nbsp;<span class="ident" id="3851950">data</span><span class="op" id="3851954">[</span><span class="num" id="3851955">1</span><span class="op" id="3851956">:</span><span class="op" id="3851957">]</span><br>
<span class="lineno">1070</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851960">if</span>&nbsp;<span class="builtinfunc" id="3851963">len</span><span class="op" id="3851966">(</span><span class="ident" id="3851967">data</span><span class="op" id="3851971">)</span>&nbsp;<span class="op" id="3851973">!=</span>&nbsp;<span class="ident" id="3851976">paddingLen</span>&nbsp;<span class="op" id="3851987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851991">return</span>&nbsp;<span class="builtintype" id="3851998">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3852005">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852009">return</span>&nbsp;<span class="builtintype" id="3852016">true</span><br>
<span class="lineno">1075</span><span class="op" id="3852021">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3852024">type</span>&nbsp;<span class="ident" id="3852029">certificateRequestMsg</span>&nbsp;<span class="keyword" id="3852051">struct</span>&nbsp;<span class="op" id="3852058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852061">raw</span>&nbsp;<span class="op" id="3852065">[</span><span class="op" id="3852066">]</span><span class="builtintype" id="3852067">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3852073">//&nbsp;hasSignatureAndHash&nbsp;indicates&nbsp;whether&nbsp;this&nbsp;message&nbsp;includes&nbsp;a&nbsp;list</span><br>
<span class="lineno">1080</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3852144">//&nbsp;of&nbsp;signature&nbsp;and&nbsp;hash&nbsp;functions.&nbsp;This&nbsp;change&nbsp;was&nbsp;introduced&nbsp;with&nbsp;TLS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3852217">//&nbsp;1.2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852226">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="3852246">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852253">certificateTypes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3852276">[</span><span class="op" id="3852277">]</span><span class="builtintype" id="3852278">byte</span><br>
<span class="lineno">1085</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852284">signatureAndHashes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3852307">[</span><span class="op" id="3852308">]</span><span class="ident" id="3852309">signatureAndHash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852327">certificateAuthorities</span>&nbsp;<span class="op" id="3852350">[</span><span class="op" id="3852351">]</span><span class="op" id="3852352">[</span><span class="op" id="3852353">]</span><span class="builtintype" id="3852354">byte</span><br>
<span class="lineno"></span><span class="op" id="3852359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3852362">func</span>&nbsp;<span class="op" id="3852367">(</span><span class="ident" id="3852368">m</span>&nbsp;<span class="op" id="3852370">*</span><span class="ident" id="3852371">certificateRequestMsg</span><span class="op" id="3852392">)</span>&nbsp;<span class="ident" id="3852394">equal</span><span class="op" id="3852399">(</span><span class="ident" id="3852400">i</span>&nbsp;<span class="keyword" id="3852402">interface</span><span class="op" id="3852411">{</span><span class="op" id="3852412">}</span><span class="op" id="3852413">)</span>&nbsp;<span class="builtintype" id="3852415">bool</span>&nbsp;<span class="op" id="3852420">{</span><br>
<span class="lineno">1090</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852423">m1</span><span class="op" id="3852425">,</span>&nbsp;<span class="ident" id="3852427">ok</span>&nbsp;<span class="op" id="3852430">:=</span>&nbsp;<span class="ident" id="3852433">i</span><span class="op" id="3852434">.</span><span class="op" id="3852435">(</span><span class="op" id="3852436">*</span><span class="ident" id="3852437">certificateRequestMsg</span><span class="op" id="3852458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852461">if</span>&nbsp;<span class="op" id="3852464">!</span><span class="ident" id="3852465">ok</span>&nbsp;<span class="op" id="3852468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852472">return</span>&nbsp;<span class="builtintype" id="3852479">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3852486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1095</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852490">return</span>&nbsp;<span class="ident" id="3852497">bytes</span><span class="op" id="3852502">.</span><span class="ident" id="3852503">Equal</span><span class="op" id="3852508">(</span><span class="ident" id="3852509">m</span><span class="op" id="3852510">.</span><span class="ident" id="3852511">raw</span><span class="op" id="3852514">,</span>&nbsp;<span class="ident" id="3852516">m1</span><span class="op" id="3852518">.</span><span class="ident" id="3852519">raw</span><span class="op" id="3852522">)</span>&nbsp;<span class="op" id="3852524">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852529">bytes</span><span class="op" id="3852534">.</span><span class="ident" id="3852535">Equal</span><span class="op" id="3852540">(</span><span class="ident" id="3852541">m</span><span class="op" id="3852542">.</span><span class="ident" id="3852543">certificateTypes</span><span class="op" id="3852559">,</span>&nbsp;<span class="ident" id="3852561">m1</span><span class="op" id="3852563">.</span><span class="ident" id="3852564">certificateTypes</span><span class="op" id="3852580">)</span>&nbsp;<span class="op" id="3852582">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852587">eqByteSlices</span><span class="op" id="3852599">(</span><span class="ident" id="3852600">m</span><span class="op" id="3852601">.</span><span class="ident" id="3852602">certificateAuthorities</span><span class="op" id="3852624">,</span>&nbsp;<span class="ident" id="3852626">m1</span><span class="op" id="3852628">.</span><span class="ident" id="3852629">certificateAuthorities</span><span class="op" id="3852651">)</span>&nbsp;<span class="op" id="3852653">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852658">eqSignatureAndHashes</span><span class="op" id="3852678">(</span><span class="ident" id="3852679">m</span><span class="op" id="3852680">.</span><span class="ident" id="3852681">signatureAndHashes</span><span class="op" id="3852699">,</span>&nbsp;<span class="ident" id="3852701">m1</span><span class="op" id="3852703">.</span><span class="ident" id="3852704">signatureAndHashes</span><span class="op" id="3852722">)</span><br>
<span class="lineno"></span><span class="op" id="3852724">}</span><br>
<span class="lineno">1100</span><br>
<span class="lineno"></span><span class="keyword" id="3852727">func</span>&nbsp;<span class="op" id="3852732">(</span><span class="ident" id="3852733">m</span>&nbsp;<span class="op" id="3852735">*</span><span class="ident" id="3852736">certificateRequestMsg</span><span class="op" id="3852757">)</span>&nbsp;<span class="ident" id="3852759">marshal</span><span class="op" id="3852766">(</span><span class="op" id="3852767">)</span>&nbsp;<span class="op" id="3852769">(</span><span class="ident" id="3852770">x</span>&nbsp;<span class="op" id="3852772">[</span><span class="op" id="3852773">]</span><span class="builtintype" id="3852774">byte</span><span class="op" id="3852778">)</span>&nbsp;<span class="op" id="3852780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852783">if</span>&nbsp;<span class="ident" id="3852786">m</span><span class="op" id="3852787">.</span><span class="ident" id="3852788">raw</span>&nbsp;<span class="op" id="3852792">!=</span>&nbsp;<span class="ident" id="3852795">nil</span>&nbsp;<span class="op" id="3852799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852803">return</span>&nbsp;<span class="ident" id="3852810">m</span><span class="op" id="3852811">.</span><span class="ident" id="3852812">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3852817">}</span><br>
<span class="lineno">1105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3852821">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852878">length</span>&nbsp;<span class="op" id="3852885">:=</span>&nbsp;<span class="num" id="3852888">1</span>&nbsp;<span class="op" id="3852890">+</span>&nbsp;<span class="builtinfunc" id="3852892">len</span><span class="op" id="3852895">(</span><span class="ident" id="3852896">m</span><span class="op" id="3852897">.</span><span class="ident" id="3852898">certificateTypes</span><span class="op" id="3852914">)</span>&nbsp;<span class="op" id="3852916">+</span>&nbsp;<span class="num" id="3852918">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852921">casLength</span>&nbsp;<span class="op" id="3852931">:=</span>&nbsp;<span class="num" id="3852934">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852937">for</span>&nbsp;<span class="ident" id="3852941">_</span><span class="op" id="3852942">,</span>&nbsp;<span class="ident" id="3852944">ca</span>&nbsp;<span class="op" id="3852947">:=</span>&nbsp;<span class="keyword" id="3852950">range</span>&nbsp;<span class="ident" id="3852956">m</span><span class="op" id="3852957">.</span><span class="ident" id="3852958">certificateAuthorities</span>&nbsp;<span class="op" id="3852981">{</span><br>
<span class="lineno">1110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852985">casLength</span>&nbsp;<span class="op" id="3852995">+=</span>&nbsp;<span class="num" id="3852998">2</span>&nbsp;<span class="op" id="3853000">+</span>&nbsp;<span class="builtinfunc" id="3853002">len</span><span class="op" id="3853005">(</span><span class="ident" id="3853006">ca</span><span class="op" id="3853008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3853011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853014">length</span>&nbsp;<span class="op" id="3853021">+=</span>&nbsp;<span class="ident" id="3853024">casLength</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3853036">if</span>&nbsp;<span class="ident" id="3853039">m</span><span class="op" id="3853040">.</span><span class="ident" id="3853041">hasSignatureAndHash</span>&nbsp;<span class="op" id="3853061">{</span><br>
<span class="lineno">1115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853065">length</span>&nbsp;<span class="op" id="3853072">+=</span>&nbsp;<span class="num" id="3853075">2</span>&nbsp;<span class="op" id="3853077">+</span>&nbsp;<span class="num" id="3853079">2</span><span class="op" id="3853080">*</span><span class="builtinfunc" id="3853081">len</span><span class="op" id="3853084">(</span><span class="ident" id="3853085">m</span><span class="op" id="3853086">.</span><span class="ident" id="3853087">signatureAndHashes</span><span class="op" id="3853105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3853108">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853112">x</span>&nbsp;<span class="op" id="3853114">=</span>&nbsp;<span class="builtinfunc" id="3853116">make</span><span class="op" id="3853120">(</span><span class="op" id="3853121">[</span><span class="op" id="3853122">]</span><span class="builtintype" id="3853123">byte</span><span class="op" id="3853127">,</span>&nbsp;<span class="num" id="3853129">4</span><span class="op" id="3853130">+</span><span class="ident" id="3853131">length</span><span class="op" id="3853137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853140">x</span><span class="op" id="3853141">[</span><span class="num" id="3853142">0</span><span class="op" id="3853143">]</span>&nbsp;<span class="op" id="3853145">=</span>&nbsp;<span class="ident" id="3853147">typeCertificateRequest</span><br>
<span class="lineno">1120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853171">x</span><span class="op" id="3853172">[</span><span class="num" id="3853173">1</span><span class="op" id="3853174">]</span>&nbsp;<span class="op" id="3853176">=</span>&nbsp;<span class="builtintype" id="3853178">uint8</span><span class="op" id="3853183">(</span><span class="ident" id="3853184">length</span>&nbsp;<span class="op" id="3853191">&gt;&gt;</span>&nbsp;<span class="num" id="3853194">16</span><span class="op" id="3853196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853199">x</span><span class="op" id="3853200">[</span><span class="num" id="3853201">2</span><span class="op" id="3853202">]</span>&nbsp;<span class="op" id="3853204">=</span>&nbsp;<span class="builtintype" id="3853206">uint8</span><span class="op" id="3853211">(</span><span class="ident" id="3853212">length</span>&nbsp;<span class="op" id="3853219">&gt;&gt;</span>&nbsp;<span class="num" id="3853222">8</span><span class="op" id="3853223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853226">x</span><span class="op" id="3853227">[</span><span class="num" id="3853228">3</span><span class="op" id="3853229">]</span>&nbsp;<span class="op" id="3853231">=</span>&nbsp;<span class="builtintype" id="3853233">uint8</span><span class="op" id="3853238">(</span><span class="ident" id="3853239">length</span><span class="op" id="3853245">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853249">x</span><span class="op" id="3853250">[</span><span class="num" id="3853251">4</span><span class="op" id="3853252">]</span>&nbsp;<span class="op" id="3853254">=</span>&nbsp;<span class="builtintype" id="3853256">uint8</span><span class="op" id="3853261">(</span><span class="builtinfunc" id="3853262">len</span><span class="op" id="3853265">(</span><span class="ident" id="3853266">m</span><span class="op" id="3853267">.</span><span class="ident" id="3853268">certificateTypes</span><span class="op" id="3853284">)</span><span class="op" id="3853285">)</span><br>
<span class="lineno">1125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3853289">copy</span><span class="op" id="3853293">(</span><span class="ident" id="3853294">x</span><span class="op" id="3853295">[</span><span class="num" id="3853296">5</span><span class="op" id="3853297">:</span><span class="op" id="3853298">]</span><span class="op" id="3853299">,</span>&nbsp;<span class="ident" id="3853301">m</span><span class="op" id="3853302">.</span><span class="ident" id="3853303">certificateTypes</span><span class="op" id="3853319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853322">y</span>&nbsp;<span class="op" id="3853324">:=</span>&nbsp;<span class="ident" id="3853327">x</span><span class="op" id="3853328">[</span><span class="num" id="3853329">5</span><span class="op" id="3853330">+</span><span class="builtinfunc" id="3853331">len</span><span class="op" id="3853334">(</span><span class="ident" id="3853335">m</span><span class="op" id="3853336">.</span><span class="ident" id="3853337">certificateTypes</span><span class="op" id="3853353">)</span><span class="op" id="3853354">:</span><span class="op" id="3853355">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3853359">if</span>&nbsp;<span class="ident" id="3853362">m</span><span class="op" id="3853363">.</span><span class="ident" id="3853364">hasSignatureAndHash</span>&nbsp;<span class="op" id="3853384">{</span><br>
<span class="lineno">1130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853388">n</span>&nbsp;<span class="op" id="3853390">:=</span>&nbsp;<span class="builtinfunc" id="3853393">len</span><span class="op" id="3853396">(</span><span class="ident" id="3853397">m</span><span class="op" id="3853398">.</span><span class="ident" id="3853399">signatureAndHashes</span><span class="op" id="3853417">)</span>&nbsp;<span class="op" id="3853419">*</span>&nbsp;<span class="num" id="3853421">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853425">y</span><span class="op" id="3853426">[</span><span class="num" id="3853427">0</span><span class="op" id="3853428">]</span>&nbsp;<span class="op" id="3853430">=</span>&nbsp;<span class="builtintype" id="3853432">uint8</span><span class="op" id="3853437">(</span><span class="ident" id="3853438">n</span>&nbsp;<span class="op" id="3853440">&gt;&gt;</span>&nbsp;<span class="num" id="3853443">8</span><span class="op" id="3853444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853448">y</span><span class="op" id="3853449">[</span><span class="num" id="3853450">1</span><span class="op" id="3853451">]</span>&nbsp;<span class="op" id="3853453">=</span>&nbsp;<span class="builtintype" id="3853455">uint8</span><span class="op" id="3853460">(</span><span class="ident" id="3853461">n</span><span class="op" id="3853462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853466">y</span>&nbsp;<span class="op" id="3853468">=</span>&nbsp;<span class="ident" id="3853470">y</span><span class="op" id="3853471">[</span><span class="num" id="3853472">2</span><span class="op" id="3853473">:</span><span class="op" id="3853474">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3853478">for</span>&nbsp;<span class="ident" id="3853482">_</span><span class="op" id="3853483">,</span>&nbsp;<span class="ident" id="3853485">sigAndHash</span>&nbsp;<span class="op" id="3853496">:=</span>&nbsp;<span class="keyword" id="3853499">range</span>&nbsp;<span class="ident" id="3853505">m</span><span class="op" id="3853506">.</span><span class="ident" id="3853507">signatureAndHashes</span>&nbsp;<span class="op" id="3853526">{</span><br>
<span class="lineno">1135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853531">y</span><span class="op" id="3853532">[</span><span class="num" id="3853533">0</span><span class="op" id="3853534">]</span>&nbsp;<span class="op" id="3853536">=</span>&nbsp;<span class="ident" id="3853538">sigAndHash</span><span class="op" id="3853548">.</span><span class="ident" id="3853549">hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853557">y</span><span class="op" id="3853558">[</span><span class="num" id="3853559">1</span><span class="op" id="3853560">]</span>&nbsp;<span class="op" id="3853562">=</span>&nbsp;<span class="ident" id="3853564">sigAndHash</span><span class="op" id="3853574">.</span><span class="ident" id="3853575">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853588">y</span>&nbsp;<span class="op" id="3853590">=</span>&nbsp;<span class="ident" id="3853592">y</span><span class="op" id="3853593">[</span><span class="num" id="3853594">2</span><span class="op" id="3853595">:</span><span class="op" id="3853596">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3853600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3853603">}</span><br>
<span class="lineno">1140</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853607">y</span><span class="op" id="3853608">[</span><span class="num" id="3853609">0</span><span class="op" id="3853610">]</span>&nbsp;<span class="op" id="3853612">=</span>&nbsp;<span class="builtintype" id="3853614">uint8</span><span class="op" id="3853619">(</span><span class="ident" id="3853620">casLength</span>&nbsp;<span class="op" id="3853630">&gt;&gt;</span>&nbsp;<span class="num" id="3853633">8</span><span class="op" id="3853634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853637">y</span><span class="op" id="3853638">[</span><span class="num" id="3853639">1</span><span class="op" id="3853640">]</span>&nbsp;<span class="op" id="3853642">=</span>&nbsp;<span class="builtintype" id="3853644">uint8</span><span class="op" id="3853649">(</span><span class="ident" id="3853650">casLength</span><span class="op" id="3853659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853662">y</span>&nbsp;<span class="op" id="3853664">=</span>&nbsp;<span class="ident" id="3853666">y</span><span class="op" id="3853667">[</span><span class="num" id="3853668">2</span><span class="op" id="3853669">:</span><span class="op" id="3853670">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3853673">for</span>&nbsp;<span class="ident" id="3853677">_</span><span class="op" id="3853678">,</span>&nbsp;<span class="ident" id="3853680">ca</span>&nbsp;<span class="op" id="3853683">:=</span>&nbsp;<span class="keyword" id="3853686">range</span>&nbsp;<span class="ident" id="3853692">m</span><span class="op" id="3853693">.</span><span class="ident" id="3853694">certificateAuthorities</span>&nbsp;<span class="op" id="3853717">{</span><br>
<span class="lineno">1145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853721">y</span><span class="op" id="3853722">[</span><span class="num" id="3853723">0</span><span class="op" id="3853724">]</span>&nbsp;<span class="op" id="3853726">=</span>&nbsp;<span class="builtintype" id="3853728">uint8</span><span class="op" id="3853733">(</span><span class="builtinfunc" id="3853734">len</span><span class="op" id="3853737">(</span><span class="ident" id="3853738">ca</span><span class="op" id="3853740">)</span>&nbsp;<span class="op" id="3853742">&gt;&gt;</span>&nbsp;<span class="num" id="3853745">8</span><span class="op" id="3853746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853750">y</span><span class="op" id="3853751">[</span><span class="num" id="3853752">1</span><span class="op" id="3853753">]</span>&nbsp;<span class="op" id="3853755">=</span>&nbsp;<span class="builtintype" id="3853757">uint8</span><span class="op" id="3853762">(</span><span class="builtinfunc" id="3853763">len</span><span class="op" id="3853766">(</span><span class="ident" id="3853767">ca</span><span class="op" id="3853769">)</span><span class="op" id="3853770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853774">y</span>&nbsp;<span class="op" id="3853776">=</span>&nbsp;<span class="ident" id="3853778">y</span><span class="op" id="3853779">[</span><span class="num" id="3853780">2</span><span class="op" id="3853781">:</span><span class="op" id="3853782">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3853786">copy</span><span class="op" id="3853790">(</span><span class="ident" id="3853791">y</span><span class="op" id="3853792">,</span>&nbsp;<span class="ident" id="3853794">ca</span><span class="op" id="3853796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853800">y</span>&nbsp;<span class="op" id="3853802">=</span>&nbsp;<span class="ident" id="3853804">y</span><span class="op" id="3853805">[</span><span class="builtinfunc" id="3853806">len</span><span class="op" id="3853809">(</span><span class="ident" id="3853810">ca</span><span class="op" id="3853812">)</span><span class="op" id="3853813">:</span><span class="op" id="3853814">]</span><br>
<span class="lineno">1150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3853817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853821">m</span><span class="op" id="3853822">.</span><span class="ident" id="3853823">raw</span>&nbsp;<span class="op" id="3853827">=</span>&nbsp;<span class="ident" id="3853829">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3853832">return</span><br>
<span class="lineno"></span><span class="op" id="3853839">}</span><br>
<span class="lineno">1155</span><br>
<span class="lineno"></span><span class="keyword" id="3853842">func</span>&nbsp;<span class="op" id="3853847">(</span><span class="ident" id="3853848">m</span>&nbsp;<span class="op" id="3853850">*</span><span class="ident" id="3853851">certificateRequestMsg</span><span class="op" id="3853872">)</span>&nbsp;<span class="ident" id="3853874">unmarshal</span><span class="op" id="3853883">(</span><span class="ident" id="3853884">data</span>&nbsp;<span class="op" id="3853889">[</span><span class="op" id="3853890">]</span><span class="builtintype" id="3853891">byte</span><span class="op" id="3853895">)</span>&nbsp;<span class="builtintype" id="3853897">bool</span>&nbsp;<span class="op" id="3853902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853905">m</span><span class="op" id="3853906">.</span><span class="ident" id="3853907">raw</span>&nbsp;<span class="op" id="3853911">=</span>&nbsp;<span class="ident" id="3853913">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3853920">if</span>&nbsp;<span class="builtinfunc" id="3853923">len</span><span class="op" id="3853926">(</span><span class="ident" id="3853927">data</span><span class="op" id="3853931">)</span>&nbsp;<span class="op" id="3853933">&lt;</span>&nbsp;<span class="num" id="3853935">5</span>&nbsp;<span class="op" id="3853937">{</span><br>
<span class="lineno">1160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3853941">return</span>&nbsp;<span class="builtintype" id="3853948">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3853955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3853959">length</span>&nbsp;<span class="op" id="3853966">:=</span>&nbsp;<span class="builtintype" id="3853969">uint32</span><span class="op" id="3853975">(</span><span class="ident" id="3853976">data</span><span class="op" id="3853980">[</span><span class="num" id="3853981">1</span><span class="op" id="3853982">]</span><span class="op" id="3853983">)</span><span class="op" id="3853984">&lt;&lt;</span><span class="num" id="3853986">16</span>&nbsp;<span class="op" id="3853989">|</span>&nbsp;<span class="builtintype" id="3853991">uint32</span><span class="op" id="3853997">(</span><span class="ident" id="3853998">data</span><span class="op" id="3854002">[</span><span class="num" id="3854003">2</span><span class="op" id="3854004">]</span><span class="op" id="3854005">)</span><span class="op" id="3854006">&lt;&lt;</span><span class="num" id="3854008">8</span>&nbsp;<span class="op" id="3854010">|</span>&nbsp;<span class="builtintype" id="3854012">uint32</span><span class="op" id="3854018">(</span><span class="ident" id="3854019">data</span><span class="op" id="3854023">[</span><span class="num" id="3854024">3</span><span class="op" id="3854025">]</span><span class="op" id="3854026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854029">if</span>&nbsp;<span class="builtintype" id="3854032">uint32</span><span class="op" id="3854038">(</span><span class="builtinfunc" id="3854039">len</span><span class="op" id="3854042">(</span><span class="ident" id="3854043">data</span><span class="op" id="3854047">)</span><span class="op" id="3854048">)</span><span class="op" id="3854049">-</span><span class="num" id="3854050">4</span>&nbsp;<span class="op" id="3854052">!=</span>&nbsp;<span class="ident" id="3854055">length</span>&nbsp;<span class="op" id="3854062">{</span><br>
<span class="lineno">1165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854066">return</span>&nbsp;<span class="builtintype" id="3854073">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3854080">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854084">numCertTypes</span>&nbsp;<span class="op" id="3854097">:=</span>&nbsp;<span class="builtintype" id="3854100">int</span><span class="op" id="3854103">(</span><span class="ident" id="3854104">data</span><span class="op" id="3854108">[</span><span class="num" id="3854109">4</span><span class="op" id="3854110">]</span><span class="op" id="3854111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854114">data</span>&nbsp;<span class="op" id="3854119">=</span>&nbsp;<span class="ident" id="3854121">data</span><span class="op" id="3854125">[</span><span class="num" id="3854126">5</span><span class="op" id="3854127">:</span><span class="op" id="3854128">]</span><br>
<span class="lineno">1170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854131">if</span>&nbsp;<span class="ident" id="3854134">numCertTypes</span>&nbsp;<span class="op" id="3854147">==</span>&nbsp;<span class="num" id="3854150">0</span>&nbsp;<span class="op" id="3854152">||</span>&nbsp;<span class="builtinfunc" id="3854155">len</span><span class="op" id="3854158">(</span><span class="ident" id="3854159">data</span><span class="op" id="3854163">)</span>&nbsp;<span class="op" id="3854165">&lt;=</span>&nbsp;<span class="ident" id="3854168">numCertTypes</span>&nbsp;<span class="op" id="3854181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854185">return</span>&nbsp;<span class="builtintype" id="3854192">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3854199">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854203">m</span><span class="op" id="3854204">.</span><span class="ident" id="3854205">certificateTypes</span>&nbsp;<span class="op" id="3854222">=</span>&nbsp;<span class="builtinfunc" id="3854224">make</span><span class="op" id="3854228">(</span><span class="op" id="3854229">[</span><span class="op" id="3854230">]</span><span class="builtintype" id="3854231">byte</span><span class="op" id="3854235">,</span>&nbsp;<span class="ident" id="3854237">numCertTypes</span><span class="op" id="3854249">)</span><br>
<span class="lineno">1175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854252">if</span>&nbsp;<span class="builtinfunc" id="3854255">copy</span><span class="op" id="3854259">(</span><span class="ident" id="3854260">m</span><span class="op" id="3854261">.</span><span class="ident" id="3854262">certificateTypes</span><span class="op" id="3854278">,</span>&nbsp;<span class="ident" id="3854280">data</span><span class="op" id="3854284">)</span>&nbsp;<span class="op" id="3854286">!=</span>&nbsp;<span class="ident" id="3854289">numCertTypes</span>&nbsp;<span class="op" id="3854302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854306">return</span>&nbsp;<span class="builtintype" id="3854313">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3854320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854324">data</span>&nbsp;<span class="op" id="3854329">=</span>&nbsp;<span class="ident" id="3854331">data</span><span class="op" id="3854335">[</span><span class="ident" id="3854336">numCertTypes</span><span class="op" id="3854348">:</span><span class="op" id="3854349">]</span><br>
<span class="lineno">1180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854353">if</span>&nbsp;<span class="ident" id="3854356">m</span><span class="op" id="3854357">.</span><span class="ident" id="3854358">hasSignatureAndHash</span>&nbsp;<span class="op" id="3854378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854382">if</span>&nbsp;<span class="builtinfunc" id="3854385">len</span><span class="op" id="3854388">(</span><span class="ident" id="3854389">data</span><span class="op" id="3854393">)</span>&nbsp;<span class="op" id="3854395">&lt;</span>&nbsp;<span class="num" id="3854397">2</span>&nbsp;<span class="op" id="3854399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854404">return</span>&nbsp;<span class="builtintype" id="3854411">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3854419">}</span><br>
<span class="lineno">1185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854423">sigAndHashLen</span>&nbsp;<span class="op" id="3854437">:=</span>&nbsp;<span class="builtintype" id="3854440">uint16</span><span class="op" id="3854446">(</span><span class="ident" id="3854447">data</span><span class="op" id="3854451">[</span><span class="num" id="3854452">0</span><span class="op" id="3854453">]</span><span class="op" id="3854454">)</span><span class="op" id="3854455">&lt;&lt;</span><span class="num" id="3854457">8</span>&nbsp;<span class="op" id="3854459">|</span>&nbsp;<span class="builtintype" id="3854461">uint16</span><span class="op" id="3854467">(</span><span class="ident" id="3854468">data</span><span class="op" id="3854472">[</span><span class="num" id="3854473">1</span><span class="op" id="3854474">]</span><span class="op" id="3854475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854479">data</span>&nbsp;<span class="op" id="3854484">=</span>&nbsp;<span class="ident" id="3854486">data</span><span class="op" id="3854490">[</span><span class="num" id="3854491">2</span><span class="op" id="3854492">:</span><span class="op" id="3854493">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854497">if</span>&nbsp;<span class="ident" id="3854500">sigAndHashLen</span><span class="op" id="3854513">&amp;</span><span class="num" id="3854514">1</span>&nbsp;<span class="op" id="3854516">!=</span>&nbsp;<span class="num" id="3854519">0</span>&nbsp;<span class="op" id="3854521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854526">return</span>&nbsp;<span class="builtintype" id="3854533">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3854541">}</span><br>
<span class="lineno">1190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854545">if</span>&nbsp;<span class="builtinfunc" id="3854548">len</span><span class="op" id="3854551">(</span><span class="ident" id="3854552">data</span><span class="op" id="3854556">)</span>&nbsp;<span class="op" id="3854558">&lt;</span>&nbsp;<span class="builtintype" id="3854560">int</span><span class="op" id="3854563">(</span><span class="ident" id="3854564">sigAndHashLen</span><span class="op" id="3854577">)</span>&nbsp;<span class="op" id="3854579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854584">return</span>&nbsp;<span class="builtintype" id="3854591">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3854599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854603">numSigAndHash</span>&nbsp;<span class="op" id="3854617">:=</span>&nbsp;<span class="ident" id="3854620">sigAndHashLen</span>&nbsp;<span class="op" id="3854634">/</span>&nbsp;<span class="num" id="3854636">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854640">m</span><span class="op" id="3854641">.</span><span class="ident" id="3854642">signatureAndHashes</span>&nbsp;<span class="op" id="3854661">=</span>&nbsp;<span class="builtinfunc" id="3854663">make</span><span class="op" id="3854667">(</span><span class="op" id="3854668">[</span><span class="op" id="3854669">]</span><span class="ident" id="3854670">signatureAndHash</span><span class="op" id="3854686">,</span>&nbsp;<span class="ident" id="3854688">numSigAndHash</span><span class="op" id="3854701">)</span><br>
<span class="lineno">1195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854705">for</span>&nbsp;<span class="ident" id="3854709">i</span>&nbsp;<span class="op" id="3854711">:=</span>&nbsp;<span class="keyword" id="3854714">range</span>&nbsp;<span class="ident" id="3854720">m</span><span class="op" id="3854721">.</span><span class="ident" id="3854722">signatureAndHashes</span>&nbsp;<span class="op" id="3854741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854746">m</span><span class="op" id="3854747">.</span><span class="ident" id="3854748">signatureAndHashes</span><span class="op" id="3854766">[</span><span class="ident" id="3854767">i</span><span class="op" id="3854768">]</span><span class="op" id="3854769">.</span><span class="ident" id="3854770">hash</span>&nbsp;<span class="op" id="3854775">=</span>&nbsp;<span class="ident" id="3854777">data</span><span class="op" id="3854781">[</span><span class="num" id="3854782">0</span><span class="op" id="3854783">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854788">m</span><span class="op" id="3854789">.</span><span class="ident" id="3854790">signatureAndHashes</span><span class="op" id="3854808">[</span><span class="ident" id="3854809">i</span><span class="op" id="3854810">]</span><span class="op" id="3854811">.</span><span class="ident" id="3854812">signature</span>&nbsp;<span class="op" id="3854822">=</span>&nbsp;<span class="ident" id="3854824">data</span><span class="op" id="3854828">[</span><span class="num" id="3854829">1</span><span class="op" id="3854830">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854835">data</span>&nbsp;<span class="op" id="3854840">=</span>&nbsp;<span class="ident" id="3854842">data</span><span class="op" id="3854846">[</span><span class="num" id="3854847">2</span><span class="op" id="3854848">:</span><span class="op" id="3854849">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3854853">}</span><br>
<span class="lineno">1200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3854856">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854860">if</span>&nbsp;<span class="builtinfunc" id="3854863">len</span><span class="op" id="3854866">(</span><span class="ident" id="3854867">data</span><span class="op" id="3854871">)</span>&nbsp;<span class="op" id="3854873">&lt;</span>&nbsp;<span class="num" id="3854875">2</span>&nbsp;<span class="op" id="3854877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854881">return</span>&nbsp;<span class="builtintype" id="3854888">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3854895">}</span><br>
<span class="lineno">1205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854898">casLength</span>&nbsp;<span class="op" id="3854908">:=</span>&nbsp;<span class="builtintype" id="3854911">uint16</span><span class="op" id="3854917">(</span><span class="ident" id="3854918">data</span><span class="op" id="3854922">[</span><span class="num" id="3854923">0</span><span class="op" id="3854924">]</span><span class="op" id="3854925">)</span><span class="op" id="3854926">&lt;&lt;</span><span class="num" id="3854928">8</span>&nbsp;<span class="op" id="3854930">|</span>&nbsp;<span class="builtintype" id="3854932">uint16</span><span class="op" id="3854938">(</span><span class="ident" id="3854939">data</span><span class="op" id="3854943">[</span><span class="num" id="3854944">1</span><span class="op" id="3854945">]</span><span class="op" id="3854946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3854949">data</span>&nbsp;<span class="op" id="3854954">=</span>&nbsp;<span class="ident" id="3854956">data</span><span class="op" id="3854960">[</span><span class="num" id="3854961">2</span><span class="op" id="3854962">:</span><span class="op" id="3854963">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3854966">if</span>&nbsp;<span class="builtinfunc" id="3854969">len</span><span class="op" id="3854972">(</span><span class="ident" id="3854973">data</span><span class="op" id="3854977">)</span>&nbsp;<span class="op" id="3854979">&lt;</span>&nbsp;<span class="builtintype" id="3854981">int</span><span class="op" id="3854984">(</span><span class="ident" id="3854985">casLength</span><span class="op" id="3854994">)</span>&nbsp;<span class="op" id="3854996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855000">return</span>&nbsp;<span class="builtintype" id="3855007">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3855014">}</span><br>
<span class="lineno">1210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855017">cas</span>&nbsp;<span class="op" id="3855021">:=</span>&nbsp;<span class="builtinfunc" id="3855024">make</span><span class="op" id="3855028">(</span><span class="op" id="3855029">[</span><span class="op" id="3855030">]</span><span class="builtintype" id="3855031">byte</span><span class="op" id="3855035">,</span>&nbsp;<span class="ident" id="3855037">casLength</span><span class="op" id="3855046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3855049">copy</span><span class="op" id="3855053">(</span><span class="ident" id="3855054">cas</span><span class="op" id="3855057">,</span>&nbsp;<span class="ident" id="3855059">data</span><span class="op" id="3855063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855066">data</span>&nbsp;<span class="op" id="3855071">=</span>&nbsp;<span class="ident" id="3855073">data</span><span class="op" id="3855077">[</span><span class="ident" id="3855078">casLength</span><span class="op" id="3855087">:</span><span class="op" id="3855088">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855092">m</span><span class="op" id="3855093">.</span><span class="ident" id="3855094">certificateAuthorities</span>&nbsp;<span class="op" id="3855117">=</span>&nbsp;<span class="ident" id="3855119">nil</span><br>
<span class="lineno">1215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855124">for</span>&nbsp;<span class="builtinfunc" id="3855128">len</span><span class="op" id="3855131">(</span><span class="ident" id="3855132">cas</span><span class="op" id="3855135">)</span>&nbsp;<span class="op" id="3855137">&gt;</span>&nbsp;<span class="num" id="3855139">0</span>&nbsp;<span class="op" id="3855141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855145">if</span>&nbsp;<span class="builtinfunc" id="3855148">len</span><span class="op" id="3855151">(</span><span class="ident" id="3855152">cas</span><span class="op" id="3855155">)</span>&nbsp;<span class="op" id="3855157">&lt;</span>&nbsp;<span class="num" id="3855159">2</span>&nbsp;<span class="op" id="3855161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855166">return</span>&nbsp;<span class="builtintype" id="3855173">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3855181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855185">caLen</span>&nbsp;<span class="op" id="3855191">:=</span>&nbsp;<span class="builtintype" id="3855194">uint16</span><span class="op" id="3855200">(</span><span class="ident" id="3855201">cas</span><span class="op" id="3855204">[</span><span class="num" id="3855205">0</span><span class="op" id="3855206">]</span><span class="op" id="3855207">)</span><span class="op" id="3855208">&lt;&lt;</span><span class="num" id="3855210">8</span>&nbsp;<span class="op" id="3855212">|</span>&nbsp;<span class="builtintype" id="3855214">uint16</span><span class="op" id="3855220">(</span><span class="ident" id="3855221">cas</span><span class="op" id="3855224">[</span><span class="num" id="3855225">1</span><span class="op" id="3855226">]</span><span class="op" id="3855227">)</span><br>
<span class="lineno">1220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855231">cas</span>&nbsp;<span class="op" id="3855235">=</span>&nbsp;<span class="ident" id="3855237">cas</span><span class="op" id="3855240">[</span><span class="num" id="3855241">2</span><span class="op" id="3855242">:</span><span class="op" id="3855243">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855248">if</span>&nbsp;<span class="builtinfunc" id="3855251">len</span><span class="op" id="3855254">(</span><span class="ident" id="3855255">cas</span><span class="op" id="3855258">)</span>&nbsp;<span class="op" id="3855260">&lt;</span>&nbsp;<span class="builtintype" id="3855262">int</span><span class="op" id="3855265">(</span><span class="ident" id="3855266">caLen</span><span class="op" id="3855271">)</span>&nbsp;<span class="op" id="3855273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855278">return</span>&nbsp;<span class="builtintype" id="3855285">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3855293">}</span><br>
<span class="lineno">1225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855298">m</span><span class="op" id="3855299">.</span><span class="ident" id="3855300">certificateAuthorities</span>&nbsp;<span class="op" id="3855323">=</span>&nbsp;<span class="builtinfunc" id="3855325">append</span><span class="op" id="3855331">(</span><span class="ident" id="3855332">m</span><span class="op" id="3855333">.</span><span class="ident" id="3855334">certificateAuthorities</span><span class="op" id="3855356">,</span>&nbsp;<span class="ident" id="3855358">cas</span><span class="op" id="3855361">[</span><span class="op" id="3855362">:</span><span class="ident" id="3855363">caLen</span><span class="op" id="3855368">]</span><span class="op" id="3855369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855373">cas</span>&nbsp;<span class="op" id="3855377">=</span>&nbsp;<span class="ident" id="3855379">cas</span><span class="op" id="3855382">[</span><span class="ident" id="3855383">caLen</span><span class="op" id="3855388">:</span><span class="op" id="3855389">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3855392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855395">if</span>&nbsp;<span class="builtinfunc" id="3855398">len</span><span class="op" id="3855401">(</span><span class="ident" id="3855402">data</span><span class="op" id="3855406">)</span>&nbsp;<span class="op" id="3855408">&gt;</span>&nbsp;<span class="num" id="3855410">0</span>&nbsp;<span class="op" id="3855412">{</span><br>
<span class="lineno">1230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855416">return</span>&nbsp;<span class="builtintype" id="3855423">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3855430">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855434">return</span>&nbsp;<span class="builtintype" id="3855441">true</span><br>
<span class="lineno"></span><span class="op" id="3855446">}</span><br>
<span class="lineno">1235</span><br>
<span class="lineno"></span><span class="keyword" id="3855449">type</span>&nbsp;<span class="ident" id="3855454">certificateVerifyMsg</span>&nbsp;<span class="keyword" id="3855475">struct</span>&nbsp;<span class="op" id="3855482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855485">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3855505">[</span><span class="op" id="3855506">]</span><span class="builtintype" id="3855507">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855513">hasSignatureAndHash</span>&nbsp;<span class="builtintype" id="3855533">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855539">signatureAndHash</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3855559">signatureAndHash</span><br>
<span class="lineno">1240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855577">signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3855597">[</span><span class="op" id="3855598">]</span><span class="builtintype" id="3855599">byte</span><br>
<span class="lineno"></span><span class="op" id="3855604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3855607">func</span>&nbsp;<span class="op" id="3855612">(</span><span class="ident" id="3855613">m</span>&nbsp;<span class="op" id="3855615">*</span><span class="ident" id="3855616">certificateVerifyMsg</span><span class="op" id="3855636">)</span>&nbsp;<span class="ident" id="3855638">equal</span><span class="op" id="3855643">(</span><span class="ident" id="3855644">i</span>&nbsp;<span class="keyword" id="3855646">interface</span><span class="op" id="3855655">{</span><span class="op" id="3855656">}</span><span class="op" id="3855657">)</span>&nbsp;<span class="builtintype" id="3855659">bool</span>&nbsp;<span class="op" id="3855664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855667">m1</span><span class="op" id="3855669">,</span>&nbsp;<span class="ident" id="3855671">ok</span>&nbsp;<span class="op" id="3855674">:=</span>&nbsp;<span class="ident" id="3855677">i</span><span class="op" id="3855678">.</span><span class="op" id="3855679">(</span><span class="op" id="3855680">*</span><span class="ident" id="3855681">certificateVerifyMsg</span><span class="op" id="3855701">)</span><br>
<span class="lineno">1245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855704">if</span>&nbsp;<span class="op" id="3855707">!</span><span class="ident" id="3855708">ok</span>&nbsp;<span class="op" id="3855711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855715">return</span>&nbsp;<span class="builtintype" id="3855722">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3855729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3855733">return</span>&nbsp;<span class="ident" id="3855740">bytes</span><span class="op" id="3855745">.</span><span class="ident" id="3855746">Equal</span><span class="op" id="3855751">(</span><span class="ident" id="3855752">m</span><span class="op" id="3855753">.</span><span class="ident" id="3855754">raw</span><span class="op" id="3855757">,</span>&nbsp;<span class="ident" id="3855759">m1</span><span class="op" id="3855761">.</span><span class="ident" id="3855762">raw</span><span class="op" id="3855765">)</span>&nbsp;<span class="op" id="3855767">&amp;&amp;</span><br>
<span class="lineno">1250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855772">m</span><span class="op" id="3855773">.</span><span class="ident" id="3855774">hasSignatureAndHash</span>&nbsp;<span class="op" id="3855794">==</span>&nbsp;<span class="ident" id="3855797">m1</span><span class="op" id="3855799">.</span><span class="ident" id="3855800">hasSignatureAndHash</span>&nbsp;<span class="op" id="3855820">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855825">m</span><span class="op" id="3855826">.</span><span class="ident" id="3855827">signatureAndHash</span><span class="op" id="3855843">.</span><span class="ident" id="3855844">hash</span>&nbsp;<span class="op" id="3855849">==</span>&nbsp;<span class="ident" id="3855852">m1</span><span class="op" id="3855854">.</span><span class="ident" id="3855855">signatureAndHash</span><span class="op" id="3855871">.</span><span class="ident" id="3855872">hash</span>&nbsp;<span class="op" id="3855877">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855882">m</span><span class="op" id="3855883">.</span><span class="ident" id="3855884">signatureAndHash</span><span class="op" id="3855900">.</span><span class="ident" id="3855901">signature</span>&nbsp;<span class="op" id="3855911">==</span>&nbsp;<span class="ident" id="3855914">m1</span><span class="op" id="3855916">.</span><span class="ident" id="3855917">signatureAndHash</span><span class="op" id="3855933">.</span><span class="ident" id="3855934">signature</span>&nbsp;<span class="op" id="3855944">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3855949">bytes</span><span class="op" id="3855954">.</span><span class="ident" id="3855955">Equal</span><span class="op" id="3855960">(</span><span class="ident" id="3855961">m</span><span class="op" id="3855962">.</span><span class="ident" id="3855963">signature</span><span class="op" id="3855972">,</span>&nbsp;<span class="ident" id="3855974">m1</span><span class="op" id="3855976">.</span><span class="ident" id="3855977">signature</span><span class="op" id="3855986">)</span><br>
<span class="lineno"></span><span class="op" id="3855988">}</span><br>
<span class="lineno">1255</span><br>
<span class="lineno"></span><span class="keyword" id="3855991">func</span>&nbsp;<span class="op" id="3855996">(</span><span class="ident" id="3855997">m</span>&nbsp;<span class="op" id="3855999">*</span><span class="ident" id="3856000">certificateVerifyMsg</span><span class="op" id="3856020">)</span>&nbsp;<span class="ident" id="3856022">marshal</span><span class="op" id="3856029">(</span><span class="op" id="3856030">)</span>&nbsp;<span class="op" id="3856032">(</span><span class="ident" id="3856033">x</span>&nbsp;<span class="op" id="3856035">[</span><span class="op" id="3856036">]</span><span class="builtintype" id="3856037">byte</span><span class="op" id="3856041">)</span>&nbsp;<span class="op" id="3856043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856046">if</span>&nbsp;<span class="ident" id="3856049">m</span><span class="op" id="3856050">.</span><span class="ident" id="3856051">raw</span>&nbsp;<span class="op" id="3856055">!=</span>&nbsp;<span class="ident" id="3856058">nil</span>&nbsp;<span class="op" id="3856062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856066">return</span>&nbsp;<span class="ident" id="3856073">m</span><span class="op" id="3856074">.</span><span class="ident" id="3856075">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3856080">}</span><br>
<span class="lineno">1260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3856084">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc4346#section-7.4.8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856141">siglength</span>&nbsp;<span class="op" id="3856151">:=</span>&nbsp;<span class="builtinfunc" id="3856154">len</span><span class="op" id="3856157">(</span><span class="ident" id="3856158">m</span><span class="op" id="3856159">.</span><span class="ident" id="3856160">signature</span><span class="op" id="3856169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856172">length</span>&nbsp;<span class="op" id="3856179">:=</span>&nbsp;<span class="num" id="3856182">2</span>&nbsp;<span class="op" id="3856184">+</span>&nbsp;<span class="ident" id="3856186">siglength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856197">if</span>&nbsp;<span class="ident" id="3856200">m</span><span class="op" id="3856201">.</span><span class="ident" id="3856202">hasSignatureAndHash</span>&nbsp;<span class="op" id="3856222">{</span><br>
<span class="lineno">1265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856226">length</span>&nbsp;<span class="op" id="3856233">+=</span>&nbsp;<span class="num" id="3856236">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3856239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856242">x</span>&nbsp;<span class="op" id="3856244">=</span>&nbsp;<span class="builtinfunc" id="3856246">make</span><span class="op" id="3856250">(</span><span class="op" id="3856251">[</span><span class="op" id="3856252">]</span><span class="builtintype" id="3856253">byte</span><span class="op" id="3856257">,</span>&nbsp;<span class="num" id="3856259">4</span><span class="op" id="3856260">+</span><span class="ident" id="3856261">length</span><span class="op" id="3856267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856270">x</span><span class="op" id="3856271">[</span><span class="num" id="3856272">0</span><span class="op" id="3856273">]</span>&nbsp;<span class="op" id="3856275">=</span>&nbsp;<span class="ident" id="3856277">typeCertificateVerify</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856300">x</span><span class="op" id="3856301">[</span><span class="num" id="3856302">1</span><span class="op" id="3856303">]</span>&nbsp;<span class="op" id="3856305">=</span>&nbsp;<span class="builtintype" id="3856307">uint8</span><span class="op" id="3856312">(</span><span class="ident" id="3856313">length</span>&nbsp;<span class="op" id="3856320">&gt;&gt;</span>&nbsp;<span class="num" id="3856323">16</span><span class="op" id="3856325">)</span><br>
<span class="lineno">1270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856328">x</span><span class="op" id="3856329">[</span><span class="num" id="3856330">2</span><span class="op" id="3856331">]</span>&nbsp;<span class="op" id="3856333">=</span>&nbsp;<span class="builtintype" id="3856335">uint8</span><span class="op" id="3856340">(</span><span class="ident" id="3856341">length</span>&nbsp;<span class="op" id="3856348">&gt;&gt;</span>&nbsp;<span class="num" id="3856351">8</span><span class="op" id="3856352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856355">x</span><span class="op" id="3856356">[</span><span class="num" id="3856357">3</span><span class="op" id="3856358">]</span>&nbsp;<span class="op" id="3856360">=</span>&nbsp;<span class="builtintype" id="3856362">uint8</span><span class="op" id="3856367">(</span><span class="ident" id="3856368">length</span><span class="op" id="3856374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856377">y</span>&nbsp;<span class="op" id="3856379">:=</span>&nbsp;<span class="ident" id="3856382">x</span><span class="op" id="3856383">[</span><span class="num" id="3856384">4</span><span class="op" id="3856385">:</span><span class="op" id="3856386">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856389">if</span>&nbsp;<span class="ident" id="3856392">m</span><span class="op" id="3856393">.</span><span class="ident" id="3856394">hasSignatureAndHash</span>&nbsp;<span class="op" id="3856414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856418">y</span><span class="op" id="3856419">[</span><span class="num" id="3856420">0</span><span class="op" id="3856421">]</span>&nbsp;<span class="op" id="3856423">=</span>&nbsp;<span class="ident" id="3856425">m</span><span class="op" id="3856426">.</span><span class="ident" id="3856427">signatureAndHash</span><span class="op" id="3856443">.</span><span class="ident" id="3856444">hash</span><br>
<span class="lineno">1275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856451">y</span><span class="op" id="3856452">[</span><span class="num" id="3856453">1</span><span class="op" id="3856454">]</span>&nbsp;<span class="op" id="3856456">=</span>&nbsp;<span class="ident" id="3856458">m</span><span class="op" id="3856459">.</span><span class="ident" id="3856460">signatureAndHash</span><span class="op" id="3856476">.</span><span class="ident" id="3856477">signature</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856489">y</span>&nbsp;<span class="op" id="3856491">=</span>&nbsp;<span class="ident" id="3856493">y</span><span class="op" id="3856494">[</span><span class="num" id="3856495">2</span><span class="op" id="3856496">:</span><span class="op" id="3856497">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3856500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856503">y</span><span class="op" id="3856504">[</span><span class="num" id="3856505">0</span><span class="op" id="3856506">]</span>&nbsp;<span class="op" id="3856508">=</span>&nbsp;<span class="builtintype" id="3856510">uint8</span><span class="op" id="3856515">(</span><span class="ident" id="3856516">siglength</span>&nbsp;<span class="op" id="3856526">&gt;&gt;</span>&nbsp;<span class="num" id="3856529">8</span><span class="op" id="3856530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856533">y</span><span class="op" id="3856534">[</span><span class="num" id="3856535">1</span><span class="op" id="3856536">]</span>&nbsp;<span class="op" id="3856538">=</span>&nbsp;<span class="builtintype" id="3856540">uint8</span><span class="op" id="3856545">(</span><span class="ident" id="3856546">siglength</span><span class="op" id="3856555">)</span><br>
<span class="lineno">1280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3856558">copy</span><span class="op" id="3856562">(</span><span class="ident" id="3856563">y</span><span class="op" id="3856564">[</span><span class="num" id="3856565">2</span><span class="op" id="3856566">:</span><span class="op" id="3856567">]</span><span class="op" id="3856568">,</span>&nbsp;<span class="ident" id="3856570">m</span><span class="op" id="3856571">.</span><span class="ident" id="3856572">signature</span><span class="op" id="3856581">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856585">m</span><span class="op" id="3856586">.</span><span class="ident" id="3856587">raw</span>&nbsp;<span class="op" id="3856591">=</span>&nbsp;<span class="ident" id="3856593">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856597">return</span><br>
<span class="lineno">1285</span><span class="op" id="3856604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3856607">func</span>&nbsp;<span class="op" id="3856612">(</span><span class="ident" id="3856613">m</span>&nbsp;<span class="op" id="3856615">*</span><span class="ident" id="3856616">certificateVerifyMsg</span><span class="op" id="3856636">)</span>&nbsp;<span class="ident" id="3856638">unmarshal</span><span class="op" id="3856647">(</span><span class="ident" id="3856648">data</span>&nbsp;<span class="op" id="3856653">[</span><span class="op" id="3856654">]</span><span class="builtintype" id="3856655">byte</span><span class="op" id="3856659">)</span>&nbsp;<span class="builtintype" id="3856661">bool</span>&nbsp;<span class="op" id="3856666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856669">m</span><span class="op" id="3856670">.</span><span class="ident" id="3856671">raw</span>&nbsp;<span class="op" id="3856675">=</span>&nbsp;<span class="ident" id="3856677">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856684">if</span>&nbsp;<span class="builtinfunc" id="3856687">len</span><span class="op" id="3856690">(</span><span class="ident" id="3856691">data</span><span class="op" id="3856695">)</span>&nbsp;<span class="op" id="3856697">&lt;</span>&nbsp;<span class="num" id="3856699">6</span>&nbsp;<span class="op" id="3856701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856705">return</span>&nbsp;<span class="builtintype" id="3856712">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3856719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856723">length</span>&nbsp;<span class="op" id="3856730">:=</span>&nbsp;<span class="builtintype" id="3856733">uint32</span><span class="op" id="3856739">(</span><span class="ident" id="3856740">data</span><span class="op" id="3856744">[</span><span class="num" id="3856745">1</span><span class="op" id="3856746">]</span><span class="op" id="3856747">)</span><span class="op" id="3856748">&lt;&lt;</span><span class="num" id="3856750">16</span>&nbsp;<span class="op" id="3856753">|</span>&nbsp;<span class="builtintype" id="3856755">uint32</span><span class="op" id="3856761">(</span><span class="ident" id="3856762">data</span><span class="op" id="3856766">[</span><span class="num" id="3856767">2</span><span class="op" id="3856768">]</span><span class="op" id="3856769">)</span><span class="op" id="3856770">&lt;&lt;</span><span class="num" id="3856772">8</span>&nbsp;<span class="op" id="3856774">|</span>&nbsp;<span class="builtintype" id="3856776">uint32</span><span class="op" id="3856782">(</span><span class="ident" id="3856783">data</span><span class="op" id="3856787">[</span><span class="num" id="3856788">3</span><span class="op" id="3856789">]</span><span class="op" id="3856790">)</span><br>
<span class="lineno">1295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856793">if</span>&nbsp;<span class="builtintype" id="3856796">uint32</span><span class="op" id="3856802">(</span><span class="builtinfunc" id="3856803">len</span><span class="op" id="3856806">(</span><span class="ident" id="3856807">data</span><span class="op" id="3856811">)</span><span class="op" id="3856812">)</span><span class="op" id="3856813">-</span><span class="num" id="3856814">4</span>&nbsp;<span class="op" id="3856816">!=</span>&nbsp;<span class="ident" id="3856819">length</span>&nbsp;<span class="op" id="3856826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856830">return</span>&nbsp;<span class="builtintype" id="3856837">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3856844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856848">data</span>&nbsp;<span class="op" id="3856853">=</span>&nbsp;<span class="ident" id="3856855">data</span><span class="op" id="3856859">[</span><span class="num" id="3856860">4</span><span class="op" id="3856861">:</span><span class="op" id="3856862">]</span><br>
<span class="lineno">1300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856865">if</span>&nbsp;<span class="ident" id="3856868">m</span><span class="op" id="3856869">.</span><span class="ident" id="3856870">hasSignatureAndHash</span>&nbsp;<span class="op" id="3856890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856894">m</span><span class="op" id="3856895">.</span><span class="ident" id="3856896">signatureAndHash</span><span class="op" id="3856912">.</span><span class="ident" id="3856913">hash</span>&nbsp;<span class="op" id="3856918">=</span>&nbsp;<span class="ident" id="3856920">data</span><span class="op" id="3856924">[</span><span class="num" id="3856925">0</span><span class="op" id="3856926">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856930">m</span><span class="op" id="3856931">.</span><span class="ident" id="3856932">signatureAndHash</span><span class="op" id="3856948">.</span><span class="ident" id="3856949">signature</span>&nbsp;<span class="op" id="3856959">=</span>&nbsp;<span class="ident" id="3856961">data</span><span class="op" id="3856965">[</span><span class="num" id="3856966">1</span><span class="op" id="3856967">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3856971">data</span>&nbsp;<span class="op" id="3856976">=</span>&nbsp;<span class="ident" id="3856978">data</span><span class="op" id="3856982">[</span><span class="num" id="3856983">2</span><span class="op" id="3856984">:</span><span class="op" id="3856985">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3856988">}</span><br>
<span class="lineno">1305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3856992">if</span>&nbsp;<span class="builtinfunc" id="3856995">len</span><span class="op" id="3856998">(</span><span class="ident" id="3856999">data</span><span class="op" id="3857003">)</span>&nbsp;<span class="op" id="3857005">&lt;</span>&nbsp;<span class="num" id="3857007">2</span>&nbsp;<span class="op" id="3857009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857013">return</span>&nbsp;<span class="builtintype" id="3857020">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3857027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857030">siglength</span>&nbsp;<span class="op" id="3857040">:=</span>&nbsp;<span class="builtintype" id="3857043">int</span><span class="op" id="3857046">(</span><span class="ident" id="3857047">data</span><span class="op" id="3857051">[</span><span class="num" id="3857052">0</span><span class="op" id="3857053">]</span><span class="op" id="3857054">)</span><span class="op" id="3857055">&lt;&lt;</span><span class="num" id="3857057">8</span>&nbsp;<span class="op" id="3857059">+</span>&nbsp;<span class="builtintype" id="3857061">int</span><span class="op" id="3857064">(</span><span class="ident" id="3857065">data</span><span class="op" id="3857069">[</span><span class="num" id="3857070">1</span><span class="op" id="3857071">]</span><span class="op" id="3857072">)</span><br>
<span class="lineno">1310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857075">data</span>&nbsp;<span class="op" id="3857080">=</span>&nbsp;<span class="ident" id="3857082">data</span><span class="op" id="3857086">[</span><span class="num" id="3857087">2</span><span class="op" id="3857088">:</span><span class="op" id="3857089">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857092">if</span>&nbsp;<span class="builtinfunc" id="3857095">len</span><span class="op" id="3857098">(</span><span class="ident" id="3857099">data</span><span class="op" id="3857103">)</span>&nbsp;<span class="op" id="3857105">!=</span>&nbsp;<span class="ident" id="3857108">siglength</span>&nbsp;<span class="op" id="3857118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857122">return</span>&nbsp;<span class="builtintype" id="3857129">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3857136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857140">m</span><span class="op" id="3857141">.</span><span class="ident" id="3857142">signature</span>&nbsp;<span class="op" id="3857152">=</span>&nbsp;<span class="ident" id="3857154">data</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857161">return</span>&nbsp;<span class="builtintype" id="3857168">true</span><br>
<span class="lineno"></span><span class="op" id="3857173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1320</span><span class="keyword" id="3857176">type</span>&nbsp;<span class="ident" id="3857181">newSessionTicketMsg</span>&nbsp;<span class="keyword" id="3857201">struct</span>&nbsp;<span class="op" id="3857208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857211">raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3857218">[</span><span class="op" id="3857219">]</span><span class="builtintype" id="3857220">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857226">ticket</span>&nbsp;<span class="op" id="3857233">[</span><span class="op" id="3857234">]</span><span class="builtintype" id="3857235">byte</span><br>
<span class="lineno"></span><span class="op" id="3857240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1325</span><span class="keyword" id="3857243">func</span>&nbsp;<span class="op" id="3857248">(</span><span class="ident" id="3857249">m</span>&nbsp;<span class="op" id="3857251">*</span><span class="ident" id="3857252">newSessionTicketMsg</span><span class="op" id="3857271">)</span>&nbsp;<span class="ident" id="3857273">equal</span><span class="op" id="3857278">(</span><span class="ident" id="3857279">i</span>&nbsp;<span class="keyword" id="3857281">interface</span><span class="op" id="3857290">{</span><span class="op" id="3857291">}</span><span class="op" id="3857292">)</span>&nbsp;<span class="builtintype" id="3857294">bool</span>&nbsp;<span class="op" id="3857299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857302">m1</span><span class="op" id="3857304">,</span>&nbsp;<span class="ident" id="3857306">ok</span>&nbsp;<span class="op" id="3857309">:=</span>&nbsp;<span class="ident" id="3857312">i</span><span class="op" id="3857313">.</span><span class="op" id="3857314">(</span><span class="op" id="3857315">*</span><span class="ident" id="3857316">newSessionTicketMsg</span><span class="op" id="3857335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857338">if</span>&nbsp;<span class="op" id="3857341">!</span><span class="ident" id="3857342">ok</span>&nbsp;<span class="op" id="3857345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857349">return</span>&nbsp;<span class="builtintype" id="3857356">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3857363">}</span><br>
<span class="lineno">1330</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857367">return</span>&nbsp;<span class="ident" id="3857374">bytes</span><span class="op" id="3857379">.</span><span class="ident" id="3857380">Equal</span><span class="op" id="3857385">(</span><span class="ident" id="3857386">m</span><span class="op" id="3857387">.</span><span class="ident" id="3857388">raw</span><span class="op" id="3857391">,</span>&nbsp;<span class="ident" id="3857393">m1</span><span class="op" id="3857395">.</span><span class="ident" id="3857396">raw</span><span class="op" id="3857399">)</span>&nbsp;<span class="op" id="3857401">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857406">bytes</span><span class="op" id="3857411">.</span><span class="ident" id="3857412">Equal</span><span class="op" id="3857417">(</span><span class="ident" id="3857418">m</span><span class="op" id="3857419">.</span><span class="ident" id="3857420">ticket</span><span class="op" id="3857426">,</span>&nbsp;<span class="ident" id="3857428">m1</span><span class="op" id="3857430">.</span><span class="ident" id="3857431">ticket</span><span class="op" id="3857437">)</span><br>
<span class="lineno"></span><span class="op" id="3857439">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1335</span><span class="keyword" id="3857442">func</span>&nbsp;<span class="op" id="3857447">(</span><span class="ident" id="3857448">m</span>&nbsp;<span class="op" id="3857450">*</span><span class="ident" id="3857451">newSessionTicketMsg</span><span class="op" id="3857470">)</span>&nbsp;<span class="ident" id="3857472">marshal</span><span class="op" id="3857479">(</span><span class="op" id="3857480">)</span>&nbsp;<span class="op" id="3857482">(</span><span class="ident" id="3857483">x</span>&nbsp;<span class="op" id="3857485">[</span><span class="op" id="3857486">]</span><span class="builtintype" id="3857487">byte</span><span class="op" id="3857491">)</span>&nbsp;<span class="op" id="3857493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857496">if</span>&nbsp;<span class="ident" id="3857499">m</span><span class="op" id="3857500">.</span><span class="ident" id="3857501">raw</span>&nbsp;<span class="op" id="3857505">!=</span>&nbsp;<span class="ident" id="3857508">nil</span>&nbsp;<span class="op" id="3857512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857516">return</span>&nbsp;<span class="ident" id="3857523">m</span><span class="op" id="3857524">.</span><span class="ident" id="3857525">raw</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3857530">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3857534">//&nbsp;See&nbsp;http://tools.ietf.org/html/rfc5077#section-3.3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857589">ticketLen</span>&nbsp;<span class="op" id="3857599">:=</span>&nbsp;<span class="builtinfunc" id="3857602">len</span><span class="op" id="3857605">(</span><span class="ident" id="3857606">m</span><span class="op" id="3857607">.</span><span class="ident" id="3857608">ticket</span><span class="op" id="3857614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857617">length</span>&nbsp;<span class="op" id="3857624">:=</span>&nbsp;<span class="num" id="3857627">2</span>&nbsp;<span class="op" id="3857629">+</span>&nbsp;<span class="num" id="3857631">4</span>&nbsp;<span class="op" id="3857633">+</span>&nbsp;<span class="ident" id="3857635">ticketLen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857646">x</span>&nbsp;<span class="op" id="3857648">=</span>&nbsp;<span class="builtinfunc" id="3857650">make</span><span class="op" id="3857654">(</span><span class="op" id="3857655">[</span><span class="op" id="3857656">]</span><span class="builtintype" id="3857657">byte</span><span class="op" id="3857661">,</span>&nbsp;<span class="num" id="3857663">4</span><span class="op" id="3857664">+</span><span class="ident" id="3857665">length</span><span class="op" id="3857671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857674">x</span><span class="op" id="3857675">[</span><span class="num" id="3857676">0</span><span class="op" id="3857677">]</span>&nbsp;<span class="op" id="3857679">=</span>&nbsp;<span class="ident" id="3857681">typeNewSessionTicket</span><br>
<span class="lineno">1345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857703">x</span><span class="op" id="3857704">[</span><span class="num" id="3857705">1</span><span class="op" id="3857706">]</span>&nbsp;<span class="op" id="3857708">=</span>&nbsp;<span class="builtintype" id="3857710">uint8</span><span class="op" id="3857715">(</span><span class="ident" id="3857716">length</span>&nbsp;<span class="op" id="3857723">&gt;&gt;</span>&nbsp;<span class="num" id="3857726">16</span><span class="op" id="3857728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857731">x</span><span class="op" id="3857732">[</span><span class="num" id="3857733">2</span><span class="op" id="3857734">]</span>&nbsp;<span class="op" id="3857736">=</span>&nbsp;<span class="builtintype" id="3857738">uint8</span><span class="op" id="3857743">(</span><span class="ident" id="3857744">length</span>&nbsp;<span class="op" id="3857751">&gt;&gt;</span>&nbsp;<span class="num" id="3857754">8</span><span class="op" id="3857755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857758">x</span><span class="op" id="3857759">[</span><span class="num" id="3857760">3</span><span class="op" id="3857761">]</span>&nbsp;<span class="op" id="3857763">=</span>&nbsp;<span class="builtintype" id="3857765">uint8</span><span class="op" id="3857770">(</span><span class="ident" id="3857771">length</span><span class="op" id="3857777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857780">x</span><span class="op" id="3857781">[</span><span class="num" id="3857782">8</span><span class="op" id="3857783">]</span>&nbsp;<span class="op" id="3857785">=</span>&nbsp;<span class="builtintype" id="3857787">uint8</span><span class="op" id="3857792">(</span><span class="ident" id="3857793">ticketLen</span>&nbsp;<span class="op" id="3857803">&gt;&gt;</span>&nbsp;<span class="num" id="3857806">8</span><span class="op" id="3857807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857810">x</span><span class="op" id="3857811">[</span><span class="num" id="3857812">9</span><span class="op" id="3857813">]</span>&nbsp;<span class="op" id="3857815">=</span>&nbsp;<span class="builtintype" id="3857817">uint8</span><span class="op" id="3857822">(</span><span class="ident" id="3857823">ticketLen</span><span class="op" id="3857832">)</span><br>
<span class="lineno">1350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3857835">copy</span><span class="op" id="3857839">(</span><span class="ident" id="3857840">x</span><span class="op" id="3857841">[</span><span class="num" id="3857842">10</span><span class="op" id="3857844">:</span><span class="op" id="3857845">]</span><span class="op" id="3857846">,</span>&nbsp;<span class="ident" id="3857848">m</span><span class="op" id="3857849">.</span><span class="ident" id="3857850">ticket</span><span class="op" id="3857856">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857860">m</span><span class="op" id="3857861">.</span><span class="ident" id="3857862">raw</span>&nbsp;<span class="op" id="3857866">=</span>&nbsp;<span class="ident" id="3857868">x</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857872">return</span><br>
<span class="lineno">1355</span><span class="op" id="3857879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3857882">func</span>&nbsp;<span class="op" id="3857887">(</span><span class="ident" id="3857888">m</span>&nbsp;<span class="op" id="3857890">*</span><span class="ident" id="3857891">newSessionTicketMsg</span><span class="op" id="3857910">)</span>&nbsp;<span class="ident" id="3857912">unmarshal</span><span class="op" id="3857921">(</span><span class="ident" id="3857922">data</span>&nbsp;<span class="op" id="3857927">[</span><span class="op" id="3857928">]</span><span class="builtintype" id="3857929">byte</span><span class="op" id="3857933">)</span>&nbsp;<span class="builtintype" id="3857935">bool</span>&nbsp;<span class="op" id="3857940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857943">m</span><span class="op" id="3857944">.</span><span class="ident" id="3857945">raw</span>&nbsp;<span class="op" id="3857949">=</span>&nbsp;<span class="ident" id="3857951">data</span><br>
<span class="lineno"></span><br>
<span class="lineno">1360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857958">if</span>&nbsp;<span class="builtinfunc" id="3857961">len</span><span class="op" id="3857964">(</span><span class="ident" id="3857965">data</span><span class="op" id="3857969">)</span>&nbsp;<span class="op" id="3857971">&lt;</span>&nbsp;<span class="num" id="3857973">10</span>&nbsp;<span class="op" id="3857976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3857980">return</span>&nbsp;<span class="builtintype" id="3857987">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3857994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3857998">length</span>&nbsp;<span class="op" id="3858005">:=</span>&nbsp;<span class="builtintype" id="3858008">uint32</span><span class="op" id="3858014">(</span><span class="ident" id="3858015">data</span><span class="op" id="3858019">[</span><span class="num" id="3858020">1</span><span class="op" id="3858021">]</span><span class="op" id="3858022">)</span><span class="op" id="3858023">&lt;&lt;</span><span class="num" id="3858025">16</span>&nbsp;<span class="op" id="3858028">|</span>&nbsp;<span class="builtintype" id="3858030">uint32</span><span class="op" id="3858036">(</span><span class="ident" id="3858037">data</span><span class="op" id="3858041">[</span><span class="num" id="3858042">2</span><span class="op" id="3858043">]</span><span class="op" id="3858044">)</span><span class="op" id="3858045">&lt;&lt;</span><span class="num" id="3858047">8</span>&nbsp;<span class="op" id="3858049">|</span>&nbsp;<span class="builtintype" id="3858051">uint32</span><span class="op" id="3858057">(</span><span class="ident" id="3858058">data</span><span class="op" id="3858062">[</span><span class="num" id="3858063">3</span><span class="op" id="3858064">]</span><span class="op" id="3858065">)</span><br>
<span class="lineno">1365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858068">if</span>&nbsp;<span class="builtintype" id="3858071">uint32</span><span class="op" id="3858077">(</span><span class="builtinfunc" id="3858078">len</span><span class="op" id="3858081">(</span><span class="ident" id="3858082">data</span><span class="op" id="3858086">)</span><span class="op" id="3858087">)</span><span class="op" id="3858088">-</span><span class="num" id="3858089">4</span>&nbsp;<span class="op" id="3858091">!=</span>&nbsp;<span class="ident" id="3858094">length</span>&nbsp;<span class="op" id="3858101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858105">return</span>&nbsp;<span class="builtintype" id="3858112">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858119">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3858123">ticketLen</span>&nbsp;<span class="op" id="3858133">:=</span>&nbsp;<span class="builtintype" id="3858136">int</span><span class="op" id="3858139">(</span><span class="ident" id="3858140">data</span><span class="op" id="3858144">[</span><span class="num" id="3858145">8</span><span class="op" id="3858146">]</span><span class="op" id="3858147">)</span><span class="op" id="3858148">&lt;&lt;</span><span class="num" id="3858150">8</span>&nbsp;<span class="op" id="3858152">+</span>&nbsp;<span class="builtintype" id="3858154">int</span><span class="op" id="3858157">(</span><span class="ident" id="3858158">data</span><span class="op" id="3858162">[</span><span class="num" id="3858163">9</span><span class="op" id="3858164">]</span><span class="op" id="3858165">)</span><br>
<span class="lineno">1370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858168">if</span>&nbsp;<span class="builtinfunc" id="3858171">len</span><span class="op" id="3858174">(</span><span class="ident" id="3858175">data</span><span class="op" id="3858179">)</span><span class="op" id="3858180">-</span><span class="num" id="3858181">10</span>&nbsp;<span class="op" id="3858184">!=</span>&nbsp;<span class="ident" id="3858187">ticketLen</span>&nbsp;<span class="op" id="3858197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858201">return</span>&nbsp;<span class="builtintype" id="3858208">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858215">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3858219">m</span><span class="op" id="3858220">.</span><span class="ident" id="3858221">ticket</span>&nbsp;<span class="op" id="3858228">=</span>&nbsp;<span class="ident" id="3858230">data</span><span class="op" id="3858234">[</span><span class="num" id="3858235">10</span><span class="op" id="3858237">:</span><span class="op" id="3858238">]</span><br>
<span class="lineno">1375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858242">return</span>&nbsp;<span class="builtintype" id="3858249">true</span><br>
<span class="lineno"></span><span class="op" id="3858254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3858257">func</span>&nbsp;<span class="ident" id="3858262">eqUint16s</span><span class="op" id="3858271">(</span><span class="ident" id="3858272">x</span><span class="op" id="3858273">,</span>&nbsp;<span class="ident" id="3858275">y</span>&nbsp;<span class="op" id="3858277">[</span><span class="op" id="3858278">]</span><span class="builtintype" id="3858279">uint16</span><span class="op" id="3858285">)</span>&nbsp;<span class="builtintype" id="3858287">bool</span>&nbsp;<span class="op" id="3858292">{</span><br>
<span class="lineno">1380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858295">if</span>&nbsp;<span class="builtinfunc" id="3858298">len</span><span class="op" id="3858301">(</span><span class="ident" id="3858302">x</span><span class="op" id="3858303">)</span>&nbsp;<span class="op" id="3858305">!=</span>&nbsp;<span class="builtinfunc" id="3858308">len</span><span class="op" id="3858311">(</span><span class="ident" id="3858312">y</span><span class="op" id="3858313">)</span>&nbsp;<span class="op" id="3858315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858319">return</span>&nbsp;<span class="builtintype" id="3858326">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858336">for</span>&nbsp;<span class="ident" id="3858340">i</span><span class="op" id="3858341">,</span>&nbsp;<span class="ident" id="3858343">v</span>&nbsp;<span class="op" id="3858345">:=</span>&nbsp;<span class="keyword" id="3858348">range</span>&nbsp;<span class="ident" id="3858354">x</span>&nbsp;<span class="op" id="3858356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858360">if</span>&nbsp;<span class="ident" id="3858363">y</span><span class="op" id="3858364">[</span><span class="ident" id="3858365">i</span><span class="op" id="3858366">]</span>&nbsp;<span class="op" id="3858368">!=</span>&nbsp;<span class="ident" id="3858371">v</span>&nbsp;<span class="op" id="3858373">{</span><br>
<span class="lineno">1385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858378">return</span>&nbsp;<span class="builtintype" id="3858385">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858399">return</span>&nbsp;<span class="builtintype" id="3858406">true</span><br>
<span class="lineno"></span><span class="op" id="3858411">}</span><br>
<span class="lineno">1390</span><br>
<span class="lineno"></span><span class="keyword" id="3858414">func</span>&nbsp;<span class="ident" id="3858419">eqCurveIDs</span><span class="op" id="3858429">(</span><span class="ident" id="3858430">x</span><span class="op" id="3858431">,</span>&nbsp;<span class="ident" id="3858433">y</span>&nbsp;<span class="op" id="3858435">[</span><span class="op" id="3858436">]</span><span class="ident" id="3858437">CurveID</span><span class="op" id="3858444">)</span>&nbsp;<span class="builtintype" id="3858446">bool</span>&nbsp;<span class="op" id="3858451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858454">if</span>&nbsp;<span class="builtinfunc" id="3858457">len</span><span class="op" id="3858460">(</span><span class="ident" id="3858461">x</span><span class="op" id="3858462">)</span>&nbsp;<span class="op" id="3858464">!=</span>&nbsp;<span class="builtinfunc" id="3858467">len</span><span class="op" id="3858470">(</span><span class="ident" id="3858471">y</span><span class="op" id="3858472">)</span>&nbsp;<span class="op" id="3858474">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858478">return</span>&nbsp;<span class="builtintype" id="3858485">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858492">}</span><br>
<span class="lineno">1395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858495">for</span>&nbsp;<span class="ident" id="3858499">i</span><span class="op" id="3858500">,</span>&nbsp;<span class="ident" id="3858502">v</span>&nbsp;<span class="op" id="3858504">:=</span>&nbsp;<span class="keyword" id="3858507">range</span>&nbsp;<span class="ident" id="3858513">x</span>&nbsp;<span class="op" id="3858515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858519">if</span>&nbsp;<span class="ident" id="3858522">y</span><span class="op" id="3858523">[</span><span class="ident" id="3858524">i</span><span class="op" id="3858525">]</span>&nbsp;<span class="op" id="3858527">!=</span>&nbsp;<span class="ident" id="3858530">v</span>&nbsp;<span class="op" id="3858532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858537">return</span>&nbsp;<span class="builtintype" id="3858544">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858552">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858555">}</span><br>
<span class="lineno">1400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858558">return</span>&nbsp;<span class="builtintype" id="3858565">true</span><br>
<span class="lineno"></span><span class="op" id="3858570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3858573">func</span>&nbsp;<span class="ident" id="3858578">eqStrings</span><span class="op" id="3858587">(</span><span class="ident" id="3858588">x</span><span class="op" id="3858589">,</span>&nbsp;<span class="ident" id="3858591">y</span>&nbsp;<span class="op" id="3858593">[</span><span class="op" id="3858594">]</span><span class="builtintype" id="3858595">string</span><span class="op" id="3858601">)</span>&nbsp;<span class="builtintype" id="3858603">bool</span>&nbsp;<span class="op" id="3858608">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858611">if</span>&nbsp;<span class="builtinfunc" id="3858614">len</span><span class="op" id="3858617">(</span><span class="ident" id="3858618">x</span><span class="op" id="3858619">)</span>&nbsp;<span class="op" id="3858621">!=</span>&nbsp;<span class="builtinfunc" id="3858624">len</span><span class="op" id="3858627">(</span><span class="ident" id="3858628">y</span><span class="op" id="3858629">)</span>&nbsp;<span class="op" id="3858631">{</span><br>
<span class="lineno">1405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858635">return</span>&nbsp;<span class="builtintype" id="3858642">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858652">for</span>&nbsp;<span class="ident" id="3858656">i</span><span class="op" id="3858657">,</span>&nbsp;<span class="ident" id="3858659">v</span>&nbsp;<span class="op" id="3858661">:=</span>&nbsp;<span class="keyword" id="3858664">range</span>&nbsp;<span class="ident" id="3858670">x</span>&nbsp;<span class="op" id="3858672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858676">if</span>&nbsp;<span class="ident" id="3858679">y</span><span class="op" id="3858680">[</span><span class="ident" id="3858681">i</span><span class="op" id="3858682">]</span>&nbsp;<span class="op" id="3858684">!=</span>&nbsp;<span class="ident" id="3858687">v</span>&nbsp;<span class="op" id="3858689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858694">return</span>&nbsp;<span class="builtintype" id="3858701">false</span><br>
<span class="lineno">1410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858715">return</span>&nbsp;<span class="builtintype" id="3858722">true</span><br>
<span class="lineno"></span><span class="op" id="3858727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">1415</span><span class="keyword" id="3858730">func</span>&nbsp;<span class="ident" id="3858735">eqByteSlices</span><span class="op" id="3858747">(</span><span class="ident" id="3858748">x</span><span class="op" id="3858749">,</span>&nbsp;<span class="ident" id="3858751">y</span>&nbsp;<span class="op" id="3858753">[</span><span class="op" id="3858754">]</span><span class="op" id="3858755">[</span><span class="op" id="3858756">]</span><span class="builtintype" id="3858757">byte</span><span class="op" id="3858761">)</span>&nbsp;<span class="builtintype" id="3858763">bool</span>&nbsp;<span class="op" id="3858768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858771">if</span>&nbsp;<span class="builtinfunc" id="3858774">len</span><span class="op" id="3858777">(</span><span class="ident" id="3858778">x</span><span class="op" id="3858779">)</span>&nbsp;<span class="op" id="3858781">!=</span>&nbsp;<span class="builtinfunc" id="3858784">len</span><span class="op" id="3858787">(</span><span class="ident" id="3858788">y</span><span class="op" id="3858789">)</span>&nbsp;<span class="op" id="3858791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858795">return</span>&nbsp;<span class="builtintype" id="3858802">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858812">for</span>&nbsp;<span class="ident" id="3858816">i</span><span class="op" id="3858817">,</span>&nbsp;<span class="ident" id="3858819">v</span>&nbsp;<span class="op" id="3858821">:=</span>&nbsp;<span class="keyword" id="3858824">range</span>&nbsp;<span class="ident" id="3858830">x</span>&nbsp;<span class="op" id="3858832">{</span><br>
<span class="lineno">1420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858836">if</span>&nbsp;<span class="op" id="3858839">!</span><span class="ident" id="3858840">bytes</span><span class="op" id="3858845">.</span><span class="ident" id="3858846">Equal</span><span class="op" id="3858851">(</span><span class="ident" id="3858852">v</span><span class="op" id="3858853">,</span>&nbsp;<span class="ident" id="3858855">y</span><span class="op" id="3858856">[</span><span class="ident" id="3858857">i</span><span class="op" id="3858858">]</span><span class="op" id="3858859">)</span>&nbsp;<span class="op" id="3858861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858866">return</span>&nbsp;<span class="builtintype" id="3858873">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858887">return</span>&nbsp;<span class="builtintype" id="3858894">true</span><br>
<span class="lineno">1425</span><span class="op" id="3858899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3858902">func</span>&nbsp;<span class="ident" id="3858907">eqSignatureAndHashes</span><span class="op" id="3858927">(</span><span class="ident" id="3858928">x</span><span class="op" id="3858929">,</span>&nbsp;<span class="ident" id="3858931">y</span>&nbsp;<span class="op" id="3858933">[</span><span class="op" id="3858934">]</span><span class="ident" id="3858935">signatureAndHash</span><span class="op" id="3858951">)</span>&nbsp;<span class="builtintype" id="3858953">bool</span>&nbsp;<span class="op" id="3858958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858961">if</span>&nbsp;<span class="builtinfunc" id="3858964">len</span><span class="op" id="3858967">(</span><span class="ident" id="3858968">x</span><span class="op" id="3858969">)</span>&nbsp;<span class="op" id="3858971">!=</span>&nbsp;<span class="builtinfunc" id="3858974">len</span><span class="op" id="3858977">(</span><span class="ident" id="3858978">y</span><span class="op" id="3858979">)</span>&nbsp;<span class="op" id="3858981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3858985">return</span>&nbsp;<span class="builtintype" id="3858992">false</span><br>
<span class="lineno">1430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3858999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859002">for</span>&nbsp;<span class="ident" id="3859006">i</span><span class="op" id="3859007">,</span>&nbsp;<span class="ident" id="3859009">v</span>&nbsp;<span class="op" id="3859011">:=</span>&nbsp;<span class="keyword" id="3859014">range</span>&nbsp;<span class="ident" id="3859020">x</span>&nbsp;<span class="op" id="3859022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3859026">v2</span>&nbsp;<span class="op" id="3859029">:=</span>&nbsp;<span class="ident" id="3859032">y</span><span class="op" id="3859033">[</span><span class="ident" id="3859034">i</span><span class="op" id="3859035">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859039">if</span>&nbsp;<span class="ident" id="3859042">v</span><span class="op" id="3859043">.</span><span class="ident" id="3859044">hash</span>&nbsp;<span class="op" id="3859049">!=</span>&nbsp;<span class="ident" id="3859052">v2</span><span class="op" id="3859054">.</span><span class="ident" id="3859055">hash</span>&nbsp;<span class="op" id="3859060">||</span>&nbsp;<span class="ident" id="3859063">v</span><span class="op" id="3859064">.</span><span class="ident" id="3859065">signature</span>&nbsp;<span class="op" id="3859075">!=</span>&nbsp;<span class="ident" id="3859078">v2</span><span class="op" id="3859080">.</span><span class="ident" id="3859081">signature</span>&nbsp;<span class="op" id="3859091">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859096">return</span>&nbsp;<span class="builtintype" id="3859103">false</span><br>
<span class="lineno">1435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3859111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3859114">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3859117">return</span>&nbsp;<span class="builtintype" id="3859124">true</span><br>
<span class="lineno"></span><span class="op" id="3859129">}</span>
</div>
</body>
</html>
