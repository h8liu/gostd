<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/rpc</h2>
<ul>
<li><a href="/gostd/net/rpc/client.go.html">client.go</a></li>
<li><a href="/gostd/net/rpc/client_test.go.html">client_test.go</a></li>
<li><a href="/gostd/net/rpc/debug.go.html">debug.go</a></li>
<li><a href="/gostd/net/rpc/server.go.html">server.go</a></li>
<li><a href="/gostd/net/rpc/server_test.go.html" class="current">server_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7232496">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7232551">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7232605">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7232656">package</span>&nbsp;<span class="ident" id="7232664">rpc</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7232669">import</span>&nbsp;<span class="op" id="7232676">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7232679">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7232689">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7232696">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7232702">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7232709">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7232716">&#34;net/http/httptest&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7232737">&#34;runtime&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7232748">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7232759">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7232767">&#34;sync/atomic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7232782">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7232793">&#34;time&#34;</span><br>
<span class="lineno">20</span><span class="op" id="7232800">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7232803">var</span>&nbsp;<span class="op" id="7232807">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7232810">newServer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7232836">*</span><span class="ident" id="7232837"><a href="/gostd/net/rpc/server.go.html#5277991">Server</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7232845">serverAddr</span><span class="op" id="7232855">,</span>&nbsp;<span class="ident" id="7232857">newServerAddr</span>&nbsp;<span class="builtintype" id="7232871">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7232879">httpServerAddr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7232905">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7232913">once</span><span class="op" id="7232917">,</span>&nbsp;<span class="ident" id="7232919">newOnce</span><span class="op" id="7232926">,</span>&nbsp;<span class="ident" id="7232928">httpOnce</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7232939"><a href="/gostd/net/rpc/server_test.go.html#7232759">sync</a></span><span class="op" id="7232943">.</span><span class="ident" id="7232944"><a href="/gostd/sync/once.go.html#1446221">Once</a></span><br>
<span class="lineno"></span><span class="op" id="7232949">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7232952">const</span>&nbsp;<span class="op" id="7232958">(</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7232961">newHttpPath</span>&nbsp;<span class="op" id="7232973">=</span>&nbsp;<span class="string" id="7232975">&#34;/foo&#34;</span><br>
<span class="lineno"></span><span class="op" id="7232982">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7232985">type</span>&nbsp;<span class="ident" id="7232990">Args</span>&nbsp;<span class="keyword" id="7232995">struct</span>&nbsp;<span class="op" id="7233002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7233005">A</span><span class="op" id="7233006">,</span>&nbsp;<span class="ident" id="7233008">B</span>&nbsp;<span class="builtintype" id="7233010">int</span><br>
<span class="lineno">35</span><span class="op" id="7233014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7233017">type</span>&nbsp;<span class="ident" id="7233022">Reply</span>&nbsp;<span class="keyword" id="7233028">struct</span>&nbsp;<span class="op" id="7233035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7233038">C</span>&nbsp;<span class="builtintype" id="7233040">int</span><br>
<span class="lineno"></span><span class="op" id="7233044">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="7233047">type</span>&nbsp;<span class="ident" id="7233052">Arith</span>&nbsp;<span class="builtintype" id="7233058">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7233063">//&nbsp;Some&nbsp;of&nbsp;Arith&#39;s&nbsp;methods&nbsp;have&nbsp;value&nbsp;args,&nbsp;some&nbsp;have&nbsp;pointer&nbsp;args.&nbsp;That&#39;s&nbsp;deliberate.</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="keyword" id="7233151">func</span>&nbsp;<span class="op" id="7233156">(</span><span class="ident" id="7233157">t</span>&nbsp;<span class="op" id="7233159">*</span><span class="ident" id="7233160"><a href="/gostd/net/rpc/server_test.go.html#7233052">Arith</a></span><span class="op" id="7233165">)</span>&nbsp;<span class="ident" id="7233167">Add</span><span class="op" id="7233170">(</span><span class="ident" id="7233171">args</span>&nbsp;<span class="ident" id="7233176"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7233180">,</span>&nbsp;<span class="ident" id="7233182">reply</span>&nbsp;<span class="op" id="7233188">*</span><span class="ident" id="7233189"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7233194">)</span>&nbsp;<span class="builtintype" id="7233196">error</span>&nbsp;<span class="op" id="7233202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7233205"><a href="/gostd/net/rpc/server_test.go.html#7233182">reply</a></span><span class="op" id="7233210">.</span><span class="ident" id="7233211"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span>&nbsp;<span class="op" id="7233213">=</span>&nbsp;<span class="ident" id="7233215"><a href="/gostd/net/rpc/server_test.go.html#7233171">args</a></span><span class="op" id="7233219">.</span><span class="ident" id="7233220"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span>&nbsp;<span class="op" id="7233222">+</span>&nbsp;<span class="ident" id="7233224"><a href="/gostd/net/rpc/server_test.go.html#7233171">args</a></span><span class="op" id="7233228">.</span><span class="ident" id="7233229"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7233232">return</span>&nbsp;<span class="builtintype" id="7233239">nil</span><br>
<span class="lineno"></span><span class="op" id="7233243">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="keyword" id="7233246">func</span>&nbsp;<span class="op" id="7233251">(</span><span class="ident" id="7233252">t</span>&nbsp;<span class="op" id="7233254">*</span><span class="ident" id="7233255"><a href="/gostd/net/rpc/server_test.go.html#7233052">Arith</a></span><span class="op" id="7233260">)</span>&nbsp;<span class="ident" id="7233262">Mul</span><span class="op" id="7233265">(</span><span class="ident" id="7233266">args</span>&nbsp;<span class="op" id="7233271">*</span><span class="ident" id="7233272"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7233276">,</span>&nbsp;<span class="ident" id="7233278">reply</span>&nbsp;<span class="op" id="7233284">*</span><span class="ident" id="7233285"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7233290">)</span>&nbsp;<span class="builtintype" id="7233292">error</span>&nbsp;<span class="op" id="7233298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7233301"><a href="/gostd/net/rpc/server_test.go.html#7233278">reply</a></span><span class="op" id="7233306">.</span><span class="ident" id="7233307"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span>&nbsp;<span class="op" id="7233309">=</span>&nbsp;<span class="ident" id="7233311"><a href="/gostd/net/rpc/server_test.go.html#7233266">args</a></span><span class="op" id="7233315">.</span><span class="ident" id="7233316"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span>&nbsp;<span class="op" id="7233318">*</span>&nbsp;<span class="ident" id="7233320"><a href="/gostd/net/rpc/server_test.go.html#7233266">args</a></span><span class="op" id="7233324">.</span><span class="ident" id="7233325"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7233328">return</span>&nbsp;<span class="builtintype" id="7233335">nil</span><br>
<span class="lineno"></span><span class="op" id="7233339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="7233342">func</span>&nbsp;<span class="op" id="7233347">(</span><span class="ident" id="7233348">t</span>&nbsp;<span class="op" id="7233350">*</span><span class="ident" id="7233351"><a href="/gostd/net/rpc/server_test.go.html#7233052">Arith</a></span><span class="op" id="7233356">)</span>&nbsp;<span class="ident" id="7233358">Div</span><span class="op" id="7233361">(</span><span class="ident" id="7233362">args</span>&nbsp;<span class="ident" id="7233367"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7233371">,</span>&nbsp;<span class="ident" id="7233373">reply</span>&nbsp;<span class="op" id="7233379">*</span><span class="ident" id="7233380"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7233385">)</span>&nbsp;<span class="builtintype" id="7233387">error</span>&nbsp;<span class="op" id="7233393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7233396">if</span>&nbsp;<span class="ident" id="7233399"><a href="/gostd/net/rpc/server_test.go.html#7233362">args</a></span><span class="op" id="7233403">.</span><span class="ident" id="7233404"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span>&nbsp;<span class="op" id="7233406">==</span>&nbsp;<span class="num" id="7233409">0</span>&nbsp;<span class="op" id="7233411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7233415">return</span>&nbsp;<span class="ident" id="7233422"><a href="/gostd/net/rpc/server_test.go.html#7232679">errors</a></span><span class="op" id="7233428">.</span><span class="ident" id="7233429"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="7233432">(</span><span class="string" id="7233433">&#34;divide&nbsp;by&nbsp;zero&#34;</span><span class="op" id="7233449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7233452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7233455"><a href="/gostd/net/rpc/server_test.go.html#7233373">reply</a></span><span class="op" id="7233460">.</span><span class="ident" id="7233461"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span>&nbsp;<span class="op" id="7233463">=</span>&nbsp;<span class="ident" id="7233465"><a href="/gostd/net/rpc/server_test.go.html#7233362">args</a></span><span class="op" id="7233469">.</span><span class="ident" id="7233470"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span>&nbsp;<span class="op" id="7233472">/</span>&nbsp;<span class="ident" id="7233474"><a href="/gostd/net/rpc/server_test.go.html#7233362">args</a></span><span class="op" id="7233478">.</span><span class="ident" id="7233479"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7233482">return</span>&nbsp;<span class="builtintype" id="7233489">nil</span><br>
<span class="lineno"></span><span class="op" id="7233493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7233496">func</span>&nbsp;<span class="op" id="7233501">(</span><span class="ident" id="7233502">t</span>&nbsp;<span class="op" id="7233504">*</span><span class="ident" id="7233505"><a href="/gostd/net/rpc/server_test.go.html#7233052">Arith</a></span><span class="op" id="7233510">)</span>&nbsp;<span class="ident" id="7233512">String</span><span class="op" id="7233518">(</span><span class="ident" id="7233519">args</span>&nbsp;<span class="op" id="7233524">*</span><span class="ident" id="7233525"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7233529">,</span>&nbsp;<span class="ident" id="7233531">reply</span>&nbsp;<span class="op" id="7233537">*</span><span class="builtintype" id="7233538">string</span><span class="op" id="7233544">)</span>&nbsp;<span class="builtintype" id="7233546">error</span>&nbsp;<span class="op" id="7233552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7233555">*</span><span class="ident" id="7233556"><a href="/gostd/net/rpc/server_test.go.html#7233531">reply</a></span>&nbsp;<span class="op" id="7233562">=</span>&nbsp;<span class="ident" id="7233564"><a href="/gostd/net/rpc/server_test.go.html#7232689">fmt</a></span><span class="op" id="7233567">.</span><span class="ident" id="7233568"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="7233575">(</span><span class="string" id="7233576">&#34;%d+%d=%d&#34;</span><span class="op" id="7233586">,</span>&nbsp;<span class="ident" id="7233588"><a href="/gostd/net/rpc/server_test.go.html#7233519">args</a></span><span class="op" id="7233592">.</span><span class="ident" id="7233593"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7233594">,</span>&nbsp;<span class="ident" id="7233596"><a href="/gostd/net/rpc/server_test.go.html#7233519">args</a></span><span class="op" id="7233600">.</span><span class="ident" id="7233601"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><span class="op" id="7233602">,</span>&nbsp;<span class="ident" id="7233604"><a href="/gostd/net/rpc/server_test.go.html#7233519">args</a></span><span class="op" id="7233608">.</span><span class="ident" id="7233609"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7233610">+</span><span class="ident" id="7233611"><a href="/gostd/net/rpc/server_test.go.html#7233519">args</a></span><span class="op" id="7233615">.</span><span class="ident" id="7233616"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><span class="op" id="7233617">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7233620">return</span>&nbsp;<span class="builtintype" id="7233627">nil</span><br>
<span class="lineno"></span><span class="op" id="7233631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7233634">func</span>&nbsp;<span class="op" id="7233639">(</span><span class="ident" id="7233640">t</span>&nbsp;<span class="op" id="7233642">*</span><span class="ident" id="7233643"><a href="/gostd/net/rpc/server_test.go.html#7233052">Arith</a></span><span class="op" id="7233648">)</span>&nbsp;<span class="ident" id="7233650">Scan</span><span class="op" id="7233654">(</span><span class="ident" id="7233655">args</span>&nbsp;<span class="builtintype" id="7233660">string</span><span class="op" id="7233666">,</span>&nbsp;<span class="ident" id="7233668">reply</span>&nbsp;<span class="op" id="7233674">*</span><span class="ident" id="7233675"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7233680">)</span>&nbsp;<span class="op" id="7233682">(</span><span class="ident" id="7233683">err</span>&nbsp;<span class="builtintype" id="7233687">error</span><span class="op" id="7233692">)</span>&nbsp;<span class="op" id="7233694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7233697">_</span><span class="op" id="7233698">,</span>&nbsp;<span class="ident" id="7233700"><a href="/gostd/net/rpc/server_test.go.html#7233683">err</a></span>&nbsp;<span class="op" id="7233704">=</span>&nbsp;<span class="ident" id="7233706"><a href="/gostd/net/rpc/server_test.go.html#7232689">fmt</a></span><span class="op" id="7233709">.</span><span class="ident" id="7233710"><a href="/gostd/fmt/scan.go.html#2172550">Sscan</a></span><span class="op" id="7233715">(</span><span class="ident" id="7233716"><a href="/gostd/net/rpc/server_test.go.html#7233655">args</a></span><span class="op" id="7233720">,</span>&nbsp;<span class="op" id="7233722">&amp;</span><span class="ident" id="7233723"><a href="/gostd/net/rpc/server_test.go.html#7233668">reply</a></span><span class="op" id="7233728">.</span><span class="ident" id="7233729"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span><span class="op" id="7233730">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7233733">return</span><br>
<span class="lineno"></span><span class="op" id="7233740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7233743">func</span>&nbsp;<span class="op" id="7233748">(</span><span class="ident" id="7233749">t</span>&nbsp;<span class="op" id="7233751">*</span><span class="ident" id="7233752"><a href="/gostd/net/rpc/server_test.go.html#7233052">Arith</a></span><span class="op" id="7233757">)</span>&nbsp;<span class="ident" id="7233759">Error</span><span class="op" id="7233764">(</span><span class="ident" id="7233765">args</span>&nbsp;<span class="op" id="7233770">*</span><span class="ident" id="7233771"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7233775">,</span>&nbsp;<span class="ident" id="7233777">reply</span>&nbsp;<span class="op" id="7233783">*</span><span class="ident" id="7233784"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7233789">)</span>&nbsp;<span class="builtintype" id="7233791">error</span>&nbsp;<span class="op" id="7233797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7233800">panic</span><span class="op" id="7233805">(</span><span class="string" id="7233806">&#34;ERROR&#34;</span><span class="op" id="7233813">)</span><br>
<span class="lineno">75</span><span class="op" id="7233815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7233818">func</span>&nbsp;<span class="ident" id="7233823">listenTCP</span><span class="op" id="7233832">(</span><span class="op" id="7233833">)</span>&nbsp;<span class="op" id="7233835">(</span><span class="ident" id="7233836"><a href="/gostd/net/rpc/server_test.go.html#7232709">net</a></span><span class="op" id="7233839">.</span><span class="ident" id="7233840"><a href="/gostd/net/net.go.html#3340703">Listener</a></span><span class="op" id="7233848">,</span>&nbsp;<span class="builtintype" id="7233850">string</span><span class="op" id="7233856">)</span>&nbsp;<span class="op" id="7233858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7233861">l</span><span class="op" id="7233862">,</span>&nbsp;<span class="ident" id="7233864">e</span>&nbsp;<span class="op" id="7233866">:=</span>&nbsp;<span class="ident" id="7233869"><a href="/gostd/net/rpc/server_test.go.html#7232709">net</a></span><span class="op" id="7233872">.</span><span class="ident" id="7233873"><a href="/gostd/net/dial.go.html#3207117">Listen</a></span><span class="op" id="7233879">(</span><span class="string" id="7233880">&#34;tcp&#34;</span><span class="op" id="7233885">,</span>&nbsp;<span class="string" id="7233887">&#34;127.0.0.1:0&#34;</span><span class="op" id="7233900">)</span>&nbsp;<span class="comment" id="7233902">//&nbsp;any&nbsp;available&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7233928">if</span>&nbsp;<span class="ident" id="7233931"><a href="/gostd/net/rpc/server_test.go.html#7233864">e</a></span>&nbsp;<span class="op" id="7233933">!=</span>&nbsp;<span class="builtintype" id="7233936">nil</span>&nbsp;<span class="op" id="7233940">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7233944"><a href="/gostd/net/rpc/server_test.go.html#7232702">log</a></span><span class="op" id="7233947">.</span><span class="ident" id="7233948"><a href="/gostd/log/log.go.html#4079156">Fatalf</a></span><span class="op" id="7233954">(</span><span class="string" id="7233955">&#34;net.Listen&nbsp;tcp&nbsp;:0:&nbsp;%v&#34;</span><span class="op" id="7233978">,</span>&nbsp;<span class="ident" id="7233980"><a href="/gostd/net/rpc/server_test.go.html#7233864">e</a></span><span class="op" id="7233981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7233984">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7233987">return</span>&nbsp;<span class="ident" id="7233994"><a href="/gostd/net/rpc/server_test.go.html#7233861">l</a></span><span class="op" id="7233995">,</span>&nbsp;<span class="ident" id="7233997"><a href="/gostd/net/rpc/server_test.go.html#7233861">l</a></span><span class="op" id="7233998">.</span><span class="ident" id="7233999"><a href="/gostd/net/net.go.html#3340993">Addr</a></span><span class="op" id="7234003">(</span><span class="op" id="7234004">)</span><span class="op" id="7234005">.</span><span class="ident" id="7234006"><a href="/gostd/net/net.go.html#3334238">String</a></span><span class="op" id="7234012">(</span><span class="op" id="7234013">)</span><br>
<span class="lineno"></span><span class="op" id="7234015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="7234018">func</span>&nbsp;<span class="ident" id="7234023">startServer</span><span class="op" id="7234034">(</span><span class="op" id="7234035">)</span>&nbsp;<span class="op" id="7234037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234040"><a href="/gostd/net/rpc/server.go.html#5290520">Register</a></span><span class="op" id="7234048">(</span><span class="builtinfunc" id="7234049">new</span><span class="op" id="7234052">(</span><span class="ident" id="7234053"><a href="/gostd/net/rpc/server_test.go.html#7233052">Arith</a></span><span class="op" id="7234058">)</span><span class="op" id="7234059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234062"><a href="/gostd/net/rpc/server.go.html#5290716">RegisterName</a></span><span class="op" id="7234074">(</span><span class="string" id="7234075">&#34;net.rpc.Arith&#34;</span><span class="op" id="7234090">,</span>&nbsp;<span class="builtinfunc" id="7234092">new</span><span class="op" id="7234095">(</span><span class="ident" id="7234096"><a href="/gostd/net/rpc/server_test.go.html#7233052">Arith</a></span><span class="op" id="7234101">)</span><span class="op" id="7234102">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7234106">var</span>&nbsp;<span class="ident" id="7234110">l</span>&nbsp;<span class="ident" id="7234112"><a href="/gostd/net/rpc/server_test.go.html#7232709">net</a></span><span class="op" id="7234115">.</span><span class="ident" id="7234116"><a href="/gostd/net/net.go.html#3340703">Listener</a></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234126"><a href="/gostd/net/rpc/server_test.go.html#7234110">l</a></span><span class="op" id="7234127">,</span>&nbsp;<span class="ident" id="7234129"><a href="/gostd/net/rpc/server_test.go.html#7232845">serverAddr</a></span>&nbsp;<span class="op" id="7234140">=</span>&nbsp;<span class="ident" id="7234142"><a href="/gostd/net/rpc/server_test.go.html#7233823">listenTCP</a></span><span class="op" id="7234151">(</span><span class="op" id="7234152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234155"><a href="/gostd/net/rpc/server_test.go.html#7232702">log</a></span><span class="op" id="7234158">.</span><span class="ident" id="7234159"><a href="/gostd/log/log.go.html#4078868">Println</a></span><span class="op" id="7234166">(</span><span class="string" id="7234167">&#34;Test&nbsp;RPC&nbsp;server&nbsp;listening&nbsp;on&#34;</span><span class="op" id="7234197">,</span>&nbsp;<span class="ident" id="7234199"><a href="/gostd/net/rpc/server_test.go.html#7232845">serverAddr</a></span><span class="op" id="7234209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7234212">go</span>&nbsp;<span class="ident" id="7234215"><a href="/gostd/net/rpc/server.go.html#5292491">Accept</a></span><span class="op" id="7234221">(</span><span class="ident" id="7234222"><a href="/gostd/net/rpc/server_test.go.html#7234110">l</a></span><span class="op" id="7234223">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234227"><a href="/gostd/net/rpc/server.go.html#5293751">HandleHTTP</a></span><span class="op" id="7234237">(</span><span class="op" id="7234238">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234241"><a href="/gostd/net/rpc/server_test.go.html#7232928">httpOnce</a></span><span class="op" id="7234249">.</span><span class="ident" id="7234250"><a href="/gostd/sync/once.go.html#1447110">Do</a></span><span class="op" id="7234252">(</span><span class="ident" id="7234253"><a href="/gostd/net/rpc/server_test.go.html#7234691">startHttpServer</a></span><span class="op" id="7234268">)</span><br>
<span class="lineno"></span><span class="op" id="7234270">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7234273">func</span>&nbsp;<span class="ident" id="7234278">startNewServer</span><span class="op" id="7234292">(</span><span class="op" id="7234293">)</span>&nbsp;<span class="op" id="7234295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234298"><a href="/gostd/net/rpc/server_test.go.html#7232810">newServer</a></span>&nbsp;<span class="op" id="7234308">=</span>&nbsp;<span class="ident" id="7234310"><a href="/gostd/net/rpc/server.go.html#5278264">NewServer</a></span><span class="op" id="7234319">(</span><span class="op" id="7234320">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234323"><a href="/gostd/net/rpc/server_test.go.html#7232810">newServer</a></span><span class="op" id="7234332">.</span><span class="ident" id="7234333"><a href="/gostd/net/rpc/server.go.html#5279421">Register</a></span><span class="op" id="7234341">(</span><span class="builtinfunc" id="7234342">new</span><span class="op" id="7234345">(</span><span class="ident" id="7234346"><a href="/gostd/net/rpc/server_test.go.html#7233052">Arith</a></span><span class="op" id="7234351">)</span><span class="op" id="7234352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234355"><a href="/gostd/net/rpc/server_test.go.html#7232810">newServer</a></span><span class="op" id="7234364">.</span><span class="ident" id="7234365"><a href="/gostd/net/rpc/server.go.html#5279639">RegisterName</a></span><span class="op" id="7234377">(</span><span class="string" id="7234378">&#34;net.rpc.Arith&#34;</span><span class="op" id="7234393">,</span>&nbsp;<span class="builtinfunc" id="7234395">new</span><span class="op" id="7234398">(</span><span class="ident" id="7234399"><a href="/gostd/net/rpc/server_test.go.html#7233052">Arith</a></span><span class="op" id="7234404">)</span><span class="op" id="7234405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234408"><a href="/gostd/net/rpc/server_test.go.html#7232810">newServer</a></span><span class="op" id="7234417">.</span><span class="ident" id="7234418"><a href="/gostd/net/rpc/server.go.html#5279639">RegisterName</a></span><span class="op" id="7234430">(</span><span class="string" id="7234431">&#34;newServer.Arith&#34;</span><span class="op" id="7234448">,</span>&nbsp;<span class="builtinfunc" id="7234450">new</span><span class="op" id="7234453">(</span><span class="ident" id="7234454"><a href="/gostd/net/rpc/server_test.go.html#7233052">Arith</a></span><span class="op" id="7234459">)</span><span class="op" id="7234460">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7234464">var</span>&nbsp;<span class="ident" id="7234468">l</span>&nbsp;<span class="ident" id="7234470"><a href="/gostd/net/rpc/server_test.go.html#7232709">net</a></span><span class="op" id="7234473">.</span><span class="ident" id="7234474"><a href="/gostd/net/net.go.html#3340703">Listener</a></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234484"><a href="/gostd/net/rpc/server_test.go.html#7234468">l</a></span><span class="op" id="7234485">,</span>&nbsp;<span class="ident" id="7234487"><a href="/gostd/net/rpc/server_test.go.html#7232857">newServerAddr</a></span>&nbsp;<span class="op" id="7234501">=</span>&nbsp;<span class="ident" id="7234503"><a href="/gostd/net/rpc/server_test.go.html#7233823">listenTCP</a></span><span class="op" id="7234512">(</span><span class="op" id="7234513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234516"><a href="/gostd/net/rpc/server_test.go.html#7232702">log</a></span><span class="op" id="7234519">.</span><span class="ident" id="7234520"><a href="/gostd/log/log.go.html#4078868">Println</a></span><span class="op" id="7234527">(</span><span class="string" id="7234528">&#34;NewServer&nbsp;test&nbsp;RPC&nbsp;server&nbsp;listening&nbsp;on&#34;</span><span class="op" id="7234568">,</span>&nbsp;<span class="ident" id="7234570"><a href="/gostd/net/rpc/server_test.go.html#7232857">newServerAddr</a></span><span class="op" id="7234583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7234586">go</span>&nbsp;<span class="ident" id="7234589"><a href="/gostd/net/rpc/server_test.go.html#7232810">newServer</a></span><span class="op" id="7234598">.</span><span class="ident" id="7234599"><a href="/gostd/net/rpc/server.go.html#5290264">Accept</a></span><span class="op" id="7234605">(</span><span class="ident" id="7234606"><a href="/gostd/net/rpc/server_test.go.html#7234468">l</a></span><span class="op" id="7234607">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234611"><a href="/gostd/net/rpc/server_test.go.html#7232810">newServer</a></span><span class="op" id="7234620">.</span><span class="ident" id="7234621"><a href="/gostd/net/rpc/server.go.html#5293412">HandleHTTP</a></span><span class="op" id="7234631">(</span><span class="ident" id="7234632"><a href="/gostd/net/rpc/server_test.go.html#7232961">newHttpPath</a></span><span class="op" id="7234643">,</span>&nbsp;<span class="string" id="7234645">&#34;/bar&#34;</span><span class="op" id="7234651">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234654"><a href="/gostd/net/rpc/server_test.go.html#7232928">httpOnce</a></span><span class="op" id="7234662">.</span><span class="ident" id="7234663"><a href="/gostd/sync/once.go.html#1447110">Do</a></span><span class="op" id="7234665">(</span><span class="ident" id="7234666"><a href="/gostd/net/rpc/server_test.go.html#7234691">startHttpServer</a></span><span class="op" id="7234681">)</span><br>
<span class="lineno"></span><span class="op" id="7234683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7234686">func</span>&nbsp;<span class="ident" id="7234691">startHttpServer</span><span class="op" id="7234706">(</span><span class="op" id="7234707">)</span>&nbsp;<span class="op" id="7234709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234712">server</span>&nbsp;<span class="op" id="7234719">:=</span>&nbsp;<span class="ident" id="7234722"><a href="/gostd/net/rpc/server_test.go.html#7232716">httptest</a></span><span class="op" id="7234730">.</span><span class="ident" id="7234731"><a href="/gostd/net/http/httptest/server.go.html#6135832">NewServer</a></span><span class="op" id="7234740">(</span><span class="builtintype" id="7234741">nil</span><span class="op" id="7234744">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234747"><a href="/gostd/net/rpc/server_test.go.html#7232879">httpServerAddr</a></span>&nbsp;<span class="op" id="7234762">=</span>&nbsp;<span class="ident" id="7234764"><a href="/gostd/net/rpc/server_test.go.html#7234712">server</a></span><span class="op" id="7234770">.</span><span class="ident" id="7234771"><a href="/gostd/net/http/httptest/server.go.html#6134105">Listener</a></span><span class="op" id="7234779">.</span><span class="ident" id="7234780"><a href="/gostd/net/net.go.html#3340993">Addr</a></span><span class="op" id="7234784">(</span><span class="op" id="7234785">)</span><span class="op" id="7234786">.</span><span class="ident" id="7234787"><a href="/gostd/net/net.go.html#3334238">String</a></span><span class="op" id="7234793">(</span><span class="op" id="7234794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234797"><a href="/gostd/net/rpc/server_test.go.html#7232702">log</a></span><span class="op" id="7234800">.</span><span class="ident" id="7234801"><a href="/gostd/log/log.go.html#4078868">Println</a></span><span class="op" id="7234808">(</span><span class="string" id="7234809">&#34;Test&nbsp;HTTP&nbsp;RPC&nbsp;server&nbsp;listening&nbsp;on&#34;</span><span class="op" id="7234844">,</span>&nbsp;<span class="ident" id="7234846"><a href="/gostd/net/rpc/server_test.go.html#7232879">httpServerAddr</a></span><span class="op" id="7234860">)</span><br>
<span class="lineno"></span><span class="op" id="7234862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7234865">func</span>&nbsp;<span class="ident" id="7234870">TestRPC</span><span class="op" id="7234877">(</span><span class="ident" id="7234878">t</span>&nbsp;<span class="op" id="7234880">*</span><span class="ident" id="7234881"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7234888">.</span><span class="ident" id="7234889"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7234890">)</span>&nbsp;<span class="op" id="7234892">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234895"><a href="/gostd/net/rpc/server_test.go.html#7232913">once</a></span><span class="op" id="7234899">.</span><span class="ident" id="7234900"><a href="/gostd/sync/once.go.html#1447110">Do</a></span><span class="op" id="7234902">(</span><span class="ident" id="7234903"><a href="/gostd/net/rpc/server_test.go.html#7234023">startServer</a></span><span class="op" id="7234914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234917"><a href="/gostd/net/rpc/server_test.go.html#7235039">testRPC</a></span><span class="op" id="7234924">(</span><span class="ident" id="7234925"><a href="/gostd/net/rpc/server_test.go.html#7234878">t</a></span><span class="op" id="7234926">,</span>&nbsp;<span class="ident" id="7234928"><a href="/gostd/net/rpc/server_test.go.html#7232845">serverAddr</a></span><span class="op" id="7234938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234941"><a href="/gostd/net/rpc/server_test.go.html#7232919">newOnce</a></span><span class="op" id="7234948">.</span><span class="ident" id="7234949"><a href="/gostd/sync/once.go.html#1447110">Do</a></span><span class="op" id="7234951">(</span><span class="ident" id="7234952"><a href="/gostd/net/rpc/server_test.go.html#7234278">startNewServer</a></span><span class="op" id="7234966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234969"><a href="/gostd/net/rpc/server_test.go.html#7235039">testRPC</a></span><span class="op" id="7234976">(</span><span class="ident" id="7234977"><a href="/gostd/net/rpc/server_test.go.html#7234878">t</a></span><span class="op" id="7234978">,</span>&nbsp;<span class="ident" id="7234980"><a href="/gostd/net/rpc/server_test.go.html#7232857">newServerAddr</a></span><span class="op" id="7234993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7234996"><a href="/gostd/net/rpc/server_test.go.html#7238618">testNewServerRPC</a></span><span class="op" id="7235012">(</span><span class="ident" id="7235013"><a href="/gostd/net/rpc/server_test.go.html#7234878">t</a></span><span class="op" id="7235014">,</span>&nbsp;<span class="ident" id="7235016"><a href="/gostd/net/rpc/server_test.go.html#7232857">newServerAddr</a></span><span class="op" id="7235029">)</span><br>
<span class="lineno">125</span><span class="op" id="7235031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7235034">func</span>&nbsp;<span class="ident" id="7235039">testRPC</span><span class="op" id="7235046">(</span><span class="ident" id="7235047">t</span>&nbsp;<span class="op" id="7235049">*</span><span class="ident" id="7235050"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7235057">.</span><span class="ident" id="7235058"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7235059">,</span>&nbsp;<span class="ident" id="7235061">addr</span>&nbsp;<span class="builtintype" id="7235066">string</span><span class="op" id="7235072">)</span>&nbsp;<span class="op" id="7235074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7235077">client</span><span class="op" id="7235083">,</span>&nbsp;<span class="ident" id="7235085">err</span>&nbsp;<span class="op" id="7235089">:=</span>&nbsp;<span class="ident" id="7235092"><a href="/gostd/net/rpc/client.go.html#5268500">Dial</a></span><span class="op" id="7235096">(</span><span class="string" id="7235097">&#34;tcp&#34;</span><span class="op" id="7235102">,</span>&nbsp;<span class="ident" id="7235104"><a href="/gostd/net/rpc/server_test.go.html#7235061">addr</a></span><span class="op" id="7235108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7235111">if</span>&nbsp;<span class="ident" id="7235114"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span>&nbsp;<span class="op" id="7235118">!=</span>&nbsp;<span class="builtintype" id="7235121">nil</span>&nbsp;<span class="op" id="7235125">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7235129"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7235130">.</span><span class="ident" id="7235131"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7235136">(</span><span class="string" id="7235137">&#34;dialing&#34;</span><span class="op" id="7235146">,</span>&nbsp;<span class="ident" id="7235148"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span><span class="op" id="7235151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7235154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7235157">defer</span>&nbsp;<span class="ident" id="7235163"><a href="/gostd/net/rpc/server_test.go.html#7235077">client</a></span><span class="op" id="7235169">.</span><span class="ident" id="7235170"><a href="/gostd/net/rpc/client.go.html#5268682">Close</a></span><span class="op" id="7235175">(</span><span class="op" id="7235176">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7235180">//&nbsp;Synchronous&nbsp;calls</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7235202">args</span>&nbsp;<span class="op" id="7235207">:=</span>&nbsp;<span class="op" id="7235210">&amp;</span><span class="ident" id="7235211"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7235215">{</span><span class="num" id="7235216">7</span><span class="op" id="7235217">,</span>&nbsp;<span class="num" id="7235219">8</span><span class="op" id="7235220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7235223">reply</span>&nbsp;<span class="op" id="7235229">:=</span>&nbsp;<span class="builtinfunc" id="7235232">new</span><span class="op" id="7235235">(</span><span class="ident" id="7235236"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7235241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7235244"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span>&nbsp;<span class="op" id="7235248">=</span>&nbsp;<span class="ident" id="7235250"><a href="/gostd/net/rpc/server_test.go.html#7235077">client</a></span><span class="op" id="7235256">.</span><span class="ident" id="7235257"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="7235261">(</span><span class="string" id="7235262">&#34;Arith.Add&#34;</span><span class="op" id="7235273">,</span>&nbsp;<span class="ident" id="7235275"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7235279">,</span>&nbsp;<span class="ident" id="7235281"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span><span class="op" id="7235286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7235289">if</span>&nbsp;<span class="ident" id="7235292"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span>&nbsp;<span class="op" id="7235296">!=</span>&nbsp;<span class="builtintype" id="7235299">nil</span>&nbsp;<span class="op" id="7235303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7235307"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7235308">.</span><span class="ident" id="7235309"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7235315">(</span><span class="string" id="7235316">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7235358">,</span>&nbsp;<span class="ident" id="7235360"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span><span class="op" id="7235363">.</span><span class="ident" id="7235364">Error</span><span class="op" id="7235369">(</span><span class="op" id="7235370">)</span><span class="op" id="7235371">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7235374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7235377">if</span>&nbsp;<span class="ident" id="7235380"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span><span class="op" id="7235385">.</span><span class="ident" id="7235386"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span>&nbsp;<span class="op" id="7235388">!=</span>&nbsp;<span class="ident" id="7235391"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7235395">.</span><span class="ident" id="7235396"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7235397">+</span><span class="ident" id="7235398"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7235402">.</span><span class="ident" id="7235403"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span>&nbsp;<span class="op" id="7235405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7235409"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7235410">.</span><span class="ident" id="7235411"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7235417">(</span><span class="string" id="7235418">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7235443">,</span>&nbsp;<span class="ident" id="7235445"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span><span class="op" id="7235450">.</span><span class="ident" id="7235451"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span><span class="op" id="7235452">,</span>&nbsp;<span class="ident" id="7235454"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7235458">.</span><span class="ident" id="7235459"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7235460">+</span><span class="ident" id="7235461"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7235465">.</span><span class="ident" id="7235466"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><span class="op" id="7235467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7235470">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7235474">//&nbsp;Nonexistent&nbsp;method</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7235497"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span>&nbsp;<span class="op" id="7235502">=</span>&nbsp;<span class="op" id="7235504">&amp;</span><span class="ident" id="7235505"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7235509">{</span><span class="num" id="7235510">7</span><span class="op" id="7235511">,</span>&nbsp;<span class="num" id="7235513">0</span><span class="op" id="7235514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7235517"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span>&nbsp;<span class="op" id="7235523">=</span>&nbsp;<span class="builtinfunc" id="7235525">new</span><span class="op" id="7235528">(</span><span class="ident" id="7235529"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7235534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7235537"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span>&nbsp;<span class="op" id="7235541">=</span>&nbsp;<span class="ident" id="7235543"><a href="/gostd/net/rpc/server_test.go.html#7235077">client</a></span><span class="op" id="7235549">.</span><span class="ident" id="7235550"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="7235554">(</span><span class="string" id="7235555">&#34;Arith.BadOperation&#34;</span><span class="op" id="7235575">,</span>&nbsp;<span class="ident" id="7235577"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7235581">,</span>&nbsp;<span class="ident" id="7235583"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span><span class="op" id="7235588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7235591">//&nbsp;expect&nbsp;an&nbsp;error</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7235611">if</span>&nbsp;<span class="ident" id="7235614"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span>&nbsp;<span class="op" id="7235618">==</span>&nbsp;<span class="builtintype" id="7235621">nil</span>&nbsp;<span class="op" id="7235625">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7235629"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7235630">.</span><span class="ident" id="7235631"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7235636">(</span><span class="string" id="7235637">&#34;BadOperation:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="7235667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7235670">}</span>&nbsp;<span class="keyword" id="7235672">else</span>&nbsp;<span class="keyword" id="7235677">if</span>&nbsp;<span class="op" id="7235680">!</span><span class="ident" id="7235681"><a href="/gostd/net/rpc/server_test.go.html#7232748">strings</a></span><span class="op" id="7235688">.</span><span class="ident" id="7235689"><a href="/gostd/strings/strings.go.html#2975366">HasPrefix</a></span><span class="op" id="7235698">(</span><span class="ident" id="7235699"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span><span class="op" id="7235702">.</span><span class="ident" id="7235703">Error</span><span class="op" id="7235708">(</span><span class="op" id="7235709">)</span><span class="op" id="7235710">,</span>&nbsp;<span class="string" id="7235712">&#34;rpc:&nbsp;can&#39;t&nbsp;find&nbsp;method&nbsp;&#34;</span><span class="op" id="7235737">)</span>&nbsp;<span class="op" id="7235739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7235743"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7235744">.</span><span class="ident" id="7235745"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7235751">(</span><span class="string" id="7235752">&#34;BadOperation:&nbsp;expected&nbsp;can&#39;t&nbsp;find&nbsp;method&nbsp;error;&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7235808">,</span>&nbsp;<span class="ident" id="7235810"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span><span class="op" id="7235813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7235816">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7235820">//&nbsp;Unknown&nbsp;service</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7235840"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span>&nbsp;<span class="op" id="7235845">=</span>&nbsp;<span class="op" id="7235847">&amp;</span><span class="ident" id="7235848"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7235852">{</span><span class="num" id="7235853">7</span><span class="op" id="7235854">,</span>&nbsp;<span class="num" id="7235856">8</span><span class="op" id="7235857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7235860"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span>&nbsp;<span class="op" id="7235866">=</span>&nbsp;<span class="builtinfunc" id="7235868">new</span><span class="op" id="7235871">(</span><span class="ident" id="7235872"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7235877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7235880"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span>&nbsp;<span class="op" id="7235884">=</span>&nbsp;<span class="ident" id="7235886"><a href="/gostd/net/rpc/server_test.go.html#7235077">client</a></span><span class="op" id="7235892">.</span><span class="ident" id="7235893"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="7235897">(</span><span class="string" id="7235898">&#34;Arith.Unknown&#34;</span><span class="op" id="7235913">,</span>&nbsp;<span class="ident" id="7235915"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7235919">,</span>&nbsp;<span class="ident" id="7235921"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span><span class="op" id="7235926">)</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7235929">if</span>&nbsp;<span class="ident" id="7235932"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span>&nbsp;<span class="op" id="7235936">==</span>&nbsp;<span class="builtintype" id="7235939">nil</span>&nbsp;<span class="op" id="7235943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7235947"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7235948">.</span><span class="ident" id="7235949"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7235954">(</span><span class="string" id="7235955">&#34;expected&nbsp;error&nbsp;calling&nbsp;unknown&nbsp;service&#34;</span><span class="op" id="7235995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7235998">}</span>&nbsp;<span class="keyword" id="7236000">else</span>&nbsp;<span class="keyword" id="7236005">if</span>&nbsp;<span class="ident" id="7236008"><a href="/gostd/net/rpc/server_test.go.html#7232748">strings</a></span><span class="op" id="7236015">.</span><span class="ident" id="7236016"><a href="/gostd/strings/strings.go.html#2968883">Index</a></span><span class="op" id="7236021">(</span><span class="ident" id="7236022"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span><span class="op" id="7236025">.</span><span class="ident" id="7236026">Error</span><span class="op" id="7236031">(</span><span class="op" id="7236032">)</span><span class="op" id="7236033">,</span>&nbsp;<span class="string" id="7236035">&#34;method&#34;</span><span class="op" id="7236043">)</span>&nbsp;<span class="op" id="7236045">&lt;</span>&nbsp;<span class="num" id="7236047">0</span>&nbsp;<span class="op" id="7236049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7236053"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7236054">.</span><span class="ident" id="7236055"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7236060">(</span><span class="string" id="7236061">&#34;expected&nbsp;error&nbsp;about&nbsp;method;&nbsp;got&#34;</span><span class="op" id="7236095">,</span>&nbsp;<span class="ident" id="7236097"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span><span class="op" id="7236100">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7236103">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7236107">//&nbsp;Out&nbsp;of&nbsp;order.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7236125"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span>&nbsp;<span class="op" id="7236130">=</span>&nbsp;<span class="op" id="7236132">&amp;</span><span class="ident" id="7236133"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7236137">{</span><span class="num" id="7236138">7</span><span class="op" id="7236139">,</span>&nbsp;<span class="num" id="7236141">8</span><span class="op" id="7236142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7236145">mulReply</span>&nbsp;<span class="op" id="7236154">:=</span>&nbsp;<span class="builtinfunc" id="7236157">new</span><span class="op" id="7236160">(</span><span class="ident" id="7236161"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7236166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7236169">mulCall</span>&nbsp;<span class="op" id="7236177">:=</span>&nbsp;<span class="ident" id="7236180"><a href="/gostd/net/rpc/server_test.go.html#7235077">client</a></span><span class="op" id="7236186">.</span><span class="ident" id="7236187"><a href="/gostd/net/rpc/client.go.html#5269205">Go</a></span><span class="op" id="7236189">(</span><span class="string" id="7236190">&#34;Arith.Mul&#34;</span><span class="op" id="7236201">,</span>&nbsp;<span class="ident" id="7236203"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7236207">,</span>&nbsp;<span class="ident" id="7236209"><a href="/gostd/net/rpc/server_test.go.html#7236145">mulReply</a></span><span class="op" id="7236217">,</span>&nbsp;<span class="builtintype" id="7236219">nil</span><span class="op" id="7236222">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7236225">addReply</span>&nbsp;<span class="op" id="7236234">:=</span>&nbsp;<span class="builtinfunc" id="7236237">new</span><span class="op" id="7236240">(</span><span class="ident" id="7236241"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7236246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7236249">addCall</span>&nbsp;<span class="op" id="7236257">:=</span>&nbsp;<span class="ident" id="7236260"><a href="/gostd/net/rpc/server_test.go.html#7235077">client</a></span><span class="op" id="7236266">.</span><span class="ident" id="7236267"><a href="/gostd/net/rpc/client.go.html#5269205">Go</a></span><span class="op" id="7236269">(</span><span class="string" id="7236270">&#34;Arith.Add&#34;</span><span class="op" id="7236281">,</span>&nbsp;<span class="ident" id="7236283"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7236287">,</span>&nbsp;<span class="ident" id="7236289"><a href="/gostd/net/rpc/server_test.go.html#7236225">addReply</a></span><span class="op" id="7236297">,</span>&nbsp;<span class="builtintype" id="7236299">nil</span><span class="op" id="7236302">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7236306"><a href="/gostd/net/rpc/server_test.go.html#7236249">addCall</a></span>&nbsp;<span class="op" id="7236314">=</span>&nbsp;<span class="op" id="7236316">&lt;-</span><span class="ident" id="7236318"><a href="/gostd/net/rpc/server_test.go.html#7236249">addCall</a></span><span class="op" id="7236325">.</span><span class="ident" id="7236326"><a href="/gostd/net/rpc/client.go.html#5262112">Done</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7236332">if</span>&nbsp;<span class="ident" id="7236335"><a href="/gostd/net/rpc/server_test.go.html#7236249">addCall</a></span><span class="op" id="7236342">.</span><span class="ident" id="7236343"><a href="/gostd/net/rpc/client.go.html#5262046">Error</a></span>&nbsp;<span class="op" id="7236349">!=</span>&nbsp;<span class="builtintype" id="7236352">nil</span>&nbsp;<span class="op" id="7236356">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7236360"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7236361">.</span><span class="ident" id="7236362"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7236368">(</span><span class="string" id="7236369">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7236411">,</span>&nbsp;<span class="ident" id="7236413"><a href="/gostd/net/rpc/server_test.go.html#7236249">addCall</a></span><span class="op" id="7236420">.</span><span class="ident" id="7236421"><a href="/gostd/net/rpc/client.go.html#5262046">Error</a></span><span class="op" id="7236426">.</span><span class="ident" id="7236427">Error</span><span class="op" id="7236432">(</span><span class="op" id="7236433">)</span><span class="op" id="7236434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7236437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7236440">if</span>&nbsp;<span class="ident" id="7236443"><a href="/gostd/net/rpc/server_test.go.html#7236225">addReply</a></span><span class="op" id="7236451">.</span><span class="ident" id="7236452"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span>&nbsp;<span class="op" id="7236454">!=</span>&nbsp;<span class="ident" id="7236457"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7236461">.</span><span class="ident" id="7236462"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7236463">+</span><span class="ident" id="7236464"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7236468">.</span><span class="ident" id="7236469"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span>&nbsp;<span class="op" id="7236471">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7236475"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7236476">.</span><span class="ident" id="7236477"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7236483">(</span><span class="string" id="7236484">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7236509">,</span>&nbsp;<span class="ident" id="7236511"><a href="/gostd/net/rpc/server_test.go.html#7236225">addReply</a></span><span class="op" id="7236519">.</span><span class="ident" id="7236520"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span><span class="op" id="7236521">,</span>&nbsp;<span class="ident" id="7236523"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7236527">.</span><span class="ident" id="7236528"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7236529">+</span><span class="ident" id="7236530"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7236534">.</span><span class="ident" id="7236535"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><span class="op" id="7236536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7236539">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7236543"><a href="/gostd/net/rpc/server_test.go.html#7236169">mulCall</a></span>&nbsp;<span class="op" id="7236551">=</span>&nbsp;<span class="op" id="7236553">&lt;-</span><span class="ident" id="7236555"><a href="/gostd/net/rpc/server_test.go.html#7236169">mulCall</a></span><span class="op" id="7236562">.</span><span class="ident" id="7236563"><a href="/gostd/net/rpc/client.go.html#5262112">Done</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7236569">if</span>&nbsp;<span class="ident" id="7236572"><a href="/gostd/net/rpc/server_test.go.html#7236169">mulCall</a></span><span class="op" id="7236579">.</span><span class="ident" id="7236580"><a href="/gostd/net/rpc/client.go.html#5262046">Error</a></span>&nbsp;<span class="op" id="7236586">!=</span>&nbsp;<span class="builtintype" id="7236589">nil</span>&nbsp;<span class="op" id="7236593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7236597"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7236598">.</span><span class="ident" id="7236599"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7236605">(</span><span class="string" id="7236606">&#34;Mul:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7236648">,</span>&nbsp;<span class="ident" id="7236650"><a href="/gostd/net/rpc/server_test.go.html#7236169">mulCall</a></span><span class="op" id="7236657">.</span><span class="ident" id="7236658"><a href="/gostd/net/rpc/client.go.html#5262046">Error</a></span><span class="op" id="7236663">.</span><span class="ident" id="7236664">Error</span><span class="op" id="7236669">(</span><span class="op" id="7236670">)</span><span class="op" id="7236671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7236674">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7236677">if</span>&nbsp;<span class="ident" id="7236680"><a href="/gostd/net/rpc/server_test.go.html#7236145">mulReply</a></span><span class="op" id="7236688">.</span><span class="ident" id="7236689"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span>&nbsp;<span class="op" id="7236691">!=</span>&nbsp;<span class="ident" id="7236694"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7236698">.</span><span class="ident" id="7236699"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7236700">*</span><span class="ident" id="7236701"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7236705">.</span><span class="ident" id="7236706"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span>&nbsp;<span class="op" id="7236708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7236712"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7236713">.</span><span class="ident" id="7236714"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7236720">(</span><span class="string" id="7236721">&#34;Mul:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7236746">,</span>&nbsp;<span class="ident" id="7236748"><a href="/gostd/net/rpc/server_test.go.html#7236145">mulReply</a></span><span class="op" id="7236756">.</span><span class="ident" id="7236757"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span><span class="op" id="7236758">,</span>&nbsp;<span class="ident" id="7236760"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7236764">.</span><span class="ident" id="7236765"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7236766">*</span><span class="ident" id="7236767"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7236771">.</span><span class="ident" id="7236772"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><span class="op" id="7236773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7236776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7236780">//&nbsp;Error&nbsp;test</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7236795"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span>&nbsp;<span class="op" id="7236800">=</span>&nbsp;<span class="op" id="7236802">&amp;</span><span class="ident" id="7236803"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7236807">{</span><span class="num" id="7236808">7</span><span class="op" id="7236809">,</span>&nbsp;<span class="num" id="7236811">0</span><span class="op" id="7236812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7236815"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span>&nbsp;<span class="op" id="7236821">=</span>&nbsp;<span class="builtinfunc" id="7236823">new</span><span class="op" id="7236826">(</span><span class="ident" id="7236827"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7236832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7236835"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span>&nbsp;<span class="op" id="7236839">=</span>&nbsp;<span class="ident" id="7236841"><a href="/gostd/net/rpc/server_test.go.html#7235077">client</a></span><span class="op" id="7236847">.</span><span class="ident" id="7236848"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="7236852">(</span><span class="string" id="7236853">&#34;Arith.Div&#34;</span><span class="op" id="7236864">,</span>&nbsp;<span class="ident" id="7236866"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7236870">,</span>&nbsp;<span class="ident" id="7236872"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span><span class="op" id="7236877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7236880">//&nbsp;expect&nbsp;an&nbsp;error:&nbsp;zero&nbsp;divide</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7236913">if</span>&nbsp;<span class="ident" id="7236916"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span>&nbsp;<span class="op" id="7236920">==</span>&nbsp;<span class="builtintype" id="7236923">nil</span>&nbsp;<span class="op" id="7236927">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7236931"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7236932">.</span><span class="ident" id="7236933"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7236938">(</span><span class="string" id="7236939">&#34;Div:&nbsp;expected&nbsp;error&#34;</span><span class="op" id="7236960">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7236963">}</span>&nbsp;<span class="keyword" id="7236965">else</span>&nbsp;<span class="keyword" id="7236970">if</span>&nbsp;<span class="ident" id="7236973"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span><span class="op" id="7236976">.</span><span class="ident" id="7236977">Error</span><span class="op" id="7236982">(</span><span class="op" id="7236983">)</span>&nbsp;<span class="op" id="7236985">!=</span>&nbsp;<span class="string" id="7236988">&#34;divide&nbsp;by&nbsp;zero&#34;</span>&nbsp;<span class="op" id="7237005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7237009"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7237010">.</span><span class="ident" id="7237011"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7237016">(</span><span class="string" id="7237017">&#34;Div:&nbsp;expected&nbsp;divide&nbsp;by&nbsp;zero&nbsp;error;&nbsp;got&#34;</span><span class="op" id="7237058">,</span>&nbsp;<span class="ident" id="7237060"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span><span class="op" id="7237063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7237066">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7237070">//&nbsp;Bad&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7237084"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span>&nbsp;<span class="op" id="7237090">=</span>&nbsp;<span class="builtinfunc" id="7237092">new</span><span class="op" id="7237095">(</span><span class="ident" id="7237096"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7237101">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7237104"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span>&nbsp;<span class="op" id="7237108">=</span>&nbsp;<span class="ident" id="7237110"><a href="/gostd/net/rpc/server_test.go.html#7235077">client</a></span><span class="op" id="7237116">.</span><span class="ident" id="7237117"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="7237121">(</span><span class="string" id="7237122">&#34;Arith.Add&#34;</span><span class="op" id="7237133">,</span>&nbsp;<span class="ident" id="7237135"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span><span class="op" id="7237140">,</span>&nbsp;<span class="ident" id="7237142"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span><span class="op" id="7237147">)</span>&nbsp;<span class="comment" id="7237149">//&nbsp;args,&nbsp;reply&nbsp;would&nbsp;be&nbsp;the&nbsp;correct&nbsp;thing&nbsp;to&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7237199">if</span>&nbsp;<span class="ident" id="7237202"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span>&nbsp;<span class="op" id="7237206">==</span>&nbsp;<span class="builtintype" id="7237209">nil</span>&nbsp;<span class="op" id="7237213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7237217"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7237218">.</span><span class="ident" id="7237219"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7237224">(</span><span class="string" id="7237225">&#34;expected&nbsp;error&nbsp;calling&nbsp;Arith.Add&nbsp;with&nbsp;wrong&nbsp;arg&nbsp;type&#34;</span><span class="op" id="7237279">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7237282">}</span>&nbsp;<span class="keyword" id="7237284">else</span>&nbsp;<span class="keyword" id="7237289">if</span>&nbsp;<span class="ident" id="7237292"><a href="/gostd/net/rpc/server_test.go.html#7232748">strings</a></span><span class="op" id="7237299">.</span><span class="ident" id="7237300"><a href="/gostd/strings/strings.go.html#2968883">Index</a></span><span class="op" id="7237305">(</span><span class="ident" id="7237306"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span><span class="op" id="7237309">.</span><span class="ident" id="7237310">Error</span><span class="op" id="7237315">(</span><span class="op" id="7237316">)</span><span class="op" id="7237317">,</span>&nbsp;<span class="string" id="7237319">&#34;type&#34;</span><span class="op" id="7237325">)</span>&nbsp;<span class="op" id="7237327">&lt;</span>&nbsp;<span class="num" id="7237329">0</span>&nbsp;<span class="op" id="7237331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7237335"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7237336">.</span><span class="ident" id="7237337"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7237342">(</span><span class="string" id="7237343">&#34;expected&nbsp;error&nbsp;about&nbsp;type;&nbsp;got&#34;</span><span class="op" id="7237375">,</span>&nbsp;<span class="ident" id="7237377"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span><span class="op" id="7237380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7237383">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7237387">//&nbsp;Non-struct&nbsp;argument</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7237411">const</span>&nbsp;<span class="ident" id="7237417">Val</span>&nbsp;<span class="op" id="7237421">=</span>&nbsp;<span class="num" id="7237423">12345</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7237430">str</span>&nbsp;<span class="op" id="7237434">:=</span>&nbsp;<span class="ident" id="7237437"><a href="/gostd/net/rpc/server_test.go.html#7232689">fmt</a></span><span class="op" id="7237440">.</span><span class="ident" id="7237441"><a href="/gostd/fmt/print.go.html#2144876">Sprint</a></span><span class="op" id="7237447">(</span><span class="ident" id="7237448"><a href="/gostd/net/rpc/server_test.go.html#7237417">Val</a></span><span class="op" id="7237451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7237454"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span>&nbsp;<span class="op" id="7237460">=</span>&nbsp;<span class="builtinfunc" id="7237462">new</span><span class="op" id="7237465">(</span><span class="ident" id="7237466"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7237471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7237474"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span>&nbsp;<span class="op" id="7237478">=</span>&nbsp;<span class="ident" id="7237480"><a href="/gostd/net/rpc/server_test.go.html#7235077">client</a></span><span class="op" id="7237486">.</span><span class="ident" id="7237487"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="7237491">(</span><span class="string" id="7237492">&#34;Arith.Scan&#34;</span><span class="op" id="7237504">,</span>&nbsp;<span class="op" id="7237506">&amp;</span><span class="ident" id="7237507"><a href="/gostd/net/rpc/server_test.go.html#7237430">str</a></span><span class="op" id="7237510">,</span>&nbsp;<span class="ident" id="7237512"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span><span class="op" id="7237517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7237520">if</span>&nbsp;<span class="ident" id="7237523"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span>&nbsp;<span class="op" id="7237527">!=</span>&nbsp;<span class="builtintype" id="7237530">nil</span>&nbsp;<span class="op" id="7237534">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7237538"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7237539">.</span><span class="ident" id="7237540"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7237546">(</span><span class="string" id="7237547">&#34;Scan:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7237590">,</span>&nbsp;<span class="ident" id="7237592"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span><span class="op" id="7237595">.</span><span class="ident" id="7237596">Error</span><span class="op" id="7237601">(</span><span class="op" id="7237602">)</span><span class="op" id="7237603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7237606">}</span>&nbsp;<span class="keyword" id="7237608">else</span>&nbsp;<span class="keyword" id="7237613">if</span>&nbsp;<span class="ident" id="7237616"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span><span class="op" id="7237621">.</span><span class="ident" id="7237622"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span>&nbsp;<span class="op" id="7237624">!=</span>&nbsp;<span class="ident" id="7237627"><a href="/gostd/net/rpc/server_test.go.html#7237417">Val</a></span>&nbsp;<span class="op" id="7237631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7237635"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7237636">.</span><span class="ident" id="7237637"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7237643">(</span><span class="string" id="7237644">&#34;Scan:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7237670">,</span>&nbsp;<span class="ident" id="7237672"><a href="/gostd/net/rpc/server_test.go.html#7237417">Val</a></span><span class="op" id="7237675">,</span>&nbsp;<span class="ident" id="7237677"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span><span class="op" id="7237682">.</span><span class="ident" id="7237683"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span><span class="op" id="7237684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7237687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7237691">//&nbsp;Non-struct&nbsp;reply</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7237712"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span>&nbsp;<span class="op" id="7237717">=</span>&nbsp;<span class="op" id="7237719">&amp;</span><span class="ident" id="7237720"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7237724">{</span><span class="num" id="7237725">27</span><span class="op" id="7237727">,</span>&nbsp;<span class="num" id="7237729">35</span><span class="op" id="7237731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7237734"><a href="/gostd/net/rpc/server_test.go.html#7237430">str</a></span>&nbsp;<span class="op" id="7237738">=</span>&nbsp;<span class="string" id="7237740">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7237744"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span>&nbsp;<span class="op" id="7237748">=</span>&nbsp;<span class="ident" id="7237750"><a href="/gostd/net/rpc/server_test.go.html#7235077">client</a></span><span class="op" id="7237756">.</span><span class="ident" id="7237757"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="7237761">(</span><span class="string" id="7237762">&#34;Arith.String&#34;</span><span class="op" id="7237776">,</span>&nbsp;<span class="ident" id="7237778"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7237782">,</span>&nbsp;<span class="op" id="7237784">&amp;</span><span class="ident" id="7237785"><a href="/gostd/net/rpc/server_test.go.html#7237430">str</a></span><span class="op" id="7237788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7237791">if</span>&nbsp;<span class="ident" id="7237794"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span>&nbsp;<span class="op" id="7237798">!=</span>&nbsp;<span class="builtintype" id="7237801">nil</span>&nbsp;<span class="op" id="7237805">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7237809"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7237810">.</span><span class="ident" id="7237811"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7237817">(</span><span class="string" id="7237818">&#34;String:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7237863">,</span>&nbsp;<span class="ident" id="7237865"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span><span class="op" id="7237868">.</span><span class="ident" id="7237869">Error</span><span class="op" id="7237874">(</span><span class="op" id="7237875">)</span><span class="op" id="7237876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7237879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7237882">expect</span>&nbsp;<span class="op" id="7237889">:=</span>&nbsp;<span class="ident" id="7237892"><a href="/gostd/net/rpc/server_test.go.html#7232689">fmt</a></span><span class="op" id="7237895">.</span><span class="ident" id="7237896"><a href="/gostd/fmt/print.go.html#2143637">Sprintf</a></span><span class="op" id="7237903">(</span><span class="string" id="7237904">&#34;%d+%d=%d&#34;</span><span class="op" id="7237914">,</span>&nbsp;<span class="ident" id="7237916"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7237920">.</span><span class="ident" id="7237921"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7237922">,</span>&nbsp;<span class="ident" id="7237924"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7237928">.</span><span class="ident" id="7237929"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><span class="op" id="7237930">,</span>&nbsp;<span class="ident" id="7237932"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7237936">.</span><span class="ident" id="7237937"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7237938">+</span><span class="ident" id="7237939"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7237943">.</span><span class="ident" id="7237944"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><span class="op" id="7237945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7237948">if</span>&nbsp;<span class="ident" id="7237951"><a href="/gostd/net/rpc/server_test.go.html#7237430">str</a></span>&nbsp;<span class="op" id="7237955">!=</span>&nbsp;<span class="ident" id="7237958"><a href="/gostd/net/rpc/server_test.go.html#7237882">expect</a></span>&nbsp;<span class="op" id="7237965">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7237969"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7237970">.</span><span class="ident" id="7237971"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7237977">(</span><span class="string" id="7237978">&#34;String:&nbsp;expected&nbsp;%s&nbsp;got&nbsp;%s&#34;</span><span class="op" id="7238006">,</span>&nbsp;<span class="ident" id="7238008"><a href="/gostd/net/rpc/server_test.go.html#7237882">expect</a></span><span class="op" id="7238014">,</span>&nbsp;<span class="ident" id="7238016"><a href="/gostd/net/rpc/server_test.go.html#7237430">str</a></span><span class="op" id="7238019">)</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7238022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7238026"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span>&nbsp;<span class="op" id="7238031">=</span>&nbsp;<span class="op" id="7238033">&amp;</span><span class="ident" id="7238034"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7238038">{</span><span class="num" id="7238039">7</span><span class="op" id="7238040">,</span>&nbsp;<span class="num" id="7238042">8</span><span class="op" id="7238043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7238046"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span>&nbsp;<span class="op" id="7238052">=</span>&nbsp;<span class="builtinfunc" id="7238054">new</span><span class="op" id="7238057">(</span><span class="ident" id="7238058"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7238063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7238066"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span>&nbsp;<span class="op" id="7238070">=</span>&nbsp;<span class="ident" id="7238072"><a href="/gostd/net/rpc/server_test.go.html#7235077">client</a></span><span class="op" id="7238078">.</span><span class="ident" id="7238079"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="7238083">(</span><span class="string" id="7238084">&#34;Arith.Mul&#34;</span><span class="op" id="7238095">,</span>&nbsp;<span class="ident" id="7238097"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7238101">,</span>&nbsp;<span class="ident" id="7238103"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span><span class="op" id="7238108">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7238111">if</span>&nbsp;<span class="ident" id="7238114"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span>&nbsp;<span class="op" id="7238118">!=</span>&nbsp;<span class="builtintype" id="7238121">nil</span>&nbsp;<span class="op" id="7238125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7238129"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7238130">.</span><span class="ident" id="7238131"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7238137">(</span><span class="string" id="7238138">&#34;Mul:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7238180">,</span>&nbsp;<span class="ident" id="7238182"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span><span class="op" id="7238185">.</span><span class="ident" id="7238186">Error</span><span class="op" id="7238191">(</span><span class="op" id="7238192">)</span><span class="op" id="7238193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7238196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7238199">if</span>&nbsp;<span class="ident" id="7238202"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span><span class="op" id="7238207">.</span><span class="ident" id="7238208"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span>&nbsp;<span class="op" id="7238210">!=</span>&nbsp;<span class="ident" id="7238213"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7238217">.</span><span class="ident" id="7238218"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7238219">*</span><span class="ident" id="7238220"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7238224">.</span><span class="ident" id="7238225"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span>&nbsp;<span class="op" id="7238227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7238231"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7238232">.</span><span class="ident" id="7238233"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7238239">(</span><span class="string" id="7238240">&#34;Mul:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7238265">,</span>&nbsp;<span class="ident" id="7238267"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span><span class="op" id="7238272">.</span><span class="ident" id="7238273"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span><span class="op" id="7238274">,</span>&nbsp;<span class="ident" id="7238276"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7238280">.</span><span class="ident" id="7238281"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7238282">*</span><span class="ident" id="7238283"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7238287">.</span><span class="ident" id="7238288"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><span class="op" id="7238289">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7238292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7238296">//&nbsp;ServiceName&nbsp;contain&nbsp;&#34;.&#34;&nbsp;character</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7238334"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span>&nbsp;<span class="op" id="7238339">=</span>&nbsp;<span class="op" id="7238341">&amp;</span><span class="ident" id="7238342"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7238346">{</span><span class="num" id="7238347">7</span><span class="op" id="7238348">,</span>&nbsp;<span class="num" id="7238350">8</span><span class="op" id="7238351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7238354"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span>&nbsp;<span class="op" id="7238360">=</span>&nbsp;<span class="builtinfunc" id="7238362">new</span><span class="op" id="7238365">(</span><span class="ident" id="7238366"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7238371">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7238374"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span>&nbsp;<span class="op" id="7238378">=</span>&nbsp;<span class="ident" id="7238380"><a href="/gostd/net/rpc/server_test.go.html#7235077">client</a></span><span class="op" id="7238386">.</span><span class="ident" id="7238387"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="7238391">(</span><span class="string" id="7238392">&#34;net.rpc.Arith.Add&#34;</span><span class="op" id="7238411">,</span>&nbsp;<span class="ident" id="7238413"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7238417">,</span>&nbsp;<span class="ident" id="7238419"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span><span class="op" id="7238424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7238427">if</span>&nbsp;<span class="ident" id="7238430"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span>&nbsp;<span class="op" id="7238434">!=</span>&nbsp;<span class="builtintype" id="7238437">nil</span>&nbsp;<span class="op" id="7238441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7238445"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7238446">.</span><span class="ident" id="7238447"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7238453">(</span><span class="string" id="7238454">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7238496">,</span>&nbsp;<span class="ident" id="7238498"><a href="/gostd/net/rpc/server_test.go.html#7235085">err</a></span><span class="op" id="7238501">.</span><span class="ident" id="7238502">Error</span><span class="op" id="7238507">(</span><span class="op" id="7238508">)</span><span class="op" id="7238509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7238512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7238515">if</span>&nbsp;<span class="ident" id="7238518"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span><span class="op" id="7238523">.</span><span class="ident" id="7238524"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span>&nbsp;<span class="op" id="7238526">!=</span>&nbsp;<span class="ident" id="7238529"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7238533">.</span><span class="ident" id="7238534"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7238535">+</span><span class="ident" id="7238536"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7238540">.</span><span class="ident" id="7238541"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span>&nbsp;<span class="op" id="7238543">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7238547"><a href="/gostd/net/rpc/server_test.go.html#7235047">t</a></span><span class="op" id="7238548">.</span><span class="ident" id="7238549"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7238555">(</span><span class="string" id="7238556">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7238581">,</span>&nbsp;<span class="ident" id="7238583"><a href="/gostd/net/rpc/server_test.go.html#7235223">reply</a></span><span class="op" id="7238588">.</span><span class="ident" id="7238589"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span><span class="op" id="7238590">,</span>&nbsp;<span class="ident" id="7238592"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7238596">.</span><span class="ident" id="7238597"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7238598">+</span><span class="ident" id="7238599"><a href="/gostd/net/rpc/server_test.go.html#7235202">args</a></span><span class="op" id="7238603">.</span><span class="ident" id="7238604"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><span class="op" id="7238605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7238608">}</span><br>
<span class="lineno"></span><span class="op" id="7238610">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7238613">func</span>&nbsp;<span class="ident" id="7238618">testNewServerRPC</span><span class="op" id="7238634">(</span><span class="ident" id="7238635">t</span>&nbsp;<span class="op" id="7238637">*</span><span class="ident" id="7238638"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7238645">.</span><span class="ident" id="7238646"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7238647">,</span>&nbsp;<span class="ident" id="7238649">addr</span>&nbsp;<span class="builtintype" id="7238654">string</span><span class="op" id="7238660">)</span>&nbsp;<span class="op" id="7238662">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7238665">client</span><span class="op" id="7238671">,</span>&nbsp;<span class="ident" id="7238673">err</span>&nbsp;<span class="op" id="7238677">:=</span>&nbsp;<span class="ident" id="7238680"><a href="/gostd/net/rpc/client.go.html#5268500">Dial</a></span><span class="op" id="7238684">(</span><span class="string" id="7238685">&#34;tcp&#34;</span><span class="op" id="7238690">,</span>&nbsp;<span class="ident" id="7238692"><a href="/gostd/net/rpc/server_test.go.html#7238649">addr</a></span><span class="op" id="7238696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7238699">if</span>&nbsp;<span class="ident" id="7238702"><a href="/gostd/net/rpc/server_test.go.html#7238673">err</a></span>&nbsp;<span class="op" id="7238706">!=</span>&nbsp;<span class="builtintype" id="7238709">nil</span>&nbsp;<span class="op" id="7238713">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7238717"><a href="/gostd/net/rpc/server_test.go.html#7238635">t</a></span><span class="op" id="7238718">.</span><span class="ident" id="7238719"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7238724">(</span><span class="string" id="7238725">&#34;dialing&#34;</span><span class="op" id="7238734">,</span>&nbsp;<span class="ident" id="7238736"><a href="/gostd/net/rpc/server_test.go.html#7238673">err</a></span><span class="op" id="7238739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7238742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7238745">defer</span>&nbsp;<span class="ident" id="7238751"><a href="/gostd/net/rpc/server_test.go.html#7238665">client</a></span><span class="op" id="7238757">.</span><span class="ident" id="7238758"><a href="/gostd/net/rpc/client.go.html#5268682">Close</a></span><span class="op" id="7238763">(</span><span class="op" id="7238764">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7238768">//&nbsp;Synchronous&nbsp;calls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7238790">args</span>&nbsp;<span class="op" id="7238795">:=</span>&nbsp;<span class="op" id="7238798">&amp;</span><span class="ident" id="7238799"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7238803">{</span><span class="num" id="7238804">7</span><span class="op" id="7238805">,</span>&nbsp;<span class="num" id="7238807">8</span><span class="op" id="7238808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7238811">reply</span>&nbsp;<span class="op" id="7238817">:=</span>&nbsp;<span class="builtinfunc" id="7238820">new</span><span class="op" id="7238823">(</span><span class="ident" id="7238824"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7238829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7238832"><a href="/gostd/net/rpc/server_test.go.html#7238673">err</a></span>&nbsp;<span class="op" id="7238836">=</span>&nbsp;<span class="ident" id="7238838"><a href="/gostd/net/rpc/server_test.go.html#7238665">client</a></span><span class="op" id="7238844">.</span><span class="ident" id="7238845"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="7238849">(</span><span class="string" id="7238850">&#34;newServer.Arith.Add&#34;</span><span class="op" id="7238871">,</span>&nbsp;<span class="ident" id="7238873"><a href="/gostd/net/rpc/server_test.go.html#7238790">args</a></span><span class="op" id="7238877">,</span>&nbsp;<span class="ident" id="7238879"><a href="/gostd/net/rpc/server_test.go.html#7238811">reply</a></span><span class="op" id="7238884">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7238887">if</span>&nbsp;<span class="ident" id="7238890"><a href="/gostd/net/rpc/server_test.go.html#7238673">err</a></span>&nbsp;<span class="op" id="7238894">!=</span>&nbsp;<span class="builtintype" id="7238897">nil</span>&nbsp;<span class="op" id="7238901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7238905"><a href="/gostd/net/rpc/server_test.go.html#7238635">t</a></span><span class="op" id="7238906">.</span><span class="ident" id="7238907"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7238913">(</span><span class="string" id="7238914">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7238956">,</span>&nbsp;<span class="ident" id="7238958"><a href="/gostd/net/rpc/server_test.go.html#7238673">err</a></span><span class="op" id="7238961">.</span><span class="ident" id="7238962">Error</span><span class="op" id="7238967">(</span><span class="op" id="7238968">)</span><span class="op" id="7238969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7238972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7238975">if</span>&nbsp;<span class="ident" id="7238978"><a href="/gostd/net/rpc/server_test.go.html#7238811">reply</a></span><span class="op" id="7238983">.</span><span class="ident" id="7238984"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span>&nbsp;<span class="op" id="7238986">!=</span>&nbsp;<span class="ident" id="7238989"><a href="/gostd/net/rpc/server_test.go.html#7238790">args</a></span><span class="op" id="7238993">.</span><span class="ident" id="7238994"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7238995">+</span><span class="ident" id="7238996"><a href="/gostd/net/rpc/server_test.go.html#7238790">args</a></span><span class="op" id="7239000">.</span><span class="ident" id="7239001"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span>&nbsp;<span class="op" id="7239003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7239007"><a href="/gostd/net/rpc/server_test.go.html#7238635">t</a></span><span class="op" id="7239008">.</span><span class="ident" id="7239009"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7239015">(</span><span class="string" id="7239016">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7239041">,</span>&nbsp;<span class="ident" id="7239043"><a href="/gostd/net/rpc/server_test.go.html#7238811">reply</a></span><span class="op" id="7239048">.</span><span class="ident" id="7239049"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span><span class="op" id="7239050">,</span>&nbsp;<span class="ident" id="7239052"><a href="/gostd/net/rpc/server_test.go.html#7238790">args</a></span><span class="op" id="7239056">.</span><span class="ident" id="7239057"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7239058">+</span><span class="ident" id="7239059"><a href="/gostd/net/rpc/server_test.go.html#7238790">args</a></span><span class="op" id="7239063">.</span><span class="ident" id="7239064"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><span class="op" id="7239065">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7239068">}</span><br>
<span class="lineno"></span><span class="op" id="7239070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7239073">func</span>&nbsp;<span class="ident" id="7239078">TestHTTP</span><span class="op" id="7239086">(</span><span class="ident" id="7239087">t</span>&nbsp;<span class="op" id="7239089">*</span><span class="ident" id="7239090"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7239097">.</span><span class="ident" id="7239098"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7239099">)</span>&nbsp;<span class="op" id="7239101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7239104"><a href="/gostd/net/rpc/server_test.go.html#7232913">once</a></span><span class="op" id="7239108">.</span><span class="ident" id="7239109"><a href="/gostd/sync/once.go.html#1447110">Do</a></span><span class="op" id="7239111">(</span><span class="ident" id="7239112"><a href="/gostd/net/rpc/server_test.go.html#7234023">startServer</a></span><span class="op" id="7239123">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7239126"><a href="/gostd/net/rpc/server_test.go.html#7239210">testHTTPRPC</a></span><span class="op" id="7239137">(</span><span class="ident" id="7239138"><a href="/gostd/net/rpc/server_test.go.html#7239087">t</a></span><span class="op" id="7239139">,</span>&nbsp;<span class="string" id="7239141">&#34;&#34;</span><span class="op" id="7239143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7239146"><a href="/gostd/net/rpc/server_test.go.html#7232919">newOnce</a></span><span class="op" id="7239153">.</span><span class="ident" id="7239154"><a href="/gostd/sync/once.go.html#1447110">Do</a></span><span class="op" id="7239156">(</span><span class="ident" id="7239157"><a href="/gostd/net/rpc/server_test.go.html#7234278">startNewServer</a></span><span class="op" id="7239171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7239174"><a href="/gostd/net/rpc/server_test.go.html#7239210">testHTTPRPC</a></span><span class="op" id="7239185">(</span><span class="ident" id="7239186"><a href="/gostd/net/rpc/server_test.go.html#7239087">t</a></span><span class="op" id="7239187">,</span>&nbsp;<span class="ident" id="7239189"><a href="/gostd/net/rpc/server_test.go.html#7232961">newHttpPath</a></span><span class="op" id="7239200">)</span><br>
<span class="lineno"></span><span class="op" id="7239202">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="7239205">func</span>&nbsp;<span class="ident" id="7239210">testHTTPRPC</span><span class="op" id="7239221">(</span><span class="ident" id="7239222">t</span>&nbsp;<span class="op" id="7239224">*</span><span class="ident" id="7239225"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7239232">.</span><span class="ident" id="7239233"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7239234">,</span>&nbsp;<span class="ident" id="7239236">path</span>&nbsp;<span class="builtintype" id="7239241">string</span><span class="op" id="7239247">)</span>&nbsp;<span class="op" id="7239249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7239252">var</span>&nbsp;<span class="ident" id="7239256">client</span>&nbsp;<span class="op" id="7239263">*</span><span class="ident" id="7239264"><a href="/gostd/net/rpc/client.go.html#5262362">Client</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7239272">var</span>&nbsp;<span class="ident" id="7239276">err</span>&nbsp;<span class="builtintype" id="7239280">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7239287">if</span>&nbsp;<span class="ident" id="7239290"><a href="/gostd/net/rpc/server_test.go.html#7239236">path</a></span>&nbsp;<span class="op" id="7239295">==</span>&nbsp;<span class="string" id="7239298">&#34;&#34;</span>&nbsp;<span class="op" id="7239301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7239305"><a href="/gostd/net/rpc/server_test.go.html#7239256">client</a></span><span class="op" id="7239311">,</span>&nbsp;<span class="ident" id="7239313"><a href="/gostd/net/rpc/server_test.go.html#7239276">err</a></span>&nbsp;<span class="op" id="7239317">=</span>&nbsp;<span class="ident" id="7239319"><a href="/gostd/net/rpc/client.go.html#5267553">DialHTTP</a></span><span class="op" id="7239327">(</span><span class="string" id="7239328">&#34;tcp&#34;</span><span class="op" id="7239333">,</span>&nbsp;<span class="ident" id="7239335"><a href="/gostd/net/rpc/server_test.go.html#7232879">httpServerAddr</a></span><span class="op" id="7239349">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7239352">}</span>&nbsp;<span class="keyword" id="7239354">else</span>&nbsp;<span class="op" id="7239359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7239363"><a href="/gostd/net/rpc/server_test.go.html#7239256">client</a></span><span class="op" id="7239369">,</span>&nbsp;<span class="ident" id="7239371"><a href="/gostd/net/rpc/server_test.go.html#7239276">err</a></span>&nbsp;<span class="op" id="7239375">=</span>&nbsp;<span class="ident" id="7239377"><a href="/gostd/net/rpc/client.go.html#5267762">DialHTTPPath</a></span><span class="op" id="7239389">(</span><span class="string" id="7239390">&#34;tcp&#34;</span><span class="op" id="7239395">,</span>&nbsp;<span class="ident" id="7239397"><a href="/gostd/net/rpc/server_test.go.html#7232879">httpServerAddr</a></span><span class="op" id="7239411">,</span>&nbsp;<span class="ident" id="7239413"><a href="/gostd/net/rpc/server_test.go.html#7239236">path</a></span><span class="op" id="7239417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7239420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7239423">if</span>&nbsp;<span class="ident" id="7239426"><a href="/gostd/net/rpc/server_test.go.html#7239276">err</a></span>&nbsp;<span class="op" id="7239430">!=</span>&nbsp;<span class="builtintype" id="7239433">nil</span>&nbsp;<span class="op" id="7239437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7239441"><a href="/gostd/net/rpc/server_test.go.html#7239222">t</a></span><span class="op" id="7239442">.</span><span class="ident" id="7239443"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7239448">(</span><span class="string" id="7239449">&#34;dialing&#34;</span><span class="op" id="7239458">,</span>&nbsp;<span class="ident" id="7239460"><a href="/gostd/net/rpc/server_test.go.html#7239276">err</a></span><span class="op" id="7239463">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7239466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7239469">defer</span>&nbsp;<span class="ident" id="7239475"><a href="/gostd/net/rpc/server_test.go.html#7239256">client</a></span><span class="op" id="7239481">.</span><span class="ident" id="7239482"><a href="/gostd/net/rpc/client.go.html#5268682">Close</a></span><span class="op" id="7239487">(</span><span class="op" id="7239488">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7239492">//&nbsp;Synchronous&nbsp;calls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7239514">args</span>&nbsp;<span class="op" id="7239519">:=</span>&nbsp;<span class="op" id="7239522">&amp;</span><span class="ident" id="7239523"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7239527">{</span><span class="num" id="7239528">7</span><span class="op" id="7239529">,</span>&nbsp;<span class="num" id="7239531">8</span><span class="op" id="7239532">}</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7239535">reply</span>&nbsp;<span class="op" id="7239541">:=</span>&nbsp;<span class="builtinfunc" id="7239544">new</span><span class="op" id="7239547">(</span><span class="ident" id="7239548"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7239553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7239556"><a href="/gostd/net/rpc/server_test.go.html#7239276">err</a></span>&nbsp;<span class="op" id="7239560">=</span>&nbsp;<span class="ident" id="7239562"><a href="/gostd/net/rpc/server_test.go.html#7239256">client</a></span><span class="op" id="7239568">.</span><span class="ident" id="7239569"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="7239573">(</span><span class="string" id="7239574">&#34;Arith.Add&#34;</span><span class="op" id="7239585">,</span>&nbsp;<span class="ident" id="7239587"><a href="/gostd/net/rpc/server_test.go.html#7239514">args</a></span><span class="op" id="7239591">,</span>&nbsp;<span class="ident" id="7239593"><a href="/gostd/net/rpc/server_test.go.html#7239535">reply</a></span><span class="op" id="7239598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7239601">if</span>&nbsp;<span class="ident" id="7239604"><a href="/gostd/net/rpc/server_test.go.html#7239276">err</a></span>&nbsp;<span class="op" id="7239608">!=</span>&nbsp;<span class="builtintype" id="7239611">nil</span>&nbsp;<span class="op" id="7239615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7239619"><a href="/gostd/net/rpc/server_test.go.html#7239222">t</a></span><span class="op" id="7239620">.</span><span class="ident" id="7239621"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7239627">(</span><span class="string" id="7239628">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7239670">,</span>&nbsp;<span class="ident" id="7239672"><a href="/gostd/net/rpc/server_test.go.html#7239276">err</a></span><span class="op" id="7239675">.</span><span class="ident" id="7239676">Error</span><span class="op" id="7239681">(</span><span class="op" id="7239682">)</span><span class="op" id="7239683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7239686">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7239689">if</span>&nbsp;<span class="ident" id="7239692"><a href="/gostd/net/rpc/server_test.go.html#7239535">reply</a></span><span class="op" id="7239697">.</span><span class="ident" id="7239698"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span>&nbsp;<span class="op" id="7239700">!=</span>&nbsp;<span class="ident" id="7239703"><a href="/gostd/net/rpc/server_test.go.html#7239514">args</a></span><span class="op" id="7239707">.</span><span class="ident" id="7239708"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7239709">+</span><span class="ident" id="7239710"><a href="/gostd/net/rpc/server_test.go.html#7239514">args</a></span><span class="op" id="7239714">.</span><span class="ident" id="7239715"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span>&nbsp;<span class="op" id="7239717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7239721"><a href="/gostd/net/rpc/server_test.go.html#7239222">t</a></span><span class="op" id="7239722">.</span><span class="ident" id="7239723"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7239729">(</span><span class="string" id="7239730">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7239755">,</span>&nbsp;<span class="ident" id="7239757"><a href="/gostd/net/rpc/server_test.go.html#7239535">reply</a></span><span class="op" id="7239762">.</span><span class="ident" id="7239763"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span><span class="op" id="7239764">,</span>&nbsp;<span class="ident" id="7239766"><a href="/gostd/net/rpc/server_test.go.html#7239514">args</a></span><span class="op" id="7239770">.</span><span class="ident" id="7239771"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7239772">+</span><span class="ident" id="7239773"><a href="/gostd/net/rpc/server_test.go.html#7239514">args</a></span><span class="op" id="7239777">.</span><span class="ident" id="7239778"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><span class="op" id="7239779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7239782">}</span><br>
<span class="lineno"></span><span class="op" id="7239784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">305</span><span class="comment" id="7239787">//&nbsp;CodecEmulator&nbsp;provides&nbsp;a&nbsp;client-like&nbsp;api&nbsp;and&nbsp;a&nbsp;ServerCodec&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="7239860">//&nbsp;Can&nbsp;be&nbsp;used&nbsp;to&nbsp;test&nbsp;ServeRequest.</span><br>
<span class="lineno"></span><span class="keyword" id="7239897">type</span>&nbsp;<span class="ident" id="7239902">CodecEmulator</span>&nbsp;<span class="keyword" id="7239916">struct</span>&nbsp;<span class="op" id="7239923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7239926">server</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7239940">*</span><span class="ident" id="7239941"><a href="/gostd/net/rpc/server.go.html#5277991">Server</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7239949">serviceMethod</span>&nbsp;<span class="builtintype" id="7239963">string</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7239971">args</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7239985">*</span><span class="ident" id="7239986"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7239992">reply</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7240006">*</span><span class="ident" id="7240007"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7240014">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7240028">error</span><br>
<span class="lineno"></span><span class="op" id="7240034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">315</span><span class="keyword" id="7240037">func</span>&nbsp;<span class="op" id="7240042">(</span><span class="ident" id="7240043">codec</span>&nbsp;<span class="op" id="7240049">*</span><span class="ident" id="7240050"><a href="/gostd/net/rpc/server_test.go.html#7239902">CodecEmulator</a></span><span class="op" id="7240063">)</span>&nbsp;<span class="ident" id="7240065">Call</span><span class="op" id="7240069">(</span><span class="ident" id="7240070">serviceMethod</span>&nbsp;<span class="builtintype" id="7240084">string</span><span class="op" id="7240090">,</span>&nbsp;<span class="ident" id="7240092">args</span>&nbsp;<span class="op" id="7240097">*</span><span class="ident" id="7240098"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7240102">,</span>&nbsp;<span class="ident" id="7240104">reply</span>&nbsp;<span class="op" id="7240110">*</span><span class="ident" id="7240111"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7240116">)</span>&nbsp;<span class="builtintype" id="7240118">error</span>&nbsp;<span class="op" id="7240124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7240127"><a href="/gostd/net/rpc/server_test.go.html#7240043">codec</a></span><span class="op" id="7240132">.</span><span class="ident" id="7240133"><a href="/gostd/net/rpc/server_test.go.html#7239949">serviceMethod</a></span>&nbsp;<span class="op" id="7240147">=</span>&nbsp;<span class="ident" id="7240149"><a href="/gostd/net/rpc/server_test.go.html#7240070">serviceMethod</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7240164"><a href="/gostd/net/rpc/server_test.go.html#7240043">codec</a></span><span class="op" id="7240169">.</span><span class="ident" id="7240170"><a href="/gostd/net/rpc/server_test.go.html#7239971">args</a></span>&nbsp;<span class="op" id="7240175">=</span>&nbsp;<span class="ident" id="7240177"><a href="/gostd/net/rpc/server_test.go.html#7240092">args</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7240183"><a href="/gostd/net/rpc/server_test.go.html#7240043">codec</a></span><span class="op" id="7240188">.</span><span class="ident" id="7240189"><a href="/gostd/net/rpc/server_test.go.html#7239992">reply</a></span>&nbsp;<span class="op" id="7240195">=</span>&nbsp;<span class="ident" id="7240197"><a href="/gostd/net/rpc/server_test.go.html#7240104">reply</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7240204"><a href="/gostd/net/rpc/server_test.go.html#7240043">codec</a></span><span class="op" id="7240209">.</span><span class="ident" id="7240210"><a href="/gostd/net/rpc/server_test.go.html#7240014">err</a></span>&nbsp;<span class="op" id="7240214">=</span>&nbsp;<span class="builtintype" id="7240216">nil</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7240221">var</span>&nbsp;<span class="ident" id="7240225">serverError</span>&nbsp;<span class="builtintype" id="7240237">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7240244">if</span>&nbsp;<span class="ident" id="7240247"><a href="/gostd/net/rpc/server_test.go.html#7240043">codec</a></span><span class="op" id="7240252">.</span><span class="ident" id="7240253"><a href="/gostd/net/rpc/server_test.go.html#7239926">server</a></span>&nbsp;<span class="op" id="7240260">==</span>&nbsp;<span class="builtintype" id="7240263">nil</span>&nbsp;<span class="op" id="7240267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7240271"><a href="/gostd/net/rpc/server_test.go.html#7240225">serverError</a></span>&nbsp;<span class="op" id="7240283">=</span>&nbsp;<span class="ident" id="7240285"><a href="/gostd/net/rpc/server.go.html#5292216">ServeRequest</a></span><span class="op" id="7240297">(</span><span class="ident" id="7240298"><a href="/gostd/net/rpc/server_test.go.html#7240043">codec</a></span><span class="op" id="7240303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7240306">}</span>&nbsp;<span class="keyword" id="7240308">else</span>&nbsp;<span class="op" id="7240313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7240317"><a href="/gostd/net/rpc/server_test.go.html#7240225">serverError</a></span>&nbsp;<span class="op" id="7240329">=</span>&nbsp;<span class="ident" id="7240331"><a href="/gostd/net/rpc/server_test.go.html#7240043">codec</a></span><span class="op" id="7240336">.</span><span class="ident" id="7240337"><a href="/gostd/net/rpc/server_test.go.html#7239926">server</a></span><span class="op" id="7240343">.</span><span class="ident" id="7240344"><a href="/gostd/net/rpc/server.go.html#5286854">ServeRequest</a></span><span class="op" id="7240356">(</span><span class="ident" id="7240357"><a href="/gostd/net/rpc/server_test.go.html#7240043">codec</a></span><span class="op" id="7240362">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7240365">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7240368">if</span>&nbsp;<span class="ident" id="7240371"><a href="/gostd/net/rpc/server_test.go.html#7240043">codec</a></span><span class="op" id="7240376">.</span><span class="ident" id="7240377"><a href="/gostd/net/rpc/server_test.go.html#7240014">err</a></span>&nbsp;<span class="op" id="7240381">==</span>&nbsp;<span class="builtintype" id="7240384">nil</span>&nbsp;<span class="op" id="7240388">&amp;&amp;</span>&nbsp;<span class="ident" id="7240391"><a href="/gostd/net/rpc/server_test.go.html#7240225">serverError</a></span>&nbsp;<span class="op" id="7240403">!=</span>&nbsp;<span class="builtintype" id="7240406">nil</span>&nbsp;<span class="op" id="7240410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7240414"><a href="/gostd/net/rpc/server_test.go.html#7240043">codec</a></span><span class="op" id="7240419">.</span><span class="ident" id="7240420"><a href="/gostd/net/rpc/server_test.go.html#7240014">err</a></span>&nbsp;<span class="op" id="7240424">=</span>&nbsp;<span class="ident" id="7240426"><a href="/gostd/net/rpc/server_test.go.html#7240225">serverError</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7240439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7240442">return</span>&nbsp;<span class="ident" id="7240449"><a href="/gostd/net/rpc/server_test.go.html#7240043">codec</a></span><span class="op" id="7240454">.</span><span class="ident" id="7240455"><a href="/gostd/net/rpc/server_test.go.html#7240014">err</a></span><br>
<span class="lineno">330</span><span class="op" id="7240459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7240462">func</span>&nbsp;<span class="op" id="7240467">(</span><span class="ident" id="7240468">codec</span>&nbsp;<span class="op" id="7240474">*</span><span class="ident" id="7240475"><a href="/gostd/net/rpc/server_test.go.html#7239902">CodecEmulator</a></span><span class="op" id="7240488">)</span>&nbsp;<span class="ident" id="7240490">ReadRequestHeader</span><span class="op" id="7240507">(</span><span class="ident" id="7240508">req</span>&nbsp;<span class="op" id="7240512">*</span><span class="ident" id="7240513"><a href="/gostd/net/rpc/server.go.html#5277366">Request</a></span><span class="op" id="7240520">)</span>&nbsp;<span class="builtintype" id="7240522">error</span>&nbsp;<span class="op" id="7240528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7240531"><a href="/gostd/net/rpc/server_test.go.html#7240508">req</a></span><span class="op" id="7240534">.</span><span class="ident" id="7240535"><a href="/gostd/net/rpc/server.go.html#5277384">ServiceMethod</a></span>&nbsp;<span class="op" id="7240549">=</span>&nbsp;<span class="ident" id="7240551"><a href="/gostd/net/rpc/server_test.go.html#7240468">codec</a></span><span class="op" id="7240556">.</span><span class="ident" id="7240557"><a href="/gostd/net/rpc/server_test.go.html#7239949">serviceMethod</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7240572"><a href="/gostd/net/rpc/server_test.go.html#7240508">req</a></span><span class="op" id="7240575">.</span><span class="ident" id="7240576"><a href="/gostd/net/rpc/server.go.html#5277436">Seq</a></span>&nbsp;<span class="op" id="7240580">=</span>&nbsp;<span class="num" id="7240582">0</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7240585">return</span>&nbsp;<span class="builtintype" id="7240592">nil</span><br>
<span class="lineno"></span><span class="op" id="7240596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7240599">func</span>&nbsp;<span class="op" id="7240604">(</span><span class="ident" id="7240605">codec</span>&nbsp;<span class="op" id="7240611">*</span><span class="ident" id="7240612"><a href="/gostd/net/rpc/server_test.go.html#7239902">CodecEmulator</a></span><span class="op" id="7240625">)</span>&nbsp;<span class="ident" id="7240627">ReadRequestBody</span><span class="op" id="7240642">(</span><span class="ident" id="7240643">argv</span>&nbsp;<span class="keyword" id="7240648">interface</span><span class="op" id="7240657">{</span><span class="op" id="7240658">}</span><span class="op" id="7240659">)</span>&nbsp;<span class="builtintype" id="7240661">error</span>&nbsp;<span class="op" id="7240667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7240670">if</span>&nbsp;<span class="ident" id="7240673"><a href="/gostd/net/rpc/server_test.go.html#7240605">codec</a></span><span class="op" id="7240678">.</span><span class="ident" id="7240679"><a href="/gostd/net/rpc/server_test.go.html#7239971">args</a></span>&nbsp;<span class="op" id="7240684">==</span>&nbsp;<span class="builtintype" id="7240687">nil</span>&nbsp;<span class="op" id="7240691">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7240695">return</span>&nbsp;<span class="ident" id="7240702"><a href="/gostd/net/rpc/server_test.go.html#7232696">io</a></span><span class="op" id="7240704">.</span><span class="ident" id="7240705"><a href="/gostd/io/io.go.html#1420096">ErrUnexpectedEOF</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7240723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7240726">*</span><span class="op" id="7240727">(</span><span class="ident" id="7240728"><a href="/gostd/net/rpc/server_test.go.html#7240643">argv</a></span><span class="op" id="7240732">.</span><span class="op" id="7240733">(</span><span class="op" id="7240734">*</span><span class="ident" id="7240735"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7240739">)</span><span class="op" id="7240740">)</span>&nbsp;<span class="op" id="7240742">=</span>&nbsp;<span class="op" id="7240744">*</span><span class="ident" id="7240745"><a href="/gostd/net/rpc/server_test.go.html#7240605">codec</a></span><span class="op" id="7240750">.</span><span class="ident" id="7240751"><a href="/gostd/net/rpc/server_test.go.html#7239971">args</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7240757">return</span>&nbsp;<span class="builtintype" id="7240764">nil</span><br>
<span class="lineno"></span><span class="op" id="7240768">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="7240771">func</span>&nbsp;<span class="op" id="7240776">(</span><span class="ident" id="7240777">codec</span>&nbsp;<span class="op" id="7240783">*</span><span class="ident" id="7240784"><a href="/gostd/net/rpc/server_test.go.html#7239902">CodecEmulator</a></span><span class="op" id="7240797">)</span>&nbsp;<span class="ident" id="7240799">WriteResponse</span><span class="op" id="7240812">(</span><span class="ident" id="7240813">resp</span>&nbsp;<span class="op" id="7240818">*</span><span class="ident" id="7240819"><a href="/gostd/net/rpc/server.go.html#5277724">Response</a></span><span class="op" id="7240827">,</span>&nbsp;<span class="ident" id="7240829">reply</span>&nbsp;<span class="keyword" id="7240835">interface</span><span class="op" id="7240844">{</span><span class="op" id="7240845">}</span><span class="op" id="7240846">)</span>&nbsp;<span class="builtintype" id="7240848">error</span>&nbsp;<span class="op" id="7240854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7240857">if</span>&nbsp;<span class="ident" id="7240860"><a href="/gostd/net/rpc/server_test.go.html#7240813">resp</a></span><span class="op" id="7240864">.</span><span class="ident" id="7240865"><a href="/gostd/net/rpc/server.go.html#5277853">Error</a></span>&nbsp;<span class="op" id="7240871">!=</span>&nbsp;<span class="string" id="7240874">&#34;&#34;</span>&nbsp;<span class="op" id="7240877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7240881"><a href="/gostd/net/rpc/server_test.go.html#7240777">codec</a></span><span class="op" id="7240886">.</span><span class="ident" id="7240887"><a href="/gostd/net/rpc/server_test.go.html#7240014">err</a></span>&nbsp;<span class="op" id="7240891">=</span>&nbsp;<span class="ident" id="7240893"><a href="/gostd/net/rpc/server_test.go.html#7232679">errors</a></span><span class="op" id="7240899">.</span><span class="ident" id="7240900"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="7240903">(</span><span class="ident" id="7240904"><a href="/gostd/net/rpc/server_test.go.html#7240813">resp</a></span><span class="op" id="7240908">.</span><span class="ident" id="7240909"><a href="/gostd/net/rpc/server.go.html#5277853">Error</a></span><span class="op" id="7240914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7240917">}</span>&nbsp;<span class="keyword" id="7240919">else</span>&nbsp;<span class="op" id="7240924">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7240928">*</span><span class="ident" id="7240929"><a href="/gostd/net/rpc/server_test.go.html#7240777">codec</a></span><span class="op" id="7240934">.</span><span class="ident" id="7240935"><a href="/gostd/net/rpc/server_test.go.html#7239992">reply</a></span>&nbsp;<span class="op" id="7240941">=</span>&nbsp;<span class="op" id="7240943">*</span><span class="op" id="7240944">(</span><span class="ident" id="7240945"><a href="/gostd/net/rpc/server_test.go.html#7240829">reply</a></span><span class="op" id="7240950">.</span><span class="op" id="7240951">(</span><span class="op" id="7240952">*</span><span class="ident" id="7240953"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7240958">)</span><span class="op" id="7240959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7240962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7240965">return</span>&nbsp;<span class="builtintype" id="7240972">nil</span><br>
<span class="lineno"></span><span class="op" id="7240976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="7240979">func</span>&nbsp;<span class="op" id="7240984">(</span><span class="ident" id="7240985">codec</span>&nbsp;<span class="op" id="7240991">*</span><span class="ident" id="7240992"><a href="/gostd/net/rpc/server_test.go.html#7239902">CodecEmulator</a></span><span class="op" id="7241005">)</span>&nbsp;<span class="ident" id="7241007">Close</span><span class="op" id="7241012">(</span><span class="op" id="7241013">)</span>&nbsp;<span class="builtintype" id="7241015">error</span>&nbsp;<span class="op" id="7241021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7241024">return</span>&nbsp;<span class="builtintype" id="7241031">nil</span><br>
<span class="lineno"></span><span class="op" id="7241035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7241038">func</span>&nbsp;<span class="ident" id="7241043">TestServeRequest</span><span class="op" id="7241059">(</span><span class="ident" id="7241060">t</span>&nbsp;<span class="op" id="7241062">*</span><span class="ident" id="7241063"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7241070">.</span><span class="ident" id="7241071"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7241072">)</span>&nbsp;<span class="op" id="7241074">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7241077"><a href="/gostd/net/rpc/server_test.go.html#7232913">once</a></span><span class="op" id="7241081">.</span><span class="ident" id="7241082"><a href="/gostd/sync/once.go.html#1447110">Do</a></span><span class="op" id="7241084">(</span><span class="ident" id="7241085"><a href="/gostd/net/rpc/server_test.go.html#7234023">startServer</a></span><span class="op" id="7241096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7241099"><a href="/gostd/net/rpc/server_test.go.html#7241192">testServeRequest</a></span><span class="op" id="7241115">(</span><span class="ident" id="7241116"><a href="/gostd/net/rpc/server_test.go.html#7241060">t</a></span><span class="op" id="7241117">,</span>&nbsp;<span class="builtintype" id="7241119">nil</span><span class="op" id="7241122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7241125"><a href="/gostd/net/rpc/server_test.go.html#7232919">newOnce</a></span><span class="op" id="7241132">.</span><span class="ident" id="7241133"><a href="/gostd/sync/once.go.html#1447110">Do</a></span><span class="op" id="7241135">(</span><span class="ident" id="7241136"><a href="/gostd/net/rpc/server_test.go.html#7234278">startNewServer</a></span><span class="op" id="7241150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7241153"><a href="/gostd/net/rpc/server_test.go.html#7241192">testServeRequest</a></span><span class="op" id="7241169">(</span><span class="ident" id="7241170"><a href="/gostd/net/rpc/server_test.go.html#7241060">t</a></span><span class="op" id="7241171">,</span>&nbsp;<span class="ident" id="7241173"><a href="/gostd/net/rpc/server_test.go.html#7232810">newServer</a></span><span class="op" id="7241182">)</span><br>
<span class="lineno"></span><span class="op" id="7241184">}</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="keyword" id="7241187">func</span>&nbsp;<span class="ident" id="7241192">testServeRequest</span><span class="op" id="7241208">(</span><span class="ident" id="7241209">t</span>&nbsp;<span class="op" id="7241211">*</span><span class="ident" id="7241212"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7241219">.</span><span class="ident" id="7241220"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7241221">,</span>&nbsp;<span class="ident" id="7241223">server</span>&nbsp;<span class="op" id="7241230">*</span><span class="ident" id="7241231"><a href="/gostd/net/rpc/server.go.html#5277991">Server</a></span><span class="op" id="7241237">)</span>&nbsp;<span class="op" id="7241239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7241242">client</span>&nbsp;<span class="op" id="7241249">:=</span>&nbsp;<span class="ident" id="7241252"><a href="/gostd/net/rpc/server_test.go.html#7239902">CodecEmulator</a></span><span class="op" id="7241265">{</span><span class="ident" id="7241266"><a href="/gostd/net/rpc/server_test.go.html#7239926">server</a></span><span class="op" id="7241272">:</span>&nbsp;<span class="ident" id="7241274"><a href="/gostd/net/rpc/server_test.go.html#7241223">server</a></span><span class="op" id="7241280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7241283">defer</span>&nbsp;<span class="ident" id="7241289"><a href="/gostd/net/rpc/server_test.go.html#7241242">client</a></span><span class="op" id="7241295">.</span><span class="ident" id="7241296"><a href="/gostd/net/rpc/server_test.go.html#7241007">Close</a></span><span class="op" id="7241301">(</span><span class="op" id="7241302">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7241306">args</span>&nbsp;<span class="op" id="7241311">:=</span>&nbsp;<span class="op" id="7241314">&amp;</span><span class="ident" id="7241315"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7241319">{</span><span class="num" id="7241320">7</span><span class="op" id="7241321">,</span>&nbsp;<span class="num" id="7241323">8</span><span class="op" id="7241324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7241327">reply</span>&nbsp;<span class="op" id="7241333">:=</span>&nbsp;<span class="builtinfunc" id="7241336">new</span><span class="op" id="7241339">(</span><span class="ident" id="7241340"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7241345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7241348">err</span>&nbsp;<span class="op" id="7241352">:=</span>&nbsp;<span class="ident" id="7241355"><a href="/gostd/net/rpc/server_test.go.html#7241242">client</a></span><span class="op" id="7241361">.</span><span class="ident" id="7241362"><a href="/gostd/net/rpc/server_test.go.html#7240065">Call</a></span><span class="op" id="7241366">(</span><span class="string" id="7241367">&#34;Arith.Add&#34;</span><span class="op" id="7241378">,</span>&nbsp;<span class="ident" id="7241380"><a href="/gostd/net/rpc/server_test.go.html#7241306">args</a></span><span class="op" id="7241384">,</span>&nbsp;<span class="ident" id="7241386"><a href="/gostd/net/rpc/server_test.go.html#7241327">reply</a></span><span class="op" id="7241391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7241394">if</span>&nbsp;<span class="ident" id="7241397"><a href="/gostd/net/rpc/server_test.go.html#7241348">err</a></span>&nbsp;<span class="op" id="7241401">!=</span>&nbsp;<span class="builtintype" id="7241404">nil</span>&nbsp;<span class="op" id="7241408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7241412"><a href="/gostd/net/rpc/server_test.go.html#7241209">t</a></span><span class="op" id="7241413">.</span><span class="ident" id="7241414"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7241420">(</span><span class="string" id="7241421">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7241463">,</span>&nbsp;<span class="ident" id="7241465"><a href="/gostd/net/rpc/server_test.go.html#7241348">err</a></span><span class="op" id="7241468">.</span><span class="ident" id="7241469">Error</span><span class="op" id="7241474">(</span><span class="op" id="7241475">)</span><span class="op" id="7241476">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7241479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7241482">if</span>&nbsp;<span class="ident" id="7241485"><a href="/gostd/net/rpc/server_test.go.html#7241327">reply</a></span><span class="op" id="7241490">.</span><span class="ident" id="7241491"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span>&nbsp;<span class="op" id="7241493">!=</span>&nbsp;<span class="ident" id="7241496"><a href="/gostd/net/rpc/server_test.go.html#7241306">args</a></span><span class="op" id="7241500">.</span><span class="ident" id="7241501"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7241502">+</span><span class="ident" id="7241503"><a href="/gostd/net/rpc/server_test.go.html#7241306">args</a></span><span class="op" id="7241507">.</span><span class="ident" id="7241508"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span>&nbsp;<span class="op" id="7241510">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7241514"><a href="/gostd/net/rpc/server_test.go.html#7241209">t</a></span><span class="op" id="7241515">.</span><span class="ident" id="7241516"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7241522">(</span><span class="string" id="7241523">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7241548">,</span>&nbsp;<span class="ident" id="7241550"><a href="/gostd/net/rpc/server_test.go.html#7241327">reply</a></span><span class="op" id="7241555">.</span><span class="ident" id="7241556"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span><span class="op" id="7241557">,</span>&nbsp;<span class="ident" id="7241559"><a href="/gostd/net/rpc/server_test.go.html#7241306">args</a></span><span class="op" id="7241563">.</span><span class="ident" id="7241564"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7241565">+</span><span class="ident" id="7241566"><a href="/gostd/net/rpc/server_test.go.html#7241306">args</a></span><span class="op" id="7241570">.</span><span class="ident" id="7241571"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><span class="op" id="7241572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7241575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7241579"><a href="/gostd/net/rpc/server_test.go.html#7241348">err</a></span>&nbsp;<span class="op" id="7241583">=</span>&nbsp;<span class="ident" id="7241585"><a href="/gostd/net/rpc/server_test.go.html#7241242">client</a></span><span class="op" id="7241591">.</span><span class="ident" id="7241592"><a href="/gostd/net/rpc/server_test.go.html#7240065">Call</a></span><span class="op" id="7241596">(</span><span class="string" id="7241597">&#34;Arith.Add&#34;</span><span class="op" id="7241608">,</span>&nbsp;<span class="builtintype" id="7241610">nil</span><span class="op" id="7241613">,</span>&nbsp;<span class="ident" id="7241615"><a href="/gostd/net/rpc/server_test.go.html#7241327">reply</a></span><span class="op" id="7241620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7241623">if</span>&nbsp;<span class="ident" id="7241626"><a href="/gostd/net/rpc/server_test.go.html#7241348">err</a></span>&nbsp;<span class="op" id="7241630">==</span>&nbsp;<span class="builtintype" id="7241633">nil</span>&nbsp;<span class="op" id="7241637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7241641"><a href="/gostd/net/rpc/server_test.go.html#7241209">t</a></span><span class="op" id="7241642">.</span><span class="ident" id="7241643"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7241649">(</span><span class="string" id="7241650">&#34;expected&nbsp;error&nbsp;calling&nbsp;Arith.Add&nbsp;with&nbsp;nil&nbsp;arg&#34;</span><span class="op" id="7241697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7241700">}</span><br>
<span class="lineno"></span><span class="op" id="7241702">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="keyword" id="7241705">type</span>&nbsp;<span class="ident" id="7241710">ReplyNotPointer</span>&nbsp;<span class="builtintype" id="7241726">int</span><br>
<span class="lineno"></span><span class="keyword" id="7241730">type</span>&nbsp;<span class="ident" id="7241735">ArgNotPublic</span>&nbsp;<span class="builtintype" id="7241748">int</span><br>
<span class="lineno"></span><span class="keyword" id="7241752">type</span>&nbsp;<span class="ident" id="7241757">ReplyNotPublic</span>&nbsp;<span class="builtintype" id="7241772">int</span><br>
<span class="lineno"></span><span class="keyword" id="7241776">type</span>&nbsp;<span class="ident" id="7241781">NeedsPtrType</span>&nbsp;<span class="builtintype" id="7241794">int</span><br>
<span class="lineno">390</span><span class="keyword" id="7241798">type</span>&nbsp;<span class="ident" id="7241803">local</span>&nbsp;<span class="keyword" id="7241809">struct</span><span class="op" id="7241815">{</span><span class="op" id="7241816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7241819">func</span>&nbsp;<span class="op" id="7241824">(</span><span class="ident" id="7241825">t</span>&nbsp;<span class="op" id="7241827">*</span><span class="ident" id="7241828"><a href="/gostd/net/rpc/server_test.go.html#7241710">ReplyNotPointer</a></span><span class="op" id="7241843">)</span>&nbsp;<span class="ident" id="7241845">ReplyNotPointer</span><span class="op" id="7241860">(</span><span class="ident" id="7241861">args</span>&nbsp;<span class="op" id="7241866">*</span><span class="ident" id="7241867"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7241871">,</span>&nbsp;<span class="ident" id="7241873">reply</span>&nbsp;<span class="ident" id="7241879"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7241884">)</span>&nbsp;<span class="builtintype" id="7241886">error</span>&nbsp;<span class="op" id="7241892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7241895">return</span>&nbsp;<span class="builtintype" id="7241902">nil</span><br>
<span class="lineno"></span><span class="op" id="7241906">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="keyword" id="7241909">func</span>&nbsp;<span class="op" id="7241914">(</span><span class="ident" id="7241915">t</span>&nbsp;<span class="op" id="7241917">*</span><span class="ident" id="7241918"><a href="/gostd/net/rpc/server_test.go.html#7241735">ArgNotPublic</a></span><span class="op" id="7241930">)</span>&nbsp;<span class="ident" id="7241932">ArgNotPublic</span><span class="op" id="7241944">(</span><span class="ident" id="7241945">args</span>&nbsp;<span class="op" id="7241950">*</span><span class="ident" id="7241951"><a href="/gostd/net/rpc/server_test.go.html#7241803">local</a></span><span class="op" id="7241956">,</span>&nbsp;<span class="ident" id="7241958">reply</span>&nbsp;<span class="op" id="7241964">*</span><span class="ident" id="7241965"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7241970">)</span>&nbsp;<span class="builtintype" id="7241972">error</span>&nbsp;<span class="op" id="7241978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7241981">return</span>&nbsp;<span class="builtintype" id="7241988">nil</span><br>
<span class="lineno"></span><span class="op" id="7241992">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="keyword" id="7241995">func</span>&nbsp;<span class="op" id="7242000">(</span><span class="ident" id="7242001">t</span>&nbsp;<span class="op" id="7242003">*</span><span class="ident" id="7242004"><a href="/gostd/net/rpc/server_test.go.html#7241757">ReplyNotPublic</a></span><span class="op" id="7242018">)</span>&nbsp;<span class="ident" id="7242020">ReplyNotPublic</span><span class="op" id="7242034">(</span><span class="ident" id="7242035">args</span>&nbsp;<span class="op" id="7242040">*</span><span class="ident" id="7242041"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7242045">,</span>&nbsp;<span class="ident" id="7242047">reply</span>&nbsp;<span class="op" id="7242053">*</span><span class="ident" id="7242054"><a href="/gostd/net/rpc/server_test.go.html#7241803">local</a></span><span class="op" id="7242059">)</span>&nbsp;<span class="builtintype" id="7242061">error</span>&nbsp;<span class="op" id="7242067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7242070">return</span>&nbsp;<span class="builtintype" id="7242077">nil</span><br>
<span class="lineno"></span><span class="op" id="7242081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7242084">func</span>&nbsp;<span class="op" id="7242089">(</span><span class="ident" id="7242090">t</span>&nbsp;<span class="op" id="7242092">*</span><span class="ident" id="7242093"><a href="/gostd/net/rpc/server_test.go.html#7241781">NeedsPtrType</a></span><span class="op" id="7242105">)</span>&nbsp;<span class="ident" id="7242107">NeedsPtrType</span><span class="op" id="7242119">(</span><span class="ident" id="7242120">args</span>&nbsp;<span class="op" id="7242125">*</span><span class="ident" id="7242126"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7242130">,</span>&nbsp;<span class="ident" id="7242132">reply</span>&nbsp;<span class="op" id="7242138">*</span><span class="ident" id="7242139"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7242144">)</span>&nbsp;<span class="builtintype" id="7242146">error</span>&nbsp;<span class="op" id="7242152">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7242155">return</span>&nbsp;<span class="builtintype" id="7242162">nil</span><br>
<span class="lineno"></span><span class="op" id="7242166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7242169">//&nbsp;Check&nbsp;that&nbsp;registration&nbsp;handles&nbsp;lots&nbsp;of&nbsp;bad&nbsp;methods&nbsp;and&nbsp;a&nbsp;type&nbsp;with&nbsp;no&nbsp;suitable&nbsp;methods.</span><br>
<span class="lineno"></span><span class="keyword" id="7242261">func</span>&nbsp;<span class="ident" id="7242266">TestRegistrationError</span><span class="op" id="7242287">(</span><span class="ident" id="7242288">t</span>&nbsp;<span class="op" id="7242290">*</span><span class="ident" id="7242291"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7242298">.</span><span class="ident" id="7242299"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7242300">)</span>&nbsp;<span class="op" id="7242302">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7242305">err</span>&nbsp;<span class="op" id="7242309">:=</span>&nbsp;<span class="ident" id="7242312"><a href="/gostd/net/rpc/server.go.html#5290520">Register</a></span><span class="op" id="7242320">(</span><span class="builtinfunc" id="7242321">new</span><span class="op" id="7242324">(</span><span class="ident" id="7242325"><a href="/gostd/net/rpc/server_test.go.html#7241710">ReplyNotPointer</a></span><span class="op" id="7242340">)</span><span class="op" id="7242341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7242344">if</span>&nbsp;<span class="ident" id="7242347"><a href="/gostd/net/rpc/server_test.go.html#7242305">err</a></span>&nbsp;<span class="op" id="7242351">==</span>&nbsp;<span class="builtintype" id="7242354">nil</span>&nbsp;<span class="op" id="7242358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7242362"><a href="/gostd/net/rpc/server_test.go.html#7242288">t</a></span><span class="op" id="7242363">.</span><span class="ident" id="7242364"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7242369">(</span><span class="string" id="7242370">&#34;expected&nbsp;error&nbsp;registering&nbsp;ReplyNotPointer&#34;</span><span class="op" id="7242414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7242417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7242420"><a href="/gostd/net/rpc/server_test.go.html#7242305">err</a></span>&nbsp;<span class="op" id="7242424">=</span>&nbsp;<span class="ident" id="7242426"><a href="/gostd/net/rpc/server.go.html#5290520">Register</a></span><span class="op" id="7242434">(</span><span class="builtinfunc" id="7242435">new</span><span class="op" id="7242438">(</span><span class="ident" id="7242439"><a href="/gostd/net/rpc/server_test.go.html#7241735">ArgNotPublic</a></span><span class="op" id="7242451">)</span><span class="op" id="7242452">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7242455">if</span>&nbsp;<span class="ident" id="7242458"><a href="/gostd/net/rpc/server_test.go.html#7242305">err</a></span>&nbsp;<span class="op" id="7242462">==</span>&nbsp;<span class="builtintype" id="7242465">nil</span>&nbsp;<span class="op" id="7242469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7242473"><a href="/gostd/net/rpc/server_test.go.html#7242288">t</a></span><span class="op" id="7242474">.</span><span class="ident" id="7242475"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7242480">(</span><span class="string" id="7242481">&#34;expected&nbsp;error&nbsp;registering&nbsp;ArgNotPublic&#34;</span><span class="op" id="7242522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7242525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7242528"><a href="/gostd/net/rpc/server_test.go.html#7242305">err</a></span>&nbsp;<span class="op" id="7242532">=</span>&nbsp;<span class="ident" id="7242534"><a href="/gostd/net/rpc/server.go.html#5290520">Register</a></span><span class="op" id="7242542">(</span><span class="builtinfunc" id="7242543">new</span><span class="op" id="7242546">(</span><span class="ident" id="7242547"><a href="/gostd/net/rpc/server_test.go.html#7241757">ReplyNotPublic</a></span><span class="op" id="7242561">)</span><span class="op" id="7242562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7242565">if</span>&nbsp;<span class="ident" id="7242568"><a href="/gostd/net/rpc/server_test.go.html#7242305">err</a></span>&nbsp;<span class="op" id="7242572">==</span>&nbsp;<span class="builtintype" id="7242575">nil</span>&nbsp;<span class="op" id="7242579">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7242583"><a href="/gostd/net/rpc/server_test.go.html#7242288">t</a></span><span class="op" id="7242584">.</span><span class="ident" id="7242585"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7242590">(</span><span class="string" id="7242591">&#34;expected&nbsp;error&nbsp;registering&nbsp;ReplyNotPublic&#34;</span><span class="op" id="7242634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7242637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7242640"><a href="/gostd/net/rpc/server_test.go.html#7242305">err</a></span>&nbsp;<span class="op" id="7242644">=</span>&nbsp;<span class="ident" id="7242646"><a href="/gostd/net/rpc/server.go.html#5290520">Register</a></span><span class="op" id="7242654">(</span><span class="ident" id="7242655"><a href="/gostd/net/rpc/server_test.go.html#7241781">NeedsPtrType</a></span><span class="op" id="7242667">(</span><span class="num" id="7242668">0</span><span class="op" id="7242669">)</span><span class="op" id="7242670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7242673">if</span>&nbsp;<span class="ident" id="7242676"><a href="/gostd/net/rpc/server_test.go.html#7242305">err</a></span>&nbsp;<span class="op" id="7242680">==</span>&nbsp;<span class="builtintype" id="7242683">nil</span>&nbsp;<span class="op" id="7242687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7242691"><a href="/gostd/net/rpc/server_test.go.html#7242288">t</a></span><span class="op" id="7242692">.</span><span class="ident" id="7242693"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7242698">(</span><span class="string" id="7242699">&#34;expected&nbsp;error&nbsp;registering&nbsp;NeedsPtrType&#34;</span><span class="op" id="7242740">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7242743">}</span>&nbsp;<span class="keyword" id="7242745">else</span>&nbsp;<span class="keyword" id="7242750">if</span>&nbsp;<span class="op" id="7242753">!</span><span class="ident" id="7242754"><a href="/gostd/net/rpc/server_test.go.html#7232748">strings</a></span><span class="op" id="7242761">.</span><span class="ident" id="7242762"><a href="/gostd/strings/strings.go.html#2968416">Contains</a></span><span class="op" id="7242770">(</span><span class="ident" id="7242771"><a href="/gostd/net/rpc/server_test.go.html#7242305">err</a></span><span class="op" id="7242774">.</span><span class="ident" id="7242775">Error</span><span class="op" id="7242780">(</span><span class="op" id="7242781">)</span><span class="op" id="7242782">,</span>&nbsp;<span class="string" id="7242784">&#34;pointer&#34;</span><span class="op" id="7242793">)</span>&nbsp;<span class="op" id="7242795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7242799"><a href="/gostd/net/rpc/server_test.go.html#7242288">t</a></span><span class="op" id="7242800">.</span><span class="ident" id="7242801"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7242806">(</span><span class="string" id="7242807">&#34;expected&nbsp;hint&nbsp;when&nbsp;registering&nbsp;NeedsPtrType&#34;</span><span class="op" id="7242852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7242855">}</span><br>
<span class="lineno"></span><span class="op" id="7242857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span><span class="keyword" id="7242860">type</span>&nbsp;<span class="ident" id="7242865">WriteFailCodec</span>&nbsp;<span class="builtintype" id="7242880">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7242885">func</span>&nbsp;<span class="op" id="7242890">(</span><span class="ident" id="7242891"><a href="/gostd/net/rpc/server_test.go.html#7242865">WriteFailCodec</a></span><span class="op" id="7242905">)</span>&nbsp;<span class="ident" id="7242907">WriteRequest</span><span class="op" id="7242919">(</span><span class="op" id="7242920">*</span><span class="ident" id="7242921"><a href="/gostd/net/rpc/server.go.html#5277366">Request</a></span><span class="op" id="7242928">,</span>&nbsp;<span class="keyword" id="7242930">interface</span><span class="op" id="7242939">{</span><span class="op" id="7242940">}</span><span class="op" id="7242941">)</span>&nbsp;<span class="builtintype" id="7242943">error</span>&nbsp;<span class="op" id="7242949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7242952">//&nbsp;the&nbsp;panic&nbsp;caused&nbsp;by&nbsp;this&nbsp;error&nbsp;used&nbsp;to&nbsp;not&nbsp;unlock&nbsp;a&nbsp;lock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7243014">return</span>&nbsp;<span class="ident" id="7243021"><a href="/gostd/net/rpc/server_test.go.html#7232679">errors</a></span><span class="op" id="7243027">.</span><span class="ident" id="7243028"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="7243031">(</span><span class="string" id="7243032">&#34;fail&#34;</span><span class="op" id="7243038">)</span><br>
<span class="lineno">435</span><span class="op" id="7243040">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7243043">func</span>&nbsp;<span class="op" id="7243048">(</span><span class="ident" id="7243049"><a href="/gostd/net/rpc/server_test.go.html#7242865">WriteFailCodec</a></span><span class="op" id="7243063">)</span>&nbsp;<span class="ident" id="7243065">ReadResponseHeader</span><span class="op" id="7243083">(</span><span class="op" id="7243084">*</span><span class="ident" id="7243085"><a href="/gostd/net/rpc/server.go.html#5277724">Response</a></span><span class="op" id="7243093">)</span>&nbsp;<span class="builtintype" id="7243095">error</span>&nbsp;<span class="op" id="7243101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7243104">select</span>&nbsp;<span class="op" id="7243111">{</span><span class="op" id="7243112">}</span><br>
<span class="lineno"></span><span class="op" id="7243114">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span><span class="keyword" id="7243117">func</span>&nbsp;<span class="op" id="7243122">(</span><span class="ident" id="7243123"><a href="/gostd/net/rpc/server_test.go.html#7242865">WriteFailCodec</a></span><span class="op" id="7243137">)</span>&nbsp;<span class="ident" id="7243139">ReadResponseBody</span><span class="op" id="7243155">(</span><span class="keyword" id="7243156">interface</span><span class="op" id="7243165">{</span><span class="op" id="7243166">}</span><span class="op" id="7243167">)</span>&nbsp;<span class="builtintype" id="7243169">error</span>&nbsp;<span class="op" id="7243175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7243178">select</span>&nbsp;<span class="op" id="7243185">{</span><span class="op" id="7243186">}</span><br>
<span class="lineno"></span><span class="op" id="7243188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span><span class="keyword" id="7243191">func</span>&nbsp;<span class="op" id="7243196">(</span><span class="ident" id="7243197"><a href="/gostd/net/rpc/server_test.go.html#7242865">WriteFailCodec</a></span><span class="op" id="7243211">)</span>&nbsp;<span class="ident" id="7243213">Close</span><span class="op" id="7243218">(</span><span class="op" id="7243219">)</span>&nbsp;<span class="builtintype" id="7243221">error</span>&nbsp;<span class="op" id="7243227">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7243230">return</span>&nbsp;<span class="builtintype" id="7243237">nil</span><br>
<span class="lineno"></span><span class="op" id="7243241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7243244">func</span>&nbsp;<span class="ident" id="7243249">TestSendDeadlock</span><span class="op" id="7243265">(</span><span class="ident" id="7243266">t</span>&nbsp;<span class="op" id="7243268">*</span><span class="ident" id="7243269"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7243276">.</span><span class="ident" id="7243277"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7243278">)</span>&nbsp;<span class="op" id="7243280">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7243283">client</span>&nbsp;<span class="op" id="7243290">:=</span>&nbsp;<span class="ident" id="7243293"><a href="/gostd/net/rpc/client.go.html#5266672">NewClientWithCodec</a></span><span class="op" id="7243311">(</span><span class="ident" id="7243312"><a href="/gostd/net/rpc/server_test.go.html#7242865">WriteFailCodec</a></span><span class="op" id="7243326">(</span><span class="num" id="7243327">0</span><span class="op" id="7243328">)</span><span class="op" id="7243329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7243332">defer</span>&nbsp;<span class="ident" id="7243338"><a href="/gostd/net/rpc/server_test.go.html#7243283">client</a></span><span class="op" id="7243344">.</span><span class="ident" id="7243345"><a href="/gostd/net/rpc/client.go.html#5268682">Close</a></span><span class="op" id="7243350">(</span><span class="op" id="7243351">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7243355">done</span>&nbsp;<span class="op" id="7243360">:=</span>&nbsp;<span class="builtinfunc" id="7243363">make</span><span class="op" id="7243367">(</span><span class="keyword" id="7243368">chan</span>&nbsp;<span class="builtintype" id="7243373">bool</span><span class="op" id="7243377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7243380">go</span>&nbsp;<span class="keyword" id="7243383">func</span><span class="op" id="7243387">(</span><span class="op" id="7243388">)</span>&nbsp;<span class="op" id="7243390">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7243394"><a href="/gostd/net/rpc/server_test.go.html#7243569">testSendDeadlock</a></span><span class="op" id="7243410">(</span><span class="ident" id="7243411"><a href="/gostd/net/rpc/server_test.go.html#7243283">client</a></span><span class="op" id="7243417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7243421"><a href="/gostd/net/rpc/server_test.go.html#7243569">testSendDeadlock</a></span><span class="op" id="7243437">(</span><span class="ident" id="7243438"><a href="/gostd/net/rpc/server_test.go.html#7243283">client</a></span><span class="op" id="7243444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7243448"><a href="/gostd/net/rpc/server_test.go.html#7243355">done</a></span>&nbsp;<span class="op" id="7243453">&lt;-</span>&nbsp;<span class="builtintype" id="7243456">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7243462">}</span><span class="op" id="7243463">(</span><span class="op" id="7243464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7243467">select</span>&nbsp;<span class="op" id="7243474">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7243477">case</span>&nbsp;<span class="op" id="7243482">&lt;-</span><span class="ident" id="7243484"><a href="/gostd/net/rpc/server_test.go.html#7243355">done</a></span><span class="op" id="7243488">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7243492">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7243500">case</span>&nbsp;<span class="op" id="7243505">&lt;-</span><span class="ident" id="7243507"><a href="/gostd/net/rpc/server_test.go.html#7232793">time</a></span><span class="op" id="7243511">.</span><span class="ident" id="7243512"><a href="/gostd/time/sleep.go.html#2716644">After</a></span><span class="op" id="7243517">(</span><span class="num" id="7243518">5</span>&nbsp;<span class="op" id="7243520">*</span>&nbsp;<span class="ident" id="7243522"><a href="/gostd/net/rpc/server_test.go.html#7232793">time</a></span><span class="op" id="7243526">.</span><span class="ident" id="7243527"><a href="/gostd/time/time.go.html#2734862">Second</a></span><span class="op" id="7243533">)</span><span class="op" id="7243534">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7243538"><a href="/gostd/net/rpc/server_test.go.html#7243266">t</a></span><span class="op" id="7243539">.</span><span class="ident" id="7243540"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7243545">(</span><span class="string" id="7243546">&#34;deadlock&#34;</span><span class="op" id="7243556">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7243559">}</span><br>
<span class="lineno">465</span><span class="op" id="7243561">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7243564">func</span>&nbsp;<span class="ident" id="7243569">testSendDeadlock</span><span class="op" id="7243585">(</span><span class="ident" id="7243586">client</span>&nbsp;<span class="op" id="7243593">*</span><span class="ident" id="7243594"><a href="/gostd/net/rpc/client.go.html#5262362">Client</a></span><span class="op" id="7243600">)</span>&nbsp;<span class="op" id="7243602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7243605">defer</span>&nbsp;<span class="keyword" id="7243611">func</span><span class="op" id="7243615">(</span><span class="op" id="7243616">)</span>&nbsp;<span class="op" id="7243618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7243622">recover</span><span class="op" id="7243629">(</span><span class="op" id="7243630">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7243633">}</span><span class="op" id="7243634">(</span><span class="op" id="7243635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7243638">args</span>&nbsp;<span class="op" id="7243643">:=</span>&nbsp;<span class="op" id="7243646">&amp;</span><span class="ident" id="7243647"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7243651">{</span><span class="num" id="7243652">7</span><span class="op" id="7243653">,</span>&nbsp;<span class="num" id="7243655">8</span><span class="op" id="7243656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7243659">reply</span>&nbsp;<span class="op" id="7243665">:=</span>&nbsp;<span class="builtinfunc" id="7243668">new</span><span class="op" id="7243671">(</span><span class="ident" id="7243672"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7243677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7243680"><a href="/gostd/net/rpc/server_test.go.html#7243586">client</a></span><span class="op" id="7243686">.</span><span class="ident" id="7243687"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="7243691">(</span><span class="string" id="7243692">&#34;Arith.Add&#34;</span><span class="op" id="7243703">,</span>&nbsp;<span class="ident" id="7243705"><a href="/gostd/net/rpc/server_test.go.html#7243638">args</a></span><span class="op" id="7243709">,</span>&nbsp;<span class="ident" id="7243711"><a href="/gostd/net/rpc/server_test.go.html#7243659">reply</a></span><span class="op" id="7243716">)</span><br>
<span class="lineno"></span><span class="op" id="7243718">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span><span class="keyword" id="7243721">func</span>&nbsp;<span class="ident" id="7243726">dialDirect</span><span class="op" id="7243736">(</span><span class="op" id="7243737">)</span>&nbsp;<span class="op" id="7243739">(</span><span class="op" id="7243740">*</span><span class="ident" id="7243741"><a href="/gostd/net/rpc/client.go.html#5262362">Client</a></span><span class="op" id="7243747">,</span>&nbsp;<span class="builtintype" id="7243749">error</span><span class="op" id="7243754">)</span>&nbsp;<span class="op" id="7243756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7243759">return</span>&nbsp;<span class="ident" id="7243766"><a href="/gostd/net/rpc/client.go.html#5268500">Dial</a></span><span class="op" id="7243770">(</span><span class="string" id="7243771">&#34;tcp&#34;</span><span class="op" id="7243776">,</span>&nbsp;<span class="ident" id="7243778"><a href="/gostd/net/rpc/server_test.go.html#7232845">serverAddr</a></span><span class="op" id="7243788">)</span><br>
<span class="lineno"></span><span class="op" id="7243790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="keyword" id="7243793">func</span>&nbsp;<span class="ident" id="7243798">dialHTTP</span><span class="op" id="7243806">(</span><span class="op" id="7243807">)</span>&nbsp;<span class="op" id="7243809">(</span><span class="op" id="7243810">*</span><span class="ident" id="7243811"><a href="/gostd/net/rpc/client.go.html#5262362">Client</a></span><span class="op" id="7243817">,</span>&nbsp;<span class="builtintype" id="7243819">error</span><span class="op" id="7243824">)</span>&nbsp;<span class="op" id="7243826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7243829">return</span>&nbsp;<span class="ident" id="7243836"><a href="/gostd/net/rpc/client.go.html#5267553">DialHTTP</a></span><span class="op" id="7243844">(</span><span class="string" id="7243845">&#34;tcp&#34;</span><span class="op" id="7243850">,</span>&nbsp;<span class="ident" id="7243852"><a href="/gostd/net/rpc/server_test.go.html#7232879">httpServerAddr</a></span><span class="op" id="7243866">)</span><br>
<span class="lineno"></span><span class="op" id="7243868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7243871">func</span>&nbsp;<span class="ident" id="7243876">countMallocs</span><span class="op" id="7243888">(</span><span class="ident" id="7243889">dial</span>&nbsp;<span class="keyword" id="7243894">func</span><span class="op" id="7243898">(</span><span class="op" id="7243899">)</span>&nbsp;<span class="op" id="7243901">(</span><span class="op" id="7243902">*</span><span class="ident" id="7243903"><a href="/gostd/net/rpc/client.go.html#5262362">Client</a></span><span class="op" id="7243909">,</span>&nbsp;<span class="builtintype" id="7243911">error</span><span class="op" id="7243916">)</span><span class="op" id="7243917">,</span>&nbsp;<span class="ident" id="7243919">t</span>&nbsp;<span class="op" id="7243921">*</span><span class="ident" id="7243922"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7243929">.</span><span class="ident" id="7243930"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7243931">)</span>&nbsp;<span class="builtintype" id="7243933">float64</span>&nbsp;<span class="op" id="7243941">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7243944"><a href="/gostd/net/rpc/server_test.go.html#7232913">once</a></span><span class="op" id="7243948">.</span><span class="ident" id="7243949"><a href="/gostd/sync/once.go.html#1447110">Do</a></span><span class="op" id="7243951">(</span><span class="ident" id="7243952"><a href="/gostd/net/rpc/server_test.go.html#7234023">startServer</a></span><span class="op" id="7243963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7243966">client</span><span class="op" id="7243972">,</span>&nbsp;<span class="ident" id="7243974">err</span>&nbsp;<span class="op" id="7243978">:=</span>&nbsp;<span class="ident" id="7243981"><a href="/gostd/net/rpc/server_test.go.html#7243889">dial</a></span><span class="op" id="7243985">(</span><span class="op" id="7243986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7243989">if</span>&nbsp;<span class="ident" id="7243992"><a href="/gostd/net/rpc/server_test.go.html#7243974">err</a></span>&nbsp;<span class="op" id="7243996">!=</span>&nbsp;<span class="builtintype" id="7243999">nil</span>&nbsp;<span class="op" id="7244003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7244007"><a href="/gostd/net/rpc/server_test.go.html#7243919">t</a></span><span class="op" id="7244008">.</span><span class="ident" id="7244009"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7244014">(</span><span class="string" id="7244015">&#34;error&nbsp;dialing&#34;</span><span class="op" id="7244030">,</span>&nbsp;<span class="ident" id="7244032"><a href="/gostd/net/rpc/server_test.go.html#7243974">err</a></span><span class="op" id="7244035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7244038">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7244041">defer</span>&nbsp;<span class="ident" id="7244047"><a href="/gostd/net/rpc/server_test.go.html#7243966">client</a></span><span class="op" id="7244053">.</span><span class="ident" id="7244054"><a href="/gostd/net/rpc/client.go.html#5268682">Close</a></span><span class="op" id="7244059">(</span><span class="op" id="7244060">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7244064">args</span>&nbsp;<span class="op" id="7244069">:=</span>&nbsp;<span class="op" id="7244072">&amp;</span><span class="ident" id="7244073"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7244077">{</span><span class="num" id="7244078">7</span><span class="op" id="7244079">,</span>&nbsp;<span class="num" id="7244081">8</span><span class="op" id="7244082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7244085">reply</span>&nbsp;<span class="op" id="7244091">:=</span>&nbsp;<span class="builtinfunc" id="7244094">new</span><span class="op" id="7244097">(</span><span class="ident" id="7244098"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7244103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7244106">return</span>&nbsp;<span class="ident" id="7244113"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7244120">.</span><span class="ident" id="7244121"><a href="/gostd/testing/allocs.go.html#5449197">AllocsPerRun</a></span><span class="op" id="7244133">(</span><span class="num" id="7244134">100</span><span class="op" id="7244137">,</span>&nbsp;<span class="keyword" id="7244139">func</span><span class="op" id="7244143">(</span><span class="op" id="7244144">)</span>&nbsp;<span class="op" id="7244146">{</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7244150">err</span>&nbsp;<span class="op" id="7244154">:=</span>&nbsp;<span class="ident" id="7244157"><a href="/gostd/net/rpc/server_test.go.html#7243966">client</a></span><span class="op" id="7244163">.</span><span class="ident" id="7244164"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="7244168">(</span><span class="string" id="7244169">&#34;Arith.Add&#34;</span><span class="op" id="7244180">,</span>&nbsp;<span class="ident" id="7244182"><a href="/gostd/net/rpc/server_test.go.html#7244064">args</a></span><span class="op" id="7244186">,</span>&nbsp;<span class="ident" id="7244188"><a href="/gostd/net/rpc/server_test.go.html#7244085">reply</a></span><span class="op" id="7244193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7244197">if</span>&nbsp;<span class="ident" id="7244200"><a href="/gostd/net/rpc/server_test.go.html#7244150">err</a></span>&nbsp;<span class="op" id="7244204">!=</span>&nbsp;<span class="builtintype" id="7244207">nil</span>&nbsp;<span class="op" id="7244211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7244216"><a href="/gostd/net/rpc/server_test.go.html#7243919">t</a></span><span class="op" id="7244217">.</span><span class="ident" id="7244218"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7244224">(</span><span class="string" id="7244225">&#34;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7244267">,</span>&nbsp;<span class="ident" id="7244269"><a href="/gostd/net/rpc/server_test.go.html#7244150">err</a></span><span class="op" id="7244272">.</span><span class="ident" id="7244273">Error</span><span class="op" id="7244278">(</span><span class="op" id="7244279">)</span><span class="op" id="7244280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7244284">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7244288">if</span>&nbsp;<span class="ident" id="7244291"><a href="/gostd/net/rpc/server_test.go.html#7244085">reply</a></span><span class="op" id="7244296">.</span><span class="ident" id="7244297"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span>&nbsp;<span class="op" id="7244299">!=</span>&nbsp;<span class="ident" id="7244302"><a href="/gostd/net/rpc/server_test.go.html#7244064">args</a></span><span class="op" id="7244306">.</span><span class="ident" id="7244307"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7244308">+</span><span class="ident" id="7244309"><a href="/gostd/net/rpc/server_test.go.html#7244064">args</a></span><span class="op" id="7244313">.</span><span class="ident" id="7244314"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span>&nbsp;<span class="op" id="7244316">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7244321"><a href="/gostd/net/rpc/server_test.go.html#7243919">t</a></span><span class="op" id="7244322">.</span><span class="ident" id="7244323"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7244329">(</span><span class="string" id="7244330">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7244355">,</span>&nbsp;<span class="ident" id="7244357"><a href="/gostd/net/rpc/server_test.go.html#7244085">reply</a></span><span class="op" id="7244362">.</span><span class="ident" id="7244363"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span><span class="op" id="7244364">,</span>&nbsp;<span class="ident" id="7244366"><a href="/gostd/net/rpc/server_test.go.html#7244064">args</a></span><span class="op" id="7244370">.</span><span class="ident" id="7244371"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7244372">+</span><span class="ident" id="7244373"><a href="/gostd/net/rpc/server_test.go.html#7244064">args</a></span><span class="op" id="7244377">.</span><span class="ident" id="7244378"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><span class="op" id="7244379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7244383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7244386">}</span><span class="op" id="7244387">)</span><br>
<span class="lineno"></span><span class="op" id="7244389">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">505</span><span class="keyword" id="7244392">func</span>&nbsp;<span class="ident" id="7244397">TestCountMallocs</span><span class="op" id="7244413">(</span><span class="ident" id="7244414">t</span>&nbsp;<span class="op" id="7244416">*</span><span class="ident" id="7244417"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7244424">.</span><span class="ident" id="7244425"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7244426">)</span>&nbsp;<span class="op" id="7244428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7244431">if</span>&nbsp;<span class="ident" id="7244434"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7244441">.</span><span class="ident" id="7244442"><a href="/gostd/testing/testing.go.html#5475359">Short</a></span><span class="op" id="7244447">(</span><span class="op" id="7244448">)</span>&nbsp;<span class="op" id="7244450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7244454"><a href="/gostd/net/rpc/server_test.go.html#7244414">t</a></span><span class="op" id="7244455">.</span><span class="ident" id="7244456"><a href="/gostd/testing/testing.go.html#5480575">Skip</a></span><span class="op" id="7244460">(</span><span class="string" id="7244461">&#34;skipping&nbsp;malloc&nbsp;count&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="7244498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7244501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7244504">if</span>&nbsp;<span class="ident" id="7244507"><a href="/gostd/net/rpc/server_test.go.html#7232737">runtime</a></span><span class="op" id="7244514">.</span><span class="ident" id="7244515"><a href="/gostd/runtime/debug.go.html#1521359">GOMAXPROCS</a></span><span class="op" id="7244525">(</span><span class="num" id="7244526">0</span><span class="op" id="7244527">)</span>&nbsp;<span class="op" id="7244529">&gt;</span>&nbsp;<span class="num" id="7244531">1</span>&nbsp;<span class="op" id="7244533">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7244537"><a href="/gostd/net/rpc/server_test.go.html#7244414">t</a></span><span class="op" id="7244538">.</span><span class="ident" id="7244539"><a href="/gostd/testing/testing.go.html#5480575">Skip</a></span><span class="op" id="7244543">(</span><span class="string" id="7244544">&#34;skipping;&nbsp;GOMAXPROCS&gt;1&#34;</span><span class="op" id="7244568">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7244571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7244574"><a href="/gostd/net/rpc/server_test.go.html#7232689">fmt</a></span><span class="op" id="7244577">.</span><span class="ident" id="7244578"><a href="/gostd/fmt/print.go.html#2143442">Printf</a></span><span class="op" id="7244584">(</span><span class="string" id="7244585">&#34;mallocs&nbsp;per&nbsp;rpc&nbsp;round&nbsp;trip:&nbsp;%v\n&#34;</span><span class="op" id="7244619">,</span>&nbsp;<span class="ident" id="7244621"><a href="/gostd/net/rpc/server_test.go.html#7243876">countMallocs</a></span><span class="op" id="7244633">(</span><span class="ident" id="7244634"><a href="/gostd/net/rpc/server_test.go.html#7243726">dialDirect</a></span><span class="op" id="7244644">,</span>&nbsp;<span class="ident" id="7244646"><a href="/gostd/net/rpc/server_test.go.html#7244414">t</a></span><span class="op" id="7244647">)</span><span class="op" id="7244648">)</span><br>
<span class="lineno"></span><span class="op" id="7244650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="7244653">func</span>&nbsp;<span class="ident" id="7244658">TestCountMallocsOverHTTP</span><span class="op" id="7244682">(</span><span class="ident" id="7244683">t</span>&nbsp;<span class="op" id="7244685">*</span><span class="ident" id="7244686"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7244693">.</span><span class="ident" id="7244694"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7244695">)</span>&nbsp;<span class="op" id="7244697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7244700">if</span>&nbsp;<span class="ident" id="7244703"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7244710">.</span><span class="ident" id="7244711"><a href="/gostd/testing/testing.go.html#5475359">Short</a></span><span class="op" id="7244716">(</span><span class="op" id="7244717">)</span>&nbsp;<span class="op" id="7244719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7244723"><a href="/gostd/net/rpc/server_test.go.html#7244683">t</a></span><span class="op" id="7244724">.</span><span class="ident" id="7244725"><a href="/gostd/testing/testing.go.html#5480575">Skip</a></span><span class="op" id="7244729">(</span><span class="string" id="7244730">&#34;skipping&nbsp;malloc&nbsp;count&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="7244767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7244770">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7244773">if</span>&nbsp;<span class="ident" id="7244776"><a href="/gostd/net/rpc/server_test.go.html#7232737">runtime</a></span><span class="op" id="7244783">.</span><span class="ident" id="7244784"><a href="/gostd/runtime/debug.go.html#1521359">GOMAXPROCS</a></span><span class="op" id="7244794">(</span><span class="num" id="7244795">0</span><span class="op" id="7244796">)</span>&nbsp;<span class="op" id="7244798">&gt;</span>&nbsp;<span class="num" id="7244800">1</span>&nbsp;<span class="op" id="7244802">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7244806"><a href="/gostd/net/rpc/server_test.go.html#7244683">t</a></span><span class="op" id="7244807">.</span><span class="ident" id="7244808"><a href="/gostd/testing/testing.go.html#5480575">Skip</a></span><span class="op" id="7244812">(</span><span class="string" id="7244813">&#34;skipping;&nbsp;GOMAXPROCS&gt;1&#34;</span><span class="op" id="7244837">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7244840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7244843"><a href="/gostd/net/rpc/server_test.go.html#7232689">fmt</a></span><span class="op" id="7244846">.</span><span class="ident" id="7244847"><a href="/gostd/fmt/print.go.html#2143442">Printf</a></span><span class="op" id="7244853">(</span><span class="string" id="7244854">&#34;mallocs&nbsp;per&nbsp;HTTP&nbsp;rpc&nbsp;round&nbsp;trip:&nbsp;%v\n&#34;</span><span class="op" id="7244893">,</span>&nbsp;<span class="ident" id="7244895"><a href="/gostd/net/rpc/server_test.go.html#7243876">countMallocs</a></span><span class="op" id="7244907">(</span><span class="ident" id="7244908"><a href="/gostd/net/rpc/server_test.go.html#7243798">dialHTTP</a></span><span class="op" id="7244916">,</span>&nbsp;<span class="ident" id="7244918"><a href="/gostd/net/rpc/server_test.go.html#7244683">t</a></span><span class="op" id="7244919">)</span><span class="op" id="7244920">)</span><br>
<span class="lineno"></span><span class="op" id="7244922">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">525</span><span class="keyword" id="7244925">type</span>&nbsp;<span class="ident" id="7244930">writeCrasher</span>&nbsp;<span class="keyword" id="7244943">struct</span>&nbsp;<span class="op" id="7244950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7244953">done</span>&nbsp;<span class="keyword" id="7244958">chan</span>&nbsp;<span class="builtintype" id="7244963">bool</span><br>
<span class="lineno"></span><span class="op" id="7244968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7244971">func</span>&nbsp;<span class="op" id="7244976">(</span><span class="ident" id="7244977"><a href="/gostd/net/rpc/server_test.go.html#7244930">writeCrasher</a></span><span class="op" id="7244989">)</span>&nbsp;<span class="ident" id="7244991">Close</span><span class="op" id="7244996">(</span><span class="op" id="7244997">)</span>&nbsp;<span class="builtintype" id="7244999">error</span>&nbsp;<span class="op" id="7245005">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7245008">return</span>&nbsp;<span class="builtintype" id="7245015">nil</span><br>
<span class="lineno"></span><span class="op" id="7245019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7245022">func</span>&nbsp;<span class="op" id="7245027">(</span><span class="ident" id="7245028">w</span>&nbsp;<span class="op" id="7245030">*</span><span class="ident" id="7245031"><a href="/gostd/net/rpc/server_test.go.html#7244930">writeCrasher</a></span><span class="op" id="7245043">)</span>&nbsp;<span class="ident" id="7245045">Read</span><span class="op" id="7245049">(</span><span class="ident" id="7245050">p</span>&nbsp;<span class="op" id="7245052">[</span><span class="op" id="7245053">]</span><span class="builtintype" id="7245054">byte</span><span class="op" id="7245058">)</span>&nbsp;<span class="op" id="7245060">(</span><span class="builtintype" id="7245061">int</span><span class="op" id="7245064">,</span>&nbsp;<span class="builtintype" id="7245066">error</span><span class="op" id="7245071">)</span>&nbsp;<span class="op" id="7245073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7245076">&lt;-</span><span class="ident" id="7245078"><a href="/gostd/net/rpc/server_test.go.html#7245028">w</a></span><span class="op" id="7245079">.</span><span class="ident" id="7245080"><a href="/gostd/net/rpc/server_test.go.html#7244953">done</a></span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7245086">return</span>&nbsp;<span class="num" id="7245093">0</span><span class="op" id="7245094">,</span>&nbsp;<span class="ident" id="7245096"><a href="/gostd/net/rpc/server_test.go.html#7232696">io</a></span><span class="op" id="7245098">.</span><span class="ident" id="7245099"><a href="/gostd/io/io.go.html#1419950">EOF</a></span><br>
<span class="lineno"></span><span class="op" id="7245103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7245106">func</span>&nbsp;<span class="op" id="7245111">(</span><span class="ident" id="7245112"><a href="/gostd/net/rpc/server_test.go.html#7244930">writeCrasher</a></span><span class="op" id="7245124">)</span>&nbsp;<span class="ident" id="7245126">Write</span><span class="op" id="7245131">(</span><span class="ident" id="7245132">p</span>&nbsp;<span class="op" id="7245134">[</span><span class="op" id="7245135">]</span><span class="builtintype" id="7245136">byte</span><span class="op" id="7245140">)</span>&nbsp;<span class="op" id="7245142">(</span><span class="builtintype" id="7245143">int</span><span class="op" id="7245146">,</span>&nbsp;<span class="builtintype" id="7245148">error</span><span class="op" id="7245153">)</span>&nbsp;<span class="op" id="7245155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7245158">return</span>&nbsp;<span class="num" id="7245165">0</span><span class="op" id="7245166">,</span>&nbsp;<span class="ident" id="7245168"><a href="/gostd/net/rpc/server_test.go.html#7232679">errors</a></span><span class="op" id="7245174">.</span><span class="ident" id="7245175"><a href="/gostd/errors/errors.go.html#1418493">New</a></span><span class="op" id="7245178">(</span><span class="string" id="7245179">&#34;fake&nbsp;write&nbsp;failure&#34;</span><span class="op" id="7245199">)</span><br>
<span class="lineno">540</span><span class="op" id="7245201">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7245204">func</span>&nbsp;<span class="ident" id="7245209">TestClientWriteError</span><span class="op" id="7245229">(</span><span class="ident" id="7245230">t</span>&nbsp;<span class="op" id="7245232">*</span><span class="ident" id="7245233"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7245240">.</span><span class="ident" id="7245241"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7245242">)</span>&nbsp;<span class="op" id="7245244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7245247">w</span>&nbsp;<span class="op" id="7245249">:=</span>&nbsp;<span class="op" id="7245252">&amp;</span><span class="ident" id="7245253"><a href="/gostd/net/rpc/server_test.go.html#7244930">writeCrasher</a></span><span class="op" id="7245265">{</span><span class="ident" id="7245266"><a href="/gostd/net/rpc/server_test.go.html#7244953">done</a></span><span class="op" id="7245270">:</span>&nbsp;<span class="builtinfunc" id="7245272">make</span><span class="op" id="7245276">(</span><span class="keyword" id="7245277">chan</span>&nbsp;<span class="builtintype" id="7245282">bool</span><span class="op" id="7245286">)</span><span class="op" id="7245287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7245290">c</span>&nbsp;<span class="op" id="7245292">:=</span>&nbsp;<span class="ident" id="7245295"><a href="/gostd/net/rpc/client.go.html#5266351">NewClient</a></span><span class="op" id="7245304">(</span><span class="ident" id="7245305"><a href="/gostd/net/rpc/server_test.go.html#7245247">w</a></span><span class="op" id="7245306">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7245309">defer</span>&nbsp;<span class="ident" id="7245315"><a href="/gostd/net/rpc/server_test.go.html#7245290">c</a></span><span class="op" id="7245316">.</span><span class="ident" id="7245317"><a href="/gostd/net/rpc/client.go.html#5268682">Close</a></span><span class="op" id="7245322">(</span><span class="op" id="7245323">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7245327">res</span>&nbsp;<span class="op" id="7245331">:=</span>&nbsp;<span class="builtintype" id="7245334">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7245341">err</span>&nbsp;<span class="op" id="7245345">:=</span>&nbsp;<span class="ident" id="7245348"><a href="/gostd/net/rpc/server_test.go.html#7245290">c</a></span><span class="op" id="7245349">.</span><span class="ident" id="7245350"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="7245354">(</span><span class="string" id="7245355">&#34;foo&#34;</span><span class="op" id="7245360">,</span>&nbsp;<span class="num" id="7245362">1</span><span class="op" id="7245363">,</span>&nbsp;<span class="op" id="7245365">&amp;</span><span class="ident" id="7245366"><a href="/gostd/net/rpc/server_test.go.html#7245327">res</a></span><span class="op" id="7245369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7245372">if</span>&nbsp;<span class="ident" id="7245375"><a href="/gostd/net/rpc/server_test.go.html#7245341">err</a></span>&nbsp;<span class="op" id="7245379">==</span>&nbsp;<span class="builtintype" id="7245382">nil</span>&nbsp;<span class="op" id="7245386">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7245390"><a href="/gostd/net/rpc/server_test.go.html#7245230">t</a></span><span class="op" id="7245391">.</span><span class="ident" id="7245392"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7245397">(</span><span class="string" id="7245398">&#34;expected&nbsp;error&#34;</span><span class="op" id="7245414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7245417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7245420">if</span>&nbsp;<span class="ident" id="7245423"><a href="/gostd/net/rpc/server_test.go.html#7245341">err</a></span><span class="op" id="7245426">.</span><span class="ident" id="7245427">Error</span><span class="op" id="7245432">(</span><span class="op" id="7245433">)</span>&nbsp;<span class="op" id="7245435">!=</span>&nbsp;<span class="string" id="7245438">&#34;fake&nbsp;write&nbsp;failure&#34;</span>&nbsp;<span class="op" id="7245459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7245463"><a href="/gostd/net/rpc/server_test.go.html#7245230">t</a></span><span class="op" id="7245464">.</span><span class="ident" id="7245465"><a href="/gostd/testing/testing.go.html#5479963">Error</a></span><span class="op" id="7245470">(</span><span class="string" id="7245471">&#34;unexpected&nbsp;value&nbsp;of&nbsp;error:&#34;</span><span class="op" id="7245499">,</span>&nbsp;<span class="ident" id="7245501"><a href="/gostd/net/rpc/server_test.go.html#7245341">err</a></span><span class="op" id="7245504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7245507">}</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7245510"><a href="/gostd/net/rpc/server_test.go.html#7245247">w</a></span><span class="op" id="7245511">.</span><span class="ident" id="7245512"><a href="/gostd/net/rpc/server_test.go.html#7244953">done</a></span>&nbsp;<span class="op" id="7245517">&lt;-</span>&nbsp;<span class="builtintype" id="7245520">true</span><br>
<span class="lineno"></span><span class="op" id="7245525">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7245528">func</span>&nbsp;<span class="ident" id="7245533">TestTCPClose</span><span class="op" id="7245545">(</span><span class="ident" id="7245546">t</span>&nbsp;<span class="op" id="7245548">*</span><span class="ident" id="7245549"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7245556">.</span><span class="ident" id="7245557"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7245558">)</span>&nbsp;<span class="op" id="7245560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7245563"><a href="/gostd/net/rpc/server_test.go.html#7232913">once</a></span><span class="op" id="7245567">.</span><span class="ident" id="7245568"><a href="/gostd/sync/once.go.html#1447110">Do</a></span><span class="op" id="7245570">(</span><span class="ident" id="7245571"><a href="/gostd/net/rpc/server_test.go.html#7234023">startServer</a></span><span class="op" id="7245582">)</span><br>
<span class="lineno">560</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7245586">client</span><span class="op" id="7245592">,</span>&nbsp;<span class="ident" id="7245594">err</span>&nbsp;<span class="op" id="7245598">:=</span>&nbsp;<span class="ident" id="7245601"><a href="/gostd/net/rpc/server_test.go.html#7243798">dialHTTP</a></span><span class="op" id="7245609">(</span><span class="op" id="7245610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7245613">if</span>&nbsp;<span class="ident" id="7245616"><a href="/gostd/net/rpc/server_test.go.html#7245594">err</a></span>&nbsp;<span class="op" id="7245620">!=</span>&nbsp;<span class="builtintype" id="7245623">nil</span>&nbsp;<span class="op" id="7245627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7245631"><a href="/gostd/net/rpc/server_test.go.html#7245546">t</a></span><span class="op" id="7245632">.</span><span class="ident" id="7245633"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7245639">(</span><span class="string" id="7245640">&#34;dialing:&nbsp;%v&#34;</span><span class="op" id="7245653">,</span>&nbsp;<span class="ident" id="7245655"><a href="/gostd/net/rpc/server_test.go.html#7245594">err</a></span><span class="op" id="7245658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7245661">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7245664">defer</span>&nbsp;<span class="ident" id="7245670"><a href="/gostd/net/rpc/server_test.go.html#7245586">client</a></span><span class="op" id="7245676">.</span><span class="ident" id="7245677"><a href="/gostd/net/rpc/client.go.html#5268682">Close</a></span><span class="op" id="7245682">(</span><span class="op" id="7245683">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7245687">args</span>&nbsp;<span class="op" id="7245692">:=</span>&nbsp;<span class="ident" id="7245695"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7245699">{</span><span class="num" id="7245700">17</span><span class="op" id="7245702">,</span>&nbsp;<span class="num" id="7245704">8</span><span class="op" id="7245705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7245708">var</span>&nbsp;<span class="ident" id="7245712">reply</span>&nbsp;<span class="ident" id="7245718"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7245725"><a href="/gostd/net/rpc/server_test.go.html#7245594">err</a></span>&nbsp;<span class="op" id="7245729">=</span>&nbsp;<span class="ident" id="7245731"><a href="/gostd/net/rpc/server_test.go.html#7245586">client</a></span><span class="op" id="7245737">.</span><span class="ident" id="7245738"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="7245742">(</span><span class="string" id="7245743">&#34;Arith.Mul&#34;</span><span class="op" id="7245754">,</span>&nbsp;<span class="ident" id="7245756"><a href="/gostd/net/rpc/server_test.go.html#7245687">args</a></span><span class="op" id="7245760">,</span>&nbsp;<span class="op" id="7245762">&amp;</span><span class="ident" id="7245763"><a href="/gostd/net/rpc/server_test.go.html#7245712">reply</a></span><span class="op" id="7245768">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7245771">if</span>&nbsp;<span class="ident" id="7245774"><a href="/gostd/net/rpc/server_test.go.html#7245594">err</a></span>&nbsp;<span class="op" id="7245778">!=</span>&nbsp;<span class="builtintype" id="7245781">nil</span>&nbsp;<span class="op" id="7245785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7245789"><a href="/gostd/net/rpc/server_test.go.html#7245546">t</a></span><span class="op" id="7245790">.</span><span class="ident" id="7245791"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7245796">(</span><span class="string" id="7245797">&#34;arith&nbsp;error:&#34;</span><span class="op" id="7245811">,</span>&nbsp;<span class="ident" id="7245813"><a href="/gostd/net/rpc/server_test.go.html#7245594">err</a></span><span class="op" id="7245816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7245819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7245822"><a href="/gostd/net/rpc/server_test.go.html#7245546">t</a></span><span class="op" id="7245823">.</span><span class="ident" id="7245824"><a href="/gostd/testing/testing.go.html#5479816">Logf</a></span><span class="op" id="7245828">(</span><span class="string" id="7245829">&#34;Arith:&nbsp;%d*%d=%d\n&#34;</span><span class="op" id="7245848">,</span>&nbsp;<span class="ident" id="7245850"><a href="/gostd/net/rpc/server_test.go.html#7245687">args</a></span><span class="op" id="7245854">.</span><span class="ident" id="7245855"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7245856">,</span>&nbsp;<span class="ident" id="7245858"><a href="/gostd/net/rpc/server_test.go.html#7245687">args</a></span><span class="op" id="7245862">.</span><span class="ident" id="7245863"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><span class="op" id="7245864">,</span>&nbsp;<span class="ident" id="7245866"><a href="/gostd/net/rpc/server_test.go.html#7245712">reply</a></span><span class="op" id="7245871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7245874">if</span>&nbsp;<span class="ident" id="7245877"><a href="/gostd/net/rpc/server_test.go.html#7245712">reply</a></span><span class="op" id="7245882">.</span><span class="ident" id="7245883"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span>&nbsp;<span class="op" id="7245885">!=</span>&nbsp;<span class="ident" id="7245888"><a href="/gostd/net/rpc/server_test.go.html#7245687">args</a></span><span class="op" id="7245892">.</span><span class="ident" id="7245893"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7245894">*</span><span class="ident" id="7245895"><a href="/gostd/net/rpc/server_test.go.html#7245687">args</a></span><span class="op" id="7245899">.</span><span class="ident" id="7245900"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span>&nbsp;<span class="op" id="7245902">{</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7245906"><a href="/gostd/net/rpc/server_test.go.html#7245546">t</a></span><span class="op" id="7245907">.</span><span class="ident" id="7245908"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7245914">(</span><span class="string" id="7245915">&#34;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7245940">,</span>&nbsp;<span class="ident" id="7245942"><a href="/gostd/net/rpc/server_test.go.html#7245712">reply</a></span><span class="op" id="7245947">.</span><span class="ident" id="7245948"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span><span class="op" id="7245949">,</span>&nbsp;<span class="ident" id="7245951"><a href="/gostd/net/rpc/server_test.go.html#7245687">args</a></span><span class="op" id="7245955">.</span><span class="ident" id="7245956"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7245957">*</span><span class="ident" id="7245958"><a href="/gostd/net/rpc/server_test.go.html#7245687">args</a></span><span class="op" id="7245962">.</span><span class="ident" id="7245963"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><span class="op" id="7245964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7245967">}</span><br>
<span class="lineno"></span><span class="op" id="7245969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7245972">func</span>&nbsp;<span class="ident" id="7245977">TestErrorAfterClientClose</span><span class="op" id="7246002">(</span><span class="ident" id="7246003">t</span>&nbsp;<span class="op" id="7246005">*</span><span class="ident" id="7246006"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7246013">.</span><span class="ident" id="7246014"><a href="/gostd/testing/testing.go.html#5477412">T</a></span><span class="op" id="7246015">)</span>&nbsp;<span class="op" id="7246017">{</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7246020"><a href="/gostd/net/rpc/server_test.go.html#7232913">once</a></span><span class="op" id="7246024">.</span><span class="ident" id="7246025"><a href="/gostd/sync/once.go.html#1447110">Do</a></span><span class="op" id="7246027">(</span><span class="ident" id="7246028"><a href="/gostd/net/rpc/server_test.go.html#7234023">startServer</a></span><span class="op" id="7246039">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7246043">client</span><span class="op" id="7246049">,</span>&nbsp;<span class="ident" id="7246051">err</span>&nbsp;<span class="op" id="7246055">:=</span>&nbsp;<span class="ident" id="7246058"><a href="/gostd/net/rpc/server_test.go.html#7243798">dialHTTP</a></span><span class="op" id="7246066">(</span><span class="op" id="7246067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7246070">if</span>&nbsp;<span class="ident" id="7246073"><a href="/gostd/net/rpc/server_test.go.html#7246051">err</a></span>&nbsp;<span class="op" id="7246077">!=</span>&nbsp;<span class="builtintype" id="7246080">nil</span>&nbsp;<span class="op" id="7246084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7246088"><a href="/gostd/net/rpc/server_test.go.html#7246003">t</a></span><span class="op" id="7246089">.</span><span class="ident" id="7246090"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7246096">(</span><span class="string" id="7246097">&#34;dialing:&nbsp;%v&#34;</span><span class="op" id="7246110">,</span>&nbsp;<span class="ident" id="7246112"><a href="/gostd/net/rpc/server_test.go.html#7246051">err</a></span><span class="op" id="7246115">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7246118">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7246121"><a href="/gostd/net/rpc/server_test.go.html#7246051">err</a></span>&nbsp;<span class="op" id="7246125">=</span>&nbsp;<span class="ident" id="7246127"><a href="/gostd/net/rpc/server_test.go.html#7246043">client</a></span><span class="op" id="7246133">.</span><span class="ident" id="7246134"><a href="/gostd/net/rpc/client.go.html#5268682">Close</a></span><span class="op" id="7246139">(</span><span class="op" id="7246140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7246143">if</span>&nbsp;<span class="ident" id="7246146"><a href="/gostd/net/rpc/server_test.go.html#7246051">err</a></span>&nbsp;<span class="op" id="7246150">!=</span>&nbsp;<span class="builtintype" id="7246153">nil</span>&nbsp;<span class="op" id="7246157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7246161"><a href="/gostd/net/rpc/server_test.go.html#7246003">t</a></span><span class="op" id="7246162">.</span><span class="ident" id="7246163"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7246168">(</span><span class="string" id="7246169">&#34;close&nbsp;error:&#34;</span><span class="op" id="7246183">,</span>&nbsp;<span class="ident" id="7246185"><a href="/gostd/net/rpc/server_test.go.html#7246051">err</a></span><span class="op" id="7246188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7246191">}</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7246194"><a href="/gostd/net/rpc/server_test.go.html#7246051">err</a></span>&nbsp;<span class="op" id="7246198">=</span>&nbsp;<span class="ident" id="7246200"><a href="/gostd/net/rpc/server_test.go.html#7246043">client</a></span><span class="op" id="7246206">.</span><span class="ident" id="7246207"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="7246211">(</span><span class="string" id="7246212">&#34;Arith.Add&#34;</span><span class="op" id="7246223">,</span>&nbsp;<span class="op" id="7246225">&amp;</span><span class="ident" id="7246226"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7246230">{</span><span class="num" id="7246231">7</span><span class="op" id="7246232">,</span>&nbsp;<span class="num" id="7246234">9</span><span class="op" id="7246235">}</span><span class="op" id="7246236">,</span>&nbsp;<span class="builtinfunc" id="7246238">new</span><span class="op" id="7246241">(</span><span class="ident" id="7246242"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7246247">)</span><span class="op" id="7246248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7246251">if</span>&nbsp;<span class="ident" id="7246254"><a href="/gostd/net/rpc/server_test.go.html#7246051">err</a></span>&nbsp;<span class="op" id="7246258">!=</span>&nbsp;<span class="ident" id="7246261"><a href="/gostd/net/rpc/client.go.html#5261726">ErrShutdown</a></span>&nbsp;<span class="op" id="7246273">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7246277"><a href="/gostd/net/rpc/server_test.go.html#7246003">t</a></span><span class="op" id="7246278">.</span><span class="ident" id="7246279"><a href="/gostd/testing/testing.go.html#5480102">Errorf</a></span><span class="op" id="7246285">(</span><span class="string" id="7246286">&#34;Forever:&nbsp;expected&nbsp;ErrShutdown&nbsp;got&nbsp;%v&#34;</span><span class="op" id="7246324">,</span>&nbsp;<span class="ident" id="7246326"><a href="/gostd/net/rpc/server_test.go.html#7246051">err</a></span><span class="op" id="7246329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7246332">}</span><br>
<span class="lineno"></span><span class="op" id="7246334">}</span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span><span class="keyword" id="7246337">func</span>&nbsp;<span class="ident" id="7246342">benchmarkEndToEnd</span><span class="op" id="7246359">(</span><span class="ident" id="7246360">dial</span>&nbsp;<span class="keyword" id="7246365">func</span><span class="op" id="7246369">(</span><span class="op" id="7246370">)</span>&nbsp;<span class="op" id="7246372">(</span><span class="op" id="7246373">*</span><span class="ident" id="7246374"><a href="/gostd/net/rpc/client.go.html#5262362">Client</a></span><span class="op" id="7246380">,</span>&nbsp;<span class="builtintype" id="7246382">error</span><span class="op" id="7246387">)</span><span class="op" id="7246388">,</span>&nbsp;<span class="ident" id="7246390">b</span>&nbsp;<span class="op" id="7246392">*</span><span class="ident" id="7246393"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7246400">.</span><span class="ident" id="7246401"><a href="/gostd/testing/benchmark.go.html#5450963">B</a></span><span class="op" id="7246402">)</span>&nbsp;<span class="op" id="7246404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7246407"><a href="/gostd/net/rpc/server_test.go.html#7232913">once</a></span><span class="op" id="7246411">.</span><span class="ident" id="7246412"><a href="/gostd/sync/once.go.html#1447110">Do</a></span><span class="op" id="7246414">(</span><span class="ident" id="7246415"><a href="/gostd/net/rpc/server_test.go.html#7234023">startServer</a></span><span class="op" id="7246426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7246429">client</span><span class="op" id="7246435">,</span>&nbsp;<span class="ident" id="7246437">err</span>&nbsp;<span class="op" id="7246441">:=</span>&nbsp;<span class="ident" id="7246444"><a href="/gostd/net/rpc/server_test.go.html#7246360">dial</a></span><span class="op" id="7246448">(</span><span class="op" id="7246449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7246452">if</span>&nbsp;<span class="ident" id="7246455"><a href="/gostd/net/rpc/server_test.go.html#7246437">err</a></span>&nbsp;<span class="op" id="7246459">!=</span>&nbsp;<span class="builtintype" id="7246462">nil</span>&nbsp;<span class="op" id="7246466">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7246470"><a href="/gostd/net/rpc/server_test.go.html#7246390">b</a></span><span class="op" id="7246471">.</span><span class="ident" id="7246472"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7246477">(</span><span class="string" id="7246478">&#34;error&nbsp;dialing:&#34;</span><span class="op" id="7246494">,</span>&nbsp;<span class="ident" id="7246496"><a href="/gostd/net/rpc/server_test.go.html#7246437">err</a></span><span class="op" id="7246499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7246502">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7246505">defer</span>&nbsp;<span class="ident" id="7246511"><a href="/gostd/net/rpc/server_test.go.html#7246429">client</a></span><span class="op" id="7246517">.</span><span class="ident" id="7246518"><a href="/gostd/net/rpc/client.go.html#5268682">Close</a></span><span class="op" id="7246523">(</span><span class="op" id="7246524">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7246528">//&nbsp;Synchronous&nbsp;calls</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7246550">args</span>&nbsp;<span class="op" id="7246555">:=</span>&nbsp;<span class="op" id="7246558">&amp;</span><span class="ident" id="7246559"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7246563">{</span><span class="num" id="7246564">7</span><span class="op" id="7246565">,</span>&nbsp;<span class="num" id="7246567">8</span><span class="op" id="7246568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7246571"><a href="/gostd/net/rpc/server_test.go.html#7246390">b</a></span><span class="op" id="7246572">.</span><span class="ident" id="7246573"><a href="/gostd/testing/benchmark.go.html#5452470">ResetTimer</a></span><span class="op" id="7246583">(</span><span class="op" id="7246584">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7246588"><a href="/gostd/net/rpc/server_test.go.html#7246390">b</a></span><span class="op" id="7246589">.</span><span class="ident" id="7246590"><a href="/gostd/testing/benchmark.go.html#5460837">RunParallel</a></span><span class="op" id="7246601">(</span><span class="keyword" id="7246602">func</span><span class="op" id="7246606">(</span><span class="ident" id="7246607">pb</span>&nbsp;<span class="op" id="7246610">*</span><span class="ident" id="7246611"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7246618">.</span><span class="ident" id="7246619"><a href="/gostd/testing/benchmark.go.html#5459633">PB</a></span><span class="op" id="7246621">)</span>&nbsp;<span class="op" id="7246623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7246627">reply</span>&nbsp;<span class="op" id="7246633">:=</span>&nbsp;<span class="builtinfunc" id="7246636">new</span><span class="op" id="7246639">(</span><span class="ident" id="7246640"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7246645">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7246649">for</span>&nbsp;<span class="ident" id="7246653"><a href="/gostd/net/rpc/server_test.go.html#7246607">pb</a></span><span class="op" id="7246655">.</span><span class="ident" id="7246656"><a href="/gostd/testing/benchmark.go.html#5459988">Next</a></span><span class="op" id="7246660">(</span><span class="op" id="7246661">)</span>&nbsp;<span class="op" id="7246663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7246668">err</span>&nbsp;<span class="op" id="7246672">:=</span>&nbsp;<span class="ident" id="7246675"><a href="/gostd/net/rpc/server_test.go.html#7246429">client</a></span><span class="op" id="7246681">.</span><span class="ident" id="7246682"><a href="/gostd/net/rpc/client.go.html#5269931">Call</a></span><span class="op" id="7246686">(</span><span class="string" id="7246687">&#34;Arith.Add&#34;</span><span class="op" id="7246698">,</span>&nbsp;<span class="ident" id="7246700"><a href="/gostd/net/rpc/server_test.go.html#7246550">args</a></span><span class="op" id="7246704">,</span>&nbsp;<span class="ident" id="7246706"><a href="/gostd/net/rpc/server_test.go.html#7246627">reply</a></span><span class="op" id="7246711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7246716">if</span>&nbsp;<span class="ident" id="7246719"><a href="/gostd/net/rpc/server_test.go.html#7246668">err</a></span>&nbsp;<span class="op" id="7246723">!=</span>&nbsp;<span class="builtintype" id="7246726">nil</span>&nbsp;<span class="op" id="7246730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7246736"><a href="/gostd/net/rpc/server_test.go.html#7246390">b</a></span><span class="op" id="7246737">.</span><span class="ident" id="7246738"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7246744">(</span><span class="string" id="7246745">&#34;rpc&nbsp;error:&nbsp;Add:&nbsp;expected&nbsp;no&nbsp;error&nbsp;but&nbsp;got&nbsp;string&nbsp;%q&#34;</span><span class="op" id="7246798">,</span>&nbsp;<span class="ident" id="7246800"><a href="/gostd/net/rpc/server_test.go.html#7246668">err</a></span><span class="op" id="7246803">.</span><span class="ident" id="7246804">Error</span><span class="op" id="7246809">(</span><span class="op" id="7246810">)</span><span class="op" id="7246811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7246816">}</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7246821">if</span>&nbsp;<span class="ident" id="7246824"><a href="/gostd/net/rpc/server_test.go.html#7246627">reply</a></span><span class="op" id="7246829">.</span><span class="ident" id="7246830"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span>&nbsp;<span class="op" id="7246832">!=</span>&nbsp;<span class="ident" id="7246835"><a href="/gostd/net/rpc/server_test.go.html#7246550">args</a></span><span class="op" id="7246839">.</span><span class="ident" id="7246840"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7246841">+</span><span class="ident" id="7246842"><a href="/gostd/net/rpc/server_test.go.html#7246550">args</a></span><span class="op" id="7246846">.</span><span class="ident" id="7246847"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span>&nbsp;<span class="op" id="7246849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7246855"><a href="/gostd/net/rpc/server_test.go.html#7246390">b</a></span><span class="op" id="7246856">.</span><span class="ident" id="7246857"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7246863">(</span><span class="string" id="7246864">&#34;rpc&nbsp;error:&nbsp;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7246900">,</span>&nbsp;<span class="ident" id="7246902"><a href="/gostd/net/rpc/server_test.go.html#7246627">reply</a></span><span class="op" id="7246907">.</span><span class="ident" id="7246908"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span><span class="op" id="7246909">,</span>&nbsp;<span class="ident" id="7246911"><a href="/gostd/net/rpc/server_test.go.html#7246550">args</a></span><span class="op" id="7246915">.</span><span class="ident" id="7246916"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><span class="op" id="7246917">+</span><span class="ident" id="7246918"><a href="/gostd/net/rpc/server_test.go.html#7246550">args</a></span><span class="op" id="7246922">.</span><span class="ident" id="7246923"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><span class="op" id="7246924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7246929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7246933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7246936">}</span><span class="op" id="7246937">)</span><br>
<span class="lineno">620</span><span class="op" id="7246939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7246942">func</span>&nbsp;<span class="ident" id="7246947">benchmarkEndToEndAsync</span><span class="op" id="7246969">(</span><span class="ident" id="7246970">dial</span>&nbsp;<span class="keyword" id="7246975">func</span><span class="op" id="7246979">(</span><span class="op" id="7246980">)</span>&nbsp;<span class="op" id="7246982">(</span><span class="op" id="7246983">*</span><span class="ident" id="7246984"><a href="/gostd/net/rpc/client.go.html#5262362">Client</a></span><span class="op" id="7246990">,</span>&nbsp;<span class="builtintype" id="7246992">error</span><span class="op" id="7246997">)</span><span class="op" id="7246998">,</span>&nbsp;<span class="ident" id="7247000">b</span>&nbsp;<span class="op" id="7247002">*</span><span class="ident" id="7247003"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7247010">.</span><span class="ident" id="7247011"><a href="/gostd/testing/benchmark.go.html#5450963">B</a></span><span class="op" id="7247012">)</span>&nbsp;<span class="op" id="7247014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7247017">const</span>&nbsp;<span class="ident" id="7247023">MaxConcurrentCalls</span>&nbsp;<span class="op" id="7247042">=</span>&nbsp;<span class="num" id="7247044">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247049"><a href="/gostd/net/rpc/server_test.go.html#7232913">once</a></span><span class="op" id="7247053">.</span><span class="ident" id="7247054"><a href="/gostd/sync/once.go.html#1447110">Do</a></span><span class="op" id="7247056">(</span><span class="ident" id="7247057"><a href="/gostd/net/rpc/server_test.go.html#7234023">startServer</a></span><span class="op" id="7247068">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247071">client</span><span class="op" id="7247077">,</span>&nbsp;<span class="ident" id="7247079">err</span>&nbsp;<span class="op" id="7247083">:=</span>&nbsp;<span class="ident" id="7247086"><a href="/gostd/net/rpc/server_test.go.html#7246970">dial</a></span><span class="op" id="7247090">(</span><span class="op" id="7247091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7247094">if</span>&nbsp;<span class="ident" id="7247097"><a href="/gostd/net/rpc/server_test.go.html#7247079">err</a></span>&nbsp;<span class="op" id="7247101">!=</span>&nbsp;<span class="builtintype" id="7247104">nil</span>&nbsp;<span class="op" id="7247108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247112"><a href="/gostd/net/rpc/server_test.go.html#7247000">b</a></span><span class="op" id="7247113">.</span><span class="ident" id="7247114"><a href="/gostd/testing/testing.go.html#5480265">Fatal</a></span><span class="op" id="7247119">(</span><span class="string" id="7247120">&#34;error&nbsp;dialing:&#34;</span><span class="op" id="7247136">,</span>&nbsp;<span class="ident" id="7247138"><a href="/gostd/net/rpc/server_test.go.html#7247079">err</a></span><span class="op" id="7247141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7247144">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7247147">defer</span>&nbsp;<span class="ident" id="7247153"><a href="/gostd/net/rpc/server_test.go.html#7247071">client</a></span><span class="op" id="7247159">.</span><span class="ident" id="7247160"><a href="/gostd/net/rpc/client.go.html#5268682">Close</a></span><span class="op" id="7247165">(</span><span class="op" id="7247166">)</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7247170">//&nbsp;Asynchronous&nbsp;calls</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247193">args</span>&nbsp;<span class="op" id="7247198">:=</span>&nbsp;<span class="op" id="7247201">&amp;</span><span class="ident" id="7247202"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7247206">{</span><span class="num" id="7247207">7</span><span class="op" id="7247208">,</span>&nbsp;<span class="num" id="7247210">8</span><span class="op" id="7247211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247214">procs</span>&nbsp;<span class="op" id="7247220">:=</span>&nbsp;<span class="num" id="7247223">4</span>&nbsp;<span class="op" id="7247225">*</span>&nbsp;<span class="ident" id="7247227"><a href="/gostd/net/rpc/server_test.go.html#7232737">runtime</a></span><span class="op" id="7247234">.</span><span class="ident" id="7247235"><a href="/gostd/runtime/debug.go.html#1521359">GOMAXPROCS</a></span><span class="op" id="7247245">(</span><span class="op" id="7247246">-</span><span class="num" id="7247247">1</span><span class="op" id="7247248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247251">send</span>&nbsp;<span class="op" id="7247256">:=</span>&nbsp;<span class="builtintype" id="7247259">int32</span><span class="op" id="7247264">(</span><span class="ident" id="7247265"><a href="/gostd/net/rpc/server_test.go.html#7247000">b</a></span><span class="op" id="7247266">.</span><span class="ident" id="7247267"><a href="/gostd/testing/benchmark.go.html#5450983">N</a></span><span class="op" id="7247268">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247271">recv</span>&nbsp;<span class="op" id="7247276">:=</span>&nbsp;<span class="builtintype" id="7247279">int32</span><span class="op" id="7247284">(</span><span class="ident" id="7247285"><a href="/gostd/net/rpc/server_test.go.html#7247000">b</a></span><span class="op" id="7247286">.</span><span class="ident" id="7247287"><a href="/gostd/testing/benchmark.go.html#5450983">N</a></span><span class="op" id="7247288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7247291">var</span>&nbsp;<span class="ident" id="7247295">wg</span>&nbsp;<span class="ident" id="7247298"><a href="/gostd/net/rpc/server_test.go.html#7232759">sync</a></span><span class="op" id="7247302">.</span><span class="ident" id="7247303"><a href="/gostd/sync/waitgroup.go.html#1459933">WaitGroup</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247314"><a href="/gostd/net/rpc/server_test.go.html#7247295">wg</a></span><span class="op" id="7247316">.</span><span class="ident" id="7247317"><a href="/gostd/sync/waitgroup.go.html#1461154">Add</a></span><span class="op" id="7247320">(</span><span class="ident" id="7247321"><a href="/gostd/net/rpc/server_test.go.html#7247214">procs</a></span><span class="op" id="7247326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247329">gate</span>&nbsp;<span class="op" id="7247334">:=</span>&nbsp;<span class="builtinfunc" id="7247337">make</span><span class="op" id="7247341">(</span><span class="keyword" id="7247342">chan</span>&nbsp;<span class="builtintype" id="7247347">bool</span><span class="op" id="7247351">,</span>&nbsp;<span class="ident" id="7247353"><a href="/gostd/net/rpc/server_test.go.html#7247023">MaxConcurrentCalls</a></span><span class="op" id="7247371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247374">res</span>&nbsp;<span class="op" id="7247378">:=</span>&nbsp;<span class="builtinfunc" id="7247381">make</span><span class="op" id="7247385">(</span><span class="keyword" id="7247386">chan</span>&nbsp;<span class="op" id="7247391">*</span><span class="ident" id="7247392"><a href="/gostd/net/rpc/client.go.html#5261818">Call</a></span><span class="op" id="7247396">,</span>&nbsp;<span class="ident" id="7247398"><a href="/gostd/net/rpc/server_test.go.html#7247023">MaxConcurrentCalls</a></span><span class="op" id="7247416">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247419"><a href="/gostd/net/rpc/server_test.go.html#7247000">b</a></span><span class="op" id="7247420">.</span><span class="ident" id="7247421"><a href="/gostd/testing/benchmark.go.html#5452470">ResetTimer</a></span><span class="op" id="7247431">(</span><span class="op" id="7247432">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7247436">for</span>&nbsp;<span class="ident" id="7247440">p</span>&nbsp;<span class="op" id="7247442">:=</span>&nbsp;<span class="num" id="7247445">0</span><span class="op" id="7247446">;</span>&nbsp;<span class="ident" id="7247448"><a href="/gostd/net/rpc/server_test.go.html#7247440">p</a></span>&nbsp;<span class="op" id="7247450">&lt;</span>&nbsp;<span class="ident" id="7247452"><a href="/gostd/net/rpc/server_test.go.html#7247214">procs</a></span><span class="op" id="7247457">;</span>&nbsp;<span class="ident" id="7247459"><a href="/gostd/net/rpc/server_test.go.html#7247440">p</a></span><span class="op" id="7247460">++</span>&nbsp;<span class="op" id="7247463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7247467">go</span>&nbsp;<span class="keyword" id="7247470">func</span><span class="op" id="7247474">(</span><span class="op" id="7247475">)</span>&nbsp;<span class="op" id="7247477">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7247482">for</span>&nbsp;<span class="ident" id="7247486"><a href="/gostd/net/rpc/server_test.go.html#7232767">atomic</a></span><span class="op" id="7247492">.</span><span class="ident" id="7247493"><a href="/gostd/sync/atomic/doc.go.html#1466936">AddInt32</a></span><span class="op" id="7247501">(</span><span class="op" id="7247502">&amp;</span><span class="ident" id="7247503"><a href="/gostd/net/rpc/server_test.go.html#7247251">send</a></span><span class="op" id="7247507">,</span>&nbsp;<span class="op" id="7247509">-</span><span class="num" id="7247510">1</span><span class="op" id="7247511">)</span>&nbsp;<span class="op" id="7247513">&gt;=</span>&nbsp;<span class="num" id="7247516">0</span>&nbsp;<span class="op" id="7247518">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247524"><a href="/gostd/net/rpc/server_test.go.html#7247329">gate</a></span>&nbsp;<span class="op" id="7247529">&lt;-</span>&nbsp;<span class="builtintype" id="7247532">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247541">reply</span>&nbsp;<span class="op" id="7247547">:=</span>&nbsp;<span class="builtinfunc" id="7247550">new</span><span class="op" id="7247553">(</span><span class="ident" id="7247554"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7247559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247565"><a href="/gostd/net/rpc/server_test.go.html#7247071">client</a></span><span class="op" id="7247571">.</span><span class="ident" id="7247572"><a href="/gostd/net/rpc/client.go.html#5269205">Go</a></span><span class="op" id="7247574">(</span><span class="string" id="7247575">&#34;Arith.Add&#34;</span><span class="op" id="7247586">,</span>&nbsp;<span class="ident" id="7247588"><a href="/gostd/net/rpc/server_test.go.html#7247193">args</a></span><span class="op" id="7247592">,</span>&nbsp;<span class="ident" id="7247594"><a href="/gostd/net/rpc/server_test.go.html#7247541">reply</a></span><span class="op" id="7247599">,</span>&nbsp;<span class="ident" id="7247601"><a href="/gostd/net/rpc/server_test.go.html#7247374">res</a></span><span class="op" id="7247604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7247609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7247613">}</span><span class="op" id="7247614">(</span><span class="op" id="7247615">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7247619">go</span>&nbsp;<span class="keyword" id="7247622">func</span><span class="op" id="7247626">(</span><span class="op" id="7247627">)</span>&nbsp;<span class="op" id="7247629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7247634">for</span>&nbsp;<span class="ident" id="7247638">call</span>&nbsp;<span class="op" id="7247643">:=</span>&nbsp;<span class="keyword" id="7247646">range</span>&nbsp;<span class="ident" id="7247652"><a href="/gostd/net/rpc/server_test.go.html#7247374">res</a></span>&nbsp;<span class="op" id="7247656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247662">A</span>&nbsp;<span class="op" id="7247664">:=</span>&nbsp;<span class="ident" id="7247667"><a href="/gostd/net/rpc/server_test.go.html#7247638">call</a></span><span class="op" id="7247671">.</span><span class="ident" id="7247672"><a href="/gostd/net/rpc/client.go.html#5261907">Args</a></span><span class="op" id="7247676">.</span><span class="op" id="7247677">(</span><span class="op" id="7247678">*</span><span class="ident" id="7247679"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7247683">)</span><span class="op" id="7247684">.</span><span class="ident" id="7247685"><a href="/gostd/net/rpc/server_test.go.html#7233005">A</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247691">B</span>&nbsp;<span class="op" id="7247693">:=</span>&nbsp;<span class="ident" id="7247696"><a href="/gostd/net/rpc/server_test.go.html#7247638">call</a></span><span class="op" id="7247700">.</span><span class="ident" id="7247701"><a href="/gostd/net/rpc/client.go.html#5261907">Args</a></span><span class="op" id="7247705">.</span><span class="op" id="7247706">(</span><span class="op" id="7247707">*</span><span class="ident" id="7247708"><a href="/gostd/net/rpc/server_test.go.html#7232990">Args</a></span><span class="op" id="7247712">)</span><span class="op" id="7247713">.</span><span class="ident" id="7247714"><a href="/gostd/net/rpc/server_test.go.html#7233008">B</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247720">C</span>&nbsp;<span class="op" id="7247722">:=</span>&nbsp;<span class="ident" id="7247725"><a href="/gostd/net/rpc/server_test.go.html#7247638">call</a></span><span class="op" id="7247729">.</span><span class="ident" id="7247730"><a href="/gostd/net/rpc/client.go.html#5261977">Reply</a></span><span class="op" id="7247735">.</span><span class="op" id="7247736">(</span><span class="op" id="7247737">*</span><span class="ident" id="7247738"><a href="/gostd/net/rpc/server_test.go.html#7233022">Reply</a></span><span class="op" id="7247743">)</span><span class="op" id="7247744">.</span><span class="ident" id="7247745"><a href="/gostd/net/rpc/server_test.go.html#7233038">C</a></span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7247751">if</span>&nbsp;<span class="ident" id="7247754"><a href="/gostd/net/rpc/server_test.go.html#7247662">A</a></span><span class="op" id="7247755">+</span><span class="ident" id="7247756"><a href="/gostd/net/rpc/server_test.go.html#7247691">B</a></span>&nbsp;<span class="op" id="7247758">!=</span>&nbsp;<span class="ident" id="7247761"><a href="/gostd/net/rpc/server_test.go.html#7247720">C</a></span>&nbsp;<span class="op" id="7247763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247770"><a href="/gostd/net/rpc/server_test.go.html#7247000">b</a></span><span class="op" id="7247771">.</span><span class="ident" id="7247772"><a href="/gostd/testing/testing.go.html#5480410">Fatalf</a></span><span class="op" id="7247778">(</span><span class="string" id="7247779">&#34;incorrect&nbsp;reply:&nbsp;Add:&nbsp;expected&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7247821">,</span>&nbsp;<span class="ident" id="7247823"><a href="/gostd/net/rpc/server_test.go.html#7247662">A</a></span><span class="op" id="7247824">+</span><span class="ident" id="7247825"><a href="/gostd/net/rpc/server_test.go.html#7247691">B</a></span><span class="op" id="7247826">,</span>&nbsp;<span class="ident" id="7247828"><a href="/gostd/net/rpc/server_test.go.html#7247720">C</a></span><span class="op" id="7247829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7247835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7247841">&lt;-</span><span class="ident" id="7247843"><a href="/gostd/net/rpc/server_test.go.html#7247329">gate</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7247852">if</span>&nbsp;<span class="ident" id="7247855"><a href="/gostd/net/rpc/server_test.go.html#7232767">atomic</a></span><span class="op" id="7247861">.</span><span class="ident" id="7247862"><a href="/gostd/sync/atomic/doc.go.html#1466936">AddInt32</a></span><span class="op" id="7247870">(</span><span class="op" id="7247871">&amp;</span><span class="ident" id="7247872"><a href="/gostd/net/rpc/server_test.go.html#7247271">recv</a></span><span class="op" id="7247876">,</span>&nbsp;<span class="op" id="7247878">-</span><span class="num" id="7247879">1</span><span class="op" id="7247880">)</span>&nbsp;<span class="op" id="7247882">==</span>&nbsp;<span class="num" id="7247885">0</span>&nbsp;<span class="op" id="7247887">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="7247894">close</span><span class="op" id="7247899">(</span><span class="ident" id="7247900"><a href="/gostd/net/rpc/server_test.go.html#7247374">res</a></span><span class="op" id="7247903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7247909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7247914">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247919"><a href="/gostd/net/rpc/server_test.go.html#7247295">wg</a></span><span class="op" id="7247921">.</span><span class="ident" id="7247922"><a href="/gostd/sync/waitgroup.go.html#1462065">Done</a></span><span class="op" id="7247926">(</span><span class="op" id="7247927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7247931">}</span><span class="op" id="7247932">(</span><span class="op" id="7247933">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7247936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247939"><a href="/gostd/net/rpc/server_test.go.html#7247295">wg</a></span><span class="op" id="7247941">.</span><span class="ident" id="7247942"><a href="/gostd/sync/waitgroup.go.html#1462162">Wait</a></span><span class="op" id="7247946">(</span><span class="op" id="7247947">)</span><br>
<span class="lineno"></span><span class="op" id="7247949">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7247952">func</span>&nbsp;<span class="ident" id="7247957">BenchmarkEndToEnd</span><span class="op" id="7247974">(</span><span class="ident" id="7247975">b</span>&nbsp;<span class="op" id="7247977">*</span><span class="ident" id="7247978"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7247985">.</span><span class="ident" id="7247986"><a href="/gostd/testing/benchmark.go.html#5450963">B</a></span><span class="op" id="7247987">)</span>&nbsp;<span class="op" id="7247989">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7247992"><a href="/gostd/net/rpc/server_test.go.html#7246342">benchmarkEndToEnd</a></span><span class="op" id="7248009">(</span><span class="ident" id="7248010"><a href="/gostd/net/rpc/server_test.go.html#7243726">dialDirect</a></span><span class="op" id="7248020">,</span>&nbsp;<span class="ident" id="7248022"><a href="/gostd/net/rpc/server_test.go.html#7247975">b</a></span><span class="op" id="7248023">)</span><br>
<span class="lineno"></span><span class="op" id="7248025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7248028">func</span>&nbsp;<span class="ident" id="7248033">BenchmarkEndToEndHTTP</span><span class="op" id="7248054">(</span><span class="ident" id="7248055">b</span>&nbsp;<span class="op" id="7248057">*</span><span class="ident" id="7248058"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7248065">.</span><span class="ident" id="7248066"><a href="/gostd/testing/benchmark.go.html#5450963">B</a></span><span class="op" id="7248067">)</span>&nbsp;<span class="op" id="7248069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7248072"><a href="/gostd/net/rpc/server_test.go.html#7246342">benchmarkEndToEnd</a></span><span class="op" id="7248089">(</span><span class="ident" id="7248090"><a href="/gostd/net/rpc/server_test.go.html#7243798">dialHTTP</a></span><span class="op" id="7248098">,</span>&nbsp;<span class="ident" id="7248100"><a href="/gostd/net/rpc/server_test.go.html#7248055">b</a></span><span class="op" id="7248101">)</span><br>
<span class="lineno">675</span><span class="op" id="7248103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7248106">func</span>&nbsp;<span class="ident" id="7248111">BenchmarkEndToEndAsync</span><span class="op" id="7248133">(</span><span class="ident" id="7248134">b</span>&nbsp;<span class="op" id="7248136">*</span><span class="ident" id="7248137"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7248144">.</span><span class="ident" id="7248145"><a href="/gostd/testing/benchmark.go.html#5450963">B</a></span><span class="op" id="7248146">)</span>&nbsp;<span class="op" id="7248148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7248151"><a href="/gostd/net/rpc/server_test.go.html#7246947">benchmarkEndToEndAsync</a></span><span class="op" id="7248173">(</span><span class="ident" id="7248174"><a href="/gostd/net/rpc/server_test.go.html#7243726">dialDirect</a></span><span class="op" id="7248184">,</span>&nbsp;<span class="ident" id="7248186"><a href="/gostd/net/rpc/server_test.go.html#7248134">b</a></span><span class="op" id="7248187">)</span><br>
<span class="lineno"></span><span class="op" id="7248189">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="7248192">func</span>&nbsp;<span class="ident" id="7248197">BenchmarkEndToEndAsyncHTTP</span><span class="op" id="7248223">(</span><span class="ident" id="7248224">b</span>&nbsp;<span class="op" id="7248226">*</span><span class="ident" id="7248227"><a href="/gostd/net/rpc/server_test.go.html#7232782">testing</a></span><span class="op" id="7248234">.</span><span class="ident" id="7248235"><a href="/gostd/testing/benchmark.go.html#5450963">B</a></span><span class="op" id="7248236">)</span>&nbsp;<span class="op" id="7248238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7248241"><a href="/gostd/net/rpc/server_test.go.html#7246947">benchmarkEndToEndAsync</a></span><span class="op" id="7248263">(</span><span class="ident" id="7248264"><a href="/gostd/net/rpc/server_test.go.html#7243798">dialHTTP</a></span><span class="op" id="7248272">,</span>&nbsp;<span class="ident" id="7248274"><a href="/gostd/net/rpc/server_test.go.html#7248224">b</a></span><span class="op" id="7248275">)</span><br>
<span class="lineno"></span><span class="op" id="7248277">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
