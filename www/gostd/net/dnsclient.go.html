<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html" class="current">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3208541">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3208596">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3208650">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3208701">package</span>&nbsp;<span class="ident" id="3208709">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3208714">import</span>&nbsp;<span class="op" id="3208721">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3208724">&#34;math/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3208737">&#34;sort&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3208744">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3208747">//&nbsp;DNSError&nbsp;represents&nbsp;a&nbsp;DNS&nbsp;lookup&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="3208790">type</span>&nbsp;<span class="ident" id="3208795">DNSError</span>&nbsp;<span class="keyword" id="3208804">struct</span>&nbsp;<span class="op" id="3208811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3208814">Err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3208824">string</span>&nbsp;<span class="comment" id="3208831">//&nbsp;description&nbsp;of&nbsp;the&nbsp;error</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3208860">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3208870">string</span>&nbsp;<span class="comment" id="3208877">//&nbsp;name&nbsp;looked&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3208897">Server</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3208907">string</span>&nbsp;<span class="comment" id="3208914">//&nbsp;server&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3208930">IsTimeout</span>&nbsp;<span class="builtintype" id="3208940">bool</span><br>
<span class="lineno"></span><span class="op" id="3208945">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="keyword" id="3208948">func</span>&nbsp;<span class="op" id="3208953">(</span><span class="ident" id="3208954">e</span>&nbsp;<span class="op" id="3208956">*</span><span class="ident" id="3208957"><a href="/gostd/net/dnsclient.go.html#3208795">DNSError</a></span><span class="op" id="3208965">)</span>&nbsp;<span class="ident" id="3208967">Error</span><span class="op" id="3208972">(</span><span class="op" id="3208973">)</span>&nbsp;<span class="builtintype" id="3208975">string</span>&nbsp;<span class="op" id="3208982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3208985">if</span>&nbsp;<span class="ident" id="3208988"><a href="/gostd/net/dnsclient.go.html#3208954">e</a></span>&nbsp;<span class="op" id="3208990">==</span>&nbsp;<span class="builtintype" id="3208993">nil</span>&nbsp;<span class="op" id="3208997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3209001">return</span>&nbsp;<span class="string" id="3209008">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3209017">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3209020">s</span>&nbsp;<span class="op" id="3209022">:=</span>&nbsp;<span class="string" id="3209025">&#34;lookup&nbsp;&#34;</span>&nbsp;<span class="op" id="3209035">+</span>&nbsp;<span class="ident" id="3209037"><a href="/gostd/net/dnsclient.go.html#3208954">e</a></span><span class="op" id="3209038">.</span><span class="ident" id="3209039"><a href="/gostd/net/dnsclient.go.html#3208860">Name</a></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3209045">if</span>&nbsp;<span class="ident" id="3209048"><a href="/gostd/net/dnsclient.go.html#3208954">e</a></span><span class="op" id="3209049">.</span><span class="ident" id="3209050"><a href="/gostd/net/dnsclient.go.html#3208897">Server</a></span>&nbsp;<span class="op" id="3209057">!=</span>&nbsp;<span class="string" id="3209060">&#34;&#34;</span>&nbsp;<span class="op" id="3209063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3209067"><a href="/gostd/net/dnsclient.go.html#3209020">s</a></span>&nbsp;<span class="op" id="3209069">+=</span>&nbsp;<span class="string" id="3209072">&#34;&nbsp;on&nbsp;&#34;</span>&nbsp;<span class="op" id="3209079">+</span>&nbsp;<span class="ident" id="3209081"><a href="/gostd/net/dnsclient.go.html#3208954">e</a></span><span class="op" id="3209082">.</span><span class="ident" id="3209083"><a href="/gostd/net/dnsclient.go.html#3208897">Server</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3209091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3209094"><a href="/gostd/net/dnsclient.go.html#3209020">s</a></span>&nbsp;<span class="op" id="3209096">+=</span>&nbsp;<span class="string" id="3209099">&#34;:&nbsp;&#34;</span>&nbsp;<span class="op" id="3209104">+</span>&nbsp;<span class="ident" id="3209106"><a href="/gostd/net/dnsclient.go.html#3208954">e</a></span><span class="op" id="3209107">.</span><span class="ident" id="3209108"><a href="/gostd/net/dnsclient.go.html#3208814">Err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3209113">return</span>&nbsp;<span class="ident" id="3209120"><a href="/gostd/net/dnsclient.go.html#3209020">s</a></span><br>
<span class="lineno">30</span><span class="op" id="3209122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3209125">func</span>&nbsp;<span class="op" id="3209130">(</span><span class="ident" id="3209131">e</span>&nbsp;<span class="op" id="3209133">*</span><span class="ident" id="3209134"><a href="/gostd/net/dnsclient.go.html#3208795">DNSError</a></span><span class="op" id="3209142">)</span>&nbsp;<span class="ident" id="3209144">Timeout</span><span class="op" id="3209151">(</span><span class="op" id="3209152">)</span>&nbsp;<span class="builtintype" id="3209154">bool</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3209161">{</span>&nbsp;<span class="keyword" id="3209163">return</span>&nbsp;<span class="ident" id="3209170"><a href="/gostd/net/dnsclient.go.html#3209131">e</a></span><span class="op" id="3209171">.</span><span class="ident" id="3209172"><a href="/gostd/net/dnsclient.go.html#3208930">IsTimeout</a></span>&nbsp;<span class="op" id="3209182">}</span><br>
<span class="lineno"></span><span class="keyword" id="3209184">func</span>&nbsp;<span class="op" id="3209189">(</span><span class="ident" id="3209190">e</span>&nbsp;<span class="op" id="3209192">*</span><span class="ident" id="3209193"><a href="/gostd/net/dnsclient.go.html#3208795">DNSError</a></span><span class="op" id="3209201">)</span>&nbsp;<span class="ident" id="3209203">Temporary</span><span class="op" id="3209212">(</span><span class="op" id="3209213">)</span>&nbsp;<span class="builtintype" id="3209215">bool</span>&nbsp;<span class="op" id="3209220">{</span>&nbsp;<span class="keyword" id="3209222">return</span>&nbsp;<span class="ident" id="3209229"><a href="/gostd/net/dnsclient.go.html#3209190">e</a></span><span class="op" id="3209230">.</span><span class="ident" id="3209231"><a href="/gostd/net/dnsclient.go.html#3208930">IsTimeout</a></span>&nbsp;<span class="op" id="3209241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="3209244">const</span>&nbsp;<span class="ident" id="3209250">noSuchHost</span>&nbsp;<span class="op" id="3209261">=</span>&nbsp;<span class="string" id="3209263">&#34;no&nbsp;such&nbsp;host&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3209279">//&nbsp;reverseaddr&nbsp;returns&nbsp;the&nbsp;in-addr.arpa.&nbsp;or&nbsp;ip6.arpa.&nbsp;hostname&nbsp;of&nbsp;the&nbsp;IP</span><br>
<span class="lineno"></span><span class="comment" id="3209352">//&nbsp;address&nbsp;addr&nbsp;suitable&nbsp;for&nbsp;rDNS&nbsp;(PTR)&nbsp;record&nbsp;lookup&nbsp;or&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;fails</span><br>
<span class="lineno"></span><span class="comment" id="3209430">//&nbsp;to&nbsp;parse&nbsp;the&nbsp;IP&nbsp;address.</span><br>
<span class="lineno">40</span><span class="keyword" id="3209458">func</span>&nbsp;<span class="ident" id="3209463">reverseaddr</span><span class="op" id="3209474">(</span><span class="ident" id="3209475">addr</span>&nbsp;<span class="builtintype" id="3209480">string</span><span class="op" id="3209486">)</span>&nbsp;<span class="op" id="3209488">(</span><span class="ident" id="3209489">arpa</span>&nbsp;<span class="builtintype" id="3209494">string</span><span class="op" id="3209500">,</span>&nbsp;<span class="ident" id="3209502">err</span>&nbsp;<span class="builtintype" id="3209506">error</span><span class="op" id="3209511">)</span>&nbsp;<span class="op" id="3209513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3209516">ip</span>&nbsp;<span class="op" id="3209519">:=</span>&nbsp;<span class="ident" id="3209522"><a href="/gostd/net/ip.go.html#3299857">ParseIP</a></span><span class="op" id="3209529">(</span><span class="ident" id="3209530"><a href="/gostd/net/dnsclient.go.html#3209475">addr</a></span><span class="op" id="3209534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3209537">if</span>&nbsp;<span class="ident" id="3209540"><a href="/gostd/net/dnsclient.go.html#3209516">ip</a></span>&nbsp;<span class="op" id="3209543">==</span>&nbsp;<span class="builtintype" id="3209546">nil</span>&nbsp;<span class="op" id="3209550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3209554">return</span>&nbsp;<span class="string" id="3209561">&#34;&#34;</span><span class="op" id="3209563">,</span>&nbsp;<span class="op" id="3209565">&amp;</span><span class="ident" id="3209566"><a href="/gostd/net/dnsclient.go.html#3208795">DNSError</a></span><span class="op" id="3209574">{</span><span class="ident" id="3209575"><a href="/gostd/net/dnsclient.go.html#3208814">Err</a></span><span class="op" id="3209578">:</span>&nbsp;<span class="string" id="3209580">&#34;unrecognized&nbsp;address&#34;</span><span class="op" id="3209602">,</span>&nbsp;<span class="ident" id="3209604"><a href="/gostd/net/dnsclient.go.html#3208860">Name</a></span><span class="op" id="3209608">:</span>&nbsp;<span class="ident" id="3209610"><a href="/gostd/net/dnsclient.go.html#3209475">addr</a></span><span class="op" id="3209614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3209617">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3209620">if</span>&nbsp;<span class="ident" id="3209623"><a href="/gostd/net/dnsclient.go.html#3209516">ip</a></span><span class="op" id="3209625">.</span><span class="ident" id="3209626"><a href="/gostd/net/ip.go.html#3290039">To4</a></span><span class="op" id="3209629">(</span><span class="op" id="3209630">)</span>&nbsp;<span class="op" id="3209632">!=</span>&nbsp;<span class="builtintype" id="3209635">nil</span>&nbsp;<span class="op" id="3209639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3209643">return</span>&nbsp;<span class="ident" id="3209650"><a href="/gostd/net/parse.go.html#3348151">itoa</a></span><span class="op" id="3209654">(</span><span class="builtintype" id="3209655">int</span><span class="op" id="3209658">(</span><span class="ident" id="3209659"><a href="/gostd/net/dnsclient.go.html#3209516">ip</a></span><span class="op" id="3209661">[</span><span class="num" id="3209662">15</span><span class="op" id="3209664">]</span><span class="op" id="3209665">)</span><span class="op" id="3209666">)</span>&nbsp;<span class="op" id="3209668">+</span>&nbsp;<span class="string" id="3209670">&#34;.&#34;</span>&nbsp;<span class="op" id="3209674">+</span>&nbsp;<span class="ident" id="3209676"><a href="/gostd/net/parse.go.html#3348151">itoa</a></span><span class="op" id="3209680">(</span><span class="builtintype" id="3209681">int</span><span class="op" id="3209684">(</span><span class="ident" id="3209685"><a href="/gostd/net/dnsclient.go.html#3209516">ip</a></span><span class="op" id="3209687">[</span><span class="num" id="3209688">14</span><span class="op" id="3209690">]</span><span class="op" id="3209691">)</span><span class="op" id="3209692">)</span>&nbsp;<span class="op" id="3209694">+</span>&nbsp;<span class="string" id="3209696">&#34;.&#34;</span>&nbsp;<span class="op" id="3209700">+</span>&nbsp;<span class="ident" id="3209702"><a href="/gostd/net/parse.go.html#3348151">itoa</a></span><span class="op" id="3209706">(</span><span class="builtintype" id="3209707">int</span><span class="op" id="3209710">(</span><span class="ident" id="3209711"><a href="/gostd/net/dnsclient.go.html#3209516">ip</a></span><span class="op" id="3209713">[</span><span class="num" id="3209714">13</span><span class="op" id="3209716">]</span><span class="op" id="3209717">)</span><span class="op" id="3209718">)</span>&nbsp;<span class="op" id="3209720">+</span>&nbsp;<span class="string" id="3209722">&#34;.&#34;</span>&nbsp;<span class="op" id="3209726">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3209731"><a href="/gostd/net/parse.go.html#3348151">itoa</a></span><span class="op" id="3209735">(</span><span class="builtintype" id="3209736">int</span><span class="op" id="3209739">(</span><span class="ident" id="3209740"><a href="/gostd/net/dnsclient.go.html#3209516">ip</a></span><span class="op" id="3209742">[</span><span class="num" id="3209743">12</span><span class="op" id="3209745">]</span><span class="op" id="3209746">)</span><span class="op" id="3209747">)</span>&nbsp;<span class="op" id="3209749">+</span>&nbsp;<span class="string" id="3209751">&#34;.in-addr.arpa.&#34;</span><span class="op" id="3209767">,</span>&nbsp;<span class="builtintype" id="3209769">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3209774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3209777">//&nbsp;Must&nbsp;be&nbsp;IPv6</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3209794">buf</span>&nbsp;<span class="op" id="3209798">:=</span>&nbsp;<span class="builtinfunc" id="3209801">make</span><span class="op" id="3209805">(</span><span class="op" id="3209806">[</span><span class="op" id="3209807">]</span><span class="builtintype" id="3209808">byte</span><span class="op" id="3209812">,</span>&nbsp;<span class="num" id="3209814">0</span><span class="op" id="3209815">,</span>&nbsp;<span class="builtinfunc" id="3209817">len</span><span class="op" id="3209820">(</span><span class="ident" id="3209821"><a href="/gostd/net/dnsclient.go.html#3209516">ip</a></span><span class="op" id="3209823">)</span><span class="op" id="3209824">*</span><span class="num" id="3209825">4</span><span class="op" id="3209826">+</span><span class="builtinfunc" id="3209827">len</span><span class="op" id="3209830">(</span><span class="string" id="3209831">&#34;ip6.arpa.&#34;</span><span class="op" id="3209842">)</span><span class="op" id="3209843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3209846">//&nbsp;Add&nbsp;it,&nbsp;in&nbsp;reverse,&nbsp;to&nbsp;the&nbsp;buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3209884">for</span>&nbsp;<span class="ident" id="3209888">i</span>&nbsp;<span class="op" id="3209890">:=</span>&nbsp;<span class="builtinfunc" id="3209893">len</span><span class="op" id="3209896">(</span><span class="ident" id="3209897"><a href="/gostd/net/dnsclient.go.html#3209516">ip</a></span><span class="op" id="3209899">)</span>&nbsp;<span class="op" id="3209901">-</span>&nbsp;<span class="num" id="3209903">1</span><span class="op" id="3209904">;</span>&nbsp;<span class="ident" id="3209906"><a href="/gostd/net/dnsclient.go.html#3209888">i</a></span>&nbsp;<span class="op" id="3209908">&gt;=</span>&nbsp;<span class="num" id="3209911">0</span><span class="op" id="3209912">;</span>&nbsp;<span class="ident" id="3209914"><a href="/gostd/net/dnsclient.go.html#3209888">i</a></span><span class="op" id="3209915">--</span>&nbsp;<span class="op" id="3209918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3209922">v</span>&nbsp;<span class="op" id="3209924">:=</span>&nbsp;<span class="ident" id="3209927"><a href="/gostd/net/dnsclient.go.html#3209516">ip</a></span><span class="op" id="3209929">[</span><span class="ident" id="3209930"><a href="/gostd/net/dnsclient.go.html#3209888">i</a></span><span class="op" id="3209931">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3209935"><a href="/gostd/net/dnsclient.go.html#3209794">buf</a></span>&nbsp;<span class="op" id="3209939">=</span>&nbsp;<span class="builtinfunc" id="3209941">append</span><span class="op" id="3209947">(</span><span class="ident" id="3209948"><a href="/gostd/net/dnsclient.go.html#3209794">buf</a></span><span class="op" id="3209951">,</span>&nbsp;<span class="ident" id="3209953"><a href="/gostd/net/mac.go.html#3331450">hexDigit</a></span><span class="op" id="3209961">[</span><span class="ident" id="3209962"><a href="/gostd/net/dnsclient.go.html#3209922">v</a></span><span class="op" id="3209963">&amp;</span><span class="num" id="3209964">0xF</span><span class="op" id="3209967">]</span><span class="op" id="3209968">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3209972"><a href="/gostd/net/dnsclient.go.html#3209794">buf</a></span>&nbsp;<span class="op" id="3209976">=</span>&nbsp;<span class="builtinfunc" id="3209978">append</span><span class="op" id="3209984">(</span><span class="ident" id="3209985"><a href="/gostd/net/dnsclient.go.html#3209794">buf</a></span><span class="op" id="3209988">,</span>&nbsp;<span class="string" id="3209990">&#39;.&#39;</span><span class="op" id="3209993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3209997"><a href="/gostd/net/dnsclient.go.html#3209794">buf</a></span>&nbsp;<span class="op" id="3210001">=</span>&nbsp;<span class="builtinfunc" id="3210003">append</span><span class="op" id="3210009">(</span><span class="ident" id="3210010"><a href="/gostd/net/dnsclient.go.html#3209794">buf</a></span><span class="op" id="3210013">,</span>&nbsp;<span class="ident" id="3210015"><a href="/gostd/net/mac.go.html#3331450">hexDigit</a></span><span class="op" id="3210023">[</span><span class="ident" id="3210024"><a href="/gostd/net/dnsclient.go.html#3209922">v</a></span><span class="op" id="3210025">&gt;&gt;</span><span class="num" id="3210027">4</span><span class="op" id="3210028">]</span><span class="op" id="3210029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3210033"><a href="/gostd/net/dnsclient.go.html#3209794">buf</a></span>&nbsp;<span class="op" id="3210037">=</span>&nbsp;<span class="builtinfunc" id="3210039">append</span><span class="op" id="3210045">(</span><span class="ident" id="3210046"><a href="/gostd/net/dnsclient.go.html#3209794">buf</a></span><span class="op" id="3210049">,</span>&nbsp;<span class="string" id="3210051">&#39;.&#39;</span><span class="op" id="3210054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3210057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3210060">//&nbsp;Append&nbsp;&#34;ip6.arpa.&#34;&nbsp;and&nbsp;return&nbsp;(buf&nbsp;already&nbsp;has&nbsp;the&nbsp;final&nbsp;.)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3210124"><a href="/gostd/net/dnsclient.go.html#3209794">buf</a></span>&nbsp;<span class="op" id="3210128">=</span>&nbsp;<span class="builtinfunc" id="3210130">append</span><span class="op" id="3210136">(</span><span class="ident" id="3210137"><a href="/gostd/net/dnsclient.go.html#3209794">buf</a></span><span class="op" id="3210140">,</span>&nbsp;<span class="string" id="3210142">&#34;ip6.arpa.&#34;</span><span class="op" id="3210153">...</span><span class="op" id="3210156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3210159">return</span>&nbsp;<span class="builtintype" id="3210166">string</span><span class="op" id="3210172">(</span><span class="ident" id="3210173"><a href="/gostd/net/dnsclient.go.html#3209794">buf</a></span><span class="op" id="3210176">)</span><span class="op" id="3210177">,</span>&nbsp;<span class="builtintype" id="3210179">nil</span><br>
<span class="lineno"></span><span class="op" id="3210183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3210186">//&nbsp;Find&nbsp;answer&nbsp;for&nbsp;name&nbsp;in&nbsp;dns&nbsp;message.</span><br>
<span class="lineno">65</span><span class="comment" id="3210226">//&nbsp;On&nbsp;return,&nbsp;if&nbsp;err&nbsp;==&nbsp;nil,&nbsp;addrs&nbsp;!=&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="3210269">func</span>&nbsp;<span class="ident" id="3210274">answer</span><span class="op" id="3210280">(</span><span class="ident" id="3210281">name</span><span class="op" id="3210285">,</span>&nbsp;<span class="ident" id="3210287">server</span>&nbsp;<span class="builtintype" id="3210294">string</span><span class="op" id="3210300">,</span>&nbsp;<span class="ident" id="3210302">dns</span>&nbsp;<span class="op" id="3210306">*</span><span class="ident" id="3210307"><a href="/gostd/net/dnsmsg.go.html#3245872">dnsMsg</a></span><span class="op" id="3210313">,</span>&nbsp;<span class="ident" id="3210315">qtype</span>&nbsp;<span class="builtintype" id="3210321">uint16</span><span class="op" id="3210327">)</span>&nbsp;<span class="op" id="3210329">(</span><span class="ident" id="3210330">cname</span>&nbsp;<span class="builtintype" id="3210336">string</span><span class="op" id="3210342">,</span>&nbsp;<span class="ident" id="3210344">addrs</span>&nbsp;<span class="op" id="3210350">[</span><span class="op" id="3210351">]</span><span class="ident" id="3210352"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span><span class="op" id="3210357">,</span>&nbsp;<span class="ident" id="3210359">err</span>&nbsp;<span class="builtintype" id="3210363">error</span><span class="op" id="3210368">)</span>&nbsp;<span class="op" id="3210370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3210373"><a href="/gostd/net/dnsclient.go.html#3210344">addrs</a></span>&nbsp;<span class="op" id="3210379">=</span>&nbsp;<span class="builtinfunc" id="3210381">make</span><span class="op" id="3210385">(</span><span class="op" id="3210386">[</span><span class="op" id="3210387">]</span><span class="ident" id="3210388"><a href="/gostd/net/dnsmsg.go.html#3231784">dnsRR</a></span><span class="op" id="3210393">,</span>&nbsp;<span class="num" id="3210395">0</span><span class="op" id="3210396">,</span>&nbsp;<span class="builtinfunc" id="3210398">len</span><span class="op" id="3210401">(</span><span class="ident" id="3210402"><a href="/gostd/net/dnsclient.go.html#3210302">dns</a></span><span class="op" id="3210405">.</span><span class="ident" id="3210406"><a href="/gostd/net/dnsmsg.go.html#3245924">answer</a></span><span class="op" id="3210412">)</span><span class="op" id="3210413">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3210417">if</span>&nbsp;<span class="ident" id="3210420"><a href="/gostd/net/dnsclient.go.html#3210302">dns</a></span><span class="op" id="3210423">.</span><span class="ident" id="3210424"><a href="/gostd/net/dnsmsg.go.html#3245438">rcode</a></span>&nbsp;<span class="op" id="3210430">==</span>&nbsp;<span class="ident" id="3210433"><a href="/gostd/net/dnsmsg.go.html#3229467">dnsRcodeNameError</a></span>&nbsp;<span class="op" id="3210451">&amp;&amp;</span>&nbsp;<span class="ident" id="3210454"><a href="/gostd/net/dnsclient.go.html#3210302">dns</a></span><span class="op" id="3210457">.</span><span class="ident" id="3210458"><a href="/gostd/net/dnsmsg.go.html#3245412">recursion_available</a></span>&nbsp;<span class="op" id="3210478">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3210482">return</span>&nbsp;<span class="string" id="3210489">&#34;&#34;</span><span class="op" id="3210491">,</span>&nbsp;<span class="builtintype" id="3210493">nil</span><span class="op" id="3210496">,</span>&nbsp;<span class="op" id="3210498">&amp;</span><span class="ident" id="3210499"><a href="/gostd/net/dnsclient.go.html#3208795">DNSError</a></span><span class="op" id="3210507">{</span><span class="ident" id="3210508"><a href="/gostd/net/dnsclient.go.html#3208814">Err</a></span><span class="op" id="3210511">:</span>&nbsp;<span class="ident" id="3210513"><a href="/gostd/net/dnsclient.go.html#3209250">noSuchHost</a></span><span class="op" id="3210523">,</span>&nbsp;<span class="ident" id="3210525"><a href="/gostd/net/dnsclient.go.html#3208860">Name</a></span><span class="op" id="3210529">:</span>&nbsp;<span class="ident" id="3210531"><a href="/gostd/net/dnsclient.go.html#3210281">name</a></span><span class="op" id="3210535">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3210538">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3210541">if</span>&nbsp;<span class="ident" id="3210544"><a href="/gostd/net/dnsclient.go.html#3210302">dns</a></span><span class="op" id="3210547">.</span><span class="ident" id="3210548"><a href="/gostd/net/dnsmsg.go.html#3245438">rcode</a></span>&nbsp;<span class="op" id="3210554">!=</span>&nbsp;<span class="ident" id="3210557"><a href="/gostd/net/dnsmsg.go.html#3229383">dnsRcodeSuccess</a></span>&nbsp;<span class="op" id="3210573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3210577">//&nbsp;None&nbsp;of&nbsp;the&nbsp;error&nbsp;codes&nbsp;make&nbsp;sense</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3210617">//&nbsp;for&nbsp;the&nbsp;query&nbsp;we&nbsp;sent.&nbsp;&nbsp;If&nbsp;we&nbsp;didn&#39;t&nbsp;get</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3210663">//&nbsp;a&nbsp;name&nbsp;error&nbsp;and&nbsp;we&nbsp;didn&#39;t&nbsp;get&nbsp;success,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3210708">//&nbsp;the&nbsp;server&nbsp;is&nbsp;behaving&nbsp;incorrectly.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3210749">return</span>&nbsp;<span class="string" id="3210756">&#34;&#34;</span><span class="op" id="3210758">,</span>&nbsp;<span class="builtintype" id="3210760">nil</span><span class="op" id="3210763">,</span>&nbsp;<span class="op" id="3210765">&amp;</span><span class="ident" id="3210766"><a href="/gostd/net/dnsclient.go.html#3208795">DNSError</a></span><span class="op" id="3210774">{</span><span class="ident" id="3210775"><a href="/gostd/net/dnsclient.go.html#3208814">Err</a></span><span class="op" id="3210778">:</span>&nbsp;<span class="string" id="3210780">&#34;server&nbsp;misbehaving&#34;</span><span class="op" id="3210800">,</span>&nbsp;<span class="ident" id="3210802"><a href="/gostd/net/dnsclient.go.html#3208860">Name</a></span><span class="op" id="3210806">:</span>&nbsp;<span class="ident" id="3210808"><a href="/gostd/net/dnsclient.go.html#3210281">name</a></span><span class="op" id="3210812">,</span>&nbsp;<span class="ident" id="3210814"><a href="/gostd/net/dnsclient.go.html#3208897">Server</a></span><span class="op" id="3210820">:</span>&nbsp;<span class="ident" id="3210822"><a href="/gostd/net/dnsclient.go.html#3210287">server</a></span><span class="op" id="3210828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3210831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3210835">//&nbsp;Look&nbsp;for&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3210858">//&nbsp;Presotto&nbsp;says&nbsp;it&#39;s&nbsp;okay&nbsp;to&nbsp;assume&nbsp;that&nbsp;servers&nbsp;listed&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3210919">//&nbsp;/etc/resolv.conf&nbsp;are&nbsp;recursive&nbsp;resolvers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3210965">//&nbsp;We&nbsp;asked&nbsp;for&nbsp;recursion,&nbsp;so&nbsp;it&nbsp;should&nbsp;have&nbsp;included</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3211020">//&nbsp;all&nbsp;the&nbsp;answers&nbsp;we&nbsp;need&nbsp;in&nbsp;this&nbsp;one&nbsp;packet.</span><br>
<span class="lineno">85</span><span class="ident" id="3211067">Cname</span><span class="op" id="3211072">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3211075">for</span>&nbsp;<span class="ident" id="3211079">cnameloop</span>&nbsp;<span class="op" id="3211089">:=</span>&nbsp;<span class="num" id="3211092">0</span><span class="op" id="3211093">;</span>&nbsp;<span class="ident" id="3211095"><a href="/gostd/net/dnsclient.go.html#3211079">cnameloop</a></span>&nbsp;<span class="op" id="3211105">&lt;</span>&nbsp;<span class="num" id="3211107">10</span><span class="op" id="3211109">;</span>&nbsp;<span class="ident" id="3211111"><a href="/gostd/net/dnsclient.go.html#3211079">cnameloop</a></span><span class="op" id="3211120">++</span>&nbsp;<span class="op" id="3211123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3211127"><a href="/gostd/net/dnsclient.go.html#3210344">addrs</a></span>&nbsp;<span class="op" id="3211133">=</span>&nbsp;<span class="ident" id="3211135"><a href="/gostd/net/dnsclient.go.html#3210344">addrs</a></span><span class="op" id="3211140">[</span><span class="num" id="3211141">0</span><span class="op" id="3211142">:</span><span class="num" id="3211143">0</span><span class="op" id="3211144">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3211148">for</span>&nbsp;<span class="ident" id="3211152">_</span><span class="op" id="3211153">,</span>&nbsp;<span class="ident" id="3211155">rr</span>&nbsp;<span class="op" id="3211158">:=</span>&nbsp;<span class="keyword" id="3211161">range</span>&nbsp;<span class="ident" id="3211167"><a href="/gostd/net/dnsclient.go.html#3210302">dns</a></span><span class="op" id="3211170">.</span><span class="ident" id="3211171"><a href="/gostd/net/dnsmsg.go.html#3245924">answer</a></span>&nbsp;<span class="op" id="3211178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3211183">if</span>&nbsp;<span class="ident" id="3211186">_</span><span class="op" id="3211187">,</span>&nbsp;<span class="ident" id="3211189">justHeader</span>&nbsp;<span class="op" id="3211200">:=</span>&nbsp;<span class="ident" id="3211203"><a href="/gostd/net/dnsclient.go.html#3211155">rr</a></span><span class="op" id="3211205">.</span><span class="op" id="3211206">(</span><span class="op" id="3211207">*</span><span class="ident" id="3211208"><a href="/gostd/net/dnsmsg.go.html#3231312">dnsRR_Header</a></span><span class="op" id="3211220">)</span><span class="op" id="3211221">;</span>&nbsp;<span class="ident" id="3211223"><a href="/gostd/net/dnsclient.go.html#3211189">justHeader</a></span>&nbsp;<span class="op" id="3211234">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3211240">//&nbsp;Corrupt&nbsp;record:&nbsp;we&nbsp;only&nbsp;have&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3211278">//&nbsp;header.&nbsp;That&nbsp;header&nbsp;might&nbsp;say&nbsp;it&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3211320">//&nbsp;of&nbsp;type&nbsp;qtype,&nbsp;but&nbsp;we&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3211355">//&nbsp;actually&nbsp;have&nbsp;it.&nbsp;Skip.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3211386">continue</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3211398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3211403">h</span>&nbsp;<span class="op" id="3211405">:=</span>&nbsp;<span class="ident" id="3211408"><a href="/gostd/net/dnsclient.go.html#3211155">rr</a></span><span class="op" id="3211410">.</span><span class="ident" id="3211411"><a href="/gostd/net/dnsmsg.go.html#3231814">Header</a></span><span class="op" id="3211417">(</span><span class="op" id="3211418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3211423">if</span>&nbsp;<span class="ident" id="3211426"><a href="/gostd/net/dnsclient.go.html#3211403">h</a></span><span class="op" id="3211427">.</span><span class="ident" id="3211428"><a href="/gostd/net/dnsmsg.go.html#3231389">Class</a></span>&nbsp;<span class="op" id="3211434">==</span>&nbsp;<span class="ident" id="3211437"><a href="/gostd/net/dnsmsg.go.html#3229263">dnsClassINET</a></span>&nbsp;<span class="op" id="3211450">&amp;&amp;</span>&nbsp;<span class="ident" id="3211453"><a href="/gostd/net/dnsclient.go.html#3211403">h</a></span><span class="op" id="3211454">.</span><span class="ident" id="3211455"><a href="/gostd/net/dnsmsg.go.html#3231335">Name</a></span>&nbsp;<span class="op" id="3211460">==</span>&nbsp;<span class="ident" id="3211463"><a href="/gostd/net/dnsclient.go.html#3210281">name</a></span>&nbsp;<span class="op" id="3211468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3211474">switch</span>&nbsp;<span class="ident" id="3211481"><a href="/gostd/net/dnsclient.go.html#3211403">h</a></span><span class="op" id="3211482">.</span><span class="ident" id="3211483"><a href="/gostd/net/dnsmsg.go.html#3231372">Rrtype</a></span>&nbsp;<span class="op" id="3211490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3211496">case</span>&nbsp;<span class="ident" id="3211501"><a href="/gostd/net/dnsclient.go.html#3210315">qtype</a></span><span class="op" id="3211506">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3211513"><a href="/gostd/net/dnsclient.go.html#3210344">addrs</a></span>&nbsp;<span class="op" id="3211519">=</span>&nbsp;<span class="builtinfunc" id="3211521">append</span><span class="op" id="3211527">(</span><span class="ident" id="3211528"><a href="/gostd/net/dnsclient.go.html#3210344">addrs</a></span><span class="op" id="3211533">,</span>&nbsp;<span class="ident" id="3211535"><a href="/gostd/net/dnsclient.go.html#3211155">rr</a></span><span class="op" id="3211537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3211543">case</span>&nbsp;<span class="ident" id="3211548"><a href="/gostd/net/dnsmsg.go.html#3228858">dnsTypeCNAME</a></span><span class="op" id="3211560">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3211567">//&nbsp;redirect&nbsp;to&nbsp;cname</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3211593"><a href="/gostd/net/dnsclient.go.html#3210281">name</a></span>&nbsp;<span class="op" id="3211598">=</span>&nbsp;<span class="ident" id="3211600"><a href="/gostd/net/dnsclient.go.html#3211155">rr</a></span><span class="op" id="3211602">.</span><span class="op" id="3211603">(</span><span class="op" id="3211604">*</span><span class="ident" id="3211605"><a href="/gostd/net/dnsmsg.go.html#3231894">dnsRR_CNAME</a></span><span class="op" id="3211616">)</span><span class="op" id="3211617">.</span><span class="ident" id="3211618"><a href="/gostd/net/dnsmsg.go.html#3231936">Cname</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3211629">continue</span>&nbsp;<span class="ident" id="3211638"><a href="/gostd/net/dnsclient.go.html#3211067">Cname</a></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3211648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3211653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3211657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3211661">if</span>&nbsp;<span class="builtinfunc" id="3211664">len</span><span class="op" id="3211667">(</span><span class="ident" id="3211668"><a href="/gostd/net/dnsclient.go.html#3210344">addrs</a></span><span class="op" id="3211673">)</span>&nbsp;<span class="op" id="3211675">==</span>&nbsp;<span class="num" id="3211678">0</span>&nbsp;<span class="op" id="3211680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3211685">return</span>&nbsp;<span class="string" id="3211692">&#34;&#34;</span><span class="op" id="3211694">,</span>&nbsp;<span class="builtintype" id="3211696">nil</span><span class="op" id="3211699">,</span>&nbsp;<span class="op" id="3211701">&amp;</span><span class="ident" id="3211702"><a href="/gostd/net/dnsclient.go.html#3208795">DNSError</a></span><span class="op" id="3211710">{</span><span class="ident" id="3211711"><a href="/gostd/net/dnsclient.go.html#3208814">Err</a></span><span class="op" id="3211714">:</span>&nbsp;<span class="ident" id="3211716"><a href="/gostd/net/dnsclient.go.html#3209250">noSuchHost</a></span><span class="op" id="3211726">,</span>&nbsp;<span class="ident" id="3211728"><a href="/gostd/net/dnsclient.go.html#3208860">Name</a></span><span class="op" id="3211732">:</span>&nbsp;<span class="ident" id="3211734"><a href="/gostd/net/dnsclient.go.html#3210281">name</a></span><span class="op" id="3211738">,</span>&nbsp;<span class="ident" id="3211740"><a href="/gostd/net/dnsclient.go.html#3208897">Server</a></span><span class="op" id="3211746">:</span>&nbsp;<span class="ident" id="3211748"><a href="/gostd/net/dnsclient.go.html#3210287">server</a></span><span class="op" id="3211754">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3211758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3211762">return</span>&nbsp;<span class="ident" id="3211769"><a href="/gostd/net/dnsclient.go.html#3210281">name</a></span><span class="op" id="3211773">,</span>&nbsp;<span class="ident" id="3211775"><a href="/gostd/net/dnsclient.go.html#3210344">addrs</a></span><span class="op" id="3211780">,</span>&nbsp;<span class="builtintype" id="3211782">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3211787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3211791">return</span>&nbsp;<span class="string" id="3211798">&#34;&#34;</span><span class="op" id="3211800">,</span>&nbsp;<span class="builtintype" id="3211802">nil</span><span class="op" id="3211805">,</span>&nbsp;<span class="op" id="3211807">&amp;</span><span class="ident" id="3211808"><a href="/gostd/net/dnsclient.go.html#3208795">DNSError</a></span><span class="op" id="3211816">{</span><span class="ident" id="3211817"><a href="/gostd/net/dnsclient.go.html#3208814">Err</a></span><span class="op" id="3211820">:</span>&nbsp;<span class="string" id="3211822">&#34;too&nbsp;many&nbsp;redirects&#34;</span><span class="op" id="3211842">,</span>&nbsp;<span class="ident" id="3211844"><a href="/gostd/net/dnsclient.go.html#3208860">Name</a></span><span class="op" id="3211848">:</span>&nbsp;<span class="ident" id="3211850"><a href="/gostd/net/dnsclient.go.html#3210281">name</a></span><span class="op" id="3211854">,</span>&nbsp;<span class="ident" id="3211856"><a href="/gostd/net/dnsclient.go.html#3208897">Server</a></span><span class="op" id="3211862">:</span>&nbsp;<span class="ident" id="3211864"><a href="/gostd/net/dnsclient.go.html#3210287">server</a></span><span class="op" id="3211870">}</span><br>
<span class="lineno">115</span><span class="op" id="3211872">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3211875">func</span>&nbsp;<span class="ident" id="3211880">isDomainName</span><span class="op" id="3211892">(</span><span class="ident" id="3211893">s</span>&nbsp;<span class="builtintype" id="3211895">string</span><span class="op" id="3211901">)</span>&nbsp;<span class="builtintype" id="3211903">bool</span>&nbsp;<span class="op" id="3211908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3211911">//&nbsp;See&nbsp;RFC&nbsp;1035,&nbsp;RFC&nbsp;3696.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3211939">if</span>&nbsp;<span class="builtinfunc" id="3211942">len</span><span class="op" id="3211945">(</span><span class="ident" id="3211946"><a href="/gostd/net/dnsclient.go.html#3211893">s</a></span><span class="op" id="3211947">)</span>&nbsp;<span class="op" id="3211949">==</span>&nbsp;<span class="num" id="3211952">0</span>&nbsp;<span class="op" id="3211954">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3211958">return</span>&nbsp;<span class="builtintype" id="3211965">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3211972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3211975">if</span>&nbsp;<span class="builtinfunc" id="3211978">len</span><span class="op" id="3211981">(</span><span class="ident" id="3211982"><a href="/gostd/net/dnsclient.go.html#3211893">s</a></span><span class="op" id="3211983">)</span>&nbsp;<span class="op" id="3211985">&gt;</span>&nbsp;<span class="num" id="3211987">255</span>&nbsp;<span class="op" id="3211991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3211995">return</span>&nbsp;<span class="builtintype" id="3212002">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3212009">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3212013">last</span>&nbsp;<span class="op" id="3212018">:=</span>&nbsp;<span class="builtintype" id="3212021">byte</span><span class="op" id="3212025">(</span><span class="string" id="3212026">&#39;.&#39;</span><span class="op" id="3212029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3212032">ok</span>&nbsp;<span class="op" id="3212035">:=</span>&nbsp;<span class="builtintype" id="3212038">false</span>&nbsp;<span class="comment" id="3212044">//&nbsp;Ok&nbsp;once&nbsp;we&#39;ve&nbsp;seen&nbsp;a&nbsp;letter.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3212077">partlen</span>&nbsp;<span class="op" id="3212085">:=</span>&nbsp;<span class="num" id="3212088">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3212091">for</span>&nbsp;<span class="ident" id="3212095">i</span>&nbsp;<span class="op" id="3212097">:=</span>&nbsp;<span class="num" id="3212100">0</span><span class="op" id="3212101">;</span>&nbsp;<span class="ident" id="3212103"><a href="/gostd/net/dnsclient.go.html#3212095">i</a></span>&nbsp;<span class="op" id="3212105">&lt;</span>&nbsp;<span class="builtinfunc" id="3212107">len</span><span class="op" id="3212110">(</span><span class="ident" id="3212111"><a href="/gostd/net/dnsclient.go.html#3211893">s</a></span><span class="op" id="3212112">)</span><span class="op" id="3212113">;</span>&nbsp;<span class="ident" id="3212115"><a href="/gostd/net/dnsclient.go.html#3212095">i</a></span><span class="op" id="3212116">++</span>&nbsp;<span class="op" id="3212119">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3212123">c</span>&nbsp;<span class="op" id="3212125">:=</span>&nbsp;<span class="ident" id="3212128"><a href="/gostd/net/dnsclient.go.html#3211893">s</a></span><span class="op" id="3212129">[</span><span class="ident" id="3212130"><a href="/gostd/net/dnsclient.go.html#3212095">i</a></span><span class="op" id="3212131">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3212135">switch</span>&nbsp;<span class="op" id="3212142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3212146">default</span><span class="op" id="3212153">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3212158">return</span>&nbsp;<span class="builtintype" id="3212165">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3212173">case</span>&nbsp;<span class="string" id="3212178">&#39;a&#39;</span>&nbsp;<span class="op" id="3212182">&lt;=</span>&nbsp;<span class="ident" id="3212185"><a href="/gostd/net/dnsclient.go.html#3212123">c</a></span>&nbsp;<span class="op" id="3212187">&amp;&amp;</span>&nbsp;<span class="ident" id="3212190"><a href="/gostd/net/dnsclient.go.html#3212123">c</a></span>&nbsp;<span class="op" id="3212192">&lt;=</span>&nbsp;<span class="string" id="3212195">&#39;z&#39;</span>&nbsp;<span class="op" id="3212199">||</span>&nbsp;<span class="string" id="3212202">&#39;A&#39;</span>&nbsp;<span class="op" id="3212206">&lt;=</span>&nbsp;<span class="ident" id="3212209"><a href="/gostd/net/dnsclient.go.html#3212123">c</a></span>&nbsp;<span class="op" id="3212211">&amp;&amp;</span>&nbsp;<span class="ident" id="3212214"><a href="/gostd/net/dnsclient.go.html#3212123">c</a></span>&nbsp;<span class="op" id="3212216">&lt;=</span>&nbsp;<span class="string" id="3212219">&#39;Z&#39;</span>&nbsp;<span class="op" id="3212223">||</span>&nbsp;<span class="ident" id="3212226"><a href="/gostd/net/dnsclient.go.html#3212123">c</a></span>&nbsp;<span class="op" id="3212228">==</span>&nbsp;<span class="string" id="3212231">&#39;_&#39;</span><span class="op" id="3212234">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3212239"><a href="/gostd/net/dnsclient.go.html#3212032">ok</a></span>&nbsp;<span class="op" id="3212242">=</span>&nbsp;<span class="builtintype" id="3212244">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3212252"><a href="/gostd/net/dnsclient.go.html#3212077">partlen</a></span><span class="op" id="3212259">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3212264">case</span>&nbsp;<span class="string" id="3212269">&#39;0&#39;</span>&nbsp;<span class="op" id="3212273">&lt;=</span>&nbsp;<span class="ident" id="3212276"><a href="/gostd/net/dnsclient.go.html#3212123">c</a></span>&nbsp;<span class="op" id="3212278">&amp;&amp;</span>&nbsp;<span class="ident" id="3212281"><a href="/gostd/net/dnsclient.go.html#3212123">c</a></span>&nbsp;<span class="op" id="3212283">&lt;=</span>&nbsp;<span class="string" id="3212286">&#39;9&#39;</span><span class="op" id="3212289">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3212294">//&nbsp;fine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3212305"><a href="/gostd/net/dnsclient.go.html#3212077">partlen</a></span><span class="op" id="3212312">++</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3212317">case</span>&nbsp;<span class="ident" id="3212322"><a href="/gostd/net/dnsclient.go.html#3212123">c</a></span>&nbsp;<span class="op" id="3212324">==</span>&nbsp;<span class="string" id="3212327">&#39;-&#39;</span><span class="op" id="3212330">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3212335">//&nbsp;Byte&nbsp;before&nbsp;dash&nbsp;cannot&nbsp;be&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3212373">if</span>&nbsp;<span class="ident" id="3212376"><a href="/gostd/net/dnsclient.go.html#3212013">last</a></span>&nbsp;<span class="op" id="3212381">==</span>&nbsp;<span class="string" id="3212384">&#39;.&#39;</span>&nbsp;<span class="op" id="3212388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3212394">return</span>&nbsp;<span class="builtintype" id="3212401">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3212410">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3212415"><a href="/gostd/net/dnsclient.go.html#3212077">partlen</a></span><span class="op" id="3212422">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3212427">case</span>&nbsp;<span class="ident" id="3212432"><a href="/gostd/net/dnsclient.go.html#3212123">c</a></span>&nbsp;<span class="op" id="3212434">==</span>&nbsp;<span class="string" id="3212437">&#39;.&#39;</span><span class="op" id="3212440">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3212445">//&nbsp;Byte&nbsp;before&nbsp;dot&nbsp;cannot&nbsp;be&nbsp;dot,&nbsp;dash.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3212488">if</span>&nbsp;<span class="ident" id="3212491"><a href="/gostd/net/dnsclient.go.html#3212013">last</a></span>&nbsp;<span class="op" id="3212496">==</span>&nbsp;<span class="string" id="3212499">&#39;.&#39;</span>&nbsp;<span class="op" id="3212503">||</span>&nbsp;<span class="ident" id="3212506"><a href="/gostd/net/dnsclient.go.html#3212013">last</a></span>&nbsp;<span class="op" id="3212511">==</span>&nbsp;<span class="string" id="3212514">&#39;-&#39;</span>&nbsp;<span class="op" id="3212518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3212524">return</span>&nbsp;<span class="builtintype" id="3212531">false</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3212540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3212545">if</span>&nbsp;<span class="ident" id="3212548"><a href="/gostd/net/dnsclient.go.html#3212077">partlen</a></span>&nbsp;<span class="op" id="3212556">&gt;</span>&nbsp;<span class="num" id="3212558">63</span>&nbsp;<span class="op" id="3212561">||</span>&nbsp;<span class="ident" id="3212564"><a href="/gostd/net/dnsclient.go.html#3212077">partlen</a></span>&nbsp;<span class="op" id="3212572">==</span>&nbsp;<span class="num" id="3212575">0</span>&nbsp;<span class="op" id="3212577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3212583">return</span>&nbsp;<span class="builtintype" id="3212590">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3212599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3212604"><a href="/gostd/net/dnsclient.go.html#3212077">partlen</a></span>&nbsp;<span class="op" id="3212612">=</span>&nbsp;<span class="num" id="3212614">0</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3212618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3212622"><a href="/gostd/net/dnsclient.go.html#3212013">last</a></span>&nbsp;<span class="op" id="3212627">=</span>&nbsp;<span class="ident" id="3212629"><a href="/gostd/net/dnsclient.go.html#3212123">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3212632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3212635">if</span>&nbsp;<span class="ident" id="3212638"><a href="/gostd/net/dnsclient.go.html#3212013">last</a></span>&nbsp;<span class="op" id="3212643">==</span>&nbsp;<span class="string" id="3212646">&#39;-&#39;</span>&nbsp;<span class="op" id="3212650">||</span>&nbsp;<span class="ident" id="3212653"><a href="/gostd/net/dnsclient.go.html#3212077">partlen</a></span>&nbsp;<span class="op" id="3212661">&gt;</span>&nbsp;<span class="num" id="3212663">63</span>&nbsp;<span class="op" id="3212666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3212670">return</span>&nbsp;<span class="builtintype" id="3212677">false</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3212684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3212688">return</span>&nbsp;<span class="ident" id="3212695"><a href="/gostd/net/dnsclient.go.html#3212032">ok</a></span><br>
<span class="lineno"></span><span class="op" id="3212698">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="3212701">//&nbsp;An&nbsp;SRV&nbsp;represents&nbsp;a&nbsp;single&nbsp;DNS&nbsp;SRV&nbsp;record.</span><br>
<span class="lineno"></span><span class="keyword" id="3212747">type</span>&nbsp;<span class="ident" id="3212752">SRV</span>&nbsp;<span class="keyword" id="3212756">struct</span>&nbsp;<span class="op" id="3212763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3212766">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3212775">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3212783">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3212792">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3212800">Priority</span>&nbsp;<span class="builtintype" id="3212809">uint16</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3212817">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3212826">uint16</span><br>
<span class="lineno"></span><span class="op" id="3212833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3212836">//&nbsp;byPriorityWeight&nbsp;sorts&nbsp;SRV&nbsp;records&nbsp;by&nbsp;ascending&nbsp;priority&nbsp;and&nbsp;weight.</span><br>
<span class="lineno"></span><span class="keyword" id="3212908">type</span>&nbsp;<span class="ident" id="3212913">byPriorityWeight</span>&nbsp;<span class="op" id="3212930">[</span><span class="op" id="3212931">]</span><span class="op" id="3212932">*</span><span class="ident" id="3212933"><a href="/gostd/net/dnsclient.go.html#3212752">SRV</a></span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="3212938">func</span>&nbsp;<span class="op" id="3212943">(</span><span class="ident" id="3212944">s</span>&nbsp;<span class="ident" id="3212946"><a href="/gostd/net/dnsclient.go.html#3212913">byPriorityWeight</a></span><span class="op" id="3212962">)</span>&nbsp;<span class="ident" id="3212964">Len</span><span class="op" id="3212967">(</span><span class="op" id="3212968">)</span>&nbsp;<span class="builtintype" id="3212970">int</span>&nbsp;<span class="op" id="3212974">{</span>&nbsp;<span class="keyword" id="3212976">return</span>&nbsp;<span class="builtinfunc" id="3212983">len</span><span class="op" id="3212986">(</span><span class="ident" id="3212987"><a href="/gostd/net/dnsclient.go.html#3212944">s</a></span><span class="op" id="3212988">)</span>&nbsp;<span class="op" id="3212990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3212993">func</span>&nbsp;<span class="op" id="3212998">(</span><span class="ident" id="3212999">s</span>&nbsp;<span class="ident" id="3213001"><a href="/gostd/net/dnsclient.go.html#3212913">byPriorityWeight</a></span><span class="op" id="3213017">)</span>&nbsp;<span class="ident" id="3213019">Swap</span><span class="op" id="3213023">(</span><span class="ident" id="3213024">i</span><span class="op" id="3213025">,</span>&nbsp;<span class="ident" id="3213027">j</span>&nbsp;<span class="builtintype" id="3213029">int</span><span class="op" id="3213032">)</span>&nbsp;<span class="op" id="3213034">{</span>&nbsp;<span class="ident" id="3213036"><a href="/gostd/net/dnsclient.go.html#3212999">s</a></span><span class="op" id="3213037">[</span><span class="ident" id="3213038"><a href="/gostd/net/dnsclient.go.html#3213024">i</a></span><span class="op" id="3213039">]</span><span class="op" id="3213040">,</span>&nbsp;<span class="ident" id="3213042"><a href="/gostd/net/dnsclient.go.html#3212999">s</a></span><span class="op" id="3213043">[</span><span class="ident" id="3213044"><a href="/gostd/net/dnsclient.go.html#3213027">j</a></span><span class="op" id="3213045">]</span>&nbsp;<span class="op" id="3213047">=</span>&nbsp;<span class="ident" id="3213049"><a href="/gostd/net/dnsclient.go.html#3212999">s</a></span><span class="op" id="3213050">[</span><span class="ident" id="3213051"><a href="/gostd/net/dnsclient.go.html#3213027">j</a></span><span class="op" id="3213052">]</span><span class="op" id="3213053">,</span>&nbsp;<span class="ident" id="3213055"><a href="/gostd/net/dnsclient.go.html#3212999">s</a></span><span class="op" id="3213056">[</span><span class="ident" id="3213057"><a href="/gostd/net/dnsclient.go.html#3213024">i</a></span><span class="op" id="3213058">]</span>&nbsp;<span class="op" id="3213060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="3213063">func</span>&nbsp;<span class="op" id="3213068">(</span><span class="ident" id="3213069">s</span>&nbsp;<span class="ident" id="3213071"><a href="/gostd/net/dnsclient.go.html#3212913">byPriorityWeight</a></span><span class="op" id="3213087">)</span>&nbsp;<span class="ident" id="3213089">Less</span><span class="op" id="3213093">(</span><span class="ident" id="3213094">i</span><span class="op" id="3213095">,</span>&nbsp;<span class="ident" id="3213097">j</span>&nbsp;<span class="builtintype" id="3213099">int</span><span class="op" id="3213102">)</span>&nbsp;<span class="builtintype" id="3213104">bool</span>&nbsp;<span class="op" id="3213109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3213112">return</span>&nbsp;<span class="ident" id="3213119"><a href="/gostd/net/dnsclient.go.html#3213069">s</a></span><span class="op" id="3213120">[</span><span class="ident" id="3213121"><a href="/gostd/net/dnsclient.go.html#3213094">i</a></span><span class="op" id="3213122">]</span><span class="op" id="3213123">.</span><span class="ident" id="3213124"><a href="/gostd/net/dnsclient.go.html#3212800">Priority</a></span>&nbsp;<span class="op" id="3213133">&lt;</span>&nbsp;<span class="ident" id="3213135"><a href="/gostd/net/dnsclient.go.html#3213069">s</a></span><span class="op" id="3213136">[</span><span class="ident" id="3213137"><a href="/gostd/net/dnsclient.go.html#3213097">j</a></span><span class="op" id="3213138">]</span><span class="op" id="3213139">.</span><span class="ident" id="3213140"><a href="/gostd/net/dnsclient.go.html#3212800">Priority</a></span>&nbsp;<span class="op" id="3213149">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3213154">(</span><span class="ident" id="3213155"><a href="/gostd/net/dnsclient.go.html#3213069">s</a></span><span class="op" id="3213156">[</span><span class="ident" id="3213157"><a href="/gostd/net/dnsclient.go.html#3213094">i</a></span><span class="op" id="3213158">]</span><span class="op" id="3213159">.</span><span class="ident" id="3213160"><a href="/gostd/net/dnsclient.go.html#3212800">Priority</a></span>&nbsp;<span class="op" id="3213169">==</span>&nbsp;<span class="ident" id="3213172"><a href="/gostd/net/dnsclient.go.html#3213069">s</a></span><span class="op" id="3213173">[</span><span class="ident" id="3213174"><a href="/gostd/net/dnsclient.go.html#3213097">j</a></span><span class="op" id="3213175">]</span><span class="op" id="3213176">.</span><span class="ident" id="3213177"><a href="/gostd/net/dnsclient.go.html#3212800">Priority</a></span>&nbsp;<span class="op" id="3213186">&amp;&amp;</span>&nbsp;<span class="ident" id="3213189"><a href="/gostd/net/dnsclient.go.html#3213069">s</a></span><span class="op" id="3213190">[</span><span class="ident" id="3213191"><a href="/gostd/net/dnsclient.go.html#3213094">i</a></span><span class="op" id="3213192">]</span><span class="op" id="3213193">.</span><span class="ident" id="3213194"><a href="/gostd/net/dnsclient.go.html#3212817">Weight</a></span>&nbsp;<span class="op" id="3213201">&lt;</span>&nbsp;<span class="ident" id="3213203"><a href="/gostd/net/dnsclient.go.html#3213069">s</a></span><span class="op" id="3213204">[</span><span class="ident" id="3213205"><a href="/gostd/net/dnsclient.go.html#3213097">j</a></span><span class="op" id="3213206">]</span><span class="op" id="3213207">.</span><span class="ident" id="3213208"><a href="/gostd/net/dnsclient.go.html#3212817">Weight</a></span><span class="op" id="3213214">)</span><br>
<span class="lineno"></span><span class="op" id="3213216">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="comment" id="3213219">//&nbsp;shuffleByWeight&nbsp;shuffles&nbsp;SRV&nbsp;records&nbsp;by&nbsp;weight&nbsp;using&nbsp;the&nbsp;algorithm</span><br>
<span class="lineno"></span><span class="comment" id="3213289">//&nbsp;described&nbsp;in&nbsp;RFC&nbsp;2782.</span><br>
<span class="lineno"></span><span class="keyword" id="3213315">func</span>&nbsp;<span class="op" id="3213320">(</span><span class="ident" id="3213321">addrs</span>&nbsp;<span class="ident" id="3213327"><a href="/gostd/net/dnsclient.go.html#3212913">byPriorityWeight</a></span><span class="op" id="3213343">)</span>&nbsp;<span class="ident" id="3213345">shuffleByWeight</span><span class="op" id="3213360">(</span><span class="op" id="3213361">)</span>&nbsp;<span class="op" id="3213363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3213366">sum</span>&nbsp;<span class="op" id="3213370">:=</span>&nbsp;<span class="num" id="3213373">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3213376">for</span>&nbsp;<span class="ident" id="3213380">_</span><span class="op" id="3213381">,</span>&nbsp;<span class="ident" id="3213383">addr</span>&nbsp;<span class="op" id="3213388">:=</span>&nbsp;<span class="keyword" id="3213391">range</span>&nbsp;<span class="ident" id="3213397"><a href="/gostd/net/dnsclient.go.html#3213321">addrs</a></span>&nbsp;<span class="op" id="3213403">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3213407"><a href="/gostd/net/dnsclient.go.html#3213366">sum</a></span>&nbsp;<span class="op" id="3213411">+=</span>&nbsp;<span class="builtintype" id="3213414">int</span><span class="op" id="3213417">(</span><span class="ident" id="3213418"><a href="/gostd/net/dnsclient.go.html#3213383">addr</a></span><span class="op" id="3213422">.</span><span class="ident" id="3213423"><a href="/gostd/net/dnsclient.go.html#3212817">Weight</a></span><span class="op" id="3213429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3213432">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3213435">for</span>&nbsp;<span class="ident" id="3213439"><a href="/gostd/net/dnsclient.go.html#3213366">sum</a></span>&nbsp;<span class="op" id="3213443">&gt;</span>&nbsp;<span class="num" id="3213445">0</span>&nbsp;<span class="op" id="3213447">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="3213450">len</span><span class="op" id="3213453">(</span><span class="ident" id="3213454"><a href="/gostd/net/dnsclient.go.html#3213321">addrs</a></span><span class="op" id="3213459">)</span>&nbsp;<span class="op" id="3213461">&gt;</span>&nbsp;<span class="num" id="3213463">1</span>&nbsp;<span class="op" id="3213465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3213469">s</span>&nbsp;<span class="op" id="3213471">:=</span>&nbsp;<span class="num" id="3213474">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3213478">n</span>&nbsp;<span class="op" id="3213480">:=</span>&nbsp;<span class="ident" id="3213483"><a href="/gostd/net/dnsclient.go.html#3208724">rand</a></span><span class="op" id="3213487">.</span><span class="ident" id="3213488"><a href="/gostd/math/rand/rand.go.html#2927246">Intn</a></span><span class="op" id="3213492">(</span><span class="ident" id="3213493"><a href="/gostd/net/dnsclient.go.html#3213366">sum</a></span><span class="op" id="3213496">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3213500">for</span>&nbsp;<span class="ident" id="3213504">i</span>&nbsp;<span class="op" id="3213506">:=</span>&nbsp;<span class="keyword" id="3213509">range</span>&nbsp;<span class="ident" id="3213515"><a href="/gostd/net/dnsclient.go.html#3213321">addrs</a></span>&nbsp;<span class="op" id="3213521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3213526"><a href="/gostd/net/dnsclient.go.html#3213469">s</a></span>&nbsp;<span class="op" id="3213528">+=</span>&nbsp;<span class="builtintype" id="3213531">int</span><span class="op" id="3213534">(</span><span class="ident" id="3213535"><a href="/gostd/net/dnsclient.go.html#3213321">addrs</a></span><span class="op" id="3213540">[</span><span class="ident" id="3213541"><a href="/gostd/net/dnsclient.go.html#3213504">i</a></span><span class="op" id="3213542">]</span><span class="op" id="3213543">.</span><span class="ident" id="3213544"><a href="/gostd/net/dnsclient.go.html#3212817">Weight</a></span><span class="op" id="3213550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3213555">if</span>&nbsp;<span class="ident" id="3213558"><a href="/gostd/net/dnsclient.go.html#3213469">s</a></span>&nbsp;<span class="op" id="3213560">&gt;</span>&nbsp;<span class="ident" id="3213562"><a href="/gostd/net/dnsclient.go.html#3213478">n</a></span>&nbsp;<span class="op" id="3213564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3213570">if</span>&nbsp;<span class="ident" id="3213573"><a href="/gostd/net/dnsclient.go.html#3213504">i</a></span>&nbsp;<span class="op" id="3213575">&gt;</span>&nbsp;<span class="num" id="3213577">0</span>&nbsp;<span class="op" id="3213579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3213586"><a href="/gostd/net/dnsclient.go.html#3213321">addrs</a></span><span class="op" id="3213591">[</span><span class="num" id="3213592">0</span><span class="op" id="3213593">]</span><span class="op" id="3213594">,</span>&nbsp;<span class="ident" id="3213596"><a href="/gostd/net/dnsclient.go.html#3213321">addrs</a></span><span class="op" id="3213601">[</span><span class="ident" id="3213602"><a href="/gostd/net/dnsclient.go.html#3213504">i</a></span><span class="op" id="3213603">]</span>&nbsp;<span class="op" id="3213605">=</span>&nbsp;<span class="ident" id="3213607"><a href="/gostd/net/dnsclient.go.html#3213321">addrs</a></span><span class="op" id="3213612">[</span><span class="ident" id="3213613"><a href="/gostd/net/dnsclient.go.html#3213504">i</a></span><span class="op" id="3213614">]</span><span class="op" id="3213615">,</span>&nbsp;<span class="ident" id="3213617"><a href="/gostd/net/dnsclient.go.html#3213321">addrs</a></span><span class="op" id="3213622">[</span><span class="num" id="3213623">0</span><span class="op" id="3213624">]</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3213630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3213636">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3213645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3213649">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3213653"><a href="/gostd/net/dnsclient.go.html#3213366">sum</a></span>&nbsp;<span class="op" id="3213657">-=</span>&nbsp;<span class="builtintype" id="3213660">int</span><span class="op" id="3213663">(</span><span class="ident" id="3213664"><a href="/gostd/net/dnsclient.go.html#3213321">addrs</a></span><span class="op" id="3213669">[</span><span class="num" id="3213670">0</span><span class="op" id="3213671">]</span><span class="op" id="3213672">.</span><span class="ident" id="3213673"><a href="/gostd/net/dnsclient.go.html#3212817">Weight</a></span><span class="op" id="3213679">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3213683"><a href="/gostd/net/dnsclient.go.html#3213321">addrs</a></span>&nbsp;<span class="op" id="3213689">=</span>&nbsp;<span class="ident" id="3213691"><a href="/gostd/net/dnsclient.go.html#3213321">addrs</a></span><span class="op" id="3213696">[</span><span class="num" id="3213697">1</span><span class="op" id="3213698">:</span><span class="op" id="3213699">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3213702">}</span><br>
<span class="lineno"></span><span class="op" id="3213704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3213707">//&nbsp;sort&nbsp;reorders&nbsp;SRV&nbsp;records&nbsp;as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;2782.</span><br>
<span class="lineno">210</span><span class="keyword" id="3213762">func</span>&nbsp;<span class="op" id="3213767">(</span><span class="ident" id="3213768">addrs</span>&nbsp;<span class="ident" id="3213774"><a href="/gostd/net/dnsclient.go.html#3212913">byPriorityWeight</a></span><span class="op" id="3213790">)</span>&nbsp;<span class="ident" id="3213792">sort</span><span class="op" id="3213796">(</span><span class="op" id="3213797">)</span>&nbsp;<span class="op" id="3213799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3213802"><a href="/gostd/net/dnsclient.go.html#3208737">sort</a></span><span class="op" id="3213806">.</span><span class="ident" id="3213807"><a href="/gostd/sort/sort.go.html#2015380">Sort</a></span><span class="op" id="3213811">(</span><span class="ident" id="3213812"><a href="/gostd/net/dnsclient.go.html#3213768">addrs</a></span><span class="op" id="3213817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3213820">i</span>&nbsp;<span class="op" id="3213822">:=</span>&nbsp;<span class="num" id="3213825">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3213828">for</span>&nbsp;<span class="ident" id="3213832">j</span>&nbsp;<span class="op" id="3213834">:=</span>&nbsp;<span class="num" id="3213837">1</span><span class="op" id="3213838">;</span>&nbsp;<span class="ident" id="3213840"><a href="/gostd/net/dnsclient.go.html#3213832">j</a></span>&nbsp;<span class="op" id="3213842">&lt;</span>&nbsp;<span class="builtinfunc" id="3213844">len</span><span class="op" id="3213847">(</span><span class="ident" id="3213848"><a href="/gostd/net/dnsclient.go.html#3213768">addrs</a></span><span class="op" id="3213853">)</span><span class="op" id="3213854">;</span>&nbsp;<span class="ident" id="3213856"><a href="/gostd/net/dnsclient.go.html#3213832">j</a></span><span class="op" id="3213857">++</span>&nbsp;<span class="op" id="3213860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3213864">if</span>&nbsp;<span class="ident" id="3213867"><a href="/gostd/net/dnsclient.go.html#3213768">addrs</a></span><span class="op" id="3213872">[</span><span class="ident" id="3213873"><a href="/gostd/net/dnsclient.go.html#3213820">i</a></span><span class="op" id="3213874">]</span><span class="op" id="3213875">.</span><span class="ident" id="3213876"><a href="/gostd/net/dnsclient.go.html#3212800">Priority</a></span>&nbsp;<span class="op" id="3213885">!=</span>&nbsp;<span class="ident" id="3213888"><a href="/gostd/net/dnsclient.go.html#3213768">addrs</a></span><span class="op" id="3213893">[</span><span class="ident" id="3213894"><a href="/gostd/net/dnsclient.go.html#3213832">j</a></span><span class="op" id="3213895">]</span><span class="op" id="3213896">.</span><span class="ident" id="3213897"><a href="/gostd/net/dnsclient.go.html#3212800">Priority</a></span>&nbsp;<span class="op" id="3213906">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3213911"><a href="/gostd/net/dnsclient.go.html#3213768">addrs</a></span><span class="op" id="3213916">[</span><span class="ident" id="3213917"><a href="/gostd/net/dnsclient.go.html#3213820">i</a></span><span class="op" id="3213918">:</span><span class="ident" id="3213919"><a href="/gostd/net/dnsclient.go.html#3213832">j</a></span><span class="op" id="3213920">]</span><span class="op" id="3213921">.</span><span class="ident" id="3213922"><a href="/gostd/net/dnsclient.go.html#3213345">shuffleByWeight</a></span><span class="op" id="3213937">(</span><span class="op" id="3213938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3213943"><a href="/gostd/net/dnsclient.go.html#3213820">i</a></span>&nbsp;<span class="op" id="3213945">=</span>&nbsp;<span class="ident" id="3213947"><a href="/gostd/net/dnsclient.go.html#3213832">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3213951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3213954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3213957"><a href="/gostd/net/dnsclient.go.html#3213768">addrs</a></span><span class="op" id="3213962">[</span><span class="ident" id="3213963"><a href="/gostd/net/dnsclient.go.html#3213820">i</a></span><span class="op" id="3213964">:</span><span class="op" id="3213965">]</span><span class="op" id="3213966">.</span><span class="ident" id="3213967"><a href="/gostd/net/dnsclient.go.html#3213345">shuffleByWeight</a></span><span class="op" id="3213982">(</span><span class="op" id="3213983">)</span><br>
<span class="lineno">220</span><span class="op" id="3213985">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3213988">//&nbsp;An&nbsp;MX&nbsp;represents&nbsp;a&nbsp;single&nbsp;DNS&nbsp;MX&nbsp;record.</span><br>
<span class="lineno"></span><span class="keyword" id="3214032">type</span>&nbsp;<span class="ident" id="3214037">MX</span>&nbsp;<span class="keyword" id="3214040">struct</span>&nbsp;<span class="op" id="3214047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3214050">Host</span>&nbsp;<span class="builtintype" id="3214055">string</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3214063">Pref</span>&nbsp;<span class="builtintype" id="3214068">uint16</span><br>
<span class="lineno"></span><span class="op" id="3214075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3214078">//&nbsp;byPref&nbsp;implements&nbsp;sort.Interface&nbsp;to&nbsp;sort&nbsp;MX&nbsp;records&nbsp;by&nbsp;preference</span><br>
<span class="lineno"></span><span class="keyword" id="3214147">type</span>&nbsp;<span class="ident" id="3214152">byPref</span>&nbsp;<span class="op" id="3214159">[</span><span class="op" id="3214160">]</span><span class="op" id="3214161">*</span><span class="ident" id="3214162"><a href="/gostd/net/dnsclient.go.html#3214037">MX</a></span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="3214166">func</span>&nbsp;<span class="op" id="3214171">(</span><span class="ident" id="3214172">s</span>&nbsp;<span class="ident" id="3214174"><a href="/gostd/net/dnsclient.go.html#3214152">byPref</a></span><span class="op" id="3214180">)</span>&nbsp;<span class="ident" id="3214182">Len</span><span class="op" id="3214185">(</span><span class="op" id="3214186">)</span>&nbsp;<span class="builtintype" id="3214188">int</span>&nbsp;<span class="op" id="3214192">{</span>&nbsp;<span class="keyword" id="3214194">return</span>&nbsp;<span class="builtinfunc" id="3214201">len</span><span class="op" id="3214204">(</span><span class="ident" id="3214205"><a href="/gostd/net/dnsclient.go.html#3214172">s</a></span><span class="op" id="3214206">)</span>&nbsp;<span class="op" id="3214208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3214211">func</span>&nbsp;<span class="op" id="3214216">(</span><span class="ident" id="3214217">s</span>&nbsp;<span class="ident" id="3214219"><a href="/gostd/net/dnsclient.go.html#3214152">byPref</a></span><span class="op" id="3214225">)</span>&nbsp;<span class="ident" id="3214227">Less</span><span class="op" id="3214231">(</span><span class="ident" id="3214232">i</span><span class="op" id="3214233">,</span>&nbsp;<span class="ident" id="3214235">j</span>&nbsp;<span class="builtintype" id="3214237">int</span><span class="op" id="3214240">)</span>&nbsp;<span class="builtintype" id="3214242">bool</span>&nbsp;<span class="op" id="3214247">{</span>&nbsp;<span class="keyword" id="3214249">return</span>&nbsp;<span class="ident" id="3214256"><a href="/gostd/net/dnsclient.go.html#3214217">s</a></span><span class="op" id="3214257">[</span><span class="ident" id="3214258"><a href="/gostd/net/dnsclient.go.html#3214232">i</a></span><span class="op" id="3214259">]</span><span class="op" id="3214260">.</span><span class="ident" id="3214261"><a href="/gostd/net/dnsclient.go.html#3214063">Pref</a></span>&nbsp;<span class="op" id="3214266">&lt;</span>&nbsp;<span class="ident" id="3214268"><a href="/gostd/net/dnsclient.go.html#3214217">s</a></span><span class="op" id="3214269">[</span><span class="ident" id="3214270"><a href="/gostd/net/dnsclient.go.html#3214235">j</a></span><span class="op" id="3214271">]</span><span class="op" id="3214272">.</span><span class="ident" id="3214273"><a href="/gostd/net/dnsclient.go.html#3214063">Pref</a></span>&nbsp;<span class="op" id="3214278">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="3214281">func</span>&nbsp;<span class="op" id="3214286">(</span><span class="ident" id="3214287">s</span>&nbsp;<span class="ident" id="3214289"><a href="/gostd/net/dnsclient.go.html#3214152">byPref</a></span><span class="op" id="3214295">)</span>&nbsp;<span class="ident" id="3214297">Swap</span><span class="op" id="3214301">(</span><span class="ident" id="3214302">i</span><span class="op" id="3214303">,</span>&nbsp;<span class="ident" id="3214305">j</span>&nbsp;<span class="builtintype" id="3214307">int</span><span class="op" id="3214310">)</span>&nbsp;<span class="op" id="3214312">{</span>&nbsp;<span class="ident" id="3214314"><a href="/gostd/net/dnsclient.go.html#3214287">s</a></span><span class="op" id="3214315">[</span><span class="ident" id="3214316"><a href="/gostd/net/dnsclient.go.html#3214302">i</a></span><span class="op" id="3214317">]</span><span class="op" id="3214318">,</span>&nbsp;<span class="ident" id="3214320"><a href="/gostd/net/dnsclient.go.html#3214287">s</a></span><span class="op" id="3214321">[</span><span class="ident" id="3214322"><a href="/gostd/net/dnsclient.go.html#3214305">j</a></span><span class="op" id="3214323">]</span>&nbsp;<span class="op" id="3214325">=</span>&nbsp;<span class="ident" id="3214327"><a href="/gostd/net/dnsclient.go.html#3214287">s</a></span><span class="op" id="3214328">[</span><span class="ident" id="3214329"><a href="/gostd/net/dnsclient.go.html#3214305">j</a></span><span class="op" id="3214330">]</span><span class="op" id="3214331">,</span>&nbsp;<span class="ident" id="3214333"><a href="/gostd/net/dnsclient.go.html#3214287">s</a></span><span class="op" id="3214334">[</span><span class="ident" id="3214335"><a href="/gostd/net/dnsclient.go.html#3214302">i</a></span><span class="op" id="3214336">]</span>&nbsp;<span class="op" id="3214338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3214341">//&nbsp;sort&nbsp;reorders&nbsp;MX&nbsp;records&nbsp;as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;5321.</span><br>
<span class="lineno"></span><span class="keyword" id="3214395">func</span>&nbsp;<span class="op" id="3214400">(</span><span class="ident" id="3214401">s</span>&nbsp;<span class="ident" id="3214403"><a href="/gostd/net/dnsclient.go.html#3214152">byPref</a></span><span class="op" id="3214409">)</span>&nbsp;<span class="ident" id="3214411">sort</span><span class="op" id="3214415">(</span><span class="op" id="3214416">)</span>&nbsp;<span class="op" id="3214418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3214421">for</span>&nbsp;<span class="ident" id="3214425">i</span>&nbsp;<span class="op" id="3214427">:=</span>&nbsp;<span class="keyword" id="3214430">range</span>&nbsp;<span class="ident" id="3214436"><a href="/gostd/net/dnsclient.go.html#3214401">s</a></span>&nbsp;<span class="op" id="3214438">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3214442">j</span>&nbsp;<span class="op" id="3214444">:=</span>&nbsp;<span class="ident" id="3214447"><a href="/gostd/net/dnsclient.go.html#3208724">rand</a></span><span class="op" id="3214451">.</span><span class="ident" id="3214452"><a href="/gostd/math/rand/rand.go.html#2927246">Intn</a></span><span class="op" id="3214456">(</span><span class="ident" id="3214457"><a href="/gostd/net/dnsclient.go.html#3214425">i</a></span>&nbsp;<span class="op" id="3214459">+</span>&nbsp;<span class="num" id="3214461">1</span><span class="op" id="3214462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3214466"><a href="/gostd/net/dnsclient.go.html#3214401">s</a></span><span class="op" id="3214467">[</span><span class="ident" id="3214468"><a href="/gostd/net/dnsclient.go.html#3214425">i</a></span><span class="op" id="3214469">]</span><span class="op" id="3214470">,</span>&nbsp;<span class="ident" id="3214472"><a href="/gostd/net/dnsclient.go.html#3214401">s</a></span><span class="op" id="3214473">[</span><span class="ident" id="3214474"><a href="/gostd/net/dnsclient.go.html#3214442">j</a></span><span class="op" id="3214475">]</span>&nbsp;<span class="op" id="3214477">=</span>&nbsp;<span class="ident" id="3214479"><a href="/gostd/net/dnsclient.go.html#3214401">s</a></span><span class="op" id="3214480">[</span><span class="ident" id="3214481"><a href="/gostd/net/dnsclient.go.html#3214442">j</a></span><span class="op" id="3214482">]</span><span class="op" id="3214483">,</span>&nbsp;<span class="ident" id="3214485"><a href="/gostd/net/dnsclient.go.html#3214401">s</a></span><span class="op" id="3214486">[</span><span class="ident" id="3214487"><a href="/gostd/net/dnsclient.go.html#3214425">i</a></span><span class="op" id="3214488">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3214491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3214494"><a href="/gostd/net/dnsclient.go.html#3208737">sort</a></span><span class="op" id="3214498">.</span><span class="ident" id="3214499"><a href="/gostd/sort/sort.go.html#2015380">Sort</a></span><span class="op" id="3214503">(</span><span class="ident" id="3214504"><a href="/gostd/net/dnsclient.go.html#3214401">s</a></span><span class="op" id="3214505">)</span><br>
<span class="lineno"></span><span class="op" id="3214507">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="comment" id="3214510">//&nbsp;An&nbsp;NS&nbsp;represents&nbsp;a&nbsp;single&nbsp;DNS&nbsp;NS&nbsp;record.</span><br>
<span class="lineno"></span><span class="keyword" id="3214554">type</span>&nbsp;<span class="ident" id="3214559">NS</span>&nbsp;<span class="keyword" id="3214562">struct</span>&nbsp;<span class="op" id="3214569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3214572">Host</span>&nbsp;<span class="builtintype" id="3214577">string</span><br>
<span class="lineno"></span><span class="op" id="3214584">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
