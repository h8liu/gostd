<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net/textproto</h2>
<ul>
<li><a href="/gostd/net/textproto/header.go.html">header.go</a></li>
<li><a href="/gostd/net/textproto/pipeline.go.html">pipeline.go</a></li>
<li><a href="/gostd/net/textproto/reader.go.html">reader.go</a></li>
<li><a href="/gostd/net/textproto/reader_test.go.html">reader_test.go</a></li>
<li><a href="/gostd/net/textproto/textproto.go.html">textproto.go</a></li>
<li><a href="/gostd/net/textproto/writer.go.html">writer.go</a></li>
<li><a href="/gostd/net/textproto/writer_test.go.html">writer_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4566977">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4567033">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4567087">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4567138">//&nbsp;Package&nbsp;textproto&nbsp;implements&nbsp;generic&nbsp;support&nbsp;for&nbsp;text-based&nbsp;request/response</span><br>
<span class="lineno"></span><span class="comment" id="4567218">//&nbsp;protocols&nbsp;in&nbsp;the&nbsp;style&nbsp;of&nbsp;HTTP,&nbsp;NNTP,&nbsp;and&nbsp;SMTP.</span><br>
<span class="lineno"></span><span class="comment" id="4567269">//</span><br>
<span class="lineno"></span><span class="comment" id="4567272">//&nbsp;The&nbsp;package&nbsp;provides:</span><br>
<span class="lineno"></span><span class="comment" id="4567297">//</span><br>
<span class="lineno">10</span><span class="comment" id="4567300">//&nbsp;Error,&nbsp;which&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="4567357">//&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="comment" id="4567370">//</span><br>
<span class="lineno"></span><span class="comment" id="4567373">//&nbsp;Pipeline,&nbsp;to&nbsp;manage&nbsp;pipelined&nbsp;requests&nbsp;and&nbsp;responses</span><br>
<span class="lineno"></span><span class="comment" id="4567429">//&nbsp;in&nbsp;a&nbsp;client.</span><br>
<span class="lineno">15</span><span class="comment" id="4567445">//</span><br>
<span class="lineno"></span><span class="comment" id="4567448">//&nbsp;Reader,&nbsp;to&nbsp;read&nbsp;numeric&nbsp;response&nbsp;code&nbsp;lines,</span><br>
<span class="lineno"></span><span class="comment" id="4567496">//&nbsp;key:&nbsp;value&nbsp;headers,&nbsp;lines&nbsp;wrapped&nbsp;with&nbsp;leading&nbsp;spaces</span><br>
<span class="lineno"></span><span class="comment" id="4567553">//&nbsp;on&nbsp;continuation&nbsp;lines,&nbsp;and&nbsp;whole&nbsp;text&nbsp;blocks&nbsp;ending</span><br>
<span class="lineno"></span><span class="comment" id="4567608">//&nbsp;with&nbsp;a&nbsp;dot&nbsp;on&nbsp;a&nbsp;line&nbsp;by&nbsp;itself.</span><br>
<span class="lineno">20</span><span class="comment" id="4567643">//</span><br>
<span class="lineno"></span><span class="comment" id="4567646">//&nbsp;Writer,&nbsp;to&nbsp;write&nbsp;dot-encoded&nbsp;text&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="comment" id="4567691">//</span><br>
<span class="lineno"></span><span class="comment" id="4567694">//&nbsp;Conn,&nbsp;a&nbsp;convenient&nbsp;packaging&nbsp;of&nbsp;Reader,&nbsp;Writer,&nbsp;and&nbsp;Pipeline&nbsp;for&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="4567766">//&nbsp;with&nbsp;a&nbsp;single&nbsp;network&nbsp;connection.</span><br>
<span class="lineno">25</span><span class="comment" id="4567803">//</span><br>
<span class="lineno"></span><span class="keyword" id="4567806">package</span>&nbsp;<span class="ident" id="4567814">textproto</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4567825">import</span>&nbsp;<span class="op" id="4567832">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4567835">&#34;bufio&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4567844">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4567851">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4567857">&#34;net&#34;</span><br>
<span class="lineno"></span><span class="op" id="4567863">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="4567866">//&nbsp;An&nbsp;Error&nbsp;represents&nbsp;a&nbsp;numeric&nbsp;error&nbsp;response&nbsp;from&nbsp;a&nbsp;server.</span><br>
<span class="lineno"></span><span class="keyword" id="4567929">type</span>&nbsp;<span class="ident" id="4567934">Error</span>&nbsp;<span class="keyword" id="4567940">struct</span>&nbsp;<span class="op" id="4567947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4567950">Code</span>&nbsp;<span class="builtintype" id="4567955">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4567960">Msg</span>&nbsp;&nbsp;<span class="builtintype" id="4567965">string</span><br>
<span class="lineno"></span><span class="op" id="4567972">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4567975">func</span>&nbsp;<span class="op" id="4567980">(</span><span class="ident" id="4567981">e</span>&nbsp;<span class="op" id="4567983">*</span><span class="ident" id="4567984">Error</span><span class="op" id="4567989">)</span>&nbsp;<span class="ident" id="4567991">Error</span><span class="op" id="4567996">(</span><span class="op" id="4567997">)</span>&nbsp;<span class="builtintype" id="4567999">string</span>&nbsp;<span class="op" id="4568006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4568009">return</span>&nbsp;<span class="ident" id="4568016">fmt</span><span class="op" id="4568019">.</span><span class="ident" id="4568020">Sprintf</span><span class="op" id="4568027">(</span><span class="string" id="4568028">&#34;%03d&nbsp;%s&#34;</span><span class="op" id="4568037">,</span>&nbsp;<span class="ident" id="4568039">e</span><span class="op" id="4568040">.</span><span class="ident" id="4568041">Code</span><span class="op" id="4568045">,</span>&nbsp;<span class="ident" id="4568047">e</span><span class="op" id="4568048">.</span><span class="ident" id="4568049">Msg</span><span class="op" id="4568052">)</span><br>
<span class="lineno"></span><span class="op" id="4568054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="4568057">//&nbsp;A&nbsp;ProtocolError&nbsp;describes&nbsp;a&nbsp;protocol&nbsp;violation&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="4568112">//&nbsp;as&nbsp;an&nbsp;invalid&nbsp;response&nbsp;or&nbsp;a&nbsp;hung-up&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="4568163">type</span>&nbsp;<span class="ident" id="4568168">ProtocolError</span>&nbsp;<span class="builtintype" id="4568182">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4568190">func</span>&nbsp;<span class="op" id="4568195">(</span><span class="ident" id="4568196">p</span>&nbsp;<span class="ident" id="4568198">ProtocolError</span><span class="op" id="4568211">)</span>&nbsp;<span class="ident" id="4568213">Error</span><span class="op" id="4568218">(</span><span class="op" id="4568219">)</span>&nbsp;<span class="builtintype" id="4568221">string</span>&nbsp;<span class="op" id="4568228">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4568231">return</span>&nbsp;<span class="builtintype" id="4568238">string</span><span class="op" id="4568244">(</span><span class="ident" id="4568245">p</span><span class="op" id="4568246">)</span><br>
<span class="lineno"></span><span class="op" id="4568248">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4568251">//&nbsp;A&nbsp;Conn&nbsp;represents&nbsp;a&nbsp;textual&nbsp;network&nbsp;protocol&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="4568311">//&nbsp;It&nbsp;consists&nbsp;of&nbsp;a&nbsp;Reader&nbsp;and&nbsp;Writer&nbsp;to&nbsp;manage&nbsp;I/O</span><br>
<span class="lineno">55</span><span class="comment" id="4568363">//&nbsp;and&nbsp;a&nbsp;Pipeline&nbsp;to&nbsp;sequence&nbsp;concurrent&nbsp;requests&nbsp;on&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="comment" id="4568432">//&nbsp;These&nbsp;embedded&nbsp;types&nbsp;carry&nbsp;methods&nbsp;with&nbsp;them;</span><br>
<span class="lineno"></span><span class="comment" id="4568481">//&nbsp;see&nbsp;the&nbsp;documentation&nbsp;of&nbsp;those&nbsp;types&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span><span class="keyword" id="4568534">type</span>&nbsp;<span class="ident" id="4568539">Conn</span>&nbsp;<span class="keyword" id="4568544">struct</span>&nbsp;<span class="op" id="4568551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568554">Reader</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568562">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568570">Pipeline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568580">conn</span>&nbsp;<span class="ident" id="4568585">io</span><span class="op" id="4568587">.</span><span class="ident" id="4568588">ReadWriteCloser</span><br>
<span class="lineno"></span><span class="op" id="4568604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="comment" id="4568607">//&nbsp;NewConn&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;using&nbsp;conn&nbsp;for&nbsp;I/O.</span><br>
<span class="lineno"></span><span class="keyword" id="4568657">func</span>&nbsp;<span class="ident" id="4568662">NewConn</span><span class="op" id="4568669">(</span><span class="ident" id="4568670">conn</span>&nbsp;<span class="ident" id="4568675">io</span><span class="op" id="4568677">.</span><span class="ident" id="4568678">ReadWriteCloser</span><span class="op" id="4568693">)</span>&nbsp;<span class="op" id="4568695">*</span><span class="ident" id="4568696">Conn</span>&nbsp;<span class="op" id="4568701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4568704">return</span>&nbsp;<span class="op" id="4568711">&amp;</span><span class="ident" id="4568712">Conn</span><span class="op" id="4568716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568720">Reader</span><span class="op" id="4568726">:</span>&nbsp;<span class="ident" id="4568728">Reader</span><span class="op" id="4568734">{</span><span class="ident" id="4568735">R</span><span class="op" id="4568736">:</span>&nbsp;<span class="ident" id="4568738">bufio</span><span class="op" id="4568743">.</span><span class="ident" id="4568744">NewReader</span><span class="op" id="4568753">(</span><span class="ident" id="4568754">conn</span><span class="op" id="4568758">)</span><span class="op" id="4568759">}</span><span class="op" id="4568760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568764">Writer</span><span class="op" id="4568770">:</span>&nbsp;<span class="ident" id="4568772">Writer</span><span class="op" id="4568778">{</span><span class="ident" id="4568779">W</span><span class="op" id="4568780">:</span>&nbsp;<span class="ident" id="4568782">bufio</span><span class="op" id="4568787">.</span><span class="ident" id="4568788">NewWriter</span><span class="op" id="4568797">(</span><span class="ident" id="4568798">conn</span><span class="op" id="4568802">)</span><span class="op" id="4568803">}</span><span class="op" id="4568804">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4568808">conn</span><span class="op" id="4568812">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4568816">conn</span><span class="op" id="4568820">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4568823">}</span><br>
<span class="lineno"></span><span class="op" id="4568825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4568828">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;connection.</span><br>
<span class="lineno">75</span><span class="keyword" id="4568860">func</span>&nbsp;<span class="op" id="4568865">(</span><span class="ident" id="4568866">c</span>&nbsp;<span class="op" id="4568868">*</span><span class="ident" id="4568869">Conn</span><span class="op" id="4568873">)</span>&nbsp;<span class="ident" id="4568875">Close</span><span class="op" id="4568880">(</span><span class="op" id="4568881">)</span>&nbsp;<span class="builtintype" id="4568883">error</span>&nbsp;<span class="op" id="4568889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4568892">return</span>&nbsp;<span class="ident" id="4568899">c</span><span class="op" id="4568900">.</span><span class="ident" id="4568901">conn</span><span class="op" id="4568905">.</span><span class="ident" id="4568906">Close</span><span class="op" id="4568911">(</span><span class="op" id="4568912">)</span><br>
<span class="lineno"></span><span class="op" id="4568914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4568917">//&nbsp;Dial&nbsp;connects&nbsp;to&nbsp;the&nbsp;given&nbsp;address&nbsp;on&nbsp;the&nbsp;given&nbsp;network&nbsp;using&nbsp;net.Dial</span><br>
<span class="lineno">80</span><span class="comment" id="4568991">//&nbsp;and&nbsp;then&nbsp;returns&nbsp;a&nbsp;new&nbsp;Conn&nbsp;for&nbsp;the&nbsp;connection.</span><br>
<span class="lineno"></span><span class="keyword" id="4569042">func</span>&nbsp;<span class="ident" id="4569047">Dial</span><span class="op" id="4569051">(</span><span class="ident" id="4569052">network</span><span class="op" id="4569059">,</span>&nbsp;<span class="ident" id="4569061">addr</span>&nbsp;<span class="builtintype" id="4569066">string</span><span class="op" id="4569072">)</span>&nbsp;<span class="op" id="4569074">(</span><span class="op" id="4569075">*</span><span class="ident" id="4569076">Conn</span><span class="op" id="4569080">,</span>&nbsp;<span class="builtintype" id="4569082">error</span><span class="op" id="4569087">)</span>&nbsp;<span class="op" id="4569089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569092">c</span><span class="op" id="4569093">,</span>&nbsp;<span class="ident" id="4569095">err</span>&nbsp;<span class="op" id="4569099">:=</span>&nbsp;<span class="ident" id="4569102">net</span><span class="op" id="4569105">.</span><span class="ident" id="4569106">Dial</span><span class="op" id="4569110">(</span><span class="ident" id="4569111">network</span><span class="op" id="4569118">,</span>&nbsp;<span class="ident" id="4569120">addr</span><span class="op" id="4569124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4569127">if</span>&nbsp;<span class="ident" id="4569130">err</span>&nbsp;<span class="op" id="4569134">!=</span>&nbsp;<span class="ident" id="4569137">nil</span>&nbsp;<span class="op" id="4569141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4569145">return</span>&nbsp;<span class="ident" id="4569152">nil</span><span class="op" id="4569155">,</span>&nbsp;<span class="ident" id="4569157">err</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4569162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4569165">return</span>&nbsp;<span class="ident" id="4569172">NewConn</span><span class="op" id="4569179">(</span><span class="ident" id="4569180">c</span><span class="op" id="4569181">)</span><span class="op" id="4569182">,</span>&nbsp;<span class="ident" id="4569184">nil</span><br>
<span class="lineno"></span><span class="op" id="4569188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4569191">//&nbsp;Cmd&nbsp;is&nbsp;a&nbsp;convenience&nbsp;method&nbsp;that&nbsp;sends&nbsp;a&nbsp;command&nbsp;after</span><br>
<span class="lineno">90</span><span class="comment" id="4569249">//&nbsp;waiting&nbsp;its&nbsp;turn&nbsp;in&nbsp;the&nbsp;pipeline.&nbsp;&nbsp;The&nbsp;command&nbsp;text&nbsp;is&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4569311">//&nbsp;result&nbsp;of&nbsp;formatting&nbsp;format&nbsp;with&nbsp;args&nbsp;and&nbsp;appending&nbsp;\r\n.</span><br>
<span class="lineno"></span><span class="comment" id="4569372">//&nbsp;Cmd&nbsp;returns&nbsp;the&nbsp;id&nbsp;of&nbsp;the&nbsp;command,&nbsp;for&nbsp;use&nbsp;with&nbsp;StartResponse&nbsp;and&nbsp;EndResponse.</span><br>
<span class="lineno"></span><span class="comment" id="4569454">//</span><br>
<span class="lineno"></span><span class="comment" id="4569457">//&nbsp;For&nbsp;example,&nbsp;a&nbsp;client&nbsp;might&nbsp;run&nbsp;a&nbsp;HELP&nbsp;command&nbsp;that&nbsp;returns&nbsp;a&nbsp;dot-body</span><br>
<span class="lineno">95</span><span class="comment" id="4569531">//&nbsp;by&nbsp;using:</span><br>
<span class="lineno"></span><span class="comment" id="4569544">//</span><br>
<span class="lineno"></span><span class="comment" id="4569547">//&nbsp;&nbsp;&nbsp;&nbspid,&nbsp;err&nbsp;:=&nbsp;c.Cmd(&#34;HELP&#34;)</span><br>
<span class="lineno"></span><span class="comment" id="4569575">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4569594">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno">100</span><span class="comment" id="4569614">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="4569619">//</span><br>
<span class="lineno"></span><span class="comment" id="4569622">//&nbsp;&nbsp;&nbsp;&nbspc.StartResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="4569645">//&nbsp;&nbsp;&nbsp;&nbspdefer&nbsp;c.EndResponse(id)</span><br>
<span class="lineno"></span><span class="comment" id="4569672">//</span><br>
<span class="lineno">105</span><span class="comment" id="4569675">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;_,&nbsp;_,&nbsp;err&nbsp;=&nbsp;c.ReadCodeLine(110);&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno"></span><span class="comment" id="4569727">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="4569747">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="4569752">//&nbsp;&nbsp;&nbsp;&nbsptext,&nbsp;err&nbsp;:=&nbsp;c.ReadDotBytes()</span><br>
<span class="lineno"></span><span class="comment" id="4569785">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;err&nbsp;!=&nbsp;nil&nbsp;{</span><br>
<span class="lineno">110</span><span class="comment" id="4569804">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;nil,&nbsp;err</span><br>
<span class="lineno"></span><span class="comment" id="4569824">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span><span class="comment" id="4569829">//&nbsp;&nbsp;&nbsp;&nbspreturn&nbsp;c.ReadCodeLine(250)</span><br>
<span class="lineno"></span><span class="comment" id="4569859">//</span><br>
<span class="lineno"></span><span class="keyword" id="4569862">func</span>&nbsp;<span class="op" id="4569867">(</span><span class="ident" id="4569868">c</span>&nbsp;<span class="op" id="4569870">*</span><span class="ident" id="4569871">Conn</span><span class="op" id="4569875">)</span>&nbsp;<span class="ident" id="4569877">Cmd</span><span class="op" id="4569880">(</span><span class="ident" id="4569881">format</span>&nbsp;<span class="builtintype" id="4569888">string</span><span class="op" id="4569894">,</span>&nbsp;<span class="ident" id="4569896">args</span>&nbsp;<span class="op" id="4569901">...</span><span class="keyword" id="4569904">interface</span><span class="op" id="4569913">{</span><span class="op" id="4569914">}</span><span class="op" id="4569915">)</span>&nbsp;<span class="op" id="4569917">(</span><span class="ident" id="4569918">id</span>&nbsp;<span class="builtintype" id="4569921">uint</span><span class="op" id="4569925">,</span>&nbsp;<span class="ident" id="4569927">err</span>&nbsp;<span class="builtintype" id="4569931">error</span><span class="op" id="4569936">)</span>&nbsp;<span class="op" id="4569938">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569941">id</span>&nbsp;<span class="op" id="4569944">=</span>&nbsp;<span class="ident" id="4569946">c</span><span class="op" id="4569947">.</span><span class="ident" id="4569948">Next</span><span class="op" id="4569952">(</span><span class="op" id="4569953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569956">c</span><span class="op" id="4569957">.</span><span class="ident" id="4569958">StartRequest</span><span class="op" id="4569970">(</span><span class="ident" id="4569971">id</span><span class="op" id="4569973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4569976">err</span>&nbsp;<span class="op" id="4569980">=</span>&nbsp;<span class="ident" id="4569982">c</span><span class="op" id="4569983">.</span><span class="ident" id="4569984">PrintfLine</span><span class="op" id="4569994">(</span><span class="ident" id="4569995">format</span><span class="op" id="4570001">,</span>&nbsp;<span class="ident" id="4570003">args</span><span class="op" id="4570007">...</span><span class="op" id="4570010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570013">c</span><span class="op" id="4570014">.</span><span class="ident" id="4570015">EndRequest</span><span class="op" id="4570025">(</span><span class="ident" id="4570026">id</span><span class="op" id="4570028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570031">if</span>&nbsp;<span class="ident" id="4570034">err</span>&nbsp;<span class="op" id="4570038">!=</span>&nbsp;<span class="ident" id="4570041">nil</span>&nbsp;<span class="op" id="4570045">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570049">return</span>&nbsp;<span class="num" id="4570056">0</span><span class="op" id="4570057">,</span>&nbsp;<span class="ident" id="4570059">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570067">return</span>&nbsp;<span class="ident" id="4570074">id</span><span class="op" id="4570076">,</span>&nbsp;<span class="ident" id="4570078">nil</span><br>
<span class="lineno"></span><span class="op" id="4570082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="4570085">//&nbsp;TrimString&nbsp;returns&nbsp;s&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="4570151">func</span>&nbsp;<span class="ident" id="4570156">TrimString</span><span class="op" id="4570166">(</span><span class="ident" id="4570167">s</span>&nbsp;<span class="builtintype" id="4570169">string</span><span class="op" id="4570175">)</span>&nbsp;<span class="builtintype" id="4570177">string</span>&nbsp;<span class="op" id="4570184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570187">for</span>&nbsp;<span class="builtinfunc" id="4570191">len</span><span class="op" id="4570194">(</span><span class="ident" id="4570195">s</span><span class="op" id="4570196">)</span>&nbsp;<span class="op" id="4570198">&gt;</span>&nbsp;<span class="num" id="4570200">0</span>&nbsp;<span class="op" id="4570202">&amp;&amp;</span>&nbsp;<span class="ident" id="4570205">isASCIISpace</span><span class="op" id="4570217">(</span><span class="ident" id="4570218">s</span><span class="op" id="4570219">[</span><span class="num" id="4570220">0</span><span class="op" id="4570221">]</span><span class="op" id="4570222">)</span>&nbsp;<span class="op" id="4570224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570228">s</span>&nbsp;<span class="op" id="4570230">=</span>&nbsp;<span class="ident" id="4570232">s</span><span class="op" id="4570233">[</span><span class="num" id="4570234">1</span><span class="op" id="4570235">:</span><span class="op" id="4570236">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570239">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570242">for</span>&nbsp;<span class="builtinfunc" id="4570246">len</span><span class="op" id="4570249">(</span><span class="ident" id="4570250">s</span><span class="op" id="4570251">)</span>&nbsp;<span class="op" id="4570253">&gt;</span>&nbsp;<span class="num" id="4570255">0</span>&nbsp;<span class="op" id="4570257">&amp;&amp;</span>&nbsp;<span class="ident" id="4570260">isASCIISpace</span><span class="op" id="4570272">(</span><span class="ident" id="4570273">s</span><span class="op" id="4570274">[</span><span class="builtinfunc" id="4570275">len</span><span class="op" id="4570278">(</span><span class="ident" id="4570279">s</span><span class="op" id="4570280">)</span><span class="op" id="4570281">-</span><span class="num" id="4570282">1</span><span class="op" id="4570283">]</span><span class="op" id="4570284">)</span>&nbsp;<span class="op" id="4570286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570290">s</span>&nbsp;<span class="op" id="4570292">=</span>&nbsp;<span class="ident" id="4570294">s</span><span class="op" id="4570295">[</span><span class="op" id="4570296">:</span><span class="builtinfunc" id="4570297">len</span><span class="op" id="4570300">(</span><span class="ident" id="4570301">s</span><span class="op" id="4570302">)</span><span class="op" id="4570303">-</span><span class="num" id="4570304">1</span><span class="op" id="4570305">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570308">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570311">return</span>&nbsp;<span class="ident" id="4570318">s</span><br>
<span class="lineno"></span><span class="op" id="4570320">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span><span class="comment" id="4570323">//&nbsp;TrimBytes&nbsp;returns&nbsp;b&nbsp;without&nbsp;leading&nbsp;and&nbsp;trailing&nbsp;ASCII&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="4570388">func</span>&nbsp;<span class="ident" id="4570393">TrimBytes</span><span class="op" id="4570402">(</span><span class="ident" id="4570403">b</span>&nbsp;<span class="op" id="4570405">[</span><span class="op" id="4570406">]</span><span class="builtintype" id="4570407">byte</span><span class="op" id="4570411">)</span>&nbsp;<span class="op" id="4570413">[</span><span class="op" id="4570414">]</span><span class="builtintype" id="4570415">byte</span>&nbsp;<span class="op" id="4570420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570423">for</span>&nbsp;<span class="builtinfunc" id="4570427">len</span><span class="op" id="4570430">(</span><span class="ident" id="4570431">b</span><span class="op" id="4570432">)</span>&nbsp;<span class="op" id="4570434">&gt;</span>&nbsp;<span class="num" id="4570436">0</span>&nbsp;<span class="op" id="4570438">&amp;&amp;</span>&nbsp;<span class="ident" id="4570441">isASCIISpace</span><span class="op" id="4570453">(</span><span class="ident" id="4570454">b</span><span class="op" id="4570455">[</span><span class="num" id="4570456">0</span><span class="op" id="4570457">]</span><span class="op" id="4570458">)</span>&nbsp;<span class="op" id="4570460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570464">b</span>&nbsp;<span class="op" id="4570466">=</span>&nbsp;<span class="ident" id="4570468">b</span><span class="op" id="4570469">[</span><span class="num" id="4570470">1</span><span class="op" id="4570471">:</span><span class="op" id="4570472">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570475">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570478">for</span>&nbsp;<span class="builtinfunc" id="4570482">len</span><span class="op" id="4570485">(</span><span class="ident" id="4570486">b</span><span class="op" id="4570487">)</span>&nbsp;<span class="op" id="4570489">&gt;</span>&nbsp;<span class="num" id="4570491">0</span>&nbsp;<span class="op" id="4570493">&amp;&amp;</span>&nbsp;<span class="ident" id="4570496">isASCIISpace</span><span class="op" id="4570508">(</span><span class="ident" id="4570509">b</span><span class="op" id="4570510">[</span><span class="builtinfunc" id="4570511">len</span><span class="op" id="4570514">(</span><span class="ident" id="4570515">b</span><span class="op" id="4570516">)</span><span class="op" id="4570517">-</span><span class="num" id="4570518">1</span><span class="op" id="4570519">]</span><span class="op" id="4570520">)</span>&nbsp;<span class="op" id="4570522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570526">b</span>&nbsp;<span class="op" id="4570528">=</span>&nbsp;<span class="ident" id="4570530">b</span><span class="op" id="4570531">[</span><span class="op" id="4570532">:</span><span class="builtinfunc" id="4570533">len</span><span class="op" id="4570536">(</span><span class="ident" id="4570537">b</span><span class="op" id="4570538">)</span><span class="op" id="4570539">-</span><span class="num" id="4570540">1</span><span class="op" id="4570541">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4570544">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570547">return</span>&nbsp;<span class="ident" id="4570554">b</span><br>
<span class="lineno">145</span><span class="op" id="4570556">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4570559">func</span>&nbsp;<span class="ident" id="4570564">isASCIISpace</span><span class="op" id="4570576">(</span><span class="ident" id="4570577">b</span>&nbsp;<span class="builtintype" id="4570579">byte</span><span class="op" id="4570583">)</span>&nbsp;<span class="builtintype" id="4570585">bool</span>&nbsp;<span class="op" id="4570590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570593">return</span>&nbsp;<span class="ident" id="4570600">b</span>&nbsp;<span class="op" id="4570602">==</span>&nbsp;<span class="string" id="4570605">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4570609">||</span>&nbsp;<span class="ident" id="4570612">b</span>&nbsp;<span class="op" id="4570614">==</span>&nbsp;<span class="string" id="4570617">&#39;\t&#39;</span>&nbsp;<span class="op" id="4570622">||</span>&nbsp;<span class="ident" id="4570625">b</span>&nbsp;<span class="op" id="4570627">==</span>&nbsp;<span class="string" id="4570630">&#39;\n&#39;</span>&nbsp;<span class="op" id="4570635">||</span>&nbsp;<span class="ident" id="4570638">b</span>&nbsp;<span class="op" id="4570640">==</span>&nbsp;<span class="string" id="4570643">&#39;\r&#39;</span><br>
<span class="lineno"></span><span class="op" id="4570648">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="4570651">func</span>&nbsp;<span class="ident" id="4570656">isASCIILetter</span><span class="op" id="4570669">(</span><span class="ident" id="4570670">b</span>&nbsp;<span class="builtintype" id="4570672">byte</span><span class="op" id="4570676">)</span>&nbsp;<span class="builtintype" id="4570678">bool</span>&nbsp;<span class="op" id="4570683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4570686">b</span>&nbsp;<span class="op" id="4570688">|=</span>&nbsp;<span class="num" id="4570691">0x20</span>&nbsp;<span class="comment" id="4570696">//&nbsp;make&nbsp;lower&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4570716">return</span>&nbsp;<span class="string" id="4570723">&#39;a&#39;</span>&nbsp;<span class="op" id="4570727">&lt;=</span>&nbsp;<span class="ident" id="4570730">b</span>&nbsp;<span class="op" id="4570732">&amp;&amp;</span>&nbsp;<span class="ident" id="4570735">b</span>&nbsp;<span class="op" id="4570737">&lt;=</span>&nbsp;<span class="string" id="4570740">&#39;z&#39;</span><br>
<span class="lineno"></span><span class="op" id="4570744">}</span>
</div>
</body>
</html>
