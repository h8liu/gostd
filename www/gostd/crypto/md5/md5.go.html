<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/md5</h2>
<ul>
<li><a href="/gostd/crypto/md5/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5.go.html" class="current">md5.go</a></li>
<li><a href="/gostd/crypto/md5/md5_test.go.html">md5_test.go</a></li>
<li><a href="/gostd/crypto/md5/md5block.go.html">md5block.go</a></li>
<li><a href="/gostd/crypto/md5/md5block_decl.go.html">md5block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4444124">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4444179">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4444233">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4444284">//go:generate&nbsp;go&nbsp;run&nbsp;gen.go&nbsp;-full&nbsp;-output&nbsp;md5block.go</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4444339">//&nbsp;Package&nbsp;md5&nbsp;implements&nbsp;the&nbsp;MD5&nbsp;hash&nbsp;algorithm&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;1321.</span><br>
<span class="lineno"></span><span class="keyword" id="4444412">package</span>&nbsp;<span class="ident" id="4444420">md5</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4444425">import</span>&nbsp;<span class="op" id="4444432">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4444435">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4444445">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4444452">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="keyword" id="4444455">func</span>&nbsp;<span class="ident" id="4444460">init</span><span class="op" id="4444464">(</span><span class="op" id="4444465">)</span>&nbsp;<span class="op" id="4444467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4444470">crypto</span><span class="op" id="4444476">.</span><span class="ident" id="4444477">RegisterHash</span><span class="op" id="4444489">(</span><span class="ident" id="4444490">crypto</span><span class="op" id="4444496">.</span><span class="ident" id="4444497">MD5</span><span class="op" id="4444500">,</span>&nbsp;<span class="ident" id="4444502">New</span><span class="op" id="4444505">)</span><br>
<span class="lineno"></span><span class="op" id="4444507">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4444510">//&nbsp;The&nbsp;size&nbsp;of&nbsp;an&nbsp;MD5&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4444551">const</span>&nbsp;<span class="ident" id="4444557">Size</span>&nbsp;<span class="op" id="4444562">=</span>&nbsp;<span class="num" id="4444564">16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4444568">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;MD5&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4444602">const</span>&nbsp;<span class="ident" id="4444608">BlockSize</span>&nbsp;<span class="op" id="4444618">=</span>&nbsp;<span class="num" id="4444620">64</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="4444624">const</span>&nbsp;<span class="op" id="4444630">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4444633">chunk</span>&nbsp;<span class="op" id="4444639">=</span>&nbsp;<span class="num" id="4444641">64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4444645">init0</span>&nbsp;<span class="op" id="4444651">=</span>&nbsp;<span class="num" id="4444653">0x67452301</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4444665">init1</span>&nbsp;<span class="op" id="4444671">=</span>&nbsp;<span class="num" id="4444673">0xEFCDAB89</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4444685">init2</span>&nbsp;<span class="op" id="4444691">=</span>&nbsp;<span class="num" id="4444693">0x98BADCFE</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4444705">init3</span>&nbsp;<span class="op" id="4444711">=</span>&nbsp;<span class="num" id="4444713">0x10325476</span><br>
<span class="lineno"></span><span class="op" id="4444724">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4444727">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4444786">type</span>&nbsp;<span class="ident" id="4444791">digest</span>&nbsp;<span class="keyword" id="4444798">struct</span>&nbsp;<span class="op" id="4444805">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4444808">s</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4444812">[</span><span class="num" id="4444813">4</span><span class="op" id="4444814">]</span><span class="builtintype" id="4444815">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4444823">x</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4444827">[</span><span class="ident" id="4444828">chunk</span><span class="op" id="4444833">]</span><span class="builtintype" id="4444834">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4444840">nx</span>&nbsp;&nbsp;<span class="builtintype" id="4444844">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4444849">len</span>&nbsp;<span class="builtintype" id="4444853">uint64</span><br>
<span class="lineno"></span><span class="op" id="4444860">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4444863">func</span>&nbsp;<span class="op" id="4444868">(</span><span class="ident" id="4444869">d</span>&nbsp;<span class="op" id="4444871">*</span><span class="ident" id="4444872">digest</span><span class="op" id="4444878">)</span>&nbsp;<span class="ident" id="4444880">Reset</span><span class="op" id="4444885">(</span><span class="op" id="4444886">)</span>&nbsp;<span class="op" id="4444888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4444891">d</span><span class="op" id="4444892">.</span><span class="ident" id="4444893">s</span><span class="op" id="4444894">[</span><span class="num" id="4444895">0</span><span class="op" id="4444896">]</span>&nbsp;<span class="op" id="4444898">=</span>&nbsp;<span class="ident" id="4444900">init0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4444907">d</span><span class="op" id="4444908">.</span><span class="ident" id="4444909">s</span><span class="op" id="4444910">[</span><span class="num" id="4444911">1</span><span class="op" id="4444912">]</span>&nbsp;<span class="op" id="4444914">=</span>&nbsp;<span class="ident" id="4444916">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4444923">d</span><span class="op" id="4444924">.</span><span class="ident" id="4444925">s</span><span class="op" id="4444926">[</span><span class="num" id="4444927">2</span><span class="op" id="4444928">]</span>&nbsp;<span class="op" id="4444930">=</span>&nbsp;<span class="ident" id="4444932">init2</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4444939">d</span><span class="op" id="4444940">.</span><span class="ident" id="4444941">s</span><span class="op" id="4444942">[</span><span class="num" id="4444943">3</span><span class="op" id="4444944">]</span>&nbsp;<span class="op" id="4444946">=</span>&nbsp;<span class="ident" id="4444948">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4444955">d</span><span class="op" id="4444956">.</span><span class="ident" id="4444957">nx</span>&nbsp;<span class="op" id="4444960">=</span>&nbsp;<span class="num" id="4444962">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4444965">d</span><span class="op" id="4444966">.</span><span class="builtinfunc" id="4444967">len</span>&nbsp;<span class="op" id="4444971">=</span>&nbsp;<span class="num" id="4444973">0</span><br>
<span class="lineno"></span><span class="op" id="4444975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="4444978">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;MD5&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4445037">func</span>&nbsp;<span class="ident" id="4445042">New</span><span class="op" id="4445045">(</span><span class="op" id="4445046">)</span>&nbsp;<span class="ident" id="4445048">hash</span><span class="op" id="4445052">.</span><span class="ident" id="4445053">Hash</span>&nbsp;<span class="op" id="4445058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4445061">d</span>&nbsp;<span class="op" id="4445063">:=</span>&nbsp;<span class="builtinfunc" id="4445066">new</span><span class="op" id="4445069">(</span><span class="ident" id="4445070">digest</span><span class="op" id="4445076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4445079">d</span><span class="op" id="4445080">.</span><span class="ident" id="4445081">Reset</span><span class="op" id="4445086">(</span><span class="op" id="4445087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4445090">return</span>&nbsp;<span class="ident" id="4445097">d</span><br>
<span class="lineno">55</span><span class="op" id="4445099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4445102">func</span>&nbsp;<span class="op" id="4445107">(</span><span class="ident" id="4445108">d</span>&nbsp;<span class="op" id="4445110">*</span><span class="ident" id="4445111">digest</span><span class="op" id="4445117">)</span>&nbsp;<span class="ident" id="4445119">Size</span><span class="op" id="4445123">(</span><span class="op" id="4445124">)</span>&nbsp;<span class="builtintype" id="4445126">int</span>&nbsp;<span class="op" id="4445130">{</span>&nbsp;<span class="keyword" id="4445132">return</span>&nbsp;<span class="ident" id="4445139">Size</span>&nbsp;<span class="op" id="4445144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4445147">func</span>&nbsp;<span class="op" id="4445152">(</span><span class="ident" id="4445153">d</span>&nbsp;<span class="op" id="4445155">*</span><span class="ident" id="4445156">digest</span><span class="op" id="4445162">)</span>&nbsp;<span class="ident" id="4445164">BlockSize</span><span class="op" id="4445173">(</span><span class="op" id="4445174">)</span>&nbsp;<span class="builtintype" id="4445176">int</span>&nbsp;<span class="op" id="4445180">{</span>&nbsp;<span class="keyword" id="4445182">return</span>&nbsp;<span class="ident" id="4445189">BlockSize</span>&nbsp;<span class="op" id="4445199">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="4445202">func</span>&nbsp;<span class="op" id="4445207">(</span><span class="ident" id="4445208">d</span>&nbsp;<span class="op" id="4445210">*</span><span class="ident" id="4445211">digest</span><span class="op" id="4445217">)</span>&nbsp;<span class="ident" id="4445219">Write</span><span class="op" id="4445224">(</span><span class="ident" id="4445225">p</span>&nbsp;<span class="op" id="4445227">[</span><span class="op" id="4445228">]</span><span class="builtintype" id="4445229">byte</span><span class="op" id="4445233">)</span>&nbsp;<span class="op" id="4445235">(</span><span class="ident" id="4445236">nn</span>&nbsp;<span class="builtintype" id="4445239">int</span><span class="op" id="4445242">,</span>&nbsp;<span class="ident" id="4445244">err</span>&nbsp;<span class="builtintype" id="4445248">error</span><span class="op" id="4445253">)</span>&nbsp;<span class="op" id="4445255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4445258">nn</span>&nbsp;<span class="op" id="4445261">=</span>&nbsp;<span class="builtinfunc" id="4445263">len</span><span class="op" id="4445266">(</span><span class="ident" id="4445267">p</span><span class="op" id="4445268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4445271">d</span><span class="op" id="4445272">.</span><span class="builtinfunc" id="4445273">len</span>&nbsp;<span class="op" id="4445277">+=</span>&nbsp;<span class="builtintype" id="4445280">uint64</span><span class="op" id="4445286">(</span><span class="ident" id="4445287">nn</span><span class="op" id="4445289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4445292">if</span>&nbsp;<span class="ident" id="4445295">d</span><span class="op" id="4445296">.</span><span class="ident" id="4445297">nx</span>&nbsp;<span class="op" id="4445300">&gt;</span>&nbsp;<span class="num" id="4445302">0</span>&nbsp;<span class="op" id="4445304">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4445308">n</span>&nbsp;<span class="op" id="4445310">:=</span>&nbsp;<span class="builtinfunc" id="4445313">len</span><span class="op" id="4445316">(</span><span class="ident" id="4445317">p</span><span class="op" id="4445318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4445322">if</span>&nbsp;<span class="ident" id="4445325">n</span>&nbsp;<span class="op" id="4445327">&gt;</span>&nbsp;<span class="ident" id="4445329">chunk</span><span class="op" id="4445334">-</span><span class="ident" id="4445335">d</span><span class="op" id="4445336">.</span><span class="ident" id="4445337">nx</span>&nbsp;<span class="op" id="4445340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4445345">n</span>&nbsp;<span class="op" id="4445347">=</span>&nbsp;<span class="ident" id="4445349">chunk</span>&nbsp;<span class="op" id="4445355">-</span>&nbsp;<span class="ident" id="4445357">d</span><span class="op" id="4445358">.</span><span class="ident" id="4445359">nx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4445364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4445368">for</span>&nbsp;<span class="ident" id="4445372">i</span>&nbsp;<span class="op" id="4445374">:=</span>&nbsp;<span class="num" id="4445377">0</span><span class="op" id="4445378">;</span>&nbsp;<span class="ident" id="4445380">i</span>&nbsp;<span class="op" id="4445382">&lt;</span>&nbsp;<span class="ident" id="4445384">n</span><span class="op" id="4445385">;</span>&nbsp;<span class="ident" id="4445387">i</span><span class="op" id="4445388">++</span>&nbsp;<span class="op" id="4445391">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4445396">d</span><span class="op" id="4445397">.</span><span class="ident" id="4445398">x</span><span class="op" id="4445399">[</span><span class="ident" id="4445400">d</span><span class="op" id="4445401">.</span><span class="ident" id="4445402">nx</span><span class="op" id="4445404">+</span><span class="ident" id="4445405">i</span><span class="op" id="4445406">]</span>&nbsp;<span class="op" id="4445408">=</span>&nbsp;<span class="ident" id="4445410">p</span><span class="op" id="4445411">[</span><span class="ident" id="4445412">i</span><span class="op" id="4445413">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4445417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4445421">d</span><span class="op" id="4445422">.</span><span class="ident" id="4445423">nx</span>&nbsp;<span class="op" id="4445426">+=</span>&nbsp;<span class="ident" id="4445429">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4445433">if</span>&nbsp;<span class="ident" id="4445436">d</span><span class="op" id="4445437">.</span><span class="ident" id="4445438">nx</span>&nbsp;<span class="op" id="4445441">==</span>&nbsp;<span class="ident" id="4445444">chunk</span>&nbsp;<span class="op" id="4445450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4445455">block</span><span class="op" id="4445460">(</span><span class="ident" id="4445461">d</span><span class="op" id="4445462">,</span>&nbsp;<span class="ident" id="4445464">d</span><span class="op" id="4445465">.</span><span class="ident" id="4445466">x</span><span class="op" id="4445467">[</span><span class="num" id="4445468">0</span><span class="op" id="4445469">:</span><span class="ident" id="4445470">chunk</span><span class="op" id="4445475">]</span><span class="op" id="4445476">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4445481">d</span><span class="op" id="4445482">.</span><span class="ident" id="4445483">nx</span>&nbsp;<span class="op" id="4445486">=</span>&nbsp;<span class="num" id="4445488">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4445492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4445496">p</span>&nbsp;<span class="op" id="4445498">=</span>&nbsp;<span class="ident" id="4445500">p</span><span class="op" id="4445501">[</span><span class="ident" id="4445502">n</span><span class="op" id="4445503">:</span><span class="op" id="4445504">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4445507">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4445510">if</span>&nbsp;<span class="builtinfunc" id="4445513">len</span><span class="op" id="4445516">(</span><span class="ident" id="4445517">p</span><span class="op" id="4445518">)</span>&nbsp;<span class="op" id="4445520">&gt;=</span>&nbsp;<span class="ident" id="4445523">chunk</span>&nbsp;<span class="op" id="4445529">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4445533">n</span>&nbsp;<span class="op" id="4445535">:=</span>&nbsp;<span class="builtinfunc" id="4445538">len</span><span class="op" id="4445541">(</span><span class="ident" id="4445542">p</span><span class="op" id="4445543">)</span>&nbsp;<span class="op" id="4445545">&amp;^</span>&nbsp;<span class="op" id="4445548">(</span><span class="ident" id="4445549">chunk</span>&nbsp;<span class="op" id="4445555">-</span>&nbsp;<span class="num" id="4445557">1</span><span class="op" id="4445558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4445562">block</span><span class="op" id="4445567">(</span><span class="ident" id="4445568">d</span><span class="op" id="4445569">,</span>&nbsp;<span class="ident" id="4445571">p</span><span class="op" id="4445572">[</span><span class="op" id="4445573">:</span><span class="ident" id="4445574">n</span><span class="op" id="4445575">]</span><span class="op" id="4445576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4445580">p</span>&nbsp;<span class="op" id="4445582">=</span>&nbsp;<span class="ident" id="4445584">p</span><span class="op" id="4445585">[</span><span class="ident" id="4445586">n</span><span class="op" id="4445587">:</span><span class="op" id="4445588">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4445591">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4445594">if</span>&nbsp;<span class="builtinfunc" id="4445597">len</span><span class="op" id="4445600">(</span><span class="ident" id="4445601">p</span><span class="op" id="4445602">)</span>&nbsp;<span class="op" id="4445604">&gt;</span>&nbsp;<span class="num" id="4445606">0</span>&nbsp;<span class="op" id="4445608">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4445612">d</span><span class="op" id="4445613">.</span><span class="ident" id="4445614">nx</span>&nbsp;<span class="op" id="4445617">=</span>&nbsp;<span class="builtinfunc" id="4445619">copy</span><span class="op" id="4445623">(</span><span class="ident" id="4445624">d</span><span class="op" id="4445625">.</span><span class="ident" id="4445626">x</span><span class="op" id="4445627">[</span><span class="op" id="4445628">:</span><span class="op" id="4445629">]</span><span class="op" id="4445630">,</span>&nbsp;<span class="ident" id="4445632">p</span><span class="op" id="4445633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4445636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4445639">return</span><br>
<span class="lineno"></span><span class="op" id="4445646">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="keyword" id="4445649">func</span>&nbsp;<span class="op" id="4445654">(</span><span class="ident" id="4445655">d0</span>&nbsp;<span class="op" id="4445658">*</span><span class="ident" id="4445659">digest</span><span class="op" id="4445665">)</span>&nbsp;<span class="ident" id="4445667">Sum</span><span class="op" id="4445670">(</span><span class="ident" id="4445671">in</span>&nbsp;<span class="op" id="4445674">[</span><span class="op" id="4445675">]</span><span class="builtintype" id="4445676">byte</span><span class="op" id="4445680">)</span>&nbsp;<span class="op" id="4445682">[</span><span class="op" id="4445683">]</span><span class="builtintype" id="4445684">byte</span>&nbsp;<span class="op" id="4445689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4445692">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4445759">d</span>&nbsp;<span class="op" id="4445761">:=</span>&nbsp;<span class="op" id="4445764">*</span><span class="ident" id="4445765">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4445769">hash</span>&nbsp;<span class="op" id="4445774">:=</span>&nbsp;<span class="ident" id="4445777">d</span><span class="op" id="4445778">.</span><span class="ident" id="4445779">checkSum</span><span class="op" id="4445787">(</span><span class="op" id="4445788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4445791">return</span>&nbsp;<span class="builtinfunc" id="4445798">append</span><span class="op" id="4445804">(</span><span class="ident" id="4445805">in</span><span class="op" id="4445807">,</span>&nbsp;<span class="ident" id="4445809">hash</span><span class="op" id="4445813">[</span><span class="op" id="4445814">:</span><span class="op" id="4445815">]</span><span class="op" id="4445816">...</span><span class="op" id="4445819">)</span><br>
<span class="lineno">95</span><span class="op" id="4445821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4445824">func</span>&nbsp;<span class="op" id="4445829">(</span><span class="ident" id="4445830">d</span>&nbsp;<span class="op" id="4445832">*</span><span class="ident" id="4445833">digest</span><span class="op" id="4445839">)</span>&nbsp;<span class="ident" id="4445841">checkSum</span><span class="op" id="4445849">(</span><span class="op" id="4445850">)</span>&nbsp;<span class="op" id="4445852">[</span><span class="ident" id="4445853">Size</span><span class="op" id="4445857">]</span><span class="builtintype" id="4445858">byte</span>&nbsp;<span class="op" id="4445863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4445866">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4445926">len</span>&nbsp;<span class="op" id="4445930">:=</span>&nbsp;<span class="ident" id="4445933">d</span><span class="op" id="4445934">.</span><span class="builtinfunc" id="4445935">len</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4445940">var</span>&nbsp;<span class="ident" id="4445944">tmp</span>&nbsp;<span class="op" id="4445948">[</span><span class="num" id="4445949">64</span><span class="op" id="4445951">]</span><span class="builtintype" id="4445952">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4445958">tmp</span><span class="op" id="4445961">[</span><span class="num" id="4445962">0</span><span class="op" id="4445963">]</span>&nbsp;<span class="op" id="4445965">=</span>&nbsp;<span class="num" id="4445967">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4445973">if</span>&nbsp;<span class="builtinfunc" id="4445976">len</span><span class="op" id="4445979">%</span><span class="num" id="4445980">64</span>&nbsp;<span class="op" id="4445983">&lt;</span>&nbsp;<span class="num" id="4445985">56</span>&nbsp;<span class="op" id="4445988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4445992">d</span><span class="op" id="4445993">.</span><span class="ident" id="4445994">Write</span><span class="op" id="4445999">(</span><span class="ident" id="4446000">tmp</span><span class="op" id="4446003">[</span><span class="num" id="4446004">0</span>&nbsp;<span class="op" id="4446006">:</span>&nbsp;<span class="num" id="4446008">56</span><span class="op" id="4446010">-</span><span class="builtinfunc" id="4446011">len</span><span class="op" id="4446014">%</span><span class="num" id="4446015">64</span><span class="op" id="4446017">]</span><span class="op" id="4446018">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4446021">}</span>&nbsp;<span class="keyword" id="4446023">else</span>&nbsp;<span class="op" id="4446028">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4446032">d</span><span class="op" id="4446033">.</span><span class="ident" id="4446034">Write</span><span class="op" id="4446039">(</span><span class="ident" id="4446040">tmp</span><span class="op" id="4446043">[</span><span class="num" id="4446044">0</span>&nbsp;<span class="op" id="4446046">:</span>&nbsp;<span class="num" id="4446048">64</span><span class="op" id="4446050">+</span><span class="num" id="4446051">56</span><span class="op" id="4446053">-</span><span class="builtinfunc" id="4446054">len</span><span class="op" id="4446057">%</span><span class="num" id="4446058">64</span><span class="op" id="4446060">]</span><span class="op" id="4446061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4446064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4446068">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4446088">len</span>&nbsp;<span class="op" id="4446092">&lt;&lt;=</span>&nbsp;<span class="num" id="4446096">3</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4446099">for</span>&nbsp;<span class="ident" id="4446103">i</span>&nbsp;<span class="op" id="4446105">:=</span>&nbsp;<span class="builtintype" id="4446108">uint</span><span class="op" id="4446112">(</span><span class="num" id="4446113">0</span><span class="op" id="4446114">)</span><span class="op" id="4446115">;</span>&nbsp;<span class="ident" id="4446117">i</span>&nbsp;<span class="op" id="4446119">&lt;</span>&nbsp;<span class="num" id="4446121">8</span><span class="op" id="4446122">;</span>&nbsp;<span class="ident" id="4446124">i</span><span class="op" id="4446125">++</span>&nbsp;<span class="op" id="4446128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4446132">tmp</span><span class="op" id="4446135">[</span><span class="ident" id="4446136">i</span><span class="op" id="4446137">]</span>&nbsp;<span class="op" id="4446139">=</span>&nbsp;<span class="builtintype" id="4446141">byte</span><span class="op" id="4446145">(</span><span class="builtinfunc" id="4446146">len</span>&nbsp;<span class="op" id="4446150">&gt;&gt;</span>&nbsp;<span class="op" id="4446153">(</span><span class="num" id="4446154">8</span>&nbsp;<span class="op" id="4446156">*</span>&nbsp;<span class="ident" id="4446158">i</span><span class="op" id="4446159">)</span><span class="op" id="4446160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4446163">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4446166">d</span><span class="op" id="4446167">.</span><span class="ident" id="4446168">Write</span><span class="op" id="4446173">(</span><span class="ident" id="4446174">tmp</span><span class="op" id="4446177">[</span><span class="num" id="4446178">0</span><span class="op" id="4446179">:</span><span class="num" id="4446180">8</span><span class="op" id="4446181">]</span><span class="op" id="4446182">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4446186">if</span>&nbsp;<span class="ident" id="4446189">d</span><span class="op" id="4446190">.</span><span class="ident" id="4446191">nx</span>&nbsp;<span class="op" id="4446194">!=</span>&nbsp;<span class="num" id="4446197">0</span>&nbsp;<span class="op" id="4446199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4446203">panic</span><span class="op" id="4446208">(</span><span class="string" id="4446209">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4446220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4446223">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4446227">var</span>&nbsp;<span class="ident" id="4446231">digest</span>&nbsp;<span class="op" id="4446238">[</span><span class="ident" id="4446239">Size</span><span class="op" id="4446243">]</span><span class="builtintype" id="4446244">byte</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4446250">for</span>&nbsp;<span class="ident" id="4446254">i</span><span class="op" id="4446255">,</span>&nbsp;<span class="ident" id="4446257">s</span>&nbsp;<span class="op" id="4446259">:=</span>&nbsp;<span class="keyword" id="4446262">range</span>&nbsp;<span class="ident" id="4446268">d</span><span class="op" id="4446269">.</span><span class="ident" id="4446270">s</span>&nbsp;<span class="op" id="4446272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4446276">digest</span><span class="op" id="4446282">[</span><span class="ident" id="4446283">i</span><span class="op" id="4446284">*</span><span class="num" id="4446285">4</span><span class="op" id="4446286">]</span>&nbsp;<span class="op" id="4446288">=</span>&nbsp;<span class="builtintype" id="4446290">byte</span><span class="op" id="4446294">(</span><span class="ident" id="4446295">s</span><span class="op" id="4446296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4446300">digest</span><span class="op" id="4446306">[</span><span class="ident" id="4446307">i</span><span class="op" id="4446308">*</span><span class="num" id="4446309">4</span><span class="op" id="4446310">+</span><span class="num" id="4446311">1</span><span class="op" id="4446312">]</span>&nbsp;<span class="op" id="4446314">=</span>&nbsp;<span class="builtintype" id="4446316">byte</span><span class="op" id="4446320">(</span><span class="ident" id="4446321">s</span>&nbsp;<span class="op" id="4446323">&gt;&gt;</span>&nbsp;<span class="num" id="4446326">8</span><span class="op" id="4446327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4446331">digest</span><span class="op" id="4446337">[</span><span class="ident" id="4446338">i</span><span class="op" id="4446339">*</span><span class="num" id="4446340">4</span><span class="op" id="4446341">+</span><span class="num" id="4446342">2</span><span class="op" id="4446343">]</span>&nbsp;<span class="op" id="4446345">=</span>&nbsp;<span class="builtintype" id="4446347">byte</span><span class="op" id="4446351">(</span><span class="ident" id="4446352">s</span>&nbsp;<span class="op" id="4446354">&gt;&gt;</span>&nbsp;<span class="num" id="4446357">16</span><span class="op" id="4446359">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4446363">digest</span><span class="op" id="4446369">[</span><span class="ident" id="4446370">i</span><span class="op" id="4446371">*</span><span class="num" id="4446372">4</span><span class="op" id="4446373">+</span><span class="num" id="4446374">3</span><span class="op" id="4446375">]</span>&nbsp;<span class="op" id="4446377">=</span>&nbsp;<span class="builtintype" id="4446379">byte</span><span class="op" id="4446383">(</span><span class="ident" id="4446384">s</span>&nbsp;<span class="op" id="4446386">&gt;&gt;</span>&nbsp;<span class="num" id="4446389">24</span><span class="op" id="4446391">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4446394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4446398">return</span>&nbsp;<span class="ident" id="4446405">digest</span><br>
<span class="lineno"></span><span class="op" id="4446412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="4446415">//&nbsp;Sum&nbsp;returns&nbsp;the&nbsp;MD5&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4446460">func</span>&nbsp;<span class="ident" id="4446465">Sum</span><span class="op" id="4446468">(</span><span class="ident" id="4446469">data</span>&nbsp;<span class="op" id="4446474">[</span><span class="op" id="4446475">]</span><span class="builtintype" id="4446476">byte</span><span class="op" id="4446480">)</span>&nbsp;<span class="op" id="4446482">[</span><span class="ident" id="4446483">Size</span><span class="op" id="4446487">]</span><span class="builtintype" id="4446488">byte</span>&nbsp;<span class="op" id="4446493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4446496">var</span>&nbsp;<span class="ident" id="4446500">d</span>&nbsp;<span class="ident" id="4446502">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4446510">d</span><span class="op" id="4446511">.</span><span class="ident" id="4446512">Reset</span><span class="op" id="4446517">(</span><span class="op" id="4446518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4446521">d</span><span class="op" id="4446522">.</span><span class="ident" id="4446523">Write</span><span class="op" id="4446528">(</span><span class="ident" id="4446529">data</span><span class="op" id="4446533">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4446536">return</span>&nbsp;<span class="ident" id="4446543">d</span><span class="op" id="4446544">.</span><span class="ident" id="4446545">checkSum</span><span class="op" id="4446553">(</span><span class="op" id="4446554">)</span><br>
<span class="lineno"></span><span class="op" id="4446556">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
