<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>html/template</h2>
<ul>
<li><a href="/gostd/html/template/attr.go.html">attr.go</a></li>
<li><a href="/gostd/html/template/clone_test.go.html">clone_test.go</a></li>
<li><a href="/gostd/html/template/content.go.html">content.go</a></li>
<li><a href="/gostd/html/template/content_test.go.html">content_test.go</a></li>
<li><a href="/gostd/html/template/context.go.html">context.go</a></li>
<li><a href="/gostd/html/template/css.go.html">css.go</a></li>
<li><a href="/gostd/html/template/css_test.go.html">css_test.go</a></li>
<li><a href="/gostd/html/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/html/template/error.go.html">error.go</a></li>
<li><a href="/gostd/html/template/escape.go.html">escape.go</a></li>
<li><a href="/gostd/html/template/escape_test.go.html">escape_test.go</a></li>
<li><a href="/gostd/html/template/html.go.html">html.go</a></li>
<li><a href="/gostd/html/template/html_test.go.html">html_test.go</a></li>
<li><a href="/gostd/html/template/js.go.html">js.go</a></li>
<li><a href="/gostd/html/template/js_test.go.html">js_test.go</a></li>
<li><a href="/gostd/html/template/template.go.html">template.go</a></li>
<li><a href="/gostd/html/template/transition.go.html">transition.go</a></li>
<li><a href="/gostd/html/template/url.go.html">url.go</a></li>
<li><a href="/gostd/html/template/url_test.go.html">url_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4533918">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4533973">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4534027">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4534078">package</span>&nbsp;<span class="ident" id="4534086">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4534096">import</span>&nbsp;<span class="op" id="4534103">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4534106">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4534115">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4534122">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4534133">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="4534148">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4534151">//&nbsp;endsWithCSSKeyword&nbsp;reports&nbsp;whether&nbsp;b&nbsp;ends&nbsp;with&nbsp;an&nbsp;ident&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="4534215">//&nbsp;case-insensitively&nbsp;matches&nbsp;the&nbsp;lower-case&nbsp;kw.</span><br>
<span class="lineno"></span><span class="keyword" id="4534264">func</span>&nbsp;<span class="ident" id="4534269">endsWithCSSKeyword</span><span class="op" id="4534287">(</span><span class="ident" id="4534288">b</span>&nbsp;<span class="op" id="4534290">[</span><span class="op" id="4534291">]</span><span class="builtintype" id="4534292">byte</span><span class="op" id="4534296">,</span>&nbsp;<span class="ident" id="4534298">kw</span>&nbsp;<span class="builtintype" id="4534301">string</span><span class="op" id="4534307">)</span>&nbsp;<span class="builtintype" id="4534309">bool</span>&nbsp;<span class="op" id="4534314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4534317">i</span>&nbsp;<span class="op" id="4534319">:=</span>&nbsp;<span class="builtinfunc" id="4534322">len</span><span class="op" id="4534325">(</span><span class="ident" id="4534326">b</span><span class="op" id="4534327">)</span>&nbsp;<span class="op" id="4534329">-</span>&nbsp;<span class="builtinfunc" id="4534331">len</span><span class="op" id="4534334">(</span><span class="ident" id="4534335">kw</span><span class="op" id="4534337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4534340">if</span>&nbsp;<span class="ident" id="4534343">i</span>&nbsp;<span class="op" id="4534345">&lt;</span>&nbsp;<span class="num" id="4534347">0</span>&nbsp;<span class="op" id="4534349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4534353">//&nbsp;Too&nbsp;short.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4534369">return</span>&nbsp;<span class="builtintype" id="4534376">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4534383">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4534386">if</span>&nbsp;<span class="ident" id="4534389">i</span>&nbsp;<span class="op" id="4534391">!=</span>&nbsp;<span class="num" id="4534394">0</span>&nbsp;<span class="op" id="4534396">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4534400">r</span><span class="op" id="4534401">,</span>&nbsp;<span class="ident" id="4534403">_</span>&nbsp;<span class="op" id="4534405">:=</span>&nbsp;<span class="ident" id="4534408">utf8</span><span class="op" id="4534412">.</span><span class="ident" id="4534413">DecodeLastRune</span><span class="op" id="4534427">(</span><span class="ident" id="4534428">b</span><span class="op" id="4534429">[</span><span class="op" id="4534430">:</span><span class="ident" id="4534431">i</span><span class="op" id="4534432">]</span><span class="op" id="4534433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4534437">if</span>&nbsp;<span class="ident" id="4534440">isCSSNmchar</span><span class="op" id="4534451">(</span><span class="ident" id="4534452">r</span><span class="op" id="4534453">)</span>&nbsp;<span class="op" id="4534455">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4534460">//&nbsp;Too&nbsp;long.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4534476">return</span>&nbsp;<span class="builtintype" id="4534483">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4534491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4534494">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4534497">//&nbsp;Many&nbsp;CSS&nbsp;keywords,&nbsp;such&nbsp;as&nbsp;&#34;!important&#34;&nbsp;can&nbsp;have&nbsp;characters&nbsp;encoded,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4534570">//&nbsp;but&nbsp;the&nbsp;URI&nbsp;production&nbsp;does&nbsp;not&nbsp;allow&nbsp;that&nbsp;according&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4534630">//&nbsp;http://www.w3.org/TR/css3-syntax/#TOK-URI</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4534676">//&nbsp;This&nbsp;does&nbsp;not&nbsp;attempt&nbsp;to&nbsp;recognize&nbsp;encoded&nbsp;keywords.&nbsp;For&nbsp;example,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4534746">//&nbsp;given&nbsp;&#34;\75\72\6c&#34;&nbsp;and&nbsp;&#34;url&#34;&nbsp;this&nbsp;return&nbsp;false.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4534797">return</span>&nbsp;<span class="builtintype" id="4534804">string</span><span class="op" id="4534810">(</span><span class="ident" id="4534811">bytes</span><span class="op" id="4534816">.</span><span class="ident" id="4534817">ToLower</span><span class="op" id="4534824">(</span><span class="ident" id="4534825">b</span><span class="op" id="4534826">[</span><span class="ident" id="4534827">i</span><span class="op" id="4534828">:</span><span class="op" id="4534829">]</span><span class="op" id="4534830">)</span><span class="op" id="4534831">)</span>&nbsp;<span class="op" id="4534833">==</span>&nbsp;<span class="ident" id="4534836">kw</span><br>
<span class="lineno">35</span><span class="op" id="4534839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4534842">//&nbsp;isCSSNmchar&nbsp;reports&nbsp;whether&nbsp;rune&nbsp;is&nbsp;allowed&nbsp;anywhere&nbsp;in&nbsp;a&nbsp;CSS&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="4534919">func</span>&nbsp;<span class="ident" id="4534924">isCSSNmchar</span><span class="op" id="4534935">(</span><span class="ident" id="4534936">r</span>&nbsp;<span class="builtintype" id="4534938">rune</span><span class="op" id="4534942">)</span>&nbsp;<span class="builtintype" id="4534944">bool</span>&nbsp;<span class="op" id="4534949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4534952">//&nbsp;Based&nbsp;on&nbsp;the&nbsp;CSS3&nbsp;nmchar&nbsp;production&nbsp;but&nbsp;ignores&nbsp;multi-rune&nbsp;escape</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4535022">//&nbsp;sequences.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4535037">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-nmchar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4535089">return</span>&nbsp;<span class="string" id="4535096">&#39;a&#39;</span>&nbsp;<span class="op" id="4535100">&lt;=</span>&nbsp;<span class="ident" id="4535103">r</span>&nbsp;<span class="op" id="4535105">&amp;&amp;</span>&nbsp;<span class="ident" id="4535108">r</span>&nbsp;<span class="op" id="4535110">&lt;=</span>&nbsp;<span class="string" id="4535113">&#39;z&#39;</span>&nbsp;<span class="op" id="4535117">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4535122">&#39;A&#39;</span>&nbsp;<span class="op" id="4535126">&lt;=</span>&nbsp;<span class="ident" id="4535129">r</span>&nbsp;<span class="op" id="4535131">&amp;&amp;</span>&nbsp;<span class="ident" id="4535134">r</span>&nbsp;<span class="op" id="4535136">&lt;=</span>&nbsp;<span class="string" id="4535139">&#39;Z&#39;</span>&nbsp;<span class="op" id="4535143">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4535148">&#39;0&#39;</span>&nbsp;<span class="op" id="4535152">&lt;=</span>&nbsp;<span class="ident" id="4535155">r</span>&nbsp;<span class="op" id="4535157">&amp;&amp;</span>&nbsp;<span class="ident" id="4535160">r</span>&nbsp;<span class="op" id="4535162">&lt;=</span>&nbsp;<span class="string" id="4535165">&#39;9&#39;</span>&nbsp;<span class="op" id="4535169">||</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4535174">r</span>&nbsp;<span class="op" id="4535176">==</span>&nbsp;<span class="string" id="4535179">&#39;-&#39;</span>&nbsp;<span class="op" id="4535183">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4535188">r</span>&nbsp;<span class="op" id="4535190">==</span>&nbsp;<span class="string" id="4535193">&#39;_&#39;</span>&nbsp;<span class="op" id="4535197">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4535202">//&nbsp;Non-ASCII&nbsp;cases&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4535230">0x80</span>&nbsp;<span class="op" id="4535235">&lt;=</span>&nbsp;<span class="ident" id="4535238">r</span>&nbsp;<span class="op" id="4535240">&amp;&amp;</span>&nbsp;<span class="ident" id="4535243">r</span>&nbsp;<span class="op" id="4535245">&lt;=</span>&nbsp;<span class="num" id="4535248">0xd7ff</span>&nbsp;<span class="op" id="4535255">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4535260">0xe000</span>&nbsp;<span class="op" id="4535267">&lt;=</span>&nbsp;<span class="ident" id="4535270">r</span>&nbsp;<span class="op" id="4535272">&amp;&amp;</span>&nbsp;<span class="ident" id="4535275">r</span>&nbsp;<span class="op" id="4535277">&lt;=</span>&nbsp;<span class="num" id="4535280">0xfffd</span>&nbsp;<span class="op" id="4535287">||</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="4535292">0x10000</span>&nbsp;<span class="op" id="4535300">&lt;=</span>&nbsp;<span class="ident" id="4535303">r</span>&nbsp;<span class="op" id="4535305">&amp;&amp;</span>&nbsp;<span class="ident" id="4535308">r</span>&nbsp;<span class="op" id="4535310">&lt;=</span>&nbsp;<span class="num" id="4535313">0x10ffff</span><br>
<span class="lineno"></span><span class="op" id="4535322">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4535325">//&nbsp;decodeCSS&nbsp;decodes&nbsp;CSS3&nbsp;escapes&nbsp;given&nbsp;a&nbsp;sequence&nbsp;of&nbsp;stringchars.</span><br>
<span class="lineno"></span><span class="comment" id="4535392">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;change,&nbsp;it&nbsp;returns&nbsp;the&nbsp;input,&nbsp;otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;slice</span><br>
<span class="lineno">55</span><span class="comment" id="4535469">//&nbsp;backed&nbsp;by&nbsp;a&nbsp;new&nbsp;array.</span><br>
<span class="lineno"></span><span class="comment" id="4535495">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-stringchar&nbsp;defines&nbsp;stringchar.</span><br>
<span class="lineno"></span><span class="keyword" id="4535570">func</span>&nbsp;<span class="ident" id="4535575">decodeCSS</span><span class="op" id="4535584">(</span><span class="ident" id="4535585">s</span>&nbsp;<span class="op" id="4535587">[</span><span class="op" id="4535588">]</span><span class="builtintype" id="4535589">byte</span><span class="op" id="4535593">)</span>&nbsp;<span class="op" id="4535595">[</span><span class="op" id="4535596">]</span><span class="builtintype" id="4535597">byte</span>&nbsp;<span class="op" id="4535602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4535605">i</span>&nbsp;<span class="op" id="4535607">:=</span>&nbsp;<span class="ident" id="4535610">bytes</span><span class="op" id="4535615">.</span><span class="ident" id="4535616">IndexByte</span><span class="op" id="4535625">(</span><span class="ident" id="4535626">s</span><span class="op" id="4535627">,</span>&nbsp;<span class="string" id="4535629">&#39;\\&#39;</span><span class="op" id="4535633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4535636">if</span>&nbsp;<span class="ident" id="4535639">i</span>&nbsp;<span class="op" id="4535641">==</span>&nbsp;<span class="op" id="4535644">-</span><span class="num" id="4535645">1</span>&nbsp;<span class="op" id="4535647">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4535651">return</span>&nbsp;<span class="ident" id="4535658">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4535661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4535664">//&nbsp;The&nbsp;UTF-8&nbsp;sequence&nbsp;for&nbsp;a&nbsp;codepoint&nbsp;is&nbsp;never&nbsp;longer&nbsp;than&nbsp;1&nbsp;+&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4535732">//&nbsp;number&nbsp;hex&nbsp;digits&nbsp;need&nbsp;to&nbsp;represent&nbsp;that&nbsp;codepoint,&nbsp;so&nbsp;len(s)&nbsp;is&nbsp;an</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4535804">//&nbsp;upper&nbsp;bound&nbsp;on&nbsp;the&nbsp;output&nbsp;length.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4535842">b</span>&nbsp;<span class="op" id="4535844">:=</span>&nbsp;<span class="builtinfunc" id="4535847">make</span><span class="op" id="4535851">(</span><span class="op" id="4535852">[</span><span class="op" id="4535853">]</span><span class="builtintype" id="4535854">byte</span><span class="op" id="4535858">,</span>&nbsp;<span class="num" id="4535860">0</span><span class="op" id="4535861">,</span>&nbsp;<span class="builtinfunc" id="4535863">len</span><span class="op" id="4535866">(</span><span class="ident" id="4535867">s</span><span class="op" id="4535868">)</span><span class="op" id="4535869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4535872">for</span>&nbsp;<span class="builtinfunc" id="4535876">len</span><span class="op" id="4535879">(</span><span class="ident" id="4535880">s</span><span class="op" id="4535881">)</span>&nbsp;<span class="op" id="4535883">!=</span>&nbsp;<span class="num" id="4535886">0</span>&nbsp;<span class="op" id="4535888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4535892">i</span>&nbsp;<span class="op" id="4535894">:=</span>&nbsp;<span class="ident" id="4535897">bytes</span><span class="op" id="4535902">.</span><span class="ident" id="4535903">IndexByte</span><span class="op" id="4535912">(</span><span class="ident" id="4535913">s</span><span class="op" id="4535914">,</span>&nbsp;<span class="string" id="4535916">&#39;\\&#39;</span><span class="op" id="4535920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4535924">if</span>&nbsp;<span class="ident" id="4535927">i</span>&nbsp;<span class="op" id="4535929">==</span>&nbsp;<span class="op" id="4535932">-</span><span class="num" id="4535933">1</span>&nbsp;<span class="op" id="4535935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4535940">i</span>&nbsp;<span class="op" id="4535942">=</span>&nbsp;<span class="builtinfunc" id="4535944">len</span><span class="op" id="4535947">(</span><span class="ident" id="4535948">s</span><span class="op" id="4535949">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4535953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4535957">b</span><span class="op" id="4535958">,</span>&nbsp;<span class="ident" id="4535960">s</span>&nbsp;<span class="op" id="4535962">=</span>&nbsp;<span class="builtinfunc" id="4535964">append</span><span class="op" id="4535970">(</span><span class="ident" id="4535971">b</span><span class="op" id="4535972">,</span>&nbsp;<span class="ident" id="4535974">s</span><span class="op" id="4535975">[</span><span class="op" id="4535976">:</span><span class="ident" id="4535977">i</span><span class="op" id="4535978">]</span><span class="op" id="4535979">...</span><span class="op" id="4535982">)</span><span class="op" id="4535983">,</span>&nbsp;<span class="ident" id="4535985">s</span><span class="op" id="4535986">[</span><span class="ident" id="4535987">i</span><span class="op" id="4535988">:</span><span class="op" id="4535989">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4535993">if</span>&nbsp;<span class="builtinfunc" id="4535996">len</span><span class="op" id="4535999">(</span><span class="ident" id="4536000">s</span><span class="op" id="4536001">)</span>&nbsp;<span class="op" id="4536003">&lt;</span>&nbsp;<span class="num" id="4536005">2</span>&nbsp;<span class="op" id="4536007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4536012">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4536020">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4536024">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-escape</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4536077">//&nbsp;escape&nbsp;::=&nbsp;unicode&nbsp;|&nbsp;&#39;\&#39;&nbsp;[#x20-#x7E#x80-#xD7FF#xE000-#xFFFD#x10000-#x10FFFF]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4536159">if</span>&nbsp;<span class="ident" id="4536162">isHex</span><span class="op" id="4536167">(</span><span class="ident" id="4536168">s</span><span class="op" id="4536169">[</span><span class="num" id="4536170">1</span><span class="op" id="4536171">]</span><span class="op" id="4536172">)</span>&nbsp;<span class="op" id="4536174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4536179">//&nbsp;http://www.w3.org/TR/css3-syntax/#SUBTOK-unicode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4536234">//&nbsp;&nbsp;&nbsp;unicode&nbsp;::=&nbsp;&#39;\&#39;&nbsp;[0-9a-fA-F]{1,6}&nbsp;wc?</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536279">j</span>&nbsp;<span class="op" id="4536281">:=</span>&nbsp;<span class="num" id="4536284">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4536289">for</span>&nbsp;<span class="ident" id="4536293">j</span>&nbsp;<span class="op" id="4536295">&lt;</span>&nbsp;<span class="builtinfunc" id="4536297">len</span><span class="op" id="4536300">(</span><span class="ident" id="4536301">s</span><span class="op" id="4536302">)</span>&nbsp;<span class="op" id="4536304">&amp;&amp;</span>&nbsp;<span class="ident" id="4536307">j</span>&nbsp;<span class="op" id="4536309">&lt;</span>&nbsp;<span class="num" id="4536311">7</span>&nbsp;<span class="op" id="4536313">&amp;&amp;</span>&nbsp;<span class="ident" id="4536316">isHex</span><span class="op" id="4536321">(</span><span class="ident" id="4536322">s</span><span class="op" id="4536323">[</span><span class="ident" id="4536324">j</span><span class="op" id="4536325">]</span><span class="op" id="4536326">)</span>&nbsp;<span class="op" id="4536328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536334">j</span><span class="op" id="4536335">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4536341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536346">r</span>&nbsp;<span class="op" id="4536348">:=</span>&nbsp;<span class="ident" id="4536351">hexDecode</span><span class="op" id="4536360">(</span><span class="ident" id="4536361">s</span><span class="op" id="4536362">[</span><span class="num" id="4536363">1</span><span class="op" id="4536364">:</span><span class="ident" id="4536365">j</span><span class="op" id="4536366">]</span><span class="op" id="4536367">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4536372">if</span>&nbsp;<span class="ident" id="4536375">r</span>&nbsp;<span class="op" id="4536377">&gt;</span>&nbsp;<span class="ident" id="4536379">unicode</span><span class="op" id="4536386">.</span><span class="ident" id="4536387">MaxRune</span>&nbsp;<span class="op" id="4536395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536401">r</span><span class="op" id="4536402">,</span>&nbsp;<span class="ident" id="4536404">j</span>&nbsp;<span class="op" id="4536406">=</span>&nbsp;<span class="ident" id="4536408">r</span><span class="op" id="4536409">/</span><span class="num" id="4536410">16</span><span class="op" id="4536412">,</span>&nbsp;<span class="ident" id="4536414">j</span><span class="op" id="4536415">-</span><span class="num" id="4536416">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4536421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536426">n</span>&nbsp;<span class="op" id="4536428">:=</span>&nbsp;<span class="ident" id="4536431">utf8</span><span class="op" id="4536435">.</span><span class="ident" id="4536436">EncodeRune</span><span class="op" id="4536446">(</span><span class="ident" id="4536447">b</span><span class="op" id="4536448">[</span><span class="builtinfunc" id="4536449">len</span><span class="op" id="4536452">(</span><span class="ident" id="4536453">b</span><span class="op" id="4536454">)</span><span class="op" id="4536455">:</span><span class="builtinfunc" id="4536456">cap</span><span class="op" id="4536459">(</span><span class="ident" id="4536460">b</span><span class="op" id="4536461">)</span><span class="op" id="4536462">]</span><span class="op" id="4536463">,</span>&nbsp;<span class="ident" id="4536465">r</span><span class="op" id="4536466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4536471">//&nbsp;The&nbsp;optional&nbsp;space&nbsp;at&nbsp;the&nbsp;end&nbsp;allows&nbsp;a&nbsp;hex</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4536520">//&nbsp;sequence&nbsp;to&nbsp;be&nbsp;followed&nbsp;by&nbsp;a&nbsp;literal&nbsp;hex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4536568">//&nbsp;string(decodeCSS([]byte(`\A&nbsp;B`)))&nbsp;==&nbsp;&#34;\nB&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536617">b</span><span class="op" id="4536618">,</span>&nbsp;<span class="ident" id="4536620">s</span>&nbsp;<span class="op" id="4536622">=</span>&nbsp;<span class="ident" id="4536624">b</span><span class="op" id="4536625">[</span><span class="op" id="4536626">:</span><span class="builtinfunc" id="4536627">len</span><span class="op" id="4536630">(</span><span class="ident" id="4536631">b</span><span class="op" id="4536632">)</span><span class="op" id="4536633">+</span><span class="ident" id="4536634">n</span><span class="op" id="4536635">]</span><span class="op" id="4536636">,</span>&nbsp;<span class="ident" id="4536638">skipCSSSpace</span><span class="op" id="4536650">(</span><span class="ident" id="4536651">s</span><span class="op" id="4536652">[</span><span class="ident" id="4536653">j</span><span class="op" id="4536654">:</span><span class="op" id="4536655">]</span><span class="op" id="4536656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4536660">}</span>&nbsp;<span class="keyword" id="4536662">else</span>&nbsp;<span class="op" id="4536667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4536672">//&nbsp;`\\`&nbsp;decodes&nbsp;to&nbsp;`\`&nbsp;and&nbsp;`\&#34;`&nbsp;to&nbsp;`&#34;`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536715">_</span><span class="op" id="4536716">,</span>&nbsp;<span class="ident" id="4536718">n</span>&nbsp;<span class="op" id="4536720">:=</span>&nbsp;<span class="ident" id="4536723">utf8</span><span class="op" id="4536727">.</span><span class="ident" id="4536728">DecodeRune</span><span class="op" id="4536738">(</span><span class="ident" id="4536739">s</span><span class="op" id="4536740">[</span><span class="num" id="4536741">1</span><span class="op" id="4536742">:</span><span class="op" id="4536743">]</span><span class="op" id="4536744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4536749">b</span><span class="op" id="4536750">,</span>&nbsp;<span class="ident" id="4536752">s</span>&nbsp;<span class="op" id="4536754">=</span>&nbsp;<span class="builtinfunc" id="4536756">append</span><span class="op" id="4536762">(</span><span class="ident" id="4536763">b</span><span class="op" id="4536764">,</span>&nbsp;<span class="ident" id="4536766">s</span><span class="op" id="4536767">[</span><span class="num" id="4536768">1</span><span class="op" id="4536769">:</span><span class="num" id="4536770">1</span><span class="op" id="4536771">+</span><span class="ident" id="4536772">n</span><span class="op" id="4536773">]</span><span class="op" id="4536774">...</span><span class="op" id="4536777">)</span><span class="op" id="4536778">,</span>&nbsp;<span class="ident" id="4536780">s</span><span class="op" id="4536781">[</span><span class="num" id="4536782">1</span><span class="op" id="4536783">+</span><span class="ident" id="4536784">n</span><span class="op" id="4536785">:</span><span class="op" id="4536786">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4536790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4536793">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4536796">return</span>&nbsp;<span class="ident" id="4536803">b</span><br>
<span class="lineno">100</span><span class="op" id="4536805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4536808">//&nbsp;isHex&nbsp;reports&nbsp;whether&nbsp;the&nbsp;given&nbsp;character&nbsp;is&nbsp;a&nbsp;hex&nbsp;digit.</span><br>
<span class="lineno"></span><span class="keyword" id="4536869">func</span>&nbsp;<span class="ident" id="4536874">isHex</span><span class="op" id="4536879">(</span><span class="ident" id="4536880">c</span>&nbsp;<span class="builtintype" id="4536882">byte</span><span class="op" id="4536886">)</span>&nbsp;<span class="builtintype" id="4536888">bool</span>&nbsp;<span class="op" id="4536893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4536896">return</span>&nbsp;<span class="string" id="4536903">&#39;0&#39;</span>&nbsp;<span class="op" id="4536907">&lt;=</span>&nbsp;<span class="ident" id="4536910">c</span>&nbsp;<span class="op" id="4536912">&amp;&amp;</span>&nbsp;<span class="ident" id="4536915">c</span>&nbsp;<span class="op" id="4536917">&lt;=</span>&nbsp;<span class="string" id="4536920">&#39;9&#39;</span>&nbsp;<span class="op" id="4536924">||</span>&nbsp;<span class="string" id="4536927">&#39;a&#39;</span>&nbsp;<span class="op" id="4536931">&lt;=</span>&nbsp;<span class="ident" id="4536934">c</span>&nbsp;<span class="op" id="4536936">&amp;&amp;</span>&nbsp;<span class="ident" id="4536939">c</span>&nbsp;<span class="op" id="4536941">&lt;=</span>&nbsp;<span class="string" id="4536944">&#39;f&#39;</span>&nbsp;<span class="op" id="4536948">||</span>&nbsp;<span class="string" id="4536951">&#39;A&#39;</span>&nbsp;<span class="op" id="4536955">&lt;=</span>&nbsp;<span class="ident" id="4536958">c</span>&nbsp;<span class="op" id="4536960">&amp;&amp;</span>&nbsp;<span class="ident" id="4536963">c</span>&nbsp;<span class="op" id="4536965">&lt;=</span>&nbsp;<span class="string" id="4536968">&#39;F&#39;</span><br>
<span class="lineno">105</span><span class="op" id="4536972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4536975">//&nbsp;hexDecode&nbsp;decodes&nbsp;a&nbsp;short&nbsp;hex&nbsp;digit&nbsp;sequence:&nbsp;&#34;10&#34;&nbsp;-&gt;&nbsp;16.</span><br>
<span class="lineno"></span><span class="keyword" id="4537036">func</span>&nbsp;<span class="ident" id="4537041">hexDecode</span><span class="op" id="4537050">(</span><span class="ident" id="4537051">s</span>&nbsp;<span class="op" id="4537053">[</span><span class="op" id="4537054">]</span><span class="builtintype" id="4537055">byte</span><span class="op" id="4537059">)</span>&nbsp;<span class="builtintype" id="4537061">rune</span>&nbsp;<span class="op" id="4537066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537069">n</span>&nbsp;<span class="op" id="4537071">:=</span>&nbsp;<span class="string" id="4537074">&#39;\x00&#39;</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537082">for</span>&nbsp;<span class="ident" id="4537086">_</span><span class="op" id="4537087">,</span>&nbsp;<span class="ident" id="4537089">c</span>&nbsp;<span class="op" id="4537091">:=</span>&nbsp;<span class="keyword" id="4537094">range</span>&nbsp;<span class="ident" id="4537100">s</span>&nbsp;<span class="op" id="4537102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537106">n</span>&nbsp;<span class="op" id="4537108">&lt;&lt;=</span>&nbsp;<span class="num" id="4537112">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537116">switch</span>&nbsp;<span class="op" id="4537123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537127">case</span>&nbsp;<span class="string" id="4537132">&#39;0&#39;</span>&nbsp;<span class="op" id="4537136">&lt;=</span>&nbsp;<span class="ident" id="4537139">c</span>&nbsp;<span class="op" id="4537141">&amp;&amp;</span>&nbsp;<span class="ident" id="4537144">c</span>&nbsp;<span class="op" id="4537146">&lt;=</span>&nbsp;<span class="string" id="4537149">&#39;9&#39;</span><span class="op" id="4537152">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537157">n</span>&nbsp;<span class="op" id="4537159">|=</span>&nbsp;<span class="builtintype" id="4537162">rune</span><span class="op" id="4537166">(</span><span class="ident" id="4537167">c</span>&nbsp;<span class="op" id="4537169">-</span>&nbsp;<span class="string" id="4537171">&#39;0&#39;</span><span class="op" id="4537174">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537178">case</span>&nbsp;<span class="string" id="4537183">&#39;a&#39;</span>&nbsp;<span class="op" id="4537187">&lt;=</span>&nbsp;<span class="ident" id="4537190">c</span>&nbsp;<span class="op" id="4537192">&amp;&amp;</span>&nbsp;<span class="ident" id="4537195">c</span>&nbsp;<span class="op" id="4537197">&lt;=</span>&nbsp;<span class="string" id="4537200">&#39;f&#39;</span><span class="op" id="4537203">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537208">n</span>&nbsp;<span class="op" id="4537210">|=</span>&nbsp;<span class="builtintype" id="4537213">rune</span><span class="op" id="4537217">(</span><span class="ident" id="4537218">c</span><span class="op" id="4537219">-</span><span class="string" id="4537220">&#39;a&#39;</span><span class="op" id="4537223">)</span>&nbsp;<span class="op" id="4537225">+</span>&nbsp;<span class="num" id="4537227">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537232">case</span>&nbsp;<span class="string" id="4537237">&#39;A&#39;</span>&nbsp;<span class="op" id="4537241">&lt;=</span>&nbsp;<span class="ident" id="4537244">c</span>&nbsp;<span class="op" id="4537246">&amp;&amp;</span>&nbsp;<span class="ident" id="4537249">c</span>&nbsp;<span class="op" id="4537251">&lt;=</span>&nbsp;<span class="string" id="4537254">&#39;F&#39;</span><span class="op" id="4537257">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4537262">n</span>&nbsp;<span class="op" id="4537264">|=</span>&nbsp;<span class="builtintype" id="4537267">rune</span><span class="op" id="4537271">(</span><span class="ident" id="4537272">c</span><span class="op" id="4537273">-</span><span class="string" id="4537274">&#39;A&#39;</span><span class="op" id="4537277">)</span>&nbsp;<span class="op" id="4537279">+</span>&nbsp;<span class="num" id="4537281">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537286">default</span><span class="op" id="4537293">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4537298">panic</span><span class="op" id="4537303">(</span><span class="ident" id="4537304">fmt</span><span class="op" id="4537307">.</span><span class="ident" id="4537308">Sprintf</span><span class="op" id="4537315">(</span><span class="string" id="4537316">&#34;Bad&nbsp;hex&nbsp;digit&nbsp;in&nbsp;%q&#34;</span><span class="op" id="4537337">,</span>&nbsp;<span class="ident" id="4537339">s</span><span class="op" id="4537340">)</span><span class="op" id="4537341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4537345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4537348">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537351">return</span>&nbsp;<span class="ident" id="4537358">n</span><br>
<span class="lineno"></span><span class="op" id="4537360">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4537363">//&nbsp;skipCSSSpace&nbsp;returns&nbsp;a&nbsp;suffix&nbsp;of&nbsp;c,&nbsp;skipping&nbsp;over&nbsp;a&nbsp;single&nbsp;space.</span><br>
<span class="lineno"></span><span class="keyword" id="4537432">func</span>&nbsp;<span class="ident" id="4537437">skipCSSSpace</span><span class="op" id="4537449">(</span><span class="ident" id="4537450">c</span>&nbsp;<span class="op" id="4537452">[</span><span class="op" id="4537453">]</span><span class="builtintype" id="4537454">byte</span><span class="op" id="4537458">)</span>&nbsp;<span class="op" id="4537460">[</span><span class="op" id="4537461">]</span><span class="builtintype" id="4537462">byte</span>&nbsp;<span class="op" id="4537467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537470">if</span>&nbsp;<span class="builtinfunc" id="4537473">len</span><span class="op" id="4537476">(</span><span class="ident" id="4537477">c</span><span class="op" id="4537478">)</span>&nbsp;<span class="op" id="4537480">==</span>&nbsp;<span class="num" id="4537483">0</span>&nbsp;<span class="op" id="4537485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537489">return</span>&nbsp;<span class="ident" id="4537496">c</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4537499">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4537502">//&nbsp;wc&nbsp;::=&nbsp;#x9&nbsp;|&nbsp;#xA&nbsp;|&nbsp;#xC&nbsp;|&nbsp;#xD&nbsp;|&nbsp;#x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537542">switch</span>&nbsp;<span class="ident" id="4537549">c</span><span class="op" id="4537550">[</span><span class="num" id="4537551">0</span><span class="op" id="4537552">]</span>&nbsp;<span class="op" id="4537554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537557">case</span>&nbsp;<span class="string" id="4537562">&#39;\t&#39;</span><span class="op" id="4537566">,</span>&nbsp;<span class="string" id="4537568">&#39;\n&#39;</span><span class="op" id="4537572">,</span>&nbsp;<span class="string" id="4537574">&#39;\f&#39;</span><span class="op" id="4537578">,</span>&nbsp;<span class="string" id="4537580">&#39;&nbsp;&#39;</span><span class="op" id="4537583">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537587">return</span>&nbsp;<span class="ident" id="4537594">c</span><span class="op" id="4537595">[</span><span class="num" id="4537596">1</span><span class="op" id="4537597">:</span><span class="op" id="4537598">]</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537601">case</span>&nbsp;<span class="string" id="4537606">&#39;\r&#39;</span><span class="op" id="4537610">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4537614">//&nbsp;This&nbsp;differs&nbsp;from&nbsp;CSS3&#39;s&nbsp;wc&nbsp;production&nbsp;because&nbsp;it&nbsp;contains&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4537680">//&nbsp;probable&nbsp;spec&nbsp;error&nbsp;whereby&nbsp;wc&nbsp;contains&nbsp;all&nbsp;the&nbsp;single&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4537745">//&nbsp;sequences&nbsp;in&nbsp;nl&nbsp;(newline)&nbsp;but&nbsp;not&nbsp;CRLF.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537790">if</span>&nbsp;<span class="builtinfunc" id="4537793">len</span><span class="op" id="4537796">(</span><span class="ident" id="4537797">c</span><span class="op" id="4537798">)</span>&nbsp;<span class="op" id="4537800">&gt;=</span>&nbsp;<span class="num" id="4537803">2</span>&nbsp;<span class="op" id="4537805">&amp;&amp;</span>&nbsp;<span class="ident" id="4537808">c</span><span class="op" id="4537809">[</span><span class="num" id="4537810">1</span><span class="op" id="4537811">]</span>&nbsp;<span class="op" id="4537813">==</span>&nbsp;<span class="string" id="4537816">&#39;\n&#39;</span>&nbsp;<span class="op" id="4537821">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537826">return</span>&nbsp;<span class="ident" id="4537833">c</span><span class="op" id="4537834">[</span><span class="num" id="4537835">2</span><span class="op" id="4537836">:</span><span class="op" id="4537837">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4537841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537845">return</span>&nbsp;<span class="ident" id="4537852">c</span><span class="op" id="4537853">[</span><span class="num" id="4537854">1</span><span class="op" id="4537855">:</span><span class="op" id="4537856">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4537859">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537862">return</span>&nbsp;<span class="ident" id="4537869">c</span><br>
<span class="lineno">145</span><span class="op" id="4537871">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4537874">//&nbsp;isCSSSpace&nbsp;reports&nbsp;whether&nbsp;b&nbsp;is&nbsp;a&nbsp;CSS&nbsp;space&nbsp;char&nbsp;as&nbsp;defined&nbsp;in&nbsp;wc.</span><br>
<span class="lineno"></span><span class="keyword" id="4537944">func</span>&nbsp;<span class="ident" id="4537949">isCSSSpace</span><span class="op" id="4537959">(</span><span class="ident" id="4537960">b</span>&nbsp;<span class="builtintype" id="4537962">byte</span><span class="op" id="4537966">)</span>&nbsp;<span class="builtintype" id="4537968">bool</span>&nbsp;<span class="op" id="4537973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537976">switch</span>&nbsp;<span class="ident" id="4537983">b</span>&nbsp;<span class="op" id="4537985">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4537988">case</span>&nbsp;<span class="string" id="4537993">&#39;\t&#39;</span><span class="op" id="4537997">,</span>&nbsp;<span class="string" id="4537999">&#39;\n&#39;</span><span class="op" id="4538003">,</span>&nbsp;<span class="string" id="4538005">&#39;\f&#39;</span><span class="op" id="4538009">,</span>&nbsp;<span class="string" id="4538011">&#39;\r&#39;</span><span class="op" id="4538015">,</span>&nbsp;<span class="string" id="4538017">&#39;&nbsp;&#39;</span><span class="op" id="4538020">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538024">return</span>&nbsp;<span class="builtintype" id="4538031">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4538037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538040">return</span>&nbsp;<span class="builtintype" id="4538047">false</span><br>
<span class="lineno"></span><span class="op" id="4538053">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="4538056">//&nbsp;cssEscaper&nbsp;escapes&nbsp;HTML&nbsp;and&nbsp;CSS&nbsp;special&nbsp;characters&nbsp;using&nbsp;\&lt;hex&gt;+&nbsp;escapes.</span><br>
<span class="lineno"></span><span class="keyword" id="4538133">func</span>&nbsp;<span class="ident" id="4538138">cssEscaper</span><span class="op" id="4538148">(</span><span class="ident" id="4538149">args</span>&nbsp;<span class="op" id="4538154">...</span><span class="keyword" id="4538157">interface</span><span class="op" id="4538166">{</span><span class="op" id="4538167">}</span><span class="op" id="4538168">)</span>&nbsp;<span class="builtintype" id="4538170">string</span>&nbsp;<span class="op" id="4538177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538180">s</span><span class="op" id="4538181">,</span>&nbsp;<span class="ident" id="4538183">_</span>&nbsp;<span class="op" id="4538185">:=</span>&nbsp;<span class="ident" id="4538188">stringify</span><span class="op" id="4538197">(</span><span class="ident" id="4538198">args</span><span class="op" id="4538202">...</span><span class="op" id="4538205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538208">var</span>&nbsp;<span class="ident" id="4538212">b</span>&nbsp;<span class="ident" id="4538214">bytes</span><span class="op" id="4538219">.</span><span class="ident" id="4538220">Buffer</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538228">written</span>&nbsp;<span class="op" id="4538236">:=</span>&nbsp;<span class="num" id="4538239">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538242">for</span>&nbsp;<span class="ident" id="4538246">i</span><span class="op" id="4538247">,</span>&nbsp;<span class="ident" id="4538249">r</span>&nbsp;<span class="op" id="4538251">:=</span>&nbsp;<span class="keyword" id="4538254">range</span>&nbsp;<span class="ident" id="4538260">s</span>&nbsp;<span class="op" id="4538262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538266">var</span>&nbsp;<span class="ident" id="4538270">repl</span>&nbsp;<span class="builtintype" id="4538275">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538284">switch</span>&nbsp;<span class="ident" id="4538291">r</span>&nbsp;<span class="op" id="4538293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538297">case</span>&nbsp;<span class="num" id="4538302">0</span><span class="op" id="4538303">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538308">repl</span>&nbsp;<span class="op" id="4538313">=</span>&nbsp;<span class="string" id="4538315">`\0`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538322">case</span>&nbsp;<span class="string" id="4538327">&#39;\t&#39;</span><span class="op" id="4538331">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538336">repl</span>&nbsp;<span class="op" id="4538341">=</span>&nbsp;<span class="string" id="4538343">`\9`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538350">case</span>&nbsp;<span class="string" id="4538355">&#39;\n&#39;</span><span class="op" id="4538359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538364">repl</span>&nbsp;<span class="op" id="4538369">=</span>&nbsp;<span class="string" id="4538371">`\a`</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538378">case</span>&nbsp;<span class="string" id="4538383">&#39;\f&#39;</span><span class="op" id="4538387">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538392">repl</span>&nbsp;<span class="op" id="4538397">=</span>&nbsp;<span class="string" id="4538399">`\c`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538406">case</span>&nbsp;<span class="string" id="4538411">&#39;\r&#39;</span><span class="op" id="4538415">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538420">repl</span>&nbsp;<span class="op" id="4538425">=</span>&nbsp;<span class="string" id="4538427">`\d`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4538434">//&nbsp;Encode&nbsp;HTML&nbsp;specials&nbsp;as&nbsp;hex&nbsp;so&nbsp;the&nbsp;output&nbsp;can&nbsp;be&nbsp;embedded</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4538497">//&nbsp;in&nbsp;HTML&nbsp;attributes&nbsp;without&nbsp;further&nbsp;encoding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538547">case</span>&nbsp;<span class="string" id="4538552">&#39;&#34;&#39;</span><span class="op" id="4538555">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538560">repl</span>&nbsp;<span class="op" id="4538565">=</span>&nbsp;<span class="string" id="4538567">`\22`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538575">case</span>&nbsp;<span class="string" id="4538580">&#39;&amp;&#39;</span><span class="op" id="4538583">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538588">repl</span>&nbsp;<span class="op" id="4538593">=</span>&nbsp;<span class="string" id="4538595">`\26`</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538603">case</span>&nbsp;<span class="string" id="4538608">&#39;\&#39;&#39;</span><span class="op" id="4538612">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538617">repl</span>&nbsp;<span class="op" id="4538622">=</span>&nbsp;<span class="string" id="4538624">`\27`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538632">case</span>&nbsp;<span class="string" id="4538637">&#39;(&#39;</span><span class="op" id="4538640">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538645">repl</span>&nbsp;<span class="op" id="4538650">=</span>&nbsp;<span class="string" id="4538652">`\28`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538660">case</span>&nbsp;<span class="string" id="4538665">&#39;)&#39;</span><span class="op" id="4538668">:</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538673">repl</span>&nbsp;<span class="op" id="4538678">=</span>&nbsp;<span class="string" id="4538680">`\29`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538688">case</span>&nbsp;<span class="string" id="4538693">&#39;+&#39;</span><span class="op" id="4538696">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538701">repl</span>&nbsp;<span class="op" id="4538706">=</span>&nbsp;<span class="string" id="4538708">`\2b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538716">case</span>&nbsp;<span class="string" id="4538721">&#39;/&#39;</span><span class="op" id="4538724">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538729">repl</span>&nbsp;<span class="op" id="4538734">=</span>&nbsp;<span class="string" id="4538736">`\2f`</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538744">case</span>&nbsp;<span class="string" id="4538749">&#39;:&#39;</span><span class="op" id="4538752">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538757">repl</span>&nbsp;<span class="op" id="4538762">=</span>&nbsp;<span class="string" id="4538764">`\3a`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538772">case</span>&nbsp;<span class="string" id="4538777">&#39;;&#39;</span><span class="op" id="4538780">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538785">repl</span>&nbsp;<span class="op" id="4538790">=</span>&nbsp;<span class="string" id="4538792">`\3b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538800">case</span>&nbsp;<span class="string" id="4538805">&#39;&lt;&#39;</span><span class="op" id="4538808">:</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538813">repl</span>&nbsp;<span class="op" id="4538818">=</span>&nbsp;<span class="string" id="4538820">`\3c`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538828">case</span>&nbsp;<span class="string" id="4538833">&#39;&gt;&#39;</span><span class="op" id="4538836">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538841">repl</span>&nbsp;<span class="op" id="4538846">=</span>&nbsp;<span class="string" id="4538848">`\3e`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538856">case</span>&nbsp;<span class="string" id="4538861">&#39;\\&#39;</span><span class="op" id="4538865">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538870">repl</span>&nbsp;<span class="op" id="4538875">=</span>&nbsp;<span class="string" id="4538877">`\\`</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538884">case</span>&nbsp;<span class="string" id="4538889">&#39;{&#39;</span><span class="op" id="4538892">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538897">repl</span>&nbsp;<span class="op" id="4538902">=</span>&nbsp;<span class="string" id="4538904">`\7b`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538912">case</span>&nbsp;<span class="string" id="4538917">&#39;}&#39;</span><span class="op" id="4538920">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538925">repl</span>&nbsp;<span class="op" id="4538930">=</span>&nbsp;<span class="string" id="4538932">`\7d`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538940">default</span><span class="op" id="4538947">:</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4538952">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4538963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538967">b</span><span class="op" id="4538968">.</span><span class="ident" id="4538969">WriteString</span><span class="op" id="4538980">(</span><span class="ident" id="4538981">s</span><span class="op" id="4538982">[</span><span class="ident" id="4538983">written</span><span class="op" id="4538990">:</span><span class="ident" id="4538991">i</span><span class="op" id="4538992">]</span><span class="op" id="4538993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4538997">b</span><span class="op" id="4538998">.</span><span class="ident" id="4538999">WriteString</span><span class="op" id="4539010">(</span><span class="ident" id="4539011">repl</span><span class="op" id="4539015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539019">written</span>&nbsp;<span class="op" id="4539027">=</span>&nbsp;<span class="ident" id="4539029">i</span>&nbsp;<span class="op" id="4539031">+</span>&nbsp;<span class="ident" id="4539033">utf8</span><span class="op" id="4539037">.</span><span class="ident" id="4539038">RuneLen</span><span class="op" id="4539045">(</span><span class="ident" id="4539046">r</span><span class="op" id="4539047">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539051">if</span>&nbsp;<span class="ident" id="4539054">repl</span>&nbsp;<span class="op" id="4539059">!=</span>&nbsp;<span class="string" id="4539062">`\\`</span>&nbsp;<span class="op" id="4539067">&amp;&amp;</span>&nbsp;<span class="op" id="4539070">(</span><span class="ident" id="4539071">written</span>&nbsp;<span class="op" id="4539079">==</span>&nbsp;<span class="builtinfunc" id="4539082">len</span><span class="op" id="4539085">(</span><span class="ident" id="4539086">s</span><span class="op" id="4539087">)</span>&nbsp;<span class="op" id="4539089">||</span>&nbsp;<span class="ident" id="4539092">isHex</span><span class="op" id="4539097">(</span><span class="ident" id="4539098">s</span><span class="op" id="4539099">[</span><span class="ident" id="4539100">written</span><span class="op" id="4539107">]</span><span class="op" id="4539108">)</span>&nbsp;<span class="op" id="4539110">||</span>&nbsp;<span class="ident" id="4539113">isCSSSpace</span><span class="op" id="4539123">(</span><span class="ident" id="4539124">s</span><span class="op" id="4539125">[</span><span class="ident" id="4539126">written</span><span class="op" id="4539133">]</span><span class="op" id="4539134">)</span><span class="op" id="4539135">)</span>&nbsp;<span class="op" id="4539137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539142">b</span><span class="op" id="4539143">.</span><span class="ident" id="4539144">WriteByte</span><span class="op" id="4539153">(</span><span class="string" id="4539154">&#39;&nbsp;&#39;</span><span class="op" id="4539157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4539161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4539164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539167">if</span>&nbsp;<span class="ident" id="4539170">written</span>&nbsp;<span class="op" id="4539178">==</span>&nbsp;<span class="num" id="4539181">0</span>&nbsp;<span class="op" id="4539183">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539187">return</span>&nbsp;<span class="ident" id="4539194">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4539197">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539200">b</span><span class="op" id="4539201">.</span><span class="ident" id="4539202">WriteString</span><span class="op" id="4539213">(</span><span class="ident" id="4539214">s</span><span class="op" id="4539215">[</span><span class="ident" id="4539216">written</span><span class="op" id="4539223">:</span><span class="op" id="4539224">]</span><span class="op" id="4539225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539228">return</span>&nbsp;<span class="ident" id="4539235">b</span><span class="op" id="4539236">.</span><span class="ident" id="4539237">String</span><span class="op" id="4539243">(</span><span class="op" id="4539244">)</span><br>
<span class="lineno"></span><span class="op" id="4539246">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="4539249">var</span>&nbsp;<span class="ident" id="4539253">expressionBytes</span>&nbsp;<span class="op" id="4539269">=</span>&nbsp;<span class="op" id="4539271">[</span><span class="op" id="4539272">]</span><span class="builtintype" id="4539273">byte</span><span class="op" id="4539277">(</span><span class="string" id="4539278">&#34;expression&#34;</span><span class="op" id="4539290">)</span><br>
<span class="lineno"></span><span class="keyword" id="4539292">var</span>&nbsp;<span class="ident" id="4539296">mozBindingBytes</span>&nbsp;<span class="op" id="4539312">=</span>&nbsp;<span class="op" id="4539314">[</span><span class="op" id="4539315">]</span><span class="builtintype" id="4539316">byte</span><span class="op" id="4539320">(</span><span class="string" id="4539321">&#34;mozbinding&#34;</span><span class="op" id="4539333">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4539336">//&nbsp;cssValueFilter&nbsp;allows&nbsp;innocuous&nbsp;CSS&nbsp;values&nbsp;in&nbsp;the&nbsp;output&nbsp;including&nbsp;CSS</span><br>
<span class="lineno">225</span><span class="comment" id="4539410">//&nbsp;quantities&nbsp;(10px&nbsp;or&nbsp;25%),&nbsp;ID&nbsp;or&nbsp;class&nbsp;literals&nbsp;(#foo,&nbsp;.bar),&nbsp;keyword&nbsp;values</span><br>
<span class="lineno"></span><span class="comment" id="4539489">//&nbsp;(inherit,&nbsp;blue),&nbsp;and&nbsp;colors&nbsp;(#888).</span><br>
<span class="lineno"></span><span class="comment" id="4539528">//&nbsp;It&nbsp;filters&nbsp;out&nbsp;unsafe&nbsp;values,&nbsp;such&nbsp;as&nbsp;those&nbsp;that&nbsp;affect&nbsp;token&nbsp;boundaries,</span><br>
<span class="lineno"></span><span class="comment" id="4539605">//&nbsp;and&nbsp;anything&nbsp;that&nbsp;might&nbsp;execute&nbsp;scripts.</span><br>
<span class="lineno"></span><span class="keyword" id="4539649">func</span>&nbsp;<span class="ident" id="4539654">cssValueFilter</span><span class="op" id="4539668">(</span><span class="ident" id="4539669">args</span>&nbsp;<span class="op" id="4539674">...</span><span class="keyword" id="4539677">interface</span><span class="op" id="4539686">{</span><span class="op" id="4539687">}</span><span class="op" id="4539688">)</span>&nbsp;<span class="builtintype" id="4539690">string</span>&nbsp;<span class="op" id="4539697">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539700">s</span><span class="op" id="4539701">,</span>&nbsp;<span class="ident" id="4539703">t</span>&nbsp;<span class="op" id="4539705">:=</span>&nbsp;<span class="ident" id="4539708">stringify</span><span class="op" id="4539717">(</span><span class="ident" id="4539718">args</span><span class="op" id="4539722">...</span><span class="op" id="4539725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539728">if</span>&nbsp;<span class="ident" id="4539731">t</span>&nbsp;<span class="op" id="4539733">==</span>&nbsp;<span class="ident" id="4539736">contentTypeCSS</span>&nbsp;<span class="op" id="4539751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4539755">return</span>&nbsp;<span class="ident" id="4539762">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4539765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4539768">b</span><span class="op" id="4539769">,</span>&nbsp;<span class="ident" id="4539771">id</span>&nbsp;<span class="op" id="4539774">:=</span>&nbsp;<span class="ident" id="4539777">decodeCSS</span><span class="op" id="4539786">(</span><span class="op" id="4539787">[</span><span class="op" id="4539788">]</span><span class="builtintype" id="4539789">byte</span><span class="op" id="4539793">(</span><span class="ident" id="4539794">s</span><span class="op" id="4539795">)</span><span class="op" id="4539796">)</span><span class="op" id="4539797">,</span>&nbsp;<span class="builtinfunc" id="4539799">make</span><span class="op" id="4539803">(</span><span class="op" id="4539804">[</span><span class="op" id="4539805">]</span><span class="builtintype" id="4539806">byte</span><span class="op" id="4539810">,</span>&nbsp;<span class="num" id="4539812">0</span><span class="op" id="4539813">,</span>&nbsp;<span class="num" id="4539815">64</span><span class="op" id="4539817">)</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4539821">//&nbsp;CSS3&nbsp;error&nbsp;handling&nbsp;is&nbsp;specified&nbsp;as&nbsp;honoring&nbsp;string&nbsp;boundaries&nbsp;per</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4539892">//&nbsp;http://www.w3.org/TR/css3-syntax/#error-handling&nbsp;:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4539947">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Malformed&nbsp;declarations.&nbsp;User&nbsp;agents&nbsp;must&nbsp;handle&nbsp;unexpected</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4540014">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tokens&nbsp;encountered&nbsp;while&nbsp;parsing&nbsp;a&nbsp;declaration&nbsp;by&nbsp;reading&nbsp;until</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4540086">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;declaration,&nbsp;while&nbsp;observing&nbsp;the&nbsp;rules&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4540152">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;matching&nbsp;pairs&nbsp;of&nbsp;(),&nbsp;[],&nbsp;{},&nbsp;&#34;&#34;,&nbsp;and&nbsp;&#39;&#39;,&nbsp;and&nbsp;correctly&nbsp;handling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4540225">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;escapes.&nbsp;For&nbsp;example,&nbsp;a&nbsp;malformed&nbsp;declaration&nbsp;may&nbsp;be&nbsp;missing&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4540296">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;property,&nbsp;colon&nbsp;(:)&nbsp;or&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4540334">//&nbsp;So&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;values&nbsp;do&nbsp;not&nbsp;have&nbsp;mismatched&nbsp;bracket</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4540405">//&nbsp;or&nbsp;quote&nbsp;characters&nbsp;to&nbsp;prevent&nbsp;the&nbsp;browser&nbsp;from&nbsp;restarting&nbsp;parsing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4540476">//&nbsp;inside&nbsp;a&nbsp;string&nbsp;that&nbsp;might&nbsp;embed&nbsp;JavaScript&nbsp;source.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4540532">for</span>&nbsp;<span class="ident" id="4540536">i</span><span class="op" id="4540537">,</span>&nbsp;<span class="ident" id="4540539">c</span>&nbsp;<span class="op" id="4540541">:=</span>&nbsp;<span class="keyword" id="4540544">range</span>&nbsp;<span class="ident" id="4540550">b</span>&nbsp;<span class="op" id="4540552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4540556">switch</span>&nbsp;<span class="ident" id="4540563">c</span>&nbsp;<span class="op" id="4540565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4540569">case</span>&nbsp;<span class="num" id="4540574">0</span><span class="op" id="4540575">,</span>&nbsp;<span class="string" id="4540577">&#39;&#34;&#39;</span><span class="op" id="4540580">,</span>&nbsp;<span class="string" id="4540582">&#39;\&#39;&#39;</span><span class="op" id="4540586">,</span>&nbsp;<span class="string" id="4540588">&#39;(&#39;</span><span class="op" id="4540591">,</span>&nbsp;<span class="string" id="4540593">&#39;)&#39;</span><span class="op" id="4540596">,</span>&nbsp;<span class="string" id="4540598">&#39;/&#39;</span><span class="op" id="4540601">,</span>&nbsp;<span class="string" id="4540603">&#39;;&#39;</span><span class="op" id="4540606">,</span>&nbsp;<span class="string" id="4540608">&#39;@&#39;</span><span class="op" id="4540611">,</span>&nbsp;<span class="string" id="4540613">&#39;[&#39;</span><span class="op" id="4540616">,</span>&nbsp;<span class="string" id="4540618">&#39;\\&#39;</span><span class="op" id="4540622">,</span>&nbsp;<span class="string" id="4540624">&#39;]&#39;</span><span class="op" id="4540627">,</span>&nbsp;<span class="string" id="4540629">&#39;`&#39;</span><span class="op" id="4540632">,</span>&nbsp;<span class="string" id="4540634">&#39;{&#39;</span><span class="op" id="4540637">,</span>&nbsp;<span class="string" id="4540639">&#39;}&#39;</span><span class="op" id="4540642">:</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4540647">return</span>&nbsp;<span class="ident" id="4540654">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4540671">case</span>&nbsp;<span class="string" id="4540676">&#39;-&#39;</span><span class="op" id="4540679">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4540684">//&nbsp;Disallow&nbsp;&lt;!--&nbsp;or&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4540712">//&nbsp;--&nbsp;should&nbsp;not&nbsp;appear&nbsp;in&nbsp;valid&nbsp;identifiers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4540761">if</span>&nbsp;<span class="ident" id="4540764">i</span>&nbsp;<span class="op" id="4540766">!=</span>&nbsp;<span class="num" id="4540769">0</span>&nbsp;<span class="op" id="4540771">&amp;&amp;</span>&nbsp;<span class="ident" id="4540774">b</span><span class="op" id="4540775">[</span><span class="ident" id="4540776">i</span><span class="op" id="4540777">-</span><span class="num" id="4540778">1</span><span class="op" id="4540779">]</span>&nbsp;<span class="op" id="4540781">==</span>&nbsp;<span class="string" id="4540784">&#39;-&#39;</span>&nbsp;<span class="op" id="4540788">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4540794">return</span>&nbsp;<span class="ident" id="4540801">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4540819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4540823">default</span><span class="op" id="4540830">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4540835">if</span>&nbsp;<span class="ident" id="4540838">c</span>&nbsp;<span class="op" id="4540840">&lt;</span>&nbsp;<span class="num" id="4540842">0x80</span>&nbsp;<span class="op" id="4540847">&amp;&amp;</span>&nbsp;<span class="ident" id="4540850">isCSSNmchar</span><span class="op" id="4540861">(</span><span class="builtintype" id="4540862">rune</span><span class="op" id="4540866">(</span><span class="ident" id="4540867">c</span><span class="op" id="4540868">)</span><span class="op" id="4540869">)</span>&nbsp;<span class="op" id="4540871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540877">id</span>&nbsp;<span class="op" id="4540880">=</span>&nbsp;<span class="builtinfunc" id="4540882">append</span><span class="op" id="4540888">(</span><span class="ident" id="4540889">id</span><span class="op" id="4540891">,</span>&nbsp;<span class="ident" id="4540893">c</span><span class="op" id="4540894">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4540899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4540903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4540906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540909">id</span>&nbsp;<span class="op" id="4540912">=</span>&nbsp;<span class="ident" id="4540914">bytes</span><span class="op" id="4540919">.</span><span class="ident" id="4540920">ToLower</span><span class="op" id="4540927">(</span><span class="ident" id="4540928">id</span><span class="op" id="4540930">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4540933">if</span>&nbsp;<span class="ident" id="4540936">bytes</span><span class="op" id="4540941">.</span><span class="ident" id="4540942">Index</span><span class="op" id="4540947">(</span><span class="ident" id="4540948">id</span><span class="op" id="4540950">,</span>&nbsp;<span class="ident" id="4540952">expressionBytes</span><span class="op" id="4540967">)</span>&nbsp;<span class="op" id="4540969">!=</span>&nbsp;<span class="op" id="4540972">-</span><span class="num" id="4540973">1</span>&nbsp;<span class="op" id="4540975">||</span>&nbsp;<span class="ident" id="4540978">bytes</span><span class="op" id="4540983">.</span><span class="ident" id="4540984">Index</span><span class="op" id="4540989">(</span><span class="ident" id="4540990">id</span><span class="op" id="4540992">,</span>&nbsp;<span class="ident" id="4540994">mozBindingBytes</span><span class="op" id="4541009">)</span>&nbsp;<span class="op" id="4541011">!=</span>&nbsp;<span class="op" id="4541014">-</span><span class="num" id="4541015">1</span>&nbsp;<span class="op" id="4541017">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541021">return</span>&nbsp;<span class="ident" id="4541028">filterFailsafe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4541044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541047">return</span>&nbsp;<span class="builtintype" id="4541054">string</span><span class="op" id="4541060">(</span><span class="ident" id="4541061">b</span><span class="op" id="4541062">)</span><br>
<span class="lineno"></span><span class="op" id="4541064">}</span>
</div>
</body>
</html>
