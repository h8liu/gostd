<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>log</h2>
<ul>
<li><a href="/gostd/log/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/log/log.go.html">log.go</a></li>
<li><a href="/gostd/log/log_test.go.html">log_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6885244">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6885299">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6885353">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6885404">package</span>&nbsp;<span class="ident" id="6885412">log</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6885417">//&nbsp;These&nbsp;tests&nbsp;are&nbsp;too&nbsp;simple.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6885449">import</span>&nbsp;<span class="op" id="6885456">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6885459">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6885468">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6885474">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6885484">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6885494">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="6885497">const</span>&nbsp;<span class="op" id="6885503">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6885506">Rdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6885520">=</span>&nbsp;<span class="string" id="6885522">`[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6885568">Rtime</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6885582">=</span>&nbsp;<span class="string" id="6885584">`[0-9][0-9]:[0-9][0-9]:[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6885620">Rmicroseconds</span>&nbsp;<span class="op" id="6885634">=</span>&nbsp;<span class="string" id="6885636">`\.[0-9][0-9][0-9][0-9][0-9][0-9]`</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6885672">Rline</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6885686">=</span>&nbsp;<span class="string" id="6885688">`(54|56):`</span>&nbsp;<span class="comment" id="6885699">//&nbsp;must&nbsp;update&nbsp;if&nbsp;the&nbsp;calls&nbsp;to&nbsp;l.Printf&nbsp;/&nbsp;l.Print&nbsp;below&nbsp;move</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6885761">Rlongfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6885775">=</span>&nbsp;<span class="string" id="6885777">`.*/[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="6885803">+</span>&nbsp;<span class="ident" id="6885805">Rline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6885812">Rshortfile</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6885826">=</span>&nbsp;<span class="string" id="6885828">`[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="6885851">+</span>&nbsp;<span class="ident" id="6885853">Rline</span><br>
<span class="lineno"></span><span class="op" id="6885859">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="6885862">type</span>&nbsp;<span class="ident" id="6885867">tester</span>&nbsp;<span class="keyword" id="6885874">struct</span>&nbsp;<span class="op" id="6885881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6885884">flag</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6885892">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6885897">prefix</span>&nbsp;&nbsp;<span class="builtintype" id="6885905">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6885913">pattern</span>&nbsp;<span class="builtintype" id="6885921">string</span>&nbsp;<span class="comment" id="6885928">//&nbsp;regexp&nbsp;that&nbsp;log&nbsp;output&nbsp;must&nbsp;match;&nbsp;we&nbsp;add&nbsp;^&nbsp;and&nbsp;expected_text$&nbsp;always</span><br>
<span class="lineno"></span><span class="op" id="6886001">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="6886004">var</span>&nbsp;<span class="ident" id="6886008">tests</span>&nbsp;<span class="op" id="6886014">=</span>&nbsp;<span class="op" id="6886016">[</span><span class="op" id="6886017">]</span><span class="ident" id="6886018">tester</span><span class="op" id="6886024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6886027">//&nbsp;individual&nbsp;pieces:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6886050">{</span><span class="num" id="6886051">0</span><span class="op" id="6886052">,</span>&nbsp;<span class="string" id="6886054">&#34;&#34;</span><span class="op" id="6886056">,</span>&nbsp;<span class="string" id="6886058">&#34;&#34;</span><span class="op" id="6886060">}</span><span class="op" id="6886061">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6886064">{</span><span class="num" id="6886065">0</span><span class="op" id="6886066">,</span>&nbsp;<span class="string" id="6886068">&#34;XXX&#34;</span><span class="op" id="6886073">,</span>&nbsp;<span class="string" id="6886075">&#34;XXX&#34;</span><span class="op" id="6886080">}</span><span class="op" id="6886081">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6886084">{</span><span class="ident" id="6886085">Ldate</span><span class="op" id="6886090">,</span>&nbsp;<span class="string" id="6886092">&#34;&#34;</span><span class="op" id="6886094">,</span>&nbsp;<span class="ident" id="6886096">Rdate</span>&nbsp;<span class="op" id="6886102">+</span>&nbsp;<span class="string" id="6886104">&#34;&nbsp;&#34;</span><span class="op" id="6886107">}</span><span class="op" id="6886108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6886111">{</span><span class="ident" id="6886112">Ltime</span><span class="op" id="6886117">,</span>&nbsp;<span class="string" id="6886119">&#34;&#34;</span><span class="op" id="6886121">,</span>&nbsp;<span class="ident" id="6886123">Rtime</span>&nbsp;<span class="op" id="6886129">+</span>&nbsp;<span class="string" id="6886131">&#34;&nbsp;&#34;</span><span class="op" id="6886134">}</span><span class="op" id="6886135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6886138">{</span><span class="ident" id="6886139">Ltime</span>&nbsp;<span class="op" id="6886145">|</span>&nbsp;<span class="ident" id="6886147">Lmicroseconds</span><span class="op" id="6886160">,</span>&nbsp;<span class="string" id="6886162">&#34;&#34;</span><span class="op" id="6886164">,</span>&nbsp;<span class="ident" id="6886166">Rtime</span>&nbsp;<span class="op" id="6886172">+</span>&nbsp;<span class="ident" id="6886174">Rmicroseconds</span>&nbsp;<span class="op" id="6886188">+</span>&nbsp;<span class="string" id="6886190">&#34;&nbsp;&#34;</span><span class="op" id="6886193">}</span><span class="op" id="6886194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6886197">{</span><span class="ident" id="6886198">Lmicroseconds</span><span class="op" id="6886211">,</span>&nbsp;<span class="string" id="6886213">&#34;&#34;</span><span class="op" id="6886215">,</span>&nbsp;<span class="ident" id="6886217">Rtime</span>&nbsp;<span class="op" id="6886223">+</span>&nbsp;<span class="ident" id="6886225">Rmicroseconds</span>&nbsp;<span class="op" id="6886239">+</span>&nbsp;<span class="string" id="6886241">&#34;&nbsp;&#34;</span><span class="op" id="6886244">}</span><span class="op" id="6886245">,</span>&nbsp;<span class="comment" id="6886247">//&nbsp;microsec&nbsp;implies&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6886273">{</span><span class="ident" id="6886274">Llongfile</span><span class="op" id="6886283">,</span>&nbsp;<span class="string" id="6886285">&#34;&#34;</span><span class="op" id="6886287">,</span>&nbsp;<span class="ident" id="6886289">Rlongfile</span>&nbsp;<span class="op" id="6886299">+</span>&nbsp;<span class="string" id="6886301">&#34;&nbsp;&#34;</span><span class="op" id="6886304">}</span><span class="op" id="6886305">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6886308">{</span><span class="ident" id="6886309">Lshortfile</span><span class="op" id="6886319">,</span>&nbsp;<span class="string" id="6886321">&#34;&#34;</span><span class="op" id="6886323">,</span>&nbsp;<span class="ident" id="6886325">Rshortfile</span>&nbsp;<span class="op" id="6886336">+</span>&nbsp;<span class="string" id="6886338">&#34;&nbsp;&#34;</span><span class="op" id="6886341">}</span><span class="op" id="6886342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6886345">{</span><span class="ident" id="6886346">Llongfile</span>&nbsp;<span class="op" id="6886356">|</span>&nbsp;<span class="ident" id="6886358">Lshortfile</span><span class="op" id="6886368">,</span>&nbsp;<span class="string" id="6886370">&#34;&#34;</span><span class="op" id="6886372">,</span>&nbsp;<span class="ident" id="6886374">Rshortfile</span>&nbsp;<span class="op" id="6886385">+</span>&nbsp;<span class="string" id="6886387">&#34;&nbsp;&#34;</span><span class="op" id="6886390">}</span><span class="op" id="6886391">,</span>&nbsp;<span class="comment" id="6886393">//&nbsp;shortfile&nbsp;overrides&nbsp;longfile</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6886426">//&nbsp;everything&nbsp;at&nbsp;once:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6886450">{</span><span class="ident" id="6886451">Ldate</span>&nbsp;<span class="op" id="6886457">|</span>&nbsp;<span class="ident" id="6886459">Ltime</span>&nbsp;<span class="op" id="6886465">|</span>&nbsp;<span class="ident" id="6886467">Lmicroseconds</span>&nbsp;<span class="op" id="6886481">|</span>&nbsp;<span class="ident" id="6886483">Llongfile</span><span class="op" id="6886492">,</span>&nbsp;<span class="string" id="6886494">&#34;XXX&#34;</span><span class="op" id="6886499">,</span>&nbsp;<span class="string" id="6886501">&#34;XXX&#34;</span>&nbsp;<span class="op" id="6886507">+</span>&nbsp;<span class="ident" id="6886509">Rdate</span>&nbsp;<span class="op" id="6886515">+</span>&nbsp;<span class="string" id="6886517">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6886521">+</span>&nbsp;<span class="ident" id="6886523">Rtime</span>&nbsp;<span class="op" id="6886529">+</span>&nbsp;<span class="ident" id="6886531">Rmicroseconds</span>&nbsp;<span class="op" id="6886545">+</span>&nbsp;<span class="string" id="6886547">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6886551">+</span>&nbsp;<span class="ident" id="6886553">Rlongfile</span>&nbsp;<span class="op" id="6886563">+</span>&nbsp;<span class="string" id="6886565">&#34;&nbsp;&#34;</span><span class="op" id="6886568">}</span><span class="op" id="6886569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6886572">{</span><span class="ident" id="6886573">Ldate</span>&nbsp;<span class="op" id="6886579">|</span>&nbsp;<span class="ident" id="6886581">Ltime</span>&nbsp;<span class="op" id="6886587">|</span>&nbsp;<span class="ident" id="6886589">Lmicroseconds</span>&nbsp;<span class="op" id="6886603">|</span>&nbsp;<span class="ident" id="6886605">Lshortfile</span><span class="op" id="6886615">,</span>&nbsp;<span class="string" id="6886617">&#34;XXX&#34;</span><span class="op" id="6886622">,</span>&nbsp;<span class="string" id="6886624">&#34;XXX&#34;</span>&nbsp;<span class="op" id="6886630">+</span>&nbsp;<span class="ident" id="6886632">Rdate</span>&nbsp;<span class="op" id="6886638">+</span>&nbsp;<span class="string" id="6886640">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6886644">+</span>&nbsp;<span class="ident" id="6886646">Rtime</span>&nbsp;<span class="op" id="6886652">+</span>&nbsp;<span class="ident" id="6886654">Rmicroseconds</span>&nbsp;<span class="op" id="6886668">+</span>&nbsp;<span class="string" id="6886670">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6886674">+</span>&nbsp;<span class="ident" id="6886676">Rshortfile</span>&nbsp;<span class="op" id="6886687">+</span>&nbsp;<span class="string" id="6886689">&#34;&nbsp;&#34;</span><span class="op" id="6886692">}</span><span class="op" id="6886693">,</span><br>
<span class="lineno">45</span><span class="op" id="6886695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6886698">//&nbsp;Test&nbsp;using&nbsp;Println(&#34;hello&#34;,&nbsp;23,&nbsp;&#34;world&#34;)&nbsp;or&nbsp;using&nbsp;Printf(&#34;hello&nbsp;%d&nbsp;world&#34;,&nbsp;23)</span><br>
<span class="lineno"></span><span class="keyword" id="6886780">func</span>&nbsp;<span class="ident" id="6886785">testPrint</span><span class="op" id="6886794">(</span><span class="ident" id="6886795">t</span>&nbsp;<span class="op" id="6886797">*</span><span class="ident" id="6886798">testing</span><span class="op" id="6886805">.</span><span class="ident" id="6886806">T</span><span class="op" id="6886807">,</span>&nbsp;<span class="ident" id="6886809">flag</span>&nbsp;<span class="builtintype" id="6886814">int</span><span class="op" id="6886817">,</span>&nbsp;<span class="ident" id="6886819">prefix</span>&nbsp;<span class="builtintype" id="6886826">string</span><span class="op" id="6886832">,</span>&nbsp;<span class="ident" id="6886834">pattern</span>&nbsp;<span class="builtintype" id="6886842">string</span><span class="op" id="6886848">,</span>&nbsp;<span class="ident" id="6886850">useFormat</span>&nbsp;<span class="builtintype" id="6886860">bool</span><span class="op" id="6886864">)</span>&nbsp;<span class="op" id="6886866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6886869">buf</span>&nbsp;<span class="op" id="6886873">:=</span>&nbsp;<span class="builtinfunc" id="6886876">new</span><span class="op" id="6886879">(</span><span class="ident" id="6886880">bytes</span><span class="op" id="6886885">.</span><span class="ident" id="6886886">Buffer</span><span class="op" id="6886892">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6886895">SetOutput</span><span class="op" id="6886904">(</span><span class="ident" id="6886905">buf</span><span class="op" id="6886908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6886911">SetFlags</span><span class="op" id="6886919">(</span><span class="ident" id="6886920">flag</span><span class="op" id="6886924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6886927">SetPrefix</span><span class="op" id="6886936">(</span><span class="ident" id="6886937">prefix</span><span class="op" id="6886943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6886946">if</span>&nbsp;<span class="ident" id="6886949">useFormat</span>&nbsp;<span class="op" id="6886959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6886963">Printf</span><span class="op" id="6886969">(</span><span class="string" id="6886970">&#34;hello&nbsp;%d&nbsp;world&#34;</span><span class="op" id="6886986">,</span>&nbsp;<span class="num" id="6886988">23</span><span class="op" id="6886990">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6886993">}</span>&nbsp;<span class="keyword" id="6886995">else</span>&nbsp;<span class="op" id="6887000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6887004">Println</span><span class="op" id="6887011">(</span><span class="string" id="6887012">&#34;hello&#34;</span><span class="op" id="6887019">,</span>&nbsp;<span class="num" id="6887021">23</span><span class="op" id="6887023">,</span>&nbsp;<span class="string" id="6887025">&#34;world&#34;</span><span class="op" id="6887032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6887035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6887038">line</span>&nbsp;<span class="op" id="6887043">:=</span>&nbsp;<span class="ident" id="6887046">buf</span><span class="op" id="6887049">.</span><span class="ident" id="6887050">String</span><span class="op" id="6887056">(</span><span class="op" id="6887057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6887060">line</span>&nbsp;<span class="op" id="6887065">=</span>&nbsp;<span class="ident" id="6887067">line</span><span class="op" id="6887071">[</span><span class="num" id="6887072">0</span>&nbsp;<span class="op" id="6887074">:</span>&nbsp;<span class="builtinfunc" id="6887076">len</span><span class="op" id="6887079">(</span><span class="ident" id="6887080">line</span><span class="op" id="6887084">)</span><span class="op" id="6887085">-</span><span class="num" id="6887086">1</span><span class="op" id="6887087">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6887090">pattern</span>&nbsp;<span class="op" id="6887098">=</span>&nbsp;<span class="string" id="6887100">&#34;^&#34;</span>&nbsp;<span class="op" id="6887104">+</span>&nbsp;<span class="ident" id="6887106">pattern</span>&nbsp;<span class="op" id="6887114">+</span>&nbsp;<span class="string" id="6887116">&#34;hello&nbsp;23&nbsp;world$&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6887135">matched</span><span class="op" id="6887142">,</span>&nbsp;<span class="ident" id="6887144">err4</span>&nbsp;<span class="op" id="6887149">:=</span>&nbsp;<span class="ident" id="6887152">regexp</span><span class="op" id="6887158">.</span><span class="ident" id="6887159">MatchString</span><span class="op" id="6887170">(</span><span class="ident" id="6887171">pattern</span><span class="op" id="6887178">,</span>&nbsp;<span class="ident" id="6887180">line</span><span class="op" id="6887184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6887187">if</span>&nbsp;<span class="ident" id="6887190">err4</span>&nbsp;<span class="op" id="6887195">!=</span>&nbsp;<span class="ident" id="6887198">nil</span>&nbsp;<span class="op" id="6887202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6887206">t</span><span class="op" id="6887207">.</span><span class="ident" id="6887208">Fatal</span><span class="op" id="6887213">(</span><span class="string" id="6887214">&#34;pattern&nbsp;did&nbsp;not&nbsp;compile:&#34;</span><span class="op" id="6887240">,</span>&nbsp;<span class="ident" id="6887242">err4</span><span class="op" id="6887246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6887249">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6887252">if</span>&nbsp;<span class="op" id="6887255">!</span><span class="ident" id="6887256">matched</span>&nbsp;<span class="op" id="6887264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6887268">t</span><span class="op" id="6887269">.</span><span class="ident" id="6887270">Errorf</span><span class="op" id="6887276">(</span><span class="string" id="6887277">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="6887311">,</span>&nbsp;<span class="ident" id="6887313">pattern</span><span class="op" id="6887320">,</span>&nbsp;<span class="ident" id="6887322">line</span><span class="op" id="6887326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6887329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6887332">SetOutput</span><span class="op" id="6887341">(</span><span class="ident" id="6887342">os</span><span class="op" id="6887344">.</span><span class="ident" id="6887345">Stderr</span><span class="op" id="6887351">)</span><br>
<span class="lineno"></span><span class="op" id="6887353">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="6887356">func</span>&nbsp;<span class="ident" id="6887361">TestAll</span><span class="op" id="6887368">(</span><span class="ident" id="6887369">t</span>&nbsp;<span class="op" id="6887371">*</span><span class="ident" id="6887372">testing</span><span class="op" id="6887379">.</span><span class="ident" id="6887380">T</span><span class="op" id="6887381">)</span>&nbsp;<span class="op" id="6887383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6887386">for</span>&nbsp;<span class="ident" id="6887390">_</span><span class="op" id="6887391">,</span>&nbsp;<span class="ident" id="6887393">testcase</span>&nbsp;<span class="op" id="6887402">:=</span>&nbsp;<span class="keyword" id="6887405">range</span>&nbsp;<span class="ident" id="6887411">tests</span>&nbsp;<span class="op" id="6887417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6887421">testPrint</span><span class="op" id="6887430">(</span><span class="ident" id="6887431">t</span><span class="op" id="6887432">,</span>&nbsp;<span class="ident" id="6887434">testcase</span><span class="op" id="6887442">.</span><span class="ident" id="6887443">flag</span><span class="op" id="6887447">,</span>&nbsp;<span class="ident" id="6887449">testcase</span><span class="op" id="6887457">.</span><span class="ident" id="6887458">prefix</span><span class="op" id="6887464">,</span>&nbsp;<span class="ident" id="6887466">testcase</span><span class="op" id="6887474">.</span><span class="ident" id="6887475">pattern</span><span class="op" id="6887482">,</span>&nbsp;<span class="builtintype" id="6887484">false</span><span class="op" id="6887489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6887493">testPrint</span><span class="op" id="6887502">(</span><span class="ident" id="6887503">t</span><span class="op" id="6887504">,</span>&nbsp;<span class="ident" id="6887506">testcase</span><span class="op" id="6887514">.</span><span class="ident" id="6887515">flag</span><span class="op" id="6887519">,</span>&nbsp;<span class="ident" id="6887521">testcase</span><span class="op" id="6887529">.</span><span class="ident" id="6887530">prefix</span><span class="op" id="6887536">,</span>&nbsp;<span class="ident" id="6887538">testcase</span><span class="op" id="6887546">.</span><span class="ident" id="6887547">pattern</span><span class="op" id="6887554">,</span>&nbsp;<span class="builtintype" id="6887556">true</span><span class="op" id="6887560">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6887563">}</span><br>
<span class="lineno"></span><span class="op" id="6887565">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6887568">func</span>&nbsp;<span class="ident" id="6887573">TestOutput</span><span class="op" id="6887583">(</span><span class="ident" id="6887584">t</span>&nbsp;<span class="op" id="6887586">*</span><span class="ident" id="6887587">testing</span><span class="op" id="6887594">.</span><span class="ident" id="6887595">T</span><span class="op" id="6887596">)</span>&nbsp;<span class="op" id="6887598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6887601">const</span>&nbsp;<span class="ident" id="6887607">testString</span>&nbsp;<span class="op" id="6887618">=</span>&nbsp;<span class="string" id="6887620">&#34;test&#34;</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6887628">var</span>&nbsp;<span class="ident" id="6887632">b</span>&nbsp;<span class="ident" id="6887634">bytes</span><span class="op" id="6887639">.</span><span class="ident" id="6887640">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6887648">l</span>&nbsp;<span class="op" id="6887650">:=</span>&nbsp;<span class="ident" id="6887653">New</span><span class="op" id="6887656">(</span><span class="op" id="6887657">&amp;</span><span class="ident" id="6887658">b</span><span class="op" id="6887659">,</span>&nbsp;<span class="string" id="6887661">&#34;&#34;</span><span class="op" id="6887663">,</span>&nbsp;<span class="num" id="6887665">0</span><span class="op" id="6887666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6887669">l</span><span class="op" id="6887670">.</span><span class="ident" id="6887671">Println</span><span class="op" id="6887678">(</span><span class="ident" id="6887679">testString</span><span class="op" id="6887689">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6887692">if</span>&nbsp;<span class="ident" id="6887695">expect</span>&nbsp;<span class="op" id="6887702">:=</span>&nbsp;<span class="ident" id="6887705">testString</span>&nbsp;<span class="op" id="6887716">+</span>&nbsp;<span class="string" id="6887718">&#34;\n&#34;</span><span class="op" id="6887722">;</span>&nbsp;<span class="ident" id="6887724">b</span><span class="op" id="6887725">.</span><span class="ident" id="6887726">String</span><span class="op" id="6887732">(</span><span class="op" id="6887733">)</span>&nbsp;<span class="op" id="6887735">!=</span>&nbsp;<span class="ident" id="6887738">expect</span>&nbsp;<span class="op" id="6887745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6887749">t</span><span class="op" id="6887750">.</span><span class="ident" id="6887751">Errorf</span><span class="op" id="6887757">(</span><span class="string" id="6887758">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="6887792">,</span>&nbsp;<span class="ident" id="6887794">expect</span><span class="op" id="6887800">,</span>&nbsp;<span class="ident" id="6887802">b</span><span class="op" id="6887803">.</span><span class="ident" id="6887804">String</span><span class="op" id="6887810">(</span><span class="op" id="6887811">)</span><span class="op" id="6887812">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6887815">}</span><br>
<span class="lineno"></span><span class="op" id="6887817">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6887820">func</span>&nbsp;<span class="ident" id="6887825">TestFlagAndPrefixSetting</span><span class="op" id="6887849">(</span><span class="ident" id="6887850">t</span>&nbsp;<span class="op" id="6887852">*</span><span class="ident" id="6887853">testing</span><span class="op" id="6887860">.</span><span class="ident" id="6887861">T</span><span class="op" id="6887862">)</span>&nbsp;<span class="op" id="6887864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6887867">var</span>&nbsp;<span class="ident" id="6887871">b</span>&nbsp;<span class="ident" id="6887873">bytes</span><span class="op" id="6887878">.</span><span class="ident" id="6887879">Buffer</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6887887">l</span>&nbsp;<span class="op" id="6887889">:=</span>&nbsp;<span class="ident" id="6887892">New</span><span class="op" id="6887895">(</span><span class="op" id="6887896">&amp;</span><span class="ident" id="6887897">b</span><span class="op" id="6887898">,</span>&nbsp;<span class="string" id="6887900">&#34;Test:&#34;</span><span class="op" id="6887907">,</span>&nbsp;<span class="ident" id="6887909">LstdFlags</span><span class="op" id="6887918">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6887921">f</span>&nbsp;<span class="op" id="6887923">:=</span>&nbsp;<span class="ident" id="6887926">l</span><span class="op" id="6887927">.</span><span class="ident" id="6887928">Flags</span><span class="op" id="6887933">(</span><span class="op" id="6887934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6887937">if</span>&nbsp;<span class="ident" id="6887940">f</span>&nbsp;<span class="op" id="6887942">!=</span>&nbsp;<span class="ident" id="6887945">LstdFlags</span>&nbsp;<span class="op" id="6887955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6887959">t</span><span class="op" id="6887960">.</span><span class="ident" id="6887961">Errorf</span><span class="op" id="6887967">(</span><span class="string" id="6887968">&#34;Flags&nbsp;1:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="6887997">,</span>&nbsp;<span class="ident" id="6887999">LstdFlags</span><span class="op" id="6888008">,</span>&nbsp;<span class="ident" id="6888010">f</span><span class="op" id="6888011">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6888014">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6888017">l</span><span class="op" id="6888018">.</span><span class="ident" id="6888019">SetFlags</span><span class="op" id="6888027">(</span><span class="ident" id="6888028">f</span>&nbsp;<span class="op" id="6888030">|</span>&nbsp;<span class="ident" id="6888032">Lmicroseconds</span><span class="op" id="6888045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6888048">f</span>&nbsp;<span class="op" id="6888050">=</span>&nbsp;<span class="ident" id="6888052">l</span><span class="op" id="6888053">.</span><span class="ident" id="6888054">Flags</span><span class="op" id="6888059">(</span><span class="op" id="6888060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6888063">if</span>&nbsp;<span class="ident" id="6888066">f</span>&nbsp;<span class="op" id="6888068">!=</span>&nbsp;<span class="ident" id="6888071">LstdFlags</span><span class="op" id="6888080">|</span><span class="ident" id="6888081">Lmicroseconds</span>&nbsp;<span class="op" id="6888095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6888099">t</span><span class="op" id="6888100">.</span><span class="ident" id="6888101">Errorf</span><span class="op" id="6888107">(</span><span class="string" id="6888108">&#34;Flags&nbsp;2:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="6888137">,</span>&nbsp;<span class="ident" id="6888139">LstdFlags</span><span class="op" id="6888148">|</span><span class="ident" id="6888149">Lmicroseconds</span><span class="op" id="6888162">,</span>&nbsp;<span class="ident" id="6888164">f</span><span class="op" id="6888165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6888168">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6888171">p</span>&nbsp;<span class="op" id="6888173">:=</span>&nbsp;<span class="ident" id="6888176">l</span><span class="op" id="6888177">.</span><span class="ident" id="6888178">Prefix</span><span class="op" id="6888184">(</span><span class="op" id="6888185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6888188">if</span>&nbsp;<span class="ident" id="6888191">p</span>&nbsp;<span class="op" id="6888193">!=</span>&nbsp;<span class="string" id="6888196">&#34;Test:&#34;</span>&nbsp;<span class="op" id="6888204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6888208">t</span><span class="op" id="6888209">.</span><span class="ident" id="6888210">Errorf</span><span class="op" id="6888216">(</span><span class="string" id="6888217">`Prefix:&nbsp;expected&nbsp;&#34;Test:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="6888250">,</span>&nbsp;<span class="ident" id="6888252">p</span><span class="op" id="6888253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6888256">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6888259">l</span><span class="op" id="6888260">.</span><span class="ident" id="6888261">SetPrefix</span><span class="op" id="6888270">(</span><span class="string" id="6888271">&#34;Reality:&#34;</span><span class="op" id="6888281">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6888284">p</span>&nbsp;<span class="op" id="6888286">=</span>&nbsp;<span class="ident" id="6888288">l</span><span class="op" id="6888289">.</span><span class="ident" id="6888290">Prefix</span><span class="op" id="6888296">(</span><span class="op" id="6888297">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6888300">if</span>&nbsp;<span class="ident" id="6888303">p</span>&nbsp;<span class="op" id="6888305">!=</span>&nbsp;<span class="string" id="6888308">&#34;Reality:&#34;</span>&nbsp;<span class="op" id="6888319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6888323">t</span><span class="op" id="6888324">.</span><span class="ident" id="6888325">Errorf</span><span class="op" id="6888331">(</span><span class="string" id="6888332">`Prefix:&nbsp;expected&nbsp;&#34;Reality:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="6888368">,</span>&nbsp;<span class="ident" id="6888370">p</span><span class="op" id="6888371">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6888374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6888377">//&nbsp;Verify&nbsp;a&nbsp;log&nbsp;message&nbsp;looks&nbsp;right,&nbsp;with&nbsp;our&nbsp;prefix&nbsp;and&nbsp;microseconds&nbsp;present.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6888457">l</span><span class="op" id="6888458">.</span><span class="ident" id="6888459">Print</span><span class="op" id="6888464">(</span><span class="string" id="6888465">&#34;hello&#34;</span><span class="op" id="6888472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6888475">pattern</span>&nbsp;<span class="op" id="6888483">:=</span>&nbsp;<span class="string" id="6888486">&#34;^Reality:&#34;</span>&nbsp;<span class="op" id="6888498">+</span>&nbsp;<span class="ident" id="6888500">Rdate</span>&nbsp;<span class="op" id="6888506">+</span>&nbsp;<span class="string" id="6888508">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6888512">+</span>&nbsp;<span class="ident" id="6888514">Rtime</span>&nbsp;<span class="op" id="6888520">+</span>&nbsp;<span class="ident" id="6888522">Rmicroseconds</span>&nbsp;<span class="op" id="6888536">+</span>&nbsp;<span class="string" id="6888538">&#34;&nbsp;hello\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6888550">matched</span><span class="op" id="6888557">,</span>&nbsp;<span class="ident" id="6888559">err</span>&nbsp;<span class="op" id="6888563">:=</span>&nbsp;<span class="ident" id="6888566">regexp</span><span class="op" id="6888572">.</span><span class="ident" id="6888573">Match</span><span class="op" id="6888578">(</span><span class="ident" id="6888579">pattern</span><span class="op" id="6888586">,</span>&nbsp;<span class="ident" id="6888588">b</span><span class="op" id="6888589">.</span><span class="ident" id="6888590">Bytes</span><span class="op" id="6888595">(</span><span class="op" id="6888596">)</span><span class="op" id="6888597">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6888600">if</span>&nbsp;<span class="ident" id="6888603">err</span>&nbsp;<span class="op" id="6888607">!=</span>&nbsp;<span class="ident" id="6888610">nil</span>&nbsp;<span class="op" id="6888614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6888618">t</span><span class="op" id="6888619">.</span><span class="ident" id="6888620">Fatalf</span><span class="op" id="6888626">(</span><span class="string" id="6888627">&#34;pattern&nbsp;%q&nbsp;did&nbsp;not&nbsp;compile:&nbsp;%s&#34;</span><span class="op" id="6888659">,</span>&nbsp;<span class="ident" id="6888661">pattern</span><span class="op" id="6888668">,</span>&nbsp;<span class="ident" id="6888670">err</span><span class="op" id="6888673">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6888676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6888679">if</span>&nbsp;<span class="op" id="6888682">!</span><span class="ident" id="6888683">matched</span>&nbsp;<span class="op" id="6888691">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6888695">t</span><span class="op" id="6888696">.</span><span class="ident" id="6888697">Error</span><span class="op" id="6888702">(</span><span class="string" id="6888703">&#34;message&nbsp;did&nbsp;not&nbsp;match&nbsp;pattern&#34;</span><span class="op" id="6888734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6888737">}</span><br>
<span class="lineno"></span><span class="op" id="6888739">}</span>
</div>
</body>
</html>
