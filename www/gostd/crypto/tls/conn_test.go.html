<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/tls</h2>
<ul>
<li><a href="/gostd/crypto/tls/alert.go.html">alert.go</a></li>
<li><a href="/gostd/crypto/tls/cipher_suites.go.html">cipher_suites.go</a></li>
<li><a href="/gostd/crypto/tls/common.go.html">common.go</a></li>
<li><a href="/gostd/crypto/tls/conn.go.html">conn.go</a></li>
<li><a href="/gostd/crypto/tls/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/crypto/tls/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client.go.html">handshake_client.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_client_test.go.html">handshake_client_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages.go.html">handshake_messages.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_messages_test.go.html">handshake_messages_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server.go.html">handshake_server.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_server_test.go.html">handshake_server_test.go</a></li>
<li><a href="/gostd/crypto/tls/handshake_test.go.html">handshake_test.go</a></li>
<li><a href="/gostd/crypto/tls/key_agreement.go.html">key_agreement.go</a></li>
<li><a href="/gostd/crypto/tls/prf.go.html">prf.go</a></li>
<li><a href="/gostd/crypto/tls/prf_test.go.html">prf_test.go</a></li>
<li><a href="/gostd/crypto/tls/ticket.go.html">ticket.go</a></li>
<li><a href="/gostd/crypto/tls/tls.go.html">tls.go</a></li>
<li><a href="/gostd/crypto/tls/tls_test.go.html">tls_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7164102">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7164157">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7164211">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7164262">package</span>&nbsp;<span class="ident" id="7164270">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7164275">import</span>&nbsp;<span class="op" id="7164282">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7164285">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7164295">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="7164298">func</span>&nbsp;<span class="ident" id="7164303">TestRoundUp</span><span class="op" id="7164314">(</span><span class="ident" id="7164315">t</span>&nbsp;<span class="op" id="7164317">*</span><span class="ident" id="7164318">testing</span><span class="op" id="7164325">.</span><span class="ident" id="7164326">T</span><span class="op" id="7164327">)</span>&nbsp;<span class="op" id="7164329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7164332">if</span>&nbsp;<span class="ident" id="7164335">roundUp</span><span class="op" id="7164342">(</span><span class="num" id="7164343">0</span><span class="op" id="7164344">,</span>&nbsp;<span class="num" id="7164346">16</span><span class="op" id="7164348">)</span>&nbsp;<span class="op" id="7164350">!=</span>&nbsp;<span class="num" id="7164353">0</span>&nbsp;<span class="op" id="7164355">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7164360">roundUp</span><span class="op" id="7164367">(</span><span class="num" id="7164368">1</span><span class="op" id="7164369">,</span>&nbsp;<span class="num" id="7164371">16</span><span class="op" id="7164373">)</span>&nbsp;<span class="op" id="7164375">!=</span>&nbsp;<span class="num" id="7164378">16</span>&nbsp;<span class="op" id="7164381">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7164386">roundUp</span><span class="op" id="7164393">(</span><span class="num" id="7164394">15</span><span class="op" id="7164396">,</span>&nbsp;<span class="num" id="7164398">16</span><span class="op" id="7164400">)</span>&nbsp;<span class="op" id="7164402">!=</span>&nbsp;<span class="num" id="7164405">16</span>&nbsp;<span class="op" id="7164408">||</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7164413">roundUp</span><span class="op" id="7164420">(</span><span class="num" id="7164421">16</span><span class="op" id="7164423">,</span>&nbsp;<span class="num" id="7164425">16</span><span class="op" id="7164427">)</span>&nbsp;<span class="op" id="7164429">!=</span>&nbsp;<span class="num" id="7164432">16</span>&nbsp;<span class="op" id="7164435">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7164440">roundUp</span><span class="op" id="7164447">(</span><span class="num" id="7164448">17</span><span class="op" id="7164450">,</span>&nbsp;<span class="num" id="7164452">16</span><span class="op" id="7164454">)</span>&nbsp;<span class="op" id="7164456">!=</span>&nbsp;<span class="num" id="7164459">32</span>&nbsp;<span class="op" id="7164462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7164466">t</span><span class="op" id="7164467">.</span><span class="ident" id="7164468">Error</span><span class="op" id="7164473">(</span><span class="string" id="7164474">&#34;roundUp&nbsp;broken&#34;</span><span class="op" id="7164490">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7164493">}</span><br>
<span class="lineno"></span><span class="op" id="7164495">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="7164498">var</span>&nbsp;<span class="ident" id="7164502">paddingTests</span>&nbsp;<span class="op" id="7164515">=</span>&nbsp;<span class="op" id="7164517">[</span><span class="op" id="7164518">]</span><span class="keyword" id="7164519">struct</span>&nbsp;<span class="op" id="7164526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7164529">in</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7164541">[</span><span class="op" id="7164542">]</span><span class="builtintype" id="7164543">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7164549">good</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7164561">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7164567">expectedLen</span>&nbsp;<span class="builtintype" id="7164579">int</span><br>
<span class="lineno">25</span><span class="op" id="7164583">}</span><span class="op" id="7164584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7164587">{</span><span class="op" id="7164588">[</span><span class="op" id="7164589">]</span><span class="builtintype" id="7164590">byte</span><span class="op" id="7164594">{</span><span class="num" id="7164595">1</span><span class="op" id="7164596">,</span>&nbsp;<span class="num" id="7164598">2</span><span class="op" id="7164599">,</span>&nbsp;<span class="num" id="7164601">3</span><span class="op" id="7164602">,</span>&nbsp;<span class="num" id="7164604">4</span><span class="op" id="7164605">,</span>&nbsp;<span class="num" id="7164607">0</span><span class="op" id="7164608">}</span><span class="op" id="7164609">,</span>&nbsp;<span class="builtintype" id="7164611">true</span><span class="op" id="7164615">,</span>&nbsp;<span class="num" id="7164617">4</span><span class="op" id="7164618">}</span><span class="op" id="7164619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7164622">{</span><span class="op" id="7164623">[</span><span class="op" id="7164624">]</span><span class="builtintype" id="7164625">byte</span><span class="op" id="7164629">{</span><span class="num" id="7164630">1</span><span class="op" id="7164631">,</span>&nbsp;<span class="num" id="7164633">2</span><span class="op" id="7164634">,</span>&nbsp;<span class="num" id="7164636">3</span><span class="op" id="7164637">,</span>&nbsp;<span class="num" id="7164639">4</span><span class="op" id="7164640">,</span>&nbsp;<span class="num" id="7164642">0</span><span class="op" id="7164643">,</span>&nbsp;<span class="num" id="7164645">1</span><span class="op" id="7164646">}</span><span class="op" id="7164647">,</span>&nbsp;<span class="builtintype" id="7164649">false</span><span class="op" id="7164654">,</span>&nbsp;<span class="num" id="7164656">0</span><span class="op" id="7164657">}</span><span class="op" id="7164658">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7164661">{</span><span class="op" id="7164662">[</span><span class="op" id="7164663">]</span><span class="builtintype" id="7164664">byte</span><span class="op" id="7164668">{</span><span class="num" id="7164669">1</span><span class="op" id="7164670">,</span>&nbsp;<span class="num" id="7164672">2</span><span class="op" id="7164673">,</span>&nbsp;<span class="num" id="7164675">3</span><span class="op" id="7164676">,</span>&nbsp;<span class="num" id="7164678">4</span><span class="op" id="7164679">,</span>&nbsp;<span class="num" id="7164681">99</span><span class="op" id="7164683">,</span>&nbsp;<span class="num" id="7164685">99</span><span class="op" id="7164687">}</span><span class="op" id="7164688">,</span>&nbsp;<span class="builtintype" id="7164690">false</span><span class="op" id="7164695">,</span>&nbsp;<span class="num" id="7164697">0</span><span class="op" id="7164698">}</span><span class="op" id="7164699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7164702">{</span><span class="op" id="7164703">[</span><span class="op" id="7164704">]</span><span class="builtintype" id="7164705">byte</span><span class="op" id="7164709">{</span><span class="num" id="7164710">1</span><span class="op" id="7164711">,</span>&nbsp;<span class="num" id="7164713">2</span><span class="op" id="7164714">,</span>&nbsp;<span class="num" id="7164716">3</span><span class="op" id="7164717">,</span>&nbsp;<span class="num" id="7164719">4</span><span class="op" id="7164720">,</span>&nbsp;<span class="num" id="7164722">1</span><span class="op" id="7164723">,</span>&nbsp;<span class="num" id="7164725">1</span><span class="op" id="7164726">}</span><span class="op" id="7164727">,</span>&nbsp;<span class="builtintype" id="7164729">true</span><span class="op" id="7164733">,</span>&nbsp;<span class="num" id="7164735">4</span><span class="op" id="7164736">}</span><span class="op" id="7164737">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7164740">{</span><span class="op" id="7164741">[</span><span class="op" id="7164742">]</span><span class="builtintype" id="7164743">byte</span><span class="op" id="7164747">{</span><span class="num" id="7164748">1</span><span class="op" id="7164749">,</span>&nbsp;<span class="num" id="7164751">2</span><span class="op" id="7164752">,</span>&nbsp;<span class="num" id="7164754">3</span><span class="op" id="7164755">,</span>&nbsp;<span class="num" id="7164757">2</span><span class="op" id="7164758">,</span>&nbsp;<span class="num" id="7164760">2</span><span class="op" id="7164761">,</span>&nbsp;<span class="num" id="7164763">2</span><span class="op" id="7164764">}</span><span class="op" id="7164765">,</span>&nbsp;<span class="builtintype" id="7164767">true</span><span class="op" id="7164771">,</span>&nbsp;<span class="num" id="7164773">3</span><span class="op" id="7164774">}</span><span class="op" id="7164775">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7164778">{</span><span class="op" id="7164779">[</span><span class="op" id="7164780">]</span><span class="builtintype" id="7164781">byte</span><span class="op" id="7164785">{</span><span class="num" id="7164786">1</span><span class="op" id="7164787">,</span>&nbsp;<span class="num" id="7164789">2</span><span class="op" id="7164790">,</span>&nbsp;<span class="num" id="7164792">3</span><span class="op" id="7164793">,</span>&nbsp;<span class="num" id="7164795">3</span><span class="op" id="7164796">,</span>&nbsp;<span class="num" id="7164798">3</span><span class="op" id="7164799">,</span>&nbsp;<span class="num" id="7164801">3</span><span class="op" id="7164802">}</span><span class="op" id="7164803">,</span>&nbsp;<span class="builtintype" id="7164805">true</span><span class="op" id="7164809">,</span>&nbsp;<span class="num" id="7164811">2</span><span class="op" id="7164812">}</span><span class="op" id="7164813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7164816">{</span><span class="op" id="7164817">[</span><span class="op" id="7164818">]</span><span class="builtintype" id="7164819">byte</span><span class="op" id="7164823">{</span><span class="num" id="7164824">1</span><span class="op" id="7164825">,</span>&nbsp;<span class="num" id="7164827">2</span><span class="op" id="7164828">,</span>&nbsp;<span class="num" id="7164830">3</span><span class="op" id="7164831">,</span>&nbsp;<span class="num" id="7164833">4</span><span class="op" id="7164834">,</span>&nbsp;<span class="num" id="7164836">3</span><span class="op" id="7164837">,</span>&nbsp;<span class="num" id="7164839">3</span><span class="op" id="7164840">}</span><span class="op" id="7164841">,</span>&nbsp;<span class="builtintype" id="7164843">false</span><span class="op" id="7164848">,</span>&nbsp;<span class="num" id="7164850">0</span><span class="op" id="7164851">}</span><span class="op" id="7164852">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7164855">{</span><span class="op" id="7164856">[</span><span class="op" id="7164857">]</span><span class="builtintype" id="7164858">byte</span><span class="op" id="7164862">{</span><span class="num" id="7164863">1</span><span class="op" id="7164864">,</span>&nbsp;<span class="num" id="7164866">4</span><span class="op" id="7164867">,</span>&nbsp;<span class="num" id="7164869">4</span><span class="op" id="7164870">,</span>&nbsp;<span class="num" id="7164872">4</span><span class="op" id="7164873">,</span>&nbsp;<span class="num" id="7164875">4</span><span class="op" id="7164876">,</span>&nbsp;<span class="num" id="7164878">4</span><span class="op" id="7164879">}</span><span class="op" id="7164880">,</span>&nbsp;<span class="builtintype" id="7164882">true</span><span class="op" id="7164886">,</span>&nbsp;<span class="num" id="7164888">1</span><span class="op" id="7164889">}</span><span class="op" id="7164890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7164893">{</span><span class="op" id="7164894">[</span><span class="op" id="7164895">]</span><span class="builtintype" id="7164896">byte</span><span class="op" id="7164900">{</span><span class="num" id="7164901">5</span><span class="op" id="7164902">,</span>&nbsp;<span class="num" id="7164904">5</span><span class="op" id="7164905">,</span>&nbsp;<span class="num" id="7164907">5</span><span class="op" id="7164908">,</span>&nbsp;<span class="num" id="7164910">5</span><span class="op" id="7164911">,</span>&nbsp;<span class="num" id="7164913">5</span><span class="op" id="7164914">,</span>&nbsp;<span class="num" id="7164916">5</span><span class="op" id="7164917">}</span><span class="op" id="7164918">,</span>&nbsp;<span class="builtintype" id="7164920">true</span><span class="op" id="7164924">,</span>&nbsp;<span class="num" id="7164926">0</span><span class="op" id="7164927">}</span><span class="op" id="7164928">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7164931">{</span><span class="op" id="7164932">[</span><span class="op" id="7164933">]</span><span class="builtintype" id="7164934">byte</span><span class="op" id="7164938">{</span><span class="num" id="7164939">6</span><span class="op" id="7164940">,</span>&nbsp;<span class="num" id="7164942">6</span><span class="op" id="7164943">,</span>&nbsp;<span class="num" id="7164945">6</span><span class="op" id="7164946">,</span>&nbsp;<span class="num" id="7164948">6</span><span class="op" id="7164949">,</span>&nbsp;<span class="num" id="7164951">6</span><span class="op" id="7164952">,</span>&nbsp;<span class="num" id="7164954">6</span><span class="op" id="7164955">}</span><span class="op" id="7164956">,</span>&nbsp;<span class="builtintype" id="7164958">false</span><span class="op" id="7164963">,</span>&nbsp;<span class="num" id="7164965">0</span><span class="op" id="7164966">}</span><span class="op" id="7164967">,</span><br>
<span class="lineno"></span><span class="op" id="7164969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7164972">func</span>&nbsp;<span class="ident" id="7164977">TestRemovePadding</span><span class="op" id="7164994">(</span><span class="ident" id="7164995">t</span>&nbsp;<span class="op" id="7164997">*</span><span class="ident" id="7164998">testing</span><span class="op" id="7165005">.</span><span class="ident" id="7165006">T</span><span class="op" id="7165007">)</span>&nbsp;<span class="op" id="7165009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7165012">for</span>&nbsp;<span class="ident" id="7165016">i</span><span class="op" id="7165017">,</span>&nbsp;<span class="ident" id="7165019">test</span>&nbsp;<span class="op" id="7165024">:=</span>&nbsp;<span class="keyword" id="7165027">range</span>&nbsp;<span class="ident" id="7165033">paddingTests</span>&nbsp;<span class="op" id="7165046">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7165050">payload</span><span class="op" id="7165057">,</span>&nbsp;<span class="ident" id="7165059">good</span>&nbsp;<span class="op" id="7165064">:=</span>&nbsp;<span class="ident" id="7165067">removePadding</span><span class="op" id="7165080">(</span><span class="ident" id="7165081">test</span><span class="op" id="7165085">.</span><span class="ident" id="7165086">in</span><span class="op" id="7165088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7165092">expectedGood</span>&nbsp;<span class="op" id="7165105">:=</span>&nbsp;<span class="builtintype" id="7165108">byte</span><span class="op" id="7165112">(</span><span class="num" id="7165113">255</span><span class="op" id="7165116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7165120">if</span>&nbsp;<span class="op" id="7165123">!</span><span class="ident" id="7165124">test</span><span class="op" id="7165128">.</span><span class="ident" id="7165129">good</span>&nbsp;<span class="op" id="7165134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7165139">expectedGood</span>&nbsp;<span class="op" id="7165152">=</span>&nbsp;<span class="num" id="7165154">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7165158">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7165162">if</span>&nbsp;<span class="ident" id="7165165">good</span>&nbsp;<span class="op" id="7165170">!=</span>&nbsp;<span class="ident" id="7165173">expectedGood</span>&nbsp;<span class="op" id="7165186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7165191">t</span><span class="op" id="7165192">.</span><span class="ident" id="7165193">Errorf</span><span class="op" id="7165199">(</span><span class="string" id="7165200">&#34;#%d:&nbsp;wrong&nbsp;validity,&nbsp;want:%d&nbsp;got:%d&#34;</span><span class="op" id="7165237">,</span>&nbsp;<span class="ident" id="7165239">i</span><span class="op" id="7165240">,</span>&nbsp;<span class="ident" id="7165242">expectedGood</span><span class="op" id="7165254">,</span>&nbsp;<span class="ident" id="7165256">good</span><span class="op" id="7165260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7165264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7165268">if</span>&nbsp;<span class="ident" id="7165271">good</span>&nbsp;<span class="op" id="7165276">==</span>&nbsp;<span class="num" id="7165279">255</span>&nbsp;<span class="op" id="7165283">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="7165286">len</span><span class="op" id="7165289">(</span><span class="ident" id="7165290">payload</span><span class="op" id="7165297">)</span>&nbsp;<span class="op" id="7165299">!=</span>&nbsp;<span class="ident" id="7165302">test</span><span class="op" id="7165306">.</span><span class="ident" id="7165307">expectedLen</span>&nbsp;<span class="op" id="7165319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7165324">t</span><span class="op" id="7165325">.</span><span class="ident" id="7165326">Errorf</span><span class="op" id="7165332">(</span><span class="string" id="7165333">&#34;#%d:&nbsp;got&nbsp;%d,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7165355">,</span>&nbsp;<span class="ident" id="7165357">i</span><span class="op" id="7165358">,</span>&nbsp;<span class="builtinfunc" id="7165360">len</span><span class="op" id="7165363">(</span><span class="ident" id="7165364">payload</span><span class="op" id="7165371">)</span><span class="op" id="7165372">,</span>&nbsp;<span class="ident" id="7165374">test</span><span class="op" id="7165378">.</span><span class="ident" id="7165379">expectedLen</span><span class="op" id="7165390">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7165394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7165397">}</span><br>
<span class="lineno"></span><span class="op" id="7165399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7165402">var</span>&nbsp;<span class="ident" id="7165406">certExampleCom</span>&nbsp;<span class="op" id="7165421">=</span>&nbsp;<span class="string" id="7165423">`308201403081eda003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313138353835325a170d3132303933303138353835325a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31a301830160603551d11040f300d820b6578616d706c652e636f6d300b06092a864886f70d0101050341001a0b419d2c74474c6450654e5f10b32bf426ffdf55cad1c52602e7a9151513a3424c70f5960dcd682db0c33769cc1daa3fcdd3db10809d2392ed4a1bf50ced18`</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="keyword" id="7166075">var</span>&nbsp;<span class="ident" id="7166079">certWildcardExampleCom</span>&nbsp;<span class="op" id="7166102">=</span>&nbsp;<span class="string" id="7166104">`308201423081efa003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303034365a170d3132303933303139303034365a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31c301a30180603551d110411300f820d2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001676f0c9e7c33c1b656ed5a6476c4e2ee9ec8e62df7407accb1875272b2edd0a22096cb2c22598d11604104d604f810eb4b5987ca6bb319c7e6ce48725c54059`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7166760">var</span>&nbsp;<span class="ident" id="7166764">certFooExampleCom</span>&nbsp;<span class="op" id="7166782">=</span>&nbsp;<span class="string" id="7166784">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303131345a170d3132303933303139303131345a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f666f6f2e6578616d706c652e636f6d300b06092a864886f70d010105034100646a2a51f2aa2477add854b462cf5207ba16d3213ffb5d3d0eed473fbf09935019192d1d5b8ca6a2407b424cf04d97c4cd9197c83ecf81f0eab9464a1109d09f`</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="keyword" id="7167444">var</span>&nbsp;<span class="ident" id="7167448">certDoubleWildcardExampleCom</span>&nbsp;<span class="op" id="7167477">=</span>&nbsp;<span class="string" id="7167479">`308201443081f1a003020102020101300b06092a864886f70d010105301e311c301a060355040a131354657374696e67204365727469666963617465301e170d3131313030313139303134315a170d3132303933303139303134315a301e311c301a060355040a131354657374696e67204365727469666963617465305a300b06092a864886f70d010101034b003048024100bced6e32368599eeddf18796bfd03958a154f87e5b084f96e85136a56b886733592f493f0fc68b0d6b3551781cb95e13c5de458b28d6fb60d20a9129313261410203010001a31e301c301a0603551d1104133011820f2a2e2a2e6578616d706c652e636f6d300b06092a864886f70d0101050341001c3de267975f56ef57771c6218ef95ecc65102e57bd1defe6f7efea90d9b26cf40de5bd7ad75e46201c7f2a92aaa3e907451e9409f65e28ddb6db80d726290f6`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7168139">func</span>&nbsp;<span class="ident" id="7168144">TestCertificateSelection</span><span class="op" id="7168168">(</span><span class="ident" id="7168169">t</span>&nbsp;<span class="op" id="7168171">*</span><span class="ident" id="7168172">testing</span><span class="op" id="7168179">.</span><span class="ident" id="7168180">T</span><span class="op" id="7168181">)</span>&nbsp;<span class="op" id="7168183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7168186">config</span>&nbsp;<span class="op" id="7168193">:=</span>&nbsp;<span class="ident" id="7168196">Config</span><span class="op" id="7168202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7168206">Certificates</span><span class="op" id="7168218">:</span>&nbsp;<span class="op" id="7168220">[</span><span class="op" id="7168221">]</span><span class="ident" id="7168222">Certificate</span><span class="op" id="7168233">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7168238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7168244">Certificate</span><span class="op" id="7168255">:</span>&nbsp;<span class="op" id="7168257">[</span><span class="op" id="7168258">]</span><span class="op" id="7168259">[</span><span class="op" id="7168260">]</span><span class="builtintype" id="7168261">byte</span><span class="op" id="7168265">{</span><span class="ident" id="7168266">fromHex</span><span class="op" id="7168273">(</span><span class="ident" id="7168274">certExampleCom</span><span class="op" id="7168288">)</span><span class="op" id="7168289">}</span><span class="op" id="7168290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7168295">}</span><span class="op" id="7168296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7168301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7168307">Certificate</span><span class="op" id="7168318">:</span>&nbsp;<span class="op" id="7168320">[</span><span class="op" id="7168321">]</span><span class="op" id="7168322">[</span><span class="op" id="7168323">]</span><span class="builtintype" id="7168324">byte</span><span class="op" id="7168328">{</span><span class="ident" id="7168329">fromHex</span><span class="op" id="7168336">(</span><span class="ident" id="7168337">certWildcardExampleCom</span><span class="op" id="7168359">)</span><span class="op" id="7168360">}</span><span class="op" id="7168361">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7168366">}</span><span class="op" id="7168367">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7168372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7168378">Certificate</span><span class="op" id="7168389">:</span>&nbsp;<span class="op" id="7168391">[</span><span class="op" id="7168392">]</span><span class="op" id="7168393">[</span><span class="op" id="7168394">]</span><span class="builtintype" id="7168395">byte</span><span class="op" id="7168399">{</span><span class="ident" id="7168400">fromHex</span><span class="op" id="7168407">(</span><span class="ident" id="7168408">certFooExampleCom</span><span class="op" id="7168425">)</span><span class="op" id="7168426">}</span><span class="op" id="7168427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7168432">}</span><span class="op" id="7168433">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7168438">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7168444">Certificate</span><span class="op" id="7168455">:</span>&nbsp;<span class="op" id="7168457">[</span><span class="op" id="7168458">]</span><span class="op" id="7168459">[</span><span class="op" id="7168460">]</span><span class="builtintype" id="7168461">byte</span><span class="op" id="7168465">{</span><span class="ident" id="7168466">fromHex</span><span class="op" id="7168473">(</span><span class="ident" id="7168474">certDoubleWildcardExampleCom</span><span class="op" id="7168502">)</span><span class="op" id="7168503">}</span><span class="op" id="7168504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7168509">}</span><span class="op" id="7168510">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7168514">}</span><span class="op" id="7168515">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7168518">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7168522">config</span><span class="op" id="7168528">.</span><span class="ident" id="7168529">BuildNameToCertificate</span><span class="op" id="7168551">(</span><span class="op" id="7168552">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7168556">pointerToIndex</span>&nbsp;<span class="op" id="7168571">:=</span>&nbsp;<span class="keyword" id="7168574">func</span><span class="op" id="7168578">(</span><span class="ident" id="7168579">c</span>&nbsp;<span class="op" id="7168581">*</span><span class="ident" id="7168582">Certificate</span><span class="op" id="7168593">)</span>&nbsp;<span class="builtintype" id="7168595">int</span>&nbsp;<span class="op" id="7168599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7168603">for</span>&nbsp;<span class="ident" id="7168607">i</span>&nbsp;<span class="op" id="7168609">:=</span>&nbsp;<span class="keyword" id="7168612">range</span>&nbsp;<span class="ident" id="7168618">config</span><span class="op" id="7168624">.</span><span class="ident" id="7168625">Certificates</span>&nbsp;<span class="op" id="7168638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7168643">if</span>&nbsp;<span class="ident" id="7168646">c</span>&nbsp;<span class="op" id="7168648">==</span>&nbsp;<span class="op" id="7168651">&amp;</span><span class="ident" id="7168652">config</span><span class="op" id="7168658">.</span><span class="ident" id="7168659">Certificates</span><span class="op" id="7168671">[</span><span class="ident" id="7168672">i</span><span class="op" id="7168673">]</span>&nbsp;<span class="op" id="7168675">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7168681">return</span>&nbsp;<span class="ident" id="7168688">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7168693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7168697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7168701">return</span>&nbsp;<span class="op" id="7168708">-</span><span class="num" id="7168709">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7168712">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7168716">certificateForName</span>&nbsp;<span class="op" id="7168735">:=</span>&nbsp;<span class="keyword" id="7168738">func</span><span class="op" id="7168742">(</span><span class="ident" id="7168743">name</span>&nbsp;<span class="builtintype" id="7168748">string</span><span class="op" id="7168754">)</span>&nbsp;<span class="op" id="7168756">*</span><span class="ident" id="7168757">Certificate</span>&nbsp;<span class="op" id="7168769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7168773">clientHello</span>&nbsp;<span class="op" id="7168785">:=</span>&nbsp;<span class="op" id="7168788">&amp;</span><span class="ident" id="7168789">ClientHelloInfo</span><span class="op" id="7168804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7168809">ServerName</span><span class="op" id="7168819">:</span>&nbsp;<span class="ident" id="7168821">name</span><span class="op" id="7168825">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7168829">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7168833">if</span>&nbsp;<span class="ident" id="7168836">cert</span><span class="op" id="7168840">,</span>&nbsp;<span class="ident" id="7168842">err</span>&nbsp;<span class="op" id="7168846">:=</span>&nbsp;<span class="ident" id="7168849">config</span><span class="op" id="7168855">.</span><span class="ident" id="7168856">getCertificate</span><span class="op" id="7168870">(</span><span class="ident" id="7168871">clientHello</span><span class="op" id="7168882">)</span><span class="op" id="7168883">;</span>&nbsp;<span class="ident" id="7168885">err</span>&nbsp;<span class="op" id="7168889">!=</span>&nbsp;<span class="ident" id="7168892">nil</span>&nbsp;<span class="op" id="7168896">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7168901">t</span><span class="op" id="7168902">.</span><span class="ident" id="7168903">Errorf</span><span class="op" id="7168909">(</span><span class="string" id="7168910">&#34;unable&nbsp;to&nbsp;get&nbsp;certificate&nbsp;for&nbsp;name&nbsp;&#39;%s&#39;:&nbsp;%s&#34;</span><span class="op" id="7168955">,</span>&nbsp;<span class="ident" id="7168957">name</span><span class="op" id="7168961">,</span>&nbsp;<span class="ident" id="7168963">err</span><span class="op" id="7168966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7168971">return</span>&nbsp;<span class="ident" id="7168978">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7168984">}</span>&nbsp;<span class="keyword" id="7168986">else</span>&nbsp;<span class="op" id="7168991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7168996">return</span>&nbsp;<span class="ident" id="7169003">cert</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7169010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7169013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7169017">if</span>&nbsp;<span class="ident" id="7169020">n</span>&nbsp;<span class="op" id="7169022">:=</span>&nbsp;<span class="ident" id="7169025">pointerToIndex</span><span class="op" id="7169039">(</span><span class="ident" id="7169040">certificateForName</span><span class="op" id="7169058">(</span><span class="string" id="7169059">&#34;example.com&#34;</span><span class="op" id="7169072">)</span><span class="op" id="7169073">)</span><span class="op" id="7169074">;</span>&nbsp;<span class="ident" id="7169076">n</span>&nbsp;<span class="op" id="7169078">!=</span>&nbsp;<span class="num" id="7169081">0</span>&nbsp;<span class="op" id="7169083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7169087">t</span><span class="op" id="7169088">.</span><span class="ident" id="7169089">Errorf</span><span class="op" id="7169095">(</span><span class="string" id="7169096">&#34;example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="7169140">,</span>&nbsp;<span class="ident" id="7169142">n</span><span class="op" id="7169143">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7169146">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7169149">if</span>&nbsp;<span class="ident" id="7169152">n</span>&nbsp;<span class="op" id="7169154">:=</span>&nbsp;<span class="ident" id="7169157">pointerToIndex</span><span class="op" id="7169171">(</span><span class="ident" id="7169172">certificateForName</span><span class="op" id="7169190">(</span><span class="string" id="7169191">&#34;bar.example.com&#34;</span><span class="op" id="7169208">)</span><span class="op" id="7169209">)</span><span class="op" id="7169210">;</span>&nbsp;<span class="ident" id="7169212">n</span>&nbsp;<span class="op" id="7169214">!=</span>&nbsp;<span class="num" id="7169217">1</span>&nbsp;<span class="op" id="7169219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7169223">t</span><span class="op" id="7169224">.</span><span class="ident" id="7169225">Errorf</span><span class="op" id="7169231">(</span><span class="string" id="7169232">&#34;bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;1&#34;</span><span class="op" id="7169280">,</span>&nbsp;<span class="ident" id="7169282">n</span><span class="op" id="7169283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7169286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7169289">if</span>&nbsp;<span class="ident" id="7169292">n</span>&nbsp;<span class="op" id="7169294">:=</span>&nbsp;<span class="ident" id="7169297">pointerToIndex</span><span class="op" id="7169311">(</span><span class="ident" id="7169312">certificateForName</span><span class="op" id="7169330">(</span><span class="string" id="7169331">&#34;foo.example.com&#34;</span><span class="op" id="7169348">)</span><span class="op" id="7169349">)</span><span class="op" id="7169350">;</span>&nbsp;<span class="ident" id="7169352">n</span>&nbsp;<span class="op" id="7169354">!=</span>&nbsp;<span class="num" id="7169357">2</span>&nbsp;<span class="op" id="7169359">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7169363">t</span><span class="op" id="7169364">.</span><span class="ident" id="7169365">Errorf</span><span class="op" id="7169371">(</span><span class="string" id="7169372">&#34;foo.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;2&#34;</span><span class="op" id="7169420">,</span>&nbsp;<span class="ident" id="7169422">n</span><span class="op" id="7169423">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7169426">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7169429">if</span>&nbsp;<span class="ident" id="7169432">n</span>&nbsp;<span class="op" id="7169434">:=</span>&nbsp;<span class="ident" id="7169437">pointerToIndex</span><span class="op" id="7169451">(</span><span class="ident" id="7169452">certificateForName</span><span class="op" id="7169470">(</span><span class="string" id="7169471">&#34;foo.bar.example.com&#34;</span><span class="op" id="7169492">)</span><span class="op" id="7169493">)</span><span class="op" id="7169494">;</span>&nbsp;<span class="ident" id="7169496">n</span>&nbsp;<span class="op" id="7169498">!=</span>&nbsp;<span class="num" id="7169501">3</span>&nbsp;<span class="op" id="7169503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7169507">t</span><span class="op" id="7169508">.</span><span class="ident" id="7169509">Errorf</span><span class="op" id="7169515">(</span><span class="string" id="7169516">&#34;foo.bar.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;3&#34;</span><span class="op" id="7169568">,</span>&nbsp;<span class="ident" id="7169570">n</span><span class="op" id="7169571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7169574">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7169577">if</span>&nbsp;<span class="ident" id="7169580">n</span>&nbsp;<span class="op" id="7169582">:=</span>&nbsp;<span class="ident" id="7169585">pointerToIndex</span><span class="op" id="7169599">(</span><span class="ident" id="7169600">certificateForName</span><span class="op" id="7169618">(</span><span class="string" id="7169619">&#34;foo.bar.baz.example.com&#34;</span><span class="op" id="7169644">)</span><span class="op" id="7169645">)</span><span class="op" id="7169646">;</span>&nbsp;<span class="ident" id="7169648">n</span>&nbsp;<span class="op" id="7169650">!=</span>&nbsp;<span class="num" id="7169653">0</span>&nbsp;<span class="op" id="7169655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7169659">t</span><span class="op" id="7169660">.</span><span class="ident" id="7169661">Errorf</span><span class="op" id="7169667">(</span><span class="string" id="7169668">&#34;foo.bar.baz.example.com&nbsp;returned&nbsp;certificate&nbsp;%d,&nbsp;not&nbsp;0&#34;</span><span class="op" id="7169724">,</span>&nbsp;<span class="ident" id="7169726">n</span><span class="op" id="7169727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7169730">}</span><br>
<span class="lineno"></span><span class="op" id="7169732">}</span>
</div>
</body>
</html>
