<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>mime</h2>
<ul>
<li><a href="/gostd/mime/grammar.go.html">grammar.go</a></li>
<li><a href="/gostd/mime/mediatype.go.html">mediatype.go</a></li>
<li><a href="/gostd/mime/mediatype_test.go.html">mediatype_test.go</a></li>
<li><a href="/gostd/mime/type.go.html">type.go</a></li>
<li><a href="/gostd/mime/type_test.go.html" class="current">type_test.go</a></li>
<li><a href="/gostd/mime/type_unix.go.html">type_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7343484">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7343539">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7343593">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7343644">package</span>&nbsp;<span class="ident" id="7343652">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7343658">import</span>&nbsp;<span class="op" id="7343665">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7343668">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7343678">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="7343681">var</span>&nbsp;<span class="ident" id="7343685">typeTests</span>&nbsp;<span class="op" id="7343695">=</span>&nbsp;<span class="ident" id="7343697">initMimeForTests</span><span class="op" id="7343713">(</span><span class="op" id="7343714">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7343717">func</span>&nbsp;<span class="ident" id="7343722">TestTypeByExtension</span><span class="op" id="7343741">(</span><span class="ident" id="7343742">t</span>&nbsp;<span class="op" id="7343744">*</span><span class="ident" id="7343745">testing</span><span class="op" id="7343752">.</span><span class="ident" id="7343753">T</span><span class="op" id="7343754">)</span>&nbsp;<span class="op" id="7343756">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7343759">for</span>&nbsp;<span class="ident" id="7343763">ext</span><span class="op" id="7343766">,</span>&nbsp;<span class="ident" id="7343768">want</span>&nbsp;<span class="op" id="7343773">:=</span>&nbsp;<span class="keyword" id="7343776">range</span>&nbsp;<span class="ident" id="7343782">typeTests</span>&nbsp;<span class="op" id="7343792">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7343796">val</span>&nbsp;<span class="op" id="7343800">:=</span>&nbsp;<span class="ident" id="7343803">TypeByExtension</span><span class="op" id="7343818">(</span><span class="ident" id="7343819">ext</span><span class="op" id="7343822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7343826">if</span>&nbsp;<span class="ident" id="7343829">val</span>&nbsp;<span class="op" id="7343833">!=</span>&nbsp;<span class="ident" id="7343836">want</span>&nbsp;<span class="op" id="7343841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7343846">t</span><span class="op" id="7343847">.</span><span class="ident" id="7343848">Errorf</span><span class="op" id="7343854">(</span><span class="string" id="7343855">&#34;TypeByExtension(%q)&nbsp;=&nbsp;%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7343890">,</span>&nbsp;<span class="ident" id="7343892">ext</span><span class="op" id="7343895">,</span>&nbsp;<span class="ident" id="7343897">val</span><span class="op" id="7343900">,</span>&nbsp;<span class="ident" id="7343902">want</span><span class="op" id="7343906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7343910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7343913">}</span><br>
<span class="lineno">20</span><span class="op" id="7343915">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7343918">func</span>&nbsp;<span class="ident" id="7343923">TestTypeByExtensionCase</span><span class="op" id="7343946">(</span><span class="ident" id="7343947">t</span>&nbsp;<span class="op" id="7343949">*</span><span class="ident" id="7343950">testing</span><span class="op" id="7343957">.</span><span class="ident" id="7343958">T</span><span class="op" id="7343959">)</span>&nbsp;<span class="op" id="7343961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7343964">const</span>&nbsp;<span class="ident" id="7343970">custom</span>&nbsp;<span class="op" id="7343977">=</span>&nbsp;<span class="string" id="7343979">&#34;test/test;&nbsp;charset=iso-8859-1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7344012">const</span>&nbsp;<span class="ident" id="7344018">caps</span>&nbsp;<span class="op" id="7344023">=</span>&nbsp;<span class="string" id="7344025">&#34;test/test;&nbsp;WAS=ALLCAPS&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7344051">if</span>&nbsp;<span class="ident" id="7344054">err</span>&nbsp;<span class="op" id="7344058">:=</span>&nbsp;<span class="ident" id="7344061">AddExtensionType</span><span class="op" id="7344077">(</span><span class="string" id="7344078">&#34;.TEST&#34;</span><span class="op" id="7344085">,</span>&nbsp;<span class="ident" id="7344087">caps</span><span class="op" id="7344091">)</span><span class="op" id="7344092">;</span>&nbsp;<span class="ident" id="7344094">err</span>&nbsp;<span class="op" id="7344098">!=</span>&nbsp;<span class="builtintype" id="7344101">nil</span>&nbsp;<span class="op" id="7344105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7344109">t</span><span class="op" id="7344110">.</span><span class="ident" id="7344111">Fatalf</span><span class="op" id="7344117">(</span><span class="string" id="7344118">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="7344149">,</span>&nbsp;<span class="ident" id="7344151">err</span><span class="op" id="7344154">,</span>&nbsp;<span class="ident" id="7344156">custom</span><span class="op" id="7344162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7344165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7344168">if</span>&nbsp;<span class="ident" id="7344171">err</span>&nbsp;<span class="op" id="7344175">:=</span>&nbsp;<span class="ident" id="7344178">AddExtensionType</span><span class="op" id="7344194">(</span><span class="string" id="7344195">&#34;.tesT&#34;</span><span class="op" id="7344202">,</span>&nbsp;<span class="ident" id="7344204">custom</span><span class="op" id="7344210">)</span><span class="op" id="7344211">;</span>&nbsp;<span class="ident" id="7344213">err</span>&nbsp;<span class="op" id="7344217">!=</span>&nbsp;<span class="builtintype" id="7344220">nil</span>&nbsp;<span class="op" id="7344224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7344228">t</span><span class="op" id="7344229">.</span><span class="ident" id="7344230">Fatalf</span><span class="op" id="7344236">(</span><span class="string" id="7344237">&#34;error&nbsp;%s&nbsp;for&nbsp;AddExtension(%s)&#34;</span><span class="op" id="7344268">,</span>&nbsp;<span class="ident" id="7344270">err</span><span class="op" id="7344273">,</span>&nbsp;<span class="ident" id="7344275">custom</span><span class="op" id="7344281">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7344284">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7344288">//&nbsp;case-sensitive&nbsp;lookup</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7344314">if</span>&nbsp;<span class="ident" id="7344317">got</span>&nbsp;<span class="op" id="7344321">:=</span>&nbsp;<span class="ident" id="7344324">TypeByExtension</span><span class="op" id="7344339">(</span><span class="string" id="7344340">&#34;.tesT&#34;</span><span class="op" id="7344347">)</span><span class="op" id="7344348">;</span>&nbsp;<span class="ident" id="7344350">got</span>&nbsp;<span class="op" id="7344354">!=</span>&nbsp;<span class="ident" id="7344357">custom</span>&nbsp;<span class="op" id="7344364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7344368">t</span><span class="op" id="7344369">.</span><span class="ident" id="7344370">Fatalf</span><span class="op" id="7344376">(</span><span class="string" id="7344377">&#34;for&nbsp;.tesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7344405">,</span>&nbsp;<span class="ident" id="7344407">got</span><span class="op" id="7344410">,</span>&nbsp;<span class="ident" id="7344412">custom</span><span class="op" id="7344418">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7344421">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7344424">if</span>&nbsp;<span class="ident" id="7344427">got</span>&nbsp;<span class="op" id="7344431">:=</span>&nbsp;<span class="ident" id="7344434">TypeByExtension</span><span class="op" id="7344449">(</span><span class="string" id="7344450">&#34;.TEST&#34;</span><span class="op" id="7344457">)</span><span class="op" id="7344458">;</span>&nbsp;<span class="ident" id="7344460">got</span>&nbsp;<span class="op" id="7344464">!=</span>&nbsp;<span class="ident" id="7344467">caps</span>&nbsp;<span class="op" id="7344472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7344476">t</span><span class="op" id="7344477">.</span><span class="ident" id="7344478">Fatalf</span><span class="op" id="7344484">(</span><span class="string" id="7344485">&#34;for&nbsp;.TEST,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%s&#34;</span><span class="op" id="7344513">,</span>&nbsp;<span class="ident" id="7344515">got</span><span class="op" id="7344518">,</span>&nbsp;<span class="ident" id="7344520">caps</span><span class="op" id="7344524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7344527">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7344531">//&nbsp;case-insensitive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7344552">if</span>&nbsp;<span class="ident" id="7344555">got</span>&nbsp;<span class="op" id="7344559">:=</span>&nbsp;<span class="ident" id="7344562">TypeByExtension</span><span class="op" id="7344577">(</span><span class="string" id="7344578">&#34;.TesT&#34;</span><span class="op" id="7344585">)</span><span class="op" id="7344586">;</span>&nbsp;<span class="ident" id="7344588">got</span>&nbsp;<span class="op" id="7344592">!=</span>&nbsp;<span class="ident" id="7344595">custom</span>&nbsp;<span class="op" id="7344602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7344606">t</span><span class="op" id="7344607">.</span><span class="ident" id="7344608">Fatalf</span><span class="op" id="7344614">(</span><span class="string" id="7344615">&#34;for&nbsp;.TesT,&nbsp;got&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7344643">,</span>&nbsp;<span class="ident" id="7344645">got</span><span class="op" id="7344648">,</span>&nbsp;<span class="ident" id="7344650">custom</span><span class="op" id="7344656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7344659">}</span><br>
<span class="lineno"></span><span class="op" id="7344661">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="7344664">func</span>&nbsp;<span class="ident" id="7344669">TestLookupMallocs</span><span class="op" id="7344686">(</span><span class="ident" id="7344687">t</span>&nbsp;<span class="op" id="7344689">*</span><span class="ident" id="7344690">testing</span><span class="op" id="7344697">.</span><span class="ident" id="7344698">T</span><span class="op" id="7344699">)</span>&nbsp;<span class="op" id="7344701">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7344704">n</span>&nbsp;<span class="op" id="7344706">:=</span>&nbsp;<span class="ident" id="7344709">testing</span><span class="op" id="7344716">.</span><span class="ident" id="7344717">AllocsPerRun</span><span class="op" id="7344729">(</span><span class="num" id="7344730">10000</span><span class="op" id="7344735">,</span>&nbsp;<span class="keyword" id="7344737">func</span><span class="op" id="7344741">(</span><span class="op" id="7344742">)</span>&nbsp;<span class="op" id="7344744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7344748">TypeByExtension</span><span class="op" id="7344763">(</span><span class="string" id="7344764">&#34;.html&#34;</span><span class="op" id="7344771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7344775">TypeByExtension</span><span class="op" id="7344790">(</span><span class="string" id="7344791">&#34;.HtML&#34;</span><span class="op" id="7344798">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7344801">}</span><span class="op" id="7344802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7344805">if</span>&nbsp;<span class="ident" id="7344808">n</span>&nbsp;<span class="op" id="7344810">&gt;</span>&nbsp;<span class="num" id="7344812">0</span>&nbsp;<span class="op" id="7344814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7344818">t</span><span class="op" id="7344819">.</span><span class="ident" id="7344820">Errorf</span><span class="op" id="7344826">(</span><span class="string" id="7344827">&#34;allocs&nbsp;=&nbsp;%v;&nbsp;want&nbsp;0&#34;</span><span class="op" id="7344848">,</span>&nbsp;<span class="ident" id="7344850">n</span><span class="op" id="7344851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7344854">}</span><br>
<span class="lineno"></span><span class="op" id="7344856">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
