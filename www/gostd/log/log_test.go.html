<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>log</h2>
<ul>
<li><a href="/gostd/log/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/log/log.go.html">log.go</a></li>
<li><a href="/gostd/log/log_test.go.html" class="current">log_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7863479">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7863534">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7863588">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7863639">package</span>&nbsp;<span class="ident" id="7863647">log</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7863652">//&nbsp;These&nbsp;tests&nbsp;are&nbsp;too&nbsp;simple.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7863684">import</span>&nbsp;<span class="op" id="7863691">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7863694">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7863703">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7863709">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7863719">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7863729">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7863732">const</span>&nbsp;<span class="op" id="7863738">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7863741">Rdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7863755">=</span>&nbsp;<span class="string" id="7863757">`[0-9][0-9][0-9][0-9]/[0-9][0-9]/[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7863803">Rtime</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7863817">=</span>&nbsp;<span class="string" id="7863819">`[0-9][0-9]:[0-9][0-9]:[0-9][0-9]`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7863855">Rmicroseconds</span>&nbsp;<span class="op" id="7863869">=</span>&nbsp;<span class="string" id="7863871">`\.[0-9][0-9][0-9][0-9][0-9][0-9]`</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7863907">Rline</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7863921">=</span>&nbsp;<span class="string" id="7863923">`(54|56):`</span>&nbsp;<span class="comment" id="7863934">//&nbsp;must&nbsp;update&nbsp;if&nbsp;the&nbsp;calls&nbsp;to&nbsp;l.Printf&nbsp;/&nbsp;l.Print&nbsp;below&nbsp;move</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7863996">Rlongfile</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7864010">=</span>&nbsp;<span class="string" id="7864012">`.*/[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="7864038">+</span>&nbsp;<span class="ident" id="7864040">Rline</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7864047">Rshortfile</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7864061">=</span>&nbsp;<span class="string" id="7864063">`[A-Za-z0-9_\-]+\.go:`</span>&nbsp;<span class="op" id="7864086">+</span>&nbsp;<span class="ident" id="7864088">Rline</span><br>
<span class="lineno"></span><span class="op" id="7864094">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="7864097">type</span>&nbsp;<span class="ident" id="7864102">tester</span>&nbsp;<span class="keyword" id="7864109">struct</span>&nbsp;<span class="op" id="7864116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7864119">flag</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7864127">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7864132">prefix</span>&nbsp;&nbsp;<span class="builtintype" id="7864140">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7864148">pattern</span>&nbsp;<span class="builtintype" id="7864156">string</span>&nbsp;<span class="comment" id="7864163">//&nbsp;regexp&nbsp;that&nbsp;log&nbsp;output&nbsp;must&nbsp;match;&nbsp;we&nbsp;add&nbsp;^&nbsp;and&nbsp;expected_text$&nbsp;always</span><br>
<span class="lineno"></span><span class="op" id="7864236">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="7864239">var</span>&nbsp;<span class="ident" id="7864243">tests</span>&nbsp;<span class="op" id="7864249">=</span>&nbsp;<span class="op" id="7864251">[</span><span class="op" id="7864252">]</span><span class="ident" id="7864253">tester</span><span class="op" id="7864259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7864262">//&nbsp;individual&nbsp;pieces:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7864285">{</span><span class="num" id="7864286">0</span><span class="op" id="7864287">,</span>&nbsp;<span class="string" id="7864289">&#34;&#34;</span><span class="op" id="7864291">,</span>&nbsp;<span class="string" id="7864293">&#34;&#34;</span><span class="op" id="7864295">}</span><span class="op" id="7864296">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7864299">{</span><span class="num" id="7864300">0</span><span class="op" id="7864301">,</span>&nbsp;<span class="string" id="7864303">&#34;XXX&#34;</span><span class="op" id="7864308">,</span>&nbsp;<span class="string" id="7864310">&#34;XXX&#34;</span><span class="op" id="7864315">}</span><span class="op" id="7864316">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7864319">{</span><span class="ident" id="7864320">Ldate</span><span class="op" id="7864325">,</span>&nbsp;<span class="string" id="7864327">&#34;&#34;</span><span class="op" id="7864329">,</span>&nbsp;<span class="ident" id="7864331">Rdate</span>&nbsp;<span class="op" id="7864337">+</span>&nbsp;<span class="string" id="7864339">&#34;&nbsp;&#34;</span><span class="op" id="7864342">}</span><span class="op" id="7864343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7864346">{</span><span class="ident" id="7864347">Ltime</span><span class="op" id="7864352">,</span>&nbsp;<span class="string" id="7864354">&#34;&#34;</span><span class="op" id="7864356">,</span>&nbsp;<span class="ident" id="7864358">Rtime</span>&nbsp;<span class="op" id="7864364">+</span>&nbsp;<span class="string" id="7864366">&#34;&nbsp;&#34;</span><span class="op" id="7864369">}</span><span class="op" id="7864370">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7864373">{</span><span class="ident" id="7864374">Ltime</span>&nbsp;<span class="op" id="7864380">|</span>&nbsp;<span class="ident" id="7864382">Lmicroseconds</span><span class="op" id="7864395">,</span>&nbsp;<span class="string" id="7864397">&#34;&#34;</span><span class="op" id="7864399">,</span>&nbsp;<span class="ident" id="7864401">Rtime</span>&nbsp;<span class="op" id="7864407">+</span>&nbsp;<span class="ident" id="7864409">Rmicroseconds</span>&nbsp;<span class="op" id="7864423">+</span>&nbsp;<span class="string" id="7864425">&#34;&nbsp;&#34;</span><span class="op" id="7864428">}</span><span class="op" id="7864429">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7864432">{</span><span class="ident" id="7864433">Lmicroseconds</span><span class="op" id="7864446">,</span>&nbsp;<span class="string" id="7864448">&#34;&#34;</span><span class="op" id="7864450">,</span>&nbsp;<span class="ident" id="7864452">Rtime</span>&nbsp;<span class="op" id="7864458">+</span>&nbsp;<span class="ident" id="7864460">Rmicroseconds</span>&nbsp;<span class="op" id="7864474">+</span>&nbsp;<span class="string" id="7864476">&#34;&nbsp;&#34;</span><span class="op" id="7864479">}</span><span class="op" id="7864480">,</span>&nbsp;<span class="comment" id="7864482">//&nbsp;microsec&nbsp;implies&nbsp;time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7864508">{</span><span class="ident" id="7864509">Llongfile</span><span class="op" id="7864518">,</span>&nbsp;<span class="string" id="7864520">&#34;&#34;</span><span class="op" id="7864522">,</span>&nbsp;<span class="ident" id="7864524">Rlongfile</span>&nbsp;<span class="op" id="7864534">+</span>&nbsp;<span class="string" id="7864536">&#34;&nbsp;&#34;</span><span class="op" id="7864539">}</span><span class="op" id="7864540">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7864543">{</span><span class="ident" id="7864544">Lshortfile</span><span class="op" id="7864554">,</span>&nbsp;<span class="string" id="7864556">&#34;&#34;</span><span class="op" id="7864558">,</span>&nbsp;<span class="ident" id="7864560">Rshortfile</span>&nbsp;<span class="op" id="7864571">+</span>&nbsp;<span class="string" id="7864573">&#34;&nbsp;&#34;</span><span class="op" id="7864576">}</span><span class="op" id="7864577">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7864580">{</span><span class="ident" id="7864581">Llongfile</span>&nbsp;<span class="op" id="7864591">|</span>&nbsp;<span class="ident" id="7864593">Lshortfile</span><span class="op" id="7864603">,</span>&nbsp;<span class="string" id="7864605">&#34;&#34;</span><span class="op" id="7864607">,</span>&nbsp;<span class="ident" id="7864609">Rshortfile</span>&nbsp;<span class="op" id="7864620">+</span>&nbsp;<span class="string" id="7864622">&#34;&nbsp;&#34;</span><span class="op" id="7864625">}</span><span class="op" id="7864626">,</span>&nbsp;<span class="comment" id="7864628">//&nbsp;shortfile&nbsp;overrides&nbsp;longfile</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7864661">//&nbsp;everything&nbsp;at&nbsp;once:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7864685">{</span><span class="ident" id="7864686">Ldate</span>&nbsp;<span class="op" id="7864692">|</span>&nbsp;<span class="ident" id="7864694">Ltime</span>&nbsp;<span class="op" id="7864700">|</span>&nbsp;<span class="ident" id="7864702">Lmicroseconds</span>&nbsp;<span class="op" id="7864716">|</span>&nbsp;<span class="ident" id="7864718">Llongfile</span><span class="op" id="7864727">,</span>&nbsp;<span class="string" id="7864729">&#34;XXX&#34;</span><span class="op" id="7864734">,</span>&nbsp;<span class="string" id="7864736">&#34;XXX&#34;</span>&nbsp;<span class="op" id="7864742">+</span>&nbsp;<span class="ident" id="7864744">Rdate</span>&nbsp;<span class="op" id="7864750">+</span>&nbsp;<span class="string" id="7864752">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7864756">+</span>&nbsp;<span class="ident" id="7864758">Rtime</span>&nbsp;<span class="op" id="7864764">+</span>&nbsp;<span class="ident" id="7864766">Rmicroseconds</span>&nbsp;<span class="op" id="7864780">+</span>&nbsp;<span class="string" id="7864782">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7864786">+</span>&nbsp;<span class="ident" id="7864788">Rlongfile</span>&nbsp;<span class="op" id="7864798">+</span>&nbsp;<span class="string" id="7864800">&#34;&nbsp;&#34;</span><span class="op" id="7864803">}</span><span class="op" id="7864804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7864807">{</span><span class="ident" id="7864808">Ldate</span>&nbsp;<span class="op" id="7864814">|</span>&nbsp;<span class="ident" id="7864816">Ltime</span>&nbsp;<span class="op" id="7864822">|</span>&nbsp;<span class="ident" id="7864824">Lmicroseconds</span>&nbsp;<span class="op" id="7864838">|</span>&nbsp;<span class="ident" id="7864840">Lshortfile</span><span class="op" id="7864850">,</span>&nbsp;<span class="string" id="7864852">&#34;XXX&#34;</span><span class="op" id="7864857">,</span>&nbsp;<span class="string" id="7864859">&#34;XXX&#34;</span>&nbsp;<span class="op" id="7864865">+</span>&nbsp;<span class="ident" id="7864867">Rdate</span>&nbsp;<span class="op" id="7864873">+</span>&nbsp;<span class="string" id="7864875">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7864879">+</span>&nbsp;<span class="ident" id="7864881">Rtime</span>&nbsp;<span class="op" id="7864887">+</span>&nbsp;<span class="ident" id="7864889">Rmicroseconds</span>&nbsp;<span class="op" id="7864903">+</span>&nbsp;<span class="string" id="7864905">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7864909">+</span>&nbsp;<span class="ident" id="7864911">Rshortfile</span>&nbsp;<span class="op" id="7864922">+</span>&nbsp;<span class="string" id="7864924">&#34;&nbsp;&#34;</span><span class="op" id="7864927">}</span><span class="op" id="7864928">,</span><br>
<span class="lineno">45</span><span class="op" id="7864930">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7864933">//&nbsp;Test&nbsp;using&nbsp;Println(&#34;hello&#34;,&nbsp;23,&nbsp;&#34;world&#34;)&nbsp;or&nbsp;using&nbsp;Printf(&#34;hello&nbsp;%d&nbsp;world&#34;,&nbsp;23)</span><br>
<span class="lineno"></span><span class="keyword" id="7865015">func</span>&nbsp;<span class="ident" id="7865020">testPrint</span><span class="op" id="7865029">(</span><span class="ident" id="7865030">t</span>&nbsp;<span class="op" id="7865032">*</span><span class="ident" id="7865033">testing</span><span class="op" id="7865040">.</span><span class="ident" id="7865041">T</span><span class="op" id="7865042">,</span>&nbsp;<span class="ident" id="7865044">flag</span>&nbsp;<span class="builtintype" id="7865049">int</span><span class="op" id="7865052">,</span>&nbsp;<span class="ident" id="7865054">prefix</span>&nbsp;<span class="builtintype" id="7865061">string</span><span class="op" id="7865067">,</span>&nbsp;<span class="ident" id="7865069">pattern</span>&nbsp;<span class="builtintype" id="7865077">string</span><span class="op" id="7865083">,</span>&nbsp;<span class="ident" id="7865085">useFormat</span>&nbsp;<span class="builtintype" id="7865095">bool</span><span class="op" id="7865099">)</span>&nbsp;<span class="op" id="7865101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7865104">buf</span>&nbsp;<span class="op" id="7865108">:=</span>&nbsp;<span class="builtinfunc" id="7865111">new</span><span class="op" id="7865114">(</span><span class="ident" id="7865115">bytes</span><span class="op" id="7865120">.</span><span class="ident" id="7865121">Buffer</span><span class="op" id="7865127">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7865130">SetOutput</span><span class="op" id="7865139">(</span><span class="ident" id="7865140">buf</span><span class="op" id="7865143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7865146">SetFlags</span><span class="op" id="7865154">(</span><span class="ident" id="7865155">flag</span><span class="op" id="7865159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7865162">SetPrefix</span><span class="op" id="7865171">(</span><span class="ident" id="7865172">prefix</span><span class="op" id="7865178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7865181">if</span>&nbsp;<span class="ident" id="7865184">useFormat</span>&nbsp;<span class="op" id="7865194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7865198">Printf</span><span class="op" id="7865204">(</span><span class="string" id="7865205">&#34;hello&nbsp;%d&nbsp;world&#34;</span><span class="op" id="7865221">,</span>&nbsp;<span class="num" id="7865223">23</span><span class="op" id="7865225">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7865228">}</span>&nbsp;<span class="keyword" id="7865230">else</span>&nbsp;<span class="op" id="7865235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7865239">Println</span><span class="op" id="7865246">(</span><span class="string" id="7865247">&#34;hello&#34;</span><span class="op" id="7865254">,</span>&nbsp;<span class="num" id="7865256">23</span><span class="op" id="7865258">,</span>&nbsp;<span class="string" id="7865260">&#34;world&#34;</span><span class="op" id="7865267">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7865270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7865273">line</span>&nbsp;<span class="op" id="7865278">:=</span>&nbsp;<span class="ident" id="7865281">buf</span><span class="op" id="7865284">.</span><span class="ident" id="7865285">String</span><span class="op" id="7865291">(</span><span class="op" id="7865292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7865295">line</span>&nbsp;<span class="op" id="7865300">=</span>&nbsp;<span class="ident" id="7865302">line</span><span class="op" id="7865306">[</span><span class="num" id="7865307">0</span>&nbsp;<span class="op" id="7865309">:</span>&nbsp;<span class="builtinfunc" id="7865311">len</span><span class="op" id="7865314">(</span><span class="ident" id="7865315">line</span><span class="op" id="7865319">)</span><span class="op" id="7865320">-</span><span class="num" id="7865321">1</span><span class="op" id="7865322">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7865325">pattern</span>&nbsp;<span class="op" id="7865333">=</span>&nbsp;<span class="string" id="7865335">&#34;^&#34;</span>&nbsp;<span class="op" id="7865339">+</span>&nbsp;<span class="ident" id="7865341">pattern</span>&nbsp;<span class="op" id="7865349">+</span>&nbsp;<span class="string" id="7865351">&#34;hello&nbsp;23&nbsp;world$&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7865370">matched</span><span class="op" id="7865377">,</span>&nbsp;<span class="ident" id="7865379">err4</span>&nbsp;<span class="op" id="7865384">:=</span>&nbsp;<span class="ident" id="7865387">regexp</span><span class="op" id="7865393">.</span><span class="ident" id="7865394">MatchString</span><span class="op" id="7865405">(</span><span class="ident" id="7865406">pattern</span><span class="op" id="7865413">,</span>&nbsp;<span class="ident" id="7865415">line</span><span class="op" id="7865419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7865422">if</span>&nbsp;<span class="ident" id="7865425">err4</span>&nbsp;<span class="op" id="7865430">!=</span>&nbsp;<span class="ident" id="7865433">nil</span>&nbsp;<span class="op" id="7865437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7865441">t</span><span class="op" id="7865442">.</span><span class="ident" id="7865443">Fatal</span><span class="op" id="7865448">(</span><span class="string" id="7865449">&#34;pattern&nbsp;did&nbsp;not&nbsp;compile:&#34;</span><span class="op" id="7865475">,</span>&nbsp;<span class="ident" id="7865477">err4</span><span class="op" id="7865481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7865484">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7865487">if</span>&nbsp;<span class="op" id="7865490">!</span><span class="ident" id="7865491">matched</span>&nbsp;<span class="op" id="7865499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7865503">t</span><span class="op" id="7865504">.</span><span class="ident" id="7865505">Errorf</span><span class="op" id="7865511">(</span><span class="string" id="7865512">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="7865546">,</span>&nbsp;<span class="ident" id="7865548">pattern</span><span class="op" id="7865555">,</span>&nbsp;<span class="ident" id="7865557">line</span><span class="op" id="7865561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7865564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7865567">SetOutput</span><span class="op" id="7865576">(</span><span class="ident" id="7865577">os</span><span class="op" id="7865579">.</span><span class="ident" id="7865580">Stderr</span><span class="op" id="7865586">)</span><br>
<span class="lineno"></span><span class="op" id="7865588">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="7865591">func</span>&nbsp;<span class="ident" id="7865596">TestAll</span><span class="op" id="7865603">(</span><span class="ident" id="7865604">t</span>&nbsp;<span class="op" id="7865606">*</span><span class="ident" id="7865607">testing</span><span class="op" id="7865614">.</span><span class="ident" id="7865615">T</span><span class="op" id="7865616">)</span>&nbsp;<span class="op" id="7865618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7865621">for</span>&nbsp;<span class="ident" id="7865625">_</span><span class="op" id="7865626">,</span>&nbsp;<span class="ident" id="7865628">testcase</span>&nbsp;<span class="op" id="7865637">:=</span>&nbsp;<span class="keyword" id="7865640">range</span>&nbsp;<span class="ident" id="7865646">tests</span>&nbsp;<span class="op" id="7865652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7865656">testPrint</span><span class="op" id="7865665">(</span><span class="ident" id="7865666">t</span><span class="op" id="7865667">,</span>&nbsp;<span class="ident" id="7865669">testcase</span><span class="op" id="7865677">.</span><span class="ident" id="7865678">flag</span><span class="op" id="7865682">,</span>&nbsp;<span class="ident" id="7865684">testcase</span><span class="op" id="7865692">.</span><span class="ident" id="7865693">prefix</span><span class="op" id="7865699">,</span>&nbsp;<span class="ident" id="7865701">testcase</span><span class="op" id="7865709">.</span><span class="ident" id="7865710">pattern</span><span class="op" id="7865717">,</span>&nbsp;<span class="builtintype" id="7865719">false</span><span class="op" id="7865724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7865728">testPrint</span><span class="op" id="7865737">(</span><span class="ident" id="7865738">t</span><span class="op" id="7865739">,</span>&nbsp;<span class="ident" id="7865741">testcase</span><span class="op" id="7865749">.</span><span class="ident" id="7865750">flag</span><span class="op" id="7865754">,</span>&nbsp;<span class="ident" id="7865756">testcase</span><span class="op" id="7865764">.</span><span class="ident" id="7865765">prefix</span><span class="op" id="7865771">,</span>&nbsp;<span class="ident" id="7865773">testcase</span><span class="op" id="7865781">.</span><span class="ident" id="7865782">pattern</span><span class="op" id="7865789">,</span>&nbsp;<span class="builtintype" id="7865791">true</span><span class="op" id="7865795">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7865798">}</span><br>
<span class="lineno"></span><span class="op" id="7865800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7865803">func</span>&nbsp;<span class="ident" id="7865808">TestOutput</span><span class="op" id="7865818">(</span><span class="ident" id="7865819">t</span>&nbsp;<span class="op" id="7865821">*</span><span class="ident" id="7865822">testing</span><span class="op" id="7865829">.</span><span class="ident" id="7865830">T</span><span class="op" id="7865831">)</span>&nbsp;<span class="op" id="7865833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7865836">const</span>&nbsp;<span class="ident" id="7865842">testString</span>&nbsp;<span class="op" id="7865853">=</span>&nbsp;<span class="string" id="7865855">&#34;test&#34;</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7865863">var</span>&nbsp;<span class="ident" id="7865867">b</span>&nbsp;<span class="ident" id="7865869">bytes</span><span class="op" id="7865874">.</span><span class="ident" id="7865875">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7865883">l</span>&nbsp;<span class="op" id="7865885">:=</span>&nbsp;<span class="ident" id="7865888">New</span><span class="op" id="7865891">(</span><span class="op" id="7865892">&amp;</span><span class="ident" id="7865893">b</span><span class="op" id="7865894">,</span>&nbsp;<span class="string" id="7865896">&#34;&#34;</span><span class="op" id="7865898">,</span>&nbsp;<span class="num" id="7865900">0</span><span class="op" id="7865901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7865904">l</span><span class="op" id="7865905">.</span><span class="ident" id="7865906">Println</span><span class="op" id="7865913">(</span><span class="ident" id="7865914">testString</span><span class="op" id="7865924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7865927">if</span>&nbsp;<span class="ident" id="7865930">expect</span>&nbsp;<span class="op" id="7865937">:=</span>&nbsp;<span class="ident" id="7865940">testString</span>&nbsp;<span class="op" id="7865951">+</span>&nbsp;<span class="string" id="7865953">&#34;\n&#34;</span><span class="op" id="7865957">;</span>&nbsp;<span class="ident" id="7865959">b</span><span class="op" id="7865960">.</span><span class="ident" id="7865961">String</span><span class="op" id="7865967">(</span><span class="op" id="7865968">)</span>&nbsp;<span class="op" id="7865970">!=</span>&nbsp;<span class="ident" id="7865973">expect</span>&nbsp;<span class="op" id="7865980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7865984">t</span><span class="op" id="7865985">.</span><span class="ident" id="7865986">Errorf</span><span class="op" id="7865992">(</span><span class="string" id="7865993">&#34;log&nbsp;output&nbsp;should&nbsp;match&nbsp;%q&nbsp;is&nbsp;%q&#34;</span><span class="op" id="7866027">,</span>&nbsp;<span class="ident" id="7866029">expect</span><span class="op" id="7866035">,</span>&nbsp;<span class="ident" id="7866037">b</span><span class="op" id="7866038">.</span><span class="ident" id="7866039">String</span><span class="op" id="7866045">(</span><span class="op" id="7866046">)</span><span class="op" id="7866047">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7866050">}</span><br>
<span class="lineno"></span><span class="op" id="7866052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7866055">func</span>&nbsp;<span class="ident" id="7866060">TestFlagAndPrefixSetting</span><span class="op" id="7866084">(</span><span class="ident" id="7866085">t</span>&nbsp;<span class="op" id="7866087">*</span><span class="ident" id="7866088">testing</span><span class="op" id="7866095">.</span><span class="ident" id="7866096">T</span><span class="op" id="7866097">)</span>&nbsp;<span class="op" id="7866099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7866102">var</span>&nbsp;<span class="ident" id="7866106">b</span>&nbsp;<span class="ident" id="7866108">bytes</span><span class="op" id="7866113">.</span><span class="ident" id="7866114">Buffer</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7866122">l</span>&nbsp;<span class="op" id="7866124">:=</span>&nbsp;<span class="ident" id="7866127">New</span><span class="op" id="7866130">(</span><span class="op" id="7866131">&amp;</span><span class="ident" id="7866132">b</span><span class="op" id="7866133">,</span>&nbsp;<span class="string" id="7866135">&#34;Test:&#34;</span><span class="op" id="7866142">,</span>&nbsp;<span class="ident" id="7866144">LstdFlags</span><span class="op" id="7866153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7866156">f</span>&nbsp;<span class="op" id="7866158">:=</span>&nbsp;<span class="ident" id="7866161">l</span><span class="op" id="7866162">.</span><span class="ident" id="7866163">Flags</span><span class="op" id="7866168">(</span><span class="op" id="7866169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7866172">if</span>&nbsp;<span class="ident" id="7866175">f</span>&nbsp;<span class="op" id="7866177">!=</span>&nbsp;<span class="ident" id="7866180">LstdFlags</span>&nbsp;<span class="op" id="7866190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7866194">t</span><span class="op" id="7866195">.</span><span class="ident" id="7866196">Errorf</span><span class="op" id="7866202">(</span><span class="string" id="7866203">&#34;Flags&nbsp;1:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="7866232">,</span>&nbsp;<span class="ident" id="7866234">LstdFlags</span><span class="op" id="7866243">,</span>&nbsp;<span class="ident" id="7866245">f</span><span class="op" id="7866246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7866249">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7866252">l</span><span class="op" id="7866253">.</span><span class="ident" id="7866254">SetFlags</span><span class="op" id="7866262">(</span><span class="ident" id="7866263">f</span>&nbsp;<span class="op" id="7866265">|</span>&nbsp;<span class="ident" id="7866267">Lmicroseconds</span><span class="op" id="7866280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7866283">f</span>&nbsp;<span class="op" id="7866285">=</span>&nbsp;<span class="ident" id="7866287">l</span><span class="op" id="7866288">.</span><span class="ident" id="7866289">Flags</span><span class="op" id="7866294">(</span><span class="op" id="7866295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7866298">if</span>&nbsp;<span class="ident" id="7866301">f</span>&nbsp;<span class="op" id="7866303">!=</span>&nbsp;<span class="ident" id="7866306">LstdFlags</span><span class="op" id="7866315">|</span><span class="ident" id="7866316">Lmicroseconds</span>&nbsp;<span class="op" id="7866330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7866334">t</span><span class="op" id="7866335">.</span><span class="ident" id="7866336">Errorf</span><span class="op" id="7866342">(</span><span class="string" id="7866343">&#34;Flags&nbsp;2:&nbsp;expected&nbsp;%x&nbsp;got&nbsp;%x&#34;</span><span class="op" id="7866372">,</span>&nbsp;<span class="ident" id="7866374">LstdFlags</span><span class="op" id="7866383">|</span><span class="ident" id="7866384">Lmicroseconds</span><span class="op" id="7866397">,</span>&nbsp;<span class="ident" id="7866399">f</span><span class="op" id="7866400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7866403">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7866406">p</span>&nbsp;<span class="op" id="7866408">:=</span>&nbsp;<span class="ident" id="7866411">l</span><span class="op" id="7866412">.</span><span class="ident" id="7866413">Prefix</span><span class="op" id="7866419">(</span><span class="op" id="7866420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7866423">if</span>&nbsp;<span class="ident" id="7866426">p</span>&nbsp;<span class="op" id="7866428">!=</span>&nbsp;<span class="string" id="7866431">&#34;Test:&#34;</span>&nbsp;<span class="op" id="7866439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7866443">t</span><span class="op" id="7866444">.</span><span class="ident" id="7866445">Errorf</span><span class="op" id="7866451">(</span><span class="string" id="7866452">`Prefix:&nbsp;expected&nbsp;&#34;Test:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="7866485">,</span>&nbsp;<span class="ident" id="7866487">p</span><span class="op" id="7866488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7866491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7866494">l</span><span class="op" id="7866495">.</span><span class="ident" id="7866496">SetPrefix</span><span class="op" id="7866505">(</span><span class="string" id="7866506">&#34;Reality:&#34;</span><span class="op" id="7866516">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7866519">p</span>&nbsp;<span class="op" id="7866521">=</span>&nbsp;<span class="ident" id="7866523">l</span><span class="op" id="7866524">.</span><span class="ident" id="7866525">Prefix</span><span class="op" id="7866531">(</span><span class="op" id="7866532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7866535">if</span>&nbsp;<span class="ident" id="7866538">p</span>&nbsp;<span class="op" id="7866540">!=</span>&nbsp;<span class="string" id="7866543">&#34;Reality:&#34;</span>&nbsp;<span class="op" id="7866554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7866558">t</span><span class="op" id="7866559">.</span><span class="ident" id="7866560">Errorf</span><span class="op" id="7866566">(</span><span class="string" id="7866567">`Prefix:&nbsp;expected&nbsp;&#34;Reality:&#34;&nbsp;got&nbsp;%q`</span><span class="op" id="7866603">,</span>&nbsp;<span class="ident" id="7866605">p</span><span class="op" id="7866606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7866609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7866612">//&nbsp;Verify&nbsp;a&nbsp;log&nbsp;message&nbsp;looks&nbsp;right,&nbsp;with&nbsp;our&nbsp;prefix&nbsp;and&nbsp;microseconds&nbsp;present.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7866692">l</span><span class="op" id="7866693">.</span><span class="ident" id="7866694">Print</span><span class="op" id="7866699">(</span><span class="string" id="7866700">&#34;hello&#34;</span><span class="op" id="7866707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7866710">pattern</span>&nbsp;<span class="op" id="7866718">:=</span>&nbsp;<span class="string" id="7866721">&#34;^Reality:&#34;</span>&nbsp;<span class="op" id="7866733">+</span>&nbsp;<span class="ident" id="7866735">Rdate</span>&nbsp;<span class="op" id="7866741">+</span>&nbsp;<span class="string" id="7866743">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="7866747">+</span>&nbsp;<span class="ident" id="7866749">Rtime</span>&nbsp;<span class="op" id="7866755">+</span>&nbsp;<span class="ident" id="7866757">Rmicroseconds</span>&nbsp;<span class="op" id="7866771">+</span>&nbsp;<span class="string" id="7866773">&#34;&nbsp;hello\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7866785">matched</span><span class="op" id="7866792">,</span>&nbsp;<span class="ident" id="7866794">err</span>&nbsp;<span class="op" id="7866798">:=</span>&nbsp;<span class="ident" id="7866801">regexp</span><span class="op" id="7866807">.</span><span class="ident" id="7866808">Match</span><span class="op" id="7866813">(</span><span class="ident" id="7866814">pattern</span><span class="op" id="7866821">,</span>&nbsp;<span class="ident" id="7866823">b</span><span class="op" id="7866824">.</span><span class="ident" id="7866825">Bytes</span><span class="op" id="7866830">(</span><span class="op" id="7866831">)</span><span class="op" id="7866832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7866835">if</span>&nbsp;<span class="ident" id="7866838">err</span>&nbsp;<span class="op" id="7866842">!=</span>&nbsp;<span class="ident" id="7866845">nil</span>&nbsp;<span class="op" id="7866849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7866853">t</span><span class="op" id="7866854">.</span><span class="ident" id="7866855">Fatalf</span><span class="op" id="7866861">(</span><span class="string" id="7866862">&#34;pattern&nbsp;%q&nbsp;did&nbsp;not&nbsp;compile:&nbsp;%s&#34;</span><span class="op" id="7866894">,</span>&nbsp;<span class="ident" id="7866896">pattern</span><span class="op" id="7866903">,</span>&nbsp;<span class="ident" id="7866905">err</span><span class="op" id="7866908">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7866911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7866914">if</span>&nbsp;<span class="op" id="7866917">!</span><span class="ident" id="7866918">matched</span>&nbsp;<span class="op" id="7866926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7866930">t</span><span class="op" id="7866931">.</span><span class="ident" id="7866932">Error</span><span class="op" id="7866937">(</span><span class="string" id="7866938">&#34;message&nbsp;did&nbsp;not&nbsp;match&nbsp;pattern&#34;</span><span class="op" id="7866969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7866972">}</span><br>
<span class="lineno"></span><span class="op" id="7866974">}</span>
</div>
</body>
</html>
