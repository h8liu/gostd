<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5976081">package</span>&nbsp;<span class="ident" id="5976089">arch8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5976096">import</span>&nbsp;<span class="op" id="5976103">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5976106">&#34;io&#34;</span><br>
<span class="lineno">5</span><span class="op" id="5976111">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5976114">//&nbsp;Machine&nbsp;is&nbsp;a&nbsp;multicore&nbsp;shared&nbsp;memory&nbsp;simulated&nbsp;arch8&nbsp;machine.</span><br>
<span class="lineno"></span><span class="keyword" id="5976179">type</span>&nbsp;<span class="ident" id="5976184">Machine</span>&nbsp;<span class="keyword" id="5976192">struct</span>&nbsp;<span class="op" id="5976199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976202">phyMem</span>&nbsp;&nbsp;<span class="op" id="5976210">*</span><span class="ident" id="5976211"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984438">phyMemory</a></span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976222">inst</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5976230"><a href="/lonnie.io/e8vm/arch8/cpu.go.html#5960963">inst</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976236">cores</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5976244">*</span><span class="ident" id="5976245"><a href="/lonnie.io/e8vm/arch8/multi_core.go.html#5978210">multiCore</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976256">serial</span>&nbsp;&nbsp;<span class="op" id="5976264">*</span><span class="ident" id="5976265"><a href="/lonnie.io/e8vm/arch8/serial.go.html#5987528">serial</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976273">console</span>&nbsp;<span class="op" id="5976281">*</span><span class="ident" id="5976282"><a href="/lonnie.io/e8vm/arch8/console.go.html#5959921">console</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976292">devices</span>&nbsp;<span class="op" id="5976300">[</span><span class="op" id="5976301">]</span><span class="ident" id="5976302"><a href="/lonnie.io/e8vm/arch8/device.go.html#5965421">device</a></span><br>
<span class="lineno"></span><span class="op" id="5976309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5976312">//&nbsp;NewMachine&nbsp;creates&nbsp;a&nbsp;machine&nbsp;with&nbsp;memory&nbsp;and&nbsp;cores.</span><br>
<span class="lineno"></span><span class="keyword" id="5976367">func</span>&nbsp;<span class="ident" id="5976372">NewMachine</span><span class="op" id="5976382">(</span><span class="ident" id="5976383">memSize</span>&nbsp;<span class="builtintype" id="5976391">uint32</span><span class="op" id="5976397">,</span>&nbsp;<span class="ident" id="5976399">ncore</span>&nbsp;<span class="builtintype" id="5976405">int</span><span class="op" id="5976408">)</span>&nbsp;<span class="op" id="5976410">*</span><span class="ident" id="5976411"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976184">Machine</a></span>&nbsp;<span class="op" id="5976419">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976422">ret</span>&nbsp;<span class="op" id="5976426">:=</span>&nbsp;<span class="builtinfunc" id="5976429">new</span><span class="op" id="5976432">(</span><span class="ident" id="5976433"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976184">Machine</a></span><span class="op" id="5976440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976443"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976422">ret</a></span><span class="op" id="5976446">.</span><span class="ident" id="5976447">phyMem</span>&nbsp;<span class="op" id="5976454">=</span>&nbsp;<span class="ident" id="5976456"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984648">newPhyMemory</a></span><span class="op" id="5976468">(</span><span class="ident" id="5976469"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976383">memSize</a></span><span class="op" id="5976476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976479"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976422">ret</a></span><span class="op" id="5976482">.</span><span class="ident" id="5976483">inst</span>&nbsp;<span class="op" id="5976488">=</span>&nbsp;<span class="builtinfunc" id="5976490">new</span><span class="op" id="5976493">(</span><span class="ident" id="5976494"><a href="/lonnie.io/e8vm/arch8/inst_all.go.html#5966620">instArch8</a></span><span class="op" id="5976503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976506"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976422">ret</a></span><span class="op" id="5976509">.</span><span class="ident" id="5976510">cores</span>&nbsp;<span class="op" id="5976516">=</span>&nbsp;<span class="ident" id="5976518"><a href="/lonnie.io/e8vm/arch8/multi_core.go.html#5978332">newMultiCore</a></span><span class="op" id="5976530">(</span><span class="ident" id="5976531"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976399">ncore</a></span><span class="op" id="5976536">,</span>&nbsp;<span class="ident" id="5976538"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976422">ret</a></span><span class="op" id="5976541">.</span><span class="ident" id="5976542">phyMem</span><span class="op" id="5976548">,</span>&nbsp;<span class="ident" id="5976550"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976422">ret</a></span><span class="op" id="5976553">.</span><span class="ident" id="5976554">inst</span><span class="op" id="5976558">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5976562">//&nbsp;hook-up&nbsp;devices</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976582">p</span>&nbsp;<span class="op" id="5976584">:=</span>&nbsp;<span class="ident" id="5976587"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976422">ret</a></span><span class="op" id="5976590">.</span><span class="ident" id="5976591">phyMem</span><span class="op" id="5976597">.</span><span class="ident" id="5976598">Page</span><span class="op" id="5976602">(</span><span class="ident" id="5976603"><a href="/lonnie.io/e8vm/arch8/phy_memory.go.html#5984545">pageBasicIO</a></span><span class="op" id="5976614">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976618"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976422">ret</a></span><span class="op" id="5976621">.</span><span class="ident" id="5976622">serial</span>&nbsp;<span class="op" id="5976629">=</span>&nbsp;<span class="ident" id="5976631"><a href="/lonnie.io/e8vm/arch8/serial.go.html#5988408">newSerial</a></span><span class="op" id="5976640">(</span><span class="ident" id="5976641"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976582">p</a></span><span class="op" id="5976642">,</span>&nbsp;<span class="ident" id="5976644"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976422">ret</a></span><span class="op" id="5976647">.</span><span class="ident" id="5976648">cores</span><span class="op" id="5976653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976656"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976422">ret</a></span><span class="op" id="5976659">.</span><span class="ident" id="5976660">console</span>&nbsp;<span class="op" id="5976668">=</span>&nbsp;<span class="ident" id="5976670"><a href="/lonnie.io/e8vm/arch8/console.go.html#5960078">newConsole</a></span><span class="op" id="5976680">(</span><span class="ident" id="5976681"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976582">p</a></span><span class="op" id="5976682">,</span>&nbsp;<span class="ident" id="5976684"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976422">ret</a></span><span class="op" id="5976687">.</span><span class="ident" id="5976688">cores</span><span class="op" id="5976693">)</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976697"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976422">ret</a></span><span class="op" id="5976700">.</span><span class="ident" id="5976701">addDevice</span><span class="op" id="5976710">(</span><span class="ident" id="5976711"><a href="/lonnie.io/e8vm/arch8/ticker.go.html#5991389">newTicker</a></span><span class="op" id="5976720">(</span><span class="ident" id="5976721"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976422">ret</a></span><span class="op" id="5976724">.</span><span class="ident" id="5976725">cores</span><span class="op" id="5976730">)</span><span class="op" id="5976731">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976734"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976422">ret</a></span><span class="op" id="5976737">.</span><span class="ident" id="5976738">addDevice</span><span class="op" id="5976747">(</span><span class="ident" id="5976748"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976422">ret</a></span><span class="op" id="5976751">.</span><span class="ident" id="5976752">serial</span><span class="op" id="5976758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976761"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976422">ret</a></span><span class="op" id="5976764">.</span><span class="ident" id="5976765">addDevice</span><span class="op" id="5976774">(</span><span class="ident" id="5976775"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976422">ret</a></span><span class="op" id="5976778">.</span><span class="ident" id="5976779">console</span><span class="op" id="5976786">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5976790">return</span>&nbsp;<span class="ident" id="5976797"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976422">ret</a></span><br>
<span class="lineno"></span><span class="op" id="5976801">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5976804">//&nbsp;SetOutput&nbsp;sets&nbsp;the&nbsp;output&nbsp;writer&nbsp;of&nbsp;the&nbsp;machine&#39;s&nbsp;serial</span><br>
<span class="lineno"></span><span class="comment" id="5976864">//&nbsp;console.</span><br>
<span class="lineno">40</span><span class="keyword" id="5976876">func</span>&nbsp;<span class="op" id="5976881">(</span><span class="ident" id="5976882">m</span>&nbsp;<span class="op" id="5976884">*</span><span class="ident" id="5976885"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976184">Machine</a></span><span class="op" id="5976892">)</span>&nbsp;<span class="ident" id="5976894">SetOutput</span><span class="op" id="5976903">(</span><span class="ident" id="5976904">w</span>&nbsp;<span class="ident" id="5976906"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976106">io</a></span><span class="op" id="5976908">.</span><span class="ident" id="5976909">Writer</span><span class="op" id="5976915">)</span>&nbsp;<span class="op" id="5976917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976920"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976882">m</a></span><span class="op" id="5976921">.</span><span class="ident" id="5976922">serial</span><span class="op" id="5976928">.</span><span class="ident" id="5976929">Output</span>&nbsp;<span class="op" id="5976936">=</span>&nbsp;<span class="ident" id="5976938"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976904">w</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5976941"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976882">m</a></span><span class="op" id="5976942">.</span><span class="ident" id="5976943">console</span><span class="op" id="5976950">.</span><span class="ident" id="5976951">Output</span>&nbsp;<span class="op" id="5976958">=</span>&nbsp;<span class="ident" id="5976960"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976904">w</a></span><br>
<span class="lineno"></span><span class="op" id="5976962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="5976965">//&nbsp;AddDevice&nbsp;adds&nbsp;a&nbsp;devices&nbsp;to&nbsp;the&nbsp;machine.</span><br>
<span class="lineno"></span><span class="keyword" id="5977009">func</span>&nbsp;<span class="op" id="5977014">(</span><span class="ident" id="5977015">m</span>&nbsp;<span class="op" id="5977017">*</span><span class="ident" id="5977018"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976184">Machine</a></span><span class="op" id="5977025">)</span>&nbsp;<span class="ident" id="5977027">addDevice</span><span class="op" id="5977036">(</span><span class="ident" id="5977037">d</span>&nbsp;<span class="ident" id="5977039"><a href="/lonnie.io/e8vm/arch8/device.go.html#5965421">device</a></span><span class="op" id="5977045">)</span>&nbsp;<span class="op" id="5977047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977050"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977015">m</a></span><span class="op" id="5977051">.</span><span class="ident" id="5977052">devices</span>&nbsp;<span class="op" id="5977060">=</span>&nbsp;<span class="builtinfunc" id="5977062">append</span><span class="op" id="5977068">(</span><span class="ident" id="5977069"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977015">m</a></span><span class="op" id="5977070">.</span><span class="ident" id="5977071">devices</span><span class="op" id="5977078">,</span>&nbsp;<span class="ident" id="5977080"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977037">d</a></span><span class="op" id="5977081">)</span><br>
<span class="lineno"></span><span class="op" id="5977083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="5977086">//&nbsp;Tick&nbsp;proceeds&nbsp;the&nbsp;simulation&nbsp;by&nbsp;one&nbsp;tick.</span><br>
<span class="lineno"></span><span class="keyword" id="5977131">func</span>&nbsp;<span class="op" id="5977136">(</span><span class="ident" id="5977137">m</span>&nbsp;<span class="op" id="5977139">*</span><span class="ident" id="5977140"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976184">Machine</a></span><span class="op" id="5977147">)</span>&nbsp;<span class="ident" id="5977149">Tick</span><span class="op" id="5977153">(</span><span class="op" id="5977154">)</span>&nbsp;<span class="op" id="5977156">*</span><span class="ident" id="5977157"><a href="/lonnie.io/e8vm/arch8/multi_core.go.html#5978665">CoreExcep</a></span>&nbsp;<span class="op" id="5977167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977170">for</span>&nbsp;<span class="ident" id="5977174">_</span><span class="op" id="5977175">,</span>&nbsp;<span class="ident" id="5977177">d</span>&nbsp;<span class="op" id="5977179">:=</span>&nbsp;<span class="keyword" id="5977182">range</span>&nbsp;<span class="ident" id="5977188"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977137">m</a></span><span class="op" id="5977189">.</span><span class="ident" id="5977190">devices</span>&nbsp;<span class="op" id="5977198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977202"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977177">d</a></span><span class="op" id="5977203">.</span><span class="ident" id="5977204">Tick</span><span class="op" id="5977208">(</span><span class="op" id="5977209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977212">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977216">return</span>&nbsp;<span class="ident" id="5977223"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977137">m</a></span><span class="op" id="5977224">.</span><span class="ident" id="5977225">cores</span><span class="op" id="5977230">.</span><span class="ident" id="5977231">Tick</span><span class="op" id="5977235">(</span><span class="op" id="5977236">)</span><br>
<span class="lineno"></span><span class="op" id="5977238">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5977241">//&nbsp;Run&nbsp;simulates&nbsp;nticks.&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;ticks</span><br>
<span class="lineno">60</span><span class="comment" id="5977297">//&nbsp;simulated&nbsp;without&nbsp;error,&nbsp;and&nbsp;the&nbsp;first&nbsp;met&nbsp;error&nbsp;if&nbsp;any.</span><br>
<span class="lineno"></span><span class="keyword" id="5977357">func</span>&nbsp;<span class="op" id="5977362">(</span><span class="ident" id="5977363">m</span>&nbsp;<span class="op" id="5977365">*</span><span class="ident" id="5977366"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976184">Machine</a></span><span class="op" id="5977373">)</span>&nbsp;<span class="ident" id="5977375">Run</span><span class="op" id="5977378">(</span><span class="ident" id="5977379">nticks</span>&nbsp;<span class="builtintype" id="5977386">int</span><span class="op" id="5977389">)</span>&nbsp;<span class="op" id="5977391">(</span><span class="builtintype" id="5977392">int</span><span class="op" id="5977395">,</span>&nbsp;<span class="op" id="5977397">*</span><span class="ident" id="5977398"><a href="/lonnie.io/e8vm/arch8/multi_core.go.html#5978665">CoreExcep</a></span><span class="op" id="5977407">)</span>&nbsp;<span class="op" id="5977409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977412">n</span>&nbsp;<span class="op" id="5977414">:=</span>&nbsp;<span class="num" id="5977417">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977420">for</span>&nbsp;<span class="ident" id="5977424">i</span>&nbsp;<span class="op" id="5977426">:=</span>&nbsp;<span class="num" id="5977429">0</span><span class="op" id="5977430">;</span>&nbsp;<span class="ident" id="5977432"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977379">nticks</a></span>&nbsp;<span class="op" id="5977439">==</span>&nbsp;<span class="num" id="5977442">0</span>&nbsp;<span class="op" id="5977444">||</span>&nbsp;<span class="ident" id="5977447"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977424">i</a></span>&nbsp;<span class="op" id="5977449">&lt;</span>&nbsp;<span class="ident" id="5977451"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977379">nticks</a></span><span class="op" id="5977457">;</span>&nbsp;<span class="ident" id="5977459"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977424">i</a></span><span class="op" id="5977460">++</span>&nbsp;<span class="op" id="5977463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977467">e</span>&nbsp;<span class="op" id="5977469">:=</span>&nbsp;<span class="ident" id="5977472"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977363">m</a></span><span class="op" id="5977473">.</span><span class="ident" id="5977474">Tick</span><span class="op" id="5977478">(</span><span class="op" id="5977479">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977483"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977412">n</a></span><span class="op" id="5977484">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977489">if</span>&nbsp;<span class="ident" id="5977492"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977467">e</a></span>&nbsp;<span class="op" id="5977494">!=</span>&nbsp;<span class="ident" id="5977497">nil</span>&nbsp;<span class="op" id="5977501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977506">return</span>&nbsp;<span class="ident" id="5977513"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977412">n</a></span><span class="op" id="5977514">,</span>&nbsp;<span class="ident" id="5977516"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977467">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977523">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977527">return</span>&nbsp;<span class="ident" id="5977534"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977412">n</a></span><span class="op" id="5977535">,</span>&nbsp;<span class="ident" id="5977537">nil</span><br>
<span class="lineno"></span><span class="op" id="5977541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5977544">//&nbsp;LoadImage&nbsp;loads&nbsp;an&nbsp;booting&nbsp;image&nbsp;from&nbsp;a&nbsp;reader&nbsp;and&nbsp;put&nbsp;it</span><br>
<span class="lineno">75</span><span class="comment" id="5977605">//&nbsp;at&nbsp;a&nbsp;particular&nbsp;offset&nbsp;in&nbsp;the&nbsp;physical&nbsp;memory.</span><br>
<span class="lineno"></span><span class="keyword" id="5977655">func</span>&nbsp;<span class="op" id="5977660">(</span><span class="ident" id="5977661">m</span>&nbsp;<span class="op" id="5977663">*</span><span class="ident" id="5977664"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976184">Machine</a></span><span class="op" id="5977671">)</span>&nbsp;<span class="ident" id="5977673">LoadImage</span><span class="op" id="5977682">(</span><span class="ident" id="5977683">r</span>&nbsp;<span class="ident" id="5977685"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976106">io</a></span><span class="op" id="5977687">.</span><span class="ident" id="5977688">Reader</span><span class="op" id="5977694">,</span>&nbsp;<span class="ident" id="5977696">offset</span>&nbsp;<span class="builtintype" id="5977703">uint32</span><span class="op" id="5977709">)</span>&nbsp;<span class="builtintype" id="5977711">error</span>&nbsp;<span class="op" id="5977717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977720">if</span>&nbsp;<span class="ident" id="5977723"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977696">offset</a></span><span class="op" id="5977729">%</span><span class="ident" id="5977730"><a href="/lonnie.io/e8vm/arch8/page.go.html#5979836">PageSize</a></span>&nbsp;<span class="op" id="5977739">!=</span>&nbsp;<span class="num" id="5977742">0</span>&nbsp;<span class="op" id="5977744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5977748">panic</span><span class="op" id="5977753">(</span><span class="string" id="5977754">&#34;boot&nbsp;image&nbsp;not&nbsp;page&nbsp;aligned&#34;</span><span class="op" id="5977783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977786">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977790">pn</span>&nbsp;<span class="op" id="5977793">:=</span>&nbsp;<span class="ident" id="5977796"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977696">offset</a></span>&nbsp;<span class="op" id="5977803">/</span>&nbsp;<span class="ident" id="5977805"><a href="/lonnie.io/e8vm/arch8/page.go.html#5979836">PageSize</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977816">for</span>&nbsp;<span class="op" id="5977820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977824">p</span>&nbsp;<span class="op" id="5977826">:=</span>&nbsp;<span class="ident" id="5977829"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977661">m</a></span><span class="op" id="5977830">.</span><span class="ident" id="5977831">phyMem</span><span class="op" id="5977837">.</span><span class="ident" id="5977838">Page</span><span class="op" id="5977842">(</span><span class="ident" id="5977843"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977790">pn</a></span><span class="op" id="5977845">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977849">if</span>&nbsp;<span class="ident" id="5977852"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977824">p</a></span>&nbsp;<span class="op" id="5977854">==</span>&nbsp;<span class="ident" id="5977857">nil</span>&nbsp;<span class="op" id="5977861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977866">return</span>&nbsp;<span class="ident" id="5977873"><a href="/lonnie.io/e8vm/arch8/exception.go.html#5966189">errOutOfRange</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977893">_</span><span class="op" id="5977894">,</span>&nbsp;<span class="ident" id="5977896">e</span>&nbsp;<span class="op" id="5977898">:=</span>&nbsp;<span class="ident" id="5977901"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977683">r</a></span><span class="op" id="5977902">.</span><span class="ident" id="5977903">Read</span><span class="op" id="5977907">(</span><span class="ident" id="5977908"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977824">p</a></span><span class="op" id="5977909">.</span><span class="ident" id="5977910">Bytes</span><span class="op" id="5977915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977919">if</span>&nbsp;<span class="ident" id="5977922"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977896">e</a></span>&nbsp;<span class="op" id="5977924">==</span>&nbsp;<span class="ident" id="5977927"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976106">io</a></span><span class="op" id="5977929">.</span><span class="ident" id="5977930">EOF</span>&nbsp;<span class="op" id="5977934">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977939">return</span>&nbsp;<span class="ident" id="5977946">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977952">}</span>&nbsp;<span class="keyword" id="5977954">else</span>&nbsp;<span class="keyword" id="5977959">if</span>&nbsp;<span class="ident" id="5977962"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977896">e</a></span>&nbsp;<span class="op" id="5977964">!=</span>&nbsp;<span class="ident" id="5977967">nil</span>&nbsp;<span class="op" id="5977971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5977976">return</span>&nbsp;<span class="ident" id="5977983"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977896">e</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5977992"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5977790">pn</a></span><span class="op" id="5977994">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5977998">}</span><br>
<span class="lineno"></span><span class="op" id="5978000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5978003">//&nbsp;PrintCoreStatus&nbsp;prints&nbsp;the&nbsp;cpu&nbsp;statuses.</span><br>
<span class="lineno">100</span><span class="keyword" id="5978047">func</span>&nbsp;<span class="op" id="5978052">(</span><span class="ident" id="5978053">m</span>&nbsp;<span class="op" id="5978055">*</span><span class="ident" id="5978056"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5976184">Machine</a></span><span class="op" id="5978063">)</span>&nbsp;<span class="ident" id="5978065">PrintCoreStatus</span><span class="op" id="5978080">(</span><span class="op" id="5978081">)</span>&nbsp;<span class="op" id="5978083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5978086"><a href="/lonnie.io/e8vm/arch8/machine.go.html#5978053">m</a></span><span class="op" id="5978087">.</span><span class="ident" id="5978088">cores</span><span class="op" id="5978093">.</span><span class="ident" id="5978094">PrintStatus</span><span class="op" id="5978105">(</span><span class="op" id="5978106">)</span><br>
<span class="lineno"></span><span class="op" id="5978108">}</span>
</div>
</body>
</html>
