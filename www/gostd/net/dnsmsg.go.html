<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4019216">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4019271">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4019325">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4019376">//&nbsp;DNS&nbsp;packet&nbsp;assembly.&nbsp;&nbsp;See&nbsp;RFC&nbsp;1035.</span><br>
<span class="lineno"></span><span class="comment" id="4019415">//</span><br>
<span class="lineno"></span><span class="comment" id="4019418">//&nbsp;This&nbsp;is&nbsp;intended&nbsp;to&nbsp;support&nbsp;name&nbsp;resolution&nbsp;during&nbsp;Dial.</span><br>
<span class="lineno"></span><span class="comment" id="4019478">//&nbsp;It&nbsp;doesn&#39;t&nbsp;have&nbsp;to&nbsp;be&nbsp;blazing&nbsp;fast.</span><br>
<span class="lineno"></span><span class="comment" id="4019517">//</span><br>
<span class="lineno">10</span><span class="comment" id="4019520">//&nbsp;Each&nbsp;message&nbsp;structure&nbsp;has&nbsp;a&nbsp;Walk&nbsp;method&nbsp;that&nbsp;is&nbsp;used&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="4019580">//&nbsp;a&nbsp;generic&nbsp;pack/unpack&nbsp;routine.&nbsp;Thus,&nbsp;if&nbsp;in&nbsp;the&nbsp;future&nbsp;we&nbsp;need</span><br>
<span class="lineno"></span><span class="comment" id="4019645">//&nbsp;to&nbsp;define&nbsp;new&nbsp;message&nbsp;structs,&nbsp;no&nbsp;new&nbsp;pack/unpack/printing&nbsp;code</span><br>
<span class="lineno"></span><span class="comment" id="4019712">//&nbsp;needs&nbsp;to&nbsp;be&nbsp;written.</span><br>
<span class="lineno"></span><span class="comment" id="4019736">//</span><br>
<span class="lineno">15</span><span class="comment" id="4019739">//&nbsp;The&nbsp;first&nbsp;half&nbsp;of&nbsp;this&nbsp;file&nbsp;defines&nbsp;the&nbsp;DNS&nbsp;message&nbsp;formats.</span><br>
<span class="lineno"></span><span class="comment" id="4019803">//&nbsp;The&nbsp;second&nbsp;half&nbsp;implements&nbsp;the&nbsp;conversion&nbsp;to&nbsp;and&nbsp;from&nbsp;wire&nbsp;format.</span><br>
<span class="lineno"></span><span class="comment" id="4019873">//&nbsp;A&nbsp;few&nbsp;of&nbsp;the&nbsp;structure&nbsp;elements&nbsp;have&nbsp;string&nbsp;tags&nbsp;to&nbsp;aid&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4019936">//&nbsp;generic&nbsp;pack/unpack&nbsp;routines.</span><br>
<span class="lineno"></span><span class="comment" id="4019969">//</span><br>
<span class="lineno">20</span><span class="comment" id="4019972">//&nbsp;TODO(rsc):&nbsp;&nbsp;There&nbsp;are&nbsp;enough&nbsp;names&nbsp;defined&nbsp;in&nbsp;this&nbsp;file&nbsp;that&nbsp;they&#39;re&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="4020048">//&nbsp;prefixed&nbsp;with&nbsp;dns.&nbsp;&nbsp;Perhaps&nbsp;put&nbsp;this&nbsp;in&nbsp;its&nbsp;own&nbsp;package&nbsp;later.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4020115">package</span>&nbsp;<span class="ident" id="4020123">net</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4020128">//&nbsp;Packet&nbsp;formats</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4020147">//&nbsp;Wire&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="4020166">const</span>&nbsp;<span class="op" id="4020172">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020175">//&nbsp;valid&nbsp;dnsRR_Header.Rrtype&nbsp;and&nbsp;dnsQuestion.qtype</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020227">dnsTypeA</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4020240">=</span>&nbsp;<span class="num" id="4020242">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020245">dnsTypeNS</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4020258">=</span>&nbsp;<span class="num" id="4020260">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020263">dnsTypeMD</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4020276">=</span>&nbsp;<span class="num" id="4020278">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020281">dnsTypeMF</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4020294">=</span>&nbsp;<span class="num" id="4020296">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020299">dnsTypeCNAME</span>&nbsp;<span class="op" id="4020312">=</span>&nbsp;<span class="num" id="4020314">5</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020317">dnsTypeSOA</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4020330">=</span>&nbsp;<span class="num" id="4020332">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020335">dnsTypeMB</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4020348">=</span>&nbsp;<span class="num" id="4020350">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020353">dnsTypeMG</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4020366">=</span>&nbsp;<span class="num" id="4020368">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020371">dnsTypeMR</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4020384">=</span>&nbsp;<span class="num" id="4020386">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020389">dnsTypeNULL</span>&nbsp;&nbsp;<span class="op" id="4020402">=</span>&nbsp;<span class="num" id="4020404">10</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020408">dnsTypeWKS</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4020421">=</span>&nbsp;<span class="num" id="4020423">11</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020427">dnsTypePTR</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4020440">=</span>&nbsp;<span class="num" id="4020442">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020446">dnsTypeHINFO</span>&nbsp;<span class="op" id="4020459">=</span>&nbsp;<span class="num" id="4020461">13</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020465">dnsTypeMINFO</span>&nbsp;<span class="op" id="4020478">=</span>&nbsp;<span class="num" id="4020480">14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020484">dnsTypeMX</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4020497">=</span>&nbsp;<span class="num" id="4020499">15</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020503">dnsTypeTXT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4020516">=</span>&nbsp;<span class="num" id="4020518">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020522">dnsTypeAAAA</span>&nbsp;&nbsp;<span class="op" id="4020535">=</span>&nbsp;<span class="num" id="4020537">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020541">dnsTypeSRV</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4020554">=</span>&nbsp;<span class="num" id="4020556">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020561">//&nbsp;valid&nbsp;dnsQuestion.qtype&nbsp;only</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020594">dnsTypeAXFR</span>&nbsp;&nbsp;<span class="op" id="4020607">=</span>&nbsp;<span class="num" id="4020609">252</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020614">dnsTypeMAILB</span>&nbsp;<span class="op" id="4020627">=</span>&nbsp;<span class="num" id="4020629">253</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020634">dnsTypeMAILA</span>&nbsp;<span class="op" id="4020647">=</span>&nbsp;<span class="num" id="4020649">254</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020654">dnsTypeALL</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4020667">=</span>&nbsp;<span class="num" id="4020669">255</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020675">//&nbsp;valid&nbsp;dnsQuestion.qclass</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020704">dnsClassINET</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4020719">=</span>&nbsp;<span class="num" id="4020721">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020724">dnsClassCSNET</span>&nbsp;&nbsp;<span class="op" id="4020739">=</span>&nbsp;<span class="num" id="4020741">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020744">dnsClassCHAOS</span>&nbsp;&nbsp;<span class="op" id="4020759">=</span>&nbsp;<span class="num" id="4020761">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020764">dnsClassHESIOD</span>&nbsp;<span class="op" id="4020779">=</span>&nbsp;<span class="num" id="4020781">4</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020784">dnsClassANY</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4020799">=</span>&nbsp;<span class="num" id="4020801">255</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4020807">//&nbsp;dnsMsg.rcode</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020824">dnsRcodeSuccess</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4020847">=</span>&nbsp;<span class="num" id="4020849">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020852">dnsRcodeFormatError</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4020875">=</span>&nbsp;<span class="num" id="4020877">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020880">dnsRcodeServerFailure</span>&nbsp;&nbsp;<span class="op" id="4020903">=</span>&nbsp;<span class="num" id="4020905">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020908">dnsRcodeNameError</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4020931">=</span>&nbsp;<span class="num" id="4020933">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020936">dnsRcodeNotImplemented</span>&nbsp;<span class="op" id="4020959">=</span>&nbsp;<span class="num" id="4020961">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4020964">dnsRcodeRefused</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4020987">=</span>&nbsp;<span class="num" id="4020989">5</span><br>
<span class="lineno"></span><span class="op" id="4020991">)</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="4020994">//&nbsp;A&nbsp;dnsStruct&nbsp;describes&nbsp;how&nbsp;to&nbsp;iterate&nbsp;over&nbsp;its&nbsp;fields&nbsp;to&nbsp;emulate</span><br>
<span class="lineno"></span><span class="comment" id="4021061">//&nbsp;reflective&nbsp;marshalling.</span><br>
<span class="lineno"></span><span class="keyword" id="4021088">type</span>&nbsp;<span class="ident" id="4021093">dnsStruct</span>&nbsp;<span class="keyword" id="4021103">interface</span>&nbsp;<span class="op" id="4021113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021116">//&nbsp;Walk&nbsp;iterates&nbsp;over&nbsp;fields&nbsp;of&nbsp;a&nbsp;structure&nbsp;and&nbsp;calls&nbsp;f</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021173">//&nbsp;with&nbsp;a&nbsp;reference&nbsp;to&nbsp;that&nbsp;field,&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021231">//&nbsp;and&nbsp;a&nbsp;tag&nbsp;(&#34;&#34;,&nbsp;&#34;domain&#34;,&nbsp;&#34;ipv4&#34;,&nbsp;&#34;ipv6&#34;)&nbsp;specifying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021287">//&nbsp;particular&nbsp;encodings.&nbsp;Possible&nbsp;concrete&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021337">//&nbsp;for&nbsp;v&nbsp;are&nbsp;*uint16,&nbsp;*uint32,&nbsp;*string,&nbsp;or&nbsp;[]byte,&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021393">//&nbsp;*int,&nbsp;*bool&nbsp;in&nbsp;the&nbsp;case&nbsp;of&nbsp;dnsMsgHdr.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021435">//&nbsp;Whenever&nbsp;f&nbsp;returns&nbsp;false,&nbsp;Walk&nbsp;must&nbsp;stop&nbsp;and&nbsp;return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4021491">//&nbsp;false,&nbsp;and&nbsp;otherwise&nbsp;return&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021529">Walk</span><span class="op" id="4021533">(</span><span class="ident" id="4021534">f</span>&nbsp;<span class="keyword" id="4021536">func</span><span class="op" id="4021540">(</span><span class="ident" id="4021541">v</span>&nbsp;<span class="keyword" id="4021543">interface</span><span class="op" id="4021552">{</span><span class="op" id="4021553">}</span><span class="op" id="4021554">,</span>&nbsp;<span class="ident" id="4021556">name</span><span class="op" id="4021560">,</span>&nbsp;<span class="ident" id="4021562">tag</span>&nbsp;<span class="builtintype" id="4021566">string</span><span class="op" id="4021572">)</span>&nbsp;<span class="op" id="4021574">(</span><span class="ident" id="4021575">ok</span>&nbsp;<span class="builtintype" id="4021578">bool</span><span class="op" id="4021582">)</span><span class="op" id="4021583">)</span>&nbsp;<span class="op" id="4021585">(</span><span class="ident" id="4021586">ok</span>&nbsp;<span class="builtintype" id="4021589">bool</span><span class="op" id="4021593">)</span><br>
<span class="lineno"></span><span class="op" id="4021595">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="comment" id="4021598">//&nbsp;The&nbsp;wire&nbsp;format&nbsp;for&nbsp;the&nbsp;DNS&nbsp;packet&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="4021644">type</span>&nbsp;<span class="ident" id="4021649">dnsHeader</span>&nbsp;<span class="keyword" id="4021659">struct</span>&nbsp;<span class="op" id="4021666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021669">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4021704">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021712">Bits</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4021747">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021755">Qdcount</span><span class="op" id="4021762">,</span>&nbsp;<span class="ident" id="4021764">Ancount</span><span class="op" id="4021771">,</span>&nbsp;<span class="ident" id="4021773">Nscount</span><span class="op" id="4021780">,</span>&nbsp;<span class="ident" id="4021782">Arcount</span>&nbsp;<span class="builtintype" id="4021790">uint16</span><br>
<span class="lineno">90</span><span class="op" id="4021797">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4021800">func</span>&nbsp;<span class="op" id="4021805">(</span><span class="ident" id="4021806">h</span>&nbsp;<span class="op" id="4021808">*</span><span class="ident" id="4021809">dnsHeader</span><span class="op" id="4021818">)</span>&nbsp;<span class="ident" id="4021820">Walk</span><span class="op" id="4021824">(</span><span class="ident" id="4021825">f</span>&nbsp;<span class="keyword" id="4021827">func</span><span class="op" id="4021831">(</span><span class="ident" id="4021832">v</span>&nbsp;<span class="keyword" id="4021834">interface</span><span class="op" id="4021843">{</span><span class="op" id="4021844">}</span><span class="op" id="4021845">,</span>&nbsp;<span class="ident" id="4021847">name</span><span class="op" id="4021851">,</span>&nbsp;<span class="ident" id="4021853">tag</span>&nbsp;<span class="builtintype" id="4021857">string</span><span class="op" id="4021863">)</span>&nbsp;<span class="builtintype" id="4021865">bool</span><span class="op" id="4021869">)</span>&nbsp;<span class="builtintype" id="4021871">bool</span>&nbsp;<span class="op" id="4021876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4021879">return</span>&nbsp;<span class="ident" id="4021886">f</span><span class="op" id="4021887">(</span><span class="op" id="4021888">&amp;</span><span class="ident" id="4021889">h</span><span class="op" id="4021890">.</span><span class="ident" id="4021891">Id</span><span class="op" id="4021893">,</span>&nbsp;<span class="string" id="4021895">&#34;Id&#34;</span><span class="op" id="4021899">,</span>&nbsp;<span class="string" id="4021901">&#34;&#34;</span><span class="op" id="4021903">)</span>&nbsp;<span class="op" id="4021905">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021910">f</span><span class="op" id="4021911">(</span><span class="op" id="4021912">&amp;</span><span class="ident" id="4021913">h</span><span class="op" id="4021914">.</span><span class="ident" id="4021915">Bits</span><span class="op" id="4021919">,</span>&nbsp;<span class="string" id="4021921">&#34;Bits&#34;</span><span class="op" id="4021927">,</span>&nbsp;<span class="string" id="4021929">&#34;&#34;</span><span class="op" id="4021931">)</span>&nbsp;<span class="op" id="4021933">&amp;&amp;</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021938">f</span><span class="op" id="4021939">(</span><span class="op" id="4021940">&amp;</span><span class="ident" id="4021941">h</span><span class="op" id="4021942">.</span><span class="ident" id="4021943">Qdcount</span><span class="op" id="4021950">,</span>&nbsp;<span class="string" id="4021952">&#34;Qdcount&#34;</span><span class="op" id="4021961">,</span>&nbsp;<span class="string" id="4021963">&#34;&#34;</span><span class="op" id="4021965">)</span>&nbsp;<span class="op" id="4021967">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4021972">f</span><span class="op" id="4021973">(</span><span class="op" id="4021974">&amp;</span><span class="ident" id="4021975">h</span><span class="op" id="4021976">.</span><span class="ident" id="4021977">Ancount</span><span class="op" id="4021984">,</span>&nbsp;<span class="string" id="4021986">&#34;Ancount&#34;</span><span class="op" id="4021995">,</span>&nbsp;<span class="string" id="4021997">&#34;&#34;</span><span class="op" id="4021999">)</span>&nbsp;<span class="op" id="4022001">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022006">f</span><span class="op" id="4022007">(</span><span class="op" id="4022008">&amp;</span><span class="ident" id="4022009">h</span><span class="op" id="4022010">.</span><span class="ident" id="4022011">Nscount</span><span class="op" id="4022018">,</span>&nbsp;<span class="string" id="4022020">&#34;Nscount&#34;</span><span class="op" id="4022029">,</span>&nbsp;<span class="string" id="4022031">&#34;&#34;</span><span class="op" id="4022033">)</span>&nbsp;<span class="op" id="4022035">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022040">f</span><span class="op" id="4022041">(</span><span class="op" id="4022042">&amp;</span><span class="ident" id="4022043">h</span><span class="op" id="4022044">.</span><span class="ident" id="4022045">Arcount</span><span class="op" id="4022052">,</span>&nbsp;<span class="string" id="4022054">&#34;Arcount&#34;</span><span class="op" id="4022063">,</span>&nbsp;<span class="string" id="4022065">&#34;&#34;</span><span class="op" id="4022067">)</span><br>
<span class="lineno"></span><span class="op" id="4022069">}</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span><span class="keyword" id="4022072">const</span>&nbsp;<span class="op" id="4022078">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4022081">//&nbsp;dnsHeader.Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022100">_QR</span>&nbsp;<span class="op" id="4022104">=</span>&nbsp;<span class="num" id="4022106">1</span>&nbsp;<span class="op" id="4022108">&lt;&lt;</span>&nbsp;<span class="num" id="4022111">15</span>&nbsp;<span class="comment" id="4022114">//&nbsp;query/response&nbsp;(response=1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022146">_AA</span>&nbsp;<span class="op" id="4022150">=</span>&nbsp;<span class="num" id="4022152">1</span>&nbsp;<span class="op" id="4022154">&lt;&lt;</span>&nbsp;<span class="num" id="4022157">10</span>&nbsp;<span class="comment" id="4022160">//&nbsp;authoritative</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022178">_TC</span>&nbsp;<span class="op" id="4022182">=</span>&nbsp;<span class="num" id="4022184">1</span>&nbsp;<span class="op" id="4022186">&lt;&lt;</span>&nbsp;<span class="num" id="4022189">9</span>&nbsp;&nbsp;<span class="comment" id="4022192">//&nbsp;truncated</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022206">_RD</span>&nbsp;<span class="op" id="4022210">=</span>&nbsp;<span class="num" id="4022212">1</span>&nbsp;<span class="op" id="4022214">&lt;&lt;</span>&nbsp;<span class="num" id="4022217">8</span>&nbsp;&nbsp;<span class="comment" id="4022220">//&nbsp;recursion&nbsp;desired</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022242">_RA</span>&nbsp;<span class="op" id="4022246">=</span>&nbsp;<span class="num" id="4022248">1</span>&nbsp;<span class="op" id="4022250">&lt;&lt;</span>&nbsp;<span class="num" id="4022253">7</span>&nbsp;&nbsp;<span class="comment" id="4022256">//&nbsp;recursion&nbsp;available</span><br>
<span class="lineno"></span><span class="op" id="4022279">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="4022282">//&nbsp;DNS&nbsp;queries.</span><br>
<span class="lineno"></span><span class="keyword" id="4022298">type</span>&nbsp;<span class="ident" id="4022303">dnsQuestion</span>&nbsp;<span class="keyword" id="4022315">struct</span>&nbsp;<span class="op" id="4022322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022325">Name</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4022332">string</span>&nbsp;<span class="string" id="4022339">`net:&#34;domain-name&#34;`</span>&nbsp;<span class="comment" id="4022359">//&nbsp;`net:&#34;domain-name&#34;`&nbsp;specifies&nbsp;encoding;&nbsp;see&nbsp;packers&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022421">Qtype</span>&nbsp;&nbsp;<span class="builtintype" id="4022428">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022436">Qclass</span>&nbsp;<span class="builtintype" id="4022443">uint16</span><br>
<span class="lineno">115</span><span class="op" id="4022450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4022453">func</span>&nbsp;<span class="op" id="4022458">(</span><span class="ident" id="4022459">q</span>&nbsp;<span class="op" id="4022461">*</span><span class="ident" id="4022462">dnsQuestion</span><span class="op" id="4022473">)</span>&nbsp;<span class="ident" id="4022475">Walk</span><span class="op" id="4022479">(</span><span class="ident" id="4022480">f</span>&nbsp;<span class="keyword" id="4022482">func</span><span class="op" id="4022486">(</span><span class="ident" id="4022487">v</span>&nbsp;<span class="keyword" id="4022489">interface</span><span class="op" id="4022498">{</span><span class="op" id="4022499">}</span><span class="op" id="4022500">,</span>&nbsp;<span class="ident" id="4022502">name</span><span class="op" id="4022506">,</span>&nbsp;<span class="ident" id="4022508">tag</span>&nbsp;<span class="builtintype" id="4022512">string</span><span class="op" id="4022518">)</span>&nbsp;<span class="builtintype" id="4022520">bool</span><span class="op" id="4022524">)</span>&nbsp;<span class="builtintype" id="4022526">bool</span>&nbsp;<span class="op" id="4022531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4022534">return</span>&nbsp;<span class="ident" id="4022541">f</span><span class="op" id="4022542">(</span><span class="op" id="4022543">&amp;</span><span class="ident" id="4022544">q</span><span class="op" id="4022545">.</span><span class="ident" id="4022546">Name</span><span class="op" id="4022550">,</span>&nbsp;<span class="string" id="4022552">&#34;Name&#34;</span><span class="op" id="4022558">,</span>&nbsp;<span class="string" id="4022560">&#34;domain&#34;</span><span class="op" id="4022568">)</span>&nbsp;<span class="op" id="4022570">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022575">f</span><span class="op" id="4022576">(</span><span class="op" id="4022577">&amp;</span><span class="ident" id="4022578">q</span><span class="op" id="4022579">.</span><span class="ident" id="4022580">Qtype</span><span class="op" id="4022585">,</span>&nbsp;<span class="string" id="4022587">&#34;Qtype&#34;</span><span class="op" id="4022594">,</span>&nbsp;<span class="string" id="4022596">&#34;&#34;</span><span class="op" id="4022598">)</span>&nbsp;<span class="op" id="4022600">&amp;&amp;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022605">f</span><span class="op" id="4022606">(</span><span class="op" id="4022607">&amp;</span><span class="ident" id="4022608">q</span><span class="op" id="4022609">.</span><span class="ident" id="4022610">Qclass</span><span class="op" id="4022616">,</span>&nbsp;<span class="string" id="4022618">&#34;Qclass&#34;</span><span class="op" id="4022626">,</span>&nbsp;<span class="string" id="4022628">&#34;&#34;</span><span class="op" id="4022630">)</span><br>
<span class="lineno"></span><span class="op" id="4022632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4022635">//&nbsp;DNS&nbsp;responses&nbsp;(resource&nbsp;records).</span><br>
<span class="lineno"></span><span class="comment" id="4022672">//&nbsp;There&nbsp;are&nbsp;many&nbsp;types&nbsp;of&nbsp;messages,</span><br>
<span class="lineno">125</span><span class="comment" id="4022709">//&nbsp;but&nbsp;they&nbsp;all&nbsp;share&nbsp;the&nbsp;same&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="4022748">type</span>&nbsp;<span class="ident" id="4022753">dnsRR_Header</span>&nbsp;<span class="keyword" id="4022766">struct</span>&nbsp;<span class="op" id="4022773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022776">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4022785">string</span>&nbsp;<span class="string" id="4022792">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022813">Rrtype</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4022822">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022830">Class</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4022839">uint16</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022847">Ttl</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4022856">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4022864">Rdlength</span>&nbsp;<span class="builtintype" id="4022873">uint16</span>&nbsp;<span class="comment" id="4022880">//&nbsp;length&nbsp;of&nbsp;data&nbsp;after&nbsp;header</span><br>
<span class="lineno"></span><span class="op" id="4022911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4022914">func</span>&nbsp;<span class="op" id="4022919">(</span><span class="ident" id="4022920">h</span>&nbsp;<span class="op" id="4022922">*</span><span class="ident" id="4022923">dnsRR_Header</span><span class="op" id="4022935">)</span>&nbsp;<span class="ident" id="4022937">Header</span><span class="op" id="4022943">(</span><span class="op" id="4022944">)</span>&nbsp;<span class="op" id="4022946">*</span><span class="ident" id="4022947">dnsRR_Header</span>&nbsp;<span class="op" id="4022960">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4022963">return</span>&nbsp;<span class="ident" id="4022970">h</span><br>
<span class="lineno"></span><span class="op" id="4022972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4022975">func</span>&nbsp;<span class="op" id="4022980">(</span><span class="ident" id="4022981">h</span>&nbsp;<span class="op" id="4022983">*</span><span class="ident" id="4022984">dnsRR_Header</span><span class="op" id="4022996">)</span>&nbsp;<span class="ident" id="4022998">Walk</span><span class="op" id="4023002">(</span><span class="ident" id="4023003">f</span>&nbsp;<span class="keyword" id="4023005">func</span><span class="op" id="4023009">(</span><span class="ident" id="4023010">v</span>&nbsp;<span class="keyword" id="4023012">interface</span><span class="op" id="4023021">{</span><span class="op" id="4023022">}</span><span class="op" id="4023023">,</span>&nbsp;<span class="ident" id="4023025">name</span><span class="op" id="4023029">,</span>&nbsp;<span class="ident" id="4023031">tag</span>&nbsp;<span class="builtintype" id="4023035">string</span><span class="op" id="4023041">)</span>&nbsp;<span class="builtintype" id="4023043">bool</span><span class="op" id="4023047">)</span>&nbsp;<span class="builtintype" id="4023049">bool</span>&nbsp;<span class="op" id="4023054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023057">return</span>&nbsp;<span class="ident" id="4023064">f</span><span class="op" id="4023065">(</span><span class="op" id="4023066">&amp;</span><span class="ident" id="4023067">h</span><span class="op" id="4023068">.</span><span class="ident" id="4023069">Name</span><span class="op" id="4023073">,</span>&nbsp;<span class="string" id="4023075">&#34;Name&#34;</span><span class="op" id="4023081">,</span>&nbsp;<span class="string" id="4023083">&#34;domain&#34;</span><span class="op" id="4023091">)</span>&nbsp;<span class="op" id="4023093">&amp;&amp;</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023098">f</span><span class="op" id="4023099">(</span><span class="op" id="4023100">&amp;</span><span class="ident" id="4023101">h</span><span class="op" id="4023102">.</span><span class="ident" id="4023103">Rrtype</span><span class="op" id="4023109">,</span>&nbsp;<span class="string" id="4023111">&#34;Rrtype&#34;</span><span class="op" id="4023119">,</span>&nbsp;<span class="string" id="4023121">&#34;&#34;</span><span class="op" id="4023123">)</span>&nbsp;<span class="op" id="4023125">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023130">f</span><span class="op" id="4023131">(</span><span class="op" id="4023132">&amp;</span><span class="ident" id="4023133">h</span><span class="op" id="4023134">.</span><span class="ident" id="4023135">Class</span><span class="op" id="4023140">,</span>&nbsp;<span class="string" id="4023142">&#34;Class&#34;</span><span class="op" id="4023149">,</span>&nbsp;<span class="string" id="4023151">&#34;&#34;</span><span class="op" id="4023153">)</span>&nbsp;<span class="op" id="4023155">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023160">f</span><span class="op" id="4023161">(</span><span class="op" id="4023162">&amp;</span><span class="ident" id="4023163">h</span><span class="op" id="4023164">.</span><span class="ident" id="4023165">Ttl</span><span class="op" id="4023168">,</span>&nbsp;<span class="string" id="4023170">&#34;Ttl&#34;</span><span class="op" id="4023175">,</span>&nbsp;<span class="string" id="4023177">&#34;&#34;</span><span class="op" id="4023179">)</span>&nbsp;<span class="op" id="4023181">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023186">f</span><span class="op" id="4023187">(</span><span class="op" id="4023188">&amp;</span><span class="ident" id="4023189">h</span><span class="op" id="4023190">.</span><span class="ident" id="4023191">Rdlength</span><span class="op" id="4023199">,</span>&nbsp;<span class="string" id="4023201">&#34;Rdlength&#34;</span><span class="op" id="4023211">,</span>&nbsp;<span class="string" id="4023213">&#34;&#34;</span><span class="op" id="4023215">)</span><br>
<span class="lineno"></span><span class="op" id="4023217">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="keyword" id="4023220">type</span>&nbsp;<span class="ident" id="4023225">dnsRR</span>&nbsp;<span class="keyword" id="4023231">interface</span>&nbsp;<span class="op" id="4023241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023244">dnsStruct</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023255">Header</span><span class="op" id="4023261">(</span><span class="op" id="4023262">)</span>&nbsp;<span class="op" id="4023264">*</span><span class="ident" id="4023265">dnsRR_Header</span><br>
<span class="lineno"></span><span class="op" id="4023278">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="comment" id="4023281">//&nbsp;Specific&nbsp;DNS&nbsp;RR&nbsp;formats&nbsp;for&nbsp;each&nbsp;query&nbsp;type.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4023330">type</span>&nbsp;<span class="ident" id="4023335">dnsRR_CNAME</span>&nbsp;<span class="keyword" id="4023347">struct</span>&nbsp;<span class="op" id="4023354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023357">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4023363">dnsRR_Header</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023377">Cname</span>&nbsp;<span class="builtintype" id="4023383">string</span>&nbsp;<span class="string" id="4023390">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4023410">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4023413">func</span>&nbsp;<span class="op" id="4023418">(</span><span class="ident" id="4023419">rr</span>&nbsp;<span class="op" id="4023422">*</span><span class="ident" id="4023423">dnsRR_CNAME</span><span class="op" id="4023434">)</span>&nbsp;<span class="ident" id="4023436">Header</span><span class="op" id="4023442">(</span><span class="op" id="4023443">)</span>&nbsp;<span class="op" id="4023445">*</span><span class="ident" id="4023446">dnsRR_Header</span>&nbsp;<span class="op" id="4023459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023462">return</span>&nbsp;<span class="op" id="4023469">&amp;</span><span class="ident" id="4023470">rr</span><span class="op" id="4023472">.</span><span class="ident" id="4023473">Hdr</span><br>
<span class="lineno">160</span><span class="op" id="4023477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4023480">func</span>&nbsp;<span class="op" id="4023485">(</span><span class="ident" id="4023486">rr</span>&nbsp;<span class="op" id="4023489">*</span><span class="ident" id="4023490">dnsRR_CNAME</span><span class="op" id="4023501">)</span>&nbsp;<span class="ident" id="4023503">Walk</span><span class="op" id="4023507">(</span><span class="ident" id="4023508">f</span>&nbsp;<span class="keyword" id="4023510">func</span><span class="op" id="4023514">(</span><span class="ident" id="4023515">v</span>&nbsp;<span class="keyword" id="4023517">interface</span><span class="op" id="4023526">{</span><span class="op" id="4023527">}</span><span class="op" id="4023528">,</span>&nbsp;<span class="ident" id="4023530">name</span><span class="op" id="4023534">,</span>&nbsp;<span class="ident" id="4023536">tag</span>&nbsp;<span class="builtintype" id="4023540">string</span><span class="op" id="4023546">)</span>&nbsp;<span class="builtintype" id="4023548">bool</span><span class="op" id="4023552">)</span>&nbsp;<span class="builtintype" id="4023554">bool</span>&nbsp;<span class="op" id="4023559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023562">return</span>&nbsp;<span class="ident" id="4023569">rr</span><span class="op" id="4023571">.</span><span class="ident" id="4023572">Hdr</span><span class="op" id="4023575">.</span><span class="ident" id="4023576">Walk</span><span class="op" id="4023580">(</span><span class="ident" id="4023581">f</span><span class="op" id="4023582">)</span>&nbsp;<span class="op" id="4023584">&amp;&amp;</span>&nbsp;<span class="ident" id="4023587">f</span><span class="op" id="4023588">(</span><span class="op" id="4023589">&amp;</span><span class="ident" id="4023590">rr</span><span class="op" id="4023592">.</span><span class="ident" id="4023593">Cname</span><span class="op" id="4023598">,</span>&nbsp;<span class="string" id="4023600">&#34;Cname&#34;</span><span class="op" id="4023607">,</span>&nbsp;<span class="string" id="4023609">&#34;domain&#34;</span><span class="op" id="4023617">)</span><br>
<span class="lineno"></span><span class="op" id="4023619">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="4023622">type</span>&nbsp;<span class="ident" id="4023627">dnsRR_HINFO</span>&nbsp;<span class="keyword" id="4023639">struct</span>&nbsp;<span class="op" id="4023646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023649">Hdr</span>&nbsp;<span class="ident" id="4023653">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023667">Cpu</span>&nbsp;<span class="builtintype" id="4023671">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023679">Os</span>&nbsp;&nbsp;<span class="builtintype" id="4023683">string</span><br>
<span class="lineno">170</span><span class="op" id="4023690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4023693">func</span>&nbsp;<span class="op" id="4023698">(</span><span class="ident" id="4023699">rr</span>&nbsp;<span class="op" id="4023702">*</span><span class="ident" id="4023703">dnsRR_HINFO</span><span class="op" id="4023714">)</span>&nbsp;<span class="ident" id="4023716">Header</span><span class="op" id="4023722">(</span><span class="op" id="4023723">)</span>&nbsp;<span class="op" id="4023725">*</span><span class="ident" id="4023726">dnsRR_Header</span>&nbsp;<span class="op" id="4023739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023742">return</span>&nbsp;<span class="op" id="4023749">&amp;</span><span class="ident" id="4023750">rr</span><span class="op" id="4023752">.</span><span class="ident" id="4023753">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4023757">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="4023760">func</span>&nbsp;<span class="op" id="4023765">(</span><span class="ident" id="4023766">rr</span>&nbsp;<span class="op" id="4023769">*</span><span class="ident" id="4023770">dnsRR_HINFO</span><span class="op" id="4023781">)</span>&nbsp;<span class="ident" id="4023783">Walk</span><span class="op" id="4023787">(</span><span class="ident" id="4023788">f</span>&nbsp;<span class="keyword" id="4023790">func</span><span class="op" id="4023794">(</span><span class="ident" id="4023795">v</span>&nbsp;<span class="keyword" id="4023797">interface</span><span class="op" id="4023806">{</span><span class="op" id="4023807">}</span><span class="op" id="4023808">,</span>&nbsp;<span class="ident" id="4023810">name</span><span class="op" id="4023814">,</span>&nbsp;<span class="ident" id="4023816">tag</span>&nbsp;<span class="builtintype" id="4023820">string</span><span class="op" id="4023826">)</span>&nbsp;<span class="builtintype" id="4023828">bool</span><span class="op" id="4023832">)</span>&nbsp;<span class="builtintype" id="4023834">bool</span>&nbsp;<span class="op" id="4023839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4023842">return</span>&nbsp;<span class="ident" id="4023849">rr</span><span class="op" id="4023851">.</span><span class="ident" id="4023852">Hdr</span><span class="op" id="4023855">.</span><span class="ident" id="4023856">Walk</span><span class="op" id="4023860">(</span><span class="ident" id="4023861">f</span><span class="op" id="4023862">)</span>&nbsp;<span class="op" id="4023864">&amp;&amp;</span>&nbsp;<span class="ident" id="4023867">f</span><span class="op" id="4023868">(</span><span class="op" id="4023869">&amp;</span><span class="ident" id="4023870">rr</span><span class="op" id="4023872">.</span><span class="ident" id="4023873">Cpu</span><span class="op" id="4023876">,</span>&nbsp;<span class="string" id="4023878">&#34;Cpu&#34;</span><span class="op" id="4023883">,</span>&nbsp;<span class="string" id="4023885">&#34;&#34;</span><span class="op" id="4023887">)</span>&nbsp;<span class="op" id="4023889">&amp;&amp;</span>&nbsp;<span class="ident" id="4023892">f</span><span class="op" id="4023893">(</span><span class="op" id="4023894">&amp;</span><span class="ident" id="4023895">rr</span><span class="op" id="4023897">.</span><span class="ident" id="4023898">Os</span><span class="op" id="4023900">,</span>&nbsp;<span class="string" id="4023902">&#34;Os&#34;</span><span class="op" id="4023906">,</span>&nbsp;<span class="string" id="4023908">&#34;&#34;</span><span class="op" id="4023910">)</span><br>
<span class="lineno"></span><span class="op" id="4023912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="4023915">type</span>&nbsp;<span class="ident" id="4023920">dnsRR_MB</span>&nbsp;<span class="keyword" id="4023929">struct</span>&nbsp;<span class="op" id="4023936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023939">Hdr</span>&nbsp;<span class="ident" id="4023943">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4023957">Mb</span>&nbsp;&nbsp;<span class="builtintype" id="4023961">string</span>&nbsp;<span class="string" id="4023968">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4023988">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="4023991">func</span>&nbsp;<span class="op" id="4023996">(</span><span class="ident" id="4023997">rr</span>&nbsp;<span class="op" id="4024000">*</span><span class="ident" id="4024001">dnsRR_MB</span><span class="op" id="4024009">)</span>&nbsp;<span class="ident" id="4024011">Header</span><span class="op" id="4024017">(</span><span class="op" id="4024018">)</span>&nbsp;<span class="op" id="4024020">*</span><span class="ident" id="4024021">dnsRR_Header</span>&nbsp;<span class="op" id="4024034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024037">return</span>&nbsp;<span class="op" id="4024044">&amp;</span><span class="ident" id="4024045">rr</span><span class="op" id="4024047">.</span><span class="ident" id="4024048">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4024052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4024055">func</span>&nbsp;<span class="op" id="4024060">(</span><span class="ident" id="4024061">rr</span>&nbsp;<span class="op" id="4024064">*</span><span class="ident" id="4024065">dnsRR_MB</span><span class="op" id="4024073">)</span>&nbsp;<span class="ident" id="4024075">Walk</span><span class="op" id="4024079">(</span><span class="ident" id="4024080">f</span>&nbsp;<span class="keyword" id="4024082">func</span><span class="op" id="4024086">(</span><span class="ident" id="4024087">v</span>&nbsp;<span class="keyword" id="4024089">interface</span><span class="op" id="4024098">{</span><span class="op" id="4024099">}</span><span class="op" id="4024100">,</span>&nbsp;<span class="ident" id="4024102">name</span><span class="op" id="4024106">,</span>&nbsp;<span class="ident" id="4024108">tag</span>&nbsp;<span class="builtintype" id="4024112">string</span><span class="op" id="4024118">)</span>&nbsp;<span class="builtintype" id="4024120">bool</span><span class="op" id="4024124">)</span>&nbsp;<span class="builtintype" id="4024126">bool</span>&nbsp;<span class="op" id="4024131">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024134">return</span>&nbsp;<span class="ident" id="4024141">rr</span><span class="op" id="4024143">.</span><span class="ident" id="4024144">Hdr</span><span class="op" id="4024147">.</span><span class="ident" id="4024148">Walk</span><span class="op" id="4024152">(</span><span class="ident" id="4024153">f</span><span class="op" id="4024154">)</span>&nbsp;<span class="op" id="4024156">&amp;&amp;</span>&nbsp;<span class="ident" id="4024159">f</span><span class="op" id="4024160">(</span><span class="op" id="4024161">&amp;</span><span class="ident" id="4024162">rr</span><span class="op" id="4024164">.</span><span class="ident" id="4024165">Mb</span><span class="op" id="4024167">,</span>&nbsp;<span class="string" id="4024169">&#34;Mb&#34;</span><span class="op" id="4024173">,</span>&nbsp;<span class="string" id="4024175">&#34;domain&#34;</span><span class="op" id="4024183">)</span><br>
<span class="lineno"></span><span class="op" id="4024185">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4024188">type</span>&nbsp;<span class="ident" id="4024193">dnsRR_MG</span>&nbsp;<span class="keyword" id="4024202">struct</span>&nbsp;<span class="op" id="4024209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024212">Hdr</span>&nbsp;<span class="ident" id="4024216">dnsRR_Header</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024230">Mg</span>&nbsp;&nbsp;<span class="builtintype" id="4024234">string</span>&nbsp;<span class="string" id="4024241">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4024261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4024264">func</span>&nbsp;<span class="op" id="4024269">(</span><span class="ident" id="4024270">rr</span>&nbsp;<span class="op" id="4024273">*</span><span class="ident" id="4024274">dnsRR_MG</span><span class="op" id="4024282">)</span>&nbsp;<span class="ident" id="4024284">Header</span><span class="op" id="4024290">(</span><span class="op" id="4024291">)</span>&nbsp;<span class="op" id="4024293">*</span><span class="ident" id="4024294">dnsRR_Header</span>&nbsp;<span class="op" id="4024307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024310">return</span>&nbsp;<span class="op" id="4024317">&amp;</span><span class="ident" id="4024318">rr</span><span class="op" id="4024320">.</span><span class="ident" id="4024321">Hdr</span><br>
<span class="lineno">200</span><span class="op" id="4024325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4024328">func</span>&nbsp;<span class="op" id="4024333">(</span><span class="ident" id="4024334">rr</span>&nbsp;<span class="op" id="4024337">*</span><span class="ident" id="4024338">dnsRR_MG</span><span class="op" id="4024346">)</span>&nbsp;<span class="ident" id="4024348">Walk</span><span class="op" id="4024352">(</span><span class="ident" id="4024353">f</span>&nbsp;<span class="keyword" id="4024355">func</span><span class="op" id="4024359">(</span><span class="ident" id="4024360">v</span>&nbsp;<span class="keyword" id="4024362">interface</span><span class="op" id="4024371">{</span><span class="op" id="4024372">}</span><span class="op" id="4024373">,</span>&nbsp;<span class="ident" id="4024375">name</span><span class="op" id="4024379">,</span>&nbsp;<span class="ident" id="4024381">tag</span>&nbsp;<span class="builtintype" id="4024385">string</span><span class="op" id="4024391">)</span>&nbsp;<span class="builtintype" id="4024393">bool</span><span class="op" id="4024397">)</span>&nbsp;<span class="builtintype" id="4024399">bool</span>&nbsp;<span class="op" id="4024404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024407">return</span>&nbsp;<span class="ident" id="4024414">rr</span><span class="op" id="4024416">.</span><span class="ident" id="4024417">Hdr</span><span class="op" id="4024420">.</span><span class="ident" id="4024421">Walk</span><span class="op" id="4024425">(</span><span class="ident" id="4024426">f</span><span class="op" id="4024427">)</span>&nbsp;<span class="op" id="4024429">&amp;&amp;</span>&nbsp;<span class="ident" id="4024432">f</span><span class="op" id="4024433">(</span><span class="op" id="4024434">&amp;</span><span class="ident" id="4024435">rr</span><span class="op" id="4024437">.</span><span class="ident" id="4024438">Mg</span><span class="op" id="4024440">,</span>&nbsp;<span class="string" id="4024442">&#34;Mg&#34;</span><span class="op" id="4024446">,</span>&nbsp;<span class="string" id="4024448">&#34;domain&#34;</span><span class="op" id="4024456">)</span><br>
<span class="lineno"></span><span class="op" id="4024458">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="4024461">type</span>&nbsp;<span class="ident" id="4024466">dnsRR_MINFO</span>&nbsp;<span class="keyword" id="4024478">struct</span>&nbsp;<span class="op" id="4024485">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024488">Hdr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4024494">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024508">Rmail</span>&nbsp;<span class="builtintype" id="4024514">string</span>&nbsp;<span class="string" id="4024521">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024542">Email</span>&nbsp;<span class="builtintype" id="4024548">string</span>&nbsp;<span class="string" id="4024555">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">210</span><span class="op" id="4024575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4024578">func</span>&nbsp;<span class="op" id="4024583">(</span><span class="ident" id="4024584">rr</span>&nbsp;<span class="op" id="4024587">*</span><span class="ident" id="4024588">dnsRR_MINFO</span><span class="op" id="4024599">)</span>&nbsp;<span class="ident" id="4024601">Header</span><span class="op" id="4024607">(</span><span class="op" id="4024608">)</span>&nbsp;<span class="op" id="4024610">*</span><span class="ident" id="4024611">dnsRR_Header</span>&nbsp;<span class="op" id="4024624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024627">return</span>&nbsp;<span class="op" id="4024634">&amp;</span><span class="ident" id="4024635">rr</span><span class="op" id="4024637">.</span><span class="ident" id="4024638">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4024642">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="4024645">func</span>&nbsp;<span class="op" id="4024650">(</span><span class="ident" id="4024651">rr</span>&nbsp;<span class="op" id="4024654">*</span><span class="ident" id="4024655">dnsRR_MINFO</span><span class="op" id="4024666">)</span>&nbsp;<span class="ident" id="4024668">Walk</span><span class="op" id="4024672">(</span><span class="ident" id="4024673">f</span>&nbsp;<span class="keyword" id="4024675">func</span><span class="op" id="4024679">(</span><span class="ident" id="4024680">v</span>&nbsp;<span class="keyword" id="4024682">interface</span><span class="op" id="4024691">{</span><span class="op" id="4024692">}</span><span class="op" id="4024693">,</span>&nbsp;<span class="ident" id="4024695">name</span><span class="op" id="4024699">,</span>&nbsp;<span class="ident" id="4024701">tag</span>&nbsp;<span class="builtintype" id="4024705">string</span><span class="op" id="4024711">)</span>&nbsp;<span class="builtintype" id="4024713">bool</span><span class="op" id="4024717">)</span>&nbsp;<span class="builtintype" id="4024719">bool</span>&nbsp;<span class="op" id="4024724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024727">return</span>&nbsp;<span class="ident" id="4024734">rr</span><span class="op" id="4024736">.</span><span class="ident" id="4024737">Hdr</span><span class="op" id="4024740">.</span><span class="ident" id="4024741">Walk</span><span class="op" id="4024745">(</span><span class="ident" id="4024746">f</span><span class="op" id="4024747">)</span>&nbsp;<span class="op" id="4024749">&amp;&amp;</span>&nbsp;<span class="ident" id="4024752">f</span><span class="op" id="4024753">(</span><span class="op" id="4024754">&amp;</span><span class="ident" id="4024755">rr</span><span class="op" id="4024757">.</span><span class="ident" id="4024758">Rmail</span><span class="op" id="4024763">,</span>&nbsp;<span class="string" id="4024765">&#34;Rmail&#34;</span><span class="op" id="4024772">,</span>&nbsp;<span class="string" id="4024774">&#34;domain&#34;</span><span class="op" id="4024782">)</span>&nbsp;<span class="op" id="4024784">&amp;&amp;</span>&nbsp;<span class="ident" id="4024787">f</span><span class="op" id="4024788">(</span><span class="op" id="4024789">&amp;</span><span class="ident" id="4024790">rr</span><span class="op" id="4024792">.</span><span class="ident" id="4024793">Email</span><span class="op" id="4024798">,</span>&nbsp;<span class="string" id="4024800">&#34;Email&#34;</span><span class="op" id="4024807">,</span>&nbsp;<span class="string" id="4024809">&#34;domain&#34;</span><span class="op" id="4024817">)</span><br>
<span class="lineno"></span><span class="op" id="4024819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="keyword" id="4024822">type</span>&nbsp;<span class="ident" id="4024827">dnsRR_MR</span>&nbsp;<span class="keyword" id="4024836">struct</span>&nbsp;<span class="op" id="4024843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024846">Hdr</span>&nbsp;<span class="ident" id="4024850">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4024864">Mr</span>&nbsp;&nbsp;<span class="builtintype" id="4024868">string</span>&nbsp;<span class="string" id="4024875">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4024895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="4024898">func</span>&nbsp;<span class="op" id="4024903">(</span><span class="ident" id="4024904">rr</span>&nbsp;<span class="op" id="4024907">*</span><span class="ident" id="4024908">dnsRR_MR</span><span class="op" id="4024916">)</span>&nbsp;<span class="ident" id="4024918">Header</span><span class="op" id="4024924">(</span><span class="op" id="4024925">)</span>&nbsp;<span class="op" id="4024927">*</span><span class="ident" id="4024928">dnsRR_Header</span>&nbsp;<span class="op" id="4024941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4024944">return</span>&nbsp;<span class="op" id="4024951">&amp;</span><span class="ident" id="4024952">rr</span><span class="op" id="4024954">.</span><span class="ident" id="4024955">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4024959">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4024962">func</span>&nbsp;<span class="op" id="4024967">(</span><span class="ident" id="4024968">rr</span>&nbsp;<span class="op" id="4024971">*</span><span class="ident" id="4024972">dnsRR_MR</span><span class="op" id="4024980">)</span>&nbsp;<span class="ident" id="4024982">Walk</span><span class="op" id="4024986">(</span><span class="ident" id="4024987">f</span>&nbsp;<span class="keyword" id="4024989">func</span><span class="op" id="4024993">(</span><span class="ident" id="4024994">v</span>&nbsp;<span class="keyword" id="4024996">interface</span><span class="op" id="4025005">{</span><span class="op" id="4025006">}</span><span class="op" id="4025007">,</span>&nbsp;<span class="ident" id="4025009">name</span><span class="op" id="4025013">,</span>&nbsp;<span class="ident" id="4025015">tag</span>&nbsp;<span class="builtintype" id="4025019">string</span><span class="op" id="4025025">)</span>&nbsp;<span class="builtintype" id="4025027">bool</span><span class="op" id="4025031">)</span>&nbsp;<span class="builtintype" id="4025033">bool</span>&nbsp;<span class="op" id="4025038">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025041">return</span>&nbsp;<span class="ident" id="4025048">rr</span><span class="op" id="4025050">.</span><span class="ident" id="4025051">Hdr</span><span class="op" id="4025054">.</span><span class="ident" id="4025055">Walk</span><span class="op" id="4025059">(</span><span class="ident" id="4025060">f</span><span class="op" id="4025061">)</span>&nbsp;<span class="op" id="4025063">&amp;&amp;</span>&nbsp;<span class="ident" id="4025066">f</span><span class="op" id="4025067">(</span><span class="op" id="4025068">&amp;</span><span class="ident" id="4025069">rr</span><span class="op" id="4025071">.</span><span class="ident" id="4025072">Mr</span><span class="op" id="4025074">,</span>&nbsp;<span class="string" id="4025076">&#34;Mr&#34;</span><span class="op" id="4025080">,</span>&nbsp;<span class="string" id="4025082">&#34;domain&#34;</span><span class="op" id="4025090">)</span><br>
<span class="lineno"></span><span class="op" id="4025092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4025095">type</span>&nbsp;<span class="ident" id="4025100">dnsRR_MX</span>&nbsp;<span class="keyword" id="4025109">struct</span>&nbsp;<span class="op" id="4025116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025119">Hdr</span>&nbsp;&nbsp;<span class="ident" id="4025124">dnsRR_Header</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025138">Pref</span>&nbsp;<span class="builtintype" id="4025143">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025151">Mx</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4025156">string</span>&nbsp;<span class="string" id="4025163">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4025183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4025186">func</span>&nbsp;<span class="op" id="4025191">(</span><span class="ident" id="4025192">rr</span>&nbsp;<span class="op" id="4025195">*</span><span class="ident" id="4025196">dnsRR_MX</span><span class="op" id="4025204">)</span>&nbsp;<span class="ident" id="4025206">Header</span><span class="op" id="4025212">(</span><span class="op" id="4025213">)</span>&nbsp;<span class="op" id="4025215">*</span><span class="ident" id="4025216">dnsRR_Header</span>&nbsp;<span class="op" id="4025229">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025232">return</span>&nbsp;<span class="op" id="4025239">&amp;</span><span class="ident" id="4025240">rr</span><span class="op" id="4025242">.</span><span class="ident" id="4025243">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4025247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4025250">func</span>&nbsp;<span class="op" id="4025255">(</span><span class="ident" id="4025256">rr</span>&nbsp;<span class="op" id="4025259">*</span><span class="ident" id="4025260">dnsRR_MX</span><span class="op" id="4025268">)</span>&nbsp;<span class="ident" id="4025270">Walk</span><span class="op" id="4025274">(</span><span class="ident" id="4025275">f</span>&nbsp;<span class="keyword" id="4025277">func</span><span class="op" id="4025281">(</span><span class="ident" id="4025282">v</span>&nbsp;<span class="keyword" id="4025284">interface</span><span class="op" id="4025293">{</span><span class="op" id="4025294">}</span><span class="op" id="4025295">,</span>&nbsp;<span class="ident" id="4025297">name</span><span class="op" id="4025301">,</span>&nbsp;<span class="ident" id="4025303">tag</span>&nbsp;<span class="builtintype" id="4025307">string</span><span class="op" id="4025313">)</span>&nbsp;<span class="builtintype" id="4025315">bool</span><span class="op" id="4025319">)</span>&nbsp;<span class="builtintype" id="4025321">bool</span>&nbsp;<span class="op" id="4025326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025329">return</span>&nbsp;<span class="ident" id="4025336">rr</span><span class="op" id="4025338">.</span><span class="ident" id="4025339">Hdr</span><span class="op" id="4025342">.</span><span class="ident" id="4025343">Walk</span><span class="op" id="4025347">(</span><span class="ident" id="4025348">f</span><span class="op" id="4025349">)</span>&nbsp;<span class="op" id="4025351">&amp;&amp;</span>&nbsp;<span class="ident" id="4025354">f</span><span class="op" id="4025355">(</span><span class="op" id="4025356">&amp;</span><span class="ident" id="4025357">rr</span><span class="op" id="4025359">.</span><span class="ident" id="4025360">Pref</span><span class="op" id="4025364">,</span>&nbsp;<span class="string" id="4025366">&#34;Pref&#34;</span><span class="op" id="4025372">,</span>&nbsp;<span class="string" id="4025374">&#34;&#34;</span><span class="op" id="4025376">)</span>&nbsp;<span class="op" id="4025378">&amp;&amp;</span>&nbsp;<span class="ident" id="4025381">f</span><span class="op" id="4025382">(</span><span class="op" id="4025383">&amp;</span><span class="ident" id="4025384">rr</span><span class="op" id="4025386">.</span><span class="ident" id="4025387">Mx</span><span class="op" id="4025389">,</span>&nbsp;<span class="string" id="4025391">&#34;Mx&#34;</span><span class="op" id="4025395">,</span>&nbsp;<span class="string" id="4025397">&#34;domain&#34;</span><span class="op" id="4025405">)</span><br>
<span class="lineno">245</span><span class="op" id="4025407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4025410">type</span>&nbsp;<span class="ident" id="4025415">dnsRR_NS</span>&nbsp;<span class="keyword" id="4025424">struct</span>&nbsp;<span class="op" id="4025431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025434">Hdr</span>&nbsp;<span class="ident" id="4025438">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025452">Ns</span>&nbsp;&nbsp;<span class="builtintype" id="4025456">string</span>&nbsp;<span class="string" id="4025463">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno">250</span><span class="op" id="4025483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4025486">func</span>&nbsp;<span class="op" id="4025491">(</span><span class="ident" id="4025492">rr</span>&nbsp;<span class="op" id="4025495">*</span><span class="ident" id="4025496">dnsRR_NS</span><span class="op" id="4025504">)</span>&nbsp;<span class="ident" id="4025506">Header</span><span class="op" id="4025512">(</span><span class="op" id="4025513">)</span>&nbsp;<span class="op" id="4025515">*</span><span class="ident" id="4025516">dnsRR_Header</span>&nbsp;<span class="op" id="4025529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025532">return</span>&nbsp;<span class="op" id="4025539">&amp;</span><span class="ident" id="4025540">rr</span><span class="op" id="4025542">.</span><span class="ident" id="4025543">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4025547">}</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span><span class="keyword" id="4025550">func</span>&nbsp;<span class="op" id="4025555">(</span><span class="ident" id="4025556">rr</span>&nbsp;<span class="op" id="4025559">*</span><span class="ident" id="4025560">dnsRR_NS</span><span class="op" id="4025568">)</span>&nbsp;<span class="ident" id="4025570">Walk</span><span class="op" id="4025574">(</span><span class="ident" id="4025575">f</span>&nbsp;<span class="keyword" id="4025577">func</span><span class="op" id="4025581">(</span><span class="ident" id="4025582">v</span>&nbsp;<span class="keyword" id="4025584">interface</span><span class="op" id="4025593">{</span><span class="op" id="4025594">}</span><span class="op" id="4025595">,</span>&nbsp;<span class="ident" id="4025597">name</span><span class="op" id="4025601">,</span>&nbsp;<span class="ident" id="4025603">tag</span>&nbsp;<span class="builtintype" id="4025607">string</span><span class="op" id="4025613">)</span>&nbsp;<span class="builtintype" id="4025615">bool</span><span class="op" id="4025619">)</span>&nbsp;<span class="builtintype" id="4025621">bool</span>&nbsp;<span class="op" id="4025626">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025629">return</span>&nbsp;<span class="ident" id="4025636">rr</span><span class="op" id="4025638">.</span><span class="ident" id="4025639">Hdr</span><span class="op" id="4025642">.</span><span class="ident" id="4025643">Walk</span><span class="op" id="4025647">(</span><span class="ident" id="4025648">f</span><span class="op" id="4025649">)</span>&nbsp;<span class="op" id="4025651">&amp;&amp;</span>&nbsp;<span class="ident" id="4025654">f</span><span class="op" id="4025655">(</span><span class="op" id="4025656">&amp;</span><span class="ident" id="4025657">rr</span><span class="op" id="4025659">.</span><span class="ident" id="4025660">Ns</span><span class="op" id="4025662">,</span>&nbsp;<span class="string" id="4025664">&#34;Ns&#34;</span><span class="op" id="4025668">,</span>&nbsp;<span class="string" id="4025670">&#34;domain&#34;</span><span class="op" id="4025678">)</span><br>
<span class="lineno"></span><span class="op" id="4025680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="4025683">type</span>&nbsp;<span class="ident" id="4025688">dnsRR_PTR</span>&nbsp;<span class="keyword" id="4025698">struct</span>&nbsp;<span class="op" id="4025705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025708">Hdr</span>&nbsp;<span class="ident" id="4025712">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025726">Ptr</span>&nbsp;<span class="builtintype" id="4025730">string</span>&nbsp;<span class="string" id="4025737">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4025757">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="4025760">func</span>&nbsp;<span class="op" id="4025765">(</span><span class="ident" id="4025766">rr</span>&nbsp;<span class="op" id="4025769">*</span><span class="ident" id="4025770">dnsRR_PTR</span><span class="op" id="4025779">)</span>&nbsp;<span class="ident" id="4025781">Header</span><span class="op" id="4025787">(</span><span class="op" id="4025788">)</span>&nbsp;<span class="op" id="4025790">*</span><span class="ident" id="4025791">dnsRR_Header</span>&nbsp;<span class="op" id="4025804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025807">return</span>&nbsp;<span class="op" id="4025814">&amp;</span><span class="ident" id="4025815">rr</span><span class="op" id="4025817">.</span><span class="ident" id="4025818">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4025822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4025825">func</span>&nbsp;<span class="op" id="4025830">(</span><span class="ident" id="4025831">rr</span>&nbsp;<span class="op" id="4025834">*</span><span class="ident" id="4025835">dnsRR_PTR</span><span class="op" id="4025844">)</span>&nbsp;<span class="ident" id="4025846">Walk</span><span class="op" id="4025850">(</span><span class="ident" id="4025851">f</span>&nbsp;<span class="keyword" id="4025853">func</span><span class="op" id="4025857">(</span><span class="ident" id="4025858">v</span>&nbsp;<span class="keyword" id="4025860">interface</span><span class="op" id="4025869">{</span><span class="op" id="4025870">}</span><span class="op" id="4025871">,</span>&nbsp;<span class="ident" id="4025873">name</span><span class="op" id="4025877">,</span>&nbsp;<span class="ident" id="4025879">tag</span>&nbsp;<span class="builtintype" id="4025883">string</span><span class="op" id="4025889">)</span>&nbsp;<span class="builtintype" id="4025891">bool</span><span class="op" id="4025895">)</span>&nbsp;<span class="builtintype" id="4025897">bool</span>&nbsp;<span class="op" id="4025902">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4025905">return</span>&nbsp;<span class="ident" id="4025912">rr</span><span class="op" id="4025914">.</span><span class="ident" id="4025915">Hdr</span><span class="op" id="4025918">.</span><span class="ident" id="4025919">Walk</span><span class="op" id="4025923">(</span><span class="ident" id="4025924">f</span><span class="op" id="4025925">)</span>&nbsp;<span class="op" id="4025927">&amp;&amp;</span>&nbsp;<span class="ident" id="4025930">f</span><span class="op" id="4025931">(</span><span class="op" id="4025932">&amp;</span><span class="ident" id="4025933">rr</span><span class="op" id="4025935">.</span><span class="ident" id="4025936">Ptr</span><span class="op" id="4025939">,</span>&nbsp;<span class="string" id="4025941">&#34;Ptr&#34;</span><span class="op" id="4025946">,</span>&nbsp;<span class="string" id="4025948">&#34;domain&#34;</span><span class="op" id="4025956">)</span><br>
<span class="lineno"></span><span class="op" id="4025958">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4025961">type</span>&nbsp;<span class="ident" id="4025966">dnsRR_SOA</span>&nbsp;<span class="keyword" id="4025976">struct</span>&nbsp;<span class="op" id="4025983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4025986">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4025994">dnsRR_Header</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026008">Ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4026016">string</span>&nbsp;<span class="string" id="4026023">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026044">Mbox</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4026052">string</span>&nbsp;<span class="string" id="4026059">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026080">Serial</span>&nbsp;&nbsp;<span class="builtintype" id="4026088">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026096">Refresh</span>&nbsp;<span class="builtintype" id="4026104">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026112">Retry</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4026120">uint32</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026128">Expire</span>&nbsp;&nbsp;<span class="builtintype" id="4026136">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026144">Minttl</span>&nbsp;&nbsp;<span class="builtintype" id="4026152">uint32</span><br>
<span class="lineno"></span><span class="op" id="4026159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4026162">func</span>&nbsp;<span class="op" id="4026167">(</span><span class="ident" id="4026168">rr</span>&nbsp;<span class="op" id="4026171">*</span><span class="ident" id="4026172">dnsRR_SOA</span><span class="op" id="4026181">)</span>&nbsp;<span class="ident" id="4026183">Header</span><span class="op" id="4026189">(</span><span class="op" id="4026190">)</span>&nbsp;<span class="op" id="4026192">*</span><span class="ident" id="4026193">dnsRR_Header</span>&nbsp;<span class="op" id="4026206">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026209">return</span>&nbsp;<span class="op" id="4026216">&amp;</span><span class="ident" id="4026217">rr</span><span class="op" id="4026219">.</span><span class="ident" id="4026220">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4026224">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4026227">func</span>&nbsp;<span class="op" id="4026232">(</span><span class="ident" id="4026233">rr</span>&nbsp;<span class="op" id="4026236">*</span><span class="ident" id="4026237">dnsRR_SOA</span><span class="op" id="4026246">)</span>&nbsp;<span class="ident" id="4026248">Walk</span><span class="op" id="4026252">(</span><span class="ident" id="4026253">f</span>&nbsp;<span class="keyword" id="4026255">func</span><span class="op" id="4026259">(</span><span class="ident" id="4026260">v</span>&nbsp;<span class="keyword" id="4026262">interface</span><span class="op" id="4026271">{</span><span class="op" id="4026272">}</span><span class="op" id="4026273">,</span>&nbsp;<span class="ident" id="4026275">name</span><span class="op" id="4026279">,</span>&nbsp;<span class="ident" id="4026281">tag</span>&nbsp;<span class="builtintype" id="4026285">string</span><span class="op" id="4026291">)</span>&nbsp;<span class="builtintype" id="4026293">bool</span><span class="op" id="4026297">)</span>&nbsp;<span class="builtintype" id="4026299">bool</span>&nbsp;<span class="op" id="4026304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026307">return</span>&nbsp;<span class="ident" id="4026314">rr</span><span class="op" id="4026316">.</span><span class="ident" id="4026317">Hdr</span><span class="op" id="4026320">.</span><span class="ident" id="4026321">Walk</span><span class="op" id="4026325">(</span><span class="ident" id="4026326">f</span><span class="op" id="4026327">)</span>&nbsp;<span class="op" id="4026329">&amp;&amp;</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026334">f</span><span class="op" id="4026335">(</span><span class="op" id="4026336">&amp;</span><span class="ident" id="4026337">rr</span><span class="op" id="4026339">.</span><span class="ident" id="4026340">Ns</span><span class="op" id="4026342">,</span>&nbsp;<span class="string" id="4026344">&#34;Ns&#34;</span><span class="op" id="4026348">,</span>&nbsp;<span class="string" id="4026350">&#34;domain&#34;</span><span class="op" id="4026358">)</span>&nbsp;<span class="op" id="4026360">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026365">f</span><span class="op" id="4026366">(</span><span class="op" id="4026367">&amp;</span><span class="ident" id="4026368">rr</span><span class="op" id="4026370">.</span><span class="ident" id="4026371">Mbox</span><span class="op" id="4026375">,</span>&nbsp;<span class="string" id="4026377">&#34;Mbox&#34;</span><span class="op" id="4026383">,</span>&nbsp;<span class="string" id="4026385">&#34;domain&#34;</span><span class="op" id="4026393">)</span>&nbsp;<span class="op" id="4026395">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026400">f</span><span class="op" id="4026401">(</span><span class="op" id="4026402">&amp;</span><span class="ident" id="4026403">rr</span><span class="op" id="4026405">.</span><span class="ident" id="4026406">Serial</span><span class="op" id="4026412">,</span>&nbsp;<span class="string" id="4026414">&#34;Serial&#34;</span><span class="op" id="4026422">,</span>&nbsp;<span class="string" id="4026424">&#34;&#34;</span><span class="op" id="4026426">)</span>&nbsp;<span class="op" id="4026428">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026433">f</span><span class="op" id="4026434">(</span><span class="op" id="4026435">&amp;</span><span class="ident" id="4026436">rr</span><span class="op" id="4026438">.</span><span class="ident" id="4026439">Refresh</span><span class="op" id="4026446">,</span>&nbsp;<span class="string" id="4026448">&#34;Refresh&#34;</span><span class="op" id="4026457">,</span>&nbsp;<span class="string" id="4026459">&#34;&#34;</span><span class="op" id="4026461">)</span>&nbsp;<span class="op" id="4026463">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026468">f</span><span class="op" id="4026469">(</span><span class="op" id="4026470">&amp;</span><span class="ident" id="4026471">rr</span><span class="op" id="4026473">.</span><span class="ident" id="4026474">Retry</span><span class="op" id="4026479">,</span>&nbsp;<span class="string" id="4026481">&#34;Retry&#34;</span><span class="op" id="4026488">,</span>&nbsp;<span class="string" id="4026490">&#34;&#34;</span><span class="op" id="4026492">)</span>&nbsp;<span class="op" id="4026494">&amp;&amp;</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026499">f</span><span class="op" id="4026500">(</span><span class="op" id="4026501">&amp;</span><span class="ident" id="4026502">rr</span><span class="op" id="4026504">.</span><span class="ident" id="4026505">Expire</span><span class="op" id="4026511">,</span>&nbsp;<span class="string" id="4026513">&#34;Expire&#34;</span><span class="op" id="4026521">,</span>&nbsp;<span class="string" id="4026523">&#34;&#34;</span><span class="op" id="4026525">)</span>&nbsp;<span class="op" id="4026527">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026532">f</span><span class="op" id="4026533">(</span><span class="op" id="4026534">&amp;</span><span class="ident" id="4026535">rr</span><span class="op" id="4026537">.</span><span class="ident" id="4026538">Minttl</span><span class="op" id="4026544">,</span>&nbsp;<span class="string" id="4026546">&#34;Minttl&#34;</span><span class="op" id="4026554">,</span>&nbsp;<span class="string" id="4026556">&#34;&#34;</span><span class="op" id="4026558">)</span><br>
<span class="lineno"></span><span class="op" id="4026560">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4026563">type</span>&nbsp;<span class="ident" id="4026568">dnsRR_TXT</span>&nbsp;<span class="keyword" id="4026578">struct</span>&nbsp;<span class="op" id="4026585">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026588">Hdr</span>&nbsp;<span class="ident" id="4026592">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026606">Txt</span>&nbsp;<span class="builtintype" id="4026610">string</span>&nbsp;<span class="comment" id="4026617">//&nbsp;not&nbsp;domain&nbsp;name</span><br>
<span class="lineno"></span><span class="op" id="4026636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4026639">func</span>&nbsp;<span class="op" id="4026644">(</span><span class="ident" id="4026645">rr</span>&nbsp;<span class="op" id="4026648">*</span><span class="ident" id="4026649">dnsRR_TXT</span><span class="op" id="4026658">)</span>&nbsp;<span class="ident" id="4026660">Header</span><span class="op" id="4026666">(</span><span class="op" id="4026667">)</span>&nbsp;<span class="op" id="4026669">*</span><span class="ident" id="4026670">dnsRR_Header</span>&nbsp;<span class="op" id="4026683">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026686">return</span>&nbsp;<span class="op" id="4026693">&amp;</span><span class="ident" id="4026694">rr</span><span class="op" id="4026696">.</span><span class="ident" id="4026697">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4026701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4026704">func</span>&nbsp;<span class="op" id="4026709">(</span><span class="ident" id="4026710">rr</span>&nbsp;<span class="op" id="4026713">*</span><span class="ident" id="4026714">dnsRR_TXT</span><span class="op" id="4026723">)</span>&nbsp;<span class="ident" id="4026725">Walk</span><span class="op" id="4026729">(</span><span class="ident" id="4026730">f</span>&nbsp;<span class="keyword" id="4026732">func</span><span class="op" id="4026736">(</span><span class="ident" id="4026737">v</span>&nbsp;<span class="keyword" id="4026739">interface</span><span class="op" id="4026748">{</span><span class="op" id="4026749">}</span><span class="op" id="4026750">,</span>&nbsp;<span class="ident" id="4026752">name</span><span class="op" id="4026756">,</span>&nbsp;<span class="ident" id="4026758">tag</span>&nbsp;<span class="builtintype" id="4026762">string</span><span class="op" id="4026768">)</span>&nbsp;<span class="builtintype" id="4026770">bool</span><span class="op" id="4026774">)</span>&nbsp;<span class="builtintype" id="4026776">bool</span>&nbsp;<span class="op" id="4026781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4026784">return</span>&nbsp;<span class="ident" id="4026791">rr</span><span class="op" id="4026793">.</span><span class="ident" id="4026794">Hdr</span><span class="op" id="4026797">.</span><span class="ident" id="4026798">Walk</span><span class="op" id="4026802">(</span><span class="ident" id="4026803">f</span><span class="op" id="4026804">)</span>&nbsp;<span class="op" id="4026806">&amp;&amp;</span>&nbsp;<span class="ident" id="4026809">f</span><span class="op" id="4026810">(</span><span class="op" id="4026811">&amp;</span><span class="ident" id="4026812">rr</span><span class="op" id="4026814">.</span><span class="ident" id="4026815">Txt</span><span class="op" id="4026818">,</span>&nbsp;<span class="string" id="4026820">&#34;Txt&#34;</span><span class="op" id="4026825">,</span>&nbsp;<span class="string" id="4026827">&#34;&#34;</span><span class="op" id="4026829">)</span><br>
<span class="lineno">310</span><span class="op" id="4026831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4026834">type</span>&nbsp;<span class="ident" id="4026839">dnsRR_SRV</span>&nbsp;<span class="keyword" id="4026849">struct</span>&nbsp;<span class="op" id="4026856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026859">Hdr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4026868">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026882">Priority</span>&nbsp;<span class="builtintype" id="4026891">uint16</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026899">Weight</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4026908">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026916">Port</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4026925">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4026933">Target</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4026942">string</span>&nbsp;<span class="string" id="4026949">`net:&#34;domain-name&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4026969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="keyword" id="4026972">func</span>&nbsp;<span class="op" id="4026977">(</span><span class="ident" id="4026978">rr</span>&nbsp;<span class="op" id="4026981">*</span><span class="ident" id="4026982">dnsRR_SRV</span><span class="op" id="4026991">)</span>&nbsp;<span class="ident" id="4026993">Header</span><span class="op" id="4026999">(</span><span class="op" id="4027000">)</span>&nbsp;<span class="op" id="4027002">*</span><span class="ident" id="4027003">dnsRR_Header</span>&nbsp;<span class="op" id="4027016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027019">return</span>&nbsp;<span class="op" id="4027026">&amp;</span><span class="ident" id="4027027">rr</span><span class="op" id="4027029">.</span><span class="ident" id="4027030">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4027034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4027037">func</span>&nbsp;<span class="op" id="4027042">(</span><span class="ident" id="4027043">rr</span>&nbsp;<span class="op" id="4027046">*</span><span class="ident" id="4027047">dnsRR_SRV</span><span class="op" id="4027056">)</span>&nbsp;<span class="ident" id="4027058">Walk</span><span class="op" id="4027062">(</span><span class="ident" id="4027063">f</span>&nbsp;<span class="keyword" id="4027065">func</span><span class="op" id="4027069">(</span><span class="ident" id="4027070">v</span>&nbsp;<span class="keyword" id="4027072">interface</span><span class="op" id="4027081">{</span><span class="op" id="4027082">}</span><span class="op" id="4027083">,</span>&nbsp;<span class="ident" id="4027085">name</span><span class="op" id="4027089">,</span>&nbsp;<span class="ident" id="4027091">tag</span>&nbsp;<span class="builtintype" id="4027095">string</span><span class="op" id="4027101">)</span>&nbsp;<span class="builtintype" id="4027103">bool</span><span class="op" id="4027107">)</span>&nbsp;<span class="builtintype" id="4027109">bool</span>&nbsp;<span class="op" id="4027114">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027117">return</span>&nbsp;<span class="ident" id="4027124">rr</span><span class="op" id="4027126">.</span><span class="ident" id="4027127">Hdr</span><span class="op" id="4027130">.</span><span class="ident" id="4027131">Walk</span><span class="op" id="4027135">(</span><span class="ident" id="4027136">f</span><span class="op" id="4027137">)</span>&nbsp;<span class="op" id="4027139">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027144">f</span><span class="op" id="4027145">(</span><span class="op" id="4027146">&amp;</span><span class="ident" id="4027147">rr</span><span class="op" id="4027149">.</span><span class="ident" id="4027150">Priority</span><span class="op" id="4027158">,</span>&nbsp;<span class="string" id="4027160">&#34;Priority&#34;</span><span class="op" id="4027170">,</span>&nbsp;<span class="string" id="4027172">&#34;&#34;</span><span class="op" id="4027174">)</span>&nbsp;<span class="op" id="4027176">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027181">f</span><span class="op" id="4027182">(</span><span class="op" id="4027183">&amp;</span><span class="ident" id="4027184">rr</span><span class="op" id="4027186">.</span><span class="ident" id="4027187">Weight</span><span class="op" id="4027193">,</span>&nbsp;<span class="string" id="4027195">&#34;Weight&#34;</span><span class="op" id="4027203">,</span>&nbsp;<span class="string" id="4027205">&#34;&#34;</span><span class="op" id="4027207">)</span>&nbsp;<span class="op" id="4027209">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027214">f</span><span class="op" id="4027215">(</span><span class="op" id="4027216">&amp;</span><span class="ident" id="4027217">rr</span><span class="op" id="4027219">.</span><span class="ident" id="4027220">Port</span><span class="op" id="4027224">,</span>&nbsp;<span class="string" id="4027226">&#34;Port&#34;</span><span class="op" id="4027232">,</span>&nbsp;<span class="string" id="4027234">&#34;&#34;</span><span class="op" id="4027236">)</span>&nbsp;<span class="op" id="4027238">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027243">f</span><span class="op" id="4027244">(</span><span class="op" id="4027245">&amp;</span><span class="ident" id="4027246">rr</span><span class="op" id="4027248">.</span><span class="ident" id="4027249">Target</span><span class="op" id="4027255">,</span>&nbsp;<span class="string" id="4027257">&#34;Target&#34;</span><span class="op" id="4027265">,</span>&nbsp;<span class="string" id="4027267">&#34;domain&#34;</span><span class="op" id="4027275">)</span><br>
<span class="lineno">330</span><span class="op" id="4027277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4027280">type</span>&nbsp;<span class="ident" id="4027285">dnsRR_A</span>&nbsp;<span class="keyword" id="4027293">struct</span>&nbsp;<span class="op" id="4027300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027303">Hdr</span>&nbsp;<span class="ident" id="4027307">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027321">A</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4027325">uint32</span>&nbsp;<span class="string" id="4027332">`net:&#34;ipv4&#34;`</span><br>
<span class="lineno">335</span><span class="op" id="4027345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4027348">func</span>&nbsp;<span class="op" id="4027353">(</span><span class="ident" id="4027354">rr</span>&nbsp;<span class="op" id="4027357">*</span><span class="ident" id="4027358">dnsRR_A</span><span class="op" id="4027365">)</span>&nbsp;<span class="ident" id="4027367">Header</span><span class="op" id="4027373">(</span><span class="op" id="4027374">)</span>&nbsp;<span class="op" id="4027376">*</span><span class="ident" id="4027377">dnsRR_Header</span>&nbsp;<span class="op" id="4027390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027393">return</span>&nbsp;<span class="op" id="4027400">&amp;</span><span class="ident" id="4027401">rr</span><span class="op" id="4027403">.</span><span class="ident" id="4027404">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4027408">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="keyword" id="4027411">func</span>&nbsp;<span class="op" id="4027416">(</span><span class="ident" id="4027417">rr</span>&nbsp;<span class="op" id="4027420">*</span><span class="ident" id="4027421">dnsRR_A</span><span class="op" id="4027428">)</span>&nbsp;<span class="ident" id="4027430">Walk</span><span class="op" id="4027434">(</span><span class="ident" id="4027435">f</span>&nbsp;<span class="keyword" id="4027437">func</span><span class="op" id="4027441">(</span><span class="ident" id="4027442">v</span>&nbsp;<span class="keyword" id="4027444">interface</span><span class="op" id="4027453">{</span><span class="op" id="4027454">}</span><span class="op" id="4027455">,</span>&nbsp;<span class="ident" id="4027457">name</span><span class="op" id="4027461">,</span>&nbsp;<span class="ident" id="4027463">tag</span>&nbsp;<span class="builtintype" id="4027467">string</span><span class="op" id="4027473">)</span>&nbsp;<span class="builtintype" id="4027475">bool</span><span class="op" id="4027479">)</span>&nbsp;<span class="builtintype" id="4027481">bool</span>&nbsp;<span class="op" id="4027486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027489">return</span>&nbsp;<span class="ident" id="4027496">rr</span><span class="op" id="4027498">.</span><span class="ident" id="4027499">Hdr</span><span class="op" id="4027502">.</span><span class="ident" id="4027503">Walk</span><span class="op" id="4027507">(</span><span class="ident" id="4027508">f</span><span class="op" id="4027509">)</span>&nbsp;<span class="op" id="4027511">&amp;&amp;</span>&nbsp;<span class="ident" id="4027514">f</span><span class="op" id="4027515">(</span><span class="op" id="4027516">&amp;</span><span class="ident" id="4027517">rr</span><span class="op" id="4027519">.</span><span class="ident" id="4027520">A</span><span class="op" id="4027521">,</span>&nbsp;<span class="string" id="4027523">&#34;A&#34;</span><span class="op" id="4027526">,</span>&nbsp;<span class="string" id="4027528">&#34;ipv4&#34;</span><span class="op" id="4027534">)</span><br>
<span class="lineno"></span><span class="op" id="4027536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="keyword" id="4027539">type</span>&nbsp;<span class="ident" id="4027544">dnsRR_AAAA</span>&nbsp;<span class="keyword" id="4027555">struct</span>&nbsp;<span class="op" id="4027562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027565">Hdr</span>&nbsp;&nbsp;<span class="ident" id="4027570">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4027584">AAAA</span>&nbsp;<span class="op" id="4027589">[</span><span class="num" id="4027590">16</span><span class="op" id="4027592">]</span><span class="builtintype" id="4027593">byte</span>&nbsp;<span class="string" id="4027598">`net:&#34;ipv6&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4027611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="4027614">func</span>&nbsp;<span class="op" id="4027619">(</span><span class="ident" id="4027620">rr</span>&nbsp;<span class="op" id="4027623">*</span><span class="ident" id="4027624">dnsRR_AAAA</span><span class="op" id="4027634">)</span>&nbsp;<span class="ident" id="4027636">Header</span><span class="op" id="4027642">(</span><span class="op" id="4027643">)</span>&nbsp;<span class="op" id="4027645">*</span><span class="ident" id="4027646">dnsRR_Header</span>&nbsp;<span class="op" id="4027659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027662">return</span>&nbsp;<span class="op" id="4027669">&amp;</span><span class="ident" id="4027670">rr</span><span class="op" id="4027672">.</span><span class="ident" id="4027673">Hdr</span><br>
<span class="lineno"></span><span class="op" id="4027677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4027680">func</span>&nbsp;<span class="op" id="4027685">(</span><span class="ident" id="4027686">rr</span>&nbsp;<span class="op" id="4027689">*</span><span class="ident" id="4027690">dnsRR_AAAA</span><span class="op" id="4027700">)</span>&nbsp;<span class="ident" id="4027702">Walk</span><span class="op" id="4027706">(</span><span class="ident" id="4027707">f</span>&nbsp;<span class="keyword" id="4027709">func</span><span class="op" id="4027713">(</span><span class="ident" id="4027714">v</span>&nbsp;<span class="keyword" id="4027716">interface</span><span class="op" id="4027725">{</span><span class="op" id="4027726">}</span><span class="op" id="4027727">,</span>&nbsp;<span class="ident" id="4027729">name</span><span class="op" id="4027733">,</span>&nbsp;<span class="ident" id="4027735">tag</span>&nbsp;<span class="builtintype" id="4027739">string</span><span class="op" id="4027745">)</span>&nbsp;<span class="builtintype" id="4027747">bool</span><span class="op" id="4027751">)</span>&nbsp;<span class="builtintype" id="4027753">bool</span>&nbsp;<span class="op" id="4027758">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4027761">return</span>&nbsp;<span class="ident" id="4027768">rr</span><span class="op" id="4027770">.</span><span class="ident" id="4027771">Hdr</span><span class="op" id="4027774">.</span><span class="ident" id="4027775">Walk</span><span class="op" id="4027779">(</span><span class="ident" id="4027780">f</span><span class="op" id="4027781">)</span>&nbsp;<span class="op" id="4027783">&amp;&amp;</span>&nbsp;<span class="ident" id="4027786">f</span><span class="op" id="4027787">(</span><span class="ident" id="4027788">rr</span><span class="op" id="4027790">.</span><span class="ident" id="4027791">AAAA</span><span class="op" id="4027795">[</span><span class="op" id="4027796">:</span><span class="op" id="4027797">]</span><span class="op" id="4027798">,</span>&nbsp;<span class="string" id="4027800">&#34;AAAA&#34;</span><span class="op" id="4027806">,</span>&nbsp;<span class="string" id="4027808">&#34;ipv6&#34;</span><span class="op" id="4027814">)</span><br>
<span class="lineno"></span><span class="op" id="4027816">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4027819">//&nbsp;Packing&nbsp;and&nbsp;unpacking.</span><br>
<span class="lineno"></span><span class="comment" id="4027845">//</span><br>
<span class="lineno">360</span><span class="comment" id="4027848">//&nbsp;All&nbsp;the&nbsp;packers&nbsp;and&nbsp;unpackers&nbsp;take&nbsp;a&nbsp;(msg&nbsp;[]byte,&nbsp;off&nbsp;int)</span><br>
<span class="lineno"></span><span class="comment" id="4027910">//&nbsp;and&nbsp;return&nbsp;(off1&nbsp;int,&nbsp;ok&nbsp;bool).&nbsp;&nbsp;If&nbsp;they&nbsp;return&nbsp;ok==false,&nbsp;they</span><br>
<span class="lineno"></span><span class="comment" id="4027977">//&nbsp;also&nbsp;return&nbsp;off1==len(msg),&nbsp;so&nbsp;that&nbsp;the&nbsp;next&nbsp;unpacker&nbsp;will</span><br>
<span class="lineno"></span><span class="comment" id="4028039">//&nbsp;also&nbsp;fail.&nbsp;&nbsp;This&nbsp;lets&nbsp;us&nbsp;avoid&nbsp;checks&nbsp;of&nbsp;ok&nbsp;until&nbsp;the&nbsp;end&nbsp;of&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4028105">//&nbsp;packing&nbsp;sequence.</span><br>
<span class="lineno">365</span><br>
<span class="lineno"></span><span class="comment" id="4028127">//&nbsp;Map&nbsp;of&nbsp;constructors&nbsp;for&nbsp;each&nbsp;RR&nbsp;wire&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4028173">var</span>&nbsp;<span class="ident" id="4028177">rr_mk</span>&nbsp;<span class="op" id="4028183">=</span>&nbsp;<span class="keyword" id="4028185">map</span><span class="op" id="4028188">[</span><span class="builtintype" id="4028189">int</span><span class="op" id="4028192">]</span><span class="keyword" id="4028193">func</span><span class="op" id="4028197">(</span><span class="op" id="4028198">)</span>&nbsp;<span class="ident" id="4028200">dnsRR</span><span class="op" id="4028205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028208">dnsTypeCNAME</span><span class="op" id="4028220">:</span>&nbsp;<span class="keyword" id="4028222">func</span><span class="op" id="4028226">(</span><span class="op" id="4028227">)</span>&nbsp;<span class="ident" id="4028229">dnsRR</span>&nbsp;<span class="op" id="4028235">{</span>&nbsp;<span class="keyword" id="4028237">return</span>&nbsp;<span class="builtinfunc" id="4028244">new</span><span class="op" id="4028247">(</span><span class="ident" id="4028248">dnsRR_CNAME</span><span class="op" id="4028259">)</span>&nbsp;<span class="op" id="4028261">}</span><span class="op" id="4028262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028265">dnsTypeHINFO</span><span class="op" id="4028277">:</span>&nbsp;<span class="keyword" id="4028279">func</span><span class="op" id="4028283">(</span><span class="op" id="4028284">)</span>&nbsp;<span class="ident" id="4028286">dnsRR</span>&nbsp;<span class="op" id="4028292">{</span>&nbsp;<span class="keyword" id="4028294">return</span>&nbsp;<span class="builtinfunc" id="4028301">new</span><span class="op" id="4028304">(</span><span class="ident" id="4028305">dnsRR_HINFO</span><span class="op" id="4028316">)</span>&nbsp;<span class="op" id="4028318">}</span><span class="op" id="4028319">,</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028322">dnsTypeMB</span><span class="op" id="4028331">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028336">func</span><span class="op" id="4028340">(</span><span class="op" id="4028341">)</span>&nbsp;<span class="ident" id="4028343">dnsRR</span>&nbsp;<span class="op" id="4028349">{</span>&nbsp;<span class="keyword" id="4028351">return</span>&nbsp;<span class="builtinfunc" id="4028358">new</span><span class="op" id="4028361">(</span><span class="ident" id="4028362">dnsRR_MB</span><span class="op" id="4028370">)</span>&nbsp;<span class="op" id="4028372">}</span><span class="op" id="4028373">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028376">dnsTypeMG</span><span class="op" id="4028385">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028390">func</span><span class="op" id="4028394">(</span><span class="op" id="4028395">)</span>&nbsp;<span class="ident" id="4028397">dnsRR</span>&nbsp;<span class="op" id="4028403">{</span>&nbsp;<span class="keyword" id="4028405">return</span>&nbsp;<span class="builtinfunc" id="4028412">new</span><span class="op" id="4028415">(</span><span class="ident" id="4028416">dnsRR_MG</span><span class="op" id="4028424">)</span>&nbsp;<span class="op" id="4028426">}</span><span class="op" id="4028427">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028430">dnsTypeMINFO</span><span class="op" id="4028442">:</span>&nbsp;<span class="keyword" id="4028444">func</span><span class="op" id="4028448">(</span><span class="op" id="4028449">)</span>&nbsp;<span class="ident" id="4028451">dnsRR</span>&nbsp;<span class="op" id="4028457">{</span>&nbsp;<span class="keyword" id="4028459">return</span>&nbsp;<span class="builtinfunc" id="4028466">new</span><span class="op" id="4028469">(</span><span class="ident" id="4028470">dnsRR_MINFO</span><span class="op" id="4028481">)</span>&nbsp;<span class="op" id="4028483">}</span><span class="op" id="4028484">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028487">dnsTypeMR</span><span class="op" id="4028496">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028501">func</span><span class="op" id="4028505">(</span><span class="op" id="4028506">)</span>&nbsp;<span class="ident" id="4028508">dnsRR</span>&nbsp;<span class="op" id="4028514">{</span>&nbsp;<span class="keyword" id="4028516">return</span>&nbsp;<span class="builtinfunc" id="4028523">new</span><span class="op" id="4028526">(</span><span class="ident" id="4028527">dnsRR_MR</span><span class="op" id="4028535">)</span>&nbsp;<span class="op" id="4028537">}</span><span class="op" id="4028538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028541">dnsTypeMX</span><span class="op" id="4028550">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028555">func</span><span class="op" id="4028559">(</span><span class="op" id="4028560">)</span>&nbsp;<span class="ident" id="4028562">dnsRR</span>&nbsp;<span class="op" id="4028568">{</span>&nbsp;<span class="keyword" id="4028570">return</span>&nbsp;<span class="builtinfunc" id="4028577">new</span><span class="op" id="4028580">(</span><span class="ident" id="4028581">dnsRR_MX</span><span class="op" id="4028589">)</span>&nbsp;<span class="op" id="4028591">}</span><span class="op" id="4028592">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028595">dnsTypeNS</span><span class="op" id="4028604">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028609">func</span><span class="op" id="4028613">(</span><span class="op" id="4028614">)</span>&nbsp;<span class="ident" id="4028616">dnsRR</span>&nbsp;<span class="op" id="4028622">{</span>&nbsp;<span class="keyword" id="4028624">return</span>&nbsp;<span class="builtinfunc" id="4028631">new</span><span class="op" id="4028634">(</span><span class="ident" id="4028635">dnsRR_NS</span><span class="op" id="4028643">)</span>&nbsp;<span class="op" id="4028645">}</span><span class="op" id="4028646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028649">dnsTypePTR</span><span class="op" id="4028659">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028663">func</span><span class="op" id="4028667">(</span><span class="op" id="4028668">)</span>&nbsp;<span class="ident" id="4028670">dnsRR</span>&nbsp;<span class="op" id="4028676">{</span>&nbsp;<span class="keyword" id="4028678">return</span>&nbsp;<span class="builtinfunc" id="4028685">new</span><span class="op" id="4028688">(</span><span class="ident" id="4028689">dnsRR_PTR</span><span class="op" id="4028698">)</span>&nbsp;<span class="op" id="4028700">}</span><span class="op" id="4028701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028704">dnsTypeSOA</span><span class="op" id="4028714">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028718">func</span><span class="op" id="4028722">(</span><span class="op" id="4028723">)</span>&nbsp;<span class="ident" id="4028725">dnsRR</span>&nbsp;<span class="op" id="4028731">{</span>&nbsp;<span class="keyword" id="4028733">return</span>&nbsp;<span class="builtinfunc" id="4028740">new</span><span class="op" id="4028743">(</span><span class="ident" id="4028744">dnsRR_SOA</span><span class="op" id="4028753">)</span>&nbsp;<span class="op" id="4028755">}</span><span class="op" id="4028756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028759">dnsTypeTXT</span><span class="op" id="4028769">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028773">func</span><span class="op" id="4028777">(</span><span class="op" id="4028778">)</span>&nbsp;<span class="ident" id="4028780">dnsRR</span>&nbsp;<span class="op" id="4028786">{</span>&nbsp;<span class="keyword" id="4028788">return</span>&nbsp;<span class="builtinfunc" id="4028795">new</span><span class="op" id="4028798">(</span><span class="ident" id="4028799">dnsRR_TXT</span><span class="op" id="4028808">)</span>&nbsp;<span class="op" id="4028810">}</span><span class="op" id="4028811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028814">dnsTypeSRV</span><span class="op" id="4028824">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028828">func</span><span class="op" id="4028832">(</span><span class="op" id="4028833">)</span>&nbsp;<span class="ident" id="4028835">dnsRR</span>&nbsp;<span class="op" id="4028841">{</span>&nbsp;<span class="keyword" id="4028843">return</span>&nbsp;<span class="builtinfunc" id="4028850">new</span><span class="op" id="4028853">(</span><span class="ident" id="4028854">dnsRR_SRV</span><span class="op" id="4028863">)</span>&nbsp;<span class="op" id="4028865">}</span><span class="op" id="4028866">,</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028869">dnsTypeA</span><span class="op" id="4028877">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028883">func</span><span class="op" id="4028887">(</span><span class="op" id="4028888">)</span>&nbsp;<span class="ident" id="4028890">dnsRR</span>&nbsp;<span class="op" id="4028896">{</span>&nbsp;<span class="keyword" id="4028898">return</span>&nbsp;<span class="builtinfunc" id="4028905">new</span><span class="op" id="4028908">(</span><span class="ident" id="4028909">dnsRR_A</span><span class="op" id="4028916">)</span>&nbsp;<span class="op" id="4028918">}</span><span class="op" id="4028919">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4028922">dnsTypeAAAA</span><span class="op" id="4028933">:</span>&nbsp;&nbsp;<span class="keyword" id="4028936">func</span><span class="op" id="4028940">(</span><span class="op" id="4028941">)</span>&nbsp;<span class="ident" id="4028943">dnsRR</span>&nbsp;<span class="op" id="4028949">{</span>&nbsp;<span class="keyword" id="4028951">return</span>&nbsp;<span class="builtinfunc" id="4028958">new</span><span class="op" id="4028961">(</span><span class="ident" id="4028962">dnsRR_AAAA</span><span class="op" id="4028972">)</span>&nbsp;<span class="op" id="4028974">}</span><span class="op" id="4028975">,</span><br>
<span class="lineno"></span><span class="op" id="4028977">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4028980">//&nbsp;Pack&nbsp;a&nbsp;domain&nbsp;name&nbsp;s&nbsp;into&nbsp;msg[off:].</span><br>
<span class="lineno">385</span><span class="comment" id="4029020">//&nbsp;Domain&nbsp;names&nbsp;are&nbsp;a&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings</span><br>
<span class="lineno"></span><span class="comment" id="4029070">//&nbsp;split&nbsp;at&nbsp;the&nbsp;dots.&nbsp;&nbsp;They&nbsp;end&nbsp;with&nbsp;a&nbsp;zero-length&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4029129">func</span>&nbsp;<span class="ident" id="4029134">packDomainName</span><span class="op" id="4029148">(</span><span class="ident" id="4029149">s</span>&nbsp;<span class="builtintype" id="4029151">string</span><span class="op" id="4029157">,</span>&nbsp;<span class="ident" id="4029159">msg</span>&nbsp;<span class="op" id="4029163">[</span><span class="op" id="4029164">]</span><span class="builtintype" id="4029165">byte</span><span class="op" id="4029169">,</span>&nbsp;<span class="ident" id="4029171">off</span>&nbsp;<span class="builtintype" id="4029175">int</span><span class="op" id="4029178">)</span>&nbsp;<span class="op" id="4029180">(</span><span class="ident" id="4029181">off1</span>&nbsp;<span class="builtintype" id="4029186">int</span><span class="op" id="4029189">,</span>&nbsp;<span class="ident" id="4029191">ok</span>&nbsp;<span class="builtintype" id="4029194">bool</span><span class="op" id="4029198">)</span>&nbsp;<span class="op" id="4029200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4029203">//&nbsp;Add&nbsp;trailing&nbsp;dot&nbsp;to&nbsp;canonicalize&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029246">if</span>&nbsp;<span class="ident" id="4029249">n</span>&nbsp;<span class="op" id="4029251">:=</span>&nbsp;<span class="builtinfunc" id="4029254">len</span><span class="op" id="4029257">(</span><span class="ident" id="4029258">s</span><span class="op" id="4029259">)</span><span class="op" id="4029260">;</span>&nbsp;<span class="ident" id="4029262">n</span>&nbsp;<span class="op" id="4029264">==</span>&nbsp;<span class="num" id="4029267">0</span>&nbsp;<span class="op" id="4029269">||</span>&nbsp;<span class="ident" id="4029272">s</span><span class="op" id="4029273">[</span><span class="ident" id="4029274">n</span><span class="op" id="4029275">-</span><span class="num" id="4029276">1</span><span class="op" id="4029277">]</span>&nbsp;<span class="op" id="4029279">!=</span>&nbsp;<span class="string" id="4029282">&#39;.&#39;</span>&nbsp;<span class="op" id="4029286">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029290">s</span>&nbsp;<span class="op" id="4029292">+=</span>&nbsp;<span class="string" id="4029295">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4029304">//&nbsp;Each&nbsp;dot&nbsp;ends&nbsp;a&nbsp;segment&nbsp;of&nbsp;the&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4029345">//&nbsp;We&nbsp;trade&nbsp;each&nbsp;dot&nbsp;byte&nbsp;for&nbsp;a&nbsp;length&nbsp;byte.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4029391">//&nbsp;There&nbsp;is&nbsp;also&nbsp;a&nbsp;trailing&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4029426">//&nbsp;Check&nbsp;that&nbsp;we&nbsp;have&nbsp;all&nbsp;the&nbsp;space&nbsp;we&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029472">tot</span>&nbsp;<span class="op" id="4029476">:=</span>&nbsp;<span class="builtinfunc" id="4029479">len</span><span class="op" id="4029482">(</span><span class="ident" id="4029483">s</span><span class="op" id="4029484">)</span>&nbsp;<span class="op" id="4029486">+</span>&nbsp;<span class="num" id="4029488">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029491">if</span>&nbsp;<span class="ident" id="4029494">off</span><span class="op" id="4029497">+</span><span class="ident" id="4029498">tot</span>&nbsp;<span class="op" id="4029502">&gt;</span>&nbsp;<span class="builtinfunc" id="4029504">len</span><span class="op" id="4029507">(</span><span class="ident" id="4029508">msg</span><span class="op" id="4029511">)</span>&nbsp;<span class="op" id="4029513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029517">return</span>&nbsp;<span class="builtinfunc" id="4029524">len</span><span class="op" id="4029527">(</span><span class="ident" id="4029528">msg</span><span class="op" id="4029531">)</span><span class="op" id="4029532">,</span>&nbsp;<span class="builtintype" id="4029534">false</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4029545">//&nbsp;Emit&nbsp;sequence&nbsp;of&nbsp;counted&nbsp;strings,&nbsp;chopping&nbsp;at&nbsp;dots.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029601">begin</span>&nbsp;<span class="op" id="4029607">:=</span>&nbsp;<span class="num" id="4029610">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029613">for</span>&nbsp;<span class="ident" id="4029617">i</span>&nbsp;<span class="op" id="4029619">:=</span>&nbsp;<span class="num" id="4029622">0</span><span class="op" id="4029623">;</span>&nbsp;<span class="ident" id="4029625">i</span>&nbsp;<span class="op" id="4029627">&lt;</span>&nbsp;<span class="builtinfunc" id="4029629">len</span><span class="op" id="4029632">(</span><span class="ident" id="4029633">s</span><span class="op" id="4029634">)</span><span class="op" id="4029635">;</span>&nbsp;<span class="ident" id="4029637">i</span><span class="op" id="4029638">++</span>&nbsp;<span class="op" id="4029641">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029645">if</span>&nbsp;<span class="ident" id="4029648">s</span><span class="op" id="4029649">[</span><span class="ident" id="4029650">i</span><span class="op" id="4029651">]</span>&nbsp;<span class="op" id="4029653">==</span>&nbsp;<span class="string" id="4029656">&#39;.&#39;</span>&nbsp;<span class="op" id="4029660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029665">if</span>&nbsp;<span class="ident" id="4029668">i</span><span class="op" id="4029669">-</span><span class="ident" id="4029670">begin</span>&nbsp;<span class="op" id="4029676">&gt;=</span>&nbsp;<span class="num" id="4029679">1</span><span class="op" id="4029680">&lt;&lt;</span><span class="num" id="4029682">6</span>&nbsp;<span class="op" id="4029684">{</span>&nbsp;<span class="comment" id="4029686">//&nbsp;top&nbsp;two&nbsp;bits&nbsp;of&nbsp;length&nbsp;must&nbsp;be&nbsp;clear</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029730">return</span>&nbsp;<span class="builtinfunc" id="4029737">len</span><span class="op" id="4029740">(</span><span class="ident" id="4029741">msg</span><span class="op" id="4029744">)</span><span class="op" id="4029745">,</span>&nbsp;<span class="builtintype" id="4029747">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029761">msg</span><span class="op" id="4029764">[</span><span class="ident" id="4029765">off</span><span class="op" id="4029768">]</span>&nbsp;<span class="op" id="4029770">=</span>&nbsp;<span class="builtintype" id="4029772">byte</span><span class="op" id="4029776">(</span><span class="ident" id="4029777">i</span>&nbsp;<span class="op" id="4029779">-</span>&nbsp;<span class="ident" id="4029781">begin</span><span class="op" id="4029786">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029791">off</span><span class="op" id="4029794">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029800">for</span>&nbsp;<span class="ident" id="4029804">j</span>&nbsp;<span class="op" id="4029806">:=</span>&nbsp;<span class="ident" id="4029809">begin</span><span class="op" id="4029814">;</span>&nbsp;<span class="ident" id="4029816">j</span>&nbsp;<span class="op" id="4029818">&lt;</span>&nbsp;<span class="ident" id="4029820">i</span><span class="op" id="4029821">;</span>&nbsp;<span class="ident" id="4029823">j</span><span class="op" id="4029824">++</span>&nbsp;<span class="op" id="4029827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029833">msg</span><span class="op" id="4029836">[</span><span class="ident" id="4029837">off</span><span class="op" id="4029840">]</span>&nbsp;<span class="op" id="4029842">=</span>&nbsp;<span class="ident" id="4029844">s</span><span class="op" id="4029845">[</span><span class="ident" id="4029846">j</span><span class="op" id="4029847">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029853">off</span><span class="op" id="4029856">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029862">}</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029867">begin</span>&nbsp;<span class="op" id="4029873">=</span>&nbsp;<span class="ident" id="4029875">i</span>&nbsp;<span class="op" id="4029877">+</span>&nbsp;<span class="num" id="4029879">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4029886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029889">msg</span><span class="op" id="4029892">[</span><span class="ident" id="4029893">off</span><span class="op" id="4029896">]</span>&nbsp;<span class="op" id="4029898">=</span>&nbsp;<span class="num" id="4029900">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4029903">off</span><span class="op" id="4029906">++</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4029910">return</span>&nbsp;<span class="ident" id="4029917">off</span><span class="op" id="4029920">,</span>&nbsp;<span class="builtintype" id="4029922">true</span><br>
<span class="lineno"></span><span class="op" id="4029927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4029930">//&nbsp;Unpack&nbsp;a&nbsp;domain&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="4029955">//&nbsp;In&nbsp;addition&nbsp;to&nbsp;the&nbsp;simple&nbsp;sequences&nbsp;of&nbsp;counted&nbsp;strings&nbsp;above,</span><br>
<span class="lineno">425</span><span class="comment" id="4030020">//&nbsp;domain&nbsp;names&nbsp;are&nbsp;allowed&nbsp;to&nbsp;refer&nbsp;to&nbsp;strings&nbsp;elsewhere&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4030085">//&nbsp;packet,&nbsp;to&nbsp;avoid&nbsp;repeating&nbsp;common&nbsp;suffixes&nbsp;when&nbsp;returning</span><br>
<span class="lineno"></span><span class="comment" id="4030146">//&nbsp;many&nbsp;entries&nbsp;in&nbsp;a&nbsp;single&nbsp;domain.&nbsp;&nbsp;The&nbsp;pointers&nbsp;are&nbsp;marked</span><br>
<span class="lineno"></span><span class="comment" id="4030207">//&nbsp;by&nbsp;a&nbsp;length&nbsp;byte&nbsp;with&nbsp;the&nbsp;top&nbsp;two&nbsp;bits&nbsp;set.&nbsp;&nbsp;Ignoring&nbsp;those</span><br>
<span class="lineno"></span><span class="comment" id="4030270">//&nbsp;two&nbsp;bits,&nbsp;that&nbsp;byte&nbsp;and&nbsp;the&nbsp;next&nbsp;give&nbsp;a&nbsp;14&nbsp;bit&nbsp;offset&nbsp;from&nbsp;msg[0]</span><br>
<span class="lineno">430</span><span class="comment" id="4030339">//&nbsp;where&nbsp;we&nbsp;should&nbsp;pick&nbsp;up&nbsp;the&nbsp;trail.</span><br>
<span class="lineno"></span><span class="comment" id="4030377">//&nbsp;Note&nbsp;that&nbsp;if&nbsp;we&nbsp;jump&nbsp;elsewhere&nbsp;in&nbsp;the&nbsp;packet,</span><br>
<span class="lineno"></span><span class="comment" id="4030426">//&nbsp;we&nbsp;return&nbsp;off1&nbsp;==&nbsp;the&nbsp;offset&nbsp;after&nbsp;the&nbsp;first&nbsp;pointer&nbsp;we&nbsp;found,</span><br>
<span class="lineno"></span><span class="comment" id="4030492">//&nbsp;which&nbsp;is&nbsp;where&nbsp;the&nbsp;next&nbsp;record&nbsp;will&nbsp;start.</span><br>
<span class="lineno"></span><span class="comment" id="4030538">//&nbsp;In&nbsp;theory,&nbsp;the&nbsp;pointers&nbsp;are&nbsp;only&nbsp;allowed&nbsp;to&nbsp;jump&nbsp;backward.</span><br>
<span class="lineno">435</span><span class="comment" id="4030600">//&nbsp;We&nbsp;let&nbsp;them&nbsp;jump&nbsp;anywhere&nbsp;and&nbsp;stop&nbsp;jumping&nbsp;after&nbsp;a&nbsp;while.</span><br>
<span class="lineno"></span><span class="keyword" id="4030661">func</span>&nbsp;<span class="ident" id="4030666">unpackDomainName</span><span class="op" id="4030682">(</span><span class="ident" id="4030683">msg</span>&nbsp;<span class="op" id="4030687">[</span><span class="op" id="4030688">]</span><span class="builtintype" id="4030689">byte</span><span class="op" id="4030693">,</span>&nbsp;<span class="ident" id="4030695">off</span>&nbsp;<span class="builtintype" id="4030699">int</span><span class="op" id="4030702">)</span>&nbsp;<span class="op" id="4030704">(</span><span class="ident" id="4030705">s</span>&nbsp;<span class="builtintype" id="4030707">string</span><span class="op" id="4030713">,</span>&nbsp;<span class="ident" id="4030715">off1</span>&nbsp;<span class="builtintype" id="4030720">int</span><span class="op" id="4030723">,</span>&nbsp;<span class="ident" id="4030725">ok</span>&nbsp;<span class="builtintype" id="4030728">bool</span><span class="op" id="4030732">)</span>&nbsp;<span class="op" id="4030734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030737">s</span>&nbsp;<span class="op" id="4030739">=</span>&nbsp;<span class="string" id="4030741">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030745">ptr</span>&nbsp;<span class="op" id="4030749">:=</span>&nbsp;<span class="num" id="4030752">0</span>&nbsp;<span class="comment" id="4030754">//&nbsp;number&nbsp;of&nbsp;pointers&nbsp;followed</span><br>
<span class="lineno"></span><span class="ident" id="4030785">Loop</span><span class="op" id="4030789">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030792">for</span>&nbsp;<span class="op" id="4030796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030800">if</span>&nbsp;<span class="ident" id="4030803">off</span>&nbsp;<span class="op" id="4030807">&gt;=</span>&nbsp;<span class="builtinfunc" id="4030810">len</span><span class="op" id="4030813">(</span><span class="ident" id="4030814">msg</span><span class="op" id="4030817">)</span>&nbsp;<span class="op" id="4030819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030824">return</span>&nbsp;<span class="string" id="4030831">&#34;&#34;</span><span class="op" id="4030833">,</span>&nbsp;<span class="builtinfunc" id="4030835">len</span><span class="op" id="4030838">(</span><span class="ident" id="4030839">msg</span><span class="op" id="4030842">)</span><span class="op" id="4030843">,</span>&nbsp;<span class="builtintype" id="4030845">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4030853">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030857">c</span>&nbsp;<span class="op" id="4030859">:=</span>&nbsp;<span class="builtintype" id="4030862">int</span><span class="op" id="4030865">(</span><span class="ident" id="4030866">msg</span><span class="op" id="4030869">[</span><span class="ident" id="4030870">off</span><span class="op" id="4030873">]</span><span class="op" id="4030874">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4030878">off</span><span class="op" id="4030881">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030886">switch</span>&nbsp;<span class="ident" id="4030893">c</span>&nbsp;<span class="op" id="4030895">&amp;</span>&nbsp;<span class="num" id="4030897">0xC0</span>&nbsp;<span class="op" id="4030902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030906">case</span>&nbsp;<span class="num" id="4030911">0x00</span><span class="op" id="4030915">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030920">if</span>&nbsp;<span class="ident" id="4030923">c</span>&nbsp;<span class="op" id="4030925">==</span>&nbsp;<span class="num" id="4030928">0x00</span>&nbsp;<span class="op" id="4030933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4030939">//&nbsp;end&nbsp;of&nbsp;name</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030958">break</span>&nbsp;<span class="ident" id="4030964">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4030972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4030977">//&nbsp;literal&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4030998">if</span>&nbsp;<span class="ident" id="4031001">off</span><span class="op" id="4031004">+</span><span class="ident" id="4031005">c</span>&nbsp;<span class="op" id="4031007">&gt;</span>&nbsp;<span class="builtinfunc" id="4031009">len</span><span class="op" id="4031012">(</span><span class="ident" id="4031013">msg</span><span class="op" id="4031016">)</span>&nbsp;<span class="op" id="4031018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031024">return</span>&nbsp;<span class="string" id="4031031">&#34;&#34;</span><span class="op" id="4031033">,</span>&nbsp;<span class="builtinfunc" id="4031035">len</span><span class="op" id="4031038">(</span><span class="ident" id="4031039">msg</span><span class="op" id="4031042">)</span><span class="op" id="4031043">,</span>&nbsp;<span class="builtintype" id="4031045">false</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4031054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031059">s</span>&nbsp;<span class="op" id="4031061">+=</span>&nbsp;<span class="builtintype" id="4031064">string</span><span class="op" id="4031070">(</span><span class="ident" id="4031071">msg</span><span class="op" id="4031074">[</span><span class="ident" id="4031075">off</span><span class="op" id="4031078">:</span><span class="ident" id="4031079">off</span><span class="op" id="4031082">+</span><span class="ident" id="4031083">c</span><span class="op" id="4031084">]</span><span class="op" id="4031085">)</span>&nbsp;<span class="op" id="4031087">+</span>&nbsp;<span class="string" id="4031089">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031096">off</span>&nbsp;<span class="op" id="4031100">+=</span>&nbsp;<span class="ident" id="4031103">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031107">case</span>&nbsp;<span class="num" id="4031112">0xC0</span><span class="op" id="4031116">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4031121">//&nbsp;pointer&nbsp;to&nbsp;somewhere&nbsp;else&nbsp;in&nbsp;msg.</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4031161">//&nbsp;remember&nbsp;location&nbsp;after&nbsp;first&nbsp;ptr,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4031202">//&nbsp;since&nbsp;that&#39;s&nbsp;how&nbsp;many&nbsp;bytes&nbsp;we&nbsp;consumed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4031249">//&nbsp;also,&nbsp;don&#39;t&nbsp;follow&nbsp;too&nbsp;many&nbsp;pointers&nbsp;--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4031295">//&nbsp;maybe&nbsp;there&#39;s&nbsp;a&nbsp;loop.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031323">if</span>&nbsp;<span class="ident" id="4031326">off</span>&nbsp;<span class="op" id="4031330">&gt;=</span>&nbsp;<span class="builtinfunc" id="4031333">len</span><span class="op" id="4031336">(</span><span class="ident" id="4031337">msg</span><span class="op" id="4031340">)</span>&nbsp;<span class="op" id="4031342">{</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031348">return</span>&nbsp;<span class="string" id="4031355">&#34;&#34;</span><span class="op" id="4031357">,</span>&nbsp;<span class="builtinfunc" id="4031359">len</span><span class="op" id="4031362">(</span><span class="ident" id="4031363">msg</span><span class="op" id="4031366">)</span><span class="op" id="4031367">,</span>&nbsp;<span class="builtintype" id="4031369">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4031378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031383">c1</span>&nbsp;<span class="op" id="4031386">:=</span>&nbsp;<span class="ident" id="4031389">msg</span><span class="op" id="4031392">[</span><span class="ident" id="4031393">off</span><span class="op" id="4031396">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031401">off</span><span class="op" id="4031404">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031410">if</span>&nbsp;<span class="ident" id="4031413">ptr</span>&nbsp;<span class="op" id="4031417">==</span>&nbsp;<span class="num" id="4031420">0</span>&nbsp;<span class="op" id="4031422">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031428">off1</span>&nbsp;<span class="op" id="4031433">=</span>&nbsp;<span class="ident" id="4031435">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4031442">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031447">if</span>&nbsp;<span class="ident" id="4031450">ptr</span><span class="op" id="4031453">++</span><span class="op" id="4031455">;</span>&nbsp;<span class="ident" id="4031457">ptr</span>&nbsp;<span class="op" id="4031461">&gt;</span>&nbsp;<span class="num" id="4031463">10</span>&nbsp;<span class="op" id="4031466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031472">return</span>&nbsp;<span class="string" id="4031479">&#34;&#34;</span><span class="op" id="4031481">,</span>&nbsp;<span class="builtinfunc" id="4031483">len</span><span class="op" id="4031486">(</span><span class="ident" id="4031487">msg</span><span class="op" id="4031490">)</span><span class="op" id="4031491">,</span>&nbsp;<span class="builtintype" id="4031493">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4031502">}</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031507">off</span>&nbsp;<span class="op" id="4031511">=</span>&nbsp;<span class="op" id="4031513">(</span><span class="ident" id="4031514">c</span><span class="op" id="4031515">^</span><span class="num" id="4031516">0xC0</span><span class="op" id="4031520">)</span><span class="op" id="4031521">&lt;&lt;</span><span class="num" id="4031523">8</span>&nbsp;<span class="op" id="4031525">|</span>&nbsp;<span class="builtintype" id="4031527">int</span><span class="op" id="4031530">(</span><span class="ident" id="4031531">c1</span><span class="op" id="4031533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031537">default</span><span class="op" id="4031544">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4031549">//&nbsp;0x80&nbsp;and&nbsp;0x40&nbsp;are&nbsp;reserved</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031582">return</span>&nbsp;<span class="string" id="4031589">&#34;&#34;</span><span class="op" id="4031591">,</span>&nbsp;<span class="builtinfunc" id="4031593">len</span><span class="op" id="4031596">(</span><span class="ident" id="4031597">msg</span><span class="op" id="4031600">)</span><span class="op" id="4031601">,</span>&nbsp;<span class="builtintype" id="4031603">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4031611">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4031614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031617">if</span>&nbsp;<span class="ident" id="4031620">ptr</span>&nbsp;<span class="op" id="4031624">==</span>&nbsp;<span class="num" id="4031627">0</span>&nbsp;<span class="op" id="4031629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031633">off1</span>&nbsp;<span class="op" id="4031638">=</span>&nbsp;<span class="ident" id="4031640">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4031645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031648">return</span>&nbsp;<span class="ident" id="4031655">s</span><span class="op" id="4031656">,</span>&nbsp;<span class="ident" id="4031658">off1</span><span class="op" id="4031662">,</span>&nbsp;<span class="builtintype" id="4031664">true</span><br>
<span class="lineno">485</span><span class="op" id="4031669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4031672">//&nbsp;packStruct&nbsp;packs&nbsp;a&nbsp;structure&nbsp;into&nbsp;msg&nbsp;at&nbsp;specified&nbsp;offset&nbsp;off,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4031742">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4031803">func</span>&nbsp;<span class="ident" id="4031808">packStruct</span><span class="op" id="4031818">(</span><span class="ident" id="4031819">any</span>&nbsp;<span class="ident" id="4031823">dnsStruct</span><span class="op" id="4031832">,</span>&nbsp;<span class="ident" id="4031834">msg</span>&nbsp;<span class="op" id="4031838">[</span><span class="op" id="4031839">]</span><span class="builtintype" id="4031840">byte</span><span class="op" id="4031844">,</span>&nbsp;<span class="ident" id="4031846">off</span>&nbsp;<span class="builtintype" id="4031850">int</span><span class="op" id="4031853">)</span>&nbsp;<span class="op" id="4031855">(</span><span class="ident" id="4031856">off1</span>&nbsp;<span class="builtintype" id="4031861">int</span><span class="op" id="4031864">,</span>&nbsp;<span class="ident" id="4031866">ok</span>&nbsp;<span class="builtintype" id="4031869">bool</span><span class="op" id="4031873">)</span>&nbsp;<span class="op" id="4031875">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4031878">ok</span>&nbsp;<span class="op" id="4031881">=</span>&nbsp;<span class="ident" id="4031883">any</span><span class="op" id="4031886">.</span><span class="ident" id="4031887">Walk</span><span class="op" id="4031891">(</span><span class="keyword" id="4031892">func</span><span class="op" id="4031896">(</span><span class="ident" id="4031897">field</span>&nbsp;<span class="keyword" id="4031903">interface</span><span class="op" id="4031912">{</span><span class="op" id="4031913">}</span><span class="op" id="4031914">,</span>&nbsp;<span class="ident" id="4031916">name</span><span class="op" id="4031920">,</span>&nbsp;<span class="ident" id="4031922">tag</span>&nbsp;<span class="builtintype" id="4031926">string</span><span class="op" id="4031932">)</span>&nbsp;<span class="builtintype" id="4031934">bool</span>&nbsp;<span class="op" id="4031939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031943">switch</span>&nbsp;<span class="ident" id="4031950">fv</span>&nbsp;<span class="op" id="4031953">:=</span>&nbsp;<span class="ident" id="4031956">field</span><span class="op" id="4031961">.</span><span class="op" id="4031962">(</span><span class="keyword" id="4031963">type</span><span class="op" id="4031967">)</span>&nbsp;<span class="op" id="4031969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4031973">default</span><span class="op" id="4031980">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4031985">println</span><span class="op" id="4031992">(</span><span class="string" id="4031993">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="4032025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032030">return</span>&nbsp;<span class="builtintype" id="4032037">false</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032045">case</span>&nbsp;<span class="op" id="4032050">*</span><span class="builtintype" id="4032051">uint16</span><span class="op" id="4032057">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032062">i</span>&nbsp;<span class="op" id="4032064">:=</span>&nbsp;<span class="op" id="4032067">*</span><span class="ident" id="4032068">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032074">if</span>&nbsp;<span class="ident" id="4032077">off</span><span class="op" id="4032080">+</span><span class="num" id="4032081">2</span>&nbsp;<span class="op" id="4032083">&gt;</span>&nbsp;<span class="builtinfunc" id="4032085">len</span><span class="op" id="4032088">(</span><span class="ident" id="4032089">msg</span><span class="op" id="4032092">)</span>&nbsp;<span class="op" id="4032094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032100">return</span>&nbsp;<span class="builtintype" id="4032107">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4032116">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032121">msg</span><span class="op" id="4032124">[</span><span class="ident" id="4032125">off</span><span class="op" id="4032128">]</span>&nbsp;<span class="op" id="4032130">=</span>&nbsp;<span class="builtintype" id="4032132">byte</span><span class="op" id="4032136">(</span><span class="ident" id="4032137">i</span>&nbsp;<span class="op" id="4032139">&gt;&gt;</span>&nbsp;<span class="num" id="4032142">8</span><span class="op" id="4032143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032148">msg</span><span class="op" id="4032151">[</span><span class="ident" id="4032152">off</span><span class="op" id="4032155">+</span><span class="num" id="4032156">1</span><span class="op" id="4032157">]</span>&nbsp;<span class="op" id="4032159">=</span>&nbsp;<span class="builtintype" id="4032161">byte</span><span class="op" id="4032165">(</span><span class="ident" id="4032166">i</span><span class="op" id="4032167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032172">off</span>&nbsp;<span class="op" id="4032176">+=</span>&nbsp;<span class="num" id="4032179">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032183">case</span>&nbsp;<span class="op" id="4032188">*</span><span class="builtintype" id="4032189">uint32</span><span class="op" id="4032195">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032200">i</span>&nbsp;<span class="op" id="4032202">:=</span>&nbsp;<span class="op" id="4032205">*</span><span class="ident" id="4032206">fv</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032212">msg</span><span class="op" id="4032215">[</span><span class="ident" id="4032216">off</span><span class="op" id="4032219">]</span>&nbsp;<span class="op" id="4032221">=</span>&nbsp;<span class="builtintype" id="4032223">byte</span><span class="op" id="4032227">(</span><span class="ident" id="4032228">i</span>&nbsp;<span class="op" id="4032230">&gt;&gt;</span>&nbsp;<span class="num" id="4032233">24</span><span class="op" id="4032235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032240">msg</span><span class="op" id="4032243">[</span><span class="ident" id="4032244">off</span><span class="op" id="4032247">+</span><span class="num" id="4032248">1</span><span class="op" id="4032249">]</span>&nbsp;<span class="op" id="4032251">=</span>&nbsp;<span class="builtintype" id="4032253">byte</span><span class="op" id="4032257">(</span><span class="ident" id="4032258">i</span>&nbsp;<span class="op" id="4032260">&gt;&gt;</span>&nbsp;<span class="num" id="4032263">16</span><span class="op" id="4032265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032270">msg</span><span class="op" id="4032273">[</span><span class="ident" id="4032274">off</span><span class="op" id="4032277">+</span><span class="num" id="4032278">2</span><span class="op" id="4032279">]</span>&nbsp;<span class="op" id="4032281">=</span>&nbsp;<span class="builtintype" id="4032283">byte</span><span class="op" id="4032287">(</span><span class="ident" id="4032288">i</span>&nbsp;<span class="op" id="4032290">&gt;&gt;</span>&nbsp;<span class="num" id="4032293">8</span><span class="op" id="4032294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032299">msg</span><span class="op" id="4032302">[</span><span class="ident" id="4032303">off</span><span class="op" id="4032306">+</span><span class="num" id="4032307">3</span><span class="op" id="4032308">]</span>&nbsp;<span class="op" id="4032310">=</span>&nbsp;<span class="builtintype" id="4032312">byte</span><span class="op" id="4032316">(</span><span class="ident" id="4032317">i</span><span class="op" id="4032318">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032323">off</span>&nbsp;<span class="op" id="4032327">+=</span>&nbsp;<span class="num" id="4032330">4</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032334">case</span>&nbsp;<span class="op" id="4032339">[</span><span class="op" id="4032340">]</span><span class="builtintype" id="4032341">byte</span><span class="op" id="4032345">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032350">n</span>&nbsp;<span class="op" id="4032352">:=</span>&nbsp;<span class="builtinfunc" id="4032355">len</span><span class="op" id="4032358">(</span><span class="ident" id="4032359">fv</span><span class="op" id="4032361">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032366">if</span>&nbsp;<span class="ident" id="4032369">off</span><span class="op" id="4032372">+</span><span class="ident" id="4032373">n</span>&nbsp;<span class="op" id="4032375">&gt;</span>&nbsp;<span class="builtinfunc" id="4032377">len</span><span class="op" id="4032380">(</span><span class="ident" id="4032381">msg</span><span class="op" id="4032384">)</span>&nbsp;<span class="op" id="4032386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032392">return</span>&nbsp;<span class="builtintype" id="4032399">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4032408">}</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4032413">copy</span><span class="op" id="4032417">(</span><span class="ident" id="4032418">msg</span><span class="op" id="4032421">[</span><span class="ident" id="4032422">off</span><span class="op" id="4032425">:</span><span class="ident" id="4032426">off</span><span class="op" id="4032429">+</span><span class="ident" id="4032430">n</span><span class="op" id="4032431">]</span><span class="op" id="4032432">,</span>&nbsp;<span class="ident" id="4032434">fv</span><span class="op" id="4032436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032441">off</span>&nbsp;<span class="op" id="4032445">+=</span>&nbsp;<span class="ident" id="4032448">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032452">case</span>&nbsp;<span class="op" id="4032457">*</span><span class="builtintype" id="4032458">string</span><span class="op" id="4032464">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032469">s</span>&nbsp;<span class="op" id="4032471">:=</span>&nbsp;<span class="op" id="4032474">*</span><span class="ident" id="4032475">fv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032481">switch</span>&nbsp;<span class="ident" id="4032488">tag</span>&nbsp;<span class="op" id="4032492">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032497">default</span><span class="op" id="4032504">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4032510">println</span><span class="op" id="4032517">(</span><span class="string" id="4032518">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="4032548">,</span>&nbsp;<span class="ident" id="4032550">tag</span><span class="op" id="4032553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032559">return</span>&nbsp;<span class="builtintype" id="4032566">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032575">case</span>&nbsp;<span class="string" id="4032580">&#34;domain&#34;</span><span class="op" id="4032588">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032594">off</span><span class="op" id="4032597">,</span>&nbsp;<span class="ident" id="4032599">ok</span>&nbsp;<span class="op" id="4032602">=</span>&nbsp;<span class="ident" id="4032604">packDomainName</span><span class="op" id="4032618">(</span><span class="ident" id="4032619">s</span><span class="op" id="4032620">,</span>&nbsp;<span class="ident" id="4032622">msg</span><span class="op" id="4032625">,</span>&nbsp;<span class="ident" id="4032627">off</span><span class="op" id="4032630">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032636">if</span>&nbsp;<span class="op" id="4032639">!</span><span class="ident" id="4032640">ok</span>&nbsp;<span class="op" id="4032643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032650">return</span>&nbsp;<span class="builtintype" id="4032657">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4032667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032672">case</span>&nbsp;<span class="string" id="4032677">&#34;&#34;</span><span class="op" id="4032679">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4032685">//&nbsp;Counted&nbsp;string:&nbsp;1&nbsp;byte&nbsp;length.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032723">if</span>&nbsp;<span class="builtinfunc" id="4032726">len</span><span class="op" id="4032729">(</span><span class="ident" id="4032730">s</span><span class="op" id="4032731">)</span>&nbsp;<span class="op" id="4032733">&gt;</span>&nbsp;<span class="num" id="4032735">255</span>&nbsp;<span class="op" id="4032739">||</span>&nbsp;<span class="ident" id="4032742">off</span><span class="op" id="4032745">+</span><span class="num" id="4032746">1</span><span class="op" id="4032747">+</span><span class="builtinfunc" id="4032748">len</span><span class="op" id="4032751">(</span><span class="ident" id="4032752">s</span><span class="op" id="4032753">)</span>&nbsp;<span class="op" id="4032755">&gt;</span>&nbsp;<span class="builtinfunc" id="4032757">len</span><span class="op" id="4032760">(</span><span class="ident" id="4032761">msg</span><span class="op" id="4032764">)</span>&nbsp;<span class="op" id="4032766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032773">return</span>&nbsp;<span class="builtintype" id="4032780">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4032790">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032796">msg</span><span class="op" id="4032799">[</span><span class="ident" id="4032800">off</span><span class="op" id="4032803">]</span>&nbsp;<span class="op" id="4032805">=</span>&nbsp;<span class="builtintype" id="4032807">byte</span><span class="op" id="4032811">(</span><span class="builtinfunc" id="4032812">len</span><span class="op" id="4032815">(</span><span class="ident" id="4032816">s</span><span class="op" id="4032817">)</span><span class="op" id="4032818">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032824">off</span><span class="op" id="4032827">++</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4032834">off</span>&nbsp;<span class="op" id="4032838">+=</span>&nbsp;<span class="builtinfunc" id="4032841">copy</span><span class="op" id="4032845">(</span><span class="ident" id="4032846">msg</span><span class="op" id="4032849">[</span><span class="ident" id="4032850">off</span><span class="op" id="4032853">:</span><span class="op" id="4032854">]</span><span class="op" id="4032855">,</span>&nbsp;<span class="ident" id="4032857">s</span><span class="op" id="4032858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4032863">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4032867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032871">return</span>&nbsp;<span class="builtintype" id="4032878">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4032884">}</span><span class="op" id="4032885">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032888">if</span>&nbsp;<span class="op" id="4032891">!</span><span class="ident" id="4032892">ok</span>&nbsp;<span class="op" id="4032895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032899">return</span>&nbsp;<span class="builtinfunc" id="4032906">len</span><span class="op" id="4032909">(</span><span class="ident" id="4032910">msg</span><span class="op" id="4032913">)</span><span class="op" id="4032914">,</span>&nbsp;<span class="builtintype" id="4032916">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4032923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4032926">return</span>&nbsp;<span class="ident" id="4032933">off</span><span class="op" id="4032936">,</span>&nbsp;<span class="builtintype" id="4032938">true</span><br>
<span class="lineno"></span><span class="op" id="4032943">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="comment" id="4032946">//&nbsp;unpackStruct&nbsp;decodes&nbsp;msg[off:]into&nbsp;the&nbsp;given&nbsp;structure,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4033011">//&nbsp;returns&nbsp;off1&nbsp;such&nbsp;that&nbsp;msg[off:off1]&nbsp;is&nbsp;the&nbsp;encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4033072">func</span>&nbsp;<span class="ident" id="4033077">unpackStruct</span><span class="op" id="4033089">(</span><span class="ident" id="4033090">any</span>&nbsp;<span class="ident" id="4033094">dnsStruct</span><span class="op" id="4033103">,</span>&nbsp;<span class="ident" id="4033105">msg</span>&nbsp;<span class="op" id="4033109">[</span><span class="op" id="4033110">]</span><span class="builtintype" id="4033111">byte</span><span class="op" id="4033115">,</span>&nbsp;<span class="ident" id="4033117">off</span>&nbsp;<span class="builtintype" id="4033121">int</span><span class="op" id="4033124">)</span>&nbsp;<span class="op" id="4033126">(</span><span class="ident" id="4033127">off1</span>&nbsp;<span class="builtintype" id="4033132">int</span><span class="op" id="4033135">,</span>&nbsp;<span class="ident" id="4033137">ok</span>&nbsp;<span class="builtintype" id="4033140">bool</span><span class="op" id="4033144">)</span>&nbsp;<span class="op" id="4033146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033149">ok</span>&nbsp;<span class="op" id="4033152">=</span>&nbsp;<span class="ident" id="4033154">any</span><span class="op" id="4033157">.</span><span class="ident" id="4033158">Walk</span><span class="op" id="4033162">(</span><span class="keyword" id="4033163">func</span><span class="op" id="4033167">(</span><span class="ident" id="4033168">field</span>&nbsp;<span class="keyword" id="4033174">interface</span><span class="op" id="4033183">{</span><span class="op" id="4033184">}</span><span class="op" id="4033185">,</span>&nbsp;<span class="ident" id="4033187">name</span><span class="op" id="4033191">,</span>&nbsp;<span class="ident" id="4033193">tag</span>&nbsp;<span class="builtintype" id="4033197">string</span><span class="op" id="4033203">)</span>&nbsp;<span class="builtintype" id="4033205">bool</span>&nbsp;<span class="op" id="4033210">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033214">switch</span>&nbsp;<span class="ident" id="4033221">fv</span>&nbsp;<span class="op" id="4033224">:=</span>&nbsp;<span class="ident" id="4033227">field</span><span class="op" id="4033232">.</span><span class="op" id="4033233">(</span><span class="keyword" id="4033234">type</span><span class="op" id="4033238">)</span>&nbsp;<span class="op" id="4033240">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033244">default</span><span class="op" id="4033251">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4033256">println</span><span class="op" id="4033263">(</span><span class="string" id="4033264">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;packing&nbsp;type&#34;</span><span class="op" id="4033296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033301">return</span>&nbsp;<span class="builtintype" id="4033308">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033316">case</span>&nbsp;<span class="op" id="4033321">*</span><span class="builtintype" id="4033322">uint16</span><span class="op" id="4033328">:</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033333">if</span>&nbsp;<span class="ident" id="4033336">off</span><span class="op" id="4033339">+</span><span class="num" id="4033340">2</span>&nbsp;<span class="op" id="4033342">&gt;</span>&nbsp;<span class="builtinfunc" id="4033344">len</span><span class="op" id="4033347">(</span><span class="ident" id="4033348">msg</span><span class="op" id="4033351">)</span>&nbsp;<span class="op" id="4033353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033359">return</span>&nbsp;<span class="builtintype" id="4033366">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4033375">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4033380">*</span><span class="ident" id="4033381">fv</span>&nbsp;<span class="op" id="4033384">=</span>&nbsp;<span class="builtintype" id="4033386">uint16</span><span class="op" id="4033392">(</span><span class="ident" id="4033393">msg</span><span class="op" id="4033396">[</span><span class="ident" id="4033397">off</span><span class="op" id="4033400">]</span><span class="op" id="4033401">)</span><span class="op" id="4033402">&lt;&lt;</span><span class="num" id="4033404">8</span>&nbsp;<span class="op" id="4033406">|</span>&nbsp;<span class="builtintype" id="4033408">uint16</span><span class="op" id="4033414">(</span><span class="ident" id="4033415">msg</span><span class="op" id="4033418">[</span><span class="ident" id="4033419">off</span><span class="op" id="4033422">+</span><span class="num" id="4033423">1</span><span class="op" id="4033424">]</span><span class="op" id="4033425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033430">off</span>&nbsp;<span class="op" id="4033434">+=</span>&nbsp;<span class="num" id="4033437">2</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033441">case</span>&nbsp;<span class="op" id="4033446">*</span><span class="builtintype" id="4033447">uint32</span><span class="op" id="4033453">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033458">if</span>&nbsp;<span class="ident" id="4033461">off</span><span class="op" id="4033464">+</span><span class="num" id="4033465">4</span>&nbsp;<span class="op" id="4033467">&gt;</span>&nbsp;<span class="builtinfunc" id="4033469">len</span><span class="op" id="4033472">(</span><span class="ident" id="4033473">msg</span><span class="op" id="4033476">)</span>&nbsp;<span class="op" id="4033478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033484">return</span>&nbsp;<span class="builtintype" id="4033491">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4033500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4033505">*</span><span class="ident" id="4033506">fv</span>&nbsp;<span class="op" id="4033509">=</span>&nbsp;<span class="builtintype" id="4033511">uint32</span><span class="op" id="4033517">(</span><span class="ident" id="4033518">msg</span><span class="op" id="4033521">[</span><span class="ident" id="4033522">off</span><span class="op" id="4033525">]</span><span class="op" id="4033526">)</span><span class="op" id="4033527">&lt;&lt;</span><span class="num" id="4033529">24</span>&nbsp;<span class="op" id="4033532">|</span>&nbsp;<span class="builtintype" id="4033534">uint32</span><span class="op" id="4033540">(</span><span class="ident" id="4033541">msg</span><span class="op" id="4033544">[</span><span class="ident" id="4033545">off</span><span class="op" id="4033548">+</span><span class="num" id="4033549">1</span><span class="op" id="4033550">]</span><span class="op" id="4033551">)</span><span class="op" id="4033552">&lt;&lt;</span><span class="num" id="4033554">16</span>&nbsp;<span class="op" id="4033557">|</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="4033563">uint32</span><span class="op" id="4033569">(</span><span class="ident" id="4033570">msg</span><span class="op" id="4033573">[</span><span class="ident" id="4033574">off</span><span class="op" id="4033577">+</span><span class="num" id="4033578">2</span><span class="op" id="4033579">]</span><span class="op" id="4033580">)</span><span class="op" id="4033581">&lt;&lt;</span><span class="num" id="4033583">8</span>&nbsp;<span class="op" id="4033585">|</span>&nbsp;<span class="builtintype" id="4033587">uint32</span><span class="op" id="4033593">(</span><span class="ident" id="4033594">msg</span><span class="op" id="4033597">[</span><span class="ident" id="4033598">off</span><span class="op" id="4033601">+</span><span class="num" id="4033602">3</span><span class="op" id="4033603">]</span><span class="op" id="4033604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033609">off</span>&nbsp;<span class="op" id="4033613">+=</span>&nbsp;<span class="num" id="4033616">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033620">case</span>&nbsp;<span class="op" id="4033625">[</span><span class="op" id="4033626">]</span><span class="builtintype" id="4033627">byte</span><span class="op" id="4033631">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033636">n</span>&nbsp;<span class="op" id="4033638">:=</span>&nbsp;<span class="builtinfunc" id="4033641">len</span><span class="op" id="4033644">(</span><span class="ident" id="4033645">fv</span><span class="op" id="4033647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033652">if</span>&nbsp;<span class="ident" id="4033655">off</span><span class="op" id="4033658">+</span><span class="ident" id="4033659">n</span>&nbsp;<span class="op" id="4033661">&gt;</span>&nbsp;<span class="builtinfunc" id="4033663">len</span><span class="op" id="4033666">(</span><span class="ident" id="4033667">msg</span><span class="op" id="4033670">)</span>&nbsp;<span class="op" id="4033672">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033678">return</span>&nbsp;<span class="builtintype" id="4033685">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4033694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4033699">copy</span><span class="op" id="4033703">(</span><span class="ident" id="4033704">fv</span><span class="op" id="4033706">,</span>&nbsp;<span class="ident" id="4033708">msg</span><span class="op" id="4033711">[</span><span class="ident" id="4033712">off</span><span class="op" id="4033715">:</span><span class="ident" id="4033716">off</span><span class="op" id="4033719">+</span><span class="ident" id="4033720">n</span><span class="op" id="4033721">]</span><span class="op" id="4033722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033727">off</span>&nbsp;<span class="op" id="4033731">+=</span>&nbsp;<span class="ident" id="4033734">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033738">case</span>&nbsp;<span class="op" id="4033743">*</span><span class="builtintype" id="4033744">string</span><span class="op" id="4033750">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033755">var</span>&nbsp;<span class="ident" id="4033759">s</span>&nbsp;<span class="builtintype" id="4033761">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033771">switch</span>&nbsp;<span class="ident" id="4033778">tag</span>&nbsp;<span class="op" id="4033782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033787">default</span><span class="op" id="4033794">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4033800">println</span><span class="op" id="4033807">(</span><span class="string" id="4033808">&#34;net:&nbsp;dns:&nbsp;unknown&nbsp;string&nbsp;tag&#34;</span><span class="op" id="4033838">,</span>&nbsp;<span class="ident" id="4033840">tag</span><span class="op" id="4033843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033849">return</span>&nbsp;<span class="builtintype" id="4033856">false</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033865">case</span>&nbsp;<span class="string" id="4033870">&#34;domain&#34;</span><span class="op" id="4033878">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4033884">s</span><span class="op" id="4033885">,</span>&nbsp;<span class="ident" id="4033887">off</span><span class="op" id="4033890">,</span>&nbsp;<span class="ident" id="4033892">ok</span>&nbsp;<span class="op" id="4033895">=</span>&nbsp;<span class="ident" id="4033897">unpackDomainName</span><span class="op" id="4033913">(</span><span class="ident" id="4033914">msg</span><span class="op" id="4033917">,</span>&nbsp;<span class="ident" id="4033919">off</span><span class="op" id="4033922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033928">if</span>&nbsp;<span class="op" id="4033931">!</span><span class="ident" id="4033932">ok</span>&nbsp;<span class="op" id="4033935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033942">return</span>&nbsp;<span class="builtintype" id="4033949">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4033959">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033964">case</span>&nbsp;<span class="string" id="4033969">&#34;&#34;</span><span class="op" id="4033971">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4033977">if</span>&nbsp;<span class="ident" id="4033980">off</span>&nbsp;<span class="op" id="4033984">&gt;=</span>&nbsp;<span class="builtinfunc" id="4033987">len</span><span class="op" id="4033990">(</span><span class="ident" id="4033991">msg</span><span class="op" id="4033994">)</span>&nbsp;<span class="op" id="4033996">||</span>&nbsp;<span class="ident" id="4033999">off</span><span class="op" id="4034002">+</span><span class="num" id="4034003">1</span><span class="op" id="4034004">+</span><span class="builtintype" id="4034005">int</span><span class="op" id="4034008">(</span><span class="ident" id="4034009">msg</span><span class="op" id="4034012">[</span><span class="ident" id="4034013">off</span><span class="op" id="4034016">]</span><span class="op" id="4034017">)</span>&nbsp;<span class="op" id="4034019">&gt;</span>&nbsp;<span class="builtinfunc" id="4034021">len</span><span class="op" id="4034024">(</span><span class="ident" id="4034025">msg</span><span class="op" id="4034028">)</span>&nbsp;<span class="op" id="4034030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034037">return</span>&nbsp;<span class="builtintype" id="4034044">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4034054">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034060">n</span>&nbsp;<span class="op" id="4034062">:=</span>&nbsp;<span class="builtintype" id="4034065">int</span><span class="op" id="4034068">(</span><span class="ident" id="4034069">msg</span><span class="op" id="4034072">[</span><span class="ident" id="4034073">off</span><span class="op" id="4034076">]</span><span class="op" id="4034077">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034083">off</span><span class="op" id="4034086">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034093">b</span>&nbsp;<span class="op" id="4034095">:=</span>&nbsp;<span class="builtinfunc" id="4034098">make</span><span class="op" id="4034102">(</span><span class="op" id="4034103">[</span><span class="op" id="4034104">]</span><span class="builtintype" id="4034105">byte</span><span class="op" id="4034109">,</span>&nbsp;<span class="ident" id="4034111">n</span><span class="op" id="4034112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034118">for</span>&nbsp;<span class="ident" id="4034122">i</span>&nbsp;<span class="op" id="4034124">:=</span>&nbsp;<span class="num" id="4034127">0</span><span class="op" id="4034128">;</span>&nbsp;<span class="ident" id="4034130">i</span>&nbsp;<span class="op" id="4034132">&lt;</span>&nbsp;<span class="ident" id="4034134">n</span><span class="op" id="4034135">;</span>&nbsp;<span class="ident" id="4034137">i</span><span class="op" id="4034138">++</span>&nbsp;<span class="op" id="4034141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034148">b</span><span class="op" id="4034149">[</span><span class="ident" id="4034150">i</span><span class="op" id="4034151">]</span>&nbsp;<span class="op" id="4034153">=</span>&nbsp;<span class="ident" id="4034155">msg</span><span class="op" id="4034158">[</span><span class="ident" id="4034159">off</span><span class="op" id="4034162">+</span><span class="ident" id="4034163">i</span><span class="op" id="4034164">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4034170">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034176">off</span>&nbsp;<span class="op" id="4034180">+=</span>&nbsp;<span class="ident" id="4034183">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034189">s</span>&nbsp;<span class="op" id="4034191">=</span>&nbsp;<span class="builtintype" id="4034193">string</span><span class="op" id="4034199">(</span><span class="ident" id="4034200">b</span><span class="op" id="4034201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4034206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4034211">*</span><span class="ident" id="4034212">fv</span>&nbsp;<span class="op" id="4034215">=</span>&nbsp;<span class="ident" id="4034217">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4034221">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034225">return</span>&nbsp;<span class="builtintype" id="4034232">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4034238">}</span><span class="op" id="4034239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034242">if</span>&nbsp;<span class="op" id="4034245">!</span><span class="ident" id="4034246">ok</span>&nbsp;<span class="op" id="4034249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034253">return</span>&nbsp;<span class="builtinfunc" id="4034260">len</span><span class="op" id="4034263">(</span><span class="ident" id="4034264">msg</span><span class="op" id="4034267">)</span><span class="op" id="4034268">,</span>&nbsp;<span class="builtintype" id="4034270">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4034277">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034280">return</span>&nbsp;<span class="ident" id="4034287">off</span><span class="op" id="4034290">,</span>&nbsp;<span class="builtintype" id="4034292">true</span><br>
<span class="lineno"></span><span class="op" id="4034297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4034300">//&nbsp;Generic&nbsp;struct&nbsp;printer.&nbsp;Prints&nbsp;fields&nbsp;with&nbsp;tag&nbsp;&#34;ipv4&#34;&nbsp;or&nbsp;&#34;ipv6&#34;</span><br>
<span class="lineno"></span><span class="comment" id="4034367">//&nbsp;as&nbsp;IP&nbsp;addresses.</span><br>
<span class="lineno">610</span><span class="keyword" id="4034387">func</span>&nbsp;<span class="ident" id="4034392">printStruct</span><span class="op" id="4034403">(</span><span class="ident" id="4034404">any</span>&nbsp;<span class="ident" id="4034408">dnsStruct</span><span class="op" id="4034417">)</span>&nbsp;<span class="builtintype" id="4034419">string</span>&nbsp;<span class="op" id="4034426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034429">s</span>&nbsp;<span class="op" id="4034431">:=</span>&nbsp;<span class="string" id="4034434">&#34;{&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034439">i</span>&nbsp;<span class="op" id="4034441">:=</span>&nbsp;<span class="num" id="4034444">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034447">any</span><span class="op" id="4034450">.</span><span class="ident" id="4034451">Walk</span><span class="op" id="4034455">(</span><span class="keyword" id="4034456">func</span><span class="op" id="4034460">(</span><span class="ident" id="4034461">val</span>&nbsp;<span class="keyword" id="4034465">interface</span><span class="op" id="4034474">{</span><span class="op" id="4034475">}</span><span class="op" id="4034476">,</span>&nbsp;<span class="ident" id="4034478">name</span><span class="op" id="4034482">,</span>&nbsp;<span class="ident" id="4034484">tag</span>&nbsp;<span class="builtintype" id="4034488">string</span><span class="op" id="4034494">)</span>&nbsp;<span class="builtintype" id="4034496">bool</span>&nbsp;<span class="op" id="4034501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034505">i</span><span class="op" id="4034506">++</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034511">if</span>&nbsp;<span class="ident" id="4034514">i</span>&nbsp;<span class="op" id="4034516">&gt;</span>&nbsp;<span class="num" id="4034518">1</span>&nbsp;<span class="op" id="4034520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034525">s</span>&nbsp;<span class="op" id="4034527">+=</span>&nbsp;<span class="string" id="4034530">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4034537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034541">s</span>&nbsp;<span class="op" id="4034543">+=</span>&nbsp;<span class="ident" id="4034546">name</span>&nbsp;<span class="op" id="4034551">+</span>&nbsp;<span class="string" id="4034553">&#34;=&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034559">switch</span>&nbsp;<span class="ident" id="4034566">tag</span>&nbsp;<span class="op" id="4034570">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034574">case</span>&nbsp;<span class="string" id="4034579">&#34;ipv4&#34;</span><span class="op" id="4034585">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034590">i</span>&nbsp;<span class="op" id="4034592">:=</span>&nbsp;<span class="op" id="4034595">*</span><span class="ident" id="4034596">val</span><span class="op" id="4034599">.</span><span class="op" id="4034600">(</span><span class="op" id="4034601">*</span><span class="builtintype" id="4034602">uint32</span><span class="op" id="4034608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034613">s</span>&nbsp;<span class="op" id="4034615">+=</span>&nbsp;<span class="ident" id="4034618">IPv4</span><span class="op" id="4034622">(</span><span class="builtintype" id="4034623">byte</span><span class="op" id="4034627">(</span><span class="ident" id="4034628">i</span><span class="op" id="4034629">&gt;&gt;</span><span class="num" id="4034631">24</span><span class="op" id="4034633">)</span><span class="op" id="4034634">,</span>&nbsp;<span class="builtintype" id="4034636">byte</span><span class="op" id="4034640">(</span><span class="ident" id="4034641">i</span><span class="op" id="4034642">&gt;&gt;</span><span class="num" id="4034644">16</span><span class="op" id="4034646">)</span><span class="op" id="4034647">,</span>&nbsp;<span class="builtintype" id="4034649">byte</span><span class="op" id="4034653">(</span><span class="ident" id="4034654">i</span><span class="op" id="4034655">&gt;&gt;</span><span class="num" id="4034657">8</span><span class="op" id="4034658">)</span><span class="op" id="4034659">,</span>&nbsp;<span class="builtintype" id="4034661">byte</span><span class="op" id="4034665">(</span><span class="ident" id="4034666">i</span><span class="op" id="4034667">)</span><span class="op" id="4034668">)</span><span class="op" id="4034669">.</span><span class="ident" id="4034670">String</span><span class="op" id="4034676">(</span><span class="op" id="4034677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034681">case</span>&nbsp;<span class="string" id="4034686">&#34;ipv6&#34;</span><span class="op" id="4034692">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034697">i</span>&nbsp;<span class="op" id="4034699">:=</span>&nbsp;<span class="ident" id="4034702">val</span><span class="op" id="4034705">.</span><span class="op" id="4034706">(</span><span class="op" id="4034707">[</span><span class="op" id="4034708">]</span><span class="builtintype" id="4034709">byte</span><span class="op" id="4034713">)</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034718">s</span>&nbsp;<span class="op" id="4034720">+=</span>&nbsp;<span class="ident" id="4034723">IP</span><span class="op" id="4034725">(</span><span class="ident" id="4034726">i</span><span class="op" id="4034727">)</span><span class="op" id="4034728">.</span><span class="ident" id="4034729">String</span><span class="op" id="4034735">(</span><span class="op" id="4034736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034740">default</span><span class="op" id="4034747">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034752">var</span>&nbsp;<span class="ident" id="4034756">i</span>&nbsp;<span class="ident" id="4034758">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034767">switch</span>&nbsp;<span class="ident" id="4034774">v</span>&nbsp;<span class="op" id="4034776">:=</span>&nbsp;<span class="ident" id="4034779">val</span><span class="op" id="4034782">.</span><span class="op" id="4034783">(</span><span class="keyword" id="4034784">type</span><span class="op" id="4034788">)</span>&nbsp;<span class="op" id="4034790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034795">default</span><span class="op" id="4034802">:</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4034808">//&nbsp;can&#39;t&nbsp;really&nbsp;happen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034836">s</span>&nbsp;<span class="op" id="4034838">+=</span>&nbsp;<span class="string" id="4034841">&#34;&lt;unknown&nbsp;type&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034862">return</span>&nbsp;<span class="builtintype" id="4034869">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034877">case</span>&nbsp;<span class="op" id="4034882">*</span><span class="builtintype" id="4034883">string</span><span class="op" id="4034889">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034895">s</span>&nbsp;<span class="op" id="4034897">+=</span>&nbsp;<span class="op" id="4034900">*</span><span class="ident" id="4034901">v</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034907">return</span>&nbsp;<span class="builtintype" id="4034914">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034922">case</span>&nbsp;<span class="op" id="4034927">[</span><span class="op" id="4034928">]</span><span class="builtintype" id="4034929">byte</span><span class="op" id="4034933">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4034939">s</span>&nbsp;<span class="op" id="4034941">+=</span>&nbsp;<span class="builtintype" id="4034944">string</span><span class="op" id="4034950">(</span><span class="ident" id="4034951">v</span><span class="op" id="4034952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034958">return</span>&nbsp;<span class="builtintype" id="4034965">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034973">case</span>&nbsp;<span class="op" id="4034978">*</span><span class="builtintype" id="4034979">bool</span><span class="op" id="4034983">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4034989">if</span>&nbsp;<span class="op" id="4034992">*</span><span class="ident" id="4034993">v</span>&nbsp;<span class="op" id="4034995">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035002">s</span>&nbsp;<span class="op" id="4035004">+=</span>&nbsp;<span class="string" id="4035007">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4035018">}</span>&nbsp;<span class="keyword" id="4035020">else</span>&nbsp;<span class="op" id="4035025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035032">s</span>&nbsp;<span class="op" id="4035034">+=</span>&nbsp;<span class="string" id="4035037">&#34;false&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4035049">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035055">return</span>&nbsp;<span class="builtintype" id="4035062">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035070">case</span>&nbsp;<span class="op" id="4035075">*</span><span class="builtintype" id="4035076">int</span><span class="op" id="4035079">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035085">i</span>&nbsp;<span class="op" id="4035087">=</span>&nbsp;<span class="ident" id="4035089">int64</span><span class="op" id="4035094">(</span><span class="op" id="4035095">*</span><span class="ident" id="4035096">v</span><span class="op" id="4035097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035102">case</span>&nbsp;<span class="op" id="4035107">*</span><span class="builtintype" id="4035108">uint</span><span class="op" id="4035112">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035118">i</span>&nbsp;<span class="op" id="4035120">=</span>&nbsp;<span class="ident" id="4035122">int64</span><span class="op" id="4035127">(</span><span class="op" id="4035128">*</span><span class="ident" id="4035129">v</span><span class="op" id="4035130">)</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035135">case</span>&nbsp;<span class="op" id="4035140">*</span><span class="builtintype" id="4035141">uint8</span><span class="op" id="4035146">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035152">i</span>&nbsp;<span class="op" id="4035154">=</span>&nbsp;<span class="ident" id="4035156">int64</span><span class="op" id="4035161">(</span><span class="op" id="4035162">*</span><span class="ident" id="4035163">v</span><span class="op" id="4035164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035169">case</span>&nbsp;<span class="op" id="4035174">*</span><span class="builtintype" id="4035175">uint16</span><span class="op" id="4035181">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035187">i</span>&nbsp;<span class="op" id="4035189">=</span>&nbsp;<span class="ident" id="4035191">int64</span><span class="op" id="4035196">(</span><span class="op" id="4035197">*</span><span class="ident" id="4035198">v</span><span class="op" id="4035199">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035204">case</span>&nbsp;<span class="op" id="4035209">*</span><span class="builtintype" id="4035210">uint32</span><span class="op" id="4035216">:</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035222">i</span>&nbsp;<span class="op" id="4035224">=</span>&nbsp;<span class="ident" id="4035226">int64</span><span class="op" id="4035231">(</span><span class="op" id="4035232">*</span><span class="ident" id="4035233">v</span><span class="op" id="4035234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035239">case</span>&nbsp;<span class="op" id="4035244">*</span><span class="ident" id="4035245">uint64</span><span class="op" id="4035251">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035257">i</span>&nbsp;<span class="op" id="4035259">=</span>&nbsp;<span class="ident" id="4035261">int64</span><span class="op" id="4035266">(</span><span class="op" id="4035267">*</span><span class="ident" id="4035268">v</span><span class="op" id="4035269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035274">case</span>&nbsp;<span class="op" id="4035279">*</span><span class="builtintype" id="4035280">uintptr</span><span class="op" id="4035287">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035293">i</span>&nbsp;<span class="op" id="4035295">=</span>&nbsp;<span class="ident" id="4035297">int64</span><span class="op" id="4035302">(</span><span class="op" id="4035303">*</span><span class="ident" id="4035304">v</span><span class="op" id="4035305">)</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4035310">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035315">s</span>&nbsp;<span class="op" id="4035317">+=</span>&nbsp;<span class="ident" id="4035320">itoa</span><span class="op" id="4035324">(</span><span class="builtintype" id="4035325">int</span><span class="op" id="4035328">(</span><span class="ident" id="4035329">i</span><span class="op" id="4035330">)</span><span class="op" id="4035331">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4035335">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035339">return</span>&nbsp;<span class="builtintype" id="4035346">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4035352">}</span><span class="op" id="4035353">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035356">s</span>&nbsp;<span class="op" id="4035358">+=</span>&nbsp;<span class="string" id="4035361">&#34;}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035366">return</span>&nbsp;<span class="ident" id="4035373">s</span><br>
<span class="lineno"></span><span class="op" id="4035375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4035378">//&nbsp;Resource&nbsp;record&nbsp;packer.</span><br>
<span class="lineno">670</span><span class="keyword" id="4035405">func</span>&nbsp;<span class="ident" id="4035410">packRR</span><span class="op" id="4035416">(</span><span class="ident" id="4035417">rr</span>&nbsp;<span class="ident" id="4035420">dnsRR</span><span class="op" id="4035425">,</span>&nbsp;<span class="ident" id="4035427">msg</span>&nbsp;<span class="op" id="4035431">[</span><span class="op" id="4035432">]</span><span class="builtintype" id="4035433">byte</span><span class="op" id="4035437">,</span>&nbsp;<span class="ident" id="4035439">off</span>&nbsp;<span class="builtintype" id="4035443">int</span><span class="op" id="4035446">)</span>&nbsp;<span class="op" id="4035448">(</span><span class="ident" id="4035449">off2</span>&nbsp;<span class="builtintype" id="4035454">int</span><span class="op" id="4035457">,</span>&nbsp;<span class="ident" id="4035459">ok</span>&nbsp;<span class="builtintype" id="4035462">bool</span><span class="op" id="4035466">)</span>&nbsp;<span class="op" id="4035468">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035471">var</span>&nbsp;<span class="ident" id="4035475">off1</span>&nbsp;<span class="builtintype" id="4035480">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4035485">//&nbsp;pack&nbsp;twice,&nbsp;once&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4035528">//&nbsp;and&nbsp;again&nbsp;to&nbsp;find&nbsp;end&nbsp;of&nbsp;packet.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4035565">//&nbsp;a&nbsp;bit&nbsp;inefficient&nbsp;but&nbsp;this&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4035621">//&nbsp;off1&nbsp;is&nbsp;end&nbsp;of&nbsp;header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4035647">//&nbsp;off2&nbsp;is&nbsp;end&nbsp;of&nbsp;rr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035669">off1</span><span class="op" id="4035673">,</span>&nbsp;<span class="ident" id="4035675">ok</span>&nbsp;<span class="op" id="4035678">=</span>&nbsp;<span class="ident" id="4035680">packStruct</span><span class="op" id="4035690">(</span><span class="ident" id="4035691">rr</span><span class="op" id="4035693">.</span><span class="ident" id="4035694">Header</span><span class="op" id="4035700">(</span><span class="op" id="4035701">)</span><span class="op" id="4035702">,</span>&nbsp;<span class="ident" id="4035704">msg</span><span class="op" id="4035707">,</span>&nbsp;<span class="ident" id="4035709">off</span><span class="op" id="4035712">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035715">off2</span><span class="op" id="4035719">,</span>&nbsp;<span class="ident" id="4035721">ok</span>&nbsp;<span class="op" id="4035724">=</span>&nbsp;<span class="ident" id="4035726">packStruct</span><span class="op" id="4035736">(</span><span class="ident" id="4035737">rr</span><span class="op" id="4035739">,</span>&nbsp;<span class="ident" id="4035741">msg</span><span class="op" id="4035744">,</span>&nbsp;<span class="ident" id="4035746">off</span><span class="op" id="4035749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035752">if</span>&nbsp;<span class="op" id="4035755">!</span><span class="ident" id="4035756">ok</span>&nbsp;<span class="op" id="4035759">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035763">return</span>&nbsp;<span class="builtinfunc" id="4035770">len</span><span class="op" id="4035773">(</span><span class="ident" id="4035774">msg</span><span class="op" id="4035777">)</span><span class="op" id="4035778">,</span>&nbsp;<span class="builtintype" id="4035780">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4035787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4035790">//&nbsp;pack&nbsp;a&nbsp;third&nbsp;time;&nbsp;redo&nbsp;header&nbsp;with&nbsp;correct&nbsp;data&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035850">rr</span><span class="op" id="4035852">.</span><span class="ident" id="4035853">Header</span><span class="op" id="4035859">(</span><span class="op" id="4035860">)</span><span class="op" id="4035861">.</span><span class="ident" id="4035862">Rdlength</span>&nbsp;<span class="op" id="4035871">=</span>&nbsp;<span class="builtintype" id="4035873">uint16</span><span class="op" id="4035879">(</span><span class="ident" id="4035880">off2</span>&nbsp;<span class="op" id="4035885">-</span>&nbsp;<span class="ident" id="4035887">off1</span><span class="op" id="4035891">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4035894">packStruct</span><span class="op" id="4035904">(</span><span class="ident" id="4035905">rr</span><span class="op" id="4035907">.</span><span class="ident" id="4035908">Header</span><span class="op" id="4035914">(</span><span class="op" id="4035915">)</span><span class="op" id="4035916">,</span>&nbsp;<span class="ident" id="4035918">msg</span><span class="op" id="4035921">,</span>&nbsp;<span class="ident" id="4035923">off</span><span class="op" id="4035926">)</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4035929">return</span>&nbsp;<span class="ident" id="4035936">off2</span><span class="op" id="4035940">,</span>&nbsp;<span class="builtintype" id="4035942">true</span><br>
<span class="lineno"></span><span class="op" id="4035947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4035950">//&nbsp;Resource&nbsp;record&nbsp;unpacker.</span><br>
<span class="lineno"></span><span class="keyword" id="4035979">func</span>&nbsp;<span class="ident" id="4035984">unpackRR</span><span class="op" id="4035992">(</span><span class="ident" id="4035993">msg</span>&nbsp;<span class="op" id="4035997">[</span><span class="op" id="4035998">]</span><span class="builtintype" id="4035999">byte</span><span class="op" id="4036003">,</span>&nbsp;<span class="ident" id="4036005">off</span>&nbsp;<span class="builtintype" id="4036009">int</span><span class="op" id="4036012">)</span>&nbsp;<span class="op" id="4036014">(</span><span class="ident" id="4036015">rr</span>&nbsp;<span class="ident" id="4036018">dnsRR</span><span class="op" id="4036023">,</span>&nbsp;<span class="ident" id="4036025">off1</span>&nbsp;<span class="builtintype" id="4036030">int</span><span class="op" id="4036033">,</span>&nbsp;<span class="ident" id="4036035">ok</span>&nbsp;<span class="builtintype" id="4036038">bool</span><span class="op" id="4036042">)</span>&nbsp;<span class="op" id="4036044">{</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4036047">//&nbsp;unpack&nbsp;just&nbsp;the&nbsp;header,&nbsp;to&nbsp;find&nbsp;the&nbsp;rr&nbsp;type&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4036106">var</span>&nbsp;<span class="ident" id="4036110">h</span>&nbsp;<span class="ident" id="4036112">dnsRR_Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036126">off0</span>&nbsp;<span class="op" id="4036131">:=</span>&nbsp;<span class="ident" id="4036134">off</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4036139">if</span>&nbsp;<span class="ident" id="4036142">off</span><span class="op" id="4036145">,</span>&nbsp;<span class="ident" id="4036147">ok</span>&nbsp;<span class="op" id="4036150">=</span>&nbsp;<span class="ident" id="4036152">unpackStruct</span><span class="op" id="4036164">(</span><span class="op" id="4036165">&amp;</span><span class="ident" id="4036166">h</span><span class="op" id="4036167">,</span>&nbsp;<span class="ident" id="4036169">msg</span><span class="op" id="4036172">,</span>&nbsp;<span class="ident" id="4036174">off</span><span class="op" id="4036177">)</span><span class="op" id="4036178">;</span>&nbsp;<span class="op" id="4036180">!</span><span class="ident" id="4036181">ok</span>&nbsp;<span class="op" id="4036184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4036188">return</span>&nbsp;<span class="ident" id="4036195">nil</span><span class="op" id="4036198">,</span>&nbsp;<span class="builtinfunc" id="4036200">len</span><span class="op" id="4036203">(</span><span class="ident" id="4036204">msg</span><span class="op" id="4036207">)</span><span class="op" id="4036208">,</span>&nbsp;<span class="builtintype" id="4036210">false</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4036217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036220">end</span>&nbsp;<span class="op" id="4036224">:=</span>&nbsp;<span class="ident" id="4036227">off</span>&nbsp;<span class="op" id="4036231">+</span>&nbsp;<span class="builtintype" id="4036233">int</span><span class="op" id="4036236">(</span><span class="ident" id="4036237">h</span><span class="op" id="4036238">.</span><span class="ident" id="4036239">Rdlength</span><span class="op" id="4036247">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4036251">//&nbsp;make&nbsp;an&nbsp;rr&nbsp;of&nbsp;that&nbsp;type&nbsp;and&nbsp;re-unpack.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4036294">//&nbsp;again&nbsp;inefficient&nbsp;but&nbsp;doesn&#39;t&nbsp;need&nbsp;to&nbsp;be&nbsp;fast.</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036345">mk</span><span class="op" id="4036347">,</span>&nbsp;<span class="ident" id="4036349">known</span>&nbsp;<span class="op" id="4036355">:=</span>&nbsp;<span class="ident" id="4036358">rr_mk</span><span class="op" id="4036363">[</span><span class="builtintype" id="4036364">int</span><span class="op" id="4036367">(</span><span class="ident" id="4036368">h</span><span class="op" id="4036369">.</span><span class="ident" id="4036370">Rrtype</span><span class="op" id="4036376">)</span><span class="op" id="4036377">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4036380">if</span>&nbsp;<span class="op" id="4036383">!</span><span class="ident" id="4036384">known</span>&nbsp;<span class="op" id="4036390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4036394">return</span>&nbsp;<span class="op" id="4036401">&amp;</span><span class="ident" id="4036402">h</span><span class="op" id="4036403">,</span>&nbsp;<span class="ident" id="4036405">end</span><span class="op" id="4036408">,</span>&nbsp;<span class="builtintype" id="4036410">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4036416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036419">rr</span>&nbsp;<span class="op" id="4036422">=</span>&nbsp;<span class="ident" id="4036424">mk</span><span class="op" id="4036426">(</span><span class="op" id="4036427">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036430">off</span><span class="op" id="4036433">,</span>&nbsp;<span class="ident" id="4036435">ok</span>&nbsp;<span class="op" id="4036438">=</span>&nbsp;<span class="ident" id="4036440">unpackStruct</span><span class="op" id="4036452">(</span><span class="ident" id="4036453">rr</span><span class="op" id="4036455">,</span>&nbsp;<span class="ident" id="4036457">msg</span><span class="op" id="4036460">,</span>&nbsp;<span class="ident" id="4036462">off0</span><span class="op" id="4036466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4036469">if</span>&nbsp;<span class="ident" id="4036472">off</span>&nbsp;<span class="op" id="4036476">!=</span>&nbsp;<span class="ident" id="4036479">end</span>&nbsp;<span class="op" id="4036483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4036487">return</span>&nbsp;<span class="op" id="4036494">&amp;</span><span class="ident" id="4036495">h</span><span class="op" id="4036496">,</span>&nbsp;<span class="ident" id="4036498">end</span><span class="op" id="4036501">,</span>&nbsp;<span class="builtintype" id="4036503">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4036509">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4036512">return</span>&nbsp;<span class="ident" id="4036519">rr</span><span class="op" id="4036521">,</span>&nbsp;<span class="ident" id="4036523">off</span><span class="op" id="4036526">,</span>&nbsp;<span class="ident" id="4036528">ok</span><br>
<span class="lineno">710</span><span class="op" id="4036531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4036534">//&nbsp;Usable&nbsp;representation&nbsp;of&nbsp;a&nbsp;DNS&nbsp;packet.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4036577">//&nbsp;A&nbsp;manually-unpacked&nbsp;version&nbsp;of&nbsp;(id,&nbsp;bits).</span><br>
<span class="lineno">715</span><span class="comment" id="4036623">//&nbsp;This&nbsp;is&nbsp;in&nbsp;its&nbsp;own&nbsp;struct&nbsp;for&nbsp;easy&nbsp;printing.</span><br>
<span class="lineno"></span><span class="keyword" id="4036671">type</span>&nbsp;<span class="ident" id="4036676">dnsMsgHdr</span>&nbsp;<span class="keyword" id="4036686">struct</span>&nbsp;<span class="op" id="4036693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036696">id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4036716">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036724">response</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4036744">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036750">opcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4036770">int</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036775">authoritative</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4036795">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036801">truncated</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4036821">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036827">recursion_desired</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4036847">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036853">recursion_available</span>&nbsp;<span class="builtintype" id="4036873">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4036879">rcode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4036899">int</span><br>
<span class="lineno">725</span><span class="op" id="4036903">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4036906">func</span>&nbsp;<span class="op" id="4036911">(</span><span class="ident" id="4036912">h</span>&nbsp;<span class="op" id="4036914">*</span><span class="ident" id="4036915">dnsMsgHdr</span><span class="op" id="4036924">)</span>&nbsp;<span class="ident" id="4036926">Walk</span><span class="op" id="4036930">(</span><span class="ident" id="4036931">f</span>&nbsp;<span class="keyword" id="4036933">func</span><span class="op" id="4036937">(</span><span class="ident" id="4036938">v</span>&nbsp;<span class="keyword" id="4036940">interface</span><span class="op" id="4036949">{</span><span class="op" id="4036950">}</span><span class="op" id="4036951">,</span>&nbsp;<span class="ident" id="4036953">name</span><span class="op" id="4036957">,</span>&nbsp;<span class="ident" id="4036959">tag</span>&nbsp;<span class="builtintype" id="4036963">string</span><span class="op" id="4036969">)</span>&nbsp;<span class="builtintype" id="4036971">bool</span><span class="op" id="4036975">)</span>&nbsp;<span class="builtintype" id="4036977">bool</span>&nbsp;<span class="op" id="4036982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4036985">return</span>&nbsp;<span class="ident" id="4036992">f</span><span class="op" id="4036993">(</span><span class="op" id="4036994">&amp;</span><span class="ident" id="4036995">h</span><span class="op" id="4036996">.</span><span class="ident" id="4036997">id</span><span class="op" id="4036999">,</span>&nbsp;<span class="string" id="4037001">&#34;id&#34;</span><span class="op" id="4037005">,</span>&nbsp;<span class="string" id="4037007">&#34;&#34;</span><span class="op" id="4037009">)</span>&nbsp;<span class="op" id="4037011">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037016">f</span><span class="op" id="4037017">(</span><span class="op" id="4037018">&amp;</span><span class="ident" id="4037019">h</span><span class="op" id="4037020">.</span><span class="ident" id="4037021">response</span><span class="op" id="4037029">,</span>&nbsp;<span class="string" id="4037031">&#34;response&#34;</span><span class="op" id="4037041">,</span>&nbsp;<span class="string" id="4037043">&#34;&#34;</span><span class="op" id="4037045">)</span>&nbsp;<span class="op" id="4037047">&amp;&amp;</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037052">f</span><span class="op" id="4037053">(</span><span class="op" id="4037054">&amp;</span><span class="ident" id="4037055">h</span><span class="op" id="4037056">.</span><span class="ident" id="4037057">opcode</span><span class="op" id="4037063">,</span>&nbsp;<span class="string" id="4037065">&#34;opcode&#34;</span><span class="op" id="4037073">,</span>&nbsp;<span class="string" id="4037075">&#34;&#34;</span><span class="op" id="4037077">)</span>&nbsp;<span class="op" id="4037079">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037084">f</span><span class="op" id="4037085">(</span><span class="op" id="4037086">&amp;</span><span class="ident" id="4037087">h</span><span class="op" id="4037088">.</span><span class="ident" id="4037089">authoritative</span><span class="op" id="4037102">,</span>&nbsp;<span class="string" id="4037104">&#34;authoritative&#34;</span><span class="op" id="4037119">,</span>&nbsp;<span class="string" id="4037121">&#34;&#34;</span><span class="op" id="4037123">)</span>&nbsp;<span class="op" id="4037125">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037130">f</span><span class="op" id="4037131">(</span><span class="op" id="4037132">&amp;</span><span class="ident" id="4037133">h</span><span class="op" id="4037134">.</span><span class="ident" id="4037135">truncated</span><span class="op" id="4037144">,</span>&nbsp;<span class="string" id="4037146">&#34;truncated&#34;</span><span class="op" id="4037157">,</span>&nbsp;<span class="string" id="4037159">&#34;&#34;</span><span class="op" id="4037161">)</span>&nbsp;<span class="op" id="4037163">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037168">f</span><span class="op" id="4037169">(</span><span class="op" id="4037170">&amp;</span><span class="ident" id="4037171">h</span><span class="op" id="4037172">.</span><span class="ident" id="4037173">recursion_desired</span><span class="op" id="4037190">,</span>&nbsp;<span class="string" id="4037192">&#34;recursion_desired&#34;</span><span class="op" id="4037211">,</span>&nbsp;<span class="string" id="4037213">&#34;&#34;</span><span class="op" id="4037215">)</span>&nbsp;<span class="op" id="4037217">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037222">f</span><span class="op" id="4037223">(</span><span class="op" id="4037224">&amp;</span><span class="ident" id="4037225">h</span><span class="op" id="4037226">.</span><span class="ident" id="4037227">recursion_available</span><span class="op" id="4037246">,</span>&nbsp;<span class="string" id="4037248">&#34;recursion_available&#34;</span><span class="op" id="4037269">,</span>&nbsp;<span class="string" id="4037271">&#34;&#34;</span><span class="op" id="4037273">)</span>&nbsp;<span class="op" id="4037275">&amp;&amp;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037280">f</span><span class="op" id="4037281">(</span><span class="op" id="4037282">&amp;</span><span class="ident" id="4037283">h</span><span class="op" id="4037284">.</span><span class="ident" id="4037285">rcode</span><span class="op" id="4037290">,</span>&nbsp;<span class="string" id="4037292">&#34;rcode&#34;</span><span class="op" id="4037299">,</span>&nbsp;<span class="string" id="4037301">&#34;&#34;</span><span class="op" id="4037303">)</span><br>
<span class="lineno"></span><span class="op" id="4037305">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4037308">type</span>&nbsp;<span class="ident" id="4037313">dnsMsg</span>&nbsp;<span class="keyword" id="4037320">struct</span>&nbsp;<span class="op" id="4037327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037330">dnsMsgHdr</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037341">question</span>&nbsp;<span class="op" id="4037350">[</span><span class="op" id="4037351">]</span><span class="ident" id="4037352">dnsQuestion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037365">answer</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4037374">[</span><span class="op" id="4037375">]</span><span class="ident" id="4037376">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037383">ns</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4037392">[</span><span class="op" id="4037393">]</span><span class="ident" id="4037394">dnsRR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037401">extra</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4037410">[</span><span class="op" id="4037411">]</span><span class="ident" id="4037412">dnsRR</span><br>
<span class="lineno"></span><span class="op" id="4037418">}</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span><span class="keyword" id="4037421">func</span>&nbsp;<span class="op" id="4037426">(</span><span class="ident" id="4037427">dns</span>&nbsp;<span class="op" id="4037431">*</span><span class="ident" id="4037432">dnsMsg</span><span class="op" id="4037438">)</span>&nbsp;<span class="ident" id="4037440">Pack</span><span class="op" id="4037444">(</span><span class="op" id="4037445">)</span>&nbsp;<span class="op" id="4037447">(</span><span class="ident" id="4037448">msg</span>&nbsp;<span class="op" id="4037452">[</span><span class="op" id="4037453">]</span><span class="builtintype" id="4037454">byte</span><span class="op" id="4037458">,</span>&nbsp;<span class="ident" id="4037460">ok</span>&nbsp;<span class="builtintype" id="4037463">bool</span><span class="op" id="4037467">)</span>&nbsp;<span class="op" id="4037469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4037472">var</span>&nbsp;<span class="ident" id="4037476">dh</span>&nbsp;<span class="ident" id="4037479">dnsHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4037491">//&nbsp;Convert&nbsp;convenient&nbsp;dnsMsg&nbsp;into&nbsp;wire-like&nbsp;dnsHeader.</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037547">dh</span><span class="op" id="4037549">.</span><span class="ident" id="4037550">Id</span>&nbsp;<span class="op" id="4037553">=</span>&nbsp;<span class="ident" id="4037555">dns</span><span class="op" id="4037558">.</span><span class="ident" id="4037559">id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037563">dh</span><span class="op" id="4037565">.</span><span class="ident" id="4037566">Bits</span>&nbsp;<span class="op" id="4037571">=</span>&nbsp;<span class="builtintype" id="4037573">uint16</span><span class="op" id="4037579">(</span><span class="ident" id="4037580">dns</span><span class="op" id="4037583">.</span><span class="ident" id="4037584">opcode</span><span class="op" id="4037590">)</span><span class="op" id="4037591">&lt;&lt;</span><span class="num" id="4037593">11</span>&nbsp;<span class="op" id="4037596">|</span>&nbsp;<span class="builtintype" id="4037598">uint16</span><span class="op" id="4037604">(</span><span class="ident" id="4037605">dns</span><span class="op" id="4037608">.</span><span class="ident" id="4037609">rcode</span><span class="op" id="4037614">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4037617">if</span>&nbsp;<span class="ident" id="4037620">dns</span><span class="op" id="4037623">.</span><span class="ident" id="4037624">recursion_available</span>&nbsp;<span class="op" id="4037644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037648">dh</span><span class="op" id="4037650">.</span><span class="ident" id="4037651">Bits</span>&nbsp;<span class="op" id="4037656">|=</span>&nbsp;<span class="ident" id="4037659">_RA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4037664">}</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4037667">if</span>&nbsp;<span class="ident" id="4037670">dns</span><span class="op" id="4037673">.</span><span class="ident" id="4037674">recursion_desired</span>&nbsp;<span class="op" id="4037692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037696">dh</span><span class="op" id="4037698">.</span><span class="ident" id="4037699">Bits</span>&nbsp;<span class="op" id="4037704">|=</span>&nbsp;<span class="ident" id="4037707">_RD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4037712">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4037715">if</span>&nbsp;<span class="ident" id="4037718">dns</span><span class="op" id="4037721">.</span><span class="ident" id="4037722">truncated</span>&nbsp;<span class="op" id="4037732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037736">dh</span><span class="op" id="4037738">.</span><span class="ident" id="4037739">Bits</span>&nbsp;<span class="op" id="4037744">|=</span>&nbsp;<span class="ident" id="4037747">_TC</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4037752">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4037755">if</span>&nbsp;<span class="ident" id="4037758">dns</span><span class="op" id="4037761">.</span><span class="ident" id="4037762">authoritative</span>&nbsp;<span class="op" id="4037776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037780">dh</span><span class="op" id="4037782">.</span><span class="ident" id="4037783">Bits</span>&nbsp;<span class="op" id="4037788">|=</span>&nbsp;<span class="ident" id="4037791">_AA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4037796">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4037799">if</span>&nbsp;<span class="ident" id="4037802">dns</span><span class="op" id="4037805">.</span><span class="ident" id="4037806">response</span>&nbsp;<span class="op" id="4037815">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037819">dh</span><span class="op" id="4037821">.</span><span class="ident" id="4037822">Bits</span>&nbsp;<span class="op" id="4037827">|=</span>&nbsp;<span class="ident" id="4037830">_QR</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4037835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4037839">//&nbsp;Prepare&nbsp;variable&nbsp;sized&nbsp;arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037874">question</span>&nbsp;<span class="op" id="4037883">:=</span>&nbsp;<span class="ident" id="4037886">dns</span><span class="op" id="4037889">.</span><span class="ident" id="4037890">question</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037900">answer</span>&nbsp;<span class="op" id="4037907">:=</span>&nbsp;<span class="ident" id="4037910">dns</span><span class="op" id="4037913">.</span><span class="ident" id="4037914">answer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037922">ns</span>&nbsp;<span class="op" id="4037925">:=</span>&nbsp;<span class="ident" id="4037928">dns</span><span class="op" id="4037931">.</span><span class="ident" id="4037932">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037936">extra</span>&nbsp;<span class="op" id="4037942">:=</span>&nbsp;<span class="ident" id="4037945">dns</span><span class="op" id="4037948">.</span><span class="ident" id="4037949">extra</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037957">dh</span><span class="op" id="4037959">.</span><span class="ident" id="4037960">Qdcount</span>&nbsp;<span class="op" id="4037968">=</span>&nbsp;<span class="builtintype" id="4037970">uint16</span><span class="op" id="4037976">(</span><span class="builtinfunc" id="4037977">len</span><span class="op" id="4037980">(</span><span class="ident" id="4037981">question</span><span class="op" id="4037989">)</span><span class="op" id="4037990">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4037993">dh</span><span class="op" id="4037995">.</span><span class="ident" id="4037996">Ancount</span>&nbsp;<span class="op" id="4038004">=</span>&nbsp;<span class="builtintype" id="4038006">uint16</span><span class="op" id="4038012">(</span><span class="builtinfunc" id="4038013">len</span><span class="op" id="4038016">(</span><span class="ident" id="4038017">answer</span><span class="op" id="4038023">)</span><span class="op" id="4038024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038027">dh</span><span class="op" id="4038029">.</span><span class="ident" id="4038030">Nscount</span>&nbsp;<span class="op" id="4038038">=</span>&nbsp;<span class="builtintype" id="4038040">uint16</span><span class="op" id="4038046">(</span><span class="builtinfunc" id="4038047">len</span><span class="op" id="4038050">(</span><span class="ident" id="4038051">ns</span><span class="op" id="4038053">)</span><span class="op" id="4038054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038057">dh</span><span class="op" id="4038059">.</span><span class="ident" id="4038060">Arcount</span>&nbsp;<span class="op" id="4038068">=</span>&nbsp;<span class="builtintype" id="4038070">uint16</span><span class="op" id="4038076">(</span><span class="builtinfunc" id="4038077">len</span><span class="op" id="4038080">(</span><span class="ident" id="4038081">extra</span><span class="op" id="4038086">)</span><span class="op" id="4038087">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4038091">//&nbsp;Could&nbsp;work&nbsp;harder&nbsp;to&nbsp;calculate&nbsp;message&nbsp;size,</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4038140">//&nbsp;but&nbsp;this&nbsp;is&nbsp;far&nbsp;more&nbsp;than&nbsp;we&nbsp;need&nbsp;and&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4038186">//&nbsp;big&nbsp;enough&nbsp;to&nbsp;hurt&nbsp;the&nbsp;allocator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038224">msg</span>&nbsp;<span class="op" id="4038228">=</span>&nbsp;<span class="builtinfunc" id="4038230">make</span><span class="op" id="4038234">(</span><span class="op" id="4038235">[</span><span class="op" id="4038236">]</span><span class="builtintype" id="4038237">byte</span><span class="op" id="4038241">,</span>&nbsp;<span class="num" id="4038243">2000</span><span class="op" id="4038247">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4038251">//&nbsp;Pack&nbsp;it&nbsp;in:&nbsp;header&nbsp;and&nbsp;then&nbsp;the&nbsp;pieces.</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038295">off</span>&nbsp;<span class="op" id="4038299">:=</span>&nbsp;<span class="num" id="4038302">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038305">off</span><span class="op" id="4038308">,</span>&nbsp;<span class="ident" id="4038310">ok</span>&nbsp;<span class="op" id="4038313">=</span>&nbsp;<span class="ident" id="4038315">packStruct</span><span class="op" id="4038325">(</span><span class="op" id="4038326">&amp;</span><span class="ident" id="4038327">dh</span><span class="op" id="4038329">,</span>&nbsp;<span class="ident" id="4038331">msg</span><span class="op" id="4038334">,</span>&nbsp;<span class="ident" id="4038336">off</span><span class="op" id="4038339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038342">for</span>&nbsp;<span class="ident" id="4038346">i</span>&nbsp;<span class="op" id="4038348">:=</span>&nbsp;<span class="num" id="4038351">0</span><span class="op" id="4038352">;</span>&nbsp;<span class="ident" id="4038354">i</span>&nbsp;<span class="op" id="4038356">&lt;</span>&nbsp;<span class="builtinfunc" id="4038358">len</span><span class="op" id="4038361">(</span><span class="ident" id="4038362">question</span><span class="op" id="4038370">)</span><span class="op" id="4038371">;</span>&nbsp;<span class="ident" id="4038373">i</span><span class="op" id="4038374">++</span>&nbsp;<span class="op" id="4038377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038381">off</span><span class="op" id="4038384">,</span>&nbsp;<span class="ident" id="4038386">ok</span>&nbsp;<span class="op" id="4038389">=</span>&nbsp;<span class="ident" id="4038391">packStruct</span><span class="op" id="4038401">(</span><span class="op" id="4038402">&amp;</span><span class="ident" id="4038403">question</span><span class="op" id="4038411">[</span><span class="ident" id="4038412">i</span><span class="op" id="4038413">]</span><span class="op" id="4038414">,</span>&nbsp;<span class="ident" id="4038416">msg</span><span class="op" id="4038419">,</span>&nbsp;<span class="ident" id="4038421">off</span><span class="op" id="4038424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4038427">}</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038430">for</span>&nbsp;<span class="ident" id="4038434">i</span>&nbsp;<span class="op" id="4038436">:=</span>&nbsp;<span class="num" id="4038439">0</span><span class="op" id="4038440">;</span>&nbsp;<span class="ident" id="4038442">i</span>&nbsp;<span class="op" id="4038444">&lt;</span>&nbsp;<span class="builtinfunc" id="4038446">len</span><span class="op" id="4038449">(</span><span class="ident" id="4038450">answer</span><span class="op" id="4038456">)</span><span class="op" id="4038457">;</span>&nbsp;<span class="ident" id="4038459">i</span><span class="op" id="4038460">++</span>&nbsp;<span class="op" id="4038463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038467">off</span><span class="op" id="4038470">,</span>&nbsp;<span class="ident" id="4038472">ok</span>&nbsp;<span class="op" id="4038475">=</span>&nbsp;<span class="ident" id="4038477">packRR</span><span class="op" id="4038483">(</span><span class="ident" id="4038484">answer</span><span class="op" id="4038490">[</span><span class="ident" id="4038491">i</span><span class="op" id="4038492">]</span><span class="op" id="4038493">,</span>&nbsp;<span class="ident" id="4038495">msg</span><span class="op" id="4038498">,</span>&nbsp;<span class="ident" id="4038500">off</span><span class="op" id="4038503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4038506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038509">for</span>&nbsp;<span class="ident" id="4038513">i</span>&nbsp;<span class="op" id="4038515">:=</span>&nbsp;<span class="num" id="4038518">0</span><span class="op" id="4038519">;</span>&nbsp;<span class="ident" id="4038521">i</span>&nbsp;<span class="op" id="4038523">&lt;</span>&nbsp;<span class="builtinfunc" id="4038525">len</span><span class="op" id="4038528">(</span><span class="ident" id="4038529">ns</span><span class="op" id="4038531">)</span><span class="op" id="4038532">;</span>&nbsp;<span class="ident" id="4038534">i</span><span class="op" id="4038535">++</span>&nbsp;<span class="op" id="4038538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038542">off</span><span class="op" id="4038545">,</span>&nbsp;<span class="ident" id="4038547">ok</span>&nbsp;<span class="op" id="4038550">=</span>&nbsp;<span class="ident" id="4038552">packRR</span><span class="op" id="4038558">(</span><span class="ident" id="4038559">ns</span><span class="op" id="4038561">[</span><span class="ident" id="4038562">i</span><span class="op" id="4038563">]</span><span class="op" id="4038564">,</span>&nbsp;<span class="ident" id="4038566">msg</span><span class="op" id="4038569">,</span>&nbsp;<span class="ident" id="4038571">off</span><span class="op" id="4038574">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4038577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038580">for</span>&nbsp;<span class="ident" id="4038584">i</span>&nbsp;<span class="op" id="4038586">:=</span>&nbsp;<span class="num" id="4038589">0</span><span class="op" id="4038590">;</span>&nbsp;<span class="ident" id="4038592">i</span>&nbsp;<span class="op" id="4038594">&lt;</span>&nbsp;<span class="builtinfunc" id="4038596">len</span><span class="op" id="4038599">(</span><span class="ident" id="4038600">extra</span><span class="op" id="4038605">)</span><span class="op" id="4038606">;</span>&nbsp;<span class="ident" id="4038608">i</span><span class="op" id="4038609">++</span>&nbsp;<span class="op" id="4038612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038616">off</span><span class="op" id="4038619">,</span>&nbsp;<span class="ident" id="4038621">ok</span>&nbsp;<span class="op" id="4038624">=</span>&nbsp;<span class="ident" id="4038626">packRR</span><span class="op" id="4038632">(</span><span class="ident" id="4038633">extra</span><span class="op" id="4038638">[</span><span class="ident" id="4038639">i</span><span class="op" id="4038640">]</span><span class="op" id="4038641">,</span>&nbsp;<span class="ident" id="4038643">msg</span><span class="op" id="4038646">,</span>&nbsp;<span class="ident" id="4038648">off</span><span class="op" id="4038651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4038654">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038657">if</span>&nbsp;<span class="op" id="4038660">!</span><span class="ident" id="4038661">ok</span>&nbsp;<span class="op" id="4038664">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038668">return</span>&nbsp;<span class="ident" id="4038675">nil</span><span class="op" id="4038678">,</span>&nbsp;<span class="builtintype" id="4038680">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4038687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038690">return</span>&nbsp;<span class="ident" id="4038697">msg</span><span class="op" id="4038700">[</span><span class="num" id="4038701">0</span><span class="op" id="4038702">:</span><span class="ident" id="4038703">off</span><span class="op" id="4038706">]</span><span class="op" id="4038707">,</span>&nbsp;<span class="builtintype" id="4038709">true</span><br>
<span class="lineno"></span><span class="op" id="4038714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="keyword" id="4038717">func</span>&nbsp;<span class="op" id="4038722">(</span><span class="ident" id="4038723">dns</span>&nbsp;<span class="op" id="4038727">*</span><span class="ident" id="4038728">dnsMsg</span><span class="op" id="4038734">)</span>&nbsp;<span class="ident" id="4038736">Unpack</span><span class="op" id="4038742">(</span><span class="ident" id="4038743">msg</span>&nbsp;<span class="op" id="4038747">[</span><span class="op" id="4038748">]</span><span class="builtintype" id="4038749">byte</span><span class="op" id="4038753">)</span>&nbsp;<span class="builtintype" id="4038755">bool</span>&nbsp;<span class="op" id="4038760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4038763">//&nbsp;Header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038775">var</span>&nbsp;<span class="ident" id="4038779">dh</span>&nbsp;<span class="ident" id="4038782">dnsHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038793">off</span>&nbsp;<span class="op" id="4038797">:=</span>&nbsp;<span class="num" id="4038800">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038803">var</span>&nbsp;<span class="ident" id="4038807">ok</span>&nbsp;<span class="builtintype" id="4038810">bool</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038816">if</span>&nbsp;<span class="ident" id="4038819">off</span><span class="op" id="4038822">,</span>&nbsp;<span class="ident" id="4038824">ok</span>&nbsp;<span class="op" id="4038827">=</span>&nbsp;<span class="ident" id="4038829">unpackStruct</span><span class="op" id="4038841">(</span><span class="op" id="4038842">&amp;</span><span class="ident" id="4038843">dh</span><span class="op" id="4038845">,</span>&nbsp;<span class="ident" id="4038847">msg</span><span class="op" id="4038850">,</span>&nbsp;<span class="ident" id="4038852">off</span><span class="op" id="4038855">)</span><span class="op" id="4038856">;</span>&nbsp;<span class="op" id="4038858">!</span><span class="ident" id="4038859">ok</span>&nbsp;<span class="op" id="4038862">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4038866">return</span>&nbsp;<span class="builtintype" id="4038873">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4038880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038883">dns</span><span class="op" id="4038886">.</span><span class="ident" id="4038887">id</span>&nbsp;<span class="op" id="4038890">=</span>&nbsp;<span class="ident" id="4038892">dh</span><span class="op" id="4038894">.</span><span class="ident" id="4038895">Id</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038899">dns</span><span class="op" id="4038902">.</span><span class="ident" id="4038903">response</span>&nbsp;<span class="op" id="4038912">=</span>&nbsp;<span class="op" id="4038914">(</span><span class="ident" id="4038915">dh</span><span class="op" id="4038917">.</span><span class="ident" id="4038918">Bits</span>&nbsp;<span class="op" id="4038923">&amp;</span>&nbsp;<span class="ident" id="4038925">_QR</span><span class="op" id="4038928">)</span>&nbsp;<span class="op" id="4038930">!=</span>&nbsp;<span class="num" id="4038933">0</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038936">dns</span><span class="op" id="4038939">.</span><span class="ident" id="4038940">opcode</span>&nbsp;<span class="op" id="4038947">=</span>&nbsp;<span class="builtintype" id="4038949">int</span><span class="op" id="4038952">(</span><span class="ident" id="4038953">dh</span><span class="op" id="4038955">.</span><span class="ident" id="4038956">Bits</span><span class="op" id="4038960">&gt;&gt;</span><span class="num" id="4038962">11</span><span class="op" id="4038964">)</span>&nbsp;<span class="op" id="4038966">&amp;</span>&nbsp;<span class="num" id="4038968">0xF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4038973">dns</span><span class="op" id="4038976">.</span><span class="ident" id="4038977">authoritative</span>&nbsp;<span class="op" id="4038991">=</span>&nbsp;<span class="op" id="4038993">(</span><span class="ident" id="4038994">dh</span><span class="op" id="4038996">.</span><span class="ident" id="4038997">Bits</span>&nbsp;<span class="op" id="4039002">&amp;</span>&nbsp;<span class="ident" id="4039004">_AA</span><span class="op" id="4039007">)</span>&nbsp;<span class="op" id="4039009">!=</span>&nbsp;<span class="num" id="4039012">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039015">dns</span><span class="op" id="4039018">.</span><span class="ident" id="4039019">truncated</span>&nbsp;<span class="op" id="4039029">=</span>&nbsp;<span class="op" id="4039031">(</span><span class="ident" id="4039032">dh</span><span class="op" id="4039034">.</span><span class="ident" id="4039035">Bits</span>&nbsp;<span class="op" id="4039040">&amp;</span>&nbsp;<span class="ident" id="4039042">_TC</span><span class="op" id="4039045">)</span>&nbsp;<span class="op" id="4039047">!=</span>&nbsp;<span class="num" id="4039050">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039053">dns</span><span class="op" id="4039056">.</span><span class="ident" id="4039057">recursion_desired</span>&nbsp;<span class="op" id="4039075">=</span>&nbsp;<span class="op" id="4039077">(</span><span class="ident" id="4039078">dh</span><span class="op" id="4039080">.</span><span class="ident" id="4039081">Bits</span>&nbsp;<span class="op" id="4039086">&amp;</span>&nbsp;<span class="ident" id="4039088">_RD</span><span class="op" id="4039091">)</span>&nbsp;<span class="op" id="4039093">!=</span>&nbsp;<span class="num" id="4039096">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039099">dns</span><span class="op" id="4039102">.</span><span class="ident" id="4039103">recursion_available</span>&nbsp;<span class="op" id="4039123">=</span>&nbsp;<span class="op" id="4039125">(</span><span class="ident" id="4039126">dh</span><span class="op" id="4039128">.</span><span class="ident" id="4039129">Bits</span>&nbsp;<span class="op" id="4039134">&amp;</span>&nbsp;<span class="ident" id="4039136">_RA</span><span class="op" id="4039139">)</span>&nbsp;<span class="op" id="4039141">!=</span>&nbsp;<span class="num" id="4039144">0</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039147">dns</span><span class="op" id="4039150">.</span><span class="ident" id="4039151">rcode</span>&nbsp;<span class="op" id="4039157">=</span>&nbsp;<span class="builtintype" id="4039159">int</span><span class="op" id="4039162">(</span><span class="ident" id="4039163">dh</span><span class="op" id="4039165">.</span><span class="ident" id="4039166">Bits</span>&nbsp;<span class="op" id="4039171">&amp;</span>&nbsp;<span class="num" id="4039173">0xF</span><span class="op" id="4039176">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4039180">//&nbsp;Arrays.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039192">dns</span><span class="op" id="4039195">.</span><span class="ident" id="4039196">question</span>&nbsp;<span class="op" id="4039205">=</span>&nbsp;<span class="builtinfunc" id="4039207">make</span><span class="op" id="4039211">(</span><span class="op" id="4039212">[</span><span class="op" id="4039213">]</span><span class="ident" id="4039214">dnsQuestion</span><span class="op" id="4039225">,</span>&nbsp;<span class="ident" id="4039227">dh</span><span class="op" id="4039229">.</span><span class="ident" id="4039230">Qdcount</span><span class="op" id="4039237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039240">dns</span><span class="op" id="4039243">.</span><span class="ident" id="4039244">answer</span>&nbsp;<span class="op" id="4039251">=</span>&nbsp;<span class="builtinfunc" id="4039253">make</span><span class="op" id="4039257">(</span><span class="op" id="4039258">[</span><span class="op" id="4039259">]</span><span class="ident" id="4039260">dnsRR</span><span class="op" id="4039265">,</span>&nbsp;<span class="num" id="4039267">0</span><span class="op" id="4039268">,</span>&nbsp;<span class="ident" id="4039270">dh</span><span class="op" id="4039272">.</span><span class="ident" id="4039273">Ancount</span><span class="op" id="4039280">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039283">dns</span><span class="op" id="4039286">.</span><span class="ident" id="4039287">ns</span>&nbsp;<span class="op" id="4039290">=</span>&nbsp;<span class="builtinfunc" id="4039292">make</span><span class="op" id="4039296">(</span><span class="op" id="4039297">[</span><span class="op" id="4039298">]</span><span class="ident" id="4039299">dnsRR</span><span class="op" id="4039304">,</span>&nbsp;<span class="num" id="4039306">0</span><span class="op" id="4039307">,</span>&nbsp;<span class="ident" id="4039309">dh</span><span class="op" id="4039311">.</span><span class="ident" id="4039312">Nscount</span><span class="op" id="4039319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039322">dns</span><span class="op" id="4039325">.</span><span class="ident" id="4039326">extra</span>&nbsp;<span class="op" id="4039332">=</span>&nbsp;<span class="builtinfunc" id="4039334">make</span><span class="op" id="4039338">(</span><span class="op" id="4039339">[</span><span class="op" id="4039340">]</span><span class="ident" id="4039341">dnsRR</span><span class="op" id="4039346">,</span>&nbsp;<span class="num" id="4039348">0</span><span class="op" id="4039349">,</span>&nbsp;<span class="ident" id="4039351">dh</span><span class="op" id="4039353">.</span><span class="ident" id="4039354">Arcount</span><span class="op" id="4039361">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039365">var</span>&nbsp;<span class="ident" id="4039369">rec</span>&nbsp;<span class="ident" id="4039373">dnsRR</span><br>
<span class="lineno"></span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039381">for</span>&nbsp;<span class="ident" id="4039385">i</span>&nbsp;<span class="op" id="4039387">:=</span>&nbsp;<span class="num" id="4039390">0</span><span class="op" id="4039391">;</span>&nbsp;<span class="ident" id="4039393">i</span>&nbsp;<span class="op" id="4039395">&lt;</span>&nbsp;<span class="builtinfunc" id="4039397">len</span><span class="op" id="4039400">(</span><span class="ident" id="4039401">dns</span><span class="op" id="4039404">.</span><span class="ident" id="4039405">question</span><span class="op" id="4039413">)</span><span class="op" id="4039414">;</span>&nbsp;<span class="ident" id="4039416">i</span><span class="op" id="4039417">++</span>&nbsp;<span class="op" id="4039420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039424">off</span><span class="op" id="4039427">,</span>&nbsp;<span class="ident" id="4039429">ok</span>&nbsp;<span class="op" id="4039432">=</span>&nbsp;<span class="ident" id="4039434">unpackStruct</span><span class="op" id="4039446">(</span><span class="op" id="4039447">&amp;</span><span class="ident" id="4039448">dns</span><span class="op" id="4039451">.</span><span class="ident" id="4039452">question</span><span class="op" id="4039460">[</span><span class="ident" id="4039461">i</span><span class="op" id="4039462">]</span><span class="op" id="4039463">,</span>&nbsp;<span class="ident" id="4039465">msg</span><span class="op" id="4039468">,</span>&nbsp;<span class="ident" id="4039470">off</span><span class="op" id="4039473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4039476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039479">for</span>&nbsp;<span class="ident" id="4039483">i</span>&nbsp;<span class="op" id="4039485">:=</span>&nbsp;<span class="num" id="4039488">0</span><span class="op" id="4039489">;</span>&nbsp;<span class="ident" id="4039491">i</span>&nbsp;<span class="op" id="4039493">&lt;</span>&nbsp;<span class="builtintype" id="4039495">int</span><span class="op" id="4039498">(</span><span class="ident" id="4039499">dh</span><span class="op" id="4039501">.</span><span class="ident" id="4039502">Ancount</span><span class="op" id="4039509">)</span><span class="op" id="4039510">;</span>&nbsp;<span class="ident" id="4039512">i</span><span class="op" id="4039513">++</span>&nbsp;<span class="op" id="4039516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039520">rec</span><span class="op" id="4039523">,</span>&nbsp;<span class="ident" id="4039525">off</span><span class="op" id="4039528">,</span>&nbsp;<span class="ident" id="4039530">ok</span>&nbsp;<span class="op" id="4039533">=</span>&nbsp;<span class="ident" id="4039535">unpackRR</span><span class="op" id="4039543">(</span><span class="ident" id="4039544">msg</span><span class="op" id="4039547">,</span>&nbsp;<span class="ident" id="4039549">off</span><span class="op" id="4039552">)</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039556">if</span>&nbsp;<span class="op" id="4039559">!</span><span class="ident" id="4039560">ok</span>&nbsp;<span class="op" id="4039563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039568">return</span>&nbsp;<span class="builtintype" id="4039575">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4039583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039587">dns</span><span class="op" id="4039590">.</span><span class="ident" id="4039591">answer</span>&nbsp;<span class="op" id="4039598">=</span>&nbsp;<span class="builtinfunc" id="4039600">append</span><span class="op" id="4039606">(</span><span class="ident" id="4039607">dns</span><span class="op" id="4039610">.</span><span class="ident" id="4039611">answer</span><span class="op" id="4039617">,</span>&nbsp;<span class="ident" id="4039619">rec</span><span class="op" id="4039622">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4039625">}</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039628">for</span>&nbsp;<span class="ident" id="4039632">i</span>&nbsp;<span class="op" id="4039634">:=</span>&nbsp;<span class="num" id="4039637">0</span><span class="op" id="4039638">;</span>&nbsp;<span class="ident" id="4039640">i</span>&nbsp;<span class="op" id="4039642">&lt;</span>&nbsp;<span class="builtintype" id="4039644">int</span><span class="op" id="4039647">(</span><span class="ident" id="4039648">dh</span><span class="op" id="4039650">.</span><span class="ident" id="4039651">Nscount</span><span class="op" id="4039658">)</span><span class="op" id="4039659">;</span>&nbsp;<span class="ident" id="4039661">i</span><span class="op" id="4039662">++</span>&nbsp;<span class="op" id="4039665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039669">rec</span><span class="op" id="4039672">,</span>&nbsp;<span class="ident" id="4039674">off</span><span class="op" id="4039677">,</span>&nbsp;<span class="ident" id="4039679">ok</span>&nbsp;<span class="op" id="4039682">=</span>&nbsp;<span class="ident" id="4039684">unpackRR</span><span class="op" id="4039692">(</span><span class="ident" id="4039693">msg</span><span class="op" id="4039696">,</span>&nbsp;<span class="ident" id="4039698">off</span><span class="op" id="4039701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039705">if</span>&nbsp;<span class="op" id="4039708">!</span><span class="ident" id="4039709">ok</span>&nbsp;<span class="op" id="4039712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039717">return</span>&nbsp;<span class="builtintype" id="4039724">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4039732">}</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039736">dns</span><span class="op" id="4039739">.</span><span class="ident" id="4039740">ns</span>&nbsp;<span class="op" id="4039743">=</span>&nbsp;<span class="builtinfunc" id="4039745">append</span><span class="op" id="4039751">(</span><span class="ident" id="4039752">dns</span><span class="op" id="4039755">.</span><span class="ident" id="4039756">ns</span><span class="op" id="4039758">,</span>&nbsp;<span class="ident" id="4039760">rec</span><span class="op" id="4039763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4039766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039769">for</span>&nbsp;<span class="ident" id="4039773">i</span>&nbsp;<span class="op" id="4039775">:=</span>&nbsp;<span class="num" id="4039778">0</span><span class="op" id="4039779">;</span>&nbsp;<span class="ident" id="4039781">i</span>&nbsp;<span class="op" id="4039783">&lt;</span>&nbsp;<span class="builtintype" id="4039785">int</span><span class="op" id="4039788">(</span><span class="ident" id="4039789">dh</span><span class="op" id="4039791">.</span><span class="ident" id="4039792">Arcount</span><span class="op" id="4039799">)</span><span class="op" id="4039800">;</span>&nbsp;<span class="ident" id="4039802">i</span><span class="op" id="4039803">++</span>&nbsp;<span class="op" id="4039806">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039810">rec</span><span class="op" id="4039813">,</span>&nbsp;<span class="ident" id="4039815">off</span><span class="op" id="4039818">,</span>&nbsp;<span class="ident" id="4039820">ok</span>&nbsp;<span class="op" id="4039823">=</span>&nbsp;<span class="ident" id="4039825">unpackRR</span><span class="op" id="4039833">(</span><span class="ident" id="4039834">msg</span><span class="op" id="4039837">,</span>&nbsp;<span class="ident" id="4039839">off</span><span class="op" id="4039842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039846">if</span>&nbsp;<span class="op" id="4039849">!</span><span class="ident" id="4039850">ok</span>&nbsp;<span class="op" id="4039853">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4039858">return</span>&nbsp;<span class="builtintype" id="4039865">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4039873">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4039877">dns</span><span class="op" id="4039880">.</span><span class="ident" id="4039881">extra</span>&nbsp;<span class="op" id="4039887">=</span>&nbsp;<span class="builtinfunc" id="4039889">append</span><span class="op" id="4039895">(</span><span class="ident" id="4039896">dns</span><span class="op" id="4039899">.</span><span class="ident" id="4039900">extra</span><span class="op" id="4039905">,</span>&nbsp;<span class="ident" id="4039907">rec</span><span class="op" id="4039910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4039913">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4039916">//&nbsp;&nbsp;&nbsp;&nbspif&nbsp;off&nbsp;!=&nbsp;len(msg)&nbsp;{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4039941">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspprintln(&#34;extra&nbsp;bytes&nbsp;in&nbsp;dns&nbsp;packet&#34;,&nbsp;off,&nbsp;&#34;&lt;&#34;,&nbsp;len(msg));</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4040004">//&nbsp;&nbsp;&nbsp;&nbsp}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040010">return</span>&nbsp;<span class="builtintype" id="4040017">true</span><br>
<span class="lineno"></span><span class="op" id="4040022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">860</span><span class="keyword" id="4040025">func</span>&nbsp;<span class="op" id="4040030">(</span><span class="ident" id="4040031">dns</span>&nbsp;<span class="op" id="4040035">*</span><span class="ident" id="4040036">dnsMsg</span><span class="op" id="4040042">)</span>&nbsp;<span class="ident" id="4040044">String</span><span class="op" id="4040050">(</span><span class="op" id="4040051">)</span>&nbsp;<span class="builtintype" id="4040053">string</span>&nbsp;<span class="op" id="4040060">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040063">s</span>&nbsp;<span class="op" id="4040065">:=</span>&nbsp;<span class="string" id="4040068">&#34;DNS:&nbsp;&#34;</span>&nbsp;<span class="op" id="4040076">+</span>&nbsp;<span class="ident" id="4040078">printStruct</span><span class="op" id="4040089">(</span><span class="op" id="4040090">&amp;</span><span class="ident" id="4040091">dns</span><span class="op" id="4040094">.</span><span class="ident" id="4040095">dnsMsgHdr</span><span class="op" id="4040104">)</span>&nbsp;<span class="op" id="4040106">+</span>&nbsp;<span class="string" id="4040108">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040114">if</span>&nbsp;<span class="builtinfunc" id="4040117">len</span><span class="op" id="4040120">(</span><span class="ident" id="4040121">dns</span><span class="op" id="4040124">.</span><span class="ident" id="4040125">question</span><span class="op" id="4040133">)</span>&nbsp;<span class="op" id="4040135">&gt;</span>&nbsp;<span class="num" id="4040137">0</span>&nbsp;<span class="op" id="4040139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040143">s</span>&nbsp;<span class="op" id="4040145">+=</span>&nbsp;<span class="string" id="4040148">&#34;--&nbsp;Questions\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040167">for</span>&nbsp;<span class="ident" id="4040171">i</span>&nbsp;<span class="op" id="4040173">:=</span>&nbsp;<span class="num" id="4040176">0</span><span class="op" id="4040177">;</span>&nbsp;<span class="ident" id="4040179">i</span>&nbsp;<span class="op" id="4040181">&lt;</span>&nbsp;<span class="builtinfunc" id="4040183">len</span><span class="op" id="4040186">(</span><span class="ident" id="4040187">dns</span><span class="op" id="4040190">.</span><span class="ident" id="4040191">question</span><span class="op" id="4040199">)</span><span class="op" id="4040200">;</span>&nbsp;<span class="ident" id="4040202">i</span><span class="op" id="4040203">++</span>&nbsp;<span class="op" id="4040206">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040211">s</span>&nbsp;<span class="op" id="4040213">+=</span>&nbsp;<span class="ident" id="4040216">printStruct</span><span class="op" id="4040227">(</span><span class="op" id="4040228">&amp;</span><span class="ident" id="4040229">dns</span><span class="op" id="4040232">.</span><span class="ident" id="4040233">question</span><span class="op" id="4040241">[</span><span class="ident" id="4040242">i</span><span class="op" id="4040243">]</span><span class="op" id="4040244">)</span>&nbsp;<span class="op" id="4040246">+</span>&nbsp;<span class="string" id="4040248">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4040255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4040258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040261">if</span>&nbsp;<span class="builtinfunc" id="4040264">len</span><span class="op" id="4040267">(</span><span class="ident" id="4040268">dns</span><span class="op" id="4040271">.</span><span class="ident" id="4040272">answer</span><span class="op" id="4040278">)</span>&nbsp;<span class="op" id="4040280">&gt;</span>&nbsp;<span class="num" id="4040282">0</span>&nbsp;<span class="op" id="4040284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040288">s</span>&nbsp;<span class="op" id="4040290">+=</span>&nbsp;<span class="string" id="4040293">&#34;--&nbsp;Answers\n&#34;</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040310">for</span>&nbsp;<span class="ident" id="4040314">i</span>&nbsp;<span class="op" id="4040316">:=</span>&nbsp;<span class="num" id="4040319">0</span><span class="op" id="4040320">;</span>&nbsp;<span class="ident" id="4040322">i</span>&nbsp;<span class="op" id="4040324">&lt;</span>&nbsp;<span class="builtinfunc" id="4040326">len</span><span class="op" id="4040329">(</span><span class="ident" id="4040330">dns</span><span class="op" id="4040333">.</span><span class="ident" id="4040334">answer</span><span class="op" id="4040340">)</span><span class="op" id="4040341">;</span>&nbsp;<span class="ident" id="4040343">i</span><span class="op" id="4040344">++</span>&nbsp;<span class="op" id="4040347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040352">s</span>&nbsp;<span class="op" id="4040354">+=</span>&nbsp;<span class="ident" id="4040357">printStruct</span><span class="op" id="4040368">(</span><span class="ident" id="4040369">dns</span><span class="op" id="4040372">.</span><span class="ident" id="4040373">answer</span><span class="op" id="4040379">[</span><span class="ident" id="4040380">i</span><span class="op" id="4040381">]</span><span class="op" id="4040382">)</span>&nbsp;<span class="op" id="4040384">+</span>&nbsp;<span class="string" id="4040386">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4040393">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4040396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040399">if</span>&nbsp;<span class="builtinfunc" id="4040402">len</span><span class="op" id="4040405">(</span><span class="ident" id="4040406">dns</span><span class="op" id="4040409">.</span><span class="ident" id="4040410">ns</span><span class="op" id="4040412">)</span>&nbsp;<span class="op" id="4040414">&gt;</span>&nbsp;<span class="num" id="4040416">0</span>&nbsp;<span class="op" id="4040418">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040422">s</span>&nbsp;<span class="op" id="4040424">+=</span>&nbsp;<span class="string" id="4040427">&#34;--&nbsp;Name&nbsp;servers\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040449">for</span>&nbsp;<span class="ident" id="4040453">i</span>&nbsp;<span class="op" id="4040455">:=</span>&nbsp;<span class="num" id="4040458">0</span><span class="op" id="4040459">;</span>&nbsp;<span class="ident" id="4040461">i</span>&nbsp;<span class="op" id="4040463">&lt;</span>&nbsp;<span class="builtinfunc" id="4040465">len</span><span class="op" id="4040468">(</span><span class="ident" id="4040469">dns</span><span class="op" id="4040472">.</span><span class="ident" id="4040473">ns</span><span class="op" id="4040475">)</span><span class="op" id="4040476">;</span>&nbsp;<span class="ident" id="4040478">i</span><span class="op" id="4040479">++</span>&nbsp;<span class="op" id="4040482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040487">s</span>&nbsp;<span class="op" id="4040489">+=</span>&nbsp;<span class="ident" id="4040492">printStruct</span><span class="op" id="4040503">(</span><span class="ident" id="4040504">dns</span><span class="op" id="4040507">.</span><span class="ident" id="4040508">ns</span><span class="op" id="4040510">[</span><span class="ident" id="4040511">i</span><span class="op" id="4040512">]</span><span class="op" id="4040513">)</span>&nbsp;<span class="op" id="4040515">+</span>&nbsp;<span class="string" id="4040517">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4040524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4040527">}</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040530">if</span>&nbsp;<span class="builtinfunc" id="4040533">len</span><span class="op" id="4040536">(</span><span class="ident" id="4040537">dns</span><span class="op" id="4040540">.</span><span class="ident" id="4040541">extra</span><span class="op" id="4040546">)</span>&nbsp;<span class="op" id="4040548">&gt;</span>&nbsp;<span class="num" id="4040550">0</span>&nbsp;<span class="op" id="4040552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040556">s</span>&nbsp;<span class="op" id="4040558">+=</span>&nbsp;<span class="string" id="4040561">&#34;--&nbsp;Extra\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040576">for</span>&nbsp;<span class="ident" id="4040580">i</span>&nbsp;<span class="op" id="4040582">:=</span>&nbsp;<span class="num" id="4040585">0</span><span class="op" id="4040586">;</span>&nbsp;<span class="ident" id="4040588">i</span>&nbsp;<span class="op" id="4040590">&lt;</span>&nbsp;<span class="builtinfunc" id="4040592">len</span><span class="op" id="4040595">(</span><span class="ident" id="4040596">dns</span><span class="op" id="4040599">.</span><span class="ident" id="4040600">extra</span><span class="op" id="4040605">)</span><span class="op" id="4040606">;</span>&nbsp;<span class="ident" id="4040608">i</span><span class="op" id="4040609">++</span>&nbsp;<span class="op" id="4040612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4040617">s</span>&nbsp;<span class="op" id="4040619">+=</span>&nbsp;<span class="ident" id="4040622">printStruct</span><span class="op" id="4040633">(</span><span class="ident" id="4040634">dns</span><span class="op" id="4040637">.</span><span class="ident" id="4040638">extra</span><span class="op" id="4040643">[</span><span class="ident" id="4040644">i</span><span class="op" id="4040645">]</span><span class="op" id="4040646">)</span>&nbsp;<span class="op" id="4040648">+</span>&nbsp;<span class="string" id="4040650">&#34;\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4040657">}</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4040660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4040663">return</span>&nbsp;<span class="ident" id="4040670">s</span><br>
<span class="lineno"></span><span class="op" id="4040672">}</span>
</div>
</body>
</html>
