<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template/parse</h2>
<ul>
<li><a href="/gostd/text/template/parse/lex.go.html">lex.go</a></li>
<li><a href="/gostd/text/template/parse/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/text/template/parse/node.go.html">node.go</a></li>
<li><a href="/gostd/text/template/parse/parse.go.html">parse.go</a></li>
<li><a href="/gostd/text/template/parse/parse_test.go.html">parse_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3473054">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3473109">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3473163">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3473214">//&nbsp;Parse&nbsp;nodes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3473231">package</span>&nbsp;<span class="ident" id="3473239">parse</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3473246">import</span>&nbsp;<span class="op" id="3473253">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3473256">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3473265">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3473272">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3473283">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="3473293">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="3473296">var</span>&nbsp;<span class="ident" id="3473300">textFormat</span>&nbsp;<span class="op" id="3473311">=</span>&nbsp;<span class="string" id="3473313">&#34;%s&#34;</span>&nbsp;<span class="comment" id="3473318">//&nbsp;Changed&nbsp;to&nbsp;&#34;%q&#34;&nbsp;in&nbsp;tests&nbsp;for&nbsp;better&nbsp;error&nbsp;messages.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3473374">//&nbsp;A&nbsp;Node&nbsp;is&nbsp;an&nbsp;element&nbsp;in&nbsp;the&nbsp;parse&nbsp;tree.&nbsp;The&nbsp;interface&nbsp;is&nbsp;trivial.</span><br>
<span class="lineno"></span><span class="comment" id="3473443">//&nbsp;The&nbsp;interface&nbsp;contains&nbsp;an&nbsp;unexported&nbsp;method&nbsp;so&nbsp;that&nbsp;only</span><br>
<span class="lineno">20</span><span class="comment" id="3473503">//&nbsp;types&nbsp;local&nbsp;to&nbsp;this&nbsp;package&nbsp;can&nbsp;satisfy&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="3473550">type</span>&nbsp;<span class="ident" id="3473555">Node</span>&nbsp;<span class="keyword" id="3473560">interface</span>&nbsp;<span class="op" id="3473570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3473573">Type</span><span class="op" id="3473577">(</span><span class="op" id="3473578">)</span>&nbsp;<span class="ident" id="3473580">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3473590">String</span><span class="op" id="3473596">(</span><span class="op" id="3473597">)</span>&nbsp;<span class="builtintype" id="3473599">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3473607">//&nbsp;Copy&nbsp;does&nbsp;a&nbsp;deep&nbsp;copy&nbsp;of&nbsp;the&nbsp;Node&nbsp;and&nbsp;all&nbsp;its&nbsp;components.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3473669">//&nbsp;To&nbsp;avoid&nbsp;type&nbsp;assertions,&nbsp;some&nbsp;XxxNodes&nbsp;also&nbsp;have&nbsp;specialized</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3473735">//&nbsp;CopyXxx&nbsp;methods&nbsp;that&nbsp;return&nbsp;*XxxNode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3473777">Copy</span><span class="op" id="3473781">(</span><span class="op" id="3473782">)</span>&nbsp;<span class="ident" id="3473784">Node</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3473790">Position</span><span class="op" id="3473798">(</span><span class="op" id="3473799">)</span>&nbsp;<span class="ident" id="3473801">Pos</span>&nbsp;<span class="comment" id="3473805">//&nbsp;byte&nbsp;position&nbsp;of&nbsp;start&nbsp;of&nbsp;node&nbsp;in&nbsp;full&nbsp;original&nbsp;input&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3473870">//&nbsp;tree&nbsp;returns&nbsp;the&nbsp;containing&nbsp;*Tree.</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3473909">//&nbsp;It&nbsp;is&nbsp;unexported&nbsp;so&nbsp;all&nbsp;implementations&nbsp;of&nbsp;Node&nbsp;are&nbsp;in&nbsp;this&nbsp;package.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3473982">tree</span><span class="op" id="3473986">(</span><span class="op" id="3473987">)</span>&nbsp;<span class="op" id="3473989">*</span><span class="ident" id="3473990">Tree</span><br>
<span class="lineno"></span><span class="op" id="3473995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3473998">//&nbsp;NodeType&nbsp;identifies&nbsp;the&nbsp;type&nbsp;of&nbsp;a&nbsp;parse&nbsp;tree&nbsp;node.</span><br>
<span class="lineno">35</span><span class="keyword" id="3474052">type</span>&nbsp;<span class="ident" id="3474057">NodeType</span>&nbsp;<span class="builtintype" id="3474066">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3474071">//&nbsp;Pos&nbsp;represents&nbsp;a&nbsp;byte&nbsp;position&nbsp;in&nbsp;the&nbsp;original&nbsp;input&nbsp;text&nbsp;from&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="3474143">//&nbsp;this&nbsp;template&nbsp;was&nbsp;parsed.</span><br>
<span class="lineno"></span><span class="keyword" id="3474172">type</span>&nbsp;<span class="ident" id="3474177">Pos</span>&nbsp;<span class="builtintype" id="3474181">int</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3474186">func</span>&nbsp;<span class="op" id="3474191">(</span><span class="ident" id="3474192">p</span>&nbsp;<span class="ident" id="3474194">Pos</span><span class="op" id="3474197">)</span>&nbsp;<span class="ident" id="3474199">Position</span><span class="op" id="3474207">(</span><span class="op" id="3474208">)</span>&nbsp;<span class="ident" id="3474210">Pos</span>&nbsp;<span class="op" id="3474214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3474217">return</span>&nbsp;<span class="ident" id="3474224">p</span><br>
<span class="lineno"></span><span class="op" id="3474226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="3474229">//&nbsp;Type&nbsp;returns&nbsp;itself&nbsp;and&nbsp;provides&nbsp;an&nbsp;easy&nbsp;default&nbsp;implementation</span><br>
<span class="lineno"></span><span class="comment" id="3474296">//&nbsp;for&nbsp;embedding&nbsp;in&nbsp;a&nbsp;Node.&nbsp;Embedded&nbsp;in&nbsp;all&nbsp;non-trivial&nbsp;Nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="3474359">func</span>&nbsp;<span class="op" id="3474364">(</span><span class="ident" id="3474365">t</span>&nbsp;<span class="ident" id="3474367">NodeType</span><span class="op" id="3474375">)</span>&nbsp;<span class="ident" id="3474377">Type</span><span class="op" id="3474381">(</span><span class="op" id="3474382">)</span>&nbsp;<span class="ident" id="3474384">NodeType</span>&nbsp;<span class="op" id="3474393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3474396">return</span>&nbsp;<span class="ident" id="3474403">t</span><br>
<span class="lineno"></span><span class="op" id="3474405">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="3474408">const</span>&nbsp;<span class="op" id="3474414">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3474417">NodeText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3474432">NodeType</span>&nbsp;<span class="op" id="3474441">=</span>&nbsp;<span class="ident" id="3474443">iota</span>&nbsp;<span class="comment" id="3474448">//&nbsp;Plain&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3474464">NodeAction</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3474495">//&nbsp;A&nbsp;non-control&nbsp;action&nbsp;such&nbsp;as&nbsp;a&nbsp;field&nbsp;evaluation.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3474548">NodeBool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3474579">//&nbsp;A&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3474603">NodeChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3474634">//&nbsp;A&nbsp;sequence&nbsp;of&nbsp;field&nbsp;accesses.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3474668">NodeCommand</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3474699">//&nbsp;An&nbsp;element&nbsp;of&nbsp;a&nbsp;pipeline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3474729">NodeDot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3474760">//&nbsp;The&nbsp;cursor,&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3474781">nodeElse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3474812">//&nbsp;An&nbsp;else&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3474851">nodeEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3474882">//&nbsp;An&nbsp;end&nbsp;action.&nbsp;Not&nbsp;added&nbsp;to&nbsp;tree.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3474920">NodeField</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3474951">//&nbsp;A&nbsp;field&nbsp;or&nbsp;method&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3474979">NodeIdentifier</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3475010">//&nbsp;An&nbsp;identifier;&nbsp;always&nbsp;a&nbsp;function&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475053">NodeIf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3475084">//&nbsp;An&nbsp;if&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475102">NodeList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3475133">//&nbsp;A&nbsp;list&nbsp;of&nbsp;Nodes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475154">NodeNil</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3475185">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475214">NodeNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3475245">//&nbsp;A&nbsp;numerical&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475271">NodePipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3475302">//&nbsp;A&nbsp;pipeline&nbsp;of&nbsp;commands.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475330">NodeRange</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3475361">//&nbsp;A&nbsp;range&nbsp;action.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475381">NodeString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3475412">//&nbsp;A&nbsp;string&nbsp;constant.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475435">NodeTemplate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3475466">//&nbsp;A&nbsp;template&nbsp;invocation&nbsp;action.</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475500">NodeVariable</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3475531">//&nbsp;A&nbsp;$&nbsp;variable.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475549">NodeWith</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3475580">//&nbsp;A&nbsp;with&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="3475598">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3475601">//&nbsp;Nodes.</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="3475612">//&nbsp;ListNode&nbsp;holds&nbsp;a&nbsp;sequence&nbsp;of&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="3475651">type</span>&nbsp;<span class="ident" id="3475656">ListNode</span>&nbsp;<span class="keyword" id="3475665">struct</span>&nbsp;<span class="op" id="3475672">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475675">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475685">Pos</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475690">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3475696">*</span><span class="ident" id="3475697">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475703">Nodes</span>&nbsp;<span class="op" id="3475709">[</span><span class="op" id="3475710">]</span><span class="ident" id="3475711">Node</span>&nbsp;<span class="comment" id="3475716">//&nbsp;The&nbsp;element&nbsp;nodes&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3475755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3475758">func</span>&nbsp;<span class="op" id="3475763">(</span><span class="ident" id="3475764">t</span>&nbsp;<span class="op" id="3475766">*</span><span class="ident" id="3475767">Tree</span><span class="op" id="3475771">)</span>&nbsp;<span class="ident" id="3475773">newList</span><span class="op" id="3475780">(</span><span class="ident" id="3475781">pos</span>&nbsp;<span class="ident" id="3475785">Pos</span><span class="op" id="3475788">)</span>&nbsp;<span class="op" id="3475790">*</span><span class="ident" id="3475791">ListNode</span>&nbsp;<span class="op" id="3475800">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3475803">return</span>&nbsp;<span class="op" id="3475810">&amp;</span><span class="ident" id="3475811">ListNode</span><span class="op" id="3475819">{</span><span class="ident" id="3475820">tr</span><span class="op" id="3475822">:</span>&nbsp;<span class="ident" id="3475824">t</span><span class="op" id="3475825">,</span>&nbsp;<span class="ident" id="3475827">NodeType</span><span class="op" id="3475835">:</span>&nbsp;<span class="ident" id="3475837">NodeList</span><span class="op" id="3475845">,</span>&nbsp;<span class="ident" id="3475847">Pos</span><span class="op" id="3475850">:</span>&nbsp;<span class="ident" id="3475852">pos</span><span class="op" id="3475855">}</span><br>
<span class="lineno"></span><span class="op" id="3475857">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3475860">func</span>&nbsp;<span class="op" id="3475865">(</span><span class="ident" id="3475866">l</span>&nbsp;<span class="op" id="3475868">*</span><span class="ident" id="3475869">ListNode</span><span class="op" id="3475877">)</span>&nbsp;<span class="builtinfunc" id="3475879">append</span><span class="op" id="3475885">(</span><span class="ident" id="3475886">n</span>&nbsp;<span class="ident" id="3475888">Node</span><span class="op" id="3475892">)</span>&nbsp;<span class="op" id="3475894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3475897">l</span><span class="op" id="3475898">.</span><span class="ident" id="3475899">Nodes</span>&nbsp;<span class="op" id="3475905">=</span>&nbsp;<span class="builtinfunc" id="3475907">append</span><span class="op" id="3475913">(</span><span class="ident" id="3475914">l</span><span class="op" id="3475915">.</span><span class="ident" id="3475916">Nodes</span><span class="op" id="3475921">,</span>&nbsp;<span class="ident" id="3475923">n</span><span class="op" id="3475924">)</span><br>
<span class="lineno">90</span><span class="op" id="3475926">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3475929">func</span>&nbsp;<span class="op" id="3475934">(</span><span class="ident" id="3475935">l</span>&nbsp;<span class="op" id="3475937">*</span><span class="ident" id="3475938">ListNode</span><span class="op" id="3475946">)</span>&nbsp;<span class="ident" id="3475948">tree</span><span class="op" id="3475952">(</span><span class="op" id="3475953">)</span>&nbsp;<span class="op" id="3475955">*</span><span class="ident" id="3475956">Tree</span>&nbsp;<span class="op" id="3475961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3475964">return</span>&nbsp;<span class="ident" id="3475971">l</span><span class="op" id="3475972">.</span><span class="ident" id="3475973">tr</span><br>
<span class="lineno"></span><span class="op" id="3475976">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="3475979">func</span>&nbsp;<span class="op" id="3475984">(</span><span class="ident" id="3475985">l</span>&nbsp;<span class="op" id="3475987">*</span><span class="ident" id="3475988">ListNode</span><span class="op" id="3475996">)</span>&nbsp;<span class="ident" id="3475998">String</span><span class="op" id="3476004">(</span><span class="op" id="3476005">)</span>&nbsp;<span class="builtintype" id="3476007">string</span>&nbsp;<span class="op" id="3476014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3476017">b</span>&nbsp;<span class="op" id="3476019">:=</span>&nbsp;<span class="builtinfunc" id="3476022">new</span><span class="op" id="3476025">(</span><span class="ident" id="3476026">bytes</span><span class="op" id="3476031">.</span><span class="ident" id="3476032">Buffer</span><span class="op" id="3476038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3476041">for</span>&nbsp;<span class="ident" id="3476045">_</span><span class="op" id="3476046">,</span>&nbsp;<span class="ident" id="3476048">n</span>&nbsp;<span class="op" id="3476050">:=</span>&nbsp;<span class="keyword" id="3476053">range</span>&nbsp;<span class="ident" id="3476059">l</span><span class="op" id="3476060">.</span><span class="ident" id="3476061">Nodes</span>&nbsp;<span class="op" id="3476067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3476071">fmt</span><span class="op" id="3476074">.</span><span class="ident" id="3476075">Fprint</span><span class="op" id="3476081">(</span><span class="ident" id="3476082">b</span><span class="op" id="3476083">,</span>&nbsp;<span class="ident" id="3476085">n</span><span class="op" id="3476086">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3476089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3476092">return</span>&nbsp;<span class="ident" id="3476099">b</span><span class="op" id="3476100">.</span><span class="ident" id="3476101">String</span><span class="op" id="3476107">(</span><span class="op" id="3476108">)</span><br>
<span class="lineno"></span><span class="op" id="3476110">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3476113">func</span>&nbsp;<span class="op" id="3476118">(</span><span class="ident" id="3476119">l</span>&nbsp;<span class="op" id="3476121">*</span><span class="ident" id="3476122">ListNode</span><span class="op" id="3476130">)</span>&nbsp;<span class="ident" id="3476132">CopyList</span><span class="op" id="3476140">(</span><span class="op" id="3476141">)</span>&nbsp;<span class="op" id="3476143">*</span><span class="ident" id="3476144">ListNode</span>&nbsp;<span class="op" id="3476153">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3476156">if</span>&nbsp;<span class="ident" id="3476159">l</span>&nbsp;<span class="op" id="3476161">==</span>&nbsp;<span class="ident" id="3476164">nil</span>&nbsp;<span class="op" id="3476168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3476172">return</span>&nbsp;<span class="ident" id="3476179">l</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3476182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3476185">n</span>&nbsp;<span class="op" id="3476187">:=</span>&nbsp;<span class="ident" id="3476190">l</span><span class="op" id="3476191">.</span><span class="ident" id="3476192">tr</span><span class="op" id="3476194">.</span><span class="ident" id="3476195">newList</span><span class="op" id="3476202">(</span><span class="ident" id="3476203">l</span><span class="op" id="3476204">.</span><span class="ident" id="3476205">Pos</span><span class="op" id="3476208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3476211">for</span>&nbsp;<span class="ident" id="3476215">_</span><span class="op" id="3476216">,</span>&nbsp;<span class="ident" id="3476218">elem</span>&nbsp;<span class="op" id="3476223">:=</span>&nbsp;<span class="keyword" id="3476226">range</span>&nbsp;<span class="ident" id="3476232">l</span><span class="op" id="3476233">.</span><span class="ident" id="3476234">Nodes</span>&nbsp;<span class="op" id="3476240">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3476244">n</span><span class="op" id="3476245">.</span><span class="builtinfunc" id="3476246">append</span><span class="op" id="3476252">(</span><span class="ident" id="3476253">elem</span><span class="op" id="3476257">.</span><span class="ident" id="3476258">Copy</span><span class="op" id="3476262">(</span><span class="op" id="3476263">)</span><span class="op" id="3476264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3476267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3476270">return</span>&nbsp;<span class="ident" id="3476277">n</span><br>
<span class="lineno"></span><span class="op" id="3476279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="3476282">func</span>&nbsp;<span class="op" id="3476287">(</span><span class="ident" id="3476288">l</span>&nbsp;<span class="op" id="3476290">*</span><span class="ident" id="3476291">ListNode</span><span class="op" id="3476299">)</span>&nbsp;<span class="ident" id="3476301">Copy</span><span class="op" id="3476305">(</span><span class="op" id="3476306">)</span>&nbsp;<span class="ident" id="3476308">Node</span>&nbsp;<span class="op" id="3476313">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3476316">return</span>&nbsp;<span class="ident" id="3476323">l</span><span class="op" id="3476324">.</span><span class="ident" id="3476325">CopyList</span><span class="op" id="3476333">(</span><span class="op" id="3476334">)</span><br>
<span class="lineno"></span><span class="op" id="3476336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3476339">//&nbsp;TextNode&nbsp;holds&nbsp;plain&nbsp;text.</span><br>
<span class="lineno">120</span><span class="keyword" id="3476369">type</span>&nbsp;<span class="ident" id="3476374">TextNode</span>&nbsp;<span class="keyword" id="3476383">struct</span>&nbsp;<span class="op" id="3476390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3476393">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3476403">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3476408">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3476413">*</span><span class="ident" id="3476414">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3476420">Text</span>&nbsp;<span class="op" id="3476425">[</span><span class="op" id="3476426">]</span><span class="builtintype" id="3476427">byte</span>&nbsp;<span class="comment" id="3476432">//&nbsp;The&nbsp;text;&nbsp;may&nbsp;span&nbsp;newlines.</span><br>
<span class="lineno">125</span><span class="op" id="3476464">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3476467">func</span>&nbsp;<span class="op" id="3476472">(</span><span class="ident" id="3476473">t</span>&nbsp;<span class="op" id="3476475">*</span><span class="ident" id="3476476">Tree</span><span class="op" id="3476480">)</span>&nbsp;<span class="ident" id="3476482">newText</span><span class="op" id="3476489">(</span><span class="ident" id="3476490">pos</span>&nbsp;<span class="ident" id="3476494">Pos</span><span class="op" id="3476497">,</span>&nbsp;<span class="ident" id="3476499">text</span>&nbsp;<span class="builtintype" id="3476504">string</span><span class="op" id="3476510">)</span>&nbsp;<span class="op" id="3476512">*</span><span class="ident" id="3476513">TextNode</span>&nbsp;<span class="op" id="3476522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3476525">return</span>&nbsp;<span class="op" id="3476532">&amp;</span><span class="ident" id="3476533">TextNode</span><span class="op" id="3476541">{</span><span class="ident" id="3476542">tr</span><span class="op" id="3476544">:</span>&nbsp;<span class="ident" id="3476546">t</span><span class="op" id="3476547">,</span>&nbsp;<span class="ident" id="3476549">NodeType</span><span class="op" id="3476557">:</span>&nbsp;<span class="ident" id="3476559">NodeText</span><span class="op" id="3476567">,</span>&nbsp;<span class="ident" id="3476569">Pos</span><span class="op" id="3476572">:</span>&nbsp;<span class="ident" id="3476574">pos</span><span class="op" id="3476577">,</span>&nbsp;<span class="ident" id="3476579">Text</span><span class="op" id="3476583">:</span>&nbsp;<span class="op" id="3476585">[</span><span class="op" id="3476586">]</span><span class="builtintype" id="3476587">byte</span><span class="op" id="3476591">(</span><span class="ident" id="3476592">text</span><span class="op" id="3476596">)</span><span class="op" id="3476597">}</span><br>
<span class="lineno"></span><span class="op" id="3476599">}</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span><span class="keyword" id="3476602">func</span>&nbsp;<span class="op" id="3476607">(</span><span class="ident" id="3476608">t</span>&nbsp;<span class="op" id="3476610">*</span><span class="ident" id="3476611">TextNode</span><span class="op" id="3476619">)</span>&nbsp;<span class="ident" id="3476621">String</span><span class="op" id="3476627">(</span><span class="op" id="3476628">)</span>&nbsp;<span class="builtintype" id="3476630">string</span>&nbsp;<span class="op" id="3476637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3476640">return</span>&nbsp;<span class="ident" id="3476647">fmt</span><span class="op" id="3476650">.</span><span class="ident" id="3476651">Sprintf</span><span class="op" id="3476658">(</span><span class="ident" id="3476659">textFormat</span><span class="op" id="3476669">,</span>&nbsp;<span class="ident" id="3476671">t</span><span class="op" id="3476672">.</span><span class="ident" id="3476673">Text</span><span class="op" id="3476677">)</span><br>
<span class="lineno"></span><span class="op" id="3476679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="keyword" id="3476682">func</span>&nbsp;<span class="op" id="3476687">(</span><span class="ident" id="3476688">t</span>&nbsp;<span class="op" id="3476690">*</span><span class="ident" id="3476691">TextNode</span><span class="op" id="3476699">)</span>&nbsp;<span class="ident" id="3476701">tree</span><span class="op" id="3476705">(</span><span class="op" id="3476706">)</span>&nbsp;<span class="op" id="3476708">*</span><span class="ident" id="3476709">Tree</span>&nbsp;<span class="op" id="3476714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3476717">return</span>&nbsp;<span class="ident" id="3476724">t</span><span class="op" id="3476725">.</span><span class="ident" id="3476726">tr</span><br>
<span class="lineno"></span><span class="op" id="3476729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3476732">func</span>&nbsp;<span class="op" id="3476737">(</span><span class="ident" id="3476738">t</span>&nbsp;<span class="op" id="3476740">*</span><span class="ident" id="3476741">TextNode</span><span class="op" id="3476749">)</span>&nbsp;<span class="ident" id="3476751">Copy</span><span class="op" id="3476755">(</span><span class="op" id="3476756">)</span>&nbsp;<span class="ident" id="3476758">Node</span>&nbsp;<span class="op" id="3476763">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3476766">return</span>&nbsp;<span class="op" id="3476773">&amp;</span><span class="ident" id="3476774">TextNode</span><span class="op" id="3476782">{</span><span class="ident" id="3476783">tr</span><span class="op" id="3476785">:</span>&nbsp;<span class="ident" id="3476787">t</span><span class="op" id="3476788">.</span><span class="ident" id="3476789">tr</span><span class="op" id="3476791">,</span>&nbsp;<span class="ident" id="3476793">NodeType</span><span class="op" id="3476801">:</span>&nbsp;<span class="ident" id="3476803">NodeText</span><span class="op" id="3476811">,</span>&nbsp;<span class="ident" id="3476813">Pos</span><span class="op" id="3476816">:</span>&nbsp;<span class="ident" id="3476818">t</span><span class="op" id="3476819">.</span><span class="ident" id="3476820">Pos</span><span class="op" id="3476823">,</span>&nbsp;<span class="ident" id="3476825">Text</span><span class="op" id="3476829">:</span>&nbsp;<span class="builtinfunc" id="3476831">append</span><span class="op" id="3476837">(</span><span class="op" id="3476838">[</span><span class="op" id="3476839">]</span><span class="builtintype" id="3476840">byte</span><span class="op" id="3476844">{</span><span class="op" id="3476845">}</span><span class="op" id="3476846">,</span>&nbsp;<span class="ident" id="3476848">t</span><span class="op" id="3476849">.</span><span class="ident" id="3476850">Text</span><span class="op" id="3476854">...</span><span class="op" id="3476857">)</span><span class="op" id="3476858">}</span><br>
<span class="lineno"></span><span class="op" id="3476860">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3476863">//&nbsp;PipeNode&nbsp;holds&nbsp;a&nbsp;pipeline&nbsp;with&nbsp;optional&nbsp;declaration</span><br>
<span class="lineno"></span><span class="keyword" id="3476918">type</span>&nbsp;<span class="ident" id="3476923">PipeNode</span>&nbsp;<span class="keyword" id="3476932">struct</span>&nbsp;<span class="op" id="3476939">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3476942">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3476952">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3476957">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3476962">*</span><span class="ident" id="3476963">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3476969">Line</span>&nbsp;<span class="builtintype" id="3476974">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3476990">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477060">Decl</span>&nbsp;<span class="op" id="3477065">[</span><span class="op" id="3477066">]</span><span class="op" id="3477067">*</span><span class="ident" id="3477068">VariableNode</span>&nbsp;<span class="comment" id="3477081">//&nbsp;Variable&nbsp;declarations&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477125">Cmds</span>&nbsp;<span class="op" id="3477130">[</span><span class="op" id="3477131">]</span><span class="op" id="3477132">*</span><span class="ident" id="3477133">CommandNode</span>&nbsp;&nbsp;<span class="comment" id="3477146">//&nbsp;The&nbsp;commands&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3477180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3477183">func</span>&nbsp;<span class="op" id="3477188">(</span><span class="ident" id="3477189">t</span>&nbsp;<span class="op" id="3477191">*</span><span class="ident" id="3477192">Tree</span><span class="op" id="3477196">)</span>&nbsp;<span class="ident" id="3477198">newPipeline</span><span class="op" id="3477209">(</span><span class="ident" id="3477210">pos</span>&nbsp;<span class="ident" id="3477214">Pos</span><span class="op" id="3477217">,</span>&nbsp;<span class="ident" id="3477219">line</span>&nbsp;<span class="builtintype" id="3477224">int</span><span class="op" id="3477227">,</span>&nbsp;<span class="ident" id="3477229">decl</span>&nbsp;<span class="op" id="3477234">[</span><span class="op" id="3477235">]</span><span class="op" id="3477236">*</span><span class="ident" id="3477237">VariableNode</span><span class="op" id="3477249">)</span>&nbsp;<span class="op" id="3477251">*</span><span class="ident" id="3477252">PipeNode</span>&nbsp;<span class="op" id="3477261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477264">return</span>&nbsp;<span class="op" id="3477271">&amp;</span><span class="ident" id="3477272">PipeNode</span><span class="op" id="3477280">{</span><span class="ident" id="3477281">tr</span><span class="op" id="3477283">:</span>&nbsp;<span class="ident" id="3477285">t</span><span class="op" id="3477286">,</span>&nbsp;<span class="ident" id="3477288">NodeType</span><span class="op" id="3477296">:</span>&nbsp;<span class="ident" id="3477298">NodePipe</span><span class="op" id="3477306">,</span>&nbsp;<span class="ident" id="3477308">Pos</span><span class="op" id="3477311">:</span>&nbsp;<span class="ident" id="3477313">pos</span><span class="op" id="3477316">,</span>&nbsp;<span class="ident" id="3477318">Line</span><span class="op" id="3477322">:</span>&nbsp;<span class="ident" id="3477324">line</span><span class="op" id="3477328">,</span>&nbsp;<span class="ident" id="3477330">Decl</span><span class="op" id="3477334">:</span>&nbsp;<span class="ident" id="3477336">decl</span><span class="op" id="3477340">}</span><br>
<span class="lineno">155</span><span class="op" id="3477342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3477345">func</span>&nbsp;<span class="op" id="3477350">(</span><span class="ident" id="3477351">p</span>&nbsp;<span class="op" id="3477353">*</span><span class="ident" id="3477354">PipeNode</span><span class="op" id="3477362">)</span>&nbsp;<span class="builtinfunc" id="3477364">append</span><span class="op" id="3477370">(</span><span class="ident" id="3477371">command</span>&nbsp;<span class="op" id="3477379">*</span><span class="ident" id="3477380">CommandNode</span><span class="op" id="3477391">)</span>&nbsp;<span class="op" id="3477393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477396">p</span><span class="op" id="3477397">.</span><span class="ident" id="3477398">Cmds</span>&nbsp;<span class="op" id="3477403">=</span>&nbsp;<span class="builtinfunc" id="3477405">append</span><span class="op" id="3477411">(</span><span class="ident" id="3477412">p</span><span class="op" id="3477413">.</span><span class="ident" id="3477414">Cmds</span><span class="op" id="3477418">,</span>&nbsp;<span class="ident" id="3477420">command</span><span class="op" id="3477427">)</span><br>
<span class="lineno"></span><span class="op" id="3477429">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span><span class="keyword" id="3477432">func</span>&nbsp;<span class="op" id="3477437">(</span><span class="ident" id="3477438">p</span>&nbsp;<span class="op" id="3477440">*</span><span class="ident" id="3477441">PipeNode</span><span class="op" id="3477449">)</span>&nbsp;<span class="ident" id="3477451">String</span><span class="op" id="3477457">(</span><span class="op" id="3477458">)</span>&nbsp;<span class="builtintype" id="3477460">string</span>&nbsp;<span class="op" id="3477467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477470">s</span>&nbsp;<span class="op" id="3477472">:=</span>&nbsp;<span class="string" id="3477475">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477479">if</span>&nbsp;<span class="builtinfunc" id="3477482">len</span><span class="op" id="3477485">(</span><span class="ident" id="3477486">p</span><span class="op" id="3477487">.</span><span class="ident" id="3477488">Decl</span><span class="op" id="3477492">)</span>&nbsp;<span class="op" id="3477494">&gt;</span>&nbsp;<span class="num" id="3477496">0</span>&nbsp;<span class="op" id="3477498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477502">for</span>&nbsp;<span class="ident" id="3477506">i</span><span class="op" id="3477507">,</span>&nbsp;<span class="ident" id="3477509">v</span>&nbsp;<span class="op" id="3477511">:=</span>&nbsp;<span class="keyword" id="3477514">range</span>&nbsp;<span class="ident" id="3477520">p</span><span class="op" id="3477521">.</span><span class="ident" id="3477522">Decl</span>&nbsp;<span class="op" id="3477527">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477532">if</span>&nbsp;<span class="ident" id="3477535">i</span>&nbsp;<span class="op" id="3477537">&gt;</span>&nbsp;<span class="num" id="3477539">0</span>&nbsp;<span class="op" id="3477541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477547">s</span>&nbsp;<span class="op" id="3477549">+=</span>&nbsp;<span class="string" id="3477552">&#34;,&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3477560">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477565">s</span>&nbsp;<span class="op" id="3477567">+=</span>&nbsp;<span class="ident" id="3477570">v</span><span class="op" id="3477571">.</span><span class="ident" id="3477572">String</span><span class="op" id="3477578">(</span><span class="op" id="3477579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3477583">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477587">s</span>&nbsp;<span class="op" id="3477589">+=</span>&nbsp;<span class="string" id="3477592">&#34;&nbsp;:=&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3477600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477603">for</span>&nbsp;<span class="ident" id="3477607">i</span><span class="op" id="3477608">,</span>&nbsp;<span class="ident" id="3477610">c</span>&nbsp;<span class="op" id="3477612">:=</span>&nbsp;<span class="keyword" id="3477615">range</span>&nbsp;<span class="ident" id="3477621">p</span><span class="op" id="3477622">.</span><span class="ident" id="3477623">Cmds</span>&nbsp;<span class="op" id="3477628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477632">if</span>&nbsp;<span class="ident" id="3477635">i</span>&nbsp;<span class="op" id="3477637">&gt;</span>&nbsp;<span class="num" id="3477639">0</span>&nbsp;<span class="op" id="3477641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477646">s</span>&nbsp;<span class="op" id="3477648">+=</span>&nbsp;<span class="string" id="3477651">&#34;&nbsp;|&nbsp;&#34;</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3477659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477663">s</span>&nbsp;<span class="op" id="3477665">+=</span>&nbsp;<span class="ident" id="3477668">c</span><span class="op" id="3477669">.</span><span class="ident" id="3477670">String</span><span class="op" id="3477676">(</span><span class="op" id="3477677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3477680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477683">return</span>&nbsp;<span class="ident" id="3477690">s</span><br>
<span class="lineno"></span><span class="op" id="3477692">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="keyword" id="3477695">func</span>&nbsp;<span class="op" id="3477700">(</span><span class="ident" id="3477701">p</span>&nbsp;<span class="op" id="3477703">*</span><span class="ident" id="3477704">PipeNode</span><span class="op" id="3477712">)</span>&nbsp;<span class="ident" id="3477714">tree</span><span class="op" id="3477718">(</span><span class="op" id="3477719">)</span>&nbsp;<span class="op" id="3477721">*</span><span class="ident" id="3477722">Tree</span>&nbsp;<span class="op" id="3477727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477730">return</span>&nbsp;<span class="ident" id="3477737">p</span><span class="op" id="3477738">.</span><span class="ident" id="3477739">tr</span><br>
<span class="lineno"></span><span class="op" id="3477742">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="3477745">func</span>&nbsp;<span class="op" id="3477750">(</span><span class="ident" id="3477751">p</span>&nbsp;<span class="op" id="3477753">*</span><span class="ident" id="3477754">PipeNode</span><span class="op" id="3477762">)</span>&nbsp;<span class="ident" id="3477764">CopyPipe</span><span class="op" id="3477772">(</span><span class="op" id="3477773">)</span>&nbsp;<span class="op" id="3477775">*</span><span class="ident" id="3477776">PipeNode</span>&nbsp;<span class="op" id="3477785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477788">if</span>&nbsp;<span class="ident" id="3477791">p</span>&nbsp;<span class="op" id="3477793">==</span>&nbsp;<span class="ident" id="3477796">nil</span>&nbsp;<span class="op" id="3477800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477804">return</span>&nbsp;<span class="ident" id="3477811">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3477814">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477817">var</span>&nbsp;<span class="ident" id="3477821">decl</span>&nbsp;<span class="op" id="3477826">[</span><span class="op" id="3477827">]</span><span class="op" id="3477828">*</span><span class="ident" id="3477829">VariableNode</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477843">for</span>&nbsp;<span class="ident" id="3477847">_</span><span class="op" id="3477848">,</span>&nbsp;<span class="ident" id="3477850">d</span>&nbsp;<span class="op" id="3477852">:=</span>&nbsp;<span class="keyword" id="3477855">range</span>&nbsp;<span class="ident" id="3477861">p</span><span class="op" id="3477862">.</span><span class="ident" id="3477863">Decl</span>&nbsp;<span class="op" id="3477868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477872">decl</span>&nbsp;<span class="op" id="3477877">=</span>&nbsp;<span class="builtinfunc" id="3477879">append</span><span class="op" id="3477885">(</span><span class="ident" id="3477886">decl</span><span class="op" id="3477890">,</span>&nbsp;<span class="ident" id="3477892">d</span><span class="op" id="3477893">.</span><span class="ident" id="3477894">Copy</span><span class="op" id="3477898">(</span><span class="op" id="3477899">)</span><span class="op" id="3477900">.</span><span class="op" id="3477901">(</span><span class="op" id="3477902">*</span><span class="ident" id="3477903">VariableNode</span><span class="op" id="3477915">)</span><span class="op" id="3477916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3477919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477922">n</span>&nbsp;<span class="op" id="3477924">:=</span>&nbsp;<span class="ident" id="3477927">p</span><span class="op" id="3477928">.</span><span class="ident" id="3477929">tr</span><span class="op" id="3477931">.</span><span class="ident" id="3477932">newPipeline</span><span class="op" id="3477943">(</span><span class="ident" id="3477944">p</span><span class="op" id="3477945">.</span><span class="ident" id="3477946">Pos</span><span class="op" id="3477949">,</span>&nbsp;<span class="ident" id="3477951">p</span><span class="op" id="3477952">.</span><span class="ident" id="3477953">Line</span><span class="op" id="3477957">,</span>&nbsp;<span class="ident" id="3477959">decl</span><span class="op" id="3477963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3477966">for</span>&nbsp;<span class="ident" id="3477970">_</span><span class="op" id="3477971">,</span>&nbsp;<span class="ident" id="3477973">c</span>&nbsp;<span class="op" id="3477975">:=</span>&nbsp;<span class="keyword" id="3477978">range</span>&nbsp;<span class="ident" id="3477984">p</span><span class="op" id="3477985">.</span><span class="ident" id="3477986">Cmds</span>&nbsp;<span class="op" id="3477991">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3477995">n</span><span class="op" id="3477996">.</span><span class="builtinfunc" id="3477997">append</span><span class="op" id="3478003">(</span><span class="ident" id="3478004">c</span><span class="op" id="3478005">.</span><span class="ident" id="3478006">Copy</span><span class="op" id="3478010">(</span><span class="op" id="3478011">)</span><span class="op" id="3478012">.</span><span class="op" id="3478013">(</span><span class="op" id="3478014">*</span><span class="ident" id="3478015">CommandNode</span><span class="op" id="3478026">)</span><span class="op" id="3478027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3478030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3478033">return</span>&nbsp;<span class="ident" id="3478040">n</span><br>
<span class="lineno"></span><span class="op" id="3478042">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="3478045">func</span>&nbsp;<span class="op" id="3478050">(</span><span class="ident" id="3478051">p</span>&nbsp;<span class="op" id="3478053">*</span><span class="ident" id="3478054">PipeNode</span><span class="op" id="3478062">)</span>&nbsp;<span class="ident" id="3478064">Copy</span><span class="op" id="3478068">(</span><span class="op" id="3478069">)</span>&nbsp;<span class="ident" id="3478071">Node</span>&nbsp;<span class="op" id="3478076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3478079">return</span>&nbsp;<span class="ident" id="3478086">p</span><span class="op" id="3478087">.</span><span class="ident" id="3478088">CopyPipe</span><span class="op" id="3478096">(</span><span class="op" id="3478097">)</span><br>
<span class="lineno"></span><span class="op" id="3478099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3478102">//&nbsp;ActionNode&nbsp;holds&nbsp;an&nbsp;action&nbsp;(something&nbsp;bounded&nbsp;by&nbsp;delimiters).</span><br>
<span class="lineno">205</span><span class="comment" id="3478167">//&nbsp;Control&nbsp;actions&nbsp;have&nbsp;their&nbsp;own&nbsp;nodes;&nbsp;ActionNode&nbsp;represents&nbsp;simple</span><br>
<span class="lineno"></span><span class="comment" id="3478237">//&nbsp;ones&nbsp;such&nbsp;as&nbsp;field&nbsp;evaluations&nbsp;and&nbsp;parenthesized&nbsp;pipelines.</span><br>
<span class="lineno"></span><span class="keyword" id="3478300">type</span>&nbsp;<span class="ident" id="3478305">ActionNode</span>&nbsp;<span class="keyword" id="3478316">struct</span>&nbsp;<span class="op" id="3478323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478326">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478336">Pos</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478341">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3478346">*</span><span class="ident" id="3478347">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478353">Line</span>&nbsp;<span class="builtintype" id="3478358">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3478368">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478438">Pipe</span>&nbsp;<span class="op" id="3478443">*</span><span class="ident" id="3478444">PipeNode</span>&nbsp;<span class="comment" id="3478453">//&nbsp;The&nbsp;pipeline&nbsp;in&nbsp;the&nbsp;action.</span><br>
<span class="lineno"></span><span class="op" id="3478484">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="3478487">func</span>&nbsp;<span class="op" id="3478492">(</span><span class="ident" id="3478493">t</span>&nbsp;<span class="op" id="3478495">*</span><span class="ident" id="3478496">Tree</span><span class="op" id="3478500">)</span>&nbsp;<span class="ident" id="3478502">newAction</span><span class="op" id="3478511">(</span><span class="ident" id="3478512">pos</span>&nbsp;<span class="ident" id="3478516">Pos</span><span class="op" id="3478519">,</span>&nbsp;<span class="ident" id="3478521">line</span>&nbsp;<span class="builtintype" id="3478526">int</span><span class="op" id="3478529">,</span>&nbsp;<span class="ident" id="3478531">pipe</span>&nbsp;<span class="op" id="3478536">*</span><span class="ident" id="3478537">PipeNode</span><span class="op" id="3478545">)</span>&nbsp;<span class="op" id="3478547">*</span><span class="ident" id="3478548">ActionNode</span>&nbsp;<span class="op" id="3478559">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3478562">return</span>&nbsp;<span class="op" id="3478569">&amp;</span><span class="ident" id="3478570">ActionNode</span><span class="op" id="3478580">{</span><span class="ident" id="3478581">tr</span><span class="op" id="3478583">:</span>&nbsp;<span class="ident" id="3478585">t</span><span class="op" id="3478586">,</span>&nbsp;<span class="ident" id="3478588">NodeType</span><span class="op" id="3478596">:</span>&nbsp;<span class="ident" id="3478598">NodeAction</span><span class="op" id="3478608">,</span>&nbsp;<span class="ident" id="3478610">Pos</span><span class="op" id="3478613">:</span>&nbsp;<span class="ident" id="3478615">pos</span><span class="op" id="3478618">,</span>&nbsp;<span class="ident" id="3478620">Line</span><span class="op" id="3478624">:</span>&nbsp;<span class="ident" id="3478626">line</span><span class="op" id="3478630">,</span>&nbsp;<span class="ident" id="3478632">Pipe</span><span class="op" id="3478636">:</span>&nbsp;<span class="ident" id="3478638">pipe</span><span class="op" id="3478642">}</span><br>
<span class="lineno"></span><span class="op" id="3478644">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3478647">func</span>&nbsp;<span class="op" id="3478652">(</span><span class="ident" id="3478653">a</span>&nbsp;<span class="op" id="3478655">*</span><span class="ident" id="3478656">ActionNode</span><span class="op" id="3478666">)</span>&nbsp;<span class="ident" id="3478668">String</span><span class="op" id="3478674">(</span><span class="op" id="3478675">)</span>&nbsp;<span class="builtintype" id="3478677">string</span>&nbsp;<span class="op" id="3478684">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3478687">return</span>&nbsp;<span class="ident" id="3478694">fmt</span><span class="op" id="3478697">.</span><span class="ident" id="3478698">Sprintf</span><span class="op" id="3478705">(</span><span class="string" id="3478706">&#34;{{%s}}&#34;</span><span class="op" id="3478714">,</span>&nbsp;<span class="ident" id="3478716">a</span><span class="op" id="3478717">.</span><span class="ident" id="3478718">Pipe</span><span class="op" id="3478722">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="op" id="3478725">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3478728">func</span>&nbsp;<span class="op" id="3478733">(</span><span class="ident" id="3478734">a</span>&nbsp;<span class="op" id="3478736">*</span><span class="ident" id="3478737">ActionNode</span><span class="op" id="3478747">)</span>&nbsp;<span class="ident" id="3478749">tree</span><span class="op" id="3478753">(</span><span class="op" id="3478754">)</span>&nbsp;<span class="op" id="3478756">*</span><span class="ident" id="3478757">Tree</span>&nbsp;<span class="op" id="3478762">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3478765">return</span>&nbsp;<span class="ident" id="3478772">a</span><span class="op" id="3478773">.</span><span class="ident" id="3478774">tr</span><br>
<span class="lineno"></span><span class="op" id="3478777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3478780">func</span>&nbsp;<span class="op" id="3478785">(</span><span class="ident" id="3478786">a</span>&nbsp;<span class="op" id="3478788">*</span><span class="ident" id="3478789">ActionNode</span><span class="op" id="3478799">)</span>&nbsp;<span class="ident" id="3478801">Copy</span><span class="op" id="3478805">(</span><span class="op" id="3478806">)</span>&nbsp;<span class="ident" id="3478808">Node</span>&nbsp;<span class="op" id="3478813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3478816">return</span>&nbsp;<span class="ident" id="3478823">a</span><span class="op" id="3478824">.</span><span class="ident" id="3478825">tr</span><span class="op" id="3478827">.</span><span class="ident" id="3478828">newAction</span><span class="op" id="3478837">(</span><span class="ident" id="3478838">a</span><span class="op" id="3478839">.</span><span class="ident" id="3478840">Pos</span><span class="op" id="3478843">,</span>&nbsp;<span class="ident" id="3478845">a</span><span class="op" id="3478846">.</span><span class="ident" id="3478847">Line</span><span class="op" id="3478851">,</span>&nbsp;<span class="ident" id="3478853">a</span><span class="op" id="3478854">.</span><span class="ident" id="3478855">Pipe</span><span class="op" id="3478859">.</span><span class="ident" id="3478860">CopyPipe</span><span class="op" id="3478868">(</span><span class="op" id="3478869">)</span><span class="op" id="3478870">)</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="op" id="3478873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3478876">//&nbsp;CommandNode&nbsp;holds&nbsp;a&nbsp;command&nbsp;(a&nbsp;pipeline&nbsp;inside&nbsp;an&nbsp;evaluating&nbsp;action).</span><br>
<span class="lineno"></span><span class="keyword" id="3478949">type</span>&nbsp;<span class="ident" id="3478954">CommandNode</span>&nbsp;<span class="keyword" id="3478966">struct</span>&nbsp;<span class="op" id="3478973">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478976">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478986">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3478991">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3478996">*</span><span class="ident" id="3478997">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479003">Args</span>&nbsp;<span class="op" id="3479008">[</span><span class="op" id="3479009">]</span><span class="ident" id="3479010">Node</span>&nbsp;<span class="comment" id="3479015">//&nbsp;Arguments&nbsp;in&nbsp;lexical&nbsp;order:&nbsp;Identifier,&nbsp;field,&nbsp;or&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="3479078">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="keyword" id="3479081">func</span>&nbsp;<span class="op" id="3479086">(</span><span class="ident" id="3479087">t</span>&nbsp;<span class="op" id="3479089">*</span><span class="ident" id="3479090">Tree</span><span class="op" id="3479094">)</span>&nbsp;<span class="ident" id="3479096">newCommand</span><span class="op" id="3479106">(</span><span class="ident" id="3479107">pos</span>&nbsp;<span class="ident" id="3479111">Pos</span><span class="op" id="3479114">)</span>&nbsp;<span class="op" id="3479116">*</span><span class="ident" id="3479117">CommandNode</span>&nbsp;<span class="op" id="3479129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479132">return</span>&nbsp;<span class="op" id="3479139">&amp;</span><span class="ident" id="3479140">CommandNode</span><span class="op" id="3479151">{</span><span class="ident" id="3479152">tr</span><span class="op" id="3479154">:</span>&nbsp;<span class="ident" id="3479156">t</span><span class="op" id="3479157">,</span>&nbsp;<span class="ident" id="3479159">NodeType</span><span class="op" id="3479167">:</span>&nbsp;<span class="ident" id="3479169">NodeCommand</span><span class="op" id="3479180">,</span>&nbsp;<span class="ident" id="3479182">Pos</span><span class="op" id="3479185">:</span>&nbsp;<span class="ident" id="3479187">pos</span><span class="op" id="3479190">}</span><br>
<span class="lineno"></span><span class="op" id="3479192">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="keyword" id="3479195">func</span>&nbsp;<span class="op" id="3479200">(</span><span class="ident" id="3479201">c</span>&nbsp;<span class="op" id="3479203">*</span><span class="ident" id="3479204">CommandNode</span><span class="op" id="3479215">)</span>&nbsp;<span class="builtinfunc" id="3479217">append</span><span class="op" id="3479223">(</span><span class="ident" id="3479224">arg</span>&nbsp;<span class="ident" id="3479228">Node</span><span class="op" id="3479232">)</span>&nbsp;<span class="op" id="3479234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479237">c</span><span class="op" id="3479238">.</span><span class="ident" id="3479239">Args</span>&nbsp;<span class="op" id="3479244">=</span>&nbsp;<span class="builtinfunc" id="3479246">append</span><span class="op" id="3479252">(</span><span class="ident" id="3479253">c</span><span class="op" id="3479254">.</span><span class="ident" id="3479255">Args</span><span class="op" id="3479259">,</span>&nbsp;<span class="ident" id="3479261">arg</span><span class="op" id="3479264">)</span><br>
<span class="lineno"></span><span class="op" id="3479266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3479269">func</span>&nbsp;<span class="op" id="3479274">(</span><span class="ident" id="3479275">c</span>&nbsp;<span class="op" id="3479277">*</span><span class="ident" id="3479278">CommandNode</span><span class="op" id="3479289">)</span>&nbsp;<span class="ident" id="3479291">String</span><span class="op" id="3479297">(</span><span class="op" id="3479298">)</span>&nbsp;<span class="builtintype" id="3479300">string</span>&nbsp;<span class="op" id="3479307">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479310">s</span>&nbsp;<span class="op" id="3479312">:=</span>&nbsp;<span class="string" id="3479315">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479319">for</span>&nbsp;<span class="ident" id="3479323">i</span><span class="op" id="3479324">,</span>&nbsp;<span class="ident" id="3479326">arg</span>&nbsp;<span class="op" id="3479330">:=</span>&nbsp;<span class="keyword" id="3479333">range</span>&nbsp;<span class="ident" id="3479339">c</span><span class="op" id="3479340">.</span><span class="ident" id="3479341">Args</span>&nbsp;<span class="op" id="3479346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479350">if</span>&nbsp;<span class="ident" id="3479353">i</span>&nbsp;<span class="op" id="3479355">&gt;</span>&nbsp;<span class="num" id="3479357">0</span>&nbsp;<span class="op" id="3479359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479364">s</span>&nbsp;<span class="op" id="3479366">+=</span>&nbsp;<span class="string" id="3479369">&#34;&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3479375">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479379">if</span>&nbsp;<span class="ident" id="3479382">arg</span><span class="op" id="3479385">,</span>&nbsp;<span class="ident" id="3479387">ok</span>&nbsp;<span class="op" id="3479390">:=</span>&nbsp;<span class="ident" id="3479393">arg</span><span class="op" id="3479396">.</span><span class="op" id="3479397">(</span><span class="op" id="3479398">*</span><span class="ident" id="3479399">PipeNode</span><span class="op" id="3479407">)</span><span class="op" id="3479408">;</span>&nbsp;<span class="ident" id="3479410">ok</span>&nbsp;<span class="op" id="3479413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479418">s</span>&nbsp;<span class="op" id="3479420">+=</span>&nbsp;<span class="string" id="3479423">&#34;(&#34;</span>&nbsp;<span class="op" id="3479427">+</span>&nbsp;<span class="ident" id="3479429">arg</span><span class="op" id="3479432">.</span><span class="ident" id="3479433">String</span><span class="op" id="3479439">(</span><span class="op" id="3479440">)</span>&nbsp;<span class="op" id="3479442">+</span>&nbsp;<span class="string" id="3479444">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479451">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3479462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479466">s</span>&nbsp;<span class="op" id="3479468">+=</span>&nbsp;<span class="ident" id="3479471">arg</span><span class="op" id="3479474">.</span><span class="ident" id="3479475">String</span><span class="op" id="3479481">(</span><span class="op" id="3479482">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3479485">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479488">return</span>&nbsp;<span class="ident" id="3479495">s</span><br>
<span class="lineno"></span><span class="op" id="3479497">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3479500">func</span>&nbsp;<span class="op" id="3479505">(</span><span class="ident" id="3479506">c</span>&nbsp;<span class="op" id="3479508">*</span><span class="ident" id="3479509">CommandNode</span><span class="op" id="3479520">)</span>&nbsp;<span class="ident" id="3479522">tree</span><span class="op" id="3479526">(</span><span class="op" id="3479527">)</span>&nbsp;<span class="op" id="3479529">*</span><span class="ident" id="3479530">Tree</span>&nbsp;<span class="op" id="3479535">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479538">return</span>&nbsp;<span class="ident" id="3479545">c</span><span class="op" id="3479546">.</span><span class="ident" id="3479547">tr</span><br>
<span class="lineno"></span><span class="op" id="3479550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3479553">func</span>&nbsp;<span class="op" id="3479558">(</span><span class="ident" id="3479559">c</span>&nbsp;<span class="op" id="3479561">*</span><span class="ident" id="3479562">CommandNode</span><span class="op" id="3479573">)</span>&nbsp;<span class="ident" id="3479575">Copy</span><span class="op" id="3479579">(</span><span class="op" id="3479580">)</span>&nbsp;<span class="ident" id="3479582">Node</span>&nbsp;<span class="op" id="3479587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479590">if</span>&nbsp;<span class="ident" id="3479593">c</span>&nbsp;<span class="op" id="3479595">==</span>&nbsp;<span class="ident" id="3479598">nil</span>&nbsp;<span class="op" id="3479602">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479606">return</span>&nbsp;<span class="ident" id="3479613">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3479616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479619">n</span>&nbsp;<span class="op" id="3479621">:=</span>&nbsp;<span class="ident" id="3479624">c</span><span class="op" id="3479625">.</span><span class="ident" id="3479626">tr</span><span class="op" id="3479628">.</span><span class="ident" id="3479629">newCommand</span><span class="op" id="3479639">(</span><span class="ident" id="3479640">c</span><span class="op" id="3479641">.</span><span class="ident" id="3479642">Pos</span><span class="op" id="3479645">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479648">for</span>&nbsp;<span class="ident" id="3479652">_</span><span class="op" id="3479653">,</span>&nbsp;<span class="ident" id="3479655">c</span>&nbsp;<span class="op" id="3479657">:=</span>&nbsp;<span class="keyword" id="3479660">range</span>&nbsp;<span class="ident" id="3479666">c</span><span class="op" id="3479667">.</span><span class="ident" id="3479668">Args</span>&nbsp;<span class="op" id="3479673">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479677">n</span><span class="op" id="3479678">.</span><span class="builtinfunc" id="3479679">append</span><span class="op" id="3479685">(</span><span class="ident" id="3479686">c</span><span class="op" id="3479687">.</span><span class="ident" id="3479688">Copy</span><span class="op" id="3479692">(</span><span class="op" id="3479693">)</span><span class="op" id="3479694">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3479697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479700">return</span>&nbsp;<span class="ident" id="3479707">n</span><br>
<span class="lineno"></span><span class="op" id="3479709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3479712">//&nbsp;IdentifierNode&nbsp;holds&nbsp;an&nbsp;identifier.</span><br>
<span class="lineno">280</span><span class="keyword" id="3479751">type</span>&nbsp;<span class="ident" id="3479756">IdentifierNode</span>&nbsp;<span class="keyword" id="3479771">struct</span>&nbsp;<span class="op" id="3479778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479781">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479791">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479796">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3479802">*</span><span class="ident" id="3479803">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3479809">Ident</span>&nbsp;<span class="builtintype" id="3479815">string</span>&nbsp;<span class="comment" id="3479822">//&nbsp;The&nbsp;identifier&#39;s&nbsp;name.</span><br>
<span class="lineno">285</span><span class="op" id="3479848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3479851">//&nbsp;NewIdentifier&nbsp;returns&nbsp;a&nbsp;new&nbsp;IdentifierNode&nbsp;with&nbsp;the&nbsp;given&nbsp;identifier&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3479929">func</span>&nbsp;<span class="ident" id="3479934">NewIdentifier</span><span class="op" id="3479947">(</span><span class="ident" id="3479948">ident</span>&nbsp;<span class="builtintype" id="3479954">string</span><span class="op" id="3479960">)</span>&nbsp;<span class="op" id="3479962">*</span><span class="ident" id="3479963">IdentifierNode</span>&nbsp;<span class="op" id="3479978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3479981">return</span>&nbsp;<span class="op" id="3479988">&amp;</span><span class="ident" id="3479989">IdentifierNode</span><span class="op" id="3480003">{</span><span class="ident" id="3480004">NodeType</span><span class="op" id="3480012">:</span>&nbsp;<span class="ident" id="3480014">NodeIdentifier</span><span class="op" id="3480028">,</span>&nbsp;<span class="ident" id="3480030">Ident</span><span class="op" id="3480035">:</span>&nbsp;<span class="ident" id="3480037">ident</span><span class="op" id="3480042">}</span><br>
<span class="lineno">290</span><span class="op" id="3480044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3480047">//&nbsp;SetPos&nbsp;sets&nbsp;the&nbsp;position.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="3480143">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="3480171">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno">295</span><span class="keyword" id="3480193">func</span>&nbsp;<span class="op" id="3480198">(</span><span class="ident" id="3480199">i</span>&nbsp;<span class="op" id="3480201">*</span><span class="ident" id="3480202">IdentifierNode</span><span class="op" id="3480216">)</span>&nbsp;<span class="ident" id="3480218">SetPos</span><span class="op" id="3480224">(</span><span class="ident" id="3480225">pos</span>&nbsp;<span class="ident" id="3480229">Pos</span><span class="op" id="3480232">)</span>&nbsp;<span class="op" id="3480234">*</span><span class="ident" id="3480235">IdentifierNode</span>&nbsp;<span class="op" id="3480250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480253">i</span><span class="op" id="3480254">.</span><span class="ident" id="3480255">Pos</span>&nbsp;<span class="op" id="3480259">=</span>&nbsp;<span class="ident" id="3480261">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480266">return</span>&nbsp;<span class="ident" id="3480273">i</span><br>
<span class="lineno"></span><span class="op" id="3480275">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">300</span><span class="comment" id="3480278">//&nbsp;SetTree&nbsp;sets&nbsp;the&nbsp;parent&nbsp;tree&nbsp;for&nbsp;the&nbsp;node.&nbsp;NewIdentifier&nbsp;is&nbsp;a&nbsp;public&nbsp;method&nbsp;so&nbsp;we&nbsp;can&#39;t&nbsp;modify&nbsp;its&nbsp;signature.</span><br>
<span class="lineno"></span><span class="comment" id="3480391">//&nbsp;Chained&nbsp;for&nbsp;convenience.</span><br>
<span class="lineno"></span><span class="comment" id="3480419">//&nbsp;TODO:&nbsp;fix&nbsp;one&nbsp;day?</span><br>
<span class="lineno"></span><span class="keyword" id="3480441">func</span>&nbsp;<span class="op" id="3480446">(</span><span class="ident" id="3480447">i</span>&nbsp;<span class="op" id="3480449">*</span><span class="ident" id="3480450">IdentifierNode</span><span class="op" id="3480464">)</span>&nbsp;<span class="ident" id="3480466">SetTree</span><span class="op" id="3480473">(</span><span class="ident" id="3480474">t</span>&nbsp;<span class="op" id="3480476">*</span><span class="ident" id="3480477">Tree</span><span class="op" id="3480481">)</span>&nbsp;<span class="op" id="3480483">*</span><span class="ident" id="3480484">IdentifierNode</span>&nbsp;<span class="op" id="3480499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480502">i</span><span class="op" id="3480503">.</span><span class="ident" id="3480504">tr</span>&nbsp;<span class="op" id="3480507">=</span>&nbsp;<span class="ident" id="3480509">t</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480512">return</span>&nbsp;<span class="ident" id="3480519">i</span><br>
<span class="lineno"></span><span class="op" id="3480521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3480524">func</span>&nbsp;<span class="op" id="3480529">(</span><span class="ident" id="3480530">i</span>&nbsp;<span class="op" id="3480532">*</span><span class="ident" id="3480533">IdentifierNode</span><span class="op" id="3480547">)</span>&nbsp;<span class="ident" id="3480549">String</span><span class="op" id="3480555">(</span><span class="op" id="3480556">)</span>&nbsp;<span class="builtintype" id="3480558">string</span>&nbsp;<span class="op" id="3480565">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480568">return</span>&nbsp;<span class="ident" id="3480575">i</span><span class="op" id="3480576">.</span><span class="ident" id="3480577">Ident</span><br>
<span class="lineno">310</span><span class="op" id="3480583">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3480586">func</span>&nbsp;<span class="op" id="3480591">(</span><span class="ident" id="3480592">i</span>&nbsp;<span class="op" id="3480594">*</span><span class="ident" id="3480595">IdentifierNode</span><span class="op" id="3480609">)</span>&nbsp;<span class="ident" id="3480611">tree</span><span class="op" id="3480615">(</span><span class="op" id="3480616">)</span>&nbsp;<span class="op" id="3480618">*</span><span class="ident" id="3480619">Tree</span>&nbsp;<span class="op" id="3480624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480627">return</span>&nbsp;<span class="ident" id="3480634">i</span><span class="op" id="3480635">.</span><span class="ident" id="3480636">tr</span><br>
<span class="lineno"></span><span class="op" id="3480639">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="3480642">func</span>&nbsp;<span class="op" id="3480647">(</span><span class="ident" id="3480648">i</span>&nbsp;<span class="op" id="3480650">*</span><span class="ident" id="3480651">IdentifierNode</span><span class="op" id="3480665">)</span>&nbsp;<span class="ident" id="3480667">Copy</span><span class="op" id="3480671">(</span><span class="op" id="3480672">)</span>&nbsp;<span class="ident" id="3480674">Node</span>&nbsp;<span class="op" id="3480679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3480682">return</span>&nbsp;<span class="ident" id="3480689">NewIdentifier</span><span class="op" id="3480702">(</span><span class="ident" id="3480703">i</span><span class="op" id="3480704">.</span><span class="ident" id="3480705">Ident</span><span class="op" id="3480710">)</span><span class="op" id="3480711">.</span><span class="ident" id="3480712">SetTree</span><span class="op" id="3480719">(</span><span class="ident" id="3480720">i</span><span class="op" id="3480721">.</span><span class="ident" id="3480722">tr</span><span class="op" id="3480724">)</span><span class="op" id="3480725">.</span><span class="ident" id="3480726">SetPos</span><span class="op" id="3480732">(</span><span class="ident" id="3480733">i</span><span class="op" id="3480734">.</span><span class="ident" id="3480735">Pos</span><span class="op" id="3480738">)</span><br>
<span class="lineno"></span><span class="op" id="3480740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="3480743">//&nbsp;VariableNode&nbsp;holds&nbsp;a&nbsp;list&nbsp;of&nbsp;variable&nbsp;names,&nbsp;possibly&nbsp;with&nbsp;chained&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="3480819">//&nbsp;accesses.&nbsp;The&nbsp;dollar&nbsp;sign&nbsp;is&nbsp;part&nbsp;of&nbsp;the&nbsp;(first)&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="3480877">type</span>&nbsp;<span class="ident" id="3480882">VariableNode</span>&nbsp;<span class="keyword" id="3480895">struct</span>&nbsp;<span class="op" id="3480902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480905">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480915">Pos</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480920">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3480926">*</span><span class="ident" id="3480927">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3480933">Ident</span>&nbsp;<span class="op" id="3480939">[</span><span class="op" id="3480940">]</span><span class="builtintype" id="3480941">string</span>&nbsp;<span class="comment" id="3480948">//&nbsp;Variable&nbsp;name&nbsp;and&nbsp;fields&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3480994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3480997">func</span>&nbsp;<span class="op" id="3481002">(</span><span class="ident" id="3481003">t</span>&nbsp;<span class="op" id="3481005">*</span><span class="ident" id="3481006">Tree</span><span class="op" id="3481010">)</span>&nbsp;<span class="ident" id="3481012">newVariable</span><span class="op" id="3481023">(</span><span class="ident" id="3481024">pos</span>&nbsp;<span class="ident" id="3481028">Pos</span><span class="op" id="3481031">,</span>&nbsp;<span class="ident" id="3481033">ident</span>&nbsp;<span class="builtintype" id="3481039">string</span><span class="op" id="3481045">)</span>&nbsp;<span class="op" id="3481047">*</span><span class="ident" id="3481048">VariableNode</span>&nbsp;<span class="op" id="3481061">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481064">return</span>&nbsp;<span class="op" id="3481071">&amp;</span><span class="ident" id="3481072">VariableNode</span><span class="op" id="3481084">{</span><span class="ident" id="3481085">tr</span><span class="op" id="3481087">:</span>&nbsp;<span class="ident" id="3481089">t</span><span class="op" id="3481090">,</span>&nbsp;<span class="ident" id="3481092">NodeType</span><span class="op" id="3481100">:</span>&nbsp;<span class="ident" id="3481102">NodeVariable</span><span class="op" id="3481114">,</span>&nbsp;<span class="ident" id="3481116">Pos</span><span class="op" id="3481119">:</span>&nbsp;<span class="ident" id="3481121">pos</span><span class="op" id="3481124">,</span>&nbsp;<span class="ident" id="3481126">Ident</span><span class="op" id="3481131">:</span>&nbsp;<span class="ident" id="3481133">strings</span><span class="op" id="3481140">.</span><span class="ident" id="3481141">Split</span><span class="op" id="3481146">(</span><span class="ident" id="3481147">ident</span><span class="op" id="3481152">,</span>&nbsp;<span class="string" id="3481154">&#34;.&#34;</span><span class="op" id="3481157">)</span><span class="op" id="3481158">}</span><br>
<span class="lineno"></span><span class="op" id="3481160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3481163">func</span>&nbsp;<span class="op" id="3481168">(</span><span class="ident" id="3481169">v</span>&nbsp;<span class="op" id="3481171">*</span><span class="ident" id="3481172">VariableNode</span><span class="op" id="3481184">)</span>&nbsp;<span class="ident" id="3481186">String</span><span class="op" id="3481192">(</span><span class="op" id="3481193">)</span>&nbsp;<span class="builtintype" id="3481195">string</span>&nbsp;<span class="op" id="3481202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481205">s</span>&nbsp;<span class="op" id="3481207">:=</span>&nbsp;<span class="string" id="3481210">&#34;&#34;</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481214">for</span>&nbsp;<span class="ident" id="3481218">i</span><span class="op" id="3481219">,</span>&nbsp;<span class="ident" id="3481221">id</span>&nbsp;<span class="op" id="3481224">:=</span>&nbsp;<span class="keyword" id="3481227">range</span>&nbsp;<span class="ident" id="3481233">v</span><span class="op" id="3481234">.</span><span class="ident" id="3481235">Ident</span>&nbsp;<span class="op" id="3481241">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481245">if</span>&nbsp;<span class="ident" id="3481248">i</span>&nbsp;<span class="op" id="3481250">&gt;</span>&nbsp;<span class="num" id="3481252">0</span>&nbsp;<span class="op" id="3481254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481259">s</span>&nbsp;<span class="op" id="3481261">+=</span>&nbsp;<span class="string" id="3481264">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3481270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481274">s</span>&nbsp;<span class="op" id="3481276">+=</span>&nbsp;<span class="ident" id="3481279">id</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3481283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481286">return</span>&nbsp;<span class="ident" id="3481293">s</span><br>
<span class="lineno"></span><span class="op" id="3481295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3481298">func</span>&nbsp;<span class="op" id="3481303">(</span><span class="ident" id="3481304">v</span>&nbsp;<span class="op" id="3481306">*</span><span class="ident" id="3481307">VariableNode</span><span class="op" id="3481319">)</span>&nbsp;<span class="ident" id="3481321">tree</span><span class="op" id="3481325">(</span><span class="op" id="3481326">)</span>&nbsp;<span class="op" id="3481328">*</span><span class="ident" id="3481329">Tree</span>&nbsp;<span class="op" id="3481334">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481337">return</span>&nbsp;<span class="ident" id="3481344">v</span><span class="op" id="3481345">.</span><span class="ident" id="3481346">tr</span><br>
<span class="lineno"></span><span class="op" id="3481349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3481352">func</span>&nbsp;<span class="op" id="3481357">(</span><span class="ident" id="3481358">v</span>&nbsp;<span class="op" id="3481360">*</span><span class="ident" id="3481361">VariableNode</span><span class="op" id="3481373">)</span>&nbsp;<span class="ident" id="3481375">Copy</span><span class="op" id="3481379">(</span><span class="op" id="3481380">)</span>&nbsp;<span class="ident" id="3481382">Node</span>&nbsp;<span class="op" id="3481387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481390">return</span>&nbsp;<span class="op" id="3481397">&amp;</span><span class="ident" id="3481398">VariableNode</span><span class="op" id="3481410">{</span><span class="ident" id="3481411">tr</span><span class="op" id="3481413">:</span>&nbsp;<span class="ident" id="3481415">v</span><span class="op" id="3481416">.</span><span class="ident" id="3481417">tr</span><span class="op" id="3481419">,</span>&nbsp;<span class="ident" id="3481421">NodeType</span><span class="op" id="3481429">:</span>&nbsp;<span class="ident" id="3481431">NodeVariable</span><span class="op" id="3481443">,</span>&nbsp;<span class="ident" id="3481445">Pos</span><span class="op" id="3481448">:</span>&nbsp;<span class="ident" id="3481450">v</span><span class="op" id="3481451">.</span><span class="ident" id="3481452">Pos</span><span class="op" id="3481455">,</span>&nbsp;<span class="ident" id="3481457">Ident</span><span class="op" id="3481462">:</span>&nbsp;<span class="builtinfunc" id="3481464">append</span><span class="op" id="3481470">(</span><span class="op" id="3481471">[</span><span class="op" id="3481472">]</span><span class="builtintype" id="3481473">string</span><span class="op" id="3481479">{</span><span class="op" id="3481480">}</span><span class="op" id="3481481">,</span>&nbsp;<span class="ident" id="3481483">v</span><span class="op" id="3481484">.</span><span class="ident" id="3481485">Ident</span><span class="op" id="3481490">...</span><span class="op" id="3481493">)</span><span class="op" id="3481494">}</span><br>
<span class="lineno">350</span><span class="op" id="3481496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3481499">//&nbsp;DotNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;.&#39;.</span><br>
<span class="lineno"></span><span class="keyword" id="3481544">type</span>&nbsp;<span class="ident" id="3481549">DotNode</span>&nbsp;<span class="keyword" id="3481557">struct</span>&nbsp;<span class="op" id="3481564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481567">NodeType</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481577">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3481582">tr</span>&nbsp;<span class="op" id="3481585">*</span><span class="ident" id="3481586">Tree</span><br>
<span class="lineno"></span><span class="op" id="3481591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3481594">func</span>&nbsp;<span class="op" id="3481599">(</span><span class="ident" id="3481600">t</span>&nbsp;<span class="op" id="3481602">*</span><span class="ident" id="3481603">Tree</span><span class="op" id="3481607">)</span>&nbsp;<span class="ident" id="3481609">newDot</span><span class="op" id="3481615">(</span><span class="ident" id="3481616">pos</span>&nbsp;<span class="ident" id="3481620">Pos</span><span class="op" id="3481623">)</span>&nbsp;<span class="op" id="3481625">*</span><span class="ident" id="3481626">DotNode</span>&nbsp;<span class="op" id="3481634">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481637">return</span>&nbsp;<span class="op" id="3481644">&amp;</span><span class="ident" id="3481645">DotNode</span><span class="op" id="3481652">{</span><span class="ident" id="3481653">tr</span><span class="op" id="3481655">:</span>&nbsp;<span class="ident" id="3481657">t</span><span class="op" id="3481658">,</span>&nbsp;<span class="ident" id="3481660">NodeType</span><span class="op" id="3481668">:</span>&nbsp;<span class="ident" id="3481670">NodeDot</span><span class="op" id="3481677">,</span>&nbsp;<span class="ident" id="3481679">Pos</span><span class="op" id="3481682">:</span>&nbsp;<span class="ident" id="3481684">pos</span><span class="op" id="3481687">}</span><br>
<span class="lineno"></span><span class="op" id="3481689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3481692">func</span>&nbsp;<span class="op" id="3481697">(</span><span class="ident" id="3481698">d</span>&nbsp;<span class="op" id="3481700">*</span><span class="ident" id="3481701">DotNode</span><span class="op" id="3481708">)</span>&nbsp;<span class="ident" id="3481710">Type</span><span class="op" id="3481714">(</span><span class="op" id="3481715">)</span>&nbsp;<span class="ident" id="3481717">NodeType</span>&nbsp;<span class="op" id="3481726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3481729">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3481793">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3481861">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481885">return</span>&nbsp;<span class="ident" id="3481892">NodeDot</span><br>
<span class="lineno"></span><span class="op" id="3481900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="keyword" id="3481903">func</span>&nbsp;<span class="op" id="3481908">(</span><span class="ident" id="3481909">d</span>&nbsp;<span class="op" id="3481911">*</span><span class="ident" id="3481912">DotNode</span><span class="op" id="3481919">)</span>&nbsp;<span class="ident" id="3481921">String</span><span class="op" id="3481927">(</span><span class="op" id="3481928">)</span>&nbsp;<span class="builtintype" id="3481930">string</span>&nbsp;<span class="op" id="3481937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481940">return</span>&nbsp;<span class="string" id="3481947">&#34;.&#34;</span><br>
<span class="lineno"></span><span class="op" id="3481951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3481954">func</span>&nbsp;<span class="op" id="3481959">(</span><span class="ident" id="3481960">d</span>&nbsp;<span class="op" id="3481962">*</span><span class="ident" id="3481963">DotNode</span><span class="op" id="3481970">)</span>&nbsp;<span class="ident" id="3481972">tree</span><span class="op" id="3481976">(</span><span class="op" id="3481977">)</span>&nbsp;<span class="op" id="3481979">*</span><span class="ident" id="3481980">Tree</span>&nbsp;<span class="op" id="3481985">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3481988">return</span>&nbsp;<span class="ident" id="3481995">d</span><span class="op" id="3481996">.</span><span class="ident" id="3481997">tr</span><br>
<span class="lineno"></span><span class="op" id="3482000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3482003">func</span>&nbsp;<span class="op" id="3482008">(</span><span class="ident" id="3482009">d</span>&nbsp;<span class="op" id="3482011">*</span><span class="ident" id="3482012">DotNode</span><span class="op" id="3482019">)</span>&nbsp;<span class="ident" id="3482021">Copy</span><span class="op" id="3482025">(</span><span class="op" id="3482026">)</span>&nbsp;<span class="ident" id="3482028">Node</span>&nbsp;<span class="op" id="3482033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482036">return</span>&nbsp;<span class="ident" id="3482043">d</span><span class="op" id="3482044">.</span><span class="ident" id="3482045">tr</span><span class="op" id="3482047">.</span><span class="ident" id="3482048">newDot</span><span class="op" id="3482054">(</span><span class="ident" id="3482055">d</span><span class="op" id="3482056">.</span><span class="ident" id="3482057">Pos</span><span class="op" id="3482060">)</span><br>
<span class="lineno">380</span><span class="op" id="3482062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3482065">//&nbsp;NilNode&nbsp;holds&nbsp;the&nbsp;special&nbsp;identifier&nbsp;&#39;nil&#39;&nbsp;representing&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="3482149">type</span>&nbsp;<span class="ident" id="3482154">NilNode</span>&nbsp;<span class="keyword" id="3482162">struct</span>&nbsp;<span class="op" id="3482169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482172">NodeType</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482182">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482187">tr</span>&nbsp;<span class="op" id="3482190">*</span><span class="ident" id="3482191">Tree</span><br>
<span class="lineno"></span><span class="op" id="3482196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3482199">func</span>&nbsp;<span class="op" id="3482204">(</span><span class="ident" id="3482205">t</span>&nbsp;<span class="op" id="3482207">*</span><span class="ident" id="3482208">Tree</span><span class="op" id="3482212">)</span>&nbsp;<span class="ident" id="3482214">newNil</span><span class="op" id="3482220">(</span><span class="ident" id="3482221">pos</span>&nbsp;<span class="ident" id="3482225">Pos</span><span class="op" id="3482228">)</span>&nbsp;<span class="op" id="3482230">*</span><span class="ident" id="3482231">NilNode</span>&nbsp;<span class="op" id="3482239">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482242">return</span>&nbsp;<span class="op" id="3482249">&amp;</span><span class="ident" id="3482250">NilNode</span><span class="op" id="3482257">{</span><span class="ident" id="3482258">tr</span><span class="op" id="3482260">:</span>&nbsp;<span class="ident" id="3482262">t</span><span class="op" id="3482263">,</span>&nbsp;<span class="ident" id="3482265">NodeType</span><span class="op" id="3482273">:</span>&nbsp;<span class="ident" id="3482275">NodeNil</span><span class="op" id="3482282">,</span>&nbsp;<span class="ident" id="3482284">Pos</span><span class="op" id="3482287">:</span>&nbsp;<span class="ident" id="3482289">pos</span><span class="op" id="3482292">}</span><br>
<span class="lineno"></span><span class="op" id="3482294">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3482297">func</span>&nbsp;<span class="op" id="3482302">(</span><span class="ident" id="3482303">n</span>&nbsp;<span class="op" id="3482305">*</span><span class="ident" id="3482306">NilNode</span><span class="op" id="3482313">)</span>&nbsp;<span class="ident" id="3482315">Type</span><span class="op" id="3482319">(</span><span class="op" id="3482320">)</span>&nbsp;<span class="ident" id="3482322">NodeType</span>&nbsp;<span class="op" id="3482331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3482334">//&nbsp;Override&nbsp;method&nbsp;on&nbsp;embedded&nbsp;NodeType&nbsp;for&nbsp;API&nbsp;compatibility.</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3482398">//&nbsp;TODO:&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem;&nbsp;could&nbsp;change&nbsp;API&nbsp;without&nbsp;effect&nbsp;but</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3482466">//&nbsp;api&nbsp;tool&nbsp;complains.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482490">return</span>&nbsp;<span class="ident" id="3482497">NodeNil</span><br>
<span class="lineno"></span><span class="op" id="3482505">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">400</span><span class="keyword" id="3482508">func</span>&nbsp;<span class="op" id="3482513">(</span><span class="ident" id="3482514">n</span>&nbsp;<span class="op" id="3482516">*</span><span class="ident" id="3482517">NilNode</span><span class="op" id="3482524">)</span>&nbsp;<span class="ident" id="3482526">String</span><span class="op" id="3482532">(</span><span class="op" id="3482533">)</span>&nbsp;<span class="builtintype" id="3482535">string</span>&nbsp;<span class="op" id="3482542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482545">return</span>&nbsp;<span class="string" id="3482552">&#34;nil&#34;</span><br>
<span class="lineno"></span><span class="op" id="3482558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3482561">func</span>&nbsp;<span class="op" id="3482566">(</span><span class="ident" id="3482567">n</span>&nbsp;<span class="op" id="3482569">*</span><span class="ident" id="3482570">NilNode</span><span class="op" id="3482577">)</span>&nbsp;<span class="ident" id="3482579">tree</span><span class="op" id="3482583">(</span><span class="op" id="3482584">)</span>&nbsp;<span class="op" id="3482586">*</span><span class="ident" id="3482587">Tree</span>&nbsp;<span class="op" id="3482592">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482595">return</span>&nbsp;<span class="ident" id="3482602">n</span><span class="op" id="3482603">.</span><span class="ident" id="3482604">tr</span><br>
<span class="lineno"></span><span class="op" id="3482607">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3482610">func</span>&nbsp;<span class="op" id="3482615">(</span><span class="ident" id="3482616">n</span>&nbsp;<span class="op" id="3482618">*</span><span class="ident" id="3482619">NilNode</span><span class="op" id="3482626">)</span>&nbsp;<span class="ident" id="3482628">Copy</span><span class="op" id="3482632">(</span><span class="op" id="3482633">)</span>&nbsp;<span class="ident" id="3482635">Node</span>&nbsp;<span class="op" id="3482640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482643">return</span>&nbsp;<span class="ident" id="3482650">n</span><span class="op" id="3482651">.</span><span class="ident" id="3482652">tr</span><span class="op" id="3482654">.</span><span class="ident" id="3482655">newNil</span><span class="op" id="3482661">(</span><span class="ident" id="3482662">n</span><span class="op" id="3482663">.</span><span class="ident" id="3482664">Pos</span><span class="op" id="3482667">)</span><br>
<span class="lineno">410</span><span class="op" id="3482669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3482672">//&nbsp;FieldNode&nbsp;holds&nbsp;a&nbsp;field&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3482731">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3482769">//&nbsp;The&nbsp;period&nbsp;is&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">415</span><span class="keyword" id="3482811">type</span>&nbsp;<span class="ident" id="3482816">FieldNode</span>&nbsp;<span class="keyword" id="3482826">struct</span>&nbsp;<span class="op" id="3482833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482836">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482846">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482851">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3482857">*</span><span class="ident" id="3482858">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3482864">Ident</span>&nbsp;<span class="op" id="3482870">[</span><span class="op" id="3482871">]</span><span class="builtintype" id="3482872">string</span>&nbsp;<span class="comment" id="3482879">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno">420</span><span class="op" id="3482916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3482919">func</span>&nbsp;<span class="op" id="3482924">(</span><span class="ident" id="3482925">t</span>&nbsp;<span class="op" id="3482927">*</span><span class="ident" id="3482928">Tree</span><span class="op" id="3482932">)</span>&nbsp;<span class="ident" id="3482934">newField</span><span class="op" id="3482942">(</span><span class="ident" id="3482943">pos</span>&nbsp;<span class="ident" id="3482947">Pos</span><span class="op" id="3482950">,</span>&nbsp;<span class="ident" id="3482952">ident</span>&nbsp;<span class="builtintype" id="3482958">string</span><span class="op" id="3482964">)</span>&nbsp;<span class="op" id="3482966">*</span><span class="ident" id="3482967">FieldNode</span>&nbsp;<span class="op" id="3482977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3482980">return</span>&nbsp;<span class="op" id="3482987">&amp;</span><span class="ident" id="3482988">FieldNode</span><span class="op" id="3482997">{</span><span class="ident" id="3482998">tr</span><span class="op" id="3483000">:</span>&nbsp;<span class="ident" id="3483002">t</span><span class="op" id="3483003">,</span>&nbsp;<span class="ident" id="3483005">NodeType</span><span class="op" id="3483013">:</span>&nbsp;<span class="ident" id="3483015">NodeField</span><span class="op" id="3483024">,</span>&nbsp;<span class="ident" id="3483026">Pos</span><span class="op" id="3483029">:</span>&nbsp;<span class="ident" id="3483031">pos</span><span class="op" id="3483034">,</span>&nbsp;<span class="ident" id="3483036">Ident</span><span class="op" id="3483041">:</span>&nbsp;<span class="ident" id="3483043">strings</span><span class="op" id="3483050">.</span><span class="ident" id="3483051">Split</span><span class="op" id="3483056">(</span><span class="ident" id="3483057">ident</span><span class="op" id="3483062">[</span><span class="num" id="3483063">1</span><span class="op" id="3483064">:</span><span class="op" id="3483065">]</span><span class="op" id="3483066">,</span>&nbsp;<span class="string" id="3483068">&#34;.&#34;</span><span class="op" id="3483071">)</span><span class="op" id="3483072">}</span>&nbsp;<span class="comment" id="3483074">//&nbsp;[1:]&nbsp;to&nbsp;drop&nbsp;leading&nbsp;period</span><br>
<span class="lineno"></span><span class="op" id="3483105">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="keyword" id="3483108">func</span>&nbsp;<span class="op" id="3483113">(</span><span class="ident" id="3483114">f</span>&nbsp;<span class="op" id="3483116">*</span><span class="ident" id="3483117">FieldNode</span><span class="op" id="3483126">)</span>&nbsp;<span class="ident" id="3483128">String</span><span class="op" id="3483134">(</span><span class="op" id="3483135">)</span>&nbsp;<span class="builtintype" id="3483137">string</span>&nbsp;<span class="op" id="3483144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483147">s</span>&nbsp;<span class="op" id="3483149">:=</span>&nbsp;<span class="string" id="3483152">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3483156">for</span>&nbsp;<span class="ident" id="3483160">_</span><span class="op" id="3483161">,</span>&nbsp;<span class="ident" id="3483163">id</span>&nbsp;<span class="op" id="3483166">:=</span>&nbsp;<span class="keyword" id="3483169">range</span>&nbsp;<span class="ident" id="3483175">f</span><span class="op" id="3483176">.</span><span class="ident" id="3483177">Ident</span>&nbsp;<span class="op" id="3483183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483187">s</span>&nbsp;<span class="op" id="3483189">+=</span>&nbsp;<span class="string" id="3483192">&#34;.&#34;</span>&nbsp;<span class="op" id="3483196">+</span>&nbsp;<span class="ident" id="3483198">id</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3483202">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3483205">return</span>&nbsp;<span class="ident" id="3483212">s</span><br>
<span class="lineno"></span><span class="op" id="3483214">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3483217">func</span>&nbsp;<span class="op" id="3483222">(</span><span class="ident" id="3483223">f</span>&nbsp;<span class="op" id="3483225">*</span><span class="ident" id="3483226">FieldNode</span><span class="op" id="3483235">)</span>&nbsp;<span class="ident" id="3483237">tree</span><span class="op" id="3483241">(</span><span class="op" id="3483242">)</span>&nbsp;<span class="op" id="3483244">*</span><span class="ident" id="3483245">Tree</span>&nbsp;<span class="op" id="3483250">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3483253">return</span>&nbsp;<span class="ident" id="3483260">f</span><span class="op" id="3483261">.</span><span class="ident" id="3483262">tr</span><br>
<span class="lineno"></span><span class="op" id="3483265">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3483268">func</span>&nbsp;<span class="op" id="3483273">(</span><span class="ident" id="3483274">f</span>&nbsp;<span class="op" id="3483276">*</span><span class="ident" id="3483277">FieldNode</span><span class="op" id="3483286">)</span>&nbsp;<span class="ident" id="3483288">Copy</span><span class="op" id="3483292">(</span><span class="op" id="3483293">)</span>&nbsp;<span class="ident" id="3483295">Node</span>&nbsp;<span class="op" id="3483300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3483303">return</span>&nbsp;<span class="op" id="3483310">&amp;</span><span class="ident" id="3483311">FieldNode</span><span class="op" id="3483320">{</span><span class="ident" id="3483321">tr</span><span class="op" id="3483323">:</span>&nbsp;<span class="ident" id="3483325">f</span><span class="op" id="3483326">.</span><span class="ident" id="3483327">tr</span><span class="op" id="3483329">,</span>&nbsp;<span class="ident" id="3483331">NodeType</span><span class="op" id="3483339">:</span>&nbsp;<span class="ident" id="3483341">NodeField</span><span class="op" id="3483350">,</span>&nbsp;<span class="ident" id="3483352">Pos</span><span class="op" id="3483355">:</span>&nbsp;<span class="ident" id="3483357">f</span><span class="op" id="3483358">.</span><span class="ident" id="3483359">Pos</span><span class="op" id="3483362">,</span>&nbsp;<span class="ident" id="3483364">Ident</span><span class="op" id="3483369">:</span>&nbsp;<span class="builtinfunc" id="3483371">append</span><span class="op" id="3483377">(</span><span class="op" id="3483378">[</span><span class="op" id="3483379">]</span><span class="builtintype" id="3483380">string</span><span class="op" id="3483386">{</span><span class="op" id="3483387">}</span><span class="op" id="3483388">,</span>&nbsp;<span class="ident" id="3483390">f</span><span class="op" id="3483391">.</span><span class="ident" id="3483392">Ident</span><span class="op" id="3483397">...</span><span class="op" id="3483400">)</span><span class="op" id="3483401">}</span><br>
<span class="lineno">440</span><span class="op" id="3483403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3483406">//&nbsp;ChainNode&nbsp;holds&nbsp;a&nbsp;term&nbsp;followed&nbsp;by&nbsp;a&nbsp;chain&nbsp;of&nbsp;field&nbsp;accesses&nbsp;(identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3483502">//&nbsp;The&nbsp;names&nbsp;may&nbsp;be&nbsp;chained&nbsp;(&#39;.x.y&#39;).</span><br>
<span class="lineno"></span><span class="comment" id="3483540">//&nbsp;The&nbsp;periods&nbsp;are&nbsp;dropped&nbsp;from&nbsp;each&nbsp;ident.</span><br>
<span class="lineno">445</span><span class="keyword" id="3483584">type</span>&nbsp;<span class="ident" id="3483589">ChainNode</span>&nbsp;<span class="keyword" id="3483599">struct</span>&nbsp;<span class="op" id="3483606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483609">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483619">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483624">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3483630">*</span><span class="ident" id="3483631">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483637">Node</span>&nbsp;&nbsp;<span class="ident" id="3483643">Node</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3483649">Field</span>&nbsp;<span class="op" id="3483655">[</span><span class="op" id="3483656">]</span><span class="builtintype" id="3483657">string</span>&nbsp;<span class="comment" id="3483664">//&nbsp;The&nbsp;identifiers&nbsp;in&nbsp;lexical&nbsp;order.</span><br>
<span class="lineno"></span><span class="op" id="3483701">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3483704">func</span>&nbsp;<span class="op" id="3483709">(</span><span class="ident" id="3483710">t</span>&nbsp;<span class="op" id="3483712">*</span><span class="ident" id="3483713">Tree</span><span class="op" id="3483717">)</span>&nbsp;<span class="ident" id="3483719">newChain</span><span class="op" id="3483727">(</span><span class="ident" id="3483728">pos</span>&nbsp;<span class="ident" id="3483732">Pos</span><span class="op" id="3483735">,</span>&nbsp;<span class="ident" id="3483737">node</span>&nbsp;<span class="ident" id="3483742">Node</span><span class="op" id="3483746">)</span>&nbsp;<span class="op" id="3483748">*</span><span class="ident" id="3483749">ChainNode</span>&nbsp;<span class="op" id="3483759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3483762">return</span>&nbsp;<span class="op" id="3483769">&amp;</span><span class="ident" id="3483770">ChainNode</span><span class="op" id="3483779">{</span><span class="ident" id="3483780">tr</span><span class="op" id="3483782">:</span>&nbsp;<span class="ident" id="3483784">t</span><span class="op" id="3483785">,</span>&nbsp;<span class="ident" id="3483787">NodeType</span><span class="op" id="3483795">:</span>&nbsp;<span class="ident" id="3483797">NodeChain</span><span class="op" id="3483806">,</span>&nbsp;<span class="ident" id="3483808">Pos</span><span class="op" id="3483811">:</span>&nbsp;<span class="ident" id="3483813">pos</span><span class="op" id="3483816">,</span>&nbsp;<span class="ident" id="3483818">Node</span><span class="op" id="3483822">:</span>&nbsp;<span class="ident" id="3483824">node</span><span class="op" id="3483828">}</span><br>
<span class="lineno">455</span><span class="op" id="3483830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3483833">//&nbsp;Add&nbsp;adds&nbsp;the&nbsp;named&nbsp;field&nbsp;(which&nbsp;should&nbsp;start&nbsp;with&nbsp;a&nbsp;period)&nbsp;to&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="3483921">func</span>&nbsp;<span class="op" id="3483926">(</span><span class="ident" id="3483927">c</span>&nbsp;<span class="op" id="3483929">*</span><span class="ident" id="3483930">ChainNode</span><span class="op" id="3483939">)</span>&nbsp;<span class="ident" id="3483941">Add</span><span class="op" id="3483944">(</span><span class="ident" id="3483945">field</span>&nbsp;<span class="builtintype" id="3483951">string</span><span class="op" id="3483957">)</span>&nbsp;<span class="op" id="3483959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3483962">if</span>&nbsp;<span class="builtinfunc" id="3483965">len</span><span class="op" id="3483968">(</span><span class="ident" id="3483969">field</span><span class="op" id="3483974">)</span>&nbsp;<span class="op" id="3483976">==</span>&nbsp;<span class="num" id="3483979">0</span>&nbsp;<span class="op" id="3483981">||</span>&nbsp;<span class="ident" id="3483984">field</span><span class="op" id="3483989">[</span><span class="num" id="3483990">0</span><span class="op" id="3483991">]</span>&nbsp;<span class="op" id="3483993">!=</span>&nbsp;<span class="string" id="3483996">&#39;.&#39;</span>&nbsp;<span class="op" id="3484000">{</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3484004">panic</span><span class="op" id="3484009">(</span><span class="string" id="3484010">&#34;no&nbsp;dot&nbsp;in&nbsp;field&#34;</span><span class="op" id="3484027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3484030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3484033">field</span>&nbsp;<span class="op" id="3484039">=</span>&nbsp;<span class="ident" id="3484041">field</span><span class="op" id="3484046">[</span><span class="num" id="3484047">1</span><span class="op" id="3484048">:</span><span class="op" id="3484049">]</span>&nbsp;<span class="comment" id="3484051">//&nbsp;Remove&nbsp;leading&nbsp;dot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484075">if</span>&nbsp;<span class="ident" id="3484078">field</span>&nbsp;<span class="op" id="3484084">==</span>&nbsp;<span class="string" id="3484087">&#34;&#34;</span>&nbsp;<span class="op" id="3484090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3484094">panic</span><span class="op" id="3484099">(</span><span class="string" id="3484100">&#34;empty&nbsp;field&#34;</span><span class="op" id="3484113">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3484116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3484119">c</span><span class="op" id="3484120">.</span><span class="ident" id="3484121">Field</span>&nbsp;<span class="op" id="3484127">=</span>&nbsp;<span class="builtinfunc" id="3484129">append</span><span class="op" id="3484135">(</span><span class="ident" id="3484136">c</span><span class="op" id="3484137">.</span><span class="ident" id="3484138">Field</span><span class="op" id="3484143">,</span>&nbsp;<span class="ident" id="3484145">field</span><span class="op" id="3484150">)</span><br>
<span class="lineno"></span><span class="op" id="3484152">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3484155">func</span>&nbsp;<span class="op" id="3484160">(</span><span class="ident" id="3484161">c</span>&nbsp;<span class="op" id="3484163">*</span><span class="ident" id="3484164">ChainNode</span><span class="op" id="3484173">)</span>&nbsp;<span class="ident" id="3484175">String</span><span class="op" id="3484181">(</span><span class="op" id="3484182">)</span>&nbsp;<span class="builtintype" id="3484184">string</span>&nbsp;<span class="op" id="3484191">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3484194">s</span>&nbsp;<span class="op" id="3484196">:=</span>&nbsp;<span class="ident" id="3484199">c</span><span class="op" id="3484200">.</span><span class="ident" id="3484201">Node</span><span class="op" id="3484205">.</span><span class="ident" id="3484206">String</span><span class="op" id="3484212">(</span><span class="op" id="3484213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484216">if</span>&nbsp;<span class="ident" id="3484219">_</span><span class="op" id="3484220">,</span>&nbsp;<span class="ident" id="3484222">ok</span>&nbsp;<span class="op" id="3484225">:=</span>&nbsp;<span class="ident" id="3484228">c</span><span class="op" id="3484229">.</span><span class="ident" id="3484230">Node</span><span class="op" id="3484234">.</span><span class="op" id="3484235">(</span><span class="op" id="3484236">*</span><span class="ident" id="3484237">PipeNode</span><span class="op" id="3484245">)</span><span class="op" id="3484246">;</span>&nbsp;<span class="ident" id="3484248">ok</span>&nbsp;<span class="op" id="3484251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3484255">s</span>&nbsp;<span class="op" id="3484257">=</span>&nbsp;<span class="string" id="3484259">&#34;(&#34;</span>&nbsp;<span class="op" id="3484263">+</span>&nbsp;<span class="ident" id="3484265">s</span>&nbsp;<span class="op" id="3484267">+</span>&nbsp;<span class="string" id="3484269">&#34;)&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3484274">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484277">for</span>&nbsp;<span class="ident" id="3484281">_</span><span class="op" id="3484282">,</span>&nbsp;<span class="ident" id="3484284">field</span>&nbsp;<span class="op" id="3484290">:=</span>&nbsp;<span class="keyword" id="3484293">range</span>&nbsp;<span class="ident" id="3484299">c</span><span class="op" id="3484300">.</span><span class="ident" id="3484301">Field</span>&nbsp;<span class="op" id="3484307">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3484311">s</span>&nbsp;<span class="op" id="3484313">+=</span>&nbsp;<span class="string" id="3484316">&#34;.&#34;</span>&nbsp;<span class="op" id="3484320">+</span>&nbsp;<span class="ident" id="3484322">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3484329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484332">return</span>&nbsp;<span class="ident" id="3484339">s</span><br>
<span class="lineno"></span><span class="op" id="3484341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">480</span><span class="keyword" id="3484344">func</span>&nbsp;<span class="op" id="3484349">(</span><span class="ident" id="3484350">c</span>&nbsp;<span class="op" id="3484352">*</span><span class="ident" id="3484353">ChainNode</span><span class="op" id="3484362">)</span>&nbsp;<span class="ident" id="3484364">tree</span><span class="op" id="3484368">(</span><span class="op" id="3484369">)</span>&nbsp;<span class="op" id="3484371">*</span><span class="ident" id="3484372">Tree</span>&nbsp;<span class="op" id="3484377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484380">return</span>&nbsp;<span class="ident" id="3484387">c</span><span class="op" id="3484388">.</span><span class="ident" id="3484389">tr</span><br>
<span class="lineno"></span><span class="op" id="3484392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3484395">func</span>&nbsp;<span class="op" id="3484400">(</span><span class="ident" id="3484401">c</span>&nbsp;<span class="op" id="3484403">*</span><span class="ident" id="3484404">ChainNode</span><span class="op" id="3484413">)</span>&nbsp;<span class="ident" id="3484415">Copy</span><span class="op" id="3484419">(</span><span class="op" id="3484420">)</span>&nbsp;<span class="ident" id="3484422">Node</span>&nbsp;<span class="op" id="3484427">{</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484430">return</span>&nbsp;<span class="op" id="3484437">&amp;</span><span class="ident" id="3484438">ChainNode</span><span class="op" id="3484447">{</span><span class="ident" id="3484448">tr</span><span class="op" id="3484450">:</span>&nbsp;<span class="ident" id="3484452">c</span><span class="op" id="3484453">.</span><span class="ident" id="3484454">tr</span><span class="op" id="3484456">,</span>&nbsp;<span class="ident" id="3484458">NodeType</span><span class="op" id="3484466">:</span>&nbsp;<span class="ident" id="3484468">NodeChain</span><span class="op" id="3484477">,</span>&nbsp;<span class="ident" id="3484479">Pos</span><span class="op" id="3484482">:</span>&nbsp;<span class="ident" id="3484484">c</span><span class="op" id="3484485">.</span><span class="ident" id="3484486">Pos</span><span class="op" id="3484489">,</span>&nbsp;<span class="ident" id="3484491">Node</span><span class="op" id="3484495">:</span>&nbsp;<span class="ident" id="3484497">c</span><span class="op" id="3484498">.</span><span class="ident" id="3484499">Node</span><span class="op" id="3484503">,</span>&nbsp;<span class="ident" id="3484505">Field</span><span class="op" id="3484510">:</span>&nbsp;<span class="builtinfunc" id="3484512">append</span><span class="op" id="3484518">(</span><span class="op" id="3484519">[</span><span class="op" id="3484520">]</span><span class="builtintype" id="3484521">string</span><span class="op" id="3484527">{</span><span class="op" id="3484528">}</span><span class="op" id="3484529">,</span>&nbsp;<span class="ident" id="3484531">c</span><span class="op" id="3484532">.</span><span class="ident" id="3484533">Field</span><span class="op" id="3484538">...</span><span class="op" id="3484541">)</span><span class="op" id="3484542">}</span><br>
<span class="lineno"></span><span class="op" id="3484544">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3484547">//&nbsp;BoolNode&nbsp;holds&nbsp;a&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="keyword" id="3484585">type</span>&nbsp;<span class="ident" id="3484590">BoolNode</span>&nbsp;<span class="keyword" id="3484599">struct</span>&nbsp;<span class="op" id="3484606">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3484609">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3484619">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3484624">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3484629">*</span><span class="ident" id="3484630">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3484636">True</span>&nbsp;<span class="builtintype" id="3484641">bool</span>&nbsp;<span class="comment" id="3484646">//&nbsp;The&nbsp;value&nbsp;of&nbsp;the&nbsp;boolean&nbsp;constant.</span><br>
<span class="lineno"></span><span class="op" id="3484684">}</span><br>
<span class="lineno">495</span><br>
<span class="lineno"></span><span class="keyword" id="3484687">func</span>&nbsp;<span class="op" id="3484692">(</span><span class="ident" id="3484693">t</span>&nbsp;<span class="op" id="3484695">*</span><span class="ident" id="3484696">Tree</span><span class="op" id="3484700">)</span>&nbsp;<span class="ident" id="3484702">newBool</span><span class="op" id="3484709">(</span><span class="ident" id="3484710">pos</span>&nbsp;<span class="ident" id="3484714">Pos</span><span class="op" id="3484717">,</span>&nbsp;<span class="builtintype" id="3484719">true</span>&nbsp;<span class="builtintype" id="3484724">bool</span><span class="op" id="3484728">)</span>&nbsp;<span class="op" id="3484730">*</span><span class="ident" id="3484731">BoolNode</span>&nbsp;<span class="op" id="3484740">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484743">return</span>&nbsp;<span class="op" id="3484750">&amp;</span><span class="ident" id="3484751">BoolNode</span><span class="op" id="3484759">{</span><span class="ident" id="3484760">tr</span><span class="op" id="3484762">:</span>&nbsp;<span class="ident" id="3484764">t</span><span class="op" id="3484765">,</span>&nbsp;<span class="ident" id="3484767">NodeType</span><span class="op" id="3484775">:</span>&nbsp;<span class="ident" id="3484777">NodeBool</span><span class="op" id="3484785">,</span>&nbsp;<span class="ident" id="3484787">Pos</span><span class="op" id="3484790">:</span>&nbsp;<span class="ident" id="3484792">pos</span><span class="op" id="3484795">,</span>&nbsp;<span class="ident" id="3484797">True</span><span class="op" id="3484801">:</span>&nbsp;<span class="builtintype" id="3484803">true</span><span class="op" id="3484807">}</span><br>
<span class="lineno"></span><span class="op" id="3484809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">500</span><span class="keyword" id="3484812">func</span>&nbsp;<span class="op" id="3484817">(</span><span class="ident" id="3484818">b</span>&nbsp;<span class="op" id="3484820">*</span><span class="ident" id="3484821">BoolNode</span><span class="op" id="3484829">)</span>&nbsp;<span class="ident" id="3484831">String</span><span class="op" id="3484837">(</span><span class="op" id="3484838">)</span>&nbsp;<span class="builtintype" id="3484840">string</span>&nbsp;<span class="op" id="3484847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484850">if</span>&nbsp;<span class="ident" id="3484853">b</span><span class="op" id="3484854">.</span><span class="ident" id="3484855">True</span>&nbsp;<span class="op" id="3484860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484864">return</span>&nbsp;<span class="string" id="3484871">&#34;true&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3484879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484882">return</span>&nbsp;<span class="string" id="3484889">&#34;false&#34;</span><br>
<span class="lineno">505</span><span class="op" id="3484897">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3484900">func</span>&nbsp;<span class="op" id="3484905">(</span><span class="ident" id="3484906">b</span>&nbsp;<span class="op" id="3484908">*</span><span class="ident" id="3484909">BoolNode</span><span class="op" id="3484917">)</span>&nbsp;<span class="ident" id="3484919">tree</span><span class="op" id="3484923">(</span><span class="op" id="3484924">)</span>&nbsp;<span class="op" id="3484926">*</span><span class="ident" id="3484927">Tree</span>&nbsp;<span class="op" id="3484932">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484935">return</span>&nbsp;<span class="ident" id="3484942">b</span><span class="op" id="3484943">.</span><span class="ident" id="3484944">tr</span><br>
<span class="lineno"></span><span class="op" id="3484947">}</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span><span class="keyword" id="3484950">func</span>&nbsp;<span class="op" id="3484955">(</span><span class="ident" id="3484956">b</span>&nbsp;<span class="op" id="3484958">*</span><span class="ident" id="3484959">BoolNode</span><span class="op" id="3484967">)</span>&nbsp;<span class="ident" id="3484969">Copy</span><span class="op" id="3484973">(</span><span class="op" id="3484974">)</span>&nbsp;<span class="ident" id="3484976">Node</span>&nbsp;<span class="op" id="3484981">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3484984">return</span>&nbsp;<span class="ident" id="3484991">b</span><span class="op" id="3484992">.</span><span class="ident" id="3484993">tr</span><span class="op" id="3484995">.</span><span class="ident" id="3484996">newBool</span><span class="op" id="3485003">(</span><span class="ident" id="3485004">b</span><span class="op" id="3485005">.</span><span class="ident" id="3485006">Pos</span><span class="op" id="3485009">,</span>&nbsp;<span class="ident" id="3485011">b</span><span class="op" id="3485012">.</span><span class="ident" id="3485013">True</span><span class="op" id="3485017">)</span><br>
<span class="lineno"></span><span class="op" id="3485019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="comment" id="3485022">//&nbsp;NumberNode&nbsp;holds&nbsp;a&nbsp;number:&nbsp;signed&nbsp;or&nbsp;unsigned&nbsp;integer,&nbsp;float,&nbsp;or&nbsp;complex.</span><br>
<span class="lineno"></span><span class="comment" id="3485099">//&nbsp;The&nbsp;value&nbsp;is&nbsp;parsed&nbsp;and&nbsp;stored&nbsp;under&nbsp;all&nbsp;the&nbsp;types&nbsp;that&nbsp;can&nbsp;represent&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span><span class="comment" id="3485183">//&nbsp;This&nbsp;simulates&nbsp;in&nbsp;a&nbsp;small&nbsp;amount&nbsp;of&nbsp;code&nbsp;the&nbsp;behavior&nbsp;of&nbsp;Go&#39;s&nbsp;ideal&nbsp;constants.</span><br>
<span class="lineno"></span><span class="keyword" id="3485265">type</span>&nbsp;<span class="ident" id="3485270">NumberNode</span>&nbsp;<span class="keyword" id="3485281">struct</span>&nbsp;<span class="op" id="3485288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485291">NodeType</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485301">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485306">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3485317">*</span><span class="ident" id="3485318">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485324">IsInt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3485335">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3485346">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485380">IsUint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3485391">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3485402">//&nbsp;Number&nbsp;has&nbsp;an&nbsp;unsigned&nbsp;integral&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485445">IsFloat</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3485456">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3485467">//&nbsp;Number&nbsp;has&nbsp;a&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485506">IsComplex</span>&nbsp;&nbsp;<span class="builtintype" id="3485517">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3485528">//&nbsp;Number&nbsp;is&nbsp;complex.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485551">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3485562">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3485573">//&nbsp;The&nbsp;signed&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485603">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3485614">uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3485625">//&nbsp;The&nbsp;unsigned&nbsp;integer&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485657">Float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3485668">float64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3485679">//&nbsp;The&nbsp;floating-point&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485709">Complex128</span>&nbsp;<span class="builtintype" id="3485720">complex128</span>&nbsp;<span class="comment" id="3485731">//&nbsp;The&nbsp;complex&nbsp;value.</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485754">Text</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3485765">string</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3485776">//&nbsp;The&nbsp;original&nbsp;textual&nbsp;representation&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="op" id="3485831">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3485834">func</span>&nbsp;<span class="op" id="3485839">(</span><span class="ident" id="3485840">t</span>&nbsp;<span class="op" id="3485842">*</span><span class="ident" id="3485843">Tree</span><span class="op" id="3485847">)</span>&nbsp;<span class="ident" id="3485849">newNumber</span><span class="op" id="3485858">(</span><span class="ident" id="3485859">pos</span>&nbsp;<span class="ident" id="3485863">Pos</span><span class="op" id="3485866">,</span>&nbsp;<span class="ident" id="3485868">text</span>&nbsp;<span class="builtintype" id="3485873">string</span><span class="op" id="3485879">,</span>&nbsp;<span class="ident" id="3485881">typ</span>&nbsp;<span class="ident" id="3485885">itemType</span><span class="op" id="3485893">)</span>&nbsp;<span class="op" id="3485895">(</span><span class="op" id="3485896">*</span><span class="ident" id="3485897">NumberNode</span><span class="op" id="3485907">,</span>&nbsp;<span class="builtintype" id="3485909">error</span><span class="op" id="3485914">)</span>&nbsp;<span class="op" id="3485916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3485919">n</span>&nbsp;<span class="op" id="3485921">:=</span>&nbsp;<span class="op" id="3485924">&amp;</span><span class="ident" id="3485925">NumberNode</span><span class="op" id="3485935">{</span><span class="ident" id="3485936">tr</span><span class="op" id="3485938">:</span>&nbsp;<span class="ident" id="3485940">t</span><span class="op" id="3485941">,</span>&nbsp;<span class="ident" id="3485943">NodeType</span><span class="op" id="3485951">:</span>&nbsp;<span class="ident" id="3485953">NodeNumber</span><span class="op" id="3485963">,</span>&nbsp;<span class="ident" id="3485965">Pos</span><span class="op" id="3485968">:</span>&nbsp;<span class="ident" id="3485970">pos</span><span class="op" id="3485973">,</span>&nbsp;<span class="ident" id="3485975">Text</span><span class="op" id="3485979">:</span>&nbsp;<span class="ident" id="3485981">text</span><span class="op" id="3485985">}</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3485988">switch</span>&nbsp;<span class="ident" id="3485995">typ</span>&nbsp;<span class="op" id="3485999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486002">case</span>&nbsp;<span class="ident" id="3486007">itemCharConstant</span><span class="op" id="3486023">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="3486027">rune</span><span class="op" id="3486031">,</span>&nbsp;<span class="ident" id="3486033">_</span><span class="op" id="3486034">,</span>&nbsp;<span class="ident" id="3486036">tail</span><span class="op" id="3486040">,</span>&nbsp;<span class="ident" id="3486042">err</span>&nbsp;<span class="op" id="3486046">:=</span>&nbsp;<span class="ident" id="3486049">strconv</span><span class="op" id="3486056">.</span><span class="ident" id="3486057">UnquoteChar</span><span class="op" id="3486068">(</span><span class="ident" id="3486069">text</span><span class="op" id="3486073">[</span><span class="num" id="3486074">1</span><span class="op" id="3486075">:</span><span class="op" id="3486076">]</span><span class="op" id="3486077">,</span>&nbsp;<span class="ident" id="3486079">text</span><span class="op" id="3486083">[</span><span class="num" id="3486084">0</span><span class="op" id="3486085">]</span><span class="op" id="3486086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486090">if</span>&nbsp;<span class="ident" id="3486093">err</span>&nbsp;<span class="op" id="3486097">!=</span>&nbsp;<span class="ident" id="3486100">nil</span>&nbsp;<span class="op" id="3486104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486109">return</span>&nbsp;<span class="ident" id="3486116">nil</span><span class="op" id="3486119">,</span>&nbsp;<span class="ident" id="3486121">err</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3486127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486131">if</span>&nbsp;<span class="ident" id="3486134">tail</span>&nbsp;<span class="op" id="3486139">!=</span>&nbsp;<span class="string" id="3486142">&#34;&#39;&#34;</span>&nbsp;<span class="op" id="3486146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486151">return</span>&nbsp;<span class="ident" id="3486158">nil</span><span class="op" id="3486161">,</span>&nbsp;<span class="ident" id="3486163">fmt</span><span class="op" id="3486166">.</span><span class="ident" id="3486167">Errorf</span><span class="op" id="3486173">(</span><span class="string" id="3486174">&#34;malformed&nbsp;character&nbsp;constant:&nbsp;%s&#34;</span><span class="op" id="3486208">,</span>&nbsp;<span class="ident" id="3486210">text</span><span class="op" id="3486214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3486218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486222">n</span><span class="op" id="3486223">.</span><span class="ident" id="3486224">Int64</span>&nbsp;<span class="op" id="3486230">=</span>&nbsp;<span class="ident" id="3486232">int64</span><span class="op" id="3486237">(</span><span class="builtintype" id="3486238">rune</span><span class="op" id="3486242">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486246">n</span><span class="op" id="3486247">.</span><span class="ident" id="3486248">IsInt</span>&nbsp;<span class="op" id="3486254">=</span>&nbsp;<span class="builtintype" id="3486256">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486263">n</span><span class="op" id="3486264">.</span><span class="ident" id="3486265">Uint64</span>&nbsp;<span class="op" id="3486272">=</span>&nbsp;<span class="ident" id="3486274">uint64</span><span class="op" id="3486280">(</span><span class="builtintype" id="3486281">rune</span><span class="op" id="3486285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486289">n</span><span class="op" id="3486290">.</span><span class="ident" id="3486291">IsUint</span>&nbsp;<span class="op" id="3486298">=</span>&nbsp;<span class="builtintype" id="3486300">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486307">n</span><span class="op" id="3486308">.</span><span class="ident" id="3486309">Float64</span>&nbsp;<span class="op" id="3486317">=</span>&nbsp;<span class="builtintype" id="3486319">float64</span><span class="op" id="3486326">(</span><span class="builtintype" id="3486327">rune</span><span class="op" id="3486331">)</span>&nbsp;<span class="comment" id="3486333">//&nbsp;odd&nbsp;but&nbsp;those&nbsp;are&nbsp;the&nbsp;rules.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486367">n</span><span class="op" id="3486368">.</span><span class="ident" id="3486369">IsFloat</span>&nbsp;<span class="op" id="3486377">=</span>&nbsp;<span class="builtintype" id="3486379">true</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486386">return</span>&nbsp;<span class="ident" id="3486393">n</span><span class="op" id="3486394">,</span>&nbsp;<span class="ident" id="3486396">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486401">case</span>&nbsp;<span class="ident" id="3486406">itemComplex</span><span class="op" id="3486417">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3486421">//&nbsp;fmt.Sscan&nbsp;can&nbsp;parse&nbsp;the&nbsp;pair,&nbsp;so&nbsp;let&nbsp;it&nbsp;do&nbsp;the&nbsp;work.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486479">if</span>&nbsp;<span class="ident" id="3486482">_</span><span class="op" id="3486483">,</span>&nbsp;<span class="ident" id="3486485">err</span>&nbsp;<span class="op" id="3486489">:=</span>&nbsp;<span class="ident" id="3486492">fmt</span><span class="op" id="3486495">.</span><span class="ident" id="3486496">Sscan</span><span class="op" id="3486501">(</span><span class="ident" id="3486502">text</span><span class="op" id="3486506">,</span>&nbsp;<span class="op" id="3486508">&amp;</span><span class="ident" id="3486509">n</span><span class="op" id="3486510">.</span><span class="ident" id="3486511">Complex128</span><span class="op" id="3486521">)</span><span class="op" id="3486522">;</span>&nbsp;<span class="ident" id="3486524">err</span>&nbsp;<span class="op" id="3486528">!=</span>&nbsp;<span class="ident" id="3486531">nil</span>&nbsp;<span class="op" id="3486535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486540">return</span>&nbsp;<span class="ident" id="3486547">nil</span><span class="op" id="3486550">,</span>&nbsp;<span class="ident" id="3486552">err</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3486558">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486562">n</span><span class="op" id="3486563">.</span><span class="ident" id="3486564">IsComplex</span>&nbsp;<span class="op" id="3486574">=</span>&nbsp;<span class="builtintype" id="3486576">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486583">n</span><span class="op" id="3486584">.</span><span class="ident" id="3486585">simplifyComplex</span><span class="op" id="3486600">(</span><span class="op" id="3486601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486605">return</span>&nbsp;<span class="ident" id="3486612">n</span><span class="op" id="3486613">,</span>&nbsp;<span class="ident" id="3486615">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3486620">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3486623">//&nbsp;Imaginary&nbsp;constants&nbsp;can&nbsp;only&nbsp;be&nbsp;complex&nbsp;unless&nbsp;they&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486689">if</span>&nbsp;<span class="builtinfunc" id="3486692">len</span><span class="op" id="3486695">(</span><span class="ident" id="3486696">text</span><span class="op" id="3486700">)</span>&nbsp;<span class="op" id="3486702">&gt;</span>&nbsp;<span class="num" id="3486704">0</span>&nbsp;<span class="op" id="3486706">&amp;&amp;</span>&nbsp;<span class="ident" id="3486709">text</span><span class="op" id="3486713">[</span><span class="builtinfunc" id="3486714">len</span><span class="op" id="3486717">(</span><span class="ident" id="3486718">text</span><span class="op" id="3486722">)</span><span class="op" id="3486723">-</span><span class="num" id="3486724">1</span><span class="op" id="3486725">]</span>&nbsp;<span class="op" id="3486727">==</span>&nbsp;<span class="string" id="3486730">&#39;i&#39;</span>&nbsp;<span class="op" id="3486734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486738">f</span><span class="op" id="3486739">,</span>&nbsp;<span class="ident" id="3486741">err</span>&nbsp;<span class="op" id="3486745">:=</span>&nbsp;<span class="ident" id="3486748">strconv</span><span class="op" id="3486755">.</span><span class="ident" id="3486756">ParseFloat</span><span class="op" id="3486766">(</span><span class="ident" id="3486767">text</span><span class="op" id="3486771">[</span><span class="op" id="3486772">:</span><span class="builtinfunc" id="3486773">len</span><span class="op" id="3486776">(</span><span class="ident" id="3486777">text</span><span class="op" id="3486781">)</span><span class="op" id="3486782">-</span><span class="num" id="3486783">1</span><span class="op" id="3486784">]</span><span class="op" id="3486785">,</span>&nbsp;<span class="num" id="3486787">64</span><span class="op" id="3486789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486793">if</span>&nbsp;<span class="ident" id="3486796">err</span>&nbsp;<span class="op" id="3486800">==</span>&nbsp;<span class="ident" id="3486803">nil</span>&nbsp;<span class="op" id="3486807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486812">n</span><span class="op" id="3486813">.</span><span class="ident" id="3486814">IsComplex</span>&nbsp;<span class="op" id="3486824">=</span>&nbsp;<span class="builtintype" id="3486826">true</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486834">n</span><span class="op" id="3486835">.</span><span class="ident" id="3486836">Complex128</span>&nbsp;<span class="op" id="3486847">=</span>&nbsp;<span class="builtinfunc" id="3486849">complex</span><span class="op" id="3486856">(</span><span class="num" id="3486857">0</span><span class="op" id="3486858">,</span>&nbsp;<span class="ident" id="3486860">f</span><span class="op" id="3486861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486866">n</span><span class="op" id="3486867">.</span><span class="ident" id="3486868">simplifyComplex</span><span class="op" id="3486883">(</span><span class="op" id="3486884">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3486889">return</span>&nbsp;<span class="ident" id="3486896">n</span><span class="op" id="3486897">,</span>&nbsp;<span class="ident" id="3486899">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3486905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3486908">}</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3486911">//&nbsp;Do&nbsp;integer&nbsp;test&nbsp;first&nbsp;so&nbsp;we&nbsp;get&nbsp;0x123&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3486958">u</span><span class="op" id="3486959">,</span>&nbsp;<span class="ident" id="3486961">err</span>&nbsp;<span class="op" id="3486965">:=</span>&nbsp;<span class="ident" id="3486968">strconv</span><span class="op" id="3486975">.</span><span class="ident" id="3486976">ParseUint</span><span class="op" id="3486985">(</span><span class="ident" id="3486986">text</span><span class="op" id="3486990">,</span>&nbsp;<span class="num" id="3486992">0</span><span class="op" id="3486993">,</span>&nbsp;<span class="num" id="3486995">64</span><span class="op" id="3486997">)</span>&nbsp;<span class="comment" id="3486999">//&nbsp;will&nbsp;fail&nbsp;for&nbsp;-0;&nbsp;fixed&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3487034">if</span>&nbsp;<span class="ident" id="3487037">err</span>&nbsp;<span class="op" id="3487041">==</span>&nbsp;<span class="ident" id="3487044">nil</span>&nbsp;<span class="op" id="3487048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487052">n</span><span class="op" id="3487053">.</span><span class="ident" id="3487054">IsUint</span>&nbsp;<span class="op" id="3487061">=</span>&nbsp;<span class="builtintype" id="3487063">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487070">n</span><span class="op" id="3487071">.</span><span class="ident" id="3487072">Uint64</span>&nbsp;<span class="op" id="3487079">=</span>&nbsp;<span class="ident" id="3487081">u</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3487084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487087">i</span><span class="op" id="3487088">,</span>&nbsp;<span class="ident" id="3487090">err</span>&nbsp;<span class="op" id="3487094">:=</span>&nbsp;<span class="ident" id="3487097">strconv</span><span class="op" id="3487104">.</span><span class="ident" id="3487105">ParseInt</span><span class="op" id="3487113">(</span><span class="ident" id="3487114">text</span><span class="op" id="3487118">,</span>&nbsp;<span class="num" id="3487120">0</span><span class="op" id="3487121">,</span>&nbsp;<span class="num" id="3487123">64</span><span class="op" id="3487125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3487128">if</span>&nbsp;<span class="ident" id="3487131">err</span>&nbsp;<span class="op" id="3487135">==</span>&nbsp;<span class="ident" id="3487138">nil</span>&nbsp;<span class="op" id="3487142">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487146">n</span><span class="op" id="3487147">.</span><span class="ident" id="3487148">IsInt</span>&nbsp;<span class="op" id="3487154">=</span>&nbsp;<span class="builtintype" id="3487156">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487163">n</span><span class="op" id="3487164">.</span><span class="ident" id="3487165">Int64</span>&nbsp;<span class="op" id="3487171">=</span>&nbsp;<span class="ident" id="3487173">i</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3487177">if</span>&nbsp;<span class="ident" id="3487180">i</span>&nbsp;<span class="op" id="3487182">==</span>&nbsp;<span class="num" id="3487185">0</span>&nbsp;<span class="op" id="3487187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487192">n</span><span class="op" id="3487193">.</span><span class="ident" id="3487194">IsUint</span>&nbsp;<span class="op" id="3487201">=</span>&nbsp;<span class="builtintype" id="3487203">true</span>&nbsp;<span class="comment" id="3487208">//&nbsp;in&nbsp;case&nbsp;of&nbsp;-0.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487229">n</span><span class="op" id="3487230">.</span><span class="ident" id="3487231">Uint64</span>&nbsp;<span class="op" id="3487238">=</span>&nbsp;<span class="ident" id="3487240">u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3487244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3487247">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3487250">//&nbsp;If&nbsp;an&nbsp;integer&nbsp;extraction&nbsp;succeeded,&nbsp;promote&nbsp;the&nbsp;float.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3487309">if</span>&nbsp;<span class="ident" id="3487312">n</span><span class="op" id="3487313">.</span><span class="ident" id="3487314">IsInt</span>&nbsp;<span class="op" id="3487320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487324">n</span><span class="op" id="3487325">.</span><span class="ident" id="3487326">IsFloat</span>&nbsp;<span class="op" id="3487334">=</span>&nbsp;<span class="builtintype" id="3487336">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487343">n</span><span class="op" id="3487344">.</span><span class="ident" id="3487345">Float64</span>&nbsp;<span class="op" id="3487353">=</span>&nbsp;<span class="builtintype" id="3487355">float64</span><span class="op" id="3487362">(</span><span class="ident" id="3487363">n</span><span class="op" id="3487364">.</span><span class="ident" id="3487365">Int64</span><span class="op" id="3487370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3487373">}</span>&nbsp;<span class="keyword" id="3487375">else</span>&nbsp;<span class="keyword" id="3487380">if</span>&nbsp;<span class="ident" id="3487383">n</span><span class="op" id="3487384">.</span><span class="ident" id="3487385">IsUint</span>&nbsp;<span class="op" id="3487392">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487396">n</span><span class="op" id="3487397">.</span><span class="ident" id="3487398">IsFloat</span>&nbsp;<span class="op" id="3487406">=</span>&nbsp;<span class="builtintype" id="3487408">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487415">n</span><span class="op" id="3487416">.</span><span class="ident" id="3487417">Float64</span>&nbsp;<span class="op" id="3487425">=</span>&nbsp;<span class="builtintype" id="3487427">float64</span><span class="op" id="3487434">(</span><span class="ident" id="3487435">n</span><span class="op" id="3487436">.</span><span class="ident" id="3487437">Uint64</span><span class="op" id="3487443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3487446">}</span>&nbsp;<span class="keyword" id="3487448">else</span>&nbsp;<span class="op" id="3487453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487457">f</span><span class="op" id="3487458">,</span>&nbsp;<span class="ident" id="3487460">err</span>&nbsp;<span class="op" id="3487464">:=</span>&nbsp;<span class="ident" id="3487467">strconv</span><span class="op" id="3487474">.</span><span class="ident" id="3487475">ParseFloat</span><span class="op" id="3487485">(</span><span class="ident" id="3487486">text</span><span class="op" id="3487490">,</span>&nbsp;<span class="num" id="3487492">64</span><span class="op" id="3487494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3487498">if</span>&nbsp;<span class="ident" id="3487501">err</span>&nbsp;<span class="op" id="3487505">==</span>&nbsp;<span class="ident" id="3487508">nil</span>&nbsp;<span class="op" id="3487512">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487517">n</span><span class="op" id="3487518">.</span><span class="ident" id="3487519">IsFloat</span>&nbsp;<span class="op" id="3487527">=</span>&nbsp;<span class="builtintype" id="3487529">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487537">n</span><span class="op" id="3487538">.</span><span class="ident" id="3487539">Float64</span>&nbsp;<span class="op" id="3487547">=</span>&nbsp;<span class="ident" id="3487549">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3487554">//&nbsp;If&nbsp;a&nbsp;floating-point&nbsp;extraction&nbsp;succeeded,&nbsp;extract&nbsp;the&nbsp;int&nbsp;if&nbsp;needed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3487629">if</span>&nbsp;<span class="op" id="3487632">!</span><span class="ident" id="3487633">n</span><span class="op" id="3487634">.</span><span class="ident" id="3487635">IsInt</span>&nbsp;<span class="op" id="3487641">&amp;&amp;</span>&nbsp;<span class="builtintype" id="3487644">float64</span><span class="op" id="3487651">(</span><span class="ident" id="3487652">int64</span><span class="op" id="3487657">(</span><span class="ident" id="3487658">f</span><span class="op" id="3487659">)</span><span class="op" id="3487660">)</span>&nbsp;<span class="op" id="3487662">==</span>&nbsp;<span class="ident" id="3487665">f</span>&nbsp;<span class="op" id="3487667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487673">n</span><span class="op" id="3487674">.</span><span class="ident" id="3487675">IsInt</span>&nbsp;<span class="op" id="3487681">=</span>&nbsp;<span class="builtintype" id="3487683">true</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487692">n</span><span class="op" id="3487693">.</span><span class="ident" id="3487694">Int64</span>&nbsp;<span class="op" id="3487700">=</span>&nbsp;<span class="ident" id="3487702">int64</span><span class="op" id="3487707">(</span><span class="ident" id="3487708">f</span><span class="op" id="3487709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3487714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3487719">if</span>&nbsp;<span class="op" id="3487722">!</span><span class="ident" id="3487723">n</span><span class="op" id="3487724">.</span><span class="ident" id="3487725">IsUint</span>&nbsp;<span class="op" id="3487732">&amp;&amp;</span>&nbsp;<span class="builtintype" id="3487735">float64</span><span class="op" id="3487742">(</span><span class="ident" id="3487743">uint64</span><span class="op" id="3487749">(</span><span class="ident" id="3487750">f</span><span class="op" id="3487751">)</span><span class="op" id="3487752">)</span>&nbsp;<span class="op" id="3487754">==</span>&nbsp;<span class="ident" id="3487757">f</span>&nbsp;<span class="op" id="3487759">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487765">n</span><span class="op" id="3487766">.</span><span class="ident" id="3487767">IsUint</span>&nbsp;<span class="op" id="3487774">=</span>&nbsp;<span class="builtintype" id="3487776">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3487785">n</span><span class="op" id="3487786">.</span><span class="ident" id="3487787">Uint64</span>&nbsp;<span class="op" id="3487794">=</span>&nbsp;<span class="ident" id="3487796">uint64</span><span class="op" id="3487802">(</span><span class="ident" id="3487803">f</span><span class="op" id="3487804">)</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3487809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3487813">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3487816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3487819">if</span>&nbsp;<span class="op" id="3487822">!</span><span class="ident" id="3487823">n</span><span class="op" id="3487824">.</span><span class="ident" id="3487825">IsInt</span>&nbsp;<span class="op" id="3487831">&amp;&amp;</span>&nbsp;<span class="op" id="3487834">!</span><span class="ident" id="3487835">n</span><span class="op" id="3487836">.</span><span class="ident" id="3487837">IsUint</span>&nbsp;<span class="op" id="3487844">&amp;&amp;</span>&nbsp;<span class="op" id="3487847">!</span><span class="ident" id="3487848">n</span><span class="op" id="3487849">.</span><span class="ident" id="3487850">IsFloat</span>&nbsp;<span class="op" id="3487858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3487862">return</span>&nbsp;<span class="ident" id="3487869">nil</span><span class="op" id="3487872">,</span>&nbsp;<span class="ident" id="3487874">fmt</span><span class="op" id="3487877">.</span><span class="ident" id="3487878">Errorf</span><span class="op" id="3487884">(</span><span class="string" id="3487885">&#34;illegal&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="3487912">,</span>&nbsp;<span class="ident" id="3487914">text</span><span class="op" id="3487918">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3487921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3487924">return</span>&nbsp;<span class="ident" id="3487931">n</span><span class="op" id="3487932">,</span>&nbsp;<span class="ident" id="3487934">nil</span><br>
<span class="lineno"></span><span class="op" id="3487938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3487941">//&nbsp;simplifyComplex&nbsp;pulls&nbsp;out&nbsp;any&nbsp;other&nbsp;types&nbsp;that&nbsp;are&nbsp;represented&nbsp;by&nbsp;the&nbsp;complex&nbsp;number.</span><br>
<span class="lineno">615</span><span class="comment" id="3488030">//&nbsp;These&nbsp;all&nbsp;require&nbsp;that&nbsp;the&nbsp;imaginary&nbsp;part&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span><span class="keyword" id="3488084">func</span>&nbsp;<span class="op" id="3488089">(</span><span class="ident" id="3488090">n</span>&nbsp;<span class="op" id="3488092">*</span><span class="ident" id="3488093">NumberNode</span><span class="op" id="3488103">)</span>&nbsp;<span class="ident" id="3488105">simplifyComplex</span><span class="op" id="3488120">(</span><span class="op" id="3488121">)</span>&nbsp;<span class="op" id="3488123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488126">n</span><span class="op" id="3488127">.</span><span class="ident" id="3488128">IsFloat</span>&nbsp;<span class="op" id="3488136">=</span>&nbsp;<span class="builtinfunc" id="3488138">imag</span><span class="op" id="3488142">(</span><span class="ident" id="3488143">n</span><span class="op" id="3488144">.</span><span class="ident" id="3488145">Complex128</span><span class="op" id="3488155">)</span>&nbsp;<span class="op" id="3488157">==</span>&nbsp;<span class="num" id="3488160">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488163">if</span>&nbsp;<span class="ident" id="3488166">n</span><span class="op" id="3488167">.</span><span class="ident" id="3488168">IsFloat</span>&nbsp;<span class="op" id="3488176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488180">n</span><span class="op" id="3488181">.</span><span class="ident" id="3488182">Float64</span>&nbsp;<span class="op" id="3488190">=</span>&nbsp;<span class="builtinfunc" id="3488192">real</span><span class="op" id="3488196">(</span><span class="ident" id="3488197">n</span><span class="op" id="3488198">.</span><span class="ident" id="3488199">Complex128</span><span class="op" id="3488209">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488213">n</span><span class="op" id="3488214">.</span><span class="ident" id="3488215">IsInt</span>&nbsp;<span class="op" id="3488221">=</span>&nbsp;<span class="builtintype" id="3488223">float64</span><span class="op" id="3488230">(</span><span class="ident" id="3488231">int64</span><span class="op" id="3488236">(</span><span class="ident" id="3488237">n</span><span class="op" id="3488238">.</span><span class="ident" id="3488239">Float64</span><span class="op" id="3488246">)</span><span class="op" id="3488247">)</span>&nbsp;<span class="op" id="3488249">==</span>&nbsp;<span class="ident" id="3488252">n</span><span class="op" id="3488253">.</span><span class="ident" id="3488254">Float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488264">if</span>&nbsp;<span class="ident" id="3488267">n</span><span class="op" id="3488268">.</span><span class="ident" id="3488269">IsInt</span>&nbsp;<span class="op" id="3488275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488280">n</span><span class="op" id="3488281">.</span><span class="ident" id="3488282">Int64</span>&nbsp;<span class="op" id="3488288">=</span>&nbsp;<span class="ident" id="3488290">int64</span><span class="op" id="3488295">(</span><span class="ident" id="3488296">n</span><span class="op" id="3488297">.</span><span class="ident" id="3488298">Float64</span><span class="op" id="3488305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3488309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488313">n</span><span class="op" id="3488314">.</span><span class="ident" id="3488315">IsUint</span>&nbsp;<span class="op" id="3488322">=</span>&nbsp;<span class="builtintype" id="3488324">float64</span><span class="op" id="3488331">(</span><span class="ident" id="3488332">uint64</span><span class="op" id="3488338">(</span><span class="ident" id="3488339">n</span><span class="op" id="3488340">.</span><span class="ident" id="3488341">Float64</span><span class="op" id="3488348">)</span><span class="op" id="3488349">)</span>&nbsp;<span class="op" id="3488351">==</span>&nbsp;<span class="ident" id="3488354">n</span><span class="op" id="3488355">.</span><span class="ident" id="3488356">Float64</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488366">if</span>&nbsp;<span class="ident" id="3488369">n</span><span class="op" id="3488370">.</span><span class="ident" id="3488371">IsUint</span>&nbsp;<span class="op" id="3488378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488383">n</span><span class="op" id="3488384">.</span><span class="ident" id="3488385">Uint64</span>&nbsp;<span class="op" id="3488392">=</span>&nbsp;<span class="ident" id="3488394">uint64</span><span class="op" id="3488400">(</span><span class="ident" id="3488401">n</span><span class="op" id="3488402">.</span><span class="ident" id="3488403">Float64</span><span class="op" id="3488410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3488414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3488417">}</span><br>
<span class="lineno"></span><span class="op" id="3488419">}</span><br>
<span class="lineno">630</span><br>
<span class="lineno"></span><span class="keyword" id="3488422">func</span>&nbsp;<span class="op" id="3488427">(</span><span class="ident" id="3488428">n</span>&nbsp;<span class="op" id="3488430">*</span><span class="ident" id="3488431">NumberNode</span><span class="op" id="3488441">)</span>&nbsp;<span class="ident" id="3488443">String</span><span class="op" id="3488449">(</span><span class="op" id="3488450">)</span>&nbsp;<span class="builtintype" id="3488452">string</span>&nbsp;<span class="op" id="3488459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488462">return</span>&nbsp;<span class="ident" id="3488469">n</span><span class="op" id="3488470">.</span><span class="ident" id="3488471">Text</span><br>
<span class="lineno"></span><span class="op" id="3488476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">635</span><span class="keyword" id="3488479">func</span>&nbsp;<span class="op" id="3488484">(</span><span class="ident" id="3488485">n</span>&nbsp;<span class="op" id="3488487">*</span><span class="ident" id="3488488">NumberNode</span><span class="op" id="3488498">)</span>&nbsp;<span class="ident" id="3488500">tree</span><span class="op" id="3488504">(</span><span class="op" id="3488505">)</span>&nbsp;<span class="op" id="3488507">*</span><span class="ident" id="3488508">Tree</span>&nbsp;<span class="op" id="3488513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488516">return</span>&nbsp;<span class="ident" id="3488523">n</span><span class="op" id="3488524">.</span><span class="ident" id="3488525">tr</span><br>
<span class="lineno"></span><span class="op" id="3488528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3488531">func</span>&nbsp;<span class="op" id="3488536">(</span><span class="ident" id="3488537">n</span>&nbsp;<span class="op" id="3488539">*</span><span class="ident" id="3488540">NumberNode</span><span class="op" id="3488550">)</span>&nbsp;<span class="ident" id="3488552">Copy</span><span class="op" id="3488556">(</span><span class="op" id="3488557">)</span>&nbsp;<span class="ident" id="3488559">Node</span>&nbsp;<span class="op" id="3488564">{</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488567">nn</span>&nbsp;<span class="op" id="3488570">:=</span>&nbsp;<span class="builtinfunc" id="3488573">new</span><span class="op" id="3488576">(</span><span class="ident" id="3488577">NumberNode</span><span class="op" id="3488587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3488590">*</span><span class="ident" id="3488591">nn</span>&nbsp;<span class="op" id="3488594">=</span>&nbsp;<span class="op" id="3488596">*</span><span class="ident" id="3488597">n</span>&nbsp;<span class="comment" id="3488599">//&nbsp;Easy,&nbsp;fast,&nbsp;correct.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488624">return</span>&nbsp;<span class="ident" id="3488631">nn</span><br>
<span class="lineno"></span><span class="op" id="3488634">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">645</span><span class="comment" id="3488637">//&nbsp;StringNode&nbsp;holds&nbsp;a&nbsp;string&nbsp;constant.&nbsp;The&nbsp;value&nbsp;has&nbsp;been&nbsp;&#34;unquoted&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3488707">type</span>&nbsp;<span class="ident" id="3488712">StringNode</span>&nbsp;<span class="keyword" id="3488723">struct</span>&nbsp;<span class="op" id="3488730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488733">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488743">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488748">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3488755">*</span><span class="ident" id="3488756">Tree</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488762">Quoted</span>&nbsp;<span class="builtintype" id="3488769">string</span>&nbsp;<span class="comment" id="3488776">//&nbsp;The&nbsp;original&nbsp;text&nbsp;of&nbsp;the&nbsp;string,&nbsp;with&nbsp;quotes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3488826">Text</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3488833">string</span>&nbsp;<span class="comment" id="3488840">//&nbsp;The&nbsp;string,&nbsp;after&nbsp;quote&nbsp;processing.</span><br>
<span class="lineno"></span><span class="op" id="3488879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3488882">func</span>&nbsp;<span class="op" id="3488887">(</span><span class="ident" id="3488888">t</span>&nbsp;<span class="op" id="3488890">*</span><span class="ident" id="3488891">Tree</span><span class="op" id="3488895">)</span>&nbsp;<span class="ident" id="3488897">newString</span><span class="op" id="3488906">(</span><span class="ident" id="3488907">pos</span>&nbsp;<span class="ident" id="3488911">Pos</span><span class="op" id="3488914">,</span>&nbsp;<span class="ident" id="3488916">orig</span><span class="op" id="3488920">,</span>&nbsp;<span class="ident" id="3488922">text</span>&nbsp;<span class="builtintype" id="3488927">string</span><span class="op" id="3488933">)</span>&nbsp;<span class="op" id="3488935">*</span><span class="ident" id="3488936">StringNode</span>&nbsp;<span class="op" id="3488947">{</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3488950">return</span>&nbsp;<span class="op" id="3488957">&amp;</span><span class="ident" id="3488958">StringNode</span><span class="op" id="3488968">{</span><span class="ident" id="3488969">tr</span><span class="op" id="3488971">:</span>&nbsp;<span class="ident" id="3488973">t</span><span class="op" id="3488974">,</span>&nbsp;<span class="ident" id="3488976">NodeType</span><span class="op" id="3488984">:</span>&nbsp;<span class="ident" id="3488986">NodeString</span><span class="op" id="3488996">,</span>&nbsp;<span class="ident" id="3488998">Pos</span><span class="op" id="3489001">:</span>&nbsp;<span class="ident" id="3489003">pos</span><span class="op" id="3489006">,</span>&nbsp;<span class="ident" id="3489008">Quoted</span><span class="op" id="3489014">:</span>&nbsp;<span class="ident" id="3489016">orig</span><span class="op" id="3489020">,</span>&nbsp;<span class="ident" id="3489022">Text</span><span class="op" id="3489026">:</span>&nbsp;<span class="ident" id="3489028">text</span><span class="op" id="3489032">}</span><br>
<span class="lineno"></span><span class="op" id="3489034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3489037">func</span>&nbsp;<span class="op" id="3489042">(</span><span class="ident" id="3489043">s</span>&nbsp;<span class="op" id="3489045">*</span><span class="ident" id="3489046">StringNode</span><span class="op" id="3489056">)</span>&nbsp;<span class="ident" id="3489058">String</span><span class="op" id="3489064">(</span><span class="op" id="3489065">)</span>&nbsp;<span class="builtintype" id="3489067">string</span>&nbsp;<span class="op" id="3489074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3489077">return</span>&nbsp;<span class="ident" id="3489084">s</span><span class="op" id="3489085">.</span><span class="ident" id="3489086">Quoted</span><br>
<span class="lineno">660</span><span class="op" id="3489093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3489096">func</span>&nbsp;<span class="op" id="3489101">(</span><span class="ident" id="3489102">s</span>&nbsp;<span class="op" id="3489104">*</span><span class="ident" id="3489105">StringNode</span><span class="op" id="3489115">)</span>&nbsp;<span class="ident" id="3489117">tree</span><span class="op" id="3489121">(</span><span class="op" id="3489122">)</span>&nbsp;<span class="op" id="3489124">*</span><span class="ident" id="3489125">Tree</span>&nbsp;<span class="op" id="3489130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3489133">return</span>&nbsp;<span class="ident" id="3489140">s</span><span class="op" id="3489141">.</span><span class="ident" id="3489142">tr</span><br>
<span class="lineno"></span><span class="op" id="3489145">}</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span><span class="keyword" id="3489148">func</span>&nbsp;<span class="op" id="3489153">(</span><span class="ident" id="3489154">s</span>&nbsp;<span class="op" id="3489156">*</span><span class="ident" id="3489157">StringNode</span><span class="op" id="3489167">)</span>&nbsp;<span class="ident" id="3489169">Copy</span><span class="op" id="3489173">(</span><span class="op" id="3489174">)</span>&nbsp;<span class="ident" id="3489176">Node</span>&nbsp;<span class="op" id="3489181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3489184">return</span>&nbsp;<span class="ident" id="3489191">s</span><span class="op" id="3489192">.</span><span class="ident" id="3489193">tr</span><span class="op" id="3489195">.</span><span class="ident" id="3489196">newString</span><span class="op" id="3489205">(</span><span class="ident" id="3489206">s</span><span class="op" id="3489207">.</span><span class="ident" id="3489208">Pos</span><span class="op" id="3489211">,</span>&nbsp;<span class="ident" id="3489213">s</span><span class="op" id="3489214">.</span><span class="ident" id="3489215">Quoted</span><span class="op" id="3489221">,</span>&nbsp;<span class="ident" id="3489223">s</span><span class="op" id="3489224">.</span><span class="ident" id="3489225">Text</span><span class="op" id="3489229">)</span><br>
<span class="lineno"></span><span class="op" id="3489231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span><span class="comment" id="3489234">//&nbsp;endNode&nbsp;represents&nbsp;an&nbsp;{{end}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="comment" id="3489275">//&nbsp;It&nbsp;does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;parse&nbsp;tree.</span><br>
<span class="lineno"></span><span class="keyword" id="3489322">type</span>&nbsp;<span class="ident" id="3489327">endNode</span>&nbsp;<span class="keyword" id="3489335">struct</span>&nbsp;<span class="op" id="3489342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3489345">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3489355">Pos</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3489360">tr</span>&nbsp;<span class="op" id="3489363">*</span><span class="ident" id="3489364">Tree</span><br>
<span class="lineno"></span><span class="op" id="3489369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3489372">func</span>&nbsp;<span class="op" id="3489377">(</span><span class="ident" id="3489378">t</span>&nbsp;<span class="op" id="3489380">*</span><span class="ident" id="3489381">Tree</span><span class="op" id="3489385">)</span>&nbsp;<span class="ident" id="3489387">newEnd</span><span class="op" id="3489393">(</span><span class="ident" id="3489394">pos</span>&nbsp;<span class="ident" id="3489398">Pos</span><span class="op" id="3489401">)</span>&nbsp;<span class="op" id="3489403">*</span><span class="ident" id="3489404">endNode</span>&nbsp;<span class="op" id="3489412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3489415">return</span>&nbsp;<span class="op" id="3489422">&amp;</span><span class="ident" id="3489423">endNode</span><span class="op" id="3489430">{</span><span class="ident" id="3489431">tr</span><span class="op" id="3489433">:</span>&nbsp;<span class="ident" id="3489435">t</span><span class="op" id="3489436">,</span>&nbsp;<span class="ident" id="3489438">NodeType</span><span class="op" id="3489446">:</span>&nbsp;<span class="ident" id="3489448">nodeEnd</span><span class="op" id="3489455">,</span>&nbsp;<span class="ident" id="3489457">Pos</span><span class="op" id="3489460">:</span>&nbsp;<span class="ident" id="3489462">pos</span><span class="op" id="3489465">}</span><br>
<span class="lineno">680</span><span class="op" id="3489467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3489470">func</span>&nbsp;<span class="op" id="3489475">(</span><span class="ident" id="3489476">e</span>&nbsp;<span class="op" id="3489478">*</span><span class="ident" id="3489479">endNode</span><span class="op" id="3489486">)</span>&nbsp;<span class="ident" id="3489488">String</span><span class="op" id="3489494">(</span><span class="op" id="3489495">)</span>&nbsp;<span class="builtintype" id="3489497">string</span>&nbsp;<span class="op" id="3489504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3489507">return</span>&nbsp;<span class="string" id="3489514">&#34;{{end}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="3489524">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="3489527">func</span>&nbsp;<span class="op" id="3489532">(</span><span class="ident" id="3489533">e</span>&nbsp;<span class="op" id="3489535">*</span><span class="ident" id="3489536">endNode</span><span class="op" id="3489543">)</span>&nbsp;<span class="ident" id="3489545">tree</span><span class="op" id="3489549">(</span><span class="op" id="3489550">)</span>&nbsp;<span class="op" id="3489552">*</span><span class="ident" id="3489553">Tree</span>&nbsp;<span class="op" id="3489558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3489561">return</span>&nbsp;<span class="ident" id="3489568">e</span><span class="op" id="3489569">.</span><span class="ident" id="3489570">tr</span><br>
<span class="lineno"></span><span class="op" id="3489573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="3489576">func</span>&nbsp;<span class="op" id="3489581">(</span><span class="ident" id="3489582">e</span>&nbsp;<span class="op" id="3489584">*</span><span class="ident" id="3489585">endNode</span><span class="op" id="3489592">)</span>&nbsp;<span class="ident" id="3489594">Copy</span><span class="op" id="3489598">(</span><span class="op" id="3489599">)</span>&nbsp;<span class="ident" id="3489601">Node</span>&nbsp;<span class="op" id="3489606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3489609">return</span>&nbsp;<span class="ident" id="3489616">e</span><span class="op" id="3489617">.</span><span class="ident" id="3489618">tr</span><span class="op" id="3489620">.</span><span class="ident" id="3489621">newEnd</span><span class="op" id="3489627">(</span><span class="ident" id="3489628">e</span><span class="op" id="3489629">.</span><span class="ident" id="3489630">Pos</span><span class="op" id="3489633">)</span><br>
<span class="lineno"></span><span class="op" id="3489635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3489638">//&nbsp;elseNode&nbsp;represents&nbsp;an&nbsp;{{else}}&nbsp;action.&nbsp;Does&nbsp;not&nbsp;appear&nbsp;in&nbsp;the&nbsp;final&nbsp;tree.</span><br>
<span class="lineno">695</span><span class="keyword" id="3489716">type</span>&nbsp;<span class="ident" id="3489721">elseNode</span>&nbsp;<span class="keyword" id="3489730">struct</span>&nbsp;<span class="op" id="3489737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3489740">NodeType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3489750">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3489755">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3489760">*</span><span class="ident" id="3489761">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3489767">Line</span>&nbsp;<span class="builtintype" id="3489772">int</span>&nbsp;<span class="comment" id="3489776">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno">700</span><span class="op" id="3489845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3489848">func</span>&nbsp;<span class="op" id="3489853">(</span><span class="ident" id="3489854">t</span>&nbsp;<span class="op" id="3489856">*</span><span class="ident" id="3489857">Tree</span><span class="op" id="3489861">)</span>&nbsp;<span class="ident" id="3489863">newElse</span><span class="op" id="3489870">(</span><span class="ident" id="3489871">pos</span>&nbsp;<span class="ident" id="3489875">Pos</span><span class="op" id="3489878">,</span>&nbsp;<span class="ident" id="3489880">line</span>&nbsp;<span class="builtintype" id="3489885">int</span><span class="op" id="3489888">)</span>&nbsp;<span class="op" id="3489890">*</span><span class="ident" id="3489891">elseNode</span>&nbsp;<span class="op" id="3489900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3489903">return</span>&nbsp;<span class="op" id="3489910">&amp;</span><span class="ident" id="3489911">elseNode</span><span class="op" id="3489919">{</span><span class="ident" id="3489920">tr</span><span class="op" id="3489922">:</span>&nbsp;<span class="ident" id="3489924">t</span><span class="op" id="3489925">,</span>&nbsp;<span class="ident" id="3489927">NodeType</span><span class="op" id="3489935">:</span>&nbsp;<span class="ident" id="3489937">nodeElse</span><span class="op" id="3489945">,</span>&nbsp;<span class="ident" id="3489947">Pos</span><span class="op" id="3489950">:</span>&nbsp;<span class="ident" id="3489952">pos</span><span class="op" id="3489955">,</span>&nbsp;<span class="ident" id="3489957">Line</span><span class="op" id="3489961">:</span>&nbsp;<span class="ident" id="3489963">line</span><span class="op" id="3489967">}</span><br>
<span class="lineno"></span><span class="op" id="3489969">}</span><br>
<span class="lineno">705</span><br>
<span class="lineno"></span><span class="keyword" id="3489972">func</span>&nbsp;<span class="op" id="3489977">(</span><span class="ident" id="3489978">e</span>&nbsp;<span class="op" id="3489980">*</span><span class="ident" id="3489981">elseNode</span><span class="op" id="3489989">)</span>&nbsp;<span class="ident" id="3489991">Type</span><span class="op" id="3489995">(</span><span class="op" id="3489996">)</span>&nbsp;<span class="ident" id="3489998">NodeType</span>&nbsp;<span class="op" id="3490007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490010">return</span>&nbsp;<span class="ident" id="3490017">nodeElse</span><br>
<span class="lineno"></span><span class="op" id="3490026">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="3490029">func</span>&nbsp;<span class="op" id="3490034">(</span><span class="ident" id="3490035">e</span>&nbsp;<span class="op" id="3490037">*</span><span class="ident" id="3490038">elseNode</span><span class="op" id="3490046">)</span>&nbsp;<span class="ident" id="3490048">String</span><span class="op" id="3490054">(</span><span class="op" id="3490055">)</span>&nbsp;<span class="builtintype" id="3490057">string</span>&nbsp;<span class="op" id="3490064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490067">return</span>&nbsp;<span class="string" id="3490074">&#34;{{else}}&#34;</span><br>
<span class="lineno"></span><span class="op" id="3490085">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3490088">func</span>&nbsp;<span class="op" id="3490093">(</span><span class="ident" id="3490094">e</span>&nbsp;<span class="op" id="3490096">*</span><span class="ident" id="3490097">elseNode</span><span class="op" id="3490105">)</span>&nbsp;<span class="ident" id="3490107">tree</span><span class="op" id="3490111">(</span><span class="op" id="3490112">)</span>&nbsp;<span class="op" id="3490114">*</span><span class="ident" id="3490115">Tree</span>&nbsp;<span class="op" id="3490120">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490123">return</span>&nbsp;<span class="ident" id="3490130">e</span><span class="op" id="3490131">.</span><span class="ident" id="3490132">tr</span><br>
<span class="lineno"></span><span class="op" id="3490135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3490138">func</span>&nbsp;<span class="op" id="3490143">(</span><span class="ident" id="3490144">e</span>&nbsp;<span class="op" id="3490146">*</span><span class="ident" id="3490147">elseNode</span><span class="op" id="3490155">)</span>&nbsp;<span class="ident" id="3490157">Copy</span><span class="op" id="3490161">(</span><span class="op" id="3490162">)</span>&nbsp;<span class="ident" id="3490164">Node</span>&nbsp;<span class="op" id="3490169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490172">return</span>&nbsp;<span class="ident" id="3490179">e</span><span class="op" id="3490180">.</span><span class="ident" id="3490181">tr</span><span class="op" id="3490183">.</span><span class="ident" id="3490184">newElse</span><span class="op" id="3490191">(</span><span class="ident" id="3490192">e</span><span class="op" id="3490193">.</span><span class="ident" id="3490194">Pos</span><span class="op" id="3490197">,</span>&nbsp;<span class="ident" id="3490199">e</span><span class="op" id="3490200">.</span><span class="ident" id="3490201">Line</span><span class="op" id="3490205">)</span><br>
<span class="lineno">720</span><span class="op" id="3490207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3490210">//&nbsp;BranchNode&nbsp;is&nbsp;the&nbsp;common&nbsp;representation&nbsp;of&nbsp;if,&nbsp;range,&nbsp;and&nbsp;with.</span><br>
<span class="lineno"></span><span class="keyword" id="3490277">type</span>&nbsp;<span class="ident" id="3490282">BranchNode</span>&nbsp;<span class="keyword" id="3490293">struct</span>&nbsp;<span class="op" id="3490300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490303">NodeType</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490313">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490318">tr</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3490327">*</span><span class="ident" id="3490328">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490334">Line</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3490343">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3490353">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490423">Pipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3490432">*</span><span class="ident" id="3490433">PipeNode</span>&nbsp;<span class="comment" id="3490442">//&nbsp;The&nbsp;pipeline&nbsp;to&nbsp;be&nbsp;evaluated.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490476">List</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3490485">*</span><span class="ident" id="3490486">ListNode</span>&nbsp;<span class="comment" id="3490495">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;non-empty.</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490542">ElseList</span>&nbsp;<span class="op" id="3490551">*</span><span class="ident" id="3490552">ListNode</span>&nbsp;<span class="comment" id="3490561">//&nbsp;What&nbsp;to&nbsp;execute&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;empty&nbsp;(nil&nbsp;if&nbsp;absent).</span><br>
<span class="lineno"></span><span class="op" id="3490619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3490622">func</span>&nbsp;<span class="op" id="3490627">(</span><span class="ident" id="3490628">b</span>&nbsp;<span class="op" id="3490630">*</span><span class="ident" id="3490631">BranchNode</span><span class="op" id="3490641">)</span>&nbsp;<span class="ident" id="3490643">String</span><span class="op" id="3490649">(</span><span class="op" id="3490650">)</span>&nbsp;<span class="builtintype" id="3490652">string</span>&nbsp;<span class="op" id="3490659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490662">name</span>&nbsp;<span class="op" id="3490667">:=</span>&nbsp;<span class="string" id="3490670">&#34;&#34;</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490674">switch</span>&nbsp;<span class="ident" id="3490681">b</span><span class="op" id="3490682">.</span><span class="ident" id="3490683">NodeType</span>&nbsp;<span class="op" id="3490692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490695">case</span>&nbsp;<span class="ident" id="3490700">NodeIf</span><span class="op" id="3490706">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490710">name</span>&nbsp;<span class="op" id="3490715">=</span>&nbsp;<span class="string" id="3490717">&#34;if&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490723">case</span>&nbsp;<span class="ident" id="3490728">NodeRange</span><span class="op" id="3490737">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490741">name</span>&nbsp;<span class="op" id="3490746">=</span>&nbsp;<span class="string" id="3490748">&#34;range&#34;</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490757">case</span>&nbsp;<span class="ident" id="3490762">NodeWith</span><span class="op" id="3490770">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3490774">name</span>&nbsp;<span class="op" id="3490779">=</span>&nbsp;<span class="string" id="3490781">&#34;with&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490789">default</span><span class="op" id="3490796">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3490800">panic</span><span class="op" id="3490805">(</span><span class="string" id="3490806">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="3490827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3490830">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490833">if</span>&nbsp;<span class="ident" id="3490836">b</span><span class="op" id="3490837">.</span><span class="ident" id="3490838">ElseList</span>&nbsp;<span class="op" id="3490847">!=</span>&nbsp;<span class="ident" id="3490850">nil</span>&nbsp;<span class="op" id="3490854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490858">return</span>&nbsp;<span class="ident" id="3490865">fmt</span><span class="op" id="3490868">.</span><span class="ident" id="3490869">Sprintf</span><span class="op" id="3490876">(</span><span class="string" id="3490877">&#34;{{%s&nbsp;%s}}%s{{else}}%s{{end}}&#34;</span><span class="op" id="3490907">,</span>&nbsp;<span class="ident" id="3490909">name</span><span class="op" id="3490913">,</span>&nbsp;<span class="ident" id="3490915">b</span><span class="op" id="3490916">.</span><span class="ident" id="3490917">Pipe</span><span class="op" id="3490921">,</span>&nbsp;<span class="ident" id="3490923">b</span><span class="op" id="3490924">.</span><span class="ident" id="3490925">List</span><span class="op" id="3490929">,</span>&nbsp;<span class="ident" id="3490931">b</span><span class="op" id="3490932">.</span><span class="ident" id="3490933">ElseList</span><span class="op" id="3490941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3490944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3490947">return</span>&nbsp;<span class="ident" id="3490954">fmt</span><span class="op" id="3490957">.</span><span class="ident" id="3490958">Sprintf</span><span class="op" id="3490965">(</span><span class="string" id="3490966">&#34;{{%s&nbsp;%s}}%s{{end}}&#34;</span><span class="op" id="3490986">,</span>&nbsp;<span class="ident" id="3490988">name</span><span class="op" id="3490992">,</span>&nbsp;<span class="ident" id="3490994">b</span><span class="op" id="3490995">.</span><span class="ident" id="3490996">Pipe</span><span class="op" id="3491000">,</span>&nbsp;<span class="ident" id="3491002">b</span><span class="op" id="3491003">.</span><span class="ident" id="3491004">List</span><span class="op" id="3491008">)</span><br>
<span class="lineno"></span><span class="op" id="3491010">}</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span><span class="keyword" id="3491013">func</span>&nbsp;<span class="op" id="3491018">(</span><span class="ident" id="3491019">b</span>&nbsp;<span class="op" id="3491021">*</span><span class="ident" id="3491022">BranchNode</span><span class="op" id="3491032">)</span>&nbsp;<span class="ident" id="3491034">tree</span><span class="op" id="3491038">(</span><span class="op" id="3491039">)</span>&nbsp;<span class="op" id="3491041">*</span><span class="ident" id="3491042">Tree</span>&nbsp;<span class="op" id="3491047">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491050">return</span>&nbsp;<span class="ident" id="3491057">b</span><span class="op" id="3491058">.</span><span class="ident" id="3491059">tr</span><br>
<span class="lineno"></span><span class="op" id="3491062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span><span class="keyword" id="3491065">func</span>&nbsp;<span class="op" id="3491070">(</span><span class="ident" id="3491071">b</span>&nbsp;<span class="op" id="3491073">*</span><span class="ident" id="3491074">BranchNode</span><span class="op" id="3491084">)</span>&nbsp;<span class="ident" id="3491086">Copy</span><span class="op" id="3491090">(</span><span class="op" id="3491091">)</span>&nbsp;<span class="ident" id="3491093">Node</span>&nbsp;<span class="op" id="3491098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491101">switch</span>&nbsp;<span class="ident" id="3491108">b</span><span class="op" id="3491109">.</span><span class="ident" id="3491110">NodeType</span>&nbsp;<span class="op" id="3491119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491122">case</span>&nbsp;<span class="ident" id="3491127">NodeIf</span><span class="op" id="3491133">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491137">return</span>&nbsp;<span class="ident" id="3491144">b</span><span class="op" id="3491145">.</span><span class="ident" id="3491146">tr</span><span class="op" id="3491148">.</span><span class="ident" id="3491149">newIf</span><span class="op" id="3491154">(</span><span class="ident" id="3491155">b</span><span class="op" id="3491156">.</span><span class="ident" id="3491157">Pos</span><span class="op" id="3491160">,</span>&nbsp;<span class="ident" id="3491162">b</span><span class="op" id="3491163">.</span><span class="ident" id="3491164">Line</span><span class="op" id="3491168">,</span>&nbsp;<span class="ident" id="3491170">b</span><span class="op" id="3491171">.</span><span class="ident" id="3491172">Pipe</span><span class="op" id="3491176">,</span>&nbsp;<span class="ident" id="3491178">b</span><span class="op" id="3491179">.</span><span class="ident" id="3491180">List</span><span class="op" id="3491184">,</span>&nbsp;<span class="ident" id="3491186">b</span><span class="op" id="3491187">.</span><span class="ident" id="3491188">ElseList</span><span class="op" id="3491196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491199">case</span>&nbsp;<span class="ident" id="3491204">NodeRange</span><span class="op" id="3491213">:</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491217">return</span>&nbsp;<span class="ident" id="3491224">b</span><span class="op" id="3491225">.</span><span class="ident" id="3491226">tr</span><span class="op" id="3491228">.</span><span class="ident" id="3491229">newRange</span><span class="op" id="3491237">(</span><span class="ident" id="3491238">b</span><span class="op" id="3491239">.</span><span class="ident" id="3491240">Pos</span><span class="op" id="3491243">,</span>&nbsp;<span class="ident" id="3491245">b</span><span class="op" id="3491246">.</span><span class="ident" id="3491247">Line</span><span class="op" id="3491251">,</span>&nbsp;<span class="ident" id="3491253">b</span><span class="op" id="3491254">.</span><span class="ident" id="3491255">Pipe</span><span class="op" id="3491259">,</span>&nbsp;<span class="ident" id="3491261">b</span><span class="op" id="3491262">.</span><span class="ident" id="3491263">List</span><span class="op" id="3491267">,</span>&nbsp;<span class="ident" id="3491269">b</span><span class="op" id="3491270">.</span><span class="ident" id="3491271">ElseList</span><span class="op" id="3491279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491282">case</span>&nbsp;<span class="ident" id="3491287">NodeWith</span><span class="op" id="3491295">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491299">return</span>&nbsp;<span class="ident" id="3491306">b</span><span class="op" id="3491307">.</span><span class="ident" id="3491308">tr</span><span class="op" id="3491310">.</span><span class="ident" id="3491311">newWith</span><span class="op" id="3491318">(</span><span class="ident" id="3491319">b</span><span class="op" id="3491320">.</span><span class="ident" id="3491321">Pos</span><span class="op" id="3491324">,</span>&nbsp;<span class="ident" id="3491326">b</span><span class="op" id="3491327">.</span><span class="ident" id="3491328">Line</span><span class="op" id="3491332">,</span>&nbsp;<span class="ident" id="3491334">b</span><span class="op" id="3491335">.</span><span class="ident" id="3491336">Pipe</span><span class="op" id="3491340">,</span>&nbsp;<span class="ident" id="3491342">b</span><span class="op" id="3491343">.</span><span class="ident" id="3491344">List</span><span class="op" id="3491348">,</span>&nbsp;<span class="ident" id="3491350">b</span><span class="op" id="3491351">.</span><span class="ident" id="3491352">ElseList</span><span class="op" id="3491360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491363">default</span><span class="op" id="3491370">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3491374">panic</span><span class="op" id="3491379">(</span><span class="string" id="3491380">&#34;unknown&nbsp;branch&nbsp;type&#34;</span><span class="op" id="3491401">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3491404">}</span><br>
<span class="lineno"></span><span class="op" id="3491406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3491409">//&nbsp;IfNode&nbsp;represents&nbsp;an&nbsp;{{if}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="3491465">type</span>&nbsp;<span class="ident" id="3491470">IfNode</span>&nbsp;<span class="keyword" id="3491477">struct</span>&nbsp;<span class="op" id="3491484">{</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3491487">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="3491498">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3491501">func</span>&nbsp;<span class="op" id="3491506">(</span><span class="ident" id="3491507">t</span>&nbsp;<span class="op" id="3491509">*</span><span class="ident" id="3491510">Tree</span><span class="op" id="3491514">)</span>&nbsp;<span class="ident" id="3491516">newIf</span><span class="op" id="3491521">(</span><span class="ident" id="3491522">pos</span>&nbsp;<span class="ident" id="3491526">Pos</span><span class="op" id="3491529">,</span>&nbsp;<span class="ident" id="3491531">line</span>&nbsp;<span class="builtintype" id="3491536">int</span><span class="op" id="3491539">,</span>&nbsp;<span class="ident" id="3491541">pipe</span>&nbsp;<span class="op" id="3491546">*</span><span class="ident" id="3491547">PipeNode</span><span class="op" id="3491555">,</span>&nbsp;<span class="ident" id="3491557">list</span><span class="op" id="3491561">,</span>&nbsp;<span class="ident" id="3491563">elseList</span>&nbsp;<span class="op" id="3491572">*</span><span class="ident" id="3491573">ListNode</span><span class="op" id="3491581">)</span>&nbsp;<span class="op" id="3491583">*</span><span class="ident" id="3491584">IfNode</span>&nbsp;<span class="op" id="3491591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491594">return</span>&nbsp;<span class="op" id="3491601">&amp;</span><span class="ident" id="3491602">IfNode</span><span class="op" id="3491608">{</span><span class="ident" id="3491609">BranchNode</span><span class="op" id="3491619">{</span><span class="ident" id="3491620">tr</span><span class="op" id="3491622">:</span>&nbsp;<span class="ident" id="3491624">t</span><span class="op" id="3491625">,</span>&nbsp;<span class="ident" id="3491627">NodeType</span><span class="op" id="3491635">:</span>&nbsp;<span class="ident" id="3491637">NodeIf</span><span class="op" id="3491643">,</span>&nbsp;<span class="ident" id="3491645">Pos</span><span class="op" id="3491648">:</span>&nbsp;<span class="ident" id="3491650">pos</span><span class="op" id="3491653">,</span>&nbsp;<span class="ident" id="3491655">Line</span><span class="op" id="3491659">:</span>&nbsp;<span class="ident" id="3491661">line</span><span class="op" id="3491665">,</span>&nbsp;<span class="ident" id="3491667">Pipe</span><span class="op" id="3491671">:</span>&nbsp;<span class="ident" id="3491673">pipe</span><span class="op" id="3491677">,</span>&nbsp;<span class="ident" id="3491679">List</span><span class="op" id="3491683">:</span>&nbsp;<span class="ident" id="3491685">list</span><span class="op" id="3491689">,</span>&nbsp;<span class="ident" id="3491691">ElseList</span><span class="op" id="3491699">:</span>&nbsp;<span class="ident" id="3491701">elseList</span><span class="op" id="3491709">}</span><span class="op" id="3491710">}</span><br>
<span class="lineno">775</span><span class="op" id="3491712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3491715">func</span>&nbsp;<span class="op" id="3491720">(</span><span class="ident" id="3491721">i</span>&nbsp;<span class="op" id="3491723">*</span><span class="ident" id="3491724">IfNode</span><span class="op" id="3491730">)</span>&nbsp;<span class="ident" id="3491732">Copy</span><span class="op" id="3491736">(</span><span class="op" id="3491737">)</span>&nbsp;<span class="ident" id="3491739">Node</span>&nbsp;<span class="op" id="3491744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3491747">return</span>&nbsp;<span class="ident" id="3491754">i</span><span class="op" id="3491755">.</span><span class="ident" id="3491756">tr</span><span class="op" id="3491758">.</span><span class="ident" id="3491759">newIf</span><span class="op" id="3491764">(</span><span class="ident" id="3491765">i</span><span class="op" id="3491766">.</span><span class="ident" id="3491767">Pos</span><span class="op" id="3491770">,</span>&nbsp;<span class="ident" id="3491772">i</span><span class="op" id="3491773">.</span><span class="ident" id="3491774">Line</span><span class="op" id="3491778">,</span>&nbsp;<span class="ident" id="3491780">i</span><span class="op" id="3491781">.</span><span class="ident" id="3491782">Pipe</span><span class="op" id="3491786">.</span><span class="ident" id="3491787">CopyPipe</span><span class="op" id="3491795">(</span><span class="op" id="3491796">)</span><span class="op" id="3491797">,</span>&nbsp;<span class="ident" id="3491799">i</span><span class="op" id="3491800">.</span><span class="ident" id="3491801">List</span><span class="op" id="3491805">.</span><span class="ident" id="3491806">CopyList</span><span class="op" id="3491814">(</span><span class="op" id="3491815">)</span><span class="op" id="3491816">,</span>&nbsp;<span class="ident" id="3491818">i</span><span class="op" id="3491819">.</span><span class="ident" id="3491820">ElseList</span><span class="op" id="3491828">.</span><span class="ident" id="3491829">CopyList</span><span class="op" id="3491837">(</span><span class="op" id="3491838">)</span><span class="op" id="3491839">)</span><br>
<span class="lineno"></span><span class="op" id="3491841">}</span><br>
<span class="lineno">780</span><br>
<span class="lineno"></span><span class="comment" id="3491844">//&nbsp;RangeNode&nbsp;represents&nbsp;a&nbsp;{{range}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno"></span><span class="keyword" id="3491905">type</span>&nbsp;<span class="ident" id="3491910">RangeNode</span>&nbsp;<span class="keyword" id="3491920">struct</span>&nbsp;<span class="op" id="3491927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3491930">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="3491941">}</span><br>
<span class="lineno">785</span><br>
<span class="lineno"></span><span class="keyword" id="3491944">func</span>&nbsp;<span class="op" id="3491949">(</span><span class="ident" id="3491950">t</span>&nbsp;<span class="op" id="3491952">*</span><span class="ident" id="3491953">Tree</span><span class="op" id="3491957">)</span>&nbsp;<span class="ident" id="3491959">newRange</span><span class="op" id="3491967">(</span><span class="ident" id="3491968">pos</span>&nbsp;<span class="ident" id="3491972">Pos</span><span class="op" id="3491975">,</span>&nbsp;<span class="ident" id="3491977">line</span>&nbsp;<span class="builtintype" id="3491982">int</span><span class="op" id="3491985">,</span>&nbsp;<span class="ident" id="3491987">pipe</span>&nbsp;<span class="op" id="3491992">*</span><span class="ident" id="3491993">PipeNode</span><span class="op" id="3492001">,</span>&nbsp;<span class="ident" id="3492003">list</span><span class="op" id="3492007">,</span>&nbsp;<span class="ident" id="3492009">elseList</span>&nbsp;<span class="op" id="3492018">*</span><span class="ident" id="3492019">ListNode</span><span class="op" id="3492027">)</span>&nbsp;<span class="op" id="3492029">*</span><span class="ident" id="3492030">RangeNode</span>&nbsp;<span class="op" id="3492040">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492043">return</span>&nbsp;<span class="op" id="3492050">&amp;</span><span class="ident" id="3492051">RangeNode</span><span class="op" id="3492060">{</span><span class="ident" id="3492061">BranchNode</span><span class="op" id="3492071">{</span><span class="ident" id="3492072">tr</span><span class="op" id="3492074">:</span>&nbsp;<span class="ident" id="3492076">t</span><span class="op" id="3492077">,</span>&nbsp;<span class="ident" id="3492079">NodeType</span><span class="op" id="3492087">:</span>&nbsp;<span class="ident" id="3492089">NodeRange</span><span class="op" id="3492098">,</span>&nbsp;<span class="ident" id="3492100">Pos</span><span class="op" id="3492103">:</span>&nbsp;<span class="ident" id="3492105">pos</span><span class="op" id="3492108">,</span>&nbsp;<span class="ident" id="3492110">Line</span><span class="op" id="3492114">:</span>&nbsp;<span class="ident" id="3492116">line</span><span class="op" id="3492120">,</span>&nbsp;<span class="ident" id="3492122">Pipe</span><span class="op" id="3492126">:</span>&nbsp;<span class="ident" id="3492128">pipe</span><span class="op" id="3492132">,</span>&nbsp;<span class="ident" id="3492134">List</span><span class="op" id="3492138">:</span>&nbsp;<span class="ident" id="3492140">list</span><span class="op" id="3492144">,</span>&nbsp;<span class="ident" id="3492146">ElseList</span><span class="op" id="3492154">:</span>&nbsp;<span class="ident" id="3492156">elseList</span><span class="op" id="3492164">}</span><span class="op" id="3492165">}</span><br>
<span class="lineno"></span><span class="op" id="3492167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">790</span><span class="keyword" id="3492170">func</span>&nbsp;<span class="op" id="3492175">(</span><span class="ident" id="3492176">r</span>&nbsp;<span class="op" id="3492178">*</span><span class="ident" id="3492179">RangeNode</span><span class="op" id="3492188">)</span>&nbsp;<span class="ident" id="3492190">Copy</span><span class="op" id="3492194">(</span><span class="op" id="3492195">)</span>&nbsp;<span class="ident" id="3492197">Node</span>&nbsp;<span class="op" id="3492202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492205">return</span>&nbsp;<span class="ident" id="3492212">r</span><span class="op" id="3492213">.</span><span class="ident" id="3492214">tr</span><span class="op" id="3492216">.</span><span class="ident" id="3492217">newRange</span><span class="op" id="3492225">(</span><span class="ident" id="3492226">r</span><span class="op" id="3492227">.</span><span class="ident" id="3492228">Pos</span><span class="op" id="3492231">,</span>&nbsp;<span class="ident" id="3492233">r</span><span class="op" id="3492234">.</span><span class="ident" id="3492235">Line</span><span class="op" id="3492239">,</span>&nbsp;<span class="ident" id="3492241">r</span><span class="op" id="3492242">.</span><span class="ident" id="3492243">Pipe</span><span class="op" id="3492247">.</span><span class="ident" id="3492248">CopyPipe</span><span class="op" id="3492256">(</span><span class="op" id="3492257">)</span><span class="op" id="3492258">,</span>&nbsp;<span class="ident" id="3492260">r</span><span class="op" id="3492261">.</span><span class="ident" id="3492262">List</span><span class="op" id="3492266">.</span><span class="ident" id="3492267">CopyList</span><span class="op" id="3492275">(</span><span class="op" id="3492276">)</span><span class="op" id="3492277">,</span>&nbsp;<span class="ident" id="3492279">r</span><span class="op" id="3492280">.</span><span class="ident" id="3492281">ElseList</span><span class="op" id="3492289">.</span><span class="ident" id="3492290">CopyList</span><span class="op" id="3492298">(</span><span class="op" id="3492299">)</span><span class="op" id="3492300">)</span><br>
<span class="lineno"></span><span class="op" id="3492302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3492305">//&nbsp;WithNode&nbsp;represents&nbsp;a&nbsp;{{with}}&nbsp;action&nbsp;and&nbsp;its&nbsp;commands.</span><br>
<span class="lineno">795</span><span class="keyword" id="3492364">type</span>&nbsp;<span class="ident" id="3492369">WithNode</span>&nbsp;<span class="keyword" id="3492378">struct</span>&nbsp;<span class="op" id="3492385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3492388">BranchNode</span><br>
<span class="lineno"></span><span class="op" id="3492399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3492402">func</span>&nbsp;<span class="op" id="3492407">(</span><span class="ident" id="3492408">t</span>&nbsp;<span class="op" id="3492410">*</span><span class="ident" id="3492411">Tree</span><span class="op" id="3492415">)</span>&nbsp;<span class="ident" id="3492417">newWith</span><span class="op" id="3492424">(</span><span class="ident" id="3492425">pos</span>&nbsp;<span class="ident" id="3492429">Pos</span><span class="op" id="3492432">,</span>&nbsp;<span class="ident" id="3492434">line</span>&nbsp;<span class="builtintype" id="3492439">int</span><span class="op" id="3492442">,</span>&nbsp;<span class="ident" id="3492444">pipe</span>&nbsp;<span class="op" id="3492449">*</span><span class="ident" id="3492450">PipeNode</span><span class="op" id="3492458">,</span>&nbsp;<span class="ident" id="3492460">list</span><span class="op" id="3492464">,</span>&nbsp;<span class="ident" id="3492466">elseList</span>&nbsp;<span class="op" id="3492475">*</span><span class="ident" id="3492476">ListNode</span><span class="op" id="3492484">)</span>&nbsp;<span class="op" id="3492486">*</span><span class="ident" id="3492487">WithNode</span>&nbsp;<span class="op" id="3492496">{</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492499">return</span>&nbsp;<span class="op" id="3492506">&amp;</span><span class="ident" id="3492507">WithNode</span><span class="op" id="3492515">{</span><span class="ident" id="3492516">BranchNode</span><span class="op" id="3492526">{</span><span class="ident" id="3492527">tr</span><span class="op" id="3492529">:</span>&nbsp;<span class="ident" id="3492531">t</span><span class="op" id="3492532">,</span>&nbsp;<span class="ident" id="3492534">NodeType</span><span class="op" id="3492542">:</span>&nbsp;<span class="ident" id="3492544">NodeWith</span><span class="op" id="3492552">,</span>&nbsp;<span class="ident" id="3492554">Pos</span><span class="op" id="3492557">:</span>&nbsp;<span class="ident" id="3492559">pos</span><span class="op" id="3492562">,</span>&nbsp;<span class="ident" id="3492564">Line</span><span class="op" id="3492568">:</span>&nbsp;<span class="ident" id="3492570">line</span><span class="op" id="3492574">,</span>&nbsp;<span class="ident" id="3492576">Pipe</span><span class="op" id="3492580">:</span>&nbsp;<span class="ident" id="3492582">pipe</span><span class="op" id="3492586">,</span>&nbsp;<span class="ident" id="3492588">List</span><span class="op" id="3492592">:</span>&nbsp;<span class="ident" id="3492594">list</span><span class="op" id="3492598">,</span>&nbsp;<span class="ident" id="3492600">ElseList</span><span class="op" id="3492608">:</span>&nbsp;<span class="ident" id="3492610">elseList</span><span class="op" id="3492618">}</span><span class="op" id="3492619">}</span><br>
<span class="lineno"></span><span class="op" id="3492621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3492624">func</span>&nbsp;<span class="op" id="3492629">(</span><span class="ident" id="3492630">w</span>&nbsp;<span class="op" id="3492632">*</span><span class="ident" id="3492633">WithNode</span><span class="op" id="3492641">)</span>&nbsp;<span class="ident" id="3492643">Copy</span><span class="op" id="3492647">(</span><span class="op" id="3492648">)</span>&nbsp;<span class="ident" id="3492650">Node</span>&nbsp;<span class="op" id="3492655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3492658">return</span>&nbsp;<span class="ident" id="3492665">w</span><span class="op" id="3492666">.</span><span class="ident" id="3492667">tr</span><span class="op" id="3492669">.</span><span class="ident" id="3492670">newWith</span><span class="op" id="3492677">(</span><span class="ident" id="3492678">w</span><span class="op" id="3492679">.</span><span class="ident" id="3492680">Pos</span><span class="op" id="3492683">,</span>&nbsp;<span class="ident" id="3492685">w</span><span class="op" id="3492686">.</span><span class="ident" id="3492687">Line</span><span class="op" id="3492691">,</span>&nbsp;<span class="ident" id="3492693">w</span><span class="op" id="3492694">.</span><span class="ident" id="3492695">Pipe</span><span class="op" id="3492699">.</span><span class="ident" id="3492700">CopyPipe</span><span class="op" id="3492708">(</span><span class="op" id="3492709">)</span><span class="op" id="3492710">,</span>&nbsp;<span class="ident" id="3492712">w</span><span class="op" id="3492713">.</span><span class="ident" id="3492714">List</span><span class="op" id="3492718">.</span><span class="ident" id="3492719">CopyList</span><span class="op" id="3492727">(</span><span class="op" id="3492728">)</span><span class="op" id="3492729">,</span>&nbsp;<span class="ident" id="3492731">w</span><span class="op" id="3492732">.</span><span class="ident" id="3492733">ElseList</span><span class="op" id="3492741">.</span><span class="ident" id="3492742">CopyList</span><span class="op" id="3492750">(</span><span class="op" id="3492751">)</span><span class="op" id="3492752">)</span><br>
<span class="lineno">805</span><span class="op" id="3492754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3492757">//&nbsp;TemplateNode&nbsp;represents&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="3492807">type</span>&nbsp;<span class="ident" id="3492812">TemplateNode</span>&nbsp;<span class="keyword" id="3492825">struct</span>&nbsp;<span class="op" id="3492832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3492835">NodeType</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3492845">Pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3492850">tr</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3492855">*</span><span class="ident" id="3492856">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3492862">Line</span>&nbsp;<span class="builtintype" id="3492867">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3492877">//&nbsp;The&nbsp;line&nbsp;number&nbsp;in&nbsp;the&nbsp;input&nbsp;(deprecated;&nbsp;kept&nbsp;for&nbsp;compatibility)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3492947">Name</span>&nbsp;<span class="builtintype" id="3492952">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3492962">//&nbsp;The&nbsp;name&nbsp;of&nbsp;the&nbsp;template&nbsp;(unquoted).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3493003">Pipe</span>&nbsp;<span class="op" id="3493008">*</span><span class="ident" id="3493009">PipeNode</span>&nbsp;<span class="comment" id="3493018">//&nbsp;The&nbsp;command&nbsp;to&nbsp;evaluate&nbsp;as&nbsp;dot&nbsp;for&nbsp;the&nbsp;template.</span><br>
<span class="lineno">815</span><span class="op" id="3493070">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3493073">func</span>&nbsp;<span class="op" id="3493078">(</span><span class="ident" id="3493079">t</span>&nbsp;<span class="op" id="3493081">*</span><span class="ident" id="3493082">Tree</span><span class="op" id="3493086">)</span>&nbsp;<span class="ident" id="3493088">newTemplate</span><span class="op" id="3493099">(</span><span class="ident" id="3493100">pos</span>&nbsp;<span class="ident" id="3493104">Pos</span><span class="op" id="3493107">,</span>&nbsp;<span class="ident" id="3493109">line</span>&nbsp;<span class="builtintype" id="3493114">int</span><span class="op" id="3493117">,</span>&nbsp;<span class="ident" id="3493119">name</span>&nbsp;<span class="builtintype" id="3493124">string</span><span class="op" id="3493130">,</span>&nbsp;<span class="ident" id="3493132">pipe</span>&nbsp;<span class="op" id="3493137">*</span><span class="ident" id="3493138">PipeNode</span><span class="op" id="3493146">)</span>&nbsp;<span class="op" id="3493148">*</span><span class="ident" id="3493149">TemplateNode</span>&nbsp;<span class="op" id="3493162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493165">return</span>&nbsp;<span class="op" id="3493172">&amp;</span><span class="ident" id="3493173">TemplateNode</span><span class="op" id="3493185">{</span><span class="ident" id="3493186">tr</span><span class="op" id="3493188">:</span>&nbsp;<span class="ident" id="3493190">t</span><span class="op" id="3493191">,</span>&nbsp;<span class="ident" id="3493193">NodeType</span><span class="op" id="3493201">:</span>&nbsp;<span class="ident" id="3493203">NodeTemplate</span><span class="op" id="3493215">,</span>&nbsp;<span class="ident" id="3493217">Pos</span><span class="op" id="3493220">:</span>&nbsp;<span class="ident" id="3493222">pos</span><span class="op" id="3493225">,</span>&nbsp;<span class="ident" id="3493227">Line</span><span class="op" id="3493231">:</span>&nbsp;<span class="ident" id="3493233">line</span><span class="op" id="3493237">,</span>&nbsp;<span class="ident" id="3493239">Name</span><span class="op" id="3493243">:</span>&nbsp;<span class="ident" id="3493245">name</span><span class="op" id="3493249">,</span>&nbsp;<span class="ident" id="3493251">Pipe</span><span class="op" id="3493255">:</span>&nbsp;<span class="ident" id="3493257">pipe</span><span class="op" id="3493261">}</span><br>
<span class="lineno"></span><span class="op" id="3493263">}</span><br>
<span class="lineno">820</span><br>
<span class="lineno"></span><span class="keyword" id="3493266">func</span>&nbsp;<span class="op" id="3493271">(</span><span class="ident" id="3493272">t</span>&nbsp;<span class="op" id="3493274">*</span><span class="ident" id="3493275">TemplateNode</span><span class="op" id="3493287">)</span>&nbsp;<span class="ident" id="3493289">String</span><span class="op" id="3493295">(</span><span class="op" id="3493296">)</span>&nbsp;<span class="builtintype" id="3493298">string</span>&nbsp;<span class="op" id="3493305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493308">if</span>&nbsp;<span class="ident" id="3493311">t</span><span class="op" id="3493312">.</span><span class="ident" id="3493313">Pipe</span>&nbsp;<span class="op" id="3493318">==</span>&nbsp;<span class="ident" id="3493321">nil</span>&nbsp;<span class="op" id="3493325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493329">return</span>&nbsp;<span class="ident" id="3493336">fmt</span><span class="op" id="3493339">.</span><span class="ident" id="3493340">Sprintf</span><span class="op" id="3493347">(</span><span class="string" id="3493348">&#34;{{template&nbsp;%q}}&#34;</span><span class="op" id="3493365">,</span>&nbsp;<span class="ident" id="3493367">t</span><span class="op" id="3493368">.</span><span class="ident" id="3493369">Name</span><span class="op" id="3493373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3493376">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493379">return</span>&nbsp;<span class="ident" id="3493386">fmt</span><span class="op" id="3493389">.</span><span class="ident" id="3493390">Sprintf</span><span class="op" id="3493397">(</span><span class="string" id="3493398">&#34;{{template&nbsp;%q&nbsp;%s}}&#34;</span><span class="op" id="3493418">,</span>&nbsp;<span class="ident" id="3493420">t</span><span class="op" id="3493421">.</span><span class="ident" id="3493422">Name</span><span class="op" id="3493426">,</span>&nbsp;<span class="ident" id="3493428">t</span><span class="op" id="3493429">.</span><span class="ident" id="3493430">Pipe</span><span class="op" id="3493434">)</span><br>
<span class="lineno"></span><span class="op" id="3493436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3493439">func</span>&nbsp;<span class="op" id="3493444">(</span><span class="ident" id="3493445">t</span>&nbsp;<span class="op" id="3493447">*</span><span class="ident" id="3493448">TemplateNode</span><span class="op" id="3493460">)</span>&nbsp;<span class="ident" id="3493462">tree</span><span class="op" id="3493466">(</span><span class="op" id="3493467">)</span>&nbsp;<span class="op" id="3493469">*</span><span class="ident" id="3493470">Tree</span>&nbsp;<span class="op" id="3493475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493478">return</span>&nbsp;<span class="ident" id="3493485">t</span><span class="op" id="3493486">.</span><span class="ident" id="3493487">tr</span><br>
<span class="lineno">830</span><span class="op" id="3493490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3493493">func</span>&nbsp;<span class="op" id="3493498">(</span><span class="ident" id="3493499">t</span>&nbsp;<span class="op" id="3493501">*</span><span class="ident" id="3493502">TemplateNode</span><span class="op" id="3493514">)</span>&nbsp;<span class="ident" id="3493516">Copy</span><span class="op" id="3493520">(</span><span class="op" id="3493521">)</span>&nbsp;<span class="ident" id="3493523">Node</span>&nbsp;<span class="op" id="3493528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3493531">return</span>&nbsp;<span class="ident" id="3493538">t</span><span class="op" id="3493539">.</span><span class="ident" id="3493540">tr</span><span class="op" id="3493542">.</span><span class="ident" id="3493543">newTemplate</span><span class="op" id="3493554">(</span><span class="ident" id="3493555">t</span><span class="op" id="3493556">.</span><span class="ident" id="3493557">Pos</span><span class="op" id="3493560">,</span>&nbsp;<span class="ident" id="3493562">t</span><span class="op" id="3493563">.</span><span class="ident" id="3493564">Line</span><span class="op" id="3493568">,</span>&nbsp;<span class="ident" id="3493570">t</span><span class="op" id="3493571">.</span><span class="ident" id="3493572">Name</span><span class="op" id="3493576">,</span>&nbsp;<span class="ident" id="3493578">t</span><span class="op" id="3493579">.</span><span class="ident" id="3493580">Pipe</span><span class="op" id="3493584">.</span><span class="ident" id="3493585">CopyPipe</span><span class="op" id="3493593">(</span><span class="op" id="3493594">)</span><span class="op" id="3493595">)</span><br>
<span class="lineno"></span><span class="op" id="3493597">}</span>
</div>
</body>
</html>
