<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/xml</h2>
<ul>
<li><a href="/gostd/encoding/xml/atom_test.go.html">atom_test.go</a></li>
<li><a href="/gostd/encoding/xml/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/xml/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/xml/marshal_test.go.html">marshal_test.go</a></li>
<li><a href="/gostd/encoding/xml/read.go.html">read.go</a></li>
<li><a href="/gostd/encoding/xml/read_test.go.html">read_test.go</a></li>
<li><a href="/gostd/encoding/xml/typeinfo.go.html">typeinfo.go</a></li>
<li><a href="/gostd/encoding/xml/xml.go.html">xml.go</a></li>
<li><a href="/gostd/encoding/xml/xml_test.go.html" class="current">xml_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6770826">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6770882">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6770936">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6770987">package</span>&nbsp;<span class="ident" id="6770995">xml</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6771000">import</span>&nbsp;<span class="op" id="6771007">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6771010">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6771019">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6771026">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6771032">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6771043">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6771054">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6771065">&#34;unicode/utf8&#34;</span><br>
<span class="lineno">15</span><span class="op" id="6771080">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6771083">const</span>&nbsp;<span class="ident" id="6771089">testInput</span>&nbsp;<span class="op" id="6771099">=</span>&nbsp;<span class="string" id="6771101">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;?&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno">20</span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;&gt;<br>
<span class="lineno"></span>&lt;body&nbsp;xmlns:foo=&#34;ns1&#34;&nbsp;xmlns=&#34;ns2&#34;&nbsp;xmlns:tag=&#34;ns3&#34;&nbsp;`</span>&nbsp;<span class="op" id="6771318">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6771321">&#34;\r\n\t&#34;</span>&nbsp;<span class="op" id="6771330">+</span>&nbsp;<span class="string" id="6771332">`&nbsp;&nbsp;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;hello&nbsp;lang=&#34;en&#34;&gt;World&nbsp;&amp;lt;&amp;gt;&amp;apos;&amp;quot;&nbsp;&amp;#x767d;&amp;#40300;翔&lt;/hello&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;query&gt;&amp;何;&nbsp;&amp;is-it;&lt;/query&gt;<br>
<span class="lineno">25</span>&nbsp;&nbsp;&lt;goodbye&nbsp;/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;outer&nbsp;foo:attr=&#34;value&#34;&nbsp;xmlns:tag=&#34;ns4&#34;&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;inner/&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/outer&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;tag:name&gt;<br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;![CDATA[Some&nbsp;text&nbsp;here.]]&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&lt;/tag:name&gt;<br>
<span class="lineno"></span>&lt;/body&gt;&lt;!--&nbsp;missing&nbsp;final&nbsp;newline&nbsp;--&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6771622">var</span>&nbsp;<span class="ident" id="6771626">testEntity</span>&nbsp;<span class="op" id="6771637">=</span>&nbsp;<span class="keyword" id="6771639">map</span><span class="op" id="6771642">[</span><span class="builtintype" id="6771643">string</span><span class="op" id="6771649">]</span><span class="builtintype" id="6771650">string</span><span class="op" id="6771656">{</span><span class="string" id="6771657">&#34;何&#34;</span><span class="op" id="6771662">:</span>&nbsp;<span class="string" id="6771664">&#34;What&#34;</span><span class="op" id="6771670">,</span>&nbsp;<span class="string" id="6771672">&#34;is-it&#34;</span><span class="op" id="6771679">:</span>&nbsp;<span class="string" id="6771681">&#34;is&nbsp;it?&#34;</span><span class="op" id="6771689">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="6771692">var</span>&nbsp;<span class="ident" id="6771696">rawTokens</span>&nbsp;<span class="op" id="6771706">=</span>&nbsp;<span class="op" id="6771708">[</span><span class="op" id="6771709">]</span><span class="ident" id="6771710">Token</span><span class="op" id="6771715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6771718">CharData</span><span class="op" id="6771726">(</span><span class="string" id="6771727">&#34;\n&#34;</span><span class="op" id="6771731">)</span><span class="op" id="6771732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6771735">ProcInst</span><span class="op" id="6771743">{</span><span class="string" id="6771744">&#34;xml&#34;</span><span class="op" id="6771749">,</span>&nbsp;<span class="op" id="6771751">[</span><span class="op" id="6771752">]</span><span class="builtintype" id="6771753">byte</span><span class="op" id="6771757">(</span><span class="string" id="6771758">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="6771790">)</span><span class="op" id="6771791">}</span><span class="op" id="6771792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6771795">CharData</span><span class="op" id="6771803">(</span><span class="string" id="6771804">&#34;\n&#34;</span><span class="op" id="6771808">)</span><span class="op" id="6771809">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6771812">Directive</span><span class="op" id="6771821">(</span><span class="string" id="6771822">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="6771944">)</span><span class="op" id="6771945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6771948">CharData</span><span class="op" id="6771956">(</span><span class="string" id="6771957">&#34;\n&#34;</span><span class="op" id="6771961">)</span><span class="op" id="6771962">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6771965">StartElement</span><span class="op" id="6771977">{</span><span class="ident" id="6771978">Name</span><span class="op" id="6771982">{</span><span class="string" id="6771983">&#34;&#34;</span><span class="op" id="6771985">,</span>&nbsp;<span class="string" id="6771987">&#34;body&#34;</span><span class="op" id="6771993">}</span><span class="op" id="6771994">,</span>&nbsp;<span class="op" id="6771996">[</span><span class="op" id="6771997">]</span><span class="ident" id="6771998">Attr</span><span class="op" id="6772002">{</span><span class="op" id="6772003">{</span><span class="ident" id="6772004">Name</span><span class="op" id="6772008">{</span><span class="string" id="6772009">&#34;xmlns&#34;</span><span class="op" id="6772016">,</span>&nbsp;<span class="string" id="6772018">&#34;foo&#34;</span><span class="op" id="6772023">}</span><span class="op" id="6772024">,</span>&nbsp;<span class="string" id="6772026">&#34;ns1&#34;</span><span class="op" id="6772031">}</span><span class="op" id="6772032">,</span>&nbsp;<span class="op" id="6772034">{</span><span class="ident" id="6772035">Name</span><span class="op" id="6772039">{</span><span class="string" id="6772040">&#34;&#34;</span><span class="op" id="6772042">,</span>&nbsp;<span class="string" id="6772044">&#34;xmlns&#34;</span><span class="op" id="6772051">}</span><span class="op" id="6772052">,</span>&nbsp;<span class="string" id="6772054">&#34;ns2&#34;</span><span class="op" id="6772059">}</span><span class="op" id="6772060">,</span>&nbsp;<span class="op" id="6772062">{</span><span class="ident" id="6772063">Name</span><span class="op" id="6772067">{</span><span class="string" id="6772068">&#34;xmlns&#34;</span><span class="op" id="6772075">,</span>&nbsp;<span class="string" id="6772077">&#34;tag&#34;</span><span class="op" id="6772082">}</span><span class="op" id="6772083">,</span>&nbsp;<span class="string" id="6772085">&#34;ns3&#34;</span><span class="op" id="6772090">}</span><span class="op" id="6772091">}</span><span class="op" id="6772092">}</span><span class="op" id="6772093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772096">CharData</span><span class="op" id="6772104">(</span><span class="string" id="6772105">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6772111">)</span><span class="op" id="6772112">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772115">StartElement</span><span class="op" id="6772127">{</span><span class="ident" id="6772128">Name</span><span class="op" id="6772132">{</span><span class="string" id="6772133">&#34;&#34;</span><span class="op" id="6772135">,</span>&nbsp;<span class="string" id="6772137">&#34;hello&#34;</span><span class="op" id="6772144">}</span><span class="op" id="6772145">,</span>&nbsp;<span class="op" id="6772147">[</span><span class="op" id="6772148">]</span><span class="ident" id="6772149">Attr</span><span class="op" id="6772153">{</span><span class="op" id="6772154">{</span><span class="ident" id="6772155">Name</span><span class="op" id="6772159">{</span><span class="string" id="6772160">&#34;&#34;</span><span class="op" id="6772162">,</span>&nbsp;<span class="string" id="6772164">&#34;lang&#34;</span><span class="op" id="6772170">}</span><span class="op" id="6772171">,</span>&nbsp;<span class="string" id="6772173">&#34;en&#34;</span><span class="op" id="6772177">}</span><span class="op" id="6772178">}</span><span class="op" id="6772179">}</span><span class="op" id="6772180">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772183">CharData</span><span class="op" id="6772191">(</span><span class="string" id="6772192">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="6772215">)</span><span class="op" id="6772216">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772219">EndElement</span><span class="op" id="6772229">{</span><span class="ident" id="6772230">Name</span><span class="op" id="6772234">{</span><span class="string" id="6772235">&#34;&#34;</span><span class="op" id="6772237">,</span>&nbsp;<span class="string" id="6772239">&#34;hello&#34;</span><span class="op" id="6772246">}</span><span class="op" id="6772247">}</span><span class="op" id="6772248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772251">CharData</span><span class="op" id="6772259">(</span><span class="string" id="6772260">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6772266">)</span><span class="op" id="6772267">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772270">StartElement</span><span class="op" id="6772282">{</span><span class="ident" id="6772283">Name</span><span class="op" id="6772287">{</span><span class="string" id="6772288">&#34;&#34;</span><span class="op" id="6772290">,</span>&nbsp;<span class="string" id="6772292">&#34;query&#34;</span><span class="op" id="6772299">}</span><span class="op" id="6772300">,</span>&nbsp;<span class="op" id="6772302">[</span><span class="op" id="6772303">]</span><span class="ident" id="6772304">Attr</span><span class="op" id="6772308">{</span><span class="op" id="6772309">}</span><span class="op" id="6772310">}</span><span class="op" id="6772311">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772314">CharData</span><span class="op" id="6772322">(</span><span class="string" id="6772323">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="6772336">)</span><span class="op" id="6772337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772340">EndElement</span><span class="op" id="6772350">{</span><span class="ident" id="6772351">Name</span><span class="op" id="6772355">{</span><span class="string" id="6772356">&#34;&#34;</span><span class="op" id="6772358">,</span>&nbsp;<span class="string" id="6772360">&#34;query&#34;</span><span class="op" id="6772367">}</span><span class="op" id="6772368">}</span><span class="op" id="6772369">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772372">CharData</span><span class="op" id="6772380">(</span><span class="string" id="6772381">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6772387">)</span><span class="op" id="6772388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772391">StartElement</span><span class="op" id="6772403">{</span><span class="ident" id="6772404">Name</span><span class="op" id="6772408">{</span><span class="string" id="6772409">&#34;&#34;</span><span class="op" id="6772411">,</span>&nbsp;<span class="string" id="6772413">&#34;goodbye&#34;</span><span class="op" id="6772422">}</span><span class="op" id="6772423">,</span>&nbsp;<span class="op" id="6772425">[</span><span class="op" id="6772426">]</span><span class="ident" id="6772427">Attr</span><span class="op" id="6772431">{</span><span class="op" id="6772432">}</span><span class="op" id="6772433">}</span><span class="op" id="6772434">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772437">EndElement</span><span class="op" id="6772447">{</span><span class="ident" id="6772448">Name</span><span class="op" id="6772452">{</span><span class="string" id="6772453">&#34;&#34;</span><span class="op" id="6772455">,</span>&nbsp;<span class="string" id="6772457">&#34;goodbye&#34;</span><span class="op" id="6772466">}</span><span class="op" id="6772467">}</span><span class="op" id="6772468">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772471">CharData</span><span class="op" id="6772479">(</span><span class="string" id="6772480">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6772486">)</span><span class="op" id="6772487">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772490">StartElement</span><span class="op" id="6772502">{</span><span class="ident" id="6772503">Name</span><span class="op" id="6772507">{</span><span class="string" id="6772508">&#34;&#34;</span><span class="op" id="6772510">,</span>&nbsp;<span class="string" id="6772512">&#34;outer&#34;</span><span class="op" id="6772519">}</span><span class="op" id="6772520">,</span>&nbsp;<span class="op" id="6772522">[</span><span class="op" id="6772523">]</span><span class="ident" id="6772524">Attr</span><span class="op" id="6772528">{</span><span class="op" id="6772529">{</span><span class="ident" id="6772530">Name</span><span class="op" id="6772534">{</span><span class="string" id="6772535">&#34;foo&#34;</span><span class="op" id="6772540">,</span>&nbsp;<span class="string" id="6772542">&#34;attr&#34;</span><span class="op" id="6772548">}</span><span class="op" id="6772549">,</span>&nbsp;<span class="string" id="6772551">&#34;value&#34;</span><span class="op" id="6772558">}</span><span class="op" id="6772559">,</span>&nbsp;<span class="op" id="6772561">{</span><span class="ident" id="6772562">Name</span><span class="op" id="6772566">{</span><span class="string" id="6772567">&#34;xmlns&#34;</span><span class="op" id="6772574">,</span>&nbsp;<span class="string" id="6772576">&#34;tag&#34;</span><span class="op" id="6772581">}</span><span class="op" id="6772582">,</span>&nbsp;<span class="string" id="6772584">&#34;ns4&#34;</span><span class="op" id="6772589">}</span><span class="op" id="6772590">}</span><span class="op" id="6772591">}</span><span class="op" id="6772592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772595">CharData</span><span class="op" id="6772603">(</span><span class="string" id="6772604">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="6772612">)</span><span class="op" id="6772613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772616">StartElement</span><span class="op" id="6772628">{</span><span class="ident" id="6772629">Name</span><span class="op" id="6772633">{</span><span class="string" id="6772634">&#34;&#34;</span><span class="op" id="6772636">,</span>&nbsp;<span class="string" id="6772638">&#34;inner&#34;</span><span class="op" id="6772645">}</span><span class="op" id="6772646">,</span>&nbsp;<span class="op" id="6772648">[</span><span class="op" id="6772649">]</span><span class="ident" id="6772650">Attr</span><span class="op" id="6772654">{</span><span class="op" id="6772655">}</span><span class="op" id="6772656">}</span><span class="op" id="6772657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772660">EndElement</span><span class="op" id="6772670">{</span><span class="ident" id="6772671">Name</span><span class="op" id="6772675">{</span><span class="string" id="6772676">&#34;&#34;</span><span class="op" id="6772678">,</span>&nbsp;<span class="string" id="6772680">&#34;inner&#34;</span><span class="op" id="6772687">}</span><span class="op" id="6772688">}</span><span class="op" id="6772689">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772692">CharData</span><span class="op" id="6772700">(</span><span class="string" id="6772701">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6772707">)</span><span class="op" id="6772708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772711">EndElement</span><span class="op" id="6772721">{</span><span class="ident" id="6772722">Name</span><span class="op" id="6772726">{</span><span class="string" id="6772727">&#34;&#34;</span><span class="op" id="6772729">,</span>&nbsp;<span class="string" id="6772731">&#34;outer&#34;</span><span class="op" id="6772738">}</span><span class="op" id="6772739">}</span><span class="op" id="6772740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772743">CharData</span><span class="op" id="6772751">(</span><span class="string" id="6772752">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6772758">)</span><span class="op" id="6772759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772762">StartElement</span><span class="op" id="6772774">{</span><span class="ident" id="6772775">Name</span><span class="op" id="6772779">{</span><span class="string" id="6772780">&#34;tag&#34;</span><span class="op" id="6772785">,</span>&nbsp;<span class="string" id="6772787">&#34;name&#34;</span><span class="op" id="6772793">}</span><span class="op" id="6772794">,</span>&nbsp;<span class="op" id="6772796">[</span><span class="op" id="6772797">]</span><span class="ident" id="6772798">Attr</span><span class="op" id="6772802">{</span><span class="op" id="6772803">}</span><span class="op" id="6772804">}</span><span class="op" id="6772805">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772808">CharData</span><span class="op" id="6772816">(</span><span class="string" id="6772817">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="6772825">)</span><span class="op" id="6772826">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772829">CharData</span><span class="op" id="6772837">(</span><span class="string" id="6772838">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="6772855">)</span><span class="op" id="6772856">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772859">CharData</span><span class="op" id="6772867">(</span><span class="string" id="6772868">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6772874">)</span><span class="op" id="6772875">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772878">EndElement</span><span class="op" id="6772888">{</span><span class="ident" id="6772889">Name</span><span class="op" id="6772893">{</span><span class="string" id="6772894">&#34;tag&#34;</span><span class="op" id="6772899">,</span>&nbsp;<span class="string" id="6772901">&#34;name&#34;</span><span class="op" id="6772907">}</span><span class="op" id="6772908">}</span><span class="op" id="6772909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772912">CharData</span><span class="op" id="6772920">(</span><span class="string" id="6772921">&#34;\n&#34;</span><span class="op" id="6772925">)</span><span class="op" id="6772926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772929">EndElement</span><span class="op" id="6772939">{</span><span class="ident" id="6772940">Name</span><span class="op" id="6772944">{</span><span class="string" id="6772945">&#34;&#34;</span><span class="op" id="6772947">,</span>&nbsp;<span class="string" id="6772949">&#34;body&#34;</span><span class="op" id="6772955">}</span><span class="op" id="6772956">}</span><span class="op" id="6772957">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6772960">Comment</span><span class="op" id="6772967">(</span><span class="string" id="6772968">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="6772993">)</span><span class="op" id="6772994">,</span><br>
<span class="lineno"></span><span class="op" id="6772996">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6772999">var</span>&nbsp;<span class="ident" id="6773003">cookedTokens</span>&nbsp;<span class="op" id="6773016">=</span>&nbsp;<span class="op" id="6773018">[</span><span class="op" id="6773019">]</span><span class="ident" id="6773020">Token</span><span class="op" id="6773025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773028">CharData</span><span class="op" id="6773036">(</span><span class="string" id="6773037">&#34;\n&#34;</span><span class="op" id="6773041">)</span><span class="op" id="6773042">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773045">ProcInst</span><span class="op" id="6773053">{</span><span class="string" id="6773054">&#34;xml&#34;</span><span class="op" id="6773059">,</span>&nbsp;<span class="op" id="6773061">[</span><span class="op" id="6773062">]</span><span class="builtintype" id="6773063">byte</span><span class="op" id="6773067">(</span><span class="string" id="6773068">`version=&#34;1.0&#34;&nbsp;encoding=&#34;UTF-8&#34;`</span><span class="op" id="6773100">)</span><span class="op" id="6773101">}</span><span class="op" id="6773102">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773105">CharData</span><span class="op" id="6773113">(</span><span class="string" id="6773114">&#34;\n&#34;</span><span class="op" id="6773118">)</span><span class="op" id="6773119">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773122">Directive</span><span class="op" id="6773131">(</span><span class="string" id="6773132">`DOCTYPE&nbsp;html&nbsp;PUBLIC&nbsp;&#34;-//W3C//DTD&nbsp;XHTML&nbsp;1.0&nbsp;Transitional//EN&#34;<br>
<span class="lineno"></span>&nbsp;&nbsp;&#34;http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd&#34;`</span><span class="op" id="6773254">)</span><span class="op" id="6773255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773258">CharData</span><span class="op" id="6773266">(</span><span class="string" id="6773267">&#34;\n&#34;</span><span class="op" id="6773271">)</span><span class="op" id="6773272">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773275">StartElement</span><span class="op" id="6773287">{</span><span class="ident" id="6773288">Name</span><span class="op" id="6773292">{</span><span class="string" id="6773293">&#34;ns2&#34;</span><span class="op" id="6773298">,</span>&nbsp;<span class="string" id="6773300">&#34;body&#34;</span><span class="op" id="6773306">}</span><span class="op" id="6773307">,</span>&nbsp;<span class="op" id="6773309">[</span><span class="op" id="6773310">]</span><span class="ident" id="6773311">Attr</span><span class="op" id="6773315">{</span><span class="op" id="6773316">{</span><span class="ident" id="6773317">Name</span><span class="op" id="6773321">{</span><span class="string" id="6773322">&#34;xmlns&#34;</span><span class="op" id="6773329">,</span>&nbsp;<span class="string" id="6773331">&#34;foo&#34;</span><span class="op" id="6773336">}</span><span class="op" id="6773337">,</span>&nbsp;<span class="string" id="6773339">&#34;ns1&#34;</span><span class="op" id="6773344">}</span><span class="op" id="6773345">,</span>&nbsp;<span class="op" id="6773347">{</span><span class="ident" id="6773348">Name</span><span class="op" id="6773352">{</span><span class="string" id="6773353">&#34;&#34;</span><span class="op" id="6773355">,</span>&nbsp;<span class="string" id="6773357">&#34;xmlns&#34;</span><span class="op" id="6773364">}</span><span class="op" id="6773365">,</span>&nbsp;<span class="string" id="6773367">&#34;ns2&#34;</span><span class="op" id="6773372">}</span><span class="op" id="6773373">,</span>&nbsp;<span class="op" id="6773375">{</span><span class="ident" id="6773376">Name</span><span class="op" id="6773380">{</span><span class="string" id="6773381">&#34;xmlns&#34;</span><span class="op" id="6773388">,</span>&nbsp;<span class="string" id="6773390">&#34;tag&#34;</span><span class="op" id="6773395">}</span><span class="op" id="6773396">,</span>&nbsp;<span class="string" id="6773398">&#34;ns3&#34;</span><span class="op" id="6773403">}</span><span class="op" id="6773404">}</span><span class="op" id="6773405">}</span><span class="op" id="6773406">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773409">CharData</span><span class="op" id="6773417">(</span><span class="string" id="6773418">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6773424">)</span><span class="op" id="6773425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773428">StartElement</span><span class="op" id="6773440">{</span><span class="ident" id="6773441">Name</span><span class="op" id="6773445">{</span><span class="string" id="6773446">&#34;ns2&#34;</span><span class="op" id="6773451">,</span>&nbsp;<span class="string" id="6773453">&#34;hello&#34;</span><span class="op" id="6773460">}</span><span class="op" id="6773461">,</span>&nbsp;<span class="op" id="6773463">[</span><span class="op" id="6773464">]</span><span class="ident" id="6773465">Attr</span><span class="op" id="6773469">{</span><span class="op" id="6773470">{</span><span class="ident" id="6773471">Name</span><span class="op" id="6773475">{</span><span class="string" id="6773476">&#34;&#34;</span><span class="op" id="6773478">,</span>&nbsp;<span class="string" id="6773480">&#34;lang&#34;</span><span class="op" id="6773486">}</span><span class="op" id="6773487">,</span>&nbsp;<span class="string" id="6773489">&#34;en&#34;</span><span class="op" id="6773493">}</span><span class="op" id="6773494">}</span><span class="op" id="6773495">}</span><span class="op" id="6773496">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773499">CharData</span><span class="op" id="6773507">(</span><span class="string" id="6773508">&#34;World&nbsp;&lt;&gt;&#39;\&#34;&nbsp;白鵬翔&#34;</span><span class="op" id="6773531">)</span><span class="op" id="6773532">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773535">EndElement</span><span class="op" id="6773545">{</span><span class="ident" id="6773546">Name</span><span class="op" id="6773550">{</span><span class="string" id="6773551">&#34;ns2&#34;</span><span class="op" id="6773556">,</span>&nbsp;<span class="string" id="6773558">&#34;hello&#34;</span><span class="op" id="6773565">}</span><span class="op" id="6773566">}</span><span class="op" id="6773567">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773570">CharData</span><span class="op" id="6773578">(</span><span class="string" id="6773579">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6773585">)</span><span class="op" id="6773586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773589">StartElement</span><span class="op" id="6773601">{</span><span class="ident" id="6773602">Name</span><span class="op" id="6773606">{</span><span class="string" id="6773607">&#34;ns2&#34;</span><span class="op" id="6773612">,</span>&nbsp;<span class="string" id="6773614">&#34;query&#34;</span><span class="op" id="6773621">}</span><span class="op" id="6773622">,</span>&nbsp;<span class="op" id="6773624">[</span><span class="op" id="6773625">]</span><span class="ident" id="6773626">Attr</span><span class="op" id="6773630">{</span><span class="op" id="6773631">}</span><span class="op" id="6773632">}</span><span class="op" id="6773633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773636">CharData</span><span class="op" id="6773644">(</span><span class="string" id="6773645">&#34;What&nbsp;is&nbsp;it?&#34;</span><span class="op" id="6773658">)</span><span class="op" id="6773659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773662">EndElement</span><span class="op" id="6773672">{</span><span class="ident" id="6773673">Name</span><span class="op" id="6773677">{</span><span class="string" id="6773678">&#34;ns2&#34;</span><span class="op" id="6773683">,</span>&nbsp;<span class="string" id="6773685">&#34;query&#34;</span><span class="op" id="6773692">}</span><span class="op" id="6773693">}</span><span class="op" id="6773694">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773697">CharData</span><span class="op" id="6773705">(</span><span class="string" id="6773706">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6773712">)</span><span class="op" id="6773713">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773716">StartElement</span><span class="op" id="6773728">{</span><span class="ident" id="6773729">Name</span><span class="op" id="6773733">{</span><span class="string" id="6773734">&#34;ns2&#34;</span><span class="op" id="6773739">,</span>&nbsp;<span class="string" id="6773741">&#34;goodbye&#34;</span><span class="op" id="6773750">}</span><span class="op" id="6773751">,</span>&nbsp;<span class="op" id="6773753">[</span><span class="op" id="6773754">]</span><span class="ident" id="6773755">Attr</span><span class="op" id="6773759">{</span><span class="op" id="6773760">}</span><span class="op" id="6773761">}</span><span class="op" id="6773762">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773765">EndElement</span><span class="op" id="6773775">{</span><span class="ident" id="6773776">Name</span><span class="op" id="6773780">{</span><span class="string" id="6773781">&#34;ns2&#34;</span><span class="op" id="6773786">,</span>&nbsp;<span class="string" id="6773788">&#34;goodbye&#34;</span><span class="op" id="6773797">}</span><span class="op" id="6773798">}</span><span class="op" id="6773799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773802">CharData</span><span class="op" id="6773810">(</span><span class="string" id="6773811">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6773817">)</span><span class="op" id="6773818">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773821">StartElement</span><span class="op" id="6773833">{</span><span class="ident" id="6773834">Name</span><span class="op" id="6773838">{</span><span class="string" id="6773839">&#34;ns2&#34;</span><span class="op" id="6773844">,</span>&nbsp;<span class="string" id="6773846">&#34;outer&#34;</span><span class="op" id="6773853">}</span><span class="op" id="6773854">,</span>&nbsp;<span class="op" id="6773856">[</span><span class="op" id="6773857">]</span><span class="ident" id="6773858">Attr</span><span class="op" id="6773862">{</span><span class="op" id="6773863">{</span><span class="ident" id="6773864">Name</span><span class="op" id="6773868">{</span><span class="string" id="6773869">&#34;ns1&#34;</span><span class="op" id="6773874">,</span>&nbsp;<span class="string" id="6773876">&#34;attr&#34;</span><span class="op" id="6773882">}</span><span class="op" id="6773883">,</span>&nbsp;<span class="string" id="6773885">&#34;value&#34;</span><span class="op" id="6773892">}</span><span class="op" id="6773893">,</span>&nbsp;<span class="op" id="6773895">{</span><span class="ident" id="6773896">Name</span><span class="op" id="6773900">{</span><span class="string" id="6773901">&#34;xmlns&#34;</span><span class="op" id="6773908">,</span>&nbsp;<span class="string" id="6773910">&#34;tag&#34;</span><span class="op" id="6773915">}</span><span class="op" id="6773916">,</span>&nbsp;<span class="string" id="6773918">&#34;ns4&#34;</span><span class="op" id="6773923">}</span><span class="op" id="6773924">}</span><span class="op" id="6773925">}</span><span class="op" id="6773926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773929">CharData</span><span class="op" id="6773937">(</span><span class="string" id="6773938">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="6773946">)</span><span class="op" id="6773947">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773950">StartElement</span><span class="op" id="6773962">{</span><span class="ident" id="6773963">Name</span><span class="op" id="6773967">{</span><span class="string" id="6773968">&#34;ns2&#34;</span><span class="op" id="6773973">,</span>&nbsp;<span class="string" id="6773975">&#34;inner&#34;</span><span class="op" id="6773982">}</span><span class="op" id="6773983">,</span>&nbsp;<span class="op" id="6773985">[</span><span class="op" id="6773986">]</span><span class="ident" id="6773987">Attr</span><span class="op" id="6773991">{</span><span class="op" id="6773992">}</span><span class="op" id="6773993">}</span><span class="op" id="6773994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6773997">EndElement</span><span class="op" id="6774007">{</span><span class="ident" id="6774008">Name</span><span class="op" id="6774012">{</span><span class="string" id="6774013">&#34;ns2&#34;</span><span class="op" id="6774018">,</span>&nbsp;<span class="string" id="6774020">&#34;inner&#34;</span><span class="op" id="6774027">}</span><span class="op" id="6774028">}</span><span class="op" id="6774029">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6774032">CharData</span><span class="op" id="6774040">(</span><span class="string" id="6774041">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6774047">)</span><span class="op" id="6774048">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6774051">EndElement</span><span class="op" id="6774061">{</span><span class="ident" id="6774062">Name</span><span class="op" id="6774066">{</span><span class="string" id="6774067">&#34;ns2&#34;</span><span class="op" id="6774072">,</span>&nbsp;<span class="string" id="6774074">&#34;outer&#34;</span><span class="op" id="6774081">}</span><span class="op" id="6774082">}</span><span class="op" id="6774083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6774086">CharData</span><span class="op" id="6774094">(</span><span class="string" id="6774095">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6774101">)</span><span class="op" id="6774102">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6774105">StartElement</span><span class="op" id="6774117">{</span><span class="ident" id="6774118">Name</span><span class="op" id="6774122">{</span><span class="string" id="6774123">&#34;ns3&#34;</span><span class="op" id="6774128">,</span>&nbsp;<span class="string" id="6774130">&#34;name&#34;</span><span class="op" id="6774136">}</span><span class="op" id="6774137">,</span>&nbsp;<span class="op" id="6774139">[</span><span class="op" id="6774140">]</span><span class="ident" id="6774141">Attr</span><span class="op" id="6774145">{</span><span class="op" id="6774146">}</span><span class="op" id="6774147">}</span><span class="op" id="6774148">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6774151">CharData</span><span class="op" id="6774159">(</span><span class="string" id="6774160">&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="6774168">)</span><span class="op" id="6774169">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6774172">CharData</span><span class="op" id="6774180">(</span><span class="string" id="6774181">&#34;Some&nbsp;text&nbsp;here.&#34;</span><span class="op" id="6774198">)</span><span class="op" id="6774199">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6774202">CharData</span><span class="op" id="6774210">(</span><span class="string" id="6774211">&#34;\n&nbsp;&nbsp;&#34;</span><span class="op" id="6774217">)</span><span class="op" id="6774218">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6774221">EndElement</span><span class="op" id="6774231">{</span><span class="ident" id="6774232">Name</span><span class="op" id="6774236">{</span><span class="string" id="6774237">&#34;ns3&#34;</span><span class="op" id="6774242">,</span>&nbsp;<span class="string" id="6774244">&#34;name&#34;</span><span class="op" id="6774250">}</span><span class="op" id="6774251">}</span><span class="op" id="6774252">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6774255">CharData</span><span class="op" id="6774263">(</span><span class="string" id="6774264">&#34;\n&#34;</span><span class="op" id="6774268">)</span><span class="op" id="6774269">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6774272">EndElement</span><span class="op" id="6774282">{</span><span class="ident" id="6774283">Name</span><span class="op" id="6774287">{</span><span class="string" id="6774288">&#34;ns2&#34;</span><span class="op" id="6774293">,</span>&nbsp;<span class="string" id="6774295">&#34;body&#34;</span><span class="op" id="6774301">}</span><span class="op" id="6774302">}</span><span class="op" id="6774303">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6774306">Comment</span><span class="op" id="6774313">(</span><span class="string" id="6774314">&#34;&nbsp;missing&nbsp;final&nbsp;newline&nbsp;&#34;</span><span class="op" id="6774339">)</span><span class="op" id="6774340">,</span><br>
<span class="lineno"></span><span class="op" id="6774342">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="6774345">const</span>&nbsp;<span class="ident" id="6774351">testInputAltEncoding</span>&nbsp;<span class="op" id="6774372">=</span>&nbsp;<span class="string" id="6774374">`<br>
<span class="lineno"></span>&lt;?xml&nbsp;version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;?&gt;<br>
<span class="lineno"></span>&lt;TAG&gt;VALUE&lt;/TAG&gt;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6774448">var</span>&nbsp;<span class="ident" id="6774452">rawTokensAltEncoding</span>&nbsp;<span class="op" id="6774473">=</span>&nbsp;<span class="op" id="6774475">[</span><span class="op" id="6774476">]</span><span class="ident" id="6774477">Token</span><span class="op" id="6774482">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6774485">CharData</span><span class="op" id="6774493">(</span><span class="string" id="6774494">&#34;\n&#34;</span><span class="op" id="6774498">)</span><span class="op" id="6774499">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6774502">ProcInst</span><span class="op" id="6774510">{</span><span class="string" id="6774511">&#34;xml&#34;</span><span class="op" id="6774516">,</span>&nbsp;<span class="op" id="6774518">[</span><span class="op" id="6774519">]</span><span class="builtintype" id="6774520">byte</span><span class="op" id="6774524">(</span><span class="string" id="6774525">`version=&#34;1.0&#34;&nbsp;encoding=&#34;x-testing-uppercase&#34;`</span><span class="op" id="6774571">)</span><span class="op" id="6774572">}</span><span class="op" id="6774573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6774576">CharData</span><span class="op" id="6774584">(</span><span class="string" id="6774585">&#34;\n&#34;</span><span class="op" id="6774589">)</span><span class="op" id="6774590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6774593">StartElement</span><span class="op" id="6774605">{</span><span class="ident" id="6774606">Name</span><span class="op" id="6774610">{</span><span class="string" id="6774611">&#34;&#34;</span><span class="op" id="6774613">,</span>&nbsp;<span class="string" id="6774615">&#34;tag&#34;</span><span class="op" id="6774620">}</span><span class="op" id="6774621">,</span>&nbsp;<span class="op" id="6774623">[</span><span class="op" id="6774624">]</span><span class="ident" id="6774625">Attr</span><span class="op" id="6774629">{</span><span class="op" id="6774630">}</span><span class="op" id="6774631">}</span><span class="op" id="6774632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6774635">CharData</span><span class="op" id="6774643">(</span><span class="string" id="6774644">&#34;value&#34;</span><span class="op" id="6774651">)</span><span class="op" id="6774652">,</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6774655">EndElement</span><span class="op" id="6774665">{</span><span class="ident" id="6774666">Name</span><span class="op" id="6774670">{</span><span class="string" id="6774671">&#34;&#34;</span><span class="op" id="6774673">,</span>&nbsp;<span class="string" id="6774675">&#34;tag&#34;</span><span class="op" id="6774680">}</span><span class="op" id="6774681">}</span><span class="op" id="6774682">,</span><br>
<span class="lineno"></span><span class="op" id="6774684">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6774687">var</span>&nbsp;<span class="ident" id="6774691">xmlInput</span>&nbsp;<span class="op" id="6774700">=</span>&nbsp;<span class="op" id="6774702">[</span><span class="op" id="6774703">]</span><span class="builtintype" id="6774704">string</span><span class="op" id="6774710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6774713">//&nbsp;unexpected&nbsp;EOF&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774738">&#34;&lt;&#34;</span><span class="op" id="6774741">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774744">&#34;&lt;t&#34;</span><span class="op" id="6774748">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774751">&#34;&lt;t&nbsp;&#34;</span><span class="op" id="6774756">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774759">&#34;&lt;t/&#34;</span><span class="op" id="6774764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774767">&#34;&lt;!&#34;</span><span class="op" id="6774771">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774774">&#34;&lt;!-&#34;</span><span class="op" id="6774779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774782">&#34;&lt;!--&#34;</span><span class="op" id="6774788">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774791">&#34;&lt;!--c-&#34;</span><span class="op" id="6774799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774802">&#34;&lt;!--c--&#34;</span><span class="op" id="6774811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774814">&#34;&lt;!d&#34;</span><span class="op" id="6774819">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774822">&#34;&lt;t&gt;&lt;/&#34;</span><span class="op" id="6774829">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774832">&#34;&lt;t&gt;&lt;/t&#34;</span><span class="op" id="6774840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774843">&#34;&lt;?&#34;</span><span class="op" id="6774847">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774850">&#34;&lt;?p&#34;</span><span class="op" id="6774855">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774858">&#34;&lt;t&nbsp;a&#34;</span><span class="op" id="6774864">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774867">&#34;&lt;t&nbsp;a=&#34;</span><span class="op" id="6774874">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774877">&#34;&lt;t&nbsp;a=&#39;&#34;</span><span class="op" id="6774885">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774888">&#34;&lt;t&nbsp;a=&#39;&#39;&#34;</span><span class="op" id="6774897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774900">&#34;&lt;t/&gt;&lt;![&#34;</span><span class="op" id="6774909">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774912">&#34;&lt;t/&gt;&lt;![C&#34;</span><span class="op" id="6774922">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774925">&#34;&lt;t/&gt;&lt;![CDATA[d&#34;</span><span class="op" id="6774941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774944">&#34;&lt;t/&gt;&lt;![CDATA[d]&#34;</span><span class="op" id="6774961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6774964">&#34;&lt;t/&gt;&lt;![CDATA[d]]&#34;</span><span class="op" id="6774982">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6774986">//&nbsp;other&nbsp;Syntax&nbsp;errors</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6775010">&#34;&lt;&gt;&#34;</span><span class="op" id="6775014">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6775017">&#34;&lt;t/a&#34;</span><span class="op" id="6775023">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6775026">&#34;&lt;0&nbsp;/&gt;&#34;</span><span class="op" id="6775033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6775036">&#34;&lt;?0&nbsp;&gt;&#34;</span><span class="op" id="6775043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6775046">//&nbsp;&nbsp;&nbsp;&nbsp;&#34;&lt;!0&nbsp;&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6775092">&#34;&lt;/0&gt;&#34;</span><span class="op" id="6775098">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6775101">&#34;&lt;t&nbsp;0=&#39;&#39;&gt;&#34;</span><span class="op" id="6775111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6775114">&#34;&lt;t&nbsp;a=&#39;&amp;&#39;&gt;&#34;</span><span class="op" id="6775125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6775128">&#34;&lt;t&nbsp;a=&#39;&lt;&#39;&gt;&#34;</span><span class="op" id="6775139">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6775142">&#34;&lt;t&gt;&amp;nbspc;&lt;/t&gt;&#34;</span><span class="op" id="6775158">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6775161">&#34;&lt;t&nbsp;a&gt;&#34;</span><span class="op" id="6775168">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6775171">&#34;&lt;t&nbsp;a=&gt;&#34;</span><span class="op" id="6775179">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6775182">&#34;&lt;t&nbsp;a=v&gt;&#34;</span><span class="op" id="6775191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6775194">//&nbsp;&nbsp;&nbsp;&nbsp;&#34;&lt;![CDATA[d]]&gt;&#34;,&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;let&nbsp;the&nbsp;Token()&nbsp;caller&nbsp;handle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6775248">&#34;&lt;t&gt;&lt;/e&gt;&#34;</span><span class="op" id="6775257">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6775260">&#34;&lt;t&gt;&lt;/&gt;&#34;</span><span class="op" id="6775268">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6775271">&#34;&lt;t&gt;&lt;/t!&#34;</span><span class="op" id="6775280">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6775283">&#34;&lt;t&gt;cdata]]&gt;&lt;/t&gt;&#34;</span><span class="op" id="6775300">,</span><br>
<span class="lineno"></span><span class="op" id="6775302">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="6775305">func</span>&nbsp;<span class="ident" id="6775310">TestRawToken</span><span class="op" id="6775322">(</span><span class="ident" id="6775323">t</span>&nbsp;<span class="op" id="6775325">*</span><span class="ident" id="6775326">testing</span><span class="op" id="6775333">.</span><span class="ident" id="6775334">T</span><span class="op" id="6775335">)</span>&nbsp;<span class="op" id="6775337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6775340">d</span>&nbsp;<span class="op" id="6775342">:=</span>&nbsp;<span class="ident" id="6775345">NewDecoder</span><span class="op" id="6775355">(</span><span class="ident" id="6775356">strings</span><span class="op" id="6775363">.</span><span class="ident" id="6775364">NewReader</span><span class="op" id="6775373">(</span><span class="ident" id="6775374">testInput</span><span class="op" id="6775383">)</span><span class="op" id="6775384">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6775387">d</span><span class="op" id="6775388">.</span><span class="ident" id="6775389">Entity</span>&nbsp;<span class="op" id="6775396">=</span>&nbsp;<span class="ident" id="6775398">testEntity</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6775410">testRawToken</span><span class="op" id="6775422">(</span><span class="ident" id="6775423">t</span><span class="op" id="6775424">,</span>&nbsp;<span class="ident" id="6775426">d</span><span class="op" id="6775427">,</span>&nbsp;<span class="ident" id="6775429">testInput</span><span class="op" id="6775438">,</span>&nbsp;<span class="ident" id="6775440">rawTokens</span><span class="op" id="6775449">)</span><br>
<span class="lineno"></span><span class="op" id="6775451">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="6775454">const</span>&nbsp;<span class="ident" id="6775460">nonStrictInput</span>&nbsp;<span class="op" id="6775475">=</span>&nbsp;<span class="string" id="6775477">`<br>
<span class="lineno"></span>&lt;tag&gt;non&amp;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;unknown;entity&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;#123&lt;/tag&gt;<br>
<span class="lineno">180</span>&lt;tag&gt;&amp;#zzz;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;なまえ3;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;lt-gt;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;;&lt;/tag&gt;<br>
<span class="lineno"></span>&lt;tag&gt;&amp;0a;&lt;/tag&gt;<br>
<span class="lineno">185</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6775639">var</span>&nbsp;<span class="ident" id="6775643">nonStringEntity</span>&nbsp;<span class="op" id="6775659">=</span>&nbsp;<span class="keyword" id="6775661">map</span><span class="op" id="6775664">[</span><span class="builtintype" id="6775665">string</span><span class="op" id="6775671">]</span><span class="builtintype" id="6775672">string</span><span class="op" id="6775678">{</span><span class="string" id="6775679">&#34;&#34;</span><span class="op" id="6775681">:</span>&nbsp;<span class="string" id="6775683">&#34;oops!&#34;</span><span class="op" id="6775690">,</span>&nbsp;<span class="string" id="6775692">&#34;0a&#34;</span><span class="op" id="6775696">:</span>&nbsp;<span class="string" id="6775698">&#34;oops!&#34;</span><span class="op" id="6775705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6775708">var</span>&nbsp;<span class="ident" id="6775712">nonStrictTokens</span>&nbsp;<span class="op" id="6775728">=</span>&nbsp;<span class="op" id="6775730">[</span><span class="op" id="6775731">]</span><span class="ident" id="6775732">Token</span><span class="op" id="6775737">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6775740">CharData</span><span class="op" id="6775748">(</span><span class="string" id="6775749">&#34;\n&#34;</span><span class="op" id="6775753">)</span><span class="op" id="6775754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6775757">StartElement</span><span class="op" id="6775769">{</span><span class="ident" id="6775770">Name</span><span class="op" id="6775774">{</span><span class="string" id="6775775">&#34;&#34;</span><span class="op" id="6775777">,</span>&nbsp;<span class="string" id="6775779">&#34;tag&#34;</span><span class="op" id="6775784">}</span><span class="op" id="6775785">,</span>&nbsp;<span class="op" id="6775787">[</span><span class="op" id="6775788">]</span><span class="ident" id="6775789">Attr</span><span class="op" id="6775793">{</span><span class="op" id="6775794">}</span><span class="op" id="6775795">}</span><span class="op" id="6775796">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6775799">CharData</span><span class="op" id="6775807">(</span><span class="string" id="6775808">&#34;non&amp;entity&#34;</span><span class="op" id="6775820">)</span><span class="op" id="6775821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6775824">EndElement</span><span class="op" id="6775834">{</span><span class="ident" id="6775835">Name</span><span class="op" id="6775839">{</span><span class="string" id="6775840">&#34;&#34;</span><span class="op" id="6775842">,</span>&nbsp;<span class="string" id="6775844">&#34;tag&#34;</span><span class="op" id="6775849">}</span><span class="op" id="6775850">}</span><span class="op" id="6775851">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6775854">CharData</span><span class="op" id="6775862">(</span><span class="string" id="6775863">&#34;\n&#34;</span><span class="op" id="6775867">)</span><span class="op" id="6775868">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6775871">StartElement</span><span class="op" id="6775883">{</span><span class="ident" id="6775884">Name</span><span class="op" id="6775888">{</span><span class="string" id="6775889">&#34;&#34;</span><span class="op" id="6775891">,</span>&nbsp;<span class="string" id="6775893">&#34;tag&#34;</span><span class="op" id="6775898">}</span><span class="op" id="6775899">,</span>&nbsp;<span class="op" id="6775901">[</span><span class="op" id="6775902">]</span><span class="ident" id="6775903">Attr</span><span class="op" id="6775907">{</span><span class="op" id="6775908">}</span><span class="op" id="6775909">}</span><span class="op" id="6775910">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6775913">CharData</span><span class="op" id="6775921">(</span><span class="string" id="6775922">&#34;&amp;unknown;entity&#34;</span><span class="op" id="6775939">)</span><span class="op" id="6775940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6775943">EndElement</span><span class="op" id="6775953">{</span><span class="ident" id="6775954">Name</span><span class="op" id="6775958">{</span><span class="string" id="6775959">&#34;&#34;</span><span class="op" id="6775961">,</span>&nbsp;<span class="string" id="6775963">&#34;tag&#34;</span><span class="op" id="6775968">}</span><span class="op" id="6775969">}</span><span class="op" id="6775970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6775973">CharData</span><span class="op" id="6775981">(</span><span class="string" id="6775982">&#34;\n&#34;</span><span class="op" id="6775986">)</span><span class="op" id="6775987">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6775990">StartElement</span><span class="op" id="6776002">{</span><span class="ident" id="6776003">Name</span><span class="op" id="6776007">{</span><span class="string" id="6776008">&#34;&#34;</span><span class="op" id="6776010">,</span>&nbsp;<span class="string" id="6776012">&#34;tag&#34;</span><span class="op" id="6776017">}</span><span class="op" id="6776018">,</span>&nbsp;<span class="op" id="6776020">[</span><span class="op" id="6776021">]</span><span class="ident" id="6776022">Attr</span><span class="op" id="6776026">{</span><span class="op" id="6776027">}</span><span class="op" id="6776028">}</span><span class="op" id="6776029">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776032">CharData</span><span class="op" id="6776040">(</span><span class="string" id="6776041">&#34;&amp;#123&#34;</span><span class="op" id="6776048">)</span><span class="op" id="6776049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776052">EndElement</span><span class="op" id="6776062">{</span><span class="ident" id="6776063">Name</span><span class="op" id="6776067">{</span><span class="string" id="6776068">&#34;&#34;</span><span class="op" id="6776070">,</span>&nbsp;<span class="string" id="6776072">&#34;tag&#34;</span><span class="op" id="6776077">}</span><span class="op" id="6776078">}</span><span class="op" id="6776079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776082">CharData</span><span class="op" id="6776090">(</span><span class="string" id="6776091">&#34;\n&#34;</span><span class="op" id="6776095">)</span><span class="op" id="6776096">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776099">StartElement</span><span class="op" id="6776111">{</span><span class="ident" id="6776112">Name</span><span class="op" id="6776116">{</span><span class="string" id="6776117">&#34;&#34;</span><span class="op" id="6776119">,</span>&nbsp;<span class="string" id="6776121">&#34;tag&#34;</span><span class="op" id="6776126">}</span><span class="op" id="6776127">,</span>&nbsp;<span class="op" id="6776129">[</span><span class="op" id="6776130">]</span><span class="ident" id="6776131">Attr</span><span class="op" id="6776135">{</span><span class="op" id="6776136">}</span><span class="op" id="6776137">}</span><span class="op" id="6776138">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776141">CharData</span><span class="op" id="6776149">(</span><span class="string" id="6776150">&#34;&amp;#zzz;&#34;</span><span class="op" id="6776158">)</span><span class="op" id="6776159">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776162">EndElement</span><span class="op" id="6776172">{</span><span class="ident" id="6776173">Name</span><span class="op" id="6776177">{</span><span class="string" id="6776178">&#34;&#34;</span><span class="op" id="6776180">,</span>&nbsp;<span class="string" id="6776182">&#34;tag&#34;</span><span class="op" id="6776187">}</span><span class="op" id="6776188">}</span><span class="op" id="6776189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776192">CharData</span><span class="op" id="6776200">(</span><span class="string" id="6776201">&#34;\n&#34;</span><span class="op" id="6776205">)</span><span class="op" id="6776206">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776209">StartElement</span><span class="op" id="6776221">{</span><span class="ident" id="6776222">Name</span><span class="op" id="6776226">{</span><span class="string" id="6776227">&#34;&#34;</span><span class="op" id="6776229">,</span>&nbsp;<span class="string" id="6776231">&#34;tag&#34;</span><span class="op" id="6776236">}</span><span class="op" id="6776237">,</span>&nbsp;<span class="op" id="6776239">[</span><span class="op" id="6776240">]</span><span class="ident" id="6776241">Attr</span><span class="op" id="6776245">{</span><span class="op" id="6776246">}</span><span class="op" id="6776247">}</span><span class="op" id="6776248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776251">CharData</span><span class="op" id="6776259">(</span><span class="string" id="6776260">&#34;&amp;なまえ3;&#34;</span><span class="op" id="6776274">)</span><span class="op" id="6776275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776278">EndElement</span><span class="op" id="6776288">{</span><span class="ident" id="6776289">Name</span><span class="op" id="6776293">{</span><span class="string" id="6776294">&#34;&#34;</span><span class="op" id="6776296">,</span>&nbsp;<span class="string" id="6776298">&#34;tag&#34;</span><span class="op" id="6776303">}</span><span class="op" id="6776304">}</span><span class="op" id="6776305">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776308">CharData</span><span class="op" id="6776316">(</span><span class="string" id="6776317">&#34;\n&#34;</span><span class="op" id="6776321">)</span><span class="op" id="6776322">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776325">StartElement</span><span class="op" id="6776337">{</span><span class="ident" id="6776338">Name</span><span class="op" id="6776342">{</span><span class="string" id="6776343">&#34;&#34;</span><span class="op" id="6776345">,</span>&nbsp;<span class="string" id="6776347">&#34;tag&#34;</span><span class="op" id="6776352">}</span><span class="op" id="6776353">,</span>&nbsp;<span class="op" id="6776355">[</span><span class="op" id="6776356">]</span><span class="ident" id="6776357">Attr</span><span class="op" id="6776361">{</span><span class="op" id="6776362">}</span><span class="op" id="6776363">}</span><span class="op" id="6776364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776367">CharData</span><span class="op" id="6776375">(</span><span class="string" id="6776376">&#34;&amp;lt-gt;&#34;</span><span class="op" id="6776385">)</span><span class="op" id="6776386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776389">EndElement</span><span class="op" id="6776399">{</span><span class="ident" id="6776400">Name</span><span class="op" id="6776404">{</span><span class="string" id="6776405">&#34;&#34;</span><span class="op" id="6776407">,</span>&nbsp;<span class="string" id="6776409">&#34;tag&#34;</span><span class="op" id="6776414">}</span><span class="op" id="6776415">}</span><span class="op" id="6776416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776419">CharData</span><span class="op" id="6776427">(</span><span class="string" id="6776428">&#34;\n&#34;</span><span class="op" id="6776432">)</span><span class="op" id="6776433">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776436">StartElement</span><span class="op" id="6776448">{</span><span class="ident" id="6776449">Name</span><span class="op" id="6776453">{</span><span class="string" id="6776454">&#34;&#34;</span><span class="op" id="6776456">,</span>&nbsp;<span class="string" id="6776458">&#34;tag&#34;</span><span class="op" id="6776463">}</span><span class="op" id="6776464">,</span>&nbsp;<span class="op" id="6776466">[</span><span class="op" id="6776467">]</span><span class="ident" id="6776468">Attr</span><span class="op" id="6776472">{</span><span class="op" id="6776473">}</span><span class="op" id="6776474">}</span><span class="op" id="6776475">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776478">CharData</span><span class="op" id="6776486">(</span><span class="string" id="6776487">&#34;&amp;;&#34;</span><span class="op" id="6776491">)</span><span class="op" id="6776492">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776495">EndElement</span><span class="op" id="6776505">{</span><span class="ident" id="6776506">Name</span><span class="op" id="6776510">{</span><span class="string" id="6776511">&#34;&#34;</span><span class="op" id="6776513">,</span>&nbsp;<span class="string" id="6776515">&#34;tag&#34;</span><span class="op" id="6776520">}</span><span class="op" id="6776521">}</span><span class="op" id="6776522">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776525">CharData</span><span class="op" id="6776533">(</span><span class="string" id="6776534">&#34;\n&#34;</span><span class="op" id="6776538">)</span><span class="op" id="6776539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776542">StartElement</span><span class="op" id="6776554">{</span><span class="ident" id="6776555">Name</span><span class="op" id="6776559">{</span><span class="string" id="6776560">&#34;&#34;</span><span class="op" id="6776562">,</span>&nbsp;<span class="string" id="6776564">&#34;tag&#34;</span><span class="op" id="6776569">}</span><span class="op" id="6776570">,</span>&nbsp;<span class="op" id="6776572">[</span><span class="op" id="6776573">]</span><span class="ident" id="6776574">Attr</span><span class="op" id="6776578">{</span><span class="op" id="6776579">}</span><span class="op" id="6776580">}</span><span class="op" id="6776581">,</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776584">CharData</span><span class="op" id="6776592">(</span><span class="string" id="6776593">&#34;&amp;0a;&#34;</span><span class="op" id="6776599">)</span><span class="op" id="6776600">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776603">EndElement</span><span class="op" id="6776613">{</span><span class="ident" id="6776614">Name</span><span class="op" id="6776618">{</span><span class="string" id="6776619">&#34;&#34;</span><span class="op" id="6776621">,</span>&nbsp;<span class="string" id="6776623">&#34;tag&#34;</span><span class="op" id="6776628">}</span><span class="op" id="6776629">}</span><span class="op" id="6776630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776633">CharData</span><span class="op" id="6776641">(</span><span class="string" id="6776642">&#34;\n&#34;</span><span class="op" id="6776646">)</span><span class="op" id="6776647">,</span><br>
<span class="lineno"></span><span class="op" id="6776649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="6776652">func</span>&nbsp;<span class="ident" id="6776657">TestNonStrictRawToken</span><span class="op" id="6776678">(</span><span class="ident" id="6776679">t</span>&nbsp;<span class="op" id="6776681">*</span><span class="ident" id="6776682">testing</span><span class="op" id="6776689">.</span><span class="ident" id="6776690">T</span><span class="op" id="6776691">)</span>&nbsp;<span class="op" id="6776693">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776696">d</span>&nbsp;<span class="op" id="6776698">:=</span>&nbsp;<span class="ident" id="6776701">NewDecoder</span><span class="op" id="6776711">(</span><span class="ident" id="6776712">strings</span><span class="op" id="6776719">.</span><span class="ident" id="6776720">NewReader</span><span class="op" id="6776729">(</span><span class="ident" id="6776730">nonStrictInput</span><span class="op" id="6776744">)</span><span class="op" id="6776745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776748">d</span><span class="op" id="6776749">.</span><span class="ident" id="6776750">Strict</span>&nbsp;<span class="op" id="6776757">=</span>&nbsp;<span class="builtintype" id="6776759">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776766">testRawToken</span><span class="op" id="6776778">(</span><span class="ident" id="6776779">t</span><span class="op" id="6776780">,</span>&nbsp;<span class="ident" id="6776782">d</span><span class="op" id="6776783">,</span>&nbsp;<span class="ident" id="6776785">nonStrictInput</span><span class="op" id="6776799">,</span>&nbsp;<span class="ident" id="6776801">nonStrictTokens</span><span class="op" id="6776816">)</span><br>
<span class="lineno"></span><span class="op" id="6776818">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="6776821">type</span>&nbsp;<span class="ident" id="6776826">downCaser</span>&nbsp;<span class="keyword" id="6776836">struct</span>&nbsp;<span class="op" id="6776843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776846">t</span>&nbsp;<span class="op" id="6776848">*</span><span class="ident" id="6776849">testing</span><span class="op" id="6776856">.</span><span class="ident" id="6776857">T</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776860">r</span>&nbsp;<span class="ident" id="6776862">io</span><span class="op" id="6776864">.</span><span class="ident" id="6776865">ByteReader</span><br>
<span class="lineno"></span><span class="op" id="6776876">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="6776879">func</span>&nbsp;<span class="op" id="6776884">(</span><span class="ident" id="6776885">d</span>&nbsp;<span class="op" id="6776887">*</span><span class="ident" id="6776888">downCaser</span><span class="op" id="6776897">)</span>&nbsp;<span class="ident" id="6776899">ReadByte</span><span class="op" id="6776907">(</span><span class="op" id="6776908">)</span>&nbsp;<span class="op" id="6776910">(</span><span class="ident" id="6776911">c</span>&nbsp;<span class="builtintype" id="6776913">byte</span><span class="op" id="6776917">,</span>&nbsp;<span class="ident" id="6776919">err</span>&nbsp;<span class="builtintype" id="6776923">error</span><span class="op" id="6776928">)</span>&nbsp;<span class="op" id="6776930">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776933">c</span><span class="op" id="6776934">,</span>&nbsp;<span class="ident" id="6776936">err</span>&nbsp;<span class="op" id="6776940">=</span>&nbsp;<span class="ident" id="6776942">d</span><span class="op" id="6776943">.</span><span class="ident" id="6776944">r</span><span class="op" id="6776945">.</span><span class="ident" id="6776946">ReadByte</span><span class="op" id="6776954">(</span><span class="op" id="6776955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6776958">if</span>&nbsp;<span class="ident" id="6776961">c</span>&nbsp;<span class="op" id="6776963">&gt;=</span>&nbsp;<span class="string" id="6776966">&#39;A&#39;</span>&nbsp;<span class="op" id="6776970">&amp;&amp;</span>&nbsp;<span class="ident" id="6776973">c</span>&nbsp;<span class="op" id="6776975">&lt;=</span>&nbsp;<span class="string" id="6776978">&#39;Z&#39;</span>&nbsp;<span class="op" id="6776982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6776986">c</span>&nbsp;<span class="op" id="6776988">+=</span>&nbsp;<span class="string" id="6776991">&#39;a&#39;</span>&nbsp;<span class="op" id="6776995">-</span>&nbsp;<span class="string" id="6776997">&#39;A&#39;</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6777002">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6777005">return</span><br>
<span class="lineno"></span><span class="op" id="6777012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6777015">func</span>&nbsp;<span class="op" id="6777020">(</span><span class="ident" id="6777021">d</span>&nbsp;<span class="op" id="6777023">*</span><span class="ident" id="6777024">downCaser</span><span class="op" id="6777033">)</span>&nbsp;<span class="ident" id="6777035">Read</span><span class="op" id="6777039">(</span><span class="ident" id="6777040">p</span>&nbsp;<span class="op" id="6777042">[</span><span class="op" id="6777043">]</span><span class="builtintype" id="6777044">byte</span><span class="op" id="6777048">)</span>&nbsp;<span class="op" id="6777050">(</span><span class="builtintype" id="6777051">int</span><span class="op" id="6777054">,</span>&nbsp;<span class="builtintype" id="6777056">error</span><span class="op" id="6777061">)</span>&nbsp;<span class="op" id="6777063">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6777066">d</span><span class="op" id="6777067">.</span><span class="ident" id="6777068">t</span><span class="op" id="6777069">.</span><span class="ident" id="6777070">Fatalf</span><span class="op" id="6777076">(</span><span class="string" id="6777077">&#34;unexpected&nbsp;Read&nbsp;call&nbsp;on&nbsp;downCaser&nbsp;reader&#34;</span><span class="op" id="6777119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="6777122">panic</span><span class="op" id="6777127">(</span><span class="string" id="6777128">&#34;unreachable&#34;</span><span class="op" id="6777141">)</span><br>
<span class="lineno"></span><span class="op" id="6777143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6777146">func</span>&nbsp;<span class="ident" id="6777151">TestRawTokenAltEncoding</span><span class="op" id="6777174">(</span><span class="ident" id="6777175">t</span>&nbsp;<span class="op" id="6777177">*</span><span class="ident" id="6777178">testing</span><span class="op" id="6777185">.</span><span class="ident" id="6777186">T</span><span class="op" id="6777187">)</span>&nbsp;<span class="op" id="6777189">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6777192">d</span>&nbsp;<span class="op" id="6777194">:=</span>&nbsp;<span class="ident" id="6777197">NewDecoder</span><span class="op" id="6777207">(</span><span class="ident" id="6777208">strings</span><span class="op" id="6777215">.</span><span class="ident" id="6777216">NewReader</span><span class="op" id="6777225">(</span><span class="ident" id="6777226">testInputAltEncoding</span><span class="op" id="6777246">)</span><span class="op" id="6777247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6777250">d</span><span class="op" id="6777251">.</span><span class="ident" id="6777252">CharsetReader</span>&nbsp;<span class="op" id="6777266">=</span>&nbsp;<span class="keyword" id="6777268">func</span><span class="op" id="6777272">(</span><span class="ident" id="6777273">charset</span>&nbsp;<span class="builtintype" id="6777281">string</span><span class="op" id="6777287">,</span>&nbsp;<span class="ident" id="6777289">input</span>&nbsp;<span class="ident" id="6777295">io</span><span class="op" id="6777297">.</span><span class="ident" id="6777298">Reader</span><span class="op" id="6777304">)</span>&nbsp;<span class="op" id="6777306">(</span><span class="ident" id="6777307">io</span><span class="op" id="6777309">.</span><span class="ident" id="6777310">Reader</span><span class="op" id="6777316">,</span>&nbsp;<span class="builtintype" id="6777318">error</span><span class="op" id="6777323">)</span>&nbsp;<span class="op" id="6777325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6777329">if</span>&nbsp;<span class="ident" id="6777332">charset</span>&nbsp;<span class="op" id="6777340">!=</span>&nbsp;<span class="string" id="6777343">&#34;x-testing-uppercase&#34;</span>&nbsp;<span class="op" id="6777365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6777370">t</span><span class="op" id="6777371">.</span><span class="ident" id="6777372">Fatalf</span><span class="op" id="6777378">(</span><span class="string" id="6777379">&#34;unexpected&nbsp;charset&nbsp;%q&#34;</span><span class="op" id="6777402">,</span>&nbsp;<span class="ident" id="6777404">charset</span><span class="op" id="6777411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6777415">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6777419">return</span>&nbsp;<span class="op" id="6777426">&amp;</span><span class="ident" id="6777427">downCaser</span><span class="op" id="6777436">{</span><span class="ident" id="6777437">t</span><span class="op" id="6777438">,</span>&nbsp;<span class="ident" id="6777440">input</span><span class="op" id="6777445">.</span><span class="op" id="6777446">(</span><span class="ident" id="6777447">io</span><span class="op" id="6777449">.</span><span class="ident" id="6777450">ByteReader</span><span class="op" id="6777460">)</span><span class="op" id="6777461">}</span><span class="op" id="6777462">,</span>&nbsp;<span class="ident" id="6777464">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6777469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6777472">testRawToken</span><span class="op" id="6777484">(</span><span class="ident" id="6777485">t</span><span class="op" id="6777486">,</span>&nbsp;<span class="ident" id="6777488">d</span><span class="op" id="6777489">,</span>&nbsp;<span class="ident" id="6777491">testInputAltEncoding</span><span class="op" id="6777511">,</span>&nbsp;<span class="ident" id="6777513">rawTokensAltEncoding</span><span class="op" id="6777533">)</span><br>
<span class="lineno"></span><span class="op" id="6777535">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="keyword" id="6777538">func</span>&nbsp;<span class="ident" id="6777543">TestRawTokenAltEncodingNoConverter</span><span class="op" id="6777577">(</span><span class="ident" id="6777578">t</span>&nbsp;<span class="op" id="6777580">*</span><span class="ident" id="6777581">testing</span><span class="op" id="6777588">.</span><span class="ident" id="6777589">T</span><span class="op" id="6777590">)</span>&nbsp;<span class="op" id="6777592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6777595">d</span>&nbsp;<span class="op" id="6777597">:=</span>&nbsp;<span class="ident" id="6777600">NewDecoder</span><span class="op" id="6777610">(</span><span class="ident" id="6777611">strings</span><span class="op" id="6777618">.</span><span class="ident" id="6777619">NewReader</span><span class="op" id="6777628">(</span><span class="ident" id="6777629">testInputAltEncoding</span><span class="op" id="6777649">)</span><span class="op" id="6777650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6777653">token</span><span class="op" id="6777658">,</span>&nbsp;<span class="ident" id="6777660">err</span>&nbsp;<span class="op" id="6777664">:=</span>&nbsp;<span class="ident" id="6777667">d</span><span class="op" id="6777668">.</span><span class="ident" id="6777669">RawToken</span><span class="op" id="6777677">(</span><span class="op" id="6777678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6777681">if</span>&nbsp;<span class="ident" id="6777684">token</span>&nbsp;<span class="op" id="6777690">==</span>&nbsp;<span class="ident" id="6777693">nil</span>&nbsp;<span class="op" id="6777697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6777701">t</span><span class="op" id="6777702">.</span><span class="ident" id="6777703">Fatalf</span><span class="op" id="6777709">(</span><span class="string" id="6777710">&#34;expected&nbsp;a&nbsp;token&nbsp;on&nbsp;first&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="6777751">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6777754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6777757">if</span>&nbsp;<span class="ident" id="6777760">err</span>&nbsp;<span class="op" id="6777764">!=</span>&nbsp;<span class="ident" id="6777767">nil</span>&nbsp;<span class="op" id="6777771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6777775">t</span><span class="op" id="6777776">.</span><span class="ident" id="6777777">Fatal</span><span class="op" id="6777782">(</span><span class="ident" id="6777783">err</span><span class="op" id="6777786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6777789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6777792">token</span><span class="op" id="6777797">,</span>&nbsp;<span class="ident" id="6777799">err</span>&nbsp;<span class="op" id="6777803">=</span>&nbsp;<span class="ident" id="6777805">d</span><span class="op" id="6777806">.</span><span class="ident" id="6777807">RawToken</span><span class="op" id="6777815">(</span><span class="op" id="6777816">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6777819">if</span>&nbsp;<span class="ident" id="6777822">token</span>&nbsp;<span class="op" id="6777828">!=</span>&nbsp;<span class="ident" id="6777831">nil</span>&nbsp;<span class="op" id="6777835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6777839">t</span><span class="op" id="6777840">.</span><span class="ident" id="6777841">Errorf</span><span class="op" id="6777847">(</span><span class="string" id="6777848">&#34;expected&nbsp;a&nbsp;nil&nbsp;token;&nbsp;got&nbsp;%#v&#34;</span><span class="op" id="6777879">,</span>&nbsp;<span class="ident" id="6777881">token</span><span class="op" id="6777886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6777889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6777892">if</span>&nbsp;<span class="ident" id="6777895">err</span>&nbsp;<span class="op" id="6777899">==</span>&nbsp;<span class="ident" id="6777902">nil</span>&nbsp;<span class="op" id="6777906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6777910">t</span><span class="op" id="6777911">.</span><span class="ident" id="6777912">Fatalf</span><span class="op" id="6777918">(</span><span class="string" id="6777919">&#34;expected&nbsp;an&nbsp;error&nbsp;on&nbsp;second&nbsp;RawToken&nbsp;call&#34;</span><span class="op" id="6777962">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6777965">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6777968">const</span>&nbsp;<span class="ident" id="6777974">encoding</span>&nbsp;<span class="op" id="6777983">=</span>&nbsp;<span class="string" id="6777985">&#34;x-testing-uppercase&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6778008">if</span>&nbsp;<span class="op" id="6778011">!</span><span class="ident" id="6778012">strings</span><span class="op" id="6778019">.</span><span class="ident" id="6778020">Contains</span><span class="op" id="6778028">(</span><span class="ident" id="6778029">err</span><span class="op" id="6778032">.</span><span class="ident" id="6778033">Error</span><span class="op" id="6778038">(</span><span class="op" id="6778039">)</span><span class="op" id="6778040">,</span>&nbsp;<span class="ident" id="6778042">encoding</span><span class="op" id="6778050">)</span>&nbsp;<span class="op" id="6778052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6778056">t</span><span class="op" id="6778057">.</span><span class="ident" id="6778058">Errorf</span><span class="op" id="6778064">(</span><span class="string" id="6778065">&#34;expected&nbsp;error&nbsp;to&nbsp;contain&nbsp;%q;&nbsp;got&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6778110">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6778115">encoding</span><span class="op" id="6778123">,</span>&nbsp;<span class="ident" id="6778125">err</span><span class="op" id="6778128">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6778131">}</span><br>
<span class="lineno"></span><span class="op" id="6778133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6778136">func</span>&nbsp;<span class="ident" id="6778141">testRawToken</span><span class="op" id="6778153">(</span><span class="ident" id="6778154">t</span>&nbsp;<span class="op" id="6778156">*</span><span class="ident" id="6778157">testing</span><span class="op" id="6778164">.</span><span class="ident" id="6778165">T</span><span class="op" id="6778166">,</span>&nbsp;<span class="ident" id="6778168">d</span>&nbsp;<span class="op" id="6778170">*</span><span class="ident" id="6778171">Decoder</span><span class="op" id="6778178">,</span>&nbsp;<span class="ident" id="6778180">raw</span>&nbsp;<span class="builtintype" id="6778184">string</span><span class="op" id="6778190">,</span>&nbsp;<span class="ident" id="6778192">rawTokens</span>&nbsp;<span class="op" id="6778202">[</span><span class="op" id="6778203">]</span><span class="ident" id="6778204">Token</span><span class="op" id="6778209">)</span>&nbsp;<span class="op" id="6778211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6778214">lastEnd</span>&nbsp;<span class="op" id="6778222">:=</span>&nbsp;<span class="ident" id="6778225">int64</span><span class="op" id="6778230">(</span><span class="num" id="6778231">0</span><span class="op" id="6778232">)</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6778235">for</span>&nbsp;<span class="ident" id="6778239">i</span><span class="op" id="6778240">,</span>&nbsp;<span class="ident" id="6778242">want</span>&nbsp;<span class="op" id="6778247">:=</span>&nbsp;<span class="keyword" id="6778250">range</span>&nbsp;<span class="ident" id="6778256">rawTokens</span>&nbsp;<span class="op" id="6778266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6778270">start</span>&nbsp;<span class="op" id="6778276">:=</span>&nbsp;<span class="ident" id="6778279">d</span><span class="op" id="6778280">.</span><span class="ident" id="6778281">InputOffset</span><span class="op" id="6778292">(</span><span class="op" id="6778293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6778297">have</span><span class="op" id="6778301">,</span>&nbsp;<span class="ident" id="6778303">err</span>&nbsp;<span class="op" id="6778307">:=</span>&nbsp;<span class="ident" id="6778310">d</span><span class="op" id="6778311">.</span><span class="ident" id="6778312">RawToken</span><span class="op" id="6778320">(</span><span class="op" id="6778321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6778325">end</span>&nbsp;<span class="op" id="6778329">:=</span>&nbsp;<span class="ident" id="6778332">d</span><span class="op" id="6778333">.</span><span class="ident" id="6778334">InputOffset</span><span class="op" id="6778345">(</span><span class="op" id="6778346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6778350">if</span>&nbsp;<span class="ident" id="6778353">err</span>&nbsp;<span class="op" id="6778357">!=</span>&nbsp;<span class="ident" id="6778360">nil</span>&nbsp;<span class="op" id="6778364">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6778369">t</span><span class="op" id="6778370">.</span><span class="ident" id="6778371">Fatalf</span><span class="op" id="6778377">(</span><span class="string" id="6778378">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6778410">,</span>&nbsp;<span class="ident" id="6778412">i</span><span class="op" id="6778413">,</span>&nbsp;<span class="ident" id="6778415">err</span><span class="op" id="6778418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6778422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6778426">if</span>&nbsp;<span class="op" id="6778429">!</span><span class="ident" id="6778430">reflect</span><span class="op" id="6778437">.</span><span class="ident" id="6778438">DeepEqual</span><span class="op" id="6778447">(</span><span class="ident" id="6778448">have</span><span class="op" id="6778452">,</span>&nbsp;<span class="ident" id="6778454">want</span><span class="op" id="6778458">)</span>&nbsp;<span class="op" id="6778460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6778465">var</span>&nbsp;<span class="ident" id="6778469">shave</span><span class="op" id="6778474">,</span>&nbsp;<span class="ident" id="6778476">swant</span>&nbsp;<span class="builtintype" id="6778482">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6778492">if</span>&nbsp;<span class="ident" id="6778495">_</span><span class="op" id="6778496">,</span>&nbsp;<span class="ident" id="6778498">ok</span>&nbsp;<span class="op" id="6778501">:=</span>&nbsp;<span class="ident" id="6778504">have</span><span class="op" id="6778508">.</span><span class="op" id="6778509">(</span><span class="ident" id="6778510">CharData</span><span class="op" id="6778518">)</span><span class="op" id="6778519">;</span>&nbsp;<span class="ident" id="6778521">ok</span>&nbsp;<span class="op" id="6778524">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6778530">shave</span>&nbsp;<span class="op" id="6778536">=</span>&nbsp;<span class="ident" id="6778538">fmt</span><span class="op" id="6778541">.</span><span class="ident" id="6778542">Sprintf</span><span class="op" id="6778549">(</span><span class="string" id="6778550">&#34;CharData(%q)&#34;</span><span class="op" id="6778564">,</span>&nbsp;<span class="ident" id="6778566">have</span><span class="op" id="6778570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6778575">}</span>&nbsp;<span class="keyword" id="6778577">else</span>&nbsp;<span class="op" id="6778582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6778588">shave</span>&nbsp;<span class="op" id="6778594">=</span>&nbsp;<span class="ident" id="6778596">fmt</span><span class="op" id="6778599">.</span><span class="ident" id="6778600">Sprintf</span><span class="op" id="6778607">(</span><span class="string" id="6778608">&#34;%#v&#34;</span><span class="op" id="6778613">,</span>&nbsp;<span class="ident" id="6778615">have</span><span class="op" id="6778619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6778624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6778629">if</span>&nbsp;<span class="ident" id="6778632">_</span><span class="op" id="6778633">,</span>&nbsp;<span class="ident" id="6778635">ok</span>&nbsp;<span class="op" id="6778638">:=</span>&nbsp;<span class="ident" id="6778641">want</span><span class="op" id="6778645">.</span><span class="op" id="6778646">(</span><span class="ident" id="6778647">CharData</span><span class="op" id="6778655">)</span><span class="op" id="6778656">;</span>&nbsp;<span class="ident" id="6778658">ok</span>&nbsp;<span class="op" id="6778661">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6778667">swant</span>&nbsp;<span class="op" id="6778673">=</span>&nbsp;<span class="ident" id="6778675">fmt</span><span class="op" id="6778678">.</span><span class="ident" id="6778679">Sprintf</span><span class="op" id="6778686">(</span><span class="string" id="6778687">&#34;CharData(%q)&#34;</span><span class="op" id="6778701">,</span>&nbsp;<span class="ident" id="6778703">want</span><span class="op" id="6778707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6778712">}</span>&nbsp;<span class="keyword" id="6778714">else</span>&nbsp;<span class="op" id="6778719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6778725">swant</span>&nbsp;<span class="op" id="6778731">=</span>&nbsp;<span class="ident" id="6778733">fmt</span><span class="op" id="6778736">.</span><span class="ident" id="6778737">Sprintf</span><span class="op" id="6778744">(</span><span class="string" id="6778745">&#34;%#v&#34;</span><span class="op" id="6778750">,</span>&nbsp;<span class="ident" id="6778752">want</span><span class="op" id="6778756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6778761">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6778766">t</span><span class="op" id="6778767">.</span><span class="ident" id="6778768">Errorf</span><span class="op" id="6778774">(</span><span class="string" id="6778775">&#34;token&nbsp;%d&nbsp;=&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6778799">,</span>&nbsp;<span class="ident" id="6778801">i</span><span class="op" id="6778802">,</span>&nbsp;<span class="ident" id="6778804">shave</span><span class="op" id="6778809">,</span>&nbsp;<span class="ident" id="6778811">swant</span><span class="op" id="6778816">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6778820">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6778825">//&nbsp;Check&nbsp;that&nbsp;InputOffset&nbsp;returned&nbsp;actual&nbsp;token.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6778876">switch</span>&nbsp;<span class="op" id="6778883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6778887">case</span>&nbsp;<span class="ident" id="6778892">start</span>&nbsp;<span class="op" id="6778898">&lt;</span>&nbsp;<span class="ident" id="6778900">lastEnd</span><span class="op" id="6778907">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6778912">t</span><span class="op" id="6778913">.</span><span class="ident" id="6778914">Errorf</span><span class="op" id="6778920">(</span><span class="string" id="6778921">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;before&nbsp;previous&nbsp;token&#34;</span><span class="op" id="6778981">,</span>&nbsp;<span class="ident" id="6778983">i</span><span class="op" id="6778984">,</span>&nbsp;<span class="ident" id="6778986">start</span><span class="op" id="6778991">,</span>&nbsp;<span class="ident" id="6778993">end</span><span class="op" id="6778996">,</span>&nbsp;<span class="ident" id="6778998">have</span><span class="op" id="6779002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6779006">case</span>&nbsp;<span class="ident" id="6779011">start</span>&nbsp;<span class="op" id="6779017">&gt;=</span>&nbsp;<span class="ident" id="6779020">end</span><span class="op" id="6779023">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6779028">//&nbsp;Special&nbsp;case:&nbsp;EndElement&nbsp;can&nbsp;be&nbsp;synthesized.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6779079">if</span>&nbsp;<span class="ident" id="6779082">start</span>&nbsp;<span class="op" id="6779088">==</span>&nbsp;<span class="ident" id="6779091">end</span>&nbsp;<span class="op" id="6779095">&amp;&amp;</span>&nbsp;<span class="ident" id="6779098">end</span>&nbsp;<span class="op" id="6779102">==</span>&nbsp;<span class="ident" id="6779105">lastEnd</span>&nbsp;<span class="op" id="6779113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6779119">break</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6779128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6779133">t</span><span class="op" id="6779134">.</span><span class="ident" id="6779135">Errorf</span><span class="op" id="6779141">(</span><span class="string" id="6779142">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;is&nbsp;empty&#34;</span><span class="op" id="6779186">,</span>&nbsp;<span class="ident" id="6779188">i</span><span class="op" id="6779189">,</span>&nbsp;<span class="ident" id="6779191">start</span><span class="op" id="6779196">,</span>&nbsp;<span class="ident" id="6779198">end</span><span class="op" id="6779201">,</span>&nbsp;<span class="ident" id="6779203">have</span><span class="op" id="6779207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6779211">case</span>&nbsp;<span class="ident" id="6779216">end</span>&nbsp;<span class="op" id="6779220">&gt;</span>&nbsp;<span class="ident" id="6779222">int64</span><span class="op" id="6779227">(</span><span class="builtinfunc" id="6779228">len</span><span class="op" id="6779231">(</span><span class="ident" id="6779232">raw</span><span class="op" id="6779235">)</span><span class="op" id="6779236">)</span><span class="op" id="6779237">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6779242">t</span><span class="op" id="6779243">.</span><span class="ident" id="6779244">Errorf</span><span class="op" id="6779250">(</span><span class="string" id="6779251">&#34;token&nbsp;%d:&nbsp;position&nbsp;[%d,%d)&nbsp;for&nbsp;%T&nbsp;extends&nbsp;beyond&nbsp;input&#34;</span><span class="op" id="6779307">,</span>&nbsp;<span class="ident" id="6779309">i</span><span class="op" id="6779310">,</span>&nbsp;<span class="ident" id="6779312">start</span><span class="op" id="6779317">,</span>&nbsp;<span class="ident" id="6779319">end</span><span class="op" id="6779322">,</span>&nbsp;<span class="ident" id="6779324">have</span><span class="op" id="6779328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6779332">default</span><span class="op" id="6779339">:</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6779344">text</span>&nbsp;<span class="op" id="6779349">:=</span>&nbsp;<span class="ident" id="6779352">raw</span><span class="op" id="6779355">[</span><span class="ident" id="6779356">start</span><span class="op" id="6779361">:</span><span class="ident" id="6779362">end</span><span class="op" id="6779365">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6779370">if</span>&nbsp;<span class="ident" id="6779373">strings</span><span class="op" id="6779380">.</span><span class="ident" id="6779381">ContainsAny</span><span class="op" id="6779392">(</span><span class="ident" id="6779393">text</span><span class="op" id="6779397">,</span>&nbsp;<span class="string" id="6779399">&#34;&lt;&gt;&#34;</span><span class="op" id="6779403">)</span>&nbsp;<span class="op" id="6779405">&amp;&amp;</span>&nbsp;<span class="op" id="6779408">(</span><span class="op" id="6779409">!</span><span class="ident" id="6779410">strings</span><span class="op" id="6779417">.</span><span class="ident" id="6779418">HasPrefix</span><span class="op" id="6779427">(</span><span class="ident" id="6779428">text</span><span class="op" id="6779432">,</span>&nbsp;<span class="string" id="6779434">&#34;&lt;&#34;</span><span class="op" id="6779437">)</span>&nbsp;<span class="op" id="6779439">||</span>&nbsp;<span class="op" id="6779442">!</span><span class="ident" id="6779443">strings</span><span class="op" id="6779450">.</span><span class="ident" id="6779451">HasSuffix</span><span class="op" id="6779460">(</span><span class="ident" id="6779461">text</span><span class="op" id="6779465">,</span>&nbsp;<span class="string" id="6779467">&#34;&gt;&#34;</span><span class="op" id="6779470">)</span><span class="op" id="6779471">)</span>&nbsp;<span class="op" id="6779473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6779479">t</span><span class="op" id="6779480">.</span><span class="ident" id="6779481">Errorf</span><span class="op" id="6779487">(</span><span class="string" id="6779488">&#34;token&nbsp;%d:&nbsp;misaligned&nbsp;raw&nbsp;token&nbsp;%#q&nbsp;for&nbsp;%T&#34;</span><span class="op" id="6779531">,</span>&nbsp;<span class="ident" id="6779533">i</span><span class="op" id="6779534">,</span>&nbsp;<span class="ident" id="6779536">text</span><span class="op" id="6779540">,</span>&nbsp;<span class="ident" id="6779542">have</span><span class="op" id="6779546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6779551">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6779555">}</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6779559">lastEnd</span>&nbsp;<span class="op" id="6779567">=</span>&nbsp;<span class="ident" id="6779569">end</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6779574">}</span><br>
<span class="lineno"></span><span class="op" id="6779576">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6779579">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;(specifically&nbsp;!DOCTYPE)&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno">330</span><span class="comment" id="6779650">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives,&nbsp;noting&nbsp;that&nbsp;&lt;&nbsp;and&nbsp;&gt;&nbsp;do&nbsp;not&nbsp;change</span><br>
<span class="lineno"></span><span class="comment" id="6779718">//&nbsp;nesting&nbsp;depth&nbsp;if&nbsp;they&nbsp;are&nbsp;in&nbsp;single&nbsp;or&nbsp;double&nbsp;quotes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6779776">var</span>&nbsp;<span class="ident" id="6779780">nestedDirectivesInput</span>&nbsp;<span class="op" id="6779802">=</span>&nbsp;<span class="string" id="6779804">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno">335</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]&gt;<br>
<span class="lineno">340</span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]&gt;<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6780070">var</span>&nbsp;<span class="ident" id="6780074">nestedDirectivesTokens</span>&nbsp;<span class="op" id="6780097">=</span>&nbsp;<span class="op" id="6780099">[</span><span class="op" id="6780100">]</span><span class="ident" id="6780101">Token</span><span class="op" id="6780106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780109">CharData</span><span class="op" id="6780117">(</span><span class="string" id="6780118">&#34;\n&#34;</span><span class="op" id="6780122">)</span><span class="op" id="6780123">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780126">Directive</span><span class="op" id="6780135">(</span><span class="string" id="6780136">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="6780207">)</span><span class="op" id="6780208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780211">CharData</span><span class="op" id="6780219">(</span><span class="string" id="6780220">&#34;\n&#34;</span><span class="op" id="6780224">)</span><span class="op" id="6780225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780228">Directive</span><span class="op" id="6780237">(</span><span class="string" id="6780238">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&gt;&#34;&gt;]`</span><span class="op" id="6780267">)</span><span class="op" id="6780268">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780271">CharData</span><span class="op" id="6780279">(</span><span class="string" id="6780280">&#34;\n&#34;</span><span class="op" id="6780284">)</span><span class="op" id="6780285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780288">Directive</span><span class="op" id="6780297">(</span><span class="string" id="6780298">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&lt;&#34;&gt;]`</span><span class="op" id="6780327">)</span><span class="op" id="6780328">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780331">CharData</span><span class="op" id="6780339">(</span><span class="string" id="6780340">&#34;\n&#34;</span><span class="op" id="6780344">)</span><span class="op" id="6780345">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780348">Directive</span><span class="op" id="6780357">(</span><span class="string" id="6780358">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&gt;&#39;&gt;]`</span><span class="op" id="6780387">)</span><span class="op" id="6780388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780391">CharData</span><span class="op" id="6780399">(</span><span class="string" id="6780400">&#34;\n&#34;</span><span class="op" id="6780404">)</span><span class="op" id="6780405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780408">Directive</span><span class="op" id="6780417">(</span><span class="string" id="6780418">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&lt;&#39;&gt;]`</span><span class="op" id="6780447">)</span><span class="op" id="6780448">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780451">CharData</span><span class="op" id="6780459">(</span><span class="string" id="6780460">&#34;\n&#34;</span><span class="op" id="6780464">)</span><span class="op" id="6780465">,</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780468">Directive</span><span class="op" id="6780477">(</span><span class="string" id="6780478">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#39;&#34;&gt;&#39;&gt;]`</span><span class="op" id="6780508">)</span><span class="op" id="6780509">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780512">CharData</span><span class="op" id="6780520">(</span><span class="string" id="6780521">&#34;\n&#34;</span><span class="op" id="6780525">)</span><span class="op" id="6780526">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780529">Directive</span><span class="op" id="6780538">(</span><span class="string" id="6780539">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;xlt&nbsp;&#34;&#39;&lt;&#34;&gt;]`</span><span class="op" id="6780569">)</span><span class="op" id="6780570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780573">CharData</span><span class="op" id="6780581">(</span><span class="string" id="6780582">&#34;\n&#34;</span><span class="op" id="6780586">)</span><span class="op" id="6780587">,</span><br>
<span class="lineno"></span><span class="op" id="6780589">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="keyword" id="6780592">func</span>&nbsp;<span class="ident" id="6780597">TestNestedDirectives</span><span class="op" id="6780617">(</span><span class="ident" id="6780618">t</span>&nbsp;<span class="op" id="6780620">*</span><span class="ident" id="6780621">testing</span><span class="op" id="6780628">.</span><span class="ident" id="6780629">T</span><span class="op" id="6780630">)</span>&nbsp;<span class="op" id="6780632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780635">d</span>&nbsp;<span class="op" id="6780637">:=</span>&nbsp;<span class="ident" id="6780640">NewDecoder</span><span class="op" id="6780650">(</span><span class="ident" id="6780651">strings</span><span class="op" id="6780658">.</span><span class="ident" id="6780659">NewReader</span><span class="op" id="6780668">(</span><span class="ident" id="6780669">nestedDirectivesInput</span><span class="op" id="6780690">)</span><span class="op" id="6780691">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6780695">for</span>&nbsp;<span class="ident" id="6780699">i</span><span class="op" id="6780700">,</span>&nbsp;<span class="ident" id="6780702">want</span>&nbsp;<span class="op" id="6780707">:=</span>&nbsp;<span class="keyword" id="6780710">range</span>&nbsp;<span class="ident" id="6780716">nestedDirectivesTokens</span>&nbsp;<span class="op" id="6780739">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780743">have</span><span class="op" id="6780747">,</span>&nbsp;<span class="ident" id="6780749">err</span>&nbsp;<span class="op" id="6780753">:=</span>&nbsp;<span class="ident" id="6780756">d</span><span class="op" id="6780757">.</span><span class="ident" id="6780758">Token</span><span class="op" id="6780763">(</span><span class="op" id="6780764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6780768">if</span>&nbsp;<span class="ident" id="6780771">err</span>&nbsp;<span class="op" id="6780775">!=</span>&nbsp;<span class="ident" id="6780778">nil</span>&nbsp;<span class="op" id="6780782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780787">t</span><span class="op" id="6780788">.</span><span class="ident" id="6780789">Fatalf</span><span class="op" id="6780795">(</span><span class="string" id="6780796">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6780828">,</span>&nbsp;<span class="ident" id="6780830">i</span><span class="op" id="6780831">,</span>&nbsp;<span class="ident" id="6780833">err</span><span class="op" id="6780836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6780840">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6780844">if</span>&nbsp;<span class="op" id="6780847">!</span><span class="ident" id="6780848">reflect</span><span class="op" id="6780855">.</span><span class="ident" id="6780856">DeepEqual</span><span class="op" id="6780865">(</span><span class="ident" id="6780866">have</span><span class="op" id="6780870">,</span>&nbsp;<span class="ident" id="6780872">want</span><span class="op" id="6780876">)</span>&nbsp;<span class="op" id="6780878">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780883">t</span><span class="op" id="6780884">.</span><span class="ident" id="6780885">Errorf</span><span class="op" id="6780891">(</span><span class="string" id="6780892">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="6780917">,</span>&nbsp;<span class="ident" id="6780919">i</span><span class="op" id="6780920">,</span>&nbsp;<span class="ident" id="6780922">have</span><span class="op" id="6780926">,</span>&nbsp;<span class="ident" id="6780928">want</span><span class="op" id="6780932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6780936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6780939">}</span><br>
<span class="lineno"></span><span class="op" id="6780941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">375</span><span class="keyword" id="6780944">func</span>&nbsp;<span class="ident" id="6780949">TestToken</span><span class="op" id="6780958">(</span><span class="ident" id="6780959">t</span>&nbsp;<span class="op" id="6780961">*</span><span class="ident" id="6780962">testing</span><span class="op" id="6780969">.</span><span class="ident" id="6780970">T</span><span class="op" id="6780971">)</span>&nbsp;<span class="op" id="6780973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6780976">d</span>&nbsp;<span class="op" id="6780978">:=</span>&nbsp;<span class="ident" id="6780981">NewDecoder</span><span class="op" id="6780991">(</span><span class="ident" id="6780992">strings</span><span class="op" id="6780999">.</span><span class="ident" id="6781000">NewReader</span><span class="op" id="6781009">(</span><span class="ident" id="6781010">testInput</span><span class="op" id="6781019">)</span><span class="op" id="6781020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781023">d</span><span class="op" id="6781024">.</span><span class="ident" id="6781025">Entity</span>&nbsp;<span class="op" id="6781032">=</span>&nbsp;<span class="ident" id="6781034">testEntity</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6781047">for</span>&nbsp;<span class="ident" id="6781051">i</span><span class="op" id="6781052">,</span>&nbsp;<span class="ident" id="6781054">want</span>&nbsp;<span class="op" id="6781059">:=</span>&nbsp;<span class="keyword" id="6781062">range</span>&nbsp;<span class="ident" id="6781068">cookedTokens</span>&nbsp;<span class="op" id="6781081">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781085">have</span><span class="op" id="6781089">,</span>&nbsp;<span class="ident" id="6781091">err</span>&nbsp;<span class="op" id="6781095">:=</span>&nbsp;<span class="ident" id="6781098">d</span><span class="op" id="6781099">.</span><span class="ident" id="6781100">Token</span><span class="op" id="6781105">(</span><span class="op" id="6781106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6781110">if</span>&nbsp;<span class="ident" id="6781113">err</span>&nbsp;<span class="op" id="6781117">!=</span>&nbsp;<span class="ident" id="6781120">nil</span>&nbsp;<span class="op" id="6781124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781129">t</span><span class="op" id="6781130">.</span><span class="ident" id="6781131">Fatalf</span><span class="op" id="6781137">(</span><span class="string" id="6781138">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6781170">,</span>&nbsp;<span class="ident" id="6781172">i</span><span class="op" id="6781173">,</span>&nbsp;<span class="ident" id="6781175">err</span><span class="op" id="6781178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6781182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6781186">if</span>&nbsp;<span class="op" id="6781189">!</span><span class="ident" id="6781190">reflect</span><span class="op" id="6781197">.</span><span class="ident" id="6781198">DeepEqual</span><span class="op" id="6781207">(</span><span class="ident" id="6781208">have</span><span class="op" id="6781212">,</span>&nbsp;<span class="ident" id="6781214">want</span><span class="op" id="6781218">)</span>&nbsp;<span class="op" id="6781220">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781225">t</span><span class="op" id="6781226">.</span><span class="ident" id="6781227">Errorf</span><span class="op" id="6781233">(</span><span class="string" id="6781234">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="6781259">,</span>&nbsp;<span class="ident" id="6781261">i</span><span class="op" id="6781262">,</span>&nbsp;<span class="ident" id="6781264">have</span><span class="op" id="6781268">,</span>&nbsp;<span class="ident" id="6781270">want</span><span class="op" id="6781274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6781278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6781281">}</span><br>
<span class="lineno"></span><span class="op" id="6781283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span><span class="keyword" id="6781286">func</span>&nbsp;<span class="ident" id="6781291">TestSyntax</span><span class="op" id="6781301">(</span><span class="ident" id="6781302">t</span>&nbsp;<span class="op" id="6781304">*</span><span class="ident" id="6781305">testing</span><span class="op" id="6781312">.</span><span class="ident" id="6781313">T</span><span class="op" id="6781314">)</span>&nbsp;<span class="op" id="6781316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6781319">for</span>&nbsp;<span class="ident" id="6781323">i</span>&nbsp;<span class="op" id="6781325">:=</span>&nbsp;<span class="keyword" id="6781328">range</span>&nbsp;<span class="ident" id="6781334">xmlInput</span>&nbsp;<span class="op" id="6781343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781347">d</span>&nbsp;<span class="op" id="6781349">:=</span>&nbsp;<span class="ident" id="6781352">NewDecoder</span><span class="op" id="6781362">(</span><span class="ident" id="6781363">strings</span><span class="op" id="6781370">.</span><span class="ident" id="6781371">NewReader</span><span class="op" id="6781380">(</span><span class="ident" id="6781381">xmlInput</span><span class="op" id="6781389">[</span><span class="ident" id="6781390">i</span><span class="op" id="6781391">]</span><span class="op" id="6781392">)</span><span class="op" id="6781393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6781397">var</span>&nbsp;<span class="ident" id="6781401">err</span>&nbsp;<span class="builtintype" id="6781405">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6781413">for</span>&nbsp;<span class="ident" id="6781417">_</span><span class="op" id="6781418">,</span>&nbsp;<span class="ident" id="6781420">err</span>&nbsp;<span class="op" id="6781424">=</span>&nbsp;<span class="ident" id="6781426">d</span><span class="op" id="6781427">.</span><span class="ident" id="6781428">Token</span><span class="op" id="6781433">(</span><span class="op" id="6781434">)</span><span class="op" id="6781435">;</span>&nbsp;<span class="ident" id="6781437">err</span>&nbsp;<span class="op" id="6781441">==</span>&nbsp;<span class="ident" id="6781444">nil</span><span class="op" id="6781447">;</span>&nbsp;<span class="ident" id="6781449">_</span><span class="op" id="6781450">,</span>&nbsp;<span class="ident" id="6781452">err</span>&nbsp;<span class="op" id="6781456">=</span>&nbsp;<span class="ident" id="6781458">d</span><span class="op" id="6781459">.</span><span class="ident" id="6781460">Token</span><span class="op" id="6781465">(</span><span class="op" id="6781466">)</span>&nbsp;<span class="op" id="6781468">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6781472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6781476">if</span>&nbsp;<span class="ident" id="6781479">_</span><span class="op" id="6781480">,</span>&nbsp;<span class="ident" id="6781482">ok</span>&nbsp;<span class="op" id="6781485">:=</span>&nbsp;<span class="ident" id="6781488">err</span><span class="op" id="6781491">.</span><span class="op" id="6781492">(</span><span class="op" id="6781493">*</span><span class="ident" id="6781494">SyntaxError</span><span class="op" id="6781505">)</span><span class="op" id="6781506">;</span>&nbsp;<span class="op" id="6781508">!</span><span class="ident" id="6781509">ok</span>&nbsp;<span class="op" id="6781512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781517">t</span><span class="op" id="6781518">.</span><span class="ident" id="6781519">Fatalf</span><span class="op" id="6781525">(</span><span class="string" id="6781526">`xmlInput&nbsp;&#34;%s&#34;:&nbsp;expected&nbsp;SyntaxError&nbsp;not&nbsp;received`</span><span class="op" id="6781576">,</span>&nbsp;<span class="ident" id="6781578">xmlInput</span><span class="op" id="6781586">[</span><span class="ident" id="6781587">i</span><span class="op" id="6781588">]</span><span class="op" id="6781589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6781593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6781596">}</span><br>
<span class="lineno">400</span><span class="op" id="6781598">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6781601">type</span>&nbsp;<span class="ident" id="6781606">allScalars</span>&nbsp;<span class="keyword" id="6781617">struct</span>&nbsp;<span class="op" id="6781624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781627">True1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6781637">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781643">True2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6781653">bool</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781659">False1</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6781669">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781675">False2</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6781685">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781691">Int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6781701">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781706">Int8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6781716">int8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781722">Int16</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6781732">int16</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781739">Int32</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6781749">int32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781756">Int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781766">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781773">Uint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6781783">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781788">Uint8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6781798">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781805">Uint16</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6781815">uint16</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781823">Uint32</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6781833">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781841">Uint64</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781851">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781859">Uintptr</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6781869">uintptr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781878">Float32</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6781888">float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781897">Float64</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6781907">float64</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781916">String</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6781926">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781934">PtrString</span>&nbsp;<span class="op" id="6781944">*</span><span class="builtintype" id="6781945">string</span><br>
<span class="lineno"></span><span class="op" id="6781952">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6781955">var</span>&nbsp;<span class="ident" id="6781959">all</span>&nbsp;<span class="op" id="6781963">=</span>&nbsp;<span class="ident" id="6781965">allScalars</span><span class="op" id="6781975">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781978">True1</span><span class="op" id="6781983">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6781989">true</span><span class="op" id="6781993">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6781996">True2</span><span class="op" id="6782001">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6782007">true</span><span class="op" id="6782011">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782014">False1</span><span class="op" id="6782020">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6782025">false</span><span class="op" id="6782030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782033">False2</span><span class="op" id="6782039">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6782044">false</span><span class="op" id="6782049">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782052">Int</span><span class="op" id="6782055">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6782063">1</span><span class="op" id="6782064">,</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782067">Int8</span><span class="op" id="6782071">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6782078">-</span><span class="num" id="6782079">2</span><span class="op" id="6782080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782083">Int16</span><span class="op" id="6782088">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6782094">3</span><span class="op" id="6782095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782098">Int32</span><span class="op" id="6782103">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6782109">-</span><span class="num" id="6782110">4</span><span class="op" id="6782111">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782114">Int64</span><span class="op" id="6782119">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6782125">5</span><span class="op" id="6782126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782129">Uint</span><span class="op" id="6782133">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6782140">6</span><span class="op" id="6782141">,</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782144">Uint8</span><span class="op" id="6782149">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6782155">7</span><span class="op" id="6782156">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782159">Uint16</span><span class="op" id="6782165">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6782170">8</span><span class="op" id="6782171">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782174">Uint32</span><span class="op" id="6782180">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6782185">9</span><span class="op" id="6782186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782189">Uint64</span><span class="op" id="6782195">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="6782200">10</span><span class="op" id="6782202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782205">Uintptr</span><span class="op" id="6782212">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6782216">11</span><span class="op" id="6782218">,</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782221">Float32</span><span class="op" id="6782228">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6782232">13.0</span><span class="op" id="6782236">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782239">Float64</span><span class="op" id="6782246">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="6782250">14.0</span><span class="op" id="6782254">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782257">String</span><span class="op" id="6782263">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="6782268">&#34;15&#34;</span><span class="op" id="6782272">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782275">PtrString</span><span class="op" id="6782284">:</span>&nbsp;<span class="op" id="6782286">&amp;</span><span class="ident" id="6782287">sixteen</span><span class="op" id="6782294">,</span><br>
<span class="lineno"></span><span class="op" id="6782296">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span><span class="keyword" id="6782299">var</span>&nbsp;<span class="ident" id="6782303">sixteen</span>&nbsp;<span class="op" id="6782311">=</span>&nbsp;<span class="string" id="6782313">&#34;16&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6782319">const</span>&nbsp;<span class="ident" id="6782325">testScalarsInput</span>&nbsp;<span class="op" id="6782342">=</span>&nbsp;<span class="string" id="6782344">`&lt;allscalars&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;True1&gt;true&lt;/True1&gt;<br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;True2&gt;1&lt;/True2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;False1&gt;false&lt;/False1&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;False2&gt;0&lt;/False2&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int&gt;1&lt;/Int&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int8&gt;-2&lt;/Int8&gt;<br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int16&gt;3&lt;/Int16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int32&gt;-4&lt;/Int32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Int64&gt;5&lt;/Int64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint&gt;6&lt;/Uint&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint8&gt;7&lt;/Uint8&gt;<br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint16&gt;8&lt;/Uint16&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint32&gt;9&lt;/Uint32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uint64&gt;10&lt;/Uint64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Uintptr&gt;11&lt;/Uintptr&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Float&gt;12.0&lt;/Float&gt;<br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Float32&gt;13.0&lt;/Float32&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;Float64&gt;14.0&lt;/Float64&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;String&gt;15&lt;/String&gt;<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&lt;PtrString&gt;16&lt;/PtrString&gt;<br>
<span class="lineno"></span>&lt;/allscalars&gt;`</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span><span class="keyword" id="6782780">func</span>&nbsp;<span class="ident" id="6782785">TestAllScalars</span><span class="op" id="6782799">(</span><span class="ident" id="6782800">t</span>&nbsp;<span class="op" id="6782802">*</span><span class="ident" id="6782803">testing</span><span class="op" id="6782810">.</span><span class="ident" id="6782811">T</span><span class="op" id="6782812">)</span>&nbsp;<span class="op" id="6782814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6782817">var</span>&nbsp;<span class="ident" id="6782821">a</span>&nbsp;<span class="ident" id="6782823">allScalars</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782835">err</span>&nbsp;<span class="op" id="6782839">:=</span>&nbsp;<span class="ident" id="6782842">Unmarshal</span><span class="op" id="6782851">(</span><span class="op" id="6782852">[</span><span class="op" id="6782853">]</span><span class="builtintype" id="6782854">byte</span><span class="op" id="6782858">(</span><span class="ident" id="6782859">testScalarsInput</span><span class="op" id="6782875">)</span><span class="op" id="6782876">,</span>&nbsp;<span class="op" id="6782878">&amp;</span><span class="ident" id="6782879">a</span><span class="op" id="6782880">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6782884">if</span>&nbsp;<span class="ident" id="6782887">err</span>&nbsp;<span class="op" id="6782891">!=</span>&nbsp;<span class="ident" id="6782894">nil</span>&nbsp;<span class="op" id="6782898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782902">t</span><span class="op" id="6782903">.</span><span class="ident" id="6782904">Fatal</span><span class="op" id="6782909">(</span><span class="ident" id="6782910">err</span><span class="op" id="6782913">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6782916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6782919">if</span>&nbsp;<span class="op" id="6782922">!</span><span class="ident" id="6782923">reflect</span><span class="op" id="6782930">.</span><span class="ident" id="6782931">DeepEqual</span><span class="op" id="6782940">(</span><span class="ident" id="6782941">a</span><span class="op" id="6782942">,</span>&nbsp;<span class="ident" id="6782944">all</span><span class="op" id="6782947">)</span>&nbsp;<span class="op" id="6782949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6782953">t</span><span class="op" id="6782954">.</span><span class="ident" id="6782955">Errorf</span><span class="op" id="6782961">(</span><span class="string" id="6782962">&#34;have&nbsp;%+v&nbsp;want&nbsp;%+v&#34;</span><span class="op" id="6782981">,</span>&nbsp;<span class="ident" id="6782983">a</span><span class="op" id="6782984">,</span>&nbsp;<span class="ident" id="6782986">all</span><span class="op" id="6782989">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6782992">}</span><br>
<span class="lineno"></span><span class="op" id="6782994">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6782997">type</span>&nbsp;<span class="ident" id="6783002">item</span>&nbsp;<span class="keyword" id="6783007">struct</span>&nbsp;<span class="op" id="6783014">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6783017">Field_a</span>&nbsp;<span class="builtintype" id="6783025">string</span><br>
<span class="lineno">485</span><span class="op" id="6783032">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6783035">func</span>&nbsp;<span class="ident" id="6783040">TestIssue569</span><span class="op" id="6783052">(</span><span class="ident" id="6783053">t</span>&nbsp;<span class="op" id="6783055">*</span><span class="ident" id="6783056">testing</span><span class="op" id="6783063">.</span><span class="ident" id="6783064">T</span><span class="op" id="6783065">)</span>&nbsp;<span class="op" id="6783067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6783070">data</span>&nbsp;<span class="op" id="6783075">:=</span>&nbsp;<span class="string" id="6783078">`&lt;item&gt;&lt;Field_a&gt;abcd&lt;/Field_a&gt;&lt;/item&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6783118">var</span>&nbsp;<span class="ident" id="6783122">i</span>&nbsp;<span class="ident" id="6783124">item</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6783130">err</span>&nbsp;<span class="op" id="6783134">:=</span>&nbsp;<span class="ident" id="6783137">Unmarshal</span><span class="op" id="6783146">(</span><span class="op" id="6783147">[</span><span class="op" id="6783148">]</span><span class="builtintype" id="6783149">byte</span><span class="op" id="6783153">(</span><span class="ident" id="6783154">data</span><span class="op" id="6783158">)</span><span class="op" id="6783159">,</span>&nbsp;<span class="op" id="6783161">&amp;</span><span class="ident" id="6783162">i</span><span class="op" id="6783163">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6783167">if</span>&nbsp;<span class="ident" id="6783170">err</span>&nbsp;<span class="op" id="6783174">!=</span>&nbsp;<span class="ident" id="6783177">nil</span>&nbsp;<span class="op" id="6783181">||</span>&nbsp;<span class="ident" id="6783184">i</span><span class="op" id="6783185">.</span><span class="ident" id="6783186">Field_a</span>&nbsp;<span class="op" id="6783194">!=</span>&nbsp;<span class="string" id="6783197">&#34;abcd&#34;</span>&nbsp;<span class="op" id="6783204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6783208">t</span><span class="op" id="6783209">.</span><span class="ident" id="6783210">Fatal</span><span class="op" id="6783215">(</span><span class="string" id="6783216">&#34;Expecting&nbsp;abcd&#34;</span><span class="op" id="6783232">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6783235">}</span><br>
<span class="lineno">495</span><span class="op" id="6783237">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6783240">func</span>&nbsp;<span class="ident" id="6783245">TestUnquotedAttrs</span><span class="op" id="6783262">(</span><span class="ident" id="6783263">t</span>&nbsp;<span class="op" id="6783265">*</span><span class="ident" id="6783266">testing</span><span class="op" id="6783273">.</span><span class="ident" id="6783274">T</span><span class="op" id="6783275">)</span>&nbsp;<span class="op" id="6783277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6783280">data</span>&nbsp;<span class="op" id="6783285">:=</span>&nbsp;<span class="string" id="6783288">&#34;&lt;tag&nbsp;attr=azAZ09:-_\t&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6783314">d</span>&nbsp;<span class="op" id="6783316">:=</span>&nbsp;<span class="ident" id="6783319">NewDecoder</span><span class="op" id="6783329">(</span><span class="ident" id="6783330">strings</span><span class="op" id="6783337">.</span><span class="ident" id="6783338">NewReader</span><span class="op" id="6783347">(</span><span class="ident" id="6783348">data</span><span class="op" id="6783352">)</span><span class="op" id="6783353">)</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6783356">d</span><span class="op" id="6783357">.</span><span class="ident" id="6783358">Strict</span>&nbsp;<span class="op" id="6783365">=</span>&nbsp;<span class="builtintype" id="6783367">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6783374">token</span><span class="op" id="6783379">,</span>&nbsp;<span class="ident" id="6783381">err</span>&nbsp;<span class="op" id="6783385">:=</span>&nbsp;<span class="ident" id="6783388">d</span><span class="op" id="6783389">.</span><span class="ident" id="6783390">Token</span><span class="op" id="6783395">(</span><span class="op" id="6783396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6783399">if</span>&nbsp;<span class="ident" id="6783402">_</span><span class="op" id="6783403">,</span>&nbsp;<span class="ident" id="6783405">ok</span>&nbsp;<span class="op" id="6783408">:=</span>&nbsp;<span class="ident" id="6783411">err</span><span class="op" id="6783414">.</span><span class="op" id="6783415">(</span><span class="op" id="6783416">*</span><span class="ident" id="6783417">SyntaxError</span><span class="op" id="6783428">)</span><span class="op" id="6783429">;</span>&nbsp;<span class="ident" id="6783431">ok</span>&nbsp;<span class="op" id="6783434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6783438">t</span><span class="op" id="6783439">.</span><span class="ident" id="6783440">Errorf</span><span class="op" id="6783446">(</span><span class="string" id="6783447">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6783469">,</span>&nbsp;<span class="ident" id="6783471">err</span><span class="op" id="6783474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6783477">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6783480">if</span>&nbsp;<span class="ident" id="6783483">token</span><span class="op" id="6783488">.</span><span class="op" id="6783489">(</span><span class="ident" id="6783490">StartElement</span><span class="op" id="6783502">)</span><span class="op" id="6783503">.</span><span class="ident" id="6783504">Name</span><span class="op" id="6783508">.</span><span class="ident" id="6783509">Local</span>&nbsp;<span class="op" id="6783515">!=</span>&nbsp;<span class="string" id="6783518">&#34;tag&#34;</span>&nbsp;<span class="op" id="6783524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6783528">t</span><span class="op" id="6783529">.</span><span class="ident" id="6783530">Errorf</span><span class="op" id="6783536">(</span><span class="string" id="6783537">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="6783562">,</span>&nbsp;<span class="ident" id="6783564">token</span><span class="op" id="6783569">.</span><span class="op" id="6783570">(</span><span class="ident" id="6783571">StartElement</span><span class="op" id="6783583">)</span><span class="op" id="6783584">.</span><span class="ident" id="6783585">Name</span><span class="op" id="6783589">.</span><span class="ident" id="6783590">Local</span><span class="op" id="6783595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6783598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6783601">attr</span>&nbsp;<span class="op" id="6783606">:=</span>&nbsp;<span class="ident" id="6783609">token</span><span class="op" id="6783614">.</span><span class="op" id="6783615">(</span><span class="ident" id="6783616">StartElement</span><span class="op" id="6783628">)</span><span class="op" id="6783629">.</span><span class="ident" id="6783630">Attr</span><span class="op" id="6783634">[</span><span class="num" id="6783635">0</span><span class="op" id="6783636">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6783639">if</span>&nbsp;<span class="ident" id="6783642">attr</span><span class="op" id="6783646">.</span><span class="ident" id="6783647">Value</span>&nbsp;<span class="op" id="6783653">!=</span>&nbsp;<span class="string" id="6783656">&#34;azAZ09:-_&#34;</span>&nbsp;<span class="op" id="6783668">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6783672">t</span><span class="op" id="6783673">.</span><span class="ident" id="6783674">Errorf</span><span class="op" id="6783680">(</span><span class="string" id="6783681">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="6783713">,</span>&nbsp;<span class="ident" id="6783715">attr</span><span class="op" id="6783719">.</span><span class="ident" id="6783720">Value</span><span class="op" id="6783725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6783728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6783731">if</span>&nbsp;<span class="ident" id="6783734">attr</span><span class="op" id="6783738">.</span><span class="ident" id="6783739">Name</span><span class="op" id="6783743">.</span><span class="ident" id="6783744">Local</span>&nbsp;<span class="op" id="6783750">!=</span>&nbsp;<span class="string" id="6783753">&#34;attr&#34;</span>&nbsp;<span class="op" id="6783760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6783764">t</span><span class="op" id="6783765">.</span><span class="ident" id="6783766">Errorf</span><span class="op" id="6783772">(</span><span class="string" id="6783773">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="6783804">,</span>&nbsp;<span class="ident" id="6783806">attr</span><span class="op" id="6783810">.</span><span class="ident" id="6783811">Name</span><span class="op" id="6783815">.</span><span class="ident" id="6783816">Local</span><span class="op" id="6783821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6783824">}</span><br>
<span class="lineno">515</span><span class="op" id="6783826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6783829">func</span>&nbsp;<span class="ident" id="6783834">TestValuelessAttrs</span><span class="op" id="6783852">(</span><span class="ident" id="6783853">t</span>&nbsp;<span class="op" id="6783855">*</span><span class="ident" id="6783856">testing</span><span class="op" id="6783863">.</span><span class="ident" id="6783864">T</span><span class="op" id="6783865">)</span>&nbsp;<span class="op" id="6783867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6783870">tests</span>&nbsp;<span class="op" id="6783876">:=</span>&nbsp;<span class="op" id="6783879">[</span><span class="op" id="6783880">]</span><span class="op" id="6783881">[</span><span class="num" id="6783882">3</span><span class="op" id="6783883">]</span><span class="builtintype" id="6783884">string</span><span class="op" id="6783890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6783894">{</span><span class="string" id="6783895">&#34;&lt;p&nbsp;nowrap&gt;&#34;</span><span class="op" id="6783907">,</span>&nbsp;<span class="string" id="6783909">&#34;p&#34;</span><span class="op" id="6783912">,</span>&nbsp;<span class="string" id="6783914">&#34;nowrap&#34;</span><span class="op" id="6783922">}</span><span class="op" id="6783923">,</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6783927">{</span><span class="string" id="6783928">&#34;&lt;p&nbsp;nowrap&nbsp;&gt;&#34;</span><span class="op" id="6783941">,</span>&nbsp;<span class="string" id="6783943">&#34;p&#34;</span><span class="op" id="6783946">,</span>&nbsp;<span class="string" id="6783948">&#34;nowrap&#34;</span><span class="op" id="6783956">}</span><span class="op" id="6783957">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6783961">{</span><span class="string" id="6783962">&#34;&lt;input&nbsp;checked/&gt;&#34;</span><span class="op" id="6783980">,</span>&nbsp;<span class="string" id="6783982">&#34;input&#34;</span><span class="op" id="6783989">,</span>&nbsp;<span class="string" id="6783991">&#34;checked&#34;</span><span class="op" id="6784000">}</span><span class="op" id="6784001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6784005">{</span><span class="string" id="6784006">&#34;&lt;input&nbsp;checked&nbsp;/&gt;&#34;</span><span class="op" id="6784025">,</span>&nbsp;<span class="string" id="6784027">&#34;input&#34;</span><span class="op" id="6784034">,</span>&nbsp;<span class="string" id="6784036">&#34;checked&#34;</span><span class="op" id="6784045">}</span><span class="op" id="6784046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6784049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6784052">for</span>&nbsp;<span class="ident" id="6784056">_</span><span class="op" id="6784057">,</span>&nbsp;<span class="ident" id="6784059">test</span>&nbsp;<span class="op" id="6784064">:=</span>&nbsp;<span class="keyword" id="6784067">range</span>&nbsp;<span class="ident" id="6784073">tests</span>&nbsp;<span class="op" id="6784079">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6784083">d</span>&nbsp;<span class="op" id="6784085">:=</span>&nbsp;<span class="ident" id="6784088">NewDecoder</span><span class="op" id="6784098">(</span><span class="ident" id="6784099">strings</span><span class="op" id="6784106">.</span><span class="ident" id="6784107">NewReader</span><span class="op" id="6784116">(</span><span class="ident" id="6784117">test</span><span class="op" id="6784121">[</span><span class="num" id="6784122">0</span><span class="op" id="6784123">]</span><span class="op" id="6784124">)</span><span class="op" id="6784125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6784129">d</span><span class="op" id="6784130">.</span><span class="ident" id="6784131">Strict</span>&nbsp;<span class="op" id="6784138">=</span>&nbsp;<span class="builtintype" id="6784140">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6784148">token</span><span class="op" id="6784153">,</span>&nbsp;<span class="ident" id="6784155">err</span>&nbsp;<span class="op" id="6784159">:=</span>&nbsp;<span class="ident" id="6784162">d</span><span class="op" id="6784163">.</span><span class="ident" id="6784164">Token</span><span class="op" id="6784169">(</span><span class="op" id="6784170">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6784174">if</span>&nbsp;<span class="ident" id="6784177">_</span><span class="op" id="6784178">,</span>&nbsp;<span class="ident" id="6784180">ok</span>&nbsp;<span class="op" id="6784183">:=</span>&nbsp;<span class="ident" id="6784186">err</span><span class="op" id="6784189">.</span><span class="op" id="6784190">(</span><span class="op" id="6784191">*</span><span class="ident" id="6784192">SyntaxError</span><span class="op" id="6784203">)</span><span class="op" id="6784204">;</span>&nbsp;<span class="ident" id="6784206">ok</span>&nbsp;<span class="op" id="6784209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6784214">t</span><span class="op" id="6784215">.</span><span class="ident" id="6784216">Errorf</span><span class="op" id="6784222">(</span><span class="string" id="6784223">&#34;Unexpected&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6784245">,</span>&nbsp;<span class="ident" id="6784247">err</span><span class="op" id="6784250">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6784254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6784258">if</span>&nbsp;<span class="ident" id="6784261">token</span><span class="op" id="6784266">.</span><span class="op" id="6784267">(</span><span class="ident" id="6784268">StartElement</span><span class="op" id="6784280">)</span><span class="op" id="6784281">.</span><span class="ident" id="6784282">Name</span><span class="op" id="6784286">.</span><span class="ident" id="6784287">Local</span>&nbsp;<span class="op" id="6784293">!=</span>&nbsp;<span class="ident" id="6784296">test</span><span class="op" id="6784300">[</span><span class="num" id="6784301">1</span><span class="op" id="6784302">]</span>&nbsp;<span class="op" id="6784304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6784309">t</span><span class="op" id="6784310">.</span><span class="ident" id="6784311">Errorf</span><span class="op" id="6784317">(</span><span class="string" id="6784318">&#34;Unexpected&nbsp;tag&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="6784343">,</span>&nbsp;<span class="ident" id="6784345">token</span><span class="op" id="6784350">.</span><span class="op" id="6784351">(</span><span class="ident" id="6784352">StartElement</span><span class="op" id="6784364">)</span><span class="op" id="6784365">.</span><span class="ident" id="6784366">Name</span><span class="op" id="6784370">.</span><span class="ident" id="6784371">Local</span><span class="op" id="6784376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6784380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6784384">attr</span>&nbsp;<span class="op" id="6784389">:=</span>&nbsp;<span class="ident" id="6784392">token</span><span class="op" id="6784397">.</span><span class="op" id="6784398">(</span><span class="ident" id="6784399">StartElement</span><span class="op" id="6784411">)</span><span class="op" id="6784412">.</span><span class="ident" id="6784413">Attr</span><span class="op" id="6784417">[</span><span class="num" id="6784418">0</span><span class="op" id="6784419">]</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6784423">if</span>&nbsp;<span class="ident" id="6784426">attr</span><span class="op" id="6784430">.</span><span class="ident" id="6784431">Value</span>&nbsp;<span class="op" id="6784437">!=</span>&nbsp;<span class="ident" id="6784440">test</span><span class="op" id="6784444">[</span><span class="num" id="6784445">2</span><span class="op" id="6784446">]</span>&nbsp;<span class="op" id="6784448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6784453">t</span><span class="op" id="6784454">.</span><span class="ident" id="6784455">Errorf</span><span class="op" id="6784461">(</span><span class="string" id="6784462">&#34;Unexpected&nbsp;attribute&nbsp;value:&nbsp;%v&#34;</span><span class="op" id="6784494">,</span>&nbsp;<span class="ident" id="6784496">attr</span><span class="op" id="6784500">.</span><span class="ident" id="6784501">Value</span><span class="op" id="6784506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6784510">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6784514">if</span>&nbsp;<span class="ident" id="6784517">attr</span><span class="op" id="6784521">.</span><span class="ident" id="6784522">Name</span><span class="op" id="6784526">.</span><span class="ident" id="6784527">Local</span>&nbsp;<span class="op" id="6784533">!=</span>&nbsp;<span class="ident" id="6784536">test</span><span class="op" id="6784540">[</span><span class="num" id="6784541">2</span><span class="op" id="6784542">]</span>&nbsp;<span class="op" id="6784544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6784549">t</span><span class="op" id="6784550">.</span><span class="ident" id="6784551">Errorf</span><span class="op" id="6784557">(</span><span class="string" id="6784558">&#34;Unexpected&nbsp;attribute&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="6784589">,</span>&nbsp;<span class="ident" id="6784591">attr</span><span class="op" id="6784595">.</span><span class="ident" id="6784596">Name</span><span class="op" id="6784600">.</span><span class="ident" id="6784601">Local</span><span class="op" id="6784606">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6784610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6784613">}</span><br>
<span class="lineno"></span><span class="op" id="6784615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6784618">func</span>&nbsp;<span class="ident" id="6784623">TestCopyTokenCharData</span><span class="op" id="6784644">(</span><span class="ident" id="6784645">t</span>&nbsp;<span class="op" id="6784647">*</span><span class="ident" id="6784648">testing</span><span class="op" id="6784655">.</span><span class="ident" id="6784656">T</span><span class="op" id="6784657">)</span>&nbsp;<span class="op" id="6784659">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6784662">data</span>&nbsp;<span class="op" id="6784667">:=</span>&nbsp;<span class="op" id="6784670">[</span><span class="op" id="6784671">]</span><span class="builtintype" id="6784672">byte</span><span class="op" id="6784676">(</span><span class="string" id="6784677">&#34;same&nbsp;data&#34;</span><span class="op" id="6784688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6784691">var</span>&nbsp;<span class="ident" id="6784695">tok1</span>&nbsp;<span class="ident" id="6784700">Token</span>&nbsp;<span class="op" id="6784706">=</span>&nbsp;<span class="ident" id="6784708">CharData</span><span class="op" id="6784716">(</span><span class="ident" id="6784717">data</span><span class="op" id="6784721">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6784724">tok2</span>&nbsp;<span class="op" id="6784729">:=</span>&nbsp;<span class="ident" id="6784732">CopyToken</span><span class="op" id="6784741">(</span><span class="ident" id="6784742">tok1</span><span class="op" id="6784746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6784749">if</span>&nbsp;<span class="op" id="6784752">!</span><span class="ident" id="6784753">reflect</span><span class="op" id="6784760">.</span><span class="ident" id="6784761">DeepEqual</span><span class="op" id="6784770">(</span><span class="ident" id="6784771">tok1</span><span class="op" id="6784775">,</span>&nbsp;<span class="ident" id="6784777">tok2</span><span class="op" id="6784781">)</span>&nbsp;<span class="op" id="6784783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6784787">t</span><span class="op" id="6784788">.</span><span class="ident" id="6784789">Error</span><span class="op" id="6784794">(</span><span class="string" id="6784795">&#34;CopyToken(CharData)&nbsp;!=&nbsp;CharData&#34;</span><span class="op" id="6784828">)</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6784831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6784834">data</span><span class="op" id="6784838">[</span><span class="num" id="6784839">1</span><span class="op" id="6784840">]</span>&nbsp;<span class="op" id="6784842">=</span>&nbsp;<span class="string" id="6784844">&#39;o&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6784849">if</span>&nbsp;<span class="ident" id="6784852">reflect</span><span class="op" id="6784859">.</span><span class="ident" id="6784860">DeepEqual</span><span class="op" id="6784869">(</span><span class="ident" id="6784870">tok1</span><span class="op" id="6784874">,</span>&nbsp;<span class="ident" id="6784876">tok2</span><span class="op" id="6784880">)</span>&nbsp;<span class="op" id="6784882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6784886">t</span><span class="op" id="6784887">.</span><span class="ident" id="6784888">Error</span><span class="op" id="6784893">(</span><span class="string" id="6784894">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="6784933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6784936">}</span><br>
<span class="lineno">555</span><span class="op" id="6784938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6784941">func</span>&nbsp;<span class="ident" id="6784946">TestCopyTokenStartElement</span><span class="op" id="6784971">(</span><span class="ident" id="6784972">t</span>&nbsp;<span class="op" id="6784974">*</span><span class="ident" id="6784975">testing</span><span class="op" id="6784982">.</span><span class="ident" id="6784983">T</span><span class="op" id="6784984">)</span>&nbsp;<span class="op" id="6784986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6784989">elt</span>&nbsp;<span class="op" id="6784993">:=</span>&nbsp;<span class="ident" id="6784996">StartElement</span><span class="op" id="6785008">{</span><span class="ident" id="6785009">Name</span><span class="op" id="6785013">{</span><span class="string" id="6785014">&#34;&#34;</span><span class="op" id="6785016">,</span>&nbsp;<span class="string" id="6785018">&#34;hello&#34;</span><span class="op" id="6785025">}</span><span class="op" id="6785026">,</span>&nbsp;<span class="op" id="6785028">[</span><span class="op" id="6785029">]</span><span class="ident" id="6785030">Attr</span><span class="op" id="6785034">{</span><span class="op" id="6785035">{</span><span class="ident" id="6785036">Name</span><span class="op" id="6785040">{</span><span class="string" id="6785041">&#34;&#34;</span><span class="op" id="6785043">,</span>&nbsp;<span class="string" id="6785045">&#34;lang&#34;</span><span class="op" id="6785051">}</span><span class="op" id="6785052">,</span>&nbsp;<span class="string" id="6785054">&#34;en&#34;</span><span class="op" id="6785058">}</span><span class="op" id="6785059">}</span><span class="op" id="6785060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6785063">var</span>&nbsp;<span class="ident" id="6785067">tok1</span>&nbsp;<span class="ident" id="6785072">Token</span>&nbsp;<span class="op" id="6785078">=</span>&nbsp;<span class="ident" id="6785080">elt</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6785085">tok2</span>&nbsp;<span class="op" id="6785090">:=</span>&nbsp;<span class="ident" id="6785093">CopyToken</span><span class="op" id="6785102">(</span><span class="ident" id="6785103">tok1</span><span class="op" id="6785107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6785110">if</span>&nbsp;<span class="ident" id="6785113">tok1</span><span class="op" id="6785117">.</span><span class="op" id="6785118">(</span><span class="ident" id="6785119">StartElement</span><span class="op" id="6785131">)</span><span class="op" id="6785132">.</span><span class="ident" id="6785133">Attr</span><span class="op" id="6785137">[</span><span class="num" id="6785138">0</span><span class="op" id="6785139">]</span><span class="op" id="6785140">.</span><span class="ident" id="6785141">Value</span>&nbsp;<span class="op" id="6785147">!=</span>&nbsp;<span class="string" id="6785150">&#34;en&#34;</span>&nbsp;<span class="op" id="6785155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6785159">t</span><span class="op" id="6785160">.</span><span class="ident" id="6785161">Error</span><span class="op" id="6785166">(</span><span class="string" id="6785167">&#34;CopyToken&nbsp;overwrote&nbsp;Attr[0]&#34;</span><span class="op" id="6785196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6785199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6785202">if</span>&nbsp;<span class="op" id="6785205">!</span><span class="ident" id="6785206">reflect</span><span class="op" id="6785213">.</span><span class="ident" id="6785214">DeepEqual</span><span class="op" id="6785223">(</span><span class="ident" id="6785224">tok1</span><span class="op" id="6785228">,</span>&nbsp;<span class="ident" id="6785230">tok2</span><span class="op" id="6785234">)</span>&nbsp;<span class="op" id="6785236">{</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6785240">t</span><span class="op" id="6785241">.</span><span class="ident" id="6785242">Error</span><span class="op" id="6785247">(</span><span class="string" id="6785248">&#34;CopyToken(StartElement)&nbsp;!=&nbsp;StartElement&#34;</span><span class="op" id="6785289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6785292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6785295">tok1</span><span class="op" id="6785299">.</span><span class="op" id="6785300">(</span><span class="ident" id="6785301">StartElement</span><span class="op" id="6785313">)</span><span class="op" id="6785314">.</span><span class="ident" id="6785315">Attr</span><span class="op" id="6785319">[</span><span class="num" id="6785320">0</span><span class="op" id="6785321">]</span>&nbsp;<span class="op" id="6785323">=</span>&nbsp;<span class="ident" id="6785325">Attr</span><span class="op" id="6785329">{</span><span class="ident" id="6785330">Name</span><span class="op" id="6785334">{</span><span class="string" id="6785335">&#34;&#34;</span><span class="op" id="6785337">,</span>&nbsp;<span class="string" id="6785339">&#34;lang&#34;</span><span class="op" id="6785345">}</span><span class="op" id="6785346">,</span>&nbsp;<span class="string" id="6785348">&#34;de&#34;</span><span class="op" id="6785352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6785355">if</span>&nbsp;<span class="ident" id="6785358">reflect</span><span class="op" id="6785365">.</span><span class="ident" id="6785366">DeepEqual</span><span class="op" id="6785375">(</span><span class="ident" id="6785376">tok1</span><span class="op" id="6785380">,</span>&nbsp;<span class="ident" id="6785382">tok2</span><span class="op" id="6785386">)</span>&nbsp;<span class="op" id="6785388">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6785392">t</span><span class="op" id="6785393">.</span><span class="ident" id="6785394">Error</span><span class="op" id="6785399">(</span><span class="string" id="6785400">&#34;CopyToken(CharData)&nbsp;uses&nbsp;same&nbsp;buffer.&#34;</span><span class="op" id="6785439">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6785442">}</span><br>
<span class="lineno"></span><span class="op" id="6785444">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6785447">func</span>&nbsp;<span class="ident" id="6785452">TestSyntaxErrorLineNum</span><span class="op" id="6785474">(</span><span class="ident" id="6785475">t</span>&nbsp;<span class="op" id="6785477">*</span><span class="ident" id="6785478">testing</span><span class="op" id="6785485">.</span><span class="ident" id="6785486">T</span><span class="op" id="6785487">)</span>&nbsp;<span class="op" id="6785489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6785492">testInput</span>&nbsp;<span class="op" id="6785502">:=</span>&nbsp;<span class="string" id="6785505">&#34;&lt;P&gt;Foo&lt;P&gt;\n\n&lt;P&gt;Bar&lt;/&gt;\n&#34;</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6785533">d</span>&nbsp;<span class="op" id="6785535">:=</span>&nbsp;<span class="ident" id="6785538">NewDecoder</span><span class="op" id="6785548">(</span><span class="ident" id="6785549">strings</span><span class="op" id="6785556">.</span><span class="ident" id="6785557">NewReader</span><span class="op" id="6785566">(</span><span class="ident" id="6785567">testInput</span><span class="op" id="6785576">)</span><span class="op" id="6785577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6785580">var</span>&nbsp;<span class="ident" id="6785584">err</span>&nbsp;<span class="builtintype" id="6785588">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6785595">for</span>&nbsp;<span class="ident" id="6785599">_</span><span class="op" id="6785600">,</span>&nbsp;<span class="ident" id="6785602">err</span>&nbsp;<span class="op" id="6785606">=</span>&nbsp;<span class="ident" id="6785608">d</span><span class="op" id="6785609">.</span><span class="ident" id="6785610">Token</span><span class="op" id="6785615">(</span><span class="op" id="6785616">)</span><span class="op" id="6785617">;</span>&nbsp;<span class="ident" id="6785619">err</span>&nbsp;<span class="op" id="6785623">==</span>&nbsp;<span class="ident" id="6785626">nil</span><span class="op" id="6785629">;</span>&nbsp;<span class="ident" id="6785631">_</span><span class="op" id="6785632">,</span>&nbsp;<span class="ident" id="6785634">err</span>&nbsp;<span class="op" id="6785638">=</span>&nbsp;<span class="ident" id="6785640">d</span><span class="op" id="6785641">.</span><span class="ident" id="6785642">Token</span><span class="op" id="6785647">(</span><span class="op" id="6785648">)</span>&nbsp;<span class="op" id="6785650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6785653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6785656">synerr</span><span class="op" id="6785662">,</span>&nbsp;<span class="ident" id="6785664">ok</span>&nbsp;<span class="op" id="6785667">:=</span>&nbsp;<span class="ident" id="6785670">err</span><span class="op" id="6785673">.</span><span class="op" id="6785674">(</span><span class="op" id="6785675">*</span><span class="ident" id="6785676">SyntaxError</span><span class="op" id="6785687">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6785690">if</span>&nbsp;<span class="op" id="6785693">!</span><span class="ident" id="6785694">ok</span>&nbsp;<span class="op" id="6785697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6785701">t</span><span class="op" id="6785702">.</span><span class="ident" id="6785703">Error</span><span class="op" id="6785708">(</span><span class="string" id="6785709">&#34;Expected&nbsp;SyntaxError.&#34;</span><span class="op" id="6785732">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6785735">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6785738">if</span>&nbsp;<span class="ident" id="6785741">synerr</span><span class="op" id="6785747">.</span><span class="ident" id="6785748">Line</span>&nbsp;<span class="op" id="6785753">!=</span>&nbsp;<span class="num" id="6785756">3</span>&nbsp;<span class="op" id="6785758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6785762">t</span><span class="op" id="6785763">.</span><span class="ident" id="6785764">Error</span><span class="op" id="6785769">(</span><span class="string" id="6785770">&#34;SyntaxError&nbsp;didn&#39;t&nbsp;have&nbsp;correct&nbsp;line&nbsp;number.&#34;</span><span class="op" id="6785816">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6785819">}</span><br>
<span class="lineno"></span><span class="op" id="6785821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6785824">func</span>&nbsp;<span class="ident" id="6785829">TestTrailingRawToken</span><span class="op" id="6785849">(</span><span class="ident" id="6785850">t</span>&nbsp;<span class="op" id="6785852">*</span><span class="ident" id="6785853">testing</span><span class="op" id="6785860">.</span><span class="ident" id="6785861">T</span><span class="op" id="6785862">)</span>&nbsp;<span class="op" id="6785864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6785867">input</span>&nbsp;<span class="op" id="6785873">:=</span>&nbsp;<span class="string" id="6785876">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6785893">d</span>&nbsp;<span class="op" id="6785895">:=</span>&nbsp;<span class="ident" id="6785898">NewDecoder</span><span class="op" id="6785908">(</span><span class="ident" id="6785909">strings</span><span class="op" id="6785916">.</span><span class="ident" id="6785917">NewReader</span><span class="op" id="6785926">(</span><span class="ident" id="6785927">input</span><span class="op" id="6785932">)</span><span class="op" id="6785933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6785936">var</span>&nbsp;<span class="ident" id="6785940">err</span>&nbsp;<span class="builtintype" id="6785944">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6785951">for</span>&nbsp;<span class="ident" id="6785955">_</span><span class="op" id="6785956">,</span>&nbsp;<span class="ident" id="6785958">err</span>&nbsp;<span class="op" id="6785962">=</span>&nbsp;<span class="ident" id="6785964">d</span><span class="op" id="6785965">.</span><span class="ident" id="6785966">RawToken</span><span class="op" id="6785974">(</span><span class="op" id="6785975">)</span><span class="op" id="6785976">;</span>&nbsp;<span class="ident" id="6785978">err</span>&nbsp;<span class="op" id="6785982">==</span>&nbsp;<span class="ident" id="6785985">nil</span><span class="op" id="6785988">;</span>&nbsp;<span class="ident" id="6785990">_</span><span class="op" id="6785991">,</span>&nbsp;<span class="ident" id="6785993">err</span>&nbsp;<span class="op" id="6785997">=</span>&nbsp;<span class="ident" id="6785999">d</span><span class="op" id="6786000">.</span><span class="ident" id="6786001">RawToken</span><span class="op" id="6786009">(</span><span class="op" id="6786010">)</span>&nbsp;<span class="op" id="6786012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6786015">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6786018">if</span>&nbsp;<span class="ident" id="6786021">err</span>&nbsp;<span class="op" id="6786025">!=</span>&nbsp;<span class="ident" id="6786028">io</span><span class="op" id="6786030">.</span><span class="ident" id="6786031">EOF</span>&nbsp;<span class="op" id="6786035">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6786039">t</span><span class="op" id="6786040">.</span><span class="ident" id="6786041">Fatalf</span><span class="op" id="6786047">(</span><span class="string" id="6786048">&#34;d.RawToken()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="6786086">,</span>&nbsp;<span class="ident" id="6786088">err</span><span class="op" id="6786091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6786094">}</span><br>
<span class="lineno"></span><span class="op" id="6786096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6786099">func</span>&nbsp;<span class="ident" id="6786104">TestTrailingToken</span><span class="op" id="6786121">(</span><span class="ident" id="6786122">t</span>&nbsp;<span class="op" id="6786124">*</span><span class="ident" id="6786125">testing</span><span class="op" id="6786132">.</span><span class="ident" id="6786133">T</span><span class="op" id="6786134">)</span>&nbsp;<span class="op" id="6786136">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6786139">input</span>&nbsp;<span class="op" id="6786145">:=</span>&nbsp;<span class="string" id="6786148">`&lt;FOO&gt;&lt;/FOO&gt;&nbsp;&nbsp;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6786165">d</span>&nbsp;<span class="op" id="6786167">:=</span>&nbsp;<span class="ident" id="6786170">NewDecoder</span><span class="op" id="6786180">(</span><span class="ident" id="6786181">strings</span><span class="op" id="6786188">.</span><span class="ident" id="6786189">NewReader</span><span class="op" id="6786198">(</span><span class="ident" id="6786199">input</span><span class="op" id="6786204">)</span><span class="op" id="6786205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6786208">var</span>&nbsp;<span class="ident" id="6786212">err</span>&nbsp;<span class="builtintype" id="6786216">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6786223">for</span>&nbsp;<span class="ident" id="6786227">_</span><span class="op" id="6786228">,</span>&nbsp;<span class="ident" id="6786230">err</span>&nbsp;<span class="op" id="6786234">=</span>&nbsp;<span class="ident" id="6786236">d</span><span class="op" id="6786237">.</span><span class="ident" id="6786238">Token</span><span class="op" id="6786243">(</span><span class="op" id="6786244">)</span><span class="op" id="6786245">;</span>&nbsp;<span class="ident" id="6786247">err</span>&nbsp;<span class="op" id="6786251">==</span>&nbsp;<span class="ident" id="6786254">nil</span><span class="op" id="6786257">;</span>&nbsp;<span class="ident" id="6786259">_</span><span class="op" id="6786260">,</span>&nbsp;<span class="ident" id="6786262">err</span>&nbsp;<span class="op" id="6786266">=</span>&nbsp;<span class="ident" id="6786268">d</span><span class="op" id="6786269">.</span><span class="ident" id="6786270">Token</span><span class="op" id="6786275">(</span><span class="op" id="6786276">)</span>&nbsp;<span class="op" id="6786278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6786281">}</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6786284">if</span>&nbsp;<span class="ident" id="6786287">err</span>&nbsp;<span class="op" id="6786291">!=</span>&nbsp;<span class="ident" id="6786294">io</span><span class="op" id="6786296">.</span><span class="ident" id="6786297">EOF</span>&nbsp;<span class="op" id="6786301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6786305">t</span><span class="op" id="6786306">.</span><span class="ident" id="6786307">Fatalf</span><span class="op" id="6786313">(</span><span class="string" id="6786314">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="6786349">,</span>&nbsp;<span class="ident" id="6786351">err</span><span class="op" id="6786354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6786357">}</span><br>
<span class="lineno"></span><span class="op" id="6786359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">610</span><span class="keyword" id="6786362">func</span>&nbsp;<span class="ident" id="6786367">TestEntityInsideCDATA</span><span class="op" id="6786388">(</span><span class="ident" id="6786389">t</span>&nbsp;<span class="op" id="6786391">*</span><span class="ident" id="6786392">testing</span><span class="op" id="6786399">.</span><span class="ident" id="6786400">T</span><span class="op" id="6786401">)</span>&nbsp;<span class="op" id="6786403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6786406">input</span>&nbsp;<span class="op" id="6786412">:=</span>&nbsp;<span class="string" id="6786415">`&lt;test&gt;&lt;![CDATA[&nbsp;&amp;val=foo&nbsp;]]&gt;&lt;/test&gt;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6786454">d</span>&nbsp;<span class="op" id="6786456">:=</span>&nbsp;<span class="ident" id="6786459">NewDecoder</span><span class="op" id="6786469">(</span><span class="ident" id="6786470">strings</span><span class="op" id="6786477">.</span><span class="ident" id="6786478">NewReader</span><span class="op" id="6786487">(</span><span class="ident" id="6786488">input</span><span class="op" id="6786493">)</span><span class="op" id="6786494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6786497">var</span>&nbsp;<span class="ident" id="6786501">err</span>&nbsp;<span class="builtintype" id="6786505">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6786512">for</span>&nbsp;<span class="ident" id="6786516">_</span><span class="op" id="6786517">,</span>&nbsp;<span class="ident" id="6786519">err</span>&nbsp;<span class="op" id="6786523">=</span>&nbsp;<span class="ident" id="6786525">d</span><span class="op" id="6786526">.</span><span class="ident" id="6786527">Token</span><span class="op" id="6786532">(</span><span class="op" id="6786533">)</span><span class="op" id="6786534">;</span>&nbsp;<span class="ident" id="6786536">err</span>&nbsp;<span class="op" id="6786540">==</span>&nbsp;<span class="ident" id="6786543">nil</span><span class="op" id="6786546">;</span>&nbsp;<span class="ident" id="6786548">_</span><span class="op" id="6786549">,</span>&nbsp;<span class="ident" id="6786551">err</span>&nbsp;<span class="op" id="6786555">=</span>&nbsp;<span class="ident" id="6786557">d</span><span class="op" id="6786558">.</span><span class="ident" id="6786559">Token</span><span class="op" id="6786564">(</span><span class="op" id="6786565">)</span>&nbsp;<span class="op" id="6786567">{</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6786570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6786573">if</span>&nbsp;<span class="ident" id="6786576">err</span>&nbsp;<span class="op" id="6786580">!=</span>&nbsp;<span class="ident" id="6786583">io</span><span class="op" id="6786585">.</span><span class="ident" id="6786586">EOF</span>&nbsp;<span class="op" id="6786590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6786594">t</span><span class="op" id="6786595">.</span><span class="ident" id="6786596">Fatalf</span><span class="op" id="6786602">(</span><span class="string" id="6786603">&#34;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;io.EOF&#34;</span><span class="op" id="6786638">,</span>&nbsp;<span class="ident" id="6786640">err</span><span class="op" id="6786643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6786646">}</span><br>
<span class="lineno"></span><span class="op" id="6786648">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="6786651">var</span>&nbsp;<span class="ident" id="6786655">characterTests</span>&nbsp;<span class="op" id="6786670">=</span>&nbsp;<span class="op" id="6786672">[</span><span class="op" id="6786673">]</span><span class="keyword" id="6786674">struct</span>&nbsp;<span class="op" id="6786681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6786684">in</span>&nbsp;&nbsp;<span class="builtintype" id="6786688">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6786696">err</span>&nbsp;<span class="builtintype" id="6786700">string</span><br>
<span class="lineno"></span><span class="op" id="6786707">}</span><span class="op" id="6786708">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6786711">{</span><span class="string" id="6786712">&#34;\x12&lt;doc/&gt;&#34;</span><span class="op" id="6786724">,</span>&nbsp;<span class="string" id="6786726">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0012&#34;</span><span class="op" id="6786757">}</span><span class="op" id="6786758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6786761">{</span><span class="string" id="6786762">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;\x0b&lt;doc/&gt;&#34;</span><span class="op" id="6786797">,</span>&nbsp;<span class="string" id="6786799">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+000B&#34;</span><span class="op" id="6786830">}</span><span class="op" id="6786831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6786834">{</span><span class="string" id="6786835">&#34;\xef\xbf\xbe&lt;doc/&gt;&#34;</span><span class="op" id="6786855">,</span>&nbsp;<span class="string" id="6786857">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+FFFE&#34;</span><span class="op" id="6786888">}</span><span class="op" id="6786889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6786892">{</span><span class="string" id="6786893">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&gt;\r\n&lt;hiya/&gt;\x07&lt;toots/&gt;&lt;/doc&gt;&#34;</span><span class="op" id="6786952">,</span>&nbsp;<span class="string" id="6786954">&#34;illegal&nbsp;character&nbsp;code&nbsp;U+0007&#34;</span><span class="op" id="6786985">}</span><span class="op" id="6786986">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6786989">{</span><span class="string" id="6786990">&#34;&lt;?xml&nbsp;version=\&#34;1.0\&#34;?&gt;&lt;doc&nbsp;\x12=&#39;value&#39;&gt;what&#39;s&nbsp;up&lt;/doc&gt;&#34;</span><span class="op" id="6787048">,</span>&nbsp;<span class="string" id="6787050">&#34;expected&nbsp;attribute&nbsp;name&nbsp;in&nbsp;element&#34;</span><span class="op" id="6787086">}</span><span class="op" id="6787087">,</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6787090">{</span><span class="string" id="6787091">&#34;&lt;doc&gt;&amp;abc\x01;&lt;/doc&gt;&#34;</span><span class="op" id="6787113">,</span>&nbsp;<span class="string" id="6787115">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;abc&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="6787161">}</span><span class="op" id="6787162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6787165">{</span><span class="string" id="6787166">&#34;&lt;doc&gt;&amp;\x01;&lt;/doc&gt;&#34;</span><span class="op" id="6787185">,</span>&nbsp;<span class="string" id="6787187">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;&nbsp;(no&nbsp;semicolon)&#34;</span><span class="op" id="6787230">}</span><span class="op" id="6787231">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6787234">{</span><span class="string" id="6787235">&#34;&lt;doc&gt;&amp;\xef\xbf\xbe;&lt;/doc&gt;&#34;</span><span class="op" id="6787262">,</span>&nbsp;<span class="string" id="6787264">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;\uFFFE;&#34;</span><span class="op" id="6787299">}</span><span class="op" id="6787300">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6787303">{</span><span class="string" id="6787304">&#34;&lt;doc&gt;&amp;hello;&lt;/doc&gt;&#34;</span><span class="op" id="6787324">,</span>&nbsp;<span class="string" id="6787326">&#34;invalid&nbsp;character&nbsp;entity&nbsp;&amp;hello;&#34;</span><span class="op" id="6787360">}</span><span class="op" id="6787361">,</span><br>
<span class="lineno"></span><span class="op" id="6787363">}</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span><span class="keyword" id="6787366">func</span>&nbsp;<span class="ident" id="6787371">TestDisallowedCharacters</span><span class="op" id="6787395">(</span><span class="ident" id="6787396">t</span>&nbsp;<span class="op" id="6787398">*</span><span class="ident" id="6787399">testing</span><span class="op" id="6787406">.</span><span class="ident" id="6787407">T</span><span class="op" id="6787408">)</span>&nbsp;<span class="op" id="6787410">{</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6787414">for</span>&nbsp;<span class="ident" id="6787418">i</span><span class="op" id="6787419">,</span>&nbsp;<span class="ident" id="6787421">tt</span>&nbsp;<span class="op" id="6787424">:=</span>&nbsp;<span class="keyword" id="6787427">range</span>&nbsp;<span class="ident" id="6787433">characterTests</span>&nbsp;<span class="op" id="6787448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6787452">d</span>&nbsp;<span class="op" id="6787454">:=</span>&nbsp;<span class="ident" id="6787457">NewDecoder</span><span class="op" id="6787467">(</span><span class="ident" id="6787468">strings</span><span class="op" id="6787475">.</span><span class="ident" id="6787476">NewReader</span><span class="op" id="6787485">(</span><span class="ident" id="6787486">tt</span><span class="op" id="6787488">.</span><span class="ident" id="6787489">in</span><span class="op" id="6787491">)</span><span class="op" id="6787492">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6787496">var</span>&nbsp;<span class="ident" id="6787500">err</span>&nbsp;<span class="builtintype" id="6787504">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6787513">for</span>&nbsp;<span class="ident" id="6787517">err</span>&nbsp;<span class="op" id="6787521">==</span>&nbsp;<span class="ident" id="6787524">nil</span>&nbsp;<span class="op" id="6787528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6787533">_</span><span class="op" id="6787534">,</span>&nbsp;<span class="ident" id="6787536">err</span>&nbsp;<span class="op" id="6787540">=</span>&nbsp;<span class="ident" id="6787542">d</span><span class="op" id="6787543">.</span><span class="ident" id="6787544">Token</span><span class="op" id="6787549">(</span><span class="op" id="6787550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6787554">}</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6787558">synerr</span><span class="op" id="6787564">,</span>&nbsp;<span class="ident" id="6787566">ok</span>&nbsp;<span class="op" id="6787569">:=</span>&nbsp;<span class="ident" id="6787572">err</span><span class="op" id="6787575">.</span><span class="op" id="6787576">(</span><span class="op" id="6787577">*</span><span class="ident" id="6787578">SyntaxError</span><span class="op" id="6787589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6787593">if</span>&nbsp;<span class="op" id="6787596">!</span><span class="ident" id="6787597">ok</span>&nbsp;<span class="op" id="6787600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6787605">t</span><span class="op" id="6787606">.</span><span class="ident" id="6787607">Fatalf</span><span class="op" id="6787613">(</span><span class="string" id="6787614">&#34;input&nbsp;%d&nbsp;d.Token()&nbsp;=&nbsp;_,&nbsp;%v,&nbsp;want&nbsp;_,&nbsp;*SyntaxError&#34;</span><span class="op" id="6787664">,</span>&nbsp;<span class="ident" id="6787666">i</span><span class="op" id="6787667">,</span>&nbsp;<span class="ident" id="6787669">err</span><span class="op" id="6787672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6787676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6787680">if</span>&nbsp;<span class="ident" id="6787683">synerr</span><span class="op" id="6787689">.</span><span class="ident" id="6787690">Msg</span>&nbsp;<span class="op" id="6787694">!=</span>&nbsp;<span class="ident" id="6787697">tt</span><span class="op" id="6787699">.</span><span class="ident" id="6787700">err</span>&nbsp;<span class="op" id="6787704">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6787709">t</span><span class="op" id="6787710">.</span><span class="ident" id="6787711">Fatalf</span><span class="op" id="6787717">(</span><span class="string" id="6787718">&#34;input&nbsp;%d&nbsp;synerr.Msg&nbsp;wrong:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="6787762">,</span>&nbsp;<span class="ident" id="6787764">i</span><span class="op" id="6787765">,</span>&nbsp;<span class="ident" id="6787767">tt</span><span class="op" id="6787769">.</span><span class="ident" id="6787770">err</span><span class="op" id="6787773">,</span>&nbsp;<span class="ident" id="6787775">synerr</span><span class="op" id="6787781">.</span><span class="ident" id="6787782">Msg</span><span class="op" id="6787785">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6787789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6787792">}</span><br>
<span class="lineno"></span><span class="op" id="6787794">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">655</span><span class="keyword" id="6787797">type</span>&nbsp;<span class="ident" id="6787802">procInstEncodingTest</span>&nbsp;<span class="keyword" id="6787823">struct</span>&nbsp;<span class="op" id="6787830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6787833">expect</span><span class="op" id="6787839">,</span>&nbsp;<span class="ident" id="6787841">got</span>&nbsp;<span class="builtintype" id="6787845">string</span><br>
<span class="lineno"></span><span class="op" id="6787852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6787855">var</span>&nbsp;<span class="ident" id="6787859">procInstTests</span>&nbsp;<span class="op" id="6787873">=</span>&nbsp;<span class="op" id="6787875">[</span><span class="op" id="6787876">]</span><span class="keyword" id="6787877">struct</span>&nbsp;<span class="op" id="6787884">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6787887">input</span><span class="op" id="6787892">,</span>&nbsp;<span class="ident" id="6787894">expect</span>&nbsp;<span class="builtintype" id="6787901">string</span><br>
<span class="lineno"></span><span class="op" id="6787908">}</span><span class="op" id="6787909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6787912">{</span><span class="string" id="6787913">`version=&#34;1.0&#34;&nbsp;encoding=&#34;utf-8&#34;`</span><span class="op" id="6787945">,</span>&nbsp;<span class="string" id="6787947">&#34;utf-8&#34;</span><span class="op" id="6787954">}</span><span class="op" id="6787955">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6787958">{</span><span class="string" id="6787959">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;`</span><span class="op" id="6787991">,</span>&nbsp;<span class="string" id="6787993">&#34;utf-8&#34;</span><span class="op" id="6788000">}</span><span class="op" id="6788001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6788004">{</span><span class="string" id="6788005">`version=&#34;1.0&#34;&nbsp;encoding=&#39;utf-8&#39;&nbsp;`</span><span class="op" id="6788038">,</span>&nbsp;<span class="string" id="6788040">&#34;utf-8&#34;</span><span class="op" id="6788047">}</span><span class="op" id="6788048">,</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6788051">{</span><span class="string" id="6788052">`version=&#34;1.0&#34;&nbsp;encoding=utf-8`</span><span class="op" id="6788082">,</span>&nbsp;<span class="string" id="6788084">&#34;&#34;</span><span class="op" id="6788086">}</span><span class="op" id="6788087">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6788090">{</span><span class="string" id="6788091">`encoding=&#34;FOO&#34;&nbsp;`</span><span class="op" id="6788108">,</span>&nbsp;<span class="string" id="6788110">&#34;FOO&#34;</span><span class="op" id="6788115">}</span><span class="op" id="6788116">,</span><br>
<span class="lineno"></span><span class="op" id="6788118">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6788121">func</span>&nbsp;<span class="ident" id="6788126">TestProcInstEncoding</span><span class="op" id="6788146">(</span><span class="ident" id="6788147">t</span>&nbsp;<span class="op" id="6788149">*</span><span class="ident" id="6788150">testing</span><span class="op" id="6788157">.</span><span class="ident" id="6788158">T</span><span class="op" id="6788159">)</span>&nbsp;<span class="op" id="6788161">{</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6788164">for</span>&nbsp;<span class="ident" id="6788168">_</span><span class="op" id="6788169">,</span>&nbsp;<span class="ident" id="6788171">test</span>&nbsp;<span class="op" id="6788176">:=</span>&nbsp;<span class="keyword" id="6788179">range</span>&nbsp;<span class="ident" id="6788185">procInstTests</span>&nbsp;<span class="op" id="6788199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6788203">got</span>&nbsp;<span class="op" id="6788207">:=</span>&nbsp;<span class="ident" id="6788210">procInstEncoding</span><span class="op" id="6788226">(</span><span class="ident" id="6788227">test</span><span class="op" id="6788231">.</span><span class="ident" id="6788232">input</span><span class="op" id="6788237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6788241">if</span>&nbsp;<span class="ident" id="6788244">got</span>&nbsp;<span class="op" id="6788248">!=</span>&nbsp;<span class="ident" id="6788251">test</span><span class="op" id="6788255">.</span><span class="ident" id="6788256">expect</span>&nbsp;<span class="op" id="6788263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6788268">t</span><span class="op" id="6788269">.</span><span class="ident" id="6788270">Errorf</span><span class="op" id="6788276">(</span><span class="string" id="6788277">&#34;procInstEncoding(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6788313">,</span>&nbsp;<span class="ident" id="6788315">test</span><span class="op" id="6788319">.</span><span class="ident" id="6788320">input</span><span class="op" id="6788325">,</span>&nbsp;<span class="ident" id="6788327">got</span><span class="op" id="6788330">,</span>&nbsp;<span class="ident" id="6788332">test</span><span class="op" id="6788336">.</span><span class="ident" id="6788337">expect</span><span class="op" id="6788343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6788347">}</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6788350">}</span><br>
<span class="lineno"></span><span class="op" id="6788352">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6788355">//&nbsp;Ensure&nbsp;that&nbsp;directives&nbsp;with&nbsp;comments&nbsp;include&nbsp;the&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="6788416">//&nbsp;text&nbsp;of&nbsp;any&nbsp;nested&nbsp;directives.</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="6788451">var</span>&nbsp;<span class="ident" id="6788455">directivesWithCommentsInput</span>&nbsp;<span class="op" id="6788483">=</span>&nbsp;<span class="string" id="6788485">`<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!--&nbsp;a&nbsp;comment&nbsp;--&gt;&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno"></span>&lt;!DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&lt;!----&gt;&nbsp;&lt;!--&gt;--&gt;&nbsp;&lt;!---&gt;--&gt;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;&lt;!--&nbsp;a&nbsp;comment--&gt;]&gt;<br>
<span class="lineno">685</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6788721">var</span>&nbsp;<span class="ident" id="6788725">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="6788754">=</span>&nbsp;<span class="op" id="6788756">[</span><span class="op" id="6788757">]</span><span class="ident" id="6788758">Token</span><span class="op" id="6788763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6788766">CharData</span><span class="op" id="6788774">(</span><span class="string" id="6788775">&#34;\n&#34;</span><span class="op" id="6788779">)</span><span class="op" id="6788780">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6788783">Directive</span><span class="op" id="6788792">(</span><span class="string" id="6788793">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;rdf&nbsp;&#34;http://www.w3.org/1999/02/22-rdf-syntax-ns#&#34;&gt;]`</span><span class="op" id="6788864">)</span><span class="op" id="6788865">,</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6788868">CharData</span><span class="op" id="6788876">(</span><span class="string" id="6788877">&#34;\n&#34;</span><span class="op" id="6788881">)</span><span class="op" id="6788882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6788885">Directive</span><span class="op" id="6788894">(</span><span class="string" id="6788895">`DOCTYPE&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="6788928">)</span><span class="op" id="6788929">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6788932">CharData</span><span class="op" id="6788940">(</span><span class="string" id="6788941">&#34;\n&#34;</span><span class="op" id="6788945">)</span><span class="op" id="6788946">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6788949">Directive</span><span class="op" id="6788958">(</span><span class="string" id="6788959">`DOCTYPE&nbsp;&lt;!-&gt;&nbsp;&lt;!&gt;&nbsp;&nbsp;&nbsp;&nbsp;[&lt;!ENTITY&nbsp;go&nbsp;&#34;Golang&#34;&gt;]`</span><span class="op" id="6789004">)</span><span class="op" id="6789005">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6789008">CharData</span><span class="op" id="6789016">(</span><span class="string" id="6789017">&#34;\n&#34;</span><span class="op" id="6789021">)</span><span class="op" id="6789022">,</span><br>
<span class="lineno">695</span><span class="op" id="6789024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6789027">func</span>&nbsp;<span class="ident" id="6789032">TestDirectivesWithComments</span><span class="op" id="6789058">(</span><span class="ident" id="6789059">t</span>&nbsp;<span class="op" id="6789061">*</span><span class="ident" id="6789062">testing</span><span class="op" id="6789069">.</span><span class="ident" id="6789070">T</span><span class="op" id="6789071">)</span>&nbsp;<span class="op" id="6789073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6789076">d</span>&nbsp;<span class="op" id="6789078">:=</span>&nbsp;<span class="ident" id="6789081">NewDecoder</span><span class="op" id="6789091">(</span><span class="ident" id="6789092">strings</span><span class="op" id="6789099">.</span><span class="ident" id="6789100">NewReader</span><span class="op" id="6789109">(</span><span class="ident" id="6789110">directivesWithCommentsInput</span><span class="op" id="6789137">)</span><span class="op" id="6789138">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6789142">for</span>&nbsp;<span class="ident" id="6789146">i</span><span class="op" id="6789147">,</span>&nbsp;<span class="ident" id="6789149">want</span>&nbsp;<span class="op" id="6789154">:=</span>&nbsp;<span class="keyword" id="6789157">range</span>&nbsp;<span class="ident" id="6789163">directivesWithCommentsTokens</span>&nbsp;<span class="op" id="6789192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6789196">have</span><span class="op" id="6789200">,</span>&nbsp;<span class="ident" id="6789202">err</span>&nbsp;<span class="op" id="6789206">:=</span>&nbsp;<span class="ident" id="6789209">d</span><span class="op" id="6789210">.</span><span class="ident" id="6789211">Token</span><span class="op" id="6789216">(</span><span class="op" id="6789217">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6789221">if</span>&nbsp;<span class="ident" id="6789224">err</span>&nbsp;<span class="op" id="6789228">!=</span>&nbsp;<span class="ident" id="6789231">nil</span>&nbsp;<span class="op" id="6789235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6789240">t</span><span class="op" id="6789241">.</span><span class="ident" id="6789242">Fatalf</span><span class="op" id="6789248">(</span><span class="string" id="6789249">&#34;token&nbsp;%d:&nbsp;unexpected&nbsp;error:&nbsp;%s&#34;</span><span class="op" id="6789281">,</span>&nbsp;<span class="ident" id="6789283">i</span><span class="op" id="6789284">,</span>&nbsp;<span class="ident" id="6789286">err</span><span class="op" id="6789289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6789293">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6789297">if</span>&nbsp;<span class="op" id="6789300">!</span><span class="ident" id="6789301">reflect</span><span class="op" id="6789308">.</span><span class="ident" id="6789309">DeepEqual</span><span class="op" id="6789318">(</span><span class="ident" id="6789319">have</span><span class="op" id="6789323">,</span>&nbsp;<span class="ident" id="6789325">want</span><span class="op" id="6789329">)</span>&nbsp;<span class="op" id="6789331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6789336">t</span><span class="op" id="6789337">.</span><span class="ident" id="6789338">Errorf</span><span class="op" id="6789344">(</span><span class="string" id="6789345">&#34;token&nbsp;%d&nbsp;=&nbsp;%#v&nbsp;want&nbsp;%#v&#34;</span><span class="op" id="6789370">,</span>&nbsp;<span class="ident" id="6789372">i</span><span class="op" id="6789373">,</span>&nbsp;<span class="ident" id="6789375">have</span><span class="op" id="6789379">,</span>&nbsp;<span class="ident" id="6789381">want</span><span class="op" id="6789385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6789389">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6789392">}</span><br>
<span class="lineno"></span><span class="op" id="6789394">}</span><br>
<span class="lineno">710</span><br>
<span class="lineno"></span><span class="comment" id="6789397">//&nbsp;Writer&nbsp;whose&nbsp;Write&nbsp;method&nbsp;always&nbsp;returns&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="6789451">type</span>&nbsp;<span class="ident" id="6789456">errWriter</span>&nbsp;<span class="keyword" id="6789466">struct</span><span class="op" id="6789472">{</span><span class="op" id="6789473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6789476">func</span>&nbsp;<span class="op" id="6789481">(</span><span class="ident" id="6789482">errWriter</span><span class="op" id="6789491">)</span>&nbsp;<span class="ident" id="6789493">Write</span><span class="op" id="6789498">(</span><span class="ident" id="6789499">p</span>&nbsp;<span class="op" id="6789501">[</span><span class="op" id="6789502">]</span><span class="builtintype" id="6789503">byte</span><span class="op" id="6789507">)</span>&nbsp;<span class="op" id="6789509">(</span><span class="ident" id="6789510">n</span>&nbsp;<span class="builtintype" id="6789512">int</span><span class="op" id="6789515">,</span>&nbsp;<span class="ident" id="6789517">err</span>&nbsp;<span class="builtintype" id="6789521">error</span><span class="op" id="6789526">)</span>&nbsp;<span class="op" id="6789528">{</span>&nbsp;<span class="keyword" id="6789530">return</span>&nbsp;<span class="num" id="6789537">0</span><span class="op" id="6789538">,</span>&nbsp;<span class="ident" id="6789540">fmt</span><span class="op" id="6789543">.</span><span class="ident" id="6789544">Errorf</span><span class="op" id="6789550">(</span><span class="string" id="6789551">&#34;unwritable&#34;</span><span class="op" id="6789563">)</span>&nbsp;<span class="op" id="6789565">}</span><br>
<span class="lineno">715</span><br>
<span class="lineno"></span><span class="keyword" id="6789568">func</span>&nbsp;<span class="ident" id="6789573">TestEscapeTextIOErrors</span><span class="op" id="6789595">(</span><span class="ident" id="6789596">t</span>&nbsp;<span class="op" id="6789598">*</span><span class="ident" id="6789599">testing</span><span class="op" id="6789606">.</span><span class="ident" id="6789607">T</span><span class="op" id="6789608">)</span>&nbsp;<span class="op" id="6789610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6789613">expectErr</span>&nbsp;<span class="op" id="6789623">:=</span>&nbsp;<span class="string" id="6789626">&#34;unwritable&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6789640">err</span>&nbsp;<span class="op" id="6789644">:=</span>&nbsp;<span class="ident" id="6789647">EscapeText</span><span class="op" id="6789657">(</span><span class="ident" id="6789658">errWriter</span><span class="op" id="6789667">{</span><span class="op" id="6789668">}</span><span class="op" id="6789669">,</span>&nbsp;<span class="op" id="6789671">[</span><span class="op" id="6789672">]</span><span class="builtintype" id="6789673">byte</span><span class="op" id="6789677">{</span><span class="string" id="6789678">&#39;A&#39;</span><span class="op" id="6789681">}</span><span class="op" id="6789682">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6789686">if</span>&nbsp;<span class="ident" id="6789689">err</span>&nbsp;<span class="op" id="6789693">==</span>&nbsp;<span class="ident" id="6789696">nil</span>&nbsp;<span class="op" id="6789700">||</span>&nbsp;<span class="ident" id="6789703">err</span><span class="op" id="6789706">.</span><span class="ident" id="6789707">Error</span><span class="op" id="6789712">(</span><span class="op" id="6789713">)</span>&nbsp;<span class="op" id="6789715">!=</span>&nbsp;<span class="ident" id="6789718">expectErr</span>&nbsp;<span class="op" id="6789728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6789732">t</span><span class="op" id="6789733">.</span><span class="ident" id="6789734">Errorf</span><span class="op" id="6789740">(</span><span class="string" id="6789741">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6789759">,</span>&nbsp;<span class="ident" id="6789761">err</span><span class="op" id="6789764">,</span>&nbsp;<span class="ident" id="6789766">expectErr</span><span class="op" id="6789775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6789778">}</span><br>
<span class="lineno"></span><span class="op" id="6789780">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="keyword" id="6789783">func</span>&nbsp;<span class="ident" id="6789788">TestEscapeTextInvalidChar</span><span class="op" id="6789813">(</span><span class="ident" id="6789814">t</span>&nbsp;<span class="op" id="6789816">*</span><span class="ident" id="6789817">testing</span><span class="op" id="6789824">.</span><span class="ident" id="6789825">T</span><span class="op" id="6789826">)</span>&nbsp;<span class="op" id="6789828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6789831">input</span>&nbsp;<span class="op" id="6789837">:=</span>&nbsp;<span class="op" id="6789840">[</span><span class="op" id="6789841">]</span><span class="builtintype" id="6789842">byte</span><span class="op" id="6789846">(</span><span class="string" id="6789847">&#34;A&nbsp;\x00&nbsp;terminated&nbsp;string.&#34;</span><span class="op" id="6789874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6789877">expected</span>&nbsp;<span class="op" id="6789886">:=</span>&nbsp;<span class="string" id="6789889">&#34;A&nbsp;\uFFFD&nbsp;terminated&nbsp;string.&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6789921">buff</span>&nbsp;<span class="op" id="6789926">:=</span>&nbsp;<span class="builtinfunc" id="6789929">new</span><span class="op" id="6789932">(</span><span class="ident" id="6789933">bytes</span><span class="op" id="6789938">.</span><span class="ident" id="6789939">Buffer</span><span class="op" id="6789945">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6789948">if</span>&nbsp;<span class="ident" id="6789951">err</span>&nbsp;<span class="op" id="6789955">:=</span>&nbsp;<span class="ident" id="6789958">EscapeText</span><span class="op" id="6789968">(</span><span class="ident" id="6789969">buff</span><span class="op" id="6789973">,</span>&nbsp;<span class="ident" id="6789975">input</span><span class="op" id="6789980">)</span><span class="op" id="6789981">;</span>&nbsp;<span class="ident" id="6789983">err</span>&nbsp;<span class="op" id="6789987">!=</span>&nbsp;<span class="ident" id="6789990">nil</span>&nbsp;<span class="op" id="6789994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6789998">t</span><span class="op" id="6789999">.</span><span class="ident" id="6790000">Fatalf</span><span class="op" id="6790006">(</span><span class="string" id="6790007">&#34;have&nbsp;%v,&nbsp;want&nbsp;nil&#34;</span><span class="op" id="6790026">,</span>&nbsp;<span class="ident" id="6790028">err</span><span class="op" id="6790031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6790034">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6790037">text</span>&nbsp;<span class="op" id="6790042">:=</span>&nbsp;<span class="ident" id="6790045">buff</span><span class="op" id="6790049">.</span><span class="ident" id="6790050">String</span><span class="op" id="6790056">(</span><span class="op" id="6790057">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790061">if</span>&nbsp;<span class="ident" id="6790064">text</span>&nbsp;<span class="op" id="6790069">!=</span>&nbsp;<span class="ident" id="6790072">expected</span>&nbsp;<span class="op" id="6790081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6790085">t</span><span class="op" id="6790086">.</span><span class="ident" id="6790087">Errorf</span><span class="op" id="6790093">(</span><span class="string" id="6790094">&#34;have&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6790112">,</span>&nbsp;<span class="ident" id="6790114">text</span><span class="op" id="6790118">,</span>&nbsp;<span class="ident" id="6790120">expected</span><span class="op" id="6790128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6790131">}</span><br>
<span class="lineno"></span><span class="op" id="6790133">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">740</span><span class="keyword" id="6790136">func</span>&nbsp;<span class="ident" id="6790141">TestIssue5880</span><span class="op" id="6790154">(</span><span class="ident" id="6790155">t</span>&nbsp;<span class="op" id="6790157">*</span><span class="ident" id="6790158">testing</span><span class="op" id="6790165">.</span><span class="ident" id="6790166">T</span><span class="op" id="6790167">)</span>&nbsp;<span class="op" id="6790169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790172">type</span>&nbsp;<span class="ident" id="6790177">T</span>&nbsp;<span class="op" id="6790179">[</span><span class="op" id="6790180">]</span><span class="builtintype" id="6790181">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6790187">data</span><span class="op" id="6790191">,</span>&nbsp;<span class="ident" id="6790193">err</span>&nbsp;<span class="op" id="6790197">:=</span>&nbsp;<span class="ident" id="6790200">Marshal</span><span class="op" id="6790207">(</span><span class="ident" id="6790208">T</span><span class="op" id="6790209">{</span><span class="num" id="6790210">192</span><span class="op" id="6790213">,</span>&nbsp;<span class="num" id="6790215">168</span><span class="op" id="6790218">,</span>&nbsp;<span class="num" id="6790220">0</span><span class="op" id="6790221">,</span>&nbsp;<span class="num" id="6790223">1</span><span class="op" id="6790224">}</span><span class="op" id="6790225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790228">if</span>&nbsp;<span class="ident" id="6790231">err</span>&nbsp;<span class="op" id="6790235">!=</span>&nbsp;<span class="ident" id="6790238">nil</span>&nbsp;<span class="op" id="6790242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6790246">t</span><span class="op" id="6790247">.</span><span class="ident" id="6790248">Errorf</span><span class="op" id="6790254">(</span><span class="string" id="6790255">&#34;Marshal&nbsp;error:&nbsp;%v&#34;</span><span class="op" id="6790274">,</span>&nbsp;<span class="ident" id="6790276">err</span><span class="op" id="6790279">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6790282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6790285">if</span>&nbsp;<span class="op" id="6790288">!</span><span class="ident" id="6790289">utf8</span><span class="op" id="6790293">.</span><span class="ident" id="6790294">Valid</span><span class="op" id="6790299">(</span><span class="ident" id="6790300">data</span><span class="op" id="6790304">)</span>&nbsp;<span class="op" id="6790306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6790310">t</span><span class="op" id="6790311">.</span><span class="ident" id="6790312">Errorf</span><span class="op" id="6790318">(</span><span class="string" id="6790319">&#34;Marshal&nbsp;generated&nbsp;invalid&nbsp;UTF-8:&nbsp;%x&#34;</span><span class="op" id="6790356">,</span>&nbsp;<span class="ident" id="6790358">data</span><span class="op" id="6790362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6790365">}</span><br>
<span class="lineno"></span><span class="op" id="6790367">}</span>
</div>
</body>
</html>
