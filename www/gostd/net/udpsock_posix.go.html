<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html" class="current">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4022013">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4022069">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4022123">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4022174">//&nbsp;+build&nbsp;darwin&nbsp;dragonfly&nbsp;freebsd&nbsp;linux&nbsp;nacl&nbsp;netbsd&nbsp;openbsd&nbsp;solaris&nbsp;windows</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4022252">package</span>&nbsp;<span class="ident" id="4022260">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4022265">import</span>&nbsp;<span class="op" id="4022272">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4022275">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4022286">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4022293">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4022296">func</span>&nbsp;<span class="ident" id="4022301">sockaddrToUDP</span><span class="op" id="4022314">(</span><span class="ident" id="4022315">sa</span>&nbsp;<span class="ident" id="4022318">syscall</span><span class="op" id="4022325">.</span><span class="ident" id="4022326">Sockaddr</span><span class="op" id="4022334">)</span>&nbsp;<span class="ident" id="4022336">Addr</span>&nbsp;<span class="op" id="4022341">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4022344">switch</span>&nbsp;<span class="ident" id="4022351">sa</span>&nbsp;<span class="op" id="4022354">:=</span>&nbsp;<span class="ident" id="4022357">sa</span><span class="op" id="4022359">.</span><span class="op" id="4022360">(</span><span class="keyword" id="4022361">type</span><span class="op" id="4022365">)</span>&nbsp;<span class="op" id="4022367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4022370">case</span>&nbsp;<span class="op" id="4022375">*</span><span class="ident" id="4022376">syscall</span><span class="op" id="4022383">.</span><span class="ident" id="4022384">SockaddrInet4</span><span class="op" id="4022397">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4022401">return</span>&nbsp;<span class="op" id="4022408">&amp;</span><span class="ident" id="4022409">UDPAddr</span><span class="op" id="4022416">{</span><span class="ident" id="4022417">IP</span><span class="op" id="4022419">:</span>&nbsp;<span class="ident" id="4022421">sa</span><span class="op" id="4022423">.</span><span class="ident" id="4022424">Addr</span><span class="op" id="4022428">[</span><span class="num" id="4022429">0</span><span class="op" id="4022430">:</span><span class="op" id="4022431">]</span><span class="op" id="4022432">,</span>&nbsp;<span class="ident" id="4022434">Port</span><span class="op" id="4022438">:</span>&nbsp;<span class="ident" id="4022440">sa</span><span class="op" id="4022442">.</span><span class="ident" id="4022443">Port</span><span class="op" id="4022447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4022450">case</span>&nbsp;<span class="op" id="4022455">*</span><span class="ident" id="4022456">syscall</span><span class="op" id="4022463">.</span><span class="ident" id="4022464">SockaddrInet6</span><span class="op" id="4022477">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4022481">return</span>&nbsp;<span class="op" id="4022488">&amp;</span><span class="ident" id="4022489">UDPAddr</span><span class="op" id="4022496">{</span><span class="ident" id="4022497">IP</span><span class="op" id="4022499">:</span>&nbsp;<span class="ident" id="4022501">sa</span><span class="op" id="4022503">.</span><span class="ident" id="4022504">Addr</span><span class="op" id="4022508">[</span><span class="num" id="4022509">0</span><span class="op" id="4022510">:</span><span class="op" id="4022511">]</span><span class="op" id="4022512">,</span>&nbsp;<span class="ident" id="4022514">Port</span><span class="op" id="4022518">:</span>&nbsp;<span class="ident" id="4022520">sa</span><span class="op" id="4022522">.</span><span class="ident" id="4022523">Port</span><span class="op" id="4022527">,</span>&nbsp;<span class="ident" id="4022529">Zone</span><span class="op" id="4022533">:</span>&nbsp;<span class="ident" id="4022535">zoneToString</span><span class="op" id="4022547">(</span><span class="builtintype" id="4022548">int</span><span class="op" id="4022551">(</span><span class="ident" id="4022552">sa</span><span class="op" id="4022554">.</span><span class="ident" id="4022555">ZoneId</span><span class="op" id="4022561">)</span><span class="op" id="4022562">)</span><span class="op" id="4022563">}</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4022566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4022569">return</span>&nbsp;<span class="builtintype" id="4022576">nil</span><br>
<span class="lineno"></span><span class="op" id="4022580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4022583">func</span>&nbsp;<span class="op" id="4022588">(</span><span class="ident" id="4022589">a</span>&nbsp;<span class="op" id="4022591">*</span><span class="ident" id="4022592">UDPAddr</span><span class="op" id="4022599">)</span>&nbsp;<span class="ident" id="4022601">family</span><span class="op" id="4022607">(</span><span class="op" id="4022608">)</span>&nbsp;<span class="builtintype" id="4022610">int</span>&nbsp;<span class="op" id="4022614">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4022617">if</span>&nbsp;<span class="ident" id="4022620">a</span>&nbsp;<span class="op" id="4022622">==</span>&nbsp;<span class="builtintype" id="4022625">nil</span>&nbsp;<span class="op" id="4022629">||</span>&nbsp;<span class="builtinfunc" id="4022632">len</span><span class="op" id="4022635">(</span><span class="ident" id="4022636">a</span><span class="op" id="4022637">.</span><span class="ident" id="4022638">IP</span><span class="op" id="4022640">)</span>&nbsp;<span class="op" id="4022642">&lt;=</span>&nbsp;<span class="ident" id="4022645">IPv4len</span>&nbsp;<span class="op" id="4022653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4022657">return</span>&nbsp;<span class="ident" id="4022664">syscall</span><span class="op" id="4022671">.</span><span class="ident" id="4022672">AF_INET</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4022681">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4022684">if</span>&nbsp;<span class="ident" id="4022687">a</span><span class="op" id="4022688">.</span><span class="ident" id="4022689">IP</span><span class="op" id="4022691">.</span><span class="ident" id="4022692">To4</span><span class="op" id="4022695">(</span><span class="op" id="4022696">)</span>&nbsp;<span class="op" id="4022698">!=</span>&nbsp;<span class="builtintype" id="4022701">nil</span>&nbsp;<span class="op" id="4022705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4022709">return</span>&nbsp;<span class="ident" id="4022716">syscall</span><span class="op" id="4022723">.</span><span class="ident" id="4022724">AF_INET</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4022733">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4022736">return</span>&nbsp;<span class="ident" id="4022743">syscall</span><span class="op" id="4022750">.</span><span class="ident" id="4022751">AF_INET6</span><br>
<span class="lineno"></span><span class="op" id="4022760">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4022763">func</span>&nbsp;<span class="op" id="4022768">(</span><span class="ident" id="4022769">a</span>&nbsp;<span class="op" id="4022771">*</span><span class="ident" id="4022772">UDPAddr</span><span class="op" id="4022779">)</span>&nbsp;<span class="ident" id="4022781">isWildcard</span><span class="op" id="4022791">(</span><span class="op" id="4022792">)</span>&nbsp;<span class="builtintype" id="4022794">bool</span>&nbsp;<span class="op" id="4022799">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4022802">if</span>&nbsp;<span class="ident" id="4022805">a</span>&nbsp;<span class="op" id="4022807">==</span>&nbsp;<span class="builtintype" id="4022810">nil</span>&nbsp;<span class="op" id="4022814">||</span>&nbsp;<span class="ident" id="4022817">a</span><span class="op" id="4022818">.</span><span class="ident" id="4022819">IP</span>&nbsp;<span class="op" id="4022822">==</span>&nbsp;<span class="builtintype" id="4022825">nil</span>&nbsp;<span class="op" id="4022829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4022833">return</span>&nbsp;<span class="builtintype" id="4022840">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4022846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4022849">return</span>&nbsp;<span class="ident" id="4022856">a</span><span class="op" id="4022857">.</span><span class="ident" id="4022858">IP</span><span class="op" id="4022860">.</span><span class="ident" id="4022861">IsUnspecified</span><span class="op" id="4022874">(</span><span class="op" id="4022875">)</span><br>
<span class="lineno"></span><span class="op" id="4022877">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="4022880">func</span>&nbsp;<span class="op" id="4022885">(</span><span class="ident" id="4022886">a</span>&nbsp;<span class="op" id="4022888">*</span><span class="ident" id="4022889">UDPAddr</span><span class="op" id="4022896">)</span>&nbsp;<span class="ident" id="4022898">sockaddr</span><span class="op" id="4022906">(</span><span class="ident" id="4022907">family</span>&nbsp;<span class="builtintype" id="4022914">int</span><span class="op" id="4022917">)</span>&nbsp;<span class="op" id="4022919">(</span><span class="ident" id="4022920">syscall</span><span class="op" id="4022927">.</span><span class="ident" id="4022928">Sockaddr</span><span class="op" id="4022936">,</span>&nbsp;<span class="builtintype" id="4022938">error</span><span class="op" id="4022943">)</span>&nbsp;<span class="op" id="4022945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4022948">if</span>&nbsp;<span class="ident" id="4022951">a</span>&nbsp;<span class="op" id="4022953">==</span>&nbsp;<span class="builtintype" id="4022956">nil</span>&nbsp;<span class="op" id="4022960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4022964">return</span>&nbsp;<span class="builtintype" id="4022971">nil</span><span class="op" id="4022974">,</span>&nbsp;<span class="builtintype" id="4022976">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4022981">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4022984">return</span>&nbsp;<span class="ident" id="4022991">ipToSockaddr</span><span class="op" id="4023003">(</span><span class="ident" id="4023004">family</span><span class="op" id="4023010">,</span>&nbsp;<span class="ident" id="4023012">a</span><span class="op" id="4023013">.</span><span class="ident" id="4023014">IP</span><span class="op" id="4023016">,</span>&nbsp;<span class="ident" id="4023018">a</span><span class="op" id="4023019">.</span><span class="ident" id="4023020">Port</span><span class="op" id="4023024">,</span>&nbsp;<span class="ident" id="4023026">a</span><span class="op" id="4023027">.</span><span class="ident" id="4023028">Zone</span><span class="op" id="4023032">)</span><br>
<span class="lineno"></span><span class="op" id="4023034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4023037">//&nbsp;UDPConn&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;Conn&nbsp;and&nbsp;PacketConn&nbsp;interfaces</span><br>
<span class="lineno"></span><span class="comment" id="4023108">//&nbsp;for&nbsp;UDP&nbsp;network&nbsp;connections.</span><br>
<span class="lineno">50</span><span class="keyword" id="4023140">type</span>&nbsp;<span class="ident" id="4023145">UDPConn</span>&nbsp;<span class="keyword" id="4023153">struct</span>&nbsp;<span class="op" id="4023160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4023163">conn</span><br>
<span class="lineno"></span><span class="op" id="4023168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4023171">func</span>&nbsp;<span class="ident" id="4023176">newUDPConn</span><span class="op" id="4023186">(</span><span class="ident" id="4023187">fd</span>&nbsp;<span class="op" id="4023190">*</span><span class="ident" id="4023191">netFD</span><span class="op" id="4023196">)</span>&nbsp;<span class="op" id="4023198">*</span><span class="ident" id="4023199">UDPConn</span>&nbsp;<span class="op" id="4023207">{</span>&nbsp;<span class="keyword" id="4023209">return</span>&nbsp;<span class="op" id="4023216">&amp;</span><span class="ident" id="4023217">UDPConn</span><span class="op" id="4023224">{</span><span class="ident" id="4023225">conn</span><span class="op" id="4023229">{</span><span class="ident" id="4023230">fd</span><span class="op" id="4023232">}</span><span class="op" id="4023233">}</span>&nbsp;<span class="op" id="4023235">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span><span class="comment" id="4023238">//&nbsp;ReadFromUDP&nbsp;reads&nbsp;a&nbsp;UDP&nbsp;packet&nbsp;from&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b.</span><br>
<span class="lineno"></span><span class="comment" id="4023308">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b&nbsp;and&nbsp;the&nbsp;return&nbsp;address</span><br>
<span class="lineno"></span><span class="comment" id="4023379">//&nbsp;that&nbsp;was&nbsp;on&nbsp;the&nbsp;packet.</span><br>
<span class="lineno"></span><span class="comment" id="4023406">//</span><br>
<span class="lineno">60</span><span class="comment" id="4023409">//&nbsp;ReadFromUDP&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;an&nbsp;error&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4023473">//&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4023540">//&nbsp;SetReadDeadline.</span><br>
<span class="lineno"></span><span class="keyword" id="4023560">func</span>&nbsp;<span class="op" id="4023565">(</span><span class="ident" id="4023566">c</span>&nbsp;<span class="op" id="4023568">*</span><span class="ident" id="4023569">UDPConn</span><span class="op" id="4023576">)</span>&nbsp;<span class="ident" id="4023578">ReadFromUDP</span><span class="op" id="4023589">(</span><span class="ident" id="4023590">b</span>&nbsp;<span class="op" id="4023592">[</span><span class="op" id="4023593">]</span><span class="builtintype" id="4023594">byte</span><span class="op" id="4023598">)</span>&nbsp;<span class="op" id="4023600">(</span><span class="ident" id="4023601">n</span>&nbsp;<span class="builtintype" id="4023603">int</span><span class="op" id="4023606">,</span>&nbsp;<span class="ident" id="4023608">addr</span>&nbsp;<span class="op" id="4023613">*</span><span class="ident" id="4023614">UDPAddr</span><span class="op" id="4023621">,</span>&nbsp;<span class="ident" id="4023623">err</span>&nbsp;<span class="builtintype" id="4023627">error</span><span class="op" id="4023632">)</span>&nbsp;<span class="op" id="4023634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4023637">if</span>&nbsp;<span class="op" id="4023640">!</span><span class="ident" id="4023641">c</span><span class="op" id="4023642">.</span><span class="ident" id="4023643">ok</span><span class="op" id="4023645">(</span><span class="op" id="4023646">)</span>&nbsp;<span class="op" id="4023648">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4023652">return</span>&nbsp;<span class="num" id="4023659">0</span><span class="op" id="4023660">,</span>&nbsp;<span class="builtintype" id="4023662">nil</span><span class="op" id="4023665">,</span>&nbsp;<span class="ident" id="4023667">syscall</span><span class="op" id="4023674">.</span><span class="ident" id="4023675">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4023683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4023686">n</span><span class="op" id="4023687">,</span>&nbsp;<span class="ident" id="4023689">sa</span><span class="op" id="4023691">,</span>&nbsp;<span class="ident" id="4023693">err</span>&nbsp;<span class="op" id="4023697">:=</span>&nbsp;<span class="ident" id="4023700">c</span><span class="op" id="4023701">.</span><span class="ident" id="4023702">fd</span><span class="op" id="4023704">.</span><span class="ident" id="4023705">readFrom</span><span class="op" id="4023713">(</span><span class="ident" id="4023714">b</span><span class="op" id="4023715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4023718">switch</span>&nbsp;<span class="ident" id="4023725">sa</span>&nbsp;<span class="op" id="4023728">:=</span>&nbsp;<span class="ident" id="4023731">sa</span><span class="op" id="4023733">.</span><span class="op" id="4023734">(</span><span class="keyword" id="4023735">type</span><span class="op" id="4023739">)</span>&nbsp;<span class="op" id="4023741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4023744">case</span>&nbsp;<span class="op" id="4023749">*</span><span class="ident" id="4023750">syscall</span><span class="op" id="4023757">.</span><span class="ident" id="4023758">SockaddrInet4</span><span class="op" id="4023771">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4023775">addr</span>&nbsp;<span class="op" id="4023780">=</span>&nbsp;<span class="op" id="4023782">&amp;</span><span class="ident" id="4023783">UDPAddr</span><span class="op" id="4023790">{</span><span class="ident" id="4023791">IP</span><span class="op" id="4023793">:</span>&nbsp;<span class="ident" id="4023795">sa</span><span class="op" id="4023797">.</span><span class="ident" id="4023798">Addr</span><span class="op" id="4023802">[</span><span class="num" id="4023803">0</span><span class="op" id="4023804">:</span><span class="op" id="4023805">]</span><span class="op" id="4023806">,</span>&nbsp;<span class="ident" id="4023808">Port</span><span class="op" id="4023812">:</span>&nbsp;<span class="ident" id="4023814">sa</span><span class="op" id="4023816">.</span><span class="ident" id="4023817">Port</span><span class="op" id="4023821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4023824">case</span>&nbsp;<span class="op" id="4023829">*</span><span class="ident" id="4023830">syscall</span><span class="op" id="4023837">.</span><span class="ident" id="4023838">SockaddrInet6</span><span class="op" id="4023851">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4023855">addr</span>&nbsp;<span class="op" id="4023860">=</span>&nbsp;<span class="op" id="4023862">&amp;</span><span class="ident" id="4023863">UDPAddr</span><span class="op" id="4023870">{</span><span class="ident" id="4023871">IP</span><span class="op" id="4023873">:</span>&nbsp;<span class="ident" id="4023875">sa</span><span class="op" id="4023877">.</span><span class="ident" id="4023878">Addr</span><span class="op" id="4023882">[</span><span class="num" id="4023883">0</span><span class="op" id="4023884">:</span><span class="op" id="4023885">]</span><span class="op" id="4023886">,</span>&nbsp;<span class="ident" id="4023888">Port</span><span class="op" id="4023892">:</span>&nbsp;<span class="ident" id="4023894">sa</span><span class="op" id="4023896">.</span><span class="ident" id="4023897">Port</span><span class="op" id="4023901">,</span>&nbsp;<span class="ident" id="4023903">Zone</span><span class="op" id="4023907">:</span>&nbsp;<span class="ident" id="4023909">zoneToString</span><span class="op" id="4023921">(</span><span class="builtintype" id="4023922">int</span><span class="op" id="4023925">(</span><span class="ident" id="4023926">sa</span><span class="op" id="4023928">.</span><span class="ident" id="4023929">ZoneId</span><span class="op" id="4023935">)</span><span class="op" id="4023936">)</span><span class="op" id="4023937">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4023940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4023943">return</span><br>
<span class="lineno">75</span><span class="op" id="4023950">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4023953">//&nbsp;ReadFrom&nbsp;implements&nbsp;the&nbsp;PacketConn&nbsp;ReadFrom&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="4024008">func</span>&nbsp;<span class="op" id="4024013">(</span><span class="ident" id="4024014">c</span>&nbsp;<span class="op" id="4024016">*</span><span class="ident" id="4024017">UDPConn</span><span class="op" id="4024024">)</span>&nbsp;<span class="ident" id="4024026">ReadFrom</span><span class="op" id="4024034">(</span><span class="ident" id="4024035">b</span>&nbsp;<span class="op" id="4024037">[</span><span class="op" id="4024038">]</span><span class="builtintype" id="4024039">byte</span><span class="op" id="4024043">)</span>&nbsp;<span class="op" id="4024045">(</span><span class="builtintype" id="4024046">int</span><span class="op" id="4024049">,</span>&nbsp;<span class="ident" id="4024051">Addr</span><span class="op" id="4024055">,</span>&nbsp;<span class="builtintype" id="4024057">error</span><span class="op" id="4024062">)</span>&nbsp;<span class="op" id="4024064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4024067">if</span>&nbsp;<span class="op" id="4024070">!</span><span class="ident" id="4024071">c</span><span class="op" id="4024072">.</span><span class="ident" id="4024073">ok</span><span class="op" id="4024075">(</span><span class="op" id="4024076">)</span>&nbsp;<span class="op" id="4024078">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4024082">return</span>&nbsp;<span class="num" id="4024089">0</span><span class="op" id="4024090">,</span>&nbsp;<span class="builtintype" id="4024092">nil</span><span class="op" id="4024095">,</span>&nbsp;<span class="ident" id="4024097">syscall</span><span class="op" id="4024104">.</span><span class="ident" id="4024105">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4024113">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4024116">n</span><span class="op" id="4024117">,</span>&nbsp;<span class="ident" id="4024119">addr</span><span class="op" id="4024123">,</span>&nbsp;<span class="ident" id="4024125">err</span>&nbsp;<span class="op" id="4024129">:=</span>&nbsp;<span class="ident" id="4024132">c</span><span class="op" id="4024133">.</span><span class="ident" id="4024134">ReadFromUDP</span><span class="op" id="4024145">(</span><span class="ident" id="4024146">b</span><span class="op" id="4024147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4024150">return</span>&nbsp;<span class="ident" id="4024157">n</span><span class="op" id="4024158">,</span>&nbsp;<span class="ident" id="4024160">addr</span><span class="op" id="4024164">.</span><span class="ident" id="4024165">toAddr</span><span class="op" id="4024171">(</span><span class="op" id="4024172">)</span><span class="op" id="4024173">,</span>&nbsp;<span class="ident" id="4024175">err</span><br>
<span class="lineno"></span><span class="op" id="4024179">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="4024182">//&nbsp;ReadMsgUDP&nbsp;reads&nbsp;a&nbsp;packet&nbsp;from&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;into&nbsp;b&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4024250">//&nbsp;the&nbsp;associated&nbsp;out-of-band&nbsp;data&nbsp;into&nbsp;oob.&nbsp;&nbsp;It&nbsp;returns&nbsp;the&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="4024318">//&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;b,&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes&nbsp;copied&nbsp;into&nbsp;oob,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4024386">//&nbsp;flags&nbsp;that&nbsp;were&nbsp;set&nbsp;on&nbsp;the&nbsp;packet&nbsp;and&nbsp;the&nbsp;source&nbsp;address&nbsp;of&nbsp;the</span><br>
<span class="lineno">90</span><span class="comment" id="4024453">//&nbsp;packet.</span><br>
<span class="lineno"></span><span class="keyword" id="4024464">func</span>&nbsp;<span class="op" id="4024469">(</span><span class="ident" id="4024470">c</span>&nbsp;<span class="op" id="4024472">*</span><span class="ident" id="4024473">UDPConn</span><span class="op" id="4024480">)</span>&nbsp;<span class="ident" id="4024482">ReadMsgUDP</span><span class="op" id="4024492">(</span><span class="ident" id="4024493">b</span><span class="op" id="4024494">,</span>&nbsp;<span class="ident" id="4024496">oob</span>&nbsp;<span class="op" id="4024500">[</span><span class="op" id="4024501">]</span><span class="builtintype" id="4024502">byte</span><span class="op" id="4024506">)</span>&nbsp;<span class="op" id="4024508">(</span><span class="ident" id="4024509">n</span><span class="op" id="4024510">,</span>&nbsp;<span class="ident" id="4024512">oobn</span><span class="op" id="4024516">,</span>&nbsp;<span class="ident" id="4024518">flags</span>&nbsp;<span class="builtintype" id="4024524">int</span><span class="op" id="4024527">,</span>&nbsp;<span class="ident" id="4024529">addr</span>&nbsp;<span class="op" id="4024534">*</span><span class="ident" id="4024535">UDPAddr</span><span class="op" id="4024542">,</span>&nbsp;<span class="ident" id="4024544">err</span>&nbsp;<span class="builtintype" id="4024548">error</span><span class="op" id="4024553">)</span>&nbsp;<span class="op" id="4024555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4024558">if</span>&nbsp;<span class="op" id="4024561">!</span><span class="ident" id="4024562">c</span><span class="op" id="4024563">.</span><span class="ident" id="4024564">ok</span><span class="op" id="4024566">(</span><span class="op" id="4024567">)</span>&nbsp;<span class="op" id="4024569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4024573">return</span>&nbsp;<span class="num" id="4024580">0</span><span class="op" id="4024581">,</span>&nbsp;<span class="num" id="4024583">0</span><span class="op" id="4024584">,</span>&nbsp;<span class="num" id="4024586">0</span><span class="op" id="4024587">,</span>&nbsp;<span class="builtintype" id="4024589">nil</span><span class="op" id="4024592">,</span>&nbsp;<span class="ident" id="4024594">syscall</span><span class="op" id="4024601">.</span><span class="ident" id="4024602">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4024610">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4024613">var</span>&nbsp;<span class="ident" id="4024617">sa</span>&nbsp;<span class="ident" id="4024620">syscall</span><span class="op" id="4024627">.</span><span class="ident" id="4024628">Sockaddr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4024638">n</span><span class="op" id="4024639">,</span>&nbsp;<span class="ident" id="4024641">oobn</span><span class="op" id="4024645">,</span>&nbsp;<span class="ident" id="4024647">flags</span><span class="op" id="4024652">,</span>&nbsp;<span class="ident" id="4024654">sa</span><span class="op" id="4024656">,</span>&nbsp;<span class="ident" id="4024658">err</span>&nbsp;<span class="op" id="4024662">=</span>&nbsp;<span class="ident" id="4024664">c</span><span class="op" id="4024665">.</span><span class="ident" id="4024666">fd</span><span class="op" id="4024668">.</span><span class="ident" id="4024669">readMsg</span><span class="op" id="4024676">(</span><span class="ident" id="4024677">b</span><span class="op" id="4024678">,</span>&nbsp;<span class="ident" id="4024680">oob</span><span class="op" id="4024683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4024686">switch</span>&nbsp;<span class="ident" id="4024693">sa</span>&nbsp;<span class="op" id="4024696">:=</span>&nbsp;<span class="ident" id="4024699">sa</span><span class="op" id="4024701">.</span><span class="op" id="4024702">(</span><span class="keyword" id="4024703">type</span><span class="op" id="4024707">)</span>&nbsp;<span class="op" id="4024709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4024712">case</span>&nbsp;<span class="op" id="4024717">*</span><span class="ident" id="4024718">syscall</span><span class="op" id="4024725">.</span><span class="ident" id="4024726">SockaddrInet4</span><span class="op" id="4024739">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4024743">addr</span>&nbsp;<span class="op" id="4024748">=</span>&nbsp;<span class="op" id="4024750">&amp;</span><span class="ident" id="4024751">UDPAddr</span><span class="op" id="4024758">{</span><span class="ident" id="4024759">IP</span><span class="op" id="4024761">:</span>&nbsp;<span class="ident" id="4024763">sa</span><span class="op" id="4024765">.</span><span class="ident" id="4024766">Addr</span><span class="op" id="4024770">[</span><span class="num" id="4024771">0</span><span class="op" id="4024772">:</span><span class="op" id="4024773">]</span><span class="op" id="4024774">,</span>&nbsp;<span class="ident" id="4024776">Port</span><span class="op" id="4024780">:</span>&nbsp;<span class="ident" id="4024782">sa</span><span class="op" id="4024784">.</span><span class="ident" id="4024785">Port</span><span class="op" id="4024789">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4024792">case</span>&nbsp;<span class="op" id="4024797">*</span><span class="ident" id="4024798">syscall</span><span class="op" id="4024805">.</span><span class="ident" id="4024806">SockaddrInet6</span><span class="op" id="4024819">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4024823">addr</span>&nbsp;<span class="op" id="4024828">=</span>&nbsp;<span class="op" id="4024830">&amp;</span><span class="ident" id="4024831">UDPAddr</span><span class="op" id="4024838">{</span><span class="ident" id="4024839">IP</span><span class="op" id="4024841">:</span>&nbsp;<span class="ident" id="4024843">sa</span><span class="op" id="4024845">.</span><span class="ident" id="4024846">Addr</span><span class="op" id="4024850">[</span><span class="num" id="4024851">0</span><span class="op" id="4024852">:</span><span class="op" id="4024853">]</span><span class="op" id="4024854">,</span>&nbsp;<span class="ident" id="4024856">Port</span><span class="op" id="4024860">:</span>&nbsp;<span class="ident" id="4024862">sa</span><span class="op" id="4024864">.</span><span class="ident" id="4024865">Port</span><span class="op" id="4024869">,</span>&nbsp;<span class="ident" id="4024871">Zone</span><span class="op" id="4024875">:</span>&nbsp;<span class="ident" id="4024877">zoneToString</span><span class="op" id="4024889">(</span><span class="builtintype" id="4024890">int</span><span class="op" id="4024893">(</span><span class="ident" id="4024894">sa</span><span class="op" id="4024896">.</span><span class="ident" id="4024897">ZoneId</span><span class="op" id="4024903">)</span><span class="op" id="4024904">)</span><span class="op" id="4024905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4024908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4024911">return</span><br>
<span class="lineno"></span><span class="op" id="4024918">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4024921">//&nbsp;WriteToUDP&nbsp;writes&nbsp;a&nbsp;UDP&nbsp;packet&nbsp;to&nbsp;addr&nbsp;via&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload</span><br>
<span class="lineno"></span><span class="comment" id="4024990">//&nbsp;from&nbsp;b.</span><br>
<span class="lineno"></span><span class="comment" id="4025001">//</span><br>
<span class="lineno"></span><span class="comment" id="4025004">//&nbsp;WriteToUDP&nbsp;can&nbsp;be&nbsp;made&nbsp;to&nbsp;time&nbsp;out&nbsp;and&nbsp;return&nbsp;an&nbsp;error&nbsp;with</span><br>
<span class="lineno">110</span><span class="comment" id="4025067">//&nbsp;Timeout()&nbsp;==&nbsp;true&nbsp;after&nbsp;a&nbsp;fixed&nbsp;time&nbsp;limit;&nbsp;see&nbsp;SetDeadline&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4025134">//&nbsp;SetWriteDeadline.&nbsp;&nbsp;On&nbsp;packet-oriented&nbsp;connections,&nbsp;write&nbsp;timeouts</span><br>
<span class="lineno"></span><span class="comment" id="4025203">//&nbsp;are&nbsp;rare.</span><br>
<span class="lineno"></span><span class="keyword" id="4025216">func</span>&nbsp;<span class="op" id="4025221">(</span><span class="ident" id="4025222">c</span>&nbsp;<span class="op" id="4025224">*</span><span class="ident" id="4025225">UDPConn</span><span class="op" id="4025232">)</span>&nbsp;<span class="ident" id="4025234">WriteToUDP</span><span class="op" id="4025244">(</span><span class="ident" id="4025245">b</span>&nbsp;<span class="op" id="4025247">[</span><span class="op" id="4025248">]</span><span class="builtintype" id="4025249">byte</span><span class="op" id="4025253">,</span>&nbsp;<span class="ident" id="4025255">addr</span>&nbsp;<span class="op" id="4025260">*</span><span class="ident" id="4025261">UDPAddr</span><span class="op" id="4025268">)</span>&nbsp;<span class="op" id="4025270">(</span><span class="builtintype" id="4025271">int</span><span class="op" id="4025274">,</span>&nbsp;<span class="builtintype" id="4025276">error</span><span class="op" id="4025281">)</span>&nbsp;<span class="op" id="4025283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4025286">if</span>&nbsp;<span class="op" id="4025289">!</span><span class="ident" id="4025290">c</span><span class="op" id="4025291">.</span><span class="ident" id="4025292">ok</span><span class="op" id="4025294">(</span><span class="op" id="4025295">)</span>&nbsp;<span class="op" id="4025297">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4025301">return</span>&nbsp;<span class="num" id="4025308">0</span><span class="op" id="4025309">,</span>&nbsp;<span class="ident" id="4025311">syscall</span><span class="op" id="4025318">.</span><span class="ident" id="4025319">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4025327">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4025330">if</span>&nbsp;<span class="ident" id="4025333">c</span><span class="op" id="4025334">.</span><span class="ident" id="4025335">fd</span><span class="op" id="4025337">.</span><span class="ident" id="4025338">isConnected</span>&nbsp;<span class="op" id="4025350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4025354">return</span>&nbsp;<span class="num" id="4025361">0</span><span class="op" id="4025362">,</span>&nbsp;<span class="op" id="4025364">&amp;</span><span class="ident" id="4025365">OpError</span><span class="op" id="4025372">{</span><span class="string" id="4025373">&#34;write&#34;</span><span class="op" id="4025380">,</span>&nbsp;<span class="ident" id="4025382">c</span><span class="op" id="4025383">.</span><span class="ident" id="4025384">fd</span><span class="op" id="4025386">.</span><span class="ident" id="4025387">net</span><span class="op" id="4025390">,</span>&nbsp;<span class="ident" id="4025392">addr</span><span class="op" id="4025396">,</span>&nbsp;<span class="ident" id="4025398">ErrWriteToConnected</span><span class="op" id="4025417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4025420">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4025423">if</span>&nbsp;<span class="ident" id="4025426">addr</span>&nbsp;<span class="op" id="4025431">==</span>&nbsp;<span class="builtintype" id="4025434">nil</span>&nbsp;<span class="op" id="4025438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4025442">return</span>&nbsp;<span class="num" id="4025449">0</span><span class="op" id="4025450">,</span>&nbsp;<span class="op" id="4025452">&amp;</span><span class="ident" id="4025453">OpError</span><span class="op" id="4025460">{</span><span class="ident" id="4025461">Op</span><span class="op" id="4025463">:</span>&nbsp;<span class="string" id="4025465">&#34;write&#34;</span><span class="op" id="4025472">,</span>&nbsp;<span class="ident" id="4025474">Net</span><span class="op" id="4025477">:</span>&nbsp;<span class="ident" id="4025479">c</span><span class="op" id="4025480">.</span><span class="ident" id="4025481">fd</span><span class="op" id="4025483">.</span><span class="ident" id="4025484">net</span><span class="op" id="4025487">,</span>&nbsp;<span class="ident" id="4025489">Addr</span><span class="op" id="4025493">:</span>&nbsp;<span class="builtintype" id="4025495">nil</span><span class="op" id="4025498">,</span>&nbsp;<span class="ident" id="4025500">Err</span><span class="op" id="4025503">:</span>&nbsp;<span class="ident" id="4025505">errMissingAddress</span><span class="op" id="4025522">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4025525">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4025528">sa</span><span class="op" id="4025530">,</span>&nbsp;<span class="ident" id="4025532">err</span>&nbsp;<span class="op" id="4025536">:=</span>&nbsp;<span class="ident" id="4025539">addr</span><span class="op" id="4025543">.</span><span class="ident" id="4025544">sockaddr</span><span class="op" id="4025552">(</span><span class="ident" id="4025553">c</span><span class="op" id="4025554">.</span><span class="ident" id="4025555">fd</span><span class="op" id="4025557">.</span><span class="ident" id="4025558">family</span><span class="op" id="4025564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4025567">if</span>&nbsp;<span class="ident" id="4025570">err</span>&nbsp;<span class="op" id="4025574">!=</span>&nbsp;<span class="builtintype" id="4025577">nil</span>&nbsp;<span class="op" id="4025581">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4025585">return</span>&nbsp;<span class="num" id="4025592">0</span><span class="op" id="4025593">,</span>&nbsp;<span class="op" id="4025595">&amp;</span><span class="ident" id="4025596">OpError</span><span class="op" id="4025603">{</span><span class="string" id="4025604">&#34;write&#34;</span><span class="op" id="4025611">,</span>&nbsp;<span class="ident" id="4025613">c</span><span class="op" id="4025614">.</span><span class="ident" id="4025615">fd</span><span class="op" id="4025617">.</span><span class="ident" id="4025618">net</span><span class="op" id="4025621">,</span>&nbsp;<span class="ident" id="4025623">addr</span><span class="op" id="4025627">,</span>&nbsp;<span class="ident" id="4025629">err</span><span class="op" id="4025632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4025635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4025638">return</span>&nbsp;<span class="ident" id="4025645">c</span><span class="op" id="4025646">.</span><span class="ident" id="4025647">fd</span><span class="op" id="4025649">.</span><span class="ident" id="4025650">writeTo</span><span class="op" id="4025657">(</span><span class="ident" id="4025658">b</span><span class="op" id="4025659">,</span>&nbsp;<span class="ident" id="4025661">sa</span><span class="op" id="4025663">)</span><br>
<span class="lineno"></span><span class="op" id="4025665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="comment" id="4025668">//&nbsp;WriteTo&nbsp;implements&nbsp;the&nbsp;PacketConn&nbsp;WriteTo&nbsp;method.</span><br>
<span class="lineno"></span><span class="keyword" id="4025721">func</span>&nbsp;<span class="op" id="4025726">(</span><span class="ident" id="4025727">c</span>&nbsp;<span class="op" id="4025729">*</span><span class="ident" id="4025730">UDPConn</span><span class="op" id="4025737">)</span>&nbsp;<span class="ident" id="4025739">WriteTo</span><span class="op" id="4025746">(</span><span class="ident" id="4025747">b</span>&nbsp;<span class="op" id="4025749">[</span><span class="op" id="4025750">]</span><span class="builtintype" id="4025751">byte</span><span class="op" id="4025755">,</span>&nbsp;<span class="ident" id="4025757">addr</span>&nbsp;<span class="ident" id="4025762">Addr</span><span class="op" id="4025766">)</span>&nbsp;<span class="op" id="4025768">(</span><span class="builtintype" id="4025769">int</span><span class="op" id="4025772">,</span>&nbsp;<span class="builtintype" id="4025774">error</span><span class="op" id="4025779">)</span>&nbsp;<span class="op" id="4025781">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4025784">if</span>&nbsp;<span class="op" id="4025787">!</span><span class="ident" id="4025788">c</span><span class="op" id="4025789">.</span><span class="ident" id="4025790">ok</span><span class="op" id="4025792">(</span><span class="op" id="4025793">)</span>&nbsp;<span class="op" id="4025795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4025799">return</span>&nbsp;<span class="num" id="4025806">0</span><span class="op" id="4025807">,</span>&nbsp;<span class="ident" id="4025809">syscall</span><span class="op" id="4025816">.</span><span class="ident" id="4025817">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4025825">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4025828">a</span><span class="op" id="4025829">,</span>&nbsp;<span class="ident" id="4025831">ok</span>&nbsp;<span class="op" id="4025834">:=</span>&nbsp;<span class="ident" id="4025837">addr</span><span class="op" id="4025841">.</span><span class="op" id="4025842">(</span><span class="op" id="4025843">*</span><span class="ident" id="4025844">UDPAddr</span><span class="op" id="4025851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4025854">if</span>&nbsp;<span class="op" id="4025857">!</span><span class="ident" id="4025858">ok</span>&nbsp;<span class="op" id="4025861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4025865">return</span>&nbsp;<span class="num" id="4025872">0</span><span class="op" id="4025873">,</span>&nbsp;<span class="op" id="4025875">&amp;</span><span class="ident" id="4025876">OpError</span><span class="op" id="4025883">{</span><span class="string" id="4025884">&#34;write&#34;</span><span class="op" id="4025891">,</span>&nbsp;<span class="ident" id="4025893">c</span><span class="op" id="4025894">.</span><span class="ident" id="4025895">fd</span><span class="op" id="4025897">.</span><span class="ident" id="4025898">net</span><span class="op" id="4025901">,</span>&nbsp;<span class="ident" id="4025903">addr</span><span class="op" id="4025907">,</span>&nbsp;<span class="ident" id="4025909">syscall</span><span class="op" id="4025916">.</span><span class="ident" id="4025917">EINVAL</span><span class="op" id="4025923">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4025926">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4025929">return</span>&nbsp;<span class="ident" id="4025936">c</span><span class="op" id="4025937">.</span><span class="ident" id="4025938">WriteToUDP</span><span class="op" id="4025948">(</span><span class="ident" id="4025949">b</span><span class="op" id="4025950">,</span>&nbsp;<span class="ident" id="4025952">a</span><span class="op" id="4025953">)</span><br>
<span class="lineno">140</span><span class="op" id="4025955">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4025958">//&nbsp;WriteMsgUDP&nbsp;writes&nbsp;a&nbsp;packet&nbsp;to&nbsp;addr&nbsp;via&nbsp;c,&nbsp;copying&nbsp;the&nbsp;payload&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="4026029">//&nbsp;b&nbsp;and&nbsp;the&nbsp;associated&nbsp;out-of-band&nbsp;data&nbsp;from&nbsp;oob.&nbsp;&nbsp;It&nbsp;returns&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4026096">//&nbsp;number&nbsp;of&nbsp;payload&nbsp;and&nbsp;out-of-band&nbsp;bytes&nbsp;written.</span><br>
<span class="lineno">145</span><span class="keyword" id="4026148">func</span>&nbsp;<span class="op" id="4026153">(</span><span class="ident" id="4026154">c</span>&nbsp;<span class="op" id="4026156">*</span><span class="ident" id="4026157">UDPConn</span><span class="op" id="4026164">)</span>&nbsp;<span class="ident" id="4026166">WriteMsgUDP</span><span class="op" id="4026177">(</span><span class="ident" id="4026178">b</span><span class="op" id="4026179">,</span>&nbsp;<span class="ident" id="4026181">oob</span>&nbsp;<span class="op" id="4026185">[</span><span class="op" id="4026186">]</span><span class="builtintype" id="4026187">byte</span><span class="op" id="4026191">,</span>&nbsp;<span class="ident" id="4026193">addr</span>&nbsp;<span class="op" id="4026198">*</span><span class="ident" id="4026199">UDPAddr</span><span class="op" id="4026206">)</span>&nbsp;<span class="op" id="4026208">(</span><span class="ident" id="4026209">n</span><span class="op" id="4026210">,</span>&nbsp;<span class="ident" id="4026212">oobn</span>&nbsp;<span class="builtintype" id="4026217">int</span><span class="op" id="4026220">,</span>&nbsp;<span class="ident" id="4026222">err</span>&nbsp;<span class="builtintype" id="4026226">error</span><span class="op" id="4026231">)</span>&nbsp;<span class="op" id="4026233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4026236">if</span>&nbsp;<span class="op" id="4026239">!</span><span class="ident" id="4026240">c</span><span class="op" id="4026241">.</span><span class="ident" id="4026242">ok</span><span class="op" id="4026244">(</span><span class="op" id="4026245">)</span>&nbsp;<span class="op" id="4026247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4026251">return</span>&nbsp;<span class="num" id="4026258">0</span><span class="op" id="4026259">,</span>&nbsp;<span class="num" id="4026261">0</span><span class="op" id="4026262">,</span>&nbsp;<span class="ident" id="4026264">syscall</span><span class="op" id="4026271">.</span><span class="ident" id="4026272">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4026280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4026283">if</span>&nbsp;<span class="ident" id="4026286">c</span><span class="op" id="4026287">.</span><span class="ident" id="4026288">fd</span><span class="op" id="4026290">.</span><span class="ident" id="4026291">isConnected</span>&nbsp;<span class="op" id="4026303">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4026307">return</span>&nbsp;<span class="num" id="4026314">0</span><span class="op" id="4026315">,</span>&nbsp;<span class="num" id="4026317">0</span><span class="op" id="4026318">,</span>&nbsp;<span class="op" id="4026320">&amp;</span><span class="ident" id="4026321">OpError</span><span class="op" id="4026328">{</span><span class="string" id="4026329">&#34;write&#34;</span><span class="op" id="4026336">,</span>&nbsp;<span class="ident" id="4026338">c</span><span class="op" id="4026339">.</span><span class="ident" id="4026340">fd</span><span class="op" id="4026342">.</span><span class="ident" id="4026343">net</span><span class="op" id="4026346">,</span>&nbsp;<span class="ident" id="4026348">addr</span><span class="op" id="4026352">,</span>&nbsp;<span class="ident" id="4026354">ErrWriteToConnected</span><span class="op" id="4026373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4026376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4026379">if</span>&nbsp;<span class="ident" id="4026382">addr</span>&nbsp;<span class="op" id="4026387">==</span>&nbsp;<span class="builtintype" id="4026390">nil</span>&nbsp;<span class="op" id="4026394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4026398">return</span>&nbsp;<span class="num" id="4026405">0</span><span class="op" id="4026406">,</span>&nbsp;<span class="num" id="4026408">0</span><span class="op" id="4026409">,</span>&nbsp;<span class="op" id="4026411">&amp;</span><span class="ident" id="4026412">OpError</span><span class="op" id="4026419">{</span><span class="ident" id="4026420">Op</span><span class="op" id="4026422">:</span>&nbsp;<span class="string" id="4026424">&#34;write&#34;</span><span class="op" id="4026431">,</span>&nbsp;<span class="ident" id="4026433">Net</span><span class="op" id="4026436">:</span>&nbsp;<span class="ident" id="4026438">c</span><span class="op" id="4026439">.</span><span class="ident" id="4026440">fd</span><span class="op" id="4026442">.</span><span class="ident" id="4026443">net</span><span class="op" id="4026446">,</span>&nbsp;<span class="ident" id="4026448">Addr</span><span class="op" id="4026452">:</span>&nbsp;<span class="builtintype" id="4026454">nil</span><span class="op" id="4026457">,</span>&nbsp;<span class="ident" id="4026459">Err</span><span class="op" id="4026462">:</span>&nbsp;<span class="ident" id="4026464">errMissingAddress</span><span class="op" id="4026481">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4026484">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4026487">sa</span><span class="op" id="4026489">,</span>&nbsp;<span class="ident" id="4026491">err</span>&nbsp;<span class="op" id="4026495">:=</span>&nbsp;<span class="ident" id="4026498">addr</span><span class="op" id="4026502">.</span><span class="ident" id="4026503">sockaddr</span><span class="op" id="4026511">(</span><span class="ident" id="4026512">c</span><span class="op" id="4026513">.</span><span class="ident" id="4026514">fd</span><span class="op" id="4026516">.</span><span class="ident" id="4026517">family</span><span class="op" id="4026523">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4026526">if</span>&nbsp;<span class="ident" id="4026529">err</span>&nbsp;<span class="op" id="4026533">!=</span>&nbsp;<span class="builtintype" id="4026536">nil</span>&nbsp;<span class="op" id="4026540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4026544">return</span>&nbsp;<span class="num" id="4026551">0</span><span class="op" id="4026552">,</span>&nbsp;<span class="num" id="4026554">0</span><span class="op" id="4026555">,</span>&nbsp;<span class="op" id="4026557">&amp;</span><span class="ident" id="4026558">OpError</span><span class="op" id="4026565">{</span><span class="string" id="4026566">&#34;write&#34;</span><span class="op" id="4026573">,</span>&nbsp;<span class="ident" id="4026575">c</span><span class="op" id="4026576">.</span><span class="ident" id="4026577">fd</span><span class="op" id="4026579">.</span><span class="ident" id="4026580">net</span><span class="op" id="4026583">,</span>&nbsp;<span class="ident" id="4026585">addr</span><span class="op" id="4026589">,</span>&nbsp;<span class="ident" id="4026591">err</span><span class="op" id="4026594">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4026597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4026600">return</span>&nbsp;<span class="ident" id="4026607">c</span><span class="op" id="4026608">.</span><span class="ident" id="4026609">fd</span><span class="op" id="4026611">.</span><span class="ident" id="4026612">writeMsg</span><span class="op" id="4026620">(</span><span class="ident" id="4026621">b</span><span class="op" id="4026622">,</span>&nbsp;<span class="ident" id="4026624">oob</span><span class="op" id="4026627">,</span>&nbsp;<span class="ident" id="4026629">sa</span><span class="op" id="4026631">)</span><br>
<span class="lineno">160</span><span class="op" id="4026633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4026636">//&nbsp;DialUDP&nbsp;connects&nbsp;to&nbsp;the&nbsp;remote&nbsp;address&nbsp;raddr&nbsp;on&nbsp;the&nbsp;network&nbsp;net,</span><br>
<span class="lineno"></span><span class="comment" id="4026704">//&nbsp;which&nbsp;must&nbsp;be&nbsp;&#34;udp&#34;,&nbsp;&#34;udp4&#34;,&nbsp;or&nbsp;&#34;udp6&#34;.&nbsp;&nbsp;If&nbsp;laddr&nbsp;is&nbsp;not&nbsp;nil,&nbsp;it&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4026775">//&nbsp;used&nbsp;as&nbsp;the&nbsp;local&nbsp;address&nbsp;for&nbsp;the&nbsp;connection.</span><br>
<span class="lineno">165</span><span class="keyword" id="4026824">func</span>&nbsp;<span class="ident" id="4026829">DialUDP</span><span class="op" id="4026836">(</span><span class="ident" id="4026837">net</span>&nbsp;<span class="builtintype" id="4026841">string</span><span class="op" id="4026847">,</span>&nbsp;<span class="ident" id="4026849">laddr</span><span class="op" id="4026854">,</span>&nbsp;<span class="ident" id="4026856">raddr</span>&nbsp;<span class="op" id="4026862">*</span><span class="ident" id="4026863">UDPAddr</span><span class="op" id="4026870">)</span>&nbsp;<span class="op" id="4026872">(</span><span class="op" id="4026873">*</span><span class="ident" id="4026874">UDPConn</span><span class="op" id="4026881">,</span>&nbsp;<span class="builtintype" id="4026883">error</span><span class="op" id="4026888">)</span>&nbsp;<span class="op" id="4026890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4026893">switch</span>&nbsp;<span class="ident" id="4026900">net</span>&nbsp;<span class="op" id="4026904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4026907">case</span>&nbsp;<span class="string" id="4026912">&#34;udp&#34;</span><span class="op" id="4026917">,</span>&nbsp;<span class="string" id="4026919">&#34;udp4&#34;</span><span class="op" id="4026925">,</span>&nbsp;<span class="string" id="4026927">&#34;udp6&#34;</span><span class="op" id="4026933">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4026936">default</span><span class="op" id="4026943">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4026947">return</span>&nbsp;<span class="builtintype" id="4026954">nil</span><span class="op" id="4026957">,</span>&nbsp;<span class="op" id="4026959">&amp;</span><span class="ident" id="4026960">OpError</span><span class="op" id="4026967">{</span><span class="ident" id="4026968">Op</span><span class="op" id="4026970">:</span>&nbsp;<span class="string" id="4026972">&#34;dial&#34;</span><span class="op" id="4026978">,</span>&nbsp;<span class="ident" id="4026980">Net</span><span class="op" id="4026983">:</span>&nbsp;<span class="ident" id="4026985">net</span><span class="op" id="4026988">,</span>&nbsp;<span class="ident" id="4026990">Addr</span><span class="op" id="4026994">:</span>&nbsp;<span class="ident" id="4026996">raddr</span><span class="op" id="4027001">,</span>&nbsp;<span class="ident" id="4027003">Err</span><span class="op" id="4027006">:</span>&nbsp;<span class="ident" id="4027008">UnknownNetworkError</span><span class="op" id="4027027">(</span><span class="ident" id="4027028">net</span><span class="op" id="4027031">)</span><span class="op" id="4027032">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4027035">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4027038">if</span>&nbsp;<span class="ident" id="4027041">raddr</span>&nbsp;<span class="op" id="4027047">==</span>&nbsp;<span class="builtintype" id="4027050">nil</span>&nbsp;<span class="op" id="4027054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4027058">return</span>&nbsp;<span class="builtintype" id="4027065">nil</span><span class="op" id="4027068">,</span>&nbsp;<span class="op" id="4027070">&amp;</span><span class="ident" id="4027071">OpError</span><span class="op" id="4027078">{</span><span class="ident" id="4027079">Op</span><span class="op" id="4027081">:</span>&nbsp;<span class="string" id="4027083">&#34;dial&#34;</span><span class="op" id="4027089">,</span>&nbsp;<span class="ident" id="4027091">Net</span><span class="op" id="4027094">:</span>&nbsp;<span class="ident" id="4027096">net</span><span class="op" id="4027099">,</span>&nbsp;<span class="ident" id="4027101">Addr</span><span class="op" id="4027105">:</span>&nbsp;<span class="builtintype" id="4027107">nil</span><span class="op" id="4027110">,</span>&nbsp;<span class="ident" id="4027112">Err</span><span class="op" id="4027115">:</span>&nbsp;<span class="ident" id="4027117">errMissingAddress</span><span class="op" id="4027134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4027137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4027140">return</span>&nbsp;<span class="ident" id="4027147">dialUDP</span><span class="op" id="4027154">(</span><span class="ident" id="4027155">net</span><span class="op" id="4027158">,</span>&nbsp;<span class="ident" id="4027160">laddr</span><span class="op" id="4027165">,</span>&nbsp;<span class="ident" id="4027167">raddr</span><span class="op" id="4027172">,</span>&nbsp;<span class="ident" id="4027174">noDeadline</span><span class="op" id="4027184">)</span><br>
<span class="lineno">175</span><span class="op" id="4027186">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4027189">func</span>&nbsp;<span class="ident" id="4027194">dialUDP</span><span class="op" id="4027201">(</span><span class="ident" id="4027202">net</span>&nbsp;<span class="builtintype" id="4027206">string</span><span class="op" id="4027212">,</span>&nbsp;<span class="ident" id="4027214">laddr</span><span class="op" id="4027219">,</span>&nbsp;<span class="ident" id="4027221">raddr</span>&nbsp;<span class="op" id="4027227">*</span><span class="ident" id="4027228">UDPAddr</span><span class="op" id="4027235">,</span>&nbsp;<span class="ident" id="4027237">deadline</span>&nbsp;<span class="ident" id="4027246">time</span><span class="op" id="4027250">.</span><span class="ident" id="4027251">Time</span><span class="op" id="4027255">)</span>&nbsp;<span class="op" id="4027257">(</span><span class="op" id="4027258">*</span><span class="ident" id="4027259">UDPConn</span><span class="op" id="4027266">,</span>&nbsp;<span class="builtintype" id="4027268">error</span><span class="op" id="4027273">)</span>&nbsp;<span class="op" id="4027275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4027278">fd</span><span class="op" id="4027280">,</span>&nbsp;<span class="ident" id="4027282">err</span>&nbsp;<span class="op" id="4027286">:=</span>&nbsp;<span class="ident" id="4027289">internetSocket</span><span class="op" id="4027303">(</span><span class="ident" id="4027304">net</span><span class="op" id="4027307">,</span>&nbsp;<span class="ident" id="4027309">laddr</span><span class="op" id="4027314">,</span>&nbsp;<span class="ident" id="4027316">raddr</span><span class="op" id="4027321">,</span>&nbsp;<span class="ident" id="4027323">deadline</span><span class="op" id="4027331">,</span>&nbsp;<span class="ident" id="4027333">syscall</span><span class="op" id="4027340">.</span><span class="ident" id="4027341">SOCK_DGRAM</span><span class="op" id="4027351">,</span>&nbsp;<span class="num" id="4027353">0</span><span class="op" id="4027354">,</span>&nbsp;<span class="string" id="4027356">&#34;dial&#34;</span><span class="op" id="4027362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4027365">if</span>&nbsp;<span class="ident" id="4027368">err</span>&nbsp;<span class="op" id="4027372">!=</span>&nbsp;<span class="builtintype" id="4027375">nil</span>&nbsp;<span class="op" id="4027379">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4027383">return</span>&nbsp;<span class="builtintype" id="4027390">nil</span><span class="op" id="4027393">,</span>&nbsp;<span class="op" id="4027395">&amp;</span><span class="ident" id="4027396">OpError</span><span class="op" id="4027403">{</span><span class="ident" id="4027404">Op</span><span class="op" id="4027406">:</span>&nbsp;<span class="string" id="4027408">&#34;dial&#34;</span><span class="op" id="4027414">,</span>&nbsp;<span class="ident" id="4027416">Net</span><span class="op" id="4027419">:</span>&nbsp;<span class="ident" id="4027421">net</span><span class="op" id="4027424">,</span>&nbsp;<span class="ident" id="4027426">Addr</span><span class="op" id="4027430">:</span>&nbsp;<span class="ident" id="4027432">raddr</span><span class="op" id="4027437">,</span>&nbsp;<span class="ident" id="4027439">Err</span><span class="op" id="4027442">:</span>&nbsp;<span class="ident" id="4027444">err</span><span class="op" id="4027447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4027450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4027453">return</span>&nbsp;<span class="ident" id="4027460">newUDPConn</span><span class="op" id="4027470">(</span><span class="ident" id="4027471">fd</span><span class="op" id="4027473">)</span><span class="op" id="4027474">,</span>&nbsp;<span class="builtintype" id="4027476">nil</span><br>
<span class="lineno"></span><span class="op" id="4027480">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="comment" id="4027483">//&nbsp;ListenUDP&nbsp;listens&nbsp;for&nbsp;incoming&nbsp;UDP&nbsp;packets&nbsp;addressed&nbsp;to&nbsp;the&nbsp;local</span><br>
<span class="lineno"></span><span class="comment" id="4027552">//&nbsp;address&nbsp;laddr.&nbsp;&nbsp;Net&nbsp;must&nbsp;be&nbsp;&#34;udp&#34;,&nbsp;&#34;udp4&#34;,&nbsp;or&nbsp;&#34;udp6&#34;.&nbsp;&nbsp;If&nbsp;laddr&nbsp;has</span><br>
<span class="lineno"></span><span class="comment" id="4027623">//&nbsp;a&nbsp;port&nbsp;of&nbsp;0,&nbsp;ListenUDP&nbsp;will&nbsp;choose&nbsp;an&nbsp;available&nbsp;port.</span><br>
<span class="lineno"></span><span class="comment" id="4027680">//&nbsp;The&nbsp;LocalAddr&nbsp;method&nbsp;of&nbsp;the&nbsp;returned&nbsp;UDPConn&nbsp;can&nbsp;be&nbsp;used&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4027743">//&nbsp;discover&nbsp;the&nbsp;port.&nbsp;&nbsp;The&nbsp;returned&nbsp;connection&#39;s&nbsp;ReadFrom&nbsp;and&nbsp;WriteTo</span><br>
<span class="lineno">190</span><span class="comment" id="4027813">//&nbsp;methods&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;receive&nbsp;and&nbsp;send&nbsp;UDP&nbsp;packets&nbsp;with&nbsp;per-packet</span><br>
<span class="lineno"></span><span class="comment" id="4027884">//&nbsp;addressing.</span><br>
<span class="lineno"></span><span class="keyword" id="4027899">func</span>&nbsp;<span class="ident" id="4027904">ListenUDP</span><span class="op" id="4027913">(</span><span class="ident" id="4027914">net</span>&nbsp;<span class="builtintype" id="4027918">string</span><span class="op" id="4027924">,</span>&nbsp;<span class="ident" id="4027926">laddr</span>&nbsp;<span class="op" id="4027932">*</span><span class="ident" id="4027933">UDPAddr</span><span class="op" id="4027940">)</span>&nbsp;<span class="op" id="4027942">(</span><span class="op" id="4027943">*</span><span class="ident" id="4027944">UDPConn</span><span class="op" id="4027951">,</span>&nbsp;<span class="builtintype" id="4027953">error</span><span class="op" id="4027958">)</span>&nbsp;<span class="op" id="4027960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4027963">switch</span>&nbsp;<span class="ident" id="4027970">net</span>&nbsp;<span class="op" id="4027974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4027977">case</span>&nbsp;<span class="string" id="4027982">&#34;udp&#34;</span><span class="op" id="4027987">,</span>&nbsp;<span class="string" id="4027989">&#34;udp4&#34;</span><span class="op" id="4027995">,</span>&nbsp;<span class="string" id="4027997">&#34;udp6&#34;</span><span class="op" id="4028003">:</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028006">default</span><span class="op" id="4028013">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028017">return</span>&nbsp;<span class="builtintype" id="4028024">nil</span><span class="op" id="4028027">,</span>&nbsp;<span class="op" id="4028029">&amp;</span><span class="ident" id="4028030">OpError</span><span class="op" id="4028037">{</span><span class="ident" id="4028038">Op</span><span class="op" id="4028040">:</span>&nbsp;<span class="string" id="4028042">&#34;listen&#34;</span><span class="op" id="4028050">,</span>&nbsp;<span class="ident" id="4028052">Net</span><span class="op" id="4028055">:</span>&nbsp;<span class="ident" id="4028057">net</span><span class="op" id="4028060">,</span>&nbsp;<span class="ident" id="4028062">Addr</span><span class="op" id="4028066">:</span>&nbsp;<span class="ident" id="4028068">laddr</span><span class="op" id="4028073">,</span>&nbsp;<span class="ident" id="4028075">Err</span><span class="op" id="4028078">:</span>&nbsp;<span class="ident" id="4028080">UnknownNetworkError</span><span class="op" id="4028099">(</span><span class="ident" id="4028100">net</span><span class="op" id="4028103">)</span><span class="op" id="4028104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4028107">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028110">if</span>&nbsp;<span class="ident" id="4028113">laddr</span>&nbsp;<span class="op" id="4028119">==</span>&nbsp;<span class="builtintype" id="4028122">nil</span>&nbsp;<span class="op" id="4028126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4028130">laddr</span>&nbsp;<span class="op" id="4028136">=</span>&nbsp;<span class="op" id="4028138">&amp;</span><span class="ident" id="4028139">UDPAddr</span><span class="op" id="4028146">{</span><span class="op" id="4028147">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4028150">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4028153">fd</span><span class="op" id="4028155">,</span>&nbsp;<span class="ident" id="4028157">err</span>&nbsp;<span class="op" id="4028161">:=</span>&nbsp;<span class="ident" id="4028164">internetSocket</span><span class="op" id="4028178">(</span><span class="ident" id="4028179">net</span><span class="op" id="4028182">,</span>&nbsp;<span class="ident" id="4028184">laddr</span><span class="op" id="4028189">,</span>&nbsp;<span class="builtintype" id="4028191">nil</span><span class="op" id="4028194">,</span>&nbsp;<span class="ident" id="4028196">noDeadline</span><span class="op" id="4028206">,</span>&nbsp;<span class="ident" id="4028208">syscall</span><span class="op" id="4028215">.</span><span class="ident" id="4028216">SOCK_DGRAM</span><span class="op" id="4028226">,</span>&nbsp;<span class="num" id="4028228">0</span><span class="op" id="4028229">,</span>&nbsp;<span class="string" id="4028231">&#34;listen&#34;</span><span class="op" id="4028239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028242">if</span>&nbsp;<span class="ident" id="4028245">err</span>&nbsp;<span class="op" id="4028249">!=</span>&nbsp;<span class="builtintype" id="4028252">nil</span>&nbsp;<span class="op" id="4028256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028260">return</span>&nbsp;<span class="builtintype" id="4028267">nil</span><span class="op" id="4028270">,</span>&nbsp;<span class="op" id="4028272">&amp;</span><span class="ident" id="4028273">OpError</span><span class="op" id="4028280">{</span><span class="ident" id="4028281">Op</span><span class="op" id="4028283">:</span>&nbsp;<span class="string" id="4028285">&#34;listen&#34;</span><span class="op" id="4028293">,</span>&nbsp;<span class="ident" id="4028295">Net</span><span class="op" id="4028298">:</span>&nbsp;<span class="ident" id="4028300">net</span><span class="op" id="4028303">,</span>&nbsp;<span class="ident" id="4028305">Addr</span><span class="op" id="4028309">:</span>&nbsp;<span class="ident" id="4028311">laddr</span><span class="op" id="4028316">,</span>&nbsp;<span class="ident" id="4028318">Err</span><span class="op" id="4028321">:</span>&nbsp;<span class="ident" id="4028323">err</span><span class="op" id="4028326">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4028329">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028332">return</span>&nbsp;<span class="ident" id="4028339">newUDPConn</span><span class="op" id="4028349">(</span><span class="ident" id="4028350">fd</span><span class="op" id="4028352">)</span><span class="op" id="4028353">,</span>&nbsp;<span class="builtintype" id="4028355">nil</span><br>
<span class="lineno"></span><span class="op" id="4028359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4028362">//&nbsp;ListenMulticastUDP&nbsp;listens&nbsp;for&nbsp;incoming&nbsp;multicast&nbsp;UDP&nbsp;packets</span><br>
<span class="lineno"></span><span class="comment" id="4028427">//&nbsp;addressed&nbsp;to&nbsp;the&nbsp;group&nbsp;address&nbsp;gaddr&nbsp;on&nbsp;ifi,&nbsp;which&nbsp;specifies&nbsp;the</span><br>
<span class="lineno">210</span><span class="comment" id="4028495">//&nbsp;interface&nbsp;to&nbsp;join.&nbsp;&nbsp;ListenMulticastUDP&nbsp;uses&nbsp;default&nbsp;multicast</span><br>
<span class="lineno"></span><span class="comment" id="4028560">//&nbsp;interface&nbsp;if&nbsp;ifi&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4028588">func</span>&nbsp;<span class="ident" id="4028593">ListenMulticastUDP</span><span class="op" id="4028611">(</span><span class="ident" id="4028612">net</span>&nbsp;<span class="builtintype" id="4028616">string</span><span class="op" id="4028622">,</span>&nbsp;<span class="ident" id="4028624">ifi</span>&nbsp;<span class="op" id="4028628">*</span><span class="ident" id="4028629">Interface</span><span class="op" id="4028638">,</span>&nbsp;<span class="ident" id="4028640">gaddr</span>&nbsp;<span class="op" id="4028646">*</span><span class="ident" id="4028647">UDPAddr</span><span class="op" id="4028654">)</span>&nbsp;<span class="op" id="4028656">(</span><span class="op" id="4028657">*</span><span class="ident" id="4028658">UDPConn</span><span class="op" id="4028665">,</span>&nbsp;<span class="builtintype" id="4028667">error</span><span class="op" id="4028672">)</span>&nbsp;<span class="op" id="4028674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028677">switch</span>&nbsp;<span class="ident" id="4028684">net</span>&nbsp;<span class="op" id="4028688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028691">case</span>&nbsp;<span class="string" id="4028696">&#34;udp&#34;</span><span class="op" id="4028701">,</span>&nbsp;<span class="string" id="4028703">&#34;udp4&#34;</span><span class="op" id="4028709">,</span>&nbsp;<span class="string" id="4028711">&#34;udp6&#34;</span><span class="op" id="4028717">:</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028720">default</span><span class="op" id="4028727">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028731">return</span>&nbsp;<span class="builtintype" id="4028738">nil</span><span class="op" id="4028741">,</span>&nbsp;<span class="op" id="4028743">&amp;</span><span class="ident" id="4028744">OpError</span><span class="op" id="4028751">{</span><span class="ident" id="4028752">Op</span><span class="op" id="4028754">:</span>&nbsp;<span class="string" id="4028756">&#34;listen&#34;</span><span class="op" id="4028764">,</span>&nbsp;<span class="ident" id="4028766">Net</span><span class="op" id="4028769">:</span>&nbsp;<span class="ident" id="4028771">net</span><span class="op" id="4028774">,</span>&nbsp;<span class="ident" id="4028776">Addr</span><span class="op" id="4028780">:</span>&nbsp;<span class="ident" id="4028782">gaddr</span><span class="op" id="4028787">,</span>&nbsp;<span class="ident" id="4028789">Err</span><span class="op" id="4028792">:</span>&nbsp;<span class="ident" id="4028794">UnknownNetworkError</span><span class="op" id="4028813">(</span><span class="ident" id="4028814">net</span><span class="op" id="4028817">)</span><span class="op" id="4028818">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4028821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028824">if</span>&nbsp;<span class="ident" id="4028827">gaddr</span>&nbsp;<span class="op" id="4028833">==</span>&nbsp;<span class="builtintype" id="4028836">nil</span>&nbsp;<span class="op" id="4028840">||</span>&nbsp;<span class="ident" id="4028843">gaddr</span><span class="op" id="4028848">.</span><span class="ident" id="4028849">IP</span>&nbsp;<span class="op" id="4028852">==</span>&nbsp;<span class="builtintype" id="4028855">nil</span>&nbsp;<span class="op" id="4028859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4028863">return</span>&nbsp;<span class="builtintype" id="4028870">nil</span><span class="op" id="4028873">,</span>&nbsp;<span class="op" id="4028875">&amp;</span><span class="ident" id="4028876">OpError</span><span class="op" id="4028883">{</span><span class="ident" id="4028884">Op</span><span class="op" id="4028886">:</span>&nbsp;<span class="string" id="4028888">&#34;listen&#34;</span><span class="op" id="4028896">,</span>&nbsp;<span class="ident" id="4028898">Net</span><span class="op" id="4028901">:</span>&nbsp;<span class="ident" id="4028903">net</span><span class="op" id="4028906">,</span>&nbsp;<span class="ident" id="4028908">Addr</span><span class="op" id="4028912">:</span>&nbsp;<span class="builtintype" id="4028914">nil</span><span class="op" id="4028917">,</span>&nbsp;<span class="ident" id="4028919">Err</span><span class="op" id="4028922">:</span>&nbsp;<span class="ident" id="4028924">errMissingAddress</span><span class="op" id="4028941">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4028944">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4028947">fd</span><span class="op" id="4028949">,</span>&nbsp;<span class="ident" id="4028951">err</span>&nbsp;<span class="op" id="4028955">:=</span>&nbsp;<span class="ident" id="4028958">internetSocket</span><span class="op" id="4028972">(</span><span class="ident" id="4028973">net</span><span class="op" id="4028976">,</span>&nbsp;<span class="ident" id="4028978">gaddr</span><span class="op" id="4028983">,</span>&nbsp;<span class="builtintype" id="4028985">nil</span><span class="op" id="4028988">,</span>&nbsp;<span class="ident" id="4028990">noDeadline</span><span class="op" id="4029000">,</span>&nbsp;<span class="ident" id="4029002">syscall</span><span class="op" id="4029009">.</span><span class="ident" id="4029010">SOCK_DGRAM</span><span class="op" id="4029020">,</span>&nbsp;<span class="num" id="4029022">0</span><span class="op" id="4029023">,</span>&nbsp;<span class="string" id="4029025">&#34;listen&#34;</span><span class="op" id="4029033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4029036">if</span>&nbsp;<span class="ident" id="4029039">err</span>&nbsp;<span class="op" id="4029043">!=</span>&nbsp;<span class="builtintype" id="4029046">nil</span>&nbsp;<span class="op" id="4029050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4029054">return</span>&nbsp;<span class="builtintype" id="4029061">nil</span><span class="op" id="4029064">,</span>&nbsp;<span class="op" id="4029066">&amp;</span><span class="ident" id="4029067">OpError</span><span class="op" id="4029074">{</span><span class="ident" id="4029075">Op</span><span class="op" id="4029077">:</span>&nbsp;<span class="string" id="4029079">&#34;listen&#34;</span><span class="op" id="4029087">,</span>&nbsp;<span class="ident" id="4029089">Net</span><span class="op" id="4029092">:</span>&nbsp;<span class="ident" id="4029094">net</span><span class="op" id="4029097">,</span>&nbsp;<span class="ident" id="4029099">Addr</span><span class="op" id="4029103">:</span>&nbsp;<span class="ident" id="4029105">gaddr</span><span class="op" id="4029110">,</span>&nbsp;<span class="ident" id="4029112">Err</span><span class="op" id="4029115">:</span>&nbsp;<span class="ident" id="4029117">err</span><span class="op" id="4029120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4029123">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4029126">c</span>&nbsp;<span class="op" id="4029128">:=</span>&nbsp;<span class="ident" id="4029131">newUDPConn</span><span class="op" id="4029141">(</span><span class="ident" id="4029142">fd</span><span class="op" id="4029144">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4029147">if</span>&nbsp;<span class="ident" id="4029150">ip4</span>&nbsp;<span class="op" id="4029154">:=</span>&nbsp;<span class="ident" id="4029157">gaddr</span><span class="op" id="4029162">.</span><span class="ident" id="4029163">IP</span><span class="op" id="4029165">.</span><span class="ident" id="4029166">To4</span><span class="op" id="4029169">(</span><span class="op" id="4029170">)</span><span class="op" id="4029171">;</span>&nbsp;<span class="ident" id="4029173">ip4</span>&nbsp;<span class="op" id="4029177">!=</span>&nbsp;<span class="builtintype" id="4029180">nil</span>&nbsp;<span class="op" id="4029184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4029188">if</span>&nbsp;<span class="ident" id="4029191">err</span>&nbsp;<span class="op" id="4029195">:=</span>&nbsp;<span class="ident" id="4029198">listenIPv4MulticastUDP</span><span class="op" id="4029220">(</span><span class="ident" id="4029221">c</span><span class="op" id="4029222">,</span>&nbsp;<span class="ident" id="4029224">ifi</span><span class="op" id="4029227">,</span>&nbsp;<span class="ident" id="4029229">ip4</span><span class="op" id="4029232">)</span><span class="op" id="4029233">;</span>&nbsp;<span class="ident" id="4029235">err</span>&nbsp;<span class="op" id="4029239">!=</span>&nbsp;<span class="builtintype" id="4029242">nil</span>&nbsp;<span class="op" id="4029246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4029251">c</span><span class="op" id="4029252">.</span><span class="ident" id="4029253">Close</span><span class="op" id="4029258">(</span><span class="op" id="4029259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4029264">return</span>&nbsp;<span class="builtintype" id="4029271">nil</span><span class="op" id="4029274">,</span>&nbsp;<span class="op" id="4029276">&amp;</span><span class="ident" id="4029277">OpError</span><span class="op" id="4029284">{</span><span class="ident" id="4029285">Op</span><span class="op" id="4029287">:</span>&nbsp;<span class="string" id="4029289">&#34;listen&#34;</span><span class="op" id="4029297">,</span>&nbsp;<span class="ident" id="4029299">Net</span><span class="op" id="4029302">:</span>&nbsp;<span class="ident" id="4029304">net</span><span class="op" id="4029307">,</span>&nbsp;<span class="ident" id="4029309">Addr</span><span class="op" id="4029313">:</span>&nbsp;<span class="op" id="4029315">&amp;</span><span class="ident" id="4029316">IPAddr</span><span class="op" id="4029322">{</span><span class="ident" id="4029323">IP</span><span class="op" id="4029325">:</span>&nbsp;<span class="ident" id="4029327">ip4</span><span class="op" id="4029330">}</span><span class="op" id="4029331">,</span>&nbsp;<span class="ident" id="4029333">Err</span><span class="op" id="4029336">:</span>&nbsp;<span class="ident" id="4029338">err</span><span class="op" id="4029341">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4029345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4029348">}</span>&nbsp;<span class="keyword" id="4029350">else</span>&nbsp;<span class="op" id="4029355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4029359">if</span>&nbsp;<span class="ident" id="4029362">err</span>&nbsp;<span class="op" id="4029366">:=</span>&nbsp;<span class="ident" id="4029369">listenIPv6MulticastUDP</span><span class="op" id="4029391">(</span><span class="ident" id="4029392">c</span><span class="op" id="4029393">,</span>&nbsp;<span class="ident" id="4029395">ifi</span><span class="op" id="4029398">,</span>&nbsp;<span class="ident" id="4029400">gaddr</span><span class="op" id="4029405">.</span><span class="ident" id="4029406">IP</span><span class="op" id="4029408">)</span><span class="op" id="4029409">;</span>&nbsp;<span class="ident" id="4029411">err</span>&nbsp;<span class="op" id="4029415">!=</span>&nbsp;<span class="builtintype" id="4029418">nil</span>&nbsp;<span class="op" id="4029422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4029427">c</span><span class="op" id="4029428">.</span><span class="ident" id="4029429">Close</span><span class="op" id="4029434">(</span><span class="op" id="4029435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4029440">return</span>&nbsp;<span class="builtintype" id="4029447">nil</span><span class="op" id="4029450">,</span>&nbsp;<span class="op" id="4029452">&amp;</span><span class="ident" id="4029453">OpError</span><span class="op" id="4029460">{</span><span class="ident" id="4029461">Op</span><span class="op" id="4029463">:</span>&nbsp;<span class="string" id="4029465">&#34;listen&#34;</span><span class="op" id="4029473">,</span>&nbsp;<span class="ident" id="4029475">Net</span><span class="op" id="4029478">:</span>&nbsp;<span class="ident" id="4029480">net</span><span class="op" id="4029483">,</span>&nbsp;<span class="ident" id="4029485">Addr</span><span class="op" id="4029489">:</span>&nbsp;<span class="op" id="4029491">&amp;</span><span class="ident" id="4029492">IPAddr</span><span class="op" id="4029498">{</span><span class="ident" id="4029499">IP</span><span class="op" id="4029501">:</span>&nbsp;<span class="ident" id="4029503">gaddr</span><span class="op" id="4029508">.</span><span class="ident" id="4029509">IP</span><span class="op" id="4029511">}</span><span class="op" id="4029512">,</span>&nbsp;<span class="ident" id="4029514">Err</span><span class="op" id="4029517">:</span>&nbsp;<span class="ident" id="4029519">err</span><span class="op" id="4029522">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4029526">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4029529">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4029532">return</span>&nbsp;<span class="ident" id="4029539">c</span><span class="op" id="4029540">,</span>&nbsp;<span class="builtintype" id="4029542">nil</span><br>
<span class="lineno"></span><span class="op" id="4029546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">240</span><span class="keyword" id="4029549">func</span>&nbsp;<span class="ident" id="4029554">listenIPv4MulticastUDP</span><span class="op" id="4029576">(</span><span class="ident" id="4029577">c</span>&nbsp;<span class="op" id="4029579">*</span><span class="ident" id="4029580">UDPConn</span><span class="op" id="4029587">,</span>&nbsp;<span class="ident" id="4029589">ifi</span>&nbsp;<span class="op" id="4029593">*</span><span class="ident" id="4029594">Interface</span><span class="op" id="4029603">,</span>&nbsp;<span class="ident" id="4029605">ip</span>&nbsp;<span class="ident" id="4029608">IP</span><span class="op" id="4029610">)</span>&nbsp;<span class="builtintype" id="4029612">error</span>&nbsp;<span class="op" id="4029618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4029621">if</span>&nbsp;<span class="ident" id="4029624">ifi</span>&nbsp;<span class="op" id="4029628">!=</span>&nbsp;<span class="builtintype" id="4029631">nil</span>&nbsp;<span class="op" id="4029635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4029639">if</span>&nbsp;<span class="ident" id="4029642">err</span>&nbsp;<span class="op" id="4029646">:=</span>&nbsp;<span class="ident" id="4029649">setIPv4MulticastInterface</span><span class="op" id="4029674">(</span><span class="ident" id="4029675">c</span><span class="op" id="4029676">.</span><span class="ident" id="4029677">fd</span><span class="op" id="4029679">,</span>&nbsp;<span class="ident" id="4029681">ifi</span><span class="op" id="4029684">)</span><span class="op" id="4029685">;</span>&nbsp;<span class="ident" id="4029687">err</span>&nbsp;<span class="op" id="4029691">!=</span>&nbsp;<span class="builtintype" id="4029694">nil</span>&nbsp;<span class="op" id="4029698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4029703">return</span>&nbsp;<span class="ident" id="4029710">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4029716">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4029719">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4029722">if</span>&nbsp;<span class="ident" id="4029725">err</span>&nbsp;<span class="op" id="4029729">:=</span>&nbsp;<span class="ident" id="4029732">setIPv4MulticastLoopback</span><span class="op" id="4029756">(</span><span class="ident" id="4029757">c</span><span class="op" id="4029758">.</span><span class="ident" id="4029759">fd</span><span class="op" id="4029761">,</span>&nbsp;<span class="builtintype" id="4029763">false</span><span class="op" id="4029768">)</span><span class="op" id="4029769">;</span>&nbsp;<span class="ident" id="4029771">err</span>&nbsp;<span class="op" id="4029775">!=</span>&nbsp;<span class="builtintype" id="4029778">nil</span>&nbsp;<span class="op" id="4029782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4029786">return</span>&nbsp;<span class="ident" id="4029793">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4029798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4029801">if</span>&nbsp;<span class="ident" id="4029804">err</span>&nbsp;<span class="op" id="4029808">:=</span>&nbsp;<span class="ident" id="4029811">joinIPv4Group</span><span class="op" id="4029824">(</span><span class="ident" id="4029825">c</span><span class="op" id="4029826">.</span><span class="ident" id="4029827">fd</span><span class="op" id="4029829">,</span>&nbsp;<span class="ident" id="4029831">ifi</span><span class="op" id="4029834">,</span>&nbsp;<span class="ident" id="4029836">ip</span><span class="op" id="4029838">)</span><span class="op" id="4029839">;</span>&nbsp;<span class="ident" id="4029841">err</span>&nbsp;<span class="op" id="4029845">!=</span>&nbsp;<span class="builtintype" id="4029848">nil</span>&nbsp;<span class="op" id="4029852">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4029856">return</span>&nbsp;<span class="ident" id="4029863">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4029868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4029871">return</span>&nbsp;<span class="builtintype" id="4029878">nil</span><br>
<span class="lineno"></span><span class="op" id="4029882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="keyword" id="4029885">func</span>&nbsp;<span class="ident" id="4029890">listenIPv6MulticastUDP</span><span class="op" id="4029912">(</span><span class="ident" id="4029913">c</span>&nbsp;<span class="op" id="4029915">*</span><span class="ident" id="4029916">UDPConn</span><span class="op" id="4029923">,</span>&nbsp;<span class="ident" id="4029925">ifi</span>&nbsp;<span class="op" id="4029929">*</span><span class="ident" id="4029930">Interface</span><span class="op" id="4029939">,</span>&nbsp;<span class="ident" id="4029941">ip</span>&nbsp;<span class="ident" id="4029944">IP</span><span class="op" id="4029946">)</span>&nbsp;<span class="builtintype" id="4029948">error</span>&nbsp;<span class="op" id="4029954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4029957">if</span>&nbsp;<span class="ident" id="4029960">ifi</span>&nbsp;<span class="op" id="4029964">!=</span>&nbsp;<span class="builtintype" id="4029967">nil</span>&nbsp;<span class="op" id="4029971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4029975">if</span>&nbsp;<span class="ident" id="4029978">err</span>&nbsp;<span class="op" id="4029982">:=</span>&nbsp;<span class="ident" id="4029985">setIPv6MulticastInterface</span><span class="op" id="4030010">(</span><span class="ident" id="4030011">c</span><span class="op" id="4030012">.</span><span class="ident" id="4030013">fd</span><span class="op" id="4030015">,</span>&nbsp;<span class="ident" id="4030017">ifi</span><span class="op" id="4030020">)</span><span class="op" id="4030021">;</span>&nbsp;<span class="ident" id="4030023">err</span>&nbsp;<span class="op" id="4030027">!=</span>&nbsp;<span class="builtintype" id="4030030">nil</span>&nbsp;<span class="op" id="4030034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4030039">return</span>&nbsp;<span class="ident" id="4030046">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4030052">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4030055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4030058">if</span>&nbsp;<span class="ident" id="4030061">err</span>&nbsp;<span class="op" id="4030065">:=</span>&nbsp;<span class="ident" id="4030068">setIPv6MulticastLoopback</span><span class="op" id="4030092">(</span><span class="ident" id="4030093">c</span><span class="op" id="4030094">.</span><span class="ident" id="4030095">fd</span><span class="op" id="4030097">,</span>&nbsp;<span class="builtintype" id="4030099">false</span><span class="op" id="4030104">)</span><span class="op" id="4030105">;</span>&nbsp;<span class="ident" id="4030107">err</span>&nbsp;<span class="op" id="4030111">!=</span>&nbsp;<span class="builtintype" id="4030114">nil</span>&nbsp;<span class="op" id="4030118">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4030122">return</span>&nbsp;<span class="ident" id="4030129">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4030134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4030137">if</span>&nbsp;<span class="ident" id="4030140">err</span>&nbsp;<span class="op" id="4030144">:=</span>&nbsp;<span class="ident" id="4030147">joinIPv6Group</span><span class="op" id="4030160">(</span><span class="ident" id="4030161">c</span><span class="op" id="4030162">.</span><span class="ident" id="4030163">fd</span><span class="op" id="4030165">,</span>&nbsp;<span class="ident" id="4030167">ifi</span><span class="op" id="4030170">,</span>&nbsp;<span class="ident" id="4030172">ip</span><span class="op" id="4030174">)</span><span class="op" id="4030175">;</span>&nbsp;<span class="ident" id="4030177">err</span>&nbsp;<span class="op" id="4030181">!=</span>&nbsp;<span class="builtintype" id="4030184">nil</span>&nbsp;<span class="op" id="4030188">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4030192">return</span>&nbsp;<span class="ident" id="4030199">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4030204">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4030207">return</span>&nbsp;<span class="builtintype" id="4030214">nil</span><br>
<span class="lineno"></span><span class="op" id="4030218">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
