<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4657238">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4657293">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4657347">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4657398">package</span>&nbsp;<span class="ident" id="4657406">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4657416">import</span>&nbsp;<span class="op" id="4657423">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4657426">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4657435">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4657442">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4657448">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4657459">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4657470">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4657478">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4657489">&#34;text/template/parse&#34;</span><br>
<span class="lineno"></span><span class="op" id="4657511">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4657514">//&nbsp;state&nbsp;represents&nbsp;the&nbsp;state&nbsp;of&nbsp;an&nbsp;execution.&nbsp;It&#39;s&nbsp;not&nbsp;part&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4657582">//&nbsp;template&nbsp;so&nbsp;that&nbsp;multiple&nbsp;executions&nbsp;of&nbsp;the&nbsp;same&nbsp;template</span><br>
<span class="lineno">20</span><span class="comment" id="4657643">//&nbsp;can&nbsp;execute&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="4657671">type</span>&nbsp;<span class="ident" id="4657676">state</span>&nbsp;<span class="keyword" id="4657682">struct</span>&nbsp;<span class="op" id="4657689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4657692">tmpl</span>&nbsp;<span class="op" id="4657697">*</span><span class="ident" id="4657698">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4657708">wr</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4657713">io</span><span class="op" id="4657715">.</span><span class="ident" id="4657716">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4657724">node</span>&nbsp;<span class="ident" id="4657729">parse</span><span class="op" id="4657734">.</span><span class="ident" id="4657735">Node</span>&nbsp;<span class="comment" id="4657740">//&nbsp;current&nbsp;node,&nbsp;for&nbsp;errors</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4657769">vars</span>&nbsp;<span class="op" id="4657774">[</span><span class="op" id="4657775">]</span><span class="ident" id="4657776">variable</span>&nbsp;<span class="comment" id="4657785">//&nbsp;push-down&nbsp;stack&nbsp;of&nbsp;variable&nbsp;values.</span><br>
<span class="lineno"></span><span class="op" id="4657824">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4657827">//&nbsp;variable&nbsp;holds&nbsp;the&nbsp;dynamic&nbsp;value&nbsp;of&nbsp;a&nbsp;variable&nbsp;such&nbsp;as&nbsp;$,&nbsp;$x&nbsp;etc.</span><br>
<span class="lineno"></span><span class="keyword" id="4657896">type</span>&nbsp;<span class="ident" id="4657901">variable</span>&nbsp;<span class="keyword" id="4657910">struct</span>&nbsp;<span class="op" id="4657917">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4657920">name</span>&nbsp;&nbsp;<span class="builtintype" id="4657926">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4657934">value</span>&nbsp;<span class="ident" id="4657940">reflect</span><span class="op" id="4657947">.</span><span class="ident" id="4657948">Value</span><br>
<span class="lineno"></span><span class="op" id="4657954">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4657957">//&nbsp;push&nbsp;pushes&nbsp;a&nbsp;new&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.</span><br>
<span class="lineno">35</span><span class="keyword" id="4658001">func</span>&nbsp;<span class="op" id="4658006">(</span><span class="ident" id="4658007">s</span>&nbsp;<span class="op" id="4658009">*</span><span class="ident" id="4658010">state</span><span class="op" id="4658015">)</span>&nbsp;<span class="ident" id="4658017">push</span><span class="op" id="4658021">(</span><span class="ident" id="4658022">name</span>&nbsp;<span class="builtintype" id="4658027">string</span><span class="op" id="4658033">,</span>&nbsp;<span class="ident" id="4658035">value</span>&nbsp;<span class="ident" id="4658041">reflect</span><span class="op" id="4658048">.</span><span class="ident" id="4658049">Value</span><span class="op" id="4658054">)</span>&nbsp;<span class="op" id="4658056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658059">s</span><span class="op" id="4658060">.</span><span class="ident" id="4658061">vars</span>&nbsp;<span class="op" id="4658066">=</span>&nbsp;<span class="builtinfunc" id="4658068">append</span><span class="op" id="4658074">(</span><span class="ident" id="4658075">s</span><span class="op" id="4658076">.</span><span class="ident" id="4658077">vars</span><span class="op" id="4658081">,</span>&nbsp;<span class="ident" id="4658083">variable</span><span class="op" id="4658091">{</span><span class="ident" id="4658092">name</span><span class="op" id="4658096">,</span>&nbsp;<span class="ident" id="4658098">value</span><span class="op" id="4658103">}</span><span class="op" id="4658104">)</span><br>
<span class="lineno"></span><span class="op" id="4658106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4658109">//&nbsp;mark&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;variable&nbsp;stack.</span><br>
<span class="lineno">40</span><span class="keyword" id="4658159">func</span>&nbsp;<span class="op" id="4658164">(</span><span class="ident" id="4658165">s</span>&nbsp;<span class="op" id="4658167">*</span><span class="ident" id="4658168">state</span><span class="op" id="4658173">)</span>&nbsp;<span class="ident" id="4658175">mark</span><span class="op" id="4658179">(</span><span class="op" id="4658180">)</span>&nbsp;<span class="builtintype" id="4658182">int</span>&nbsp;<span class="op" id="4658186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4658189">return</span>&nbsp;<span class="builtinfunc" id="4658196">len</span><span class="op" id="4658199">(</span><span class="ident" id="4658200">s</span><span class="op" id="4658201">.</span><span class="ident" id="4658202">vars</span><span class="op" id="4658206">)</span><br>
<span class="lineno"></span><span class="op" id="4658208">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4658211">//&nbsp;pop&nbsp;pops&nbsp;the&nbsp;variable&nbsp;stack&nbsp;up&nbsp;to&nbsp;the&nbsp;mark.</span><br>
<span class="lineno">45</span><span class="keyword" id="4658258">func</span>&nbsp;<span class="op" id="4658263">(</span><span class="ident" id="4658264">s</span>&nbsp;<span class="op" id="4658266">*</span><span class="ident" id="4658267">state</span><span class="op" id="4658272">)</span>&nbsp;<span class="ident" id="4658274">pop</span><span class="op" id="4658277">(</span><span class="ident" id="4658278">mark</span>&nbsp;<span class="builtintype" id="4658283">int</span><span class="op" id="4658286">)</span>&nbsp;<span class="op" id="4658288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658291">s</span><span class="op" id="4658292">.</span><span class="ident" id="4658293">vars</span>&nbsp;<span class="op" id="4658298">=</span>&nbsp;<span class="ident" id="4658300">s</span><span class="op" id="4658301">.</span><span class="ident" id="4658302">vars</span><span class="op" id="4658306">[</span><span class="num" id="4658307">0</span><span class="op" id="4658308">:</span><span class="ident" id="4658309">mark</span><span class="op" id="4658313">]</span><br>
<span class="lineno"></span><span class="op" id="4658315">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4658318">//&nbsp;setVar&nbsp;overwrites&nbsp;the&nbsp;top-nth&nbsp;variable&nbsp;on&nbsp;the&nbsp;stack.&nbsp;Used&nbsp;by&nbsp;range&nbsp;iterations.</span><br>
<span class="lineno">50</span><span class="keyword" id="4658400">func</span>&nbsp;<span class="op" id="4658405">(</span><span class="ident" id="4658406">s</span>&nbsp;<span class="op" id="4658408">*</span><span class="ident" id="4658409">state</span><span class="op" id="4658414">)</span>&nbsp;<span class="ident" id="4658416">setVar</span><span class="op" id="4658422">(</span><span class="ident" id="4658423">n</span>&nbsp;<span class="builtintype" id="4658425">int</span><span class="op" id="4658428">,</span>&nbsp;<span class="ident" id="4658430">value</span>&nbsp;<span class="ident" id="4658436">reflect</span><span class="op" id="4658443">.</span><span class="ident" id="4658444">Value</span><span class="op" id="4658449">)</span>&nbsp;<span class="op" id="4658451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658454">s</span><span class="op" id="4658455">.</span><span class="ident" id="4658456">vars</span><span class="op" id="4658460">[</span><span class="builtinfunc" id="4658461">len</span><span class="op" id="4658464">(</span><span class="ident" id="4658465">s</span><span class="op" id="4658466">.</span><span class="ident" id="4658467">vars</span><span class="op" id="4658471">)</span><span class="op" id="4658472">-</span><span class="ident" id="4658473">n</span><span class="op" id="4658474">]</span><span class="op" id="4658475">.</span><span class="ident" id="4658476">value</span>&nbsp;<span class="op" id="4658482">=</span>&nbsp;<span class="ident" id="4658484">value</span><br>
<span class="lineno"></span><span class="op" id="4658490">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4658493">//&nbsp;varValue&nbsp;returns&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;named&nbsp;variable.</span><br>
<span class="lineno">55</span><span class="keyword" id="4658546">func</span>&nbsp;<span class="op" id="4658551">(</span><span class="ident" id="4658552">s</span>&nbsp;<span class="op" id="4658554">*</span><span class="ident" id="4658555">state</span><span class="op" id="4658560">)</span>&nbsp;<span class="ident" id="4658562">varValue</span><span class="op" id="4658570">(</span><span class="ident" id="4658571">name</span>&nbsp;<span class="builtintype" id="4658576">string</span><span class="op" id="4658582">)</span>&nbsp;<span class="ident" id="4658584">reflect</span><span class="op" id="4658591">.</span><span class="ident" id="4658592">Value</span>&nbsp;<span class="op" id="4658598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4658601">for</span>&nbsp;<span class="ident" id="4658605">i</span>&nbsp;<span class="op" id="4658607">:=</span>&nbsp;<span class="ident" id="4658610">s</span><span class="op" id="4658611">.</span><span class="ident" id="4658612">mark</span><span class="op" id="4658616">(</span><span class="op" id="4658617">)</span>&nbsp;<span class="op" id="4658619">-</span>&nbsp;<span class="num" id="4658621">1</span><span class="op" id="4658622">;</span>&nbsp;<span class="ident" id="4658624">i</span>&nbsp;<span class="op" id="4658626">&gt;=</span>&nbsp;<span class="num" id="4658629">0</span><span class="op" id="4658630">;</span>&nbsp;<span class="ident" id="4658632">i</span><span class="op" id="4658633">--</span>&nbsp;<span class="op" id="4658636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4658640">if</span>&nbsp;<span class="ident" id="4658643">s</span><span class="op" id="4658644">.</span><span class="ident" id="4658645">vars</span><span class="op" id="4658649">[</span><span class="ident" id="4658650">i</span><span class="op" id="4658651">]</span><span class="op" id="4658652">.</span><span class="ident" id="4658653">name</span>&nbsp;<span class="op" id="4658658">==</span>&nbsp;<span class="ident" id="4658661">name</span>&nbsp;<span class="op" id="4658666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4658671">return</span>&nbsp;<span class="ident" id="4658678">s</span><span class="op" id="4658679">.</span><span class="ident" id="4658680">vars</span><span class="op" id="4658684">[</span><span class="ident" id="4658685">i</span><span class="op" id="4658686">]</span><span class="op" id="4658687">.</span><span class="ident" id="4658688">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4658696">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4658699">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658702">s</span><span class="op" id="4658703">.</span><span class="ident" id="4658704">errorf</span><span class="op" id="4658710">(</span><span class="string" id="4658711">&#34;undefined&nbsp;variable:&nbsp;%s&#34;</span><span class="op" id="4658735">,</span>&nbsp;<span class="ident" id="4658737">name</span><span class="op" id="4658741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4658744">return</span>&nbsp;<span class="ident" id="4658751">zero</span><br>
<span class="lineno"></span><span class="op" id="4658756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="4658759">var</span>&nbsp;<span class="ident" id="4658763">zero</span>&nbsp;<span class="ident" id="4658768">reflect</span><span class="op" id="4658775">.</span><span class="ident" id="4658776">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4658783">//&nbsp;at&nbsp;marks&nbsp;the&nbsp;state&nbsp;to&nbsp;be&nbsp;on&nbsp;node&nbsp;n,&nbsp;for&nbsp;error&nbsp;reporting.</span><br>
<span class="lineno"></span><span class="keyword" id="4658843">func</span>&nbsp;<span class="op" id="4658848">(</span><span class="ident" id="4658849">s</span>&nbsp;<span class="op" id="4658851">*</span><span class="ident" id="4658852">state</span><span class="op" id="4658857">)</span>&nbsp;<span class="ident" id="4658859">at</span><span class="op" id="4658861">(</span><span class="ident" id="4658862">node</span>&nbsp;<span class="ident" id="4658867">parse</span><span class="op" id="4658872">.</span><span class="ident" id="4658873">Node</span><span class="op" id="4658877">)</span>&nbsp;<span class="op" id="4658879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4658882">s</span><span class="op" id="4658883">.</span><span class="ident" id="4658884">node</span>&nbsp;<span class="op" id="4658889">=</span>&nbsp;<span class="ident" id="4658891">node</span><br>
<span class="lineno">70</span><span class="op" id="4658896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4658899">//&nbsp;doublePercent&nbsp;returns&nbsp;the&nbsp;string&nbsp;with&nbsp;%&#39;s&nbsp;replaced&nbsp;by&nbsp;%%,&nbsp;if&nbsp;necessary,</span><br>
<span class="lineno"></span><span class="comment" id="4658974">//&nbsp;so&nbsp;it&nbsp;can&nbsp;be&nbsp;used&nbsp;safely&nbsp;inside&nbsp;a&nbsp;Printf&nbsp;format&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="4659033">func</span>&nbsp;<span class="ident" id="4659038">doublePercent</span><span class="op" id="4659051">(</span><span class="ident" id="4659052">str</span>&nbsp;<span class="builtintype" id="4659056">string</span><span class="op" id="4659062">)</span>&nbsp;<span class="builtintype" id="4659064">string</span>&nbsp;<span class="op" id="4659071">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4659074">if</span>&nbsp;<span class="ident" id="4659077">strings</span><span class="op" id="4659084">.</span><span class="ident" id="4659085">Contains</span><span class="op" id="4659093">(</span><span class="ident" id="4659094">str</span><span class="op" id="4659097">,</span>&nbsp;<span class="string" id="4659099">&#34;%&#34;</span><span class="op" id="4659102">)</span>&nbsp;<span class="op" id="4659104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659108">str</span>&nbsp;<span class="op" id="4659112">=</span>&nbsp;<span class="ident" id="4659114">strings</span><span class="op" id="4659121">.</span><span class="ident" id="4659122">Replace</span><span class="op" id="4659129">(</span><span class="ident" id="4659130">str</span><span class="op" id="4659133">,</span>&nbsp;<span class="string" id="4659135">&#34;%&#34;</span><span class="op" id="4659138">,</span>&nbsp;<span class="string" id="4659140">&#34;%%&#34;</span><span class="op" id="4659144">,</span>&nbsp;<span class="op" id="4659146">-</span><span class="num" id="4659147">1</span><span class="op" id="4659148">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4659151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4659154">return</span>&nbsp;<span class="ident" id="4659161">str</span><br>
<span class="lineno"></span><span class="op" id="4659165">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4659168">//&nbsp;errorf&nbsp;formats&nbsp;the&nbsp;error&nbsp;and&nbsp;terminates&nbsp;processing.</span><br>
<span class="lineno"></span><span class="keyword" id="4659223">func</span>&nbsp;<span class="op" id="4659228">(</span><span class="ident" id="4659229">s</span>&nbsp;<span class="op" id="4659231">*</span><span class="ident" id="4659232">state</span><span class="op" id="4659237">)</span>&nbsp;<span class="ident" id="4659239">errorf</span><span class="op" id="4659245">(</span><span class="ident" id="4659246">format</span>&nbsp;<span class="builtintype" id="4659253">string</span><span class="op" id="4659259">,</span>&nbsp;<span class="ident" id="4659261">args</span>&nbsp;<span class="op" id="4659266">...</span><span class="keyword" id="4659269">interface</span><span class="op" id="4659278">{</span><span class="op" id="4659279">}</span><span class="op" id="4659280">)</span>&nbsp;<span class="op" id="4659282">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659285">name</span>&nbsp;<span class="op" id="4659290">:=</span>&nbsp;<span class="ident" id="4659293">doublePercent</span><span class="op" id="4659306">(</span><span class="ident" id="4659307">s</span><span class="op" id="4659308">.</span><span class="ident" id="4659309">tmpl</span><span class="op" id="4659313">.</span><span class="ident" id="4659314">Name</span><span class="op" id="4659318">(</span><span class="op" id="4659319">)</span><span class="op" id="4659320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4659323">if</span>&nbsp;<span class="ident" id="4659326">s</span><span class="op" id="4659327">.</span><span class="ident" id="4659328">node</span>&nbsp;<span class="op" id="4659333">==</span>&nbsp;<span class="ident" id="4659336">nil</span>&nbsp;<span class="op" id="4659340">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659344">format</span>&nbsp;<span class="op" id="4659351">=</span>&nbsp;<span class="ident" id="4659353">fmt</span><span class="op" id="4659356">.</span><span class="ident" id="4659357">Sprintf</span><span class="op" id="4659364">(</span><span class="string" id="4659365">&#34;template:&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="4659383">,</span>&nbsp;<span class="ident" id="4659385">name</span><span class="op" id="4659389">,</span>&nbsp;<span class="ident" id="4659391">format</span><span class="op" id="4659397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4659400">}</span>&nbsp;<span class="keyword" id="4659402">else</span>&nbsp;<span class="op" id="4659407">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659411">location</span><span class="op" id="4659419">,</span>&nbsp;<span class="ident" id="4659421">context</span>&nbsp;<span class="op" id="4659429">:=</span>&nbsp;<span class="ident" id="4659432">s</span><span class="op" id="4659433">.</span><span class="ident" id="4659434">tmpl</span><span class="op" id="4659438">.</span><span class="ident" id="4659439">ErrorContext</span><span class="op" id="4659451">(</span><span class="ident" id="4659452">s</span><span class="op" id="4659453">.</span><span class="ident" id="4659454">node</span><span class="op" id="4659458">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659462">format</span>&nbsp;<span class="op" id="4659469">=</span>&nbsp;<span class="ident" id="4659471">fmt</span><span class="op" id="4659474">.</span><span class="ident" id="4659475">Sprintf</span><span class="op" id="4659482">(</span><span class="string" id="4659483">&#34;template:&nbsp;%s:&nbsp;executing&nbsp;%q&nbsp;at&nbsp;&lt;%s&gt;:&nbsp;%s&#34;</span><span class="op" id="4659523">,</span>&nbsp;<span class="ident" id="4659525">location</span><span class="op" id="4659533">,</span>&nbsp;<span class="ident" id="4659535">name</span><span class="op" id="4659539">,</span>&nbsp;<span class="ident" id="4659541">doublePercent</span><span class="op" id="4659554">(</span><span class="ident" id="4659555">context</span><span class="op" id="4659562">)</span><span class="op" id="4659563">,</span>&nbsp;<span class="ident" id="4659565">format</span><span class="op" id="4659571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4659574">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4659577">panic</span><span class="op" id="4659582">(</span><span class="ident" id="4659583">fmt</span><span class="op" id="4659586">.</span><span class="ident" id="4659587">Errorf</span><span class="op" id="4659593">(</span><span class="ident" id="4659594">format</span><span class="op" id="4659600">,</span>&nbsp;<span class="ident" id="4659602">args</span><span class="op" id="4659606">...</span><span class="op" id="4659609">)</span><span class="op" id="4659610">)</span><br>
<span class="lineno"></span><span class="op" id="4659612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4659615">//&nbsp;errRecover&nbsp;is&nbsp;the&nbsp;handler&nbsp;that&nbsp;turns&nbsp;panics&nbsp;into&nbsp;returns&nbsp;from&nbsp;the&nbsp;top</span><br>
<span class="lineno"></span><span class="comment" id="4659688">//&nbsp;level&nbsp;of&nbsp;Parse.</span><br>
<span class="lineno">95</span><span class="keyword" id="4659707">func</span>&nbsp;<span class="ident" id="4659712">errRecover</span><span class="op" id="4659722">(</span><span class="ident" id="4659723">errp</span>&nbsp;<span class="op" id="4659728">*</span><span class="builtintype" id="4659729">error</span><span class="op" id="4659734">)</span>&nbsp;<span class="op" id="4659736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4659739">e</span>&nbsp;<span class="op" id="4659741">:=</span>&nbsp;<span class="builtinfunc" id="4659744">recover</span><span class="op" id="4659751">(</span><span class="op" id="4659752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4659755">if</span>&nbsp;<span class="ident" id="4659758">e</span>&nbsp;<span class="op" id="4659760">!=</span>&nbsp;<span class="ident" id="4659763">nil</span>&nbsp;<span class="op" id="4659767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4659771">switch</span>&nbsp;<span class="ident" id="4659778">err</span>&nbsp;<span class="op" id="4659782">:=</span>&nbsp;<span class="ident" id="4659785">e</span><span class="op" id="4659786">.</span><span class="op" id="4659787">(</span><span class="keyword" id="4659788">type</span><span class="op" id="4659792">)</span>&nbsp;<span class="op" id="4659794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4659798">case</span>&nbsp;<span class="ident" id="4659803">runtime</span><span class="op" id="4659810">.</span><span class="ident" id="4659811">Error</span><span class="op" id="4659816">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4659821">panic</span><span class="op" id="4659826">(</span><span class="ident" id="4659827">e</span><span class="op" id="4659828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4659832">case</span>&nbsp;<span class="builtintype" id="4659837">error</span><span class="op" id="4659842">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4659847">*</span><span class="ident" id="4659848">errp</span>&nbsp;<span class="op" id="4659853">=</span>&nbsp;<span class="ident" id="4659855">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4659861">default</span><span class="op" id="4659868">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4659873">panic</span><span class="op" id="4659878">(</span><span class="ident" id="4659879">e</span><span class="op" id="4659880">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4659884">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4659887">}</span><br>
<span class="lineno"></span><span class="op" id="4659889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4659892">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno">110</span><span class="comment" id="4659974">//&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="4660035">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="4660103">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4660176">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="4660198">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno">115</span><span class="keyword" id="4660248">func</span>&nbsp;<span class="op" id="4660253">(</span><span class="ident" id="4660254">t</span>&nbsp;<span class="op" id="4660256">*</span><span class="ident" id="4660257">Template</span><span class="op" id="4660265">)</span>&nbsp;<span class="ident" id="4660267">ExecuteTemplate</span><span class="op" id="4660282">(</span><span class="ident" id="4660283">wr</span>&nbsp;<span class="ident" id="4660286">io</span><span class="op" id="4660288">.</span><span class="ident" id="4660289">Writer</span><span class="op" id="4660295">,</span>&nbsp;<span class="ident" id="4660297">name</span>&nbsp;<span class="builtintype" id="4660302">string</span><span class="op" id="4660308">,</span>&nbsp;<span class="ident" id="4660310">data</span>&nbsp;<span class="keyword" id="4660315">interface</span><span class="op" id="4660324">{</span><span class="op" id="4660325">}</span><span class="op" id="4660326">)</span>&nbsp;<span class="builtintype" id="4660328">error</span>&nbsp;<span class="op" id="4660334">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660337">tmpl</span>&nbsp;<span class="op" id="4660342">:=</span>&nbsp;<span class="ident" id="4660345">t</span><span class="op" id="4660346">.</span><span class="ident" id="4660347">tmpl</span><span class="op" id="4660351">[</span><span class="ident" id="4660352">name</span><span class="op" id="4660356">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4660359">if</span>&nbsp;<span class="ident" id="4660362">tmpl</span>&nbsp;<span class="op" id="4660367">==</span>&nbsp;<span class="ident" id="4660370">nil</span>&nbsp;<span class="op" id="4660374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4660378">return</span>&nbsp;<span class="ident" id="4660385">fmt</span><span class="op" id="4660388">.</span><span class="ident" id="4660389">Errorf</span><span class="op" id="4660395">(</span><span class="string" id="4660396">&#34;template:&nbsp;no&nbsp;template&nbsp;%q&nbsp;associated&nbsp;with&nbsp;template&nbsp;%q&#34;</span><span class="op" id="4660450">,</span>&nbsp;<span class="ident" id="4660452">name</span><span class="op" id="4660456">,</span>&nbsp;<span class="ident" id="4660458">t</span><span class="op" id="4660459">.</span><span class="ident" id="4660460">name</span><span class="op" id="4660464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4660467">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4660470">return</span>&nbsp;<span class="ident" id="4660477">tmpl</span><span class="op" id="4660481">.</span><span class="ident" id="4660482">Execute</span><span class="op" id="4660489">(</span><span class="ident" id="4660490">wr</span><span class="op" id="4660492">,</span>&nbsp;<span class="ident" id="4660494">data</span><span class="op" id="4660498">)</span><br>
<span class="lineno"></span><span class="op" id="4660500">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4660503">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="4660570">//&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">125</span><span class="comment" id="4660602">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="4660670">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4660743">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="4660765">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="4660815">func</span>&nbsp;<span class="op" id="4660820">(</span><span class="ident" id="4660821">t</span>&nbsp;<span class="op" id="4660823">*</span><span class="ident" id="4660824">Template</span><span class="op" id="4660832">)</span>&nbsp;<span class="ident" id="4660834">Execute</span><span class="op" id="4660841">(</span><span class="ident" id="4660842">wr</span>&nbsp;<span class="ident" id="4660845">io</span><span class="op" id="4660847">.</span><span class="ident" id="4660848">Writer</span><span class="op" id="4660854">,</span>&nbsp;<span class="ident" id="4660856">data</span>&nbsp;<span class="keyword" id="4660861">interface</span><span class="op" id="4660870">{</span><span class="op" id="4660871">}</span><span class="op" id="4660872">)</span>&nbsp;<span class="op" id="4660874">(</span><span class="ident" id="4660875">err</span>&nbsp;<span class="builtintype" id="4660879">error</span><span class="op" id="4660884">)</span>&nbsp;<span class="op" id="4660886">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4660889">defer</span>&nbsp;<span class="ident" id="4660895">errRecover</span><span class="op" id="4660905">(</span><span class="op" id="4660906">&amp;</span><span class="ident" id="4660907">err</span><span class="op" id="4660910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660913">value</span>&nbsp;<span class="op" id="4660919">:=</span>&nbsp;<span class="ident" id="4660922">reflect</span><span class="op" id="4660929">.</span><span class="ident" id="4660930">ValueOf</span><span class="op" id="4660937">(</span><span class="ident" id="4660938">data</span><span class="op" id="4660942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660945">state</span>&nbsp;<span class="op" id="4660951">:=</span>&nbsp;<span class="op" id="4660954">&amp;</span><span class="ident" id="4660955">state</span><span class="op" id="4660960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660964">tmpl</span><span class="op" id="4660968">:</span>&nbsp;<span class="ident" id="4660970">t</span><span class="op" id="4660971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660975">wr</span><span class="op" id="4660977">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4660981">wr</span><span class="op" id="4660983">,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4660987">vars</span><span class="op" id="4660991">:</span>&nbsp;<span class="op" id="4660993">[</span><span class="op" id="4660994">]</span><span class="ident" id="4660995">variable</span><span class="op" id="4661003">{</span><span class="op" id="4661004">{</span><span class="string" id="4661005">&#34;$&#34;</span><span class="op" id="4661008">,</span>&nbsp;<span class="ident" id="4661010">value</span><span class="op" id="4661015">}</span><span class="op" id="4661016">}</span><span class="op" id="4661017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4661020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661023">t</span><span class="op" id="4661024">.</span><span class="ident" id="4661025">init</span><span class="op" id="4661029">(</span><span class="op" id="4661030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661033">if</span>&nbsp;<span class="ident" id="4661036">t</span><span class="op" id="4661037">.</span><span class="ident" id="4661038">Tree</span>&nbsp;<span class="op" id="4661043">==</span>&nbsp;<span class="ident" id="4661046">nil</span>&nbsp;<span class="op" id="4661050">||</span>&nbsp;<span class="ident" id="4661053">t</span><span class="op" id="4661054">.</span><span class="ident" id="4661055">Root</span>&nbsp;<span class="op" id="4661060">==</span>&nbsp;<span class="ident" id="4661063">nil</span>&nbsp;<span class="op" id="4661067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661071">var</span>&nbsp;<span class="ident" id="4661075">b</span>&nbsp;<span class="ident" id="4661077">bytes</span><span class="op" id="4661082">.</span><span class="ident" id="4661083">Buffer</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661092">for</span>&nbsp;<span class="ident" id="4661096">name</span><span class="op" id="4661100">,</span>&nbsp;<span class="ident" id="4661102">tmpl</span>&nbsp;<span class="op" id="4661107">:=</span>&nbsp;<span class="keyword" id="4661110">range</span>&nbsp;<span class="ident" id="4661116">t</span><span class="op" id="4661117">.</span><span class="ident" id="4661118">tmpl</span>&nbsp;<span class="op" id="4661123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661128">if</span>&nbsp;<span class="ident" id="4661131">tmpl</span><span class="op" id="4661135">.</span><span class="ident" id="4661136">Tree</span>&nbsp;<span class="op" id="4661141">==</span>&nbsp;<span class="ident" id="4661144">nil</span>&nbsp;<span class="op" id="4661148">||</span>&nbsp;<span class="ident" id="4661151">tmpl</span><span class="op" id="4661155">.</span><span class="ident" id="4661156">Root</span>&nbsp;<span class="op" id="4661161">==</span>&nbsp;<span class="ident" id="4661164">nil</span>&nbsp;<span class="op" id="4661168">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661174">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4661186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661191">if</span>&nbsp;<span class="ident" id="4661194">b</span><span class="op" id="4661195">.</span><span class="ident" id="4661196">Len</span><span class="op" id="4661199">(</span><span class="op" id="4661200">)</span>&nbsp;<span class="op" id="4661202">&gt;</span>&nbsp;<span class="num" id="4661204">0</span>&nbsp;<span class="op" id="4661206">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661212">b</span><span class="op" id="4661213">.</span><span class="ident" id="4661214">WriteString</span><span class="op" id="4661225">(</span><span class="string" id="4661226">&#34;,&nbsp;&#34;</span><span class="op" id="4661230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4661235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661240">fmt</span><span class="op" id="4661243">.</span><span class="ident" id="4661244">Fprintf</span><span class="op" id="4661251">(</span><span class="op" id="4661252">&amp;</span><span class="ident" id="4661253">b</span><span class="op" id="4661254">,</span>&nbsp;<span class="string" id="4661256">&#34;%q&#34;</span><span class="op" id="4661260">,</span>&nbsp;<span class="ident" id="4661262">name</span><span class="op" id="4661266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4661270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661274">var</span>&nbsp;<span class="ident" id="4661278">s</span>&nbsp;<span class="builtintype" id="4661280">string</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661289">if</span>&nbsp;<span class="ident" id="4661292">b</span><span class="op" id="4661293">.</span><span class="ident" id="4661294">Len</span><span class="op" id="4661297">(</span><span class="op" id="4661298">)</span>&nbsp;<span class="op" id="4661300">&gt;</span>&nbsp;<span class="num" id="4661302">0</span>&nbsp;<span class="op" id="4661304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661309">s</span>&nbsp;<span class="op" id="4661311">=</span>&nbsp;<span class="string" id="4661313">&#34;;&nbsp;defined&nbsp;templates&nbsp;are:&nbsp;&#34;</span>&nbsp;<span class="op" id="4661341">+</span>&nbsp;<span class="ident" id="4661343">b</span><span class="op" id="4661344">.</span><span class="ident" id="4661345">String</span><span class="op" id="4661351">(</span><span class="op" id="4661352">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4661356">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661360">state</span><span class="op" id="4661365">.</span><span class="ident" id="4661366">errorf</span><span class="op" id="4661372">(</span><span class="string" id="4661373">&#34;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;or&nbsp;empty&nbsp;template%s&#34;</span><span class="op" id="4661414">,</span>&nbsp;<span class="ident" id="4661416">t</span><span class="op" id="4661417">.</span><span class="ident" id="4661418">Name</span><span class="op" id="4661422">(</span><span class="op" id="4661423">)</span><span class="op" id="4661424">,</span>&nbsp;<span class="ident" id="4661426">s</span><span class="op" id="4661427">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4661430">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661433">state</span><span class="op" id="4661438">.</span><span class="ident" id="4661439">walk</span><span class="op" id="4661443">(</span><span class="ident" id="4661444">value</span><span class="op" id="4661449">,</span>&nbsp;<span class="ident" id="4661451">t</span><span class="op" id="4661452">.</span><span class="ident" id="4661453">Root</span><span class="op" id="4661457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661460">return</span><br>
<span class="lineno"></span><span class="op" id="4661467">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4661470">//&nbsp;Walk&nbsp;functions&nbsp;step&nbsp;through&nbsp;the&nbsp;major&nbsp;pieces&nbsp;of&nbsp;the&nbsp;template&nbsp;structure,</span><br>
<span class="lineno">160</span><span class="comment" id="4661545">//&nbsp;generating&nbsp;output&nbsp;as&nbsp;they&nbsp;go.</span><br>
<span class="lineno"></span><span class="keyword" id="4661578">func</span>&nbsp;<span class="op" id="4661583">(</span><span class="ident" id="4661584">s</span>&nbsp;<span class="op" id="4661586">*</span><span class="ident" id="4661587">state</span><span class="op" id="4661592">)</span>&nbsp;<span class="ident" id="4661594">walk</span><span class="op" id="4661598">(</span><span class="ident" id="4661599">dot</span>&nbsp;<span class="ident" id="4661603">reflect</span><span class="op" id="4661610">.</span><span class="ident" id="4661611">Value</span><span class="op" id="4661616">,</span>&nbsp;<span class="ident" id="4661618">node</span>&nbsp;<span class="ident" id="4661623">parse</span><span class="op" id="4661628">.</span><span class="ident" id="4661629">Node</span><span class="op" id="4661633">)</span>&nbsp;<span class="op" id="4661635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661638">s</span><span class="op" id="4661639">.</span><span class="ident" id="4661640">at</span><span class="op" id="4661642">(</span><span class="ident" id="4661643">node</span><span class="op" id="4661647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661650">switch</span>&nbsp;<span class="ident" id="4661657">node</span>&nbsp;<span class="op" id="4661662">:=</span>&nbsp;<span class="ident" id="4661665">node</span><span class="op" id="4661669">.</span><span class="op" id="4661670">(</span><span class="keyword" id="4661671">type</span><span class="op" id="4661675">)</span>&nbsp;<span class="op" id="4661677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661680">case</span>&nbsp;<span class="op" id="4661685">*</span><span class="ident" id="4661686">parse</span><span class="op" id="4661691">.</span><span class="ident" id="4661692">ActionNode</span><span class="op" id="4661702">:</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4661706">//&nbsp;Do&nbsp;not&nbsp;pop&nbsp;variables&nbsp;so&nbsp;they&nbsp;persist&nbsp;until&nbsp;next&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4661764">//&nbsp;Also,&nbsp;if&nbsp;the&nbsp;action&nbsp;declares&nbsp;variables,&nbsp;don&#39;t&nbsp;print&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661833">val</span>&nbsp;<span class="op" id="4661837">:=</span>&nbsp;<span class="ident" id="4661840">s</span><span class="op" id="4661841">.</span><span class="ident" id="4661842">evalPipeline</span><span class="op" id="4661854">(</span><span class="ident" id="4661855">dot</span><span class="op" id="4661858">,</span>&nbsp;<span class="ident" id="4661860">node</span><span class="op" id="4661864">.</span><span class="ident" id="4661865">Pipe</span><span class="op" id="4661869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661873">if</span>&nbsp;<span class="builtinfunc" id="4661876">len</span><span class="op" id="4661879">(</span><span class="ident" id="4661880">node</span><span class="op" id="4661884">.</span><span class="ident" id="4661885">Pipe</span><span class="op" id="4661889">.</span><span class="ident" id="4661890">Decl</span><span class="op" id="4661894">)</span>&nbsp;<span class="op" id="4661896">==</span>&nbsp;<span class="num" id="4661899">0</span>&nbsp;<span class="op" id="4661901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661906">s</span><span class="op" id="4661907">.</span><span class="ident" id="4661908">printValue</span><span class="op" id="4661918">(</span><span class="ident" id="4661919">node</span><span class="op" id="4661923">,</span>&nbsp;<span class="ident" id="4661925">val</span><span class="op" id="4661928">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4661932">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4661935">case</span>&nbsp;<span class="op" id="4661940">*</span><span class="ident" id="4661941">parse</span><span class="op" id="4661946">.</span><span class="ident" id="4661947">IfNode</span><span class="op" id="4661953">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4661957">s</span><span class="op" id="4661958">.</span><span class="ident" id="4661959">walkIfOrWith</span><span class="op" id="4661971">(</span><span class="ident" id="4661972">parse</span><span class="op" id="4661977">.</span><span class="ident" id="4661978">NodeIf</span><span class="op" id="4661984">,</span>&nbsp;<span class="ident" id="4661986">dot</span><span class="op" id="4661989">,</span>&nbsp;<span class="ident" id="4661991">node</span><span class="op" id="4661995">.</span><span class="ident" id="4661996">Pipe</span><span class="op" id="4662000">,</span>&nbsp;<span class="ident" id="4662002">node</span><span class="op" id="4662006">.</span><span class="ident" id="4662007">List</span><span class="op" id="4662011">,</span>&nbsp;<span class="ident" id="4662013">node</span><span class="op" id="4662017">.</span><span class="ident" id="4662018">ElseList</span><span class="op" id="4662026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662029">case</span>&nbsp;<span class="op" id="4662034">*</span><span class="ident" id="4662035">parse</span><span class="op" id="4662040">.</span><span class="ident" id="4662041">ListNode</span><span class="op" id="4662049">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662053">for</span>&nbsp;<span class="ident" id="4662057">_</span><span class="op" id="4662058">,</span>&nbsp;<span class="ident" id="4662060">node</span>&nbsp;<span class="op" id="4662065">:=</span>&nbsp;<span class="keyword" id="4662068">range</span>&nbsp;<span class="ident" id="4662074">node</span><span class="op" id="4662078">.</span><span class="ident" id="4662079">Nodes</span>&nbsp;<span class="op" id="4662085">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662090">s</span><span class="op" id="4662091">.</span><span class="ident" id="4662092">walk</span><span class="op" id="4662096">(</span><span class="ident" id="4662097">dot</span><span class="op" id="4662100">,</span>&nbsp;<span class="ident" id="4662102">node</span><span class="op" id="4662106">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662110">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662113">case</span>&nbsp;<span class="op" id="4662118">*</span><span class="ident" id="4662119">parse</span><span class="op" id="4662124">.</span><span class="ident" id="4662125">RangeNode</span><span class="op" id="4662134">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662138">s</span><span class="op" id="4662139">.</span><span class="ident" id="4662140">walkRange</span><span class="op" id="4662149">(</span><span class="ident" id="4662150">dot</span><span class="op" id="4662153">,</span>&nbsp;<span class="ident" id="4662155">node</span><span class="op" id="4662159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662162">case</span>&nbsp;<span class="op" id="4662167">*</span><span class="ident" id="4662168">parse</span><span class="op" id="4662173">.</span><span class="ident" id="4662174">TemplateNode</span><span class="op" id="4662186">:</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662190">s</span><span class="op" id="4662191">.</span><span class="ident" id="4662192">walkTemplate</span><span class="op" id="4662204">(</span><span class="ident" id="4662205">dot</span><span class="op" id="4662208">,</span>&nbsp;<span class="ident" id="4662210">node</span><span class="op" id="4662214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662217">case</span>&nbsp;<span class="op" id="4662222">*</span><span class="ident" id="4662223">parse</span><span class="op" id="4662228">.</span><span class="ident" id="4662229">TextNode</span><span class="op" id="4662237">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662241">if</span>&nbsp;<span class="ident" id="4662244">_</span><span class="op" id="4662245">,</span>&nbsp;<span class="ident" id="4662247">err</span>&nbsp;<span class="op" id="4662251">:=</span>&nbsp;<span class="ident" id="4662254">s</span><span class="op" id="4662255">.</span><span class="ident" id="4662256">wr</span><span class="op" id="4662258">.</span><span class="ident" id="4662259">Write</span><span class="op" id="4662264">(</span><span class="ident" id="4662265">node</span><span class="op" id="4662269">.</span><span class="ident" id="4662270">Text</span><span class="op" id="4662274">)</span><span class="op" id="4662275">;</span>&nbsp;<span class="ident" id="4662277">err</span>&nbsp;<span class="op" id="4662281">!=</span>&nbsp;<span class="ident" id="4662284">nil</span>&nbsp;<span class="op" id="4662288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662293">s</span><span class="op" id="4662294">.</span><span class="ident" id="4662295">errorf</span><span class="op" id="4662301">(</span><span class="string" id="4662302">&#34;%s&#34;</span><span class="op" id="4662306">,</span>&nbsp;<span class="ident" id="4662308">err</span><span class="op" id="4662311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662315">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662318">case</span>&nbsp;<span class="op" id="4662323">*</span><span class="ident" id="4662324">parse</span><span class="op" id="4662329">.</span><span class="ident" id="4662330">WithNode</span><span class="op" id="4662338">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662342">s</span><span class="op" id="4662343">.</span><span class="ident" id="4662344">walkIfOrWith</span><span class="op" id="4662356">(</span><span class="ident" id="4662357">parse</span><span class="op" id="4662362">.</span><span class="ident" id="4662363">NodeWith</span><span class="op" id="4662371">,</span>&nbsp;<span class="ident" id="4662373">dot</span><span class="op" id="4662376">,</span>&nbsp;<span class="ident" id="4662378">node</span><span class="op" id="4662382">.</span><span class="ident" id="4662383">Pipe</span><span class="op" id="4662387">,</span>&nbsp;<span class="ident" id="4662389">node</span><span class="op" id="4662393">.</span><span class="ident" id="4662394">List</span><span class="op" id="4662398">,</span>&nbsp;<span class="ident" id="4662400">node</span><span class="op" id="4662404">.</span><span class="ident" id="4662405">ElseList</span><span class="op" id="4662413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662416">default</span><span class="op" id="4662423">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662427">s</span><span class="op" id="4662428">.</span><span class="ident" id="4662429">errorf</span><span class="op" id="4662435">(</span><span class="string" id="4662436">&#34;unknown&nbsp;node:&nbsp;%s&#34;</span><span class="op" id="4662454">,</span>&nbsp;<span class="ident" id="4662456">node</span><span class="op" id="4662460">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662463">}</span><br>
<span class="lineno">190</span><span class="op" id="4662465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4662468">//&nbsp;walkIfOrWith&nbsp;walks&nbsp;an&nbsp;&#39;if&#39;&nbsp;or&nbsp;&#39;with&#39;&nbsp;node.&nbsp;The&nbsp;two&nbsp;control&nbsp;structures</span><br>
<span class="lineno"></span><span class="comment" id="4662541">//&nbsp;are&nbsp;identical&nbsp;in&nbsp;behavior&nbsp;except&nbsp;that&nbsp;&#39;with&#39;&nbsp;sets&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="4662599">func</span>&nbsp;<span class="op" id="4662604">(</span><span class="ident" id="4662605">s</span>&nbsp;<span class="op" id="4662607">*</span><span class="ident" id="4662608">state</span><span class="op" id="4662613">)</span>&nbsp;<span class="ident" id="4662615">walkIfOrWith</span><span class="op" id="4662627">(</span><span class="ident" id="4662628">typ</span>&nbsp;<span class="ident" id="4662632">parse</span><span class="op" id="4662637">.</span><span class="ident" id="4662638">NodeType</span><span class="op" id="4662646">,</span>&nbsp;<span class="ident" id="4662648">dot</span>&nbsp;<span class="ident" id="4662652">reflect</span><span class="op" id="4662659">.</span><span class="ident" id="4662660">Value</span><span class="op" id="4662665">,</span>&nbsp;<span class="ident" id="4662667">pipe</span>&nbsp;<span class="op" id="4662672">*</span><span class="ident" id="4662673">parse</span><span class="op" id="4662678">.</span><span class="ident" id="4662679">PipeNode</span><span class="op" id="4662687">,</span>&nbsp;<span class="ident" id="4662689">list</span><span class="op" id="4662693">,</span>&nbsp;<span class="ident" id="4662695">elseList</span>&nbsp;<span class="op" id="4662704">*</span><span class="ident" id="4662705">parse</span><span class="op" id="4662710">.</span><span class="ident" id="4662711">ListNode</span><span class="op" id="4662719">)</span>&nbsp;<span class="op" id="4662721">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662724">defer</span>&nbsp;<span class="ident" id="4662730">s</span><span class="op" id="4662731">.</span><span class="ident" id="4662732">pop</span><span class="op" id="4662735">(</span><span class="ident" id="4662736">s</span><span class="op" id="4662737">.</span><span class="ident" id="4662738">mark</span><span class="op" id="4662742">(</span><span class="op" id="4662743">)</span><span class="op" id="4662744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662747">val</span>&nbsp;<span class="op" id="4662751">:=</span>&nbsp;<span class="ident" id="4662754">s</span><span class="op" id="4662755">.</span><span class="ident" id="4662756">evalPipeline</span><span class="op" id="4662768">(</span><span class="ident" id="4662769">dot</span><span class="op" id="4662772">,</span>&nbsp;<span class="ident" id="4662774">pipe</span><span class="op" id="4662778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662781">truth</span><span class="op" id="4662786">,</span>&nbsp;<span class="ident" id="4662788">ok</span>&nbsp;<span class="op" id="4662791">:=</span>&nbsp;<span class="ident" id="4662794">isTrue</span><span class="op" id="4662800">(</span><span class="ident" id="4662801">val</span><span class="op" id="4662804">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662807">if</span>&nbsp;<span class="op" id="4662810">!</span><span class="ident" id="4662811">ok</span>&nbsp;<span class="op" id="4662814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662818">s</span><span class="op" id="4662819">.</span><span class="ident" id="4662820">errorf</span><span class="op" id="4662826">(</span><span class="string" id="4662827">&#34;if/with&nbsp;can&#39;t&nbsp;use&nbsp;%v&#34;</span><span class="op" id="4662849">,</span>&nbsp;<span class="ident" id="4662851">val</span><span class="op" id="4662854">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662860">if</span>&nbsp;<span class="ident" id="4662863">truth</span>&nbsp;<span class="op" id="4662869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4662873">if</span>&nbsp;<span class="ident" id="4662876">typ</span>&nbsp;<span class="op" id="4662880">==</span>&nbsp;<span class="ident" id="4662883">parse</span><span class="op" id="4662888">.</span><span class="ident" id="4662889">NodeWith</span>&nbsp;<span class="op" id="4662898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662903">s</span><span class="op" id="4662904">.</span><span class="ident" id="4662905">walk</span><span class="op" id="4662909">(</span><span class="ident" id="4662910">val</span><span class="op" id="4662913">,</span>&nbsp;<span class="ident" id="4662915">list</span><span class="op" id="4662919">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662923">}</span>&nbsp;<span class="keyword" id="4662925">else</span>&nbsp;<span class="op" id="4662930">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662935">s</span><span class="op" id="4662936">.</span><span class="ident" id="4662937">walk</span><span class="op" id="4662941">(</span><span class="ident" id="4662942">dot</span><span class="op" id="4662945">,</span>&nbsp;<span class="ident" id="4662947">list</span><span class="op" id="4662951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4662958">}</span>&nbsp;<span class="keyword" id="4662960">else</span>&nbsp;<span class="keyword" id="4662965">if</span>&nbsp;<span class="ident" id="4662968">elseList</span>&nbsp;<span class="op" id="4662977">!=</span>&nbsp;<span class="ident" id="4662980">nil</span>&nbsp;<span class="op" id="4662984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4662988">s</span><span class="op" id="4662989">.</span><span class="ident" id="4662990">walk</span><span class="op" id="4662994">(</span><span class="ident" id="4662995">dot</span><span class="op" id="4662998">,</span>&nbsp;<span class="ident" id="4663000">elseList</span><span class="op" id="4663008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4663011">}</span><br>
<span class="lineno">210</span><span class="op" id="4663013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4663016">//&nbsp;isTrue&nbsp;reports&nbsp;whether&nbsp;the&nbsp;value&nbsp;is&nbsp;&#39;true&#39;,&nbsp;in&nbsp;the&nbsp;sense&nbsp;of&nbsp;not&nbsp;the&nbsp;zero&nbsp;of&nbsp;its&nbsp;type,</span><br>
<span class="lineno"></span><span class="comment" id="4663105">//&nbsp;and&nbsp;whether&nbsp;the&nbsp;value&nbsp;has&nbsp;a&nbsp;meaningful&nbsp;truth&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="4663160">func</span>&nbsp;<span class="ident" id="4663165">isTrue</span><span class="op" id="4663171">(</span><span class="ident" id="4663172">val</span>&nbsp;<span class="ident" id="4663176">reflect</span><span class="op" id="4663183">.</span><span class="ident" id="4663184">Value</span><span class="op" id="4663189">)</span>&nbsp;<span class="op" id="4663191">(</span><span class="ident" id="4663192">truth</span><span class="op" id="4663197">,</span>&nbsp;<span class="ident" id="4663199">ok</span>&nbsp;<span class="builtintype" id="4663202">bool</span><span class="op" id="4663206">)</span>&nbsp;<span class="op" id="4663208">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4663211">if</span>&nbsp;<span class="op" id="4663214">!</span><span class="ident" id="4663215">val</span><span class="op" id="4663218">.</span><span class="ident" id="4663219">IsValid</span><span class="op" id="4663226">(</span><span class="op" id="4663227">)</span>&nbsp;<span class="op" id="4663229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4663233">//&nbsp;Something&nbsp;like&nbsp;var&nbsp;x&nbsp;interface{},&nbsp;never&nbsp;set.&nbsp;It&#39;s&nbsp;a&nbsp;form&nbsp;of&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4663303">return</span>&nbsp;<span class="ident" id="4663310">false</span><span class="op" id="4663315">,</span>&nbsp;<span class="ident" id="4663317">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4663323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4663326">switch</span>&nbsp;<span class="ident" id="4663333">val</span><span class="op" id="4663336">.</span><span class="ident" id="4663337">Kind</span><span class="op" id="4663341">(</span><span class="op" id="4663342">)</span>&nbsp;<span class="op" id="4663344">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4663347">case</span>&nbsp;<span class="ident" id="4663352">reflect</span><span class="op" id="4663359">.</span><span class="ident" id="4663360">Array</span><span class="op" id="4663365">,</span>&nbsp;<span class="ident" id="4663367">reflect</span><span class="op" id="4663374">.</span><span class="ident" id="4663375">Map</span><span class="op" id="4663378">,</span>&nbsp;<span class="ident" id="4663380">reflect</span><span class="op" id="4663387">.</span><span class="ident" id="4663388">Slice</span><span class="op" id="4663393">,</span>&nbsp;<span class="ident" id="4663395">reflect</span><span class="op" id="4663402">.</span><span class="ident" id="4663403">String</span><span class="op" id="4663409">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663413">truth</span>&nbsp;<span class="op" id="4663419">=</span>&nbsp;<span class="ident" id="4663421">val</span><span class="op" id="4663424">.</span><span class="ident" id="4663425">Len</span><span class="op" id="4663428">(</span><span class="op" id="4663429">)</span>&nbsp;<span class="op" id="4663431">&gt;</span>&nbsp;<span class="num" id="4663433">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4663436">case</span>&nbsp;<span class="ident" id="4663441">reflect</span><span class="op" id="4663448">.</span><span class="ident" id="4663449">Bool</span><span class="op" id="4663453">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663457">truth</span>&nbsp;<span class="op" id="4663463">=</span>&nbsp;<span class="ident" id="4663465">val</span><span class="op" id="4663468">.</span><span class="ident" id="4663469">Bool</span><span class="op" id="4663473">(</span><span class="op" id="4663474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4663477">case</span>&nbsp;<span class="ident" id="4663482">reflect</span><span class="op" id="4663489">.</span><span class="ident" id="4663490">Complex64</span><span class="op" id="4663499">,</span>&nbsp;<span class="ident" id="4663501">reflect</span><span class="op" id="4663508">.</span><span class="ident" id="4663509">Complex128</span><span class="op" id="4663519">:</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663523">truth</span>&nbsp;<span class="op" id="4663529">=</span>&nbsp;<span class="ident" id="4663531">val</span><span class="op" id="4663534">.</span><span class="ident" id="4663535">Complex</span><span class="op" id="4663542">(</span><span class="op" id="4663543">)</span>&nbsp;<span class="op" id="4663545">!=</span>&nbsp;<span class="num" id="4663548">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4663551">case</span>&nbsp;<span class="ident" id="4663556">reflect</span><span class="op" id="4663563">.</span><span class="ident" id="4663564">Chan</span><span class="op" id="4663568">,</span>&nbsp;<span class="ident" id="4663570">reflect</span><span class="op" id="4663577">.</span><span class="ident" id="4663578">Func</span><span class="op" id="4663582">,</span>&nbsp;<span class="ident" id="4663584">reflect</span><span class="op" id="4663591">.</span><span class="ident" id="4663592">Ptr</span><span class="op" id="4663595">,</span>&nbsp;<span class="ident" id="4663597">reflect</span><span class="op" id="4663604">.</span><span class="ident" id="4663605">Interface</span><span class="op" id="4663614">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663618">truth</span>&nbsp;<span class="op" id="4663624">=</span>&nbsp;<span class="op" id="4663626">!</span><span class="ident" id="4663627">val</span><span class="op" id="4663630">.</span><span class="ident" id="4663631">IsNil</span><span class="op" id="4663636">(</span><span class="op" id="4663637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4663640">case</span>&nbsp;<span class="ident" id="4663645">reflect</span><span class="op" id="4663652">.</span><span class="ident" id="4663653">Int</span><span class="op" id="4663656">,</span>&nbsp;<span class="ident" id="4663658">reflect</span><span class="op" id="4663665">.</span><span class="ident" id="4663666">Int8</span><span class="op" id="4663670">,</span>&nbsp;<span class="ident" id="4663672">reflect</span><span class="op" id="4663679">.</span><span class="ident" id="4663680">Int16</span><span class="op" id="4663685">,</span>&nbsp;<span class="ident" id="4663687">reflect</span><span class="op" id="4663694">.</span><span class="ident" id="4663695">Int32</span><span class="op" id="4663700">,</span>&nbsp;<span class="ident" id="4663702">reflect</span><span class="op" id="4663709">.</span><span class="ident" id="4663710">Int64</span><span class="op" id="4663715">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663719">truth</span>&nbsp;<span class="op" id="4663725">=</span>&nbsp;<span class="ident" id="4663727">val</span><span class="op" id="4663730">.</span><span class="ident" id="4663731">Int</span><span class="op" id="4663734">(</span><span class="op" id="4663735">)</span>&nbsp;<span class="op" id="4663737">!=</span>&nbsp;<span class="num" id="4663740">0</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4663743">case</span>&nbsp;<span class="ident" id="4663748">reflect</span><span class="op" id="4663755">.</span><span class="ident" id="4663756">Float32</span><span class="op" id="4663763">,</span>&nbsp;<span class="ident" id="4663765">reflect</span><span class="op" id="4663772">.</span><span class="ident" id="4663773">Float64</span><span class="op" id="4663780">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663784">truth</span>&nbsp;<span class="op" id="4663790">=</span>&nbsp;<span class="ident" id="4663792">val</span><span class="op" id="4663795">.</span><span class="ident" id="4663796">Float</span><span class="op" id="4663801">(</span><span class="op" id="4663802">)</span>&nbsp;<span class="op" id="4663804">!=</span>&nbsp;<span class="num" id="4663807">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4663810">case</span>&nbsp;<span class="ident" id="4663815">reflect</span><span class="op" id="4663822">.</span><span class="ident" id="4663823">Uint</span><span class="op" id="4663827">,</span>&nbsp;<span class="ident" id="4663829">reflect</span><span class="op" id="4663836">.</span><span class="ident" id="4663837">Uint8</span><span class="op" id="4663842">,</span>&nbsp;<span class="ident" id="4663844">reflect</span><span class="op" id="4663851">.</span><span class="ident" id="4663852">Uint16</span><span class="op" id="4663858">,</span>&nbsp;<span class="ident" id="4663860">reflect</span><span class="op" id="4663867">.</span><span class="ident" id="4663868">Uint32</span><span class="op" id="4663874">,</span>&nbsp;<span class="ident" id="4663876">reflect</span><span class="op" id="4663883">.</span><span class="ident" id="4663884">Uint64</span><span class="op" id="4663890">,</span>&nbsp;<span class="ident" id="4663892">reflect</span><span class="op" id="4663899">.</span><span class="ident" id="4663900">Uintptr</span><span class="op" id="4663907">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663911">truth</span>&nbsp;<span class="op" id="4663917">=</span>&nbsp;<span class="ident" id="4663919">val</span><span class="op" id="4663922">.</span><span class="ident" id="4663923">Uint</span><span class="op" id="4663927">(</span><span class="op" id="4663928">)</span>&nbsp;<span class="op" id="4663930">!=</span>&nbsp;<span class="num" id="4663933">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4663936">case</span>&nbsp;<span class="ident" id="4663941">reflect</span><span class="op" id="4663948">.</span><span class="ident" id="4663949">Struct</span><span class="op" id="4663955">:</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4663959">truth</span>&nbsp;<span class="op" id="4663965">=</span>&nbsp;<span class="ident" id="4663967">true</span>&nbsp;<span class="comment" id="4663972">//&nbsp;Struct&nbsp;values&nbsp;are&nbsp;always&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664007">default</span><span class="op" id="4664014">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664018">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4664026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664029">return</span>&nbsp;<span class="ident" id="4664036">truth</span><span class="op" id="4664041">,</span>&nbsp;<span class="ident" id="4664043">true</span><br>
<span class="lineno">240</span><span class="op" id="4664048">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4664051">func</span>&nbsp;<span class="op" id="4664056">(</span><span class="ident" id="4664057">s</span>&nbsp;<span class="op" id="4664059">*</span><span class="ident" id="4664060">state</span><span class="op" id="4664065">)</span>&nbsp;<span class="ident" id="4664067">walkRange</span><span class="op" id="4664076">(</span><span class="ident" id="4664077">dot</span>&nbsp;<span class="ident" id="4664081">reflect</span><span class="op" id="4664088">.</span><span class="ident" id="4664089">Value</span><span class="op" id="4664094">,</span>&nbsp;<span class="ident" id="4664096">r</span>&nbsp;<span class="op" id="4664098">*</span><span class="ident" id="4664099">parse</span><span class="op" id="4664104">.</span><span class="ident" id="4664105">RangeNode</span><span class="op" id="4664114">)</span>&nbsp;<span class="op" id="4664116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664119">s</span><span class="op" id="4664120">.</span><span class="ident" id="4664121">at</span><span class="op" id="4664123">(</span><span class="ident" id="4664124">r</span><span class="op" id="4664125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664128">defer</span>&nbsp;<span class="ident" id="4664134">s</span><span class="op" id="4664135">.</span><span class="ident" id="4664136">pop</span><span class="op" id="4664139">(</span><span class="ident" id="4664140">s</span><span class="op" id="4664141">.</span><span class="ident" id="4664142">mark</span><span class="op" id="4664146">(</span><span class="op" id="4664147">)</span><span class="op" id="4664148">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664151">val</span><span class="op" id="4664154">,</span>&nbsp;<span class="ident" id="4664156">_</span>&nbsp;<span class="op" id="4664158">:=</span>&nbsp;<span class="ident" id="4664161">indirect</span><span class="op" id="4664169">(</span><span class="ident" id="4664170">s</span><span class="op" id="4664171">.</span><span class="ident" id="4664172">evalPipeline</span><span class="op" id="4664184">(</span><span class="ident" id="4664185">dot</span><span class="op" id="4664188">,</span>&nbsp;<span class="ident" id="4664190">r</span><span class="op" id="4664191">.</span><span class="ident" id="4664192">Pipe</span><span class="op" id="4664196">)</span><span class="op" id="4664197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4664200">//&nbsp;mark&nbsp;top&nbsp;of&nbsp;stack&nbsp;before&nbsp;any&nbsp;variables&nbsp;in&nbsp;the&nbsp;body&nbsp;are&nbsp;pushed.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664267">mark</span>&nbsp;<span class="op" id="4664272">:=</span>&nbsp;<span class="ident" id="4664275">s</span><span class="op" id="4664276">.</span><span class="ident" id="4664277">mark</span><span class="op" id="4664281">(</span><span class="op" id="4664282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664285">oneIteration</span>&nbsp;<span class="op" id="4664298">:=</span>&nbsp;<span class="keyword" id="4664301">func</span><span class="op" id="4664305">(</span><span class="ident" id="4664306">index</span><span class="op" id="4664311">,</span>&nbsp;<span class="ident" id="4664313">elem</span>&nbsp;<span class="ident" id="4664318">reflect</span><span class="op" id="4664325">.</span><span class="ident" id="4664326">Value</span><span class="op" id="4664331">)</span>&nbsp;<span class="op" id="4664333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4664337">//&nbsp;Set&nbsp;top&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;second&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;element.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664410">if</span>&nbsp;<span class="builtinfunc" id="4664413">len</span><span class="op" id="4664416">(</span><span class="ident" id="4664417">r</span><span class="op" id="4664418">.</span><span class="ident" id="4664419">Pipe</span><span class="op" id="4664423">.</span><span class="ident" id="4664424">Decl</span><span class="op" id="4664428">)</span>&nbsp;<span class="op" id="4664430">&gt;</span>&nbsp;<span class="num" id="4664432">0</span>&nbsp;<span class="op" id="4664434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664439">s</span><span class="op" id="4664440">.</span><span class="ident" id="4664441">setVar</span><span class="op" id="4664447">(</span><span class="num" id="4664448">1</span><span class="op" id="4664449">,</span>&nbsp;<span class="ident" id="4664451">elem</span><span class="op" id="4664455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4664459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4664463">//&nbsp;Set&nbsp;next&nbsp;var&nbsp;(lexically&nbsp;the&nbsp;first&nbsp;if&nbsp;there&nbsp;are&nbsp;two)&nbsp;to&nbsp;the&nbsp;index.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664534">if</span>&nbsp;<span class="builtinfunc" id="4664537">len</span><span class="op" id="4664540">(</span><span class="ident" id="4664541">r</span><span class="op" id="4664542">.</span><span class="ident" id="4664543">Pipe</span><span class="op" id="4664547">.</span><span class="ident" id="4664548">Decl</span><span class="op" id="4664552">)</span>&nbsp;<span class="op" id="4664554">&gt;</span>&nbsp;<span class="num" id="4664556">1</span>&nbsp;<span class="op" id="4664558">{</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664563">s</span><span class="op" id="4664564">.</span><span class="ident" id="4664565">setVar</span><span class="op" id="4664571">(</span><span class="num" id="4664572">2</span><span class="op" id="4664573">,</span>&nbsp;<span class="ident" id="4664575">index</span><span class="op" id="4664580">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4664584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664588">s</span><span class="op" id="4664589">.</span><span class="ident" id="4664590">walk</span><span class="op" id="4664594">(</span><span class="ident" id="4664595">elem</span><span class="op" id="4664599">,</span>&nbsp;<span class="ident" id="4664601">r</span><span class="op" id="4664602">.</span><span class="ident" id="4664603">List</span><span class="op" id="4664607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664611">s</span><span class="op" id="4664612">.</span><span class="ident" id="4664613">pop</span><span class="op" id="4664616">(</span><span class="ident" id="4664617">mark</span><span class="op" id="4664621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4664624">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664627">switch</span>&nbsp;<span class="ident" id="4664634">val</span><span class="op" id="4664637">.</span><span class="ident" id="4664638">Kind</span><span class="op" id="4664642">(</span><span class="op" id="4664643">)</span>&nbsp;<span class="op" id="4664645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664648">case</span>&nbsp;<span class="ident" id="4664653">reflect</span><span class="op" id="4664660">.</span><span class="ident" id="4664661">Array</span><span class="op" id="4664666">,</span>&nbsp;<span class="ident" id="4664668">reflect</span><span class="op" id="4664675">.</span><span class="ident" id="4664676">Slice</span><span class="op" id="4664681">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664685">if</span>&nbsp;<span class="ident" id="4664688">val</span><span class="op" id="4664691">.</span><span class="ident" id="4664692">Len</span><span class="op" id="4664695">(</span><span class="op" id="4664696">)</span>&nbsp;<span class="op" id="4664698">==</span>&nbsp;<span class="num" id="4664701">0</span>&nbsp;<span class="op" id="4664703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664708">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4664716">}</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664720">for</span>&nbsp;<span class="ident" id="4664724">i</span>&nbsp;<span class="op" id="4664726">:=</span>&nbsp;<span class="num" id="4664729">0</span><span class="op" id="4664730">;</span>&nbsp;<span class="ident" id="4664732">i</span>&nbsp;<span class="op" id="4664734">&lt;</span>&nbsp;<span class="ident" id="4664736">val</span><span class="op" id="4664739">.</span><span class="ident" id="4664740">Len</span><span class="op" id="4664743">(</span><span class="op" id="4664744">)</span><span class="op" id="4664745">;</span>&nbsp;<span class="ident" id="4664747">i</span><span class="op" id="4664748">++</span>&nbsp;<span class="op" id="4664751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664756">oneIteration</span><span class="op" id="4664768">(</span><span class="ident" id="4664769">reflect</span><span class="op" id="4664776">.</span><span class="ident" id="4664777">ValueOf</span><span class="op" id="4664784">(</span><span class="ident" id="4664785">i</span><span class="op" id="4664786">)</span><span class="op" id="4664787">,</span>&nbsp;<span class="ident" id="4664789">val</span><span class="op" id="4664792">.</span><span class="ident" id="4664793">Index</span><span class="op" id="4664798">(</span><span class="ident" id="4664799">i</span><span class="op" id="4664800">)</span><span class="op" id="4664801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4664805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664809">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664817">case</span>&nbsp;<span class="ident" id="4664822">reflect</span><span class="op" id="4664829">.</span><span class="ident" id="4664830">Map</span><span class="op" id="4664833">:</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664837">if</span>&nbsp;<span class="ident" id="4664840">val</span><span class="op" id="4664843">.</span><span class="ident" id="4664844">Len</span><span class="op" id="4664847">(</span><span class="op" id="4664848">)</span>&nbsp;<span class="op" id="4664850">==</span>&nbsp;<span class="num" id="4664853">0</span>&nbsp;<span class="op" id="4664855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664860">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4664868">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664872">for</span>&nbsp;<span class="ident" id="4664876">_</span><span class="op" id="4664877">,</span>&nbsp;<span class="ident" id="4664879">key</span>&nbsp;<span class="op" id="4664883">:=</span>&nbsp;<span class="keyword" id="4664886">range</span>&nbsp;<span class="ident" id="4664892">sortKeys</span><span class="op" id="4664900">(</span><span class="ident" id="4664901">val</span><span class="op" id="4664904">.</span><span class="ident" id="4664905">MapKeys</span><span class="op" id="4664912">(</span><span class="op" id="4664913">)</span><span class="op" id="4664914">)</span>&nbsp;<span class="op" id="4664916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4664921">oneIteration</span><span class="op" id="4664933">(</span><span class="ident" id="4664934">key</span><span class="op" id="4664937">,</span>&nbsp;<span class="ident" id="4664939">val</span><span class="op" id="4664942">.</span><span class="ident" id="4664943">MapIndex</span><span class="op" id="4664951">(</span><span class="ident" id="4664952">key</span><span class="op" id="4664955">)</span><span class="op" id="4664956">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4664960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664964">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664972">case</span>&nbsp;<span class="ident" id="4664977">reflect</span><span class="op" id="4664984">.</span><span class="ident" id="4664985">Chan</span><span class="op" id="4664989">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4664993">if</span>&nbsp;<span class="ident" id="4664996">val</span><span class="op" id="4664999">.</span><span class="ident" id="4665000">IsNil</span><span class="op" id="4665005">(</span><span class="op" id="4665006">)</span>&nbsp;<span class="op" id="4665008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665013">break</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4665021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665025">i</span>&nbsp;<span class="op" id="4665027">:=</span>&nbsp;<span class="num" id="4665030">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665034">for</span>&nbsp;<span class="op" id="4665038">;</span>&nbsp;<span class="op" id="4665040">;</span>&nbsp;<span class="ident" id="4665042">i</span><span class="op" id="4665043">++</span>&nbsp;<span class="op" id="4665046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665051">elem</span><span class="op" id="4665055">,</span>&nbsp;<span class="ident" id="4665057">ok</span>&nbsp;<span class="op" id="4665060">:=</span>&nbsp;<span class="ident" id="4665063">val</span><span class="op" id="4665066">.</span><span class="ident" id="4665067">Recv</span><span class="op" id="4665071">(</span><span class="op" id="4665072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665077">if</span>&nbsp;<span class="op" id="4665080">!</span><span class="ident" id="4665081">ok</span>&nbsp;<span class="op" id="4665084">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665090">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4665099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665104">oneIteration</span><span class="op" id="4665116">(</span><span class="ident" id="4665117">reflect</span><span class="op" id="4665124">.</span><span class="ident" id="4665125">ValueOf</span><span class="op" id="4665132">(</span><span class="ident" id="4665133">i</span><span class="op" id="4665134">)</span><span class="op" id="4665135">,</span>&nbsp;<span class="ident" id="4665137">elem</span><span class="op" id="4665141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4665145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665149">if</span>&nbsp;<span class="ident" id="4665152">i</span>&nbsp;<span class="op" id="4665154">==</span>&nbsp;<span class="num" id="4665157">0</span>&nbsp;<span class="op" id="4665159">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665164">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4665172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665176">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665184">case</span>&nbsp;<span class="ident" id="4665189">reflect</span><span class="op" id="4665196">.</span><span class="ident" id="4665197">Invalid</span><span class="op" id="4665204">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665208">break</span>&nbsp;<span class="comment" id="4665214">//&nbsp;An&nbsp;invalid&nbsp;value&nbsp;is&nbsp;likely&nbsp;a&nbsp;nil&nbsp;map,&nbsp;etc.&nbsp;and&nbsp;acts&nbsp;like&nbsp;an&nbsp;empty&nbsp;map.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665289">default</span><span class="op" id="4665296">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665300">s</span><span class="op" id="4665301">.</span><span class="ident" id="4665302">errorf</span><span class="op" id="4665308">(</span><span class="string" id="4665309">&#34;range&nbsp;can&#39;t&nbsp;iterate&nbsp;over&nbsp;%v&#34;</span><span class="op" id="4665338">,</span>&nbsp;<span class="ident" id="4665340">val</span><span class="op" id="4665343">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4665346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665349">if</span>&nbsp;<span class="ident" id="4665352">r</span><span class="op" id="4665353">.</span><span class="ident" id="4665354">ElseList</span>&nbsp;<span class="op" id="4665363">!=</span>&nbsp;<span class="ident" id="4665366">nil</span>&nbsp;<span class="op" id="4665370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665374">s</span><span class="op" id="4665375">.</span><span class="ident" id="4665376">walk</span><span class="op" id="4665380">(</span><span class="ident" id="4665381">dot</span><span class="op" id="4665384">,</span>&nbsp;<span class="ident" id="4665386">r</span><span class="op" id="4665387">.</span><span class="ident" id="4665388">ElseList</span><span class="op" id="4665396">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4665399">}</span><br>
<span class="lineno"></span><span class="op" id="4665401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4665404">func</span>&nbsp;<span class="op" id="4665409">(</span><span class="ident" id="4665410">s</span>&nbsp;<span class="op" id="4665412">*</span><span class="ident" id="4665413">state</span><span class="op" id="4665418">)</span>&nbsp;<span class="ident" id="4665420">walkTemplate</span><span class="op" id="4665432">(</span><span class="ident" id="4665433">dot</span>&nbsp;<span class="ident" id="4665437">reflect</span><span class="op" id="4665444">.</span><span class="ident" id="4665445">Value</span><span class="op" id="4665450">,</span>&nbsp;<span class="ident" id="4665452">t</span>&nbsp;<span class="op" id="4665454">*</span><span class="ident" id="4665455">parse</span><span class="op" id="4665460">.</span><span class="ident" id="4665461">TemplateNode</span><span class="op" id="4665473">)</span>&nbsp;<span class="op" id="4665475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665478">s</span><span class="op" id="4665479">.</span><span class="ident" id="4665480">at</span><span class="op" id="4665482">(</span><span class="ident" id="4665483">t</span><span class="op" id="4665484">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665487">tmpl</span>&nbsp;<span class="op" id="4665492">:=</span>&nbsp;<span class="ident" id="4665495">s</span><span class="op" id="4665496">.</span><span class="ident" id="4665497">tmpl</span><span class="op" id="4665501">.</span><span class="ident" id="4665502">tmpl</span><span class="op" id="4665506">[</span><span class="ident" id="4665507">t</span><span class="op" id="4665508">.</span><span class="ident" id="4665509">Name</span><span class="op" id="4665513">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4665516">if</span>&nbsp;<span class="ident" id="4665519">tmpl</span>&nbsp;<span class="op" id="4665524">==</span>&nbsp;<span class="ident" id="4665527">nil</span>&nbsp;<span class="op" id="4665531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665535">s</span><span class="op" id="4665536">.</span><span class="ident" id="4665537">errorf</span><span class="op" id="4665543">(</span><span class="string" id="4665544">&#34;template&nbsp;%q&nbsp;not&nbsp;defined&#34;</span><span class="op" id="4665569">,</span>&nbsp;<span class="ident" id="4665571">t</span><span class="op" id="4665572">.</span><span class="ident" id="4665573">Name</span><span class="op" id="4665577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4665580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4665583">//&nbsp;Variables&nbsp;declared&nbsp;by&nbsp;the&nbsp;pipeline&nbsp;persist.</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665631">dot</span>&nbsp;<span class="op" id="4665635">=</span>&nbsp;<span class="ident" id="4665637">s</span><span class="op" id="4665638">.</span><span class="ident" id="4665639">evalPipeline</span><span class="op" id="4665651">(</span><span class="ident" id="4665652">dot</span><span class="op" id="4665655">,</span>&nbsp;<span class="ident" id="4665657">t</span><span class="op" id="4665658">.</span><span class="ident" id="4665659">Pipe</span><span class="op" id="4665663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665666">newState</span>&nbsp;<span class="op" id="4665675">:=</span>&nbsp;<span class="op" id="4665678">*</span><span class="ident" id="4665679">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665682">newState</span><span class="op" id="4665690">.</span><span class="ident" id="4665691">tmpl</span>&nbsp;<span class="op" id="4665696">=</span>&nbsp;<span class="ident" id="4665698">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4665704">//&nbsp;No&nbsp;dynamic&nbsp;scoping:&nbsp;template&nbsp;invocations&nbsp;inherit&nbsp;no&nbsp;variables.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665771">newState</span><span class="op" id="4665779">.</span><span class="ident" id="4665780">vars</span>&nbsp;<span class="op" id="4665785">=</span>&nbsp;<span class="op" id="4665787">[</span><span class="op" id="4665788">]</span><span class="ident" id="4665789">variable</span><span class="op" id="4665797">{</span><span class="op" id="4665798">{</span><span class="string" id="4665799">&#34;$&#34;</span><span class="op" id="4665802">,</span>&nbsp;<span class="ident" id="4665804">dot</span><span class="op" id="4665807">}</span><span class="op" id="4665808">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4665811">newState</span><span class="op" id="4665819">.</span><span class="ident" id="4665820">walk</span><span class="op" id="4665824">(</span><span class="ident" id="4665825">dot</span><span class="op" id="4665828">,</span>&nbsp;<span class="ident" id="4665830">tmpl</span><span class="op" id="4665834">.</span><span class="ident" id="4665835">Root</span><span class="op" id="4665839">)</span><br>
<span class="lineno"></span><span class="op" id="4665841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4665844">//&nbsp;Eval&nbsp;functions&nbsp;evaluate&nbsp;pipelines,&nbsp;commands,&nbsp;and&nbsp;their&nbsp;elements&nbsp;and&nbsp;extract</span><br>
<span class="lineno"></span><span class="comment" id="4665923">//&nbsp;values&nbsp;from&nbsp;the&nbsp;data&nbsp;structure&nbsp;by&nbsp;examining&nbsp;fields,&nbsp;calling&nbsp;methods,&nbsp;and&nbsp;so&nbsp;on.</span><br>
<span class="lineno">320</span><span class="comment" id="4666006">//&nbsp;The&nbsp;printing&nbsp;of&nbsp;those&nbsp;values&nbsp;happens&nbsp;only&nbsp;through&nbsp;walk&nbsp;functions.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4666076">//&nbsp;evalPipeline&nbsp;returns&nbsp;the&nbsp;value&nbsp;acquired&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;pipeline.&nbsp;If&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4666152">//&nbsp;pipeline&nbsp;has&nbsp;a&nbsp;variable&nbsp;declaration,&nbsp;the&nbsp;variable&nbsp;will&nbsp;be&nbsp;pushed&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4666227">//&nbsp;stack.&nbsp;Callers&nbsp;should&nbsp;therefore&nbsp;pop&nbsp;the&nbsp;stack&nbsp;after&nbsp;they&nbsp;are&nbsp;finished</span><br>
<span class="lineno">325</span><span class="comment" id="4666300">//&nbsp;executing&nbsp;commands&nbsp;depending&nbsp;on&nbsp;the&nbsp;pipeline&nbsp;value.</span><br>
<span class="lineno"></span><span class="keyword" id="4666355">func</span>&nbsp;<span class="op" id="4666360">(</span><span class="ident" id="4666361">s</span>&nbsp;<span class="op" id="4666363">*</span><span class="ident" id="4666364">state</span><span class="op" id="4666369">)</span>&nbsp;<span class="ident" id="4666371">evalPipeline</span><span class="op" id="4666383">(</span><span class="ident" id="4666384">dot</span>&nbsp;<span class="ident" id="4666388">reflect</span><span class="op" id="4666395">.</span><span class="ident" id="4666396">Value</span><span class="op" id="4666401">,</span>&nbsp;<span class="ident" id="4666403">pipe</span>&nbsp;<span class="op" id="4666408">*</span><span class="ident" id="4666409">parse</span><span class="op" id="4666414">.</span><span class="ident" id="4666415">PipeNode</span><span class="op" id="4666423">)</span>&nbsp;<span class="op" id="4666425">(</span><span class="ident" id="4666426">value</span>&nbsp;<span class="ident" id="4666432">reflect</span><span class="op" id="4666439">.</span><span class="ident" id="4666440">Value</span><span class="op" id="4666445">)</span>&nbsp;<span class="op" id="4666447">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666450">if</span>&nbsp;<span class="ident" id="4666453">pipe</span>&nbsp;<span class="op" id="4666458">==</span>&nbsp;<span class="ident" id="4666461">nil</span>&nbsp;<span class="op" id="4666465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666469">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4666477">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4666480">s</span><span class="op" id="4666481">.</span><span class="ident" id="4666482">at</span><span class="op" id="4666484">(</span><span class="ident" id="4666485">pipe</span><span class="op" id="4666489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666492">for</span>&nbsp;<span class="ident" id="4666496">_</span><span class="op" id="4666497">,</span>&nbsp;<span class="ident" id="4666499">cmd</span>&nbsp;<span class="op" id="4666503">:=</span>&nbsp;<span class="keyword" id="4666506">range</span>&nbsp;<span class="ident" id="4666512">pipe</span><span class="op" id="4666516">.</span><span class="ident" id="4666517">Cmds</span>&nbsp;<span class="op" id="4666522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4666526">value</span>&nbsp;<span class="op" id="4666532">=</span>&nbsp;<span class="ident" id="4666534">s</span><span class="op" id="4666535">.</span><span class="ident" id="4666536">evalCommand</span><span class="op" id="4666547">(</span><span class="ident" id="4666548">dot</span><span class="op" id="4666551">,</span>&nbsp;<span class="ident" id="4666553">cmd</span><span class="op" id="4666556">,</span>&nbsp;<span class="ident" id="4666558">value</span><span class="op" id="4666563">)</span>&nbsp;<span class="comment" id="4666565">//&nbsp;previous&nbsp;value&nbsp;is&nbsp;this&nbsp;one&#39;s&nbsp;final&nbsp;arg.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4666610">//&nbsp;If&nbsp;the&nbsp;object&nbsp;has&nbsp;type&nbsp;interface{},&nbsp;dig&nbsp;down&nbsp;one&nbsp;level&nbsp;to&nbsp;the&nbsp;thing&nbsp;inside.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666691">if</span>&nbsp;<span class="ident" id="4666694">value</span><span class="op" id="4666699">.</span><span class="ident" id="4666700">Kind</span><span class="op" id="4666704">(</span><span class="op" id="4666705">)</span>&nbsp;<span class="op" id="4666707">==</span>&nbsp;<span class="ident" id="4666710">reflect</span><span class="op" id="4666717">.</span><span class="ident" id="4666718">Interface</span>&nbsp;<span class="op" id="4666728">&amp;&amp;</span>&nbsp;<span class="ident" id="4666731">value</span><span class="op" id="4666736">.</span><span class="ident" id="4666737">Type</span><span class="op" id="4666741">(</span><span class="op" id="4666742">)</span><span class="op" id="4666743">.</span><span class="ident" id="4666744">NumMethod</span><span class="op" id="4666753">(</span><span class="op" id="4666754">)</span>&nbsp;<span class="op" id="4666756">==</span>&nbsp;<span class="num" id="4666759">0</span>&nbsp;<span class="op" id="4666761">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4666766">value</span>&nbsp;<span class="op" id="4666772">=</span>&nbsp;<span class="ident" id="4666774">reflect</span><span class="op" id="4666781">.</span><span class="ident" id="4666782">ValueOf</span><span class="op" id="4666789">(</span><span class="ident" id="4666790">value</span><span class="op" id="4666795">.</span><span class="ident" id="4666796">Interface</span><span class="op" id="4666805">(</span><span class="op" id="4666806">)</span><span class="op" id="4666807">)</span>&nbsp;<span class="comment" id="4666809">//&nbsp;lovely!</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4666822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4666825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666828">for</span>&nbsp;<span class="ident" id="4666832">_</span><span class="op" id="4666833">,</span>&nbsp;<span class="ident" id="4666835">variable</span>&nbsp;<span class="op" id="4666844">:=</span>&nbsp;<span class="keyword" id="4666847">range</span>&nbsp;<span class="ident" id="4666853">pipe</span><span class="op" id="4666857">.</span><span class="ident" id="4666858">Decl</span>&nbsp;<span class="op" id="4666863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4666867">s</span><span class="op" id="4666868">.</span><span class="ident" id="4666869">push</span><span class="op" id="4666873">(</span><span class="ident" id="4666874">variable</span><span class="op" id="4666882">.</span><span class="ident" id="4666883">Ident</span><span class="op" id="4666888">[</span><span class="num" id="4666889">0</span><span class="op" id="4666890">]</span><span class="op" id="4666891">,</span>&nbsp;<span class="ident" id="4666893">value</span><span class="op" id="4666898">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4666901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666904">return</span>&nbsp;<span class="ident" id="4666911">value</span><br>
<span class="lineno"></span><span class="op" id="4666917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4666920">func</span>&nbsp;<span class="op" id="4666925">(</span><span class="ident" id="4666926">s</span>&nbsp;<span class="op" id="4666928">*</span><span class="ident" id="4666929">state</span><span class="op" id="4666934">)</span>&nbsp;<span class="ident" id="4666936">notAFunction</span><span class="op" id="4666948">(</span><span class="ident" id="4666949">args</span>&nbsp;<span class="op" id="4666954">[</span><span class="op" id="4666955">]</span><span class="ident" id="4666956">parse</span><span class="op" id="4666961">.</span><span class="ident" id="4666962">Node</span><span class="op" id="4666966">,</span>&nbsp;<span class="ident" id="4666968">final</span>&nbsp;<span class="ident" id="4666974">reflect</span><span class="op" id="4666981">.</span><span class="ident" id="4666982">Value</span><span class="op" id="4666987">)</span>&nbsp;<span class="op" id="4666989">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4666992">if</span>&nbsp;<span class="builtinfunc" id="4666995">len</span><span class="op" id="4666998">(</span><span class="ident" id="4666999">args</span><span class="op" id="4667003">)</span>&nbsp;<span class="op" id="4667005">&gt;</span>&nbsp;<span class="num" id="4667007">1</span>&nbsp;<span class="op" id="4667009">||</span>&nbsp;<span class="ident" id="4667012">final</span><span class="op" id="4667017">.</span><span class="ident" id="4667018">IsValid</span><span class="op" id="4667025">(</span><span class="op" id="4667026">)</span>&nbsp;<span class="op" id="4667028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667032">s</span><span class="op" id="4667033">.</span><span class="ident" id="4667034">errorf</span><span class="op" id="4667040">(</span><span class="string" id="4667041">&#34;can&#39;t&nbsp;give&nbsp;argument&nbsp;to&nbsp;non-function&nbsp;%s&#34;</span><span class="op" id="4667081">,</span>&nbsp;<span class="ident" id="4667083">args</span><span class="op" id="4667087">[</span><span class="num" id="4667088">0</span><span class="op" id="4667089">]</span><span class="op" id="4667090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4667093">}</span><br>
<span class="lineno"></span><span class="op" id="4667095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="4667098">func</span>&nbsp;<span class="op" id="4667103">(</span><span class="ident" id="4667104">s</span>&nbsp;<span class="op" id="4667106">*</span><span class="ident" id="4667107">state</span><span class="op" id="4667112">)</span>&nbsp;<span class="ident" id="4667114">evalCommand</span><span class="op" id="4667125">(</span><span class="ident" id="4667126">dot</span>&nbsp;<span class="ident" id="4667130">reflect</span><span class="op" id="4667137">.</span><span class="ident" id="4667138">Value</span><span class="op" id="4667143">,</span>&nbsp;<span class="ident" id="4667145">cmd</span>&nbsp;<span class="op" id="4667149">*</span><span class="ident" id="4667150">parse</span><span class="op" id="4667155">.</span><span class="ident" id="4667156">CommandNode</span><span class="op" id="4667167">,</span>&nbsp;<span class="ident" id="4667169">final</span>&nbsp;<span class="ident" id="4667175">reflect</span><span class="op" id="4667182">.</span><span class="ident" id="4667183">Value</span><span class="op" id="4667188">)</span>&nbsp;<span class="ident" id="4667190">reflect</span><span class="op" id="4667197">.</span><span class="ident" id="4667198">Value</span>&nbsp;<span class="op" id="4667204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667207">firstWord</span>&nbsp;<span class="op" id="4667217">:=</span>&nbsp;<span class="ident" id="4667220">cmd</span><span class="op" id="4667223">.</span><span class="ident" id="4667224">Args</span><span class="op" id="4667228">[</span><span class="num" id="4667229">0</span><span class="op" id="4667230">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667233">switch</span>&nbsp;<span class="ident" id="4667240">n</span>&nbsp;<span class="op" id="4667242">:=</span>&nbsp;<span class="ident" id="4667245">firstWord</span><span class="op" id="4667254">.</span><span class="op" id="4667255">(</span><span class="keyword" id="4667256">type</span><span class="op" id="4667260">)</span>&nbsp;<span class="op" id="4667262">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667265">case</span>&nbsp;<span class="op" id="4667270">*</span><span class="ident" id="4667271">parse</span><span class="op" id="4667276">.</span><span class="ident" id="4667277">FieldNode</span><span class="op" id="4667286">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667290">return</span>&nbsp;<span class="ident" id="4667297">s</span><span class="op" id="4667298">.</span><span class="ident" id="4667299">evalFieldNode</span><span class="op" id="4667312">(</span><span class="ident" id="4667313">dot</span><span class="op" id="4667316">,</span>&nbsp;<span class="ident" id="4667318">n</span><span class="op" id="4667319">,</span>&nbsp;<span class="ident" id="4667321">cmd</span><span class="op" id="4667324">.</span><span class="ident" id="4667325">Args</span><span class="op" id="4667329">,</span>&nbsp;<span class="ident" id="4667331">final</span><span class="op" id="4667336">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667339">case</span>&nbsp;<span class="op" id="4667344">*</span><span class="ident" id="4667345">parse</span><span class="op" id="4667350">.</span><span class="ident" id="4667351">ChainNode</span><span class="op" id="4667360">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667364">return</span>&nbsp;<span class="ident" id="4667371">s</span><span class="op" id="4667372">.</span><span class="ident" id="4667373">evalChainNode</span><span class="op" id="4667386">(</span><span class="ident" id="4667387">dot</span><span class="op" id="4667390">,</span>&nbsp;<span class="ident" id="4667392">n</span><span class="op" id="4667393">,</span>&nbsp;<span class="ident" id="4667395">cmd</span><span class="op" id="4667398">.</span><span class="ident" id="4667399">Args</span><span class="op" id="4667403">,</span>&nbsp;<span class="ident" id="4667405">final</span><span class="op" id="4667410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667413">case</span>&nbsp;<span class="op" id="4667418">*</span><span class="ident" id="4667419">parse</span><span class="op" id="4667424">.</span><span class="ident" id="4667425">IdentifierNode</span><span class="op" id="4667439">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4667443">//&nbsp;Must&nbsp;be&nbsp;a&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667468">return</span>&nbsp;<span class="ident" id="4667475">s</span><span class="op" id="4667476">.</span><span class="ident" id="4667477">evalFunction</span><span class="op" id="4667489">(</span><span class="ident" id="4667490">dot</span><span class="op" id="4667493">,</span>&nbsp;<span class="ident" id="4667495">n</span><span class="op" id="4667496">,</span>&nbsp;<span class="ident" id="4667498">cmd</span><span class="op" id="4667501">,</span>&nbsp;<span class="ident" id="4667503">cmd</span><span class="op" id="4667506">.</span><span class="ident" id="4667507">Args</span><span class="op" id="4667511">,</span>&nbsp;<span class="ident" id="4667513">final</span><span class="op" id="4667518">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667521">case</span>&nbsp;<span class="op" id="4667526">*</span><span class="ident" id="4667527">parse</span><span class="op" id="4667532">.</span><span class="ident" id="4667533">PipeNode</span><span class="op" id="4667541">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4667545">//&nbsp;Parenthesized&nbsp;pipeline.&nbsp;The&nbsp;arguments&nbsp;are&nbsp;all&nbsp;inside&nbsp;the&nbsp;pipeline;&nbsp;final&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667635">return</span>&nbsp;<span class="ident" id="4667642">s</span><span class="op" id="4667643">.</span><span class="ident" id="4667644">evalPipeline</span><span class="op" id="4667656">(</span><span class="ident" id="4667657">dot</span><span class="op" id="4667660">,</span>&nbsp;<span class="ident" id="4667662">n</span><span class="op" id="4667663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667666">case</span>&nbsp;<span class="op" id="4667671">*</span><span class="ident" id="4667672">parse</span><span class="op" id="4667677">.</span><span class="ident" id="4667678">VariableNode</span><span class="op" id="4667690">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667694">return</span>&nbsp;<span class="ident" id="4667701">s</span><span class="op" id="4667702">.</span><span class="ident" id="4667703">evalVariableNode</span><span class="op" id="4667719">(</span><span class="ident" id="4667720">dot</span><span class="op" id="4667723">,</span>&nbsp;<span class="ident" id="4667725">n</span><span class="op" id="4667726">,</span>&nbsp;<span class="ident" id="4667728">cmd</span><span class="op" id="4667731">.</span><span class="ident" id="4667732">Args</span><span class="op" id="4667736">,</span>&nbsp;<span class="ident" id="4667738">final</span><span class="op" id="4667743">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4667746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667749">s</span><span class="op" id="4667750">.</span><span class="ident" id="4667751">at</span><span class="op" id="4667753">(</span><span class="ident" id="4667754">firstWord</span><span class="op" id="4667763">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667766">s</span><span class="op" id="4667767">.</span><span class="ident" id="4667768">notAFunction</span><span class="op" id="4667780">(</span><span class="ident" id="4667781">cmd</span><span class="op" id="4667784">.</span><span class="ident" id="4667785">Args</span><span class="op" id="4667789">,</span>&nbsp;<span class="ident" id="4667791">final</span><span class="op" id="4667796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667799">switch</span>&nbsp;<span class="ident" id="4667806">word</span>&nbsp;<span class="op" id="4667811">:=</span>&nbsp;<span class="ident" id="4667814">firstWord</span><span class="op" id="4667823">.</span><span class="op" id="4667824">(</span><span class="keyword" id="4667825">type</span><span class="op" id="4667829">)</span>&nbsp;<span class="op" id="4667831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667834">case</span>&nbsp;<span class="op" id="4667839">*</span><span class="ident" id="4667840">parse</span><span class="op" id="4667845">.</span><span class="ident" id="4667846">BoolNode</span><span class="op" id="4667854">:</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667858">return</span>&nbsp;<span class="ident" id="4667865">reflect</span><span class="op" id="4667872">.</span><span class="ident" id="4667873">ValueOf</span><span class="op" id="4667880">(</span><span class="ident" id="4667881">word</span><span class="op" id="4667885">.</span><span class="ident" id="4667886">True</span><span class="op" id="4667890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667893">case</span>&nbsp;<span class="op" id="4667898">*</span><span class="ident" id="4667899">parse</span><span class="op" id="4667904">.</span><span class="ident" id="4667905">DotNode</span><span class="op" id="4667912">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667916">return</span>&nbsp;<span class="ident" id="4667923">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667928">case</span>&nbsp;<span class="op" id="4667933">*</span><span class="ident" id="4667934">parse</span><span class="op" id="4667939">.</span><span class="ident" id="4667940">NilNode</span><span class="op" id="4667947">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4667951">s</span><span class="op" id="4667952">.</span><span class="ident" id="4667953">errorf</span><span class="op" id="4667959">(</span><span class="string" id="4667960">&#34;nil&nbsp;is&nbsp;not&nbsp;a&nbsp;command&#34;</span><span class="op" id="4667982">)</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4667985">case</span>&nbsp;<span class="op" id="4667990">*</span><span class="ident" id="4667991">parse</span><span class="op" id="4667996">.</span><span class="ident" id="4667997">NumberNode</span><span class="op" id="4668007">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668011">return</span>&nbsp;<span class="ident" id="4668018">s</span><span class="op" id="4668019">.</span><span class="ident" id="4668020">idealConstant</span><span class="op" id="4668033">(</span><span class="ident" id="4668034">word</span><span class="op" id="4668038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668041">case</span>&nbsp;<span class="op" id="4668046">*</span><span class="ident" id="4668047">parse</span><span class="op" id="4668052">.</span><span class="ident" id="4668053">StringNode</span><span class="op" id="4668063">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668067">return</span>&nbsp;<span class="ident" id="4668074">reflect</span><span class="op" id="4668081">.</span><span class="ident" id="4668082">ValueOf</span><span class="op" id="4668089">(</span><span class="ident" id="4668090">word</span><span class="op" id="4668094">.</span><span class="ident" id="4668095">Text</span><span class="op" id="4668099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4668102">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4668105">s</span><span class="op" id="4668106">.</span><span class="ident" id="4668107">errorf</span><span class="op" id="4668113">(</span><span class="string" id="4668114">&#34;can&#39;t&nbsp;evaluate&nbsp;command&nbsp;%q&#34;</span><span class="op" id="4668141">,</span>&nbsp;<span class="ident" id="4668143">firstWord</span><span class="op" id="4668152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4668155">panic</span><span class="op" id="4668160">(</span><span class="string" id="4668161">&#34;not&nbsp;reached&#34;</span><span class="op" id="4668174">)</span><br>
<span class="lineno"></span><span class="op" id="4668176">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4668179">//&nbsp;idealConstant&nbsp;is&nbsp;called&nbsp;to&nbsp;return&nbsp;the&nbsp;value&nbsp;of&nbsp;a&nbsp;number&nbsp;in&nbsp;a&nbsp;context&nbsp;where</span><br>
<span class="lineno">385</span><span class="comment" id="4668257">//&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type.&nbsp;In&nbsp;that&nbsp;case,&nbsp;the&nbsp;syntax&nbsp;of&nbsp;the&nbsp;number&nbsp;tells&nbsp;us</span><br>
<span class="lineno"></span><span class="comment" id="4668332">//&nbsp;its&nbsp;type,&nbsp;and&nbsp;we&nbsp;use&nbsp;Go&nbsp;rules&nbsp;to&nbsp;resolve.&nbsp;&nbsp;Note&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;thing&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4668409">//&nbsp;a&nbsp;uint&nbsp;ideal&nbsp;constant&nbsp;in&nbsp;this&nbsp;situation&nbsp;-&nbsp;the&nbsp;value&nbsp;must&nbsp;be&nbsp;of&nbsp;int&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4668485">func</span>&nbsp;<span class="op" id="4668490">(</span><span class="ident" id="4668491">s</span>&nbsp;<span class="op" id="4668493">*</span><span class="ident" id="4668494">state</span><span class="op" id="4668499">)</span>&nbsp;<span class="ident" id="4668501">idealConstant</span><span class="op" id="4668514">(</span><span class="ident" id="4668515">constant</span>&nbsp;<span class="op" id="4668524">*</span><span class="ident" id="4668525">parse</span><span class="op" id="4668530">.</span><span class="ident" id="4668531">NumberNode</span><span class="op" id="4668541">)</span>&nbsp;<span class="ident" id="4668543">reflect</span><span class="op" id="4668550">.</span><span class="ident" id="4668551">Value</span>&nbsp;<span class="op" id="4668557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4668560">//&nbsp;These&nbsp;are&nbsp;ideal&nbsp;constants&nbsp;but&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;the&nbsp;type</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4668617">//&nbsp;and&nbsp;we&nbsp;have&nbsp;no&nbsp;context.&nbsp;&nbsp;(If&nbsp;it&nbsp;was&nbsp;a&nbsp;method&nbsp;argument,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4668676">//&nbsp;we&#39;d&nbsp;know&nbsp;what&nbsp;we&nbsp;need.)&nbsp;The&nbsp;syntax&nbsp;guides&nbsp;us&nbsp;to&nbsp;some&nbsp;extent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4668742">s</span><span class="op" id="4668743">.</span><span class="ident" id="4668744">at</span><span class="op" id="4668746">(</span><span class="ident" id="4668747">constant</span><span class="op" id="4668755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668758">switch</span>&nbsp;<span class="op" id="4668765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668768">case</span>&nbsp;<span class="ident" id="4668773">constant</span><span class="op" id="4668781">.</span><span class="ident" id="4668782">IsComplex</span><span class="op" id="4668791">:</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668795">return</span>&nbsp;<span class="ident" id="4668802">reflect</span><span class="op" id="4668809">.</span><span class="ident" id="4668810">ValueOf</span><span class="op" id="4668817">(</span><span class="ident" id="4668818">constant</span><span class="op" id="4668826">.</span><span class="ident" id="4668827">Complex128</span><span class="op" id="4668837">)</span>&nbsp;<span class="comment" id="4668839">//&nbsp;incontrovertible.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668861">case</span>&nbsp;<span class="ident" id="4668866">constant</span><span class="op" id="4668874">.</span><span class="ident" id="4668875">IsFloat</span>&nbsp;<span class="op" id="4668883">&amp;&amp;</span>&nbsp;<span class="op" id="4668886">!</span><span class="ident" id="4668887">isHexConstant</span><span class="op" id="4668900">(</span><span class="ident" id="4668901">constant</span><span class="op" id="4668909">.</span><span class="ident" id="4668910">Text</span><span class="op" id="4668914">)</span>&nbsp;<span class="op" id="4668916">&amp;&amp;</span>&nbsp;<span class="ident" id="4668919">strings</span><span class="op" id="4668926">.</span><span class="ident" id="4668927">IndexAny</span><span class="op" id="4668935">(</span><span class="ident" id="4668936">constant</span><span class="op" id="4668944">.</span><span class="ident" id="4668945">Text</span><span class="op" id="4668949">,</span>&nbsp;<span class="string" id="4668951">&#34;.eE&#34;</span><span class="op" id="4668956">)</span>&nbsp;<span class="op" id="4668958">&gt;=</span>&nbsp;<span class="num" id="4668961">0</span><span class="op" id="4668962">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4668966">return</span>&nbsp;<span class="ident" id="4668973">reflect</span><span class="op" id="4668980">.</span><span class="ident" id="4668981">ValueOf</span><span class="op" id="4668988">(</span><span class="ident" id="4668989">constant</span><span class="op" id="4668997">.</span><span class="ident" id="4668998">Float64</span><span class="op" id="4669005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669008">case</span>&nbsp;<span class="ident" id="4669013">constant</span><span class="op" id="4669021">.</span><span class="ident" id="4669022">IsInt</span><span class="op" id="4669027">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669031">n</span>&nbsp;<span class="op" id="4669033">:=</span>&nbsp;<span class="builtintype" id="4669036">int</span><span class="op" id="4669039">(</span><span class="ident" id="4669040">constant</span><span class="op" id="4669048">.</span><span class="ident" id="4669049">Int64</span><span class="op" id="4669054">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669058">if</span>&nbsp;<span class="ident" id="4669061">int64</span><span class="op" id="4669066">(</span><span class="ident" id="4669067">n</span><span class="op" id="4669068">)</span>&nbsp;<span class="op" id="4669070">!=</span>&nbsp;<span class="ident" id="4669073">constant</span><span class="op" id="4669081">.</span><span class="ident" id="4669082">Int64</span>&nbsp;<span class="op" id="4669088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669093">s</span><span class="op" id="4669094">.</span><span class="ident" id="4669095">errorf</span><span class="op" id="4669101">(</span><span class="string" id="4669102">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="4669120">,</span>&nbsp;<span class="ident" id="4669122">constant</span><span class="op" id="4669130">.</span><span class="ident" id="4669131">Text</span><span class="op" id="4669135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4669139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669143">return</span>&nbsp;<span class="ident" id="4669150">reflect</span><span class="op" id="4669157">.</span><span class="ident" id="4669158">ValueOf</span><span class="op" id="4669165">(</span><span class="ident" id="4669166">n</span><span class="op" id="4669167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669170">case</span>&nbsp;<span class="ident" id="4669175">constant</span><span class="op" id="4669183">.</span><span class="ident" id="4669184">IsUint</span><span class="op" id="4669190">:</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669194">s</span><span class="op" id="4669195">.</span><span class="ident" id="4669196">errorf</span><span class="op" id="4669202">(</span><span class="string" id="4669203">&#34;%s&nbsp;overflows&nbsp;int&#34;</span><span class="op" id="4669221">,</span>&nbsp;<span class="ident" id="4669223">constant</span><span class="op" id="4669231">.</span><span class="ident" id="4669232">Text</span><span class="op" id="4669236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4669239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669242">return</span>&nbsp;<span class="ident" id="4669249">zero</span><br>
<span class="lineno"></span><span class="op" id="4669254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span><span class="keyword" id="4669257">func</span>&nbsp;<span class="ident" id="4669262">isHexConstant</span><span class="op" id="4669275">(</span><span class="ident" id="4669276">s</span>&nbsp;<span class="builtintype" id="4669278">string</span><span class="op" id="4669284">)</span>&nbsp;<span class="builtintype" id="4669286">bool</span>&nbsp;<span class="op" id="4669291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669294">return</span>&nbsp;<span class="builtinfunc" id="4669301">len</span><span class="op" id="4669304">(</span><span class="ident" id="4669305">s</span><span class="op" id="4669306">)</span>&nbsp;<span class="op" id="4669308">&gt;</span>&nbsp;<span class="num" id="4669310">2</span>&nbsp;<span class="op" id="4669312">&amp;&amp;</span>&nbsp;<span class="ident" id="4669315">s</span><span class="op" id="4669316">[</span><span class="num" id="4669317">0</span><span class="op" id="4669318">]</span>&nbsp;<span class="op" id="4669320">==</span>&nbsp;<span class="string" id="4669323">&#39;0&#39;</span>&nbsp;<span class="op" id="4669327">&amp;&amp;</span>&nbsp;<span class="op" id="4669330">(</span><span class="ident" id="4669331">s</span><span class="op" id="4669332">[</span><span class="num" id="4669333">1</span><span class="op" id="4669334">]</span>&nbsp;<span class="op" id="4669336">==</span>&nbsp;<span class="string" id="4669339">&#39;x&#39;</span>&nbsp;<span class="op" id="4669343">||</span>&nbsp;<span class="ident" id="4669346">s</span><span class="op" id="4669347">[</span><span class="num" id="4669348">1</span><span class="op" id="4669349">]</span>&nbsp;<span class="op" id="4669351">==</span>&nbsp;<span class="string" id="4669354">&#39;X&#39;</span><span class="op" id="4669357">)</span><br>
<span class="lineno"></span><span class="op" id="4669359">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4669362">func</span>&nbsp;<span class="op" id="4669367">(</span><span class="ident" id="4669368">s</span>&nbsp;<span class="op" id="4669370">*</span><span class="ident" id="4669371">state</span><span class="op" id="4669376">)</span>&nbsp;<span class="ident" id="4669378">evalFieldNode</span><span class="op" id="4669391">(</span><span class="ident" id="4669392">dot</span>&nbsp;<span class="ident" id="4669396">reflect</span><span class="op" id="4669403">.</span><span class="ident" id="4669404">Value</span><span class="op" id="4669409">,</span>&nbsp;<span class="ident" id="4669411">field</span>&nbsp;<span class="op" id="4669417">*</span><span class="ident" id="4669418">parse</span><span class="op" id="4669423">.</span><span class="ident" id="4669424">FieldNode</span><span class="op" id="4669433">,</span>&nbsp;<span class="ident" id="4669435">args</span>&nbsp;<span class="op" id="4669440">[</span><span class="op" id="4669441">]</span><span class="ident" id="4669442">parse</span><span class="op" id="4669447">.</span><span class="ident" id="4669448">Node</span><span class="op" id="4669452">,</span>&nbsp;<span class="ident" id="4669454">final</span>&nbsp;<span class="ident" id="4669460">reflect</span><span class="op" id="4669467">.</span><span class="ident" id="4669468">Value</span><span class="op" id="4669473">)</span>&nbsp;<span class="ident" id="4669475">reflect</span><span class="op" id="4669482">.</span><span class="ident" id="4669483">Value</span>&nbsp;<span class="op" id="4669489">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669492">s</span><span class="op" id="4669493">.</span><span class="ident" id="4669494">at</span><span class="op" id="4669496">(</span><span class="ident" id="4669497">field</span><span class="op" id="4669502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669505">return</span>&nbsp;<span class="ident" id="4669512">s</span><span class="op" id="4669513">.</span><span class="ident" id="4669514">evalFieldChain</span><span class="op" id="4669528">(</span><span class="ident" id="4669529">dot</span><span class="op" id="4669532">,</span>&nbsp;<span class="ident" id="4669534">dot</span><span class="op" id="4669537">,</span>&nbsp;<span class="ident" id="4669539">field</span><span class="op" id="4669544">,</span>&nbsp;<span class="ident" id="4669546">field</span><span class="op" id="4669551">.</span><span class="ident" id="4669552">Ident</span><span class="op" id="4669557">,</span>&nbsp;<span class="ident" id="4669559">args</span><span class="op" id="4669563">,</span>&nbsp;<span class="ident" id="4669565">final</span><span class="op" id="4669570">)</span><br>
<span class="lineno"></span><span class="op" id="4669572">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4669575">func</span>&nbsp;<span class="op" id="4669580">(</span><span class="ident" id="4669581">s</span>&nbsp;<span class="op" id="4669583">*</span><span class="ident" id="4669584">state</span><span class="op" id="4669589">)</span>&nbsp;<span class="ident" id="4669591">evalChainNode</span><span class="op" id="4669604">(</span><span class="ident" id="4669605">dot</span>&nbsp;<span class="ident" id="4669609">reflect</span><span class="op" id="4669616">.</span><span class="ident" id="4669617">Value</span><span class="op" id="4669622">,</span>&nbsp;<span class="ident" id="4669624">chain</span>&nbsp;<span class="op" id="4669630">*</span><span class="ident" id="4669631">parse</span><span class="op" id="4669636">.</span><span class="ident" id="4669637">ChainNode</span><span class="op" id="4669646">,</span>&nbsp;<span class="ident" id="4669648">args</span>&nbsp;<span class="op" id="4669653">[</span><span class="op" id="4669654">]</span><span class="ident" id="4669655">parse</span><span class="op" id="4669660">.</span><span class="ident" id="4669661">Node</span><span class="op" id="4669665">,</span>&nbsp;<span class="ident" id="4669667">final</span>&nbsp;<span class="ident" id="4669673">reflect</span><span class="op" id="4669680">.</span><span class="ident" id="4669681">Value</span><span class="op" id="4669686">)</span>&nbsp;<span class="ident" id="4669688">reflect</span><span class="op" id="4669695">.</span><span class="ident" id="4669696">Value</span>&nbsp;<span class="op" id="4669702">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669705">s</span><span class="op" id="4669706">.</span><span class="ident" id="4669707">at</span><span class="op" id="4669709">(</span><span class="ident" id="4669710">chain</span><span class="op" id="4669715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4669718">//&nbsp;(pipe).Field1.Field2&nbsp;has&nbsp;pipe&nbsp;as&nbsp;.Node,&nbsp;fields&nbsp;as&nbsp;.Field.&nbsp;Eval&nbsp;the&nbsp;pipeline,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669816">pipe</span>&nbsp;<span class="op" id="4669821">:=</span>&nbsp;<span class="ident" id="4669824">s</span><span class="op" id="4669825">.</span><span class="ident" id="4669826">evalArg</span><span class="op" id="4669833">(</span><span class="ident" id="4669834">dot</span><span class="op" id="4669837">,</span>&nbsp;<span class="ident" id="4669839">nil</span><span class="op" id="4669842">,</span>&nbsp;<span class="ident" id="4669844">chain</span><span class="op" id="4669849">.</span><span class="ident" id="4669850">Node</span><span class="op" id="4669854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669857">if</span>&nbsp;<span class="builtinfunc" id="4669860">len</span><span class="op" id="4669863">(</span><span class="ident" id="4669864">chain</span><span class="op" id="4669869">.</span><span class="ident" id="4669870">Field</span><span class="op" id="4669875">)</span>&nbsp;<span class="op" id="4669877">==</span>&nbsp;<span class="num" id="4669880">0</span>&nbsp;<span class="op" id="4669882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4669886">s</span><span class="op" id="4669887">.</span><span class="ident" id="4669888">errorf</span><span class="op" id="4669894">(</span><span class="string" id="4669895">&#34;internal&nbsp;error:&nbsp;no&nbsp;fields&nbsp;in&nbsp;evalChainNode&#34;</span><span class="op" id="4669939">)</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4669942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4669945">return</span>&nbsp;<span class="ident" id="4669952">s</span><span class="op" id="4669953">.</span><span class="ident" id="4669954">evalFieldChain</span><span class="op" id="4669968">(</span><span class="ident" id="4669969">dot</span><span class="op" id="4669972">,</span>&nbsp;<span class="ident" id="4669974">pipe</span><span class="op" id="4669978">,</span>&nbsp;<span class="ident" id="4669980">chain</span><span class="op" id="4669985">,</span>&nbsp;<span class="ident" id="4669987">chain</span><span class="op" id="4669992">.</span><span class="ident" id="4669993">Field</span><span class="op" id="4669998">,</span>&nbsp;<span class="ident" id="4670000">args</span><span class="op" id="4670004">,</span>&nbsp;<span class="ident" id="4670006">final</span><span class="op" id="4670011">)</span><br>
<span class="lineno"></span><span class="op" id="4670013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4670016">func</span>&nbsp;<span class="op" id="4670021">(</span><span class="ident" id="4670022">s</span>&nbsp;<span class="op" id="4670024">*</span><span class="ident" id="4670025">state</span><span class="op" id="4670030">)</span>&nbsp;<span class="ident" id="4670032">evalVariableNode</span><span class="op" id="4670048">(</span><span class="ident" id="4670049">dot</span>&nbsp;<span class="ident" id="4670053">reflect</span><span class="op" id="4670060">.</span><span class="ident" id="4670061">Value</span><span class="op" id="4670066">,</span>&nbsp;<span class="ident" id="4670068">variable</span>&nbsp;<span class="op" id="4670077">*</span><span class="ident" id="4670078">parse</span><span class="op" id="4670083">.</span><span class="ident" id="4670084">VariableNode</span><span class="op" id="4670096">,</span>&nbsp;<span class="ident" id="4670098">args</span>&nbsp;<span class="op" id="4670103">[</span><span class="op" id="4670104">]</span><span class="ident" id="4670105">parse</span><span class="op" id="4670110">.</span><span class="ident" id="4670111">Node</span><span class="op" id="4670115">,</span>&nbsp;<span class="ident" id="4670117">final</span>&nbsp;<span class="ident" id="4670123">reflect</span><span class="op" id="4670130">.</span><span class="ident" id="4670131">Value</span><span class="op" id="4670136">)</span>&nbsp;<span class="ident" id="4670138">reflect</span><span class="op" id="4670145">.</span><span class="ident" id="4670146">Value</span>&nbsp;<span class="op" id="4670152">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4670155">//&nbsp;$x.Field&nbsp;has&nbsp;$x&nbsp;as&nbsp;the&nbsp;first&nbsp;ident,&nbsp;Field&nbsp;as&nbsp;the&nbsp;second.&nbsp;Eval&nbsp;the&nbsp;var,&nbsp;then&nbsp;the&nbsp;fields.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4670247">s</span><span class="op" id="4670248">.</span><span class="ident" id="4670249">at</span><span class="op" id="4670251">(</span><span class="ident" id="4670252">variable</span><span class="op" id="4670260">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4670263">value</span>&nbsp;<span class="op" id="4670269">:=</span>&nbsp;<span class="ident" id="4670272">s</span><span class="op" id="4670273">.</span><span class="ident" id="4670274">varValue</span><span class="op" id="4670282">(</span><span class="ident" id="4670283">variable</span><span class="op" id="4670291">.</span><span class="ident" id="4670292">Ident</span><span class="op" id="4670297">[</span><span class="num" id="4670298">0</span><span class="op" id="4670299">]</span><span class="op" id="4670300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4670303">if</span>&nbsp;<span class="builtinfunc" id="4670306">len</span><span class="op" id="4670309">(</span><span class="ident" id="4670310">variable</span><span class="op" id="4670318">.</span><span class="ident" id="4670319">Ident</span><span class="op" id="4670324">)</span>&nbsp;<span class="op" id="4670326">==</span>&nbsp;<span class="num" id="4670329">1</span>&nbsp;<span class="op" id="4670331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4670335">s</span><span class="op" id="4670336">.</span><span class="ident" id="4670337">notAFunction</span><span class="op" id="4670349">(</span><span class="ident" id="4670350">args</span><span class="op" id="4670354">,</span>&nbsp;<span class="ident" id="4670356">final</span><span class="op" id="4670361">)</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4670365">return</span>&nbsp;<span class="ident" id="4670372">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4670379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4670382">return</span>&nbsp;<span class="ident" id="4670389">s</span><span class="op" id="4670390">.</span><span class="ident" id="4670391">evalFieldChain</span><span class="op" id="4670405">(</span><span class="ident" id="4670406">dot</span><span class="op" id="4670409">,</span>&nbsp;<span class="ident" id="4670411">value</span><span class="op" id="4670416">,</span>&nbsp;<span class="ident" id="4670418">variable</span><span class="op" id="4670426">,</span>&nbsp;<span class="ident" id="4670428">variable</span><span class="op" id="4670436">.</span><span class="ident" id="4670437">Ident</span><span class="op" id="4670442">[</span><span class="num" id="4670443">1</span><span class="op" id="4670444">:</span><span class="op" id="4670445">]</span><span class="op" id="4670446">,</span>&nbsp;<span class="ident" id="4670448">args</span><span class="op" id="4670452">,</span>&nbsp;<span class="ident" id="4670454">final</span><span class="op" id="4670459">)</span><br>
<span class="lineno"></span><span class="op" id="4670461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">440</span><span class="comment" id="4670464">//&nbsp;evalFieldChain&nbsp;evaluates&nbsp;.X.Y.Z&nbsp;possibly&nbsp;followed&nbsp;by&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="4670531">//&nbsp;dot&nbsp;is&nbsp;the&nbsp;environment&nbsp;in&nbsp;which&nbsp;to&nbsp;evaluate&nbsp;arguments,&nbsp;while</span><br>
<span class="lineno"></span><span class="comment" id="4670595">//&nbsp;receiver&nbsp;is&nbsp;the&nbsp;value&nbsp;being&nbsp;walked&nbsp;along&nbsp;the&nbsp;chain.</span><br>
<span class="lineno"></span><span class="keyword" id="4670650">func</span>&nbsp;<span class="op" id="4670655">(</span><span class="ident" id="4670656">s</span>&nbsp;<span class="op" id="4670658">*</span><span class="ident" id="4670659">state</span><span class="op" id="4670664">)</span>&nbsp;<span class="ident" id="4670666">evalFieldChain</span><span class="op" id="4670680">(</span><span class="ident" id="4670681">dot</span><span class="op" id="4670684">,</span>&nbsp;<span class="ident" id="4670686">receiver</span>&nbsp;<span class="ident" id="4670695">reflect</span><span class="op" id="4670702">.</span><span class="ident" id="4670703">Value</span><span class="op" id="4670708">,</span>&nbsp;<span class="ident" id="4670710">node</span>&nbsp;<span class="ident" id="4670715">parse</span><span class="op" id="4670720">.</span><span class="ident" id="4670721">Node</span><span class="op" id="4670725">,</span>&nbsp;<span class="ident" id="4670727">ident</span>&nbsp;<span class="op" id="4670733">[</span><span class="op" id="4670734">]</span><span class="builtintype" id="4670735">string</span><span class="op" id="4670741">,</span>&nbsp;<span class="ident" id="4670743">args</span>&nbsp;<span class="op" id="4670748">[</span><span class="op" id="4670749">]</span><span class="ident" id="4670750">parse</span><span class="op" id="4670755">.</span><span class="ident" id="4670756">Node</span><span class="op" id="4670760">,</span>&nbsp;<span class="ident" id="4670762">final</span>&nbsp;<span class="ident" id="4670768">reflect</span><span class="op" id="4670775">.</span><span class="ident" id="4670776">Value</span><span class="op" id="4670781">)</span>&nbsp;<span class="ident" id="4670783">reflect</span><span class="op" id="4670790">.</span><span class="ident" id="4670791">Value</span>&nbsp;<span class="op" id="4670797">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4670800">n</span>&nbsp;<span class="op" id="4670802">:=</span>&nbsp;<span class="builtinfunc" id="4670805">len</span><span class="op" id="4670808">(</span><span class="ident" id="4670809">ident</span><span class="op" id="4670814">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4670817">for</span>&nbsp;<span class="ident" id="4670821">i</span>&nbsp;<span class="op" id="4670823">:=</span>&nbsp;<span class="num" id="4670826">0</span><span class="op" id="4670827">;</span>&nbsp;<span class="ident" id="4670829">i</span>&nbsp;<span class="op" id="4670831">&lt;</span>&nbsp;<span class="ident" id="4670833">n</span><span class="op" id="4670834">-</span><span class="num" id="4670835">1</span><span class="op" id="4670836">;</span>&nbsp;<span class="ident" id="4670838">i</span><span class="op" id="4670839">++</span>&nbsp;<span class="op" id="4670842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4670846">receiver</span>&nbsp;<span class="op" id="4670855">=</span>&nbsp;<span class="ident" id="4670857">s</span><span class="op" id="4670858">.</span><span class="ident" id="4670859">evalField</span><span class="op" id="4670868">(</span><span class="ident" id="4670869">dot</span><span class="op" id="4670872">,</span>&nbsp;<span class="ident" id="4670874">ident</span><span class="op" id="4670879">[</span><span class="ident" id="4670880">i</span><span class="op" id="4670881">]</span><span class="op" id="4670882">,</span>&nbsp;<span class="ident" id="4670884">node</span><span class="op" id="4670888">,</span>&nbsp;<span class="ident" id="4670890">nil</span><span class="op" id="4670893">,</span>&nbsp;<span class="ident" id="4670895">zero</span><span class="op" id="4670899">,</span>&nbsp;<span class="ident" id="4670901">receiver</span><span class="op" id="4670909">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4670912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4670915">//&nbsp;Now&nbsp;if&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;it&nbsp;gets&nbsp;the&nbsp;arguments.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4670964">return</span>&nbsp;<span class="ident" id="4670971">s</span><span class="op" id="4670972">.</span><span class="ident" id="4670973">evalField</span><span class="op" id="4670982">(</span><span class="ident" id="4670983">dot</span><span class="op" id="4670986">,</span>&nbsp;<span class="ident" id="4670988">ident</span><span class="op" id="4670993">[</span><span class="ident" id="4670994">n</span><span class="op" id="4670995">-</span><span class="num" id="4670996">1</span><span class="op" id="4670997">]</span><span class="op" id="4670998">,</span>&nbsp;<span class="ident" id="4671000">node</span><span class="op" id="4671004">,</span>&nbsp;<span class="ident" id="4671006">args</span><span class="op" id="4671010">,</span>&nbsp;<span class="ident" id="4671012">final</span><span class="op" id="4671017">,</span>&nbsp;<span class="ident" id="4671019">receiver</span><span class="op" id="4671027">)</span><br>
<span class="lineno">450</span><span class="op" id="4671029">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4671032">func</span>&nbsp;<span class="op" id="4671037">(</span><span class="ident" id="4671038">s</span>&nbsp;<span class="op" id="4671040">*</span><span class="ident" id="4671041">state</span><span class="op" id="4671046">)</span>&nbsp;<span class="ident" id="4671048">evalFunction</span><span class="op" id="4671060">(</span><span class="ident" id="4671061">dot</span>&nbsp;<span class="ident" id="4671065">reflect</span><span class="op" id="4671072">.</span><span class="ident" id="4671073">Value</span><span class="op" id="4671078">,</span>&nbsp;<span class="ident" id="4671080">node</span>&nbsp;<span class="op" id="4671085">*</span><span class="ident" id="4671086">parse</span><span class="op" id="4671091">.</span><span class="ident" id="4671092">IdentifierNode</span><span class="op" id="4671106">,</span>&nbsp;<span class="ident" id="4671108">cmd</span>&nbsp;<span class="ident" id="4671112">parse</span><span class="op" id="4671117">.</span><span class="ident" id="4671118">Node</span><span class="op" id="4671122">,</span>&nbsp;<span class="ident" id="4671124">args</span>&nbsp;<span class="op" id="4671129">[</span><span class="op" id="4671130">]</span><span class="ident" id="4671131">parse</span><span class="op" id="4671136">.</span><span class="ident" id="4671137">Node</span><span class="op" id="4671141">,</span>&nbsp;<span class="ident" id="4671143">final</span>&nbsp;<span class="ident" id="4671149">reflect</span><span class="op" id="4671156">.</span><span class="ident" id="4671157">Value</span><span class="op" id="4671162">)</span>&nbsp;<span class="ident" id="4671164">reflect</span><span class="op" id="4671171">.</span><span class="ident" id="4671172">Value</span>&nbsp;<span class="op" id="4671178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671181">s</span><span class="op" id="4671182">.</span><span class="ident" id="4671183">at</span><span class="op" id="4671185">(</span><span class="ident" id="4671186">node</span><span class="op" id="4671190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671193">name</span>&nbsp;<span class="op" id="4671198">:=</span>&nbsp;<span class="ident" id="4671201">node</span><span class="op" id="4671205">.</span><span class="ident" id="4671206">Ident</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671213">function</span><span class="op" id="4671221">,</span>&nbsp;<span class="ident" id="4671223">ok</span>&nbsp;<span class="op" id="4671226">:=</span>&nbsp;<span class="ident" id="4671229">findFunction</span><span class="op" id="4671241">(</span><span class="ident" id="4671242">name</span><span class="op" id="4671246">,</span>&nbsp;<span class="ident" id="4671248">s</span><span class="op" id="4671249">.</span><span class="ident" id="4671250">tmpl</span><span class="op" id="4671254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671257">if</span>&nbsp;<span class="op" id="4671260">!</span><span class="ident" id="4671261">ok</span>&nbsp;<span class="op" id="4671264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671268">s</span><span class="op" id="4671269">.</span><span class="ident" id="4671270">errorf</span><span class="op" id="4671276">(</span><span class="string" id="4671277">&#34;%q&nbsp;is&nbsp;not&nbsp;a&nbsp;defined&nbsp;function&#34;</span><span class="op" id="4671307">,</span>&nbsp;<span class="ident" id="4671309">name</span><span class="op" id="4671313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4671316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671319">return</span>&nbsp;<span class="ident" id="4671326">s</span><span class="op" id="4671327">.</span><span class="ident" id="4671328">evalCall</span><span class="op" id="4671336">(</span><span class="ident" id="4671337">dot</span><span class="op" id="4671340">,</span>&nbsp;<span class="ident" id="4671342">function</span><span class="op" id="4671350">,</span>&nbsp;<span class="ident" id="4671352">cmd</span><span class="op" id="4671355">,</span>&nbsp;<span class="ident" id="4671357">name</span><span class="op" id="4671361">,</span>&nbsp;<span class="ident" id="4671363">args</span><span class="op" id="4671367">,</span>&nbsp;<span class="ident" id="4671369">final</span><span class="op" id="4671374">)</span><br>
<span class="lineno">460</span><span class="op" id="4671376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4671379">//&nbsp;evalField&nbsp;evaluates&nbsp;an&nbsp;expression&nbsp;like&nbsp;(.Field)&nbsp;or&nbsp;(.Field&nbsp;arg1&nbsp;arg2).</span><br>
<span class="lineno"></span><span class="comment" id="4671453">//&nbsp;The&nbsp;&#39;final&#39;&nbsp;argument&nbsp;represents&nbsp;the&nbsp;return&nbsp;value&nbsp;from&nbsp;the&nbsp;preceding</span><br>
<span class="lineno"></span><span class="comment" id="4671524">//&nbsp;value&nbsp;of&nbsp;the&nbsp;pipeline,&nbsp;if&nbsp;any.</span><br>
<span class="lineno">465</span><span class="keyword" id="4671558">func</span>&nbsp;<span class="op" id="4671563">(</span><span class="ident" id="4671564">s</span>&nbsp;<span class="op" id="4671566">*</span><span class="ident" id="4671567">state</span><span class="op" id="4671572">)</span>&nbsp;<span class="ident" id="4671574">evalField</span><span class="op" id="4671583">(</span><span class="ident" id="4671584">dot</span>&nbsp;<span class="ident" id="4671588">reflect</span><span class="op" id="4671595">.</span><span class="ident" id="4671596">Value</span><span class="op" id="4671601">,</span>&nbsp;<span class="ident" id="4671603">fieldName</span>&nbsp;<span class="builtintype" id="4671613">string</span><span class="op" id="4671619">,</span>&nbsp;<span class="ident" id="4671621">node</span>&nbsp;<span class="ident" id="4671626">parse</span><span class="op" id="4671631">.</span><span class="ident" id="4671632">Node</span><span class="op" id="4671636">,</span>&nbsp;<span class="ident" id="4671638">args</span>&nbsp;<span class="op" id="4671643">[</span><span class="op" id="4671644">]</span><span class="ident" id="4671645">parse</span><span class="op" id="4671650">.</span><span class="ident" id="4671651">Node</span><span class="op" id="4671655">,</span>&nbsp;<span class="ident" id="4671657">final</span><span class="op" id="4671662">,</span>&nbsp;<span class="ident" id="4671664">receiver</span>&nbsp;<span class="ident" id="4671673">reflect</span><span class="op" id="4671680">.</span><span class="ident" id="4671681">Value</span><span class="op" id="4671686">)</span>&nbsp;<span class="ident" id="4671688">reflect</span><span class="op" id="4671695">.</span><span class="ident" id="4671696">Value</span>&nbsp;<span class="op" id="4671702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671705">if</span>&nbsp;<span class="op" id="4671708">!</span><span class="ident" id="4671709">receiver</span><span class="op" id="4671717">.</span><span class="ident" id="4671718">IsValid</span><span class="op" id="4671725">(</span><span class="op" id="4671726">)</span>&nbsp;<span class="op" id="4671728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671732">return</span>&nbsp;<span class="ident" id="4671739">zero</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4671745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671748">typ</span>&nbsp;<span class="op" id="4671752">:=</span>&nbsp;<span class="ident" id="4671755">receiver</span><span class="op" id="4671763">.</span><span class="ident" id="4671764">Type</span><span class="op" id="4671768">(</span><span class="op" id="4671769">)</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671772">receiver</span><span class="op" id="4671780">,</span>&nbsp;<span class="ident" id="4671782">_</span>&nbsp;<span class="op" id="4671784">=</span>&nbsp;<span class="ident" id="4671786">indirect</span><span class="op" id="4671794">(</span><span class="ident" id="4671795">receiver</span><span class="op" id="4671803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4671806">//&nbsp;Unless&nbsp;it&#39;s&nbsp;an&nbsp;interface,&nbsp;need&nbsp;to&nbsp;get&nbsp;to&nbsp;a&nbsp;value&nbsp;of&nbsp;type&nbsp;*T&nbsp;to&nbsp;guarantee</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4671883">//&nbsp;we&nbsp;see&nbsp;all&nbsp;methods&nbsp;of&nbsp;T&nbsp;and&nbsp;*T.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671919">ptr</span>&nbsp;<span class="op" id="4671923">:=</span>&nbsp;<span class="ident" id="4671926">receiver</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4671936">if</span>&nbsp;<span class="ident" id="4671939">ptr</span><span class="op" id="4671942">.</span><span class="ident" id="4671943">Kind</span><span class="op" id="4671947">(</span><span class="op" id="4671948">)</span>&nbsp;<span class="op" id="4671950">!=</span>&nbsp;<span class="ident" id="4671953">reflect</span><span class="op" id="4671960">.</span><span class="ident" id="4671961">Interface</span>&nbsp;<span class="op" id="4671971">&amp;&amp;</span>&nbsp;<span class="ident" id="4671974">ptr</span><span class="op" id="4671977">.</span><span class="ident" id="4671978">CanAddr</span><span class="op" id="4671985">(</span><span class="op" id="4671986">)</span>&nbsp;<span class="op" id="4671988">{</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4671992">ptr</span>&nbsp;<span class="op" id="4671996">=</span>&nbsp;<span class="ident" id="4671998">ptr</span><span class="op" id="4672001">.</span><span class="ident" id="4672002">Addr</span><span class="op" id="4672006">(</span><span class="op" id="4672007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672013">if</span>&nbsp;<span class="ident" id="4672016">method</span>&nbsp;<span class="op" id="4672023">:=</span>&nbsp;<span class="ident" id="4672026">ptr</span><span class="op" id="4672029">.</span><span class="ident" id="4672030">MethodByName</span><span class="op" id="4672042">(</span><span class="ident" id="4672043">fieldName</span><span class="op" id="4672052">)</span><span class="op" id="4672053">;</span>&nbsp;<span class="ident" id="4672055">method</span><span class="op" id="4672061">.</span><span class="ident" id="4672062">IsValid</span><span class="op" id="4672069">(</span><span class="op" id="4672070">)</span>&nbsp;<span class="op" id="4672072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672076">return</span>&nbsp;<span class="ident" id="4672083">s</span><span class="op" id="4672084">.</span><span class="ident" id="4672085">evalCall</span><span class="op" id="4672093">(</span><span class="ident" id="4672094">dot</span><span class="op" id="4672097">,</span>&nbsp;<span class="ident" id="4672099">method</span><span class="op" id="4672105">,</span>&nbsp;<span class="ident" id="4672107">node</span><span class="op" id="4672111">,</span>&nbsp;<span class="ident" id="4672113">fieldName</span><span class="op" id="4672122">,</span>&nbsp;<span class="ident" id="4672124">args</span><span class="op" id="4672128">,</span>&nbsp;<span class="ident" id="4672130">final</span><span class="op" id="4672135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672138">}</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672141">hasArgs</span>&nbsp;<span class="op" id="4672149">:=</span>&nbsp;<span class="builtinfunc" id="4672152">len</span><span class="op" id="4672155">(</span><span class="ident" id="4672156">args</span><span class="op" id="4672160">)</span>&nbsp;<span class="op" id="4672162">&gt;</span>&nbsp;<span class="num" id="4672164">1</span>&nbsp;<span class="op" id="4672166">||</span>&nbsp;<span class="ident" id="4672169">final</span><span class="op" id="4672174">.</span><span class="ident" id="4672175">IsValid</span><span class="op" id="4672182">(</span><span class="op" id="4672183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4672186">//&nbsp;It&#39;s&nbsp;not&nbsp;a&nbsp;method;&nbsp;must&nbsp;be&nbsp;a&nbsp;field&nbsp;of&nbsp;a&nbsp;struct&nbsp;or&nbsp;an&nbsp;element&nbsp;of&nbsp;a&nbsp;map.&nbsp;The&nbsp;receiver&nbsp;must&nbsp;not&nbsp;be&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672291">receiver</span><span class="op" id="4672299">,</span>&nbsp;<span class="ident" id="4672301">isNil</span>&nbsp;<span class="op" id="4672307">:=</span>&nbsp;<span class="ident" id="4672310">indirect</span><span class="op" id="4672318">(</span><span class="ident" id="4672319">receiver</span><span class="op" id="4672327">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672330">if</span>&nbsp;<span class="ident" id="4672333">isNil</span>&nbsp;<span class="op" id="4672339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672343">s</span><span class="op" id="4672344">.</span><span class="ident" id="4672345">errorf</span><span class="op" id="4672351">(</span><span class="string" id="4672352">&#34;nil&nbsp;pointer&nbsp;evaluating&nbsp;%s.%s&#34;</span><span class="op" id="4672382">,</span>&nbsp;<span class="ident" id="4672384">typ</span><span class="op" id="4672387">,</span>&nbsp;<span class="ident" id="4672389">fieldName</span><span class="op" id="4672398">)</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672401">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672404">switch</span>&nbsp;<span class="ident" id="4672411">receiver</span><span class="op" id="4672419">.</span><span class="ident" id="4672420">Kind</span><span class="op" id="4672424">(</span><span class="op" id="4672425">)</span>&nbsp;<span class="op" id="4672427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672430">case</span>&nbsp;<span class="ident" id="4672435">reflect</span><span class="op" id="4672442">.</span><span class="ident" id="4672443">Struct</span><span class="op" id="4672449">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672453">tField</span><span class="op" id="4672459">,</span>&nbsp;<span class="ident" id="4672461">ok</span>&nbsp;<span class="op" id="4672464">:=</span>&nbsp;<span class="ident" id="4672467">receiver</span><span class="op" id="4672475">.</span><span class="ident" id="4672476">Type</span><span class="op" id="4672480">(</span><span class="op" id="4672481">)</span><span class="op" id="4672482">.</span><span class="ident" id="4672483">FieldByName</span><span class="op" id="4672494">(</span><span class="ident" id="4672495">fieldName</span><span class="op" id="4672504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672508">if</span>&nbsp;<span class="ident" id="4672511">ok</span>&nbsp;<span class="op" id="4672514">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672519">field</span>&nbsp;<span class="op" id="4672525">:=</span>&nbsp;<span class="ident" id="4672528">receiver</span><span class="op" id="4672536">.</span><span class="ident" id="4672537">FieldByIndex</span><span class="op" id="4672549">(</span><span class="ident" id="4672550">tField</span><span class="op" id="4672556">.</span><span class="ident" id="4672557">Index</span><span class="op" id="4672562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672567">if</span>&nbsp;<span class="ident" id="4672570">tField</span><span class="op" id="4672576">.</span><span class="ident" id="4672577">PkgPath</span>&nbsp;<span class="op" id="4672585">!=</span>&nbsp;<span class="string" id="4672588">&#34;&#34;</span>&nbsp;<span class="op" id="4672591">{</span>&nbsp;<span class="comment" id="4672593">//&nbsp;field&nbsp;is&nbsp;unexported</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672620">s</span><span class="op" id="4672621">.</span><span class="ident" id="4672622">errorf</span><span class="op" id="4672628">(</span><span class="string" id="4672629">&#34;%s&nbsp;is&nbsp;an&nbsp;unexported&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="4672674">,</span>&nbsp;<span class="ident" id="4672676">fieldName</span><span class="op" id="4672685">,</span>&nbsp;<span class="ident" id="4672687">typ</span><span class="op" id="4672690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4672700">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;function,&nbsp;we&nbsp;must&nbsp;call&nbsp;it.</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672743">if</span>&nbsp;<span class="ident" id="4672746">hasArgs</span>&nbsp;<span class="op" id="4672754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672760">s</span><span class="op" id="4672761">.</span><span class="ident" id="4672762">errorf</span><span class="op" id="4672768">(</span><span class="string" id="4672769">&#34;%s&nbsp;has&nbsp;arguments&nbsp;but&nbsp;cannot&nbsp;be&nbsp;invoked&nbsp;as&nbsp;function&#34;</span><span class="op" id="4672821">,</span>&nbsp;<span class="ident" id="4672823">fieldName</span><span class="op" id="4672832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672837">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672842">return</span>&nbsp;<span class="ident" id="4672849">field</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4672857">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4672861">s</span><span class="op" id="4672862">.</span><span class="ident" id="4672863">errorf</span><span class="op" id="4672869">(</span><span class="string" id="4672870">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;field&nbsp;of&nbsp;struct&nbsp;type&nbsp;%s&#34;</span><span class="op" id="4672907">,</span>&nbsp;<span class="ident" id="4672909">fieldName</span><span class="op" id="4672918">,</span>&nbsp;<span class="ident" id="4672920">typ</span><span class="op" id="4672923">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4672926">case</span>&nbsp;<span class="ident" id="4672931">reflect</span><span class="op" id="4672938">.</span><span class="ident" id="4672939">Map</span><span class="op" id="4672942">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4672946">//&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;map,&nbsp;attempt&nbsp;to&nbsp;use&nbsp;the&nbsp;field&nbsp;name&nbsp;as&nbsp;a&nbsp;key.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673006">nameVal</span>&nbsp;<span class="op" id="4673014">:=</span>&nbsp;<span class="ident" id="4673017">reflect</span><span class="op" id="4673024">.</span><span class="ident" id="4673025">ValueOf</span><span class="op" id="4673032">(</span><span class="ident" id="4673033">fieldName</span><span class="op" id="4673042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673046">if</span>&nbsp;<span class="ident" id="4673049">nameVal</span><span class="op" id="4673056">.</span><span class="ident" id="4673057">Type</span><span class="op" id="4673061">(</span><span class="op" id="4673062">)</span><span class="op" id="4673063">.</span><span class="ident" id="4673064">AssignableTo</span><span class="op" id="4673076">(</span><span class="ident" id="4673077">receiver</span><span class="op" id="4673085">.</span><span class="ident" id="4673086">Type</span><span class="op" id="4673090">(</span><span class="op" id="4673091">)</span><span class="op" id="4673092">.</span><span class="ident" id="4673093">Key</span><span class="op" id="4673096">(</span><span class="op" id="4673097">)</span><span class="op" id="4673098">)</span>&nbsp;<span class="op" id="4673100">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673105">if</span>&nbsp;<span class="ident" id="4673108">hasArgs</span>&nbsp;<span class="op" id="4673116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673122">s</span><span class="op" id="4673123">.</span><span class="ident" id="4673124">errorf</span><span class="op" id="4673130">(</span><span class="string" id="4673131">&#34;%s&nbsp;is&nbsp;not&nbsp;a&nbsp;method&nbsp;but&nbsp;has&nbsp;arguments&#34;</span><span class="op" id="4673169">,</span>&nbsp;<span class="ident" id="4673171">fieldName</span><span class="op" id="4673180">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4673185">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673190">return</span>&nbsp;<span class="ident" id="4673197">receiver</span><span class="op" id="4673205">.</span><span class="ident" id="4673206">MapIndex</span><span class="op" id="4673214">(</span><span class="ident" id="4673215">nameVal</span><span class="op" id="4673222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4673226">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4673229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673232">s</span><span class="op" id="4673233">.</span><span class="ident" id="4673234">errorf</span><span class="op" id="4673240">(</span><span class="string" id="4673241">&#34;can&#39;t&nbsp;evaluate&nbsp;field&nbsp;%s&nbsp;in&nbsp;type&nbsp;%s&#34;</span><span class="op" id="4673277">,</span>&nbsp;<span class="ident" id="4673279">fieldName</span><span class="op" id="4673288">,</span>&nbsp;<span class="ident" id="4673290">typ</span><span class="op" id="4673293">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4673296">panic</span><span class="op" id="4673301">(</span><span class="string" id="4673302">&#34;not&nbsp;reached&#34;</span><span class="op" id="4673315">)</span><br>
<span class="lineno"></span><span class="op" id="4673317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="4673320">var</span>&nbsp;<span class="op" id="4673324">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673327">errorType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4673343">=</span>&nbsp;<span class="ident" id="4673345">reflect</span><span class="op" id="4673352">.</span><span class="ident" id="4673353">TypeOf</span><span class="op" id="4673359">(</span><span class="op" id="4673360">(</span><span class="op" id="4673361">*</span><span class="builtintype" id="4673362">error</span><span class="op" id="4673367">)</span><span class="op" id="4673368">(</span><span class="ident" id="4673369">nil</span><span class="op" id="4673372">)</span><span class="op" id="4673373">)</span><span class="op" id="4673374">.</span><span class="ident" id="4673375">Elem</span><span class="op" id="4673379">(</span><span class="op" id="4673380">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673383">fmtStringerType</span>&nbsp;<span class="op" id="4673399">=</span>&nbsp;<span class="ident" id="4673401">reflect</span><span class="op" id="4673408">.</span><span class="ident" id="4673409">TypeOf</span><span class="op" id="4673415">(</span><span class="op" id="4673416">(</span><span class="op" id="4673417">*</span><span class="ident" id="4673418">fmt</span><span class="op" id="4673421">.</span><span class="ident" id="4673422">Stringer</span><span class="op" id="4673430">)</span><span class="op" id="4673431">(</span><span class="ident" id="4673432">nil</span><span class="op" id="4673435">)</span><span class="op" id="4673436">)</span><span class="op" id="4673437">.</span><span class="ident" id="4673438">Elem</span><span class="op" id="4673442">(</span><span class="op" id="4673443">)</span><br>
<span class="lineno"></span><span class="op" id="4673445">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">520</span><span class="comment" id="4673448">//&nbsp;evalCall&nbsp;executes&nbsp;a&nbsp;function&nbsp;or&nbsp;method&nbsp;call.&nbsp;If&nbsp;it&#39;s&nbsp;a&nbsp;method,&nbsp;fun&nbsp;already&nbsp;has&nbsp;the&nbsp;receiver&nbsp;bound,&nbsp;so</span><br>
<span class="lineno"></span><span class="comment" id="4673553">//&nbsp;it&nbsp;looks&nbsp;just&nbsp;like&nbsp;a&nbsp;function&nbsp;call.&nbsp;&nbsp;The&nbsp;arg&nbsp;list,&nbsp;if&nbsp;non-nil,&nbsp;includes&nbsp;(in&nbsp;the&nbsp;manner&nbsp;of&nbsp;the&nbsp;shell),&nbsp;arg[0]</span><br>
<span class="lineno"></span><span class="comment" id="4673665">//&nbsp;as&nbsp;the&nbsp;function&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="4673692">func</span>&nbsp;<span class="op" id="4673697">(</span><span class="ident" id="4673698">s</span>&nbsp;<span class="op" id="4673700">*</span><span class="ident" id="4673701">state</span><span class="op" id="4673706">)</span>&nbsp;<span class="ident" id="4673708">evalCall</span><span class="op" id="4673716">(</span><span class="ident" id="4673717">dot</span><span class="op" id="4673720">,</span>&nbsp;<span class="ident" id="4673722">fun</span>&nbsp;<span class="ident" id="4673726">reflect</span><span class="op" id="4673733">.</span><span class="ident" id="4673734">Value</span><span class="op" id="4673739">,</span>&nbsp;<span class="ident" id="4673741">node</span>&nbsp;<span class="ident" id="4673746">parse</span><span class="op" id="4673751">.</span><span class="ident" id="4673752">Node</span><span class="op" id="4673756">,</span>&nbsp;<span class="ident" id="4673758">name</span>&nbsp;<span class="builtintype" id="4673763">string</span><span class="op" id="4673769">,</span>&nbsp;<span class="ident" id="4673771">args</span>&nbsp;<span class="op" id="4673776">[</span><span class="op" id="4673777">]</span><span class="ident" id="4673778">parse</span><span class="op" id="4673783">.</span><span class="ident" id="4673784">Node</span><span class="op" id="4673788">,</span>&nbsp;<span class="ident" id="4673790">final</span>&nbsp;<span class="ident" id="4673796">reflect</span><span class="op" id="4673803">.</span><span class="ident" id="4673804">Value</span><span class="op" id="4673809">)</span>&nbsp;<span class="ident" id="4673811">reflect</span><span class="op" id="4673818">.</span><span class="ident" id="4673819">Value</span>&nbsp;<span class="op" id="4673825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673828">if</span>&nbsp;<span class="ident" id="4673831">args</span>&nbsp;<span class="op" id="4673836">!=</span>&nbsp;<span class="ident" id="4673839">nil</span>&nbsp;<span class="op" id="4673843">{</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673847">args</span>&nbsp;<span class="op" id="4673852">=</span>&nbsp;<span class="ident" id="4673854">args</span><span class="op" id="4673858">[</span><span class="num" id="4673859">1</span><span class="op" id="4673860">:</span><span class="op" id="4673861">]</span>&nbsp;<span class="comment" id="4673863">//&nbsp;Zeroth&nbsp;arg&nbsp;is&nbsp;function&nbsp;name/node;&nbsp;not&nbsp;passed&nbsp;to&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4673925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673928">typ</span>&nbsp;<span class="op" id="4673932">:=</span>&nbsp;<span class="ident" id="4673935">fun</span><span class="op" id="4673938">.</span><span class="ident" id="4673939">Type</span><span class="op" id="4673943">(</span><span class="op" id="4673944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673947">numIn</span>&nbsp;<span class="op" id="4673953">:=</span>&nbsp;<span class="builtinfunc" id="4673956">len</span><span class="op" id="4673959">(</span><span class="ident" id="4673960">args</span><span class="op" id="4673964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4673967">if</span>&nbsp;<span class="ident" id="4673970">final</span><span class="op" id="4673975">.</span><span class="ident" id="4673976">IsValid</span><span class="op" id="4673983">(</span><span class="op" id="4673984">)</span>&nbsp;<span class="op" id="4673986">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4673990">numIn</span><span class="op" id="4673995">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4673999">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674002">numFixed</span>&nbsp;<span class="op" id="4674011">:=</span>&nbsp;<span class="builtinfunc" id="4674014">len</span><span class="op" id="4674017">(</span><span class="ident" id="4674018">args</span><span class="op" id="4674022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674025">if</span>&nbsp;<span class="ident" id="4674028">typ</span><span class="op" id="4674031">.</span><span class="ident" id="4674032">IsVariadic</span><span class="op" id="4674042">(</span><span class="op" id="4674043">)</span>&nbsp;<span class="op" id="4674045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674049">numFixed</span>&nbsp;<span class="op" id="4674058">=</span>&nbsp;<span class="ident" id="4674060">typ</span><span class="op" id="4674063">.</span><span class="ident" id="4674064">NumIn</span><span class="op" id="4674069">(</span><span class="op" id="4674070">)</span>&nbsp;<span class="op" id="4674072">-</span>&nbsp;<span class="num" id="4674074">1</span>&nbsp;<span class="comment" id="4674076">//&nbsp;last&nbsp;arg&nbsp;is&nbsp;the&nbsp;variadic&nbsp;one.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674111">if</span>&nbsp;<span class="ident" id="4674114">numIn</span>&nbsp;<span class="op" id="4674120">&lt;</span>&nbsp;<span class="ident" id="4674122">numFixed</span>&nbsp;<span class="op" id="4674131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674136">s</span><span class="op" id="4674137">.</span><span class="ident" id="4674138">errorf</span><span class="op" id="4674144">(</span><span class="string" id="4674145">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;at&nbsp;least&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="4674199">,</span>&nbsp;<span class="ident" id="4674201">name</span><span class="op" id="4674205">,</span>&nbsp;<span class="ident" id="4674207">typ</span><span class="op" id="4674210">.</span><span class="ident" id="4674211">NumIn</span><span class="op" id="4674216">(</span><span class="op" id="4674217">)</span><span class="op" id="4674218">-</span><span class="num" id="4674219">1</span><span class="op" id="4674220">,</span>&nbsp;<span class="builtinfunc" id="4674222">len</span><span class="op" id="4674225">(</span><span class="ident" id="4674226">args</span><span class="op" id="4674230">)</span><span class="op" id="4674231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4674235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4674238">}</span>&nbsp;<span class="keyword" id="4674240">else</span>&nbsp;<span class="keyword" id="4674245">if</span>&nbsp;<span class="ident" id="4674248">numIn</span>&nbsp;<span class="op" id="4674254">&lt;</span>&nbsp;<span class="ident" id="4674256">typ</span><span class="op" id="4674259">.</span><span class="ident" id="4674260">NumIn</span><span class="op" id="4674265">(</span><span class="op" id="4674266">)</span><span class="op" id="4674267">-</span><span class="num" id="4674268">1</span>&nbsp;<span class="op" id="4674270">||</span>&nbsp;<span class="op" id="4674273">!</span><span class="ident" id="4674274">typ</span><span class="op" id="4674277">.</span><span class="ident" id="4674278">IsVariadic</span><span class="op" id="4674288">(</span><span class="op" id="4674289">)</span>&nbsp;<span class="op" id="4674291">&amp;&amp;</span>&nbsp;<span class="ident" id="4674294">numIn</span>&nbsp;<span class="op" id="4674300">!=</span>&nbsp;<span class="ident" id="4674303">typ</span><span class="op" id="4674306">.</span><span class="ident" id="4674307">NumIn</span><span class="op" id="4674312">(</span><span class="op" id="4674313">)</span>&nbsp;<span class="op" id="4674315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674319">s</span><span class="op" id="4674320">.</span><span class="ident" id="4674321">errorf</span><span class="op" id="4674327">(</span><span class="string" id="4674328">&#34;wrong&nbsp;number&nbsp;of&nbsp;args&nbsp;for&nbsp;%s:&nbsp;want&nbsp;%d&nbsp;got&nbsp;%d&#34;</span><span class="op" id="4674373">,</span>&nbsp;<span class="ident" id="4674375">name</span><span class="op" id="4674379">,</span>&nbsp;<span class="ident" id="4674381">typ</span><span class="op" id="4674384">.</span><span class="ident" id="4674385">NumIn</span><span class="op" id="4674390">(</span><span class="op" id="4674391">)</span><span class="op" id="4674392">,</span>&nbsp;<span class="builtinfunc" id="4674394">len</span><span class="op" id="4674397">(</span><span class="ident" id="4674398">args</span><span class="op" id="4674402">)</span><span class="op" id="4674403">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4674406">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674409">if</span>&nbsp;<span class="op" id="4674412">!</span><span class="ident" id="4674413">goodFunc</span><span class="op" id="4674421">(</span><span class="ident" id="4674422">typ</span><span class="op" id="4674425">)</span>&nbsp;<span class="op" id="4674427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4674431">//&nbsp;TODO:&nbsp;This&nbsp;could&nbsp;still&nbsp;be&nbsp;a&nbsp;confusing&nbsp;error;&nbsp;maybe&nbsp;goodFunc&nbsp;should&nbsp;provide&nbsp;info.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674517">s</span><span class="op" id="4674518">.</span><span class="ident" id="4674519">errorf</span><span class="op" id="4674525">(</span><span class="string" id="4674526">&#34;can&#39;t&nbsp;call&nbsp;method/function&nbsp;%q&nbsp;with&nbsp;%d&nbsp;results&#34;</span><span class="op" id="4674573">,</span>&nbsp;<span class="ident" id="4674575">name</span><span class="op" id="4674579">,</span>&nbsp;<span class="ident" id="4674581">typ</span><span class="op" id="4674584">.</span><span class="ident" id="4674585">NumOut</span><span class="op" id="4674591">(</span><span class="op" id="4674592">)</span><span class="op" id="4674593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4674596">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4674599">//&nbsp;Build&nbsp;the&nbsp;arg&nbsp;list.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674623">argv</span>&nbsp;<span class="op" id="4674628">:=</span>&nbsp;<span class="builtinfunc" id="4674631">make</span><span class="op" id="4674635">(</span><span class="op" id="4674636">[</span><span class="op" id="4674637">]</span><span class="ident" id="4674638">reflect</span><span class="op" id="4674645">.</span><span class="ident" id="4674646">Value</span><span class="op" id="4674651">,</span>&nbsp;<span class="ident" id="4674653">numIn</span><span class="op" id="4674658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4674661">//&nbsp;Args&nbsp;must&nbsp;be&nbsp;evaluated.&nbsp;Fixed&nbsp;args&nbsp;first.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674707">i</span>&nbsp;<span class="op" id="4674709">:=</span>&nbsp;<span class="num" id="4674712">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674715">for</span>&nbsp;<span class="op" id="4674719">;</span>&nbsp;<span class="ident" id="4674721">i</span>&nbsp;<span class="op" id="4674723">&lt;</span>&nbsp;<span class="ident" id="4674725">numFixed</span>&nbsp;<span class="op" id="4674734">&amp;&amp;</span>&nbsp;<span class="ident" id="4674737">i</span>&nbsp;<span class="op" id="4674739">&lt;</span>&nbsp;<span class="builtinfunc" id="4674741">len</span><span class="op" id="4674744">(</span><span class="ident" id="4674745">args</span><span class="op" id="4674749">)</span><span class="op" id="4674750">;</span>&nbsp;<span class="ident" id="4674752">i</span><span class="op" id="4674753">++</span>&nbsp;<span class="op" id="4674756">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674760">argv</span><span class="op" id="4674764">[</span><span class="ident" id="4674765">i</span><span class="op" id="4674766">]</span>&nbsp;<span class="op" id="4674768">=</span>&nbsp;<span class="ident" id="4674770">s</span><span class="op" id="4674771">.</span><span class="ident" id="4674772">evalArg</span><span class="op" id="4674779">(</span><span class="ident" id="4674780">dot</span><span class="op" id="4674783">,</span>&nbsp;<span class="ident" id="4674785">typ</span><span class="op" id="4674788">.</span><span class="ident" id="4674789">In</span><span class="op" id="4674791">(</span><span class="ident" id="4674792">i</span><span class="op" id="4674793">)</span><span class="op" id="4674794">,</span>&nbsp;<span class="ident" id="4674796">args</span><span class="op" id="4674800">[</span><span class="ident" id="4674801">i</span><span class="op" id="4674802">]</span><span class="op" id="4674803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4674806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4674809">//&nbsp;Now&nbsp;the&nbsp;...&nbsp;args.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674831">if</span>&nbsp;<span class="ident" id="4674834">typ</span><span class="op" id="4674837">.</span><span class="ident" id="4674838">IsVariadic</span><span class="op" id="4674848">(</span><span class="op" id="4674849">)</span>&nbsp;<span class="op" id="4674851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674855">argType</span>&nbsp;<span class="op" id="4674863">:=</span>&nbsp;<span class="ident" id="4674866">typ</span><span class="op" id="4674869">.</span><span class="ident" id="4674870">In</span><span class="op" id="4674872">(</span><span class="ident" id="4674873">typ</span><span class="op" id="4674876">.</span><span class="ident" id="4674877">NumIn</span><span class="op" id="4674882">(</span><span class="op" id="4674883">)</span>&nbsp;<span class="op" id="4674885">-</span>&nbsp;<span class="num" id="4674887">1</span><span class="op" id="4674888">)</span><span class="op" id="4674889">.</span><span class="ident" id="4674890">Elem</span><span class="op" id="4674894">(</span><span class="op" id="4674895">)</span>&nbsp;<span class="comment" id="4674897">//&nbsp;Argument&nbsp;is&nbsp;a&nbsp;slice.</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4674923">for</span>&nbsp;<span class="op" id="4674927">;</span>&nbsp;<span class="ident" id="4674929">i</span>&nbsp;<span class="op" id="4674931">&lt;</span>&nbsp;<span class="builtinfunc" id="4674933">len</span><span class="op" id="4674936">(</span><span class="ident" id="4674937">args</span><span class="op" id="4674941">)</span><span class="op" id="4674942">;</span>&nbsp;<span class="ident" id="4674944">i</span><span class="op" id="4674945">++</span>&nbsp;<span class="op" id="4674948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4674953">argv</span><span class="op" id="4674957">[</span><span class="ident" id="4674958">i</span><span class="op" id="4674959">]</span>&nbsp;<span class="op" id="4674961">=</span>&nbsp;<span class="ident" id="4674963">s</span><span class="op" id="4674964">.</span><span class="ident" id="4674965">evalArg</span><span class="op" id="4674972">(</span><span class="ident" id="4674973">dot</span><span class="op" id="4674976">,</span>&nbsp;<span class="ident" id="4674978">argType</span><span class="op" id="4674985">,</span>&nbsp;<span class="ident" id="4674987">args</span><span class="op" id="4674991">[</span><span class="ident" id="4674992">i</span><span class="op" id="4674993">]</span><span class="op" id="4674994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4674998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4675001">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4675004">//&nbsp;Add&nbsp;final&nbsp;value&nbsp;if&nbsp;necessary.</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675038">if</span>&nbsp;<span class="ident" id="4675041">final</span><span class="op" id="4675046">.</span><span class="ident" id="4675047">IsValid</span><span class="op" id="4675054">(</span><span class="op" id="4675055">)</span>&nbsp;<span class="op" id="4675057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675061">t</span>&nbsp;<span class="op" id="4675063">:=</span>&nbsp;<span class="ident" id="4675066">typ</span><span class="op" id="4675069">.</span><span class="ident" id="4675070">In</span><span class="op" id="4675072">(</span><span class="ident" id="4675073">typ</span><span class="op" id="4675076">.</span><span class="ident" id="4675077">NumIn</span><span class="op" id="4675082">(</span><span class="op" id="4675083">)</span>&nbsp;<span class="op" id="4675085">-</span>&nbsp;<span class="num" id="4675087">1</span><span class="op" id="4675088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675092">if</span>&nbsp;<span class="ident" id="4675095">typ</span><span class="op" id="4675098">.</span><span class="ident" id="4675099">IsVariadic</span><span class="op" id="4675109">(</span><span class="op" id="4675110">)</span>&nbsp;<span class="op" id="4675112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675117">t</span>&nbsp;<span class="op" id="4675119">=</span>&nbsp;<span class="ident" id="4675121">t</span><span class="op" id="4675122">.</span><span class="ident" id="4675123">Elem</span><span class="op" id="4675127">(</span><span class="op" id="4675128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4675132">}</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675136">argv</span><span class="op" id="4675140">[</span><span class="ident" id="4675141">i</span><span class="op" id="4675142">]</span>&nbsp;<span class="op" id="4675144">=</span>&nbsp;<span class="ident" id="4675146">s</span><span class="op" id="4675147">.</span><span class="ident" id="4675148">validateType</span><span class="op" id="4675160">(</span><span class="ident" id="4675161">final</span><span class="op" id="4675166">,</span>&nbsp;<span class="ident" id="4675168">t</span><span class="op" id="4675169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4675172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675175">result</span>&nbsp;<span class="op" id="4675182">:=</span>&nbsp;<span class="ident" id="4675185">fun</span><span class="op" id="4675188">.</span><span class="ident" id="4675189">Call</span><span class="op" id="4675193">(</span><span class="ident" id="4675194">argv</span><span class="op" id="4675198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4675201">//&nbsp;If&nbsp;we&nbsp;have&nbsp;an&nbsp;error&nbsp;that&nbsp;is&nbsp;not&nbsp;nil,&nbsp;stop&nbsp;execution&nbsp;and&nbsp;return&nbsp;that&nbsp;error&nbsp;to&nbsp;the&nbsp;caller.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675294">if</span>&nbsp;<span class="builtinfunc" id="4675297">len</span><span class="op" id="4675300">(</span><span class="ident" id="4675301">result</span><span class="op" id="4675307">)</span>&nbsp;<span class="op" id="4675309">==</span>&nbsp;<span class="num" id="4675312">2</span>&nbsp;<span class="op" id="4675314">&amp;&amp;</span>&nbsp;<span class="op" id="4675317">!</span><span class="ident" id="4675318">result</span><span class="op" id="4675324">[</span><span class="num" id="4675325">1</span><span class="op" id="4675326">]</span><span class="op" id="4675327">.</span><span class="ident" id="4675328">IsNil</span><span class="op" id="4675333">(</span><span class="op" id="4675334">)</span>&nbsp;<span class="op" id="4675336">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675340">s</span><span class="op" id="4675341">.</span><span class="ident" id="4675342">at</span><span class="op" id="4675344">(</span><span class="ident" id="4675345">node</span><span class="op" id="4675349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4675353">s</span><span class="op" id="4675354">.</span><span class="ident" id="4675355">errorf</span><span class="op" id="4675361">(</span><span class="string" id="4675362">&#34;error&nbsp;calling&nbsp;%s:&nbsp;%s&#34;</span><span class="op" id="4675384">,</span>&nbsp;<span class="ident" id="4675386">name</span><span class="op" id="4675390">,</span>&nbsp;<span class="ident" id="4675392">result</span><span class="op" id="4675398">[</span><span class="num" id="4675399">1</span><span class="op" id="4675400">]</span><span class="op" id="4675401">.</span><span class="ident" id="4675402">Interface</span><span class="op" id="4675411">(</span><span class="op" id="4675412">)</span><span class="op" id="4675413">.</span><span class="op" id="4675414">(</span><span class="builtintype" id="4675415">error</span><span class="op" id="4675420">)</span><span class="op" id="4675421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4675424">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675427">return</span>&nbsp;<span class="ident" id="4675434">result</span><span class="op" id="4675440">[</span><span class="num" id="4675441">0</span><span class="op" id="4675442">]</span><br>
<span class="lineno"></span><span class="op" id="4675444">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="4675447">//&nbsp;canBeNil&nbsp;reports&nbsp;whether&nbsp;an&nbsp;untyped&nbsp;nil&nbsp;can&nbsp;be&nbsp;assigned&nbsp;to&nbsp;the&nbsp;type.&nbsp;See&nbsp;reflect.Zero.</span><br>
<span class="lineno"></span><span class="keyword" id="4675537">func</span>&nbsp;<span class="ident" id="4675542">canBeNil</span><span class="op" id="4675550">(</span><span class="ident" id="4675551">typ</span>&nbsp;<span class="ident" id="4675555">reflect</span><span class="op" id="4675562">.</span><span class="ident" id="4675563">Type</span><span class="op" id="4675567">)</span>&nbsp;<span class="builtintype" id="4675569">bool</span>&nbsp;<span class="op" id="4675574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675577">switch</span>&nbsp;<span class="ident" id="4675584">typ</span><span class="op" id="4675587">.</span><span class="ident" id="4675588">Kind</span><span class="op" id="4675592">(</span><span class="op" id="4675593">)</span>&nbsp;<span class="op" id="4675595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675598">case</span>&nbsp;<span class="ident" id="4675603">reflect</span><span class="op" id="4675610">.</span><span class="ident" id="4675611">Chan</span><span class="op" id="4675615">,</span>&nbsp;<span class="ident" id="4675617">reflect</span><span class="op" id="4675624">.</span><span class="ident" id="4675625">Func</span><span class="op" id="4675629">,</span>&nbsp;<span class="ident" id="4675631">reflect</span><span class="op" id="4675638">.</span><span class="ident" id="4675639">Interface</span><span class="op" id="4675648">,</span>&nbsp;<span class="ident" id="4675650">reflect</span><span class="op" id="4675657">.</span><span class="ident" id="4675658">Map</span><span class="op" id="4675661">,</span>&nbsp;<span class="ident" id="4675663">reflect</span><span class="op" id="4675670">.</span><span class="ident" id="4675671">Ptr</span><span class="op" id="4675674">,</span>&nbsp;<span class="ident" id="4675676">reflect</span><span class="op" id="4675683">.</span><span class="ident" id="4675684">Slice</span><span class="op" id="4675689">:</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675693">return</span>&nbsp;<span class="ident" id="4675700">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4675706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675709">return</span>&nbsp;<span class="ident" id="4675716">false</span><br>
<span class="lineno"></span><span class="op" id="4675722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">585</span><span class="comment" id="4675725">//&nbsp;validateType&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;value&nbsp;is&nbsp;valid&nbsp;and&nbsp;assignable&nbsp;to&nbsp;the&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4675804">func</span>&nbsp;<span class="op" id="4675809">(</span><span class="ident" id="4675810">s</span>&nbsp;<span class="op" id="4675812">*</span><span class="ident" id="4675813">state</span><span class="op" id="4675818">)</span>&nbsp;<span class="ident" id="4675820">validateType</span><span class="op" id="4675832">(</span><span class="ident" id="4675833">value</span>&nbsp;<span class="ident" id="4675839">reflect</span><span class="op" id="4675846">.</span><span class="ident" id="4675847">Value</span><span class="op" id="4675852">,</span>&nbsp;<span class="ident" id="4675854">typ</span>&nbsp;<span class="ident" id="4675858">reflect</span><span class="op" id="4675865">.</span><span class="ident" id="4675866">Type</span><span class="op" id="4675870">)</span>&nbsp;<span class="ident" id="4675872">reflect</span><span class="op" id="4675879">.</span><span class="ident" id="4675880">Value</span>&nbsp;<span class="op" id="4675886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675889">if</span>&nbsp;<span class="op" id="4675892">!</span><span class="ident" id="4675893">value</span><span class="op" id="4675898">.</span><span class="ident" id="4675899">IsValid</span><span class="op" id="4675906">(</span><span class="op" id="4675907">)</span>&nbsp;<span class="op" id="4675909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4675913">if</span>&nbsp;<span class="ident" id="4675916">typ</span>&nbsp;<span class="op" id="4675920">==</span>&nbsp;<span class="ident" id="4675923">nil</span>&nbsp;<span class="op" id="4675927">||</span>&nbsp;<span class="ident" id="4675930">canBeNil</span><span class="op" id="4675938">(</span><span class="ident" id="4675939">typ</span><span class="op" id="4675942">)</span>&nbsp;<span class="op" id="4675944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4675949">//&nbsp;An&nbsp;untyped&nbsp;nil&nbsp;interface{}.&nbsp;Accept&nbsp;as&nbsp;a&nbsp;proper&nbsp;nil&nbsp;value.</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676013">return</span>&nbsp;<span class="ident" id="4676020">reflect</span><span class="op" id="4676027">.</span><span class="ident" id="4676028">Zero</span><span class="op" id="4676032">(</span><span class="ident" id="4676033">typ</span><span class="op" id="4676036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4676040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4676044">s</span><span class="op" id="4676045">.</span><span class="ident" id="4676046">errorf</span><span class="op" id="4676052">(</span><span class="string" id="4676053">&#34;invalid&nbsp;value;&nbsp;expected&nbsp;%s&#34;</span><span class="op" id="4676081">,</span>&nbsp;<span class="ident" id="4676083">typ</span><span class="op" id="4676086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4676089">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676092">if</span>&nbsp;<span class="ident" id="4676095">typ</span>&nbsp;<span class="op" id="4676099">!=</span>&nbsp;<span class="ident" id="4676102">nil</span>&nbsp;<span class="op" id="4676106">&amp;&amp;</span>&nbsp;<span class="op" id="4676109">!</span><span class="ident" id="4676110">value</span><span class="op" id="4676115">.</span><span class="ident" id="4676116">Type</span><span class="op" id="4676120">(</span><span class="op" id="4676121">)</span><span class="op" id="4676122">.</span><span class="ident" id="4676123">AssignableTo</span><span class="op" id="4676135">(</span><span class="ident" id="4676136">typ</span><span class="op" id="4676139">)</span>&nbsp;<span class="op" id="4676141">{</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676145">if</span>&nbsp;<span class="ident" id="4676148">value</span><span class="op" id="4676153">.</span><span class="ident" id="4676154">Kind</span><span class="op" id="4676158">(</span><span class="op" id="4676159">)</span>&nbsp;<span class="op" id="4676161">==</span>&nbsp;<span class="ident" id="4676164">reflect</span><span class="op" id="4676171">.</span><span class="ident" id="4676172">Interface</span>&nbsp;<span class="op" id="4676182">&amp;&amp;</span>&nbsp;<span class="op" id="4676185">!</span><span class="ident" id="4676186">value</span><span class="op" id="4676191">.</span><span class="ident" id="4676192">IsNil</span><span class="op" id="4676197">(</span><span class="op" id="4676198">)</span>&nbsp;<span class="op" id="4676200">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4676205">value</span>&nbsp;<span class="op" id="4676211">=</span>&nbsp;<span class="ident" id="4676213">value</span><span class="op" id="4676218">.</span><span class="ident" id="4676219">Elem</span><span class="op" id="4676223">(</span><span class="op" id="4676224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676229">if</span>&nbsp;<span class="ident" id="4676232">value</span><span class="op" id="4676237">.</span><span class="ident" id="4676238">Type</span><span class="op" id="4676242">(</span><span class="op" id="4676243">)</span><span class="op" id="4676244">.</span><span class="ident" id="4676245">AssignableTo</span><span class="op" id="4676257">(</span><span class="ident" id="4676258">typ</span><span class="op" id="4676261">)</span>&nbsp;<span class="op" id="4676263">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676269">return</span>&nbsp;<span class="ident" id="4676276">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4676285">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4676290">//&nbsp;fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4676307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4676311">//&nbsp;Does&nbsp;one&nbsp;dereference&nbsp;or&nbsp;indirection&nbsp;work?&nbsp;We&nbsp;could&nbsp;do&nbsp;more,&nbsp;as&nbsp;we</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4676382">//&nbsp;do&nbsp;with&nbsp;method&nbsp;receivers,&nbsp;but&nbsp;that&nbsp;gets&nbsp;messy&nbsp;and&nbsp;method&nbsp;receivers</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4676454">//&nbsp;are&nbsp;much&nbsp;more&nbsp;constrained,&nbsp;so&nbsp;it&nbsp;makes&nbsp;more&nbsp;sense&nbsp;there&nbsp;than&nbsp;here.</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4676526">//&nbsp;Besides,&nbsp;one&nbsp;is&nbsp;almost&nbsp;always&nbsp;all&nbsp;you&nbsp;need.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676575">switch</span>&nbsp;<span class="op" id="4676582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676586">case</span>&nbsp;<span class="ident" id="4676591">value</span><span class="op" id="4676596">.</span><span class="ident" id="4676597">Kind</span><span class="op" id="4676601">(</span><span class="op" id="4676602">)</span>&nbsp;<span class="op" id="4676604">==</span>&nbsp;<span class="ident" id="4676607">reflect</span><span class="op" id="4676614">.</span><span class="ident" id="4676615">Ptr</span>&nbsp;<span class="op" id="4676619">&amp;&amp;</span>&nbsp;<span class="ident" id="4676622">value</span><span class="op" id="4676627">.</span><span class="ident" id="4676628">Type</span><span class="op" id="4676632">(</span><span class="op" id="4676633">)</span><span class="op" id="4676634">.</span><span class="ident" id="4676635">Elem</span><span class="op" id="4676639">(</span><span class="op" id="4676640">)</span><span class="op" id="4676641">.</span><span class="ident" id="4676642">AssignableTo</span><span class="op" id="4676654">(</span><span class="ident" id="4676655">typ</span><span class="op" id="4676658">)</span><span class="op" id="4676659">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4676664">value</span>&nbsp;<span class="op" id="4676670">=</span>&nbsp;<span class="ident" id="4676672">value</span><span class="op" id="4676677">.</span><span class="ident" id="4676678">Elem</span><span class="op" id="4676682">(</span><span class="op" id="4676683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676688">if</span>&nbsp;<span class="op" id="4676691">!</span><span class="ident" id="4676692">value</span><span class="op" id="4676697">.</span><span class="ident" id="4676698">IsValid</span><span class="op" id="4676705">(</span><span class="op" id="4676706">)</span>&nbsp;<span class="op" id="4676708">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4676714">s</span><span class="op" id="4676715">.</span><span class="ident" id="4676716">errorf</span><span class="op" id="4676722">(</span><span class="string" id="4676723">&#34;dereference&nbsp;of&nbsp;nil&nbsp;pointer&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="4676762">,</span>&nbsp;<span class="ident" id="4676764">typ</span><span class="op" id="4676767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4676772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676776">case</span>&nbsp;<span class="ident" id="4676781">reflect</span><span class="op" id="4676788">.</span><span class="ident" id="4676789">PtrTo</span><span class="op" id="4676794">(</span><span class="ident" id="4676795">value</span><span class="op" id="4676800">.</span><span class="ident" id="4676801">Type</span><span class="op" id="4676805">(</span><span class="op" id="4676806">)</span><span class="op" id="4676807">)</span><span class="op" id="4676808">.</span><span class="ident" id="4676809">AssignableTo</span><span class="op" id="4676821">(</span><span class="ident" id="4676822">typ</span><span class="op" id="4676825">)</span>&nbsp;<span class="op" id="4676827">&amp;&amp;</span>&nbsp;<span class="ident" id="4676830">value</span><span class="op" id="4676835">.</span><span class="ident" id="4676836">CanAddr</span><span class="op" id="4676843">(</span><span class="op" id="4676844">)</span><span class="op" id="4676845">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4676850">value</span>&nbsp;<span class="op" id="4676856">=</span>&nbsp;<span class="ident" id="4676858">value</span><span class="op" id="4676863">.</span><span class="ident" id="4676864">Addr</span><span class="op" id="4676868">(</span><span class="op" id="4676869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676873">default</span><span class="op" id="4676880">:</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4676885">s</span><span class="op" id="4676886">.</span><span class="ident" id="4676887">errorf</span><span class="op" id="4676893">(</span><span class="string" id="4676894">&#34;wrong&nbsp;type&nbsp;for&nbsp;value;&nbsp;expected&nbsp;%s;&nbsp;got&nbsp;%s&#34;</span><span class="op" id="4676937">,</span>&nbsp;<span class="ident" id="4676939">typ</span><span class="op" id="4676942">,</span>&nbsp;<span class="ident" id="4676944">value</span><span class="op" id="4676949">.</span><span class="ident" id="4676950">Type</span><span class="op" id="4676954">(</span><span class="op" id="4676955">)</span><span class="op" id="4676956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4676960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4676963">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4676966">return</span>&nbsp;<span class="ident" id="4676973">value</span><br>
<span class="lineno"></span><span class="op" id="4676979">}</span><br>
<span class="lineno">620</span><br>
<span class="lineno"></span><span class="keyword" id="4676982">func</span>&nbsp;<span class="op" id="4676987">(</span><span class="ident" id="4676988">s</span>&nbsp;<span class="op" id="4676990">*</span><span class="ident" id="4676991">state</span><span class="op" id="4676996">)</span>&nbsp;<span class="ident" id="4676998">evalArg</span><span class="op" id="4677005">(</span><span class="ident" id="4677006">dot</span>&nbsp;<span class="ident" id="4677010">reflect</span><span class="op" id="4677017">.</span><span class="ident" id="4677018">Value</span><span class="op" id="4677023">,</span>&nbsp;<span class="ident" id="4677025">typ</span>&nbsp;<span class="ident" id="4677029">reflect</span><span class="op" id="4677036">.</span><span class="ident" id="4677037">Type</span><span class="op" id="4677041">,</span>&nbsp;<span class="ident" id="4677043">n</span>&nbsp;<span class="ident" id="4677045">parse</span><span class="op" id="4677050">.</span><span class="ident" id="4677051">Node</span><span class="op" id="4677055">)</span>&nbsp;<span class="ident" id="4677057">reflect</span><span class="op" id="4677064">.</span><span class="ident" id="4677065">Value</span>&nbsp;<span class="op" id="4677071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677074">s</span><span class="op" id="4677075">.</span><span class="ident" id="4677076">at</span><span class="op" id="4677078">(</span><span class="ident" id="4677079">n</span><span class="op" id="4677080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677083">switch</span>&nbsp;<span class="ident" id="4677090">arg</span>&nbsp;<span class="op" id="4677094">:=</span>&nbsp;<span class="ident" id="4677097">n</span><span class="op" id="4677098">.</span><span class="op" id="4677099">(</span><span class="keyword" id="4677100">type</span><span class="op" id="4677104">)</span>&nbsp;<span class="op" id="4677106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677109">case</span>&nbsp;<span class="op" id="4677114">*</span><span class="ident" id="4677115">parse</span><span class="op" id="4677120">.</span><span class="ident" id="4677121">DotNode</span><span class="op" id="4677128">:</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677132">return</span>&nbsp;<span class="ident" id="4677139">s</span><span class="op" id="4677140">.</span><span class="ident" id="4677141">validateType</span><span class="op" id="4677153">(</span><span class="ident" id="4677154">dot</span><span class="op" id="4677157">,</span>&nbsp;<span class="ident" id="4677159">typ</span><span class="op" id="4677162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677165">case</span>&nbsp;<span class="op" id="4677170">*</span><span class="ident" id="4677171">parse</span><span class="op" id="4677176">.</span><span class="ident" id="4677177">NilNode</span><span class="op" id="4677184">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677188">if</span>&nbsp;<span class="ident" id="4677191">canBeNil</span><span class="op" id="4677199">(</span><span class="ident" id="4677200">typ</span><span class="op" id="4677203">)</span>&nbsp;<span class="op" id="4677205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677210">return</span>&nbsp;<span class="ident" id="4677217">reflect</span><span class="op" id="4677224">.</span><span class="ident" id="4677225">Zero</span><span class="op" id="4677229">(</span><span class="ident" id="4677230">typ</span><span class="op" id="4677233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4677237">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4677241">s</span><span class="op" id="4677242">.</span><span class="ident" id="4677243">errorf</span><span class="op" id="4677249">(</span><span class="string" id="4677250">&#34;cannot&nbsp;assign&nbsp;nil&nbsp;to&nbsp;%s&#34;</span><span class="op" id="4677275">,</span>&nbsp;<span class="ident" id="4677277">typ</span><span class="op" id="4677280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677283">case</span>&nbsp;<span class="op" id="4677288">*</span><span class="ident" id="4677289">parse</span><span class="op" id="4677294">.</span><span class="ident" id="4677295">FieldNode</span><span class="op" id="4677304">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677308">return</span>&nbsp;<span class="ident" id="4677315">s</span><span class="op" id="4677316">.</span><span class="ident" id="4677317">validateType</span><span class="op" id="4677329">(</span><span class="ident" id="4677330">s</span><span class="op" id="4677331">.</span><span class="ident" id="4677332">evalFieldNode</span><span class="op" id="4677345">(</span><span class="ident" id="4677346">dot</span><span class="op" id="4677349">,</span>&nbsp;<span class="ident" id="4677351">arg</span><span class="op" id="4677354">,</span>&nbsp;<span class="op" id="4677356">[</span><span class="op" id="4677357">]</span><span class="ident" id="4677358">parse</span><span class="op" id="4677363">.</span><span class="ident" id="4677364">Node</span><span class="op" id="4677368">{</span><span class="ident" id="4677369">n</span><span class="op" id="4677370">}</span><span class="op" id="4677371">,</span>&nbsp;<span class="ident" id="4677373">zero</span><span class="op" id="4677377">)</span><span class="op" id="4677378">,</span>&nbsp;<span class="ident" id="4677380">typ</span><span class="op" id="4677383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677386">case</span>&nbsp;<span class="op" id="4677391">*</span><span class="ident" id="4677392">parse</span><span class="op" id="4677397">.</span><span class="ident" id="4677398">VariableNode</span><span class="op" id="4677410">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677414">return</span>&nbsp;<span class="ident" id="4677421">s</span><span class="op" id="4677422">.</span><span class="ident" id="4677423">validateType</span><span class="op" id="4677435">(</span><span class="ident" id="4677436">s</span><span class="op" id="4677437">.</span><span class="ident" id="4677438">evalVariableNode</span><span class="op" id="4677454">(</span><span class="ident" id="4677455">dot</span><span class="op" id="4677458">,</span>&nbsp;<span class="ident" id="4677460">arg</span><span class="op" id="4677463">,</span>&nbsp;<span class="ident" id="4677465">nil</span><span class="op" id="4677468">,</span>&nbsp;<span class="ident" id="4677470">zero</span><span class="op" id="4677474">)</span><span class="op" id="4677475">,</span>&nbsp;<span class="ident" id="4677477">typ</span><span class="op" id="4677480">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677483">case</span>&nbsp;<span class="op" id="4677488">*</span><span class="ident" id="4677489">parse</span><span class="op" id="4677494">.</span><span class="ident" id="4677495">PipeNode</span><span class="op" id="4677503">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677507">return</span>&nbsp;<span class="ident" id="4677514">s</span><span class="op" id="4677515">.</span><span class="ident" id="4677516">validateType</span><span class="op" id="4677528">(</span><span class="ident" id="4677529">s</span><span class="op" id="4677530">.</span><span class="ident" id="4677531">evalPipeline</span><span class="op" id="4677543">(</span><span class="ident" id="4677544">dot</span><span class="op" id="4677547">,</span>&nbsp;<span class="ident" id="4677549">arg</span><span class="op" id="4677552">)</span><span class="op" id="4677553">,</span>&nbsp;<span class="ident" id="4677555">typ</span><span class="op" id="4677558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677561">case</span>&nbsp;<span class="op" id="4677566">*</span><span class="ident" id="4677567">parse</span><span class="op" id="4677572">.</span><span class="ident" id="4677573">IdentifierNode</span><span class="op" id="4677587">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677591">return</span>&nbsp;<span class="ident" id="4677598">s</span><span class="op" id="4677599">.</span><span class="ident" id="4677600">evalFunction</span><span class="op" id="4677612">(</span><span class="ident" id="4677613">dot</span><span class="op" id="4677616">,</span>&nbsp;<span class="ident" id="4677618">arg</span><span class="op" id="4677621">,</span>&nbsp;<span class="ident" id="4677623">arg</span><span class="op" id="4677626">,</span>&nbsp;<span class="ident" id="4677628">nil</span><span class="op" id="4677631">,</span>&nbsp;<span class="ident" id="4677633">zero</span><span class="op" id="4677637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677640">case</span>&nbsp;<span class="op" id="4677645">*</span><span class="ident" id="4677646">parse</span><span class="op" id="4677651">.</span><span class="ident" id="4677652">ChainNode</span><span class="op" id="4677661">:</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677665">return</span>&nbsp;<span class="ident" id="4677672">s</span><span class="op" id="4677673">.</span><span class="ident" id="4677674">validateType</span><span class="op" id="4677686">(</span><span class="ident" id="4677687">s</span><span class="op" id="4677688">.</span><span class="ident" id="4677689">evalChainNode</span><span class="op" id="4677702">(</span><span class="ident" id="4677703">dot</span><span class="op" id="4677706">,</span>&nbsp;<span class="ident" id="4677708">arg</span><span class="op" id="4677711">,</span>&nbsp;<span class="ident" id="4677713">nil</span><span class="op" id="4677716">,</span>&nbsp;<span class="ident" id="4677718">zero</span><span class="op" id="4677722">)</span><span class="op" id="4677723">,</span>&nbsp;<span class="ident" id="4677725">typ</span><span class="op" id="4677728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4677731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677734">switch</span>&nbsp;<span class="ident" id="4677741">typ</span><span class="op" id="4677744">.</span><span class="ident" id="4677745">Kind</span><span class="op" id="4677749">(</span><span class="op" id="4677750">)</span>&nbsp;<span class="op" id="4677752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677755">case</span>&nbsp;<span class="ident" id="4677760">reflect</span><span class="op" id="4677767">.</span><span class="ident" id="4677768">Bool</span><span class="op" id="4677772">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677776">return</span>&nbsp;<span class="ident" id="4677783">s</span><span class="op" id="4677784">.</span><span class="ident" id="4677785">evalBool</span><span class="op" id="4677793">(</span><span class="ident" id="4677794">typ</span><span class="op" id="4677797">,</span>&nbsp;<span class="ident" id="4677799">n</span><span class="op" id="4677800">)</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677803">case</span>&nbsp;<span class="ident" id="4677808">reflect</span><span class="op" id="4677815">.</span><span class="ident" id="4677816">Complex64</span><span class="op" id="4677825">,</span>&nbsp;<span class="ident" id="4677827">reflect</span><span class="op" id="4677834">.</span><span class="ident" id="4677835">Complex128</span><span class="op" id="4677845">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677849">return</span>&nbsp;<span class="ident" id="4677856">s</span><span class="op" id="4677857">.</span><span class="ident" id="4677858">evalComplex</span><span class="op" id="4677869">(</span><span class="ident" id="4677870">typ</span><span class="op" id="4677873">,</span>&nbsp;<span class="ident" id="4677875">n</span><span class="op" id="4677876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677879">case</span>&nbsp;<span class="ident" id="4677884">reflect</span><span class="op" id="4677891">.</span><span class="ident" id="4677892">Float32</span><span class="op" id="4677899">,</span>&nbsp;<span class="ident" id="4677901">reflect</span><span class="op" id="4677908">.</span><span class="ident" id="4677909">Float64</span><span class="op" id="4677916">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677920">return</span>&nbsp;<span class="ident" id="4677927">s</span><span class="op" id="4677928">.</span><span class="ident" id="4677929">evalFloat</span><span class="op" id="4677938">(</span><span class="ident" id="4677939">typ</span><span class="op" id="4677942">,</span>&nbsp;<span class="ident" id="4677944">n</span><span class="op" id="4677945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4677948">case</span>&nbsp;<span class="ident" id="4677953">reflect</span><span class="op" id="4677960">.</span><span class="ident" id="4677961">Int</span><span class="op" id="4677964">,</span>&nbsp;<span class="ident" id="4677966">reflect</span><span class="op" id="4677973">.</span><span class="ident" id="4677974">Int8</span><span class="op" id="4677978">,</span>&nbsp;<span class="ident" id="4677980">reflect</span><span class="op" id="4677987">.</span><span class="ident" id="4677988">Int16</span><span class="op" id="4677993">,</span>&nbsp;<span class="ident" id="4677995">reflect</span><span class="op" id="4678002">.</span><span class="ident" id="4678003">Int32</span><span class="op" id="4678008">,</span>&nbsp;<span class="ident" id="4678010">reflect</span><span class="op" id="4678017">.</span><span class="ident" id="4678018">Int64</span><span class="op" id="4678023">:</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678027">return</span>&nbsp;<span class="ident" id="4678034">s</span><span class="op" id="4678035">.</span><span class="ident" id="4678036">evalInteger</span><span class="op" id="4678047">(</span><span class="ident" id="4678048">typ</span><span class="op" id="4678051">,</span>&nbsp;<span class="ident" id="4678053">n</span><span class="op" id="4678054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678057">case</span>&nbsp;<span class="ident" id="4678062">reflect</span><span class="op" id="4678069">.</span><span class="ident" id="4678070">Interface</span><span class="op" id="4678079">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678083">if</span>&nbsp;<span class="ident" id="4678086">typ</span><span class="op" id="4678089">.</span><span class="ident" id="4678090">NumMethod</span><span class="op" id="4678099">(</span><span class="op" id="4678100">)</span>&nbsp;<span class="op" id="4678102">==</span>&nbsp;<span class="num" id="4678105">0</span>&nbsp;<span class="op" id="4678107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678112">return</span>&nbsp;<span class="ident" id="4678119">s</span><span class="op" id="4678120">.</span><span class="ident" id="4678121">evalEmptyInterface</span><span class="op" id="4678139">(</span><span class="ident" id="4678140">dot</span><span class="op" id="4678143">,</span>&nbsp;<span class="ident" id="4678145">n</span><span class="op" id="4678146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4678150">}</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678153">case</span>&nbsp;<span class="ident" id="4678158">reflect</span><span class="op" id="4678165">.</span><span class="ident" id="4678166">String</span><span class="op" id="4678172">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678176">return</span>&nbsp;<span class="ident" id="4678183">s</span><span class="op" id="4678184">.</span><span class="ident" id="4678185">evalString</span><span class="op" id="4678195">(</span><span class="ident" id="4678196">typ</span><span class="op" id="4678199">,</span>&nbsp;<span class="ident" id="4678201">n</span><span class="op" id="4678202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678205">case</span>&nbsp;<span class="ident" id="4678210">reflect</span><span class="op" id="4678217">.</span><span class="ident" id="4678218">Uint</span><span class="op" id="4678222">,</span>&nbsp;<span class="ident" id="4678224">reflect</span><span class="op" id="4678231">.</span><span class="ident" id="4678232">Uint8</span><span class="op" id="4678237">,</span>&nbsp;<span class="ident" id="4678239">reflect</span><span class="op" id="4678246">.</span><span class="ident" id="4678247">Uint16</span><span class="op" id="4678253">,</span>&nbsp;<span class="ident" id="4678255">reflect</span><span class="op" id="4678262">.</span><span class="ident" id="4678263">Uint32</span><span class="op" id="4678269">,</span>&nbsp;<span class="ident" id="4678271">reflect</span><span class="op" id="4678278">.</span><span class="ident" id="4678279">Uint64</span><span class="op" id="4678285">,</span>&nbsp;<span class="ident" id="4678287">reflect</span><span class="op" id="4678294">.</span><span class="ident" id="4678295">Uintptr</span><span class="op" id="4678302">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678306">return</span>&nbsp;<span class="ident" id="4678313">s</span><span class="op" id="4678314">.</span><span class="ident" id="4678315">evalUnsignedInteger</span><span class="op" id="4678334">(</span><span class="ident" id="4678335">typ</span><span class="op" id="4678338">,</span>&nbsp;<span class="ident" id="4678340">n</span><span class="op" id="4678341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4678344">}</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678347">s</span><span class="op" id="4678348">.</span><span class="ident" id="4678349">errorf</span><span class="op" id="4678355">(</span><span class="string" id="4678356">&#34;can&#39;t&nbsp;handle&nbsp;%s&nbsp;for&nbsp;arg&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="4678392">,</span>&nbsp;<span class="ident" id="4678394">n</span><span class="op" id="4678395">,</span>&nbsp;<span class="ident" id="4678397">typ</span><span class="op" id="4678400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4678403">panic</span><span class="op" id="4678408">(</span><span class="string" id="4678409">&#34;not&nbsp;reached&#34;</span><span class="op" id="4678422">)</span><br>
<span class="lineno"></span><span class="op" id="4678424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4678427">func</span>&nbsp;<span class="op" id="4678432">(</span><span class="ident" id="4678433">s</span>&nbsp;<span class="op" id="4678435">*</span><span class="ident" id="4678436">state</span><span class="op" id="4678441">)</span>&nbsp;<span class="ident" id="4678443">evalBool</span><span class="op" id="4678451">(</span><span class="ident" id="4678452">typ</span>&nbsp;<span class="ident" id="4678456">reflect</span><span class="op" id="4678463">.</span><span class="ident" id="4678464">Type</span><span class="op" id="4678468">,</span>&nbsp;<span class="ident" id="4678470">n</span>&nbsp;<span class="ident" id="4678472">parse</span><span class="op" id="4678477">.</span><span class="ident" id="4678478">Node</span><span class="op" id="4678482">)</span>&nbsp;<span class="ident" id="4678484">reflect</span><span class="op" id="4678491">.</span><span class="ident" id="4678492">Value</span>&nbsp;<span class="op" id="4678498">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678501">s</span><span class="op" id="4678502">.</span><span class="ident" id="4678503">at</span><span class="op" id="4678505">(</span><span class="ident" id="4678506">n</span><span class="op" id="4678507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678510">if</span>&nbsp;<span class="ident" id="4678513">n</span><span class="op" id="4678514">,</span>&nbsp;<span class="ident" id="4678516">ok</span>&nbsp;<span class="op" id="4678519">:=</span>&nbsp;<span class="ident" id="4678522">n</span><span class="op" id="4678523">.</span><span class="op" id="4678524">(</span><span class="op" id="4678525">*</span><span class="ident" id="4678526">parse</span><span class="op" id="4678531">.</span><span class="ident" id="4678532">BoolNode</span><span class="op" id="4678540">)</span><span class="op" id="4678541">;</span>&nbsp;<span class="ident" id="4678543">ok</span>&nbsp;<span class="op" id="4678546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678550">value</span>&nbsp;<span class="op" id="4678556">:=</span>&nbsp;<span class="ident" id="4678559">reflect</span><span class="op" id="4678566">.</span><span class="ident" id="4678567">New</span><span class="op" id="4678570">(</span><span class="ident" id="4678571">typ</span><span class="op" id="4678574">)</span><span class="op" id="4678575">.</span><span class="ident" id="4678576">Elem</span><span class="op" id="4678580">(</span><span class="op" id="4678581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678585">value</span><span class="op" id="4678590">.</span><span class="ident" id="4678591">SetBool</span><span class="op" id="4678598">(</span><span class="ident" id="4678599">n</span><span class="op" id="4678600">.</span><span class="ident" id="4678601">True</span><span class="op" id="4678605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678609">return</span>&nbsp;<span class="ident" id="4678616">value</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4678623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678626">s</span><span class="op" id="4678627">.</span><span class="ident" id="4678628">errorf</span><span class="op" id="4678634">(</span><span class="string" id="4678635">&#34;expected&nbsp;bool;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="4678660">,</span>&nbsp;<span class="ident" id="4678662">n</span><span class="op" id="4678663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4678666">panic</span><span class="op" id="4678671">(</span><span class="string" id="4678672">&#34;not&nbsp;reached&#34;</span><span class="op" id="4678685">)</span><br>
<span class="lineno"></span><span class="op" id="4678687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span><span class="keyword" id="4678690">func</span>&nbsp;<span class="op" id="4678695">(</span><span class="ident" id="4678696">s</span>&nbsp;<span class="op" id="4678698">*</span><span class="ident" id="4678699">state</span><span class="op" id="4678704">)</span>&nbsp;<span class="ident" id="4678706">evalString</span><span class="op" id="4678716">(</span><span class="ident" id="4678717">typ</span>&nbsp;<span class="ident" id="4678721">reflect</span><span class="op" id="4678728">.</span><span class="ident" id="4678729">Type</span><span class="op" id="4678733">,</span>&nbsp;<span class="ident" id="4678735">n</span>&nbsp;<span class="ident" id="4678737">parse</span><span class="op" id="4678742">.</span><span class="ident" id="4678743">Node</span><span class="op" id="4678747">)</span>&nbsp;<span class="ident" id="4678749">reflect</span><span class="op" id="4678756">.</span><span class="ident" id="4678757">Value</span>&nbsp;<span class="op" id="4678763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678766">s</span><span class="op" id="4678767">.</span><span class="ident" id="4678768">at</span><span class="op" id="4678770">(</span><span class="ident" id="4678771">n</span><span class="op" id="4678772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678775">if</span>&nbsp;<span class="ident" id="4678778">n</span><span class="op" id="4678779">,</span>&nbsp;<span class="ident" id="4678781">ok</span>&nbsp;<span class="op" id="4678784">:=</span>&nbsp;<span class="ident" id="4678787">n</span><span class="op" id="4678788">.</span><span class="op" id="4678789">(</span><span class="op" id="4678790">*</span><span class="ident" id="4678791">parse</span><span class="op" id="4678796">.</span><span class="ident" id="4678797">StringNode</span><span class="op" id="4678807">)</span><span class="op" id="4678808">;</span>&nbsp;<span class="ident" id="4678810">ok</span>&nbsp;<span class="op" id="4678813">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678817">value</span>&nbsp;<span class="op" id="4678823">:=</span>&nbsp;<span class="ident" id="4678826">reflect</span><span class="op" id="4678833">.</span><span class="ident" id="4678834">New</span><span class="op" id="4678837">(</span><span class="ident" id="4678838">typ</span><span class="op" id="4678841">)</span><span class="op" id="4678842">.</span><span class="ident" id="4678843">Elem</span><span class="op" id="4678847">(</span><span class="op" id="4678848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678852">value</span><span class="op" id="4678857">.</span><span class="ident" id="4678858">SetString</span><span class="op" id="4678867">(</span><span class="ident" id="4678868">n</span><span class="op" id="4678869">.</span><span class="ident" id="4678870">Text</span><span class="op" id="4678874">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4678878">return</span>&nbsp;<span class="ident" id="4678885">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4678892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4678895">s</span><span class="op" id="4678896">.</span><span class="ident" id="4678897">errorf</span><span class="op" id="4678903">(</span><span class="string" id="4678904">&#34;expected&nbsp;string;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="4678931">,</span>&nbsp;<span class="ident" id="4678933">n</span><span class="op" id="4678934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4678937">panic</span><span class="op" id="4678942">(</span><span class="string" id="4678943">&#34;not&nbsp;reached&#34;</span><span class="op" id="4678956">)</span><br>
<span class="lineno"></span><span class="op" id="4678958">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="keyword" id="4678961">func</span>&nbsp;<span class="op" id="4678966">(</span><span class="ident" id="4678967">s</span>&nbsp;<span class="op" id="4678969">*</span><span class="ident" id="4678970">state</span><span class="op" id="4678975">)</span>&nbsp;<span class="ident" id="4678977">evalInteger</span><span class="op" id="4678988">(</span><span class="ident" id="4678989">typ</span>&nbsp;<span class="ident" id="4678993">reflect</span><span class="op" id="4679000">.</span><span class="ident" id="4679001">Type</span><span class="op" id="4679005">,</span>&nbsp;<span class="ident" id="4679007">n</span>&nbsp;<span class="ident" id="4679009">parse</span><span class="op" id="4679014">.</span><span class="ident" id="4679015">Node</span><span class="op" id="4679019">)</span>&nbsp;<span class="ident" id="4679021">reflect</span><span class="op" id="4679028">.</span><span class="ident" id="4679029">Value</span>&nbsp;<span class="op" id="4679035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679038">s</span><span class="op" id="4679039">.</span><span class="ident" id="4679040">at</span><span class="op" id="4679042">(</span><span class="ident" id="4679043">n</span><span class="op" id="4679044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4679047">if</span>&nbsp;<span class="ident" id="4679050">n</span><span class="op" id="4679051">,</span>&nbsp;<span class="ident" id="4679053">ok</span>&nbsp;<span class="op" id="4679056">:=</span>&nbsp;<span class="ident" id="4679059">n</span><span class="op" id="4679060">.</span><span class="op" id="4679061">(</span><span class="op" id="4679062">*</span><span class="ident" id="4679063">parse</span><span class="op" id="4679068">.</span><span class="ident" id="4679069">NumberNode</span><span class="op" id="4679079">)</span><span class="op" id="4679080">;</span>&nbsp;<span class="ident" id="4679082">ok</span>&nbsp;<span class="op" id="4679085">&amp;&amp;</span>&nbsp;<span class="ident" id="4679088">n</span><span class="op" id="4679089">.</span><span class="ident" id="4679090">IsInt</span>&nbsp;<span class="op" id="4679096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679100">value</span>&nbsp;<span class="op" id="4679106">:=</span>&nbsp;<span class="ident" id="4679109">reflect</span><span class="op" id="4679116">.</span><span class="ident" id="4679117">New</span><span class="op" id="4679120">(</span><span class="ident" id="4679121">typ</span><span class="op" id="4679124">)</span><span class="op" id="4679125">.</span><span class="ident" id="4679126">Elem</span><span class="op" id="4679130">(</span><span class="op" id="4679131">)</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679135">value</span><span class="op" id="4679140">.</span><span class="ident" id="4679141">SetInt</span><span class="op" id="4679147">(</span><span class="ident" id="4679148">n</span><span class="op" id="4679149">.</span><span class="ident" id="4679150">Int64</span><span class="op" id="4679155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4679159">return</span>&nbsp;<span class="ident" id="4679166">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4679173">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679176">s</span><span class="op" id="4679177">.</span><span class="ident" id="4679178">errorf</span><span class="op" id="4679184">(</span><span class="string" id="4679185">&#34;expected&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="4679213">,</span>&nbsp;<span class="ident" id="4679215">n</span><span class="op" id="4679216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4679219">panic</span><span class="op" id="4679224">(</span><span class="string" id="4679225">&#34;not&nbsp;reached&#34;</span><span class="op" id="4679238">)</span><br>
<span class="lineno">695</span><span class="op" id="4679240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4679243">func</span>&nbsp;<span class="op" id="4679248">(</span><span class="ident" id="4679249">s</span>&nbsp;<span class="op" id="4679251">*</span><span class="ident" id="4679252">state</span><span class="op" id="4679257">)</span>&nbsp;<span class="ident" id="4679259">evalUnsignedInteger</span><span class="op" id="4679278">(</span><span class="ident" id="4679279">typ</span>&nbsp;<span class="ident" id="4679283">reflect</span><span class="op" id="4679290">.</span><span class="ident" id="4679291">Type</span><span class="op" id="4679295">,</span>&nbsp;<span class="ident" id="4679297">n</span>&nbsp;<span class="ident" id="4679299">parse</span><span class="op" id="4679304">.</span><span class="ident" id="4679305">Node</span><span class="op" id="4679309">)</span>&nbsp;<span class="ident" id="4679311">reflect</span><span class="op" id="4679318">.</span><span class="ident" id="4679319">Value</span>&nbsp;<span class="op" id="4679325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679328">s</span><span class="op" id="4679329">.</span><span class="ident" id="4679330">at</span><span class="op" id="4679332">(</span><span class="ident" id="4679333">n</span><span class="op" id="4679334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4679337">if</span>&nbsp;<span class="ident" id="4679340">n</span><span class="op" id="4679341">,</span>&nbsp;<span class="ident" id="4679343">ok</span>&nbsp;<span class="op" id="4679346">:=</span>&nbsp;<span class="ident" id="4679349">n</span><span class="op" id="4679350">.</span><span class="op" id="4679351">(</span><span class="op" id="4679352">*</span><span class="ident" id="4679353">parse</span><span class="op" id="4679358">.</span><span class="ident" id="4679359">NumberNode</span><span class="op" id="4679369">)</span><span class="op" id="4679370">;</span>&nbsp;<span class="ident" id="4679372">ok</span>&nbsp;<span class="op" id="4679375">&amp;&amp;</span>&nbsp;<span class="ident" id="4679378">n</span><span class="op" id="4679379">.</span><span class="ident" id="4679380">IsUint</span>&nbsp;<span class="op" id="4679387">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679391">value</span>&nbsp;<span class="op" id="4679397">:=</span>&nbsp;<span class="ident" id="4679400">reflect</span><span class="op" id="4679407">.</span><span class="ident" id="4679408">New</span><span class="op" id="4679411">(</span><span class="ident" id="4679412">typ</span><span class="op" id="4679415">)</span><span class="op" id="4679416">.</span><span class="ident" id="4679417">Elem</span><span class="op" id="4679421">(</span><span class="op" id="4679422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679426">value</span><span class="op" id="4679431">.</span><span class="ident" id="4679432">SetUint</span><span class="op" id="4679439">(</span><span class="ident" id="4679440">n</span><span class="op" id="4679441">.</span><span class="ident" id="4679442">Uint64</span><span class="op" id="4679448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4679452">return</span>&nbsp;<span class="ident" id="4679459">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4679466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679469">s</span><span class="op" id="4679470">.</span><span class="ident" id="4679471">errorf</span><span class="op" id="4679477">(</span><span class="string" id="4679478">&#34;expected&nbsp;unsigned&nbsp;integer;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="4679515">,</span>&nbsp;<span class="ident" id="4679517">n</span><span class="op" id="4679518">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4679521">panic</span><span class="op" id="4679526">(</span><span class="string" id="4679527">&#34;not&nbsp;reached&#34;</span><span class="op" id="4679540">)</span><br>
<span class="lineno"></span><span class="op" id="4679542">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4679545">func</span>&nbsp;<span class="op" id="4679550">(</span><span class="ident" id="4679551">s</span>&nbsp;<span class="op" id="4679553">*</span><span class="ident" id="4679554">state</span><span class="op" id="4679559">)</span>&nbsp;<span class="ident" id="4679561">evalFloat</span><span class="op" id="4679570">(</span><span class="ident" id="4679571">typ</span>&nbsp;<span class="ident" id="4679575">reflect</span><span class="op" id="4679582">.</span><span class="ident" id="4679583">Type</span><span class="op" id="4679587">,</span>&nbsp;<span class="ident" id="4679589">n</span>&nbsp;<span class="ident" id="4679591">parse</span><span class="op" id="4679596">.</span><span class="ident" id="4679597">Node</span><span class="op" id="4679601">)</span>&nbsp;<span class="ident" id="4679603">reflect</span><span class="op" id="4679610">.</span><span class="ident" id="4679611">Value</span>&nbsp;<span class="op" id="4679617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679620">s</span><span class="op" id="4679621">.</span><span class="ident" id="4679622">at</span><span class="op" id="4679624">(</span><span class="ident" id="4679625">n</span><span class="op" id="4679626">)</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4679629">if</span>&nbsp;<span class="ident" id="4679632">n</span><span class="op" id="4679633">,</span>&nbsp;<span class="ident" id="4679635">ok</span>&nbsp;<span class="op" id="4679638">:=</span>&nbsp;<span class="ident" id="4679641">n</span><span class="op" id="4679642">.</span><span class="op" id="4679643">(</span><span class="op" id="4679644">*</span><span class="ident" id="4679645">parse</span><span class="op" id="4679650">.</span><span class="ident" id="4679651">NumberNode</span><span class="op" id="4679661">)</span><span class="op" id="4679662">;</span>&nbsp;<span class="ident" id="4679664">ok</span>&nbsp;<span class="op" id="4679667">&amp;&amp;</span>&nbsp;<span class="ident" id="4679670">n</span><span class="op" id="4679671">.</span><span class="ident" id="4679672">IsFloat</span>&nbsp;<span class="op" id="4679680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679684">value</span>&nbsp;<span class="op" id="4679690">:=</span>&nbsp;<span class="ident" id="4679693">reflect</span><span class="op" id="4679700">.</span><span class="ident" id="4679701">New</span><span class="op" id="4679704">(</span><span class="ident" id="4679705">typ</span><span class="op" id="4679708">)</span><span class="op" id="4679709">.</span><span class="ident" id="4679710">Elem</span><span class="op" id="4679714">(</span><span class="op" id="4679715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679719">value</span><span class="op" id="4679724">.</span><span class="ident" id="4679725">SetFloat</span><span class="op" id="4679733">(</span><span class="ident" id="4679734">n</span><span class="op" id="4679735">.</span><span class="ident" id="4679736">Float64</span><span class="op" id="4679743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4679747">return</span>&nbsp;<span class="ident" id="4679754">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4679761">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679764">s</span><span class="op" id="4679765">.</span><span class="ident" id="4679766">errorf</span><span class="op" id="4679772">(</span><span class="string" id="4679773">&#34;expected&nbsp;float;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="4679799">,</span>&nbsp;<span class="ident" id="4679801">n</span><span class="op" id="4679802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4679805">panic</span><span class="op" id="4679810">(</span><span class="string" id="4679811">&#34;not&nbsp;reached&#34;</span><span class="op" id="4679824">)</span><br>
<span class="lineno"></span><span class="op" id="4679826">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4679829">func</span>&nbsp;<span class="op" id="4679834">(</span><span class="ident" id="4679835">s</span>&nbsp;<span class="op" id="4679837">*</span><span class="ident" id="4679838">state</span><span class="op" id="4679843">)</span>&nbsp;<span class="ident" id="4679845">evalComplex</span><span class="op" id="4679856">(</span><span class="ident" id="4679857">typ</span>&nbsp;<span class="ident" id="4679861">reflect</span><span class="op" id="4679868">.</span><span class="ident" id="4679869">Type</span><span class="op" id="4679873">,</span>&nbsp;<span class="ident" id="4679875">n</span>&nbsp;<span class="ident" id="4679877">parse</span><span class="op" id="4679882">.</span><span class="ident" id="4679883">Node</span><span class="op" id="4679887">)</span>&nbsp;<span class="ident" id="4679889">reflect</span><span class="op" id="4679896">.</span><span class="ident" id="4679897">Value</span>&nbsp;<span class="op" id="4679903">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4679906">if</span>&nbsp;<span class="ident" id="4679909">n</span><span class="op" id="4679910">,</span>&nbsp;<span class="ident" id="4679912">ok</span>&nbsp;<span class="op" id="4679915">:=</span>&nbsp;<span class="ident" id="4679918">n</span><span class="op" id="4679919">.</span><span class="op" id="4679920">(</span><span class="op" id="4679921">*</span><span class="ident" id="4679922">parse</span><span class="op" id="4679927">.</span><span class="ident" id="4679928">NumberNode</span><span class="op" id="4679938">)</span><span class="op" id="4679939">;</span>&nbsp;<span class="ident" id="4679941">ok</span>&nbsp;<span class="op" id="4679944">&amp;&amp;</span>&nbsp;<span class="ident" id="4679947">n</span><span class="op" id="4679948">.</span><span class="ident" id="4679949">IsComplex</span>&nbsp;<span class="op" id="4679959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679963">value</span>&nbsp;<span class="op" id="4679969">:=</span>&nbsp;<span class="ident" id="4679972">reflect</span><span class="op" id="4679979">.</span><span class="ident" id="4679980">New</span><span class="op" id="4679983">(</span><span class="ident" id="4679984">typ</span><span class="op" id="4679987">)</span><span class="op" id="4679988">.</span><span class="ident" id="4679989">Elem</span><span class="op" id="4679993">(</span><span class="op" id="4679994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4679998">value</span><span class="op" id="4680003">.</span><span class="ident" id="4680004">SetComplex</span><span class="op" id="4680014">(</span><span class="ident" id="4680015">n</span><span class="op" id="4680016">.</span><span class="ident" id="4680017">Complex128</span><span class="op" id="4680027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680031">return</span>&nbsp;<span class="ident" id="4680038">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4680045">}</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4680048">s</span><span class="op" id="4680049">.</span><span class="ident" id="4680050">errorf</span><span class="op" id="4680056">(</span><span class="string" id="4680057">&#34;expected&nbsp;complex;&nbsp;found&nbsp;%s&#34;</span><span class="op" id="4680085">,</span>&nbsp;<span class="ident" id="4680087">n</span><span class="op" id="4680088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4680091">panic</span><span class="op" id="4680096">(</span><span class="string" id="4680097">&#34;not&nbsp;reached&#34;</span><span class="op" id="4680110">)</span><br>
<span class="lineno"></span><span class="op" id="4680112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4680115">func</span>&nbsp;<span class="op" id="4680120">(</span><span class="ident" id="4680121">s</span>&nbsp;<span class="op" id="4680123">*</span><span class="ident" id="4680124">state</span><span class="op" id="4680129">)</span>&nbsp;<span class="ident" id="4680131">evalEmptyInterface</span><span class="op" id="4680149">(</span><span class="ident" id="4680150">dot</span>&nbsp;<span class="ident" id="4680154">reflect</span><span class="op" id="4680161">.</span><span class="ident" id="4680162">Value</span><span class="op" id="4680167">,</span>&nbsp;<span class="ident" id="4680169">n</span>&nbsp;<span class="ident" id="4680171">parse</span><span class="op" id="4680176">.</span><span class="ident" id="4680177">Node</span><span class="op" id="4680181">)</span>&nbsp;<span class="ident" id="4680183">reflect</span><span class="op" id="4680190">.</span><span class="ident" id="4680191">Value</span>&nbsp;<span class="op" id="4680197">{</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4680200">s</span><span class="op" id="4680201">.</span><span class="ident" id="4680202">at</span><span class="op" id="4680204">(</span><span class="ident" id="4680205">n</span><span class="op" id="4680206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680209">switch</span>&nbsp;<span class="ident" id="4680216">n</span>&nbsp;<span class="op" id="4680218">:=</span>&nbsp;<span class="ident" id="4680221">n</span><span class="op" id="4680222">.</span><span class="op" id="4680223">(</span><span class="keyword" id="4680224">type</span><span class="op" id="4680228">)</span>&nbsp;<span class="op" id="4680230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680233">case</span>&nbsp;<span class="op" id="4680238">*</span><span class="ident" id="4680239">parse</span><span class="op" id="4680244">.</span><span class="ident" id="4680245">BoolNode</span><span class="op" id="4680253">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680257">return</span>&nbsp;<span class="ident" id="4680264">reflect</span><span class="op" id="4680271">.</span><span class="ident" id="4680272">ValueOf</span><span class="op" id="4680279">(</span><span class="ident" id="4680280">n</span><span class="op" id="4680281">.</span><span class="ident" id="4680282">True</span><span class="op" id="4680286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680289">case</span>&nbsp;<span class="op" id="4680294">*</span><span class="ident" id="4680295">parse</span><span class="op" id="4680300">.</span><span class="ident" id="4680301">DotNode</span><span class="op" id="4680308">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680312">return</span>&nbsp;<span class="ident" id="4680319">dot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680324">case</span>&nbsp;<span class="op" id="4680329">*</span><span class="ident" id="4680330">parse</span><span class="op" id="4680335">.</span><span class="ident" id="4680336">FieldNode</span><span class="op" id="4680345">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680349">return</span>&nbsp;<span class="ident" id="4680356">s</span><span class="op" id="4680357">.</span><span class="ident" id="4680358">evalFieldNode</span><span class="op" id="4680371">(</span><span class="ident" id="4680372">dot</span><span class="op" id="4680375">,</span>&nbsp;<span class="ident" id="4680377">n</span><span class="op" id="4680378">,</span>&nbsp;<span class="ident" id="4680380">nil</span><span class="op" id="4680383">,</span>&nbsp;<span class="ident" id="4680385">zero</span><span class="op" id="4680389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680392">case</span>&nbsp;<span class="op" id="4680397">*</span><span class="ident" id="4680398">parse</span><span class="op" id="4680403">.</span><span class="ident" id="4680404">IdentifierNode</span><span class="op" id="4680418">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680422">return</span>&nbsp;<span class="ident" id="4680429">s</span><span class="op" id="4680430">.</span><span class="ident" id="4680431">evalFunction</span><span class="op" id="4680443">(</span><span class="ident" id="4680444">dot</span><span class="op" id="4680447">,</span>&nbsp;<span class="ident" id="4680449">n</span><span class="op" id="4680450">,</span>&nbsp;<span class="ident" id="4680452">n</span><span class="op" id="4680453">,</span>&nbsp;<span class="ident" id="4680455">nil</span><span class="op" id="4680458">,</span>&nbsp;<span class="ident" id="4680460">zero</span><span class="op" id="4680464">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680467">case</span>&nbsp;<span class="op" id="4680472">*</span><span class="ident" id="4680473">parse</span><span class="op" id="4680478">.</span><span class="ident" id="4680479">NilNode</span><span class="op" id="4680486">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4680490">//&nbsp;NilNode&nbsp;is&nbsp;handled&nbsp;in&nbsp;evalArg,&nbsp;the&nbsp;only&nbsp;place&nbsp;that&nbsp;calls&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4680558">s</span><span class="op" id="4680559">.</span><span class="ident" id="4680560">errorf</span><span class="op" id="4680566">(</span><span class="string" id="4680567">&#34;evalEmptyInterface:&nbsp;nil&nbsp;(can&#39;t&nbsp;happen)&#34;</span><span class="op" id="4680607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680610">case</span>&nbsp;<span class="op" id="4680615">*</span><span class="ident" id="4680616">parse</span><span class="op" id="4680621">.</span><span class="ident" id="4680622">NumberNode</span><span class="op" id="4680632">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680636">return</span>&nbsp;<span class="ident" id="4680643">s</span><span class="op" id="4680644">.</span><span class="ident" id="4680645">idealConstant</span><span class="op" id="4680658">(</span><span class="ident" id="4680659">n</span><span class="op" id="4680660">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680663">case</span>&nbsp;<span class="op" id="4680668">*</span><span class="ident" id="4680669">parse</span><span class="op" id="4680674">.</span><span class="ident" id="4680675">StringNode</span><span class="op" id="4680685">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680689">return</span>&nbsp;<span class="ident" id="4680696">reflect</span><span class="op" id="4680703">.</span><span class="ident" id="4680704">ValueOf</span><span class="op" id="4680711">(</span><span class="ident" id="4680712">n</span><span class="op" id="4680713">.</span><span class="ident" id="4680714">Text</span><span class="op" id="4680718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680721">case</span>&nbsp;<span class="op" id="4680726">*</span><span class="ident" id="4680727">parse</span><span class="op" id="4680732">.</span><span class="ident" id="4680733">VariableNode</span><span class="op" id="4680745">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680749">return</span>&nbsp;<span class="ident" id="4680756">s</span><span class="op" id="4680757">.</span><span class="ident" id="4680758">evalVariableNode</span><span class="op" id="4680774">(</span><span class="ident" id="4680775">dot</span><span class="op" id="4680778">,</span>&nbsp;<span class="ident" id="4680780">n</span><span class="op" id="4680781">,</span>&nbsp;<span class="ident" id="4680783">nil</span><span class="op" id="4680786">,</span>&nbsp;<span class="ident" id="4680788">zero</span><span class="op" id="4680792">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680795">case</span>&nbsp;<span class="op" id="4680800">*</span><span class="ident" id="4680801">parse</span><span class="op" id="4680806">.</span><span class="ident" id="4680807">PipeNode</span><span class="op" id="4680815">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4680819">return</span>&nbsp;<span class="ident" id="4680826">s</span><span class="op" id="4680827">.</span><span class="ident" id="4680828">evalPipeline</span><span class="op" id="4680840">(</span><span class="ident" id="4680841">dot</span><span class="op" id="4680844">,</span>&nbsp;<span class="ident" id="4680846">n</span><span class="op" id="4680847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4680850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4680853">s</span><span class="op" id="4680854">.</span><span class="ident" id="4680855">errorf</span><span class="op" id="4680861">(</span><span class="string" id="4680862">&#34;can&#39;t&nbsp;handle&nbsp;assignment&nbsp;of&nbsp;%s&nbsp;to&nbsp;empty&nbsp;interface&nbsp;argument&#34;</span><span class="op" id="4680921">,</span>&nbsp;<span class="ident" id="4680923">n</span><span class="op" id="4680924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4680927">panic</span><span class="op" id="4680932">(</span><span class="string" id="4680933">&#34;not&nbsp;reached&#34;</span><span class="op" id="4680946">)</span><br>
<span class="lineno"></span><span class="op" id="4680948">}</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="comment" id="4680951">//&nbsp;indirect&nbsp;returns&nbsp;the&nbsp;item&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;indirection,&nbsp;and&nbsp;a&nbsp;bool&nbsp;to&nbsp;indicate&nbsp;if&nbsp;it&#39;s&nbsp;nil.</span><br>
<span class="lineno"></span><span class="comment" id="4681043">//&nbsp;We&nbsp;indirect&nbsp;through&nbsp;pointers&nbsp;and&nbsp;empty&nbsp;interfaces&nbsp;(only)&nbsp;because</span><br>
<span class="lineno"></span><span class="comment" id="4681111">//&nbsp;non-empty&nbsp;interfaces&nbsp;have&nbsp;methods&nbsp;we&nbsp;might&nbsp;need.</span><br>
<span class="lineno"></span><span class="keyword" id="4681163">func</span>&nbsp;<span class="ident" id="4681168">indirect</span><span class="op" id="4681176">(</span><span class="ident" id="4681177">v</span>&nbsp;<span class="ident" id="4681179">reflect</span><span class="op" id="4681186">.</span><span class="ident" id="4681187">Value</span><span class="op" id="4681192">)</span>&nbsp;<span class="op" id="4681194">(</span><span class="ident" id="4681195">rv</span>&nbsp;<span class="ident" id="4681198">reflect</span><span class="op" id="4681205">.</span><span class="ident" id="4681206">Value</span><span class="op" id="4681211">,</span>&nbsp;<span class="ident" id="4681213">isNil</span>&nbsp;<span class="builtintype" id="4681219">bool</span><span class="op" id="4681223">)</span>&nbsp;<span class="op" id="4681225">{</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681228">for</span>&nbsp;<span class="op" id="4681232">;</span>&nbsp;<span class="ident" id="4681234">v</span><span class="op" id="4681235">.</span><span class="ident" id="4681236">Kind</span><span class="op" id="4681240">(</span><span class="op" id="4681241">)</span>&nbsp;<span class="op" id="4681243">==</span>&nbsp;<span class="ident" id="4681246">reflect</span><span class="op" id="4681253">.</span><span class="ident" id="4681254">Ptr</span>&nbsp;<span class="op" id="4681258">||</span>&nbsp;<span class="ident" id="4681261">v</span><span class="op" id="4681262">.</span><span class="ident" id="4681263">Kind</span><span class="op" id="4681267">(</span><span class="op" id="4681268">)</span>&nbsp;<span class="op" id="4681270">==</span>&nbsp;<span class="ident" id="4681273">reflect</span><span class="op" id="4681280">.</span><span class="ident" id="4681281">Interface</span><span class="op" id="4681290">;</span>&nbsp;<span class="ident" id="4681292">v</span>&nbsp;<span class="op" id="4681294">=</span>&nbsp;<span class="ident" id="4681296">v</span><span class="op" id="4681297">.</span><span class="ident" id="4681298">Elem</span><span class="op" id="4681302">(</span><span class="op" id="4681303">)</span>&nbsp;<span class="op" id="4681305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681309">if</span>&nbsp;<span class="ident" id="4681312">v</span><span class="op" id="4681313">.</span><span class="ident" id="4681314">IsNil</span><span class="op" id="4681319">(</span><span class="op" id="4681320">)</span>&nbsp;<span class="op" id="4681322">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681327">return</span>&nbsp;<span class="ident" id="4681334">v</span><span class="op" id="4681335">,</span>&nbsp;<span class="ident" id="4681337">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4681344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681348">if</span>&nbsp;<span class="ident" id="4681351">v</span><span class="op" id="4681352">.</span><span class="ident" id="4681353">Kind</span><span class="op" id="4681357">(</span><span class="op" id="4681358">)</span>&nbsp;<span class="op" id="4681360">==</span>&nbsp;<span class="ident" id="4681363">reflect</span><span class="op" id="4681370">.</span><span class="ident" id="4681371">Interface</span>&nbsp;<span class="op" id="4681381">&amp;&amp;</span>&nbsp;<span class="ident" id="4681384">v</span><span class="op" id="4681385">.</span><span class="ident" id="4681386">NumMethod</span><span class="op" id="4681395">(</span><span class="op" id="4681396">)</span>&nbsp;<span class="op" id="4681398">&gt;</span>&nbsp;<span class="num" id="4681400">0</span>&nbsp;<span class="op" id="4681402">{</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681407">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4681415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4681418">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681421">return</span>&nbsp;<span class="ident" id="4681428">v</span><span class="op" id="4681429">,</span>&nbsp;<span class="ident" id="4681431">false</span><br>
<span class="lineno"></span><span class="op" id="4681437">}</span><br>
<span class="lineno">770</span><br>
<span class="lineno"></span><span class="comment" id="4681440">//&nbsp;printValue&nbsp;writes&nbsp;the&nbsp;textual&nbsp;representation&nbsp;of&nbsp;the&nbsp;value&nbsp;to&nbsp;the&nbsp;output&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4681518">//&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="4681535">func</span>&nbsp;<span class="op" id="4681540">(</span><span class="ident" id="4681541">s</span>&nbsp;<span class="op" id="4681543">*</span><span class="ident" id="4681544">state</span><span class="op" id="4681549">)</span>&nbsp;<span class="ident" id="4681551">printValue</span><span class="op" id="4681561">(</span><span class="ident" id="4681562">n</span>&nbsp;<span class="ident" id="4681564">parse</span><span class="op" id="4681569">.</span><span class="ident" id="4681570">Node</span><span class="op" id="4681574">,</span>&nbsp;<span class="ident" id="4681576">v</span>&nbsp;<span class="ident" id="4681578">reflect</span><span class="op" id="4681585">.</span><span class="ident" id="4681586">Value</span><span class="op" id="4681591">)</span>&nbsp;<span class="op" id="4681593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4681596">s</span><span class="op" id="4681597">.</span><span class="ident" id="4681598">at</span><span class="op" id="4681600">(</span><span class="ident" id="4681601">n</span><span class="op" id="4681602">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4681605">iface</span><span class="op" id="4681610">,</span>&nbsp;<span class="ident" id="4681612">ok</span>&nbsp;<span class="op" id="4681615">:=</span>&nbsp;<span class="ident" id="4681618">printableValue</span><span class="op" id="4681632">(</span><span class="ident" id="4681633">v</span><span class="op" id="4681634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681637">if</span>&nbsp;<span class="op" id="4681640">!</span><span class="ident" id="4681641">ok</span>&nbsp;<span class="op" id="4681644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4681648">s</span><span class="op" id="4681649">.</span><span class="ident" id="4681650">errorf</span><span class="op" id="4681656">(</span><span class="string" id="4681657">&#34;can&#39;t&nbsp;print&nbsp;%s&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="4681684">,</span>&nbsp;<span class="ident" id="4681686">n</span><span class="op" id="4681687">,</span>&nbsp;<span class="ident" id="4681689">v</span><span class="op" id="4681690">.</span><span class="ident" id="4681691">Type</span><span class="op" id="4681695">(</span><span class="op" id="4681696">)</span><span class="op" id="4681697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4681700">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4681703">fmt</span><span class="op" id="4681706">.</span><span class="ident" id="4681707">Fprint</span><span class="op" id="4681713">(</span><span class="ident" id="4681714">s</span><span class="op" id="4681715">.</span><span class="ident" id="4681716">wr</span><span class="op" id="4681718">,</span>&nbsp;<span class="ident" id="4681720">iface</span><span class="op" id="4681725">)</span><br>
<span class="lineno">780</span><span class="op" id="4681727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4681730">//&nbsp;printableValue&nbsp;returns&nbsp;the,&nbsp;possibly&nbsp;indirected,&nbsp;interface&nbsp;value&nbsp;inside&nbsp;v&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="4681812">//&nbsp;is&nbsp;best&nbsp;for&nbsp;a&nbsp;call&nbsp;to&nbsp;formatted&nbsp;printer.</span><br>
<span class="lineno"></span><span class="keyword" id="4681856">func</span>&nbsp;<span class="ident" id="4681861">printableValue</span><span class="op" id="4681875">(</span><span class="ident" id="4681876">v</span>&nbsp;<span class="ident" id="4681878">reflect</span><span class="op" id="4681885">.</span><span class="ident" id="4681886">Value</span><span class="op" id="4681891">)</span>&nbsp;<span class="op" id="4681893">(</span><span class="keyword" id="4681894">interface</span><span class="op" id="4681903">{</span><span class="op" id="4681904">}</span><span class="op" id="4681905">,</span>&nbsp;<span class="builtintype" id="4681907">bool</span><span class="op" id="4681911">)</span>&nbsp;<span class="op" id="4681913">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681916">if</span>&nbsp;<span class="ident" id="4681919">v</span><span class="op" id="4681920">.</span><span class="ident" id="4681921">Kind</span><span class="op" id="4681925">(</span><span class="op" id="4681926">)</span>&nbsp;<span class="op" id="4681928">==</span>&nbsp;<span class="ident" id="4681931">reflect</span><span class="op" id="4681938">.</span><span class="ident" id="4681939">Ptr</span>&nbsp;<span class="op" id="4681943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4681947">v</span><span class="op" id="4681948">,</span>&nbsp;<span class="ident" id="4681950">_</span>&nbsp;<span class="op" id="4681952">=</span>&nbsp;<span class="ident" id="4681954">indirect</span><span class="op" id="4681962">(</span><span class="ident" id="4681963">v</span><span class="op" id="4681964">)</span>&nbsp;<span class="comment" id="4681966">//&nbsp;fmt.Fprint&nbsp;handles&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4681994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4681997">if</span>&nbsp;<span class="op" id="4682000">!</span><span class="ident" id="4682001">v</span><span class="op" id="4682002">.</span><span class="ident" id="4682003">IsValid</span><span class="op" id="4682010">(</span><span class="op" id="4682011">)</span>&nbsp;<span class="op" id="4682013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4682017">return</span>&nbsp;<span class="string" id="4682024">&#34;&lt;no&nbsp;value&gt;&#34;</span><span class="op" id="4682036">,</span>&nbsp;<span class="ident" id="4682038">true</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4682044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4682048">if</span>&nbsp;<span class="op" id="4682051">!</span><span class="ident" id="4682052">v</span><span class="op" id="4682053">.</span><span class="ident" id="4682054">Type</span><span class="op" id="4682058">(</span><span class="op" id="4682059">)</span><span class="op" id="4682060">.</span><span class="ident" id="4682061">Implements</span><span class="op" id="4682071">(</span><span class="ident" id="4682072">errorType</span><span class="op" id="4682081">)</span>&nbsp;<span class="op" id="4682083">&amp;&amp;</span>&nbsp;<span class="op" id="4682086">!</span><span class="ident" id="4682087">v</span><span class="op" id="4682088">.</span><span class="ident" id="4682089">Type</span><span class="op" id="4682093">(</span><span class="op" id="4682094">)</span><span class="op" id="4682095">.</span><span class="ident" id="4682096">Implements</span><span class="op" id="4682106">(</span><span class="ident" id="4682107">fmtStringerType</span><span class="op" id="4682122">)</span>&nbsp;<span class="op" id="4682124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4682128">if</span>&nbsp;<span class="ident" id="4682131">v</span><span class="op" id="4682132">.</span><span class="ident" id="4682133">CanAddr</span><span class="op" id="4682140">(</span><span class="op" id="4682141">)</span>&nbsp;<span class="op" id="4682143">&amp;&amp;</span>&nbsp;<span class="op" id="4682146">(</span><span class="ident" id="4682147">reflect</span><span class="op" id="4682154">.</span><span class="ident" id="4682155">PtrTo</span><span class="op" id="4682160">(</span><span class="ident" id="4682161">v</span><span class="op" id="4682162">.</span><span class="ident" id="4682163">Type</span><span class="op" id="4682167">(</span><span class="op" id="4682168">)</span><span class="op" id="4682169">)</span><span class="op" id="4682170">.</span><span class="ident" id="4682171">Implements</span><span class="op" id="4682181">(</span><span class="ident" id="4682182">errorType</span><span class="op" id="4682191">)</span>&nbsp;<span class="op" id="4682193">||</span>&nbsp;<span class="ident" id="4682196">reflect</span><span class="op" id="4682203">.</span><span class="ident" id="4682204">PtrTo</span><span class="op" id="4682209">(</span><span class="ident" id="4682210">v</span><span class="op" id="4682211">.</span><span class="ident" id="4682212">Type</span><span class="op" id="4682216">(</span><span class="op" id="4682217">)</span><span class="op" id="4682218">)</span><span class="op" id="4682219">.</span><span class="ident" id="4682220">Implements</span><span class="op" id="4682230">(</span><span class="ident" id="4682231">fmtStringerType</span><span class="op" id="4682246">)</span><span class="op" id="4682247">)</span>&nbsp;<span class="op" id="4682249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4682254">v</span>&nbsp;<span class="op" id="4682256">=</span>&nbsp;<span class="ident" id="4682258">v</span><span class="op" id="4682259">.</span><span class="ident" id="4682260">Addr</span><span class="op" id="4682264">(</span><span class="op" id="4682265">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4682269">}</span>&nbsp;<span class="keyword" id="4682271">else</span>&nbsp;<span class="op" id="4682276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4682281">switch</span>&nbsp;<span class="ident" id="4682288">v</span><span class="op" id="4682289">.</span><span class="ident" id="4682290">Kind</span><span class="op" id="4682294">(</span><span class="op" id="4682295">)</span>&nbsp;<span class="op" id="4682297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4682302">case</span>&nbsp;<span class="ident" id="4682307">reflect</span><span class="op" id="4682314">.</span><span class="ident" id="4682315">Chan</span><span class="op" id="4682319">,</span>&nbsp;<span class="ident" id="4682321">reflect</span><span class="op" id="4682328">.</span><span class="ident" id="4682329">Func</span><span class="op" id="4682333">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4682339">return</span>&nbsp;<span class="ident" id="4682346">nil</span><span class="op" id="4682349">,</span>&nbsp;<span class="ident" id="4682351">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4682360">}</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4682364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4682367">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4682370">return</span>&nbsp;<span class="ident" id="4682377">v</span><span class="op" id="4682378">.</span><span class="ident" id="4682379">Interface</span><span class="op" id="4682388">(</span><span class="op" id="4682389">)</span><span class="op" id="4682390">,</span>&nbsp;<span class="ident" id="4682392">true</span><br>
<span class="lineno"></span><span class="op" id="4682397">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">805</span><span class="comment" id="4682400">//&nbsp;Types&nbsp;to&nbsp;help&nbsp;sort&nbsp;the&nbsp;keys&nbsp;in&nbsp;a&nbsp;map&nbsp;for&nbsp;reproducible&nbsp;output.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4682466">type</span>&nbsp;<span class="ident" id="4682471">rvs</span>&nbsp;<span class="op" id="4682475">[</span><span class="op" id="4682476">]</span><span class="ident" id="4682477">reflect</span><span class="op" id="4682484">.</span><span class="ident" id="4682485">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4682492">func</span>&nbsp;<span class="op" id="4682497">(</span><span class="ident" id="4682498">x</span>&nbsp;<span class="ident" id="4682500">rvs</span><span class="op" id="4682503">)</span>&nbsp;<span class="ident" id="4682505">Len</span><span class="op" id="4682508">(</span><span class="op" id="4682509">)</span>&nbsp;<span class="builtintype" id="4682511">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4682520">{</span>&nbsp;<span class="keyword" id="4682522">return</span>&nbsp;<span class="builtinfunc" id="4682529">len</span><span class="op" id="4682532">(</span><span class="ident" id="4682533">x</span><span class="op" id="4682534">)</span>&nbsp;<span class="op" id="4682536">}</span><br>
<span class="lineno">810</span><span class="keyword" id="4682538">func</span>&nbsp;<span class="op" id="4682543">(</span><span class="ident" id="4682544">x</span>&nbsp;<span class="ident" id="4682546">rvs</span><span class="op" id="4682549">)</span>&nbsp;<span class="ident" id="4682551">Swap</span><span class="op" id="4682555">(</span><span class="ident" id="4682556">i</span><span class="op" id="4682557">,</span>&nbsp;<span class="ident" id="4682559">j</span>&nbsp;<span class="builtintype" id="4682561">int</span><span class="op" id="4682564">)</span>&nbsp;<span class="op" id="4682566">{</span>&nbsp;<span class="ident" id="4682568">x</span><span class="op" id="4682569">[</span><span class="ident" id="4682570">i</span><span class="op" id="4682571">]</span><span class="op" id="4682572">,</span>&nbsp;<span class="ident" id="4682574">x</span><span class="op" id="4682575">[</span><span class="ident" id="4682576">j</span><span class="op" id="4682577">]</span>&nbsp;<span class="op" id="4682579">=</span>&nbsp;<span class="ident" id="4682581">x</span><span class="op" id="4682582">[</span><span class="ident" id="4682583">j</span><span class="op" id="4682584">]</span><span class="op" id="4682585">,</span>&nbsp;<span class="ident" id="4682587">x</span><span class="op" id="4682588">[</span><span class="ident" id="4682589">i</span><span class="op" id="4682590">]</span>&nbsp;<span class="op" id="4682592">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4682595">type</span>&nbsp;<span class="ident" id="4682600">rvInts</span>&nbsp;<span class="keyword" id="4682607">struct</span><span class="op" id="4682613">{</span>&nbsp;<span class="ident" id="4682615">rvs</span>&nbsp;<span class="op" id="4682619">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4682622">func</span>&nbsp;<span class="op" id="4682627">(</span><span class="ident" id="4682628">x</span>&nbsp;<span class="ident" id="4682630">rvInts</span><span class="op" id="4682636">)</span>&nbsp;<span class="ident" id="4682638">Less</span><span class="op" id="4682642">(</span><span class="ident" id="4682643">i</span><span class="op" id="4682644">,</span>&nbsp;<span class="ident" id="4682646">j</span>&nbsp;<span class="builtintype" id="4682648">int</span><span class="op" id="4682651">)</span>&nbsp;<span class="builtintype" id="4682653">bool</span>&nbsp;<span class="op" id="4682658">{</span>&nbsp;<span class="keyword" id="4682660">return</span>&nbsp;<span class="ident" id="4682667">x</span><span class="op" id="4682668">.</span><span class="ident" id="4682669">rvs</span><span class="op" id="4682672">[</span><span class="ident" id="4682673">i</span><span class="op" id="4682674">]</span><span class="op" id="4682675">.</span><span class="ident" id="4682676">Int</span><span class="op" id="4682679">(</span><span class="op" id="4682680">)</span>&nbsp;<span class="op" id="4682682">&lt;</span>&nbsp;<span class="ident" id="4682684">x</span><span class="op" id="4682685">.</span><span class="ident" id="4682686">rvs</span><span class="op" id="4682689">[</span><span class="ident" id="4682690">j</span><span class="op" id="4682691">]</span><span class="op" id="4682692">.</span><span class="ident" id="4682693">Int</span><span class="op" id="4682696">(</span><span class="op" id="4682697">)</span>&nbsp;<span class="op" id="4682699">}</span><br>
<span class="lineno">815</span><br>
<span class="lineno"></span><span class="keyword" id="4682702">type</span>&nbsp;<span class="ident" id="4682707">rvUints</span>&nbsp;<span class="keyword" id="4682715">struct</span><span class="op" id="4682721">{</span>&nbsp;<span class="ident" id="4682723">rvs</span>&nbsp;<span class="op" id="4682727">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4682730">func</span>&nbsp;<span class="op" id="4682735">(</span><span class="ident" id="4682736">x</span>&nbsp;<span class="ident" id="4682738">rvUints</span><span class="op" id="4682745">)</span>&nbsp;<span class="ident" id="4682747">Less</span><span class="op" id="4682751">(</span><span class="ident" id="4682752">i</span><span class="op" id="4682753">,</span>&nbsp;<span class="ident" id="4682755">j</span>&nbsp;<span class="builtintype" id="4682757">int</span><span class="op" id="4682760">)</span>&nbsp;<span class="builtintype" id="4682762">bool</span>&nbsp;<span class="op" id="4682767">{</span>&nbsp;<span class="keyword" id="4682769">return</span>&nbsp;<span class="ident" id="4682776">x</span><span class="op" id="4682777">.</span><span class="ident" id="4682778">rvs</span><span class="op" id="4682781">[</span><span class="ident" id="4682782">i</span><span class="op" id="4682783">]</span><span class="op" id="4682784">.</span><span class="ident" id="4682785">Uint</span><span class="op" id="4682789">(</span><span class="op" id="4682790">)</span>&nbsp;<span class="op" id="4682792">&lt;</span>&nbsp;<span class="ident" id="4682794">x</span><span class="op" id="4682795">.</span><span class="ident" id="4682796">rvs</span><span class="op" id="4682799">[</span><span class="ident" id="4682800">j</span><span class="op" id="4682801">]</span><span class="op" id="4682802">.</span><span class="ident" id="4682803">Uint</span><span class="op" id="4682807">(</span><span class="op" id="4682808">)</span>&nbsp;<span class="op" id="4682810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">820</span><span class="keyword" id="4682813">type</span>&nbsp;<span class="ident" id="4682818">rvFloats</span>&nbsp;<span class="keyword" id="4682827">struct</span><span class="op" id="4682833">{</span>&nbsp;<span class="ident" id="4682835">rvs</span>&nbsp;<span class="op" id="4682839">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4682842">func</span>&nbsp;<span class="op" id="4682847">(</span><span class="ident" id="4682848">x</span>&nbsp;<span class="ident" id="4682850">rvFloats</span><span class="op" id="4682858">)</span>&nbsp;<span class="ident" id="4682860">Less</span><span class="op" id="4682864">(</span><span class="ident" id="4682865">i</span><span class="op" id="4682866">,</span>&nbsp;<span class="ident" id="4682868">j</span>&nbsp;<span class="builtintype" id="4682870">int</span><span class="op" id="4682873">)</span>&nbsp;<span class="builtintype" id="4682875">bool</span>&nbsp;<span class="op" id="4682880">{</span>&nbsp;<span class="keyword" id="4682882">return</span>&nbsp;<span class="ident" id="4682889">x</span><span class="op" id="4682890">.</span><span class="ident" id="4682891">rvs</span><span class="op" id="4682894">[</span><span class="ident" id="4682895">i</span><span class="op" id="4682896">]</span><span class="op" id="4682897">.</span><span class="ident" id="4682898">Float</span><span class="op" id="4682903">(</span><span class="op" id="4682904">)</span>&nbsp;<span class="op" id="4682906">&lt;</span>&nbsp;<span class="ident" id="4682908">x</span><span class="op" id="4682909">.</span><span class="ident" id="4682910">rvs</span><span class="op" id="4682913">[</span><span class="ident" id="4682914">j</span><span class="op" id="4682915">]</span><span class="op" id="4682916">.</span><span class="ident" id="4682917">Float</span><span class="op" id="4682922">(</span><span class="op" id="4682923">)</span>&nbsp;<span class="op" id="4682925">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4682928">type</span>&nbsp;<span class="ident" id="4682933">rvStrings</span>&nbsp;<span class="keyword" id="4682943">struct</span><span class="op" id="4682949">{</span>&nbsp;<span class="ident" id="4682951">rvs</span>&nbsp;<span class="op" id="4682955">}</span><br>
<span class="lineno">825</span><br>
<span class="lineno"></span><span class="keyword" id="4682958">func</span>&nbsp;<span class="op" id="4682963">(</span><span class="ident" id="4682964">x</span>&nbsp;<span class="ident" id="4682966">rvStrings</span><span class="op" id="4682975">)</span>&nbsp;<span class="ident" id="4682977">Less</span><span class="op" id="4682981">(</span><span class="ident" id="4682982">i</span><span class="op" id="4682983">,</span>&nbsp;<span class="ident" id="4682985">j</span>&nbsp;<span class="builtintype" id="4682987">int</span><span class="op" id="4682990">)</span>&nbsp;<span class="builtintype" id="4682992">bool</span>&nbsp;<span class="op" id="4682997">{</span>&nbsp;<span class="keyword" id="4682999">return</span>&nbsp;<span class="ident" id="4683006">x</span><span class="op" id="4683007">.</span><span class="ident" id="4683008">rvs</span><span class="op" id="4683011">[</span><span class="ident" id="4683012">i</span><span class="op" id="4683013">]</span><span class="op" id="4683014">.</span><span class="ident" id="4683015">String</span><span class="op" id="4683021">(</span><span class="op" id="4683022">)</span>&nbsp;<span class="op" id="4683024">&lt;</span>&nbsp;<span class="ident" id="4683026">x</span><span class="op" id="4683027">.</span><span class="ident" id="4683028">rvs</span><span class="op" id="4683031">[</span><span class="ident" id="4683032">j</span><span class="op" id="4683033">]</span><span class="op" id="4683034">.</span><span class="ident" id="4683035">String</span><span class="op" id="4683041">(</span><span class="op" id="4683042">)</span>&nbsp;<span class="op" id="4683044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4683047">//&nbsp;sortKeys&nbsp;sorts&nbsp;(if&nbsp;it&nbsp;can)&nbsp;the&nbsp;slice&nbsp;of&nbsp;reflect.Values,&nbsp;which&nbsp;is&nbsp;a&nbsp;slice&nbsp;of&nbsp;map&nbsp;keys.</span><br>
<span class="lineno"></span><span class="keyword" id="4683136">func</span>&nbsp;<span class="ident" id="4683141">sortKeys</span><span class="op" id="4683149">(</span><span class="ident" id="4683150">v</span>&nbsp;<span class="op" id="4683152">[</span><span class="op" id="4683153">]</span><span class="ident" id="4683154">reflect</span><span class="op" id="4683161">.</span><span class="ident" id="4683162">Value</span><span class="op" id="4683167">)</span>&nbsp;<span class="op" id="4683169">[</span><span class="op" id="4683170">]</span><span class="ident" id="4683171">reflect</span><span class="op" id="4683178">.</span><span class="ident" id="4683179">Value</span>&nbsp;<span class="op" id="4683185">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683188">if</span>&nbsp;<span class="builtinfunc" id="4683191">len</span><span class="op" id="4683194">(</span><span class="ident" id="4683195">v</span><span class="op" id="4683196">)</span>&nbsp;<span class="op" id="4683198">&lt;=</span>&nbsp;<span class="num" id="4683201">1</span>&nbsp;<span class="op" id="4683203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683207">return</span>&nbsp;<span class="ident" id="4683214">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4683217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683220">switch</span>&nbsp;<span class="ident" id="4683227">v</span><span class="op" id="4683228">[</span><span class="num" id="4683229">0</span><span class="op" id="4683230">]</span><span class="op" id="4683231">.</span><span class="ident" id="4683232">Kind</span><span class="op" id="4683236">(</span><span class="op" id="4683237">)</span>&nbsp;<span class="op" id="4683239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683242">case</span>&nbsp;<span class="ident" id="4683247">reflect</span><span class="op" id="4683254">.</span><span class="ident" id="4683255">Float32</span><span class="op" id="4683262">,</span>&nbsp;<span class="ident" id="4683264">reflect</span><span class="op" id="4683271">.</span><span class="ident" id="4683272">Float64</span><span class="op" id="4683279">:</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4683283">sort</span><span class="op" id="4683287">.</span><span class="ident" id="4683288">Sort</span><span class="op" id="4683292">(</span><span class="ident" id="4683293">rvFloats</span><span class="op" id="4683301">{</span><span class="ident" id="4683302">v</span><span class="op" id="4683303">}</span><span class="op" id="4683304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683307">case</span>&nbsp;<span class="ident" id="4683312">reflect</span><span class="op" id="4683319">.</span><span class="ident" id="4683320">Int</span><span class="op" id="4683323">,</span>&nbsp;<span class="ident" id="4683325">reflect</span><span class="op" id="4683332">.</span><span class="ident" id="4683333">Int8</span><span class="op" id="4683337">,</span>&nbsp;<span class="ident" id="4683339">reflect</span><span class="op" id="4683346">.</span><span class="ident" id="4683347">Int16</span><span class="op" id="4683352">,</span>&nbsp;<span class="ident" id="4683354">reflect</span><span class="op" id="4683361">.</span><span class="ident" id="4683362">Int32</span><span class="op" id="4683367">,</span>&nbsp;<span class="ident" id="4683369">reflect</span><span class="op" id="4683376">.</span><span class="ident" id="4683377">Int64</span><span class="op" id="4683382">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4683386">sort</span><span class="op" id="4683390">.</span><span class="ident" id="4683391">Sort</span><span class="op" id="4683395">(</span><span class="ident" id="4683396">rvInts</span><span class="op" id="4683402">{</span><span class="ident" id="4683403">v</span><span class="op" id="4683404">}</span><span class="op" id="4683405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683408">case</span>&nbsp;<span class="ident" id="4683413">reflect</span><span class="op" id="4683420">.</span><span class="ident" id="4683421">String</span><span class="op" id="4683427">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4683431">sort</span><span class="op" id="4683435">.</span><span class="ident" id="4683436">Sort</span><span class="op" id="4683440">(</span><span class="ident" id="4683441">rvStrings</span><span class="op" id="4683450">{</span><span class="ident" id="4683451">v</span><span class="op" id="4683452">}</span><span class="op" id="4683453">)</span><br>
<span class="lineno">840</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683456">case</span>&nbsp;<span class="ident" id="4683461">reflect</span><span class="op" id="4683468">.</span><span class="ident" id="4683469">Uint</span><span class="op" id="4683473">,</span>&nbsp;<span class="ident" id="4683475">reflect</span><span class="op" id="4683482">.</span><span class="ident" id="4683483">Uint8</span><span class="op" id="4683488">,</span>&nbsp;<span class="ident" id="4683490">reflect</span><span class="op" id="4683497">.</span><span class="ident" id="4683498">Uint16</span><span class="op" id="4683504">,</span>&nbsp;<span class="ident" id="4683506">reflect</span><span class="op" id="4683513">.</span><span class="ident" id="4683514">Uint32</span><span class="op" id="4683520">,</span>&nbsp;<span class="ident" id="4683522">reflect</span><span class="op" id="4683529">.</span><span class="ident" id="4683530">Uint64</span><span class="op" id="4683536">,</span>&nbsp;<span class="ident" id="4683538">reflect</span><span class="op" id="4683545">.</span><span class="ident" id="4683546">Uintptr</span><span class="op" id="4683553">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4683557">sort</span><span class="op" id="4683561">.</span><span class="ident" id="4683562">Sort</span><span class="op" id="4683566">(</span><span class="ident" id="4683567">rvUints</span><span class="op" id="4683574">{</span><span class="ident" id="4683575">v</span><span class="op" id="4683576">}</span><span class="op" id="4683577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4683580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4683583">return</span>&nbsp;<span class="ident" id="4683590">v</span><br>
<span class="lineno"></span><span class="op" id="4683592">}</span>
</div>
</body>
</html>
