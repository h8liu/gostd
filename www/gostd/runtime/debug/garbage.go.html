<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime/debug</h2>
<ul>
<li><a href="/gostd/runtime/debug/garbage.go.html" class="current">garbage.go</a></li>
<li><a href="/gostd/runtime/debug/garbage_test.go.html">garbage_test.go</a></li>
<li><a href="/gostd/runtime/debug/heapdump_test.go.html">heapdump_test.go</a></li>
<li><a href="/gostd/runtime/debug/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/debug/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/debug/stubs.go.html">stubs.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5535212">//&nbsp;Copyright&nbsp;2013&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5535268">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5535322">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5535373">package</span>&nbsp;<span class="ident" id="5535381">debug</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5535388">import</span>&nbsp;<span class="op" id="5535395">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5535398">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5535409">&#34;sort&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5535417">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="5535424">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5535427">//&nbsp;GCStats&nbsp;collect&nbsp;information&nbsp;about&nbsp;recent&nbsp;garbage&nbsp;collections.</span><br>
<span class="lineno"></span><span class="keyword" id="5535492">type</span>&nbsp;<span class="ident" id="5535497">GCStats</span>&nbsp;<span class="keyword" id="5535505">struct</span>&nbsp;<span class="op" id="5535512">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5535515">LastGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5535530">time</span><span class="op" id="5535534">.</span><span class="ident" id="5535535">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5535546">//&nbsp;time&nbsp;of&nbsp;last&nbsp;collection</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5535574">NumGC</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5535589">int64</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5535605">//&nbsp;number&nbsp;of&nbsp;garbage&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5535639">PauseTotal</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5535654">time</span><span class="op" id="5535658">.</span><span class="ident" id="5535659">Duration</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5535670">//&nbsp;total&nbsp;pause&nbsp;for&nbsp;all&nbsp;collections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5535706">Pause</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5535721">[</span><span class="op" id="5535722">]</span><span class="ident" id="5535723">time</span><span class="op" id="5535727">.</span><span class="ident" id="5535728">Duration</span>&nbsp;<span class="comment" id="5535737">//&nbsp;pause&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5535774">PauseEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5535789">[</span><span class="op" id="5535790">]</span><span class="ident" id="5535791">time</span><span class="op" id="5535795">.</span><span class="ident" id="5535796">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5535805">//&nbsp;pause&nbsp;end&nbsp;times&nbsp;history,&nbsp;most&nbsp;recent&nbsp;first</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5535852">PauseQuantiles</span>&nbsp;<span class="op" id="5535867">[</span><span class="op" id="5535868">]</span><span class="ident" id="5535869">time</span><span class="op" id="5535873">.</span><span class="ident" id="5535874">Duration</span><br>
<span class="lineno"></span><span class="op" id="5535883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5535886">//&nbsp;ReadGCStats&nbsp;reads&nbsp;statistics&nbsp;about&nbsp;garbage&nbsp;collection&nbsp;into&nbsp;stats.</span><br>
<span class="lineno"></span><span class="comment" id="5535955">//&nbsp;The&nbsp;number&nbsp;of&nbsp;entries&nbsp;in&nbsp;the&nbsp;pause&nbsp;history&nbsp;is&nbsp;system-dependent;</span><br>
<span class="lineno">25</span><span class="comment" id="5536022">//&nbsp;stats.Pause&nbsp;slice&nbsp;will&nbsp;be&nbsp;reused&nbsp;if&nbsp;large&nbsp;enough,&nbsp;reallocated&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="5536098">//&nbsp;ReadGCStats&nbsp;may&nbsp;use&nbsp;the&nbsp;full&nbsp;capacity&nbsp;of&nbsp;the&nbsp;stats.Pause&nbsp;slice.</span><br>
<span class="lineno"></span><span class="comment" id="5536165">//&nbsp;If&nbsp;stats.PauseQuantiles&nbsp;is&nbsp;non-empty,&nbsp;ReadGCStats&nbsp;fills&nbsp;it&nbsp;with&nbsp;quantiles</span><br>
<span class="lineno"></span><span class="comment" id="5536242">//&nbsp;summarizing&nbsp;the&nbsp;distribution&nbsp;of&nbsp;pause&nbsp;time.&nbsp;For&nbsp;example,&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="5536305">//&nbsp;len(stats.PauseQuantiles)&nbsp;is&nbsp;5,&nbsp;it&nbsp;will&nbsp;be&nbsp;filled&nbsp;with&nbsp;the&nbsp;minimum,</span><br>
<span class="lineno">30</span><span class="comment" id="5536376">//&nbsp;25%,&nbsp;50%,&nbsp;75%,&nbsp;and&nbsp;maximum&nbsp;pause&nbsp;times.</span><br>
<span class="lineno"></span><span class="keyword" id="5536419">func</span>&nbsp;<span class="ident" id="5536424">ReadGCStats</span><span class="op" id="5536435">(</span><span class="ident" id="5536436">stats</span>&nbsp;<span class="op" id="5536442">*</span><span class="ident" id="5536443">GCStats</span><span class="op" id="5536450">)</span>&nbsp;<span class="op" id="5536452">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5536455">//&nbsp;Create&nbsp;a&nbsp;buffer&nbsp;with&nbsp;space&nbsp;for&nbsp;at&nbsp;least&nbsp;two&nbsp;copies&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5536517">//&nbsp;pause&nbsp;history&nbsp;tracked&nbsp;by&nbsp;the&nbsp;runtime.&nbsp;One&nbsp;will&nbsp;be&nbsp;returned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5536580">//&nbsp;to&nbsp;the&nbsp;caller&nbsp;and&nbsp;the&nbsp;other&nbsp;will&nbsp;be&nbsp;used&nbsp;as&nbsp;transfer&nbsp;buffer</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5536644">//&nbsp;for&nbsp;end&nbsp;times&nbsp;history&nbsp;and&nbsp;as&nbsp;a&nbsp;temporary&nbsp;buffer&nbsp;for</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5536700">//&nbsp;computing&nbsp;quantiles.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5536725">const</span>&nbsp;<span class="ident" id="5536731">maxPause</span>&nbsp;<span class="op" id="5536740">=</span>&nbsp;<span class="builtinfunc" id="5536742">len</span><span class="op" id="5536745">(</span><span class="op" id="5536746">(</span><span class="op" id="5536747">(</span><span class="op" id="5536748">*</span><span class="ident" id="5536749">runtime</span><span class="op" id="5536756">.</span><span class="ident" id="5536757">MemStats</span><span class="op" id="5536765">)</span><span class="op" id="5536766">(</span><span class="builtintype" id="5536767">nil</span><span class="op" id="5536770">)</span><span class="op" id="5536771">)</span><span class="op" id="5536772">.</span><span class="ident" id="5536773">PauseNs</span><span class="op" id="5536780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5536783">if</span>&nbsp;<span class="builtinfunc" id="5536786">cap</span><span class="op" id="5536789">(</span><span class="ident" id="5536790">stats</span><span class="op" id="5536795">.</span><span class="ident" id="5536796">Pause</span><span class="op" id="5536801">)</span>&nbsp;<span class="op" id="5536803">&lt;</span>&nbsp;<span class="num" id="5536805">2</span><span class="op" id="5536806">*</span><span class="ident" id="5536807">maxPause</span><span class="op" id="5536815">+</span><span class="num" id="5536816">3</span>&nbsp;<span class="op" id="5536818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5536822">stats</span><span class="op" id="5536827">.</span><span class="ident" id="5536828">Pause</span>&nbsp;<span class="op" id="5536834">=</span>&nbsp;<span class="builtinfunc" id="5536836">make</span><span class="op" id="5536840">(</span><span class="op" id="5536841">[</span><span class="op" id="5536842">]</span><span class="ident" id="5536843">time</span><span class="op" id="5536847">.</span><span class="ident" id="5536848">Duration</span><span class="op" id="5536856">,</span>&nbsp;<span class="num" id="5536858">2</span><span class="op" id="5536859">*</span><span class="ident" id="5536860">maxPause</span><span class="op" id="5536868">+</span><span class="num" id="5536869">3</span><span class="op" id="5536870">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5536873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5536877">//&nbsp;readGCStats&nbsp;fills&nbsp;in&nbsp;the&nbsp;pause&nbsp;and&nbsp;end&nbsp;times&nbsp;histories&nbsp;(up&nbsp;to</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5536943">//&nbsp;maxPause&nbsp;entries)&nbsp;and&nbsp;then&nbsp;three&nbsp;more:&nbsp;Unix&nbsp;ns&nbsp;time&nbsp;of&nbsp;last&nbsp;GC,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537011">//&nbsp;number&nbsp;of&nbsp;GC,&nbsp;and&nbsp;total&nbsp;pause&nbsp;time&nbsp;in&nbsp;nanoseconds.&nbsp;Here&nbsp;we</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537074">//&nbsp;depend&nbsp;on&nbsp;the&nbsp;fact&nbsp;that&nbsp;time.Duration&#39;s&nbsp;native&nbsp;unit&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537133">//&nbsp;nanoseconds,&nbsp;so&nbsp;the&nbsp;pauses&nbsp;and&nbsp;the&nbsp;total&nbsp;pause&nbsp;time&nbsp;do&nbsp;not&nbsp;need</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537201">//&nbsp;any&nbsp;conversion.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5537221">readGCStats</span><span class="op" id="5537232">(</span><span class="op" id="5537233">&amp;</span><span class="ident" id="5537234">stats</span><span class="op" id="5537239">.</span><span class="ident" id="5537240">Pause</span><span class="op" id="5537245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5537248">n</span>&nbsp;<span class="op" id="5537250">:=</span>&nbsp;<span class="builtinfunc" id="5537253">len</span><span class="op" id="5537256">(</span><span class="ident" id="5537257">stats</span><span class="op" id="5537262">.</span><span class="ident" id="5537263">Pause</span><span class="op" id="5537268">)</span>&nbsp;<span class="op" id="5537270">-</span>&nbsp;<span class="num" id="5537272">3</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5537275">stats</span><span class="op" id="5537280">.</span><span class="ident" id="5537281">LastGC</span>&nbsp;<span class="op" id="5537288">=</span>&nbsp;<span class="ident" id="5537290">time</span><span class="op" id="5537294">.</span><span class="ident" id="5537295">Unix</span><span class="op" id="5537299">(</span><span class="num" id="5537300">0</span><span class="op" id="5537301">,</span>&nbsp;<span class="builtintype" id="5537303">int64</span><span class="op" id="5537308">(</span><span class="ident" id="5537309">stats</span><span class="op" id="5537314">.</span><span class="ident" id="5537315">Pause</span><span class="op" id="5537320">[</span><span class="ident" id="5537321">n</span><span class="op" id="5537322">]</span><span class="op" id="5537323">)</span><span class="op" id="5537324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5537327">stats</span><span class="op" id="5537332">.</span><span class="ident" id="5537333">NumGC</span>&nbsp;<span class="op" id="5537339">=</span>&nbsp;<span class="builtintype" id="5537341">int64</span><span class="op" id="5537346">(</span><span class="ident" id="5537347">stats</span><span class="op" id="5537352">.</span><span class="ident" id="5537353">Pause</span><span class="op" id="5537358">[</span><span class="ident" id="5537359">n</span><span class="op" id="5537360">+</span><span class="num" id="5537361">1</span><span class="op" id="5537362">]</span><span class="op" id="5537363">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5537366">stats</span><span class="op" id="5537371">.</span><span class="ident" id="5537372">PauseTotal</span>&nbsp;<span class="op" id="5537383">=</span>&nbsp;<span class="ident" id="5537385">stats</span><span class="op" id="5537390">.</span><span class="ident" id="5537391">Pause</span><span class="op" id="5537396">[</span><span class="ident" id="5537397">n</span><span class="op" id="5537398">+</span><span class="num" id="5537399">2</span><span class="op" id="5537400">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5537403">n</span>&nbsp;<span class="op" id="5537405">/=</span>&nbsp;<span class="num" id="5537408">2</span>&nbsp;<span class="comment" id="5537410">//&nbsp;buffer&nbsp;holds&nbsp;pauses&nbsp;and&nbsp;end&nbsp;times</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5537448">stats</span><span class="op" id="5537453">.</span><span class="ident" id="5537454">Pause</span>&nbsp;<span class="op" id="5537460">=</span>&nbsp;<span class="ident" id="5537462">stats</span><span class="op" id="5537467">.</span><span class="ident" id="5537468">Pause</span><span class="op" id="5537473">[</span><span class="op" id="5537474">:</span><span class="ident" id="5537475">n</span><span class="op" id="5537476">]</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5537480">if</span>&nbsp;<span class="builtinfunc" id="5537483">cap</span><span class="op" id="5537486">(</span><span class="ident" id="5537487">stats</span><span class="op" id="5537492">.</span><span class="ident" id="5537493">PauseEnd</span><span class="op" id="5537501">)</span>&nbsp;<span class="op" id="5537503">&lt;</span>&nbsp;<span class="ident" id="5537505">maxPause</span>&nbsp;<span class="op" id="5537514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5537518">stats</span><span class="op" id="5537523">.</span><span class="ident" id="5537524">PauseEnd</span>&nbsp;<span class="op" id="5537533">=</span>&nbsp;<span class="builtinfunc" id="5537535">make</span><span class="op" id="5537539">(</span><span class="op" id="5537540">[</span><span class="op" id="5537541">]</span><span class="ident" id="5537542">time</span><span class="op" id="5537546">.</span><span class="ident" id="5537547">Time</span><span class="op" id="5537551">,</span>&nbsp;<span class="num" id="5537553">0</span><span class="op" id="5537554">,</span>&nbsp;<span class="ident" id="5537556">maxPause</span><span class="op" id="5537564">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5537567">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5537570">stats</span><span class="op" id="5537575">.</span><span class="ident" id="5537576">PauseEnd</span>&nbsp;<span class="op" id="5537585">=</span>&nbsp;<span class="ident" id="5537587">stats</span><span class="op" id="5537592">.</span><span class="ident" id="5537593">PauseEnd</span><span class="op" id="5537601">[</span><span class="op" id="5537602">:</span><span class="num" id="5537603">0</span><span class="op" id="5537604">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5537607">for</span>&nbsp;<span class="ident" id="5537611">_</span><span class="op" id="5537612">,</span>&nbsp;<span class="ident" id="5537614">ns</span>&nbsp;<span class="op" id="5537617">:=</span>&nbsp;<span class="keyword" id="5537620">range</span>&nbsp;<span class="ident" id="5537626">stats</span><span class="op" id="5537631">.</span><span class="ident" id="5537632">Pause</span><span class="op" id="5537637">[</span><span class="ident" id="5537638">n</span>&nbsp;<span class="op" id="5537640">:</span>&nbsp;<span class="ident" id="5537642">n</span><span class="op" id="5537643">+</span><span class="ident" id="5537644">n</span><span class="op" id="5537645">]</span>&nbsp;<span class="op" id="5537647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5537651">stats</span><span class="op" id="5537656">.</span><span class="ident" id="5537657">PauseEnd</span>&nbsp;<span class="op" id="5537666">=</span>&nbsp;<span class="builtinfunc" id="5537668">append</span><span class="op" id="5537674">(</span><span class="ident" id="5537675">stats</span><span class="op" id="5537680">.</span><span class="ident" id="5537681">PauseEnd</span><span class="op" id="5537689">,</span>&nbsp;<span class="ident" id="5537691">time</span><span class="op" id="5537695">.</span><span class="ident" id="5537696">Unix</span><span class="op" id="5537700">(</span><span class="num" id="5537701">0</span><span class="op" id="5537702">,</span>&nbsp;<span class="builtintype" id="5537704">int64</span><span class="op" id="5537709">(</span><span class="ident" id="5537710">ns</span><span class="op" id="5537712">)</span><span class="op" id="5537713">)</span><span class="op" id="5537714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5537717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5537721">if</span>&nbsp;<span class="builtinfunc" id="5537724">len</span><span class="op" id="5537727">(</span><span class="ident" id="5537728">stats</span><span class="op" id="5537733">.</span><span class="ident" id="5537734">PauseQuantiles</span><span class="op" id="5537748">)</span>&nbsp;<span class="op" id="5537750">&gt;</span>&nbsp;<span class="num" id="5537752">0</span>&nbsp;<span class="op" id="5537754">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5537758">if</span>&nbsp;<span class="ident" id="5537761">n</span>&nbsp;<span class="op" id="5537763">==</span>&nbsp;<span class="num" id="5537766">0</span>&nbsp;<span class="op" id="5537768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5537773">for</span>&nbsp;<span class="ident" id="5537777">i</span>&nbsp;<span class="op" id="5537779">:=</span>&nbsp;<span class="keyword" id="5537782">range</span>&nbsp;<span class="ident" id="5537788">stats</span><span class="op" id="5537793">.</span><span class="ident" id="5537794">PauseQuantiles</span>&nbsp;<span class="op" id="5537809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5537815">stats</span><span class="op" id="5537820">.</span><span class="ident" id="5537821">PauseQuantiles</span><span class="op" id="5537835">[</span><span class="ident" id="5537836">i</span><span class="op" id="5537837">]</span>&nbsp;<span class="op" id="5537839">=</span>&nbsp;<span class="num" id="5537841">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5537846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5537850">}</span>&nbsp;<span class="keyword" id="5537852">else</span>&nbsp;<span class="op" id="5537857">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537862">//&nbsp;There&#39;s&nbsp;room&nbsp;for&nbsp;a&nbsp;second&nbsp;copy&nbsp;of&nbsp;the&nbsp;data&nbsp;in&nbsp;stats.Pause.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5537927">//&nbsp;See&nbsp;the&nbsp;allocation&nbsp;at&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;function.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5537980">sorted</span>&nbsp;<span class="op" id="5537987">:=</span>&nbsp;<span class="ident" id="5537990">stats</span><span class="op" id="5537995">.</span><span class="ident" id="5537996">Pause</span><span class="op" id="5538001">[</span><span class="ident" id="5538002">n</span>&nbsp;<span class="op" id="5538004">:</span>&nbsp;<span class="ident" id="5538006">n</span><span class="op" id="5538007">+</span><span class="ident" id="5538008">n</span><span class="op" id="5538009">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="5538014">copy</span><span class="op" id="5538018">(</span><span class="ident" id="5538019">sorted</span><span class="op" id="5538025">,</span>&nbsp;<span class="ident" id="5538027">stats</span><span class="op" id="5538032">.</span><span class="ident" id="5538033">Pause</span><span class="op" id="5538038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5538043">sort</span><span class="op" id="5538047">.</span><span class="ident" id="5538048">Sort</span><span class="op" id="5538052">(</span><span class="ident" id="5538053">byDuration</span><span class="op" id="5538063">(</span><span class="ident" id="5538064">sorted</span><span class="op" id="5538070">)</span><span class="op" id="5538071">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5538076">nq</span>&nbsp;<span class="op" id="5538079">:=</span>&nbsp;<span class="builtinfunc" id="5538082">len</span><span class="op" id="5538085">(</span><span class="ident" id="5538086">stats</span><span class="op" id="5538091">.</span><span class="ident" id="5538092">PauseQuantiles</span><span class="op" id="5538106">)</span>&nbsp;<span class="op" id="5538108">-</span>&nbsp;<span class="num" id="5538110">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5538115">for</span>&nbsp;<span class="ident" id="5538119">i</span>&nbsp;<span class="op" id="5538121">:=</span>&nbsp;<span class="num" id="5538124">0</span><span class="op" id="5538125">;</span>&nbsp;<span class="ident" id="5538127">i</span>&nbsp;<span class="op" id="5538129">&lt;</span>&nbsp;<span class="ident" id="5538131">nq</span><span class="op" id="5538133">;</span>&nbsp;<span class="ident" id="5538135">i</span><span class="op" id="5538136">++</span>&nbsp;<span class="op" id="5538139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5538145">stats</span><span class="op" id="5538150">.</span><span class="ident" id="5538151">PauseQuantiles</span><span class="op" id="5538165">[</span><span class="ident" id="5538166">i</span><span class="op" id="5538167">]</span>&nbsp;<span class="op" id="5538169">=</span>&nbsp;<span class="ident" id="5538171">sorted</span><span class="op" id="5538177">[</span><span class="builtinfunc" id="5538178">len</span><span class="op" id="5538181">(</span><span class="ident" id="5538182">sorted</span><span class="op" id="5538188">)</span><span class="op" id="5538189">*</span><span class="ident" id="5538190">i</span><span class="op" id="5538191">/</span><span class="ident" id="5538192">nq</span><span class="op" id="5538194">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5538199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5538204">stats</span><span class="op" id="5538209">.</span><span class="ident" id="5538210">PauseQuantiles</span><span class="op" id="5538224">[</span><span class="ident" id="5538225">nq</span><span class="op" id="5538227">]</span>&nbsp;<span class="op" id="5538229">=</span>&nbsp;<span class="ident" id="5538231">sorted</span><span class="op" id="5538237">[</span><span class="builtinfunc" id="5538238">len</span><span class="op" id="5538241">(</span><span class="ident" id="5538242">sorted</span><span class="op" id="5538248">)</span><span class="op" id="5538249">-</span><span class="num" id="5538250">1</span><span class="op" id="5538251">]</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5538255">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5538258">}</span><br>
<span class="lineno"></span><span class="op" id="5538260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5538263">type</span>&nbsp;<span class="ident" id="5538268">byDuration</span>&nbsp;<span class="op" id="5538279">[</span><span class="op" id="5538280">]</span><span class="ident" id="5538281">time</span><span class="op" id="5538285">.</span><span class="ident" id="5538286">Duration</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="keyword" id="5538296">func</span>&nbsp;<span class="op" id="5538301">(</span><span class="ident" id="5538302">x</span>&nbsp;<span class="ident" id="5538304">byDuration</span><span class="op" id="5538314">)</span>&nbsp;<span class="ident" id="5538316">Len</span><span class="op" id="5538319">(</span><span class="op" id="5538320">)</span>&nbsp;<span class="builtintype" id="5538322">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5538336">{</span>&nbsp;<span class="keyword" id="5538338">return</span>&nbsp;<span class="builtinfunc" id="5538345">len</span><span class="op" id="5538348">(</span><span class="ident" id="5538349">x</span><span class="op" id="5538350">)</span>&nbsp;<span class="op" id="5538352">}</span><br>
<span class="lineno"></span><span class="keyword" id="5538354">func</span>&nbsp;<span class="op" id="5538359">(</span><span class="ident" id="5538360">x</span>&nbsp;<span class="ident" id="5538362">byDuration</span><span class="op" id="5538372">)</span>&nbsp;<span class="ident" id="5538374">Swap</span><span class="op" id="5538378">(</span><span class="ident" id="5538379">i</span><span class="op" id="5538380">,</span>&nbsp;<span class="ident" id="5538382">j</span>&nbsp;<span class="builtintype" id="5538384">int</span><span class="op" id="5538387">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5538394">{</span>&nbsp;<span class="ident" id="5538396">x</span><span class="op" id="5538397">[</span><span class="ident" id="5538398">i</span><span class="op" id="5538399">]</span><span class="op" id="5538400">,</span>&nbsp;<span class="ident" id="5538402">x</span><span class="op" id="5538403">[</span><span class="ident" id="5538404">j</span><span class="op" id="5538405">]</span>&nbsp;<span class="op" id="5538407">=</span>&nbsp;<span class="ident" id="5538409">x</span><span class="op" id="5538410">[</span><span class="ident" id="5538411">j</span><span class="op" id="5538412">]</span><span class="op" id="5538413">,</span>&nbsp;<span class="ident" id="5538415">x</span><span class="op" id="5538416">[</span><span class="ident" id="5538417">i</span><span class="op" id="5538418">]</span>&nbsp;<span class="op" id="5538420">}</span><br>
<span class="lineno"></span><span class="keyword" id="5538422">func</span>&nbsp;<span class="op" id="5538427">(</span><span class="ident" id="5538428">x</span>&nbsp;<span class="ident" id="5538430">byDuration</span><span class="op" id="5538440">)</span>&nbsp;<span class="ident" id="5538442">Less</span><span class="op" id="5538446">(</span><span class="ident" id="5538447">i</span><span class="op" id="5538448">,</span>&nbsp;<span class="ident" id="5538450">j</span>&nbsp;<span class="builtintype" id="5538452">int</span><span class="op" id="5538455">)</span>&nbsp;<span class="builtintype" id="5538457">bool</span>&nbsp;<span class="op" id="5538462">{</span>&nbsp;<span class="keyword" id="5538464">return</span>&nbsp;<span class="ident" id="5538471">x</span><span class="op" id="5538472">[</span><span class="ident" id="5538473">i</span><span class="op" id="5538474">]</span>&nbsp;<span class="op" id="5538476">&lt;</span>&nbsp;<span class="ident" id="5538478">x</span><span class="op" id="5538479">[</span><span class="ident" id="5538480">j</span><span class="op" id="5538481">]</span>&nbsp;<span class="op" id="5538483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span><span class="comment" id="5538486">//&nbsp;SetGCPercent&nbsp;sets&nbsp;the&nbsp;garbage&nbsp;collection&nbsp;target&nbsp;percentage:</span><br>
<span class="lineno"></span><span class="comment" id="5538549">//&nbsp;a&nbsp;collection&nbsp;is&nbsp;triggered&nbsp;when&nbsp;the&nbsp;ratio&nbsp;of&nbsp;freshly&nbsp;allocated&nbsp;data</span><br>
<span class="lineno"></span><span class="comment" id="5538619">//&nbsp;to&nbsp;live&nbsp;data&nbsp;remaining&nbsp;after&nbsp;the&nbsp;previous&nbsp;collection&nbsp;reaches&nbsp;this&nbsp;percentage.</span><br>
<span class="lineno"></span><span class="comment" id="5538700">//&nbsp;SetGCPercent&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5538746">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;the&nbsp;value&nbsp;of&nbsp;the&nbsp;GOGC&nbsp;environment&nbsp;variable</span><br>
<span class="lineno">95</span><span class="comment" id="5538815">//&nbsp;at&nbsp;startup,&nbsp;or&nbsp;100&nbsp;if&nbsp;the&nbsp;variable&nbsp;is&nbsp;not&nbsp;set.</span><br>
<span class="lineno"></span><span class="comment" id="5538865">//&nbsp;A&nbsp;negative&nbsp;percentage&nbsp;disables&nbsp;garbage&nbsp;collection.</span><br>
<span class="lineno"></span><span class="keyword" id="5538919">func</span>&nbsp;<span class="ident" id="5538924">SetGCPercent</span><span class="op" id="5538936">(</span><span class="ident" id="5538937">percent</span>&nbsp;<span class="builtintype" id="5538945">int</span><span class="op" id="5538948">)</span>&nbsp;<span class="builtintype" id="5538950">int</span>&nbsp;<span class="op" id="5538954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5538957">old</span>&nbsp;<span class="op" id="5538961">:=</span>&nbsp;<span class="ident" id="5538964">setGCPercent</span><span class="op" id="5538976">(</span><span class="builtintype" id="5538977">int32</span><span class="op" id="5538982">(</span><span class="ident" id="5538983">percent</span><span class="op" id="5538990">)</span><span class="op" id="5538991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5538994">runtime</span><span class="op" id="5539001">.</span><span class="ident" id="5539002">GC</span><span class="op" id="5539004">(</span><span class="op" id="5539005">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5539008">return</span>&nbsp;<span class="builtintype" id="5539015">int</span><span class="op" id="5539018">(</span><span class="ident" id="5539019">old</span><span class="op" id="5539022">)</span><br>
<span class="lineno"></span><span class="op" id="5539024">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5539027">//&nbsp;FreeOSMemory&nbsp;forces&nbsp;a&nbsp;garbage&nbsp;collection&nbsp;followed&nbsp;by&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="5539086">//&nbsp;attempt&nbsp;to&nbsp;return&nbsp;as&nbsp;much&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system</span><br>
<span class="lineno">105</span><span class="comment" id="5539146">//&nbsp;as&nbsp;possible.&nbsp;(Even&nbsp;if&nbsp;this&nbsp;is&nbsp;not&nbsp;called,&nbsp;the&nbsp;runtime&nbsp;gradually</span><br>
<span class="lineno"></span><span class="comment" id="5539213">//&nbsp;returns&nbsp;memory&nbsp;to&nbsp;the&nbsp;operating&nbsp;system&nbsp;in&nbsp;a&nbsp;background&nbsp;task.)</span><br>
<span class="lineno"></span><span class="keyword" id="5539278">func</span>&nbsp;<span class="ident" id="5539283">FreeOSMemory</span><span class="op" id="5539295">(</span><span class="op" id="5539296">)</span>&nbsp;<span class="op" id="5539298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5539301">freeOSMemory</span><span class="op" id="5539313">(</span><span class="op" id="5539314">)</span><br>
<span class="lineno"></span><span class="op" id="5539316">}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span><span class="comment" id="5539319">//&nbsp;SetMaxStack&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;amount&nbsp;of&nbsp;memory&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="5539373">//&nbsp;can&nbsp;be&nbsp;used&nbsp;by&nbsp;a&nbsp;single&nbsp;goroutine&nbsp;stack.</span><br>
<span class="lineno"></span><span class="comment" id="5539417">//&nbsp;If&nbsp;any&nbsp;goroutine&nbsp;exceeds&nbsp;this&nbsp;limit&nbsp;while&nbsp;growing&nbsp;its&nbsp;stack,</span><br>
<span class="lineno"></span><span class="comment" id="5539481">//&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno">115</span><span class="comment" id="5539505">//&nbsp;SetMaxStack&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5539550">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;1&nbsp;GB&nbsp;on&nbsp;64-bit&nbsp;systems,&nbsp;250&nbsp;MB&nbsp;on&nbsp;32-bit&nbsp;systems.</span><br>
<span class="lineno"></span><span class="comment" id="5539626">//</span><br>
<span class="lineno"></span><span class="comment" id="5539629">//&nbsp;SetMaxStack&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5539693">//&nbsp;goroutines&nbsp;that&nbsp;enter&nbsp;an&nbsp;infinite&nbsp;recursion.&nbsp;It&nbsp;only&nbsp;limits&nbsp;future</span><br>
<span class="lineno">120</span><span class="comment" id="5539763">//&nbsp;stack&nbsp;growth.</span><br>
<span class="lineno"></span><span class="keyword" id="5539780">func</span>&nbsp;<span class="ident" id="5539785">SetMaxStack</span><span class="op" id="5539796">(</span><span class="ident" id="5539797">bytes</span>&nbsp;<span class="builtintype" id="5539803">int</span><span class="op" id="5539806">)</span>&nbsp;<span class="builtintype" id="5539808">int</span>&nbsp;<span class="op" id="5539812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5539815">return</span>&nbsp;<span class="ident" id="5539822">setMaxStack</span><span class="op" id="5539833">(</span><span class="ident" id="5539834">bytes</span><span class="op" id="5539839">)</span><br>
<span class="lineno"></span><span class="op" id="5539841">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="5539844">//&nbsp;SetMaxThreads&nbsp;sets&nbsp;the&nbsp;maximum&nbsp;number&nbsp;of&nbsp;operating&nbsp;system</span><br>
<span class="lineno"></span><span class="comment" id="5539905">//&nbsp;threads&nbsp;that&nbsp;the&nbsp;Go&nbsp;program&nbsp;can&nbsp;use.&nbsp;If&nbsp;it&nbsp;attempts&nbsp;to&nbsp;use&nbsp;more&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="5539977">//&nbsp;this&nbsp;many,&nbsp;the&nbsp;program&nbsp;crashes.</span><br>
<span class="lineno"></span><span class="comment" id="5540012">//&nbsp;SetMaxThreads&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="comment" id="5540059">//&nbsp;The&nbsp;initial&nbsp;setting&nbsp;is&nbsp;10,000&nbsp;threads.</span><br>
<span class="lineno">130</span><span class="comment" id="5540101">//</span><br>
<span class="lineno"></span><span class="comment" id="5540104">//&nbsp;The&nbsp;limit&nbsp;controls&nbsp;the&nbsp;number&nbsp;of&nbsp;operating&nbsp;system&nbsp;threads,&nbsp;not&nbsp;the&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="5540181">//&nbsp;of&nbsp;goroutines.&nbsp;A&nbsp;Go&nbsp;program&nbsp;creates&nbsp;a&nbsp;new&nbsp;thread&nbsp;only&nbsp;when&nbsp;a&nbsp;goroutine</span><br>
<span class="lineno"></span><span class="comment" id="5540255">//&nbsp;is&nbsp;ready&nbsp;to&nbsp;run&nbsp;but&nbsp;all&nbsp;the&nbsp;existing&nbsp;threads&nbsp;are&nbsp;blocked&nbsp;in&nbsp;system&nbsp;calls,&nbsp;cgo&nbsp;calls,</span><br>
<span class="lineno"></span><span class="comment" id="5540343">//&nbsp;or&nbsp;are&nbsp;locked&nbsp;to&nbsp;other&nbsp;goroutines&nbsp;due&nbsp;to&nbsp;use&nbsp;of&nbsp;runtime.LockOSThread.</span><br>
<span class="lineno">135</span><span class="comment" id="5540416">//</span><br>
<span class="lineno"></span><span class="comment" id="5540419">//&nbsp;SetMaxThreads&nbsp;is&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;limiting&nbsp;the&nbsp;damage&nbsp;done&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="5540485">//&nbsp;programs&nbsp;that&nbsp;create&nbsp;an&nbsp;unbounded&nbsp;number&nbsp;of&nbsp;threads.&nbsp;The&nbsp;idea&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="5540553">//&nbsp;to&nbsp;take&nbsp;down&nbsp;the&nbsp;program&nbsp;before&nbsp;it&nbsp;takes&nbsp;down&nbsp;the&nbsp;operating&nbsp;system.</span><br>
<span class="lineno"></span><span class="keyword" id="5540624">func</span>&nbsp;<span class="ident" id="5540629">SetMaxThreads</span><span class="op" id="5540642">(</span><span class="ident" id="5540643">threads</span>&nbsp;<span class="builtintype" id="5540651">int</span><span class="op" id="5540654">)</span>&nbsp;<span class="builtintype" id="5540656">int</span>&nbsp;<span class="op" id="5540660">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5540663">return</span>&nbsp;<span class="ident" id="5540670">setMaxThreads</span><span class="op" id="5540683">(</span><span class="ident" id="5540684">threads</span><span class="op" id="5540691">)</span><br>
<span class="lineno"></span><span class="op" id="5540693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5540696">//&nbsp;SetPanicOnFault&nbsp;controls&nbsp;the&nbsp;runtime&#39;s&nbsp;behavior&nbsp;when&nbsp;a&nbsp;program&nbsp;faults</span><br>
<span class="lineno"></span><span class="comment" id="5540769">//&nbsp;at&nbsp;an&nbsp;unexpected&nbsp;(non-nil)&nbsp;address.&nbsp;Such&nbsp;faults&nbsp;are&nbsp;typically&nbsp;caused&nbsp;by</span><br>
<span class="lineno">145</span><span class="comment" id="5540844">//&nbsp;bugs&nbsp;such&nbsp;as&nbsp;runtime&nbsp;memory&nbsp;corruption,&nbsp;so&nbsp;the&nbsp;default&nbsp;response&nbsp;is&nbsp;to&nbsp;crash</span><br>
<span class="lineno"></span><span class="comment" id="5540923">//&nbsp;the&nbsp;program.&nbsp;Programs&nbsp;working&nbsp;with&nbsp;memory-mapped&nbsp;files&nbsp;or&nbsp;unsafe</span><br>
<span class="lineno"></span><span class="comment" id="5540991">//&nbsp;manipulation&nbsp;of&nbsp;memory&nbsp;may&nbsp;cause&nbsp;faults&nbsp;at&nbsp;non-nil&nbsp;addresses&nbsp;in&nbsp;less</span><br>
<span class="lineno"></span><span class="comment" id="5541063">//&nbsp;dramatic&nbsp;situations;&nbsp;SetPanicOnFault&nbsp;allows&nbsp;such&nbsp;programs&nbsp;to&nbsp;request</span><br>
<span class="lineno"></span><span class="comment" id="5541135">//&nbsp;that&nbsp;the&nbsp;runtime&nbsp;trigger&nbsp;only&nbsp;a&nbsp;panic,&nbsp;not&nbsp;a&nbsp;crash.</span><br>
<span class="lineno">150</span><span class="comment" id="5541190">//&nbsp;SetPanicOnFault&nbsp;applies&nbsp;only&nbsp;to&nbsp;the&nbsp;current&nbsp;goroutine.</span><br>
<span class="lineno"></span><span class="comment" id="5541248">//&nbsp;It&nbsp;returns&nbsp;the&nbsp;previous&nbsp;setting.</span><br>
<span class="lineno"></span><span class="keyword" id="5541284">func</span>&nbsp;<span class="ident" id="5541289">SetPanicOnFault</span><span class="op" id="5541304">(</span><span class="ident" id="5541305">enabled</span>&nbsp;<span class="builtintype" id="5541313">bool</span><span class="op" id="5541317">)</span>&nbsp;<span class="builtintype" id="5541319">bool</span>&nbsp;<span class="op" id="5541324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5541327">return</span>&nbsp;<span class="ident" id="5541334">setPanicOnFault</span><span class="op" id="5541349">(</span><span class="ident" id="5541350">enabled</span><span class="op" id="5541357">)</span><br>
<span class="lineno"></span><span class="op" id="5541359">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span><span class="comment" id="5541362">//&nbsp;WriteHeapDump&nbsp;writes&nbsp;a&nbsp;description&nbsp;of&nbsp;the&nbsp;heap&nbsp;and&nbsp;the&nbsp;objects&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5541431">//&nbsp;it&nbsp;to&nbsp;the&nbsp;given&nbsp;file&nbsp;descriptor.</span><br>
<span class="lineno"></span><span class="comment" id="5541467">//&nbsp;The&nbsp;heap&nbsp;dump&nbsp;format&nbsp;is&nbsp;defined&nbsp;at&nbsp;http://golang.org/s/go13heapdump.</span><br>
<span class="lineno"></span><span class="keyword" id="5541539">func</span>&nbsp;<span class="ident" id="5541544">WriteHeapDump</span><span class="op" id="5541557">(</span><span class="ident" id="5541558">fd</span>&nbsp;<span class="builtintype" id="5541561">uintptr</span><span class="op" id="5541568">)</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
