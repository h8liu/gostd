<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/asn1</h2>
<ul>
<li><a href="/gostd/encoding/asn1/asn1.go.html" class="current">asn1.go</a></li>
<li><a href="/gostd/encoding/asn1/asn1_test.go.html">asn1_test.go</a></li>
<li><a href="/gostd/encoding/asn1/common.go.html">common.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal_test.go.html">marshal_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4046950">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4047005">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4047059">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4047110">//&nbsp;Package&nbsp;asn1&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structures,</span><br>
<span class="lineno"></span><span class="comment" id="4047183">//&nbsp;as&nbsp;defined&nbsp;in&nbsp;ITU-T&nbsp;Rec&nbsp;X.690.</span><br>
<span class="lineno"></span><span class="comment" id="4047217">//</span><br>
<span class="lineno"></span><span class="comment" id="4047220">//&nbsp;See&nbsp;also&nbsp;``A&nbsp;Layman&#39;s&nbsp;Guide&nbsp;to&nbsp;a&nbsp;Subset&nbsp;of&nbsp;ASN.1,&nbsp;BER,&nbsp;and&nbsp;DER,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="4047289">//&nbsp;http://luca.ntop.org/Teaching/Appunti/asn1.html.</span><br>
<span class="lineno">10</span><span class="keyword" id="4047341">package</span>&nbsp;<span class="ident" id="4047349">asn1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4047355">//&nbsp;ASN.1&nbsp;is&nbsp;a&nbsp;syntax&nbsp;for&nbsp;specifying&nbsp;abstract&nbsp;objects&nbsp;and&nbsp;BER,&nbsp;DER,&nbsp;PER,&nbsp;XER&nbsp;etc</span><br>
<span class="lineno"></span><span class="comment" id="4047435">//&nbsp;are&nbsp;different&nbsp;encoding&nbsp;formats&nbsp;for&nbsp;those&nbsp;objects.&nbsp;Here,&nbsp;we&#39;ll&nbsp;be&nbsp;dealing</span><br>
<span class="lineno"></span><span class="comment" id="4047511">//&nbsp;with&nbsp;DER,&nbsp;the&nbsp;Distinguished&nbsp;Encoding&nbsp;Rules.&nbsp;DER&nbsp;is&nbsp;used&nbsp;in&nbsp;X.509&nbsp;because</span><br>
<span class="lineno">15</span><span class="comment" id="4047587">//&nbsp;it&#39;s&nbsp;fast&nbsp;to&nbsp;parse&nbsp;and,&nbsp;unlike&nbsp;BER,&nbsp;has&nbsp;a&nbsp;unique&nbsp;encoding&nbsp;for&nbsp;every&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="4047666">//&nbsp;When&nbsp;calculating&nbsp;hashes&nbsp;over&nbsp;objects,&nbsp;it&#39;s&nbsp;important&nbsp;that&nbsp;the&nbsp;resulting</span><br>
<span class="lineno"></span><span class="comment" id="4047741">//&nbsp;bytes&nbsp;be&nbsp;the&nbsp;same&nbsp;at&nbsp;both&nbsp;ends&nbsp;and&nbsp;DER&nbsp;removes&nbsp;this&nbsp;margin&nbsp;of&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4047813">//</span><br>
<span class="lineno"></span><span class="comment" id="4047816">//&nbsp;ASN.1&nbsp;is&nbsp;very&nbsp;complex&nbsp;and&nbsp;this&nbsp;package&nbsp;doesn&#39;t&nbsp;attempt&nbsp;to&nbsp;implement</span><br>
<span class="lineno">20</span><span class="comment" id="4047887">//&nbsp;everything&nbsp;by&nbsp;any&nbsp;means.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4047916">import</span>&nbsp;<span class="op" id="4047923">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4047926">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4047933">&#34;math/big&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4047945">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4047956">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4047967">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4047974">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="4047977">//&nbsp;A&nbsp;StructuralError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;valid,&nbsp;but&nbsp;the&nbsp;Go&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="4048053">//&nbsp;which&nbsp;is&nbsp;receiving&nbsp;it&nbsp;doesn&#39;t&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="4048093">type</span>&nbsp;<span class="ident" id="4048098">StructuralError</span>&nbsp;<span class="keyword" id="4048114">struct</span>&nbsp;<span class="op" id="4048121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048124">Msg</span>&nbsp;<span class="builtintype" id="4048128">string</span><br>
<span class="lineno"></span><span class="op" id="4048135">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="4048138">func</span>&nbsp;<span class="op" id="4048143">(</span><span class="ident" id="4048144">e</span>&nbsp;<span class="ident" id="4048146">StructuralError</span><span class="op" id="4048161">)</span>&nbsp;<span class="ident" id="4048163">Error</span><span class="op" id="4048168">(</span><span class="op" id="4048169">)</span>&nbsp;<span class="builtintype" id="4048171">string</span>&nbsp;<span class="op" id="4048178">{</span>&nbsp;<span class="keyword" id="4048180">return</span>&nbsp;<span class="string" id="4048187">&#34;asn1:&nbsp;structure&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4048213">+</span>&nbsp;<span class="ident" id="4048215">e</span><span class="op" id="4048216">.</span><span class="ident" id="4048217">Msg</span>&nbsp;<span class="op" id="4048221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4048224">//&nbsp;A&nbsp;SyntaxError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="4048282">type</span>&nbsp;<span class="ident" id="4048287">SyntaxError</span>&nbsp;<span class="keyword" id="4048299">struct</span>&nbsp;<span class="op" id="4048306">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048309">Msg</span>&nbsp;<span class="builtintype" id="4048313">string</span><br>
<span class="lineno"></span><span class="op" id="4048320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4048323">func</span>&nbsp;<span class="op" id="4048328">(</span><span class="ident" id="4048329">e</span>&nbsp;<span class="ident" id="4048331">SyntaxError</span><span class="op" id="4048342">)</span>&nbsp;<span class="ident" id="4048344">Error</span><span class="op" id="4048349">(</span><span class="op" id="4048350">)</span>&nbsp;<span class="builtintype" id="4048352">string</span>&nbsp;<span class="op" id="4048359">{</span>&nbsp;<span class="keyword" id="4048361">return</span>&nbsp;<span class="string" id="4048368">&#34;asn1:&nbsp;syntax&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4048391">+</span>&nbsp;<span class="ident" id="4048393">e</span><span class="op" id="4048394">.</span><span class="ident" id="4048395">Msg</span>&nbsp;<span class="op" id="4048399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="4048402">//&nbsp;We&nbsp;start&nbsp;by&nbsp;dealing&nbsp;with&nbsp;each&nbsp;of&nbsp;the&nbsp;primitive&nbsp;types&nbsp;in&nbsp;turn.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4048468">//&nbsp;BOOLEAN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4048480">func</span>&nbsp;<span class="ident" id="4048485">parseBool</span><span class="op" id="4048494">(</span><span class="ident" id="4048495">bytes</span>&nbsp;<span class="op" id="4048501">[</span><span class="op" id="4048502">]</span><span class="builtintype" id="4048503">byte</span><span class="op" id="4048507">)</span>&nbsp;<span class="op" id="4048509">(</span><span class="ident" id="4048510">ret</span>&nbsp;<span class="builtintype" id="4048514">bool</span><span class="op" id="4048518">,</span>&nbsp;<span class="ident" id="4048520">err</span>&nbsp;<span class="builtintype" id="4048524">error</span><span class="op" id="4048529">)</span>&nbsp;<span class="op" id="4048531">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4048534">if</span>&nbsp;<span class="builtinfunc" id="4048537">len</span><span class="op" id="4048540">(</span><span class="ident" id="4048541">bytes</span><span class="op" id="4048546">)</span>&nbsp;<span class="op" id="4048548">!=</span>&nbsp;<span class="num" id="4048551">1</span>&nbsp;<span class="op" id="4048553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048557">err</span>&nbsp;<span class="op" id="4048561">=</span>&nbsp;<span class="ident" id="4048563">SyntaxError</span><span class="op" id="4048574">{</span><span class="string" id="4048575">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4048592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4048596">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4048604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4048608">//&nbsp;DER&nbsp;demands&nbsp;that&nbsp;&#34;If&nbsp;the&nbsp;encoding&nbsp;represents&nbsp;the&nbsp;boolean&nbsp;value&nbsp;TRUE,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4048681">//&nbsp;its&nbsp;single&nbsp;contents&nbsp;octet&nbsp;shall&nbsp;have&nbsp;all&nbsp;eight&nbsp;bits&nbsp;set&nbsp;to&nbsp;one.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4048750">//&nbsp;Thus&nbsp;only&nbsp;0&nbsp;and&nbsp;255&nbsp;are&nbsp;valid&nbsp;encoded&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4048800">switch</span>&nbsp;<span class="ident" id="4048807">bytes</span><span class="op" id="4048812">[</span><span class="num" id="4048813">0</span><span class="op" id="4048814">]</span>&nbsp;<span class="op" id="4048816">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4048819">case</span>&nbsp;<span class="num" id="4048824">0</span><span class="op" id="4048825">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048829">ret</span>&nbsp;<span class="op" id="4048833">=</span>&nbsp;<span class="builtintype" id="4048835">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4048842">case</span>&nbsp;<span class="num" id="4048847">0xff</span><span class="op" id="4048851">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048855">ret</span>&nbsp;<span class="op" id="4048859">=</span>&nbsp;<span class="builtintype" id="4048861">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4048867">default</span><span class="op" id="4048874">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4048878">err</span>&nbsp;<span class="op" id="4048882">=</span>&nbsp;<span class="ident" id="4048884">SyntaxError</span><span class="op" id="4048895">{</span><span class="string" id="4048896">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4048913">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4048916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4048920">return</span><br>
<span class="lineno"></span><span class="op" id="4048927">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="4048930">//&nbsp;INTEGER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4048942">//&nbsp;parseInt64&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4049015">//&nbsp;returns&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4049038">func</span>&nbsp;<span class="ident" id="4049043">parseInt64</span><span class="op" id="4049053">(</span><span class="ident" id="4049054">bytes</span>&nbsp;<span class="op" id="4049060">[</span><span class="op" id="4049061">]</span><span class="builtintype" id="4049062">byte</span><span class="op" id="4049066">)</span>&nbsp;<span class="op" id="4049068">(</span><span class="ident" id="4049069">ret</span>&nbsp;<span class="ident" id="4049073">int64</span><span class="op" id="4049078">,</span>&nbsp;<span class="ident" id="4049080">err</span>&nbsp;<span class="builtintype" id="4049084">error</span><span class="op" id="4049089">)</span>&nbsp;<span class="op" id="4049091">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4049094">if</span>&nbsp;<span class="builtinfunc" id="4049097">len</span><span class="op" id="4049100">(</span><span class="ident" id="4049101">bytes</span><span class="op" id="4049106">)</span>&nbsp;<span class="op" id="4049108">&gt;</span>&nbsp;<span class="num" id="4049110">8</span>&nbsp;<span class="op" id="4049112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4049116">//&nbsp;We&#39;ll&nbsp;overflow&nbsp;an&nbsp;int64&nbsp;in&nbsp;this&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049159">err</span>&nbsp;<span class="op" id="4049163">=</span>&nbsp;<span class="ident" id="4049165">StructuralError</span><span class="op" id="4049180">{</span><span class="string" id="4049181">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4049200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4049204">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4049212">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4049215">for</span>&nbsp;<span class="ident" id="4049219">bytesRead</span>&nbsp;<span class="op" id="4049229">:=</span>&nbsp;<span class="num" id="4049232">0</span><span class="op" id="4049233">;</span>&nbsp;<span class="ident" id="4049235">bytesRead</span>&nbsp;<span class="op" id="4049245">&lt;</span>&nbsp;<span class="builtinfunc" id="4049247">len</span><span class="op" id="4049250">(</span><span class="ident" id="4049251">bytes</span><span class="op" id="4049256">)</span><span class="op" id="4049257">;</span>&nbsp;<span class="ident" id="4049259">bytesRead</span><span class="op" id="4049268">++</span>&nbsp;<span class="op" id="4049271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049275">ret</span>&nbsp;<span class="op" id="4049279">&lt;&lt;=</span>&nbsp;<span class="num" id="4049283">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049287">ret</span>&nbsp;<span class="op" id="4049291">|=</span>&nbsp;<span class="ident" id="4049294">int64</span><span class="op" id="4049299">(</span><span class="ident" id="4049300">bytes</span><span class="op" id="4049305">[</span><span class="ident" id="4049306">bytesRead</span><span class="op" id="4049315">]</span><span class="op" id="4049316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4049319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4049323">//&nbsp;Shift&nbsp;up&nbsp;and&nbsp;down&nbsp;in&nbsp;order&nbsp;to&nbsp;sign&nbsp;extend&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049381">ret</span>&nbsp;<span class="op" id="4049385">&lt;&lt;=</span>&nbsp;<span class="num" id="4049389">64</span>&nbsp;<span class="op" id="4049392">-</span>&nbsp;<span class="builtintype" id="4049394">uint8</span><span class="op" id="4049399">(</span><span class="builtinfunc" id="4049400">len</span><span class="op" id="4049403">(</span><span class="ident" id="4049404">bytes</span><span class="op" id="4049409">)</span><span class="op" id="4049410">)</span><span class="op" id="4049411">*</span><span class="num" id="4049412">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049415">ret</span>&nbsp;<span class="op" id="4049419">&gt;&gt;=</span>&nbsp;<span class="num" id="4049423">64</span>&nbsp;<span class="op" id="4049426">-</span>&nbsp;<span class="builtintype" id="4049428">uint8</span><span class="op" id="4049433">(</span><span class="builtinfunc" id="4049434">len</span><span class="op" id="4049437">(</span><span class="ident" id="4049438">bytes</span><span class="op" id="4049443">)</span><span class="op" id="4049444">)</span><span class="op" id="4049445">*</span><span class="num" id="4049446">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4049449">return</span><br>
<span class="lineno"></span><span class="op" id="4049456">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="4049459">//&nbsp;parseInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4049538">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4049553">func</span>&nbsp;<span class="ident" id="4049558">parseInt32</span><span class="op" id="4049568">(</span><span class="ident" id="4049569">bytes</span>&nbsp;<span class="op" id="4049575">[</span><span class="op" id="4049576">]</span><span class="builtintype" id="4049577">byte</span><span class="op" id="4049581">)</span>&nbsp;<span class="op" id="4049583">(</span><span class="builtintype" id="4049584">int32</span><span class="op" id="4049589">,</span>&nbsp;<span class="builtintype" id="4049591">error</span><span class="op" id="4049596">)</span>&nbsp;<span class="op" id="4049598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049601">ret64</span><span class="op" id="4049606">,</span>&nbsp;<span class="ident" id="4049608">err</span>&nbsp;<span class="op" id="4049612">:=</span>&nbsp;<span class="ident" id="4049615">parseInt64</span><span class="op" id="4049625">(</span><span class="ident" id="4049626">bytes</span><span class="op" id="4049631">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4049634">if</span>&nbsp;<span class="ident" id="4049637">err</span>&nbsp;<span class="op" id="4049641">!=</span>&nbsp;<span class="builtintype" id="4049644">nil</span>&nbsp;<span class="op" id="4049648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4049652">return</span>&nbsp;<span class="num" id="4049659">0</span><span class="op" id="4049660">,</span>&nbsp;<span class="ident" id="4049662">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4049667">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4049670">if</span>&nbsp;<span class="ident" id="4049673">ret64</span>&nbsp;<span class="op" id="4049679">!=</span>&nbsp;<span class="ident" id="4049682">int64</span><span class="op" id="4049687">(</span><span class="builtintype" id="4049688">int32</span><span class="op" id="4049693">(</span><span class="ident" id="4049694">ret64</span><span class="op" id="4049699">)</span><span class="op" id="4049700">)</span>&nbsp;<span class="op" id="4049702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4049706">return</span>&nbsp;<span class="num" id="4049713">0</span><span class="op" id="4049714">,</span>&nbsp;<span class="ident" id="4049716">StructuralError</span><span class="op" id="4049731">{</span><span class="string" id="4049732">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4049751">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4049754">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4049757">return</span>&nbsp;<span class="builtintype" id="4049764">int32</span><span class="op" id="4049769">(</span><span class="ident" id="4049770">ret64</span><span class="op" id="4049775">)</span><span class="op" id="4049776">,</span>&nbsp;<span class="builtintype" id="4049778">nil</span><br>
<span class="lineno"></span><span class="op" id="4049782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4049785">var</span>&nbsp;<span class="ident" id="4049789">bigOne</span>&nbsp;<span class="op" id="4049796">=</span>&nbsp;<span class="ident" id="4049798">big</span><span class="op" id="4049801">.</span><span class="ident" id="4049802">NewInt</span><span class="op" id="4049808">(</span><span class="num" id="4049809">1</span><span class="op" id="4049810">)</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4049813">//&nbsp;parseBigInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4049895">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4049910">func</span>&nbsp;<span class="ident" id="4049915">parseBigInt</span><span class="op" id="4049926">(</span><span class="ident" id="4049927">bytes</span>&nbsp;<span class="op" id="4049933">[</span><span class="op" id="4049934">]</span><span class="builtintype" id="4049935">byte</span><span class="op" id="4049939">)</span>&nbsp;<span class="op" id="4049941">*</span><span class="ident" id="4049942">big</span><span class="op" id="4049945">.</span><span class="ident" id="4049946">Int</span>&nbsp;<span class="op" id="4049950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4049953">ret</span>&nbsp;<span class="op" id="4049957">:=</span>&nbsp;<span class="builtinfunc" id="4049960">new</span><span class="op" id="4049963">(</span><span class="ident" id="4049964">big</span><span class="op" id="4049967">.</span><span class="ident" id="4049968">Int</span><span class="op" id="4049971">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4049974">if</span>&nbsp;<span class="builtinfunc" id="4049977">len</span><span class="op" id="4049980">(</span><span class="ident" id="4049981">bytes</span><span class="op" id="4049986">)</span>&nbsp;<span class="op" id="4049988">&gt;</span>&nbsp;<span class="num" id="4049990">0</span>&nbsp;<span class="op" id="4049992">&amp;&amp;</span>&nbsp;<span class="ident" id="4049995">bytes</span><span class="op" id="4050000">[</span><span class="num" id="4050001">0</span><span class="op" id="4050002">]</span><span class="op" id="4050003">&amp;</span><span class="num" id="4050004">0x80</span>&nbsp;<span class="op" id="4050009">==</span>&nbsp;<span class="num" id="4050012">0x80</span>&nbsp;<span class="op" id="4050017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4050021">//&nbsp;This&nbsp;is&nbsp;a&nbsp;negative&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050053">notBytes</span>&nbsp;<span class="op" id="4050062">:=</span>&nbsp;<span class="builtinfunc" id="4050065">make</span><span class="op" id="4050069">(</span><span class="op" id="4050070">[</span><span class="op" id="4050071">]</span><span class="builtintype" id="4050072">byte</span><span class="op" id="4050076">,</span>&nbsp;<span class="builtinfunc" id="4050078">len</span><span class="op" id="4050081">(</span><span class="ident" id="4050082">bytes</span><span class="op" id="4050087">)</span><span class="op" id="4050088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4050092">for</span>&nbsp;<span class="ident" id="4050096">i</span>&nbsp;<span class="op" id="4050098">:=</span>&nbsp;<span class="keyword" id="4050101">range</span>&nbsp;<span class="ident" id="4050107">notBytes</span>&nbsp;<span class="op" id="4050116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050121">notBytes</span><span class="op" id="4050129">[</span><span class="ident" id="4050130">i</span><span class="op" id="4050131">]</span>&nbsp;<span class="op" id="4050133">=</span>&nbsp;<span class="op" id="4050135">^</span><span class="ident" id="4050136">bytes</span><span class="op" id="4050141">[</span><span class="ident" id="4050142">i</span><span class="op" id="4050143">]</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4050147">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050151">ret</span><span class="op" id="4050154">.</span><span class="ident" id="4050155">SetBytes</span><span class="op" id="4050163">(</span><span class="ident" id="4050164">notBytes</span><span class="op" id="4050172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050176">ret</span><span class="op" id="4050179">.</span><span class="ident" id="4050180">Add</span><span class="op" id="4050183">(</span><span class="ident" id="4050184">ret</span><span class="op" id="4050187">,</span>&nbsp;<span class="ident" id="4050189">bigOne</span><span class="op" id="4050195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050199">ret</span><span class="op" id="4050202">.</span><span class="ident" id="4050203">Neg</span><span class="op" id="4050206">(</span><span class="ident" id="4050207">ret</span><span class="op" id="4050210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4050214">return</span>&nbsp;<span class="ident" id="4050221">ret</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4050226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050229">ret</span><span class="op" id="4050232">.</span><span class="ident" id="4050233">SetBytes</span><span class="op" id="4050241">(</span><span class="ident" id="4050242">bytes</span><span class="op" id="4050247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4050250">return</span>&nbsp;<span class="ident" id="4050257">ret</span><br>
<span class="lineno"></span><span class="op" id="4050261">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="4050264">//&nbsp;BIT&nbsp;STRING</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4050279">//&nbsp;BitString&nbsp;is&nbsp;the&nbsp;structure&nbsp;to&nbsp;use&nbsp;when&nbsp;you&nbsp;want&nbsp;an&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;type.&nbsp;A</span><br>
<span class="lineno"></span><span class="comment" id="4050358">//&nbsp;bit&nbsp;string&nbsp;is&nbsp;padded&nbsp;up&nbsp;to&nbsp;the&nbsp;nearest&nbsp;byte&nbsp;in&nbsp;memory&nbsp;and&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4050433">//&nbsp;valid&nbsp;bits&nbsp;is&nbsp;recorded.&nbsp;Padding&nbsp;bits&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno">130</span><span class="keyword" id="4050487">type</span>&nbsp;<span class="ident" id="4050492">BitString</span>&nbsp;<span class="keyword" id="4050502">struct</span>&nbsp;<span class="op" id="4050509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050512">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4050522">[</span><span class="op" id="4050523">]</span><span class="builtintype" id="4050524">byte</span>&nbsp;<span class="comment" id="4050529">//&nbsp;bits&nbsp;packed&nbsp;into&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050557">BitLength</span>&nbsp;<span class="builtintype" id="4050567">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4050574">//&nbsp;length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span><span class="op" id="4050593">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="4050596">//&nbsp;At&nbsp;returns&nbsp;the&nbsp;bit&nbsp;at&nbsp;the&nbsp;given&nbsp;index.&nbsp;If&nbsp;the&nbsp;index&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4050670">//&nbsp;returns&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword" id="4050688">func</span>&nbsp;<span class="op" id="4050693">(</span><span class="ident" id="4050694">b</span>&nbsp;<span class="ident" id="4050696">BitString</span><span class="op" id="4050705">)</span>&nbsp;<span class="ident" id="4050707">At</span><span class="op" id="4050709">(</span><span class="ident" id="4050710">i</span>&nbsp;<span class="builtintype" id="4050712">int</span><span class="op" id="4050715">)</span>&nbsp;<span class="builtintype" id="4050717">int</span>&nbsp;<span class="op" id="4050721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4050724">if</span>&nbsp;<span class="ident" id="4050727">i</span>&nbsp;<span class="op" id="4050729">&lt;</span>&nbsp;<span class="num" id="4050731">0</span>&nbsp;<span class="op" id="4050733">||</span>&nbsp;<span class="ident" id="4050736">i</span>&nbsp;<span class="op" id="4050738">&gt;=</span>&nbsp;<span class="ident" id="4050741">b</span><span class="op" id="4050742">.</span><span class="ident" id="4050743">BitLength</span>&nbsp;<span class="op" id="4050753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4050757">return</span>&nbsp;<span class="num" id="4050764">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4050767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050770">x</span>&nbsp;<span class="op" id="4050772">:=</span>&nbsp;<span class="ident" id="4050775">i</span>&nbsp;<span class="op" id="4050777">/</span>&nbsp;<span class="num" id="4050779">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4050782">y</span>&nbsp;<span class="op" id="4050784">:=</span>&nbsp;<span class="num" id="4050787">7</span>&nbsp;<span class="op" id="4050789">-</span>&nbsp;<span class="builtintype" id="4050791">uint</span><span class="op" id="4050795">(</span><span class="ident" id="4050796">i</span><span class="op" id="4050797">%</span><span class="num" id="4050798">8</span><span class="op" id="4050799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4050802">return</span>&nbsp;<span class="builtintype" id="4050809">int</span><span class="op" id="4050812">(</span><span class="ident" id="4050813">b</span><span class="op" id="4050814">.</span><span class="ident" id="4050815">Bytes</span><span class="op" id="4050820">[</span><span class="ident" id="4050821">x</span><span class="op" id="4050822">]</span><span class="op" id="4050823">&gt;&gt;</span><span class="ident" id="4050825">y</span><span class="op" id="4050826">)</span>&nbsp;<span class="op" id="4050828">&amp;</span>&nbsp;<span class="num" id="4050830">1</span><br>
<span class="lineno"></span><span class="op" id="4050832">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="4050835">//&nbsp;RightAlign&nbsp;returns&nbsp;a&nbsp;slice&nbsp;where&nbsp;the&nbsp;padding&nbsp;bits&nbsp;are&nbsp;at&nbsp;the&nbsp;beginning.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4050914">//&nbsp;slice&nbsp;may&nbsp;share&nbsp;memory&nbsp;with&nbsp;the&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="keyword" id="4050960">func</span>&nbsp;<span class="op" id="4050965">(</span><span class="ident" id="4050966">b</span>&nbsp;<span class="ident" id="4050968">BitString</span><span class="op" id="4050977">)</span>&nbsp;<span class="ident" id="4050979">RightAlign</span><span class="op" id="4050989">(</span><span class="op" id="4050990">)</span>&nbsp;<span class="op" id="4050992">[</span><span class="op" id="4050993">]</span><span class="builtintype" id="4050994">byte</span>&nbsp;<span class="op" id="4050999">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051002">shift</span>&nbsp;<span class="op" id="4051008">:=</span>&nbsp;<span class="builtintype" id="4051011">uint</span><span class="op" id="4051015">(</span><span class="num" id="4051016">8</span>&nbsp;<span class="op" id="4051018">-</span>&nbsp;<span class="op" id="4051020">(</span><span class="ident" id="4051021">b</span><span class="op" id="4051022">.</span><span class="ident" id="4051023">BitLength</span>&nbsp;<span class="op" id="4051033">%</span>&nbsp;<span class="num" id="4051035">8</span><span class="op" id="4051036">)</span><span class="op" id="4051037">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4051040">if</span>&nbsp;<span class="ident" id="4051043">shift</span>&nbsp;<span class="op" id="4051049">==</span>&nbsp;<span class="num" id="4051052">8</span>&nbsp;<span class="op" id="4051054">||</span>&nbsp;<span class="builtinfunc" id="4051057">len</span><span class="op" id="4051060">(</span><span class="ident" id="4051061">b</span><span class="op" id="4051062">.</span><span class="ident" id="4051063">Bytes</span><span class="op" id="4051068">)</span>&nbsp;<span class="op" id="4051070">==</span>&nbsp;<span class="num" id="4051073">0</span>&nbsp;<span class="op" id="4051075">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4051079">return</span>&nbsp;<span class="ident" id="4051086">b</span><span class="op" id="4051087">.</span><span class="ident" id="4051088">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4051095">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051099">a</span>&nbsp;<span class="op" id="4051101">:=</span>&nbsp;<span class="builtinfunc" id="4051104">make</span><span class="op" id="4051108">(</span><span class="op" id="4051109">[</span><span class="op" id="4051110">]</span><span class="builtintype" id="4051111">byte</span><span class="op" id="4051115">,</span>&nbsp;<span class="builtinfunc" id="4051117">len</span><span class="op" id="4051120">(</span><span class="ident" id="4051121">b</span><span class="op" id="4051122">.</span><span class="ident" id="4051123">Bytes</span><span class="op" id="4051128">)</span><span class="op" id="4051129">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051132">a</span><span class="op" id="4051133">[</span><span class="num" id="4051134">0</span><span class="op" id="4051135">]</span>&nbsp;<span class="op" id="4051137">=</span>&nbsp;<span class="ident" id="4051139">b</span><span class="op" id="4051140">.</span><span class="ident" id="4051141">Bytes</span><span class="op" id="4051146">[</span><span class="num" id="4051147">0</span><span class="op" id="4051148">]</span>&nbsp;<span class="op" id="4051150">&gt;&gt;</span>&nbsp;<span class="ident" id="4051153">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4051160">for</span>&nbsp;<span class="ident" id="4051164">i</span>&nbsp;<span class="op" id="4051166">:=</span>&nbsp;<span class="num" id="4051169">1</span><span class="op" id="4051170">;</span>&nbsp;<span class="ident" id="4051172">i</span>&nbsp;<span class="op" id="4051174">&lt;</span>&nbsp;<span class="builtinfunc" id="4051176">len</span><span class="op" id="4051179">(</span><span class="ident" id="4051180">b</span><span class="op" id="4051181">.</span><span class="ident" id="4051182">Bytes</span><span class="op" id="4051187">)</span><span class="op" id="4051188">;</span>&nbsp;<span class="ident" id="4051190">i</span><span class="op" id="4051191">++</span>&nbsp;<span class="op" id="4051194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051198">a</span><span class="op" id="4051199">[</span><span class="ident" id="4051200">i</span><span class="op" id="4051201">]</span>&nbsp;<span class="op" id="4051203">=</span>&nbsp;<span class="ident" id="4051205">b</span><span class="op" id="4051206">.</span><span class="ident" id="4051207">Bytes</span><span class="op" id="4051212">[</span><span class="ident" id="4051213">i</span><span class="op" id="4051214">-</span><span class="num" id="4051215">1</span><span class="op" id="4051216">]</span>&nbsp;<span class="op" id="4051218">&lt;&lt;</span>&nbsp;<span class="op" id="4051221">(</span><span class="num" id="4051222">8</span>&nbsp;<span class="op" id="4051224">-</span>&nbsp;<span class="ident" id="4051226">shift</span><span class="op" id="4051231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051235">a</span><span class="op" id="4051236">[</span><span class="ident" id="4051237">i</span><span class="op" id="4051238">]</span>&nbsp;<span class="op" id="4051240">|=</span>&nbsp;<span class="ident" id="4051243">b</span><span class="op" id="4051244">.</span><span class="ident" id="4051245">Bytes</span><span class="op" id="4051250">[</span><span class="ident" id="4051251">i</span><span class="op" id="4051252">]</span>&nbsp;<span class="op" id="4051254">&gt;&gt;</span>&nbsp;<span class="ident" id="4051257">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4051264">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4051268">return</span>&nbsp;<span class="ident" id="4051275">a</span><br>
<span class="lineno"></span><span class="op" id="4051277">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4051280">//&nbsp;parseBitString&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;bit&nbsp;string&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno">165</span><span class="keyword" id="4051367">func</span>&nbsp;<span class="ident" id="4051372">parseBitString</span><span class="op" id="4051386">(</span><span class="ident" id="4051387">bytes</span>&nbsp;<span class="op" id="4051393">[</span><span class="op" id="4051394">]</span><span class="builtintype" id="4051395">byte</span><span class="op" id="4051399">)</span>&nbsp;<span class="op" id="4051401">(</span><span class="ident" id="4051402">ret</span>&nbsp;<span class="ident" id="4051406">BitString</span><span class="op" id="4051415">,</span>&nbsp;<span class="ident" id="4051417">err</span>&nbsp;<span class="builtintype" id="4051421">error</span><span class="op" id="4051426">)</span>&nbsp;<span class="op" id="4051428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4051431">if</span>&nbsp;<span class="builtinfunc" id="4051434">len</span><span class="op" id="4051437">(</span><span class="ident" id="4051438">bytes</span><span class="op" id="4051443">)</span>&nbsp;<span class="op" id="4051445">==</span>&nbsp;<span class="num" id="4051448">0</span>&nbsp;<span class="op" id="4051450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051454">err</span>&nbsp;<span class="op" id="4051458">=</span>&nbsp;<span class="ident" id="4051460">SyntaxError</span><span class="op" id="4051471">{</span><span class="string" id="4051472">&#34;zero&nbsp;length&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4051496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4051500">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4051508">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051511">paddingBits</span>&nbsp;<span class="op" id="4051523">:=</span>&nbsp;<span class="builtintype" id="4051526">int</span><span class="op" id="4051529">(</span><span class="ident" id="4051530">bytes</span><span class="op" id="4051535">[</span><span class="num" id="4051536">0</span><span class="op" id="4051537">]</span><span class="op" id="4051538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4051541">if</span>&nbsp;<span class="ident" id="4051544">paddingBits</span>&nbsp;<span class="op" id="4051556">&gt;</span>&nbsp;<span class="num" id="4051558">7</span>&nbsp;<span class="op" id="4051560">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4051565">len</span><span class="op" id="4051568">(</span><span class="ident" id="4051569">bytes</span><span class="op" id="4051574">)</span>&nbsp;<span class="op" id="4051576">==</span>&nbsp;<span class="num" id="4051579">1</span>&nbsp;<span class="op" id="4051581">&amp;&amp;</span>&nbsp;<span class="ident" id="4051584">paddingBits</span>&nbsp;<span class="op" id="4051596">&gt;</span>&nbsp;<span class="num" id="4051598">0</span>&nbsp;<span class="op" id="4051600">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051605">bytes</span><span class="op" id="4051610">[</span><span class="builtinfunc" id="4051611">len</span><span class="op" id="4051614">(</span><span class="ident" id="4051615">bytes</span><span class="op" id="4051620">)</span><span class="op" id="4051621">-</span><span class="num" id="4051622">1</span><span class="op" id="4051623">]</span><span class="op" id="4051624">&amp;</span><span class="op" id="4051625">(</span><span class="op" id="4051626">(</span><span class="num" id="4051627">1</span><span class="op" id="4051628">&lt;&lt;</span><span class="ident" id="4051630">bytes</span><span class="op" id="4051635">[</span><span class="num" id="4051636">0</span><span class="op" id="4051637">]</span><span class="op" id="4051638">)</span><span class="op" id="4051639">-</span><span class="num" id="4051640">1</span><span class="op" id="4051641">)</span>&nbsp;<span class="op" id="4051643">!=</span>&nbsp;<span class="num" id="4051646">0</span>&nbsp;<span class="op" id="4051648">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051652">err</span>&nbsp;<span class="op" id="4051656">=</span>&nbsp;<span class="ident" id="4051658">SyntaxError</span><span class="op" id="4051669">{</span><span class="string" id="4051670">&#34;invalid&nbsp;padding&nbsp;bits&nbsp;in&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4051706">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4051710">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4051718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051721">ret</span><span class="op" id="4051724">.</span><span class="ident" id="4051725">BitLength</span>&nbsp;<span class="op" id="4051735">=</span>&nbsp;<span class="op" id="4051737">(</span><span class="builtinfunc" id="4051738">len</span><span class="op" id="4051741">(</span><span class="ident" id="4051742">bytes</span><span class="op" id="4051747">)</span><span class="op" id="4051748">-</span><span class="num" id="4051749">1</span><span class="op" id="4051750">)</span><span class="op" id="4051751">*</span><span class="num" id="4051752">8</span>&nbsp;<span class="op" id="4051754">-</span>&nbsp;<span class="ident" id="4051756">paddingBits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4051769">ret</span><span class="op" id="4051772">.</span><span class="ident" id="4051773">Bytes</span>&nbsp;<span class="op" id="4051779">=</span>&nbsp;<span class="ident" id="4051781">bytes</span><span class="op" id="4051786">[</span><span class="num" id="4051787">1</span><span class="op" id="4051788">:</span><span class="op" id="4051789">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4051792">return</span><br>
<span class="lineno">180</span><span class="op" id="4051799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4051802">//&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4051824">//&nbsp;An&nbsp;ObjectIdentifier&nbsp;represents&nbsp;an&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER.</span><br>
<span class="lineno">185</span><span class="keyword" id="4051886">type</span>&nbsp;<span class="ident" id="4051891">ObjectIdentifier</span>&nbsp;<span class="op" id="4051908">[</span><span class="op" id="4051909">]</span><span class="builtintype" id="4051910">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4051915">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;oi&nbsp;and&nbsp;other&nbsp;represent&nbsp;the&nbsp;same&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="4051984">func</span>&nbsp;<span class="op" id="4051989">(</span><span class="ident" id="4051990">oi</span>&nbsp;<span class="ident" id="4051993">ObjectIdentifier</span><span class="op" id="4052009">)</span>&nbsp;<span class="ident" id="4052011">Equal</span><span class="op" id="4052016">(</span><span class="ident" id="4052017">other</span>&nbsp;<span class="ident" id="4052023">ObjectIdentifier</span><span class="op" id="4052039">)</span>&nbsp;<span class="builtintype" id="4052041">bool</span>&nbsp;<span class="op" id="4052046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4052049">if</span>&nbsp;<span class="builtinfunc" id="4052052">len</span><span class="op" id="4052055">(</span><span class="ident" id="4052056">oi</span><span class="op" id="4052058">)</span>&nbsp;<span class="op" id="4052060">!=</span>&nbsp;<span class="builtinfunc" id="4052063">len</span><span class="op" id="4052066">(</span><span class="ident" id="4052067">other</span><span class="op" id="4052072">)</span>&nbsp;<span class="op" id="4052074">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4052078">return</span>&nbsp;<span class="builtintype" id="4052085">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4052092">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4052095">for</span>&nbsp;<span class="ident" id="4052099">i</span>&nbsp;<span class="op" id="4052101">:=</span>&nbsp;<span class="num" id="4052104">0</span><span class="op" id="4052105">;</span>&nbsp;<span class="ident" id="4052107">i</span>&nbsp;<span class="op" id="4052109">&lt;</span>&nbsp;<span class="builtinfunc" id="4052111">len</span><span class="op" id="4052114">(</span><span class="ident" id="4052115">oi</span><span class="op" id="4052117">)</span><span class="op" id="4052118">;</span>&nbsp;<span class="ident" id="4052120">i</span><span class="op" id="4052121">++</span>&nbsp;<span class="op" id="4052124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4052128">if</span>&nbsp;<span class="ident" id="4052131">oi</span><span class="op" id="4052133">[</span><span class="ident" id="4052134">i</span><span class="op" id="4052135">]</span>&nbsp;<span class="op" id="4052137">!=</span>&nbsp;<span class="ident" id="4052140">other</span><span class="op" id="4052145">[</span><span class="ident" id="4052146">i</span><span class="op" id="4052147">]</span>&nbsp;<span class="op" id="4052149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4052154">return</span>&nbsp;<span class="builtintype" id="4052161">false</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4052169">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4052172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4052176">return</span>&nbsp;<span class="builtintype" id="4052183">true</span><br>
<span class="lineno"></span><span class="op" id="4052188">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="4052191">func</span>&nbsp;<span class="op" id="4052196">(</span><span class="ident" id="4052197">oi</span>&nbsp;<span class="ident" id="4052200">ObjectIdentifier</span><span class="op" id="4052216">)</span>&nbsp;<span class="ident" id="4052218">String</span><span class="op" id="4052224">(</span><span class="op" id="4052225">)</span>&nbsp;<span class="builtintype" id="4052227">string</span>&nbsp;<span class="op" id="4052234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4052237">var</span>&nbsp;<span class="ident" id="4052241">s</span>&nbsp;<span class="builtintype" id="4052243">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4052252">for</span>&nbsp;<span class="ident" id="4052256">i</span><span class="op" id="4052257">,</span>&nbsp;<span class="ident" id="4052259">v</span>&nbsp;<span class="op" id="4052261">:=</span>&nbsp;<span class="keyword" id="4052264">range</span>&nbsp;<span class="ident" id="4052270">oi</span>&nbsp;<span class="op" id="4052273">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4052277">if</span>&nbsp;<span class="ident" id="4052280">i</span>&nbsp;<span class="op" id="4052282">&gt;</span>&nbsp;<span class="num" id="4052284">0</span>&nbsp;<span class="op" id="4052286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4052291">s</span>&nbsp;<span class="op" id="4052293">+=</span>&nbsp;<span class="string" id="4052296">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4052302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4052306">s</span>&nbsp;<span class="op" id="4052308">+=</span>&nbsp;<span class="ident" id="4052311">strconv</span><span class="op" id="4052318">.</span><span class="ident" id="4052319">Itoa</span><span class="op" id="4052323">(</span><span class="ident" id="4052324">v</span><span class="op" id="4052325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4052328">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4052332">return</span>&nbsp;<span class="ident" id="4052339">s</span><br>
<span class="lineno"></span><span class="op" id="4052341">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4052344">//&nbsp;parseObjectIdentifier&nbsp;parses&nbsp;an&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes&nbsp;and</span><br>
<span class="lineno">215</span><span class="comment" id="4052422">//&nbsp;returns&nbsp;it.&nbsp;An&nbsp;object&nbsp;identifier&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;variable&nbsp;length&nbsp;integers</span><br>
<span class="lineno"></span><span class="comment" id="4052500">//&nbsp;that&nbsp;are&nbsp;assigned&nbsp;in&nbsp;a&nbsp;hierarchy.</span><br>
<span class="lineno"></span><span class="keyword" id="4052537">func</span>&nbsp;<span class="ident" id="4052542">parseObjectIdentifier</span><span class="op" id="4052563">(</span><span class="ident" id="4052564">bytes</span>&nbsp;<span class="op" id="4052570">[</span><span class="op" id="4052571">]</span><span class="builtintype" id="4052572">byte</span><span class="op" id="4052576">)</span>&nbsp;<span class="op" id="4052578">(</span><span class="ident" id="4052579">s</span>&nbsp;<span class="op" id="4052581">[</span><span class="op" id="4052582">]</span><span class="builtintype" id="4052583">int</span><span class="op" id="4052586">,</span>&nbsp;<span class="ident" id="4052588">err</span>&nbsp;<span class="builtintype" id="4052592">error</span><span class="op" id="4052597">)</span>&nbsp;<span class="op" id="4052599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4052602">if</span>&nbsp;<span class="builtinfunc" id="4052605">len</span><span class="op" id="4052608">(</span><span class="ident" id="4052609">bytes</span><span class="op" id="4052614">)</span>&nbsp;<span class="op" id="4052616">==</span>&nbsp;<span class="num" id="4052619">0</span>&nbsp;<span class="op" id="4052621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4052625">err</span>&nbsp;<span class="op" id="4052629">=</span>&nbsp;<span class="ident" id="4052631">SyntaxError</span><span class="op" id="4052642">{</span><span class="string" id="4052643">&#34;zero&nbsp;length&nbsp;OBJECT&nbsp;IDENTIFIER&#34;</span><span class="op" id="4052674">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4052678">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4052686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4052690">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;we&nbsp;get&nbsp;two&nbsp;elements&nbsp;from&nbsp;the&nbsp;first&nbsp;byte&nbsp;(which&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4052763">//&nbsp;encoded&nbsp;differently)&nbsp;and&nbsp;then&nbsp;every&nbsp;varint&nbsp;is&nbsp;a&nbsp;single&nbsp;byte&nbsp;long.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4052833">s</span>&nbsp;<span class="op" id="4052835">=</span>&nbsp;<span class="builtinfunc" id="4052837">make</span><span class="op" id="4052841">(</span><span class="op" id="4052842">[</span><span class="op" id="4052843">]</span><span class="builtintype" id="4052844">int</span><span class="op" id="4052847">,</span>&nbsp;<span class="builtinfunc" id="4052849">len</span><span class="op" id="4052852">(</span><span class="ident" id="4052853">bytes</span><span class="op" id="4052858">)</span><span class="op" id="4052859">+</span><span class="num" id="4052860">1</span><span class="op" id="4052861">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4052865">//&nbsp;The&nbsp;first&nbsp;varint&nbsp;is&nbsp;40*value1&nbsp;+&nbsp;value2:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4052909">//&nbsp;According&nbsp;to&nbsp;this&nbsp;packing,&nbsp;value1&nbsp;can&nbsp;take&nbsp;the&nbsp;values&nbsp;0,&nbsp;1&nbsp;and&nbsp;2&nbsp;only.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4052984">//&nbsp;When&nbsp;value1&nbsp;=&nbsp;0&nbsp;or&nbsp;value1&nbsp;=&nbsp;1,&nbsp;then&nbsp;value2&nbsp;is&nbsp;&lt;=&nbsp;39.&nbsp;When&nbsp;value1&nbsp;=&nbsp;2,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4053058">//&nbsp;then&nbsp;there&nbsp;are&nbsp;no&nbsp;restrictions&nbsp;on&nbsp;value2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4053104">v</span><span class="op" id="4053105">,</span>&nbsp;<span class="ident" id="4053107">offset</span><span class="op" id="4053113">,</span>&nbsp;<span class="ident" id="4053115">err</span>&nbsp;<span class="op" id="4053119">:=</span>&nbsp;<span class="ident" id="4053122">parseBase128Int</span><span class="op" id="4053137">(</span><span class="ident" id="4053138">bytes</span><span class="op" id="4053143">,</span>&nbsp;<span class="num" id="4053145">0</span><span class="op" id="4053146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4053149">if</span>&nbsp;<span class="ident" id="4053152">err</span>&nbsp;<span class="op" id="4053156">!=</span>&nbsp;<span class="builtintype" id="4053159">nil</span>&nbsp;<span class="op" id="4053163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4053167">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4053175">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4053178">if</span>&nbsp;<span class="ident" id="4053181">v</span>&nbsp;<span class="op" id="4053183">&lt;</span>&nbsp;<span class="num" id="4053185">80</span>&nbsp;<span class="op" id="4053188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4053192">s</span><span class="op" id="4053193">[</span><span class="num" id="4053194">0</span><span class="op" id="4053195">]</span>&nbsp;<span class="op" id="4053197">=</span>&nbsp;<span class="ident" id="4053199">v</span>&nbsp;<span class="op" id="4053201">/</span>&nbsp;<span class="num" id="4053203">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4053208">s</span><span class="op" id="4053209">[</span><span class="num" id="4053210">1</span><span class="op" id="4053211">]</span>&nbsp;<span class="op" id="4053213">=</span>&nbsp;<span class="ident" id="4053215">v</span>&nbsp;<span class="op" id="4053217">%</span>&nbsp;<span class="num" id="4053219">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4053223">}</span>&nbsp;<span class="keyword" id="4053225">else</span>&nbsp;<span class="op" id="4053230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4053234">s</span><span class="op" id="4053235">[</span><span class="num" id="4053236">0</span><span class="op" id="4053237">]</span>&nbsp;<span class="op" id="4053239">=</span>&nbsp;<span class="num" id="4053241">2</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4053245">s</span><span class="op" id="4053246">[</span><span class="num" id="4053247">1</span><span class="op" id="4053248">]</span>&nbsp;<span class="op" id="4053250">=</span>&nbsp;<span class="ident" id="4053252">v</span>&nbsp;<span class="op" id="4053254">-</span>&nbsp;<span class="num" id="4053256">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4053260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4053264">i</span>&nbsp;<span class="op" id="4053266">:=</span>&nbsp;<span class="num" id="4053269">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4053272">for</span>&nbsp;<span class="op" id="4053276">;</span>&nbsp;<span class="ident" id="4053278">offset</span>&nbsp;<span class="op" id="4053285">&lt;</span>&nbsp;<span class="builtinfunc" id="4053287">len</span><span class="op" id="4053290">(</span><span class="ident" id="4053291">bytes</span><span class="op" id="4053296">)</span><span class="op" id="4053297">;</span>&nbsp;<span class="ident" id="4053299">i</span><span class="op" id="4053300">++</span>&nbsp;<span class="op" id="4053303">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4053307">v</span><span class="op" id="4053308">,</span>&nbsp;<span class="ident" id="4053310">offset</span><span class="op" id="4053316">,</span>&nbsp;<span class="ident" id="4053318">err</span>&nbsp;<span class="op" id="4053322">=</span>&nbsp;<span class="ident" id="4053324">parseBase128Int</span><span class="op" id="4053339">(</span><span class="ident" id="4053340">bytes</span><span class="op" id="4053345">,</span>&nbsp;<span class="ident" id="4053347">offset</span><span class="op" id="4053353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4053357">if</span>&nbsp;<span class="ident" id="4053360">err</span>&nbsp;<span class="op" id="4053364">!=</span>&nbsp;<span class="builtintype" id="4053367">nil</span>&nbsp;<span class="op" id="4053371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4053376">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4053385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4053389">s</span><span class="op" id="4053390">[</span><span class="ident" id="4053391">i</span><span class="op" id="4053392">]</span>&nbsp;<span class="op" id="4053394">=</span>&nbsp;<span class="ident" id="4053396">v</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4053399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4053402">s</span>&nbsp;<span class="op" id="4053404">=</span>&nbsp;<span class="ident" id="4053406">s</span><span class="op" id="4053407">[</span><span class="num" id="4053408">0</span><span class="op" id="4053409">:</span><span class="ident" id="4053410">i</span><span class="op" id="4053411">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4053414">return</span><br>
<span class="lineno"></span><span class="op" id="4053421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="4053424">//&nbsp;ENUMERATED</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4053439">//&nbsp;An&nbsp;Enumerated&nbsp;is&nbsp;represented&nbsp;as&nbsp;a&nbsp;plain&nbsp;int.</span><br>
<span class="lineno"></span><span class="keyword" id="4053487">type</span>&nbsp;<span class="ident" id="4053492">Enumerated</span>&nbsp;<span class="builtintype" id="4053503">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="4053508">//&nbsp;FLAG</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4053517">//&nbsp;A&nbsp;Flag&nbsp;accepts&nbsp;any&nbsp;data&nbsp;and&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="4053575">type</span>&nbsp;<span class="ident" id="4053580">Flag</span>&nbsp;<span class="builtintype" id="4053585">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="4053591">//&nbsp;parseBase128Int&nbsp;parses&nbsp;a&nbsp;base-128&nbsp;encoded&nbsp;int&nbsp;from&nbsp;the&nbsp;given&nbsp;offset&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4053669">//&nbsp;given&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;value&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.</span><br>
<span class="lineno"></span><span class="keyword" id="4053731">func</span>&nbsp;<span class="ident" id="4053736">parseBase128Int</span><span class="op" id="4053751">(</span><span class="ident" id="4053752">bytes</span>&nbsp;<span class="op" id="4053758">[</span><span class="op" id="4053759">]</span><span class="builtintype" id="4053760">byte</span><span class="op" id="4053764">,</span>&nbsp;<span class="ident" id="4053766">initOffset</span>&nbsp;<span class="builtintype" id="4053777">int</span><span class="op" id="4053780">)</span>&nbsp;<span class="op" id="4053782">(</span><span class="ident" id="4053783">ret</span><span class="op" id="4053786">,</span>&nbsp;<span class="ident" id="4053788">offset</span>&nbsp;<span class="builtintype" id="4053795">int</span><span class="op" id="4053798">,</span>&nbsp;<span class="ident" id="4053800">err</span>&nbsp;<span class="builtintype" id="4053804">error</span><span class="op" id="4053809">)</span>&nbsp;<span class="op" id="4053811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4053814">offset</span>&nbsp;<span class="op" id="4053821">=</span>&nbsp;<span class="ident" id="4053823">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4053835">for</span>&nbsp;<span class="ident" id="4053839">shifted</span>&nbsp;<span class="op" id="4053847">:=</span>&nbsp;<span class="num" id="4053850">0</span><span class="op" id="4053851">;</span>&nbsp;<span class="ident" id="4053853">offset</span>&nbsp;<span class="op" id="4053860">&lt;</span>&nbsp;<span class="builtinfunc" id="4053862">len</span><span class="op" id="4053865">(</span><span class="ident" id="4053866">bytes</span><span class="op" id="4053871">)</span><span class="op" id="4053872">;</span>&nbsp;<span class="ident" id="4053874">shifted</span><span class="op" id="4053881">++</span>&nbsp;<span class="op" id="4053884">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4053888">if</span>&nbsp;<span class="ident" id="4053891">shifted</span>&nbsp;<span class="op" id="4053899">&gt;</span>&nbsp;<span class="num" id="4053901">4</span>&nbsp;<span class="op" id="4053903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4053908">err</span>&nbsp;<span class="op" id="4053912">=</span>&nbsp;<span class="ident" id="4053914">StructuralError</span><span class="op" id="4053929">{</span><span class="string" id="4053930">&#34;base&nbsp;128&nbsp;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4053958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4053963">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4053972">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4053976">ret</span>&nbsp;<span class="op" id="4053980">&lt;&lt;=</span>&nbsp;<span class="num" id="4053984">7</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4053988">b</span>&nbsp;<span class="op" id="4053990">:=</span>&nbsp;<span class="ident" id="4053993">bytes</span><span class="op" id="4053998">[</span><span class="ident" id="4053999">offset</span><span class="op" id="4054005">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4054009">ret</span>&nbsp;<span class="op" id="4054013">|=</span>&nbsp;<span class="builtintype" id="4054016">int</span><span class="op" id="4054019">(</span><span class="ident" id="4054020">b</span>&nbsp;<span class="op" id="4054022">&amp;</span>&nbsp;<span class="num" id="4054024">0x7f</span><span class="op" id="4054028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4054032">offset</span><span class="op" id="4054038">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4054043">if</span>&nbsp;<span class="ident" id="4054046">b</span><span class="op" id="4054047">&amp;</span><span class="num" id="4054048">0x80</span>&nbsp;<span class="op" id="4054053">==</span>&nbsp;<span class="num" id="4054056">0</span>&nbsp;<span class="op" id="4054058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4054063">return</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4054072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4054075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4054078">err</span>&nbsp;<span class="op" id="4054082">=</span>&nbsp;<span class="ident" id="4054084">SyntaxError</span><span class="op" id="4054095">{</span><span class="string" id="4054096">&#34;truncated&nbsp;base&nbsp;128&nbsp;integer&#34;</span><span class="op" id="4054124">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4054127">return</span><br>
<span class="lineno"></span><span class="op" id="4054134">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="4054137">//&nbsp;UTCTime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4054149">func</span>&nbsp;<span class="ident" id="4054154">parseUTCTime</span><span class="op" id="4054166">(</span><span class="ident" id="4054167">bytes</span>&nbsp;<span class="op" id="4054173">[</span><span class="op" id="4054174">]</span><span class="builtintype" id="4054175">byte</span><span class="op" id="4054179">)</span>&nbsp;<span class="op" id="4054181">(</span><span class="ident" id="4054182">ret</span>&nbsp;<span class="ident" id="4054186">time</span><span class="op" id="4054190">.</span><span class="ident" id="4054191">Time</span><span class="op" id="4054195">,</span>&nbsp;<span class="ident" id="4054197">err</span>&nbsp;<span class="builtintype" id="4054201">error</span><span class="op" id="4054206">)</span>&nbsp;<span class="op" id="4054208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4054211">s</span>&nbsp;<span class="op" id="4054213">:=</span>&nbsp;<span class="builtintype" id="4054216">string</span><span class="op" id="4054222">(</span><span class="ident" id="4054223">bytes</span><span class="op" id="4054228">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4054231">ret</span><span class="op" id="4054234">,</span>&nbsp;<span class="ident" id="4054236">err</span>&nbsp;<span class="op" id="4054240">=</span>&nbsp;<span class="ident" id="4054242">time</span><span class="op" id="4054246">.</span><span class="ident" id="4054247">Parse</span><span class="op" id="4054252">(</span><span class="string" id="4054253">&#34;0601021504Z0700&#34;</span><span class="op" id="4054270">,</span>&nbsp;<span class="ident" id="4054272">s</span><span class="op" id="4054273">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4054276">if</span>&nbsp;<span class="ident" id="4054279">err</span>&nbsp;<span class="op" id="4054283">!=</span>&nbsp;<span class="builtintype" id="4054286">nil</span>&nbsp;<span class="op" id="4054290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4054294">ret</span><span class="op" id="4054297">,</span>&nbsp;<span class="ident" id="4054299">err</span>&nbsp;<span class="op" id="4054303">=</span>&nbsp;<span class="ident" id="4054305">time</span><span class="op" id="4054309">.</span><span class="ident" id="4054310">Parse</span><span class="op" id="4054315">(</span><span class="string" id="4054316">&#34;060102150405Z0700&#34;</span><span class="op" id="4054335">,</span>&nbsp;<span class="ident" id="4054337">s</span><span class="op" id="4054338">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4054341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4054344">if</span>&nbsp;<span class="ident" id="4054347">err</span>&nbsp;<span class="op" id="4054351">==</span>&nbsp;<span class="builtintype" id="4054354">nil</span>&nbsp;<span class="op" id="4054358">&amp;&amp;</span>&nbsp;<span class="ident" id="4054361">ret</span><span class="op" id="4054364">.</span><span class="ident" id="4054365">Year</span><span class="op" id="4054369">(</span><span class="op" id="4054370">)</span>&nbsp;<span class="op" id="4054372">&gt;=</span>&nbsp;<span class="num" id="4054375">2050</span>&nbsp;<span class="op" id="4054380">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4054384">//&nbsp;UTCTime&nbsp;only&nbsp;encodes&nbsp;times&nbsp;prior&nbsp;to&nbsp;2050.&nbsp;See&nbsp;https://tools.ietf.org/html/rfc5280#section-4.1.2.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4054489">ret</span>&nbsp;<span class="op" id="4054493">=</span>&nbsp;<span class="ident" id="4054495">ret</span><span class="op" id="4054498">.</span><span class="ident" id="4054499">AddDate</span><span class="op" id="4054506">(</span><span class="op" id="4054507">-</span><span class="num" id="4054508">100</span><span class="op" id="4054511">,</span>&nbsp;<span class="num" id="4054513">0</span><span class="op" id="4054514">,</span>&nbsp;<span class="num" id="4054516">0</span><span class="op" id="4054517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4054520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4054524">return</span><br>
<span class="lineno">300</span><span class="op" id="4054531">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4054534">//&nbsp;parseGeneralizedTime&nbsp;parses&nbsp;the&nbsp;GeneralizedTime&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="4054611">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4054646">func</span>&nbsp;<span class="ident" id="4054651">parseGeneralizedTime</span><span class="op" id="4054671">(</span><span class="ident" id="4054672">bytes</span>&nbsp;<span class="op" id="4054678">[</span><span class="op" id="4054679">]</span><span class="builtintype" id="4054680">byte</span><span class="op" id="4054684">)</span>&nbsp;<span class="op" id="4054686">(</span><span class="ident" id="4054687">ret</span>&nbsp;<span class="ident" id="4054691">time</span><span class="op" id="4054695">.</span><span class="ident" id="4054696">Time</span><span class="op" id="4054700">,</span>&nbsp;<span class="ident" id="4054702">err</span>&nbsp;<span class="builtintype" id="4054706">error</span><span class="op" id="4054711">)</span>&nbsp;<span class="op" id="4054713">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4054716">return</span>&nbsp;<span class="ident" id="4054723">time</span><span class="op" id="4054727">.</span><span class="ident" id="4054728">Parse</span><span class="op" id="4054733">(</span><span class="string" id="4054734">&#34;20060102150405Z0700&#34;</span><span class="op" id="4054755">,</span>&nbsp;<span class="builtintype" id="4054757">string</span><span class="op" id="4054763">(</span><span class="ident" id="4054764">bytes</span><span class="op" id="4054769">)</span><span class="op" id="4054770">)</span><br>
<span class="lineno"></span><span class="op" id="4054772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4054775">//&nbsp;PrintableString</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4054795">//&nbsp;parsePrintableString&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;PrintableString&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4054870">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4054895">func</span>&nbsp;<span class="ident" id="4054900">parsePrintableString</span><span class="op" id="4054920">(</span><span class="ident" id="4054921">bytes</span>&nbsp;<span class="op" id="4054927">[</span><span class="op" id="4054928">]</span><span class="builtintype" id="4054929">byte</span><span class="op" id="4054933">)</span>&nbsp;<span class="op" id="4054935">(</span><span class="ident" id="4054936">ret</span>&nbsp;<span class="builtintype" id="4054940">string</span><span class="op" id="4054946">,</span>&nbsp;<span class="ident" id="4054948">err</span>&nbsp;<span class="builtintype" id="4054952">error</span><span class="op" id="4054957">)</span>&nbsp;<span class="op" id="4054959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4054962">for</span>&nbsp;<span class="ident" id="4054966">_</span><span class="op" id="4054967">,</span>&nbsp;<span class="ident" id="4054969">b</span>&nbsp;<span class="op" id="4054971">:=</span>&nbsp;<span class="keyword" id="4054974">range</span>&nbsp;<span class="ident" id="4054980">bytes</span>&nbsp;<span class="op" id="4054986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4054990">if</span>&nbsp;<span class="op" id="4054993">!</span><span class="ident" id="4054994">isPrintable</span><span class="op" id="4055005">(</span><span class="ident" id="4055006">b</span><span class="op" id="4055007">)</span>&nbsp;<span class="op" id="4055009">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055014">err</span>&nbsp;<span class="op" id="4055018">=</span>&nbsp;<span class="ident" id="4055020">SyntaxError</span><span class="op" id="4055031">{</span><span class="string" id="4055032">&#34;PrintableString&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4055076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4055081">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4055090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4055093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055096">ret</span>&nbsp;<span class="op" id="4055100">=</span>&nbsp;<span class="builtintype" id="4055102">string</span><span class="op" id="4055108">(</span><span class="ident" id="4055109">bytes</span><span class="op" id="4055114">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4055117">return</span><br>
<span class="lineno"></span><span class="op" id="4055124">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4055127">//&nbsp;isPrintable&nbsp;returns&nbsp;true&nbsp;iff&nbsp;the&nbsp;given&nbsp;b&nbsp;is&nbsp;in&nbsp;the&nbsp;ASN.1&nbsp;PrintableString&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="4055208">func</span>&nbsp;<span class="ident" id="4055213">isPrintable</span><span class="op" id="4055224">(</span><span class="ident" id="4055225">b</span>&nbsp;<span class="builtintype" id="4055227">byte</span><span class="op" id="4055231">)</span>&nbsp;<span class="builtintype" id="4055233">bool</span>&nbsp;<span class="op" id="4055238">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4055241">return</span>&nbsp;<span class="string" id="4055248">&#39;a&#39;</span>&nbsp;<span class="op" id="4055252">&lt;=</span>&nbsp;<span class="ident" id="4055255">b</span>&nbsp;<span class="op" id="4055257">&amp;&amp;</span>&nbsp;<span class="ident" id="4055260">b</span>&nbsp;<span class="op" id="4055262">&lt;=</span>&nbsp;<span class="string" id="4055265">&#39;z&#39;</span>&nbsp;<span class="op" id="4055269">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4055274">&#39;A&#39;</span>&nbsp;<span class="op" id="4055278">&lt;=</span>&nbsp;<span class="ident" id="4055281">b</span>&nbsp;<span class="op" id="4055283">&amp;&amp;</span>&nbsp;<span class="ident" id="4055286">b</span>&nbsp;<span class="op" id="4055288">&lt;=</span>&nbsp;<span class="string" id="4055291">&#39;Z&#39;</span>&nbsp;<span class="op" id="4055295">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4055300">&#39;0&#39;</span>&nbsp;<span class="op" id="4055304">&lt;=</span>&nbsp;<span class="ident" id="4055307">b</span>&nbsp;<span class="op" id="4055309">&amp;&amp;</span>&nbsp;<span class="ident" id="4055312">b</span>&nbsp;<span class="op" id="4055314">&lt;=</span>&nbsp;<span class="string" id="4055317">&#39;9&#39;</span>&nbsp;<span class="op" id="4055321">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4055326">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="4055331">&lt;=</span>&nbsp;<span class="ident" id="4055334">b</span>&nbsp;<span class="op" id="4055336">&amp;&amp;</span>&nbsp;<span class="ident" id="4055339">b</span>&nbsp;<span class="op" id="4055341">&lt;=</span>&nbsp;<span class="string" id="4055344">&#39;)&#39;</span>&nbsp;<span class="op" id="4055348">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4055353">&#39;+&#39;</span>&nbsp;<span class="op" id="4055357">&lt;=</span>&nbsp;<span class="ident" id="4055360">b</span>&nbsp;<span class="op" id="4055362">&amp;&amp;</span>&nbsp;<span class="ident" id="4055365">b</span>&nbsp;<span class="op" id="4055367">&lt;=</span>&nbsp;<span class="string" id="4055370">&#39;/&#39;</span>&nbsp;<span class="op" id="4055374">||</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055379">b</span>&nbsp;<span class="op" id="4055381">==</span>&nbsp;<span class="string" id="4055384">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4055388">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055393">b</span>&nbsp;<span class="op" id="4055395">==</span>&nbsp;<span class="string" id="4055398">&#39;:&#39;</span>&nbsp;<span class="op" id="4055402">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055407">b</span>&nbsp;<span class="op" id="4055409">==</span>&nbsp;<span class="string" id="4055412">&#39;=&#39;</span>&nbsp;<span class="op" id="4055416">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055421">b</span>&nbsp;<span class="op" id="4055423">==</span>&nbsp;<span class="string" id="4055426">&#39;?&#39;</span>&nbsp;<span class="op" id="4055430">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4055435">//&nbsp;This&nbsp;is&nbsp;technically&nbsp;not&nbsp;allowed&nbsp;in&nbsp;a&nbsp;PrintableString.</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4055494">//&nbsp;However,&nbsp;x509&nbsp;certificates&nbsp;with&nbsp;wildcard&nbsp;strings&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4055554">//&nbsp;always&nbsp;use&nbsp;the&nbsp;correct&nbsp;string&nbsp;type&nbsp;so&nbsp;we&nbsp;permit&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055611">b</span>&nbsp;<span class="op" id="4055613">==</span>&nbsp;<span class="string" id="4055616">&#39;*&#39;</span><br>
<span class="lineno"></span><span class="op" id="4055620">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="4055623">//&nbsp;IA5String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4055637">//&nbsp;parseIA5String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;IA5String&nbsp;(ASCII&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4055710">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4055740">func</span>&nbsp;<span class="ident" id="4055745">parseIA5String</span><span class="op" id="4055759">(</span><span class="ident" id="4055760">bytes</span>&nbsp;<span class="op" id="4055766">[</span><span class="op" id="4055767">]</span><span class="builtintype" id="4055768">byte</span><span class="op" id="4055772">)</span>&nbsp;<span class="op" id="4055774">(</span><span class="ident" id="4055775">ret</span>&nbsp;<span class="builtintype" id="4055779">string</span><span class="op" id="4055785">,</span>&nbsp;<span class="ident" id="4055787">err</span>&nbsp;<span class="builtintype" id="4055791">error</span><span class="op" id="4055796">)</span>&nbsp;<span class="op" id="4055798">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4055801">for</span>&nbsp;<span class="ident" id="4055805">_</span><span class="op" id="4055806">,</span>&nbsp;<span class="ident" id="4055808">b</span>&nbsp;<span class="op" id="4055810">:=</span>&nbsp;<span class="keyword" id="4055813">range</span>&nbsp;<span class="ident" id="4055819">bytes</span>&nbsp;<span class="op" id="4055825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4055829">if</span>&nbsp;<span class="ident" id="4055832">b</span>&nbsp;<span class="op" id="4055834">&gt;=</span>&nbsp;<span class="num" id="4055837">0x80</span>&nbsp;<span class="op" id="4055842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055847">err</span>&nbsp;<span class="op" id="4055851">=</span>&nbsp;<span class="ident" id="4055853">SyntaxError</span><span class="op" id="4055864">{</span><span class="string" id="4055865">&#34;IA5String&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4055903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4055908">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4055917">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4055920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4055923">ret</span>&nbsp;<span class="op" id="4055927">=</span>&nbsp;<span class="builtintype" id="4055929">string</span><span class="op" id="4055935">(</span><span class="ident" id="4055936">bytes</span><span class="op" id="4055941">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4055944">return</span><br>
<span class="lineno"></span><span class="op" id="4055951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="4055954">//&nbsp;T61String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4055968">//&nbsp;parseT61String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;T61String&nbsp;(8-bit&nbsp;clean&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4056047">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4056077">func</span>&nbsp;<span class="ident" id="4056082">parseT61String</span><span class="op" id="4056096">(</span><span class="ident" id="4056097">bytes</span>&nbsp;<span class="op" id="4056103">[</span><span class="op" id="4056104">]</span><span class="builtintype" id="4056105">byte</span><span class="op" id="4056109">)</span>&nbsp;<span class="op" id="4056111">(</span><span class="ident" id="4056112">ret</span>&nbsp;<span class="builtintype" id="4056116">string</span><span class="op" id="4056122">,</span>&nbsp;<span class="ident" id="4056124">err</span>&nbsp;<span class="builtintype" id="4056128">error</span><span class="op" id="4056133">)</span>&nbsp;<span class="op" id="4056135">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4056138">return</span>&nbsp;<span class="builtintype" id="4056145">string</span><span class="op" id="4056151">(</span><span class="ident" id="4056152">bytes</span><span class="op" id="4056157">)</span><span class="op" id="4056158">,</span>&nbsp;<span class="builtintype" id="4056160">nil</span><br>
<span class="lineno"></span><span class="op" id="4056164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4056167">//&nbsp;UTF8String</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="4056182">//&nbsp;parseUTF8String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;UTF8String&nbsp;(raw&nbsp;UTF-8)&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4056259">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4056284">func</span>&nbsp;<span class="ident" id="4056289">parseUTF8String</span><span class="op" id="4056304">(</span><span class="ident" id="4056305">bytes</span>&nbsp;<span class="op" id="4056311">[</span><span class="op" id="4056312">]</span><span class="builtintype" id="4056313">byte</span><span class="op" id="4056317">)</span>&nbsp;<span class="op" id="4056319">(</span><span class="ident" id="4056320">ret</span>&nbsp;<span class="builtintype" id="4056324">string</span><span class="op" id="4056330">,</span>&nbsp;<span class="ident" id="4056332">err</span>&nbsp;<span class="builtintype" id="4056336">error</span><span class="op" id="4056341">)</span>&nbsp;<span class="op" id="4056343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4056346">return</span>&nbsp;<span class="builtintype" id="4056353">string</span><span class="op" id="4056359">(</span><span class="ident" id="4056360">bytes</span><span class="op" id="4056365">)</span><span class="op" id="4056366">,</span>&nbsp;<span class="builtintype" id="4056368">nil</span><br>
<span class="lineno"></span><span class="op" id="4056372">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="4056375">//&nbsp;A&nbsp;RawValue&nbsp;represents&nbsp;an&nbsp;undecoded&nbsp;ASN.1&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="4056427">type</span>&nbsp;<span class="ident" id="4056432">RawValue</span>&nbsp;<span class="keyword" id="4056441">struct</span>&nbsp;<span class="op" id="4056448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4056451">Class</span><span class="op" id="4056456">,</span>&nbsp;<span class="ident" id="4056458">Tag</span>&nbsp;<span class="builtintype" id="4056462">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4056467">IsCompound</span>&nbsp;<span class="builtintype" id="4056478">bool</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4056484">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4056495">[</span><span class="op" id="4056496">]</span><span class="builtintype" id="4056497">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4056503">FullBytes</span>&nbsp;&nbsp;<span class="op" id="4056514">[</span><span class="op" id="4056515">]</span><span class="builtintype" id="4056516">byte</span>&nbsp;<span class="comment" id="4056521">//&nbsp;includes&nbsp;the&nbsp;tag&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span><span class="op" id="4056552">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4056555">//&nbsp;RawContent&nbsp;is&nbsp;used&nbsp;to&nbsp;signal&nbsp;that&nbsp;the&nbsp;undecoded,&nbsp;DER&nbsp;data&nbsp;needs&nbsp;to&nbsp;be</span><br>
<span class="lineno">380</span><span class="comment" id="4056628">//&nbsp;preserved&nbsp;for&nbsp;a&nbsp;struct.&nbsp;To&nbsp;use&nbsp;it,&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;the&nbsp;struct&nbsp;must&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="4056706">//&nbsp;this&nbsp;type.&nbsp;It&#39;s&nbsp;an&nbsp;error&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;fields&nbsp;to&nbsp;have&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4056781">type</span>&nbsp;<span class="ident" id="4056786">RawContent</span>&nbsp;<span class="op" id="4056797">[</span><span class="op" id="4056798">]</span><span class="builtintype" id="4056799">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4056805">//&nbsp;Tagging</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="comment" id="4056817">//&nbsp;parseTagAndLength&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;tag&nbsp;and&nbsp;length&nbsp;pair&nbsp;from&nbsp;the&nbsp;given&nbsp;offset</span><br>
<span class="lineno"></span><span class="comment" id="4056896">//&nbsp;into&nbsp;a&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;parsed&nbsp;data&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.&nbsp;SET&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4056973">//&nbsp;SET&nbsp;OF&nbsp;(tag&nbsp;17)&nbsp;are&nbsp;mapped&nbsp;to&nbsp;SEQUENCE&nbsp;and&nbsp;SEQUENCE&nbsp;OF&nbsp;(tag&nbsp;16)&nbsp;since&nbsp;we</span><br>
<span class="lineno"></span><span class="comment" id="4057049">//&nbsp;don&#39;t&nbsp;distinguish&nbsp;between&nbsp;ordered&nbsp;and&nbsp;unordered&nbsp;objects&nbsp;in&nbsp;this&nbsp;code.</span><br>
<span class="lineno">390</span><span class="keyword" id="4057122">func</span>&nbsp;<span class="ident" id="4057127">parseTagAndLength</span><span class="op" id="4057144">(</span><span class="ident" id="4057145">bytes</span>&nbsp;<span class="op" id="4057151">[</span><span class="op" id="4057152">]</span><span class="builtintype" id="4057153">byte</span><span class="op" id="4057157">,</span>&nbsp;<span class="ident" id="4057159">initOffset</span>&nbsp;<span class="builtintype" id="4057170">int</span><span class="op" id="4057173">)</span>&nbsp;<span class="op" id="4057175">(</span><span class="ident" id="4057176">ret</span>&nbsp;<span class="ident" id="4057180">tagAndLength</span><span class="op" id="4057192">,</span>&nbsp;<span class="ident" id="4057194">offset</span>&nbsp;<span class="builtintype" id="4057201">int</span><span class="op" id="4057204">,</span>&nbsp;<span class="ident" id="4057206">err</span>&nbsp;<span class="builtintype" id="4057210">error</span><span class="op" id="4057215">)</span>&nbsp;<span class="op" id="4057217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057220">offset</span>&nbsp;<span class="op" id="4057227">=</span>&nbsp;<span class="ident" id="4057229">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057241">b</span>&nbsp;<span class="op" id="4057243">:=</span>&nbsp;<span class="ident" id="4057246">bytes</span><span class="op" id="4057251">[</span><span class="ident" id="4057252">offset</span><span class="op" id="4057258">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057261">offset</span><span class="op" id="4057267">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057271">ret</span><span class="op" id="4057274">.</span><span class="ident" id="4057275">class</span>&nbsp;<span class="op" id="4057281">=</span>&nbsp;<span class="builtintype" id="4057283">int</span><span class="op" id="4057286">(</span><span class="ident" id="4057287">b</span>&nbsp;<span class="op" id="4057289">&gt;&gt;</span>&nbsp;<span class="num" id="4057292">6</span><span class="op" id="4057293">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057296">ret</span><span class="op" id="4057299">.</span><span class="ident" id="4057300">isCompound</span>&nbsp;<span class="op" id="4057311">=</span>&nbsp;<span class="ident" id="4057313">b</span><span class="op" id="4057314">&amp;</span><span class="num" id="4057315">0x20</span>&nbsp;<span class="op" id="4057320">==</span>&nbsp;<span class="num" id="4057323">0x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057329">ret</span><span class="op" id="4057332">.</span><span class="ident" id="4057333">tag</span>&nbsp;<span class="op" id="4057337">=</span>&nbsp;<span class="builtintype" id="4057339">int</span><span class="op" id="4057342">(</span><span class="ident" id="4057343">b</span>&nbsp;<span class="op" id="4057345">&amp;</span>&nbsp;<span class="num" id="4057347">0x1f</span><span class="op" id="4057351">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4057355">//&nbsp;If&nbsp;the&nbsp;bottom&nbsp;five&nbsp;bits&nbsp;are&nbsp;set,&nbsp;then&nbsp;the&nbsp;tag&nbsp;number&nbsp;is&nbsp;actually&nbsp;base&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4057433">//&nbsp;encoded&nbsp;afterwards</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4057456">if</span>&nbsp;<span class="ident" id="4057459">ret</span><span class="op" id="4057462">.</span><span class="ident" id="4057463">tag</span>&nbsp;<span class="op" id="4057467">==</span>&nbsp;<span class="num" id="4057470">0x1f</span>&nbsp;<span class="op" id="4057475">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057479">ret</span><span class="op" id="4057482">.</span><span class="ident" id="4057483">tag</span><span class="op" id="4057486">,</span>&nbsp;<span class="ident" id="4057488">offset</span><span class="op" id="4057494">,</span>&nbsp;<span class="ident" id="4057496">err</span>&nbsp;<span class="op" id="4057500">=</span>&nbsp;<span class="ident" id="4057502">parseBase128Int</span><span class="op" id="4057517">(</span><span class="ident" id="4057518">bytes</span><span class="op" id="4057523">,</span>&nbsp;<span class="ident" id="4057525">offset</span><span class="op" id="4057531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4057535">if</span>&nbsp;<span class="ident" id="4057538">err</span>&nbsp;<span class="op" id="4057542">!=</span>&nbsp;<span class="builtintype" id="4057545">nil</span>&nbsp;<span class="op" id="4057549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4057554">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4057563">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4057566">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4057569">if</span>&nbsp;<span class="ident" id="4057572">offset</span>&nbsp;<span class="op" id="4057579">&gt;=</span>&nbsp;<span class="builtinfunc" id="4057582">len</span><span class="op" id="4057585">(</span><span class="ident" id="4057586">bytes</span><span class="op" id="4057591">)</span>&nbsp;<span class="op" id="4057593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057597">err</span>&nbsp;<span class="op" id="4057601">=</span>&nbsp;<span class="ident" id="4057603">SyntaxError</span><span class="op" id="4057614">{</span><span class="string" id="4057615">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4057640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4057644">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4057652">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057655">b</span>&nbsp;<span class="op" id="4057657">=</span>&nbsp;<span class="ident" id="4057659">bytes</span><span class="op" id="4057664">[</span><span class="ident" id="4057665">offset</span><span class="op" id="4057671">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057674">offset</span><span class="op" id="4057680">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4057684">if</span>&nbsp;<span class="ident" id="4057687">b</span><span class="op" id="4057688">&amp;</span><span class="num" id="4057689">0x80</span>&nbsp;<span class="op" id="4057694">==</span>&nbsp;<span class="num" id="4057697">0</span>&nbsp;<span class="op" id="4057699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4057703">//&nbsp;The&nbsp;length&nbsp;is&nbsp;encoded&nbsp;in&nbsp;the&nbsp;bottom&nbsp;7&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057752">ret</span><span class="op" id="4057755">.</span><span class="ident" id="4057756">length</span>&nbsp;<span class="op" id="4057763">=</span>&nbsp;<span class="builtintype" id="4057765">int</span><span class="op" id="4057768">(</span><span class="ident" id="4057769">b</span>&nbsp;<span class="op" id="4057771">&amp;</span>&nbsp;<span class="num" id="4057773">0x7f</span><span class="op" id="4057777">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4057780">}</span>&nbsp;<span class="keyword" id="4057782">else</span>&nbsp;<span class="op" id="4057787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4057791">//&nbsp;Bottom&nbsp;7&nbsp;bits&nbsp;give&nbsp;the&nbsp;number&nbsp;of&nbsp;length&nbsp;bytes&nbsp;to&nbsp;follow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057853">numBytes</span>&nbsp;<span class="op" id="4057862">:=</span>&nbsp;<span class="builtintype" id="4057865">int</span><span class="op" id="4057868">(</span><span class="ident" id="4057869">b</span>&nbsp;<span class="op" id="4057871">&amp;</span>&nbsp;<span class="num" id="4057873">0x7f</span><span class="op" id="4057877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4057881">if</span>&nbsp;<span class="ident" id="4057884">numBytes</span>&nbsp;<span class="op" id="4057893">==</span>&nbsp;<span class="num" id="4057896">0</span>&nbsp;<span class="op" id="4057898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057903">err</span>&nbsp;<span class="op" id="4057907">=</span>&nbsp;<span class="ident" id="4057909">SyntaxError</span><span class="op" id="4057920">{</span><span class="string" id="4057921">&#34;indefinite&nbsp;length&nbsp;found&nbsp;(not&nbsp;DER)&#34;</span><span class="op" id="4057956">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4057961">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4057970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4057974">ret</span><span class="op" id="4057977">.</span><span class="ident" id="4057978">length</span>&nbsp;<span class="op" id="4057985">=</span>&nbsp;<span class="num" id="4057987">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4057991">for</span>&nbsp;<span class="ident" id="4057995">i</span>&nbsp;<span class="op" id="4057997">:=</span>&nbsp;<span class="num" id="4058000">0</span><span class="op" id="4058001">;</span>&nbsp;<span class="ident" id="4058003">i</span>&nbsp;<span class="op" id="4058005">&lt;</span>&nbsp;<span class="ident" id="4058007">numBytes</span><span class="op" id="4058015">;</span>&nbsp;<span class="ident" id="4058017">i</span><span class="op" id="4058018">++</span>&nbsp;<span class="op" id="4058021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4058026">if</span>&nbsp;<span class="ident" id="4058029">offset</span>&nbsp;<span class="op" id="4058036">&gt;=</span>&nbsp;<span class="builtinfunc" id="4058039">len</span><span class="op" id="4058042">(</span><span class="ident" id="4058043">bytes</span><span class="op" id="4058048">)</span>&nbsp;<span class="op" id="4058050">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058056">err</span>&nbsp;<span class="op" id="4058060">=</span>&nbsp;<span class="ident" id="4058062">SyntaxError</span><span class="op" id="4058073">{</span><span class="string" id="4058074">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4058099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4058105">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4058115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058120">b</span>&nbsp;<span class="op" id="4058122">=</span>&nbsp;<span class="ident" id="4058124">bytes</span><span class="op" id="4058129">[</span><span class="ident" id="4058130">offset</span><span class="op" id="4058136">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058141">offset</span><span class="op" id="4058147">++</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4058153">if</span>&nbsp;<span class="ident" id="4058156">ret</span><span class="op" id="4058159">.</span><span class="ident" id="4058160">length</span>&nbsp;<span class="op" id="4058167">&gt;=</span>&nbsp;<span class="num" id="4058170">1</span><span class="op" id="4058171">&lt;&lt;</span><span class="num" id="4058173">23</span>&nbsp;<span class="op" id="4058176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4058182">//&nbsp;We&nbsp;can&#39;t&nbsp;shift&nbsp;ret.length&nbsp;up&nbsp;without</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4058226">//&nbsp;overflowing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058246">err</span>&nbsp;<span class="op" id="4058250">=</span>&nbsp;<span class="ident" id="4058252">StructuralError</span><span class="op" id="4058267">{</span><span class="string" id="4058268">&#34;length&nbsp;too&nbsp;large&#34;</span><span class="op" id="4058286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4058292">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4058302">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058307">ret</span><span class="op" id="4058310">.</span><span class="ident" id="4058311">length</span>&nbsp;<span class="op" id="4058318">&lt;&lt;=</span>&nbsp;<span class="num" id="4058322">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058327">ret</span><span class="op" id="4058330">.</span><span class="ident" id="4058331">length</span>&nbsp;<span class="op" id="4058338">|=</span>&nbsp;<span class="builtintype" id="4058341">int</span><span class="op" id="4058344">(</span><span class="ident" id="4058345">b</span><span class="op" id="4058346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4058351">if</span>&nbsp;<span class="ident" id="4058354">ret</span><span class="op" id="4058357">.</span><span class="ident" id="4058358">length</span>&nbsp;<span class="op" id="4058365">==</span>&nbsp;<span class="num" id="4058368">0</span>&nbsp;<span class="op" id="4058370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4058376">//&nbsp;DER&nbsp;requires&nbsp;that&nbsp;lengths&nbsp;be&nbsp;minimal.</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058421">err</span>&nbsp;<span class="op" id="4058425">=</span>&nbsp;<span class="ident" id="4058427">StructuralError</span><span class="op" id="4058442">{</span><span class="string" id="4058443">&#34;superfluous&nbsp;leading&nbsp;zeros&nbsp;in&nbsp;length&#34;</span><span class="op" id="4058480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4058486">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4058496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4058500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4058503">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4058507">return</span><br>
<span class="lineno"></span><span class="op" id="4058514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4058517">//&nbsp;parseSequenceOf&nbsp;is&nbsp;used&nbsp;for&nbsp;SEQUENCE&nbsp;OF&nbsp;and&nbsp;SET&nbsp;OF&nbsp;values.&nbsp;It&nbsp;tries&nbsp;to&nbsp;parse</span><br>
<span class="lineno">450</span><span class="comment" id="4058597">//&nbsp;a&nbsp;number&nbsp;of&nbsp;ASN.1&nbsp;values&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;them&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4058673">//&nbsp;slice&nbsp;of&nbsp;Go&nbsp;values&nbsp;of&nbsp;the&nbsp;given&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4058714">func</span>&nbsp;<span class="ident" id="4058719">parseSequenceOf</span><span class="op" id="4058734">(</span><span class="ident" id="4058735">bytes</span>&nbsp;<span class="op" id="4058741">[</span><span class="op" id="4058742">]</span><span class="builtintype" id="4058743">byte</span><span class="op" id="4058747">,</span>&nbsp;<span class="ident" id="4058749">sliceType</span>&nbsp;<span class="ident" id="4058759">reflect</span><span class="op" id="4058766">.</span><span class="ident" id="4058767">Type</span><span class="op" id="4058771">,</span>&nbsp;<span class="ident" id="4058773">elemType</span>&nbsp;<span class="ident" id="4058782">reflect</span><span class="op" id="4058789">.</span><span class="ident" id="4058790">Type</span><span class="op" id="4058794">)</span>&nbsp;<span class="op" id="4058796">(</span><span class="ident" id="4058797">ret</span>&nbsp;<span class="ident" id="4058801">reflect</span><span class="op" id="4058808">.</span><span class="ident" id="4058809">Value</span><span class="op" id="4058814">,</span>&nbsp;<span class="ident" id="4058816">err</span>&nbsp;<span class="builtintype" id="4058820">error</span><span class="op" id="4058825">)</span>&nbsp;<span class="op" id="4058827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058830">expectedTag</span><span class="op" id="4058841">,</span>&nbsp;<span class="ident" id="4058843">compoundType</span><span class="op" id="4058855">,</span>&nbsp;<span class="ident" id="4058857">ok</span>&nbsp;<span class="op" id="4058860">:=</span>&nbsp;<span class="ident" id="4058863">getUniversalType</span><span class="op" id="4058879">(</span><span class="ident" id="4058880">elemType</span><span class="op" id="4058888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4058891">if</span>&nbsp;<span class="op" id="4058894">!</span><span class="ident" id="4058895">ok</span>&nbsp;<span class="op" id="4058898">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4058902">err</span>&nbsp;<span class="op" id="4058906">=</span>&nbsp;<span class="ident" id="4058908">StructuralError</span><span class="op" id="4058923">{</span><span class="string" id="4058924">&#34;unknown&nbsp;Go&nbsp;type&nbsp;for&nbsp;slice&#34;</span><span class="op" id="4058951">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4058955">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4058963">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4058967">//&nbsp;First&nbsp;we&nbsp;iterate&nbsp;over&nbsp;the&nbsp;input&nbsp;and&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;elements,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4059037">//&nbsp;checking&nbsp;that&nbsp;the&nbsp;types&nbsp;are&nbsp;correct&nbsp;in&nbsp;each&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059091">numElements</span>&nbsp;<span class="op" id="4059103">:=</span>&nbsp;<span class="num" id="4059106">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059109">for</span>&nbsp;<span class="ident" id="4059113">offset</span>&nbsp;<span class="op" id="4059120">:=</span>&nbsp;<span class="num" id="4059123">0</span><span class="op" id="4059124">;</span>&nbsp;<span class="ident" id="4059126">offset</span>&nbsp;<span class="op" id="4059133">&lt;</span>&nbsp;<span class="builtinfunc" id="4059135">len</span><span class="op" id="4059138">(</span><span class="ident" id="4059139">bytes</span><span class="op" id="4059144">)</span><span class="op" id="4059145">;</span>&nbsp;<span class="op" id="4059147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059151">var</span>&nbsp;<span class="ident" id="4059155">t</span>&nbsp;<span class="ident" id="4059157">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059172">t</span><span class="op" id="4059173">,</span>&nbsp;<span class="ident" id="4059175">offset</span><span class="op" id="4059181">,</span>&nbsp;<span class="ident" id="4059183">err</span>&nbsp;<span class="op" id="4059187">=</span>&nbsp;<span class="ident" id="4059189">parseTagAndLength</span><span class="op" id="4059206">(</span><span class="ident" id="4059207">bytes</span><span class="op" id="4059212">,</span>&nbsp;<span class="ident" id="4059214">offset</span><span class="op" id="4059220">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059224">if</span>&nbsp;<span class="ident" id="4059227">err</span>&nbsp;<span class="op" id="4059231">!=</span>&nbsp;<span class="builtintype" id="4059234">nil</span>&nbsp;<span class="op" id="4059238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059243">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4059252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059256">switch</span>&nbsp;<span class="ident" id="4059263">t</span><span class="op" id="4059264">.</span><span class="ident" id="4059265">tag</span>&nbsp;<span class="op" id="4059269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059273">case</span>&nbsp;<span class="ident" id="4059278">tagIA5String</span><span class="op" id="4059290">,</span>&nbsp;<span class="ident" id="4059292">tagGeneralString</span><span class="op" id="4059308">,</span>&nbsp;<span class="ident" id="4059310">tagT61String</span><span class="op" id="4059322">,</span>&nbsp;<span class="ident" id="4059324">tagUTF8String</span><span class="op" id="4059337">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4059342">//&nbsp;We&nbsp;pretend&nbsp;that&nbsp;various&nbsp;other&nbsp;string&nbsp;types&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4059395">//&nbsp;PRINTABLE&nbsp;STRINGs&nbsp;so&nbsp;that&nbsp;a&nbsp;sequence&nbsp;of&nbsp;them&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4059453">//&nbsp;parsed&nbsp;into&nbsp;a&nbsp;[]string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059483">t</span><span class="op" id="4059484">.</span><span class="ident" id="4059485">tag</span>&nbsp;<span class="op" id="4059489">=</span>&nbsp;<span class="ident" id="4059491">tagPrintableString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059512">case</span>&nbsp;<span class="ident" id="4059517">tagGeneralizedTime</span><span class="op" id="4059535">,</span>&nbsp;<span class="ident" id="4059537">tagUTCTime</span><span class="op" id="4059547">:</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4059552">//&nbsp;Likewise,&nbsp;both&nbsp;time&nbsp;types&nbsp;are&nbsp;treated&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059606">t</span><span class="op" id="4059607">.</span><span class="ident" id="4059608">tag</span>&nbsp;<span class="op" id="4059612">=</span>&nbsp;<span class="ident" id="4059614">tagUTCTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4059627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059632">if</span>&nbsp;<span class="ident" id="4059635">t</span><span class="op" id="4059636">.</span><span class="ident" id="4059637">class</span>&nbsp;<span class="op" id="4059643">!=</span>&nbsp;<span class="ident" id="4059646">classUniversal</span>&nbsp;<span class="op" id="4059661">||</span>&nbsp;<span class="ident" id="4059664">t</span><span class="op" id="4059665">.</span><span class="ident" id="4059666">isCompound</span>&nbsp;<span class="op" id="4059677">!=</span>&nbsp;<span class="ident" id="4059680">compoundType</span>&nbsp;<span class="op" id="4059693">||</span>&nbsp;<span class="ident" id="4059696">t</span><span class="op" id="4059697">.</span><span class="ident" id="4059698">tag</span>&nbsp;<span class="op" id="4059702">!=</span>&nbsp;<span class="ident" id="4059705">expectedTag</span>&nbsp;<span class="op" id="4059717">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059722">err</span>&nbsp;<span class="op" id="4059726">=</span>&nbsp;<span class="ident" id="4059728">StructuralError</span><span class="op" id="4059743">{</span><span class="string" id="4059744">&#34;sequence&nbsp;tag&nbsp;mismatch&#34;</span><span class="op" id="4059767">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059772">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4059781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059785">if</span>&nbsp;<span class="ident" id="4059788">invalidLength</span><span class="op" id="4059801">(</span><span class="ident" id="4059802">offset</span><span class="op" id="4059808">,</span>&nbsp;<span class="ident" id="4059810">t</span><span class="op" id="4059811">.</span><span class="ident" id="4059812">length</span><span class="op" id="4059818">,</span>&nbsp;<span class="builtinfunc" id="4059820">len</span><span class="op" id="4059823">(</span><span class="ident" id="4059824">bytes</span><span class="op" id="4059829">)</span><span class="op" id="4059830">)</span>&nbsp;<span class="op" id="4059832">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059837">err</span>&nbsp;<span class="op" id="4059841">=</span>&nbsp;<span class="ident" id="4059843">SyntaxError</span><span class="op" id="4059854">{</span><span class="string" id="4059855">&#34;truncated&nbsp;sequence&#34;</span><span class="op" id="4059875">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4059880">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4059889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059893">offset</span>&nbsp;<span class="op" id="4059900">+=</span>&nbsp;<span class="ident" id="4059903">t</span><span class="op" id="4059904">.</span><span class="ident" id="4059905">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059914">numElements</span><span class="op" id="4059925">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4059929">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059932">ret</span>&nbsp;<span class="op" id="4059936">=</span>&nbsp;<span class="ident" id="4059938">reflect</span><span class="op" id="4059945">.</span><span class="ident" id="4059946">MakeSlice</span><span class="op" id="4059955">(</span><span class="ident" id="4059956">sliceType</span><span class="op" id="4059965">,</span>&nbsp;<span class="ident" id="4059967">numElements</span><span class="op" id="4059978">,</span>&nbsp;<span class="ident" id="4059980">numElements</span><span class="op" id="4059991">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4059994">params</span>&nbsp;<span class="op" id="4060001">:=</span>&nbsp;<span class="ident" id="4060004">fieldParameters</span><span class="op" id="4060019">{</span><span class="op" id="4060020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060023">offset</span>&nbsp;<span class="op" id="4060030">:=</span>&nbsp;<span class="num" id="4060033">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4060036">for</span>&nbsp;<span class="ident" id="4060040">i</span>&nbsp;<span class="op" id="4060042">:=</span>&nbsp;<span class="num" id="4060045">0</span><span class="op" id="4060046">;</span>&nbsp;<span class="ident" id="4060048">i</span>&nbsp;<span class="op" id="4060050">&lt;</span>&nbsp;<span class="ident" id="4060052">numElements</span><span class="op" id="4060063">;</span>&nbsp;<span class="ident" id="4060065">i</span><span class="op" id="4060066">++</span>&nbsp;<span class="op" id="4060069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060073">offset</span><span class="op" id="4060079">,</span>&nbsp;<span class="ident" id="4060081">err</span>&nbsp;<span class="op" id="4060085">=</span>&nbsp;<span class="ident" id="4060087">parseField</span><span class="op" id="4060097">(</span><span class="ident" id="4060098">ret</span><span class="op" id="4060101">.</span><span class="ident" id="4060102">Index</span><span class="op" id="4060107">(</span><span class="ident" id="4060108">i</span><span class="op" id="4060109">)</span><span class="op" id="4060110">,</span>&nbsp;<span class="ident" id="4060112">bytes</span><span class="op" id="4060117">,</span>&nbsp;<span class="ident" id="4060119">offset</span><span class="op" id="4060125">,</span>&nbsp;<span class="ident" id="4060127">params</span><span class="op" id="4060133">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4060137">if</span>&nbsp;<span class="ident" id="4060140">err</span>&nbsp;<span class="op" id="4060144">!=</span>&nbsp;<span class="builtintype" id="4060147">nil</span>&nbsp;<span class="op" id="4060151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4060156">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4060165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4060168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4060171">return</span><br>
<span class="lineno">500</span><span class="op" id="4060178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4060181">var</span>&nbsp;<span class="op" id="4060185">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060188">bitStringType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4060209">=</span>&nbsp;<span class="ident" id="4060211">reflect</span><span class="op" id="4060218">.</span><span class="ident" id="4060219">TypeOf</span><span class="op" id="4060225">(</span><span class="ident" id="4060226">BitString</span><span class="op" id="4060235">{</span><span class="op" id="4060236">}</span><span class="op" id="4060237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060240">objectIdentifierType</span>&nbsp;<span class="op" id="4060261">=</span>&nbsp;<span class="ident" id="4060263">reflect</span><span class="op" id="4060270">.</span><span class="ident" id="4060271">TypeOf</span><span class="op" id="4060277">(</span><span class="ident" id="4060278">ObjectIdentifier</span><span class="op" id="4060294">{</span><span class="op" id="4060295">}</span><span class="op" id="4060296">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060299">enumeratedType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4060320">=</span>&nbsp;<span class="ident" id="4060322">reflect</span><span class="op" id="4060329">.</span><span class="ident" id="4060330">TypeOf</span><span class="op" id="4060336">(</span><span class="ident" id="4060337">Enumerated</span><span class="op" id="4060347">(</span><span class="num" id="4060348">0</span><span class="op" id="4060349">)</span><span class="op" id="4060350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060353">flagType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4060374">=</span>&nbsp;<span class="ident" id="4060376">reflect</span><span class="op" id="4060383">.</span><span class="ident" id="4060384">TypeOf</span><span class="op" id="4060390">(</span><span class="ident" id="4060391">Flag</span><span class="op" id="4060395">(</span><span class="builtintype" id="4060396">false</span><span class="op" id="4060401">)</span><span class="op" id="4060402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060405">timeType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4060426">=</span>&nbsp;<span class="ident" id="4060428">reflect</span><span class="op" id="4060435">.</span><span class="ident" id="4060436">TypeOf</span><span class="op" id="4060442">(</span><span class="ident" id="4060443">time</span><span class="op" id="4060447">.</span><span class="ident" id="4060448">Time</span><span class="op" id="4060452">{</span><span class="op" id="4060453">}</span><span class="op" id="4060454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060457">rawValueType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4060478">=</span>&nbsp;<span class="ident" id="4060480">reflect</span><span class="op" id="4060487">.</span><span class="ident" id="4060488">TypeOf</span><span class="op" id="4060494">(</span><span class="ident" id="4060495">RawValue</span><span class="op" id="4060503">{</span><span class="op" id="4060504">}</span><span class="op" id="4060505">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060508">rawContentsType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4060529">=</span>&nbsp;<span class="ident" id="4060531">reflect</span><span class="op" id="4060538">.</span><span class="ident" id="4060539">TypeOf</span><span class="op" id="4060545">(</span><span class="ident" id="4060546">RawContent</span><span class="op" id="4060556">(</span><span class="builtintype" id="4060557">nil</span><span class="op" id="4060560">)</span><span class="op" id="4060561">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4060564">bigIntType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4060585">=</span>&nbsp;<span class="ident" id="4060587">reflect</span><span class="op" id="4060594">.</span><span class="ident" id="4060595">TypeOf</span><span class="op" id="4060601">(</span><span class="builtinfunc" id="4060602">new</span><span class="op" id="4060605">(</span><span class="ident" id="4060606">big</span><span class="op" id="4060609">.</span><span class="ident" id="4060610">Int</span><span class="op" id="4060613">)</span><span class="op" id="4060614">)</span><br>
<span class="lineno"></span><span class="op" id="4060616">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4060619">//&nbsp;invalidLength&nbsp;returns&nbsp;true&nbsp;iff&nbsp;offset&nbsp;+&nbsp;length&nbsp;&gt;&nbsp;sliceLength,&nbsp;or&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4060694">//&nbsp;addition&nbsp;would&nbsp;overflow.</span><br>
<span class="lineno">515</span><span class="keyword" id="4060722">func</span>&nbsp;<span class="ident" id="4060727">invalidLength</span><span class="op" id="4060740">(</span><span class="ident" id="4060741">offset</span><span class="op" id="4060747">,</span>&nbsp;<span class="ident" id="4060749">length</span><span class="op" id="4060755">,</span>&nbsp;<span class="ident" id="4060757">sliceLength</span>&nbsp;<span class="builtintype" id="4060769">int</span><span class="op" id="4060772">)</span>&nbsp;<span class="builtintype" id="4060774">bool</span>&nbsp;<span class="op" id="4060779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4060782">return</span>&nbsp;<span class="ident" id="4060789">offset</span><span class="op" id="4060795">+</span><span class="ident" id="4060796">length</span>&nbsp;<span class="op" id="4060803">&lt;</span>&nbsp;<span class="ident" id="4060805">offset</span>&nbsp;<span class="op" id="4060812">||</span>&nbsp;<span class="ident" id="4060815">offset</span><span class="op" id="4060821">+</span><span class="ident" id="4060822">length</span>&nbsp;<span class="op" id="4060829">&gt;</span>&nbsp;<span class="ident" id="4060831">sliceLength</span><br>
<span class="lineno"></span><span class="op" id="4060843">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4060846">//&nbsp;parseField&nbsp;is&nbsp;the&nbsp;main&nbsp;parsing&nbsp;function.&nbsp;Given&nbsp;a&nbsp;byte&nbsp;slice&nbsp;and&nbsp;an&nbsp;offset</span><br>
<span class="lineno">520</span><span class="comment" id="4060923">//&nbsp;into&nbsp;the&nbsp;array,&nbsp;it&nbsp;will&nbsp;try&nbsp;to&nbsp;parse&nbsp;a&nbsp;suitable&nbsp;ASN.1&nbsp;value&nbsp;out&nbsp;and&nbsp;store&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4061003">//&nbsp;in&nbsp;the&nbsp;given&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4061026">func</span>&nbsp;<span class="ident" id="4061031">parseField</span><span class="op" id="4061041">(</span><span class="ident" id="4061042">v</span>&nbsp;<span class="ident" id="4061044">reflect</span><span class="op" id="4061051">.</span><span class="ident" id="4061052">Value</span><span class="op" id="4061057">,</span>&nbsp;<span class="ident" id="4061059">bytes</span>&nbsp;<span class="op" id="4061065">[</span><span class="op" id="4061066">]</span><span class="builtintype" id="4061067">byte</span><span class="op" id="4061071">,</span>&nbsp;<span class="ident" id="4061073">initOffset</span>&nbsp;<span class="builtintype" id="4061084">int</span><span class="op" id="4061087">,</span>&nbsp;<span class="ident" id="4061089">params</span>&nbsp;<span class="ident" id="4061096">fieldParameters</span><span class="op" id="4061111">)</span>&nbsp;<span class="op" id="4061113">(</span><span class="ident" id="4061114">offset</span>&nbsp;<span class="builtintype" id="4061121">int</span><span class="op" id="4061124">,</span>&nbsp;<span class="ident" id="4061126">err</span>&nbsp;<span class="builtintype" id="4061130">error</span><span class="op" id="4061135">)</span>&nbsp;<span class="op" id="4061137">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061140">offset</span>&nbsp;<span class="op" id="4061147">=</span>&nbsp;<span class="ident" id="4061149">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061161">fieldType</span>&nbsp;<span class="op" id="4061171">:=</span>&nbsp;<span class="ident" id="4061174">v</span><span class="op" id="4061175">.</span><span class="ident" id="4061176">Type</span><span class="op" id="4061180">(</span><span class="op" id="4061181">)</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4061185">//&nbsp;If&nbsp;we&nbsp;have&nbsp;run&nbsp;out&nbsp;of&nbsp;data,&nbsp;it&nbsp;may&nbsp;be&nbsp;that&nbsp;there&nbsp;are&nbsp;optional&nbsp;elements&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061272">if</span>&nbsp;<span class="ident" id="4061275">offset</span>&nbsp;<span class="op" id="4061282">==</span>&nbsp;<span class="builtinfunc" id="4061285">len</span><span class="op" id="4061288">(</span><span class="ident" id="4061289">bytes</span><span class="op" id="4061294">)</span>&nbsp;<span class="op" id="4061296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061300">if</span>&nbsp;<span class="op" id="4061303">!</span><span class="ident" id="4061304">setDefaultValue</span><span class="op" id="4061319">(</span><span class="ident" id="4061320">v</span><span class="op" id="4061321">,</span>&nbsp;<span class="ident" id="4061323">params</span><span class="op" id="4061329">)</span>&nbsp;<span class="op" id="4061331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061336">err</span>&nbsp;<span class="op" id="4061340">=</span>&nbsp;<span class="ident" id="4061342">SyntaxError</span><span class="op" id="4061353">{</span><span class="string" id="4061354">&#34;sequence&nbsp;truncated&#34;</span><span class="op" id="4061374">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4061378">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061382">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4061390">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4061394">//&nbsp;Deal&nbsp;with&nbsp;raw&nbsp;values.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061420">if</span>&nbsp;<span class="ident" id="4061423">fieldType</span>&nbsp;<span class="op" id="4061433">==</span>&nbsp;<span class="ident" id="4061436">rawValueType</span>&nbsp;<span class="op" id="4061449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061453">var</span>&nbsp;<span class="ident" id="4061457">t</span>&nbsp;<span class="ident" id="4061459">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061474">t</span><span class="op" id="4061475">,</span>&nbsp;<span class="ident" id="4061477">offset</span><span class="op" id="4061483">,</span>&nbsp;<span class="ident" id="4061485">err</span>&nbsp;<span class="op" id="4061489">=</span>&nbsp;<span class="ident" id="4061491">parseTagAndLength</span><span class="op" id="4061508">(</span><span class="ident" id="4061509">bytes</span><span class="op" id="4061514">,</span>&nbsp;<span class="ident" id="4061516">offset</span><span class="op" id="4061522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061526">if</span>&nbsp;<span class="ident" id="4061529">err</span>&nbsp;<span class="op" id="4061533">!=</span>&nbsp;<span class="builtintype" id="4061536">nil</span>&nbsp;<span class="op" id="4061540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061545">return</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4061554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061558">if</span>&nbsp;<span class="ident" id="4061561">invalidLength</span><span class="op" id="4061574">(</span><span class="ident" id="4061575">offset</span><span class="op" id="4061581">,</span>&nbsp;<span class="ident" id="4061583">t</span><span class="op" id="4061584">.</span><span class="ident" id="4061585">length</span><span class="op" id="4061591">,</span>&nbsp;<span class="builtinfunc" id="4061593">len</span><span class="op" id="4061596">(</span><span class="ident" id="4061597">bytes</span><span class="op" id="4061602">)</span><span class="op" id="4061603">)</span>&nbsp;<span class="op" id="4061605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061610">err</span>&nbsp;<span class="op" id="4061614">=</span>&nbsp;<span class="ident" id="4061616">SyntaxError</span><span class="op" id="4061627">{</span><span class="string" id="4061628">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4061644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061649">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4061658">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061662">result</span>&nbsp;<span class="op" id="4061669">:=</span>&nbsp;<span class="ident" id="4061672">RawValue</span><span class="op" id="4061680">{</span><span class="ident" id="4061681">t</span><span class="op" id="4061682">.</span><span class="ident" id="4061683">class</span><span class="op" id="4061688">,</span>&nbsp;<span class="ident" id="4061690">t</span><span class="op" id="4061691">.</span><span class="ident" id="4061692">tag</span><span class="op" id="4061695">,</span>&nbsp;<span class="ident" id="4061697">t</span><span class="op" id="4061698">.</span><span class="ident" id="4061699">isCompound</span><span class="op" id="4061709">,</span>&nbsp;<span class="ident" id="4061711">bytes</span><span class="op" id="4061716">[</span><span class="ident" id="4061717">offset</span>&nbsp;<span class="op" id="4061724">:</span>&nbsp;<span class="ident" id="4061726">offset</span><span class="op" id="4061732">+</span><span class="ident" id="4061733">t</span><span class="op" id="4061734">.</span><span class="ident" id="4061735">length</span><span class="op" id="4061741">]</span><span class="op" id="4061742">,</span>&nbsp;<span class="ident" id="4061744">bytes</span><span class="op" id="4061749">[</span><span class="ident" id="4061750">initOffset</span>&nbsp;<span class="op" id="4061761">:</span>&nbsp;<span class="ident" id="4061763">offset</span><span class="op" id="4061769">+</span><span class="ident" id="4061770">t</span><span class="op" id="4061771">.</span><span class="ident" id="4061772">length</span><span class="op" id="4061778">]</span><span class="op" id="4061779">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061783">offset</span>&nbsp;<span class="op" id="4061790">+=</span>&nbsp;<span class="ident" id="4061793">t</span><span class="op" id="4061794">.</span><span class="ident" id="4061795">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061804">v</span><span class="op" id="4061805">.</span><span class="ident" id="4061806">Set</span><span class="op" id="4061809">(</span><span class="ident" id="4061810">reflect</span><span class="op" id="4061817">.</span><span class="ident" id="4061818">ValueOf</span><span class="op" id="4061825">(</span><span class="ident" id="4061826">result</span><span class="op" id="4061832">)</span><span class="op" id="4061833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061837">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4061845">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4061849">//&nbsp;Deal&nbsp;with&nbsp;the&nbsp;ANY&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061877">if</span>&nbsp;<span class="ident" id="4061880">ifaceType</span>&nbsp;<span class="op" id="4061890">:=</span>&nbsp;<span class="ident" id="4061893">fieldType</span><span class="op" id="4061902">;</span>&nbsp;<span class="ident" id="4061904">ifaceType</span><span class="op" id="4061913">.</span><span class="ident" id="4061914">Kind</span><span class="op" id="4061918">(</span><span class="op" id="4061919">)</span>&nbsp;<span class="op" id="4061921">==</span>&nbsp;<span class="ident" id="4061924">reflect</span><span class="op" id="4061931">.</span><span class="ident" id="4061932">Interface</span>&nbsp;<span class="op" id="4061942">&amp;&amp;</span>&nbsp;<span class="ident" id="4061945">ifaceType</span><span class="op" id="4061954">.</span><span class="ident" id="4061955">NumMethod</span><span class="op" id="4061964">(</span><span class="op" id="4061965">)</span>&nbsp;<span class="op" id="4061967">==</span>&nbsp;<span class="num" id="4061970">0</span>&nbsp;<span class="op" id="4061972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4061976">var</span>&nbsp;<span class="ident" id="4061980">t</span>&nbsp;<span class="ident" id="4061982">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4061997">t</span><span class="op" id="4061998">,</span>&nbsp;<span class="ident" id="4062000">offset</span><span class="op" id="4062006">,</span>&nbsp;<span class="ident" id="4062008">err</span>&nbsp;<span class="op" id="4062012">=</span>&nbsp;<span class="ident" id="4062014">parseTagAndLength</span><span class="op" id="4062031">(</span><span class="ident" id="4062032">bytes</span><span class="op" id="4062037">,</span>&nbsp;<span class="ident" id="4062039">offset</span><span class="op" id="4062045">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062049">if</span>&nbsp;<span class="ident" id="4062052">err</span>&nbsp;<span class="op" id="4062056">!=</span>&nbsp;<span class="builtintype" id="4062059">nil</span>&nbsp;<span class="op" id="4062063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062068">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4062077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062081">if</span>&nbsp;<span class="ident" id="4062084">invalidLength</span><span class="op" id="4062097">(</span><span class="ident" id="4062098">offset</span><span class="op" id="4062104">,</span>&nbsp;<span class="ident" id="4062106">t</span><span class="op" id="4062107">.</span><span class="ident" id="4062108">length</span><span class="op" id="4062114">,</span>&nbsp;<span class="builtinfunc" id="4062116">len</span><span class="op" id="4062119">(</span><span class="ident" id="4062120">bytes</span><span class="op" id="4062125">)</span><span class="op" id="4062126">)</span>&nbsp;<span class="op" id="4062128">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4062133">err</span>&nbsp;<span class="op" id="4062137">=</span>&nbsp;<span class="ident" id="4062139">SyntaxError</span><span class="op" id="4062150">{</span><span class="string" id="4062151">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4062167">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062172">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4062181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062185">var</span>&nbsp;<span class="ident" id="4062189">result</span>&nbsp;<span class="keyword" id="4062196">interface</span><span class="op" id="4062205">{</span><span class="op" id="4062206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062210">if</span>&nbsp;<span class="op" id="4062213">!</span><span class="ident" id="4062214">t</span><span class="op" id="4062215">.</span><span class="ident" id="4062216">isCompound</span>&nbsp;<span class="op" id="4062227">&amp;&amp;</span>&nbsp;<span class="ident" id="4062230">t</span><span class="op" id="4062231">.</span><span class="ident" id="4062232">class</span>&nbsp;<span class="op" id="4062238">==</span>&nbsp;<span class="ident" id="4062241">classUniversal</span>&nbsp;<span class="op" id="4062256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4062261">innerBytes</span>&nbsp;<span class="op" id="4062272">:=</span>&nbsp;<span class="ident" id="4062275">bytes</span><span class="op" id="4062280">[</span><span class="ident" id="4062281">offset</span>&nbsp;<span class="op" id="4062288">:</span>&nbsp;<span class="ident" id="4062290">offset</span><span class="op" id="4062296">+</span><span class="ident" id="4062297">t</span><span class="op" id="4062298">.</span><span class="ident" id="4062299">length</span><span class="op" id="4062305">]</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062310">switch</span>&nbsp;<span class="ident" id="4062317">t</span><span class="op" id="4062318">.</span><span class="ident" id="4062319">tag</span>&nbsp;<span class="op" id="4062323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062328">case</span>&nbsp;<span class="ident" id="4062333">tagPrintableString</span><span class="op" id="4062351">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4062357">result</span><span class="op" id="4062363">,</span>&nbsp;<span class="ident" id="4062365">err</span>&nbsp;<span class="op" id="4062369">=</span>&nbsp;<span class="ident" id="4062371">parsePrintableString</span><span class="op" id="4062391">(</span><span class="ident" id="4062392">innerBytes</span><span class="op" id="4062402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062407">case</span>&nbsp;<span class="ident" id="4062412">tagIA5String</span><span class="op" id="4062424">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4062430">result</span><span class="op" id="4062436">,</span>&nbsp;<span class="ident" id="4062438">err</span>&nbsp;<span class="op" id="4062442">=</span>&nbsp;<span class="ident" id="4062444">parseIA5String</span><span class="op" id="4062458">(</span><span class="ident" id="4062459">innerBytes</span><span class="op" id="4062469">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062474">case</span>&nbsp;<span class="ident" id="4062479">tagT61String</span><span class="op" id="4062491">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4062497">result</span><span class="op" id="4062503">,</span>&nbsp;<span class="ident" id="4062505">err</span>&nbsp;<span class="op" id="4062509">=</span>&nbsp;<span class="ident" id="4062511">parseT61String</span><span class="op" id="4062525">(</span><span class="ident" id="4062526">innerBytes</span><span class="op" id="4062536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062541">case</span>&nbsp;<span class="ident" id="4062546">tagUTF8String</span><span class="op" id="4062559">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4062565">result</span><span class="op" id="4062571">,</span>&nbsp;<span class="ident" id="4062573">err</span>&nbsp;<span class="op" id="4062577">=</span>&nbsp;<span class="ident" id="4062579">parseUTF8String</span><span class="op" id="4062594">(</span><span class="ident" id="4062595">innerBytes</span><span class="op" id="4062605">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062610">case</span>&nbsp;<span class="ident" id="4062615">tagInteger</span><span class="op" id="4062625">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4062631">result</span><span class="op" id="4062637">,</span>&nbsp;<span class="ident" id="4062639">err</span>&nbsp;<span class="op" id="4062643">=</span>&nbsp;<span class="ident" id="4062645">parseInt64</span><span class="op" id="4062655">(</span><span class="ident" id="4062656">innerBytes</span><span class="op" id="4062666">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062671">case</span>&nbsp;<span class="ident" id="4062676">tagBitString</span><span class="op" id="4062688">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4062694">result</span><span class="op" id="4062700">,</span>&nbsp;<span class="ident" id="4062702">err</span>&nbsp;<span class="op" id="4062706">=</span>&nbsp;<span class="ident" id="4062708">parseBitString</span><span class="op" id="4062722">(</span><span class="ident" id="4062723">innerBytes</span><span class="op" id="4062733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062738">case</span>&nbsp;<span class="ident" id="4062743">tagOID</span><span class="op" id="4062749">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4062755">result</span><span class="op" id="4062761">,</span>&nbsp;<span class="ident" id="4062763">err</span>&nbsp;<span class="op" id="4062767">=</span>&nbsp;<span class="ident" id="4062769">parseObjectIdentifier</span><span class="op" id="4062790">(</span><span class="ident" id="4062791">innerBytes</span><span class="op" id="4062801">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062806">case</span>&nbsp;<span class="ident" id="4062811">tagUTCTime</span><span class="op" id="4062821">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4062827">result</span><span class="op" id="4062833">,</span>&nbsp;<span class="ident" id="4062835">err</span>&nbsp;<span class="op" id="4062839">=</span>&nbsp;<span class="ident" id="4062841">parseUTCTime</span><span class="op" id="4062853">(</span><span class="ident" id="4062854">innerBytes</span><span class="op" id="4062864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062869">case</span>&nbsp;<span class="ident" id="4062874">tagOctetString</span><span class="op" id="4062888">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4062894">result</span>&nbsp;<span class="op" id="4062901">=</span>&nbsp;<span class="ident" id="4062903">innerBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4062917">default</span><span class="op" id="4062924">:</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4062930">//&nbsp;If&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;to&nbsp;handle&nbsp;the&nbsp;type,&nbsp;we&nbsp;just&nbsp;leave&nbsp;Value&nbsp;as&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063013">offset</span>&nbsp;<span class="op" id="4063020">+=</span>&nbsp;<span class="ident" id="4063023">t</span><span class="op" id="4063024">.</span><span class="ident" id="4063025">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063034">if</span>&nbsp;<span class="ident" id="4063037">err</span>&nbsp;<span class="op" id="4063041">!=</span>&nbsp;<span class="builtintype" id="4063044">nil</span>&nbsp;<span class="op" id="4063048">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063053">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063066">if</span>&nbsp;<span class="ident" id="4063069">result</span>&nbsp;<span class="op" id="4063076">!=</span>&nbsp;<span class="builtintype" id="4063079">nil</span>&nbsp;<span class="op" id="4063083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063088">v</span><span class="op" id="4063089">.</span><span class="ident" id="4063090">Set</span><span class="op" id="4063093">(</span><span class="ident" id="4063094">reflect</span><span class="op" id="4063101">.</span><span class="ident" id="4063102">ValueOf</span><span class="op" id="4063109">(</span><span class="ident" id="4063110">result</span><span class="op" id="4063116">)</span><span class="op" id="4063117">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063121">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063125">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063136">universalTag</span><span class="op" id="4063148">,</span>&nbsp;<span class="ident" id="4063150">compoundType</span><span class="op" id="4063162">,</span>&nbsp;<span class="ident" id="4063164">ok1</span>&nbsp;<span class="op" id="4063168">:=</span>&nbsp;<span class="ident" id="4063171">getUniversalType</span><span class="op" id="4063187">(</span><span class="ident" id="4063188">fieldType</span><span class="op" id="4063197">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063200">if</span>&nbsp;<span class="op" id="4063203">!</span><span class="ident" id="4063204">ok1</span>&nbsp;<span class="op" id="4063208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063212">err</span>&nbsp;<span class="op" id="4063216">=</span>&nbsp;<span class="ident" id="4063218">StructuralError</span><span class="op" id="4063233">{</span><span class="ident" id="4063234">fmt</span><span class="op" id="4063237">.</span><span class="ident" id="4063238">Sprintf</span><span class="op" id="4063245">(</span><span class="string" id="4063246">&#34;unknown&nbsp;Go&nbsp;type:&nbsp;%v&#34;</span><span class="op" id="4063267">,</span>&nbsp;<span class="ident" id="4063269">fieldType</span><span class="op" id="4063278">)</span><span class="op" id="4063279">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063283">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063295">t</span><span class="op" id="4063296">,</span>&nbsp;<span class="ident" id="4063298">offset</span><span class="op" id="4063304">,</span>&nbsp;<span class="ident" id="4063306">err</span>&nbsp;<span class="op" id="4063310">:=</span>&nbsp;<span class="ident" id="4063313">parseTagAndLength</span><span class="op" id="4063330">(</span><span class="ident" id="4063331">bytes</span><span class="op" id="4063336">,</span>&nbsp;<span class="ident" id="4063338">offset</span><span class="op" id="4063344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063347">if</span>&nbsp;<span class="ident" id="4063350">err</span>&nbsp;<span class="op" id="4063354">!=</span>&nbsp;<span class="builtintype" id="4063357">nil</span>&nbsp;<span class="op" id="4063361">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063365">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063376">if</span>&nbsp;<span class="ident" id="4063379">params</span><span class="op" id="4063385">.</span><span class="ident" id="4063386">explicit</span>&nbsp;<span class="op" id="4063395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063399">expectedClass</span>&nbsp;<span class="op" id="4063413">:=</span>&nbsp;<span class="ident" id="4063416">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063439">if</span>&nbsp;<span class="ident" id="4063442">params</span><span class="op" id="4063448">.</span><span class="ident" id="4063449">application</span>&nbsp;<span class="op" id="4063461">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063466">expectedClass</span>&nbsp;<span class="op" id="4063480">=</span>&nbsp;<span class="ident" id="4063482">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063505">if</span>&nbsp;<span class="ident" id="4063508">t</span><span class="op" id="4063509">.</span><span class="ident" id="4063510">class</span>&nbsp;<span class="op" id="4063516">==</span>&nbsp;<span class="ident" id="4063519">expectedClass</span>&nbsp;<span class="op" id="4063533">&amp;&amp;</span>&nbsp;<span class="ident" id="4063536">t</span><span class="op" id="4063537">.</span><span class="ident" id="4063538">tag</span>&nbsp;<span class="op" id="4063542">==</span>&nbsp;<span class="op" id="4063545">*</span><span class="ident" id="4063546">params</span><span class="op" id="4063552">.</span><span class="ident" id="4063553">tag</span>&nbsp;<span class="op" id="4063557">&amp;&amp;</span>&nbsp;<span class="op" id="4063560">(</span><span class="ident" id="4063561">t</span><span class="op" id="4063562">.</span><span class="ident" id="4063563">length</span>&nbsp;<span class="op" id="4063570">==</span>&nbsp;<span class="num" id="4063573">0</span>&nbsp;<span class="op" id="4063575">||</span>&nbsp;<span class="ident" id="4063578">t</span><span class="op" id="4063579">.</span><span class="ident" id="4063580">isCompound</span><span class="op" id="4063590">)</span>&nbsp;<span class="op" id="4063592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063597">if</span>&nbsp;<span class="ident" id="4063600">t</span><span class="op" id="4063601">.</span><span class="ident" id="4063602">length</span>&nbsp;<span class="op" id="4063609">&gt;</span>&nbsp;<span class="num" id="4063611">0</span>&nbsp;<span class="op" id="4063613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063619">t</span><span class="op" id="4063620">,</span>&nbsp;<span class="ident" id="4063622">offset</span><span class="op" id="4063628">,</span>&nbsp;<span class="ident" id="4063630">err</span>&nbsp;<span class="op" id="4063634">=</span>&nbsp;<span class="ident" id="4063636">parseTagAndLength</span><span class="op" id="4063653">(</span><span class="ident" id="4063654">bytes</span><span class="op" id="4063659">,</span>&nbsp;<span class="ident" id="4063661">offset</span><span class="op" id="4063667">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063673">if</span>&nbsp;<span class="ident" id="4063676">err</span>&nbsp;<span class="op" id="4063680">!=</span>&nbsp;<span class="builtintype" id="4063683">nil</span>&nbsp;<span class="op" id="4063687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063694">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063705">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063710">}</span>&nbsp;<span class="keyword" id="4063712">else</span>&nbsp;<span class="op" id="4063717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063723">if</span>&nbsp;<span class="ident" id="4063726">fieldType</span>&nbsp;<span class="op" id="4063736">!=</span>&nbsp;<span class="ident" id="4063739">flagType</span>&nbsp;<span class="op" id="4063748">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063755">err</span>&nbsp;<span class="op" id="4063759">=</span>&nbsp;<span class="ident" id="4063761">StructuralError</span><span class="op" id="4063776">{</span><span class="string" id="4063777">&#34;zero&nbsp;length&nbsp;explicit&nbsp;tag&nbsp;was&nbsp;not&nbsp;an&nbsp;asn1.Flag&#34;</span><span class="op" id="4063824">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063831">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063848">v</span><span class="op" id="4063849">.</span><span class="ident" id="4063850">SetBool</span><span class="op" id="4063857">(</span><span class="builtintype" id="4063858">true</span><span class="op" id="4063862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063868">return</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063878">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4063882">}</span>&nbsp;<span class="keyword" id="4063884">else</span>&nbsp;<span class="op" id="4063889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4063894">//&nbsp;The&nbsp;tags&nbsp;didn&#39;t&nbsp;match,&nbsp;it&nbsp;might&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4063956">ok</span>&nbsp;<span class="op" id="4063959">:=</span>&nbsp;<span class="ident" id="4063962">setDefaultValue</span><span class="op" id="4063977">(</span><span class="ident" id="4063978">v</span><span class="op" id="4063979">,</span>&nbsp;<span class="ident" id="4063981">params</span><span class="op" id="4063987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4063992">if</span>&nbsp;<span class="ident" id="4063995">ok</span>&nbsp;<span class="op" id="4063998">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4064004">offset</span>&nbsp;<span class="op" id="4064011">=</span>&nbsp;<span class="ident" id="4064013">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4064027">}</span>&nbsp;<span class="keyword" id="4064029">else</span>&nbsp;<span class="op" id="4064034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4064040">err</span>&nbsp;<span class="op" id="4064044">=</span>&nbsp;<span class="ident" id="4064046">StructuralError</span><span class="op" id="4064061">{</span><span class="string" id="4064062">&#34;explicitly&nbsp;tagged&nbsp;member&nbsp;didn&#39;t&nbsp;match&#34;</span><span class="op" id="4064101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4064106">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4064111">return</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4064120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4064123">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4064127">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;strings:&nbsp;all&nbsp;the&nbsp;ASN.1&nbsp;string&nbsp;types&nbsp;map&nbsp;to&nbsp;the&nbsp;Go</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4064198">//&nbsp;type&nbsp;string.&nbsp;getUniversalType&nbsp;returns&nbsp;the&nbsp;tag&nbsp;for&nbsp;PrintableString</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4064268">//&nbsp;when&nbsp;it&nbsp;sees&nbsp;a&nbsp;string,&nbsp;so&nbsp;if&nbsp;we&nbsp;see&nbsp;a&nbsp;different&nbsp;string&nbsp;type&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4064339">//&nbsp;wire,&nbsp;we&nbsp;change&nbsp;the&nbsp;universal&nbsp;type&nbsp;to&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4064388">if</span>&nbsp;<span class="ident" id="4064391">universalTag</span>&nbsp;<span class="op" id="4064404">==</span>&nbsp;<span class="ident" id="4064407">tagPrintableString</span>&nbsp;<span class="op" id="4064426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4064430">if</span>&nbsp;<span class="ident" id="4064433">t</span><span class="op" id="4064434">.</span><span class="ident" id="4064435">class</span>&nbsp;<span class="op" id="4064441">==</span>&nbsp;<span class="ident" id="4064444">classUniversal</span>&nbsp;<span class="op" id="4064459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4064464">switch</span>&nbsp;<span class="ident" id="4064471">t</span><span class="op" id="4064472">.</span><span class="ident" id="4064473">tag</span>&nbsp;<span class="op" id="4064477">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4064482">case</span>&nbsp;<span class="ident" id="4064487">tagIA5String</span><span class="op" id="4064499">,</span>&nbsp;<span class="ident" id="4064501">tagGeneralString</span><span class="op" id="4064517">,</span>&nbsp;<span class="ident" id="4064519">tagT61String</span><span class="op" id="4064531">,</span>&nbsp;<span class="ident" id="4064533">tagUTF8String</span><span class="op" id="4064546">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4064552">universalTag</span>&nbsp;<span class="op" id="4064565">=</span>&nbsp;<span class="ident" id="4064567">t</span><span class="op" id="4064568">.</span><span class="ident" id="4064569">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4064576">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4064580">}</span>&nbsp;<span class="keyword" id="4064582">else</span>&nbsp;<span class="keyword" id="4064587">if</span>&nbsp;<span class="ident" id="4064590">params</span><span class="op" id="4064596">.</span><span class="ident" id="4064597">stringType</span>&nbsp;<span class="op" id="4064608">!=</span>&nbsp;<span class="num" id="4064611">0</span>&nbsp;<span class="op" id="4064613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4064618">universalTag</span>&nbsp;<span class="op" id="4064631">=</span>&nbsp;<span class="ident" id="4064633">params</span><span class="op" id="4064639">.</span><span class="ident" id="4064640">stringType</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4064653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4064656">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4064660">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;time:&nbsp;UTCTime&nbsp;and&nbsp;GeneralizedTime&nbsp;both&nbsp;map&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4064731">//&nbsp;Go&nbsp;type&nbsp;time.Time.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4064754">if</span>&nbsp;<span class="ident" id="4064757">universalTag</span>&nbsp;<span class="op" id="4064770">==</span>&nbsp;<span class="ident" id="4064773">tagUTCTime</span>&nbsp;<span class="op" id="4064784">&amp;&amp;</span>&nbsp;<span class="ident" id="4064787">t</span><span class="op" id="4064788">.</span><span class="ident" id="4064789">tag</span>&nbsp;<span class="op" id="4064793">==</span>&nbsp;<span class="ident" id="4064796">tagGeneralizedTime</span>&nbsp;<span class="op" id="4064815">&amp;&amp;</span>&nbsp;<span class="ident" id="4064818">t</span><span class="op" id="4064819">.</span><span class="ident" id="4064820">class</span>&nbsp;<span class="op" id="4064826">==</span>&nbsp;<span class="ident" id="4064829">classUniversal</span>&nbsp;<span class="op" id="4064844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4064848">universalTag</span>&nbsp;<span class="op" id="4064861">=</span>&nbsp;<span class="ident" id="4064863">tagGeneralizedTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4064883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4064887">if</span>&nbsp;<span class="ident" id="4064890">params</span><span class="op" id="4064896">.</span><span class="ident" id="4064897">set</span>&nbsp;<span class="op" id="4064901">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4064905">universalTag</span>&nbsp;<span class="op" id="4064918">=</span>&nbsp;<span class="ident" id="4064920">tagSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4064928">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4064932">expectedClass</span>&nbsp;<span class="op" id="4064946">:=</span>&nbsp;<span class="ident" id="4064949">classUniversal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4064965">expectedTag</span>&nbsp;<span class="op" id="4064977">:=</span>&nbsp;<span class="ident" id="4064980">universalTag</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4064995">if</span>&nbsp;<span class="op" id="4064998">!</span><span class="ident" id="4064999">params</span><span class="op" id="4065005">.</span><span class="ident" id="4065006">explicit</span>&nbsp;<span class="op" id="4065015">&amp;&amp;</span>&nbsp;<span class="ident" id="4065018">params</span><span class="op" id="4065024">.</span><span class="ident" id="4065025">tag</span>&nbsp;<span class="op" id="4065029">!=</span>&nbsp;<span class="builtintype" id="4065032">nil</span>&nbsp;<span class="op" id="4065036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065040">expectedClass</span>&nbsp;<span class="op" id="4065054">=</span>&nbsp;<span class="ident" id="4065056">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065079">expectedTag</span>&nbsp;<span class="op" id="4065091">=</span>&nbsp;<span class="op" id="4065093">*</span><span class="ident" id="4065094">params</span><span class="op" id="4065100">.</span><span class="ident" id="4065101">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4065106">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065110">if</span>&nbsp;<span class="op" id="4065113">!</span><span class="ident" id="4065114">params</span><span class="op" id="4065120">.</span><span class="ident" id="4065121">explicit</span>&nbsp;<span class="op" id="4065130">&amp;&amp;</span>&nbsp;<span class="ident" id="4065133">params</span><span class="op" id="4065139">.</span><span class="ident" id="4065140">application</span>&nbsp;<span class="op" id="4065152">&amp;&amp;</span>&nbsp;<span class="ident" id="4065155">params</span><span class="op" id="4065161">.</span><span class="ident" id="4065162">tag</span>&nbsp;<span class="op" id="4065166">!=</span>&nbsp;<span class="builtintype" id="4065169">nil</span>&nbsp;<span class="op" id="4065173">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065177">expectedClass</span>&nbsp;<span class="op" id="4065191">=</span>&nbsp;<span class="ident" id="4065193">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065212">expectedTag</span>&nbsp;<span class="op" id="4065224">=</span>&nbsp;<span class="op" id="4065226">*</span><span class="ident" id="4065227">params</span><span class="op" id="4065233">.</span><span class="ident" id="4065234">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4065239">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4065243">//&nbsp;We&nbsp;have&nbsp;unwrapped&nbsp;any&nbsp;explicit&nbsp;tagging&nbsp;at&nbsp;this&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065301">if</span>&nbsp;<span class="ident" id="4065304">t</span><span class="op" id="4065305">.</span><span class="ident" id="4065306">class</span>&nbsp;<span class="op" id="4065312">!=</span>&nbsp;<span class="ident" id="4065315">expectedClass</span>&nbsp;<span class="op" id="4065329">||</span>&nbsp;<span class="ident" id="4065332">t</span><span class="op" id="4065333">.</span><span class="ident" id="4065334">tag</span>&nbsp;<span class="op" id="4065338">!=</span>&nbsp;<span class="ident" id="4065341">expectedTag</span>&nbsp;<span class="op" id="4065353">||</span>&nbsp;<span class="ident" id="4065356">t</span><span class="op" id="4065357">.</span><span class="ident" id="4065358">isCompound</span>&nbsp;<span class="op" id="4065369">!=</span>&nbsp;<span class="ident" id="4065372">compoundType</span>&nbsp;<span class="op" id="4065385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4065389">//&nbsp;Tags&nbsp;don&#39;t&nbsp;match.&nbsp;Again,&nbsp;it&nbsp;could&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065452">ok</span>&nbsp;<span class="op" id="4065455">:=</span>&nbsp;<span class="ident" id="4065458">setDefaultValue</span><span class="op" id="4065473">(</span><span class="ident" id="4065474">v</span><span class="op" id="4065475">,</span>&nbsp;<span class="ident" id="4065477">params</span><span class="op" id="4065483">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065487">if</span>&nbsp;<span class="ident" id="4065490">ok</span>&nbsp;<span class="op" id="4065493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065498">offset</span>&nbsp;<span class="op" id="4065505">=</span>&nbsp;<span class="ident" id="4065507">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4065520">}</span>&nbsp;<span class="keyword" id="4065522">else</span>&nbsp;<span class="op" id="4065527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065532">err</span>&nbsp;<span class="op" id="4065536">=</span>&nbsp;<span class="ident" id="4065538">StructuralError</span><span class="op" id="4065553">{</span><span class="ident" id="4065554">fmt</span><span class="op" id="4065557">.</span><span class="ident" id="4065558">Sprintf</span><span class="op" id="4065565">(</span><span class="string" id="4065566">&#34;tags&nbsp;don&#39;t&nbsp;match&nbsp;(%d&nbsp;vs&nbsp;%+v)&nbsp;%+v&nbsp;%s&nbsp;@%d&#34;</span><span class="op" id="4065607">,</span>&nbsp;<span class="ident" id="4065609">expectedTag</span><span class="op" id="4065620">,</span>&nbsp;<span class="ident" id="4065622">t</span><span class="op" id="4065623">,</span>&nbsp;<span class="ident" id="4065625">params</span><span class="op" id="4065631">,</span>&nbsp;<span class="ident" id="4065633">fieldType</span><span class="op" id="4065642">.</span><span class="ident" id="4065643">Name</span><span class="op" id="4065647">(</span><span class="op" id="4065648">)</span><span class="op" id="4065649">,</span>&nbsp;<span class="ident" id="4065651">offset</span><span class="op" id="4065657">)</span><span class="op" id="4065658">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4065662">}</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065666">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4065674">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065677">if</span>&nbsp;<span class="ident" id="4065680">invalidLength</span><span class="op" id="4065693">(</span><span class="ident" id="4065694">offset</span><span class="op" id="4065700">,</span>&nbsp;<span class="ident" id="4065702">t</span><span class="op" id="4065703">.</span><span class="ident" id="4065704">length</span><span class="op" id="4065710">,</span>&nbsp;<span class="builtinfunc" id="4065712">len</span><span class="op" id="4065715">(</span><span class="ident" id="4065716">bytes</span><span class="op" id="4065721">)</span><span class="op" id="4065722">)</span>&nbsp;<span class="op" id="4065724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065728">err</span>&nbsp;<span class="op" id="4065732">=</span>&nbsp;<span class="ident" id="4065734">SyntaxError</span><span class="op" id="4065745">{</span><span class="string" id="4065746">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4065762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065766">return</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4065774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065777">innerBytes</span>&nbsp;<span class="op" id="4065788">:=</span>&nbsp;<span class="ident" id="4065791">bytes</span><span class="op" id="4065796">[</span><span class="ident" id="4065797">offset</span>&nbsp;<span class="op" id="4065804">:</span>&nbsp;<span class="ident" id="4065806">offset</span><span class="op" id="4065812">+</span><span class="ident" id="4065813">t</span><span class="op" id="4065814">.</span><span class="ident" id="4065815">length</span><span class="op" id="4065821">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065824">offset</span>&nbsp;<span class="op" id="4065831">+=</span>&nbsp;<span class="ident" id="4065834">t</span><span class="op" id="4065835">.</span><span class="ident" id="4065836">length</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4065845">//&nbsp;We&nbsp;deal&nbsp;with&nbsp;the&nbsp;structures&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;first.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065908">switch</span>&nbsp;<span class="ident" id="4065915">fieldType</span>&nbsp;<span class="op" id="4065925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4065928">case</span>&nbsp;<span class="ident" id="4065933">objectIdentifierType</span><span class="op" id="4065953">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4065957">newSlice</span><span class="op" id="4065965">,</span>&nbsp;<span class="ident" id="4065967">err1</span>&nbsp;<span class="op" id="4065972">:=</span>&nbsp;<span class="ident" id="4065975">parseObjectIdentifier</span><span class="op" id="4065996">(</span><span class="ident" id="4065997">innerBytes</span><span class="op" id="4066007">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066011">v</span><span class="op" id="4066012">.</span><span class="ident" id="4066013">Set</span><span class="op" id="4066016">(</span><span class="ident" id="4066017">reflect</span><span class="op" id="4066024">.</span><span class="ident" id="4066025">MakeSlice</span><span class="op" id="4066034">(</span><span class="ident" id="4066035">v</span><span class="op" id="4066036">.</span><span class="ident" id="4066037">Type</span><span class="op" id="4066041">(</span><span class="op" id="4066042">)</span><span class="op" id="4066043">,</span>&nbsp;<span class="builtinfunc" id="4066045">len</span><span class="op" id="4066048">(</span><span class="ident" id="4066049">newSlice</span><span class="op" id="4066057">)</span><span class="op" id="4066058">,</span>&nbsp;<span class="builtinfunc" id="4066060">len</span><span class="op" id="4066063">(</span><span class="ident" id="4066064">newSlice</span><span class="op" id="4066072">)</span><span class="op" id="4066073">)</span><span class="op" id="4066074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066078">if</span>&nbsp;<span class="ident" id="4066081">err1</span>&nbsp;<span class="op" id="4066086">==</span>&nbsp;<span class="builtintype" id="4066089">nil</span>&nbsp;<span class="op" id="4066093">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066098">reflect</span><span class="op" id="4066105">.</span><span class="ident" id="4066106">Copy</span><span class="op" id="4066110">(</span><span class="ident" id="4066111">v</span><span class="op" id="4066112">,</span>&nbsp;<span class="ident" id="4066114">reflect</span><span class="op" id="4066121">.</span><span class="ident" id="4066122">ValueOf</span><span class="op" id="4066129">(</span><span class="ident" id="4066130">newSlice</span><span class="op" id="4066138">)</span><span class="op" id="4066139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4066143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066147">err</span>&nbsp;<span class="op" id="4066151">=</span>&nbsp;<span class="ident" id="4066153">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066160">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066168">case</span>&nbsp;<span class="ident" id="4066173">bitStringType</span><span class="op" id="4066186">:</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066190">bs</span><span class="op" id="4066192">,</span>&nbsp;<span class="ident" id="4066194">err1</span>&nbsp;<span class="op" id="4066199">:=</span>&nbsp;<span class="ident" id="4066202">parseBitString</span><span class="op" id="4066216">(</span><span class="ident" id="4066217">innerBytes</span><span class="op" id="4066227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066231">if</span>&nbsp;<span class="ident" id="4066234">err1</span>&nbsp;<span class="op" id="4066239">==</span>&nbsp;<span class="builtintype" id="4066242">nil</span>&nbsp;<span class="op" id="4066246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066251">v</span><span class="op" id="4066252">.</span><span class="ident" id="4066253">Set</span><span class="op" id="4066256">(</span><span class="ident" id="4066257">reflect</span><span class="op" id="4066264">.</span><span class="ident" id="4066265">ValueOf</span><span class="op" id="4066272">(</span><span class="ident" id="4066273">bs</span><span class="op" id="4066275">)</span><span class="op" id="4066276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4066280">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066284">err</span>&nbsp;<span class="op" id="4066288">=</span>&nbsp;<span class="ident" id="4066290">err1</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066297">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066305">case</span>&nbsp;<span class="ident" id="4066310">timeType</span><span class="op" id="4066318">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066322">var</span>&nbsp;<span class="ident" id="4066326">time</span>&nbsp;<span class="ident" id="4066331">time</span><span class="op" id="4066335">.</span><span class="ident" id="4066336">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066343">var</span>&nbsp;<span class="ident" id="4066347">err1</span>&nbsp;<span class="builtintype" id="4066352">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066360">if</span>&nbsp;<span class="ident" id="4066363">universalTag</span>&nbsp;<span class="op" id="4066376">==</span>&nbsp;<span class="ident" id="4066379">tagUTCTime</span>&nbsp;<span class="op" id="4066390">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066395">time</span><span class="op" id="4066399">,</span>&nbsp;<span class="ident" id="4066401">err1</span>&nbsp;<span class="op" id="4066406">=</span>&nbsp;<span class="ident" id="4066408">parseUTCTime</span><span class="op" id="4066420">(</span><span class="ident" id="4066421">innerBytes</span><span class="op" id="4066431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4066435">}</span>&nbsp;<span class="keyword" id="4066437">else</span>&nbsp;<span class="op" id="4066442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066447">time</span><span class="op" id="4066451">,</span>&nbsp;<span class="ident" id="4066453">err1</span>&nbsp;<span class="op" id="4066458">=</span>&nbsp;<span class="ident" id="4066460">parseGeneralizedTime</span><span class="op" id="4066480">(</span><span class="ident" id="4066481">innerBytes</span><span class="op" id="4066491">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4066495">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066499">if</span>&nbsp;<span class="ident" id="4066502">err1</span>&nbsp;<span class="op" id="4066507">==</span>&nbsp;<span class="builtintype" id="4066510">nil</span>&nbsp;<span class="op" id="4066514">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066519">v</span><span class="op" id="4066520">.</span><span class="ident" id="4066521">Set</span><span class="op" id="4066524">(</span><span class="ident" id="4066525">reflect</span><span class="op" id="4066532">.</span><span class="ident" id="4066533">ValueOf</span><span class="op" id="4066540">(</span><span class="ident" id="4066541">time</span><span class="op" id="4066545">)</span><span class="op" id="4066546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4066550">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066554">err</span>&nbsp;<span class="op" id="4066558">=</span>&nbsp;<span class="ident" id="4066560">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066567">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066575">case</span>&nbsp;<span class="ident" id="4066580">enumeratedType</span><span class="op" id="4066594">:</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066598">parsedInt</span><span class="op" id="4066607">,</span>&nbsp;<span class="ident" id="4066609">err1</span>&nbsp;<span class="op" id="4066614">:=</span>&nbsp;<span class="ident" id="4066617">parseInt32</span><span class="op" id="4066627">(</span><span class="ident" id="4066628">innerBytes</span><span class="op" id="4066638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066642">if</span>&nbsp;<span class="ident" id="4066645">err1</span>&nbsp;<span class="op" id="4066650">==</span>&nbsp;<span class="builtintype" id="4066653">nil</span>&nbsp;<span class="op" id="4066657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066662">v</span><span class="op" id="4066663">.</span><span class="ident" id="4066664">SetInt</span><span class="op" id="4066670">(</span><span class="ident" id="4066671">int64</span><span class="op" id="4066676">(</span><span class="ident" id="4066677">parsedInt</span><span class="op" id="4066686">)</span><span class="op" id="4066687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4066691">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066695">err</span>&nbsp;<span class="op" id="4066699">=</span>&nbsp;<span class="ident" id="4066701">err1</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066708">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066716">case</span>&nbsp;<span class="ident" id="4066721">flagType</span><span class="op" id="4066729">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066733">v</span><span class="op" id="4066734">.</span><span class="ident" id="4066735">SetBool</span><span class="op" id="4066742">(</span><span class="builtintype" id="4066743">true</span><span class="op" id="4066747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066751">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066759">case</span>&nbsp;<span class="ident" id="4066764">bigIntType</span><span class="op" id="4066774">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066778">parsedInt</span>&nbsp;<span class="op" id="4066788">:=</span>&nbsp;<span class="ident" id="4066791">parseBigInt</span><span class="op" id="4066802">(</span><span class="ident" id="4066803">innerBytes</span><span class="op" id="4066813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066817">v</span><span class="op" id="4066818">.</span><span class="ident" id="4066819">Set</span><span class="op" id="4066822">(</span><span class="ident" id="4066823">reflect</span><span class="op" id="4066830">.</span><span class="ident" id="4066831">ValueOf</span><span class="op" id="4066838">(</span><span class="ident" id="4066839">parsedInt</span><span class="op" id="4066848">)</span><span class="op" id="4066849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066853">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4066861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066864">switch</span>&nbsp;<span class="ident" id="4066871">val</span>&nbsp;<span class="op" id="4066875">:=</span>&nbsp;<span class="ident" id="4066878">v</span><span class="op" id="4066879">;</span>&nbsp;<span class="ident" id="4066881">val</span><span class="op" id="4066884">.</span><span class="ident" id="4066885">Kind</span><span class="op" id="4066889">(</span><span class="op" id="4066890">)</span>&nbsp;<span class="op" id="4066892">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066895">case</span>&nbsp;<span class="ident" id="4066900">reflect</span><span class="op" id="4066907">.</span><span class="ident" id="4066908">Bool</span><span class="op" id="4066912">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066916">parsedBool</span><span class="op" id="4066926">,</span>&nbsp;<span class="ident" id="4066928">err1</span>&nbsp;<span class="op" id="4066933">:=</span>&nbsp;<span class="ident" id="4066936">parseBool</span><span class="op" id="4066945">(</span><span class="ident" id="4066946">innerBytes</span><span class="op" id="4066956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4066960">if</span>&nbsp;<span class="ident" id="4066963">err1</span>&nbsp;<span class="op" id="4066968">==</span>&nbsp;<span class="builtintype" id="4066971">nil</span>&nbsp;<span class="op" id="4066975">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4066980">val</span><span class="op" id="4066983">.</span><span class="ident" id="4066984">SetBool</span><span class="op" id="4066991">(</span><span class="ident" id="4066992">parsedBool</span><span class="op" id="4067002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4067006">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067010">err</span>&nbsp;<span class="op" id="4067014">=</span>&nbsp;<span class="ident" id="4067016">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067023">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067031">case</span>&nbsp;<span class="ident" id="4067036">reflect</span><span class="op" id="4067043">.</span><span class="ident" id="4067044">Int</span><span class="op" id="4067047">,</span>&nbsp;<span class="ident" id="4067049">reflect</span><span class="op" id="4067056">.</span><span class="ident" id="4067057">Int32</span><span class="op" id="4067062">,</span>&nbsp;<span class="ident" id="4067064">reflect</span><span class="op" id="4067071">.</span><span class="ident" id="4067072">Int64</span><span class="op" id="4067077">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067081">if</span>&nbsp;<span class="ident" id="4067084">val</span><span class="op" id="4067087">.</span><span class="ident" id="4067088">Type</span><span class="op" id="4067092">(</span><span class="op" id="4067093">)</span><span class="op" id="4067094">.</span><span class="ident" id="4067095">Size</span><span class="op" id="4067099">(</span><span class="op" id="4067100">)</span>&nbsp;<span class="op" id="4067102">==</span>&nbsp;<span class="num" id="4067105">4</span>&nbsp;<span class="op" id="4067107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067112">parsedInt</span><span class="op" id="4067121">,</span>&nbsp;<span class="ident" id="4067123">err1</span>&nbsp;<span class="op" id="4067128">:=</span>&nbsp;<span class="ident" id="4067131">parseInt32</span><span class="op" id="4067141">(</span><span class="ident" id="4067142">innerBytes</span><span class="op" id="4067152">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067157">if</span>&nbsp;<span class="ident" id="4067160">err1</span>&nbsp;<span class="op" id="4067165">==</span>&nbsp;<span class="builtintype" id="4067168">nil</span>&nbsp;<span class="op" id="4067172">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067178">val</span><span class="op" id="4067181">.</span><span class="ident" id="4067182">SetInt</span><span class="op" id="4067188">(</span><span class="ident" id="4067189">int64</span><span class="op" id="4067194">(</span><span class="ident" id="4067195">parsedInt</span><span class="op" id="4067204">)</span><span class="op" id="4067205">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4067210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067215">err</span>&nbsp;<span class="op" id="4067219">=</span>&nbsp;<span class="ident" id="4067221">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4067228">}</span>&nbsp;<span class="keyword" id="4067230">else</span>&nbsp;<span class="op" id="4067235">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067240">parsedInt</span><span class="op" id="4067249">,</span>&nbsp;<span class="ident" id="4067251">err1</span>&nbsp;<span class="op" id="4067256">:=</span>&nbsp;<span class="ident" id="4067259">parseInt64</span><span class="op" id="4067269">(</span><span class="ident" id="4067270">innerBytes</span><span class="op" id="4067280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067285">if</span>&nbsp;<span class="ident" id="4067288">err1</span>&nbsp;<span class="op" id="4067293">==</span>&nbsp;<span class="builtintype" id="4067296">nil</span>&nbsp;<span class="op" id="4067300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067306">val</span><span class="op" id="4067309">.</span><span class="ident" id="4067310">SetInt</span><span class="op" id="4067316">(</span><span class="ident" id="4067317">parsedInt</span><span class="op" id="4067326">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4067331">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067336">err</span>&nbsp;<span class="op" id="4067340">=</span>&nbsp;<span class="ident" id="4067342">err1</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4067349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067353">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4067361">//&nbsp;TODO(dfc)&nbsp;Add&nbsp;support&nbsp;for&nbsp;the&nbsp;remaining&nbsp;integer&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067419">case</span>&nbsp;<span class="ident" id="4067424">reflect</span><span class="op" id="4067431">.</span><span class="ident" id="4067432">Struct</span><span class="op" id="4067438">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067442">structType</span>&nbsp;<span class="op" id="4067453">:=</span>&nbsp;<span class="ident" id="4067456">fieldType</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067469">if</span>&nbsp;<span class="ident" id="4067472">structType</span><span class="op" id="4067482">.</span><span class="ident" id="4067483">NumField</span><span class="op" id="4067491">(</span><span class="op" id="4067492">)</span>&nbsp;<span class="op" id="4067494">&gt;</span>&nbsp;<span class="num" id="4067496">0</span>&nbsp;<span class="op" id="4067498">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067504">structType</span><span class="op" id="4067514">.</span><span class="ident" id="4067515">Field</span><span class="op" id="4067520">(</span><span class="num" id="4067521">0</span><span class="op" id="4067522">)</span><span class="op" id="4067523">.</span><span class="ident" id="4067524">Type</span>&nbsp;<span class="op" id="4067529">==</span>&nbsp;<span class="ident" id="4067532">rawContentsType</span>&nbsp;<span class="op" id="4067548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067553">bytes</span>&nbsp;<span class="op" id="4067559">:=</span>&nbsp;<span class="ident" id="4067562">bytes</span><span class="op" id="4067567">[</span><span class="ident" id="4067568">initOffset</span><span class="op" id="4067578">:</span><span class="ident" id="4067579">offset</span><span class="op" id="4067585">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067590">val</span><span class="op" id="4067593">.</span><span class="ident" id="4067594">Field</span><span class="op" id="4067599">(</span><span class="num" id="4067600">0</span><span class="op" id="4067601">)</span><span class="op" id="4067602">.</span><span class="ident" id="4067603">Set</span><span class="op" id="4067606">(</span><span class="ident" id="4067607">reflect</span><span class="op" id="4067614">.</span><span class="ident" id="4067615">ValueOf</span><span class="op" id="4067622">(</span><span class="ident" id="4067623">RawContent</span><span class="op" id="4067633">(</span><span class="ident" id="4067634">bytes</span><span class="op" id="4067639">)</span><span class="op" id="4067640">)</span><span class="op" id="4067641">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4067645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067650">innerOffset</span>&nbsp;<span class="op" id="4067662">:=</span>&nbsp;<span class="num" id="4067665">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067669">for</span>&nbsp;<span class="ident" id="4067673">i</span>&nbsp;<span class="op" id="4067675">:=</span>&nbsp;<span class="num" id="4067678">0</span><span class="op" id="4067679">;</span>&nbsp;<span class="ident" id="4067681">i</span>&nbsp;<span class="op" id="4067683">&lt;</span>&nbsp;<span class="ident" id="4067685">structType</span><span class="op" id="4067695">.</span><span class="ident" id="4067696">NumField</span><span class="op" id="4067704">(</span><span class="op" id="4067705">)</span><span class="op" id="4067706">;</span>&nbsp;<span class="ident" id="4067708">i</span><span class="op" id="4067709">++</span>&nbsp;<span class="op" id="4067712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067717">field</span>&nbsp;<span class="op" id="4067723">:=</span>&nbsp;<span class="ident" id="4067726">structType</span><span class="op" id="4067736">.</span><span class="ident" id="4067737">Field</span><span class="op" id="4067742">(</span><span class="ident" id="4067743">i</span><span class="op" id="4067744">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067749">if</span>&nbsp;<span class="ident" id="4067752">i</span>&nbsp;<span class="op" id="4067754">==</span>&nbsp;<span class="num" id="4067757">0</span>&nbsp;<span class="op" id="4067759">&amp;&amp;</span>&nbsp;<span class="ident" id="4067762">field</span><span class="op" id="4067767">.</span><span class="ident" id="4067768">Type</span>&nbsp;<span class="op" id="4067773">==</span>&nbsp;<span class="ident" id="4067776">rawContentsType</span>&nbsp;<span class="op" id="4067792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067798">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4067810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4067815">innerOffset</span><span class="op" id="4067826">,</span>&nbsp;<span class="ident" id="4067828">err</span>&nbsp;<span class="op" id="4067832">=</span>&nbsp;<span class="ident" id="4067834">parseField</span><span class="op" id="4067844">(</span><span class="ident" id="4067845">val</span><span class="op" id="4067848">.</span><span class="ident" id="4067849">Field</span><span class="op" id="4067854">(</span><span class="ident" id="4067855">i</span><span class="op" id="4067856">)</span><span class="op" id="4067857">,</span>&nbsp;<span class="ident" id="4067859">innerBytes</span><span class="op" id="4067869">,</span>&nbsp;<span class="ident" id="4067871">innerOffset</span><span class="op" id="4067882">,</span>&nbsp;<span class="ident" id="4067884">parseFieldParameters</span><span class="op" id="4067904">(</span><span class="ident" id="4067905">field</span><span class="op" id="4067910">.</span><span class="ident" id="4067911">Tag</span><span class="op" id="4067914">.</span><span class="ident" id="4067915">Get</span><span class="op" id="4067918">(</span><span class="string" id="4067919">&#34;asn1&#34;</span><span class="op" id="4067925">)</span><span class="op" id="4067926">)</span><span class="op" id="4067927">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067932">if</span>&nbsp;<span class="ident" id="4067935">err</span>&nbsp;<span class="op" id="4067939">!=</span>&nbsp;<span class="builtintype" id="4067942">nil</span>&nbsp;<span class="op" id="4067946">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4067952">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4067962">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4067966">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4067970">//&nbsp;We&nbsp;allow&nbsp;extra&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;SEQUENCE&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4068031">//&nbsp;adding&nbsp;elements&nbsp;to&nbsp;the&nbsp;end&nbsp;has&nbsp;been&nbsp;used&nbsp;in&nbsp;X.509&nbsp;as&nbsp;the</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4068093">//&nbsp;version&nbsp;numbers&nbsp;have&nbsp;increased.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068130">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068138">case</span>&nbsp;<span class="ident" id="4068143">reflect</span><span class="op" id="4068150">.</span><span class="ident" id="4068151">Slice</span><span class="op" id="4068156">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068160">sliceType</span>&nbsp;<span class="op" id="4068170">:=</span>&nbsp;<span class="ident" id="4068173">fieldType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068185">if</span>&nbsp;<span class="ident" id="4068188">sliceType</span><span class="op" id="4068197">.</span><span class="ident" id="4068198">Elem</span><span class="op" id="4068202">(</span><span class="op" id="4068203">)</span><span class="op" id="4068204">.</span><span class="ident" id="4068205">Kind</span><span class="op" id="4068209">(</span><span class="op" id="4068210">)</span>&nbsp;<span class="op" id="4068212">==</span>&nbsp;<span class="ident" id="4068215">reflect</span><span class="op" id="4068222">.</span><span class="ident" id="4068223">Uint8</span>&nbsp;<span class="op" id="4068229">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068234">val</span><span class="op" id="4068237">.</span><span class="ident" id="4068238">Set</span><span class="op" id="4068241">(</span><span class="ident" id="4068242">reflect</span><span class="op" id="4068249">.</span><span class="ident" id="4068250">MakeSlice</span><span class="op" id="4068259">(</span><span class="ident" id="4068260">sliceType</span><span class="op" id="4068269">,</span>&nbsp;<span class="builtinfunc" id="4068271">len</span><span class="op" id="4068274">(</span><span class="ident" id="4068275">innerBytes</span><span class="op" id="4068285">)</span><span class="op" id="4068286">,</span>&nbsp;<span class="builtinfunc" id="4068288">len</span><span class="op" id="4068291">(</span><span class="ident" id="4068292">innerBytes</span><span class="op" id="4068302">)</span><span class="op" id="4068303">)</span><span class="op" id="4068304">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068309">reflect</span><span class="op" id="4068316">.</span><span class="ident" id="4068317">Copy</span><span class="op" id="4068321">(</span><span class="ident" id="4068322">val</span><span class="op" id="4068325">,</span>&nbsp;<span class="ident" id="4068327">reflect</span><span class="op" id="4068334">.</span><span class="ident" id="4068335">ValueOf</span><span class="op" id="4068342">(</span><span class="ident" id="4068343">innerBytes</span><span class="op" id="4068353">)</span><span class="op" id="4068354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068359">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4068368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068372">newSlice</span><span class="op" id="4068380">,</span>&nbsp;<span class="ident" id="4068382">err1</span>&nbsp;<span class="op" id="4068387">:=</span>&nbsp;<span class="ident" id="4068390">parseSequenceOf</span><span class="op" id="4068405">(</span><span class="ident" id="4068406">innerBytes</span><span class="op" id="4068416">,</span>&nbsp;<span class="ident" id="4068418">sliceType</span><span class="op" id="4068427">,</span>&nbsp;<span class="ident" id="4068429">sliceType</span><span class="op" id="4068438">.</span><span class="ident" id="4068439">Elem</span><span class="op" id="4068443">(</span><span class="op" id="4068444">)</span><span class="op" id="4068445">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068449">if</span>&nbsp;<span class="ident" id="4068452">err1</span>&nbsp;<span class="op" id="4068457">==</span>&nbsp;<span class="builtintype" id="4068460">nil</span>&nbsp;<span class="op" id="4068464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068469">val</span><span class="op" id="4068472">.</span><span class="ident" id="4068473">Set</span><span class="op" id="4068476">(</span><span class="ident" id="4068477">newSlice</span><span class="op" id="4068485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4068489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068493">err</span>&nbsp;<span class="op" id="4068497">=</span>&nbsp;<span class="ident" id="4068499">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068506">return</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068514">case</span>&nbsp;<span class="ident" id="4068519">reflect</span><span class="op" id="4068526">.</span><span class="ident" id="4068527">String</span><span class="op" id="4068533">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068537">var</span>&nbsp;<span class="ident" id="4068541">v</span>&nbsp;<span class="builtintype" id="4068543">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068552">switch</span>&nbsp;<span class="ident" id="4068559">universalTag</span>&nbsp;<span class="op" id="4068572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068576">case</span>&nbsp;<span class="ident" id="4068581">tagPrintableString</span><span class="op" id="4068599">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068604">v</span><span class="op" id="4068605">,</span>&nbsp;<span class="ident" id="4068607">err</span>&nbsp;<span class="op" id="4068611">=</span>&nbsp;<span class="ident" id="4068613">parsePrintableString</span><span class="op" id="4068633">(</span><span class="ident" id="4068634">innerBytes</span><span class="op" id="4068644">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068648">case</span>&nbsp;<span class="ident" id="4068653">tagIA5String</span><span class="op" id="4068665">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068670">v</span><span class="op" id="4068671">,</span>&nbsp;<span class="ident" id="4068673">err</span>&nbsp;<span class="op" id="4068677">=</span>&nbsp;<span class="ident" id="4068679">parseIA5String</span><span class="op" id="4068693">(</span><span class="ident" id="4068694">innerBytes</span><span class="op" id="4068704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068708">case</span>&nbsp;<span class="ident" id="4068713">tagT61String</span><span class="op" id="4068725">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068730">v</span><span class="op" id="4068731">,</span>&nbsp;<span class="ident" id="4068733">err</span>&nbsp;<span class="op" id="4068737">=</span>&nbsp;<span class="ident" id="4068739">parseT61String</span><span class="op" id="4068753">(</span><span class="ident" id="4068754">innerBytes</span><span class="op" id="4068764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068768">case</span>&nbsp;<span class="ident" id="4068773">tagUTF8String</span><span class="op" id="4068786">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4068791">v</span><span class="op" id="4068792">,</span>&nbsp;<span class="ident" id="4068794">err</span>&nbsp;<span class="op" id="4068798">=</span>&nbsp;<span class="ident" id="4068800">parseUTF8String</span><span class="op" id="4068815">(</span><span class="ident" id="4068816">innerBytes</span><span class="op" id="4068826">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4068830">case</span>&nbsp;<span class="ident" id="4068835">tagGeneralString</span><span class="op" id="4068851">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4068856">//&nbsp;GeneralString&nbsp;is&nbsp;specified&nbsp;in&nbsp;ISO-2022/ECMA-35,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4068910">//&nbsp;A&nbsp;brief&nbsp;review&nbsp;suggests&nbsp;that&nbsp;it&nbsp;includes&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4068968">//&nbsp;that&nbsp;allow&nbsp;the&nbsp;encoding&nbsp;to&nbsp;change&nbsp;midstring&nbsp;and</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4069022">//&nbsp;such.&nbsp;We&nbsp;give&nbsp;up&nbsp;and&nbsp;pass&nbsp;it&nbsp;as&nbsp;an&nbsp;8-bit&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069077">v</span><span class="op" id="4069078">,</span>&nbsp;<span class="ident" id="4069080">err</span>&nbsp;<span class="op" id="4069084">=</span>&nbsp;<span class="ident" id="4069086">parseT61String</span><span class="op" id="4069100">(</span><span class="ident" id="4069101">innerBytes</span><span class="op" id="4069111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069115">default</span><span class="op" id="4069122">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069127">err</span>&nbsp;<span class="op" id="4069131">=</span>&nbsp;<span class="ident" id="4069133">SyntaxError</span><span class="op" id="4069144">{</span><span class="ident" id="4069145">fmt</span><span class="op" id="4069148">.</span><span class="ident" id="4069149">Sprintf</span><span class="op" id="4069156">(</span><span class="string" id="4069157">&#34;internal&nbsp;error:&nbsp;unknown&nbsp;string&nbsp;type&nbsp;%d&#34;</span><span class="op" id="4069197">,</span>&nbsp;<span class="ident" id="4069199">universalTag</span><span class="op" id="4069211">)</span><span class="op" id="4069212">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4069216">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069220">if</span>&nbsp;<span class="ident" id="4069223">err</span>&nbsp;<span class="op" id="4069227">==</span>&nbsp;<span class="builtintype" id="4069230">nil</span>&nbsp;<span class="op" id="4069234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069239">val</span><span class="op" id="4069242">.</span><span class="ident" id="4069243">SetString</span><span class="op" id="4069252">(</span><span class="ident" id="4069253">v</span><span class="op" id="4069254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4069258">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069262">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4069270">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069273">err</span>&nbsp;<span class="op" id="4069277">=</span>&nbsp;<span class="ident" id="4069279">StructuralError</span><span class="op" id="4069294">{</span><span class="string" id="4069295">&#34;unsupported:&nbsp;&#34;</span>&nbsp;<span class="op" id="4069311">+</span>&nbsp;<span class="ident" id="4069313">v</span><span class="op" id="4069314">.</span><span class="ident" id="4069315">Type</span><span class="op" id="4069319">(</span><span class="op" id="4069320">)</span><span class="op" id="4069321">.</span><span class="ident" id="4069322">String</span><span class="op" id="4069328">(</span><span class="op" id="4069329">)</span><span class="op" id="4069330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069333">return</span><br>
<span class="lineno"></span><span class="op" id="4069340">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4069343">//&nbsp;canHaveDefaultValue&nbsp;reports&nbsp;whether&nbsp;k&nbsp;is&nbsp;a&nbsp;Kind&nbsp;that&nbsp;we&nbsp;will&nbsp;set&nbsp;a&nbsp;default</span><br>
<span class="lineno">830</span><span class="comment" id="4069421">//&nbsp;value&nbsp;for.&nbsp;(A&nbsp;signed&nbsp;integer,&nbsp;essentially.)</span><br>
<span class="lineno"></span><span class="keyword" id="4069468">func</span>&nbsp;<span class="ident" id="4069473">canHaveDefaultValue</span><span class="op" id="4069492">(</span><span class="ident" id="4069493">k</span>&nbsp;<span class="ident" id="4069495">reflect</span><span class="op" id="4069502">.</span><span class="ident" id="4069503">Kind</span><span class="op" id="4069507">)</span>&nbsp;<span class="builtintype" id="4069509">bool</span>&nbsp;<span class="op" id="4069514">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069517">switch</span>&nbsp;<span class="ident" id="4069524">k</span>&nbsp;<span class="op" id="4069526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069529">case</span>&nbsp;<span class="ident" id="4069534">reflect</span><span class="op" id="4069541">.</span><span class="ident" id="4069542">Int</span><span class="op" id="4069545">,</span>&nbsp;<span class="ident" id="4069547">reflect</span><span class="op" id="4069554">.</span><span class="ident" id="4069555">Int8</span><span class="op" id="4069559">,</span>&nbsp;<span class="ident" id="4069561">reflect</span><span class="op" id="4069568">.</span><span class="ident" id="4069569">Int16</span><span class="op" id="4069574">,</span>&nbsp;<span class="ident" id="4069576">reflect</span><span class="op" id="4069583">.</span><span class="ident" id="4069584">Int32</span><span class="op" id="4069589">,</span>&nbsp;<span class="ident" id="4069591">reflect</span><span class="op" id="4069598">.</span><span class="ident" id="4069599">Int64</span><span class="op" id="4069604">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069608">return</span>&nbsp;<span class="builtintype" id="4069615">true</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4069621">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069625">return</span>&nbsp;<span class="builtintype" id="4069632">false</span><br>
<span class="lineno"></span><span class="op" id="4069638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="4069641">//&nbsp;setDefaultValue&nbsp;is&nbsp;used&nbsp;to&nbsp;install&nbsp;a&nbsp;default&nbsp;value,&nbsp;from&nbsp;a&nbsp;tag&nbsp;string,&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="4069720">//&nbsp;a&nbsp;Value.&nbsp;It&nbsp;is&nbsp;successful&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;optional,&nbsp;even&nbsp;if&nbsp;a&nbsp;default&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4069800">//&nbsp;wasn&#39;t&nbsp;provided&nbsp;or&nbsp;it&nbsp;failed&nbsp;to&nbsp;install&nbsp;it&nbsp;into&nbsp;the&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4069862">func</span>&nbsp;<span class="ident" id="4069867">setDefaultValue</span><span class="op" id="4069882">(</span><span class="ident" id="4069883">v</span>&nbsp;<span class="ident" id="4069885">reflect</span><span class="op" id="4069892">.</span><span class="ident" id="4069893">Value</span><span class="op" id="4069898">,</span>&nbsp;<span class="ident" id="4069900">params</span>&nbsp;<span class="ident" id="4069907">fieldParameters</span><span class="op" id="4069922">)</span>&nbsp;<span class="op" id="4069924">(</span><span class="ident" id="4069925">ok</span>&nbsp;<span class="builtintype" id="4069928">bool</span><span class="op" id="4069932">)</span>&nbsp;<span class="op" id="4069934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069937">if</span>&nbsp;<span class="op" id="4069940">!</span><span class="ident" id="4069941">params</span><span class="op" id="4069947">.</span><span class="ident" id="4069948">optional</span>&nbsp;<span class="op" id="4069957">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069961">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4069969">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4069972">ok</span>&nbsp;<span class="op" id="4069975">=</span>&nbsp;<span class="builtintype" id="4069977">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4069983">if</span>&nbsp;<span class="ident" id="4069986">params</span><span class="op" id="4069992">.</span><span class="ident" id="4069993">defaultValue</span>&nbsp;<span class="op" id="4070006">==</span>&nbsp;<span class="builtintype" id="4070009">nil</span>&nbsp;<span class="op" id="4070013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4070017">return</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4070025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4070028">if</span>&nbsp;<span class="ident" id="4070031">canHaveDefaultValue</span><span class="op" id="4070050">(</span><span class="ident" id="4070051">v</span><span class="op" id="4070052">.</span><span class="ident" id="4070053">Kind</span><span class="op" id="4070057">(</span><span class="op" id="4070058">)</span><span class="op" id="4070059">)</span>&nbsp;<span class="op" id="4070061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4070065">v</span><span class="op" id="4070066">.</span><span class="ident" id="4070067">SetInt</span><span class="op" id="4070073">(</span><span class="op" id="4070074">*</span><span class="ident" id="4070075">params</span><span class="op" id="4070081">.</span><span class="ident" id="4070082">defaultValue</span><span class="op" id="4070094">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4070097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4070100">return</span><br>
<span class="lineno">855</span><span class="op" id="4070107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4070110">//&nbsp;Unmarshal&nbsp;parses&nbsp;the&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structure&nbsp;b</span><br>
<span class="lineno"></span><span class="comment" id="4070169">//&nbsp;and&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package&nbsp;to&nbsp;fill&nbsp;in&nbsp;an&nbsp;arbitrary&nbsp;value&nbsp;pointed&nbsp;at&nbsp;by&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="4070250">//&nbsp;Because&nbsp;Unmarshal&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package,&nbsp;the&nbsp;structs</span><br>
<span class="lineno">860</span><span class="comment" id="4070309">//&nbsp;being&nbsp;written&nbsp;to&nbsp;must&nbsp;use&nbsp;upper&nbsp;case&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span><span class="comment" id="4070362">//</span><br>
<span class="lineno"></span><span class="comment" id="4070365">//&nbsp;An&nbsp;ASN.1&nbsp;INTEGER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;int,&nbsp;int32,&nbsp;int64,</span><br>
<span class="lineno"></span><span class="comment" id="4070425">//&nbsp;or&nbsp;*big.Int&nbsp;(from&nbsp;the&nbsp;math/big&nbsp;package).</span><br>
<span class="lineno"></span><span class="comment" id="4070469">//&nbsp;If&nbsp;the&nbsp;encoded&nbsp;value&nbsp;does&nbsp;not&nbsp;fit&nbsp;in&nbsp;the&nbsp;Go&nbsp;type,</span><br>
<span class="lineno">865</span><span class="comment" id="4070522">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4070558">//</span><br>
<span class="lineno"></span><span class="comment" id="4070561">//&nbsp;An&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="comment" id="4070615">//</span><br>
<span class="lineno"></span><span class="comment" id="4070618">//&nbsp;An&nbsp;ASN.1&nbsp;OCTET&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;[]byte.</span><br>
<span class="lineno">870</span><span class="comment" id="4070671">//</span><br>
<span class="lineno"></span><span class="comment" id="4070674">//&nbsp;An&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4070725">//&nbsp;ObjectIdentifier.</span><br>
<span class="lineno"></span><span class="comment" id="4070746">//</span><br>
<span class="lineno"></span><span class="comment" id="4070749">//&nbsp;An&nbsp;ASN.1&nbsp;ENUMERATED&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;Enumerated.</span><br>
<span class="lineno">875</span><span class="comment" id="4070805">//</span><br>
<span class="lineno"></span><span class="comment" id="4070808">//&nbsp;An&nbsp;ASN.1&nbsp;UTCTIME&nbsp;or&nbsp;GENERALIZEDTIME&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;time.Time.</span><br>
<span class="lineno"></span><span class="comment" id="4070878">//</span><br>
<span class="lineno"></span><span class="comment" id="4070881">//&nbsp;An&nbsp;ASN.1&nbsp;PrintableString&nbsp;or&nbsp;IA5String&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="4070950">//</span><br>
<span class="lineno">880</span><span class="comment" id="4070953">//&nbsp;Any&nbsp;of&nbsp;the&nbsp;above&nbsp;ASN.1&nbsp;values&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="4071020">//&nbsp;The&nbsp;value&nbsp;stored&nbsp;in&nbsp;the&nbsp;interface&nbsp;has&nbsp;the&nbsp;corresponding&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4071088">//&nbsp;For&nbsp;integers,&nbsp;that&nbsp;type&nbsp;is&nbsp;int64.</span><br>
<span class="lineno"></span><span class="comment" id="4071125">//</span><br>
<span class="lineno"></span><span class="comment" id="4071128">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;OF&nbsp;x&nbsp;or&nbsp;SET&nbsp;OF&nbsp;x&nbsp;can&nbsp;be&nbsp;written</span><br>
<span class="lineno">885</span><span class="comment" id="4071181">//&nbsp;to&nbsp;a&nbsp;slice&nbsp;if&nbsp;an&nbsp;x&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;the&nbsp;slice&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4071247">//</span><br>
<span class="lineno"></span><span class="comment" id="4071250">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;or&nbsp;SET&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="4071305">//&nbsp;if&nbsp;each&nbsp;of&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;sequence&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4071355">//&nbsp;written&nbsp;to&nbsp;the&nbsp;corresponding&nbsp;element&nbsp;in&nbsp;the&nbsp;struct.</span><br>
<span class="lineno">890</span><span class="comment" id="4071410">//</span><br>
<span class="lineno"></span><span class="comment" id="4071413">//&nbsp;The&nbsp;following&nbsp;tags&nbsp;on&nbsp;struct&nbsp;fields&nbsp;have&nbsp;special&nbsp;meaning&nbsp;to&nbsp;Unmarshal:</span><br>
<span class="lineno"></span><span class="comment" id="4071487">//</span><br>
<span class="lineno"></span><span class="comment" id="4071490">//&nbsp;&nbsp;&nbsp;&nbsp;application&nbsp;&nbsp;&nbsp;&nbsp;specifies&nbsp;that&nbsp;a&nbsp;APPLICATION&nbsp;tag&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="4071546">//&nbsp;&nbsp;&nbsp;&nbsp;default:x&nbsp;&nbsp;&nbsp;&nbsp;sets&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;optional&nbsp;integer&nbsp;fields</span><br>
<span class="lineno">895</span><span class="comment" id="4071610">//&nbsp;&nbsp;&nbsp;&nbsp;explicit&nbsp;&nbsp;&nbsp;&nbsp;specifies&nbsp;that&nbsp;an&nbsp;additional,&nbsp;explicit&nbsp;tag&nbsp;wraps&nbsp;the&nbsp;implicit&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="4071688">//&nbsp;&nbsp;&nbsp;&nbsp;optional&nbsp;&nbsp;&nbsp;&nbsp;marks&nbsp;the&nbsp;field&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL</span><br>
<span class="lineno"></span><span class="comment" id="4071734">//&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;causes&nbsp;a&nbsp;SET,&nbsp;rather&nbsp;than&nbsp;a&nbsp;SEQUENCE&nbsp;type&nbsp;to&nbsp;be&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="4071799">//&nbsp;&nbsp;&nbsp;&nbsp;tag:x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;specifies&nbsp;the&nbsp;ASN.1&nbsp;tag&nbsp;number;&nbsp;implies&nbsp;ASN.1&nbsp;CONTEXT&nbsp;SPECIFIC</span><br>
<span class="lineno"></span><span class="comment" id="4071872">//</span><br>
<span class="lineno">900</span><span class="comment" id="4071875">//&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;a&nbsp;structure&nbsp;is&nbsp;RawContent&nbsp;then&nbsp;the&nbsp;raw</span><br>
<span class="lineno"></span><span class="comment" id="4071951">//&nbsp;ASN1&nbsp;contents&nbsp;of&nbsp;the&nbsp;struct&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4072004">//</span><br>
<span class="lineno"></span><span class="comment" id="4072007">//&nbsp;If&nbsp;the&nbsp;type&nbsp;name&nbsp;of&nbsp;a&nbsp;slice&nbsp;element&nbsp;ends&nbsp;with&nbsp;&#34;SET&#34;&nbsp;then&nbsp;it&#39;s&nbsp;treated&nbsp;as&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="4072086">//&nbsp;the&nbsp;&#34;set&#34;&nbsp;tag&nbsp;was&nbsp;set&nbsp;on&nbsp;it.&nbsp;This&nbsp;can&nbsp;be&nbsp;used&nbsp;with&nbsp;nested&nbsp;slices&nbsp;where&nbsp;a</span><br>
<span class="lineno">905</span><span class="comment" id="4072162">//&nbsp;struct&nbsp;tag&nbsp;cannot&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="comment" id="4072193">//</span><br>
<span class="lineno"></span><span class="comment" id="4072196">//&nbsp;Other&nbsp;ASN.1&nbsp;types&nbsp;are&nbsp;not&nbsp;supported;&nbsp;if&nbsp;it&nbsp;encounters&nbsp;them,</span><br>
<span class="lineno"></span><span class="comment" id="4072259">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4072295">func</span>&nbsp;<span class="ident" id="4072300">Unmarshal</span><span class="op" id="4072309">(</span><span class="ident" id="4072310">b</span>&nbsp;<span class="op" id="4072312">[</span><span class="op" id="4072313">]</span><span class="builtintype" id="4072314">byte</span><span class="op" id="4072318">,</span>&nbsp;<span class="ident" id="4072320">val</span>&nbsp;<span class="keyword" id="4072324">interface</span><span class="op" id="4072333">{</span><span class="op" id="4072334">}</span><span class="op" id="4072335">)</span>&nbsp;<span class="op" id="4072337">(</span><span class="ident" id="4072338">rest</span>&nbsp;<span class="op" id="4072343">[</span><span class="op" id="4072344">]</span><span class="builtintype" id="4072345">byte</span><span class="op" id="4072349">,</span>&nbsp;<span class="ident" id="4072351">err</span>&nbsp;<span class="builtintype" id="4072355">error</span><span class="op" id="4072360">)</span>&nbsp;<span class="op" id="4072362">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4072365">return</span>&nbsp;<span class="ident" id="4072372">UnmarshalWithParams</span><span class="op" id="4072391">(</span><span class="ident" id="4072392">b</span><span class="op" id="4072393">,</span>&nbsp;<span class="ident" id="4072395">val</span><span class="op" id="4072398">,</span>&nbsp;<span class="string" id="4072400">&#34;&#34;</span><span class="op" id="4072402">)</span><br>
<span class="lineno"></span><span class="op" id="4072404">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4072407">//&nbsp;UnmarshalWithParams&nbsp;allows&nbsp;field&nbsp;parameters&nbsp;to&nbsp;be&nbsp;specified&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4072478">//&nbsp;top-level&nbsp;element.&nbsp;The&nbsp;form&nbsp;of&nbsp;the&nbsp;params&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;field&nbsp;tags.</span><br>
<span class="lineno">915</span><span class="keyword" id="4072554">func</span>&nbsp;<span class="ident" id="4072559">UnmarshalWithParams</span><span class="op" id="4072578">(</span><span class="ident" id="4072579">b</span>&nbsp;<span class="op" id="4072581">[</span><span class="op" id="4072582">]</span><span class="builtintype" id="4072583">byte</span><span class="op" id="4072587">,</span>&nbsp;<span class="ident" id="4072589">val</span>&nbsp;<span class="keyword" id="4072593">interface</span><span class="op" id="4072602">{</span><span class="op" id="4072603">}</span><span class="op" id="4072604">,</span>&nbsp;<span class="ident" id="4072606">params</span>&nbsp;<span class="builtintype" id="4072613">string</span><span class="op" id="4072619">)</span>&nbsp;<span class="op" id="4072621">(</span><span class="ident" id="4072622">rest</span>&nbsp;<span class="op" id="4072627">[</span><span class="op" id="4072628">]</span><span class="builtintype" id="4072629">byte</span><span class="op" id="4072633">,</span>&nbsp;<span class="ident" id="4072635">err</span>&nbsp;<span class="builtintype" id="4072639">error</span><span class="op" id="4072644">)</span>&nbsp;<span class="op" id="4072646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4072649">v</span>&nbsp;<span class="op" id="4072651">:=</span>&nbsp;<span class="ident" id="4072654">reflect</span><span class="op" id="4072661">.</span><span class="ident" id="4072662">ValueOf</span><span class="op" id="4072669">(</span><span class="ident" id="4072670">val</span><span class="op" id="4072673">)</span><span class="op" id="4072674">.</span><span class="ident" id="4072675">Elem</span><span class="op" id="4072679">(</span><span class="op" id="4072680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4072683">offset</span><span class="op" id="4072689">,</span>&nbsp;<span class="ident" id="4072691">err</span>&nbsp;<span class="op" id="4072695">:=</span>&nbsp;<span class="ident" id="4072698">parseField</span><span class="op" id="4072708">(</span><span class="ident" id="4072709">v</span><span class="op" id="4072710">,</span>&nbsp;<span class="ident" id="4072712">b</span><span class="op" id="4072713">,</span>&nbsp;<span class="num" id="4072715">0</span><span class="op" id="4072716">,</span>&nbsp;<span class="ident" id="4072718">parseFieldParameters</span><span class="op" id="4072738">(</span><span class="ident" id="4072739">params</span><span class="op" id="4072745">)</span><span class="op" id="4072746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4072749">if</span>&nbsp;<span class="ident" id="4072752">err</span>&nbsp;<span class="op" id="4072756">!=</span>&nbsp;<span class="builtintype" id="4072759">nil</span>&nbsp;<span class="op" id="4072763">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4072767">return</span>&nbsp;<span class="builtintype" id="4072774">nil</span><span class="op" id="4072777">,</span>&nbsp;<span class="ident" id="4072779">err</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4072784">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4072787">return</span>&nbsp;<span class="ident" id="4072794">b</span><span class="op" id="4072795">[</span><span class="ident" id="4072796">offset</span><span class="op" id="4072802">:</span><span class="op" id="4072803">]</span><span class="op" id="4072804">,</span>&nbsp;<span class="builtintype" id="4072806">nil</span><br>
<span class="lineno"></span><span class="op" id="4072810">}</span>
</div>
</body>
</html>
