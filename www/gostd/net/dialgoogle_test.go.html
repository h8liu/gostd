<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8182895">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8182950">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8183004">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8183055">package</span>&nbsp;<span class="ident" id="8183063">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8183068">import</span>&nbsp;<span class="op" id="8183075">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8183078">&#34;flag&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8183086">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8183093">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8183099">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8183110">&#34;syscall&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8183121">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8183131">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="8183134">//&nbsp;If&nbsp;an&nbsp;IPv6&nbsp;tunnel&nbsp;is&nbsp;running,&nbsp;we&nbsp;can&nbsp;try&nbsp;dialing&nbsp;a&nbsp;real&nbsp;IPv6&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="8183207">var</span>&nbsp;<span class="ident" id="8183211">testIPv6</span>&nbsp;<span class="op" id="8183220">=</span>&nbsp;<span class="ident" id="8183222">flag</span><span class="op" id="8183226">.</span><span class="ident" id="8183227">Bool</span><span class="op" id="8183231">(</span><span class="string" id="8183232">&#34;ipv6&#34;</span><span class="op" id="8183238">,</span>&nbsp;<span class="builtintype" id="8183240">false</span><span class="op" id="8183245">,</span>&nbsp;<span class="string" id="8183247">&#34;assume&nbsp;ipv6&nbsp;tunnel&nbsp;is&nbsp;present&#34;</span><span class="op" id="8183278">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8183281">func</span>&nbsp;<span class="ident" id="8183286">TestResolveGoogle</span><span class="op" id="8183303">(</span><span class="ident" id="8183304">t</span>&nbsp;<span class="op" id="8183306">*</span><span class="ident" id="8183307">testing</span><span class="op" id="8183314">.</span><span class="ident" id="8183315">T</span><span class="op" id="8183316">)</span>&nbsp;<span class="op" id="8183318">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8183321">if</span>&nbsp;<span class="ident" id="8183324">testing</span><span class="op" id="8183331">.</span><span class="ident" id="8183332">Short</span><span class="op" id="8183337">(</span><span class="op" id="8183338">)</span>&nbsp;<span class="op" id="8183340">||</span>&nbsp;<span class="op" id="8183343">!</span><span class="op" id="8183344">*</span><span class="ident" id="8183345">testExternal</span>&nbsp;<span class="op" id="8183358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183362">t</span><span class="op" id="8183363">.</span><span class="ident" id="8183364">Skip</span><span class="op" id="8183368">(</span><span class="string" id="8183369">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8183410">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8183417">for</span>&nbsp;<span class="ident" id="8183421">_</span><span class="op" id="8183422">,</span>&nbsp;<span class="ident" id="8183424">network</span>&nbsp;<span class="op" id="8183432">:=</span>&nbsp;<span class="keyword" id="8183435">range</span>&nbsp;<span class="op" id="8183441">[</span><span class="op" id="8183442">]</span><span class="builtintype" id="8183443">string</span><span class="op" id="8183449">{</span><span class="string" id="8183450">&#34;tcp&#34;</span><span class="op" id="8183455">,</span>&nbsp;<span class="string" id="8183457">&#34;tcp4&#34;</span><span class="op" id="8183463">,</span>&nbsp;<span class="string" id="8183465">&#34;tcp6&#34;</span><span class="op" id="8183471">}</span>&nbsp;<span class="op" id="8183473">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183477">addr</span><span class="op" id="8183481">,</span>&nbsp;<span class="ident" id="8183483">err</span>&nbsp;<span class="op" id="8183487">:=</span>&nbsp;<span class="ident" id="8183490">ResolveTCPAddr</span><span class="op" id="8183504">(</span><span class="ident" id="8183505">network</span><span class="op" id="8183512">,</span>&nbsp;<span class="string" id="8183514">&#34;www.google.com:http&#34;</span><span class="op" id="8183535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8183539">if</span>&nbsp;<span class="ident" id="8183542">err</span>&nbsp;<span class="op" id="8183546">!=</span>&nbsp;<span class="ident" id="8183549">nil</span>&nbsp;<span class="op" id="8183553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8183558">if</span>&nbsp;<span class="op" id="8183561">(</span><span class="ident" id="8183562">network</span>&nbsp;<span class="op" id="8183570">==</span>&nbsp;<span class="string" id="8183573">&#34;tcp&#34;</span>&nbsp;<span class="op" id="8183579">||</span>&nbsp;<span class="ident" id="8183582">network</span>&nbsp;<span class="op" id="8183590">==</span>&nbsp;<span class="string" id="8183593">&#34;tcp4&#34;</span><span class="op" id="8183599">)</span>&nbsp;<span class="op" id="8183601">&amp;&amp;</span>&nbsp;<span class="op" id="8183604">!</span><span class="ident" id="8183605">supportsIPv4</span>&nbsp;<span class="op" id="8183618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183624">t</span><span class="op" id="8183625">.</span><span class="ident" id="8183626">Logf</span><span class="op" id="8183630">(</span><span class="string" id="8183631">&#34;ipv4&nbsp;is&nbsp;not&nbsp;supported:&nbsp;%v&#34;</span><span class="op" id="8183658">,</span>&nbsp;<span class="ident" id="8183660">err</span><span class="op" id="8183663">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183668">}</span>&nbsp;<span class="keyword" id="8183670">else</span>&nbsp;<span class="keyword" id="8183675">if</span>&nbsp;<span class="ident" id="8183678">network</span>&nbsp;<span class="op" id="8183686">==</span>&nbsp;<span class="string" id="8183689">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="8183696">&amp;&amp;</span>&nbsp;<span class="op" id="8183699">!</span><span class="ident" id="8183700">supportsIPv6</span>&nbsp;<span class="op" id="8183713">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183719">t</span><span class="op" id="8183720">.</span><span class="ident" id="8183721">Logf</span><span class="op" id="8183725">(</span><span class="string" id="8183726">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported:&nbsp;%v&#34;</span><span class="op" id="8183753">,</span>&nbsp;<span class="ident" id="8183755">err</span><span class="op" id="8183758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183763">}</span>&nbsp;<span class="keyword" id="8183765">else</span>&nbsp;<span class="op" id="8183770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183776">t</span><span class="op" id="8183777">.</span><span class="ident" id="8183778">Errorf</span><span class="op" id="8183784">(</span><span class="string" id="8183785">&#34;ResolveTCPAddr&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8183812">,</span>&nbsp;<span class="ident" id="8183814">err</span><span class="op" id="8183817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183822">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8183827">continue</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8183842">if</span>&nbsp;<span class="op" id="8183845">(</span><span class="ident" id="8183846">network</span>&nbsp;<span class="op" id="8183854">==</span>&nbsp;<span class="string" id="8183857">&#34;tcp&#34;</span>&nbsp;<span class="op" id="8183863">||</span>&nbsp;<span class="ident" id="8183866">network</span>&nbsp;<span class="op" id="8183874">==</span>&nbsp;<span class="string" id="8183877">&#34;tcp4&#34;</span><span class="op" id="8183883">)</span>&nbsp;<span class="op" id="8183885">&amp;&amp;</span>&nbsp;<span class="ident" id="8183888">addr</span><span class="op" id="8183892">.</span><span class="ident" id="8183893">IP</span><span class="op" id="8183895">.</span><span class="ident" id="8183896">To4</span><span class="op" id="8183899">(</span><span class="op" id="8183900">)</span>&nbsp;<span class="op" id="8183902">==</span>&nbsp;<span class="ident" id="8183905">nil</span>&nbsp;<span class="op" id="8183909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8183914">t</span><span class="op" id="8183915">.</span><span class="ident" id="8183916">Errorf</span><span class="op" id="8183922">(</span><span class="string" id="8183923">&#34;got&nbsp;%v;&nbsp;expected&nbsp;an&nbsp;IPv4&nbsp;address&nbsp;on&nbsp;%v&#34;</span><span class="op" id="8183963">,</span>&nbsp;<span class="ident" id="8183965">addr</span><span class="op" id="8183969">,</span>&nbsp;<span class="ident" id="8183971">network</span><span class="op" id="8183978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8183982">}</span>&nbsp;<span class="keyword" id="8183984">else</span>&nbsp;<span class="keyword" id="8183989">if</span>&nbsp;<span class="ident" id="8183992">network</span>&nbsp;<span class="op" id="8184000">==</span>&nbsp;<span class="string" id="8184003">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="8184010">&amp;&amp;</span>&nbsp;<span class="op" id="8184013">(</span><span class="ident" id="8184014">addr</span><span class="op" id="8184018">.</span><span class="ident" id="8184019">IP</span><span class="op" id="8184021">.</span><span class="ident" id="8184022">To16</span><span class="op" id="8184026">(</span><span class="op" id="8184027">)</span>&nbsp;<span class="op" id="8184029">==</span>&nbsp;<span class="ident" id="8184032">nil</span>&nbsp;<span class="op" id="8184036">||</span>&nbsp;<span class="ident" id="8184039">addr</span><span class="op" id="8184043">.</span><span class="ident" id="8184044">IP</span><span class="op" id="8184046">.</span><span class="ident" id="8184047">To4</span><span class="op" id="8184050">(</span><span class="op" id="8184051">)</span>&nbsp;<span class="op" id="8184053">!=</span>&nbsp;<span class="ident" id="8184056">nil</span><span class="op" id="8184059">)</span>&nbsp;<span class="op" id="8184061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8184066">t</span><span class="op" id="8184067">.</span><span class="ident" id="8184068">Errorf</span><span class="op" id="8184074">(</span><span class="string" id="8184075">&#34;got&nbsp;%v;&nbsp;expected&nbsp;an&nbsp;IPv6&nbsp;address&nbsp;on&nbsp;%v&#34;</span><span class="op" id="8184115">,</span>&nbsp;<span class="ident" id="8184117">addr</span><span class="op" id="8184121">,</span>&nbsp;<span class="ident" id="8184123">network</span><span class="op" id="8184130">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184137">}</span><br>
<span class="lineno"></span><span class="op" id="8184139">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8184142">func</span>&nbsp;<span class="ident" id="8184147">TestDialGoogle</span><span class="op" id="8184161">(</span><span class="ident" id="8184162">t</span>&nbsp;<span class="op" id="8184164">*</span><span class="ident" id="8184165">testing</span><span class="op" id="8184172">.</span><span class="ident" id="8184173">T</span><span class="op" id="8184174">)</span>&nbsp;<span class="op" id="8184176">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8184179">if</span>&nbsp;<span class="ident" id="8184182">testing</span><span class="op" id="8184189">.</span><span class="ident" id="8184190">Short</span><span class="op" id="8184195">(</span><span class="op" id="8184196">)</span>&nbsp;<span class="op" id="8184198">||</span>&nbsp;<span class="op" id="8184201">!</span><span class="op" id="8184202">*</span><span class="ident" id="8184203">testExternal</span>&nbsp;<span class="op" id="8184216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8184220">t</span><span class="op" id="8184221">.</span><span class="ident" id="8184222">Skip</span><span class="op" id="8184226">(</span><span class="string" id="8184227">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8184268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8184275">d</span>&nbsp;<span class="op" id="8184277">:=</span>&nbsp;<span class="op" id="8184280">&amp;</span><span class="ident" id="8184281">Dialer</span><span class="op" id="8184287">{</span><span class="ident" id="8184288">DualStack</span><span class="op" id="8184297">:</span>&nbsp;<span class="builtintype" id="8184299">true</span><span class="op" id="8184303">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8184306">for</span>&nbsp;<span class="ident" id="8184310">_</span><span class="op" id="8184311">,</span>&nbsp;<span class="ident" id="8184313">network</span>&nbsp;<span class="op" id="8184321">:=</span>&nbsp;<span class="keyword" id="8184324">range</span>&nbsp;<span class="op" id="8184330">[</span><span class="op" id="8184331">]</span><span class="builtintype" id="8184332">string</span><span class="op" id="8184338">{</span><span class="string" id="8184339">&#34;tcp&#34;</span><span class="op" id="8184344">,</span>&nbsp;<span class="string" id="8184346">&#34;tcp4&#34;</span><span class="op" id="8184352">,</span>&nbsp;<span class="string" id="8184354">&#34;tcp6&#34;</span><span class="op" id="8184360">}</span>&nbsp;<span class="op" id="8184362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8184366">if</span>&nbsp;<span class="ident" id="8184369">network</span>&nbsp;<span class="op" id="8184377">==</span>&nbsp;<span class="string" id="8184380">&#34;tcp&#34;</span>&nbsp;<span class="op" id="8184386">&amp;&amp;</span>&nbsp;<span class="op" id="8184389">!</span><span class="ident" id="8184390">supportsIPv4</span>&nbsp;<span class="op" id="8184403">&amp;&amp;</span>&nbsp;<span class="op" id="8184406">!</span><span class="ident" id="8184407">supportsIPv6</span>&nbsp;<span class="op" id="8184420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8184425">t</span><span class="op" id="8184426">.</span><span class="ident" id="8184427">Logf</span><span class="op" id="8184431">(</span><span class="string" id="8184432">&#34;skipping&nbsp;test;&nbsp;both&nbsp;ipv4&nbsp;and&nbsp;ipv6&nbsp;are&nbsp;not&nbsp;supported&#34;</span><span class="op" id="8184485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8184490">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184501">}</span>&nbsp;<span class="keyword" id="8184503">else</span>&nbsp;<span class="keyword" id="8184508">if</span>&nbsp;<span class="ident" id="8184511">network</span>&nbsp;<span class="op" id="8184519">==</span>&nbsp;<span class="string" id="8184522">&#34;tcp4&#34;</span>&nbsp;<span class="op" id="8184529">&amp;&amp;</span>&nbsp;<span class="op" id="8184532">!</span><span class="ident" id="8184533">supportsIPv4</span>&nbsp;<span class="op" id="8184546">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8184551">t</span><span class="op" id="8184552">.</span><span class="ident" id="8184553">Logf</span><span class="op" id="8184557">(</span><span class="string" id="8184558">&#34;skipping&nbsp;test;&nbsp;ipv4&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="8184596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8184601">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184612">}</span>&nbsp;<span class="keyword" id="8184614">else</span>&nbsp;<span class="keyword" id="8184619">if</span>&nbsp;<span class="ident" id="8184622">network</span>&nbsp;<span class="op" id="8184630">==</span>&nbsp;<span class="string" id="8184633">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="8184640">&amp;&amp;</span>&nbsp;<span class="op" id="8184643">!</span><span class="ident" id="8184644">supportsIPv6</span>&nbsp;<span class="op" id="8184657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8184662">t</span><span class="op" id="8184663">.</span><span class="ident" id="8184664">Logf</span><span class="op" id="8184668">(</span><span class="string" id="8184669">&#34;skipping&nbsp;test;&nbsp;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="8184707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8184712">continue</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184723">}</span>&nbsp;<span class="keyword" id="8184725">else</span>&nbsp;<span class="keyword" id="8184730">if</span>&nbsp;<span class="ident" id="8184733">network</span>&nbsp;<span class="op" id="8184741">==</span>&nbsp;<span class="string" id="8184744">&#34;tcp6&#34;</span>&nbsp;<span class="op" id="8184751">&amp;&amp;</span>&nbsp;<span class="op" id="8184754">!</span><span class="op" id="8184755">*</span><span class="ident" id="8184756">testIPv6</span>&nbsp;<span class="op" id="8184765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8184770">t</span><span class="op" id="8184771">.</span><span class="ident" id="8184772">Logf</span><span class="op" id="8184776">(</span><span class="string" id="8184777">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-ipv6&nbsp;to&nbsp;enable&#34;</span><span class="op" id="8184813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8184818">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8184833">if</span>&nbsp;<span class="ident" id="8184836">c</span><span class="op" id="8184837">,</span>&nbsp;<span class="ident" id="8184839">err</span>&nbsp;<span class="op" id="8184843">:=</span>&nbsp;<span class="ident" id="8184846">d</span><span class="op" id="8184847">.</span><span class="ident" id="8184848">Dial</span><span class="op" id="8184852">(</span><span class="ident" id="8184853">network</span><span class="op" id="8184860">,</span>&nbsp;<span class="string" id="8184862">&#34;www.google.com:http&#34;</span><span class="op" id="8184883">)</span><span class="op" id="8184884">;</span>&nbsp;<span class="ident" id="8184886">err</span>&nbsp;<span class="op" id="8184890">!=</span>&nbsp;<span class="ident" id="8184893">nil</span>&nbsp;<span class="op" id="8184897">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8184902">t</span><span class="op" id="8184903">.</span><span class="ident" id="8184904">Errorf</span><span class="op" id="8184910">(</span><span class="string" id="8184911">&#34;Dial&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8184928">,</span>&nbsp;<span class="ident" id="8184930">err</span><span class="op" id="8184933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184937">}</span>&nbsp;<span class="keyword" id="8184939">else</span>&nbsp;<span class="op" id="8184944">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8184949">c</span><span class="op" id="8184950">.</span><span class="ident" id="8184951">Close</span><span class="op" id="8184956">(</span><span class="op" id="8184957">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184961">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8184964">}</span><br>
<span class="lineno">70</span><span class="op" id="8184966">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8184969">//&nbsp;fd&nbsp;is&nbsp;already&nbsp;connected&nbsp;to&nbsp;the&nbsp;destination,&nbsp;port&nbsp;80.</span><br>
<span class="lineno"></span><span class="comment" id="8185025">//&nbsp;Run&nbsp;an&nbsp;HTTP&nbsp;request&nbsp;to&nbsp;fetch&nbsp;the&nbsp;appropriate&nbsp;page.</span><br>
<span class="lineno"></span><span class="keyword" id="8185079">func</span>&nbsp;<span class="ident" id="8185084">fetchGoogle</span><span class="op" id="8185095">(</span><span class="ident" id="8185096">t</span>&nbsp;<span class="op" id="8185098">*</span><span class="ident" id="8185099">testing</span><span class="op" id="8185106">.</span><span class="ident" id="8185107">T</span><span class="op" id="8185108">,</span>&nbsp;<span class="ident" id="8185110">fd</span>&nbsp;<span class="ident" id="8185113">Conn</span><span class="op" id="8185117">,</span>&nbsp;<span class="ident" id="8185119">network</span><span class="op" id="8185126">,</span>&nbsp;<span class="ident" id="8185128">addr</span>&nbsp;<span class="builtintype" id="8185133">string</span><span class="op" id="8185139">)</span>&nbsp;<span class="op" id="8185141">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8185144">req</span>&nbsp;<span class="op" id="8185148">:=</span>&nbsp;<span class="op" id="8185151">[</span><span class="op" id="8185152">]</span><span class="builtintype" id="8185153">byte</span><span class="op" id="8185157">(</span><span class="string" id="8185158">&#34;GET&nbsp;/robots.txt&nbsp;HTTP/1.0\r\nHost:&nbsp;www.google.com\r\n\r\n&#34;</span><span class="op" id="8185216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8185219">n</span><span class="op" id="8185220">,</span>&nbsp;<span class="ident" id="8185222">err</span>&nbsp;<span class="op" id="8185226">:=</span>&nbsp;<span class="ident" id="8185229">fd</span><span class="op" id="8185231">.</span><span class="ident" id="8185232">Write</span><span class="op" id="8185237">(</span><span class="ident" id="8185238">req</span><span class="op" id="8185241">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8185245">buf</span>&nbsp;<span class="op" id="8185249">:=</span>&nbsp;<span class="builtinfunc" id="8185252">make</span><span class="op" id="8185256">(</span><span class="op" id="8185257">[</span><span class="op" id="8185258">]</span><span class="builtintype" id="8185259">byte</span><span class="op" id="8185263">,</span>&nbsp;<span class="num" id="8185265">1000</span><span class="op" id="8185269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8185272">n</span><span class="op" id="8185273">,</span>&nbsp;<span class="ident" id="8185275">err</span>&nbsp;<span class="op" id="8185279">=</span>&nbsp;<span class="ident" id="8185281">io</span><span class="op" id="8185283">.</span><span class="ident" id="8185284">ReadFull</span><span class="op" id="8185292">(</span><span class="ident" id="8185293">fd</span><span class="op" id="8185295">,</span>&nbsp;<span class="ident" id="8185297">buf</span><span class="op" id="8185300">)</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8185304">if</span>&nbsp;<span class="ident" id="8185307">n</span>&nbsp;<span class="op" id="8185309">&lt;</span>&nbsp;<span class="num" id="8185311">1000</span>&nbsp;<span class="op" id="8185316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8185320">t</span><span class="op" id="8185321">.</span><span class="ident" id="8185322">Errorf</span><span class="op" id="8185328">(</span><span class="string" id="8185329">&#34;fetchGoogle:&nbsp;short&nbsp;HTTP&nbsp;read&nbsp;from&nbsp;%s&nbsp;%s&nbsp;-&nbsp;%v&#34;</span><span class="op" id="8185375">,</span>&nbsp;<span class="ident" id="8185377">network</span><span class="op" id="8185384">,</span>&nbsp;<span class="ident" id="8185386">addr</span><span class="op" id="8185390">,</span>&nbsp;<span class="ident" id="8185392">err</span><span class="op" id="8185395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8185399">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8185407">}</span><br>
<span class="lineno">85</span><span class="op" id="8185409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8185412">func</span>&nbsp;<span class="ident" id="8185417">doDial</span><span class="op" id="8185423">(</span><span class="ident" id="8185424">t</span>&nbsp;<span class="op" id="8185426">*</span><span class="ident" id="8185427">testing</span><span class="op" id="8185434">.</span><span class="ident" id="8185435">T</span><span class="op" id="8185436">,</span>&nbsp;<span class="ident" id="8185438">network</span><span class="op" id="8185445">,</span>&nbsp;<span class="ident" id="8185447">addr</span>&nbsp;<span class="builtintype" id="8185452">string</span><span class="op" id="8185458">)</span>&nbsp;<span class="op" id="8185460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8185463">fd</span><span class="op" id="8185465">,</span>&nbsp;<span class="ident" id="8185467">err</span>&nbsp;<span class="op" id="8185471">:=</span>&nbsp;<span class="ident" id="8185474">Dial</span><span class="op" id="8185478">(</span><span class="ident" id="8185479">network</span><span class="op" id="8185486">,</span>&nbsp;<span class="ident" id="8185488">addr</span><span class="op" id="8185492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8185495">if</span>&nbsp;<span class="ident" id="8185498">err</span>&nbsp;<span class="op" id="8185502">!=</span>&nbsp;<span class="ident" id="8185505">nil</span>&nbsp;<span class="op" id="8185509">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8185513">t</span><span class="op" id="8185514">.</span><span class="ident" id="8185515">Errorf</span><span class="op" id="8185521">(</span><span class="string" id="8185522">&#34;Dial(%q,&nbsp;%q,&nbsp;%q)&nbsp;=&nbsp;_,&nbsp;%v&#34;</span><span class="op" id="8185548">,</span>&nbsp;<span class="ident" id="8185550">network</span><span class="op" id="8185557">,</span>&nbsp;<span class="string" id="8185559">&#34;&#34;</span><span class="op" id="8185561">,</span>&nbsp;<span class="ident" id="8185563">addr</span><span class="op" id="8185567">,</span>&nbsp;<span class="ident" id="8185569">err</span><span class="op" id="8185572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8185576">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8185584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8185587">fetchGoogle</span><span class="op" id="8185598">(</span><span class="ident" id="8185599">t</span><span class="op" id="8185600">,</span>&nbsp;<span class="ident" id="8185602">fd</span><span class="op" id="8185604">,</span>&nbsp;<span class="ident" id="8185606">network</span><span class="op" id="8185613">,</span>&nbsp;<span class="ident" id="8185615">addr</span><span class="op" id="8185619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8185622">fd</span><span class="op" id="8185624">.</span><span class="ident" id="8185625">Close</span><span class="op" id="8185630">(</span><span class="op" id="8185631">)</span><br>
<span class="lineno">95</span><span class="op" id="8185633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8185636">var</span>&nbsp;<span class="ident" id="8185640">googleaddrsipv4</span>&nbsp;<span class="op" id="8185656">=</span>&nbsp;<span class="op" id="8185658">[</span><span class="op" id="8185659">]</span><span class="builtintype" id="8185660">string</span><span class="op" id="8185666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8185669">&#34;%d.%d.%d.%d:80&#34;</span><span class="op" id="8185685">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8185688">&#34;www.google.com:80&#34;</span><span class="op" id="8185707">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8185710">&#34;%d.%d.%d.%d:http&#34;</span><span class="op" id="8185728">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8185731">&#34;www.google.com:http&#34;</span><span class="op" id="8185752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8185755">&#34;%03d.%03d.%03d.%03d:0080&#34;</span><span class="op" id="8185781">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8185784">&#34;[::ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="8185809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8185812">&#34;[::ffff:%02x%02x:%02x%02x]:80&#34;</span><span class="op" id="8185843">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8185846">&#34;[0:0:0:0:0000:ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="8185882">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8185885">&#34;[0:0:0:0:000000:ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="8185923">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8185926">&#34;[0:0:0:0::ffff:%d.%d.%d.%d]:80&#34;</span><span class="op" id="8185958">,</span><br>
<span class="lineno"></span><span class="op" id="8185960">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="keyword" id="8185963">func</span>&nbsp;<span class="ident" id="8185968">TestDialGoogleIPv4</span><span class="op" id="8185986">(</span><span class="ident" id="8185987">t</span>&nbsp;<span class="op" id="8185989">*</span><span class="ident" id="8185990">testing</span><span class="op" id="8185997">.</span><span class="ident" id="8185998">T</span><span class="op" id="8185999">)</span>&nbsp;<span class="op" id="8186001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8186004">if</span>&nbsp;<span class="ident" id="8186007">testing</span><span class="op" id="8186014">.</span><span class="ident" id="8186015">Short</span><span class="op" id="8186020">(</span><span class="op" id="8186021">)</span>&nbsp;<span class="op" id="8186023">||</span>&nbsp;<span class="op" id="8186026">!</span><span class="op" id="8186027">*</span><span class="ident" id="8186028">testExternal</span>&nbsp;<span class="op" id="8186041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8186045">t</span><span class="op" id="8186046">.</span><span class="ident" id="8186047">Skip</span><span class="op" id="8186051">(</span><span class="string" id="8186052">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8186093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8186096">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8186100">//&nbsp;Insert&nbsp;an&nbsp;actual&nbsp;IPv4&nbsp;address&nbsp;for&nbsp;google.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8186149">//&nbsp;into&nbsp;the&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8186169">addrs</span><span class="op" id="8186174">,</span>&nbsp;<span class="ident" id="8186176">err</span>&nbsp;<span class="op" id="8186180">:=</span>&nbsp;<span class="ident" id="8186183">LookupIP</span><span class="op" id="8186191">(</span><span class="string" id="8186192">&#34;www.google.com&#34;</span><span class="op" id="8186208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8186211">if</span>&nbsp;<span class="ident" id="8186214">err</span>&nbsp;<span class="op" id="8186218">!=</span>&nbsp;<span class="ident" id="8186221">nil</span>&nbsp;<span class="op" id="8186225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8186229">t</span><span class="op" id="8186230">.</span><span class="ident" id="8186231">Fatalf</span><span class="op" id="8186237">(</span><span class="string" id="8186238">&#34;lookup&nbsp;www.google.com:&nbsp;%v&#34;</span><span class="op" id="8186265">,</span>&nbsp;<span class="ident" id="8186267">err</span><span class="op" id="8186270">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8186273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8186276">var</span>&nbsp;<span class="ident" id="8186280">ip</span>&nbsp;<span class="ident" id="8186283">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8186287">for</span>&nbsp;<span class="ident" id="8186291">_</span><span class="op" id="8186292">,</span>&nbsp;<span class="ident" id="8186294">addr</span>&nbsp;<span class="op" id="8186299">:=</span>&nbsp;<span class="keyword" id="8186302">range</span>&nbsp;<span class="ident" id="8186308">addrs</span>&nbsp;<span class="op" id="8186314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8186318">if</span>&nbsp;<span class="ident" id="8186321">x</span>&nbsp;<span class="op" id="8186323">:=</span>&nbsp;<span class="ident" id="8186326">addr</span><span class="op" id="8186330">.</span><span class="ident" id="8186331">To4</span><span class="op" id="8186334">(</span><span class="op" id="8186335">)</span><span class="op" id="8186336">;</span>&nbsp;<span class="ident" id="8186338">x</span>&nbsp;<span class="op" id="8186340">!=</span>&nbsp;<span class="ident" id="8186343">nil</span>&nbsp;<span class="op" id="8186347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8186352">ip</span>&nbsp;<span class="op" id="8186355">=</span>&nbsp;<span class="ident" id="8186357">x</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8186362">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8186370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8186373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8186376">if</span>&nbsp;<span class="ident" id="8186379">ip</span>&nbsp;<span class="op" id="8186382">==</span>&nbsp;<span class="ident" id="8186385">nil</span>&nbsp;<span class="op" id="8186389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8186393">t</span><span class="op" id="8186394">.</span><span class="ident" id="8186395">Fatalf</span><span class="op" id="8186401">(</span><span class="string" id="8186402">&#34;no&nbsp;IPv4&nbsp;addresses&nbsp;for&nbsp;www.google.com&#34;</span><span class="op" id="8186440">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8186443">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8186447">for</span>&nbsp;<span class="ident" id="8186451">i</span><span class="op" id="8186452">,</span>&nbsp;<span class="ident" id="8186454">s</span>&nbsp;<span class="op" id="8186456">:=</span>&nbsp;<span class="keyword" id="8186459">range</span>&nbsp;<span class="ident" id="8186465">googleaddrsipv4</span>&nbsp;<span class="op" id="8186481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8186485">if</span>&nbsp;<span class="ident" id="8186488">strings</span><span class="op" id="8186495">.</span><span class="ident" id="8186496">Contains</span><span class="op" id="8186504">(</span><span class="ident" id="8186505">s</span><span class="op" id="8186506">,</span>&nbsp;<span class="string" id="8186508">&#34;%&#34;</span><span class="op" id="8186511">)</span>&nbsp;<span class="op" id="8186513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8186518">googleaddrsipv4</span><span class="op" id="8186533">[</span><span class="ident" id="8186534">i</span><span class="op" id="8186535">]</span>&nbsp;<span class="op" id="8186537">=</span>&nbsp;<span class="ident" id="8186539">fmt</span><span class="op" id="8186542">.</span><span class="ident" id="8186543">Sprintf</span><span class="op" id="8186550">(</span><span class="ident" id="8186551">s</span><span class="op" id="8186552">,</span>&nbsp;<span class="ident" id="8186554">ip</span><span class="op" id="8186556">[</span><span class="num" id="8186557">0</span><span class="op" id="8186558">]</span><span class="op" id="8186559">,</span>&nbsp;<span class="ident" id="8186561">ip</span><span class="op" id="8186563">[</span><span class="num" id="8186564">1</span><span class="op" id="8186565">]</span><span class="op" id="8186566">,</span>&nbsp;<span class="ident" id="8186568">ip</span><span class="op" id="8186570">[</span><span class="num" id="8186571">2</span><span class="op" id="8186572">]</span><span class="op" id="8186573">,</span>&nbsp;<span class="ident" id="8186575">ip</span><span class="op" id="8186577">[</span><span class="num" id="8186578">3</span><span class="op" id="8186579">]</span><span class="op" id="8186580">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8186584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8186587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8186591">for</span>&nbsp;<span class="ident" id="8186595">i</span>&nbsp;<span class="op" id="8186597">:=</span>&nbsp;<span class="num" id="8186600">0</span><span class="op" id="8186601">;</span>&nbsp;<span class="ident" id="8186603">i</span>&nbsp;<span class="op" id="8186605">&lt;</span>&nbsp;<span class="builtinfunc" id="8186607">len</span><span class="op" id="8186610">(</span><span class="ident" id="8186611">googleaddrsipv4</span><span class="op" id="8186626">)</span><span class="op" id="8186627">;</span>&nbsp;<span class="ident" id="8186629">i</span><span class="op" id="8186630">++</span>&nbsp;<span class="op" id="8186633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8186637">addr</span>&nbsp;<span class="op" id="8186642">:=</span>&nbsp;<span class="ident" id="8186645">googleaddrsipv4</span><span class="op" id="8186660">[</span><span class="ident" id="8186661">i</span><span class="op" id="8186662">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8186666">if</span>&nbsp;<span class="ident" id="8186669">addr</span>&nbsp;<span class="op" id="8186674">==</span>&nbsp;<span class="string" id="8186677">&#34;&#34;</span>&nbsp;<span class="op" id="8186680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8186685">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8186696">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8186700">t</span><span class="op" id="8186701">.</span><span class="ident" id="8186702">Logf</span><span class="op" id="8186706">(</span><span class="string" id="8186707">&#34;--&nbsp;%s&nbsp;--&#34;</span><span class="op" id="8186717">,</span>&nbsp;<span class="ident" id="8186719">addr</span><span class="op" id="8186723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8186727">doDial</span><span class="op" id="8186733">(</span><span class="ident" id="8186734">t</span><span class="op" id="8186735">,</span>&nbsp;<span class="string" id="8186737">&#34;tcp&#34;</span><span class="op" id="8186742">,</span>&nbsp;<span class="ident" id="8186744">addr</span><span class="op" id="8186748">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8186752">if</span>&nbsp;<span class="ident" id="8186755">addr</span><span class="op" id="8186759">[</span><span class="num" id="8186760">0</span><span class="op" id="8186761">]</span>&nbsp;<span class="op" id="8186763">!=</span>&nbsp;<span class="string" id="8186766">&#39;[&#39;</span>&nbsp;<span class="op" id="8186770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8186775">doDial</span><span class="op" id="8186781">(</span><span class="ident" id="8186782">t</span><span class="op" id="8186783">,</span>&nbsp;<span class="string" id="8186785">&#34;tcp4&#34;</span><span class="op" id="8186791">,</span>&nbsp;<span class="ident" id="8186793">addr</span><span class="op" id="8186797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8186802">if</span>&nbsp;<span class="ident" id="8186805">supportsIPv6</span>&nbsp;<span class="op" id="8186818">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8186824">//&nbsp;make&nbsp;sure&nbsp;syscall.SocketDisableIPv6&nbsp;flag&nbsp;works.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8186879">syscall</span><span class="op" id="8186886">.</span><span class="ident" id="8186887">SocketDisableIPv6</span>&nbsp;<span class="op" id="8186905">=</span>&nbsp;<span class="builtintype" id="8186907">true</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8186916">doDial</span><span class="op" id="8186922">(</span><span class="ident" id="8186923">t</span><span class="op" id="8186924">,</span>&nbsp;<span class="string" id="8186926">&#34;tcp&#34;</span><span class="op" id="8186931">,</span>&nbsp;<span class="ident" id="8186933">addr</span><span class="op" id="8186937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8186943">doDial</span><span class="op" id="8186949">(</span><span class="ident" id="8186950">t</span><span class="op" id="8186951">,</span>&nbsp;<span class="string" id="8186953">&#34;tcp4&#34;</span><span class="op" id="8186959">,</span>&nbsp;<span class="ident" id="8186961">addr</span><span class="op" id="8186965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8186971">syscall</span><span class="op" id="8186978">.</span><span class="ident" id="8186979">SocketDisableIPv6</span>&nbsp;<span class="op" id="8186997">=</span>&nbsp;<span class="builtintype" id="8186999">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8187008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8187012">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8187015">}</span><br>
<span class="lineno"></span><span class="op" id="8187017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8187020">var</span>&nbsp;<span class="ident" id="8187024">googleaddrsipv6</span>&nbsp;<span class="op" id="8187040">=</span>&nbsp;<span class="op" id="8187042">[</span><span class="op" id="8187043">]</span><span class="builtintype" id="8187044">string</span><span class="op" id="8187050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8187053">&#34;[%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x]:80&#34;</span><span class="op" id="8187131">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8187134">&#34;ipv6.google.com:80&#34;</span><span class="op" id="8187154">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8187157">&#34;[%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x]:http&#34;</span><span class="op" id="8187237">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8187240">&#34;ipv6.google.com:http&#34;</span><span class="op" id="8187262">,</span><br>
<span class="lineno"></span><span class="op" id="8187264">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="8187267">func</span>&nbsp;<span class="ident" id="8187272">TestDialGoogleIPv6</span><span class="op" id="8187290">(</span><span class="ident" id="8187291">t</span>&nbsp;<span class="op" id="8187293">*</span><span class="ident" id="8187294">testing</span><span class="op" id="8187301">.</span><span class="ident" id="8187302">T</span><span class="op" id="8187303">)</span>&nbsp;<span class="op" id="8187305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8187308">if</span>&nbsp;<span class="ident" id="8187311">testing</span><span class="op" id="8187318">.</span><span class="ident" id="8187319">Short</span><span class="op" id="8187324">(</span><span class="op" id="8187325">)</span>&nbsp;<span class="op" id="8187327">||</span>&nbsp;<span class="op" id="8187330">!</span><span class="op" id="8187331">*</span><span class="ident" id="8187332">testExternal</span>&nbsp;<span class="op" id="8187345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8187349">t</span><span class="op" id="8187350">.</span><span class="ident" id="8187351">Skip</span><span class="op" id="8187355">(</span><span class="string" id="8187356">&#34;skipping&nbsp;test&nbsp;to&nbsp;avoid&nbsp;external&nbsp;network&#34;</span><span class="op" id="8187397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8187400">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8187403">//&nbsp;Only&nbsp;run&nbsp;tcp6&nbsp;if&nbsp;the&nbsp;kernel&nbsp;will&nbsp;take&nbsp;it.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8187449">if</span>&nbsp;<span class="op" id="8187452">!</span><span class="ident" id="8187453">supportsIPv6</span>&nbsp;<span class="op" id="8187466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8187470">t</span><span class="op" id="8187471">.</span><span class="ident" id="8187472">Skip</span><span class="op" id="8187476">(</span><span class="string" id="8187477">&#34;skipping&nbsp;test;&nbsp;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="8187515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8187518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8187521">if</span>&nbsp;<span class="op" id="8187524">!</span><span class="op" id="8187525">*</span><span class="ident" id="8187526">testIPv6</span>&nbsp;<span class="op" id="8187535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8187539">t</span><span class="op" id="8187540">.</span><span class="ident" id="8187541">Skip</span><span class="op" id="8187545">(</span><span class="string" id="8187546">&#34;test&nbsp;disabled;&nbsp;use&nbsp;-ipv6&nbsp;to&nbsp;enable&#34;</span><span class="op" id="8187582">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8187585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8187589">//&nbsp;Insert&nbsp;an&nbsp;actual&nbsp;IPv6&nbsp;address&nbsp;for&nbsp;ipv6.google.com</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8187643">//&nbsp;into&nbsp;the&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8187663">addrs</span><span class="op" id="8187668">,</span>&nbsp;<span class="ident" id="8187670">err</span>&nbsp;<span class="op" id="8187674">:=</span>&nbsp;<span class="ident" id="8187677">LookupIP</span><span class="op" id="8187685">(</span><span class="string" id="8187686">&#34;ipv6.google.com&#34;</span><span class="op" id="8187703">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8187706">if</span>&nbsp;<span class="ident" id="8187709">err</span>&nbsp;<span class="op" id="8187713">!=</span>&nbsp;<span class="ident" id="8187716">nil</span>&nbsp;<span class="op" id="8187720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8187724">t</span><span class="op" id="8187725">.</span><span class="ident" id="8187726">Fatalf</span><span class="op" id="8187732">(</span><span class="string" id="8187733">&#34;lookup&nbsp;ipv6.google.com:&nbsp;%v&#34;</span><span class="op" id="8187761">,</span>&nbsp;<span class="ident" id="8187763">err</span><span class="op" id="8187766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8187769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8187772">var</span>&nbsp;<span class="ident" id="8187776">ip</span>&nbsp;<span class="ident" id="8187779">IP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8187783">for</span>&nbsp;<span class="ident" id="8187787">_</span><span class="op" id="8187788">,</span>&nbsp;<span class="ident" id="8187790">addr</span>&nbsp;<span class="op" id="8187795">:=</span>&nbsp;<span class="keyword" id="8187798">range</span>&nbsp;<span class="ident" id="8187804">addrs</span>&nbsp;<span class="op" id="8187810">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8187814">if</span>&nbsp;<span class="ident" id="8187817">x</span>&nbsp;<span class="op" id="8187819">:=</span>&nbsp;<span class="ident" id="8187822">addr</span><span class="op" id="8187826">.</span><span class="ident" id="8187827">To16</span><span class="op" id="8187831">(</span><span class="op" id="8187832">)</span><span class="op" id="8187833">;</span>&nbsp;<span class="ident" id="8187835">x</span>&nbsp;<span class="op" id="8187837">!=</span>&nbsp;<span class="ident" id="8187840">nil</span>&nbsp;<span class="op" id="8187844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8187849">ip</span>&nbsp;<span class="op" id="8187852">=</span>&nbsp;<span class="ident" id="8187854">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8187859">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8187867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8187870">}</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8187873">if</span>&nbsp;<span class="ident" id="8187876">ip</span>&nbsp;<span class="op" id="8187879">==</span>&nbsp;<span class="ident" id="8187882">nil</span>&nbsp;<span class="op" id="8187886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8187890">t</span><span class="op" id="8187891">.</span><span class="ident" id="8187892">Fatalf</span><span class="op" id="8187898">(</span><span class="string" id="8187899">&#34;no&nbsp;IPv6&nbsp;addresses&nbsp;for&nbsp;ipv6.google.com&#34;</span><span class="op" id="8187938">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8187941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8187945">for</span>&nbsp;<span class="ident" id="8187949">i</span><span class="op" id="8187950">,</span>&nbsp;<span class="ident" id="8187952">s</span>&nbsp;<span class="op" id="8187954">:=</span>&nbsp;<span class="keyword" id="8187957">range</span>&nbsp;<span class="ident" id="8187963">googleaddrsipv6</span>&nbsp;<span class="op" id="8187979">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8187983">if</span>&nbsp;<span class="ident" id="8187986">strings</span><span class="op" id="8187993">.</span><span class="ident" id="8187994">Contains</span><span class="op" id="8188002">(</span><span class="ident" id="8188003">s</span><span class="op" id="8188004">,</span>&nbsp;<span class="string" id="8188006">&#34;%&#34;</span><span class="op" id="8188009">)</span>&nbsp;<span class="op" id="8188011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188016">googleaddrsipv6</span><span class="op" id="8188031">[</span><span class="ident" id="8188032">i</span><span class="op" id="8188033">]</span>&nbsp;<span class="op" id="8188035">=</span>&nbsp;<span class="ident" id="8188037">fmt</span><span class="op" id="8188040">.</span><span class="ident" id="8188041">Sprintf</span><span class="op" id="8188048">(</span><span class="ident" id="8188049">s</span><span class="op" id="8188050">,</span>&nbsp;<span class="ident" id="8188052">ip</span><span class="op" id="8188054">[</span><span class="num" id="8188055">0</span><span class="op" id="8188056">]</span><span class="op" id="8188057">,</span>&nbsp;<span class="ident" id="8188059">ip</span><span class="op" id="8188061">[</span><span class="num" id="8188062">1</span><span class="op" id="8188063">]</span><span class="op" id="8188064">,</span>&nbsp;<span class="ident" id="8188066">ip</span><span class="op" id="8188068">[</span><span class="num" id="8188069">2</span><span class="op" id="8188070">]</span><span class="op" id="8188071">,</span>&nbsp;<span class="ident" id="8188073">ip</span><span class="op" id="8188075">[</span><span class="num" id="8188076">3</span><span class="op" id="8188077">]</span><span class="op" id="8188078">,</span>&nbsp;<span class="ident" id="8188080">ip</span><span class="op" id="8188082">[</span><span class="num" id="8188083">4</span><span class="op" id="8188084">]</span><span class="op" id="8188085">,</span>&nbsp;<span class="ident" id="8188087">ip</span><span class="op" id="8188089">[</span><span class="num" id="8188090">5</span><span class="op" id="8188091">]</span><span class="op" id="8188092">,</span>&nbsp;<span class="ident" id="8188094">ip</span><span class="op" id="8188096">[</span><span class="num" id="8188097">6</span><span class="op" id="8188098">]</span><span class="op" id="8188099">,</span>&nbsp;<span class="ident" id="8188101">ip</span><span class="op" id="8188103">[</span><span class="num" id="8188104">7</span><span class="op" id="8188105">]</span><span class="op" id="8188106">,</span>&nbsp;<span class="ident" id="8188108">ip</span><span class="op" id="8188110">[</span><span class="num" id="8188111">8</span><span class="op" id="8188112">]</span><span class="op" id="8188113">,</span>&nbsp;<span class="ident" id="8188115">ip</span><span class="op" id="8188117">[</span><span class="num" id="8188118">9</span><span class="op" id="8188119">]</span><span class="op" id="8188120">,</span>&nbsp;<span class="ident" id="8188122">ip</span><span class="op" id="8188124">[</span><span class="num" id="8188125">10</span><span class="op" id="8188127">]</span><span class="op" id="8188128">,</span>&nbsp;<span class="ident" id="8188130">ip</span><span class="op" id="8188132">[</span><span class="num" id="8188133">11</span><span class="op" id="8188135">]</span><span class="op" id="8188136">,</span>&nbsp;<span class="ident" id="8188138">ip</span><span class="op" id="8188140">[</span><span class="num" id="8188141">12</span><span class="op" id="8188143">]</span><span class="op" id="8188144">,</span>&nbsp;<span class="ident" id="8188146">ip</span><span class="op" id="8188148">[</span><span class="num" id="8188149">13</span><span class="op" id="8188151">]</span><span class="op" id="8188152">,</span>&nbsp;<span class="ident" id="8188154">ip</span><span class="op" id="8188156">[</span><span class="num" id="8188157">14</span><span class="op" id="8188159">]</span><span class="op" id="8188160">,</span>&nbsp;<span class="ident" id="8188162">ip</span><span class="op" id="8188164">[</span><span class="num" id="8188165">15</span><span class="op" id="8188167">]</span><span class="op" id="8188168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8188179">for</span>&nbsp;<span class="ident" id="8188183">i</span>&nbsp;<span class="op" id="8188185">:=</span>&nbsp;<span class="num" id="8188188">0</span><span class="op" id="8188189">;</span>&nbsp;<span class="ident" id="8188191">i</span>&nbsp;<span class="op" id="8188193">&lt;</span>&nbsp;<span class="builtinfunc" id="8188195">len</span><span class="op" id="8188198">(</span><span class="ident" id="8188199">googleaddrsipv6</span><span class="op" id="8188214">)</span><span class="op" id="8188215">;</span>&nbsp;<span class="ident" id="8188217">i</span><span class="op" id="8188218">++</span>&nbsp;<span class="op" id="8188221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188225">addr</span>&nbsp;<span class="op" id="8188230">:=</span>&nbsp;<span class="ident" id="8188233">googleaddrsipv6</span><span class="op" id="8188248">[</span><span class="ident" id="8188249">i</span><span class="op" id="8188250">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8188254">if</span>&nbsp;<span class="ident" id="8188257">addr</span>&nbsp;<span class="op" id="8188262">==</span>&nbsp;<span class="string" id="8188265">&#34;&#34;</span>&nbsp;<span class="op" id="8188268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8188273">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188284">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188288">t</span><span class="op" id="8188289">.</span><span class="ident" id="8188290">Logf</span><span class="op" id="8188294">(</span><span class="string" id="8188295">&#34;--&nbsp;%s&nbsp;--&#34;</span><span class="op" id="8188305">,</span>&nbsp;<span class="ident" id="8188307">addr</span><span class="op" id="8188311">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188315">doDial</span><span class="op" id="8188321">(</span><span class="ident" id="8188322">t</span><span class="op" id="8188323">,</span>&nbsp;<span class="string" id="8188325">&#34;tcp&#34;</span><span class="op" id="8188330">,</span>&nbsp;<span class="ident" id="8188332">addr</span><span class="op" id="8188336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8188340">doDial</span><span class="op" id="8188346">(</span><span class="ident" id="8188347">t</span><span class="op" id="8188348">,</span>&nbsp;<span class="string" id="8188350">&#34;tcp6&#34;</span><span class="op" id="8188356">,</span>&nbsp;<span class="ident" id="8188358">addr</span><span class="op" id="8188362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8188365">}</span><br>
<span class="lineno"></span><span class="op" id="8188367">}</span>
</div>
</body>
</html>
