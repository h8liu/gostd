<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha512</h2>
<ul>
<li><a href="/gostd/crypto/sha512/sha512.go.html">sha512.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512_test.go.html">sha512_test.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512block_decl.go.html">sha512block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4091712">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4091767">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4091821">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4091872">//&nbsp;Package&nbsp;sha512&nbsp;implements&nbsp;the&nbsp;SHA384&nbsp;and&nbsp;SHA512&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4091950">//&nbsp;in&nbsp;FIPS&nbsp;180-2.</span><br>
<span class="lineno"></span><span class="keyword" id="4091968">package</span>&nbsp;<span class="ident" id="4091976">sha512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4091984">import</span>&nbsp;<span class="op" id="4091991">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4091994">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4092004">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4092011">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4092014">func</span>&nbsp;<span class="ident" id="4092019">init</span><span class="op" id="4092023">(</span><span class="op" id="4092024">)</span>&nbsp;<span class="op" id="4092026">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092029">crypto</span><span class="op" id="4092035">.</span><span class="ident" id="4092036">RegisterHash</span><span class="op" id="4092048">(</span><span class="ident" id="4092049">crypto</span><span class="op" id="4092055">.</span><span class="ident" id="4092056">SHA384</span><span class="op" id="4092062">,</span>&nbsp;<span class="ident" id="4092064">New384</span><span class="op" id="4092070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092073">crypto</span><span class="op" id="4092079">.</span><span class="ident" id="4092080">RegisterHash</span><span class="op" id="4092092">(</span><span class="ident" id="4092093">crypto</span><span class="op" id="4092099">.</span><span class="ident" id="4092100">SHA512</span><span class="op" id="4092106">,</span>&nbsp;<span class="ident" id="4092108">New</span><span class="op" id="4092111">)</span><br>
<span class="lineno"></span><span class="op" id="4092113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4092116">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA512&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="4092159">const</span>&nbsp;<span class="ident" id="4092165">Size</span>&nbsp;<span class="op" id="4092170">=</span>&nbsp;<span class="num" id="4092172">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4092176">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA384&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4092219">const</span>&nbsp;<span class="ident" id="4092225">Size384</span>&nbsp;<span class="op" id="4092233">=</span>&nbsp;<span class="num" id="4092235">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4092239">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA512&nbsp;and&nbsp;SHA384&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4092287">const</span>&nbsp;<span class="ident" id="4092293">BlockSize</span>&nbsp;<span class="op" id="4092303">=</span>&nbsp;<span class="num" id="4092305">128</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4092310">const</span>&nbsp;<span class="op" id="4092316">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092319">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092329">=</span>&nbsp;<span class="num" id="4092331">128</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092336">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092346">=</span>&nbsp;<span class="num" id="4092348">0x6a09e667f3bcc908</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092368">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092378">=</span>&nbsp;<span class="num" id="4092380">0xbb67ae8584caa73b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092400">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092410">=</span>&nbsp;<span class="num" id="4092412">0x3c6ef372fe94f82b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092432">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092442">=</span>&nbsp;<span class="num" id="4092444">0xa54ff53a5f1d36f1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092464">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092474">=</span>&nbsp;<span class="num" id="4092476">0x510e527fade682d1</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092496">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092506">=</span>&nbsp;<span class="num" id="4092508">0x9b05688c2b3e6c1f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092528">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092538">=</span>&nbsp;<span class="num" id="4092540">0x1f83d9abfb41bd6b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092560">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092570">=</span>&nbsp;<span class="num" id="4092572">0x5be0cd19137e2179</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092592">init0_384</span>&nbsp;<span class="op" id="4092602">=</span>&nbsp;<span class="num" id="4092604">0xcbbb9d5dc1059ed8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092624">init1_384</span>&nbsp;<span class="op" id="4092634">=</span>&nbsp;<span class="num" id="4092636">0x629a292a367cd507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092656">init2_384</span>&nbsp;<span class="op" id="4092666">=</span>&nbsp;<span class="num" id="4092668">0x9159015a3070dd17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092688">init3_384</span>&nbsp;<span class="op" id="4092698">=</span>&nbsp;<span class="num" id="4092700">0x152fecd8f70e5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092720">init4_384</span>&nbsp;<span class="op" id="4092730">=</span>&nbsp;<span class="num" id="4092732">0x67332667ffc00b31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092752">init5_384</span>&nbsp;<span class="op" id="4092762">=</span>&nbsp;<span class="num" id="4092764">0x8eb44a8768581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092784">init6_384</span>&nbsp;<span class="op" id="4092794">=</span>&nbsp;<span class="num" id="4092796">0xdb0c2e0d64f98fa7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092816">init7_384</span>&nbsp;<span class="op" id="4092826">=</span>&nbsp;<span class="num" id="4092828">0x47b5481dbefa4fa4</span><br>
<span class="lineno"></span><span class="op" id="4092847">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4092850">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4092909">type</span>&nbsp;<span class="ident" id="4092914">digest</span>&nbsp;<span class="keyword" id="4092921">struct</span>&nbsp;<span class="op" id="4092928">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092931">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092937">[</span><span class="num" id="4092938">8</span><span class="op" id="4092939">]</span><span class="ident" id="4092940">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092948">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4092954">[</span><span class="ident" id="4092955">chunk</span><span class="op" id="4092960">]</span><span class="builtintype" id="4092961">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092967">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4092973">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4092978">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4092984">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4092992">is384</span>&nbsp;<span class="builtintype" id="4092998">bool</span>&nbsp;<span class="comment" id="4093003">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-384</span><br>
<span class="lineno">55</span><span class="op" id="4093037">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4093040">func</span>&nbsp;<span class="op" id="4093045">(</span><span class="ident" id="4093046">d</span>&nbsp;<span class="op" id="4093048">*</span><span class="ident" id="4093049">digest</span><span class="op" id="4093055">)</span>&nbsp;<span class="ident" id="4093057">Reset</span><span class="op" id="4093062">(</span><span class="op" id="4093063">)</span>&nbsp;<span class="op" id="4093065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093068">if</span>&nbsp;<span class="op" id="4093071">!</span><span class="ident" id="4093072">d</span><span class="op" id="4093073">.</span><span class="ident" id="4093074">is384</span>&nbsp;<span class="op" id="4093080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093084">d</span><span class="op" id="4093085">.</span><span class="ident" id="4093086">h</span><span class="op" id="4093087">[</span><span class="num" id="4093088">0</span><span class="op" id="4093089">]</span>&nbsp;<span class="op" id="4093091">=</span>&nbsp;<span class="ident" id="4093093">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093101">d</span><span class="op" id="4093102">.</span><span class="ident" id="4093103">h</span><span class="op" id="4093104">[</span><span class="num" id="4093105">1</span><span class="op" id="4093106">]</span>&nbsp;<span class="op" id="4093108">=</span>&nbsp;<span class="ident" id="4093110">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093118">d</span><span class="op" id="4093119">.</span><span class="ident" id="4093120">h</span><span class="op" id="4093121">[</span><span class="num" id="4093122">2</span><span class="op" id="4093123">]</span>&nbsp;<span class="op" id="4093125">=</span>&nbsp;<span class="ident" id="4093127">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093135">d</span><span class="op" id="4093136">.</span><span class="ident" id="4093137">h</span><span class="op" id="4093138">[</span><span class="num" id="4093139">3</span><span class="op" id="4093140">]</span>&nbsp;<span class="op" id="4093142">=</span>&nbsp;<span class="ident" id="4093144">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093152">d</span><span class="op" id="4093153">.</span><span class="ident" id="4093154">h</span><span class="op" id="4093155">[</span><span class="num" id="4093156">4</span><span class="op" id="4093157">]</span>&nbsp;<span class="op" id="4093159">=</span>&nbsp;<span class="ident" id="4093161">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093169">d</span><span class="op" id="4093170">.</span><span class="ident" id="4093171">h</span><span class="op" id="4093172">[</span><span class="num" id="4093173">5</span><span class="op" id="4093174">]</span>&nbsp;<span class="op" id="4093176">=</span>&nbsp;<span class="ident" id="4093178">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093186">d</span><span class="op" id="4093187">.</span><span class="ident" id="4093188">h</span><span class="op" id="4093189">[</span><span class="num" id="4093190">6</span><span class="op" id="4093191">]</span>&nbsp;<span class="op" id="4093193">=</span>&nbsp;<span class="ident" id="4093195">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093203">d</span><span class="op" id="4093204">.</span><span class="ident" id="4093205">h</span><span class="op" id="4093206">[</span><span class="num" id="4093207">7</span><span class="op" id="4093208">]</span>&nbsp;<span class="op" id="4093210">=</span>&nbsp;<span class="ident" id="4093212">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093219">}</span>&nbsp;<span class="keyword" id="4093221">else</span>&nbsp;<span class="op" id="4093226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093230">d</span><span class="op" id="4093231">.</span><span class="ident" id="4093232">h</span><span class="op" id="4093233">[</span><span class="num" id="4093234">0</span><span class="op" id="4093235">]</span>&nbsp;<span class="op" id="4093237">=</span>&nbsp;<span class="ident" id="4093239">init0_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093251">d</span><span class="op" id="4093252">.</span><span class="ident" id="4093253">h</span><span class="op" id="4093254">[</span><span class="num" id="4093255">1</span><span class="op" id="4093256">]</span>&nbsp;<span class="op" id="4093258">=</span>&nbsp;<span class="ident" id="4093260">init1_384</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093272">d</span><span class="op" id="4093273">.</span><span class="ident" id="4093274">h</span><span class="op" id="4093275">[</span><span class="num" id="4093276">2</span><span class="op" id="4093277">]</span>&nbsp;<span class="op" id="4093279">=</span>&nbsp;<span class="ident" id="4093281">init2_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093293">d</span><span class="op" id="4093294">.</span><span class="ident" id="4093295">h</span><span class="op" id="4093296">[</span><span class="num" id="4093297">3</span><span class="op" id="4093298">]</span>&nbsp;<span class="op" id="4093300">=</span>&nbsp;<span class="ident" id="4093302">init3_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093314">d</span><span class="op" id="4093315">.</span><span class="ident" id="4093316">h</span><span class="op" id="4093317">[</span><span class="num" id="4093318">4</span><span class="op" id="4093319">]</span>&nbsp;<span class="op" id="4093321">=</span>&nbsp;<span class="ident" id="4093323">init4_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093335">d</span><span class="op" id="4093336">.</span><span class="ident" id="4093337">h</span><span class="op" id="4093338">[</span><span class="num" id="4093339">5</span><span class="op" id="4093340">]</span>&nbsp;<span class="op" id="4093342">=</span>&nbsp;<span class="ident" id="4093344">init5_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093356">d</span><span class="op" id="4093357">.</span><span class="ident" id="4093358">h</span><span class="op" id="4093359">[</span><span class="num" id="4093360">6</span><span class="op" id="4093361">]</span>&nbsp;<span class="op" id="4093363">=</span>&nbsp;<span class="ident" id="4093365">init6_384</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093377">d</span><span class="op" id="4093378">.</span><span class="ident" id="4093379">h</span><span class="op" id="4093380">[</span><span class="num" id="4093381">7</span><span class="op" id="4093382">]</span>&nbsp;<span class="op" id="4093384">=</span>&nbsp;<span class="ident" id="4093386">init7_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093400">d</span><span class="op" id="4093401">.</span><span class="ident" id="4093402">nx</span>&nbsp;<span class="op" id="4093405">=</span>&nbsp;<span class="num" id="4093407">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093410">d</span><span class="op" id="4093411">.</span><span class="builtinfunc" id="4093412">len</span>&nbsp;<span class="op" id="4093416">=</span>&nbsp;<span class="num" id="4093418">0</span><br>
<span class="lineno"></span><span class="op" id="4093420">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4093423">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA512&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4093485">func</span>&nbsp;<span class="ident" id="4093490">New</span><span class="op" id="4093493">(</span><span class="op" id="4093494">)</span>&nbsp;<span class="ident" id="4093496">hash</span><span class="op" id="4093500">.</span><span class="ident" id="4093501">Hash</span>&nbsp;<span class="op" id="4093506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093509">d</span>&nbsp;<span class="op" id="4093511">:=</span>&nbsp;<span class="builtinfunc" id="4093514">new</span><span class="op" id="4093517">(</span><span class="ident" id="4093518">digest</span><span class="op" id="4093524">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093527">d</span><span class="op" id="4093528">.</span><span class="ident" id="4093529">Reset</span><span class="op" id="4093534">(</span><span class="op" id="4093535">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093538">return</span>&nbsp;<span class="ident" id="4093545">d</span><br>
<span class="lineno"></span><span class="op" id="4093547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4093550">//&nbsp;New384&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA384&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4093615">func</span>&nbsp;<span class="ident" id="4093620">New384</span><span class="op" id="4093626">(</span><span class="op" id="4093627">)</span>&nbsp;<span class="ident" id="4093629">hash</span><span class="op" id="4093633">.</span><span class="ident" id="4093634">Hash</span>&nbsp;<span class="op" id="4093639">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093642">d</span>&nbsp;<span class="op" id="4093644">:=</span>&nbsp;<span class="builtinfunc" id="4093647">new</span><span class="op" id="4093650">(</span><span class="ident" id="4093651">digest</span><span class="op" id="4093657">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093660">d</span><span class="op" id="4093661">.</span><span class="ident" id="4093662">is384</span>&nbsp;<span class="op" id="4093668">=</span>&nbsp;<span class="builtintype" id="4093670">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093676">d</span><span class="op" id="4093677">.</span><span class="ident" id="4093678">Reset</span><span class="op" id="4093683">(</span><span class="op" id="4093684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093687">return</span>&nbsp;<span class="ident" id="4093694">d</span><br>
<span class="lineno"></span><span class="op" id="4093696">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4093699">func</span>&nbsp;<span class="op" id="4093704">(</span><span class="ident" id="4093705">d</span>&nbsp;<span class="op" id="4093707">*</span><span class="ident" id="4093708">digest</span><span class="op" id="4093714">)</span>&nbsp;<span class="ident" id="4093716">Size</span><span class="op" id="4093720">(</span><span class="op" id="4093721">)</span>&nbsp;<span class="builtintype" id="4093723">int</span>&nbsp;<span class="op" id="4093727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093730">if</span>&nbsp;<span class="op" id="4093733">!</span><span class="ident" id="4093734">d</span><span class="op" id="4093735">.</span><span class="ident" id="4093736">is384</span>&nbsp;<span class="op" id="4093742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093746">return</span>&nbsp;<span class="ident" id="4093753">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4093759">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093762">return</span>&nbsp;<span class="ident" id="4093769">Size384</span><br>
<span class="lineno"></span><span class="op" id="4093777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4093780">func</span>&nbsp;<span class="op" id="4093785">(</span><span class="ident" id="4093786">d</span>&nbsp;<span class="op" id="4093788">*</span><span class="ident" id="4093789">digest</span><span class="op" id="4093795">)</span>&nbsp;<span class="ident" id="4093797">BlockSize</span><span class="op" id="4093806">(</span><span class="op" id="4093807">)</span>&nbsp;<span class="builtintype" id="4093809">int</span>&nbsp;<span class="op" id="4093813">{</span>&nbsp;<span class="keyword" id="4093815">return</span>&nbsp;<span class="ident" id="4093822">BlockSize</span>&nbsp;<span class="op" id="4093832">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="4093835">func</span>&nbsp;<span class="op" id="4093840">(</span><span class="ident" id="4093841">d</span>&nbsp;<span class="op" id="4093843">*</span><span class="ident" id="4093844">digest</span><span class="op" id="4093850">)</span>&nbsp;<span class="ident" id="4093852">Write</span><span class="op" id="4093857">(</span><span class="ident" id="4093858">p</span>&nbsp;<span class="op" id="4093860">[</span><span class="op" id="4093861">]</span><span class="builtintype" id="4093862">byte</span><span class="op" id="4093866">)</span>&nbsp;<span class="op" id="4093868">(</span><span class="ident" id="4093869">nn</span>&nbsp;<span class="builtintype" id="4093872">int</span><span class="op" id="4093875">,</span>&nbsp;<span class="ident" id="4093877">err</span>&nbsp;<span class="builtintype" id="4093881">error</span><span class="op" id="4093886">)</span>&nbsp;<span class="op" id="4093888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093891">nn</span>&nbsp;<span class="op" id="4093894">=</span>&nbsp;<span class="builtinfunc" id="4093896">len</span><span class="op" id="4093899">(</span><span class="ident" id="4093900">p</span><span class="op" id="4093901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093904">d</span><span class="op" id="4093905">.</span><span class="builtinfunc" id="4093906">len</span>&nbsp;<span class="op" id="4093910">+=</span>&nbsp;<span class="ident" id="4093913">uint64</span><span class="op" id="4093919">(</span><span class="ident" id="4093920">nn</span><span class="op" id="4093922">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093925">if</span>&nbsp;<span class="ident" id="4093928">d</span><span class="op" id="4093929">.</span><span class="ident" id="4093930">nx</span>&nbsp;<span class="op" id="4093933">&gt;</span>&nbsp;<span class="num" id="4093935">0</span>&nbsp;<span class="op" id="4093937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093941">n</span>&nbsp;<span class="op" id="4093943">:=</span>&nbsp;<span class="builtinfunc" id="4093946">copy</span><span class="op" id="4093950">(</span><span class="ident" id="4093951">d</span><span class="op" id="4093952">.</span><span class="ident" id="4093953">x</span><span class="op" id="4093954">[</span><span class="ident" id="4093955">d</span><span class="op" id="4093956">.</span><span class="ident" id="4093957">nx</span><span class="op" id="4093959">:</span><span class="op" id="4093960">]</span><span class="op" id="4093961">,</span>&nbsp;<span class="ident" id="4093963">p</span><span class="op" id="4093964">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4093968">d</span><span class="op" id="4093969">.</span><span class="ident" id="4093970">nx</span>&nbsp;<span class="op" id="4093973">+=</span>&nbsp;<span class="ident" id="4093976">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4093980">if</span>&nbsp;<span class="ident" id="4093983">d</span><span class="op" id="4093984">.</span><span class="ident" id="4093985">nx</span>&nbsp;<span class="op" id="4093988">==</span>&nbsp;<span class="ident" id="4093991">chunk</span>&nbsp;<span class="op" id="4093997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094002">block</span><span class="op" id="4094007">(</span><span class="ident" id="4094008">d</span><span class="op" id="4094009">,</span>&nbsp;<span class="ident" id="4094011">d</span><span class="op" id="4094012">.</span><span class="ident" id="4094013">x</span><span class="op" id="4094014">[</span><span class="op" id="4094015">:</span><span class="op" id="4094016">]</span><span class="op" id="4094017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094022">d</span><span class="op" id="4094023">.</span><span class="ident" id="4094024">nx</span>&nbsp;<span class="op" id="4094027">=</span>&nbsp;<span class="num" id="4094029">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094033">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094037">p</span>&nbsp;<span class="op" id="4094039">=</span>&nbsp;<span class="ident" id="4094041">p</span><span class="op" id="4094042">[</span><span class="ident" id="4094043">n</span><span class="op" id="4094044">:</span><span class="op" id="4094045">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094051">if</span>&nbsp;<span class="builtinfunc" id="4094054">len</span><span class="op" id="4094057">(</span><span class="ident" id="4094058">p</span><span class="op" id="4094059">)</span>&nbsp;<span class="op" id="4094061">&gt;=</span>&nbsp;<span class="ident" id="4094064">chunk</span>&nbsp;<span class="op" id="4094070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094074">n</span>&nbsp;<span class="op" id="4094076">:=</span>&nbsp;<span class="builtinfunc" id="4094079">len</span><span class="op" id="4094082">(</span><span class="ident" id="4094083">p</span><span class="op" id="4094084">)</span>&nbsp;<span class="op" id="4094086">&amp;^</span>&nbsp;<span class="op" id="4094089">(</span><span class="ident" id="4094090">chunk</span>&nbsp;<span class="op" id="4094096">-</span>&nbsp;<span class="num" id="4094098">1</span><span class="op" id="4094099">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094103">block</span><span class="op" id="4094108">(</span><span class="ident" id="4094109">d</span><span class="op" id="4094110">,</span>&nbsp;<span class="ident" id="4094112">p</span><span class="op" id="4094113">[</span><span class="op" id="4094114">:</span><span class="ident" id="4094115">n</span><span class="op" id="4094116">]</span><span class="op" id="4094117">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094121">p</span>&nbsp;<span class="op" id="4094123">=</span>&nbsp;<span class="ident" id="4094125">p</span><span class="op" id="4094126">[</span><span class="ident" id="4094127">n</span><span class="op" id="4094128">:</span><span class="op" id="4094129">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094132">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094135">if</span>&nbsp;<span class="builtinfunc" id="4094138">len</span><span class="op" id="4094141">(</span><span class="ident" id="4094142">p</span><span class="op" id="4094143">)</span>&nbsp;<span class="op" id="4094145">&gt;</span>&nbsp;<span class="num" id="4094147">0</span>&nbsp;<span class="op" id="4094149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094153">d</span><span class="op" id="4094154">.</span><span class="ident" id="4094155">nx</span>&nbsp;<span class="op" id="4094158">=</span>&nbsp;<span class="builtinfunc" id="4094160">copy</span><span class="op" id="4094164">(</span><span class="ident" id="4094165">d</span><span class="op" id="4094166">.</span><span class="ident" id="4094167">x</span><span class="op" id="4094168">[</span><span class="op" id="4094169">:</span><span class="op" id="4094170">]</span><span class="op" id="4094171">,</span>&nbsp;<span class="ident" id="4094173">p</span><span class="op" id="4094174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094177">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094180">return</span><br>
<span class="lineno"></span><span class="op" id="4094187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4094190">func</span>&nbsp;<span class="op" id="4094195">(</span><span class="ident" id="4094196">d0</span>&nbsp;<span class="op" id="4094199">*</span><span class="ident" id="4094200">digest</span><span class="op" id="4094206">)</span>&nbsp;<span class="ident" id="4094208">Sum</span><span class="op" id="4094211">(</span><span class="ident" id="4094212">in</span>&nbsp;<span class="op" id="4094215">[</span><span class="op" id="4094216">]</span><span class="builtintype" id="4094217">byte</span><span class="op" id="4094221">)</span>&nbsp;<span class="op" id="4094223">[</span><span class="op" id="4094224">]</span><span class="builtintype" id="4094225">byte</span>&nbsp;<span class="op" id="4094230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4094233">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094300">d</span>&nbsp;<span class="op" id="4094302">:=</span>&nbsp;<span class="builtinfunc" id="4094305">new</span><span class="op" id="4094308">(</span><span class="ident" id="4094309">digest</span><span class="op" id="4094315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094318">*</span><span class="ident" id="4094319">d</span>&nbsp;<span class="op" id="4094321">=</span>&nbsp;<span class="op" id="4094323">*</span><span class="ident" id="4094324">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094328">hash</span>&nbsp;<span class="op" id="4094333">:=</span>&nbsp;<span class="ident" id="4094336">d</span><span class="op" id="4094337">.</span><span class="ident" id="4094338">checkSum</span><span class="op" id="4094346">(</span><span class="op" id="4094347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094350">if</span>&nbsp;<span class="ident" id="4094353">d</span><span class="op" id="4094354">.</span><span class="ident" id="4094355">is384</span>&nbsp;<span class="op" id="4094361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094365">return</span>&nbsp;<span class="builtinfunc" id="4094372">append</span><span class="op" id="4094378">(</span><span class="ident" id="4094379">in</span><span class="op" id="4094381">,</span>&nbsp;<span class="ident" id="4094383">hash</span><span class="op" id="4094387">[</span><span class="op" id="4094388">:</span><span class="ident" id="4094389">Size384</span><span class="op" id="4094396">]</span><span class="op" id="4094397">...</span><span class="op" id="4094400">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094403">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094406">return</span>&nbsp;<span class="builtinfunc" id="4094413">append</span><span class="op" id="4094419">(</span><span class="ident" id="4094420">in</span><span class="op" id="4094422">,</span>&nbsp;<span class="ident" id="4094424">hash</span><span class="op" id="4094428">[</span><span class="op" id="4094429">:</span><span class="op" id="4094430">]</span><span class="op" id="4094431">...</span><span class="op" id="4094434">)</span><br>
<span class="lineno"></span><span class="op" id="4094436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4094439">func</span>&nbsp;<span class="op" id="4094444">(</span><span class="ident" id="4094445">d</span>&nbsp;<span class="op" id="4094447">*</span><span class="ident" id="4094448">digest</span><span class="op" id="4094454">)</span>&nbsp;<span class="ident" id="4094456">checkSum</span><span class="op" id="4094464">(</span><span class="op" id="4094465">)</span>&nbsp;<span class="op" id="4094467">[</span><span class="ident" id="4094468">Size</span><span class="op" id="4094472">]</span><span class="builtintype" id="4094473">byte</span>&nbsp;<span class="op" id="4094478">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4094481">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;112&nbsp;bytes&nbsp;mod&nbsp;128.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4094543">len</span>&nbsp;<span class="op" id="4094547">:=</span>&nbsp;<span class="ident" id="4094550">d</span><span class="op" id="4094551">.</span><span class="builtinfunc" id="4094552">len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094557">var</span>&nbsp;<span class="ident" id="4094561">tmp</span>&nbsp;<span class="op" id="4094565">[</span><span class="num" id="4094566">128</span><span class="op" id="4094569">]</span><span class="builtintype" id="4094570">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094576">tmp</span><span class="op" id="4094579">[</span><span class="num" id="4094580">0</span><span class="op" id="4094581">]</span>&nbsp;<span class="op" id="4094583">=</span>&nbsp;<span class="num" id="4094585">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094591">if</span>&nbsp;<span class="builtinfunc" id="4094594">len</span><span class="op" id="4094597">%</span><span class="num" id="4094598">128</span>&nbsp;<span class="op" id="4094602">&lt;</span>&nbsp;<span class="num" id="4094604">112</span>&nbsp;<span class="op" id="4094608">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094612">d</span><span class="op" id="4094613">.</span><span class="ident" id="4094614">Write</span><span class="op" id="4094619">(</span><span class="ident" id="4094620">tmp</span><span class="op" id="4094623">[</span><span class="num" id="4094624">0</span>&nbsp;<span class="op" id="4094626">:</span>&nbsp;<span class="num" id="4094628">112</span><span class="op" id="4094631">-</span><span class="builtinfunc" id="4094632">len</span><span class="op" id="4094635">%</span><span class="num" id="4094636">128</span><span class="op" id="4094639">]</span><span class="op" id="4094640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094643">}</span>&nbsp;<span class="keyword" id="4094645">else</span>&nbsp;<span class="op" id="4094650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094654">d</span><span class="op" id="4094655">.</span><span class="ident" id="4094656">Write</span><span class="op" id="4094661">(</span><span class="ident" id="4094662">tmp</span><span class="op" id="4094665">[</span><span class="num" id="4094666">0</span>&nbsp;<span class="op" id="4094668">:</span>&nbsp;<span class="num" id="4094670">128</span><span class="op" id="4094673">+</span><span class="num" id="4094674">112</span><span class="op" id="4094677">-</span><span class="builtinfunc" id="4094678">len</span><span class="op" id="4094681">%</span><span class="num" id="4094682">128</span><span class="op" id="4094685">]</span><span class="op" id="4094686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4094693">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4094713">len</span>&nbsp;<span class="op" id="4094717">&lt;&lt;=</span>&nbsp;<span class="num" id="4094721">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094724">for</span>&nbsp;<span class="ident" id="4094728">i</span>&nbsp;<span class="op" id="4094730">:=</span>&nbsp;<span class="builtintype" id="4094733">uint</span><span class="op" id="4094737">(</span><span class="num" id="4094738">0</span><span class="op" id="4094739">)</span><span class="op" id="4094740">;</span>&nbsp;<span class="ident" id="4094742">i</span>&nbsp;<span class="op" id="4094744">&lt;</span>&nbsp;<span class="num" id="4094746">16</span><span class="op" id="4094748">;</span>&nbsp;<span class="ident" id="4094750">i</span><span class="op" id="4094751">++</span>&nbsp;<span class="op" id="4094754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094758">tmp</span><span class="op" id="4094761">[</span><span class="ident" id="4094762">i</span><span class="op" id="4094763">]</span>&nbsp;<span class="op" id="4094765">=</span>&nbsp;<span class="builtintype" id="4094767">byte</span><span class="op" id="4094771">(</span><span class="builtinfunc" id="4094772">len</span>&nbsp;<span class="op" id="4094776">&gt;&gt;</span>&nbsp;<span class="op" id="4094779">(</span><span class="num" id="4094780">120</span>&nbsp;<span class="op" id="4094784">-</span>&nbsp;<span class="num" id="4094786">8</span><span class="op" id="4094787">*</span><span class="ident" id="4094788">i</span><span class="op" id="4094789">)</span><span class="op" id="4094790">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094793">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094796">d</span><span class="op" id="4094797">.</span><span class="ident" id="4094798">Write</span><span class="op" id="4094803">(</span><span class="ident" id="4094804">tmp</span><span class="op" id="4094807">[</span><span class="num" id="4094808">0</span><span class="op" id="4094809">:</span><span class="num" id="4094810">16</span><span class="op" id="4094812">]</span><span class="op" id="4094813">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094817">if</span>&nbsp;<span class="ident" id="4094820">d</span><span class="op" id="4094821">.</span><span class="ident" id="4094822">nx</span>&nbsp;<span class="op" id="4094825">!=</span>&nbsp;<span class="num" id="4094828">0</span>&nbsp;<span class="op" id="4094830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4094834">panic</span><span class="op" id="4094839">(</span><span class="string" id="4094840">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4094851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094854">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094858">h</span>&nbsp;<span class="op" id="4094860">:=</span>&nbsp;<span class="ident" id="4094863">d</span><span class="op" id="4094864">.</span><span class="ident" id="4094865">h</span><span class="op" id="4094866">[</span><span class="op" id="4094867">:</span><span class="op" id="4094868">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094871">if</span>&nbsp;<span class="ident" id="4094874">d</span><span class="op" id="4094875">.</span><span class="ident" id="4094876">is384</span>&nbsp;<span class="op" id="4094882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094886">h</span>&nbsp;<span class="op" id="4094888">=</span>&nbsp;<span class="ident" id="4094890">d</span><span class="op" id="4094891">.</span><span class="ident" id="4094892">h</span><span class="op" id="4094893">[</span><span class="op" id="4094894">:</span><span class="num" id="4094895">6</span><span class="op" id="4094896">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4094899">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094903">var</span>&nbsp;<span class="ident" id="4094907">digest</span>&nbsp;<span class="op" id="4094914">[</span><span class="ident" id="4094915">Size</span><span class="op" id="4094919">]</span><span class="builtintype" id="4094920">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4094926">for</span>&nbsp;<span class="ident" id="4094930">i</span><span class="op" id="4094931">,</span>&nbsp;<span class="ident" id="4094933">s</span>&nbsp;<span class="op" id="4094935">:=</span>&nbsp;<span class="keyword" id="4094938">range</span>&nbsp;<span class="ident" id="4094944">h</span>&nbsp;<span class="op" id="4094946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094950">digest</span><span class="op" id="4094956">[</span><span class="ident" id="4094957">i</span><span class="op" id="4094958">*</span><span class="num" id="4094959">8</span><span class="op" id="4094960">]</span>&nbsp;<span class="op" id="4094962">=</span>&nbsp;<span class="builtintype" id="4094964">byte</span><span class="op" id="4094968">(</span><span class="ident" id="4094969">s</span>&nbsp;<span class="op" id="4094971">&gt;&gt;</span>&nbsp;<span class="num" id="4094974">56</span><span class="op" id="4094976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4094980">digest</span><span class="op" id="4094986">[</span><span class="ident" id="4094987">i</span><span class="op" id="4094988">*</span><span class="num" id="4094989">8</span><span class="op" id="4094990">+</span><span class="num" id="4094991">1</span><span class="op" id="4094992">]</span>&nbsp;<span class="op" id="4094994">=</span>&nbsp;<span class="builtintype" id="4094996">byte</span><span class="op" id="4095000">(</span><span class="ident" id="4095001">s</span>&nbsp;<span class="op" id="4095003">&gt;&gt;</span>&nbsp;<span class="num" id="4095006">48</span><span class="op" id="4095008">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095012">digest</span><span class="op" id="4095018">[</span><span class="ident" id="4095019">i</span><span class="op" id="4095020">*</span><span class="num" id="4095021">8</span><span class="op" id="4095022">+</span><span class="num" id="4095023">2</span><span class="op" id="4095024">]</span>&nbsp;<span class="op" id="4095026">=</span>&nbsp;<span class="builtintype" id="4095028">byte</span><span class="op" id="4095032">(</span><span class="ident" id="4095033">s</span>&nbsp;<span class="op" id="4095035">&gt;&gt;</span>&nbsp;<span class="num" id="4095038">40</span><span class="op" id="4095040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095044">digest</span><span class="op" id="4095050">[</span><span class="ident" id="4095051">i</span><span class="op" id="4095052">*</span><span class="num" id="4095053">8</span><span class="op" id="4095054">+</span><span class="num" id="4095055">3</span><span class="op" id="4095056">]</span>&nbsp;<span class="op" id="4095058">=</span>&nbsp;<span class="builtintype" id="4095060">byte</span><span class="op" id="4095064">(</span><span class="ident" id="4095065">s</span>&nbsp;<span class="op" id="4095067">&gt;&gt;</span>&nbsp;<span class="num" id="4095070">32</span><span class="op" id="4095072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095076">digest</span><span class="op" id="4095082">[</span><span class="ident" id="4095083">i</span><span class="op" id="4095084">*</span><span class="num" id="4095085">8</span><span class="op" id="4095086">+</span><span class="num" id="4095087">4</span><span class="op" id="4095088">]</span>&nbsp;<span class="op" id="4095090">=</span>&nbsp;<span class="builtintype" id="4095092">byte</span><span class="op" id="4095096">(</span><span class="ident" id="4095097">s</span>&nbsp;<span class="op" id="4095099">&gt;&gt;</span>&nbsp;<span class="num" id="4095102">24</span><span class="op" id="4095104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095108">digest</span><span class="op" id="4095114">[</span><span class="ident" id="4095115">i</span><span class="op" id="4095116">*</span><span class="num" id="4095117">8</span><span class="op" id="4095118">+</span><span class="num" id="4095119">5</span><span class="op" id="4095120">]</span>&nbsp;<span class="op" id="4095122">=</span>&nbsp;<span class="builtintype" id="4095124">byte</span><span class="op" id="4095128">(</span><span class="ident" id="4095129">s</span>&nbsp;<span class="op" id="4095131">&gt;&gt;</span>&nbsp;<span class="num" id="4095134">16</span><span class="op" id="4095136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095140">digest</span><span class="op" id="4095146">[</span><span class="ident" id="4095147">i</span><span class="op" id="4095148">*</span><span class="num" id="4095149">8</span><span class="op" id="4095150">+</span><span class="num" id="4095151">6</span><span class="op" id="4095152">]</span>&nbsp;<span class="op" id="4095154">=</span>&nbsp;<span class="builtintype" id="4095156">byte</span><span class="op" id="4095160">(</span><span class="ident" id="4095161">s</span>&nbsp;<span class="op" id="4095163">&gt;&gt;</span>&nbsp;<span class="num" id="4095166">8</span><span class="op" id="4095167">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095171">digest</span><span class="op" id="4095177">[</span><span class="ident" id="4095178">i</span><span class="op" id="4095179">*</span><span class="num" id="4095180">8</span><span class="op" id="4095181">+</span><span class="num" id="4095182">7</span><span class="op" id="4095183">]</span>&nbsp;<span class="op" id="4095185">=</span>&nbsp;<span class="builtintype" id="4095187">byte</span><span class="op" id="4095191">(</span><span class="ident" id="4095192">s</span><span class="op" id="4095193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4095196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095200">return</span>&nbsp;<span class="ident" id="4095207">digest</span><br>
<span class="lineno"></span><span class="op" id="4095214">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="4095217">//&nbsp;Sum512&nbsp;returns&nbsp;the&nbsp;SHA512&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="4095268">func</span>&nbsp;<span class="ident" id="4095273">Sum512</span><span class="op" id="4095279">(</span><span class="ident" id="4095280">data</span>&nbsp;<span class="op" id="4095285">[</span><span class="op" id="4095286">]</span><span class="builtintype" id="4095287">byte</span><span class="op" id="4095291">)</span>&nbsp;<span class="op" id="4095293">[</span><span class="ident" id="4095294">Size</span><span class="op" id="4095298">]</span><span class="builtintype" id="4095299">byte</span>&nbsp;<span class="op" id="4095304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095307">var</span>&nbsp;<span class="ident" id="4095311">d</span>&nbsp;<span class="ident" id="4095313">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095321">d</span><span class="op" id="4095322">.</span><span class="ident" id="4095323">Reset</span><span class="op" id="4095328">(</span><span class="op" id="4095329">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095332">d</span><span class="op" id="4095333">.</span><span class="ident" id="4095334">Write</span><span class="op" id="4095339">(</span><span class="ident" id="4095340">data</span><span class="op" id="4095344">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095347">return</span>&nbsp;<span class="ident" id="4095354">d</span><span class="op" id="4095355">.</span><span class="ident" id="4095356">checkSum</span><span class="op" id="4095364">(</span><span class="op" id="4095365">)</span><br>
<span class="lineno"></span><span class="op" id="4095367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4095370">//&nbsp;Sum384&nbsp;returns&nbsp;the&nbsp;SHA384&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">190</span><span class="keyword" id="4095421">func</span>&nbsp;<span class="ident" id="4095426">Sum384</span><span class="op" id="4095432">(</span><span class="ident" id="4095433">data</span>&nbsp;<span class="op" id="4095438">[</span><span class="op" id="4095439">]</span><span class="builtintype" id="4095440">byte</span><span class="op" id="4095444">)</span>&nbsp;<span class="op" id="4095446">(</span><span class="ident" id="4095447">sum384</span>&nbsp;<span class="op" id="4095454">[</span><span class="ident" id="4095455">Size384</span><span class="op" id="4095462">]</span><span class="builtintype" id="4095463">byte</span><span class="op" id="4095467">)</span>&nbsp;<span class="op" id="4095469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095472">var</span>&nbsp;<span class="ident" id="4095476">d</span>&nbsp;<span class="ident" id="4095478">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095486">d</span><span class="op" id="4095487">.</span><span class="ident" id="4095488">is384</span>&nbsp;<span class="op" id="4095494">=</span>&nbsp;<span class="builtintype" id="4095496">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095502">d</span><span class="op" id="4095503">.</span><span class="ident" id="4095504">Reset</span><span class="op" id="4095509">(</span><span class="op" id="4095510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095513">d</span><span class="op" id="4095514">.</span><span class="ident" id="4095515">Write</span><span class="op" id="4095520">(</span><span class="ident" id="4095521">data</span><span class="op" id="4095525">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4095528">sum</span>&nbsp;<span class="op" id="4095532">:=</span>&nbsp;<span class="ident" id="4095535">d</span><span class="op" id="4095536">.</span><span class="ident" id="4095537">checkSum</span><span class="op" id="4095545">(</span><span class="op" id="4095546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4095549">copy</span><span class="op" id="4095553">(</span><span class="ident" id="4095554">sum384</span><span class="op" id="4095560">[</span><span class="op" id="4095561">:</span><span class="op" id="4095562">]</span><span class="op" id="4095563">,</span>&nbsp;<span class="ident" id="4095565">sum</span><span class="op" id="4095568">[</span><span class="op" id="4095569">:</span><span class="ident" id="4095570">Size384</span><span class="op" id="4095577">]</span><span class="op" id="4095578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4095581">return</span><br>
<span class="lineno"></span><span class="op" id="4095588">}</span>
</div>
</body>
</html>
