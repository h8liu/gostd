<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html" class="current">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3917701">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3917756">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3917810">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3917861">package</span>&nbsp;<span class="ident" id="3917869">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3917875">import</span>&nbsp;<span class="op" id="3917882">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3917885">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3917901">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3917920">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3917937">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3917947">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3917954">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="3917965">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="3917968">const</span>&nbsp;<span class="ident" id="3917974">ecPrivKeyVersion</span>&nbsp;<span class="op" id="3917991">=</span>&nbsp;<span class="num" id="3917993">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3917996">//&nbsp;ecPrivateKey&nbsp;reflects&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="3918068">//&nbsp;References:</span><br>
<span class="lineno">20</span><span class="comment" id="3918083">//&nbsp;&nbsp;&nbsp;RFC5915</span><br>
<span class="lineno"></span><span class="comment" id="3918096">//&nbsp;&nbsp;&nbsp;SEC1&nbsp;-&nbsp;http://www.secg.org/download/aid-780/sec1-v2.pdf</span><br>
<span class="lineno"></span><span class="comment" id="3918157">//&nbsp;Per&nbsp;RFC5915&nbsp;the&nbsp;NamedCurveOID&nbsp;is&nbsp;marked&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL,&nbsp;however&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3918230">//&nbsp;most&nbsp;cases&nbsp;it&nbsp;is&nbsp;not.</span><br>
<span class="lineno"></span><span class="keyword" id="3918255">type</span>&nbsp;<span class="ident" id="3918260">ecPrivateKey</span>&nbsp;<span class="keyword" id="3918273">struct</span>&nbsp;<span class="op" id="3918280">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3918283">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3918297">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3918302">PrivateKey</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3918316">[</span><span class="op" id="3918317">]</span><span class="builtintype" id="3918318">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3918324">NamedCurveOID</span>&nbsp;<span class="ident" id="3918338">asn1</span><span class="op" id="3918342">.</span><span class="ident" id="3918343">ObjectIdentifier</span>&nbsp;<span class="string" id="3918360">`asn1:&#34;optional,explicit,tag:0&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3918394">PublicKey</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3918408">asn1</span><span class="op" id="3918412">.</span><span class="ident" id="3918413">BitString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3918430">`asn1:&#34;optional,explicit,tag:1&#34;`</span><br>
<span class="lineno"></span><span class="op" id="3918463">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="3918466">//&nbsp;ParseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="keyword" id="3918541">func</span>&nbsp;<span class="ident" id="3918546">ParseECPrivateKey</span><span class="op" id="3918563">(</span><span class="ident" id="3918564">der</span>&nbsp;<span class="op" id="3918568">[</span><span class="op" id="3918569">]</span><span class="builtintype" id="3918570">byte</span><span class="op" id="3918574">)</span>&nbsp;<span class="op" id="3918576">(</span><span class="ident" id="3918577">key</span>&nbsp;<span class="op" id="3918581">*</span><span class="ident" id="3918582">ecdsa</span><span class="op" id="3918587">.</span><span class="ident" id="3918588">PrivateKey</span><span class="op" id="3918598">,</span>&nbsp;<span class="ident" id="3918600">err</span>&nbsp;<span class="builtintype" id="3918604">error</span><span class="op" id="3918609">)</span>&nbsp;<span class="op" id="3918611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3918614">return</span>&nbsp;<span class="ident" id="3918621">parseECPrivateKey</span><span class="op" id="3918638">(</span><span class="builtintype" id="3918639">nil</span><span class="op" id="3918642">,</span>&nbsp;<span class="ident" id="3918644">der</span><span class="op" id="3918647">)</span><br>
<span class="lineno"></span><span class="op" id="3918649">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="3918652">//&nbsp;MarshalECPrivateKey&nbsp;marshals&nbsp;an&nbsp;EC&nbsp;private&nbsp;key&nbsp;into&nbsp;ASN.1,&nbsp;DER&nbsp;format.</span><br>
<span class="lineno"></span><span class="keyword" id="3918726">func</span>&nbsp;<span class="ident" id="3918731">MarshalECPrivateKey</span><span class="op" id="3918750">(</span><span class="ident" id="3918751">key</span>&nbsp;<span class="op" id="3918755">*</span><span class="ident" id="3918756">ecdsa</span><span class="op" id="3918761">.</span><span class="ident" id="3918762">PrivateKey</span><span class="op" id="3918772">)</span>&nbsp;<span class="op" id="3918774">(</span><span class="op" id="3918775">[</span><span class="op" id="3918776">]</span><span class="builtintype" id="3918777">byte</span><span class="op" id="3918781">,</span>&nbsp;<span class="builtintype" id="3918783">error</span><span class="op" id="3918788">)</span>&nbsp;<span class="op" id="3918790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3918793">oid</span><span class="op" id="3918796">,</span>&nbsp;<span class="ident" id="3918798">ok</span>&nbsp;<span class="op" id="3918801">:=</span>&nbsp;<span class="ident" id="3918804">oidFromNamedCurve</span><span class="op" id="3918821">(</span><span class="ident" id="3918822">key</span><span class="op" id="3918825">.</span><span class="ident" id="3918826">Curve</span><span class="op" id="3918831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3918834">if</span>&nbsp;<span class="op" id="3918837">!</span><span class="ident" id="3918838">ok</span>&nbsp;<span class="op" id="3918841">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3918845">return</span>&nbsp;<span class="builtintype" id="3918852">nil</span><span class="op" id="3918855">,</span>&nbsp;<span class="ident" id="3918857">errors</span><span class="op" id="3918863">.</span><span class="ident" id="3918864">New</span><span class="op" id="3918867">(</span><span class="string" id="3918868">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="3918898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3918901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3918904">return</span>&nbsp;<span class="ident" id="3918911">asn1</span><span class="op" id="3918915">.</span><span class="ident" id="3918916">Marshal</span><span class="op" id="3918923">(</span><span class="ident" id="3918924">ecPrivateKey</span><span class="op" id="3918936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3918940">Version</span><span class="op" id="3918947">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="3918955">1</span><span class="op" id="3918956">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3918960">PrivateKey</span><span class="op" id="3918970">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3918975">key</span><span class="op" id="3918978">.</span><span class="ident" id="3918979">D</span><span class="op" id="3918980">.</span><span class="ident" id="3918981">Bytes</span><span class="op" id="3918986">(</span><span class="op" id="3918987">)</span><span class="op" id="3918988">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3918992">NamedCurveOID</span><span class="op" id="3919005">:</span>&nbsp;<span class="ident" id="3919007">oid</span><span class="op" id="3919010">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3919014">PublicKey</span><span class="op" id="3919023">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3919029">asn1</span><span class="op" id="3919033">.</span><span class="ident" id="3919034">BitString</span><span class="op" id="3919043">{</span><span class="ident" id="3919044">Bytes</span><span class="op" id="3919049">:</span>&nbsp;<span class="ident" id="3919051">elliptic</span><span class="op" id="3919059">.</span><span class="ident" id="3919060">Marshal</span><span class="op" id="3919067">(</span><span class="ident" id="3919068">key</span><span class="op" id="3919071">.</span><span class="ident" id="3919072">Curve</span><span class="op" id="3919077">,</span>&nbsp;<span class="ident" id="3919079">key</span><span class="op" id="3919082">.</span><span class="ident" id="3919083">X</span><span class="op" id="3919084">,</span>&nbsp;<span class="ident" id="3919086">key</span><span class="op" id="3919089">.</span><span class="ident" id="3919090">Y</span><span class="op" id="3919091">)</span><span class="op" id="3919092">}</span><span class="op" id="3919093">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3919096">}</span><span class="op" id="3919097">)</span><br>
<span class="lineno"></span><span class="op" id="3919099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="3919102">//&nbsp;parseECPrivateKey&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;Elliptic&nbsp;Curve&nbsp;Private&nbsp;Key&nbsp;Structure.</span><br>
<span class="lineno"></span><span class="comment" id="3919177">//&nbsp;The&nbsp;OID&nbsp;for&nbsp;the&nbsp;named&nbsp;curve&nbsp;may&nbsp;be&nbsp;provided&nbsp;from&nbsp;another&nbsp;source&nbsp;(such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="3919253">//&nbsp;the&nbsp;PKCS8&nbsp;container)&nbsp;-&nbsp;if&nbsp;it&nbsp;is&nbsp;provided&nbsp;then&nbsp;use&nbsp;this&nbsp;instead&nbsp;of&nbsp;the&nbsp;OID</span><br>
<span class="lineno"></span><span class="comment" id="3919330">//&nbsp;that&nbsp;may&nbsp;exist&nbsp;in&nbsp;the&nbsp;EC&nbsp;private&nbsp;key&nbsp;structure.</span><br>
<span class="lineno"></span><span class="keyword" id="3919381">func</span>&nbsp;<span class="ident" id="3919386">parseECPrivateKey</span><span class="op" id="3919403">(</span><span class="ident" id="3919404">namedCurveOID</span>&nbsp;<span class="op" id="3919418">*</span><span class="ident" id="3919419">asn1</span><span class="op" id="3919423">.</span><span class="ident" id="3919424">ObjectIdentifier</span><span class="op" id="3919440">,</span>&nbsp;<span class="ident" id="3919442">der</span>&nbsp;<span class="op" id="3919446">[</span><span class="op" id="3919447">]</span><span class="builtintype" id="3919448">byte</span><span class="op" id="3919452">)</span>&nbsp;<span class="op" id="3919454">(</span><span class="ident" id="3919455">key</span>&nbsp;<span class="op" id="3919459">*</span><span class="ident" id="3919460">ecdsa</span><span class="op" id="3919465">.</span><span class="ident" id="3919466">PrivateKey</span><span class="op" id="3919476">,</span>&nbsp;<span class="ident" id="3919478">err</span>&nbsp;<span class="builtintype" id="3919482">error</span><span class="op" id="3919487">)</span>&nbsp;<span class="op" id="3919489">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919492">var</span>&nbsp;<span class="ident" id="3919496">privKey</span>&nbsp;<span class="ident" id="3919504">ecPrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919518">if</span>&nbsp;<span class="ident" id="3919521">_</span><span class="op" id="3919522">,</span>&nbsp;<span class="ident" id="3919524">err</span>&nbsp;<span class="op" id="3919528">:=</span>&nbsp;<span class="ident" id="3919531">asn1</span><span class="op" id="3919535">.</span><span class="ident" id="3919536">Unmarshal</span><span class="op" id="3919545">(</span><span class="ident" id="3919546">der</span><span class="op" id="3919549">,</span>&nbsp;<span class="op" id="3919551">&amp;</span><span class="ident" id="3919552">privKey</span><span class="op" id="3919559">)</span><span class="op" id="3919560">;</span>&nbsp;<span class="ident" id="3919562">err</span>&nbsp;<span class="op" id="3919566">!=</span>&nbsp;<span class="builtintype" id="3919569">nil</span>&nbsp;<span class="op" id="3919573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919577">return</span>&nbsp;<span class="builtintype" id="3919584">nil</span><span class="op" id="3919587">,</span>&nbsp;<span class="ident" id="3919589">errors</span><span class="op" id="3919595">.</span><span class="ident" id="3919596">New</span><span class="op" id="3919599">(</span><span class="string" id="3919600">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key:&nbsp;&#34;</span>&nbsp;<span class="op" id="3919641">+</span>&nbsp;<span class="ident" id="3919643">err</span><span class="op" id="3919646">.</span><span class="ident" id="3919647">Error</span><span class="op" id="3919652">(</span><span class="op" id="3919653">)</span><span class="op" id="3919654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3919657">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919660">if</span>&nbsp;<span class="ident" id="3919663">privKey</span><span class="op" id="3919670">.</span><span class="ident" id="3919671">Version</span>&nbsp;<span class="op" id="3919679">!=</span>&nbsp;<span class="ident" id="3919682">ecPrivKeyVersion</span>&nbsp;<span class="op" id="3919699">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919703">return</span>&nbsp;<span class="builtintype" id="3919710">nil</span><span class="op" id="3919713">,</span>&nbsp;<span class="ident" id="3919715">fmt</span><span class="op" id="3919718">.</span><span class="ident" id="3919719">Errorf</span><span class="op" id="3919725">(</span><span class="string" id="3919726">&#34;x509:&nbsp;unknown&nbsp;EC&nbsp;private&nbsp;key&nbsp;version&nbsp;%d&#34;</span><span class="op" id="3919767">,</span>&nbsp;<span class="ident" id="3919769">privKey</span><span class="op" id="3919776">.</span><span class="ident" id="3919777">Version</span><span class="op" id="3919784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3919787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919791">var</span>&nbsp;<span class="ident" id="3919795">curve</span>&nbsp;<span class="ident" id="3919801">elliptic</span><span class="op" id="3919809">.</span><span class="ident" id="3919810">Curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919817">if</span>&nbsp;<span class="ident" id="3919820">namedCurveOID</span>&nbsp;<span class="op" id="3919834">!=</span>&nbsp;<span class="builtintype" id="3919837">nil</span>&nbsp;<span class="op" id="3919841">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3919845">curve</span>&nbsp;<span class="op" id="3919851">=</span>&nbsp;<span class="ident" id="3919853">namedCurveFromOID</span><span class="op" id="3919870">(</span><span class="op" id="3919871">*</span><span class="ident" id="3919872">namedCurveOID</span><span class="op" id="3919885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3919888">}</span>&nbsp;<span class="keyword" id="3919890">else</span>&nbsp;<span class="op" id="3919895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3919899">curve</span>&nbsp;<span class="op" id="3919905">=</span>&nbsp;<span class="ident" id="3919907">namedCurveFromOID</span><span class="op" id="3919924">(</span><span class="ident" id="3919925">privKey</span><span class="op" id="3919932">.</span><span class="ident" id="3919933">NamedCurveOID</span><span class="op" id="3919946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3919949">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919952">if</span>&nbsp;<span class="ident" id="3919955">curve</span>&nbsp;<span class="op" id="3919961">==</span>&nbsp;<span class="builtintype" id="3919964">nil</span>&nbsp;<span class="op" id="3919968">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3919972">return</span>&nbsp;<span class="builtintype" id="3919979">nil</span><span class="op" id="3919982">,</span>&nbsp;<span class="ident" id="3919984">errors</span><span class="op" id="3919990">.</span><span class="ident" id="3919991">New</span><span class="op" id="3919994">(</span><span class="string" id="3919995">&#34;x509:&nbsp;unknown&nbsp;elliptic&nbsp;curve&#34;</span><span class="op" id="3920025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3920028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3920032">k</span>&nbsp;<span class="op" id="3920034">:=</span>&nbsp;<span class="builtinfunc" id="3920037">new</span><span class="op" id="3920040">(</span><span class="ident" id="3920041">big</span><span class="op" id="3920044">.</span><span class="ident" id="3920045">Int</span><span class="op" id="3920048">)</span><span class="op" id="3920049">.</span><span class="ident" id="3920050">SetBytes</span><span class="op" id="3920058">(</span><span class="ident" id="3920059">privKey</span><span class="op" id="3920066">.</span><span class="ident" id="3920067">PrivateKey</span><span class="op" id="3920077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3920080">if</span>&nbsp;<span class="ident" id="3920083">k</span><span class="op" id="3920084">.</span><span class="ident" id="3920085">Cmp</span><span class="op" id="3920088">(</span><span class="ident" id="3920089">curve</span><span class="op" id="3920094">.</span><span class="ident" id="3920095">Params</span><span class="op" id="3920101">(</span><span class="op" id="3920102">)</span><span class="op" id="3920103">.</span><span class="ident" id="3920104">N</span><span class="op" id="3920105">)</span>&nbsp;<span class="op" id="3920107">&gt;=</span>&nbsp;<span class="num" id="3920110">0</span>&nbsp;<span class="op" id="3920112">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3920116">return</span>&nbsp;<span class="builtintype" id="3920123">nil</span><span class="op" id="3920126">,</span>&nbsp;<span class="ident" id="3920128">errors</span><span class="op" id="3920134">.</span><span class="ident" id="3920135">New</span><span class="op" id="3920138">(</span><span class="string" id="3920139">&#34;x509:&nbsp;invalid&nbsp;elliptic&nbsp;curve&nbsp;private&nbsp;key&nbsp;value&#34;</span><span class="op" id="3920187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3920190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3920193">priv</span>&nbsp;<span class="op" id="3920198">:=</span>&nbsp;<span class="builtinfunc" id="3920201">new</span><span class="op" id="3920204">(</span><span class="ident" id="3920205">ecdsa</span><span class="op" id="3920210">.</span><span class="ident" id="3920211">PrivateKey</span><span class="op" id="3920221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3920224">priv</span><span class="op" id="3920228">.</span><span class="ident" id="3920229">Curve</span>&nbsp;<span class="op" id="3920235">=</span>&nbsp;<span class="ident" id="3920237">curve</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3920244">priv</span><span class="op" id="3920248">.</span><span class="ident" id="3920249">D</span>&nbsp;<span class="op" id="3920251">=</span>&nbsp;<span class="ident" id="3920253">k</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3920256">priv</span><span class="op" id="3920260">.</span><span class="ident" id="3920261">X</span><span class="op" id="3920262">,</span>&nbsp;<span class="ident" id="3920264">priv</span><span class="op" id="3920268">.</span><span class="ident" id="3920269">Y</span>&nbsp;<span class="op" id="3920271">=</span>&nbsp;<span class="ident" id="3920273">curve</span><span class="op" id="3920278">.</span><span class="ident" id="3920279">ScalarBaseMult</span><span class="op" id="3920293">(</span><span class="ident" id="3920294">privKey</span><span class="op" id="3920301">.</span><span class="ident" id="3920302">PrivateKey</span><span class="op" id="3920312">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3920316">return</span>&nbsp;<span class="ident" id="3920323">priv</span><span class="op" id="3920327">,</span>&nbsp;<span class="builtintype" id="3920329">nil</span><br>
<span class="lineno"></span><span class="op" id="3920333">}</span>
</div>
</body>
</html>
