<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4128597">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4128652">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4128706">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4128757">//&nbsp;Package&nbsp;pkix&nbsp;contains&nbsp;shared,&nbsp;low&nbsp;level&nbsp;structures&nbsp;used&nbsp;for&nbsp;ASN.1&nbsp;parsing</span><br>
<span class="lineno"></span><span class="comment" id="4128834">//&nbsp;and&nbsp;serialization&nbsp;of&nbsp;X.509&nbsp;certificates,&nbsp;CRL&nbsp;and&nbsp;OCSP.</span><br>
<span class="lineno"></span><span class="keyword" id="4128892">package</span>&nbsp;<span class="ident" id="4128900">pkix</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4128906">import</span>&nbsp;<span class="op" id="4128913">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4128916">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4128933">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4128945">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4128952">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="4128955">//&nbsp;AlgorithmIdentifier&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4129035">//&nbsp;5280,&nbsp;section&nbsp;4.1.1.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4129061">type</span>&nbsp;<span class="ident" id="4129066">AlgorithmIdentifier</span>&nbsp;<span class="keyword" id="4129086">struct</span>&nbsp;<span class="op" id="4129093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129096">Algorithm</span>&nbsp;&nbsp;<span class="ident" id="4129107">asn1</span><span class="op" id="4129111">.</span><span class="ident" id="4129112">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129130">Parameters</span>&nbsp;<span class="ident" id="4129141">asn1</span><span class="op" id="4129145">.</span><span class="ident" id="4129146">RawValue</span>&nbsp;<span class="string" id="4129155">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">20</span><span class="op" id="4129173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4129176">type</span>&nbsp;<span class="ident" id="4129181">RDNSequence</span>&nbsp;<span class="op" id="4129193">[</span><span class="op" id="4129194">]</span><span class="ident" id="4129195">RelativeDistinguishedNameSET</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4129225">type</span>&nbsp;<span class="ident" id="4129230">RelativeDistinguishedNameSET</span>&nbsp;<span class="op" id="4129259">[</span><span class="op" id="4129260">]</span><span class="ident" id="4129261">AttributeTypeAndValue</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="4129284">//&nbsp;AttributeTypeAndValue&nbsp;mirrors&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4129357">//&nbsp;http://tools.ietf.org/html/rfc5280#section-4.1.2.4</span><br>
<span class="lineno"></span><span class="keyword" id="4129411">type</span>&nbsp;<span class="ident" id="4129416">AttributeTypeAndValue</span>&nbsp;<span class="keyword" id="4129438">struct</span>&nbsp;<span class="op" id="4129445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129448">Type</span>&nbsp;&nbsp;<span class="ident" id="4129454">asn1</span><span class="op" id="4129458">.</span><span class="ident" id="4129459">ObjectIdentifier</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129477">Value</span>&nbsp;<span class="keyword" id="4129483">interface</span><span class="op" id="4129492">{</span><span class="op" id="4129493">}</span><br>
<span class="lineno"></span><span class="op" id="4129495">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4129498">//&nbsp;AttributeTypeAndValueSET&nbsp;represents&nbsp;a&nbsp;set&nbsp;of&nbsp;ASN.1&nbsp;sequences&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4129565">//&nbsp;AttributeTypeAndValue&nbsp;sequences&nbsp;from&nbsp;RFC&nbsp;2986&nbsp;(PKCS&nbsp;#10).</span><br>
<span class="lineno">35</span><span class="keyword" id="4129626">type</span>&nbsp;<span class="ident" id="4129631">AttributeTypeAndValueSET</span>&nbsp;<span class="keyword" id="4129656">struct</span>&nbsp;<span class="op" id="4129663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129666">Type</span>&nbsp;&nbsp;<span class="ident" id="4129672">asn1</span><span class="op" id="4129676">.</span><span class="ident" id="4129677">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129695">Value</span>&nbsp;<span class="op" id="4129701">[</span><span class="op" id="4129702">]</span><span class="op" id="4129703">[</span><span class="op" id="4129704">]</span><span class="ident" id="4129705">AttributeTypeAndValue</span>&nbsp;<span class="string" id="4129727">`asn1:&#34;set&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4129740">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4129743">//&nbsp;Extension&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4129813">//&nbsp;5280,&nbsp;section&nbsp;4.2.</span><br>
<span class="lineno"></span><span class="keyword" id="4129835">type</span>&nbsp;<span class="ident" id="4129840">Extension</span>&nbsp;<span class="keyword" id="4129850">struct</span>&nbsp;<span class="op" id="4129857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129860">Id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4129869">asn1</span><span class="op" id="4129873">.</span><span class="ident" id="4129874">ObjectIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129892">Critical</span>&nbsp;<span class="builtintype" id="4129901">bool</span>&nbsp;<span class="string" id="4129906">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4129925">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4129934">[</span><span class="op" id="4129935">]</span><span class="builtintype" id="4129936">byte</span><br>
<span class="lineno"></span><span class="op" id="4129941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4129944">//&nbsp;Name&nbsp;represents&nbsp;an&nbsp;X.509&nbsp;distinguished&nbsp;name.&nbsp;This&nbsp;only&nbsp;includes&nbsp;the&nbsp;common</span><br>
<span class="lineno"></span><span class="comment" id="4130022">//&nbsp;elements&nbsp;of&nbsp;a&nbsp;DN.&nbsp;&nbsp;Additional&nbsp;elements&nbsp;in&nbsp;the&nbsp;name&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno">50</span><span class="keyword" id="4130089">type</span>&nbsp;<span class="ident" id="4130094">Name</span>&nbsp;<span class="keyword" id="4130099">struct</span>&nbsp;<span class="op" id="4130106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130109">Country</span><span class="op" id="4130116">,</span>&nbsp;<span class="ident" id="4130118">Organization</span><span class="op" id="4130130">,</span>&nbsp;<span class="ident" id="4130132">OrganizationalUnit</span>&nbsp;<span class="op" id="4130151">[</span><span class="op" id="4130152">]</span><span class="builtintype" id="4130153">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130161">Locality</span><span class="op" id="4130169">,</span>&nbsp;<span class="ident" id="4130171">Province</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4130203">[</span><span class="op" id="4130204">]</span><span class="builtintype" id="4130205">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130213">StreetAddress</span><span class="op" id="4130226">,</span>&nbsp;<span class="ident" id="4130228">PostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4130255">[</span><span class="op" id="4130256">]</span><span class="builtintype" id="4130257">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130265">SerialNumber</span><span class="op" id="4130277">,</span>&nbsp;<span class="ident" id="4130279">CommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4130307">string</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130316">Names</span>&nbsp;<span class="op" id="4130322">[</span><span class="op" id="4130323">]</span><span class="ident" id="4130324">AttributeTypeAndValue</span><br>
<span class="lineno"></span><span class="op" id="4130346">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4130349">func</span>&nbsp;<span class="op" id="4130354">(</span><span class="ident" id="4130355">n</span>&nbsp;<span class="op" id="4130357">*</span><span class="ident" id="4130358">Name</span><span class="op" id="4130362">)</span>&nbsp;<span class="ident" id="4130364">FillFromRDNSequence</span><span class="op" id="4130383">(</span><span class="ident" id="4130384">rdns</span>&nbsp;<span class="op" id="4130389">*</span><span class="ident" id="4130390">RDNSequence</span><span class="op" id="4130401">)</span>&nbsp;<span class="op" id="4130403">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130406">for</span>&nbsp;<span class="ident" id="4130410">_</span><span class="op" id="4130411">,</span>&nbsp;<span class="ident" id="4130413">rdn</span>&nbsp;<span class="op" id="4130417">:=</span>&nbsp;<span class="keyword" id="4130420">range</span>&nbsp;<span class="op" id="4130426">*</span><span class="ident" id="4130427">rdns</span>&nbsp;<span class="op" id="4130432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130436">if</span>&nbsp;<span class="builtinfunc" id="4130439">len</span><span class="op" id="4130442">(</span><span class="ident" id="4130443">rdn</span><span class="op" id="4130446">)</span>&nbsp;<span class="op" id="4130448">==</span>&nbsp;<span class="num" id="4130451">0</span>&nbsp;<span class="op" id="4130453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130458">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4130469">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130473">atv</span>&nbsp;<span class="op" id="4130477">:=</span>&nbsp;<span class="ident" id="4130480">rdn</span><span class="op" id="4130483">[</span><span class="num" id="4130484">0</span><span class="op" id="4130485">]</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130489">n</span><span class="op" id="4130490">.</span><span class="ident" id="4130491">Names</span>&nbsp;<span class="op" id="4130497">=</span>&nbsp;<span class="builtinfunc" id="4130499">append</span><span class="op" id="4130505">(</span><span class="ident" id="4130506">n</span><span class="op" id="4130507">.</span><span class="ident" id="4130508">Names</span><span class="op" id="4130513">,</span>&nbsp;<span class="ident" id="4130515">atv</span><span class="op" id="4130518">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130522">value</span><span class="op" id="4130527">,</span>&nbsp;<span class="ident" id="4130529">ok</span>&nbsp;<span class="op" id="4130532">:=</span>&nbsp;<span class="ident" id="4130535">atv</span><span class="op" id="4130538">.</span><span class="ident" id="4130539">Value</span><span class="op" id="4130544">.</span><span class="op" id="4130545">(</span><span class="builtintype" id="4130546">string</span><span class="op" id="4130552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130556">if</span>&nbsp;<span class="op" id="4130559">!</span><span class="ident" id="4130560">ok</span>&nbsp;<span class="op" id="4130563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130568">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4130579">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130584">t</span>&nbsp;<span class="op" id="4130586">:=</span>&nbsp;<span class="ident" id="4130589">atv</span><span class="op" id="4130592">.</span><span class="ident" id="4130593">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130600">if</span>&nbsp;<span class="builtinfunc" id="4130603">len</span><span class="op" id="4130606">(</span><span class="ident" id="4130607">t</span><span class="op" id="4130608">)</span>&nbsp;<span class="op" id="4130610">==</span>&nbsp;<span class="num" id="4130613">4</span>&nbsp;<span class="op" id="4130615">&amp;&amp;</span>&nbsp;<span class="ident" id="4130618">t</span><span class="op" id="4130619">[</span><span class="num" id="4130620">0</span><span class="op" id="4130621">]</span>&nbsp;<span class="op" id="4130623">==</span>&nbsp;<span class="num" id="4130626">2</span>&nbsp;<span class="op" id="4130628">&amp;&amp;</span>&nbsp;<span class="ident" id="4130631">t</span><span class="op" id="4130632">[</span><span class="num" id="4130633">1</span><span class="op" id="4130634">]</span>&nbsp;<span class="op" id="4130636">==</span>&nbsp;<span class="num" id="4130639">5</span>&nbsp;<span class="op" id="4130641">&amp;&amp;</span>&nbsp;<span class="ident" id="4130644">t</span><span class="op" id="4130645">[</span><span class="num" id="4130646">2</span><span class="op" id="4130647">]</span>&nbsp;<span class="op" id="4130649">==</span>&nbsp;<span class="num" id="4130652">4</span>&nbsp;<span class="op" id="4130654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130659">switch</span>&nbsp;<span class="ident" id="4130666">t</span><span class="op" id="4130667">[</span><span class="num" id="4130668">3</span><span class="op" id="4130669">]</span>&nbsp;<span class="op" id="4130671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130676">case</span>&nbsp;<span class="num" id="4130681">3</span><span class="op" id="4130682">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130688">n</span><span class="op" id="4130689">.</span><span class="ident" id="4130690">CommonName</span>&nbsp;<span class="op" id="4130701">=</span>&nbsp;<span class="ident" id="4130703">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130712">case</span>&nbsp;<span class="num" id="4130717">5</span><span class="op" id="4130718">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130724">n</span><span class="op" id="4130725">.</span><span class="ident" id="4130726">SerialNumber</span>&nbsp;<span class="op" id="4130739">=</span>&nbsp;<span class="ident" id="4130741">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130750">case</span>&nbsp;<span class="num" id="4130755">6</span><span class="op" id="4130756">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130762">n</span><span class="op" id="4130763">.</span><span class="ident" id="4130764">Country</span>&nbsp;<span class="op" id="4130772">=</span>&nbsp;<span class="builtinfunc" id="4130774">append</span><span class="op" id="4130780">(</span><span class="ident" id="4130781">n</span><span class="op" id="4130782">.</span><span class="ident" id="4130783">Country</span><span class="op" id="4130790">,</span>&nbsp;<span class="ident" id="4130792">value</span><span class="op" id="4130797">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130802">case</span>&nbsp;<span class="num" id="4130807">7</span><span class="op" id="4130808">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130814">n</span><span class="op" id="4130815">.</span><span class="ident" id="4130816">Locality</span>&nbsp;<span class="op" id="4130825">=</span>&nbsp;<span class="builtinfunc" id="4130827">append</span><span class="op" id="4130833">(</span><span class="ident" id="4130834">n</span><span class="op" id="4130835">.</span><span class="ident" id="4130836">Locality</span><span class="op" id="4130844">,</span>&nbsp;<span class="ident" id="4130846">value</span><span class="op" id="4130851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130856">case</span>&nbsp;<span class="num" id="4130861">8</span><span class="op" id="4130862">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130868">n</span><span class="op" id="4130869">.</span><span class="ident" id="4130870">Province</span>&nbsp;<span class="op" id="4130879">=</span>&nbsp;<span class="builtinfunc" id="4130881">append</span><span class="op" id="4130887">(</span><span class="ident" id="4130888">n</span><span class="op" id="4130889">.</span><span class="ident" id="4130890">Province</span><span class="op" id="4130898">,</span>&nbsp;<span class="ident" id="4130900">value</span><span class="op" id="4130905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130910">case</span>&nbsp;<span class="num" id="4130915">9</span><span class="op" id="4130916">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130922">n</span><span class="op" id="4130923">.</span><span class="ident" id="4130924">StreetAddress</span>&nbsp;<span class="op" id="4130938">=</span>&nbsp;<span class="builtinfunc" id="4130940">append</span><span class="op" id="4130946">(</span><span class="ident" id="4130947">n</span><span class="op" id="4130948">.</span><span class="ident" id="4130949">StreetAddress</span><span class="op" id="4130962">,</span>&nbsp;<span class="ident" id="4130964">value</span><span class="op" id="4130969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4130974">case</span>&nbsp;<span class="num" id="4130979">10</span><span class="op" id="4130981">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4130987">n</span><span class="op" id="4130988">.</span><span class="ident" id="4130989">Organization</span>&nbsp;<span class="op" id="4131002">=</span>&nbsp;<span class="builtinfunc" id="4131004">append</span><span class="op" id="4131010">(</span><span class="ident" id="4131011">n</span><span class="op" id="4131012">.</span><span class="ident" id="4131013">Organization</span><span class="op" id="4131025">,</span>&nbsp;<span class="ident" id="4131027">value</span><span class="op" id="4131032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131037">case</span>&nbsp;<span class="num" id="4131042">11</span><span class="op" id="4131044">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131050">n</span><span class="op" id="4131051">.</span><span class="ident" id="4131052">OrganizationalUnit</span>&nbsp;<span class="op" id="4131071">=</span>&nbsp;<span class="builtinfunc" id="4131073">append</span><span class="op" id="4131079">(</span><span class="ident" id="4131080">n</span><span class="op" id="4131081">.</span><span class="ident" id="4131082">OrganizationalUnit</span><span class="op" id="4131100">,</span>&nbsp;<span class="ident" id="4131102">value</span><span class="op" id="4131107">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131112">case</span>&nbsp;<span class="num" id="4131117">17</span><span class="op" id="4131119">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131125">n</span><span class="op" id="4131126">.</span><span class="ident" id="4131127">PostalCode</span>&nbsp;<span class="op" id="4131138">=</span>&nbsp;<span class="builtinfunc" id="4131140">append</span><span class="op" id="4131146">(</span><span class="ident" id="4131147">n</span><span class="op" id="4131148">.</span><span class="ident" id="4131149">PostalCode</span><span class="op" id="4131159">,</span>&nbsp;<span class="ident" id="4131161">value</span><span class="op" id="4131166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131171">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131178">}</span><br>
<span class="lineno">95</span><span class="op" id="4131180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4131183">var</span>&nbsp;<span class="op" id="4131187">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131190">oidCountry</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4131212">=</span>&nbsp;<span class="op" id="4131214">[</span><span class="op" id="4131215">]</span><span class="builtintype" id="4131216">int</span><span class="op" id="4131219">{</span><span class="num" id="4131220">2</span><span class="op" id="4131221">,</span>&nbsp;<span class="num" id="4131223">5</span><span class="op" id="4131224">,</span>&nbsp;<span class="num" id="4131226">4</span><span class="op" id="4131227">,</span>&nbsp;<span class="num" id="4131229">6</span><span class="op" id="4131230">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131233">oidOrganization</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4131255">=</span>&nbsp;<span class="op" id="4131257">[</span><span class="op" id="4131258">]</span><span class="builtintype" id="4131259">int</span><span class="op" id="4131262">{</span><span class="num" id="4131263">2</span><span class="op" id="4131264">,</span>&nbsp;<span class="num" id="4131266">5</span><span class="op" id="4131267">,</span>&nbsp;<span class="num" id="4131269">4</span><span class="op" id="4131270">,</span>&nbsp;<span class="num" id="4131272">10</span><span class="op" id="4131274">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131277">oidOrganizationalUnit</span>&nbsp;<span class="op" id="4131299">=</span>&nbsp;<span class="op" id="4131301">[</span><span class="op" id="4131302">]</span><span class="builtintype" id="4131303">int</span><span class="op" id="4131306">{</span><span class="num" id="4131307">2</span><span class="op" id="4131308">,</span>&nbsp;<span class="num" id="4131310">5</span><span class="op" id="4131311">,</span>&nbsp;<span class="num" id="4131313">4</span><span class="op" id="4131314">,</span>&nbsp;<span class="num" id="4131316">11</span><span class="op" id="4131318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131321">oidCommonName</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4131343">=</span>&nbsp;<span class="op" id="4131345">[</span><span class="op" id="4131346">]</span><span class="builtintype" id="4131347">int</span><span class="op" id="4131350">{</span><span class="num" id="4131351">2</span><span class="op" id="4131352">,</span>&nbsp;<span class="num" id="4131354">5</span><span class="op" id="4131355">,</span>&nbsp;<span class="num" id="4131357">4</span><span class="op" id="4131358">,</span>&nbsp;<span class="num" id="4131360">3</span><span class="op" id="4131361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131364">oidSerialNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4131386">=</span>&nbsp;<span class="op" id="4131388">[</span><span class="op" id="4131389">]</span><span class="builtintype" id="4131390">int</span><span class="op" id="4131393">{</span><span class="num" id="4131394">2</span><span class="op" id="4131395">,</span>&nbsp;<span class="num" id="4131397">5</span><span class="op" id="4131398">,</span>&nbsp;<span class="num" id="4131400">4</span><span class="op" id="4131401">,</span>&nbsp;<span class="num" id="4131403">5</span><span class="op" id="4131404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131407">oidLocality</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4131429">=</span>&nbsp;<span class="op" id="4131431">[</span><span class="op" id="4131432">]</span><span class="builtintype" id="4131433">int</span><span class="op" id="4131436">{</span><span class="num" id="4131437">2</span><span class="op" id="4131438">,</span>&nbsp;<span class="num" id="4131440">5</span><span class="op" id="4131441">,</span>&nbsp;<span class="num" id="4131443">4</span><span class="op" id="4131444">,</span>&nbsp;<span class="num" id="4131446">7</span><span class="op" id="4131447">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131450">oidProvince</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4131472">=</span>&nbsp;<span class="op" id="4131474">[</span><span class="op" id="4131475">]</span><span class="builtintype" id="4131476">int</span><span class="op" id="4131479">{</span><span class="num" id="4131480">2</span><span class="op" id="4131481">,</span>&nbsp;<span class="num" id="4131483">5</span><span class="op" id="4131484">,</span>&nbsp;<span class="num" id="4131486">4</span><span class="op" id="4131487">,</span>&nbsp;<span class="num" id="4131489">8</span><span class="op" id="4131490">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131493">oidStreetAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4131515">=</span>&nbsp;<span class="op" id="4131517">[</span><span class="op" id="4131518">]</span><span class="builtintype" id="4131519">int</span><span class="op" id="4131522">{</span><span class="num" id="4131523">2</span><span class="op" id="4131524">,</span>&nbsp;<span class="num" id="4131526">5</span><span class="op" id="4131527">,</span>&nbsp;<span class="num" id="4131529">4</span><span class="op" id="4131530">,</span>&nbsp;<span class="num" id="4131532">9</span><span class="op" id="4131533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131536">oidPostalCode</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4131558">=</span>&nbsp;<span class="op" id="4131560">[</span><span class="op" id="4131561">]</span><span class="builtintype" id="4131562">int</span><span class="op" id="4131565">{</span><span class="num" id="4131566">2</span><span class="op" id="4131567">,</span>&nbsp;<span class="num" id="4131569">5</span><span class="op" id="4131570">,</span>&nbsp;<span class="num" id="4131572">4</span><span class="op" id="4131573">,</span>&nbsp;<span class="num" id="4131575">17</span><span class="op" id="4131577">}</span><br>
<span class="lineno"></span><span class="op" id="4131579">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4131582">//&nbsp;appendRDNs&nbsp;appends&nbsp;a&nbsp;relativeDistinguishedNameSET&nbsp;to&nbsp;the&nbsp;given&nbsp;RDNSequence</span><br>
<span class="lineno">110</span><span class="comment" id="4131660">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;new&nbsp;value.&nbsp;The&nbsp;relativeDistinguishedNameSET&nbsp;contains&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4131735">//&nbsp;attributeTypeAndValue&nbsp;for&nbsp;each&nbsp;of&nbsp;the&nbsp;given&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;5280,&nbsp;A.1,&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4131813">//&nbsp;search&nbsp;for&nbsp;AttributeTypeAndValue.</span><br>
<span class="lineno"></span><span class="keyword" id="4131850">func</span>&nbsp;<span class="ident" id="4131855">appendRDNs</span><span class="op" id="4131865">(</span><span class="ident" id="4131866">in</span>&nbsp;<span class="ident" id="4131869">RDNSequence</span><span class="op" id="4131880">,</span>&nbsp;<span class="ident" id="4131882">values</span>&nbsp;<span class="op" id="4131889">[</span><span class="op" id="4131890">]</span><span class="builtintype" id="4131891">string</span><span class="op" id="4131897">,</span>&nbsp;<span class="ident" id="4131899">oid</span>&nbsp;<span class="ident" id="4131903">asn1</span><span class="op" id="4131907">.</span><span class="ident" id="4131908">ObjectIdentifier</span><span class="op" id="4131924">)</span>&nbsp;<span class="ident" id="4131926">RDNSequence</span>&nbsp;<span class="op" id="4131938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131941">if</span>&nbsp;<span class="builtinfunc" id="4131944">len</span><span class="op" id="4131947">(</span><span class="ident" id="4131948">values</span><span class="op" id="4131954">)</span>&nbsp;<span class="op" id="4131956">==</span>&nbsp;<span class="num" id="4131959">0</span>&nbsp;<span class="op" id="4131961">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4131965">return</span>&nbsp;<span class="ident" id="4131972">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4131976">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4131980">s</span>&nbsp;<span class="op" id="4131982">:=</span>&nbsp;<span class="builtinfunc" id="4131985">make</span><span class="op" id="4131989">(</span><span class="op" id="4131990">[</span><span class="op" id="4131991">]</span><span class="ident" id="4131992">AttributeTypeAndValue</span><span class="op" id="4132013">,</span>&nbsp;<span class="builtinfunc" id="4132015">len</span><span class="op" id="4132018">(</span><span class="ident" id="4132019">values</span><span class="op" id="4132025">)</span><span class="op" id="4132026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132029">for</span>&nbsp;<span class="ident" id="4132033">i</span><span class="op" id="4132034">,</span>&nbsp;<span class="ident" id="4132036">value</span>&nbsp;<span class="op" id="4132042">:=</span>&nbsp;<span class="keyword" id="4132045">range</span>&nbsp;<span class="ident" id="4132051">values</span>&nbsp;<span class="op" id="4132058">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132062">s</span><span class="op" id="4132063">[</span><span class="ident" id="4132064">i</span><span class="op" id="4132065">]</span><span class="op" id="4132066">.</span><span class="ident" id="4132067">Type</span>&nbsp;<span class="op" id="4132072">=</span>&nbsp;<span class="ident" id="4132074">oid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132080">s</span><span class="op" id="4132081">[</span><span class="ident" id="4132082">i</span><span class="op" id="4132083">]</span><span class="op" id="4132084">.</span><span class="ident" id="4132085">Value</span>&nbsp;<span class="op" id="4132091">=</span>&nbsp;<span class="ident" id="4132093">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4132100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132104">return</span>&nbsp;<span class="builtinfunc" id="4132111">append</span><span class="op" id="4132117">(</span><span class="ident" id="4132118">in</span><span class="op" id="4132120">,</span>&nbsp;<span class="ident" id="4132122">s</span><span class="op" id="4132123">)</span><br>
<span class="lineno">125</span><span class="op" id="4132125">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4132128">func</span>&nbsp;<span class="op" id="4132133">(</span><span class="ident" id="4132134">n</span>&nbsp;<span class="ident" id="4132136">Name</span><span class="op" id="4132140">)</span>&nbsp;<span class="ident" id="4132142">ToRDNSequence</span><span class="op" id="4132155">(</span><span class="op" id="4132156">)</span>&nbsp;<span class="op" id="4132158">(</span><span class="ident" id="4132159">ret</span>&nbsp;<span class="ident" id="4132163">RDNSequence</span><span class="op" id="4132174">)</span>&nbsp;<span class="op" id="4132176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132179">ret</span>&nbsp;<span class="op" id="4132183">=</span>&nbsp;<span class="ident" id="4132185">appendRDNs</span><span class="op" id="4132195">(</span><span class="ident" id="4132196">ret</span><span class="op" id="4132199">,</span>&nbsp;<span class="ident" id="4132201">n</span><span class="op" id="4132202">.</span><span class="ident" id="4132203">Country</span><span class="op" id="4132210">,</span>&nbsp;<span class="ident" id="4132212">oidCountry</span><span class="op" id="4132222">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132225">ret</span>&nbsp;<span class="op" id="4132229">=</span>&nbsp;<span class="ident" id="4132231">appendRDNs</span><span class="op" id="4132241">(</span><span class="ident" id="4132242">ret</span><span class="op" id="4132245">,</span>&nbsp;<span class="ident" id="4132247">n</span><span class="op" id="4132248">.</span><span class="ident" id="4132249">Organization</span><span class="op" id="4132261">,</span>&nbsp;<span class="ident" id="4132263">oidOrganization</span><span class="op" id="4132278">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132281">ret</span>&nbsp;<span class="op" id="4132285">=</span>&nbsp;<span class="ident" id="4132287">appendRDNs</span><span class="op" id="4132297">(</span><span class="ident" id="4132298">ret</span><span class="op" id="4132301">,</span>&nbsp;<span class="ident" id="4132303">n</span><span class="op" id="4132304">.</span><span class="ident" id="4132305">OrganizationalUnit</span><span class="op" id="4132323">,</span>&nbsp;<span class="ident" id="4132325">oidOrganizationalUnit</span><span class="op" id="4132346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132349">ret</span>&nbsp;<span class="op" id="4132353">=</span>&nbsp;<span class="ident" id="4132355">appendRDNs</span><span class="op" id="4132365">(</span><span class="ident" id="4132366">ret</span><span class="op" id="4132369">,</span>&nbsp;<span class="ident" id="4132371">n</span><span class="op" id="4132372">.</span><span class="ident" id="4132373">Locality</span><span class="op" id="4132381">,</span>&nbsp;<span class="ident" id="4132383">oidLocality</span><span class="op" id="4132394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132397">ret</span>&nbsp;<span class="op" id="4132401">=</span>&nbsp;<span class="ident" id="4132403">appendRDNs</span><span class="op" id="4132413">(</span><span class="ident" id="4132414">ret</span><span class="op" id="4132417">,</span>&nbsp;<span class="ident" id="4132419">n</span><span class="op" id="4132420">.</span><span class="ident" id="4132421">Province</span><span class="op" id="4132429">,</span>&nbsp;<span class="ident" id="4132431">oidProvince</span><span class="op" id="4132442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132445">ret</span>&nbsp;<span class="op" id="4132449">=</span>&nbsp;<span class="ident" id="4132451">appendRDNs</span><span class="op" id="4132461">(</span><span class="ident" id="4132462">ret</span><span class="op" id="4132465">,</span>&nbsp;<span class="ident" id="4132467">n</span><span class="op" id="4132468">.</span><span class="ident" id="4132469">StreetAddress</span><span class="op" id="4132482">,</span>&nbsp;<span class="ident" id="4132484">oidStreetAddress</span><span class="op" id="4132500">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132503">ret</span>&nbsp;<span class="op" id="4132507">=</span>&nbsp;<span class="ident" id="4132509">appendRDNs</span><span class="op" id="4132519">(</span><span class="ident" id="4132520">ret</span><span class="op" id="4132523">,</span>&nbsp;<span class="ident" id="4132525">n</span><span class="op" id="4132526">.</span><span class="ident" id="4132527">PostalCode</span><span class="op" id="4132537">,</span>&nbsp;<span class="ident" id="4132539">oidPostalCode</span><span class="op" id="4132552">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132555">if</span>&nbsp;<span class="builtinfunc" id="4132558">len</span><span class="op" id="4132561">(</span><span class="ident" id="4132562">n</span><span class="op" id="4132563">.</span><span class="ident" id="4132564">CommonName</span><span class="op" id="4132574">)</span>&nbsp;<span class="op" id="4132576">&gt;</span>&nbsp;<span class="num" id="4132578">0</span>&nbsp;<span class="op" id="4132580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132584">ret</span>&nbsp;<span class="op" id="4132588">=</span>&nbsp;<span class="ident" id="4132590">appendRDNs</span><span class="op" id="4132600">(</span><span class="ident" id="4132601">ret</span><span class="op" id="4132604">,</span>&nbsp;<span class="op" id="4132606">[</span><span class="op" id="4132607">]</span><span class="builtintype" id="4132608">string</span><span class="op" id="4132614">{</span><span class="ident" id="4132615">n</span><span class="op" id="4132616">.</span><span class="ident" id="4132617">CommonName</span><span class="op" id="4132627">}</span><span class="op" id="4132628">,</span>&nbsp;<span class="ident" id="4132630">oidCommonName</span><span class="op" id="4132643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4132646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132649">if</span>&nbsp;<span class="builtinfunc" id="4132652">len</span><span class="op" id="4132655">(</span><span class="ident" id="4132656">n</span><span class="op" id="4132657">.</span><span class="ident" id="4132658">SerialNumber</span><span class="op" id="4132670">)</span>&nbsp;<span class="op" id="4132672">&gt;</span>&nbsp;<span class="num" id="4132674">0</span>&nbsp;<span class="op" id="4132676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132680">ret</span>&nbsp;<span class="op" id="4132684">=</span>&nbsp;<span class="ident" id="4132686">appendRDNs</span><span class="op" id="4132696">(</span><span class="ident" id="4132697">ret</span><span class="op" id="4132700">,</span>&nbsp;<span class="op" id="4132702">[</span><span class="op" id="4132703">]</span><span class="builtintype" id="4132704">string</span><span class="op" id="4132710">{</span><span class="ident" id="4132711">n</span><span class="op" id="4132712">.</span><span class="ident" id="4132713">SerialNumber</span><span class="op" id="4132725">}</span><span class="op" id="4132726">,</span>&nbsp;<span class="ident" id="4132728">oidSerialNumber</span><span class="op" id="4132743">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4132746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4132750">return</span>&nbsp;<span class="ident" id="4132757">ret</span><br>
<span class="lineno"></span><span class="op" id="4132761">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">145</span><span class="comment" id="4132764">//&nbsp;CertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4132840">//&nbsp;5280,&nbsp;section&nbsp;5.1.&nbsp;Use&nbsp;Certificate.CheckCRLSignature&nbsp;to&nbsp;verify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4132910">//&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="4132924">type</span>&nbsp;<span class="ident" id="4132929">CertificateList</span>&nbsp;<span class="keyword" id="4132945">struct</span>&nbsp;<span class="op" id="4132952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132955">TBSCertList</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4132974">TBSCertificateList</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4132994">SignatureAlgorithm</span>&nbsp;<span class="ident" id="4133013">AlgorithmIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133034">SignatureValue</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133053">asn1</span><span class="op" id="4133057">.</span><span class="ident" id="4133058">BitString</span><br>
<span class="lineno"></span><span class="op" id="4133068">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4133071">//&nbsp;HasExpired&nbsp;reports&nbsp;whether&nbsp;now&nbsp;is&nbsp;past&nbsp;the&nbsp;expiry&nbsp;time&nbsp;of&nbsp;certList.</span><br>
<span class="lineno">155</span><span class="keyword" id="4133142">func</span>&nbsp;<span class="op" id="4133147">(</span><span class="ident" id="4133148">certList</span>&nbsp;<span class="op" id="4133157">*</span><span class="ident" id="4133158">CertificateList</span><span class="op" id="4133173">)</span>&nbsp;<span class="ident" id="4133175">HasExpired</span><span class="op" id="4133185">(</span><span class="ident" id="4133186">now</span>&nbsp;<span class="ident" id="4133190">time</span><span class="op" id="4133194">.</span><span class="ident" id="4133195">Time</span><span class="op" id="4133199">)</span>&nbsp;<span class="builtintype" id="4133201">bool</span>&nbsp;<span class="op" id="4133206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4133209">return</span>&nbsp;<span class="ident" id="4133216">now</span><span class="op" id="4133219">.</span><span class="ident" id="4133220">After</span><span class="op" id="4133225">(</span><span class="ident" id="4133226">certList</span><span class="op" id="4133234">.</span><span class="ident" id="4133235">TBSCertList</span><span class="op" id="4133246">.</span><span class="ident" id="4133247">NextUpdate</span><span class="op" id="4133257">)</span><br>
<span class="lineno"></span><span class="op" id="4133259">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4133262">//&nbsp;TBSCertificateList&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno">160</span><span class="comment" id="4133341">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4133363">type</span>&nbsp;<span class="ident" id="4133368">TBSCertificateList</span>&nbsp;<span class="keyword" id="4133387">struct</span>&nbsp;<span class="op" id="4133394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133397">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133417">asn1</span><span class="op" id="4133421">.</span><span class="ident" id="4133422">RawContent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133434">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4133454">int</span>&nbsp;<span class="string" id="4133458">`asn1:&#34;optional,default:2&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133487">Signature</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133507">AlgorithmIdentifier</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133528">Issuer</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133548">RDNSequence</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133561">ThisUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133581">time</span><span class="op" id="4133585">.</span><span class="ident" id="4133586">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133592">NextUpdate</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4133612">time</span><span class="op" id="4133616">.</span><span class="ident" id="4133617">Time</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4133633">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133652">RevokedCertificates</span>&nbsp;<span class="op" id="4133672">[</span><span class="op" id="4133673">]</span><span class="ident" id="4133674">RevokedCertificate</span>&nbsp;<span class="string" id="4133693">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133712">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4133732">[</span><span class="op" id="4133733">]</span><span class="ident" id="4133734">Extension</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4133753">`asn1:&#34;tag:0,optional,explicit&#34;`</span><br>
<span class="lineno">170</span><span class="op" id="4133786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4133789">//&nbsp;RevokedCertificate&nbsp;represents&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;the&nbsp;same&nbsp;name.&nbsp;See&nbsp;RFC</span><br>
<span class="lineno"></span><span class="comment" id="4133868">//&nbsp;5280,&nbsp;section&nbsp;5.1.</span><br>
<span class="lineno"></span><span class="keyword" id="4133890">type</span>&nbsp;<span class="ident" id="4133895">RevokedCertificate</span>&nbsp;<span class="keyword" id="4133914">struct</span>&nbsp;<span class="op" id="4133921">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133924">SerialNumber</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4133939">*</span><span class="ident" id="4133940">big</span><span class="op" id="4133943">.</span><span class="ident" id="4133944">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133949">RevocationTime</span>&nbsp;<span class="ident" id="4133964">time</span><span class="op" id="4133968">.</span><span class="ident" id="4133969">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4133975">Extensions</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4133990">[</span><span class="op" id="4133991">]</span><span class="ident" id="4133992">Extension</span>&nbsp;<span class="string" id="4134002">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4134020">}</span>
</div>
</body>
</html>
