<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/rand</h2>
<ul>
<li><a href="/gostd/math/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/math/rand/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/rand/normal.go.html">normal.go</a></li>
<li><a href="/gostd/math/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/math/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/math/rand/regress_test.go.html">regress_test.go</a></li>
<li><a href="/gostd/math/rand/rng.go.html">rng.go</a></li>
<li><a href="/gostd/math/rand/zipf.go.html">zipf.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3850816">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3850871">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3850925">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3850976">//&nbsp;W.Hormann,&nbsp;G.Derflinger:</span><br>
<span class="lineno"></span><span class="comment" id="3851004">//&nbsp;&#34;Rejection-Inversion&nbsp;to&nbsp;Generate&nbsp;Variates</span><br>
<span class="lineno"></span><span class="comment" id="3851049">//&nbsp;from&nbsp;Monotone&nbsp;Discrete&nbsp;Distributions&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3851090">//&nbsp;http://eeyore.wu-wien.ac.at/papers/96-04-04.wh-der.ps.gz</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="3851151">package</span>&nbsp;<span class="ident" id="3851159">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3851165">import</span>&nbsp;<span class="string" id="3851172">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3851180">//&nbsp;A&nbsp;Zipf&nbsp;generates&nbsp;Zipf&nbsp;distributed&nbsp;variates.</span><br>
<span class="lineno">15</span><span class="keyword" id="3851227">type</span>&nbsp;<span class="ident" id="3851232">Zipf</span>&nbsp;<span class="keyword" id="3851237">struct</span>&nbsp;<span class="op" id="3851244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851247">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3851260">*</span><span class="ident" id="3851261">Rand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851267">imax</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3851280">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851289">v</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3851302">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851311">q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3851324">float64</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851333">s</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3851346">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851355">oneminusQ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3851368">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851377">oneminusQinv</span>&nbsp;<span class="builtintype" id="3851390">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851399">hxm</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3851412">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851421">hx0minusHxm</span>&nbsp;&nbsp;<span class="builtintype" id="3851434">float64</span><br>
<span class="lineno">25</span><span class="op" id="3851442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3851445">func</span>&nbsp;<span class="op" id="3851450">(</span><span class="ident" id="3851451">z</span>&nbsp;<span class="op" id="3851453">*</span><span class="ident" id="3851454">Zipf</span><span class="op" id="3851458">)</span>&nbsp;<span class="ident" id="3851460">h</span><span class="op" id="3851461">(</span><span class="ident" id="3851462">x</span>&nbsp;<span class="builtintype" id="3851464">float64</span><span class="op" id="3851471">)</span>&nbsp;<span class="builtintype" id="3851473">float64</span>&nbsp;<span class="op" id="3851481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851484">return</span>&nbsp;<span class="ident" id="3851491">math</span><span class="op" id="3851495">.</span><span class="ident" id="3851496">Exp</span><span class="op" id="3851499">(</span><span class="ident" id="3851500">z</span><span class="op" id="3851501">.</span><span class="ident" id="3851502">oneminusQ</span><span class="op" id="3851511">*</span><span class="ident" id="3851512">math</span><span class="op" id="3851516">.</span><span class="ident" id="3851517">Log</span><span class="op" id="3851520">(</span><span class="ident" id="3851521">z</span><span class="op" id="3851522">.</span><span class="ident" id="3851523">v</span><span class="op" id="3851524">+</span><span class="ident" id="3851525">x</span><span class="op" id="3851526">)</span><span class="op" id="3851527">)</span>&nbsp;<span class="op" id="3851529">*</span>&nbsp;<span class="ident" id="3851531">z</span><span class="op" id="3851532">.</span><span class="ident" id="3851533">oneminusQinv</span><br>
<span class="lineno"></span><span class="op" id="3851546">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="3851549">func</span>&nbsp;<span class="op" id="3851554">(</span><span class="ident" id="3851555">z</span>&nbsp;<span class="op" id="3851557">*</span><span class="ident" id="3851558">Zipf</span><span class="op" id="3851562">)</span>&nbsp;<span class="ident" id="3851564">hinv</span><span class="op" id="3851568">(</span><span class="ident" id="3851569">x</span>&nbsp;<span class="builtintype" id="3851571">float64</span><span class="op" id="3851578">)</span>&nbsp;<span class="builtintype" id="3851580">float64</span>&nbsp;<span class="op" id="3851588">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851591">return</span>&nbsp;<span class="ident" id="3851598">math</span><span class="op" id="3851602">.</span><span class="ident" id="3851603">Exp</span><span class="op" id="3851606">(</span><span class="ident" id="3851607">z</span><span class="op" id="3851608">.</span><span class="ident" id="3851609">oneminusQinv</span><span class="op" id="3851621">*</span><span class="ident" id="3851622">math</span><span class="op" id="3851626">.</span><span class="ident" id="3851627">Log</span><span class="op" id="3851630">(</span><span class="ident" id="3851631">z</span><span class="op" id="3851632">.</span><span class="ident" id="3851633">oneminusQ</span><span class="op" id="3851642">*</span><span class="ident" id="3851643">x</span><span class="op" id="3851644">)</span><span class="op" id="3851645">)</span>&nbsp;<span class="op" id="3851647">-</span>&nbsp;<span class="ident" id="3851649">z</span><span class="op" id="3851650">.</span><span class="ident" id="3851651">v</span><br>
<span class="lineno"></span><span class="op" id="3851653">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="3851656">//&nbsp;NewZipf&nbsp;returns&nbsp;a&nbsp;Zipf&nbsp;generating&nbsp;variates&nbsp;p(k)&nbsp;on&nbsp;[0,&nbsp;imax]</span><br>
<span class="lineno"></span><span class="comment" id="3851720">//&nbsp;proportional&nbsp;to&nbsp;(v+k)**(-s)&nbsp;where&nbsp;s&gt;1&nbsp;and&nbsp;k&gt;=0,&nbsp;and&nbsp;v&gt;=1.</span><br>
<span class="lineno"></span><span class="keyword" id="3851781">func</span>&nbsp;<span class="ident" id="3851786">NewZipf</span><span class="op" id="3851793">(</span><span class="ident" id="3851794">r</span>&nbsp;<span class="op" id="3851796">*</span><span class="ident" id="3851797">Rand</span><span class="op" id="3851801">,</span>&nbsp;<span class="ident" id="3851803">s</span>&nbsp;<span class="builtintype" id="3851805">float64</span><span class="op" id="3851812">,</span>&nbsp;<span class="ident" id="3851814">v</span>&nbsp;<span class="builtintype" id="3851816">float64</span><span class="op" id="3851823">,</span>&nbsp;<span class="ident" id="3851825">imax</span>&nbsp;<span class="ident" id="3851830">uint64</span><span class="op" id="3851836">)</span>&nbsp;<span class="op" id="3851838">*</span><span class="ident" id="3851839">Zipf</span>&nbsp;<span class="op" id="3851844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851847">z</span>&nbsp;<span class="op" id="3851849">:=</span>&nbsp;<span class="builtinfunc" id="3851852">new</span><span class="op" id="3851855">(</span><span class="ident" id="3851856">Zipf</span><span class="op" id="3851860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851863">if</span>&nbsp;<span class="ident" id="3851866">s</span>&nbsp;<span class="op" id="3851868">&lt;=</span>&nbsp;<span class="num" id="3851871">1.0</span>&nbsp;<span class="op" id="3851875">||</span>&nbsp;<span class="ident" id="3851878">v</span>&nbsp;<span class="op" id="3851880">&lt;</span>&nbsp;<span class="num" id="3851882">1</span>&nbsp;<span class="op" id="3851884">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3851888">return</span>&nbsp;<span class="ident" id="3851895">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3851900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851903">z</span><span class="op" id="3851904">.</span><span class="ident" id="3851905">r</span>&nbsp;<span class="op" id="3851907">=</span>&nbsp;<span class="ident" id="3851909">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851912">z</span><span class="op" id="3851913">.</span><span class="ident" id="3851914">imax</span>&nbsp;<span class="op" id="3851919">=</span>&nbsp;<span class="builtintype" id="3851921">float64</span><span class="op" id="3851928">(</span><span class="ident" id="3851929">imax</span><span class="op" id="3851933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851936">z</span><span class="op" id="3851937">.</span><span class="ident" id="3851938">v</span>&nbsp;<span class="op" id="3851940">=</span>&nbsp;<span class="ident" id="3851942">v</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851945">z</span><span class="op" id="3851946">.</span><span class="ident" id="3851947">q</span>&nbsp;<span class="op" id="3851949">=</span>&nbsp;<span class="ident" id="3851951">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851954">z</span><span class="op" id="3851955">.</span><span class="ident" id="3851956">oneminusQ</span>&nbsp;<span class="op" id="3851966">=</span>&nbsp;<span class="num" id="3851968">1.0</span>&nbsp;<span class="op" id="3851972">-</span>&nbsp;<span class="ident" id="3851974">z</span><span class="op" id="3851975">.</span><span class="ident" id="3851976">q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3851979">z</span><span class="op" id="3851980">.</span><span class="ident" id="3851981">oneminusQinv</span>&nbsp;<span class="op" id="3851994">=</span>&nbsp;<span class="num" id="3851996">1.0</span>&nbsp;<span class="op" id="3852000">/</span>&nbsp;<span class="ident" id="3852002">z</span><span class="op" id="3852003">.</span><span class="ident" id="3852004">oneminusQ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852015">z</span><span class="op" id="3852016">.</span><span class="ident" id="3852017">hxm</span>&nbsp;<span class="op" id="3852021">=</span>&nbsp;<span class="ident" id="3852023">z</span><span class="op" id="3852024">.</span><span class="ident" id="3852025">h</span><span class="op" id="3852026">(</span><span class="ident" id="3852027">z</span><span class="op" id="3852028">.</span><span class="ident" id="3852029">imax</span>&nbsp;<span class="op" id="3852034">+</span>&nbsp;<span class="num" id="3852036">0.5</span><span class="op" id="3852039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852042">z</span><span class="op" id="3852043">.</span><span class="ident" id="3852044">hx0minusHxm</span>&nbsp;<span class="op" id="3852056">=</span>&nbsp;<span class="ident" id="3852058">z</span><span class="op" id="3852059">.</span><span class="ident" id="3852060">h</span><span class="op" id="3852061">(</span><span class="num" id="3852062">0.5</span><span class="op" id="3852065">)</span>&nbsp;<span class="op" id="3852067">-</span>&nbsp;<span class="ident" id="3852069">math</span><span class="op" id="3852073">.</span><span class="ident" id="3852074">Exp</span><span class="op" id="3852077">(</span><span class="ident" id="3852078">math</span><span class="op" id="3852082">.</span><span class="ident" id="3852083">Log</span><span class="op" id="3852086">(</span><span class="ident" id="3852087">z</span><span class="op" id="3852088">.</span><span class="ident" id="3852089">v</span><span class="op" id="3852090">)</span><span class="op" id="3852091">*</span><span class="op" id="3852092">(</span><span class="op" id="3852093">-</span><span class="ident" id="3852094">z</span><span class="op" id="3852095">.</span><span class="ident" id="3852096">q</span><span class="op" id="3852097">)</span><span class="op" id="3852098">)</span>&nbsp;<span class="op" id="3852100">-</span>&nbsp;<span class="ident" id="3852102">z</span><span class="op" id="3852103">.</span><span class="ident" id="3852104">hxm</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852109">z</span><span class="op" id="3852110">.</span><span class="ident" id="3852111">s</span>&nbsp;<span class="op" id="3852113">=</span>&nbsp;<span class="num" id="3852115">1</span>&nbsp;<span class="op" id="3852117">-</span>&nbsp;<span class="ident" id="3852119">z</span><span class="op" id="3852120">.</span><span class="ident" id="3852121">hinv</span><span class="op" id="3852125">(</span><span class="ident" id="3852126">z</span><span class="op" id="3852127">.</span><span class="ident" id="3852128">h</span><span class="op" id="3852129">(</span><span class="num" id="3852130">1.5</span><span class="op" id="3852133">)</span><span class="op" id="3852134">-</span><span class="ident" id="3852135">math</span><span class="op" id="3852139">.</span><span class="ident" id="3852140">Exp</span><span class="op" id="3852143">(</span><span class="op" id="3852144">-</span><span class="ident" id="3852145">z</span><span class="op" id="3852146">.</span><span class="ident" id="3852147">q</span><span class="op" id="3852148">*</span><span class="ident" id="3852149">math</span><span class="op" id="3852153">.</span><span class="ident" id="3852154">Log</span><span class="op" id="3852157">(</span><span class="ident" id="3852158">z</span><span class="op" id="3852159">.</span><span class="ident" id="3852160">v</span><span class="op" id="3852161">+</span><span class="num" id="3852162">1.0</span><span class="op" id="3852165">)</span><span class="op" id="3852166">)</span><span class="op" id="3852167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852170">return</span>&nbsp;<span class="ident" id="3852177">z</span><br>
<span class="lineno"></span><span class="op" id="3852179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3852182">//&nbsp;Uint64&nbsp;returns&nbsp;a&nbsp;value&nbsp;drawn&nbsp;from&nbsp;the&nbsp;Zipf&nbsp;distribution&nbsp;described</span><br>
<span class="lineno">55</span><span class="comment" id="3852251">//&nbsp;by&nbsp;the&nbsp;Zipf&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="3852274">func</span>&nbsp;<span class="op" id="3852279">(</span><span class="ident" id="3852280">z</span>&nbsp;<span class="op" id="3852282">*</span><span class="ident" id="3852283">Zipf</span><span class="op" id="3852287">)</span>&nbsp;<span class="ident" id="3852289">Uint64</span><span class="op" id="3852295">(</span><span class="op" id="3852296">)</span>&nbsp;<span class="ident" id="3852298">uint64</span>&nbsp;<span class="op" id="3852305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852308">if</span>&nbsp;<span class="ident" id="3852311">z</span>&nbsp;<span class="op" id="3852313">==</span>&nbsp;<span class="ident" id="3852316">nil</span>&nbsp;<span class="op" id="3852320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3852324">panic</span><span class="op" id="3852329">(</span><span class="string" id="3852330">&#34;rand:&nbsp;nil&nbsp;Zipf&#34;</span><span class="op" id="3852346">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3852349">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852352">k</span>&nbsp;<span class="op" id="3852354">:=</span>&nbsp;<span class="num" id="3852357">0.0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852363">for</span>&nbsp;<span class="op" id="3852367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852371">r</span>&nbsp;<span class="op" id="3852373">:=</span>&nbsp;<span class="ident" id="3852376">z</span><span class="op" id="3852377">.</span><span class="ident" id="3852378">r</span><span class="op" id="3852379">.</span><span class="ident" id="3852380">Float64</span><span class="op" id="3852387">(</span><span class="op" id="3852388">)</span>&nbsp;<span class="comment" id="3852390">//&nbsp;r&nbsp;on&nbsp;[0,1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852406">ur</span>&nbsp;<span class="op" id="3852409">:=</span>&nbsp;<span class="ident" id="3852412">z</span><span class="op" id="3852413">.</span><span class="ident" id="3852414">hxm</span>&nbsp;<span class="op" id="3852418">+</span>&nbsp;<span class="ident" id="3852420">r</span><span class="op" id="3852421">*</span><span class="ident" id="3852422">z</span><span class="op" id="3852423">.</span><span class="ident" id="3852424">hx0minusHxm</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852438">x</span>&nbsp;<span class="op" id="3852440">:=</span>&nbsp;<span class="ident" id="3852443">z</span><span class="op" id="3852444">.</span><span class="ident" id="3852445">hinv</span><span class="op" id="3852449">(</span><span class="ident" id="3852450">ur</span><span class="op" id="3852452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3852456">k</span>&nbsp;<span class="op" id="3852458">=</span>&nbsp;<span class="ident" id="3852460">math</span><span class="op" id="3852464">.</span><span class="ident" id="3852465">Floor</span><span class="op" id="3852470">(</span><span class="ident" id="3852471">x</span>&nbsp;<span class="op" id="3852473">+</span>&nbsp;<span class="num" id="3852475">0.5</span><span class="op" id="3852478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852482">if</span>&nbsp;<span class="ident" id="3852485">k</span><span class="op" id="3852486">-</span><span class="ident" id="3852487">x</span>&nbsp;<span class="op" id="3852489">&lt;=</span>&nbsp;<span class="ident" id="3852492">z</span><span class="op" id="3852493">.</span><span class="ident" id="3852494">s</span>&nbsp;<span class="op" id="3852496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852501">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3852509">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852513">if</span>&nbsp;<span class="ident" id="3852516">ur</span>&nbsp;<span class="op" id="3852519">&gt;=</span>&nbsp;<span class="ident" id="3852522">z</span><span class="op" id="3852523">.</span><span class="ident" id="3852524">h</span><span class="op" id="3852525">(</span><span class="ident" id="3852526">k</span><span class="op" id="3852527">+</span><span class="num" id="3852528">0.5</span><span class="op" id="3852531">)</span><span class="op" id="3852532">-</span><span class="ident" id="3852533">math</span><span class="op" id="3852537">.</span><span class="ident" id="3852538">Exp</span><span class="op" id="3852541">(</span><span class="op" id="3852542">-</span><span class="ident" id="3852543">math</span><span class="op" id="3852547">.</span><span class="ident" id="3852548">Log</span><span class="op" id="3852551">(</span><span class="ident" id="3852552">k</span><span class="op" id="3852553">+</span><span class="ident" id="3852554">z</span><span class="op" id="3852555">.</span><span class="ident" id="3852556">v</span><span class="op" id="3852557">)</span><span class="op" id="3852558">*</span><span class="ident" id="3852559">z</span><span class="op" id="3852560">.</span><span class="ident" id="3852561">q</span><span class="op" id="3852562">)</span>&nbsp;<span class="op" id="3852564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852569">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3852577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3852580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3852583">return</span>&nbsp;<span class="ident" id="3852590">uint64</span><span class="op" id="3852596">(</span><span class="ident" id="3852597">k</span><span class="op" id="3852598">)</span><br>
<span class="lineno">75</span><span class="op" id="3852600">}</span>
</div>
</body>
</html>
