<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3792570">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3792625">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3792679">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3792730">//&nbsp;This&nbsp;file&nbsp;implements&nbsp;multi-precision&nbsp;rational&nbsp;numbers.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3792789">package</span>&nbsp;<span class="ident" id="3792797">big</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3792802">import</span>&nbsp;<span class="op" id="3792809">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3792812">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3792831">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3792841">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3792848">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3792856">&#34;strings&#34;</span><br>
<span class="lineno">15</span><span class="op" id="3792866">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3792869">//&nbsp;A&nbsp;Rat&nbsp;represents&nbsp;a&nbsp;quotient&nbsp;a/b&nbsp;of&nbsp;arbitrary&nbsp;precision.</span><br>
<span class="lineno"></span><span class="comment" id="3792928">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;for&nbsp;a&nbsp;Rat&nbsp;represents&nbsp;the&nbsp;value&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword" id="3792980">type</span>&nbsp;<span class="ident" id="3792985">Rat</span>&nbsp;<span class="keyword" id="3792989">struct</span>&nbsp;<span class="op" id="3792996">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3792999">//&nbsp;To&nbsp;make&nbsp;zero&nbsp;values&nbsp;for&nbsp;Rat&nbsp;work&nbsp;w/o&nbsp;initialization,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793056">//&nbsp;a&nbsp;zero&nbsp;value&nbsp;of&nbsp;b&nbsp;(len(b)&nbsp;==&nbsp;0)&nbsp;acts&nbsp;like&nbsp;b&nbsp;==&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793110">//&nbsp;a.neg&nbsp;determines&nbsp;the&nbsp;sign&nbsp;of&nbsp;the&nbsp;Rat,&nbsp;b.neg&nbsp;is&nbsp;ignored.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3793170">a</span><span class="op" id="3793171">,</span>&nbsp;<span class="ident" id="3793173">b</span>&nbsp;<span class="ident" id="3793175"><a href="/math/big/int.go.html#3732722">Int</a></span><br>
<span class="lineno"></span><span class="op" id="3793179">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="comment" id="3793182">//&nbsp;NewRat&nbsp;creates&nbsp;a&nbsp;new&nbsp;Rat&nbsp;with&nbsp;numerator&nbsp;a&nbsp;and&nbsp;denominator&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="3793246">func</span>&nbsp;<span class="ident" id="3793251">NewRat</span><span class="op" id="3793257">(</span><span class="ident" id="3793258">a</span><span class="op" id="3793259">,</span>&nbsp;<span class="ident" id="3793261">b</span>&nbsp;<span class="ident" id="3793263">int64</span><span class="op" id="3793268">)</span>&nbsp;<span class="op" id="3793270">*</span><span class="ident" id="3793271"><a href="/math/big/rat.go.html#3792985">Rat</a></span>&nbsp;<span class="op" id="3793275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3793278">return</span>&nbsp;<span class="builtinfunc" id="3793285">new</span><span class="op" id="3793288">(</span><span class="ident" id="3793289"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3793292">)</span><span class="op" id="3793293">.</span><span class="ident" id="3793294">SetFrac64</span><span class="op" id="3793303">(</span><span class="ident" id="3793304"><a href="/math/big/rat.go.html#3793258">a</a></span><span class="op" id="3793305">,</span>&nbsp;<span class="ident" id="3793307"><a href="/math/big/rat.go.html#3793261">b</a></span><span class="op" id="3793308">)</span><br>
<span class="lineno"></span><span class="op" id="3793310">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="3793313">//&nbsp;SetFloat64&nbsp;sets&nbsp;z&nbsp;to&nbsp;exactly&nbsp;f&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="comment" id="3793362">//&nbsp;If&nbsp;f&nbsp;is&nbsp;not&nbsp;finite,&nbsp;SetFloat&nbsp;returns&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="3793407">func</span>&nbsp;<span class="op" id="3793412">(</span><span class="ident" id="3793413">z</span>&nbsp;<span class="op" id="3793415">*</span><span class="ident" id="3793416"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3793419">)</span>&nbsp;<span class="ident" id="3793421">SetFloat64</span><span class="op" id="3793431">(</span><span class="ident" id="3793432">f</span>&nbsp;<span class="builtintype" id="3793434">float64</span><span class="op" id="3793441">)</span>&nbsp;<span class="op" id="3793443">*</span><span class="ident" id="3793444"><a href="/math/big/rat.go.html#3792985">Rat</a></span>&nbsp;<span class="op" id="3793448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3793451">const</span>&nbsp;<span class="ident" id="3793457">expMask</span>&nbsp;<span class="op" id="3793465">=</span>&nbsp;<span class="num" id="3793467">1</span><span class="op" id="3793468">&lt;&lt;</span><span class="num" id="3793470">11</span>&nbsp;<span class="op" id="3793473">-</span>&nbsp;<span class="num" id="3793475">1</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3793478">bits</span>&nbsp;<span class="op" id="3793483">:=</span>&nbsp;<span class="ident" id="3793486"><a href="/math/big/rat.go.html#3792848">math</a></span><span class="op" id="3793490">.</span><span class="ident" id="3793491">Float64bits</span><span class="op" id="3793502">(</span><span class="ident" id="3793503"><a href="/math/big/rat.go.html#3793432">f</a></span><span class="op" id="3793504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3793507">mantissa</span>&nbsp;<span class="op" id="3793516">:=</span>&nbsp;<span class="ident" id="3793519"><a href="/math/big/rat.go.html#3793478">bits</a></span>&nbsp;<span class="op" id="3793524">&amp;</span>&nbsp;<span class="op" id="3793526">(</span><span class="num" id="3793527">1</span><span class="op" id="3793528">&lt;&lt;</span><span class="num" id="3793530">52</span>&nbsp;<span class="op" id="3793533">-</span>&nbsp;<span class="num" id="3793535">1</span><span class="op" id="3793536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3793539">exp</span>&nbsp;<span class="op" id="3793543">:=</span>&nbsp;<span class="builtintype" id="3793546">int</span><span class="op" id="3793549">(</span><span class="op" id="3793550">(</span><span class="ident" id="3793551"><a href="/math/big/rat.go.html#3793478">bits</a></span>&nbsp;<span class="op" id="3793556">&gt;&gt;</span>&nbsp;<span class="num" id="3793559">52</span><span class="op" id="3793561">)</span>&nbsp;<span class="op" id="3793563">&amp;</span>&nbsp;<span class="ident" id="3793565"><a href="/math/big/rat.go.html#3793457">expMask</a></span><span class="op" id="3793572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3793575">switch</span>&nbsp;<span class="ident" id="3793582"><a href="/math/big/rat.go.html#3793539">exp</a></span>&nbsp;<span class="op" id="3793586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3793589">case</span>&nbsp;<span class="ident" id="3793594"><a href="/math/big/rat.go.html#3793457">expMask</a></span><span class="op" id="3793601">:</span>&nbsp;<span class="comment" id="3793603">//&nbsp;non-finite</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3793619">return</span>&nbsp;<span class="ident" id="3793626">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3793631">case</span>&nbsp;<span class="num" id="3793636">0</span><span class="op" id="3793637">:</span>&nbsp;<span class="comment" id="3793639">//&nbsp;denormal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3793653"><a href="/math/big/rat.go.html#3793539">exp</a></span>&nbsp;<span class="op" id="3793657">-=</span>&nbsp;<span class="num" id="3793660">1022</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3793666">default</span><span class="op" id="3793673">:</span>&nbsp;<span class="comment" id="3793675">//&nbsp;normal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3793687"><a href="/math/big/rat.go.html#3793507">mantissa</a></span>&nbsp;<span class="op" id="3793696">|=</span>&nbsp;<span class="num" id="3793699">1</span>&nbsp;<span class="op" id="3793701">&lt;&lt;</span>&nbsp;<span class="num" id="3793704">52</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3793709"><a href="/math/big/rat.go.html#3793539">exp</a></span>&nbsp;<span class="op" id="3793713">-=</span>&nbsp;<span class="num" id="3793716">1023</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3793722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3793726">shift</span>&nbsp;<span class="op" id="3793732">:=</span>&nbsp;<span class="num" id="3793735">52</span>&nbsp;<span class="op" id="3793738">-</span>&nbsp;<span class="ident" id="3793740"><a href="/math/big/rat.go.html#3793539">exp</a></span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3793746">//&nbsp;Optimization&nbsp;(?):&nbsp;partially&nbsp;pre-normalise.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3793793">for</span>&nbsp;<span class="ident" id="3793797"><a href="/math/big/rat.go.html#3793507">mantissa</a></span><span class="op" id="3793805">&amp;</span><span class="num" id="3793806">1</span>&nbsp;<span class="op" id="3793808">==</span>&nbsp;<span class="num" id="3793811">0</span>&nbsp;<span class="op" id="3793813">&amp;&amp;</span>&nbsp;<span class="ident" id="3793816"><a href="/math/big/rat.go.html#3793726">shift</a></span>&nbsp;<span class="op" id="3793822">&gt;</span>&nbsp;<span class="num" id="3793824">0</span>&nbsp;<span class="op" id="3793826">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3793830"><a href="/math/big/rat.go.html#3793507">mantissa</a></span>&nbsp;<span class="op" id="3793839">&gt;&gt;=</span>&nbsp;<span class="num" id="3793843">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3793847"><a href="/math/big/rat.go.html#3793726">shift</a></span><span class="op" id="3793852">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3793856">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3793860"><a href="/math/big/rat.go.html#3793413">z</a></span><span class="op" id="3793861">.</span><span class="ident" id="3793862">a</span><span class="op" id="3793863">.</span><span class="ident" id="3793864">SetUint64</span><span class="op" id="3793873">(</span><span class="ident" id="3793874"><a href="/math/big/rat.go.html#3793507">mantissa</a></span><span class="op" id="3793882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3793885"><a href="/math/big/rat.go.html#3793413">z</a></span><span class="op" id="3793886">.</span><span class="ident" id="3793887">a</span><span class="op" id="3793888">.</span><span class="ident" id="3793889">neg</span>&nbsp;<span class="op" id="3793893">=</span>&nbsp;<span class="ident" id="3793895"><a href="/math/big/rat.go.html#3793432">f</a></span>&nbsp;<span class="op" id="3793897">&lt;</span>&nbsp;<span class="num" id="3793899">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3793902"><a href="/math/big/rat.go.html#3793413">z</a></span><span class="op" id="3793903">.</span><span class="ident" id="3793904">b</span><span class="op" id="3793905">.</span><span class="ident" id="3793906">Set</span><span class="op" id="3793909">(</span><span class="ident" id="3793910"><a href="/math/big/int.go.html#3732803">intOne</a></span><span class="op" id="3793916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3793919">if</span>&nbsp;<span class="ident" id="3793922"><a href="/math/big/rat.go.html#3793726">shift</a></span>&nbsp;<span class="op" id="3793928">&gt;</span>&nbsp;<span class="num" id="3793930">0</span>&nbsp;<span class="op" id="3793932">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3793936"><a href="/math/big/rat.go.html#3793413">z</a></span><span class="op" id="3793937">.</span><span class="ident" id="3793938">b</span><span class="op" id="3793939">.</span><span class="ident" id="3793940">Lsh</span><span class="op" id="3793943">(</span><span class="op" id="3793944">&amp;</span><span class="ident" id="3793945"><a href="/math/big/rat.go.html#3793413">z</a></span><span class="op" id="3793946">.</span><span class="ident" id="3793947">b</span><span class="op" id="3793948">,</span>&nbsp;<span class="builtintype" id="3793950">uint</span><span class="op" id="3793954">(</span><span class="ident" id="3793955"><a href="/math/big/rat.go.html#3793726">shift</a></span><span class="op" id="3793960">)</span><span class="op" id="3793961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3793964">}</span>&nbsp;<span class="keyword" id="3793966">else</span>&nbsp;<span class="op" id="3793971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3793975"><a href="/math/big/rat.go.html#3793413">z</a></span><span class="op" id="3793976">.</span><span class="ident" id="3793977">a</span><span class="op" id="3793978">.</span><span class="ident" id="3793979">Lsh</span><span class="op" id="3793982">(</span><span class="op" id="3793983">&amp;</span><span class="ident" id="3793984"><a href="/math/big/rat.go.html#3793413">z</a></span><span class="op" id="3793985">.</span><span class="ident" id="3793986">a</span><span class="op" id="3793987">,</span>&nbsp;<span class="builtintype" id="3793989">uint</span><span class="op" id="3793993">(</span><span class="op" id="3793994">-</span><span class="ident" id="3793995"><a href="/math/big/rat.go.html#3793726">shift</a></span><span class="op" id="3794000">)</span><span class="op" id="3794001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3794004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3794007">return</span>&nbsp;<span class="ident" id="3794014"><a href="/math/big/rat.go.html#3793413">z</a></span><span class="op" id="3794015">.</span><span class="ident" id="3794016">norm</span><span class="op" id="3794020">(</span><span class="op" id="3794021">)</span><br>
<span class="lineno">65</span><span class="op" id="3794023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3794026">//&nbsp;quotToFloat32&nbsp;returns&nbsp;the&nbsp;non-negative&nbsp;float32&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="3794082">//&nbsp;nearest&nbsp;to&nbsp;the&nbsp;quotient&nbsp;a/b,&nbsp;using&nbsp;round-to-even&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3794137">//&nbsp;halfway&nbsp;cases.&nbsp;&nbsp;It&nbsp;does&nbsp;not&nbsp;mutate&nbsp;its&nbsp;arguments.</span><br>
<span class="lineno">70</span><span class="comment" id="3794190">//&nbsp;Preconditions:&nbsp;b&nbsp;is&nbsp;non-zero;&nbsp;a&nbsp;and&nbsp;b&nbsp;have&nbsp;no&nbsp;common&nbsp;factors.</span><br>
<span class="lineno"></span><span class="keyword" id="3794255">func</span>&nbsp;<span class="ident" id="3794260">quotToFloat32</span><span class="op" id="3794273">(</span><span class="ident" id="3794274">a</span><span class="op" id="3794275">,</span>&nbsp;<span class="ident" id="3794277">b</span>&nbsp;<span class="ident" id="3794279"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3794282">)</span>&nbsp;<span class="op" id="3794284">(</span><span class="ident" id="3794285">f</span>&nbsp;<span class="builtintype" id="3794287">float32</span><span class="op" id="3794294">,</span>&nbsp;<span class="ident" id="3794296">exact</span>&nbsp;<span class="builtintype" id="3794302">bool</span><span class="op" id="3794306">)</span>&nbsp;<span class="op" id="3794308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3794311">const</span>&nbsp;<span class="op" id="3794317">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794321">//&nbsp;float&nbsp;size&nbsp;in&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794345">Fsize</span>&nbsp;<span class="op" id="3794351">=</span>&nbsp;<span class="num" id="3794353">32</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794359">//&nbsp;mantissa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794373">Msize</span>&nbsp;&nbsp;<span class="op" id="3794380">=</span>&nbsp;<span class="num" id="3794382">23</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794387">Msize1</span>&nbsp;<span class="op" id="3794394">=</span>&nbsp;<span class="ident" id="3794396"><a href="/math/big/rat.go.html#3794373">Msize</a></span>&nbsp;<span class="op" id="3794402">+</span>&nbsp;<span class="num" id="3794404">1</span>&nbsp;<span class="comment" id="3794406">//&nbsp;incl.&nbsp;implicit&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794428">Msize2</span>&nbsp;<span class="op" id="3794435">=</span>&nbsp;<span class="ident" id="3794437"><a href="/math/big/rat.go.html#3794387">Msize1</a></span>&nbsp;<span class="op" id="3794444">+</span>&nbsp;<span class="num" id="3794446">1</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794451">//&nbsp;exponent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794465">Esize</span>&nbsp;<span class="op" id="3794471">=</span>&nbsp;<span class="ident" id="3794473"><a href="/math/big/rat.go.html#3794345">Fsize</a></span>&nbsp;<span class="op" id="3794479">-</span>&nbsp;<span class="ident" id="3794481"><a href="/math/big/rat.go.html#3794387">Msize1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794490">Ebias</span>&nbsp;<span class="op" id="3794496">=</span>&nbsp;<span class="num" id="3794498">1</span><span class="op" id="3794499">&lt;&lt;</span><span class="op" id="3794501">(</span><span class="ident" id="3794502"><a href="/math/big/rat.go.html#3794465">Esize</a></span><span class="op" id="3794507">-</span><span class="num" id="3794508">1</span><span class="op" id="3794509">)</span>&nbsp;<span class="op" id="3794511">-</span>&nbsp;<span class="num" id="3794513">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794517">Emin</span>&nbsp;&nbsp;<span class="op" id="3794523">=</span>&nbsp;<span class="num" id="3794525">1</span>&nbsp;<span class="op" id="3794527">-</span>&nbsp;<span class="ident" id="3794529"><a href="/math/big/rat.go.html#3794490">Ebias</a></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794537">Emax</span>&nbsp;&nbsp;<span class="op" id="3794543">=</span>&nbsp;<span class="ident" id="3794545"><a href="/math/big/rat.go.html#3794490">Ebias</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3794552">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794556">//&nbsp;TODO(adonovan):&nbsp;specialize&nbsp;common&nbsp;degenerate&nbsp;cases:&nbsp;1.0,&nbsp;integers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794627">alen</span>&nbsp;<span class="op" id="3794632">:=</span>&nbsp;<span class="ident" id="3794635"><a href="/math/big/rat.go.html#3794274">a</a></span><span class="op" id="3794636">.</span><span class="ident" id="3794637">bitLen</span><span class="op" id="3794643">(</span><span class="op" id="3794644">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3794647">if</span>&nbsp;<span class="ident" id="3794650"><a href="/math/big/rat.go.html#3794627">alen</a></span>&nbsp;<span class="op" id="3794655">==</span>&nbsp;<span class="num" id="3794658">0</span>&nbsp;<span class="op" id="3794660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3794664">return</span>&nbsp;<span class="num" id="3794671">0</span><span class="op" id="3794672">,</span>&nbsp;<span class="builtintype" id="3794674">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3794680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3794683">blen</span>&nbsp;<span class="op" id="3794688">:=</span>&nbsp;<span class="ident" id="3794691"><a href="/math/big/rat.go.html#3794277">b</a></span><span class="op" id="3794692">.</span><span class="ident" id="3794693">bitLen</span><span class="op" id="3794699">(</span><span class="op" id="3794700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3794703">if</span>&nbsp;<span class="ident" id="3794706"><a href="/math/big/rat.go.html#3794683">blen</a></span>&nbsp;<span class="op" id="3794711">==</span>&nbsp;<span class="num" id="3794714">0</span>&nbsp;<span class="op" id="3794716">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3794720">panic</span><span class="op" id="3794725">(</span><span class="string" id="3794726">&#34;division&nbsp;by&nbsp;zero&#34;</span><span class="op" id="3794744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3794747">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794751">//&nbsp;1.&nbsp;Left-shift&nbsp;A&nbsp;or&nbsp;B&nbsp;such&nbsp;that&nbsp;quotient&nbsp;A/B&nbsp;is&nbsp;in&nbsp;[1&lt;&lt;Msize1,&nbsp;1&lt;&lt;(Msize2+1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794831">//&nbsp;(Msize2&nbsp;bits&nbsp;if&nbsp;A&nbsp;&lt;&nbsp;B&nbsp;when&nbsp;they&nbsp;are&nbsp;left-aligned,&nbsp;Msize2+1&nbsp;bits&nbsp;if&nbsp;A&nbsp;&gt;=&nbsp;B).</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794911">//&nbsp;This&nbsp;is&nbsp;2&nbsp;or&nbsp;3&nbsp;more&nbsp;than&nbsp;the&nbsp;float32&nbsp;mantissa&nbsp;field&nbsp;width&nbsp;of&nbsp;Msize:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3794983">//&nbsp;-&nbsp;the&nbsp;optional&nbsp;extra&nbsp;bit&nbsp;is&nbsp;shifted&nbsp;away&nbsp;in&nbsp;step&nbsp;3&nbsp;below.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795045">//&nbsp;-&nbsp;the&nbsp;high-order&nbsp;1&nbsp;is&nbsp;omitted&nbsp;in&nbsp;&#34;normal&#34;&nbsp;representation;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795107">//&nbsp;-&nbsp;the&nbsp;low-order&nbsp;1&nbsp;will&nbsp;be&nbsp;used&nbsp;during&nbsp;rounding&nbsp;then&nbsp;discarded.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795174">exp</span>&nbsp;<span class="op" id="3795178">:=</span>&nbsp;<span class="ident" id="3795181"><a href="/math/big/rat.go.html#3794627">alen</a></span>&nbsp;<span class="op" id="3795186">-</span>&nbsp;<span class="ident" id="3795188"><a href="/math/big/rat.go.html#3794683">blen</a></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3795194">var</span>&nbsp;<span class="ident" id="3795198">a2</span><span class="op" id="3795200">,</span>&nbsp;<span class="ident" id="3795202">b2</span>&nbsp;<span class="ident" id="3795205"><a href="/math/big/nat.go.html#3758892">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795210"><a href="/math/big/rat.go.html#3795198">a2</a></span>&nbsp;<span class="op" id="3795213">=</span>&nbsp;<span class="ident" id="3795215"><a href="/math/big/rat.go.html#3795198">a2</a></span><span class="op" id="3795217">.</span><span class="ident" id="3795218">set</span><span class="op" id="3795221">(</span><span class="ident" id="3795222"><a href="/math/big/rat.go.html#3794274">a</a></span><span class="op" id="3795223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795226"><a href="/math/big/rat.go.html#3795202">b2</a></span>&nbsp;<span class="op" id="3795229">=</span>&nbsp;<span class="ident" id="3795231"><a href="/math/big/rat.go.html#3795202">b2</a></span><span class="op" id="3795233">.</span><span class="ident" id="3795234">set</span><span class="op" id="3795237">(</span><span class="ident" id="3795238"><a href="/math/big/rat.go.html#3794277">b</a></span><span class="op" id="3795239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3795242">if</span>&nbsp;<span class="ident" id="3795245">shift</span>&nbsp;<span class="op" id="3795251">:=</span>&nbsp;<span class="ident" id="3795254"><a href="/math/big/rat.go.html#3794428">Msize2</a></span>&nbsp;<span class="op" id="3795261">-</span>&nbsp;<span class="ident" id="3795263"><a href="/math/big/rat.go.html#3795174">exp</a></span><span class="op" id="3795266">;</span>&nbsp;<span class="ident" id="3795268"><a href="/math/big/rat.go.html#3795245">shift</a></span>&nbsp;<span class="op" id="3795274">&gt;</span>&nbsp;<span class="num" id="3795276">0</span>&nbsp;<span class="op" id="3795278">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795282"><a href="/math/big/rat.go.html#3795198">a2</a></span>&nbsp;<span class="op" id="3795285">=</span>&nbsp;<span class="ident" id="3795287"><a href="/math/big/rat.go.html#3795198">a2</a></span><span class="op" id="3795289">.</span><span class="ident" id="3795290">shl</span><span class="op" id="3795293">(</span><span class="ident" id="3795294"><a href="/math/big/rat.go.html#3795198">a2</a></span><span class="op" id="3795296">,</span>&nbsp;<span class="builtintype" id="3795298">uint</span><span class="op" id="3795302">(</span><span class="ident" id="3795303"><a href="/math/big/rat.go.html#3795245">shift</a></span><span class="op" id="3795308">)</span><span class="op" id="3795309">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3795312">}</span>&nbsp;<span class="keyword" id="3795314">else</span>&nbsp;<span class="keyword" id="3795319">if</span>&nbsp;<span class="ident" id="3795322"><a href="/math/big/rat.go.html#3795245">shift</a></span>&nbsp;<span class="op" id="3795328">&lt;</span>&nbsp;<span class="num" id="3795330">0</span>&nbsp;<span class="op" id="3795332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795336"><a href="/math/big/rat.go.html#3795202">b2</a></span>&nbsp;<span class="op" id="3795339">=</span>&nbsp;<span class="ident" id="3795341"><a href="/math/big/rat.go.html#3795202">b2</a></span><span class="op" id="3795343">.</span><span class="ident" id="3795344">shl</span><span class="op" id="3795347">(</span><span class="ident" id="3795348"><a href="/math/big/rat.go.html#3795202">b2</a></span><span class="op" id="3795350">,</span>&nbsp;<span class="builtintype" id="3795352">uint</span><span class="op" id="3795356">(</span><span class="op" id="3795357">-</span><span class="ident" id="3795358"><a href="/math/big/rat.go.html#3795245">shift</a></span><span class="op" id="3795363">)</span><span class="op" id="3795364">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3795367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795371">//&nbsp;2.&nbsp;Compute&nbsp;quotient&nbsp;and&nbsp;remainder&nbsp;(q,&nbsp;r).&nbsp;&nbsp;NB:&nbsp;due&nbsp;to&nbsp;the</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795433">//&nbsp;extra&nbsp;shift,&nbsp;the&nbsp;low-order&nbsp;bit&nbsp;of&nbsp;q&nbsp;is&nbsp;logically&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795490">//&nbsp;high-order&nbsp;bit&nbsp;of&nbsp;r.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3795515">var</span>&nbsp;<span class="ident" id="3795519">q</span>&nbsp;<span class="ident" id="3795521"><a href="/math/big/nat.go.html#3758892">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795526"><a href="/math/big/rat.go.html#3795519">q</a></span><span class="op" id="3795527">,</span>&nbsp;<span class="ident" id="3795529">r</span>&nbsp;<span class="op" id="3795531">:=</span>&nbsp;<span class="ident" id="3795534"><a href="/math/big/rat.go.html#3795519">q</a></span><span class="op" id="3795535">.</span><span class="ident" id="3795536">div</span><span class="op" id="3795539">(</span><span class="ident" id="3795540"><a href="/math/big/rat.go.html#3795198">a2</a></span><span class="op" id="3795542">,</span>&nbsp;<span class="ident" id="3795544"><a href="/math/big/rat.go.html#3795198">a2</a></span><span class="op" id="3795546">,</span>&nbsp;<span class="ident" id="3795548"><a href="/math/big/rat.go.html#3795202">b2</a></span><span class="op" id="3795550">)</span>&nbsp;<span class="comment" id="3795552">//&nbsp;(recycle&nbsp;a2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795569">mantissa</span>&nbsp;<span class="op" id="3795578">:=</span>&nbsp;<span class="ident" id="3795581"><a href="/math/big/int.go.html#3745166">low32</a></span><span class="op" id="3795586">(</span><span class="ident" id="3795587"><a href="/math/big/rat.go.html#3795519">q</a></span><span class="op" id="3795588">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795591">haveRem</span>&nbsp;<span class="op" id="3795599">:=</span>&nbsp;<span class="builtinfunc" id="3795602">len</span><span class="op" id="3795605">(</span><span class="ident" id="3795606"><a href="/math/big/rat.go.html#3795529">r</a></span><span class="op" id="3795607">)</span>&nbsp;<span class="op" id="3795609">&gt;</span>&nbsp;<span class="num" id="3795611">0</span>&nbsp;<span class="comment" id="3795613">//&nbsp;mantissa&amp;1&nbsp;&amp;&amp;&nbsp;!haveRem&nbsp;=&gt;&nbsp;remainder&nbsp;is&nbsp;exactly&nbsp;half</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795670">//&nbsp;3.&nbsp;If&nbsp;quotient&nbsp;didn&#39;t&nbsp;fit&nbsp;in&nbsp;Msize2&nbsp;bits,&nbsp;redo&nbsp;division&nbsp;by&nbsp;b2&lt;&lt;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795739">//&nbsp;(in&nbsp;effect---we&nbsp;accomplish&nbsp;this&nbsp;incrementally).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3795791">if</span>&nbsp;<span class="ident" id="3795794"><a href="/math/big/rat.go.html#3795569">mantissa</a></span><span class="op" id="3795802">&gt;&gt;</span><span class="ident" id="3795804"><a href="/math/big/rat.go.html#3794428">Msize2</a></span>&nbsp;<span class="op" id="3795811">==</span>&nbsp;<span class="num" id="3795814">1</span>&nbsp;<span class="op" id="3795816">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3795820">if</span>&nbsp;<span class="ident" id="3795823"><a href="/math/big/rat.go.html#3795569">mantissa</a></span><span class="op" id="3795831">&amp;</span><span class="num" id="3795832">1</span>&nbsp;<span class="op" id="3795834">==</span>&nbsp;<span class="num" id="3795837">1</span>&nbsp;<span class="op" id="3795839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795844"><a href="/math/big/rat.go.html#3795591">haveRem</a></span>&nbsp;<span class="op" id="3795852">=</span>&nbsp;<span class="builtintype" id="3795854">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3795861">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795865"><a href="/math/big/rat.go.html#3795569">mantissa</a></span>&nbsp;<span class="op" id="3795874">&gt;&gt;=</span>&nbsp;<span class="num" id="3795878">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3795882"><a href="/math/big/rat.go.html#3795174">exp</a></span><span class="op" id="3795885">++</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3795889">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3795892">if</span>&nbsp;<span class="ident" id="3795895"><a href="/math/big/rat.go.html#3795569">mantissa</a></span><span class="op" id="3795903">&gt;&gt;</span><span class="ident" id="3795905"><a href="/math/big/rat.go.html#3794387">Msize1</a></span>&nbsp;<span class="op" id="3795912">!=</span>&nbsp;<span class="num" id="3795915">1</span>&nbsp;<span class="op" id="3795917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3795921">panic</span><span class="op" id="3795926">(</span><span class="ident" id="3795927"><a href="/math/big/rat.go.html#3792841">fmt</a></span><span class="op" id="3795930">.</span><span class="ident" id="3795931">Sprintf</span><span class="op" id="3795938">(</span><span class="string" id="3795939">&#34;expected&nbsp;exactly&nbsp;%d&nbsp;bits&nbsp;of&nbsp;result&#34;</span><span class="op" id="3795975">,</span>&nbsp;<span class="ident" id="3795977"><a href="/math/big/rat.go.html#3794428">Msize2</a></span><span class="op" id="3795983">)</span><span class="op" id="3795984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3795987">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3795991">//&nbsp;4.&nbsp;Rounding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3796008">if</span>&nbsp;<span class="ident" id="3796011"><a href="/math/big/rat.go.html#3794517">Emin</a></span><span class="op" id="3796015">-</span><span class="ident" id="3796016"><a href="/math/big/rat.go.html#3794373">Msize</a></span>&nbsp;<span class="op" id="3796022">&lt;=</span>&nbsp;<span class="ident" id="3796025"><a href="/math/big/rat.go.html#3795174">exp</a></span>&nbsp;<span class="op" id="3796029">&amp;&amp;</span>&nbsp;<span class="ident" id="3796032"><a href="/math/big/rat.go.html#3795174">exp</a></span>&nbsp;<span class="op" id="3796036">&lt;=</span>&nbsp;<span class="ident" id="3796039"><a href="/math/big/rat.go.html#3794517">Emin</a></span>&nbsp;<span class="op" id="3796044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796048">//&nbsp;Denormal&nbsp;case;&nbsp;lose&nbsp;&#39;shift&#39;&nbsp;bits&nbsp;of&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3796100">shift</span>&nbsp;<span class="op" id="3796106">:=</span>&nbsp;<span class="builtintype" id="3796109">uint</span><span class="op" id="3796113">(</span><span class="ident" id="3796114"><a href="/math/big/rat.go.html#3794517">Emin</a></span>&nbsp;<span class="op" id="3796119">-</span>&nbsp;<span class="op" id="3796121">(</span><span class="ident" id="3796122"><a href="/math/big/rat.go.html#3795174">exp</a></span>&nbsp;<span class="op" id="3796126">-</span>&nbsp;<span class="num" id="3796128">1</span><span class="op" id="3796129">)</span><span class="op" id="3796130">)</span>&nbsp;<span class="comment" id="3796132">//&nbsp;[1..Esize1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3796149">lostbits</span>&nbsp;<span class="op" id="3796158">:=</span>&nbsp;<span class="ident" id="3796161"><a href="/math/big/rat.go.html#3795569">mantissa</a></span>&nbsp;<span class="op" id="3796170">&amp;</span>&nbsp;<span class="op" id="3796172">(</span><span class="num" id="3796173">1</span><span class="op" id="3796174">&lt;&lt;</span><span class="ident" id="3796176"><a href="/math/big/rat.go.html#3796100">shift</a></span>&nbsp;<span class="op" id="3796182">-</span>&nbsp;<span class="num" id="3796184">1</span><span class="op" id="3796185">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3796189"><a href="/math/big/rat.go.html#3795591">haveRem</a></span>&nbsp;<span class="op" id="3796197">=</span>&nbsp;<span class="ident" id="3796199"><a href="/math/big/rat.go.html#3795591">haveRem</a></span>&nbsp;<span class="op" id="3796207">||</span>&nbsp;<span class="ident" id="3796210"><a href="/math/big/rat.go.html#3796149">lostbits</a></span>&nbsp;<span class="op" id="3796219">!=</span>&nbsp;<span class="num" id="3796222">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3796226"><a href="/math/big/rat.go.html#3795569">mantissa</a></span>&nbsp;<span class="op" id="3796235">&gt;&gt;=</span>&nbsp;<span class="ident" id="3796239"><a href="/math/big/rat.go.html#3796100">shift</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3796247"><a href="/math/big/rat.go.html#3795174">exp</a></span>&nbsp;<span class="op" id="3796251">=</span>&nbsp;<span class="num" id="3796253">2</span>&nbsp;<span class="op" id="3796255">-</span>&nbsp;<span class="ident" id="3796257"><a href="/math/big/rat.go.html#3794490">Ebias</a></span>&nbsp;<span class="comment" id="3796263">//&nbsp;==&nbsp;exp&nbsp;+&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3796282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796285">//&nbsp;Round&nbsp;q&nbsp;using&nbsp;round-half-to-even.</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3796323"><a href="/math/big/rat.go.html#3794296">exact</a></span>&nbsp;<span class="op" id="3796329">=</span>&nbsp;<span class="op" id="3796331">!</span><span class="ident" id="3796332"><a href="/math/big/rat.go.html#3795591">haveRem</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3796341">if</span>&nbsp;<span class="ident" id="3796344"><a href="/math/big/rat.go.html#3795569">mantissa</a></span><span class="op" id="3796352">&amp;</span><span class="num" id="3796353">1</span>&nbsp;<span class="op" id="3796355">!=</span>&nbsp;<span class="num" id="3796358">0</span>&nbsp;<span class="op" id="3796360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3796364"><a href="/math/big/rat.go.html#3794296">exact</a></span>&nbsp;<span class="op" id="3796370">=</span>&nbsp;<span class="builtintype" id="3796372">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3796380">if</span>&nbsp;<span class="ident" id="3796383"><a href="/math/big/rat.go.html#3795591">haveRem</a></span>&nbsp;<span class="op" id="3796391">||</span>&nbsp;<span class="ident" id="3796394"><a href="/math/big/rat.go.html#3795569">mantissa</a></span><span class="op" id="3796402">&amp;</span><span class="num" id="3796403">2</span>&nbsp;<span class="op" id="3796405">!=</span>&nbsp;<span class="num" id="3796408">0</span>&nbsp;<span class="op" id="3796410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3796415">if</span>&nbsp;<span class="ident" id="3796418"><a href="/math/big/rat.go.html#3795569">mantissa</a></span><span class="op" id="3796426">++</span><span class="op" id="3796428">;</span>&nbsp;<span class="ident" id="3796430"><a href="/math/big/rat.go.html#3795569">mantissa</a></span>&nbsp;<span class="op" id="3796439">&gt;=</span>&nbsp;<span class="num" id="3796442">1</span><span class="op" id="3796443">&lt;&lt;</span><span class="ident" id="3796445"><a href="/math/big/rat.go.html#3794428">Msize2</a></span>&nbsp;<span class="op" id="3796452">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3796458">//&nbsp;Complete&nbsp;rollover&nbsp;11...1&nbsp;=&gt;&nbsp;100...0,&nbsp;so&nbsp;shift&nbsp;is&nbsp;safe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3796519"><a href="/math/big/rat.go.html#3795569">mantissa</a></span>&nbsp;<span class="op" id="3796528">&gt;&gt;=</span>&nbsp;<span class="num" id="3796532">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3796538"><a href="/math/big/rat.go.html#3795174">exp</a></span><span class="op" id="3796541">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3796547">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3796551">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3796554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3796557"><a href="/math/big/rat.go.html#3795569">mantissa</a></span>&nbsp;<span class="op" id="3796566">&gt;&gt;=</span>&nbsp;<span class="num" id="3796570">1</span>&nbsp;<span class="comment" id="3796572">//&nbsp;discard&nbsp;rounding&nbsp;bit.&nbsp;&nbsp;Mantissa&nbsp;now&nbsp;scaled&nbsp;by&nbsp;1&lt;&lt;Msize1.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3796634"><a href="/math/big/rat.go.html#3794285">f</a></span>&nbsp;<span class="op" id="3796636">=</span>&nbsp;<span class="builtintype" id="3796638">float32</span><span class="op" id="3796645">(</span><span class="ident" id="3796646"><a href="/math/big/rat.go.html#3792848">math</a></span><span class="op" id="3796650">.</span><span class="ident" id="3796651">Ldexp</span><span class="op" id="3796656">(</span><span class="builtintype" id="3796657">float64</span><span class="op" id="3796664">(</span><span class="ident" id="3796665"><a href="/math/big/rat.go.html#3795569">mantissa</a></span><span class="op" id="3796673">)</span><span class="op" id="3796674">,</span>&nbsp;<span class="ident" id="3796676"><a href="/math/big/rat.go.html#3795174">exp</a></span><span class="op" id="3796679">-</span><span class="ident" id="3796680"><a href="/math/big/rat.go.html#3794387">Msize1</a></span><span class="op" id="3796686">)</span><span class="op" id="3796687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3796690">if</span>&nbsp;<span class="ident" id="3796693"><a href="/math/big/rat.go.html#3792848">math</a></span><span class="op" id="3796697">.</span><span class="ident" id="3796698">IsInf</span><span class="op" id="3796703">(</span><span class="builtintype" id="3796704">float64</span><span class="op" id="3796711">(</span><span class="ident" id="3796712"><a href="/math/big/rat.go.html#3794285">f</a></span><span class="op" id="3796713">)</span><span class="op" id="3796714">,</span>&nbsp;<span class="num" id="3796716">0</span><span class="op" id="3796717">)</span>&nbsp;<span class="op" id="3796719">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3796723"><a href="/math/big/rat.go.html#3794296">exact</a></span>&nbsp;<span class="op" id="3796729">=</span>&nbsp;<span class="builtintype" id="3796731">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3796738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3796741">return</span><br>
<span class="lineno"></span><span class="op" id="3796748">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="3796751">//&nbsp;quotToFloat64&nbsp;returns&nbsp;the&nbsp;non-negative&nbsp;float64&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="3796807">//&nbsp;nearest&nbsp;to&nbsp;the&nbsp;quotient&nbsp;a/b,&nbsp;using&nbsp;round-to-even&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3796862">//&nbsp;halfway&nbsp;cases.&nbsp;&nbsp;It&nbsp;does&nbsp;not&nbsp;mutate&nbsp;its&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="comment" id="3796915">//&nbsp;Preconditions:&nbsp;b&nbsp;is&nbsp;non-zero;&nbsp;a&nbsp;and&nbsp;b&nbsp;have&nbsp;no&nbsp;common&nbsp;factors.</span><br>
<span class="lineno"></span><span class="keyword" id="3796980">func</span>&nbsp;<span class="ident" id="3796985">quotToFloat64</span><span class="op" id="3796998">(</span><span class="ident" id="3796999">a</span><span class="op" id="3797000">,</span>&nbsp;<span class="ident" id="3797002">b</span>&nbsp;<span class="ident" id="3797004"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3797007">)</span>&nbsp;<span class="op" id="3797009">(</span><span class="ident" id="3797010">f</span>&nbsp;<span class="builtintype" id="3797012">float64</span><span class="op" id="3797019">,</span>&nbsp;<span class="ident" id="3797021">exact</span>&nbsp;<span class="builtintype" id="3797027">bool</span><span class="op" id="3797031">)</span>&nbsp;<span class="op" id="3797033">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3797036">const</span>&nbsp;<span class="op" id="3797042">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797046">//&nbsp;float&nbsp;size&nbsp;in&nbsp;bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797070">Fsize</span>&nbsp;<span class="op" id="3797076">=</span>&nbsp;<span class="num" id="3797078">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797084">//&nbsp;mantissa</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797098">Msize</span>&nbsp;&nbsp;<span class="op" id="3797105">=</span>&nbsp;<span class="num" id="3797107">52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797112">Msize1</span>&nbsp;<span class="op" id="3797119">=</span>&nbsp;<span class="ident" id="3797121"><a href="/math/big/rat.go.html#3797098">Msize</a></span>&nbsp;<span class="op" id="3797127">+</span>&nbsp;<span class="num" id="3797129">1</span>&nbsp;<span class="comment" id="3797131">//&nbsp;incl.&nbsp;implicit&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797153">Msize2</span>&nbsp;<span class="op" id="3797160">=</span>&nbsp;<span class="ident" id="3797162"><a href="/math/big/rat.go.html#3797112">Msize1</a></span>&nbsp;<span class="op" id="3797169">+</span>&nbsp;<span class="num" id="3797171">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797176">//&nbsp;exponent</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797190">Esize</span>&nbsp;<span class="op" id="3797196">=</span>&nbsp;<span class="ident" id="3797198"><a href="/math/big/rat.go.html#3797070">Fsize</a></span>&nbsp;<span class="op" id="3797204">-</span>&nbsp;<span class="ident" id="3797206"><a href="/math/big/rat.go.html#3797112">Msize1</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797215">Ebias</span>&nbsp;<span class="op" id="3797221">=</span>&nbsp;<span class="num" id="3797223">1</span><span class="op" id="3797224">&lt;&lt;</span><span class="op" id="3797226">(</span><span class="ident" id="3797227"><a href="/math/big/rat.go.html#3797190">Esize</a></span><span class="op" id="3797232">-</span><span class="num" id="3797233">1</span><span class="op" id="3797234">)</span>&nbsp;<span class="op" id="3797236">-</span>&nbsp;<span class="num" id="3797238">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797242">Emin</span>&nbsp;&nbsp;<span class="op" id="3797248">=</span>&nbsp;<span class="num" id="3797250">1</span>&nbsp;<span class="op" id="3797252">-</span>&nbsp;<span class="ident" id="3797254"><a href="/math/big/rat.go.html#3797215">Ebias</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797262">Emax</span>&nbsp;&nbsp;<span class="op" id="3797268">=</span>&nbsp;<span class="ident" id="3797270"><a href="/math/big/rat.go.html#3797215">Ebias</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3797277">)</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797281">//&nbsp;TODO(adonovan):&nbsp;specialize&nbsp;common&nbsp;degenerate&nbsp;cases:&nbsp;1.0,&nbsp;integers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797352">alen</span>&nbsp;<span class="op" id="3797357">:=</span>&nbsp;<span class="ident" id="3797360"><a href="/math/big/rat.go.html#3796999">a</a></span><span class="op" id="3797361">.</span><span class="ident" id="3797362">bitLen</span><span class="op" id="3797368">(</span><span class="op" id="3797369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3797372">if</span>&nbsp;<span class="ident" id="3797375"><a href="/math/big/rat.go.html#3797352">alen</a></span>&nbsp;<span class="op" id="3797380">==</span>&nbsp;<span class="num" id="3797383">0</span>&nbsp;<span class="op" id="3797385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3797389">return</span>&nbsp;<span class="num" id="3797396">0</span><span class="op" id="3797397">,</span>&nbsp;<span class="builtintype" id="3797399">true</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3797405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797408">blen</span>&nbsp;<span class="op" id="3797413">:=</span>&nbsp;<span class="ident" id="3797416"><a href="/math/big/rat.go.html#3797002">b</a></span><span class="op" id="3797417">.</span><span class="ident" id="3797418">bitLen</span><span class="op" id="3797424">(</span><span class="op" id="3797425">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3797428">if</span>&nbsp;<span class="ident" id="3797431"><a href="/math/big/rat.go.html#3797408">blen</a></span>&nbsp;<span class="op" id="3797436">==</span>&nbsp;<span class="num" id="3797439">0</span>&nbsp;<span class="op" id="3797441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3797445">panic</span><span class="op" id="3797450">(</span><span class="string" id="3797451">&#34;division&nbsp;by&nbsp;zero&#34;</span><span class="op" id="3797469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3797472">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797476">//&nbsp;1.&nbsp;Left-shift&nbsp;A&nbsp;or&nbsp;B&nbsp;such&nbsp;that&nbsp;quotient&nbsp;A/B&nbsp;is&nbsp;in&nbsp;[1&lt;&lt;Msize1,&nbsp;1&lt;&lt;(Msize2+1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797556">//&nbsp;(Msize2&nbsp;bits&nbsp;if&nbsp;A&nbsp;&lt;&nbsp;B&nbsp;when&nbsp;they&nbsp;are&nbsp;left-aligned,&nbsp;Msize2+1&nbsp;bits&nbsp;if&nbsp;A&nbsp;&gt;=&nbsp;B).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797636">//&nbsp;This&nbsp;is&nbsp;2&nbsp;or&nbsp;3&nbsp;more&nbsp;than&nbsp;the&nbsp;float64&nbsp;mantissa&nbsp;field&nbsp;width&nbsp;of&nbsp;Msize:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797708">//&nbsp;-&nbsp;the&nbsp;optional&nbsp;extra&nbsp;bit&nbsp;is&nbsp;shifted&nbsp;away&nbsp;in&nbsp;step&nbsp;3&nbsp;below.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797770">//&nbsp;-&nbsp;the&nbsp;high-order&nbsp;1&nbsp;is&nbsp;omitted&nbsp;in&nbsp;&#34;normal&#34;&nbsp;representation;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3797832">//&nbsp;-&nbsp;the&nbsp;low-order&nbsp;1&nbsp;will&nbsp;be&nbsp;used&nbsp;during&nbsp;rounding&nbsp;then&nbsp;discarded.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797899">exp</span>&nbsp;<span class="op" id="3797903">:=</span>&nbsp;<span class="ident" id="3797906"><a href="/math/big/rat.go.html#3797352">alen</a></span>&nbsp;<span class="op" id="3797911">-</span>&nbsp;<span class="ident" id="3797913"><a href="/math/big/rat.go.html#3797408">blen</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3797919">var</span>&nbsp;<span class="ident" id="3797923">a2</span><span class="op" id="3797925">,</span>&nbsp;<span class="ident" id="3797927">b2</span>&nbsp;<span class="ident" id="3797930"><a href="/math/big/nat.go.html#3758892">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797935"><a href="/math/big/rat.go.html#3797923">a2</a></span>&nbsp;<span class="op" id="3797938">=</span>&nbsp;<span class="ident" id="3797940"><a href="/math/big/rat.go.html#3797923">a2</a></span><span class="op" id="3797942">.</span><span class="ident" id="3797943">set</span><span class="op" id="3797946">(</span><span class="ident" id="3797947"><a href="/math/big/rat.go.html#3796999">a</a></span><span class="op" id="3797948">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3797951"><a href="/math/big/rat.go.html#3797927">b2</a></span>&nbsp;<span class="op" id="3797954">=</span>&nbsp;<span class="ident" id="3797956"><a href="/math/big/rat.go.html#3797927">b2</a></span><span class="op" id="3797958">.</span><span class="ident" id="3797959">set</span><span class="op" id="3797962">(</span><span class="ident" id="3797963"><a href="/math/big/rat.go.html#3797002">b</a></span><span class="op" id="3797964">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3797967">if</span>&nbsp;<span class="ident" id="3797970">shift</span>&nbsp;<span class="op" id="3797976">:=</span>&nbsp;<span class="ident" id="3797979"><a href="/math/big/rat.go.html#3797153">Msize2</a></span>&nbsp;<span class="op" id="3797986">-</span>&nbsp;<span class="ident" id="3797988"><a href="/math/big/rat.go.html#3797899">exp</a></span><span class="op" id="3797991">;</span>&nbsp;<span class="ident" id="3797993"><a href="/math/big/rat.go.html#3797970">shift</a></span>&nbsp;<span class="op" id="3797999">&gt;</span>&nbsp;<span class="num" id="3798001">0</span>&nbsp;<span class="op" id="3798003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798007"><a href="/math/big/rat.go.html#3797923">a2</a></span>&nbsp;<span class="op" id="3798010">=</span>&nbsp;<span class="ident" id="3798012"><a href="/math/big/rat.go.html#3797923">a2</a></span><span class="op" id="3798014">.</span><span class="ident" id="3798015">shl</span><span class="op" id="3798018">(</span><span class="ident" id="3798019"><a href="/math/big/rat.go.html#3797923">a2</a></span><span class="op" id="3798021">,</span>&nbsp;<span class="builtintype" id="3798023">uint</span><span class="op" id="3798027">(</span><span class="ident" id="3798028"><a href="/math/big/rat.go.html#3797970">shift</a></span><span class="op" id="3798033">)</span><span class="op" id="3798034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3798037">}</span>&nbsp;<span class="keyword" id="3798039">else</span>&nbsp;<span class="keyword" id="3798044">if</span>&nbsp;<span class="ident" id="3798047"><a href="/math/big/rat.go.html#3797970">shift</a></span>&nbsp;<span class="op" id="3798053">&lt;</span>&nbsp;<span class="num" id="3798055">0</span>&nbsp;<span class="op" id="3798057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798061"><a href="/math/big/rat.go.html#3797927">b2</a></span>&nbsp;<span class="op" id="3798064">=</span>&nbsp;<span class="ident" id="3798066"><a href="/math/big/rat.go.html#3797927">b2</a></span><span class="op" id="3798068">.</span><span class="ident" id="3798069">shl</span><span class="op" id="3798072">(</span><span class="ident" id="3798073"><a href="/math/big/rat.go.html#3797927">b2</a></span><span class="op" id="3798075">,</span>&nbsp;<span class="builtintype" id="3798077">uint</span><span class="op" id="3798081">(</span><span class="op" id="3798082">-</span><span class="ident" id="3798083"><a href="/math/big/rat.go.html#3797970">shift</a></span><span class="op" id="3798088">)</span><span class="op" id="3798089">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3798092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3798096">//&nbsp;2.&nbsp;Compute&nbsp;quotient&nbsp;and&nbsp;remainder&nbsp;(q,&nbsp;r).&nbsp;&nbsp;NB:&nbsp;due&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3798158">//&nbsp;extra&nbsp;shift,&nbsp;the&nbsp;low-order&nbsp;bit&nbsp;of&nbsp;q&nbsp;is&nbsp;logically&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3798215">//&nbsp;high-order&nbsp;bit&nbsp;of&nbsp;r.</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3798240">var</span>&nbsp;<span class="ident" id="3798244">q</span>&nbsp;<span class="ident" id="3798246"><a href="/math/big/nat.go.html#3758892">nat</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798251"><a href="/math/big/rat.go.html#3798244">q</a></span><span class="op" id="3798252">,</span>&nbsp;<span class="ident" id="3798254">r</span>&nbsp;<span class="op" id="3798256">:=</span>&nbsp;<span class="ident" id="3798259"><a href="/math/big/rat.go.html#3798244">q</a></span><span class="op" id="3798260">.</span><span class="ident" id="3798261">div</span><span class="op" id="3798264">(</span><span class="ident" id="3798265"><a href="/math/big/rat.go.html#3797923">a2</a></span><span class="op" id="3798267">,</span>&nbsp;<span class="ident" id="3798269"><a href="/math/big/rat.go.html#3797923">a2</a></span><span class="op" id="3798271">,</span>&nbsp;<span class="ident" id="3798273"><a href="/math/big/rat.go.html#3797927">b2</a></span><span class="op" id="3798275">)</span>&nbsp;<span class="comment" id="3798277">//&nbsp;(recycle&nbsp;a2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798294">mantissa</span>&nbsp;<span class="op" id="3798303">:=</span>&nbsp;<span class="ident" id="3798306"><a href="/math/big/int.go.html#3745302">low64</a></span><span class="op" id="3798311">(</span><span class="ident" id="3798312"><a href="/math/big/rat.go.html#3798244">q</a></span><span class="op" id="3798313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798316">haveRem</span>&nbsp;<span class="op" id="3798324">:=</span>&nbsp;<span class="builtinfunc" id="3798327">len</span><span class="op" id="3798330">(</span><span class="ident" id="3798331"><a href="/math/big/rat.go.html#3798254">r</a></span><span class="op" id="3798332">)</span>&nbsp;<span class="op" id="3798334">&gt;</span>&nbsp;<span class="num" id="3798336">0</span>&nbsp;<span class="comment" id="3798338">//&nbsp;mantissa&amp;1&nbsp;&amp;&amp;&nbsp;!haveRem&nbsp;=&gt;&nbsp;remainder&nbsp;is&nbsp;exactly&nbsp;half</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3798395">//&nbsp;3.&nbsp;If&nbsp;quotient&nbsp;didn&#39;t&nbsp;fit&nbsp;in&nbsp;Msize2&nbsp;bits,&nbsp;redo&nbsp;division&nbsp;by&nbsp;b2&lt;&lt;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3798464">//&nbsp;(in&nbsp;effect---we&nbsp;accomplish&nbsp;this&nbsp;incrementally).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3798516">if</span>&nbsp;<span class="ident" id="3798519"><a href="/math/big/rat.go.html#3798294">mantissa</a></span><span class="op" id="3798527">&gt;&gt;</span><span class="ident" id="3798529"><a href="/math/big/rat.go.html#3797153">Msize2</a></span>&nbsp;<span class="op" id="3798536">==</span>&nbsp;<span class="num" id="3798539">1</span>&nbsp;<span class="op" id="3798541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3798545">if</span>&nbsp;<span class="ident" id="3798548"><a href="/math/big/rat.go.html#3798294">mantissa</a></span><span class="op" id="3798556">&amp;</span><span class="num" id="3798557">1</span>&nbsp;<span class="op" id="3798559">==</span>&nbsp;<span class="num" id="3798562">1</span>&nbsp;<span class="op" id="3798564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798569"><a href="/math/big/rat.go.html#3798316">haveRem</a></span>&nbsp;<span class="op" id="3798577">=</span>&nbsp;<span class="builtintype" id="3798579">true</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3798586">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798590"><a href="/math/big/rat.go.html#3798294">mantissa</a></span>&nbsp;<span class="op" id="3798599">&gt;&gt;=</span>&nbsp;<span class="num" id="3798603">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798607"><a href="/math/big/rat.go.html#3797899">exp</a></span><span class="op" id="3798610">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3798614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3798617">if</span>&nbsp;<span class="ident" id="3798620"><a href="/math/big/rat.go.html#3798294">mantissa</a></span><span class="op" id="3798628">&gt;&gt;</span><span class="ident" id="3798630"><a href="/math/big/rat.go.html#3797112">Msize1</a></span>&nbsp;<span class="op" id="3798637">!=</span>&nbsp;<span class="num" id="3798640">1</span>&nbsp;<span class="op" id="3798642">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3798646">panic</span><span class="op" id="3798651">(</span><span class="ident" id="3798652"><a href="/math/big/rat.go.html#3792841">fmt</a></span><span class="op" id="3798655">.</span><span class="ident" id="3798656">Sprintf</span><span class="op" id="3798663">(</span><span class="string" id="3798664">&#34;expected&nbsp;exactly&nbsp;%d&nbsp;bits&nbsp;of&nbsp;result&#34;</span><span class="op" id="3798700">,</span>&nbsp;<span class="ident" id="3798702"><a href="/math/big/rat.go.html#3797153">Msize2</a></span><span class="op" id="3798708">)</span><span class="op" id="3798709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3798712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3798716">//&nbsp;4.&nbsp;Rounding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3798733">if</span>&nbsp;<span class="ident" id="3798736"><a href="/math/big/rat.go.html#3797242">Emin</a></span><span class="op" id="3798740">-</span><span class="ident" id="3798741"><a href="/math/big/rat.go.html#3797098">Msize</a></span>&nbsp;<span class="op" id="3798747">&lt;=</span>&nbsp;<span class="ident" id="3798750"><a href="/math/big/rat.go.html#3797899">exp</a></span>&nbsp;<span class="op" id="3798754">&amp;&amp;</span>&nbsp;<span class="ident" id="3798757"><a href="/math/big/rat.go.html#3797899">exp</a></span>&nbsp;<span class="op" id="3798761">&lt;=</span>&nbsp;<span class="ident" id="3798764"><a href="/math/big/rat.go.html#3797242">Emin</a></span>&nbsp;<span class="op" id="3798769">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3798773">//&nbsp;Denormal&nbsp;case;&nbsp;lose&nbsp;&#39;shift&#39;&nbsp;bits&nbsp;of&nbsp;precision.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798825">shift</span>&nbsp;<span class="op" id="3798831">:=</span>&nbsp;<span class="builtintype" id="3798834">uint</span><span class="op" id="3798838">(</span><span class="ident" id="3798839"><a href="/math/big/rat.go.html#3797242">Emin</a></span>&nbsp;<span class="op" id="3798844">-</span>&nbsp;<span class="op" id="3798846">(</span><span class="ident" id="3798847"><a href="/math/big/rat.go.html#3797899">exp</a></span>&nbsp;<span class="op" id="3798851">-</span>&nbsp;<span class="num" id="3798853">1</span><span class="op" id="3798854">)</span><span class="op" id="3798855">)</span>&nbsp;<span class="comment" id="3798857">//&nbsp;[1..Esize1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798874">lostbits</span>&nbsp;<span class="op" id="3798883">:=</span>&nbsp;<span class="ident" id="3798886"><a href="/math/big/rat.go.html#3798294">mantissa</a></span>&nbsp;<span class="op" id="3798895">&amp;</span>&nbsp;<span class="op" id="3798897">(</span><span class="num" id="3798898">1</span><span class="op" id="3798899">&lt;&lt;</span><span class="ident" id="3798901"><a href="/math/big/rat.go.html#3798825">shift</a></span>&nbsp;<span class="op" id="3798907">-</span>&nbsp;<span class="num" id="3798909">1</span><span class="op" id="3798910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798914"><a href="/math/big/rat.go.html#3798316">haveRem</a></span>&nbsp;<span class="op" id="3798922">=</span>&nbsp;<span class="ident" id="3798924"><a href="/math/big/rat.go.html#3798316">haveRem</a></span>&nbsp;<span class="op" id="3798932">||</span>&nbsp;<span class="ident" id="3798935"><a href="/math/big/rat.go.html#3798874">lostbits</a></span>&nbsp;<span class="op" id="3798944">!=</span>&nbsp;<span class="num" id="3798947">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798951"><a href="/math/big/rat.go.html#3798294">mantissa</a></span>&nbsp;<span class="op" id="3798960">&gt;&gt;=</span>&nbsp;<span class="ident" id="3798964"><a href="/math/big/rat.go.html#3798825">shift</a></span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3798972"><a href="/math/big/rat.go.html#3797899">exp</a></span>&nbsp;<span class="op" id="3798976">=</span>&nbsp;<span class="num" id="3798978">2</span>&nbsp;<span class="op" id="3798980">-</span>&nbsp;<span class="ident" id="3798982"><a href="/math/big/rat.go.html#3797215">Ebias</a></span>&nbsp;<span class="comment" id="3798988">//&nbsp;==&nbsp;exp&nbsp;+&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3799007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3799010">//&nbsp;Round&nbsp;q&nbsp;using&nbsp;round-half-to-even.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799048"><a href="/math/big/rat.go.html#3797021">exact</a></span>&nbsp;<span class="op" id="3799054">=</span>&nbsp;<span class="op" id="3799056">!</span><span class="ident" id="3799057"><a href="/math/big/rat.go.html#3798316">haveRem</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3799066">if</span>&nbsp;<span class="ident" id="3799069"><a href="/math/big/rat.go.html#3798294">mantissa</a></span><span class="op" id="3799077">&amp;</span><span class="num" id="3799078">1</span>&nbsp;<span class="op" id="3799080">!=</span>&nbsp;<span class="num" id="3799083">0</span>&nbsp;<span class="op" id="3799085">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799089"><a href="/math/big/rat.go.html#3797021">exact</a></span>&nbsp;<span class="op" id="3799095">=</span>&nbsp;<span class="builtintype" id="3799097">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3799105">if</span>&nbsp;<span class="ident" id="3799108"><a href="/math/big/rat.go.html#3798316">haveRem</a></span>&nbsp;<span class="op" id="3799116">||</span>&nbsp;<span class="ident" id="3799119"><a href="/math/big/rat.go.html#3798294">mantissa</a></span><span class="op" id="3799127">&amp;</span><span class="num" id="3799128">2</span>&nbsp;<span class="op" id="3799130">!=</span>&nbsp;<span class="num" id="3799133">0</span>&nbsp;<span class="op" id="3799135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3799140">if</span>&nbsp;<span class="ident" id="3799143"><a href="/math/big/rat.go.html#3798294">mantissa</a></span><span class="op" id="3799151">++</span><span class="op" id="3799153">;</span>&nbsp;<span class="ident" id="3799155"><a href="/math/big/rat.go.html#3798294">mantissa</a></span>&nbsp;<span class="op" id="3799164">&gt;=</span>&nbsp;<span class="num" id="3799167">1</span><span class="op" id="3799168">&lt;&lt;</span><span class="ident" id="3799170"><a href="/math/big/rat.go.html#3797153">Msize2</a></span>&nbsp;<span class="op" id="3799177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3799183">//&nbsp;Complete&nbsp;rollover&nbsp;11...1&nbsp;=&gt;&nbsp;100...0,&nbsp;so&nbsp;shift&nbsp;is&nbsp;safe</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799244"><a href="/math/big/rat.go.html#3798294">mantissa</a></span>&nbsp;<span class="op" id="3799253">&gt;&gt;=</span>&nbsp;<span class="num" id="3799257">1</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799263"><a href="/math/big/rat.go.html#3797899">exp</a></span><span class="op" id="3799266">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3799272">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3799276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3799279">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799282"><a href="/math/big/rat.go.html#3798294">mantissa</a></span>&nbsp;<span class="op" id="3799291">&gt;&gt;=</span>&nbsp;<span class="num" id="3799295">1</span>&nbsp;<span class="comment" id="3799297">//&nbsp;discard&nbsp;rounding&nbsp;bit.&nbsp;&nbsp;Mantissa&nbsp;now&nbsp;scaled&nbsp;by&nbsp;1&lt;&lt;Msize1.</span><br>
<span class="lineno">255</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799359"><a href="/math/big/rat.go.html#3797010">f</a></span>&nbsp;<span class="op" id="3799361">=</span>&nbsp;<span class="ident" id="3799363"><a href="/math/big/rat.go.html#3792848">math</a></span><span class="op" id="3799367">.</span><span class="ident" id="3799368">Ldexp</span><span class="op" id="3799373">(</span><span class="builtintype" id="3799374">float64</span><span class="op" id="3799381">(</span><span class="ident" id="3799382"><a href="/math/big/rat.go.html#3798294">mantissa</a></span><span class="op" id="3799390">)</span><span class="op" id="3799391">,</span>&nbsp;<span class="ident" id="3799393"><a href="/math/big/rat.go.html#3797899">exp</a></span><span class="op" id="3799396">-</span><span class="ident" id="3799397"><a href="/math/big/rat.go.html#3797112">Msize1</a></span><span class="op" id="3799403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3799406">if</span>&nbsp;<span class="ident" id="3799409"><a href="/math/big/rat.go.html#3792848">math</a></span><span class="op" id="3799413">.</span><span class="ident" id="3799414">IsInf</span><span class="op" id="3799419">(</span><span class="ident" id="3799420"><a href="/math/big/rat.go.html#3797010">f</a></span><span class="op" id="3799421">,</span>&nbsp;<span class="num" id="3799423">0</span><span class="op" id="3799424">)</span>&nbsp;<span class="op" id="3799426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799430"><a href="/math/big/rat.go.html#3797021">exact</a></span>&nbsp;<span class="op" id="3799436">=</span>&nbsp;<span class="builtintype" id="3799438">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3799445">}</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3799448">return</span><br>
<span class="lineno"></span><span class="op" id="3799455">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3799458">//&nbsp;Float32&nbsp;returns&nbsp;the&nbsp;nearest&nbsp;float32&nbsp;value&nbsp;for&nbsp;x&nbsp;and&nbsp;a&nbsp;bool&nbsp;indicating</span><br>
<span class="lineno"></span><span class="comment" id="3799531">//&nbsp;whether&nbsp;f&nbsp;represents&nbsp;x&nbsp;exactly.&nbsp;If&nbsp;the&nbsp;magnitude&nbsp;of&nbsp;x&nbsp;is&nbsp;too&nbsp;large&nbsp;to</span><br>
<span class="lineno">265</span><span class="comment" id="3799604">//&nbsp;be&nbsp;represented&nbsp;by&nbsp;a&nbsp;float32,&nbsp;f&nbsp;is&nbsp;an&nbsp;infinity&nbsp;and&nbsp;exact&nbsp;is&nbsp;false.</span><br>
<span class="lineno"></span><span class="comment" id="3799673">//&nbsp;The&nbsp;sign&nbsp;of&nbsp;f&nbsp;always&nbsp;matches&nbsp;the&nbsp;sign&nbsp;of&nbsp;x,&nbsp;even&nbsp;if&nbsp;f&nbsp;==&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword" id="3799736">func</span>&nbsp;<span class="op" id="3799741">(</span><span class="ident" id="3799742">x</span>&nbsp;<span class="op" id="3799744">*</span><span class="ident" id="3799745"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3799748">)</span>&nbsp;<span class="ident" id="3799750">Float32</span><span class="op" id="3799757">(</span><span class="op" id="3799758">)</span>&nbsp;<span class="op" id="3799760">(</span><span class="ident" id="3799761">f</span>&nbsp;<span class="builtintype" id="3799763">float32</span><span class="op" id="3799770">,</span>&nbsp;<span class="ident" id="3799772">exact</span>&nbsp;<span class="builtintype" id="3799778">bool</span><span class="op" id="3799782">)</span>&nbsp;<span class="op" id="3799784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799787">b</span>&nbsp;<span class="op" id="3799789">:=</span>&nbsp;<span class="ident" id="3799792"><a href="/math/big/rat.go.html#3799742">x</a></span><span class="op" id="3799793">.</span><span class="ident" id="3799794">b</span><span class="op" id="3799795">.</span><span class="ident" id="3799796">abs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3799801">if</span>&nbsp;<span class="builtinfunc" id="3799804">len</span><span class="op" id="3799807">(</span><span class="ident" id="3799808"><a href="/math/big/rat.go.html#3799787">b</a></span><span class="op" id="3799809">)</span>&nbsp;<span class="op" id="3799811">==</span>&nbsp;<span class="num" id="3799814">0</span>&nbsp;<span class="op" id="3799816">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799820"><a href="/math/big/rat.go.html#3799787">b</a></span>&nbsp;<span class="op" id="3799822">=</span>&nbsp;<span class="ident" id="3799824"><a href="/math/big/rat.go.html#3799787">b</a></span><span class="op" id="3799825">.</span><span class="ident" id="3799826">set</span><span class="op" id="3799829">(</span><span class="ident" id="3799830"><a href="/math/big/nat.go.html#3758911">natOne</a></span><span class="op" id="3799836">)</span>&nbsp;<span class="comment" id="3799838">//&nbsp;materialize&nbsp;denominator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3799866">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799869"><a href="/math/big/rat.go.html#3799761">f</a></span><span class="op" id="3799870">,</span>&nbsp;<span class="ident" id="3799872"><a href="/math/big/rat.go.html#3799772">exact</a></span>&nbsp;<span class="op" id="3799878">=</span>&nbsp;<span class="ident" id="3799880"><a href="/math/big/rat.go.html#3794260">quotToFloat32</a></span><span class="op" id="3799893">(</span><span class="ident" id="3799894"><a href="/math/big/rat.go.html#3799742">x</a></span><span class="op" id="3799895">.</span><span class="ident" id="3799896">a</span><span class="op" id="3799897">.</span><span class="ident" id="3799898">abs</span><span class="op" id="3799901">,</span>&nbsp;<span class="ident" id="3799903"><a href="/math/big/rat.go.html#3799787">b</a></span><span class="op" id="3799904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3799907">if</span>&nbsp;<span class="ident" id="3799910"><a href="/math/big/rat.go.html#3799742">x</a></span><span class="op" id="3799911">.</span><span class="ident" id="3799912">a</span><span class="op" id="3799913">.</span><span class="ident" id="3799914">neg</span>&nbsp;<span class="op" id="3799918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3799922"><a href="/math/big/rat.go.html#3799761">f</a></span>&nbsp;<span class="op" id="3799924">=</span>&nbsp;<span class="op" id="3799926">-</span><span class="ident" id="3799927"><a href="/math/big/rat.go.html#3799761">f</a></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3799930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3799933">return</span><br>
<span class="lineno"></span><span class="op" id="3799940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3799943">//&nbsp;Float64&nbsp;returns&nbsp;the&nbsp;nearest&nbsp;float64&nbsp;value&nbsp;for&nbsp;x&nbsp;and&nbsp;a&nbsp;bool&nbsp;indicating</span><br>
<span class="lineno">280</span><span class="comment" id="3800016">//&nbsp;whether&nbsp;f&nbsp;represents&nbsp;x&nbsp;exactly.&nbsp;If&nbsp;the&nbsp;magnitude&nbsp;of&nbsp;x&nbsp;is&nbsp;too&nbsp;large&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="3800089">//&nbsp;be&nbsp;represented&nbsp;by&nbsp;a&nbsp;float64,&nbsp;f&nbsp;is&nbsp;an&nbsp;infinity&nbsp;and&nbsp;exact&nbsp;is&nbsp;false.</span><br>
<span class="lineno"></span><span class="comment" id="3800158">//&nbsp;The&nbsp;sign&nbsp;of&nbsp;f&nbsp;always&nbsp;matches&nbsp;the&nbsp;sign&nbsp;of&nbsp;x,&nbsp;even&nbsp;if&nbsp;f&nbsp;==&nbsp;0.</span><br>
<span class="lineno"></span><span class="keyword" id="3800221">func</span>&nbsp;<span class="op" id="3800226">(</span><span class="ident" id="3800227">x</span>&nbsp;<span class="op" id="3800229">*</span><span class="ident" id="3800230"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3800233">)</span>&nbsp;<span class="ident" id="3800235">Float64</span><span class="op" id="3800242">(</span><span class="op" id="3800243">)</span>&nbsp;<span class="op" id="3800245">(</span><span class="ident" id="3800246">f</span>&nbsp;<span class="builtintype" id="3800248">float64</span><span class="op" id="3800255">,</span>&nbsp;<span class="ident" id="3800257">exact</span>&nbsp;<span class="builtintype" id="3800263">bool</span><span class="op" id="3800267">)</span>&nbsp;<span class="op" id="3800269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800272">b</span>&nbsp;<span class="op" id="3800274">:=</span>&nbsp;<span class="ident" id="3800277"><a href="/math/big/rat.go.html#3800227">x</a></span><span class="op" id="3800278">.</span><span class="ident" id="3800279">b</span><span class="op" id="3800280">.</span><span class="ident" id="3800281">abs</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800286">if</span>&nbsp;<span class="builtinfunc" id="3800289">len</span><span class="op" id="3800292">(</span><span class="ident" id="3800293"><a href="/math/big/rat.go.html#3800272">b</a></span><span class="op" id="3800294">)</span>&nbsp;<span class="op" id="3800296">==</span>&nbsp;<span class="num" id="3800299">0</span>&nbsp;<span class="op" id="3800301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800305"><a href="/math/big/rat.go.html#3800272">b</a></span>&nbsp;<span class="op" id="3800307">=</span>&nbsp;<span class="ident" id="3800309"><a href="/math/big/rat.go.html#3800272">b</a></span><span class="op" id="3800310">.</span><span class="ident" id="3800311">set</span><span class="op" id="3800314">(</span><span class="ident" id="3800315"><a href="/math/big/nat.go.html#3758911">natOne</a></span><span class="op" id="3800321">)</span>&nbsp;<span class="comment" id="3800323">//&nbsp;materialize&nbsp;denominator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3800351">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800354"><a href="/math/big/rat.go.html#3800246">f</a></span><span class="op" id="3800355">,</span>&nbsp;<span class="ident" id="3800357"><a href="/math/big/rat.go.html#3800257">exact</a></span>&nbsp;<span class="op" id="3800363">=</span>&nbsp;<span class="ident" id="3800365"><a href="/math/big/rat.go.html#3796985">quotToFloat64</a></span><span class="op" id="3800378">(</span><span class="ident" id="3800379"><a href="/math/big/rat.go.html#3800227">x</a></span><span class="op" id="3800380">.</span><span class="ident" id="3800381">a</span><span class="op" id="3800382">.</span><span class="ident" id="3800383">abs</span><span class="op" id="3800386">,</span>&nbsp;<span class="ident" id="3800388"><a href="/math/big/rat.go.html#3800272">b</a></span><span class="op" id="3800389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800392">if</span>&nbsp;<span class="ident" id="3800395"><a href="/math/big/rat.go.html#3800227">x</a></span><span class="op" id="3800396">.</span><span class="ident" id="3800397">a</span><span class="op" id="3800398">.</span><span class="ident" id="3800399">neg</span>&nbsp;<span class="op" id="3800403">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800407"><a href="/math/big/rat.go.html#3800246">f</a></span>&nbsp;<span class="op" id="3800409">=</span>&nbsp;<span class="op" id="3800411">-</span><span class="ident" id="3800412"><a href="/math/big/rat.go.html#3800246">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3800415">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800418">return</span><br>
<span class="lineno"></span><span class="op" id="3800425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span><span class="comment" id="3800428">//&nbsp;SetFrac&nbsp;sets&nbsp;z&nbsp;to&nbsp;a/b&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword" id="3800468">func</span>&nbsp;<span class="op" id="3800473">(</span><span class="ident" id="3800474">z</span>&nbsp;<span class="op" id="3800476">*</span><span class="ident" id="3800477"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3800480">)</span>&nbsp;<span class="ident" id="3800482">SetFrac</span><span class="op" id="3800489">(</span><span class="ident" id="3800490">a</span><span class="op" id="3800491">,</span>&nbsp;<span class="ident" id="3800493">b</span>&nbsp;<span class="op" id="3800495">*</span><span class="ident" id="3800496"><a href="/math/big/int.go.html#3732722">Int</a></span><span class="op" id="3800499">)</span>&nbsp;<span class="op" id="3800501">*</span><span class="ident" id="3800502"><a href="/math/big/rat.go.html#3792985">Rat</a></span>&nbsp;<span class="op" id="3800506">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800509"><a href="/math/big/rat.go.html#3800474">z</a></span><span class="op" id="3800510">.</span><span class="ident" id="3800511">a</span><span class="op" id="3800512">.</span><span class="ident" id="3800513">neg</span>&nbsp;<span class="op" id="3800517">=</span>&nbsp;<span class="ident" id="3800519"><a href="/math/big/rat.go.html#3800490">a</a></span><span class="op" id="3800520">.</span><span class="ident" id="3800521">neg</span>&nbsp;<span class="op" id="3800525">!=</span>&nbsp;<span class="ident" id="3800528"><a href="/math/big/rat.go.html#3800493">b</a></span><span class="op" id="3800529">.</span><span class="ident" id="3800530">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800535">babs</span>&nbsp;<span class="op" id="3800540">:=</span>&nbsp;<span class="ident" id="3800543"><a href="/math/big/rat.go.html#3800493">b</a></span><span class="op" id="3800544">.</span><span class="ident" id="3800545">abs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800550">if</span>&nbsp;<span class="builtinfunc" id="3800553">len</span><span class="op" id="3800556">(</span><span class="ident" id="3800557"><a href="/math/big/rat.go.html#3800535">babs</a></span><span class="op" id="3800561">)</span>&nbsp;<span class="op" id="3800563">==</span>&nbsp;<span class="num" id="3800566">0</span>&nbsp;<span class="op" id="3800568">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3800572">panic</span><span class="op" id="3800577">(</span><span class="string" id="3800578">&#34;division&nbsp;by&nbsp;zero&#34;</span><span class="op" id="3800596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3800599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800602">if</span>&nbsp;<span class="op" id="3800605">&amp;</span><span class="ident" id="3800606"><a href="/math/big/rat.go.html#3800474">z</a></span><span class="op" id="3800607">.</span><span class="ident" id="3800608">a</span>&nbsp;<span class="op" id="3800610">==</span>&nbsp;<span class="ident" id="3800613"><a href="/math/big/rat.go.html#3800493">b</a></span>&nbsp;<span class="op" id="3800615">||</span>&nbsp;<span class="ident" id="3800618"><a href="/math/big/nat.go.html#3764870">alias</a></span><span class="op" id="3800623">(</span><span class="ident" id="3800624"><a href="/math/big/rat.go.html#3800474">z</a></span><span class="op" id="3800625">.</span><span class="ident" id="3800626">a</span><span class="op" id="3800627">.</span><span class="ident" id="3800628">abs</span><span class="op" id="3800631">,</span>&nbsp;<span class="ident" id="3800633"><a href="/math/big/rat.go.html#3800535">babs</a></span><span class="op" id="3800637">)</span>&nbsp;<span class="op" id="3800639">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800643"><a href="/math/big/rat.go.html#3800535">babs</a></span>&nbsp;<span class="op" id="3800648">=</span>&nbsp;<span class="ident" id="3800650"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3800653">(</span><span class="ident" id="3800654">nil</span><span class="op" id="3800657">)</span><span class="op" id="3800658">.</span><span class="ident" id="3800659">set</span><span class="op" id="3800662">(</span><span class="ident" id="3800663"><a href="/math/big/rat.go.html#3800535">babs</a></span><span class="op" id="3800667">)</span>&nbsp;<span class="comment" id="3800669">//&nbsp;make&nbsp;a&nbsp;copy</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3800685">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800688"><a href="/math/big/rat.go.html#3800474">z</a></span><span class="op" id="3800689">.</span><span class="ident" id="3800690">a</span><span class="op" id="3800691">.</span><span class="ident" id="3800692">abs</span>&nbsp;<span class="op" id="3800696">=</span>&nbsp;<span class="ident" id="3800698"><a href="/math/big/rat.go.html#3800474">z</a></span><span class="op" id="3800699">.</span><span class="ident" id="3800700">a</span><span class="op" id="3800701">.</span><span class="ident" id="3800702">abs</span><span class="op" id="3800705">.</span><span class="ident" id="3800706">set</span><span class="op" id="3800709">(</span><span class="ident" id="3800710"><a href="/math/big/rat.go.html#3800490">a</a></span><span class="op" id="3800711">.</span><span class="ident" id="3800712">abs</span><span class="op" id="3800715">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800718"><a href="/math/big/rat.go.html#3800474">z</a></span><span class="op" id="3800719">.</span><span class="ident" id="3800720">b</span><span class="op" id="3800721">.</span><span class="ident" id="3800722">abs</span>&nbsp;<span class="op" id="3800726">=</span>&nbsp;<span class="ident" id="3800728"><a href="/math/big/rat.go.html#3800474">z</a></span><span class="op" id="3800729">.</span><span class="ident" id="3800730">b</span><span class="op" id="3800731">.</span><span class="ident" id="3800732">abs</span><span class="op" id="3800735">.</span><span class="ident" id="3800736">set</span><span class="op" id="3800739">(</span><span class="ident" id="3800740"><a href="/math/big/rat.go.html#3800535">babs</a></span><span class="op" id="3800744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800747">return</span>&nbsp;<span class="ident" id="3800754"><a href="/math/big/rat.go.html#3800474">z</a></span><span class="op" id="3800755">.</span><span class="ident" id="3800756">norm</span><span class="op" id="3800760">(</span><span class="op" id="3800761">)</span><br>
<span class="lineno"></span><span class="op" id="3800763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="3800766">//&nbsp;SetFrac64&nbsp;sets&nbsp;z&nbsp;to&nbsp;a/b&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword" id="3800808">func</span>&nbsp;<span class="op" id="3800813">(</span><span class="ident" id="3800814">z</span>&nbsp;<span class="op" id="3800816">*</span><span class="ident" id="3800817"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3800820">)</span>&nbsp;<span class="ident" id="3800822">SetFrac64</span><span class="op" id="3800831">(</span><span class="ident" id="3800832">a</span><span class="op" id="3800833">,</span>&nbsp;<span class="ident" id="3800835">b</span>&nbsp;<span class="ident" id="3800837">int64</span><span class="op" id="3800842">)</span>&nbsp;<span class="op" id="3800844">*</span><span class="ident" id="3800845"><a href="/math/big/rat.go.html#3792985">Rat</a></span>&nbsp;<span class="op" id="3800849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800852"><a href="/math/big/rat.go.html#3800814">z</a></span><span class="op" id="3800853">.</span><span class="ident" id="3800854">a</span><span class="op" id="3800855">.</span><span class="ident" id="3800856">SetInt64</span><span class="op" id="3800864">(</span><span class="ident" id="3800865"><a href="/math/big/rat.go.html#3800832">a</a></span><span class="op" id="3800866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800869">if</span>&nbsp;<span class="ident" id="3800872"><a href="/math/big/rat.go.html#3800835">b</a></span>&nbsp;<span class="op" id="3800874">==</span>&nbsp;<span class="num" id="3800877">0</span>&nbsp;<span class="op" id="3800879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3800883">panic</span><span class="op" id="3800888">(</span><span class="string" id="3800889">&#34;division&nbsp;by&nbsp;zero&#34;</span><span class="op" id="3800907">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3800910">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800913">if</span>&nbsp;<span class="ident" id="3800916"><a href="/math/big/rat.go.html#3800835">b</a></span>&nbsp;<span class="op" id="3800918">&lt;</span>&nbsp;<span class="num" id="3800920">0</span>&nbsp;<span class="op" id="3800922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800926"><a href="/math/big/rat.go.html#3800835">b</a></span>&nbsp;<span class="op" id="3800928">=</span>&nbsp;<span class="op" id="3800930">-</span><span class="ident" id="3800931"><a href="/math/big/rat.go.html#3800835">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800935"><a href="/math/big/rat.go.html#3800814">z</a></span><span class="op" id="3800936">.</span><span class="ident" id="3800937">a</span><span class="op" id="3800938">.</span><span class="ident" id="3800939">neg</span>&nbsp;<span class="op" id="3800943">=</span>&nbsp;<span class="op" id="3800945">!</span><span class="ident" id="3800946"><a href="/math/big/rat.go.html#3800814">z</a></span><span class="op" id="3800947">.</span><span class="ident" id="3800948">a</span><span class="op" id="3800949">.</span><span class="ident" id="3800950">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3800955">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3800958"><a href="/math/big/rat.go.html#3800814">z</a></span><span class="op" id="3800959">.</span><span class="ident" id="3800960">b</span><span class="op" id="3800961">.</span><span class="ident" id="3800962">abs</span>&nbsp;<span class="op" id="3800966">=</span>&nbsp;<span class="ident" id="3800968"><a href="/math/big/rat.go.html#3800814">z</a></span><span class="op" id="3800969">.</span><span class="ident" id="3800970">b</span><span class="op" id="3800971">.</span><span class="ident" id="3800972">abs</span><span class="op" id="3800975">.</span><span class="ident" id="3800976">setUint64</span><span class="op" id="3800985">(</span><span class="ident" id="3800986">uint64</span><span class="op" id="3800992">(</span><span class="ident" id="3800993"><a href="/math/big/rat.go.html#3800835">b</a></span><span class="op" id="3800994">)</span><span class="op" id="3800995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3800998">return</span>&nbsp;<span class="ident" id="3801005"><a href="/math/big/rat.go.html#3800814">z</a></span><span class="op" id="3801006">.</span><span class="ident" id="3801007">norm</span><span class="op" id="3801011">(</span><span class="op" id="3801012">)</span><br>
<span class="lineno"></span><span class="op" id="3801014">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3801017">//&nbsp;SetInt&nbsp;sets&nbsp;z&nbsp;to&nbsp;x&nbsp;(by&nbsp;making&nbsp;a&nbsp;copy&nbsp;of&nbsp;x)&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno">325</span><span class="keyword" id="3801078">func</span>&nbsp;<span class="op" id="3801083">(</span><span class="ident" id="3801084">z</span>&nbsp;<span class="op" id="3801086">*</span><span class="ident" id="3801087"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3801090">)</span>&nbsp;<span class="ident" id="3801092">SetInt</span><span class="op" id="3801098">(</span><span class="ident" id="3801099">x</span>&nbsp;<span class="op" id="3801101">*</span><span class="ident" id="3801102"><a href="/math/big/int.go.html#3732722">Int</a></span><span class="op" id="3801105">)</span>&nbsp;<span class="op" id="3801107">*</span><span class="ident" id="3801108"><a href="/math/big/rat.go.html#3792985">Rat</a></span>&nbsp;<span class="op" id="3801112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801115"><a href="/math/big/rat.go.html#3801084">z</a></span><span class="op" id="3801116">.</span><span class="ident" id="3801117">a</span><span class="op" id="3801118">.</span><span class="ident" id="3801119">Set</span><span class="op" id="3801122">(</span><span class="ident" id="3801123"><a href="/math/big/rat.go.html#3801099">x</a></span><span class="op" id="3801124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801127"><a href="/math/big/rat.go.html#3801084">z</a></span><span class="op" id="3801128">.</span><span class="ident" id="3801129">b</span><span class="op" id="3801130">.</span><span class="ident" id="3801131">abs</span>&nbsp;<span class="op" id="3801135">=</span>&nbsp;<span class="ident" id="3801137"><a href="/math/big/rat.go.html#3801084">z</a></span><span class="op" id="3801138">.</span><span class="ident" id="3801139">b</span><span class="op" id="3801140">.</span><span class="ident" id="3801141">abs</span><span class="op" id="3801144">.</span><span class="builtinfunc" id="3801145">make</span><span class="op" id="3801149">(</span><span class="num" id="3801150">0</span><span class="op" id="3801151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3801154">return</span>&nbsp;<span class="ident" id="3801161"><a href="/math/big/rat.go.html#3801084">z</a></span><br>
<span class="lineno"></span><span class="op" id="3801163">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="comment" id="3801166">//&nbsp;SetInt64&nbsp;sets&nbsp;z&nbsp;to&nbsp;x&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword" id="3801205">func</span>&nbsp;<span class="op" id="3801210">(</span><span class="ident" id="3801211">z</span>&nbsp;<span class="op" id="3801213">*</span><span class="ident" id="3801214"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3801217">)</span>&nbsp;<span class="ident" id="3801219">SetInt64</span><span class="op" id="3801227">(</span><span class="ident" id="3801228">x</span>&nbsp;<span class="ident" id="3801230">int64</span><span class="op" id="3801235">)</span>&nbsp;<span class="op" id="3801237">*</span><span class="ident" id="3801238"><a href="/math/big/rat.go.html#3792985">Rat</a></span>&nbsp;<span class="op" id="3801242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801245"><a href="/math/big/rat.go.html#3801211">z</a></span><span class="op" id="3801246">.</span><span class="ident" id="3801247">a</span><span class="op" id="3801248">.</span><span class="ident" id="3801249">SetInt64</span><span class="op" id="3801257">(</span><span class="ident" id="3801258"><a href="/math/big/rat.go.html#3801228">x</a></span><span class="op" id="3801259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801262"><a href="/math/big/rat.go.html#3801211">z</a></span><span class="op" id="3801263">.</span><span class="ident" id="3801264">b</span><span class="op" id="3801265">.</span><span class="ident" id="3801266">abs</span>&nbsp;<span class="op" id="3801270">=</span>&nbsp;<span class="ident" id="3801272"><a href="/math/big/rat.go.html#3801211">z</a></span><span class="op" id="3801273">.</span><span class="ident" id="3801274">b</span><span class="op" id="3801275">.</span><span class="ident" id="3801276">abs</span><span class="op" id="3801279">.</span><span class="builtinfunc" id="3801280">make</span><span class="op" id="3801284">(</span><span class="num" id="3801285">0</span><span class="op" id="3801286">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3801289">return</span>&nbsp;<span class="ident" id="3801296"><a href="/math/big/rat.go.html#3801211">z</a></span><br>
<span class="lineno"></span><span class="op" id="3801298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3801301">//&nbsp;Set&nbsp;sets&nbsp;z&nbsp;to&nbsp;x&nbsp;(by&nbsp;making&nbsp;a&nbsp;copy&nbsp;of&nbsp;x)&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword" id="3801359">func</span>&nbsp;<span class="op" id="3801364">(</span><span class="ident" id="3801365">z</span>&nbsp;<span class="op" id="3801367">*</span><span class="ident" id="3801368"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3801371">)</span>&nbsp;<span class="ident" id="3801373">Set</span><span class="op" id="3801376">(</span><span class="ident" id="3801377">x</span>&nbsp;<span class="op" id="3801379">*</span><span class="ident" id="3801380"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3801383">)</span>&nbsp;<span class="op" id="3801385">*</span><span class="ident" id="3801386"><a href="/math/big/rat.go.html#3792985">Rat</a></span>&nbsp;<span class="op" id="3801390">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3801393">if</span>&nbsp;<span class="ident" id="3801396"><a href="/math/big/rat.go.html#3801365">z</a></span>&nbsp;<span class="op" id="3801398">!=</span>&nbsp;<span class="ident" id="3801401"><a href="/math/big/rat.go.html#3801377">x</a></span>&nbsp;<span class="op" id="3801403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801407"><a href="/math/big/rat.go.html#3801365">z</a></span><span class="op" id="3801408">.</span><span class="ident" id="3801409">a</span><span class="op" id="3801410">.</span><span class="ident" id="3801411">Set</span><span class="op" id="3801414">(</span><span class="op" id="3801415">&amp;</span><span class="ident" id="3801416"><a href="/math/big/rat.go.html#3801377">x</a></span><span class="op" id="3801417">.</span><span class="ident" id="3801418">a</span><span class="op" id="3801419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801423"><a href="/math/big/rat.go.html#3801365">z</a></span><span class="op" id="3801424">.</span><span class="ident" id="3801425">b</span><span class="op" id="3801426">.</span><span class="ident" id="3801427">Set</span><span class="op" id="3801430">(</span><span class="op" id="3801431">&amp;</span><span class="ident" id="3801432"><a href="/math/big/rat.go.html#3801377">x</a></span><span class="op" id="3801433">.</span><span class="ident" id="3801434">b</span><span class="op" id="3801435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3801438">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3801441">return</span>&nbsp;<span class="ident" id="3801448"><a href="/math/big/rat.go.html#3801365">z</a></span><br>
<span class="lineno">345</span><span class="op" id="3801450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3801453">//&nbsp;Abs&nbsp;sets&nbsp;z&nbsp;to&nbsp;|x|&nbsp;(the&nbsp;absolute&nbsp;value&nbsp;of&nbsp;x)&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword" id="3801515">func</span>&nbsp;<span class="op" id="3801520">(</span><span class="ident" id="3801521">z</span>&nbsp;<span class="op" id="3801523">*</span><span class="ident" id="3801524"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3801527">)</span>&nbsp;<span class="ident" id="3801529">Abs</span><span class="op" id="3801532">(</span><span class="ident" id="3801533">x</span>&nbsp;<span class="op" id="3801535">*</span><span class="ident" id="3801536"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3801539">)</span>&nbsp;<span class="op" id="3801541">*</span><span class="ident" id="3801542"><a href="/math/big/rat.go.html#3792985">Rat</a></span>&nbsp;<span class="op" id="3801546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801549"><a href="/math/big/rat.go.html#3801521">z</a></span><span class="op" id="3801550">.</span><span class="ident" id="3801551">Set</span><span class="op" id="3801554">(</span><span class="ident" id="3801555"><a href="/math/big/rat.go.html#3801533">x</a></span><span class="op" id="3801556">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801559"><a href="/math/big/rat.go.html#3801521">z</a></span><span class="op" id="3801560">.</span><span class="ident" id="3801561">a</span><span class="op" id="3801562">.</span><span class="ident" id="3801563">neg</span>&nbsp;<span class="op" id="3801567">=</span>&nbsp;<span class="builtintype" id="3801569">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3801576">return</span>&nbsp;<span class="ident" id="3801583"><a href="/math/big/rat.go.html#3801521">z</a></span><br>
<span class="lineno"></span><span class="op" id="3801585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3801588">//&nbsp;Neg&nbsp;sets&nbsp;z&nbsp;to&nbsp;-x&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno">355</span><span class="keyword" id="3801623">func</span>&nbsp;<span class="op" id="3801628">(</span><span class="ident" id="3801629">z</span>&nbsp;<span class="op" id="3801631">*</span><span class="ident" id="3801632"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3801635">)</span>&nbsp;<span class="ident" id="3801637">Neg</span><span class="op" id="3801640">(</span><span class="ident" id="3801641">x</span>&nbsp;<span class="op" id="3801643">*</span><span class="ident" id="3801644"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3801647">)</span>&nbsp;<span class="op" id="3801649">*</span><span class="ident" id="3801650"><a href="/math/big/rat.go.html#3792985">Rat</a></span>&nbsp;<span class="op" id="3801654">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801657"><a href="/math/big/rat.go.html#3801629">z</a></span><span class="op" id="3801658">.</span><span class="ident" id="3801659">Set</span><span class="op" id="3801662">(</span><span class="ident" id="3801663"><a href="/math/big/rat.go.html#3801641">x</a></span><span class="op" id="3801664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801667"><a href="/math/big/rat.go.html#3801629">z</a></span><span class="op" id="3801668">.</span><span class="ident" id="3801669">a</span><span class="op" id="3801670">.</span><span class="ident" id="3801671">neg</span>&nbsp;<span class="op" id="3801675">=</span>&nbsp;<span class="builtinfunc" id="3801677">len</span><span class="op" id="3801680">(</span><span class="ident" id="3801681"><a href="/math/big/rat.go.html#3801629">z</a></span><span class="op" id="3801682">.</span><span class="ident" id="3801683">a</span><span class="op" id="3801684">.</span><span class="ident" id="3801685">abs</span><span class="op" id="3801688">)</span>&nbsp;<span class="op" id="3801690">&gt;</span>&nbsp;<span class="num" id="3801692">0</span>&nbsp;<span class="op" id="3801694">&amp;&amp;</span>&nbsp;<span class="op" id="3801697">!</span><span class="ident" id="3801698"><a href="/math/big/rat.go.html#3801629">z</a></span><span class="op" id="3801699">.</span><span class="ident" id="3801700">a</span><span class="op" id="3801701">.</span><span class="ident" id="3801702">neg</span>&nbsp;<span class="comment" id="3801706">//&nbsp;0&nbsp;has&nbsp;no&nbsp;sign</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3801724">return</span>&nbsp;<span class="ident" id="3801731"><a href="/math/big/rat.go.html#3801629">z</a></span><br>
<span class="lineno"></span><span class="op" id="3801733">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="comment" id="3801736">//&nbsp;Inv&nbsp;sets&nbsp;z&nbsp;to&nbsp;1/x&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword" id="3801772">func</span>&nbsp;<span class="op" id="3801777">(</span><span class="ident" id="3801778">z</span>&nbsp;<span class="op" id="3801780">*</span><span class="ident" id="3801781"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3801784">)</span>&nbsp;<span class="ident" id="3801786">Inv</span><span class="op" id="3801789">(</span><span class="ident" id="3801790">x</span>&nbsp;<span class="op" id="3801792">*</span><span class="ident" id="3801793"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3801796">)</span>&nbsp;<span class="op" id="3801798">*</span><span class="ident" id="3801799"><a href="/math/big/rat.go.html#3792985">Rat</a></span>&nbsp;<span class="op" id="3801803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3801806">if</span>&nbsp;<span class="builtinfunc" id="3801809">len</span><span class="op" id="3801812">(</span><span class="ident" id="3801813"><a href="/math/big/rat.go.html#3801790">x</a></span><span class="op" id="3801814">.</span><span class="ident" id="3801815">a</span><span class="op" id="3801816">.</span><span class="ident" id="3801817">abs</span><span class="op" id="3801820">)</span>&nbsp;<span class="op" id="3801822">==</span>&nbsp;<span class="num" id="3801825">0</span>&nbsp;<span class="op" id="3801827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3801831">panic</span><span class="op" id="3801836">(</span><span class="string" id="3801837">&#34;division&nbsp;by&nbsp;zero&#34;</span><span class="op" id="3801855">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3801858">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801861"><a href="/math/big/rat.go.html#3801778">z</a></span><span class="op" id="3801862">.</span><span class="ident" id="3801863">Set</span><span class="op" id="3801866">(</span><span class="ident" id="3801867"><a href="/math/big/rat.go.html#3801790">x</a></span><span class="op" id="3801868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801871">a</span>&nbsp;<span class="op" id="3801873">:=</span>&nbsp;<span class="ident" id="3801876"><a href="/math/big/rat.go.html#3801778">z</a></span><span class="op" id="3801877">.</span><span class="ident" id="3801878">b</span><span class="op" id="3801879">.</span><span class="ident" id="3801880">abs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3801885">if</span>&nbsp;<span class="builtinfunc" id="3801888">len</span><span class="op" id="3801891">(</span><span class="ident" id="3801892"><a href="/math/big/rat.go.html#3801871">a</a></span><span class="op" id="3801893">)</span>&nbsp;<span class="op" id="3801895">==</span>&nbsp;<span class="num" id="3801898">0</span>&nbsp;<span class="op" id="3801900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801904"><a href="/math/big/rat.go.html#3801871">a</a></span>&nbsp;<span class="op" id="3801906">=</span>&nbsp;<span class="ident" id="3801908"><a href="/math/big/rat.go.html#3801871">a</a></span><span class="op" id="3801909">.</span><span class="ident" id="3801910">set</span><span class="op" id="3801913">(</span><span class="ident" id="3801914"><a href="/math/big/nat.go.html#3758911">natOne</a></span><span class="op" id="3801920">)</span>&nbsp;<span class="comment" id="3801922">//&nbsp;materialize&nbsp;numerator</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3801948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801951">b</span>&nbsp;<span class="op" id="3801953">:=</span>&nbsp;<span class="ident" id="3801956"><a href="/math/big/rat.go.html#3801778">z</a></span><span class="op" id="3801957">.</span><span class="ident" id="3801958">a</span><span class="op" id="3801959">.</span><span class="ident" id="3801960">abs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3801965">if</span>&nbsp;<span class="ident" id="3801968"><a href="/math/big/rat.go.html#3801951">b</a></span><span class="op" id="3801969">.</span><span class="ident" id="3801970">cmp</span><span class="op" id="3801973">(</span><span class="ident" id="3801974"><a href="/math/big/nat.go.html#3758911">natOne</a></span><span class="op" id="3801980">)</span>&nbsp;<span class="op" id="3801982">==</span>&nbsp;<span class="num" id="3801985">0</span>&nbsp;<span class="op" id="3801987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3801991"><a href="/math/big/rat.go.html#3801951">b</a></span>&nbsp;<span class="op" id="3801993">=</span>&nbsp;<span class="ident" id="3801995"><a href="/math/big/rat.go.html#3801951">b</a></span><span class="op" id="3801996">.</span><span class="builtinfunc" id="3801997">make</span><span class="op" id="3802001">(</span><span class="num" id="3802002">0</span><span class="op" id="3802003">)</span>&nbsp;<span class="comment" id="3802005">//&nbsp;normalize&nbsp;denominator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3802031">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802034"><a href="/math/big/rat.go.html#3801778">z</a></span><span class="op" id="3802035">.</span><span class="ident" id="3802036">a</span><span class="op" id="3802037">.</span><span class="ident" id="3802038">abs</span><span class="op" id="3802041">,</span>&nbsp;<span class="ident" id="3802043"><a href="/math/big/rat.go.html#3801778">z</a></span><span class="op" id="3802044">.</span><span class="ident" id="3802045">b</span><span class="op" id="3802046">.</span><span class="ident" id="3802047">abs</span>&nbsp;<span class="op" id="3802051">=</span>&nbsp;<span class="ident" id="3802053"><a href="/math/big/rat.go.html#3801871">a</a></span><span class="op" id="3802054">,</span>&nbsp;<span class="ident" id="3802056"><a href="/math/big/rat.go.html#3801951">b</a></span>&nbsp;<span class="comment" id="3802058">//&nbsp;sign&nbsp;doesn&#39;t&nbsp;change</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3802082">return</span>&nbsp;<span class="ident" id="3802089"><a href="/math/big/rat.go.html#3801778">z</a></span><br>
<span class="lineno"></span><span class="op" id="3802091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3802094">//&nbsp;Sign&nbsp;returns:</span><br>
<span class="lineno">380</span><span class="comment" id="3802111">//</span><br>
<span class="lineno"></span><span class="comment" id="3802114">//&nbsp;&nbsp;&nbsp;&nbsp-1&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="3802130">//&nbsp;&nbsp;&nbsp;&nbsp&nbsp;0&nbsp;if&nbsp;x&nbsp;==&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="3802146">//&nbsp;&nbsp;&nbsp;&nbsp+1&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;&nbsp;0</span><br>
<span class="lineno"></span><span class="comment" id="3802162">//</span><br>
<span class="lineno">385</span><span class="keyword" id="3802165">func</span>&nbsp;<span class="op" id="3802170">(</span><span class="ident" id="3802171">x</span>&nbsp;<span class="op" id="3802173">*</span><span class="ident" id="3802174"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3802177">)</span>&nbsp;<span class="ident" id="3802179">Sign</span><span class="op" id="3802183">(</span><span class="op" id="3802184">)</span>&nbsp;<span class="builtintype" id="3802186">int</span>&nbsp;<span class="op" id="3802190">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3802193">return</span>&nbsp;<span class="ident" id="3802200"><a href="/math/big/rat.go.html#3802171">x</a></span><span class="op" id="3802201">.</span><span class="ident" id="3802202">a</span><span class="op" id="3802203">.</span><span class="ident" id="3802204">Sign</span><span class="op" id="3802208">(</span><span class="op" id="3802209">)</span><br>
<span class="lineno"></span><span class="op" id="3802211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3802214">//&nbsp;IsInt&nbsp;returns&nbsp;true&nbsp;if&nbsp;the&nbsp;denominator&nbsp;of&nbsp;x&nbsp;is&nbsp;1.</span><br>
<span class="lineno">390</span><span class="keyword" id="3802266">func</span>&nbsp;<span class="op" id="3802271">(</span><span class="ident" id="3802272">x</span>&nbsp;<span class="op" id="3802274">*</span><span class="ident" id="3802275"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3802278">)</span>&nbsp;<span class="ident" id="3802280">IsInt</span><span class="op" id="3802285">(</span><span class="op" id="3802286">)</span>&nbsp;<span class="builtintype" id="3802288">bool</span>&nbsp;<span class="op" id="3802293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3802296">return</span>&nbsp;<span class="builtinfunc" id="3802303">len</span><span class="op" id="3802306">(</span><span class="ident" id="3802307"><a href="/math/big/rat.go.html#3802272">x</a></span><span class="op" id="3802308">.</span><span class="ident" id="3802309">b</span><span class="op" id="3802310">.</span><span class="ident" id="3802311">abs</span><span class="op" id="3802314">)</span>&nbsp;<span class="op" id="3802316">==</span>&nbsp;<span class="num" id="3802319">0</span>&nbsp;<span class="op" id="3802321">||</span>&nbsp;<span class="ident" id="3802324"><a href="/math/big/rat.go.html#3802272">x</a></span><span class="op" id="3802325">.</span><span class="ident" id="3802326">b</span><span class="op" id="3802327">.</span><span class="ident" id="3802328">abs</span><span class="op" id="3802331">.</span><span class="ident" id="3802332">cmp</span><span class="op" id="3802335">(</span><span class="ident" id="3802336"><a href="/math/big/nat.go.html#3758911">natOne</a></span><span class="op" id="3802342">)</span>&nbsp;<span class="op" id="3802344">==</span>&nbsp;<span class="num" id="3802347">0</span><br>
<span class="lineno"></span><span class="op" id="3802349">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3802352">//&nbsp;Num&nbsp;returns&nbsp;the&nbsp;numerator&nbsp;of&nbsp;x;&nbsp;it&nbsp;may&nbsp;be&nbsp;&lt;=&nbsp;0.</span><br>
<span class="lineno">395</span><span class="comment" id="3802403">//&nbsp;The&nbsp;result&nbsp;is&nbsp;a&nbsp;reference&nbsp;to&nbsp;x&#39;s&nbsp;numerator;&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="3802453">//&nbsp;may&nbsp;change&nbsp;if&nbsp;a&nbsp;new&nbsp;value&nbsp;is&nbsp;assigned&nbsp;to&nbsp;x,&nbsp;and&nbsp;vice&nbsp;versa.</span><br>
<span class="lineno"></span><span class="comment" id="3802516">//&nbsp;The&nbsp;sign&nbsp;of&nbsp;the&nbsp;numerator&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;sign&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="3802575">func</span>&nbsp;<span class="op" id="3802580">(</span><span class="ident" id="3802581">x</span>&nbsp;<span class="op" id="3802583">*</span><span class="ident" id="3802584"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3802587">)</span>&nbsp;<span class="ident" id="3802589">Num</span><span class="op" id="3802592">(</span><span class="op" id="3802593">)</span>&nbsp;<span class="op" id="3802595">*</span><span class="ident" id="3802596"><a href="/math/big/int.go.html#3732722">Int</a></span>&nbsp;<span class="op" id="3802600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3802603">return</span>&nbsp;<span class="op" id="3802610">&amp;</span><span class="ident" id="3802611"><a href="/math/big/rat.go.html#3802581">x</a></span><span class="op" id="3802612">.</span><span class="ident" id="3802613">a</span><br>
<span class="lineno">400</span><span class="op" id="3802615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3802618">//&nbsp;Denom&nbsp;returns&nbsp;the&nbsp;denominator&nbsp;of&nbsp;x;&nbsp;it&nbsp;is&nbsp;always&nbsp;&gt;&nbsp;0.</span><br>
<span class="lineno"></span><span class="comment" id="3802675">//&nbsp;The&nbsp;result&nbsp;is&nbsp;a&nbsp;reference&nbsp;to&nbsp;x&#39;s&nbsp;denominator;&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="3802727">//&nbsp;may&nbsp;change&nbsp;if&nbsp;a&nbsp;new&nbsp;value&nbsp;is&nbsp;assigned&nbsp;to&nbsp;x,&nbsp;and&nbsp;vice&nbsp;versa.</span><br>
<span class="lineno">405</span><span class="keyword" id="3802790">func</span>&nbsp;<span class="op" id="3802795">(</span><span class="ident" id="3802796">x</span>&nbsp;<span class="op" id="3802798">*</span><span class="ident" id="3802799"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3802802">)</span>&nbsp;<span class="ident" id="3802804">Denom</span><span class="op" id="3802809">(</span><span class="op" id="3802810">)</span>&nbsp;<span class="op" id="3802812">*</span><span class="ident" id="3802813"><a href="/math/big/int.go.html#3732722">Int</a></span>&nbsp;<span class="op" id="3802817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802820"><a href="/math/big/rat.go.html#3802796">x</a></span><span class="op" id="3802821">.</span><span class="ident" id="3802822">b</span><span class="op" id="3802823">.</span><span class="ident" id="3802824">neg</span>&nbsp;<span class="op" id="3802828">=</span>&nbsp;<span class="builtintype" id="3802830">false</span>&nbsp;<span class="comment" id="3802836">//&nbsp;the&nbsp;result&nbsp;is&nbsp;always&nbsp;&gt;=&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3802866">if</span>&nbsp;<span class="builtinfunc" id="3802869">len</span><span class="op" id="3802872">(</span><span class="ident" id="3802873"><a href="/math/big/rat.go.html#3802796">x</a></span><span class="op" id="3802874">.</span><span class="ident" id="3802875">b</span><span class="op" id="3802876">.</span><span class="ident" id="3802877">abs</span><span class="op" id="3802880">)</span>&nbsp;<span class="op" id="3802882">==</span>&nbsp;<span class="num" id="3802885">0</span>&nbsp;<span class="op" id="3802887">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3802891"><a href="/math/big/rat.go.html#3802796">x</a></span><span class="op" id="3802892">.</span><span class="ident" id="3802893">b</span><span class="op" id="3802894">.</span><span class="ident" id="3802895">abs</span>&nbsp;<span class="op" id="3802899">=</span>&nbsp;<span class="ident" id="3802901"><a href="/math/big/rat.go.html#3802796">x</a></span><span class="op" id="3802902">.</span><span class="ident" id="3802903">b</span><span class="op" id="3802904">.</span><span class="ident" id="3802905">abs</span><span class="op" id="3802908">.</span><span class="ident" id="3802909">set</span><span class="op" id="3802912">(</span><span class="ident" id="3802913"><a href="/math/big/nat.go.html#3758911">natOne</a></span><span class="op" id="3802919">)</span>&nbsp;<span class="comment" id="3802921">//&nbsp;materialize&nbsp;denominator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3802949">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3802952">return</span>&nbsp;<span class="op" id="3802959">&amp;</span><span class="ident" id="3802960"><a href="/math/big/rat.go.html#3802796">x</a></span><span class="op" id="3802961">.</span><span class="ident" id="3802962">b</span><br>
<span class="lineno"></span><span class="op" id="3802964">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3802967">func</span>&nbsp;<span class="op" id="3802972">(</span><span class="ident" id="3802973">z</span>&nbsp;<span class="op" id="3802975">*</span><span class="ident" id="3802976"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3802979">)</span>&nbsp;<span class="ident" id="3802981">norm</span><span class="op" id="3802985">(</span><span class="op" id="3802986">)</span>&nbsp;<span class="op" id="3802988">*</span><span class="ident" id="3802989"><a href="/math/big/rat.go.html#3792985">Rat</a></span>&nbsp;<span class="op" id="3802993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3802996">switch</span>&nbsp;<span class="op" id="3803003">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803006">case</span>&nbsp;<span class="builtinfunc" id="3803011">len</span><span class="op" id="3803014">(</span><span class="ident" id="3803015"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803016">.</span><span class="ident" id="3803017">a</span><span class="op" id="3803018">.</span><span class="ident" id="3803019">abs</span><span class="op" id="3803022">)</span>&nbsp;<span class="op" id="3803024">==</span>&nbsp;<span class="num" id="3803027">0</span><span class="op" id="3803028">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3803032">//&nbsp;z&nbsp;==&nbsp;0&nbsp;-&nbsp;normalize&nbsp;sign&nbsp;and&nbsp;denominator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803077"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803078">.</span><span class="ident" id="3803079">a</span><span class="op" id="3803080">.</span><span class="ident" id="3803081">neg</span>&nbsp;<span class="op" id="3803085">=</span>&nbsp;<span class="builtintype" id="3803087">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803095"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803096">.</span><span class="ident" id="3803097">b</span><span class="op" id="3803098">.</span><span class="ident" id="3803099">abs</span>&nbsp;<span class="op" id="3803103">=</span>&nbsp;<span class="ident" id="3803105"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803106">.</span><span class="ident" id="3803107">b</span><span class="op" id="3803108">.</span><span class="ident" id="3803109">abs</span><span class="op" id="3803112">.</span><span class="builtinfunc" id="3803113">make</span><span class="op" id="3803117">(</span><span class="num" id="3803118">0</span><span class="op" id="3803119">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803122">case</span>&nbsp;<span class="builtinfunc" id="3803127">len</span><span class="op" id="3803130">(</span><span class="ident" id="3803131"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803132">.</span><span class="ident" id="3803133">b</span><span class="op" id="3803134">.</span><span class="ident" id="3803135">abs</span><span class="op" id="3803138">)</span>&nbsp;<span class="op" id="3803140">==</span>&nbsp;<span class="num" id="3803143">0</span><span class="op" id="3803144">:</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3803148">//&nbsp;z&nbsp;is&nbsp;normalized&nbsp;int&nbsp;-&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803188">case</span>&nbsp;<span class="ident" id="3803193"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803194">.</span><span class="ident" id="3803195">b</span><span class="op" id="3803196">.</span><span class="ident" id="3803197">abs</span><span class="op" id="3803200">.</span><span class="ident" id="3803201">cmp</span><span class="op" id="3803204">(</span><span class="ident" id="3803205"><a href="/math/big/nat.go.html#3758911">natOne</a></span><span class="op" id="3803211">)</span>&nbsp;<span class="op" id="3803213">==</span>&nbsp;<span class="num" id="3803216">0</span><span class="op" id="3803217">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3803221">//&nbsp;z&nbsp;is&nbsp;int&nbsp;-&nbsp;normalize&nbsp;denominator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803259"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803260">.</span><span class="ident" id="3803261">b</span><span class="op" id="3803262">.</span><span class="ident" id="3803263">abs</span>&nbsp;<span class="op" id="3803267">=</span>&nbsp;<span class="ident" id="3803269"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803270">.</span><span class="ident" id="3803271">b</span><span class="op" id="3803272">.</span><span class="ident" id="3803273">abs</span><span class="op" id="3803276">.</span><span class="builtinfunc" id="3803277">make</span><span class="op" id="3803281">(</span><span class="num" id="3803282">0</span><span class="op" id="3803283">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803286">default</span><span class="op" id="3803293">:</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803297">neg</span>&nbsp;<span class="op" id="3803301">:=</span>&nbsp;<span class="ident" id="3803304"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803305">.</span><span class="ident" id="3803306">a</span><span class="op" id="3803307">.</span><span class="ident" id="3803308">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803314"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803315">.</span><span class="ident" id="3803316">a</span><span class="op" id="3803317">.</span><span class="ident" id="3803318">neg</span>&nbsp;<span class="op" id="3803322">=</span>&nbsp;<span class="builtintype" id="3803324">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803332"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803333">.</span><span class="ident" id="3803334">b</span><span class="op" id="3803335">.</span><span class="ident" id="3803336">neg</span>&nbsp;<span class="op" id="3803340">=</span>&nbsp;<span class="builtintype" id="3803342">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803350">if</span>&nbsp;<span class="ident" id="3803353">f</span>&nbsp;<span class="op" id="3803355">:=</span>&nbsp;<span class="ident" id="3803358"><a href="/math/big/int.go.html#3733392">NewInt</a></span><span class="op" id="3803364">(</span><span class="num" id="3803365">0</span><span class="op" id="3803366">)</span><span class="op" id="3803367">.</span><span class="ident" id="3803368">binaryGCD</span><span class="op" id="3803377">(</span><span class="op" id="3803378">&amp;</span><span class="ident" id="3803379"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803380">.</span><span class="ident" id="3803381">a</span><span class="op" id="3803382">,</span>&nbsp;<span class="op" id="3803384">&amp;</span><span class="ident" id="3803385"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803386">.</span><span class="ident" id="3803387">b</span><span class="op" id="3803388">)</span><span class="op" id="3803389">;</span>&nbsp;<span class="ident" id="3803391"><a href="/math/big/rat.go.html#3803353">f</a></span><span class="op" id="3803392">.</span><span class="ident" id="3803393">Cmp</span><span class="op" id="3803396">(</span><span class="ident" id="3803397"><a href="/math/big/int.go.html#3732803">intOne</a></span><span class="op" id="3803403">)</span>&nbsp;<span class="op" id="3803405">!=</span>&nbsp;<span class="num" id="3803408">0</span>&nbsp;<span class="op" id="3803410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803415"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803416">.</span><span class="ident" id="3803417">a</span><span class="op" id="3803418">.</span><span class="ident" id="3803419">abs</span><span class="op" id="3803422">,</span>&nbsp;<span class="ident" id="3803424">_</span>&nbsp;<span class="op" id="3803426">=</span>&nbsp;<span class="ident" id="3803428"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803429">.</span><span class="ident" id="3803430">a</span><span class="op" id="3803431">.</span><span class="ident" id="3803432">abs</span><span class="op" id="3803435">.</span><span class="ident" id="3803436">div</span><span class="op" id="3803439">(</span><span class="ident" id="3803440">nil</span><span class="op" id="3803443">,</span>&nbsp;<span class="ident" id="3803445"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803446">.</span><span class="ident" id="3803447">a</span><span class="op" id="3803448">.</span><span class="ident" id="3803449">abs</span><span class="op" id="3803452">,</span>&nbsp;<span class="ident" id="3803454"><a href="/math/big/rat.go.html#3803353">f</a></span><span class="op" id="3803455">.</span><span class="ident" id="3803456">abs</span><span class="op" id="3803459">)</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803464"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803465">.</span><span class="ident" id="3803466">b</span><span class="op" id="3803467">.</span><span class="ident" id="3803468">abs</span><span class="op" id="3803471">,</span>&nbsp;<span class="ident" id="3803473">_</span>&nbsp;<span class="op" id="3803475">=</span>&nbsp;<span class="ident" id="3803477"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803478">.</span><span class="ident" id="3803479">b</span><span class="op" id="3803480">.</span><span class="ident" id="3803481">abs</span><span class="op" id="3803484">.</span><span class="ident" id="3803485">div</span><span class="op" id="3803488">(</span><span class="ident" id="3803489">nil</span><span class="op" id="3803492">,</span>&nbsp;<span class="ident" id="3803494"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803495">.</span><span class="ident" id="3803496">b</span><span class="op" id="3803497">.</span><span class="ident" id="3803498">abs</span><span class="op" id="3803501">,</span>&nbsp;<span class="ident" id="3803503"><a href="/math/big/rat.go.html#3803353">f</a></span><span class="op" id="3803504">.</span><span class="ident" id="3803505">abs</span><span class="op" id="3803508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803513">if</span>&nbsp;<span class="ident" id="3803516"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803517">.</span><span class="ident" id="3803518">b</span><span class="op" id="3803519">.</span><span class="ident" id="3803520">abs</span><span class="op" id="3803523">.</span><span class="ident" id="3803524">cmp</span><span class="op" id="3803527">(</span><span class="ident" id="3803528"><a href="/math/big/nat.go.html#3758911">natOne</a></span><span class="op" id="3803534">)</span>&nbsp;<span class="op" id="3803536">==</span>&nbsp;<span class="num" id="3803539">0</span>&nbsp;<span class="op" id="3803541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3803547">//&nbsp;z&nbsp;is&nbsp;int&nbsp;-&nbsp;normalize&nbsp;denominator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803587"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803588">.</span><span class="ident" id="3803589">b</span><span class="op" id="3803590">.</span><span class="ident" id="3803591">abs</span>&nbsp;<span class="op" id="3803595">=</span>&nbsp;<span class="ident" id="3803597"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803598">.</span><span class="ident" id="3803599">b</span><span class="op" id="3803600">.</span><span class="ident" id="3803601">abs</span><span class="op" id="3803604">.</span><span class="builtinfunc" id="3803605">make</span><span class="op" id="3803609">(</span><span class="num" id="3803610">0</span><span class="op" id="3803611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3803616">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3803620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3803624"><a href="/math/big/rat.go.html#3802973">z</a></span><span class="op" id="3803625">.</span><span class="ident" id="3803626">a</span><span class="op" id="3803627">.</span><span class="ident" id="3803628">neg</span>&nbsp;<span class="op" id="3803632">=</span>&nbsp;<span class="ident" id="3803634"><a href="/math/big/rat.go.html#3803297">neg</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3803639">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803642">return</span>&nbsp;<span class="ident" id="3803649"><a href="/math/big/rat.go.html#3802973">z</a></span><br>
<span class="lineno"></span><span class="op" id="3803651">}</span><br>
<span class="lineno">440</span><br>
<span class="lineno"></span><span class="comment" id="3803654">//&nbsp;mulDenom&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;denominator&nbsp;product&nbsp;x*y&nbsp;(by&nbsp;taking&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="3803720">//&nbsp;account&nbsp;that&nbsp;0&nbsp;values&nbsp;for&nbsp;x&nbsp;or&nbsp;y&nbsp;must&nbsp;be&nbsp;interpreted&nbsp;as&nbsp;1)&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="3803786">//&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword" id="3803800">func</span>&nbsp;<span class="ident" id="3803805">mulDenom</span><span class="op" id="3803813">(</span><span class="ident" id="3803814">z</span><span class="op" id="3803815">,</span>&nbsp;<span class="ident" id="3803817">x</span><span class="op" id="3803818">,</span>&nbsp;<span class="ident" id="3803820">y</span>&nbsp;<span class="ident" id="3803822"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3803825">)</span>&nbsp;<span class="ident" id="3803827"><a href="/math/big/nat.go.html#3758892">nat</a></span>&nbsp;<span class="op" id="3803831">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803834">switch</span>&nbsp;<span class="op" id="3803841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803844">case</span>&nbsp;<span class="builtinfunc" id="3803849">len</span><span class="op" id="3803852">(</span><span class="ident" id="3803853"><a href="/math/big/rat.go.html#3803817">x</a></span><span class="op" id="3803854">)</span>&nbsp;<span class="op" id="3803856">==</span>&nbsp;<span class="num" id="3803859">0</span><span class="op" id="3803860">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803864">return</span>&nbsp;<span class="ident" id="3803871"><a href="/math/big/rat.go.html#3803814">z</a></span><span class="op" id="3803872">.</span><span class="ident" id="3803873">set</span><span class="op" id="3803876">(</span><span class="ident" id="3803877"><a href="/math/big/rat.go.html#3803820">y</a></span><span class="op" id="3803878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803881">case</span>&nbsp;<span class="builtinfunc" id="3803886">len</span><span class="op" id="3803889">(</span><span class="ident" id="3803890"><a href="/math/big/rat.go.html#3803820">y</a></span><span class="op" id="3803891">)</span>&nbsp;<span class="op" id="3803893">==</span>&nbsp;<span class="num" id="3803896">0</span><span class="op" id="3803897">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803901">return</span>&nbsp;<span class="ident" id="3803908"><a href="/math/big/rat.go.html#3803814">z</a></span><span class="op" id="3803909">.</span><span class="ident" id="3803910">set</span><span class="op" id="3803913">(</span><span class="ident" id="3803914"><a href="/math/big/rat.go.html#3803817">x</a></span><span class="op" id="3803915">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3803918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3803921">return</span>&nbsp;<span class="ident" id="3803928"><a href="/math/big/rat.go.html#3803814">z</a></span><span class="op" id="3803929">.</span><span class="ident" id="3803930">mul</span><span class="op" id="3803933">(</span><span class="ident" id="3803934"><a href="/math/big/rat.go.html#3803817">x</a></span><span class="op" id="3803935">,</span>&nbsp;<span class="ident" id="3803937"><a href="/math/big/rat.go.html#3803820">y</a></span><span class="op" id="3803938">)</span><br>
<span class="lineno"></span><span class="op" id="3803940">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3803943">//&nbsp;scaleDenom&nbsp;computes&nbsp;x*f.</span><br>
<span class="lineno">455</span><span class="comment" id="3803971">//&nbsp;If&nbsp;f&nbsp;==&nbsp;0&nbsp;(zero&nbsp;value&nbsp;of&nbsp;denominator),&nbsp;the&nbsp;result&nbsp;is&nbsp;(a&nbsp;copy&nbsp;of)&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="3804042">func</span>&nbsp;<span class="ident" id="3804047">scaleDenom</span><span class="op" id="3804057">(</span><span class="ident" id="3804058">x</span>&nbsp;<span class="op" id="3804060">*</span><span class="ident" id="3804061"><a href="/math/big/int.go.html#3732722">Int</a></span><span class="op" id="3804064">,</span>&nbsp;<span class="ident" id="3804066">f</span>&nbsp;<span class="ident" id="3804068"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3804071">)</span>&nbsp;<span class="op" id="3804073">*</span><span class="ident" id="3804074"><a href="/math/big/int.go.html#3732722">Int</a></span>&nbsp;<span class="op" id="3804078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804081">var</span>&nbsp;<span class="ident" id="3804085">z</span>&nbsp;<span class="ident" id="3804087"><a href="/math/big/int.go.html#3732722">Int</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804092">if</span>&nbsp;<span class="builtinfunc" id="3804095">len</span><span class="op" id="3804098">(</span><span class="ident" id="3804099"><a href="/math/big/rat.go.html#3804066">f</a></span><span class="op" id="3804100">)</span>&nbsp;<span class="op" id="3804102">==</span>&nbsp;<span class="num" id="3804105">0</span>&nbsp;<span class="op" id="3804107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804111">return</span>&nbsp;<span class="ident" id="3804118"><a href="/math/big/rat.go.html#3804085">z</a></span><span class="op" id="3804119">.</span><span class="ident" id="3804120">Set</span><span class="op" id="3804123">(</span><span class="ident" id="3804124"><a href="/math/big/rat.go.html#3804058">x</a></span><span class="op" id="3804125">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3804128">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804131"><a href="/math/big/rat.go.html#3804085">z</a></span><span class="op" id="3804132">.</span><span class="ident" id="3804133">abs</span>&nbsp;<span class="op" id="3804137">=</span>&nbsp;<span class="ident" id="3804139"><a href="/math/big/rat.go.html#3804085">z</a></span><span class="op" id="3804140">.</span><span class="ident" id="3804141">abs</span><span class="op" id="3804144">.</span><span class="ident" id="3804145">mul</span><span class="op" id="3804148">(</span><span class="ident" id="3804149"><a href="/math/big/rat.go.html#3804058">x</a></span><span class="op" id="3804150">.</span><span class="ident" id="3804151">abs</span><span class="op" id="3804154">,</span>&nbsp;<span class="ident" id="3804156"><a href="/math/big/rat.go.html#3804066">f</a></span><span class="op" id="3804157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804160"><a href="/math/big/rat.go.html#3804085">z</a></span><span class="op" id="3804161">.</span><span class="ident" id="3804162">neg</span>&nbsp;<span class="op" id="3804166">=</span>&nbsp;<span class="ident" id="3804168"><a href="/math/big/rat.go.html#3804058">x</a></span><span class="op" id="3804169">.</span><span class="ident" id="3804170">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804175">return</span>&nbsp;<span class="op" id="3804182">&amp;</span><span class="ident" id="3804183"><a href="/math/big/rat.go.html#3804085">z</a></span><br>
<span class="lineno"></span><span class="op" id="3804185">}</span><br>
<span class="lineno">465</span><br>
<span class="lineno"></span><span class="comment" id="3804188">//&nbsp;Cmp&nbsp;compares&nbsp;x&nbsp;and&nbsp;y&nbsp;and&nbsp;returns:</span><br>
<span class="lineno"></span><span class="comment" id="3804225">//</span><br>
<span class="lineno"></span><span class="comment" id="3804228">//&nbsp;&nbsp;&nbsp;-1&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;&nbsp;y</span><br>
<span class="lineno"></span><span class="comment" id="3804246">//&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;if&nbsp;x&nbsp;==&nbsp;y</span><br>
<span class="lineno">470</span><span class="comment" id="3804264">//&nbsp;&nbsp;&nbsp;+1&nbsp;if&nbsp;x&nbsp;&gt;&nbsp;&nbsp;y</span><br>
<span class="lineno"></span><span class="comment" id="3804282">//</span><br>
<span class="lineno"></span><span class="keyword" id="3804285">func</span>&nbsp;<span class="op" id="3804290">(</span><span class="ident" id="3804291">x</span>&nbsp;<span class="op" id="3804293">*</span><span class="ident" id="3804294"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3804297">)</span>&nbsp;<span class="ident" id="3804299">Cmp</span><span class="op" id="3804302">(</span><span class="ident" id="3804303">y</span>&nbsp;<span class="op" id="3804305">*</span><span class="ident" id="3804306"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3804309">)</span>&nbsp;<span class="builtintype" id="3804311">int</span>&nbsp;<span class="op" id="3804315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804318">return</span>&nbsp;<span class="ident" id="3804325"><a href="/math/big/rat.go.html#3804047">scaleDenom</a></span><span class="op" id="3804335">(</span><span class="op" id="3804336">&amp;</span><span class="ident" id="3804337"><a href="/math/big/rat.go.html#3804291">x</a></span><span class="op" id="3804338">.</span><span class="ident" id="3804339">a</span><span class="op" id="3804340">,</span>&nbsp;<span class="ident" id="3804342"><a href="/math/big/rat.go.html#3804303">y</a></span><span class="op" id="3804343">.</span><span class="ident" id="3804344">b</span><span class="op" id="3804345">.</span><span class="ident" id="3804346">abs</span><span class="op" id="3804349">)</span><span class="op" id="3804350">.</span><span class="ident" id="3804351">Cmp</span><span class="op" id="3804354">(</span><span class="ident" id="3804355"><a href="/math/big/rat.go.html#3804047">scaleDenom</a></span><span class="op" id="3804365">(</span><span class="op" id="3804366">&amp;</span><span class="ident" id="3804367"><a href="/math/big/rat.go.html#3804303">y</a></span><span class="op" id="3804368">.</span><span class="ident" id="3804369">a</span><span class="op" id="3804370">,</span>&nbsp;<span class="ident" id="3804372"><a href="/math/big/rat.go.html#3804291">x</a></span><span class="op" id="3804373">.</span><span class="ident" id="3804374">b</span><span class="op" id="3804375">.</span><span class="ident" id="3804376">abs</span><span class="op" id="3804379">)</span><span class="op" id="3804380">)</span><br>
<span class="lineno"></span><span class="op" id="3804382">}</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span><span class="comment" id="3804385">//&nbsp;Add&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;sum&nbsp;x+y&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword" id="3804429">func</span>&nbsp;<span class="op" id="3804434">(</span><span class="ident" id="3804435">z</span>&nbsp;<span class="op" id="3804437">*</span><span class="ident" id="3804438"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3804441">)</span>&nbsp;<span class="ident" id="3804443">Add</span><span class="op" id="3804446">(</span><span class="ident" id="3804447">x</span><span class="op" id="3804448">,</span>&nbsp;<span class="ident" id="3804450">y</span>&nbsp;<span class="op" id="3804452">*</span><span class="ident" id="3804453"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3804456">)</span>&nbsp;<span class="op" id="3804458">*</span><span class="ident" id="3804459"><a href="/math/big/rat.go.html#3792985">Rat</a></span>&nbsp;<span class="op" id="3804463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804466">a1</span>&nbsp;<span class="op" id="3804469">:=</span>&nbsp;<span class="ident" id="3804472"><a href="/math/big/rat.go.html#3804047">scaleDenom</a></span><span class="op" id="3804482">(</span><span class="op" id="3804483">&amp;</span><span class="ident" id="3804484"><a href="/math/big/rat.go.html#3804447">x</a></span><span class="op" id="3804485">.</span><span class="ident" id="3804486">a</span><span class="op" id="3804487">,</span>&nbsp;<span class="ident" id="3804489"><a href="/math/big/rat.go.html#3804450">y</a></span><span class="op" id="3804490">.</span><span class="ident" id="3804491">b</span><span class="op" id="3804492">.</span><span class="ident" id="3804493">abs</span><span class="op" id="3804496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804499">a2</span>&nbsp;<span class="op" id="3804502">:=</span>&nbsp;<span class="ident" id="3804505"><a href="/math/big/rat.go.html#3804047">scaleDenom</a></span><span class="op" id="3804515">(</span><span class="op" id="3804516">&amp;</span><span class="ident" id="3804517"><a href="/math/big/rat.go.html#3804450">y</a></span><span class="op" id="3804518">.</span><span class="ident" id="3804519">a</span><span class="op" id="3804520">,</span>&nbsp;<span class="ident" id="3804522"><a href="/math/big/rat.go.html#3804447">x</a></span><span class="op" id="3804523">.</span><span class="ident" id="3804524">b</span><span class="op" id="3804525">.</span><span class="ident" id="3804526">abs</span><span class="op" id="3804529">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804532"><a href="/math/big/rat.go.html#3804435">z</a></span><span class="op" id="3804533">.</span><span class="ident" id="3804534">a</span><span class="op" id="3804535">.</span><span class="ident" id="3804536">Add</span><span class="op" id="3804539">(</span><span class="ident" id="3804540"><a href="/math/big/rat.go.html#3804466">a1</a></span><span class="op" id="3804542">,</span>&nbsp;<span class="ident" id="3804544"><a href="/math/big/rat.go.html#3804499">a2</a></span><span class="op" id="3804546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804549"><a href="/math/big/rat.go.html#3804435">z</a></span><span class="op" id="3804550">.</span><span class="ident" id="3804551">b</span><span class="op" id="3804552">.</span><span class="ident" id="3804553">abs</span>&nbsp;<span class="op" id="3804557">=</span>&nbsp;<span class="ident" id="3804559"><a href="/math/big/rat.go.html#3803805">mulDenom</a></span><span class="op" id="3804567">(</span><span class="ident" id="3804568"><a href="/math/big/rat.go.html#3804435">z</a></span><span class="op" id="3804569">.</span><span class="ident" id="3804570">b</span><span class="op" id="3804571">.</span><span class="ident" id="3804572">abs</span><span class="op" id="3804575">,</span>&nbsp;<span class="ident" id="3804577"><a href="/math/big/rat.go.html#3804447">x</a></span><span class="op" id="3804578">.</span><span class="ident" id="3804579">b</span><span class="op" id="3804580">.</span><span class="ident" id="3804581">abs</span><span class="op" id="3804584">,</span>&nbsp;<span class="ident" id="3804586"><a href="/math/big/rat.go.html#3804450">y</a></span><span class="op" id="3804587">.</span><span class="ident" id="3804588">b</span><span class="op" id="3804589">.</span><span class="ident" id="3804590">abs</span><span class="op" id="3804593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804596">return</span>&nbsp;<span class="ident" id="3804603"><a href="/math/big/rat.go.html#3804435">z</a></span><span class="op" id="3804604">.</span><span class="ident" id="3804605">norm</span><span class="op" id="3804609">(</span><span class="op" id="3804610">)</span><br>
<span class="lineno"></span><span class="op" id="3804612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="comment" id="3804615">//&nbsp;Sub&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;difference&nbsp;x-y&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="keyword" id="3804666">func</span>&nbsp;<span class="op" id="3804671">(</span><span class="ident" id="3804672">z</span>&nbsp;<span class="op" id="3804674">*</span><span class="ident" id="3804675"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3804678">)</span>&nbsp;<span class="ident" id="3804680">Sub</span><span class="op" id="3804683">(</span><span class="ident" id="3804684">x</span><span class="op" id="3804685">,</span>&nbsp;<span class="ident" id="3804687">y</span>&nbsp;<span class="op" id="3804689">*</span><span class="ident" id="3804690"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3804693">)</span>&nbsp;<span class="op" id="3804695">*</span><span class="ident" id="3804696"><a href="/math/big/rat.go.html#3792985">Rat</a></span>&nbsp;<span class="op" id="3804700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804703">a1</span>&nbsp;<span class="op" id="3804706">:=</span>&nbsp;<span class="ident" id="3804709"><a href="/math/big/rat.go.html#3804047">scaleDenom</a></span><span class="op" id="3804719">(</span><span class="op" id="3804720">&amp;</span><span class="ident" id="3804721"><a href="/math/big/rat.go.html#3804684">x</a></span><span class="op" id="3804722">.</span><span class="ident" id="3804723">a</span><span class="op" id="3804724">,</span>&nbsp;<span class="ident" id="3804726"><a href="/math/big/rat.go.html#3804687">y</a></span><span class="op" id="3804727">.</span><span class="ident" id="3804728">b</span><span class="op" id="3804729">.</span><span class="ident" id="3804730">abs</span><span class="op" id="3804733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804736">a2</span>&nbsp;<span class="op" id="3804739">:=</span>&nbsp;<span class="ident" id="3804742"><a href="/math/big/rat.go.html#3804047">scaleDenom</a></span><span class="op" id="3804752">(</span><span class="op" id="3804753">&amp;</span><span class="ident" id="3804754"><a href="/math/big/rat.go.html#3804687">y</a></span><span class="op" id="3804755">.</span><span class="ident" id="3804756">a</span><span class="op" id="3804757">,</span>&nbsp;<span class="ident" id="3804759"><a href="/math/big/rat.go.html#3804684">x</a></span><span class="op" id="3804760">.</span><span class="ident" id="3804761">b</span><span class="op" id="3804762">.</span><span class="ident" id="3804763">abs</span><span class="op" id="3804766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804769"><a href="/math/big/rat.go.html#3804672">z</a></span><span class="op" id="3804770">.</span><span class="ident" id="3804771">a</span><span class="op" id="3804772">.</span><span class="ident" id="3804773">Sub</span><span class="op" id="3804776">(</span><span class="ident" id="3804777"><a href="/math/big/rat.go.html#3804703">a1</a></span><span class="op" id="3804779">,</span>&nbsp;<span class="ident" id="3804781"><a href="/math/big/rat.go.html#3804736">a2</a></span><span class="op" id="3804783">)</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804786"><a href="/math/big/rat.go.html#3804672">z</a></span><span class="op" id="3804787">.</span><span class="ident" id="3804788">b</span><span class="op" id="3804789">.</span><span class="ident" id="3804790">abs</span>&nbsp;<span class="op" id="3804794">=</span>&nbsp;<span class="ident" id="3804796"><a href="/math/big/rat.go.html#3803805">mulDenom</a></span><span class="op" id="3804804">(</span><span class="ident" id="3804805"><a href="/math/big/rat.go.html#3804672">z</a></span><span class="op" id="3804806">.</span><span class="ident" id="3804807">b</span><span class="op" id="3804808">.</span><span class="ident" id="3804809">abs</span><span class="op" id="3804812">,</span>&nbsp;<span class="ident" id="3804814"><a href="/math/big/rat.go.html#3804684">x</a></span><span class="op" id="3804815">.</span><span class="ident" id="3804816">b</span><span class="op" id="3804817">.</span><span class="ident" id="3804818">abs</span><span class="op" id="3804821">,</span>&nbsp;<span class="ident" id="3804823"><a href="/math/big/rat.go.html#3804687">y</a></span><span class="op" id="3804824">.</span><span class="ident" id="3804825">b</span><span class="op" id="3804826">.</span><span class="ident" id="3804827">abs</span><span class="op" id="3804830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3804833">return</span>&nbsp;<span class="ident" id="3804840"><a href="/math/big/rat.go.html#3804672">z</a></span><span class="op" id="3804841">.</span><span class="ident" id="3804842">norm</span><span class="op" id="3804846">(</span><span class="op" id="3804847">)</span><br>
<span class="lineno"></span><span class="op" id="3804849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3804852">//&nbsp;Mul&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;product&nbsp;x*y&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno">495</span><span class="keyword" id="3804900">func</span>&nbsp;<span class="op" id="3804905">(</span><span class="ident" id="3804906">z</span>&nbsp;<span class="op" id="3804908">*</span><span class="ident" id="3804909"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3804912">)</span>&nbsp;<span class="ident" id="3804914">Mul</span><span class="op" id="3804917">(</span><span class="ident" id="3804918">x</span><span class="op" id="3804919">,</span>&nbsp;<span class="ident" id="3804921">y</span>&nbsp;<span class="op" id="3804923">*</span><span class="ident" id="3804924"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3804927">)</span>&nbsp;<span class="op" id="3804929">*</span><span class="ident" id="3804930"><a href="/math/big/rat.go.html#3792985">Rat</a></span>&nbsp;<span class="op" id="3804934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804937"><a href="/math/big/rat.go.html#3804906">z</a></span><span class="op" id="3804938">.</span><span class="ident" id="3804939">a</span><span class="op" id="3804940">.</span><span class="ident" id="3804941">Mul</span><span class="op" id="3804944">(</span><span class="op" id="3804945">&amp;</span><span class="ident" id="3804946"><a href="/math/big/rat.go.html#3804918">x</a></span><span class="op" id="3804947">.</span><span class="ident" id="3804948">a</span><span class="op" id="3804949">,</span>&nbsp;<span class="op" id="3804951">&amp;</span><span class="ident" id="3804952"><a href="/math/big/rat.go.html#3804921">y</a></span><span class="op" id="3804953">.</span><span class="ident" id="3804954">a</span><span class="op" id="3804955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3804958"><a href="/math/big/rat.go.html#3804906">z</a></span><span class="op" id="3804959">.</span><span class="ident" id="3804960">b</span><span class="op" id="3804961">.</span><span class="ident" id="3804962">abs</span>&nbsp;<span class="op" id="3804966">=</span>&nbsp;<span class="ident" id="3804968"><a href="/math/big/rat.go.html#3803805">mulDenom</a></span><span class="op" id="3804976">(</span><span class="ident" id="3804977"><a href="/math/big/rat.go.html#3804906">z</a></span><span class="op" id="3804978">.</span><span class="ident" id="3804979">b</span><span class="op" id="3804980">.</span><span class="ident" id="3804981">abs</span><span class="op" id="3804984">,</span>&nbsp;<span class="ident" id="3804986"><a href="/math/big/rat.go.html#3804918">x</a></span><span class="op" id="3804987">.</span><span class="ident" id="3804988">b</span><span class="op" id="3804989">.</span><span class="ident" id="3804990">abs</span><span class="op" id="3804993">,</span>&nbsp;<span class="ident" id="3804995"><a href="/math/big/rat.go.html#3804921">y</a></span><span class="op" id="3804996">.</span><span class="ident" id="3804997">b</span><span class="op" id="3804998">.</span><span class="ident" id="3804999">abs</span><span class="op" id="3805002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805005">return</span>&nbsp;<span class="ident" id="3805012"><a href="/math/big/rat.go.html#3804906">z</a></span><span class="op" id="3805013">.</span><span class="ident" id="3805014">norm</span><span class="op" id="3805018">(</span><span class="op" id="3805019">)</span><br>
<span class="lineno"></span><span class="op" id="3805021">}</span><br>
<span class="lineno">500</span><br>
<span class="lineno"></span><span class="comment" id="3805024">//&nbsp;Quo&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;quotient&nbsp;x/y&nbsp;and&nbsp;returns&nbsp;z.</span><br>
<span class="lineno"></span><span class="comment" id="3805073">//&nbsp;If&nbsp;y&nbsp;==&nbsp;0,&nbsp;a&nbsp;division-by-zero&nbsp;run-time&nbsp;panic&nbsp;occurs.</span><br>
<span class="lineno"></span><span class="keyword" id="3805129">func</span>&nbsp;<span class="op" id="3805134">(</span><span class="ident" id="3805135">z</span>&nbsp;<span class="op" id="3805137">*</span><span class="ident" id="3805138"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3805141">)</span>&nbsp;<span class="ident" id="3805143">Quo</span><span class="op" id="3805146">(</span><span class="ident" id="3805147">x</span><span class="op" id="3805148">,</span>&nbsp;<span class="ident" id="3805150">y</span>&nbsp;<span class="op" id="3805152">*</span><span class="ident" id="3805153"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3805156">)</span>&nbsp;<span class="op" id="3805158">*</span><span class="ident" id="3805159"><a href="/math/big/rat.go.html#3792985">Rat</a></span>&nbsp;<span class="op" id="3805163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805166">if</span>&nbsp;<span class="builtinfunc" id="3805169">len</span><span class="op" id="3805172">(</span><span class="ident" id="3805173"><a href="/math/big/rat.go.html#3805150">y</a></span><span class="op" id="3805174">.</span><span class="ident" id="3805175">a</span><span class="op" id="3805176">.</span><span class="ident" id="3805177">abs</span><span class="op" id="3805180">)</span>&nbsp;<span class="op" id="3805182">==</span>&nbsp;<span class="num" id="3805185">0</span>&nbsp;<span class="op" id="3805187">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3805191">panic</span><span class="op" id="3805196">(</span><span class="string" id="3805197">&#34;division&nbsp;by&nbsp;zero&#34;</span><span class="op" id="3805215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3805218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805221">a</span>&nbsp;<span class="op" id="3805223">:=</span>&nbsp;<span class="ident" id="3805226"><a href="/math/big/rat.go.html#3804047">scaleDenom</a></span><span class="op" id="3805236">(</span><span class="op" id="3805237">&amp;</span><span class="ident" id="3805238"><a href="/math/big/rat.go.html#3805147">x</a></span><span class="op" id="3805239">.</span><span class="ident" id="3805240">a</span><span class="op" id="3805241">,</span>&nbsp;<span class="ident" id="3805243"><a href="/math/big/rat.go.html#3805150">y</a></span><span class="op" id="3805244">.</span><span class="ident" id="3805245">b</span><span class="op" id="3805246">.</span><span class="ident" id="3805247">abs</span><span class="op" id="3805250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805253">b</span>&nbsp;<span class="op" id="3805255">:=</span>&nbsp;<span class="ident" id="3805258"><a href="/math/big/rat.go.html#3804047">scaleDenom</a></span><span class="op" id="3805268">(</span><span class="op" id="3805269">&amp;</span><span class="ident" id="3805270"><a href="/math/big/rat.go.html#3805150">y</a></span><span class="op" id="3805271">.</span><span class="ident" id="3805272">a</span><span class="op" id="3805273">,</span>&nbsp;<span class="ident" id="3805275"><a href="/math/big/rat.go.html#3805147">x</a></span><span class="op" id="3805276">.</span><span class="ident" id="3805277">b</span><span class="op" id="3805278">.</span><span class="ident" id="3805279">abs</span><span class="op" id="3805282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805285"><a href="/math/big/rat.go.html#3805135">z</a></span><span class="op" id="3805286">.</span><span class="ident" id="3805287">a</span><span class="op" id="3805288">.</span><span class="ident" id="3805289">abs</span>&nbsp;<span class="op" id="3805293">=</span>&nbsp;<span class="ident" id="3805295"><a href="/math/big/rat.go.html#3805221">a</a></span><span class="op" id="3805296">.</span><span class="ident" id="3805297">abs</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805302"><a href="/math/big/rat.go.html#3805135">z</a></span><span class="op" id="3805303">.</span><span class="ident" id="3805304">b</span><span class="op" id="3805305">.</span><span class="ident" id="3805306">abs</span>&nbsp;<span class="op" id="3805310">=</span>&nbsp;<span class="ident" id="3805312"><a href="/math/big/rat.go.html#3805253">b</a></span><span class="op" id="3805313">.</span><span class="ident" id="3805314">abs</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805319"><a href="/math/big/rat.go.html#3805135">z</a></span><span class="op" id="3805320">.</span><span class="ident" id="3805321">a</span><span class="op" id="3805322">.</span><span class="ident" id="3805323">neg</span>&nbsp;<span class="op" id="3805327">=</span>&nbsp;<span class="ident" id="3805329"><a href="/math/big/rat.go.html#3805221">a</a></span><span class="op" id="3805330">.</span><span class="ident" id="3805331">neg</span>&nbsp;<span class="op" id="3805335">!=</span>&nbsp;<span class="ident" id="3805338"><a href="/math/big/rat.go.html#3805253">b</a></span><span class="op" id="3805339">.</span><span class="ident" id="3805340">neg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805345">return</span>&nbsp;<span class="ident" id="3805352"><a href="/math/big/rat.go.html#3805135">z</a></span><span class="op" id="3805353">.</span><span class="ident" id="3805354">norm</span><span class="op" id="3805358">(</span><span class="op" id="3805359">)</span><br>
<span class="lineno"></span><span class="op" id="3805361">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">515</span><span class="keyword" id="3805364">func</span>&nbsp;<span class="ident" id="3805369">ratTok</span><span class="op" id="3805375">(</span><span class="ident" id="3805376">ch</span>&nbsp;<span class="builtintype" id="3805379">rune</span><span class="op" id="3805383">)</span>&nbsp;<span class="builtintype" id="3805385">bool</span>&nbsp;<span class="op" id="3805390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805393">return</span>&nbsp;<span class="ident" id="3805400"><a href="/math/big/rat.go.html#3792856">strings</a></span><span class="op" id="3805407">.</span><span class="ident" id="3805408">IndexRune</span><span class="op" id="3805417">(</span><span class="string" id="3805418">&#34;+-/0123456789.eE&#34;</span><span class="op" id="3805436">,</span>&nbsp;<span class="ident" id="3805438"><a href="/math/big/rat.go.html#3805376">ch</a></span><span class="op" id="3805440">)</span>&nbsp;<span class="op" id="3805442">&gt;=</span>&nbsp;<span class="num" id="3805445">0</span><br>
<span class="lineno"></span><span class="op" id="3805447">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3805450">//&nbsp;Scan&nbsp;is&nbsp;a&nbsp;support&nbsp;routine&nbsp;for&nbsp;fmt.Scanner.&nbsp;It&nbsp;accepts&nbsp;the&nbsp;formats</span><br>
<span class="lineno">520</span><span class="comment" id="3805519">//&nbsp;&#39;e&#39;,&nbsp;&#39;E&#39;,&nbsp;&#39;f&#39;,&nbsp;&#39;F&#39;,&nbsp;&#39;g&#39;,&nbsp;&#39;G&#39;,&nbsp;and&nbsp;&#39;v&#39;.&nbsp;All&nbsp;formats&nbsp;are&nbsp;equivalent.</span><br>
<span class="lineno"></span><span class="keyword" id="3805589">func</span>&nbsp;<span class="op" id="3805594">(</span><span class="ident" id="3805595">z</span>&nbsp;<span class="op" id="3805597">*</span><span class="ident" id="3805598"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3805601">)</span>&nbsp;<span class="ident" id="3805603">Scan</span><span class="op" id="3805607">(</span><span class="ident" id="3805608">s</span>&nbsp;<span class="ident" id="3805610"><a href="/math/big/rat.go.html#3792841">fmt</a></span><span class="op" id="3805613">.</span><span class="ident" id="3805614">ScanState</span><span class="op" id="3805623">,</span>&nbsp;<span class="ident" id="3805625">ch</span>&nbsp;<span class="builtintype" id="3805628">rune</span><span class="op" id="3805632">)</span>&nbsp;<span class="builtintype" id="3805634">error</span>&nbsp;<span class="op" id="3805640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3805643">tok</span><span class="op" id="3805646">,</span>&nbsp;<span class="ident" id="3805648">err</span>&nbsp;<span class="op" id="3805652">:=</span>&nbsp;<span class="ident" id="3805655"><a href="/math/big/rat.go.html#3805608">s</a></span><span class="op" id="3805656">.</span><span class="ident" id="3805657">Token</span><span class="op" id="3805662">(</span><span class="builtintype" id="3805663">true</span><span class="op" id="3805667">,</span>&nbsp;<span class="ident" id="3805669"><a href="/math/big/rat.go.html#3805369">ratTok</a></span><span class="op" id="3805675">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805678">if</span>&nbsp;<span class="ident" id="3805681"><a href="/math/big/rat.go.html#3805648">err</a></span>&nbsp;<span class="op" id="3805685">!=</span>&nbsp;<span class="ident" id="3805688">nil</span>&nbsp;<span class="op" id="3805692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805696">return</span>&nbsp;<span class="ident" id="3805703"><a href="/math/big/rat.go.html#3805648">err</a></span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3805708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805711">if</span>&nbsp;<span class="ident" id="3805714"><a href="/math/big/rat.go.html#3792856">strings</a></span><span class="op" id="3805721">.</span><span class="ident" id="3805722">IndexRune</span><span class="op" id="3805731">(</span><span class="string" id="3805732">&#34;efgEFGv&#34;</span><span class="op" id="3805741">,</span>&nbsp;<span class="ident" id="3805743"><a href="/math/big/rat.go.html#3805625">ch</a></span><span class="op" id="3805745">)</span>&nbsp;<span class="op" id="3805747">&lt;</span>&nbsp;<span class="num" id="3805749">0</span>&nbsp;<span class="op" id="3805751">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805755">return</span>&nbsp;<span class="ident" id="3805762"><a href="/math/big/rat.go.html#3792831">errors</a></span><span class="op" id="3805768">.</span><span class="ident" id="3805769">New</span><span class="op" id="3805772">(</span><span class="string" id="3805773">&#34;Rat.Scan:&nbsp;invalid&nbsp;verb&#34;</span><span class="op" id="3805797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3805800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805803">if</span>&nbsp;<span class="ident" id="3805806">_</span><span class="op" id="3805807">,</span>&nbsp;<span class="ident" id="3805809">ok</span>&nbsp;<span class="op" id="3805812">:=</span>&nbsp;<span class="ident" id="3805815"><a href="/math/big/rat.go.html#3805595">z</a></span><span class="op" id="3805816">.</span><span class="ident" id="3805817">SetString</span><span class="op" id="3805826">(</span><span class="builtintype" id="3805827">string</span><span class="op" id="3805833">(</span><span class="ident" id="3805834"><a href="/math/big/rat.go.html#3805643">tok</a></span><span class="op" id="3805837">)</span><span class="op" id="3805838">)</span><span class="op" id="3805839">;</span>&nbsp;<span class="op" id="3805841">!</span><span class="ident" id="3805842"><a href="/math/big/rat.go.html#3805809">ok</a></span>&nbsp;<span class="op" id="3805845">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805849">return</span>&nbsp;<span class="ident" id="3805856"><a href="/math/big/rat.go.html#3792831">errors</a></span><span class="op" id="3805862">.</span><span class="ident" id="3805863">New</span><span class="op" id="3805866">(</span><span class="string" id="3805867">&#34;Rat.Scan:&nbsp;invalid&nbsp;syntax&#34;</span><span class="op" id="3805893">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3805896">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3805899">return</span>&nbsp;<span class="ident" id="3805906">nil</span><br>
<span class="lineno"></span><span class="op" id="3805910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">535</span><span class="comment" id="3805913">//&nbsp;SetString&nbsp;sets&nbsp;z&nbsp;to&nbsp;the&nbsp;value&nbsp;of&nbsp;s&nbsp;and&nbsp;returns&nbsp;z&nbsp;and&nbsp;a&nbsp;boolean&nbsp;indicating</span><br>
<span class="lineno"></span><span class="comment" id="3805990">//&nbsp;success.&nbsp;s&nbsp;can&nbsp;be&nbsp;given&nbsp;as&nbsp;a&nbsp;fraction&nbsp;&#34;a/b&#34;&nbsp;or&nbsp;as&nbsp;a&nbsp;floating-point&nbsp;number</span><br>
<span class="lineno"></span><span class="comment" id="3806067">//&nbsp;optionally&nbsp;followed&nbsp;by&nbsp;an&nbsp;exponent.&nbsp;If&nbsp;the&nbsp;operation&nbsp;failed,&nbsp;the&nbsp;value&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3806144">//&nbsp;z&nbsp;is&nbsp;undefined&nbsp;but&nbsp;the&nbsp;returned&nbsp;value&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="3806193">func</span>&nbsp;<span class="op" id="3806198">(</span><span class="ident" id="3806199">z</span>&nbsp;<span class="op" id="3806201">*</span><span class="ident" id="3806202"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3806205">)</span>&nbsp;<span class="ident" id="3806207">SetString</span><span class="op" id="3806216">(</span><span class="ident" id="3806217">s</span>&nbsp;<span class="builtintype" id="3806219">string</span><span class="op" id="3806225">)</span>&nbsp;<span class="op" id="3806227">(</span><span class="op" id="3806228">*</span><span class="ident" id="3806229"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3806232">,</span>&nbsp;<span class="builtintype" id="3806234">bool</span><span class="op" id="3806238">)</span>&nbsp;<span class="op" id="3806240">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806243">if</span>&nbsp;<span class="builtinfunc" id="3806246">len</span><span class="op" id="3806249">(</span><span class="ident" id="3806250"><a href="/math/big/rat.go.html#3806217">s</a></span><span class="op" id="3806251">)</span>&nbsp;<span class="op" id="3806253">==</span>&nbsp;<span class="num" id="3806256">0</span>&nbsp;<span class="op" id="3806258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806262">return</span>&nbsp;<span class="ident" id="3806269">nil</span><span class="op" id="3806272">,</span>&nbsp;<span class="builtintype" id="3806274">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3806281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3806285">//&nbsp;check&nbsp;for&nbsp;a&nbsp;quotient</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3806310">sep</span>&nbsp;<span class="op" id="3806314">:=</span>&nbsp;<span class="ident" id="3806317"><a href="/math/big/rat.go.html#3792856">strings</a></span><span class="op" id="3806324">.</span><span class="ident" id="3806325">Index</span><span class="op" id="3806330">(</span><span class="ident" id="3806331"><a href="/math/big/rat.go.html#3806217">s</a></span><span class="op" id="3806332">,</span>&nbsp;<span class="string" id="3806334">&#34;/&#34;</span><span class="op" id="3806337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806340">if</span>&nbsp;<span class="ident" id="3806343"><a href="/math/big/rat.go.html#3806310">sep</a></span>&nbsp;<span class="op" id="3806347">&gt;=</span>&nbsp;<span class="num" id="3806350">0</span>&nbsp;<span class="op" id="3806352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806356">if</span>&nbsp;<span class="ident" id="3806359">_</span><span class="op" id="3806360">,</span>&nbsp;<span class="ident" id="3806362">ok</span>&nbsp;<span class="op" id="3806365">:=</span>&nbsp;<span class="ident" id="3806368"><a href="/math/big/rat.go.html#3806199">z</a></span><span class="op" id="3806369">.</span><span class="ident" id="3806370">a</span><span class="op" id="3806371">.</span><span class="ident" id="3806372">SetString</span><span class="op" id="3806381">(</span><span class="ident" id="3806382"><a href="/math/big/rat.go.html#3806217">s</a></span><span class="op" id="3806383">[</span><span class="num" id="3806384">0</span><span class="op" id="3806385">:</span><span class="ident" id="3806386"><a href="/math/big/rat.go.html#3806310">sep</a></span><span class="op" id="3806389">]</span><span class="op" id="3806390">,</span>&nbsp;<span class="num" id="3806392">10</span><span class="op" id="3806394">)</span><span class="op" id="3806395">;</span>&nbsp;<span class="op" id="3806397">!</span><span class="ident" id="3806398"><a href="/math/big/rat.go.html#3806362">ok</a></span>&nbsp;<span class="op" id="3806401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806406">return</span>&nbsp;<span class="ident" id="3806413">nil</span><span class="op" id="3806416">,</span>&nbsp;<span class="builtintype" id="3806418">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3806426">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3806430"><a href="/math/big/rat.go.html#3806217">s</a></span>&nbsp;<span class="op" id="3806432">=</span>&nbsp;<span class="ident" id="3806434"><a href="/math/big/rat.go.html#3806217">s</a></span><span class="op" id="3806435">[</span><span class="ident" id="3806436"><a href="/math/big/rat.go.html#3806310">sep</a></span><span class="op" id="3806439">+</span><span class="num" id="3806440">1</span><span class="op" id="3806441">:</span><span class="op" id="3806442">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806446">var</span>&nbsp;<span class="ident" id="3806450">err</span>&nbsp;<span class="builtintype" id="3806454">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806462">if</span>&nbsp;<span class="ident" id="3806465"><a href="/math/big/rat.go.html#3806199">z</a></span><span class="op" id="3806466">.</span><span class="ident" id="3806467">b</span><span class="op" id="3806468">.</span><span class="ident" id="3806469">abs</span><span class="op" id="3806472">,</span>&nbsp;<span class="ident" id="3806474">_</span><span class="op" id="3806475">,</span>&nbsp;<span class="ident" id="3806477"><a href="/math/big/rat.go.html#3806450">err</a></span>&nbsp;<span class="op" id="3806481">=</span>&nbsp;<span class="ident" id="3806483"><a href="/math/big/rat.go.html#3806199">z</a></span><span class="op" id="3806484">.</span><span class="ident" id="3806485">b</span><span class="op" id="3806486">.</span><span class="ident" id="3806487">abs</span><span class="op" id="3806490">.</span><span class="ident" id="3806491">scan</span><span class="op" id="3806495">(</span><span class="ident" id="3806496"><a href="/math/big/rat.go.html#3792856">strings</a></span><span class="op" id="3806503">.</span><span class="ident" id="3806504">NewReader</span><span class="op" id="3806513">(</span><span class="ident" id="3806514"><a href="/math/big/rat.go.html#3806217">s</a></span><span class="op" id="3806515">)</span><span class="op" id="3806516">,</span>&nbsp;<span class="num" id="3806518">10</span><span class="op" id="3806520">)</span><span class="op" id="3806521">;</span>&nbsp;<span class="ident" id="3806523"><a href="/math/big/rat.go.html#3806450">err</a></span>&nbsp;<span class="op" id="3806527">!=</span>&nbsp;<span class="ident" id="3806530">nil</span>&nbsp;<span class="op" id="3806534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806539">return</span>&nbsp;<span class="ident" id="3806546">nil</span><span class="op" id="3806549">,</span>&nbsp;<span class="builtintype" id="3806551">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3806559">}</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806563">if</span>&nbsp;<span class="builtinfunc" id="3806566">len</span><span class="op" id="3806569">(</span><span class="ident" id="3806570"><a href="/math/big/rat.go.html#3806199">z</a></span><span class="op" id="3806571">.</span><span class="ident" id="3806572">b</span><span class="op" id="3806573">.</span><span class="ident" id="3806574">abs</span><span class="op" id="3806577">)</span>&nbsp;<span class="op" id="3806579">==</span>&nbsp;<span class="num" id="3806582">0</span>&nbsp;<span class="op" id="3806584">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806589">return</span>&nbsp;<span class="ident" id="3806596">nil</span><span class="op" id="3806599">,</span>&nbsp;<span class="builtintype" id="3806601">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3806609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806613">return</span>&nbsp;<span class="ident" id="3806620"><a href="/math/big/rat.go.html#3806199">z</a></span><span class="op" id="3806621">.</span><span class="ident" id="3806622">norm</span><span class="op" id="3806626">(</span><span class="op" id="3806627">)</span><span class="op" id="3806628">,</span>&nbsp;<span class="builtintype" id="3806630">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3806636">}</span><br>
<span class="lineno">560</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3806640">//&nbsp;check&nbsp;for&nbsp;a&nbsp;decimal&nbsp;point</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3806670"><a href="/math/big/rat.go.html#3806310">sep</a></span>&nbsp;<span class="op" id="3806674">=</span>&nbsp;<span class="ident" id="3806676"><a href="/math/big/rat.go.html#3792856">strings</a></span><span class="op" id="3806683">.</span><span class="ident" id="3806684">Index</span><span class="op" id="3806689">(</span><span class="ident" id="3806690"><a href="/math/big/rat.go.html#3806217">s</a></span><span class="op" id="3806691">,</span>&nbsp;<span class="string" id="3806693">&#34;.&#34;</span><span class="op" id="3806696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3806699">//&nbsp;check&nbsp;for&nbsp;an&nbsp;exponent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3806725">e</span>&nbsp;<span class="op" id="3806727">:=</span>&nbsp;<span class="ident" id="3806730"><a href="/math/big/rat.go.html#3792856">strings</a></span><span class="op" id="3806737">.</span><span class="ident" id="3806738">IndexAny</span><span class="op" id="3806746">(</span><span class="ident" id="3806747"><a href="/math/big/rat.go.html#3806217">s</a></span><span class="op" id="3806748">,</span>&nbsp;<span class="string" id="3806750">&#34;eE&#34;</span><span class="op" id="3806754">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806757">var</span>&nbsp;<span class="ident" id="3806761">exp</span>&nbsp;<span class="ident" id="3806765"><a href="/math/big/int.go.html#3732722">Int</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806770">if</span>&nbsp;<span class="ident" id="3806773"><a href="/math/big/rat.go.html#3806725">e</a></span>&nbsp;<span class="op" id="3806775">&gt;=</span>&nbsp;<span class="num" id="3806778">0</span>&nbsp;<span class="op" id="3806780">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806784">if</span>&nbsp;<span class="ident" id="3806787"><a href="/math/big/rat.go.html#3806725">e</a></span>&nbsp;<span class="op" id="3806789">&lt;</span>&nbsp;<span class="ident" id="3806791"><a href="/math/big/rat.go.html#3806310">sep</a></span>&nbsp;<span class="op" id="3806795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3806800">//&nbsp;The&nbsp;E&nbsp;must&nbsp;come&nbsp;after&nbsp;the&nbsp;decimal&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806847">return</span>&nbsp;<span class="ident" id="3806854">nil</span><span class="op" id="3806857">,</span>&nbsp;<span class="builtintype" id="3806859">false</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3806867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806871">if</span>&nbsp;<span class="ident" id="3806874">_</span><span class="op" id="3806875">,</span>&nbsp;<span class="ident" id="3806877">ok</span>&nbsp;<span class="op" id="3806880">:=</span>&nbsp;<span class="ident" id="3806883"><a href="/math/big/rat.go.html#3806761">exp</a></span><span class="op" id="3806886">.</span><span class="ident" id="3806887">SetString</span><span class="op" id="3806896">(</span><span class="ident" id="3806897"><a href="/math/big/rat.go.html#3806217">s</a></span><span class="op" id="3806898">[</span><span class="ident" id="3806899"><a href="/math/big/rat.go.html#3806725">e</a></span><span class="op" id="3806900">+</span><span class="num" id="3806901">1</span><span class="op" id="3806902">:</span><span class="op" id="3806903">]</span><span class="op" id="3806904">,</span>&nbsp;<span class="num" id="3806906">10</span><span class="op" id="3806908">)</span><span class="op" id="3806909">;</span>&nbsp;<span class="op" id="3806911">!</span><span class="ident" id="3806912"><a href="/math/big/rat.go.html#3806877">ok</a></span>&nbsp;<span class="op" id="3806915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806920">return</span>&nbsp;<span class="ident" id="3806927">nil</span><span class="op" id="3806930">,</span>&nbsp;<span class="builtintype" id="3806932">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3806940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3806944"><a href="/math/big/rat.go.html#3806217">s</a></span>&nbsp;<span class="op" id="3806946">=</span>&nbsp;<span class="ident" id="3806948"><a href="/math/big/rat.go.html#3806217">s</a></span><span class="op" id="3806949">[</span><span class="num" id="3806950">0</span><span class="op" id="3806951">:</span><span class="ident" id="3806952"><a href="/math/big/rat.go.html#3806725">e</a></span><span class="op" id="3806953">]</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3806956">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3806959">if</span>&nbsp;<span class="ident" id="3806962"><a href="/math/big/rat.go.html#3806310">sep</a></span>&nbsp;<span class="op" id="3806966">&gt;=</span>&nbsp;<span class="num" id="3806969">0</span>&nbsp;<span class="op" id="3806971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3806975"><a href="/math/big/rat.go.html#3806217">s</a></span>&nbsp;<span class="op" id="3806977">=</span>&nbsp;<span class="ident" id="3806979"><a href="/math/big/rat.go.html#3806217">s</a></span><span class="op" id="3806980">[</span><span class="num" id="3806981">0</span><span class="op" id="3806982">:</span><span class="ident" id="3806983"><a href="/math/big/rat.go.html#3806310">sep</a></span><span class="op" id="3806986">]</span>&nbsp;<span class="op" id="3806988">+</span>&nbsp;<span class="ident" id="3806990"><a href="/math/big/rat.go.html#3806217">s</a></span><span class="op" id="3806991">[</span><span class="ident" id="3806992"><a href="/math/big/rat.go.html#3806310">sep</a></span><span class="op" id="3806995">+</span><span class="num" id="3806996">1</span><span class="op" id="3806997">:</span><span class="op" id="3806998">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807002"><a href="/math/big/rat.go.html#3806761">exp</a></span><span class="op" id="3807005">.</span><span class="ident" id="3807006">Sub</span><span class="op" id="3807009">(</span><span class="op" id="3807010">&amp;</span><span class="ident" id="3807011"><a href="/math/big/rat.go.html#3806761">exp</a></span><span class="op" id="3807014">,</span>&nbsp;<span class="ident" id="3807016"><a href="/math/big/int.go.html#3733392">NewInt</a></span><span class="op" id="3807022">(</span><span class="ident" id="3807023">int64</span><span class="op" id="3807028">(</span><span class="builtinfunc" id="3807029">len</span><span class="op" id="3807032">(</span><span class="ident" id="3807033"><a href="/math/big/rat.go.html#3806217">s</a></span><span class="op" id="3807034">)</span><span class="op" id="3807035">-</span><span class="ident" id="3807036"><a href="/math/big/rat.go.html#3806310">sep</a></span><span class="op" id="3807039">)</span><span class="op" id="3807040">)</span><span class="op" id="3807041">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3807044">}</span><br>
<span class="lineno">580</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807048">if</span>&nbsp;<span class="ident" id="3807051">_</span><span class="op" id="3807052">,</span>&nbsp;<span class="ident" id="3807054">ok</span>&nbsp;<span class="op" id="3807057">:=</span>&nbsp;<span class="ident" id="3807060"><a href="/math/big/rat.go.html#3806199">z</a></span><span class="op" id="3807061">.</span><span class="ident" id="3807062">a</span><span class="op" id="3807063">.</span><span class="ident" id="3807064">SetString</span><span class="op" id="3807073">(</span><span class="ident" id="3807074"><a href="/math/big/rat.go.html#3806217">s</a></span><span class="op" id="3807075">,</span>&nbsp;<span class="num" id="3807077">10</span><span class="op" id="3807079">)</span><span class="op" id="3807080">;</span>&nbsp;<span class="op" id="3807082">!</span><span class="ident" id="3807083"><a href="/math/big/rat.go.html#3807054">ok</a></span>&nbsp;<span class="op" id="3807086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807090">return</span>&nbsp;<span class="ident" id="3807097">nil</span><span class="op" id="3807100">,</span>&nbsp;<span class="builtintype" id="3807102">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3807109">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807112">powTen</span>&nbsp;<span class="op" id="3807119">:=</span>&nbsp;<span class="ident" id="3807122"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3807125">(</span><span class="ident" id="3807126">nil</span><span class="op" id="3807129">)</span><span class="op" id="3807130">.</span><span class="ident" id="3807131">expNN</span><span class="op" id="3807136">(</span><span class="ident" id="3807137"><a href="/math/big/nat.go.html#3758945">natTen</a></span><span class="op" id="3807143">,</span>&nbsp;<span class="ident" id="3807145"><a href="/math/big/rat.go.html#3806761">exp</a></span><span class="op" id="3807148">.</span><span class="ident" id="3807149">abs</span><span class="op" id="3807152">,</span>&nbsp;<span class="ident" id="3807154">nil</span><span class="op" id="3807157">)</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807160">if</span>&nbsp;<span class="ident" id="3807163"><a href="/math/big/rat.go.html#3806761">exp</a></span><span class="op" id="3807166">.</span><span class="ident" id="3807167">neg</span>&nbsp;<span class="op" id="3807171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807175"><a href="/math/big/rat.go.html#3806199">z</a></span><span class="op" id="3807176">.</span><span class="ident" id="3807177">b</span><span class="op" id="3807178">.</span><span class="ident" id="3807179">abs</span>&nbsp;<span class="op" id="3807183">=</span>&nbsp;<span class="ident" id="3807185"><a href="/math/big/rat.go.html#3807112">powTen</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807194"><a href="/math/big/rat.go.html#3806199">z</a></span><span class="op" id="3807195">.</span><span class="ident" id="3807196">norm</span><span class="op" id="3807200">(</span><span class="op" id="3807201">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3807204">}</span>&nbsp;<span class="keyword" id="3807206">else</span>&nbsp;<span class="op" id="3807211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807215"><a href="/math/big/rat.go.html#3806199">z</a></span><span class="op" id="3807216">.</span><span class="ident" id="3807217">a</span><span class="op" id="3807218">.</span><span class="ident" id="3807219">abs</span>&nbsp;<span class="op" id="3807223">=</span>&nbsp;<span class="ident" id="3807225"><a href="/math/big/rat.go.html#3806199">z</a></span><span class="op" id="3807226">.</span><span class="ident" id="3807227">a</span><span class="op" id="3807228">.</span><span class="ident" id="3807229">abs</span><span class="op" id="3807232">.</span><span class="ident" id="3807233">mul</span><span class="op" id="3807236">(</span><span class="ident" id="3807237"><a href="/math/big/rat.go.html#3806199">z</a></span><span class="op" id="3807238">.</span><span class="ident" id="3807239">a</span><span class="op" id="3807240">.</span><span class="ident" id="3807241">abs</span><span class="op" id="3807244">,</span>&nbsp;<span class="ident" id="3807246"><a href="/math/big/rat.go.html#3807112">powTen</a></span><span class="op" id="3807252">)</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807256"><a href="/math/big/rat.go.html#3806199">z</a></span><span class="op" id="3807257">.</span><span class="ident" id="3807258">b</span><span class="op" id="3807259">.</span><span class="ident" id="3807260">abs</span>&nbsp;<span class="op" id="3807264">=</span>&nbsp;<span class="ident" id="3807266"><a href="/math/big/rat.go.html#3806199">z</a></span><span class="op" id="3807267">.</span><span class="ident" id="3807268">b</span><span class="op" id="3807269">.</span><span class="ident" id="3807270">abs</span><span class="op" id="3807273">.</span><span class="builtinfunc" id="3807274">make</span><span class="op" id="3807278">(</span><span class="num" id="3807279">0</span><span class="op" id="3807280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3807283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807287">return</span>&nbsp;<span class="ident" id="3807294"><a href="/math/big/rat.go.html#3806199">z</a></span><span class="op" id="3807295">,</span>&nbsp;<span class="builtintype" id="3807297">true</span><br>
<span class="lineno"></span><span class="op" id="3807302">}</span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span><span class="comment" id="3807305">//&nbsp;String&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;x&nbsp;in&nbsp;the&nbsp;form&nbsp;&#34;a/b&#34;&nbsp;(even&nbsp;if&nbsp;b&nbsp;==&nbsp;1).</span><br>
<span class="lineno"></span><span class="keyword" id="3807388">func</span>&nbsp;<span class="op" id="3807393">(</span><span class="ident" id="3807394">x</span>&nbsp;<span class="op" id="3807396">*</span><span class="ident" id="3807397"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3807400">)</span>&nbsp;<span class="ident" id="3807402">String</span><span class="op" id="3807408">(</span><span class="op" id="3807409">)</span>&nbsp;<span class="builtintype" id="3807411">string</span>&nbsp;<span class="op" id="3807418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807421">s</span>&nbsp;<span class="op" id="3807423">:=</span>&nbsp;<span class="string" id="3807426">&#34;/1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807432">if</span>&nbsp;<span class="builtinfunc" id="3807435">len</span><span class="op" id="3807438">(</span><span class="ident" id="3807439"><a href="/math/big/rat.go.html#3807394">x</a></span><span class="op" id="3807440">.</span><span class="ident" id="3807441">b</span><span class="op" id="3807442">.</span><span class="ident" id="3807443">abs</span><span class="op" id="3807446">)</span>&nbsp;<span class="op" id="3807448">!=</span>&nbsp;<span class="num" id="3807451">0</span>&nbsp;<span class="op" id="3807453">{</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807457"><a href="/math/big/rat.go.html#3807421">s</a></span>&nbsp;<span class="op" id="3807459">=</span>&nbsp;<span class="string" id="3807461">&#34;/&#34;</span>&nbsp;<span class="op" id="3807465">+</span>&nbsp;<span class="ident" id="3807467"><a href="/math/big/rat.go.html#3807394">x</a></span><span class="op" id="3807468">.</span><span class="ident" id="3807469">b</span><span class="op" id="3807470">.</span><span class="ident" id="3807471">abs</span><span class="op" id="3807474">.</span><span class="ident" id="3807475">decimalString</span><span class="op" id="3807488">(</span><span class="op" id="3807489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3807492">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807495">return</span>&nbsp;<span class="ident" id="3807502"><a href="/math/big/rat.go.html#3807394">x</a></span><span class="op" id="3807503">.</span><span class="ident" id="3807504">a</span><span class="op" id="3807505">.</span><span class="ident" id="3807506">String</span><span class="op" id="3807512">(</span><span class="op" id="3807513">)</span>&nbsp;<span class="op" id="3807515">+</span>&nbsp;<span class="ident" id="3807517"><a href="/math/big/rat.go.html#3807421">s</a></span><br>
<span class="lineno"></span><span class="op" id="3807519">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">605</span><span class="comment" id="3807522">//&nbsp;RatString&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;x&nbsp;in&nbsp;the&nbsp;form&nbsp;&#34;a/b&#34;&nbsp;if&nbsp;b&nbsp;!=&nbsp;1,</span><br>
<span class="lineno"></span><span class="comment" id="3807601">//&nbsp;and&nbsp;in&nbsp;the&nbsp;form&nbsp;&#34;a&#34;&nbsp;if&nbsp;b&nbsp;==&nbsp;1.</span><br>
<span class="lineno"></span><span class="keyword" id="3807635">func</span>&nbsp;<span class="op" id="3807640">(</span><span class="ident" id="3807641">x</span>&nbsp;<span class="op" id="3807643">*</span><span class="ident" id="3807644"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3807647">)</span>&nbsp;<span class="ident" id="3807649">RatString</span><span class="op" id="3807658">(</span><span class="op" id="3807659">)</span>&nbsp;<span class="builtintype" id="3807661">string</span>&nbsp;<span class="op" id="3807668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807671">if</span>&nbsp;<span class="ident" id="3807674"><a href="/math/big/rat.go.html#3807641">x</a></span><span class="op" id="3807675">.</span><span class="ident" id="3807676">IsInt</span><span class="op" id="3807681">(</span><span class="op" id="3807682">)</span>&nbsp;<span class="op" id="3807684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807688">return</span>&nbsp;<span class="ident" id="3807695"><a href="/math/big/rat.go.html#3807641">x</a></span><span class="op" id="3807696">.</span><span class="ident" id="3807697">a</span><span class="op" id="3807698">.</span><span class="ident" id="3807699">String</span><span class="op" id="3807705">(</span><span class="op" id="3807706">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3807709">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807712">return</span>&nbsp;<span class="ident" id="3807719"><a href="/math/big/rat.go.html#3807641">x</a></span><span class="op" id="3807720">.</span><span class="ident" id="3807721">String</span><span class="op" id="3807727">(</span><span class="op" id="3807728">)</span><br>
<span class="lineno"></span><span class="op" id="3807730">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3807733">//&nbsp;FloatString&nbsp;returns&nbsp;a&nbsp;string&nbsp;representation&nbsp;of&nbsp;x&nbsp;in&nbsp;decimal&nbsp;form&nbsp;with&nbsp;prec</span><br>
<span class="lineno">615</span><span class="comment" id="3807811">//&nbsp;digits&nbsp;of&nbsp;precision&nbsp;after&nbsp;the&nbsp;decimal&nbsp;point&nbsp;and&nbsp;the&nbsp;last&nbsp;digit&nbsp;rounded.</span><br>
<span class="lineno"></span><span class="keyword" id="3807886">func</span>&nbsp;<span class="op" id="3807891">(</span><span class="ident" id="3807892">x</span>&nbsp;<span class="op" id="3807894">*</span><span class="ident" id="3807895"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3807898">)</span>&nbsp;<span class="ident" id="3807900">FloatString</span><span class="op" id="3807911">(</span><span class="ident" id="3807912">prec</span>&nbsp;<span class="builtintype" id="3807917">int</span><span class="op" id="3807920">)</span>&nbsp;<span class="builtintype" id="3807922">string</span>&nbsp;<span class="op" id="3807929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807932">if</span>&nbsp;<span class="ident" id="3807935"><a href="/math/big/rat.go.html#3807892">x</a></span><span class="op" id="3807936">.</span><span class="ident" id="3807937">IsInt</span><span class="op" id="3807942">(</span><span class="op" id="3807943">)</span>&nbsp;<span class="op" id="3807945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807949">s</span>&nbsp;<span class="op" id="3807951">:=</span>&nbsp;<span class="ident" id="3807954"><a href="/math/big/rat.go.html#3807892">x</a></span><span class="op" id="3807955">.</span><span class="ident" id="3807956">a</span><span class="op" id="3807957">.</span><span class="ident" id="3807958">String</span><span class="op" id="3807964">(</span><span class="op" id="3807965">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3807969">if</span>&nbsp;<span class="ident" id="3807972"><a href="/math/big/rat.go.html#3807912">prec</a></span>&nbsp;<span class="op" id="3807977">&gt;</span>&nbsp;<span class="num" id="3807979">0</span>&nbsp;<span class="op" id="3807981">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3807986"><a href="/math/big/rat.go.html#3807949">s</a></span>&nbsp;<span class="op" id="3807988">+=</span>&nbsp;<span class="string" id="3807991">&#34;.&#34;</span>&nbsp;<span class="op" id="3807995">+</span>&nbsp;<span class="ident" id="3807997"><a href="/math/big/rat.go.html#3792856">strings</a></span><span class="op" id="3808004">.</span><span class="ident" id="3808005">Repeat</span><span class="op" id="3808011">(</span><span class="string" id="3808012">&#34;0&#34;</span><span class="op" id="3808015">,</span>&nbsp;<span class="ident" id="3808017"><a href="/math/big/rat.go.html#3807912">prec</a></span><span class="op" id="3808021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808029">return</span>&nbsp;<span class="ident" id="3808036"><a href="/math/big/rat.go.html#3807949">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808039">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3808042">//&nbsp;x.b.abs&nbsp;!=&nbsp;0</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808060">q</span><span class="op" id="3808061">,</span>&nbsp;<span class="ident" id="3808063">r</span>&nbsp;<span class="op" id="3808065">:=</span>&nbsp;<span class="ident" id="3808068"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3808071">(</span><span class="ident" id="3808072">nil</span><span class="op" id="3808075">)</span><span class="op" id="3808076">.</span><span class="ident" id="3808077">div</span><span class="op" id="3808080">(</span><span class="ident" id="3808081"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3808084">(</span><span class="ident" id="3808085">nil</span><span class="op" id="3808088">)</span><span class="op" id="3808089">,</span>&nbsp;<span class="ident" id="3808091"><a href="/math/big/rat.go.html#3807892">x</a></span><span class="op" id="3808092">.</span><span class="ident" id="3808093">a</span><span class="op" id="3808094">.</span><span class="ident" id="3808095">abs</span><span class="op" id="3808098">,</span>&nbsp;<span class="ident" id="3808100"><a href="/math/big/rat.go.html#3807892">x</a></span><span class="op" id="3808101">.</span><span class="ident" id="3808102">b</span><span class="op" id="3808103">.</span><span class="ident" id="3808104">abs</span><span class="op" id="3808107">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808111">p</span>&nbsp;<span class="op" id="3808113">:=</span>&nbsp;<span class="ident" id="3808116"><a href="/math/big/nat.go.html#3758911">natOne</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808124">if</span>&nbsp;<span class="ident" id="3808127"><a href="/math/big/rat.go.html#3807912">prec</a></span>&nbsp;<span class="op" id="3808132">&gt;</span>&nbsp;<span class="num" id="3808134">0</span>&nbsp;<span class="op" id="3808136">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808140"><a href="/math/big/rat.go.html#3808111">p</a></span>&nbsp;<span class="op" id="3808142">=</span>&nbsp;<span class="ident" id="3808144"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3808147">(</span><span class="ident" id="3808148">nil</span><span class="op" id="3808151">)</span><span class="op" id="3808152">.</span><span class="ident" id="3808153">expNN</span><span class="op" id="3808158">(</span><span class="ident" id="3808159"><a href="/math/big/nat.go.html#3758945">natTen</a></span><span class="op" id="3808165">,</span>&nbsp;<span class="ident" id="3808167"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3808170">(</span><span class="ident" id="3808171">nil</span><span class="op" id="3808174">)</span><span class="op" id="3808175">.</span><span class="ident" id="3808176">setUint64</span><span class="op" id="3808185">(</span><span class="ident" id="3808186">uint64</span><span class="op" id="3808192">(</span><span class="ident" id="3808193"><a href="/math/big/rat.go.html#3807912">prec</a></span><span class="op" id="3808197">)</span><span class="op" id="3808198">)</span><span class="op" id="3808199">,</span>&nbsp;<span class="ident" id="3808201">nil</span><span class="op" id="3808204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808211"><a href="/math/big/rat.go.html#3808063">r</a></span>&nbsp;<span class="op" id="3808213">=</span>&nbsp;<span class="ident" id="3808215"><a href="/math/big/rat.go.html#3808063">r</a></span><span class="op" id="3808216">.</span><span class="ident" id="3808217">mul</span><span class="op" id="3808220">(</span><span class="ident" id="3808221"><a href="/math/big/rat.go.html#3808063">r</a></span><span class="op" id="3808222">,</span>&nbsp;<span class="ident" id="3808224"><a href="/math/big/rat.go.html#3808111">p</a></span><span class="op" id="3808225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808228"><a href="/math/big/rat.go.html#3808063">r</a></span><span class="op" id="3808229">,</span>&nbsp;<span class="ident" id="3808231">r2</span>&nbsp;<span class="op" id="3808234">:=</span>&nbsp;<span class="ident" id="3808237"><a href="/math/big/rat.go.html#3808063">r</a></span><span class="op" id="3808238">.</span><span class="ident" id="3808239">div</span><span class="op" id="3808242">(</span><span class="ident" id="3808243"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3808246">(</span><span class="ident" id="3808247">nil</span><span class="op" id="3808250">)</span><span class="op" id="3808251">,</span>&nbsp;<span class="ident" id="3808253"><a href="/math/big/rat.go.html#3808063">r</a></span><span class="op" id="3808254">,</span>&nbsp;<span class="ident" id="3808256"><a href="/math/big/rat.go.html#3807892">x</a></span><span class="op" id="3808257">.</span><span class="ident" id="3808258">b</span><span class="op" id="3808259">.</span><span class="ident" id="3808260">abs</span><span class="op" id="3808263">)</span><br>
<span class="lineno">635</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3808267">//&nbsp;see&nbsp;if&nbsp;we&nbsp;need&nbsp;to&nbsp;round&nbsp;up</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808298"><a href="/math/big/rat.go.html#3808231">r2</a></span>&nbsp;<span class="op" id="3808301">=</span>&nbsp;<span class="ident" id="3808303"><a href="/math/big/rat.go.html#3808231">r2</a></span><span class="op" id="3808305">.</span><span class="ident" id="3808306">add</span><span class="op" id="3808309">(</span><span class="ident" id="3808310"><a href="/math/big/rat.go.html#3808231">r2</a></span><span class="op" id="3808312">,</span>&nbsp;<span class="ident" id="3808314"><a href="/math/big/rat.go.html#3808231">r2</a></span><span class="op" id="3808316">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808319">if</span>&nbsp;<span class="ident" id="3808322"><a href="/math/big/rat.go.html#3807892">x</a></span><span class="op" id="3808323">.</span><span class="ident" id="3808324">b</span><span class="op" id="3808325">.</span><span class="ident" id="3808326">abs</span><span class="op" id="3808329">.</span><span class="ident" id="3808330">cmp</span><span class="op" id="3808333">(</span><span class="ident" id="3808334"><a href="/math/big/rat.go.html#3808231">r2</a></span><span class="op" id="3808336">)</span>&nbsp;<span class="op" id="3808338">&lt;=</span>&nbsp;<span class="num" id="3808341">0</span>&nbsp;<span class="op" id="3808343">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808347"><a href="/math/big/rat.go.html#3808063">r</a></span>&nbsp;<span class="op" id="3808349">=</span>&nbsp;<span class="ident" id="3808351"><a href="/math/big/rat.go.html#3808063">r</a></span><span class="op" id="3808352">.</span><span class="ident" id="3808353">add</span><span class="op" id="3808356">(</span><span class="ident" id="3808357"><a href="/math/big/rat.go.html#3808063">r</a></span><span class="op" id="3808358">,</span>&nbsp;<span class="ident" id="3808360"><a href="/math/big/nat.go.html#3758911">natOne</a></span><span class="op" id="3808366">)</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808370">if</span>&nbsp;<span class="ident" id="3808373"><a href="/math/big/rat.go.html#3808063">r</a></span><span class="op" id="3808374">.</span><span class="ident" id="3808375">cmp</span><span class="op" id="3808378">(</span><span class="ident" id="3808379"><a href="/math/big/rat.go.html#3808111">p</a></span><span class="op" id="3808380">)</span>&nbsp;<span class="op" id="3808382">&gt;=</span>&nbsp;<span class="num" id="3808385">0</span>&nbsp;<span class="op" id="3808387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808392"><a href="/math/big/rat.go.html#3808060">q</a></span>&nbsp;<span class="op" id="3808394">=</span>&nbsp;<span class="ident" id="3808396"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3808399">(</span><span class="ident" id="3808400">nil</span><span class="op" id="3808403">)</span><span class="op" id="3808404">.</span><span class="ident" id="3808405">add</span><span class="op" id="3808408">(</span><span class="ident" id="3808409"><a href="/math/big/rat.go.html#3808060">q</a></span><span class="op" id="3808410">,</span>&nbsp;<span class="ident" id="3808412"><a href="/math/big/nat.go.html#3758911">natOne</a></span><span class="op" id="3808418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808423"><a href="/math/big/rat.go.html#3808063">r</a></span>&nbsp;<span class="op" id="3808425">=</span>&nbsp;<span class="ident" id="3808427"><a href="/math/big/nat.go.html#3758892">nat</a></span><span class="op" id="3808430">(</span><span class="ident" id="3808431">nil</span><span class="op" id="3808434">)</span><span class="op" id="3808435">.</span><span class="ident" id="3808436">sub</span><span class="op" id="3808439">(</span><span class="ident" id="3808440"><a href="/math/big/rat.go.html#3808063">r</a></span><span class="op" id="3808441">,</span>&nbsp;<span class="ident" id="3808443"><a href="/math/big/rat.go.html#3808111">p</a></span><span class="op" id="3808444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808451">}</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808455">s</span>&nbsp;<span class="op" id="3808457">:=</span>&nbsp;<span class="ident" id="3808460"><a href="/math/big/rat.go.html#3808060">q</a></span><span class="op" id="3808461">.</span><span class="ident" id="3808462">decimalString</span><span class="op" id="3808475">(</span><span class="op" id="3808476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808479">if</span>&nbsp;<span class="ident" id="3808482"><a href="/math/big/rat.go.html#3807892">x</a></span><span class="op" id="3808483">.</span><span class="ident" id="3808484">a</span><span class="op" id="3808485">.</span><span class="ident" id="3808486">neg</span>&nbsp;<span class="op" id="3808490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808494"><a href="/math/big/rat.go.html#3808455">s</a></span>&nbsp;<span class="op" id="3808496">=</span>&nbsp;<span class="string" id="3808498">&#34;-&#34;</span>&nbsp;<span class="op" id="3808502">+</span>&nbsp;<span class="ident" id="3808504"><a href="/math/big/rat.go.html#3808455">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808507">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808511">if</span>&nbsp;<span class="ident" id="3808514"><a href="/math/big/rat.go.html#3807912">prec</a></span>&nbsp;<span class="op" id="3808519">&gt;</span>&nbsp;<span class="num" id="3808521">0</span>&nbsp;<span class="op" id="3808523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808527">rs</span>&nbsp;<span class="op" id="3808530">:=</span>&nbsp;<span class="ident" id="3808533"><a href="/math/big/rat.go.html#3808063">r</a></span><span class="op" id="3808534">.</span><span class="ident" id="3808535">decimalString</span><span class="op" id="3808548">(</span><span class="op" id="3808549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808553">leadingZeros</span>&nbsp;<span class="op" id="3808566">:=</span>&nbsp;<span class="ident" id="3808569"><a href="/math/big/rat.go.html#3807912">prec</a></span>&nbsp;<span class="op" id="3808574">-</span>&nbsp;<span class="builtinfunc" id="3808576">len</span><span class="op" id="3808579">(</span><span class="ident" id="3808580"><a href="/math/big/rat.go.html#3808527">rs</a></span><span class="op" id="3808582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808586"><a href="/math/big/rat.go.html#3808455">s</a></span>&nbsp;<span class="op" id="3808588">+=</span>&nbsp;<span class="string" id="3808591">&#34;.&#34;</span>&nbsp;<span class="op" id="3808595">+</span>&nbsp;<span class="ident" id="3808597"><a href="/math/big/rat.go.html#3792856">strings</a></span><span class="op" id="3808604">.</span><span class="ident" id="3808605">Repeat</span><span class="op" id="3808611">(</span><span class="string" id="3808612">&#34;0&#34;</span><span class="op" id="3808615">,</span>&nbsp;<span class="ident" id="3808617"><a href="/math/big/rat.go.html#3808553">leadingZeros</a></span><span class="op" id="3808629">)</span>&nbsp;<span class="op" id="3808631">+</span>&nbsp;<span class="ident" id="3808633"><a href="/math/big/rat.go.html#3808527">rs</a></span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808637">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808641">return</span>&nbsp;<span class="ident" id="3808648"><a href="/math/big/rat.go.html#3808455">s</a></span><br>
<span class="lineno"></span><span class="op" id="3808650">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">660</span><span class="comment" id="3808653">//&nbsp;Gob&nbsp;codec&nbsp;version.&nbsp;Permits&nbsp;backward-compatible&nbsp;changes&nbsp;to&nbsp;the&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="keyword" id="3808728">const</span>&nbsp;<span class="ident" id="3808734">ratGobVersion</span>&nbsp;<span class="builtintype" id="3808748">byte</span>&nbsp;<span class="op" id="3808753">=</span>&nbsp;<span class="num" id="3808755">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3808758">//&nbsp;GobEncode&nbsp;implements&nbsp;the&nbsp;gob.GobEncoder&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3808812">func</span>&nbsp;<span class="op" id="3808817">(</span><span class="ident" id="3808818">x</span>&nbsp;<span class="op" id="3808820">*</span><span class="ident" id="3808821"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3808824">)</span>&nbsp;<span class="ident" id="3808826">GobEncode</span><span class="op" id="3808835">(</span><span class="op" id="3808836">)</span>&nbsp;<span class="op" id="3808838">(</span><span class="op" id="3808839">[</span><span class="op" id="3808840">]</span><span class="builtintype" id="3808841">byte</span><span class="op" id="3808845">,</span>&nbsp;<span class="builtintype" id="3808847">error</span><span class="op" id="3808852">)</span>&nbsp;<span class="op" id="3808854">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808857">if</span>&nbsp;<span class="ident" id="3808860"><a href="/math/big/rat.go.html#3808818">x</a></span>&nbsp;<span class="op" id="3808862">==</span>&nbsp;<span class="ident" id="3808865">nil</span>&nbsp;<span class="op" id="3808869">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3808873">return</span>&nbsp;<span class="ident" id="3808880">nil</span><span class="op" id="3808883">,</span>&nbsp;<span class="ident" id="3808885">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3808890">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3808893">buf</span>&nbsp;<span class="op" id="3808897">:=</span>&nbsp;<span class="builtinfunc" id="3808900">make</span><span class="op" id="3808904">(</span><span class="op" id="3808905">[</span><span class="op" id="3808906">]</span><span class="builtintype" id="3808907">byte</span><span class="op" id="3808911">,</span>&nbsp;<span class="num" id="3808913">1</span><span class="op" id="3808914">+</span><span class="num" id="3808915">4</span><span class="op" id="3808916">+</span><span class="op" id="3808917">(</span><span class="builtinfunc" id="3808918">len</span><span class="op" id="3808921">(</span><span class="ident" id="3808922"><a href="/math/big/rat.go.html#3808818">x</a></span><span class="op" id="3808923">.</span><span class="ident" id="3808924">a</span><span class="op" id="3808925">.</span><span class="ident" id="3808926">abs</span><span class="op" id="3808929">)</span><span class="op" id="3808930">+</span><span class="builtinfunc" id="3808931">len</span><span class="op" id="3808934">(</span><span class="ident" id="3808935"><a href="/math/big/rat.go.html#3808818">x</a></span><span class="op" id="3808936">.</span><span class="ident" id="3808937">b</span><span class="op" id="3808938">.</span><span class="ident" id="3808939">abs</span><span class="op" id="3808942">)</span><span class="op" id="3808943">)</span><span class="op" id="3808944">*</span><span class="ident" id="3808945"><a href="/math/big/arith.go.html#3727872">_S</a></span><span class="op" id="3808947">)</span>&nbsp;<span class="comment" id="3808949">//&nbsp;extra&nbsp;bytes&nbsp;for&nbsp;version&nbsp;and&nbsp;sign&nbsp;bit&nbsp;(1),&nbsp;and&nbsp;numerator&nbsp;length&nbsp;(4)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809020">i</span>&nbsp;<span class="op" id="3809022">:=</span>&nbsp;<span class="ident" id="3809025"><a href="/math/big/rat.go.html#3808818">x</a></span><span class="op" id="3809026">.</span><span class="ident" id="3809027">b</span><span class="op" id="3809028">.</span><span class="ident" id="3809029">abs</span><span class="op" id="3809032">.</span><span class="ident" id="3809033">bytes</span><span class="op" id="3809038">(</span><span class="ident" id="3809039"><a href="/math/big/rat.go.html#3808893">buf</a></span><span class="op" id="3809042">)</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809045">j</span>&nbsp;<span class="op" id="3809047">:=</span>&nbsp;<span class="ident" id="3809050"><a href="/math/big/rat.go.html#3808818">x</a></span><span class="op" id="3809051">.</span><span class="ident" id="3809052">a</span><span class="op" id="3809053">.</span><span class="ident" id="3809054">abs</span><span class="op" id="3809057">.</span><span class="ident" id="3809058">bytes</span><span class="op" id="3809063">(</span><span class="ident" id="3809064"><a href="/math/big/rat.go.html#3808893">buf</a></span><span class="op" id="3809067">[</span><span class="num" id="3809068">0</span><span class="op" id="3809069">:</span><span class="ident" id="3809070"><a href="/math/big/rat.go.html#3809020">i</a></span><span class="op" id="3809071">]</span><span class="op" id="3809072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809075">n</span>&nbsp;<span class="op" id="3809077">:=</span>&nbsp;<span class="ident" id="3809080"><a href="/math/big/rat.go.html#3809020">i</a></span>&nbsp;<span class="op" id="3809082">-</span>&nbsp;<span class="ident" id="3809084"><a href="/math/big/rat.go.html#3809045">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3809087">if</span>&nbsp;<span class="builtintype" id="3809090">int</span><span class="op" id="3809093">(</span><span class="builtintype" id="3809094">uint32</span><span class="op" id="3809100">(</span><span class="ident" id="3809101"><a href="/math/big/rat.go.html#3809075">n</a></span><span class="op" id="3809102">)</span><span class="op" id="3809103">)</span>&nbsp;<span class="op" id="3809105">!=</span>&nbsp;<span class="ident" id="3809108"><a href="/math/big/rat.go.html#3809075">n</a></span>&nbsp;<span class="op" id="3809110">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3809114">//&nbsp;this&nbsp;should&nbsp;never&nbsp;happen</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3809144">return</span>&nbsp;<span class="ident" id="3809151">nil</span><span class="op" id="3809154">,</span>&nbsp;<span class="ident" id="3809156"><a href="/math/big/rat.go.html#3792831">errors</a></span><span class="op" id="3809162">.</span><span class="ident" id="3809163">New</span><span class="op" id="3809166">(</span><span class="string" id="3809167">&#34;Rat.GobEncode:&nbsp;numerator&nbsp;too&nbsp;large&#34;</span><span class="op" id="3809203">)</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3809206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809209"><a href="/math/big/rat.go.html#3792812">binary</a></span><span class="op" id="3809215">.</span><span class="ident" id="3809216">BigEndian</span><span class="op" id="3809225">.</span><span class="ident" id="3809226">PutUint32</span><span class="op" id="3809235">(</span><span class="ident" id="3809236"><a href="/math/big/rat.go.html#3808893">buf</a></span><span class="op" id="3809239">[</span><span class="ident" id="3809240"><a href="/math/big/rat.go.html#3809045">j</a></span><span class="op" id="3809241">-</span><span class="num" id="3809242">4</span><span class="op" id="3809243">:</span><span class="ident" id="3809244"><a href="/math/big/rat.go.html#3809045">j</a></span><span class="op" id="3809245">]</span><span class="op" id="3809246">,</span>&nbsp;<span class="builtintype" id="3809248">uint32</span><span class="op" id="3809254">(</span><span class="ident" id="3809255"><a href="/math/big/rat.go.html#3809075">n</a></span><span class="op" id="3809256">)</span><span class="op" id="3809257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809260"><a href="/math/big/rat.go.html#3809045">j</a></span>&nbsp;<span class="op" id="3809262">-=</span>&nbsp;<span class="num" id="3809265">1</span>&nbsp;<span class="op" id="3809267">+</span>&nbsp;<span class="num" id="3809269">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809272">b</span>&nbsp;<span class="op" id="3809274">:=</span>&nbsp;<span class="ident" id="3809277"><a href="/math/big/rat.go.html#3808734">ratGobVersion</a></span>&nbsp;<span class="op" id="3809291">&lt;&lt;</span>&nbsp;<span class="num" id="3809294">1</span>&nbsp;<span class="comment" id="3809296">//&nbsp;make&nbsp;space&nbsp;for&nbsp;sign&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3809324">if</span>&nbsp;<span class="ident" id="3809327"><a href="/math/big/rat.go.html#3808818">x</a></span><span class="op" id="3809328">.</span><span class="ident" id="3809329">a</span><span class="op" id="3809330">.</span><span class="ident" id="3809331">neg</span>&nbsp;<span class="op" id="3809335">{</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809339"><a href="/math/big/rat.go.html#3809272">b</a></span>&nbsp;<span class="op" id="3809341">|=</span>&nbsp;<span class="num" id="3809344">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3809347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809350"><a href="/math/big/rat.go.html#3808893">buf</a></span><span class="op" id="3809353">[</span><span class="ident" id="3809354"><a href="/math/big/rat.go.html#3809045">j</a></span><span class="op" id="3809355">]</span>&nbsp;<span class="op" id="3809357">=</span>&nbsp;<span class="ident" id="3809359"><a href="/math/big/rat.go.html#3809272">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3809362">return</span>&nbsp;<span class="ident" id="3809369"><a href="/math/big/rat.go.html#3808893">buf</a></span><span class="op" id="3809372">[</span><span class="ident" id="3809373"><a href="/math/big/rat.go.html#3809045">j</a></span><span class="op" id="3809374">:</span><span class="op" id="3809375">]</span><span class="op" id="3809376">,</span>&nbsp;<span class="ident" id="3809378">nil</span><br>
<span class="lineno"></span><span class="op" id="3809382">}</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span><span class="comment" id="3809385">//&nbsp;GobDecode&nbsp;implements&nbsp;the&nbsp;gob.GobDecoder&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3809439">func</span>&nbsp;<span class="op" id="3809444">(</span><span class="ident" id="3809445">z</span>&nbsp;<span class="op" id="3809447">*</span><span class="ident" id="3809448"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3809451">)</span>&nbsp;<span class="ident" id="3809453">GobDecode</span><span class="op" id="3809462">(</span><span class="ident" id="3809463">buf</span>&nbsp;<span class="op" id="3809467">[</span><span class="op" id="3809468">]</span><span class="builtintype" id="3809469">byte</span><span class="op" id="3809473">)</span>&nbsp;<span class="builtintype" id="3809475">error</span>&nbsp;<span class="op" id="3809481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3809484">if</span>&nbsp;<span class="builtinfunc" id="3809487">len</span><span class="op" id="3809490">(</span><span class="ident" id="3809491"><a href="/math/big/rat.go.html#3809463">buf</a></span><span class="op" id="3809494">)</span>&nbsp;<span class="op" id="3809496">==</span>&nbsp;<span class="num" id="3809499">0</span>&nbsp;<span class="op" id="3809501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3809505">//&nbsp;Other&nbsp;side&nbsp;sent&nbsp;a&nbsp;nil&nbsp;or&nbsp;default&nbsp;value.</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3809550">*</span><span class="ident" id="3809551"><a href="/math/big/rat.go.html#3809445">z</a></span>&nbsp;<span class="op" id="3809553">=</span>&nbsp;<span class="ident" id="3809555"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3809558">{</span><span class="op" id="3809559">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3809563">return</span>&nbsp;<span class="ident" id="3809570">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3809575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809578">b</span>&nbsp;<span class="op" id="3809580">:=</span>&nbsp;<span class="ident" id="3809583"><a href="/math/big/rat.go.html#3809463">buf</a></span><span class="op" id="3809586">[</span><span class="num" id="3809587">0</span><span class="op" id="3809588">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3809591">if</span>&nbsp;<span class="ident" id="3809594"><a href="/math/big/rat.go.html#3809578">b</a></span><span class="op" id="3809595">&gt;&gt;</span><span class="num" id="3809597">1</span>&nbsp;<span class="op" id="3809599">!=</span>&nbsp;<span class="ident" id="3809602"><a href="/math/big/rat.go.html#3808734">ratGobVersion</a></span>&nbsp;<span class="op" id="3809616">{</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3809620">return</span>&nbsp;<span class="ident" id="3809627"><a href="/math/big/rat.go.html#3792831">errors</a></span><span class="op" id="3809633">.</span><span class="ident" id="3809634">New</span><span class="op" id="3809637">(</span><span class="ident" id="3809638"><a href="/math/big/rat.go.html#3792841">fmt</a></span><span class="op" id="3809641">.</span><span class="ident" id="3809642">Sprintf</span><span class="op" id="3809649">(</span><span class="string" id="3809650">&#34;Rat.GobDecode:&nbsp;encoding&nbsp;version&nbsp;%d&nbsp;not&nbsp;supported&#34;</span><span class="op" id="3809700">,</span>&nbsp;<span class="ident" id="3809702"><a href="/math/big/rat.go.html#3809578">b</a></span><span class="op" id="3809703">&gt;&gt;</span><span class="num" id="3809705">1</span><span class="op" id="3809706">)</span><span class="op" id="3809707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3809710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3809713">const</span>&nbsp;<span class="ident" id="3809719">j</span>&nbsp;<span class="op" id="3809721">=</span>&nbsp;<span class="num" id="3809723">1</span>&nbsp;<span class="op" id="3809725">+</span>&nbsp;<span class="num" id="3809727">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809730">i</span>&nbsp;<span class="op" id="3809732">:=</span>&nbsp;<span class="ident" id="3809735"><a href="/math/big/rat.go.html#3809719">j</a></span>&nbsp;<span class="op" id="3809737">+</span>&nbsp;<span class="ident" id="3809739"><a href="/math/big/rat.go.html#3792812">binary</a></span><span class="op" id="3809745">.</span><span class="ident" id="3809746">BigEndian</span><span class="op" id="3809755">.</span><span class="ident" id="3809756">Uint32</span><span class="op" id="3809762">(</span><span class="ident" id="3809763"><a href="/math/big/rat.go.html#3809463">buf</a></span><span class="op" id="3809766">[</span><span class="ident" id="3809767"><a href="/math/big/rat.go.html#3809719">j</a></span><span class="op" id="3809768">-</span><span class="num" id="3809769">4</span><span class="op" id="3809770">:</span><span class="ident" id="3809771"><a href="/math/big/rat.go.html#3809719">j</a></span><span class="op" id="3809772">]</span><span class="op" id="3809773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809776"><a href="/math/big/rat.go.html#3809445">z</a></span><span class="op" id="3809777">.</span><span class="ident" id="3809778">a</span><span class="op" id="3809779">.</span><span class="ident" id="3809780">neg</span>&nbsp;<span class="op" id="3809784">=</span>&nbsp;<span class="ident" id="3809786"><a href="/math/big/rat.go.html#3809578">b</a></span><span class="op" id="3809787">&amp;</span><span class="num" id="3809788">1</span>&nbsp;<span class="op" id="3809790">!=</span>&nbsp;<span class="num" id="3809793">0</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809796"><a href="/math/big/rat.go.html#3809445">z</a></span><span class="op" id="3809797">.</span><span class="ident" id="3809798">a</span><span class="op" id="3809799">.</span><span class="ident" id="3809800">abs</span>&nbsp;<span class="op" id="3809804">=</span>&nbsp;<span class="ident" id="3809806"><a href="/math/big/rat.go.html#3809445">z</a></span><span class="op" id="3809807">.</span><span class="ident" id="3809808">a</span><span class="op" id="3809809">.</span><span class="ident" id="3809810">abs</span><span class="op" id="3809813">.</span><span class="ident" id="3809814">setBytes</span><span class="op" id="3809822">(</span><span class="ident" id="3809823"><a href="/math/big/rat.go.html#3809463">buf</a></span><span class="op" id="3809826">[</span><span class="ident" id="3809827"><a href="/math/big/rat.go.html#3809719">j</a></span><span class="op" id="3809828">:</span><span class="ident" id="3809829"><a href="/math/big/rat.go.html#3809730">i</a></span><span class="op" id="3809830">]</span><span class="op" id="3809831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3809834"><a href="/math/big/rat.go.html#3809445">z</a></span><span class="op" id="3809835">.</span><span class="ident" id="3809836">b</span><span class="op" id="3809837">.</span><span class="ident" id="3809838">abs</span>&nbsp;<span class="op" id="3809842">=</span>&nbsp;<span class="ident" id="3809844"><a href="/math/big/rat.go.html#3809445">z</a></span><span class="op" id="3809845">.</span><span class="ident" id="3809846">b</span><span class="op" id="3809847">.</span><span class="ident" id="3809848">abs</span><span class="op" id="3809851">.</span><span class="ident" id="3809852">setBytes</span><span class="op" id="3809860">(</span><span class="ident" id="3809861"><a href="/math/big/rat.go.html#3809463">buf</a></span><span class="op" id="3809864">[</span><span class="ident" id="3809865"><a href="/math/big/rat.go.html#3809730">i</a></span><span class="op" id="3809866">:</span><span class="op" id="3809867">]</span><span class="op" id="3809868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3809871">return</span>&nbsp;<span class="ident" id="3809878">nil</span><br>
<span class="lineno"></span><span class="op" id="3809882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">705</span><span class="comment" id="3809885">//&nbsp;MarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextMarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3809949">func</span>&nbsp;<span class="op" id="3809954">(</span><span class="ident" id="3809955">r</span>&nbsp;<span class="op" id="3809957">*</span><span class="ident" id="3809958"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3809961">)</span>&nbsp;<span class="ident" id="3809963">MarshalText</span><span class="op" id="3809974">(</span><span class="op" id="3809975">)</span>&nbsp;<span class="op" id="3809977">(</span><span class="ident" id="3809978">text</span>&nbsp;<span class="op" id="3809983">[</span><span class="op" id="3809984">]</span><span class="builtintype" id="3809985">byte</span><span class="op" id="3809989">,</span>&nbsp;<span class="ident" id="3809991">err</span>&nbsp;<span class="builtintype" id="3809995">error</span><span class="op" id="3810000">)</span>&nbsp;<span class="op" id="3810002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810005">return</span>&nbsp;<span class="op" id="3810012">[</span><span class="op" id="3810013">]</span><span class="builtintype" id="3810014">byte</span><span class="op" id="3810018">(</span><span class="ident" id="3810019"><a href="/math/big/rat.go.html#3809955">r</a></span><span class="op" id="3810020">.</span><span class="ident" id="3810021">RatString</span><span class="op" id="3810030">(</span><span class="op" id="3810031">)</span><span class="op" id="3810032">)</span><span class="op" id="3810033">,</span>&nbsp;<span class="ident" id="3810035">nil</span><br>
<span class="lineno"></span><span class="op" id="3810039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="comment" id="3810042">//&nbsp;UnmarshalText&nbsp;implements&nbsp;the&nbsp;encoding.TextUnmarshaler&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3810110">func</span>&nbsp;<span class="op" id="3810115">(</span><span class="ident" id="3810116">r</span>&nbsp;<span class="op" id="3810118">*</span><span class="ident" id="3810119"><a href="/math/big/rat.go.html#3792985">Rat</a></span><span class="op" id="3810122">)</span>&nbsp;<span class="ident" id="3810124">UnmarshalText</span><span class="op" id="3810137">(</span><span class="ident" id="3810138">text</span>&nbsp;<span class="op" id="3810143">[</span><span class="op" id="3810144">]</span><span class="builtintype" id="3810145">byte</span><span class="op" id="3810149">)</span>&nbsp;<span class="builtintype" id="3810151">error</span>&nbsp;<span class="op" id="3810157">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810160">if</span>&nbsp;<span class="ident" id="3810163">_</span><span class="op" id="3810164">,</span>&nbsp;<span class="ident" id="3810166">ok</span>&nbsp;<span class="op" id="3810169">:=</span>&nbsp;<span class="ident" id="3810172"><a href="/math/big/rat.go.html#3810116">r</a></span><span class="op" id="3810173">.</span><span class="ident" id="3810174">SetString</span><span class="op" id="3810183">(</span><span class="builtintype" id="3810184">string</span><span class="op" id="3810190">(</span><span class="ident" id="3810191"><a href="/math/big/rat.go.html#3810138">text</a></span><span class="op" id="3810195">)</span><span class="op" id="3810196">)</span><span class="op" id="3810197">;</span>&nbsp;<span class="op" id="3810199">!</span><span class="ident" id="3810200"><a href="/math/big/rat.go.html#3810166">ok</a></span>&nbsp;<span class="op" id="3810203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810207">return</span>&nbsp;<span class="ident" id="3810214"><a href="/math/big/rat.go.html#3792841">fmt</a></span><span class="op" id="3810217">.</span><span class="ident" id="3810218">Errorf</span><span class="op" id="3810224">(</span><span class="string" id="3810225">&#34;math/big:&nbsp;cannot&nbsp;unmarshal&nbsp;%q&nbsp;into&nbsp;a&nbsp;*big.Rat&#34;</span><span class="op" id="3810272">,</span>&nbsp;<span class="ident" id="3810274"><a href="/math/big/rat.go.html#3810138">text</a></span><span class="op" id="3810278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3810281">}</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3810284">return</span>&nbsp;<span class="ident" id="3810291">nil</span><br>
<span class="lineno"></span><span class="op" id="3810295">}</span>
</div>
</body>
</html>
