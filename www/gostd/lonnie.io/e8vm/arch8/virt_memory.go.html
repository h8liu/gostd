<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/arch8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/arch8/console.go.html">console.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/cpu.go.html">cpu.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/cpu_test.go.html">cpu_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/device.go.html">device.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/exception.go.html">exception.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_all.go.html">inst_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_br.go.html">inst_br.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_br_test.go.html">inst_br_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_imm.go.html">inst_imm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_imm_test.go.html">inst_imm_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_jmp.go.html">inst_jmp.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_reg.go.html">inst_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_reg_test.go.html">inst_reg_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/inst_sys.go.html">inst_sys.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/int_bus.go.html">int_bus.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/interrupt.go.html">interrupt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/interrupt_test.go.html">interrupt_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/machine.go.html">machine.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/multi_core.go.html">multi_core.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page.go.html">page.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_table.go.html">page_table.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_table_test.go.html">page_table_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/page_test.go.html">page_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/phy_memory.go.html">phy_memory.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/phy_memory_test.go.html">phy_memory_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/regs.go.html">regs.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/regs_test.go.html">regs_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/run_image.go.html">run_image.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/serial.go.html">serial.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/ticker.go.html">ticker.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/virt_memory.go.html">virt_memory.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/arch8/virt_memory_test.go.html">virt_memory_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="4809185">package</span>&nbsp;<span class="ident" id="4809193">arch8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4809200">//&nbsp;VirtMemory&nbsp;defines&nbsp;an&nbsp;address&nbsp;space&nbsp;which&nbsp;page&nbsp;mapping</span><br>
<span class="lineno"></span><span class="comment" id="4809258">//&nbsp;is&nbsp;defined&nbsp;by&nbsp;a&nbsp;page&nbsp;table.</span><br>
<span class="lineno">5</span><span class="comment" id="4809289">//&nbsp;If&nbsp;no&nbsp;page&nbsp;table&nbsp;is&nbsp;defined,&nbsp;direct&nbsp;mapping&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span><span class="keyword" id="4809344">type</span>&nbsp;<span class="ident" id="4809349">virtMemory</span>&nbsp;<span class="keyword" id="4809360">struct</span>&nbsp;<span class="op" id="4809367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4809370">phyMem</span>&nbsp;<span class="op" id="4809377">*</span><span class="ident" id="4809378">phyMemory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4809389">ptable</span>&nbsp;<span class="op" id="4809396">*</span><span class="ident" id="4809397">pageTable</span><br>
<span class="lineno"></span><span class="op" id="4809407">}</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="4809410">//&nbsp;NewVirtMemory&nbsp;creates&nbsp;a&nbsp;new&nbsp;virtual&nbsp;address&nbsp;space&nbsp;with&nbsp;no&nbsp;page&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="4809483">func</span>&nbsp;<span class="ident" id="4809488">newVirtMemory</span><span class="op" id="4809501">(</span><span class="ident" id="4809502">phy</span>&nbsp;<span class="op" id="4809506">*</span><span class="ident" id="4809507">phyMemory</span><span class="op" id="4809516">)</span>&nbsp;<span class="op" id="4809518">*</span><span class="ident" id="4809519">virtMemory</span>&nbsp;<span class="op" id="4809530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4809533">ret</span>&nbsp;<span class="op" id="4809537">:=</span>&nbsp;<span class="builtinfunc" id="4809540">new</span><span class="op" id="4809543">(</span><span class="ident" id="4809544">virtMemory</span><span class="op" id="4809554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4809557">ret</span><span class="op" id="4809560">.</span><span class="ident" id="4809561">phyMem</span>&nbsp;<span class="op" id="4809568">=</span>&nbsp;<span class="ident" id="4809570">phy</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4809575">return</span>&nbsp;<span class="ident" id="4809582">ret</span><br>
<span class="lineno"></span><span class="op" id="4809586">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4809589">//&nbsp;SetTable&nbsp;applies&nbsp;a&nbsp;particular&nbsp;pagetable&nbsp;at&nbsp;a&nbsp;physical&nbsp;memory&nbsp;position.</span><br>
<span class="lineno"></span><span class="comment" id="4809663">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;not&nbsp;page&nbsp;size&nbsp;aligned,&nbsp;it&nbsp;will&nbsp;be&nbsp;aligned&nbsp;down.</span><br>
<span class="lineno">20</span><span class="comment" id="4809732">//&nbsp;If&nbsp;the&nbsp;address&nbsp;is&nbsp;0,&nbsp;it&nbsp;will&nbsp;use&nbsp;direct&nbsp;mapping.</span><br>
<span class="lineno"></span><span class="keyword" id="4809784">func</span>&nbsp;<span class="op" id="4809789">(</span><span class="ident" id="4809790">vm</span>&nbsp;<span class="op" id="4809793">*</span><span class="ident" id="4809794">virtMemory</span><span class="op" id="4809804">)</span>&nbsp;<span class="ident" id="4809806">SetTable</span><span class="op" id="4809814">(</span><span class="ident" id="4809815">root</span>&nbsp;<span class="builtintype" id="4809820">uint32</span><span class="op" id="4809826">)</span>&nbsp;<span class="op" id="4809828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4809831">if</span>&nbsp;<span class="ident" id="4809834">root</span>&nbsp;<span class="op" id="4809839">==</span>&nbsp;<span class="num" id="4809842">0</span>&nbsp;<span class="op" id="4809844">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4809848">vm</span><span class="op" id="4809850">.</span><span class="ident" id="4809851">ptable</span>&nbsp;<span class="op" id="4809858">=</span>&nbsp;<span class="ident" id="4809860">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4809865">}</span>&nbsp;<span class="keyword" id="4809867">else</span>&nbsp;<span class="op" id="4809872">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4809876">vm</span><span class="op" id="4809878">.</span><span class="ident" id="4809879">ptable</span>&nbsp;<span class="op" id="4809886">=</span>&nbsp;<span class="ident" id="4809888">newPageTable</span><span class="op" id="4809900">(</span><span class="ident" id="4809901">vm</span><span class="op" id="4809903">.</span><span class="ident" id="4809904">phyMem</span><span class="op" id="4809910">,</span>&nbsp;<span class="ident" id="4809912">root</span><span class="op" id="4809916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4809919">}</span><br>
<span class="lineno"></span><span class="op" id="4809921">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4809924">func</span>&nbsp;<span class="op" id="4809929">(</span><span class="ident" id="4809930">vm</span>&nbsp;<span class="op" id="4809933">*</span><span class="ident" id="4809934">virtMemory</span><span class="op" id="4809944">)</span>&nbsp;<span class="ident" id="4809946">transRead</span><span class="op" id="4809955">(</span><span class="ident" id="4809956">addr</span>&nbsp;<span class="builtintype" id="4809961">uint32</span><span class="op" id="4809967">,</span>&nbsp;<span class="ident" id="4809969">ring</span>&nbsp;<span class="builtintype" id="4809974">byte</span><span class="op" id="4809978">)</span>&nbsp;<span class="op" id="4809980">(</span><span class="builtintype" id="4809981">uint32</span><span class="op" id="4809987">,</span>&nbsp;<span class="op" id="4809989">*</span><span class="ident" id="4809990">Excep</span><span class="op" id="4809995">)</span>&nbsp;<span class="op" id="4809997">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810000">if</span>&nbsp;<span class="ident" id="4810003">vm</span><span class="op" id="4810005">.</span><span class="ident" id="4810006">ptable</span>&nbsp;<span class="op" id="4810013">==</span>&nbsp;<span class="ident" id="4810016">nil</span>&nbsp;<span class="op" id="4810020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810024">return</span>&nbsp;<span class="ident" id="4810031">addr</span><span class="op" id="4810035">,</span>&nbsp;<span class="ident" id="4810037">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4810042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810045">return</span>&nbsp;<span class="ident" id="4810052">vm</span><span class="op" id="4810054">.</span><span class="ident" id="4810055">ptable</span><span class="op" id="4810061">.</span><span class="ident" id="4810062">TranslateRead</span><span class="op" id="4810075">(</span><span class="ident" id="4810076">addr</span><span class="op" id="4810080">,</span>&nbsp;<span class="ident" id="4810082">ring</span><span class="op" id="4810086">)</span><br>
<span class="lineno"></span><span class="op" id="4810088">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="4810091">func</span>&nbsp;<span class="op" id="4810096">(</span><span class="ident" id="4810097">vm</span>&nbsp;<span class="op" id="4810100">*</span><span class="ident" id="4810101">virtMemory</span><span class="op" id="4810111">)</span>&nbsp;<span class="ident" id="4810113">transWrite</span><span class="op" id="4810123">(</span><span class="ident" id="4810124">addr</span>&nbsp;<span class="builtintype" id="4810129">uint32</span><span class="op" id="4810135">,</span>&nbsp;<span class="ident" id="4810137">ring</span>&nbsp;<span class="builtintype" id="4810142">byte</span><span class="op" id="4810146">)</span>&nbsp;<span class="op" id="4810148">(</span><span class="builtintype" id="4810149">uint32</span><span class="op" id="4810155">,</span>&nbsp;<span class="op" id="4810157">*</span><span class="ident" id="4810158">Excep</span><span class="op" id="4810163">)</span>&nbsp;<span class="op" id="4810165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810168">if</span>&nbsp;<span class="ident" id="4810171">vm</span><span class="op" id="4810173">.</span><span class="ident" id="4810174">ptable</span>&nbsp;<span class="op" id="4810181">==</span>&nbsp;<span class="ident" id="4810184">nil</span>&nbsp;<span class="op" id="4810188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810192">return</span>&nbsp;<span class="ident" id="4810199">addr</span><span class="op" id="4810203">,</span>&nbsp;<span class="ident" id="4810205">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4810210">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810213">return</span>&nbsp;<span class="ident" id="4810220">vm</span><span class="op" id="4810222">.</span><span class="ident" id="4810223">ptable</span><span class="op" id="4810229">.</span><span class="ident" id="4810230">TranslateWrite</span><span class="op" id="4810244">(</span><span class="ident" id="4810245">addr</span><span class="op" id="4810249">,</span>&nbsp;<span class="ident" id="4810251">ring</span><span class="op" id="4810255">)</span><br>
<span class="lineno"></span><span class="op" id="4810257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4810260">//&nbsp;ReadWord&nbsp;reads&nbsp;the&nbsp;byte&nbsp;at&nbsp;the&nbsp;given&nbsp;virtual&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4810317">func</span>&nbsp;<span class="op" id="4810322">(</span><span class="ident" id="4810323">vm</span>&nbsp;<span class="op" id="4810326">*</span><span class="ident" id="4810327">virtMemory</span><span class="op" id="4810337">)</span>&nbsp;<span class="ident" id="4810339">ReadWord</span><span class="op" id="4810347">(</span><span class="ident" id="4810348">addr</span>&nbsp;<span class="builtintype" id="4810353">uint32</span><span class="op" id="4810359">,</span>&nbsp;<span class="ident" id="4810361">ring</span>&nbsp;<span class="builtintype" id="4810366">byte</span><span class="op" id="4810370">)</span>&nbsp;<span class="op" id="4810372">(</span><span class="builtintype" id="4810373">uint32</span><span class="op" id="4810379">,</span>&nbsp;<span class="op" id="4810381">*</span><span class="ident" id="4810382">Excep</span><span class="op" id="4810387">)</span>&nbsp;<span class="op" id="4810389">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4810392">addr</span><span class="op" id="4810396">,</span>&nbsp;<span class="ident" id="4810398">e</span>&nbsp;<span class="op" id="4810400">:=</span>&nbsp;<span class="ident" id="4810403">vm</span><span class="op" id="4810405">.</span><span class="ident" id="4810406">transRead</span><span class="op" id="4810415">(</span><span class="ident" id="4810416">addr</span><span class="op" id="4810420">,</span>&nbsp;<span class="ident" id="4810422">ring</span><span class="op" id="4810426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810429">if</span>&nbsp;<span class="ident" id="4810432">e</span>&nbsp;<span class="op" id="4810434">!=</span>&nbsp;<span class="ident" id="4810437">nil</span>&nbsp;<span class="op" id="4810441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810445">return</span>&nbsp;<span class="num" id="4810452">0</span><span class="op" id="4810453">,</span>&nbsp;<span class="ident" id="4810455">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4810458">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810461">return</span>&nbsp;<span class="ident" id="4810468">vm</span><span class="op" id="4810470">.</span><span class="ident" id="4810471">phyMem</span><span class="op" id="4810477">.</span><span class="ident" id="4810478">ReadWord</span><span class="op" id="4810486">(</span><span class="ident" id="4810487">addr</span><span class="op" id="4810491">)</span><br>
<span class="lineno">50</span><span class="op" id="4810493">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4810496">//&nbsp;WriteWord&nbsp;writes&nbsp;the&nbsp;byte&nbsp;at&nbsp;the&nbsp;given&nbsp;virtual&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4810555">func</span>&nbsp;<span class="op" id="4810560">(</span><span class="ident" id="4810561">vm</span>&nbsp;<span class="op" id="4810564">*</span><span class="ident" id="4810565">virtMemory</span><span class="op" id="4810575">)</span>&nbsp;<span class="ident" id="4810577">WriteWord</span><span class="op" id="4810586">(</span><span class="ident" id="4810587">addr</span>&nbsp;<span class="builtintype" id="4810592">uint32</span><span class="op" id="4810598">,</span>&nbsp;<span class="ident" id="4810600">ring</span>&nbsp;<span class="builtintype" id="4810605">byte</span><span class="op" id="4810609">,</span>&nbsp;<span class="ident" id="4810611">v</span>&nbsp;<span class="builtintype" id="4810613">uint32</span><span class="op" id="4810619">)</span>&nbsp;<span class="op" id="4810621">*</span><span class="ident" id="4810622">Excep</span>&nbsp;<span class="op" id="4810628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4810631">addr</span><span class="op" id="4810635">,</span>&nbsp;<span class="ident" id="4810637">e</span>&nbsp;<span class="op" id="4810639">:=</span>&nbsp;<span class="ident" id="4810642">vm</span><span class="op" id="4810644">.</span><span class="ident" id="4810645">transWrite</span><span class="op" id="4810655">(</span><span class="ident" id="4810656">addr</span><span class="op" id="4810660">,</span>&nbsp;<span class="ident" id="4810662">ring</span><span class="op" id="4810666">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810669">if</span>&nbsp;<span class="ident" id="4810672">e</span>&nbsp;<span class="op" id="4810674">!=</span>&nbsp;<span class="ident" id="4810677">nil</span>&nbsp;<span class="op" id="4810681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810685">return</span>&nbsp;<span class="ident" id="4810692">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4810695">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810698">return</span>&nbsp;<span class="ident" id="4810705">vm</span><span class="op" id="4810707">.</span><span class="ident" id="4810708">phyMem</span><span class="op" id="4810714">.</span><span class="ident" id="4810715">WriteWord</span><span class="op" id="4810724">(</span><span class="ident" id="4810725">addr</span><span class="op" id="4810729">,</span>&nbsp;<span class="ident" id="4810731">v</span><span class="op" id="4810732">)</span><br>
<span class="lineno"></span><span class="op" id="4810734">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="4810737">//&nbsp;ReadByte&nbsp;reads&nbsp;the&nbsp;byte&nbsp;at&nbsp;the&nbsp;given&nbsp;virtual&nbsp;address.</span><br>
<span class="lineno"></span><span class="keyword" id="4810794">func</span>&nbsp;<span class="op" id="4810799">(</span><span class="ident" id="4810800">vm</span>&nbsp;<span class="op" id="4810803">*</span><span class="ident" id="4810804">virtMemory</span><span class="op" id="4810814">)</span>&nbsp;<span class="ident" id="4810816">ReadByte</span><span class="op" id="4810824">(</span><span class="ident" id="4810825">addr</span>&nbsp;<span class="builtintype" id="4810830">uint32</span><span class="op" id="4810836">,</span>&nbsp;<span class="ident" id="4810838">ring</span>&nbsp;<span class="builtintype" id="4810843">byte</span><span class="op" id="4810847">)</span>&nbsp;<span class="op" id="4810849">(</span><span class="builtintype" id="4810850">byte</span><span class="op" id="4810854">,</span>&nbsp;<span class="op" id="4810856">*</span><span class="ident" id="4810857">Excep</span><span class="op" id="4810862">)</span>&nbsp;<span class="op" id="4810864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4810867">addr</span><span class="op" id="4810871">,</span>&nbsp;<span class="ident" id="4810873">e</span>&nbsp;<span class="op" id="4810875">:=</span>&nbsp;<span class="ident" id="4810878">vm</span><span class="op" id="4810880">.</span><span class="ident" id="4810881">transRead</span><span class="op" id="4810890">(</span><span class="ident" id="4810891">addr</span><span class="op" id="4810895">,</span>&nbsp;<span class="ident" id="4810897">ring</span><span class="op" id="4810901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810904">if</span>&nbsp;<span class="ident" id="4810907">e</span>&nbsp;<span class="op" id="4810909">!=</span>&nbsp;<span class="ident" id="4810912">nil</span>&nbsp;<span class="op" id="4810916">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810920">return</span>&nbsp;<span class="num" id="4810927">0</span><span class="op" id="4810928">,</span>&nbsp;<span class="ident" id="4810930">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4810933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4810936">return</span>&nbsp;<span class="ident" id="4810943">vm</span><span class="op" id="4810945">.</span><span class="ident" id="4810946">phyMem</span><span class="op" id="4810952">.</span><span class="ident" id="4810953">ReadByte</span><span class="op" id="4810961">(</span><span class="ident" id="4810962">addr</span><span class="op" id="4810966">)</span><br>
<span class="lineno"></span><span class="op" id="4810968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="4810971">//&nbsp;WriteByte&nbsp;writes&nbsp;a&nbsp;byte&nbsp;at&nbsp;the&nbsp;given&nbsp;virtual&nbsp;address&nbsp;under</span><br>
<span class="lineno"></span><span class="comment" id="4811033">//&nbsp;a&nbsp;certain&nbsp;ring.</span><br>
<span class="lineno"></span><span class="keyword" id="4811052">func</span>&nbsp;<span class="op" id="4811057">(</span><span class="ident" id="4811058">vm</span>&nbsp;<span class="op" id="4811061">*</span><span class="ident" id="4811062">virtMemory</span><span class="op" id="4811072">)</span>&nbsp;<span class="ident" id="4811074">WriteByte</span><span class="op" id="4811083">(</span><span class="ident" id="4811084">addr</span>&nbsp;<span class="builtintype" id="4811089">uint32</span><span class="op" id="4811095">,</span>&nbsp;<span class="ident" id="4811097">ring</span>&nbsp;<span class="builtintype" id="4811102">byte</span><span class="op" id="4811106">,</span>&nbsp;<span class="ident" id="4811108">v</span>&nbsp;<span class="builtintype" id="4811110">byte</span><span class="op" id="4811114">)</span>&nbsp;<span class="op" id="4811116">*</span><span class="ident" id="4811117">Excep</span>&nbsp;<span class="op" id="4811123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4811126">addr</span><span class="op" id="4811130">,</span>&nbsp;<span class="ident" id="4811132">e</span>&nbsp;<span class="op" id="4811134">:=</span>&nbsp;<span class="ident" id="4811137">vm</span><span class="op" id="4811139">.</span><span class="ident" id="4811140">transWrite</span><span class="op" id="4811150">(</span><span class="ident" id="4811151">addr</span><span class="op" id="4811155">,</span>&nbsp;<span class="ident" id="4811157">ring</span><span class="op" id="4811161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4811164">if</span>&nbsp;<span class="ident" id="4811167">e</span>&nbsp;<span class="op" id="4811169">!=</span>&nbsp;<span class="ident" id="4811172">nil</span>&nbsp;<span class="op" id="4811176">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4811180">return</span>&nbsp;<span class="ident" id="4811187">e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4811190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4811193">return</span>&nbsp;<span class="ident" id="4811200">vm</span><span class="op" id="4811202">.</span><span class="ident" id="4811203">phyMem</span><span class="op" id="4811209">.</span><span class="ident" id="4811210">WriteByte</span><span class="op" id="4811219">(</span><span class="ident" id="4811220">addr</span><span class="op" id="4811224">,</span>&nbsp;<span class="ident" id="4811226">v</span><span class="op" id="4811227">)</span><br>
<span class="lineno"></span><span class="op" id="4811229">}</span>
</div>
</body>
</html>
