<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>path/filepath</h2>
<ul>
<li><a href="/gostd/path/filepath/example_unix_test.go.html">example_unix_test.go</a></li>
<li><a href="/gostd/path/filepath/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/path/filepath/match.go.html">match.go</a></li>
<li><a href="/gostd/path/filepath/match_test.go.html">match_test.go</a></li>
<li><a href="/gostd/path/filepath/path.go.html" class="current">path.go</a></li>
<li><a href="/gostd/path/filepath/path_test.go.html">path_test.go</a></li>
<li><a href="/gostd/path/filepath/path_unix.go.html">path_unix.go</a></li>
<li><a href="/gostd/path/filepath/symlink.go.html">symlink.go</a></li>
<li><a href="/gostd/path/filepath/symlink_unix.go.html">symlink_unix.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2952871">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2952926">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2952980">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2953031">//&nbsp;Package&nbsp;filepath&nbsp;implements&nbsp;utility&nbsp;routines&nbsp;for&nbsp;manipulating&nbsp;filename&nbsp;paths</span><br>
<span class="lineno"></span><span class="comment" id="2953111">//&nbsp;in&nbsp;a&nbsp;way&nbsp;compatible&nbsp;with&nbsp;the&nbsp;target&nbsp;operating&nbsp;system-defined&nbsp;file&nbsp;paths.</span><br>
<span class="lineno"></span><span class="keyword" id="2953187">package</span>&nbsp;<span class="ident" id="2953195">filepath</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2953205">import</span>&nbsp;<span class="op" id="2953212">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2953215">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2953225">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2953231">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="2953239">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="2953249">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2953252">//&nbsp;A&nbsp;lazybuf&nbsp;is&nbsp;a&nbsp;lazily&nbsp;constructed&nbsp;path&nbsp;buffer.</span><br>
<span class="lineno"></span><span class="comment" id="2953302">//&nbsp;It&nbsp;supports&nbsp;append,&nbsp;reading&nbsp;previously&nbsp;appended&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="2953360">//&nbsp;and&nbsp;retrieving&nbsp;the&nbsp;final&nbsp;string.&nbsp;It&nbsp;does&nbsp;not&nbsp;allocate&nbsp;a&nbsp;buffer</span><br>
<span class="lineno"></span><span class="comment" id="2953426">//&nbsp;to&nbsp;hold&nbsp;the&nbsp;output&nbsp;until&nbsp;that&nbsp;output&nbsp;diverges&nbsp;from&nbsp;s.</span><br>
<span class="lineno">20</span><span class="keyword" id="2953483">type</span>&nbsp;<span class="ident" id="2953488">lazybuf</span>&nbsp;<span class="keyword" id="2953496">struct</span>&nbsp;<span class="op" id="2953503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2953506">path</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2953517">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2953525">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2953536">[</span><span class="op" id="2953537">]</span><span class="builtintype" id="2953538">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2953544">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2953555">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2953560">volAndPath</span>&nbsp;<span class="builtintype" id="2953571">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2953579">volLen</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="2953590">int</span><br>
<span class="lineno"></span><span class="op" id="2953594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2953597">func</span>&nbsp;<span class="op" id="2953602">(</span><span class="ident" id="2953603">b</span>&nbsp;<span class="op" id="2953605">*</span><span class="ident" id="2953606">lazybuf</span><span class="op" id="2953613">)</span>&nbsp;<span class="ident" id="2953615">index</span><span class="op" id="2953620">(</span><span class="ident" id="2953621">i</span>&nbsp;<span class="builtintype" id="2953623">int</span><span class="op" id="2953626">)</span>&nbsp;<span class="builtintype" id="2953628">byte</span>&nbsp;<span class="op" id="2953633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2953636">if</span>&nbsp;<span class="ident" id="2953639">b</span><span class="op" id="2953640">.</span><span class="ident" id="2953641">buf</span>&nbsp;<span class="op" id="2953645">!=</span>&nbsp;<span class="ident" id="2953648">nil</span>&nbsp;<span class="op" id="2953652">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2953656">return</span>&nbsp;<span class="ident" id="2953663">b</span><span class="op" id="2953664">.</span><span class="ident" id="2953665">buf</span><span class="op" id="2953668">[</span><span class="ident" id="2953669">i</span><span class="op" id="2953670">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2953673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2953676">return</span>&nbsp;<span class="ident" id="2953683">b</span><span class="op" id="2953684">.</span><span class="ident" id="2953685">path</span><span class="op" id="2953689">[</span><span class="ident" id="2953690">i</span><span class="op" id="2953691">]</span><br>
<span class="lineno"></span><span class="op" id="2953693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="2953696">func</span>&nbsp;<span class="op" id="2953701">(</span><span class="ident" id="2953702">b</span>&nbsp;<span class="op" id="2953704">*</span><span class="ident" id="2953705">lazybuf</span><span class="op" id="2953712">)</span>&nbsp;<span class="builtinfunc" id="2953714">append</span><span class="op" id="2953720">(</span><span class="ident" id="2953721">c</span>&nbsp;<span class="builtintype" id="2953723">byte</span><span class="op" id="2953727">)</span>&nbsp;<span class="op" id="2953729">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2953732">if</span>&nbsp;<span class="ident" id="2953735">b</span><span class="op" id="2953736">.</span><span class="ident" id="2953737">buf</span>&nbsp;<span class="op" id="2953741">==</span>&nbsp;<span class="ident" id="2953744">nil</span>&nbsp;<span class="op" id="2953748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2953752">if</span>&nbsp;<span class="ident" id="2953755">b</span><span class="op" id="2953756">.</span><span class="ident" id="2953757">w</span>&nbsp;<span class="op" id="2953759">&lt;</span>&nbsp;<span class="builtinfunc" id="2953761">len</span><span class="op" id="2953764">(</span><span class="ident" id="2953765">b</span><span class="op" id="2953766">.</span><span class="ident" id="2953767">path</span><span class="op" id="2953771">)</span>&nbsp;<span class="op" id="2953773">&amp;&amp;</span>&nbsp;<span class="ident" id="2953776">b</span><span class="op" id="2953777">.</span><span class="ident" id="2953778">path</span><span class="op" id="2953782">[</span><span class="ident" id="2953783">b</span><span class="op" id="2953784">.</span><span class="ident" id="2953785">w</span><span class="op" id="2953786">]</span>&nbsp;<span class="op" id="2953788">==</span>&nbsp;<span class="ident" id="2953791">c</span>&nbsp;<span class="op" id="2953793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2953798">b</span><span class="op" id="2953799">.</span><span class="ident" id="2953800">w</span><span class="op" id="2953801">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2953807">return</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2953816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2953820">b</span><span class="op" id="2953821">.</span><span class="ident" id="2953822">buf</span>&nbsp;<span class="op" id="2953826">=</span>&nbsp;<span class="builtinfunc" id="2953828">make</span><span class="op" id="2953832">(</span><span class="op" id="2953833">[</span><span class="op" id="2953834">]</span><span class="builtintype" id="2953835">byte</span><span class="op" id="2953839">,</span>&nbsp;<span class="builtinfunc" id="2953841">len</span><span class="op" id="2953844">(</span><span class="ident" id="2953845">b</span><span class="op" id="2953846">.</span><span class="ident" id="2953847">path</span><span class="op" id="2953851">)</span><span class="op" id="2953852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2953856">copy</span><span class="op" id="2953860">(</span><span class="ident" id="2953861">b</span><span class="op" id="2953862">.</span><span class="ident" id="2953863">buf</span><span class="op" id="2953866">,</span>&nbsp;<span class="ident" id="2953868">b</span><span class="op" id="2953869">.</span><span class="ident" id="2953870">path</span><span class="op" id="2953874">[</span><span class="op" id="2953875">:</span><span class="ident" id="2953876">b</span><span class="op" id="2953877">.</span><span class="ident" id="2953878">w</span><span class="op" id="2953879">]</span><span class="op" id="2953880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2953883">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2953886">b</span><span class="op" id="2953887">.</span><span class="ident" id="2953888">buf</span><span class="op" id="2953891">[</span><span class="ident" id="2953892">b</span><span class="op" id="2953893">.</span><span class="ident" id="2953894">w</span><span class="op" id="2953895">]</span>&nbsp;<span class="op" id="2953897">=</span>&nbsp;<span class="ident" id="2953899">c</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2953902">b</span><span class="op" id="2953903">.</span><span class="ident" id="2953904">w</span><span class="op" id="2953905">++</span><br>
<span class="lineno"></span><span class="op" id="2953908">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2953911">func</span>&nbsp;<span class="op" id="2953916">(</span><span class="ident" id="2953917">b</span>&nbsp;<span class="op" id="2953919">*</span><span class="ident" id="2953920">lazybuf</span><span class="op" id="2953927">)</span>&nbsp;<span class="builtintype" id="2953929">string</span><span class="op" id="2953935">(</span><span class="op" id="2953936">)</span>&nbsp;<span class="builtintype" id="2953938">string</span>&nbsp;<span class="op" id="2953945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2953948">if</span>&nbsp;<span class="ident" id="2953951">b</span><span class="op" id="2953952">.</span><span class="ident" id="2953953">buf</span>&nbsp;<span class="op" id="2953957">==</span>&nbsp;<span class="ident" id="2953960">nil</span>&nbsp;<span class="op" id="2953964">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2953968">return</span>&nbsp;<span class="ident" id="2953975">b</span><span class="op" id="2953976">.</span><span class="ident" id="2953977">volAndPath</span><span class="op" id="2953987">[</span><span class="op" id="2953988">:</span><span class="ident" id="2953989">b</span><span class="op" id="2953990">.</span><span class="ident" id="2953991">volLen</span><span class="op" id="2953997">+</span><span class="ident" id="2953998">b</span><span class="op" id="2953999">.</span><span class="ident" id="2954000">w</span><span class="op" id="2954001">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2954004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2954007">return</span>&nbsp;<span class="ident" id="2954014">b</span><span class="op" id="2954015">.</span><span class="ident" id="2954016">volAndPath</span><span class="op" id="2954026">[</span><span class="op" id="2954027">:</span><span class="ident" id="2954028">b</span><span class="op" id="2954029">.</span><span class="ident" id="2954030">volLen</span><span class="op" id="2954036">]</span>&nbsp;<span class="op" id="2954038">+</span>&nbsp;<span class="builtintype" id="2954040">string</span><span class="op" id="2954046">(</span><span class="ident" id="2954047">b</span><span class="op" id="2954048">.</span><span class="ident" id="2954049">buf</span><span class="op" id="2954052">[</span><span class="op" id="2954053">:</span><span class="ident" id="2954054">b</span><span class="op" id="2954055">.</span><span class="ident" id="2954056">w</span><span class="op" id="2954057">]</span><span class="op" id="2954058">)</span><br>
<span class="lineno"></span><span class="op" id="2954060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="keyword" id="2954063">const</span>&nbsp;<span class="op" id="2954069">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2954072">Separator</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2954086">=</span>&nbsp;<span class="ident" id="2954088">os</span><span class="op" id="2954090">.</span><span class="ident" id="2954091">PathSeparator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2954106">ListSeparator</span>&nbsp;<span class="op" id="2954120">=</span>&nbsp;<span class="ident" id="2954122">os</span><span class="op" id="2954124">.</span><span class="ident" id="2954125">PathListSeparator</span><br>
<span class="lineno"></span><span class="op" id="2954143">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="2954146">//&nbsp;Clean&nbsp;returns&nbsp;the&nbsp;shortest&nbsp;path&nbsp;name&nbsp;equivalent&nbsp;to&nbsp;path</span><br>
<span class="lineno"></span><span class="comment" id="2954205">//&nbsp;by&nbsp;purely&nbsp;lexical&nbsp;processing.&nbsp;&nbsp;It&nbsp;applies&nbsp;the&nbsp;following&nbsp;rules</span><br>
<span class="lineno"></span><span class="comment" id="2954270">//&nbsp;iteratively&nbsp;until&nbsp;no&nbsp;further&nbsp;processing&nbsp;can&nbsp;be&nbsp;done:</span><br>
<span class="lineno"></span><span class="comment" id="2954326">//</span><br>
<span class="lineno"></span><span class="comment" id="2954329">//&nbsp;&nbsp;&nbsp;&nbsp;1.&nbsp;Replace&nbsp;multiple&nbsp;Separator&nbsp;elements&nbsp;with&nbsp;a&nbsp;single&nbsp;one.</span><br>
<span class="lineno">65</span><span class="comment" id="2954390">//&nbsp;&nbsp;&nbsp;&nbsp;2.&nbsp;Eliminate&nbsp;each&nbsp;.&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;current&nbsp;directory).</span><br>
<span class="lineno"></span><span class="comment" id="2954456">//&nbsp;&nbsp;&nbsp;&nbsp;3.&nbsp;Eliminate&nbsp;each&nbsp;inner&nbsp;..&nbsp;path&nbsp;name&nbsp;element&nbsp;(the&nbsp;parent&nbsp;directory)</span><br>
<span class="lineno"></span><span class="comment" id="2954527">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;along&nbsp;with&nbsp;the&nbsp;non-..&nbsp;element&nbsp;that&nbsp;precedes&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="2954581">//&nbsp;&nbsp;&nbsp;&nbsp;4.&nbsp;Eliminate&nbsp;..&nbsp;elements&nbsp;that&nbsp;begin&nbsp;a&nbsp;rooted&nbsp;path:</span><br>
<span class="lineno"></span><span class="comment" id="2954635">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;is,&nbsp;replace&nbsp;&#34;/..&#34;&nbsp;by&nbsp;&#34;/&#34;&nbsp;at&nbsp;the&nbsp;beginning&nbsp;of&nbsp;a&nbsp;path,</span><br>
<span class="lineno">70</span><span class="comment" id="2954699">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;assuming&nbsp;Separator&nbsp;is&nbsp;&#39;/&#39;.</span><br>
<span class="lineno"></span><span class="comment" id="2954732">//</span><br>
<span class="lineno"></span><span class="comment" id="2954735">//&nbsp;The&nbsp;returned&nbsp;path&nbsp;ends&nbsp;in&nbsp;a&nbsp;slash&nbsp;only&nbsp;if&nbsp;it&nbsp;represents&nbsp;a&nbsp;root&nbsp;directory,</span><br>
<span class="lineno"></span><span class="comment" id="2954812">//&nbsp;such&nbsp;as&nbsp;&#34;/&#34;&nbsp;on&nbsp;Unix&nbsp;or&nbsp;`C:\`&nbsp;on&nbsp;Windows.</span><br>
<span class="lineno"></span><span class="comment" id="2954856">//</span><br>
<span class="lineno">75</span><span class="comment" id="2954859">//&nbsp;If&nbsp;the&nbsp;result&nbsp;of&nbsp;this&nbsp;process&nbsp;is&nbsp;an&nbsp;empty&nbsp;string,&nbsp;Clean</span><br>
<span class="lineno"></span><span class="comment" id="2954918">//&nbsp;returns&nbsp;the&nbsp;string&nbsp;&#34;.&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2954945">//</span><br>
<span class="lineno"></span><span class="comment" id="2954948">//&nbsp;See&nbsp;also&nbsp;Rob&nbsp;Pike,&nbsp;``Lexical&nbsp;File&nbsp;Names&nbsp;in&nbsp;Plan&nbsp;9&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2955004">//&nbsp;Getting&nbsp;Dot-Dot&nbsp;Right,&#39;&#39;</span><br>
<span class="lineno">80</span><span class="comment" id="2955032">//&nbsp;http://plan9.bell-labs.com/sys/doc/lexnames.html</span><br>
<span class="lineno"></span><span class="keyword" id="2955084">func</span>&nbsp;<span class="ident" id="2955089">Clean</span><span class="op" id="2955094">(</span><span class="ident" id="2955095">path</span>&nbsp;<span class="builtintype" id="2955100">string</span><span class="op" id="2955106">)</span>&nbsp;<span class="builtintype" id="2955108">string</span>&nbsp;<span class="op" id="2955115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2955118">originalPath</span>&nbsp;<span class="op" id="2955131">:=</span>&nbsp;<span class="ident" id="2955134">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2955140">volLen</span>&nbsp;<span class="op" id="2955147">:=</span>&nbsp;<span class="ident" id="2955150">volumeNameLen</span><span class="op" id="2955163">(</span><span class="ident" id="2955164">path</span><span class="op" id="2955168">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2955171">path</span>&nbsp;<span class="op" id="2955176">=</span>&nbsp;<span class="ident" id="2955178">path</span><span class="op" id="2955182">[</span><span class="ident" id="2955183">volLen</span><span class="op" id="2955189">:</span><span class="op" id="2955190">]</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2955193">if</span>&nbsp;<span class="ident" id="2955196">path</span>&nbsp;<span class="op" id="2955201">==</span>&nbsp;<span class="string" id="2955204">&#34;&#34;</span>&nbsp;<span class="op" id="2955207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2955211">if</span>&nbsp;<span class="ident" id="2955214">volLen</span>&nbsp;<span class="op" id="2955221">&gt;</span>&nbsp;<span class="num" id="2955223">1</span>&nbsp;<span class="op" id="2955225">&amp;&amp;</span>&nbsp;<span class="ident" id="2955228">originalPath</span><span class="op" id="2955240">[</span><span class="num" id="2955241">1</span><span class="op" id="2955242">]</span>&nbsp;<span class="op" id="2955244">!=</span>&nbsp;<span class="string" id="2955247">&#39;:&#39;</span>&nbsp;<span class="op" id="2955251">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2955256">//&nbsp;should&nbsp;be&nbsp;UNC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2955276">return</span>&nbsp;<span class="ident" id="2955283">FromSlash</span><span class="op" id="2955292">(</span><span class="ident" id="2955293">originalPath</span><span class="op" id="2955305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2955309">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2955313">return</span>&nbsp;<span class="ident" id="2955320">originalPath</span>&nbsp;<span class="op" id="2955333">+</span>&nbsp;<span class="string" id="2955335">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2955340">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2955343">rooted</span>&nbsp;<span class="op" id="2955350">:=</span>&nbsp;<span class="ident" id="2955353">os</span><span class="op" id="2955355">.</span><span class="ident" id="2955356">IsPathSeparator</span><span class="op" id="2955371">(</span><span class="ident" id="2955372">path</span><span class="op" id="2955376">[</span><span class="num" id="2955377">0</span><span class="op" id="2955378">]</span><span class="op" id="2955379">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2955383">//&nbsp;Invariants:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2955399">//&nbsp;&nbsp;&nbsp;&nbsp;reading&nbsp;from&nbsp;path;&nbsp;r&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;process.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2955458">//&nbsp;&nbsp;&nbsp;&nbsp;writing&nbsp;to&nbsp;buf;&nbsp;w&nbsp;is&nbsp;index&nbsp;of&nbsp;next&nbsp;byte&nbsp;to&nbsp;write.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2955512">//&nbsp;&nbsp;&nbsp;&nbsp;dotdot&nbsp;is&nbsp;index&nbsp;in&nbsp;buf&nbsp;where&nbsp;..&nbsp;must&nbsp;stop,&nbsp;either&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2955574">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;it&nbsp;is&nbsp;the&nbsp;leading&nbsp;slash&nbsp;or&nbsp;it&nbsp;is&nbsp;a&nbsp;leading&nbsp;../../..&nbsp;prefix.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2955639">n</span>&nbsp;<span class="op" id="2955641">:=</span>&nbsp;<span class="builtinfunc" id="2955644">len</span><span class="op" id="2955647">(</span><span class="ident" id="2955648">path</span><span class="op" id="2955652">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2955655">out</span>&nbsp;<span class="op" id="2955659">:=</span>&nbsp;<span class="ident" id="2955662">lazybuf</span><span class="op" id="2955669">{</span><span class="ident" id="2955670">path</span><span class="op" id="2955674">:</span>&nbsp;<span class="ident" id="2955676">path</span><span class="op" id="2955680">,</span>&nbsp;<span class="ident" id="2955682">volAndPath</span><span class="op" id="2955692">:</span>&nbsp;<span class="ident" id="2955694">originalPath</span><span class="op" id="2955706">,</span>&nbsp;<span class="ident" id="2955708">volLen</span><span class="op" id="2955714">:</span>&nbsp;<span class="ident" id="2955716">volLen</span><span class="op" id="2955722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2955725">r</span><span class="op" id="2955726">,</span>&nbsp;<span class="ident" id="2955728">dotdot</span>&nbsp;<span class="op" id="2955735">:=</span>&nbsp;<span class="num" id="2955738">0</span><span class="op" id="2955739">,</span>&nbsp;<span class="num" id="2955741">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2955744">if</span>&nbsp;<span class="ident" id="2955747">rooted</span>&nbsp;<span class="op" id="2955754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2955758">out</span><span class="op" id="2955761">.</span><span class="builtinfunc" id="2955762">append</span><span class="op" id="2955768">(</span><span class="ident" id="2955769">Separator</span><span class="op" id="2955778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2955782">r</span><span class="op" id="2955783">,</span>&nbsp;<span class="ident" id="2955785">dotdot</span>&nbsp;<span class="op" id="2955792">=</span>&nbsp;<span class="num" id="2955794">1</span><span class="op" id="2955795">,</span>&nbsp;<span class="num" id="2955797">1</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2955800">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2955804">for</span>&nbsp;<span class="ident" id="2955808">r</span>&nbsp;<span class="op" id="2955810">&lt;</span>&nbsp;<span class="ident" id="2955812">n</span>&nbsp;<span class="op" id="2955814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2955818">switch</span>&nbsp;<span class="op" id="2955825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2955829">case</span>&nbsp;<span class="ident" id="2955834">os</span><span class="op" id="2955836">.</span><span class="ident" id="2955837">IsPathSeparator</span><span class="op" id="2955852">(</span><span class="ident" id="2955853">path</span><span class="op" id="2955857">[</span><span class="ident" id="2955858">r</span><span class="op" id="2955859">]</span><span class="op" id="2955860">)</span><span class="op" id="2955861">:</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2955866">//&nbsp;empty&nbsp;path&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2955891">r</span><span class="op" id="2955892">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2955897">case</span>&nbsp;<span class="ident" id="2955902">path</span><span class="op" id="2955906">[</span><span class="ident" id="2955907">r</span><span class="op" id="2955908">]</span>&nbsp;<span class="op" id="2955910">==</span>&nbsp;<span class="string" id="2955913">&#39;.&#39;</span>&nbsp;<span class="op" id="2955917">&amp;&amp;</span>&nbsp;<span class="op" id="2955920">(</span><span class="ident" id="2955921">r</span><span class="op" id="2955922">+</span><span class="num" id="2955923">1</span>&nbsp;<span class="op" id="2955925">==</span>&nbsp;<span class="ident" id="2955928">n</span>&nbsp;<span class="op" id="2955930">||</span>&nbsp;<span class="ident" id="2955933">os</span><span class="op" id="2955935">.</span><span class="ident" id="2955936">IsPathSeparator</span><span class="op" id="2955951">(</span><span class="ident" id="2955952">path</span><span class="op" id="2955956">[</span><span class="ident" id="2955957">r</span><span class="op" id="2955958">+</span><span class="num" id="2955959">1</span><span class="op" id="2955960">]</span><span class="op" id="2955961">)</span><span class="op" id="2955962">)</span><span class="op" id="2955963">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2955968">//&nbsp;.&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2955984">r</span><span class="op" id="2955985">++</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2955990">case</span>&nbsp;<span class="ident" id="2955995">path</span><span class="op" id="2955999">[</span><span class="ident" id="2956000">r</span><span class="op" id="2956001">]</span>&nbsp;<span class="op" id="2956003">==</span>&nbsp;<span class="string" id="2956006">&#39;.&#39;</span>&nbsp;<span class="op" id="2956010">&amp;&amp;</span>&nbsp;<span class="ident" id="2956013">path</span><span class="op" id="2956017">[</span><span class="ident" id="2956018">r</span><span class="op" id="2956019">+</span><span class="num" id="2956020">1</span><span class="op" id="2956021">]</span>&nbsp;<span class="op" id="2956023">==</span>&nbsp;<span class="string" id="2956026">&#39;.&#39;</span>&nbsp;<span class="op" id="2956030">&amp;&amp;</span>&nbsp;<span class="op" id="2956033">(</span><span class="ident" id="2956034">r</span><span class="op" id="2956035">+</span><span class="num" id="2956036">2</span>&nbsp;<span class="op" id="2956038">==</span>&nbsp;<span class="ident" id="2956041">n</span>&nbsp;<span class="op" id="2956043">||</span>&nbsp;<span class="ident" id="2956046">os</span><span class="op" id="2956048">.</span><span class="ident" id="2956049">IsPathSeparator</span><span class="op" id="2956064">(</span><span class="ident" id="2956065">path</span><span class="op" id="2956069">[</span><span class="ident" id="2956070">r</span><span class="op" id="2956071">+</span><span class="num" id="2956072">2</span><span class="op" id="2956073">]</span><span class="op" id="2956074">)</span><span class="op" id="2956075">)</span><span class="op" id="2956076">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2956081">//&nbsp;..&nbsp;element:&nbsp;remove&nbsp;to&nbsp;last&nbsp;separator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2956124">r</span>&nbsp;<span class="op" id="2956126">+=</span>&nbsp;<span class="num" id="2956129">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2956134">switch</span>&nbsp;<span class="op" id="2956141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2956146">case</span>&nbsp;<span class="ident" id="2956151">out</span><span class="op" id="2956154">.</span><span class="ident" id="2956155">w</span>&nbsp;<span class="op" id="2956157">&gt;</span>&nbsp;<span class="ident" id="2956159">dotdot</span><span class="op" id="2956165">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2956171">//&nbsp;can&nbsp;backtrack</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2956192">out</span><span class="op" id="2956195">.</span><span class="ident" id="2956196">w</span><span class="op" id="2956197">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2956204">for</span>&nbsp;<span class="ident" id="2956208">out</span><span class="op" id="2956211">.</span><span class="ident" id="2956212">w</span>&nbsp;<span class="op" id="2956214">&gt;</span>&nbsp;<span class="ident" id="2956216">dotdot</span>&nbsp;<span class="op" id="2956223">&amp;&amp;</span>&nbsp;<span class="op" id="2956226">!</span><span class="ident" id="2956227">os</span><span class="op" id="2956229">.</span><span class="ident" id="2956230">IsPathSeparator</span><span class="op" id="2956245">(</span><span class="ident" id="2956246">out</span><span class="op" id="2956249">.</span><span class="ident" id="2956250">index</span><span class="op" id="2956255">(</span><span class="ident" id="2956256">out</span><span class="op" id="2956259">.</span><span class="ident" id="2956260">w</span><span class="op" id="2956261">)</span><span class="op" id="2956262">)</span>&nbsp;<span class="op" id="2956264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2956271">out</span><span class="op" id="2956274">.</span><span class="ident" id="2956275">w</span><span class="op" id="2956276">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2956283">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2956288">case</span>&nbsp;<span class="op" id="2956293">!</span><span class="ident" id="2956294">rooted</span><span class="op" id="2956300">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2956306">//&nbsp;cannot&nbsp;backtrack,&nbsp;but&nbsp;not&nbsp;rooted,&nbsp;so&nbsp;append&nbsp;..&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2956369">if</span>&nbsp;<span class="ident" id="2956372">out</span><span class="op" id="2956375">.</span><span class="ident" id="2956376">w</span>&nbsp;<span class="op" id="2956378">&gt;</span>&nbsp;<span class="num" id="2956380">0</span>&nbsp;<span class="op" id="2956382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2956389">out</span><span class="op" id="2956392">.</span><span class="builtinfunc" id="2956393">append</span><span class="op" id="2956399">(</span><span class="ident" id="2956400">Separator</span><span class="op" id="2956409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2956415">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2956421">out</span><span class="op" id="2956424">.</span><span class="builtinfunc" id="2956425">append</span><span class="op" id="2956431">(</span><span class="string" id="2956432">&#39;.&#39;</span><span class="op" id="2956435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2956441">out</span><span class="op" id="2956444">.</span><span class="builtinfunc" id="2956445">append</span><span class="op" id="2956451">(</span><span class="string" id="2956452">&#39;.&#39;</span><span class="op" id="2956455">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2956461">dotdot</span>&nbsp;<span class="op" id="2956468">=</span>&nbsp;<span class="ident" id="2956470">out</span><span class="op" id="2956473">.</span><span class="ident" id="2956474">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2956479">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2956483">default</span><span class="op" id="2956490">:</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2956495">//&nbsp;real&nbsp;path&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2956520">//&nbsp;add&nbsp;slash&nbsp;if&nbsp;needed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2956546">if</span>&nbsp;<span class="ident" id="2956549">rooted</span>&nbsp;<span class="op" id="2956556">&amp;&amp;</span>&nbsp;<span class="ident" id="2956559">out</span><span class="op" id="2956562">.</span><span class="ident" id="2956563">w</span>&nbsp;<span class="op" id="2956565">!=</span>&nbsp;<span class="num" id="2956568">1</span>&nbsp;<span class="op" id="2956570">||</span>&nbsp;<span class="op" id="2956573">!</span><span class="ident" id="2956574">rooted</span>&nbsp;<span class="op" id="2956581">&amp;&amp;</span>&nbsp;<span class="ident" id="2956584">out</span><span class="op" id="2956587">.</span><span class="ident" id="2956588">w</span>&nbsp;<span class="op" id="2956590">!=</span>&nbsp;<span class="num" id="2956593">0</span>&nbsp;<span class="op" id="2956595">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2956601">out</span><span class="op" id="2956604">.</span><span class="builtinfunc" id="2956605">append</span><span class="op" id="2956611">(</span><span class="ident" id="2956612">Separator</span><span class="op" id="2956621">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2956626">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2956631">//&nbsp;copy&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2956650">for</span>&nbsp;<span class="op" id="2956654">;</span>&nbsp;<span class="ident" id="2956656">r</span>&nbsp;<span class="op" id="2956658">&lt;</span>&nbsp;<span class="ident" id="2956660">n</span>&nbsp;<span class="op" id="2956662">&amp;&amp;</span>&nbsp;<span class="op" id="2956665">!</span><span class="ident" id="2956666">os</span><span class="op" id="2956668">.</span><span class="ident" id="2956669">IsPathSeparator</span><span class="op" id="2956684">(</span><span class="ident" id="2956685">path</span><span class="op" id="2956689">[</span><span class="ident" id="2956690">r</span><span class="op" id="2956691">]</span><span class="op" id="2956692">)</span><span class="op" id="2956693">;</span>&nbsp;<span class="ident" id="2956695">r</span><span class="op" id="2956696">++</span>&nbsp;<span class="op" id="2956699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2956705">out</span><span class="op" id="2956708">.</span><span class="builtinfunc" id="2956709">append</span><span class="op" id="2956715">(</span><span class="ident" id="2956716">path</span><span class="op" id="2956720">[</span><span class="ident" id="2956721">r</span><span class="op" id="2956722">]</span><span class="op" id="2956723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2956728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2956732">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2956735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2956739">//&nbsp;Turn&nbsp;empty&nbsp;string&nbsp;into&nbsp;&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2956770">if</span>&nbsp;<span class="ident" id="2956773">out</span><span class="op" id="2956776">.</span><span class="ident" id="2956777">w</span>&nbsp;<span class="op" id="2956779">==</span>&nbsp;<span class="num" id="2956782">0</span>&nbsp;<span class="op" id="2956784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2956788">out</span><span class="op" id="2956791">.</span><span class="builtinfunc" id="2956792">append</span><span class="op" id="2956798">(</span><span class="string" id="2956799">&#39;.&#39;</span><span class="op" id="2956802">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2956805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2956809">return</span>&nbsp;<span class="ident" id="2956816">FromSlash</span><span class="op" id="2956825">(</span><span class="ident" id="2956826">out</span><span class="op" id="2956829">.</span><span class="builtintype" id="2956830">string</span><span class="op" id="2956836">(</span><span class="op" id="2956837">)</span><span class="op" id="2956838">)</span><br>
<span class="lineno"></span><span class="op" id="2956840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="2956843">//&nbsp;ToSlash&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;replacing&nbsp;each&nbsp;separator&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="2956911">//&nbsp;in&nbsp;path&nbsp;with&nbsp;a&nbsp;slash&nbsp;(&#39;/&#39;)&nbsp;character.&nbsp;Multiple&nbsp;separators&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2956976">//&nbsp;replaced&nbsp;by&nbsp;multiple&nbsp;slashes.</span><br>
<span class="lineno"></span><span class="keyword" id="2957009">func</span>&nbsp;<span class="ident" id="2957014">ToSlash</span><span class="op" id="2957021">(</span><span class="ident" id="2957022">path</span>&nbsp;<span class="builtintype" id="2957027">string</span><span class="op" id="2957033">)</span>&nbsp;<span class="builtintype" id="2957035">string</span>&nbsp;<span class="op" id="2957042">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2957045">if</span>&nbsp;<span class="ident" id="2957048">Separator</span>&nbsp;<span class="op" id="2957058">==</span>&nbsp;<span class="string" id="2957061">&#39;/&#39;</span>&nbsp;<span class="op" id="2957065">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2957069">return</span>&nbsp;<span class="ident" id="2957076">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2957082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2957085">return</span>&nbsp;<span class="ident" id="2957092">strings</span><span class="op" id="2957099">.</span><span class="ident" id="2957100">Replace</span><span class="op" id="2957107">(</span><span class="ident" id="2957108">path</span><span class="op" id="2957112">,</span>&nbsp;<span class="builtintype" id="2957114">string</span><span class="op" id="2957120">(</span><span class="ident" id="2957121">Separator</span><span class="op" id="2957130">)</span><span class="op" id="2957131">,</span>&nbsp;<span class="string" id="2957133">&#34;/&#34;</span><span class="op" id="2957136">,</span>&nbsp;<span class="op" id="2957138">-</span><span class="num" id="2957139">1</span><span class="op" id="2957140">)</span><br>
<span class="lineno"></span><span class="op" id="2957142">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="2957145">//&nbsp;FromSlash&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;replacing&nbsp;each&nbsp;slash&nbsp;(&#39;/&#39;)&nbsp;character</span><br>
<span class="lineno"></span><span class="comment" id="2957217">//&nbsp;in&nbsp;path&nbsp;with&nbsp;a&nbsp;separator&nbsp;character.&nbsp;Multiple&nbsp;slashes&nbsp;are&nbsp;replaced</span><br>
<span class="lineno"></span><span class="comment" id="2957286">//&nbsp;by&nbsp;multiple&nbsp;separators.</span><br>
<span class="lineno"></span><span class="keyword" id="2957313">func</span>&nbsp;<span class="ident" id="2957318">FromSlash</span><span class="op" id="2957327">(</span><span class="ident" id="2957328">path</span>&nbsp;<span class="builtintype" id="2957333">string</span><span class="op" id="2957339">)</span>&nbsp;<span class="builtintype" id="2957341">string</span>&nbsp;<span class="op" id="2957348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2957351">if</span>&nbsp;<span class="ident" id="2957354">Separator</span>&nbsp;<span class="op" id="2957364">==</span>&nbsp;<span class="string" id="2957367">&#39;/&#39;</span>&nbsp;<span class="op" id="2957371">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2957375">return</span>&nbsp;<span class="ident" id="2957382">path</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2957388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2957391">return</span>&nbsp;<span class="ident" id="2957398">strings</span><span class="op" id="2957405">.</span><span class="ident" id="2957406">Replace</span><span class="op" id="2957413">(</span><span class="ident" id="2957414">path</span><span class="op" id="2957418">,</span>&nbsp;<span class="string" id="2957420">&#34;/&#34;</span><span class="op" id="2957423">,</span>&nbsp;<span class="builtintype" id="2957425">string</span><span class="op" id="2957431">(</span><span class="ident" id="2957432">Separator</span><span class="op" id="2957441">)</span><span class="op" id="2957442">,</span>&nbsp;<span class="op" id="2957444">-</span><span class="num" id="2957445">1</span><span class="op" id="2957446">)</span><br>
<span class="lineno"></span><span class="op" id="2957448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="comment" id="2957451">//&nbsp;SplitList&nbsp;splits&nbsp;a&nbsp;list&nbsp;of&nbsp;paths&nbsp;joined&nbsp;by&nbsp;the&nbsp;OS-specific&nbsp;ListSeparator,</span><br>
<span class="lineno"></span><span class="comment" id="2957528">//&nbsp;usually&nbsp;found&nbsp;in&nbsp;PATH&nbsp;or&nbsp;GOPATH&nbsp;environment&nbsp;variables.</span><br>
<span class="lineno"></span><span class="comment" id="2957586">//&nbsp;Unlike&nbsp;strings.Split,&nbsp;SplitList&nbsp;returns&nbsp;an&nbsp;empty&nbsp;slice&nbsp;when&nbsp;passed&nbsp;an&nbsp;empty&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="2957673">func</span>&nbsp;<span class="ident" id="2957678">SplitList</span><span class="op" id="2957687">(</span><span class="ident" id="2957688">path</span>&nbsp;<span class="builtintype" id="2957693">string</span><span class="op" id="2957699">)</span>&nbsp;<span class="op" id="2957701">[</span><span class="op" id="2957702">]</span><span class="builtintype" id="2957703">string</span>&nbsp;<span class="op" id="2957710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2957713">return</span>&nbsp;<span class="ident" id="2957720">splitList</span><span class="op" id="2957729">(</span><span class="ident" id="2957730">path</span><span class="op" id="2957734">)</span><br>
<span class="lineno">180</span><span class="op" id="2957736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2957739">//&nbsp;Split&nbsp;splits&nbsp;path&nbsp;immediately&nbsp;following&nbsp;the&nbsp;final&nbsp;Separator,</span><br>
<span class="lineno"></span><span class="comment" id="2957803">//&nbsp;separating&nbsp;it&nbsp;into&nbsp;a&nbsp;directory&nbsp;and&nbsp;file&nbsp;name&nbsp;component.</span><br>
<span class="lineno"></span><span class="comment" id="2957862">//&nbsp;If&nbsp;there&nbsp;is&nbsp;no&nbsp;Separator&nbsp;in&nbsp;path,&nbsp;Split&nbsp;returns&nbsp;an&nbsp;empty&nbsp;dir</span><br>
<span class="lineno">185</span><span class="comment" id="2957926">//&nbsp;and&nbsp;file&nbsp;set&nbsp;to&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="2957951">//&nbsp;The&nbsp;returned&nbsp;values&nbsp;have&nbsp;the&nbsp;property&nbsp;that&nbsp;path&nbsp;=&nbsp;dir+file.</span><br>
<span class="lineno"></span><span class="keyword" id="2958014">func</span>&nbsp;<span class="ident" id="2958019">Split</span><span class="op" id="2958024">(</span><span class="ident" id="2958025">path</span>&nbsp;<span class="builtintype" id="2958030">string</span><span class="op" id="2958036">)</span>&nbsp;<span class="op" id="2958038">(</span><span class="ident" id="2958039">dir</span><span class="op" id="2958042">,</span>&nbsp;<span class="ident" id="2958044">file</span>&nbsp;<span class="builtintype" id="2958049">string</span><span class="op" id="2958055">)</span>&nbsp;<span class="op" id="2958057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958060">vol</span>&nbsp;<span class="op" id="2958064">:=</span>&nbsp;<span class="ident" id="2958067">VolumeName</span><span class="op" id="2958077">(</span><span class="ident" id="2958078">path</span><span class="op" id="2958082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958085">i</span>&nbsp;<span class="op" id="2958087">:=</span>&nbsp;<span class="builtinfunc" id="2958090">len</span><span class="op" id="2958093">(</span><span class="ident" id="2958094">path</span><span class="op" id="2958098">)</span>&nbsp;<span class="op" id="2958100">-</span>&nbsp;<span class="num" id="2958102">1</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2958105">for</span>&nbsp;<span class="ident" id="2958109">i</span>&nbsp;<span class="op" id="2958111">&gt;=</span>&nbsp;<span class="builtinfunc" id="2958114">len</span><span class="op" id="2958117">(</span><span class="ident" id="2958118">vol</span><span class="op" id="2958121">)</span>&nbsp;<span class="op" id="2958123">&amp;&amp;</span>&nbsp;<span class="op" id="2958126">!</span><span class="ident" id="2958127">os</span><span class="op" id="2958129">.</span><span class="ident" id="2958130">IsPathSeparator</span><span class="op" id="2958145">(</span><span class="ident" id="2958146">path</span><span class="op" id="2958150">[</span><span class="ident" id="2958151">i</span><span class="op" id="2958152">]</span><span class="op" id="2958153">)</span>&nbsp;<span class="op" id="2958155">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2958159">i</span><span class="op" id="2958160">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2958164">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2958167">return</span>&nbsp;<span class="ident" id="2958174">path</span><span class="op" id="2958178">[</span><span class="op" id="2958179">:</span><span class="ident" id="2958180">i</span><span class="op" id="2958181">+</span><span class="num" id="2958182">1</span><span class="op" id="2958183">]</span><span class="op" id="2958184">,</span>&nbsp;<span class="ident" id="2958186">path</span><span class="op" id="2958190">[</span><span class="ident" id="2958191">i</span><span class="op" id="2958192">+</span><span class="num" id="2958193">1</span><span class="op" id="2958194">:</span><span class="op" id="2958195">]</span><br>
<span class="lineno"></span><span class="op" id="2958197">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="comment" id="2958200">//&nbsp;Join&nbsp;joins&nbsp;any&nbsp;number&nbsp;of&nbsp;path&nbsp;elements&nbsp;into&nbsp;a&nbsp;single&nbsp;path,&nbsp;adding</span><br>
<span class="lineno"></span><span class="comment" id="2958269">//&nbsp;a&nbsp;Separator&nbsp;if&nbsp;necessary.&nbsp;The&nbsp;result&nbsp;is&nbsp;Cleaned,&nbsp;in&nbsp;particular</span><br>
<span class="lineno"></span><span class="comment" id="2958335">//&nbsp;all&nbsp;empty&nbsp;strings&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="keyword" id="2958369">func</span>&nbsp;<span class="ident" id="2958374">Join</span><span class="op" id="2958378">(</span><span class="ident" id="2958379">elem</span>&nbsp;<span class="op" id="2958384">...</span><span class="builtintype" id="2958387">string</span><span class="op" id="2958393">)</span>&nbsp;<span class="builtintype" id="2958395">string</span>&nbsp;<span class="op" id="2958402">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2958405">for</span>&nbsp;<span class="ident" id="2958409">i</span><span class="op" id="2958410">,</span>&nbsp;<span class="ident" id="2958412">e</span>&nbsp;<span class="op" id="2958414">:=</span>&nbsp;<span class="keyword" id="2958417">range</span>&nbsp;<span class="ident" id="2958423">elem</span>&nbsp;<span class="op" id="2958428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2958432">if</span>&nbsp;<span class="ident" id="2958435">e</span>&nbsp;<span class="op" id="2958437">!=</span>&nbsp;<span class="string" id="2958440">&#34;&#34;</span>&nbsp;<span class="op" id="2958443">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2958448">return</span>&nbsp;<span class="ident" id="2958455">Clean</span><span class="op" id="2958460">(</span><span class="ident" id="2958461">strings</span><span class="op" id="2958468">.</span><span class="ident" id="2958469">Join</span><span class="op" id="2958473">(</span><span class="ident" id="2958474">elem</span><span class="op" id="2958478">[</span><span class="ident" id="2958479">i</span><span class="op" id="2958480">:</span><span class="op" id="2958481">]</span><span class="op" id="2958482">,</span>&nbsp;<span class="builtintype" id="2958484">string</span><span class="op" id="2958490">(</span><span class="ident" id="2958491">Separator</span><span class="op" id="2958500">)</span><span class="op" id="2958501">)</span><span class="op" id="2958502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2958506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2958509">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2958512">return</span>&nbsp;<span class="string" id="2958519">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2958522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2958525">//&nbsp;Ext&nbsp;returns&nbsp;the&nbsp;file&nbsp;name&nbsp;extension&nbsp;used&nbsp;by&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="2958578">//&nbsp;The&nbsp;extension&nbsp;is&nbsp;the&nbsp;suffix&nbsp;beginning&nbsp;at&nbsp;the&nbsp;final&nbsp;dot</span><br>
<span class="lineno">210</span><span class="comment" id="2958636">//&nbsp;in&nbsp;the&nbsp;final&nbsp;element&nbsp;of&nbsp;path;&nbsp;it&nbsp;is&nbsp;empty&nbsp;if&nbsp;there&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="2958693">//&nbsp;no&nbsp;dot.</span><br>
<span class="lineno"></span><span class="keyword" id="2958704">func</span>&nbsp;<span class="ident" id="2958709">Ext</span><span class="op" id="2958712">(</span><span class="ident" id="2958713">path</span>&nbsp;<span class="builtintype" id="2958718">string</span><span class="op" id="2958724">)</span>&nbsp;<span class="builtintype" id="2958726">string</span>&nbsp;<span class="op" id="2958733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2958736">for</span>&nbsp;<span class="ident" id="2958740">i</span>&nbsp;<span class="op" id="2958742">:=</span>&nbsp;<span class="builtinfunc" id="2958745">len</span><span class="op" id="2958748">(</span><span class="ident" id="2958749">path</span><span class="op" id="2958753">)</span>&nbsp;<span class="op" id="2958755">-</span>&nbsp;<span class="num" id="2958757">1</span><span class="op" id="2958758">;</span>&nbsp;<span class="ident" id="2958760">i</span>&nbsp;<span class="op" id="2958762">&gt;=</span>&nbsp;<span class="num" id="2958765">0</span>&nbsp;<span class="op" id="2958767">&amp;&amp;</span>&nbsp;<span class="op" id="2958770">!</span><span class="ident" id="2958771">os</span><span class="op" id="2958773">.</span><span class="ident" id="2958774">IsPathSeparator</span><span class="op" id="2958789">(</span><span class="ident" id="2958790">path</span><span class="op" id="2958794">[</span><span class="ident" id="2958795">i</span><span class="op" id="2958796">]</span><span class="op" id="2958797">)</span><span class="op" id="2958798">;</span>&nbsp;<span class="ident" id="2958800">i</span><span class="op" id="2958801">--</span>&nbsp;<span class="op" id="2958804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2958808">if</span>&nbsp;<span class="ident" id="2958811">path</span><span class="op" id="2958815">[</span><span class="ident" id="2958816">i</span><span class="op" id="2958817">]</span>&nbsp;<span class="op" id="2958819">==</span>&nbsp;<span class="string" id="2958822">&#39;.&#39;</span>&nbsp;<span class="op" id="2958826">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2958831">return</span>&nbsp;<span class="ident" id="2958838">path</span><span class="op" id="2958842">[</span><span class="ident" id="2958843">i</span><span class="op" id="2958844">:</span><span class="op" id="2958845">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2958849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2958852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2958855">return</span>&nbsp;<span class="string" id="2958862">&#34;&#34;</span><br>
<span class="lineno"></span><span class="op" id="2958865">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="2958868">//&nbsp;EvalSymlinks&nbsp;returns&nbsp;the&nbsp;path&nbsp;name&nbsp;after&nbsp;the&nbsp;evaluation&nbsp;of&nbsp;any&nbsp;symbolic</span><br>
<span class="lineno"></span><span class="comment" id="2958943">//&nbsp;links.</span><br>
<span class="lineno"></span><span class="comment" id="2958953">//&nbsp;If&nbsp;path&nbsp;is&nbsp;relative&nbsp;the&nbsp;result&nbsp;will&nbsp;be&nbsp;relative&nbsp;to&nbsp;the&nbsp;current&nbsp;directory,</span><br>
<span class="lineno"></span><span class="comment" id="2959030">//&nbsp;unless&nbsp;one&nbsp;of&nbsp;the&nbsp;components&nbsp;is&nbsp;an&nbsp;absolute&nbsp;symbolic&nbsp;link.</span><br>
<span class="lineno">225</span><span class="keyword" id="2959092">func</span>&nbsp;<span class="ident" id="2959097">EvalSymlinks</span><span class="op" id="2959109">(</span><span class="ident" id="2959110">path</span>&nbsp;<span class="builtintype" id="2959115">string</span><span class="op" id="2959121">)</span>&nbsp;<span class="op" id="2959123">(</span><span class="builtintype" id="2959124">string</span><span class="op" id="2959130">,</span>&nbsp;<span class="builtintype" id="2959132">error</span><span class="op" id="2959137">)</span>&nbsp;<span class="op" id="2959139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2959142">return</span>&nbsp;<span class="ident" id="2959149">evalSymlinks</span><span class="op" id="2959161">(</span><span class="ident" id="2959162">path</span><span class="op" id="2959166">)</span><br>
<span class="lineno"></span><span class="op" id="2959168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2959171">//&nbsp;Abs&nbsp;returns&nbsp;an&nbsp;absolute&nbsp;representation&nbsp;of&nbsp;path.</span><br>
<span class="lineno">230</span><span class="comment" id="2959222">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;not&nbsp;absolute&nbsp;it&nbsp;will&nbsp;be&nbsp;joined&nbsp;with&nbsp;the&nbsp;current</span><br>
<span class="lineno"></span><span class="comment" id="2959288">//&nbsp;working&nbsp;directory&nbsp;to&nbsp;turn&nbsp;it&nbsp;into&nbsp;an&nbsp;absolute&nbsp;path.&nbsp;&nbsp;The&nbsp;absolute</span><br>
<span class="lineno"></span><span class="comment" id="2959357">//&nbsp;path&nbsp;name&nbsp;for&nbsp;a&nbsp;given&nbsp;file&nbsp;is&nbsp;not&nbsp;guaranteed&nbsp;to&nbsp;be&nbsp;unique.</span><br>
<span class="lineno"></span><span class="keyword" id="2959419">func</span>&nbsp;<span class="ident" id="2959424">Abs</span><span class="op" id="2959427">(</span><span class="ident" id="2959428">path</span>&nbsp;<span class="builtintype" id="2959433">string</span><span class="op" id="2959439">)</span>&nbsp;<span class="op" id="2959441">(</span><span class="builtintype" id="2959442">string</span><span class="op" id="2959448">,</span>&nbsp;<span class="builtintype" id="2959450">error</span><span class="op" id="2959455">)</span>&nbsp;<span class="op" id="2959457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2959460">return</span>&nbsp;<span class="ident" id="2959467">abs</span><span class="op" id="2959470">(</span><span class="ident" id="2959471">path</span><span class="op" id="2959475">)</span><br>
<span class="lineno">235</span><span class="op" id="2959477">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2959480">func</span>&nbsp;<span class="ident" id="2959485">unixAbs</span><span class="op" id="2959492">(</span><span class="ident" id="2959493">path</span>&nbsp;<span class="builtintype" id="2959498">string</span><span class="op" id="2959504">)</span>&nbsp;<span class="op" id="2959506">(</span><span class="builtintype" id="2959507">string</span><span class="op" id="2959513">,</span>&nbsp;<span class="builtintype" id="2959515">error</span><span class="op" id="2959520">)</span>&nbsp;<span class="op" id="2959522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2959525">if</span>&nbsp;<span class="ident" id="2959528">IsAbs</span><span class="op" id="2959533">(</span><span class="ident" id="2959534">path</span><span class="op" id="2959538">)</span>&nbsp;<span class="op" id="2959540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2959544">return</span>&nbsp;<span class="ident" id="2959551">Clean</span><span class="op" id="2959556">(</span><span class="ident" id="2959557">path</span><span class="op" id="2959561">)</span><span class="op" id="2959562">,</span>&nbsp;<span class="ident" id="2959564">nil</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2959569">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2959572">wd</span><span class="op" id="2959574">,</span>&nbsp;<span class="ident" id="2959576">err</span>&nbsp;<span class="op" id="2959580">:=</span>&nbsp;<span class="ident" id="2959583">os</span><span class="op" id="2959585">.</span><span class="ident" id="2959586">Getwd</span><span class="op" id="2959591">(</span><span class="op" id="2959592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2959595">if</span>&nbsp;<span class="ident" id="2959598">err</span>&nbsp;<span class="op" id="2959602">!=</span>&nbsp;<span class="ident" id="2959605">nil</span>&nbsp;<span class="op" id="2959609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2959613">return</span>&nbsp;<span class="string" id="2959620">&#34;&#34;</span><span class="op" id="2959622">,</span>&nbsp;<span class="ident" id="2959624">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2959629">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2959632">return</span>&nbsp;<span class="ident" id="2959639">Join</span><span class="op" id="2959643">(</span><span class="ident" id="2959644">wd</span><span class="op" id="2959646">,</span>&nbsp;<span class="ident" id="2959648">path</span><span class="op" id="2959652">)</span><span class="op" id="2959653">,</span>&nbsp;<span class="ident" id="2959655">nil</span><br>
<span class="lineno"></span><span class="op" id="2959659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2959662">//&nbsp;Rel&nbsp;returns&nbsp;a&nbsp;relative&nbsp;path&nbsp;that&nbsp;is&nbsp;lexically&nbsp;equivalent&nbsp;to&nbsp;targpath&nbsp;when</span><br>
<span class="lineno"></span><span class="comment" id="2959739">//&nbsp;joined&nbsp;to&nbsp;basepath&nbsp;with&nbsp;an&nbsp;intervening&nbsp;separator.&nbsp;That&nbsp;is,</span><br>
<span class="lineno">250</span><span class="comment" id="2959801">//&nbsp;Join(basepath,&nbsp;Rel(basepath,&nbsp;targpath))&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;targpath&nbsp;itself.</span><br>
<span class="lineno"></span><span class="comment" id="2959878">//&nbsp;On&nbsp;success,&nbsp;the&nbsp;returned&nbsp;path&nbsp;will&nbsp;always&nbsp;be&nbsp;relative&nbsp;to&nbsp;basepath,</span><br>
<span class="lineno"></span><span class="comment" id="2959948">//&nbsp;even&nbsp;if&nbsp;basepath&nbsp;and&nbsp;targpath&nbsp;share&nbsp;no&nbsp;elements.</span><br>
<span class="lineno"></span><span class="comment" id="2960000">//&nbsp;An&nbsp;error&nbsp;is&nbsp;returned&nbsp;if&nbsp;targpath&nbsp;can&#39;t&nbsp;be&nbsp;made&nbsp;relative&nbsp;to&nbsp;basepath&nbsp;or&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="2960077">//&nbsp;knowing&nbsp;the&nbsp;current&nbsp;working&nbsp;directory&nbsp;would&nbsp;be&nbsp;necessary&nbsp;to&nbsp;compute&nbsp;it.</span><br>
<span class="lineno">255</span><span class="keyword" id="2960152">func</span>&nbsp;<span class="ident" id="2960157">Rel</span><span class="op" id="2960160">(</span><span class="ident" id="2960161">basepath</span><span class="op" id="2960169">,</span>&nbsp;<span class="ident" id="2960171">targpath</span>&nbsp;<span class="builtintype" id="2960180">string</span><span class="op" id="2960186">)</span>&nbsp;<span class="op" id="2960188">(</span><span class="builtintype" id="2960189">string</span><span class="op" id="2960195">,</span>&nbsp;<span class="builtintype" id="2960197">error</span><span class="op" id="2960202">)</span>&nbsp;<span class="op" id="2960204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2960207">baseVol</span>&nbsp;<span class="op" id="2960215">:=</span>&nbsp;<span class="ident" id="2960218">VolumeName</span><span class="op" id="2960228">(</span><span class="ident" id="2960229">basepath</span><span class="op" id="2960237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2960240">targVol</span>&nbsp;<span class="op" id="2960248">:=</span>&nbsp;<span class="ident" id="2960251">VolumeName</span><span class="op" id="2960261">(</span><span class="ident" id="2960262">targpath</span><span class="op" id="2960270">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2960273">base</span>&nbsp;<span class="op" id="2960278">:=</span>&nbsp;<span class="ident" id="2960281">Clean</span><span class="op" id="2960286">(</span><span class="ident" id="2960287">basepath</span><span class="op" id="2960295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2960298">targ</span>&nbsp;<span class="op" id="2960303">:=</span>&nbsp;<span class="ident" id="2960306">Clean</span><span class="op" id="2960311">(</span><span class="ident" id="2960312">targpath</span><span class="op" id="2960320">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2960323">if</span>&nbsp;<span class="ident" id="2960326">targ</span>&nbsp;<span class="op" id="2960331">==</span>&nbsp;<span class="ident" id="2960334">base</span>&nbsp;<span class="op" id="2960339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2960343">return</span>&nbsp;<span class="string" id="2960350">&#34;.&#34;</span><span class="op" id="2960353">,</span>&nbsp;<span class="ident" id="2960355">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2960360">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2960363">base</span>&nbsp;<span class="op" id="2960368">=</span>&nbsp;<span class="ident" id="2960370">base</span><span class="op" id="2960374">[</span><span class="builtinfunc" id="2960375">len</span><span class="op" id="2960378">(</span><span class="ident" id="2960379">baseVol</span><span class="op" id="2960386">)</span><span class="op" id="2960387">:</span><span class="op" id="2960388">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2960391">targ</span>&nbsp;<span class="op" id="2960396">=</span>&nbsp;<span class="ident" id="2960398">targ</span><span class="op" id="2960402">[</span><span class="builtinfunc" id="2960403">len</span><span class="op" id="2960406">(</span><span class="ident" id="2960407">targVol</span><span class="op" id="2960414">)</span><span class="op" id="2960415">:</span><span class="op" id="2960416">]</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2960419">if</span>&nbsp;<span class="ident" id="2960422">base</span>&nbsp;<span class="op" id="2960427">==</span>&nbsp;<span class="string" id="2960430">&#34;.&#34;</span>&nbsp;<span class="op" id="2960434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2960438">base</span>&nbsp;<span class="op" id="2960443">=</span>&nbsp;<span class="string" id="2960445">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2960449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2960452">//&nbsp;Can&#39;t&nbsp;use&nbsp;IsAbs&nbsp;-&nbsp;`\a`&nbsp;and&nbsp;`a`&nbsp;are&nbsp;both&nbsp;relative&nbsp;in&nbsp;Windows.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2960517">baseSlashed</span>&nbsp;<span class="op" id="2960529">:=</span>&nbsp;<span class="builtinfunc" id="2960532">len</span><span class="op" id="2960535">(</span><span class="ident" id="2960536">base</span><span class="op" id="2960540">)</span>&nbsp;<span class="op" id="2960542">&gt;</span>&nbsp;<span class="num" id="2960544">0</span>&nbsp;<span class="op" id="2960546">&amp;&amp;</span>&nbsp;<span class="ident" id="2960549">base</span><span class="op" id="2960553">[</span><span class="num" id="2960554">0</span><span class="op" id="2960555">]</span>&nbsp;<span class="op" id="2960557">==</span>&nbsp;<span class="ident" id="2960560">Separator</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2960571">targSlashed</span>&nbsp;<span class="op" id="2960583">:=</span>&nbsp;<span class="builtinfunc" id="2960586">len</span><span class="op" id="2960589">(</span><span class="ident" id="2960590">targ</span><span class="op" id="2960594">)</span>&nbsp;<span class="op" id="2960596">&gt;</span>&nbsp;<span class="num" id="2960598">0</span>&nbsp;<span class="op" id="2960600">&amp;&amp;</span>&nbsp;<span class="ident" id="2960603">targ</span><span class="op" id="2960607">[</span><span class="num" id="2960608">0</span><span class="op" id="2960609">]</span>&nbsp;<span class="op" id="2960611">==</span>&nbsp;<span class="ident" id="2960614">Separator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2960625">if</span>&nbsp;<span class="ident" id="2960628">baseSlashed</span>&nbsp;<span class="op" id="2960640">!=</span>&nbsp;<span class="ident" id="2960643">targSlashed</span>&nbsp;<span class="op" id="2960655">||</span>&nbsp;<span class="ident" id="2960658">baseVol</span>&nbsp;<span class="op" id="2960666">!=</span>&nbsp;<span class="ident" id="2960669">targVol</span>&nbsp;<span class="op" id="2960677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2960681">return</span>&nbsp;<span class="string" id="2960688">&#34;&#34;</span><span class="op" id="2960690">,</span>&nbsp;<span class="ident" id="2960692">errors</span><span class="op" id="2960698">.</span><span class="ident" id="2960699">New</span><span class="op" id="2960702">(</span><span class="string" id="2960703">&#34;Rel:&nbsp;can&#39;t&nbsp;make&nbsp;&#34;</span>&nbsp;<span class="op" id="2960722">+</span>&nbsp;<span class="ident" id="2960724">targ</span>&nbsp;<span class="op" id="2960729">+</span>&nbsp;<span class="string" id="2960731">&#34;&nbsp;relative&nbsp;to&nbsp;&#34;</span>&nbsp;<span class="op" id="2960747">+</span>&nbsp;<span class="ident" id="2960749">base</span><span class="op" id="2960753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2960756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2960759">//&nbsp;Position&nbsp;base[b0:bi]&nbsp;and&nbsp;targ[t0:ti]&nbsp;at&nbsp;the&nbsp;first&nbsp;differing&nbsp;elements.</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2960833">bl</span>&nbsp;<span class="op" id="2960836">:=</span>&nbsp;<span class="builtinfunc" id="2960839">len</span><span class="op" id="2960842">(</span><span class="ident" id="2960843">base</span><span class="op" id="2960847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2960850">tl</span>&nbsp;<span class="op" id="2960853">:=</span>&nbsp;<span class="builtinfunc" id="2960856">len</span><span class="op" id="2960859">(</span><span class="ident" id="2960860">targ</span><span class="op" id="2960864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2960867">var</span>&nbsp;<span class="ident" id="2960871">b0</span><span class="op" id="2960873">,</span>&nbsp;<span class="ident" id="2960875">bi</span><span class="op" id="2960877">,</span>&nbsp;<span class="ident" id="2960879">t0</span><span class="op" id="2960881">,</span>&nbsp;<span class="ident" id="2960883">ti</span>&nbsp;<span class="builtintype" id="2960886">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2960891">for</span>&nbsp;<span class="op" id="2960895">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2960899">for</span>&nbsp;<span class="ident" id="2960903">bi</span>&nbsp;<span class="op" id="2960906">&lt;</span>&nbsp;<span class="ident" id="2960908">bl</span>&nbsp;<span class="op" id="2960911">&amp;&amp;</span>&nbsp;<span class="ident" id="2960914">base</span><span class="op" id="2960918">[</span><span class="ident" id="2960919">bi</span><span class="op" id="2960921">]</span>&nbsp;<span class="op" id="2960923">!=</span>&nbsp;<span class="ident" id="2960926">Separator</span>&nbsp;<span class="op" id="2960936">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2960941">bi</span><span class="op" id="2960943">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2960948">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2960952">for</span>&nbsp;<span class="ident" id="2960956">ti</span>&nbsp;<span class="op" id="2960959">&lt;</span>&nbsp;<span class="ident" id="2960961">tl</span>&nbsp;<span class="op" id="2960964">&amp;&amp;</span>&nbsp;<span class="ident" id="2960967">targ</span><span class="op" id="2960971">[</span><span class="ident" id="2960972">ti</span><span class="op" id="2960974">]</span>&nbsp;<span class="op" id="2960976">!=</span>&nbsp;<span class="ident" id="2960979">Separator</span>&nbsp;<span class="op" id="2960989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2960994">ti</span><span class="op" id="2960996">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2961001">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2961005">if</span>&nbsp;<span class="ident" id="2961008">targ</span><span class="op" id="2961012">[</span><span class="ident" id="2961013">t0</span><span class="op" id="2961015">:</span><span class="ident" id="2961016">ti</span><span class="op" id="2961018">]</span>&nbsp;<span class="op" id="2961020">!=</span>&nbsp;<span class="ident" id="2961023">base</span><span class="op" id="2961027">[</span><span class="ident" id="2961028">b0</span><span class="op" id="2961030">:</span><span class="ident" id="2961031">bi</span><span class="op" id="2961033">]</span>&nbsp;<span class="op" id="2961035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2961040">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2961048">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2961052">if</span>&nbsp;<span class="ident" id="2961055">bi</span>&nbsp;<span class="op" id="2961058">&lt;</span>&nbsp;<span class="ident" id="2961060">bl</span>&nbsp;<span class="op" id="2961063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2961068">bi</span><span class="op" id="2961070">++</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2961075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2961079">if</span>&nbsp;<span class="ident" id="2961082">ti</span>&nbsp;<span class="op" id="2961085">&lt;</span>&nbsp;<span class="ident" id="2961087">tl</span>&nbsp;<span class="op" id="2961090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2961095">ti</span><span class="op" id="2961097">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2961102">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2961106">b0</span>&nbsp;<span class="op" id="2961109">=</span>&nbsp;<span class="ident" id="2961111">bi</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2961116">t0</span>&nbsp;<span class="op" id="2961119">=</span>&nbsp;<span class="ident" id="2961121">ti</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2961125">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2961128">if</span>&nbsp;<span class="ident" id="2961131">base</span><span class="op" id="2961135">[</span><span class="ident" id="2961136">b0</span><span class="op" id="2961138">:</span><span class="ident" id="2961139">bi</span><span class="op" id="2961141">]</span>&nbsp;<span class="op" id="2961143">==</span>&nbsp;<span class="string" id="2961146">&#34;..&#34;</span>&nbsp;<span class="op" id="2961151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2961155">return</span>&nbsp;<span class="string" id="2961162">&#34;&#34;</span><span class="op" id="2961164">,</span>&nbsp;<span class="ident" id="2961166">errors</span><span class="op" id="2961172">.</span><span class="ident" id="2961173">New</span><span class="op" id="2961176">(</span><span class="string" id="2961177">&#34;Rel:&nbsp;can&#39;t&nbsp;make&nbsp;&#34;</span>&nbsp;<span class="op" id="2961196">+</span>&nbsp;<span class="ident" id="2961198">targ</span>&nbsp;<span class="op" id="2961203">+</span>&nbsp;<span class="string" id="2961205">&#34;&nbsp;relative&nbsp;to&nbsp;&#34;</span>&nbsp;<span class="op" id="2961221">+</span>&nbsp;<span class="ident" id="2961223">base</span><span class="op" id="2961227">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2961230">}</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2961233">if</span>&nbsp;<span class="ident" id="2961236">b0</span>&nbsp;<span class="op" id="2961239">!=</span>&nbsp;<span class="ident" id="2961242">bl</span>&nbsp;<span class="op" id="2961245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2961249">//&nbsp;Base&nbsp;elements&nbsp;left.&nbsp;Must&nbsp;go&nbsp;up&nbsp;before&nbsp;going&nbsp;down.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2961304">seps</span>&nbsp;<span class="op" id="2961309">:=</span>&nbsp;<span class="ident" id="2961312">strings</span><span class="op" id="2961319">.</span><span class="ident" id="2961320">Count</span><span class="op" id="2961325">(</span><span class="ident" id="2961326">base</span><span class="op" id="2961330">[</span><span class="ident" id="2961331">b0</span><span class="op" id="2961333">:</span><span class="ident" id="2961334">bl</span><span class="op" id="2961336">]</span><span class="op" id="2961337">,</span>&nbsp;<span class="builtintype" id="2961339">string</span><span class="op" id="2961345">(</span><span class="ident" id="2961346">Separator</span><span class="op" id="2961355">)</span><span class="op" id="2961356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2961360">size</span>&nbsp;<span class="op" id="2961365">:=</span>&nbsp;<span class="num" id="2961368">2</span>&nbsp;<span class="op" id="2961370">+</span>&nbsp;<span class="ident" id="2961372">seps</span><span class="op" id="2961376">*</span><span class="num" id="2961377">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2961381">if</span>&nbsp;<span class="ident" id="2961384">tl</span>&nbsp;<span class="op" id="2961387">!=</span>&nbsp;<span class="ident" id="2961390">t0</span>&nbsp;<span class="op" id="2961393">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2961398">size</span>&nbsp;<span class="op" id="2961403">+=</span>&nbsp;<span class="num" id="2961406">1</span>&nbsp;<span class="op" id="2961408">+</span>&nbsp;<span class="ident" id="2961410">tl</span>&nbsp;<span class="op" id="2961413">-</span>&nbsp;<span class="ident" id="2961415">t0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2961420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2961424">buf</span>&nbsp;<span class="op" id="2961428">:=</span>&nbsp;<span class="builtinfunc" id="2961431">make</span><span class="op" id="2961435">(</span><span class="op" id="2961436">[</span><span class="op" id="2961437">]</span><span class="builtintype" id="2961438">byte</span><span class="op" id="2961442">,</span>&nbsp;<span class="ident" id="2961444">size</span><span class="op" id="2961448">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2961452">n</span>&nbsp;<span class="op" id="2961454">:=</span>&nbsp;<span class="builtinfunc" id="2961457">copy</span><span class="op" id="2961461">(</span><span class="ident" id="2961462">buf</span><span class="op" id="2961465">,</span>&nbsp;<span class="string" id="2961467">&#34;..&#34;</span><span class="op" id="2961471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2961475">for</span>&nbsp;<span class="ident" id="2961479">i</span>&nbsp;<span class="op" id="2961481">:=</span>&nbsp;<span class="num" id="2961484">0</span><span class="op" id="2961485">;</span>&nbsp;<span class="ident" id="2961487">i</span>&nbsp;<span class="op" id="2961489">&lt;</span>&nbsp;<span class="ident" id="2961491">seps</span><span class="op" id="2961495">;</span>&nbsp;<span class="ident" id="2961497">i</span><span class="op" id="2961498">++</span>&nbsp;<span class="op" id="2961501">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2961506">buf</span><span class="op" id="2961509">[</span><span class="ident" id="2961510">n</span><span class="op" id="2961511">]</span>&nbsp;<span class="op" id="2961513">=</span>&nbsp;<span class="ident" id="2961515">Separator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2961528">copy</span><span class="op" id="2961532">(</span><span class="ident" id="2961533">buf</span><span class="op" id="2961536">[</span><span class="ident" id="2961537">n</span><span class="op" id="2961538">+</span><span class="num" id="2961539">1</span><span class="op" id="2961540">:</span><span class="op" id="2961541">]</span><span class="op" id="2961542">,</span>&nbsp;<span class="string" id="2961544">&#34;..&#34;</span><span class="op" id="2961548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2961553">n</span>&nbsp;<span class="op" id="2961555">+=</span>&nbsp;<span class="num" id="2961558">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2961562">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2961566">if</span>&nbsp;<span class="ident" id="2961569">t0</span>&nbsp;<span class="op" id="2961572">!=</span>&nbsp;<span class="ident" id="2961575">tl</span>&nbsp;<span class="op" id="2961578">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2961583">buf</span><span class="op" id="2961586">[</span><span class="ident" id="2961587">n</span><span class="op" id="2961588">]</span>&nbsp;<span class="op" id="2961590">=</span>&nbsp;<span class="ident" id="2961592">Separator</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="2961605">copy</span><span class="op" id="2961609">(</span><span class="ident" id="2961610">buf</span><span class="op" id="2961613">[</span><span class="ident" id="2961614">n</span><span class="op" id="2961615">+</span><span class="num" id="2961616">1</span><span class="op" id="2961617">:</span><span class="op" id="2961618">]</span><span class="op" id="2961619">,</span>&nbsp;<span class="ident" id="2961621">targ</span><span class="op" id="2961625">[</span><span class="ident" id="2961626">t0</span><span class="op" id="2961628">:</span><span class="op" id="2961629">]</span><span class="op" id="2961630">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2961634">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2961638">return</span>&nbsp;<span class="builtintype" id="2961645">string</span><span class="op" id="2961651">(</span><span class="ident" id="2961652">buf</span><span class="op" id="2961655">)</span><span class="op" id="2961656">,</span>&nbsp;<span class="ident" id="2961658">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2961663">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2961666">return</span>&nbsp;<span class="ident" id="2961673">targ</span><span class="op" id="2961677">[</span><span class="ident" id="2961678">t0</span><span class="op" id="2961680">:</span><span class="op" id="2961681">]</span><span class="op" id="2961682">,</span>&nbsp;<span class="ident" id="2961684">nil</span><br>
<span class="lineno"></span><span class="op" id="2961688">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2961691">//&nbsp;SkipDir&nbsp;is&nbsp;used&nbsp;as&nbsp;a&nbsp;return&nbsp;value&nbsp;from&nbsp;WalkFuncs&nbsp;to&nbsp;indicate&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="2961760">//&nbsp;the&nbsp;directory&nbsp;named&nbsp;in&nbsp;the&nbsp;call&nbsp;is&nbsp;to&nbsp;be&nbsp;skipped.&nbsp;It&nbsp;is&nbsp;not&nbsp;returned</span><br>
<span class="lineno">325</span><span class="comment" id="2961832">//&nbsp;as&nbsp;an&nbsp;error&nbsp;by&nbsp;any&nbsp;function.</span><br>
<span class="lineno"></span><span class="keyword" id="2961864">var</span>&nbsp;<span class="ident" id="2961868">SkipDir</span>&nbsp;<span class="op" id="2961876">=</span>&nbsp;<span class="ident" id="2961878">errors</span><span class="op" id="2961884">.</span><span class="ident" id="2961885">New</span><span class="op" id="2961888">(</span><span class="string" id="2961889">&#34;skip&nbsp;this&nbsp;directory&#34;</span><span class="op" id="2961910">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2961913">//&nbsp;WalkFunc&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;function&nbsp;called&nbsp;for&nbsp;each&nbsp;file&nbsp;or&nbsp;directory</span><br>
<span class="lineno"></span><span class="comment" id="2961987">//&nbsp;visited&nbsp;by&nbsp;Walk.&nbsp;The&nbsp;path&nbsp;argument&nbsp;contains&nbsp;the&nbsp;argument&nbsp;to&nbsp;Walk&nbsp;as&nbsp;a</span><br>
<span class="lineno">330</span><span class="comment" id="2962060">//&nbsp;prefix;&nbsp;that&nbsp;is,&nbsp;if&nbsp;Walk&nbsp;is&nbsp;called&nbsp;with&nbsp;&#34;dir&#34;,&nbsp;which&nbsp;is&nbsp;a&nbsp;directory</span><br>
<span class="lineno"></span><span class="comment" id="2962131">//&nbsp;containing&nbsp;the&nbsp;file&nbsp;&#34;a&#34;,&nbsp;the&nbsp;walk&nbsp;function&nbsp;will&nbsp;be&nbsp;called&nbsp;with&nbsp;argument</span><br>
<span class="lineno"></span><span class="comment" id="2962206">//&nbsp;&#34;dir/a&#34;.&nbsp;The&nbsp;info&nbsp;argument&nbsp;is&nbsp;the&nbsp;os.FileInfo&nbsp;for&nbsp;the&nbsp;named&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="2962275">//</span><br>
<span class="lineno"></span><span class="comment" id="2962278">//&nbsp;If&nbsp;there&nbsp;was&nbsp;a&nbsp;problem&nbsp;walking&nbsp;to&nbsp;the&nbsp;file&nbsp;or&nbsp;directory&nbsp;named&nbsp;by&nbsp;path,&nbsp;the</span><br>
<span class="lineno">335</span><span class="comment" id="2962356">//&nbsp;incoming&nbsp;error&nbsp;will&nbsp;describe&nbsp;the&nbsp;problem&nbsp;and&nbsp;the&nbsp;function&nbsp;can&nbsp;decide&nbsp;how</span><br>
<span class="lineno"></span><span class="comment" id="2962432">//&nbsp;to&nbsp;handle&nbsp;that&nbsp;error&nbsp;(and&nbsp;Walk&nbsp;will&nbsp;not&nbsp;descend&nbsp;into&nbsp;that&nbsp;directory).&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="2962508">//&nbsp;an&nbsp;error&nbsp;is&nbsp;returned,&nbsp;processing&nbsp;stops.&nbsp;The&nbsp;sole&nbsp;exception&nbsp;is&nbsp;that&nbsp;if&nbsp;path</span><br>
<span class="lineno"></span><span class="comment" id="2962586">//&nbsp;is&nbsp;a&nbsp;directory&nbsp;and&nbsp;the&nbsp;function&nbsp;returns&nbsp;the&nbsp;special&nbsp;value&nbsp;SkipDir,&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2962660">//&nbsp;contents&nbsp;of&nbsp;the&nbsp;directory&nbsp;are&nbsp;skipped&nbsp;and&nbsp;processing&nbsp;continues&nbsp;as&nbsp;usual&nbsp;on</span><br>
<span class="lineno">340</span><span class="comment" id="2962738">//&nbsp;the&nbsp;next&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="2962756">type</span>&nbsp;<span class="ident" id="2962761">WalkFunc</span>&nbsp;<span class="keyword" id="2962770">func</span><span class="op" id="2962774">(</span><span class="ident" id="2962775">path</span>&nbsp;<span class="builtintype" id="2962780">string</span><span class="op" id="2962786">,</span>&nbsp;<span class="ident" id="2962788">info</span>&nbsp;<span class="ident" id="2962793">os</span><span class="op" id="2962795">.</span><span class="ident" id="2962796">FileInfo</span><span class="op" id="2962804">,</span>&nbsp;<span class="ident" id="2962806">err</span>&nbsp;<span class="builtintype" id="2962810">error</span><span class="op" id="2962815">)</span>&nbsp;<span class="builtintype" id="2962817">error</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2962824">var</span>&nbsp;<span class="ident" id="2962828">lstat</span>&nbsp;<span class="op" id="2962834">=</span>&nbsp;<span class="ident" id="2962836">os</span><span class="op" id="2962838">.</span><span class="ident" id="2962839">Lstat</span>&nbsp;<span class="comment" id="2962845">//&nbsp;for&nbsp;testing</span><br>
<span class="lineno"></span><br>
<span class="lineno">345</span><span class="comment" id="2962861">//&nbsp;walk&nbsp;recursively&nbsp;descends&nbsp;path,&nbsp;calling&nbsp;w.</span><br>
<span class="lineno"></span><span class="keyword" id="2962907">func</span>&nbsp;<span class="ident" id="2962912">walk</span><span class="op" id="2962916">(</span><span class="ident" id="2962917">path</span>&nbsp;<span class="builtintype" id="2962922">string</span><span class="op" id="2962928">,</span>&nbsp;<span class="ident" id="2962930">info</span>&nbsp;<span class="ident" id="2962935">os</span><span class="op" id="2962937">.</span><span class="ident" id="2962938">FileInfo</span><span class="op" id="2962946">,</span>&nbsp;<span class="ident" id="2962948">walkFn</span>&nbsp;<span class="ident" id="2962955">WalkFunc</span><span class="op" id="2962963">)</span>&nbsp;<span class="builtintype" id="2962965">error</span>&nbsp;<span class="op" id="2962971">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2962974">err</span>&nbsp;<span class="op" id="2962978">:=</span>&nbsp;<span class="ident" id="2962981">walkFn</span><span class="op" id="2962987">(</span><span class="ident" id="2962988">path</span><span class="op" id="2962992">,</span>&nbsp;<span class="ident" id="2962994">info</span><span class="op" id="2962998">,</span>&nbsp;<span class="ident" id="2963000">nil</span><span class="op" id="2963003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2963006">if</span>&nbsp;<span class="ident" id="2963009">err</span>&nbsp;<span class="op" id="2963013">!=</span>&nbsp;<span class="ident" id="2963016">nil</span>&nbsp;<span class="op" id="2963020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2963024">if</span>&nbsp;<span class="ident" id="2963027">info</span><span class="op" id="2963031">.</span><span class="ident" id="2963032">IsDir</span><span class="op" id="2963037">(</span><span class="op" id="2963038">)</span>&nbsp;<span class="op" id="2963040">&amp;&amp;</span>&nbsp;<span class="ident" id="2963043">err</span>&nbsp;<span class="op" id="2963047">==</span>&nbsp;<span class="ident" id="2963050">SkipDir</span>&nbsp;<span class="op" id="2963058">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2963063">return</span>&nbsp;<span class="ident" id="2963070">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2963076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2963080">return</span>&nbsp;<span class="ident" id="2963087">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2963092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2963096">if</span>&nbsp;<span class="op" id="2963099">!</span><span class="ident" id="2963100">info</span><span class="op" id="2963104">.</span><span class="ident" id="2963105">IsDir</span><span class="op" id="2963110">(</span><span class="op" id="2963111">)</span>&nbsp;<span class="op" id="2963113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2963117">return</span>&nbsp;<span class="ident" id="2963124">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2963129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2963133">names</span><span class="op" id="2963138">,</span>&nbsp;<span class="ident" id="2963140">err</span>&nbsp;<span class="op" id="2963144">:=</span>&nbsp;<span class="ident" id="2963147">readDirNames</span><span class="op" id="2963159">(</span><span class="ident" id="2963160">path</span><span class="op" id="2963164">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2963167">if</span>&nbsp;<span class="ident" id="2963170">err</span>&nbsp;<span class="op" id="2963174">!=</span>&nbsp;<span class="ident" id="2963177">nil</span>&nbsp;<span class="op" id="2963181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2963185">return</span>&nbsp;<span class="ident" id="2963192">walkFn</span><span class="op" id="2963198">(</span><span class="ident" id="2963199">path</span><span class="op" id="2963203">,</span>&nbsp;<span class="ident" id="2963205">info</span><span class="op" id="2963209">,</span>&nbsp;<span class="ident" id="2963211">err</span><span class="op" id="2963214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2963217">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2963221">for</span>&nbsp;<span class="ident" id="2963225">_</span><span class="op" id="2963226">,</span>&nbsp;<span class="ident" id="2963228">name</span>&nbsp;<span class="op" id="2963233">:=</span>&nbsp;<span class="keyword" id="2963236">range</span>&nbsp;<span class="ident" id="2963242">names</span>&nbsp;<span class="op" id="2963248">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2963252">filename</span>&nbsp;<span class="op" id="2963261">:=</span>&nbsp;<span class="ident" id="2963264">Join</span><span class="op" id="2963268">(</span><span class="ident" id="2963269">path</span><span class="op" id="2963273">,</span>&nbsp;<span class="ident" id="2963275">name</span><span class="op" id="2963279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2963283">fileInfo</span><span class="op" id="2963291">,</span>&nbsp;<span class="ident" id="2963293">err</span>&nbsp;<span class="op" id="2963297">:=</span>&nbsp;<span class="ident" id="2963300">lstat</span><span class="op" id="2963305">(</span><span class="ident" id="2963306">filename</span><span class="op" id="2963314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2963318">if</span>&nbsp;<span class="ident" id="2963321">err</span>&nbsp;<span class="op" id="2963325">!=</span>&nbsp;<span class="ident" id="2963328">nil</span>&nbsp;<span class="op" id="2963332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2963337">if</span>&nbsp;<span class="ident" id="2963340">err</span>&nbsp;<span class="op" id="2963344">:=</span>&nbsp;<span class="ident" id="2963347">walkFn</span><span class="op" id="2963353">(</span><span class="ident" id="2963354">filename</span><span class="op" id="2963362">,</span>&nbsp;<span class="ident" id="2963364">fileInfo</span><span class="op" id="2963372">,</span>&nbsp;<span class="ident" id="2963374">err</span><span class="op" id="2963377">)</span><span class="op" id="2963378">;</span>&nbsp;<span class="ident" id="2963380">err</span>&nbsp;<span class="op" id="2963384">!=</span>&nbsp;<span class="ident" id="2963387">nil</span>&nbsp;<span class="op" id="2963391">&amp;&amp;</span>&nbsp;<span class="ident" id="2963394">err</span>&nbsp;<span class="op" id="2963398">!=</span>&nbsp;<span class="ident" id="2963401">SkipDir</span>&nbsp;<span class="op" id="2963409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2963415">return</span>&nbsp;<span class="ident" id="2963422">err</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2963429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2963433">}</span>&nbsp;<span class="keyword" id="2963435">else</span>&nbsp;<span class="op" id="2963440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2963445">err</span>&nbsp;<span class="op" id="2963449">=</span>&nbsp;<span class="ident" id="2963451">walk</span><span class="op" id="2963455">(</span><span class="ident" id="2963456">filename</span><span class="op" id="2963464">,</span>&nbsp;<span class="ident" id="2963466">fileInfo</span><span class="op" id="2963474">,</span>&nbsp;<span class="ident" id="2963476">walkFn</span><span class="op" id="2963482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2963487">if</span>&nbsp;<span class="ident" id="2963490">err</span>&nbsp;<span class="op" id="2963494">!=</span>&nbsp;<span class="ident" id="2963497">nil</span>&nbsp;<span class="op" id="2963501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2963507">if</span>&nbsp;<span class="op" id="2963510">!</span><span class="ident" id="2963511">fileInfo</span><span class="op" id="2963519">.</span><span class="ident" id="2963520">IsDir</span><span class="op" id="2963525">(</span><span class="op" id="2963526">)</span>&nbsp;<span class="op" id="2963528">||</span>&nbsp;<span class="ident" id="2963531">err</span>&nbsp;<span class="op" id="2963535">!=</span>&nbsp;<span class="ident" id="2963538">SkipDir</span>&nbsp;<span class="op" id="2963546">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2963553">return</span>&nbsp;<span class="ident" id="2963560">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2963568">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2963573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2963577">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2963580">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2963583">return</span>&nbsp;<span class="ident" id="2963590">nil</span><br>
<span class="lineno"></span><span class="op" id="2963594">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2963597">//&nbsp;Walk&nbsp;walks&nbsp;the&nbsp;file&nbsp;tree&nbsp;rooted&nbsp;at&nbsp;root,&nbsp;calling&nbsp;walkFn&nbsp;for&nbsp;each&nbsp;file&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2963673">//&nbsp;directory&nbsp;in&nbsp;the&nbsp;tree,&nbsp;including&nbsp;root.&nbsp;All&nbsp;errors&nbsp;that&nbsp;arise&nbsp;visiting&nbsp;files</span><br>
<span class="lineno">385</span><span class="comment" id="2963752">//&nbsp;and&nbsp;directories&nbsp;are&nbsp;filtered&nbsp;by&nbsp;walkFn.&nbsp;The&nbsp;files&nbsp;are&nbsp;walked&nbsp;in&nbsp;lexical</span><br>
<span class="lineno"></span><span class="comment" id="2963827">//&nbsp;order,&nbsp;which&nbsp;makes&nbsp;the&nbsp;output&nbsp;deterministic&nbsp;but&nbsp;means&nbsp;that&nbsp;for&nbsp;very</span><br>
<span class="lineno"></span><span class="comment" id="2963898">//&nbsp;large&nbsp;directories&nbsp;Walk&nbsp;can&nbsp;be&nbsp;inefficient.</span><br>
<span class="lineno"></span><span class="comment" id="2963944">//&nbsp;Walk&nbsp;does&nbsp;not&nbsp;follow&nbsp;symbolic&nbsp;links.</span><br>
<span class="lineno"></span><span class="keyword" id="2963984">func</span>&nbsp;<span class="ident" id="2963989">Walk</span><span class="op" id="2963993">(</span><span class="ident" id="2963994">root</span>&nbsp;<span class="builtintype" id="2963999">string</span><span class="op" id="2964005">,</span>&nbsp;<span class="ident" id="2964007">walkFn</span>&nbsp;<span class="ident" id="2964014">WalkFunc</span><span class="op" id="2964022">)</span>&nbsp;<span class="builtintype" id="2964024">error</span>&nbsp;<span class="op" id="2964030">{</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2964033">info</span><span class="op" id="2964037">,</span>&nbsp;<span class="ident" id="2964039">err</span>&nbsp;<span class="op" id="2964043">:=</span>&nbsp;<span class="ident" id="2964046">os</span><span class="op" id="2964048">.</span><span class="ident" id="2964049">Lstat</span><span class="op" id="2964054">(</span><span class="ident" id="2964055">root</span><span class="op" id="2964059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2964062">if</span>&nbsp;<span class="ident" id="2964065">err</span>&nbsp;<span class="op" id="2964069">!=</span>&nbsp;<span class="ident" id="2964072">nil</span>&nbsp;<span class="op" id="2964076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2964080">return</span>&nbsp;<span class="ident" id="2964087">walkFn</span><span class="op" id="2964093">(</span><span class="ident" id="2964094">root</span><span class="op" id="2964098">,</span>&nbsp;<span class="ident" id="2964100">nil</span><span class="op" id="2964103">,</span>&nbsp;<span class="ident" id="2964105">err</span><span class="op" id="2964108">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2964111">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2964114">return</span>&nbsp;<span class="ident" id="2964121">walk</span><span class="op" id="2964125">(</span><span class="ident" id="2964126">root</span><span class="op" id="2964130">,</span>&nbsp;<span class="ident" id="2964132">info</span><span class="op" id="2964136">,</span>&nbsp;<span class="ident" id="2964138">walkFn</span><span class="op" id="2964144">)</span><br>
<span class="lineno">395</span><span class="op" id="2964146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2964149">//&nbsp;readDirNames&nbsp;reads&nbsp;the&nbsp;directory&nbsp;named&nbsp;by&nbsp;dirname&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="2964214">//&nbsp;a&nbsp;sorted&nbsp;list&nbsp;of&nbsp;directory&nbsp;entries.</span><br>
<span class="lineno"></span><span class="keyword" id="2964253">func</span>&nbsp;<span class="ident" id="2964258">readDirNames</span><span class="op" id="2964270">(</span><span class="ident" id="2964271">dirname</span>&nbsp;<span class="builtintype" id="2964279">string</span><span class="op" id="2964285">)</span>&nbsp;<span class="op" id="2964287">(</span><span class="op" id="2964288">[</span><span class="op" id="2964289">]</span><span class="builtintype" id="2964290">string</span><span class="op" id="2964296">,</span>&nbsp;<span class="builtintype" id="2964298">error</span><span class="op" id="2964303">)</span>&nbsp;<span class="op" id="2964305">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2964308">f</span><span class="op" id="2964309">,</span>&nbsp;<span class="ident" id="2964311">err</span>&nbsp;<span class="op" id="2964315">:=</span>&nbsp;<span class="ident" id="2964318">os</span><span class="op" id="2964320">.</span><span class="ident" id="2964321">Open</span><span class="op" id="2964325">(</span><span class="ident" id="2964326">dirname</span><span class="op" id="2964333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2964336">if</span>&nbsp;<span class="ident" id="2964339">err</span>&nbsp;<span class="op" id="2964343">!=</span>&nbsp;<span class="ident" id="2964346">nil</span>&nbsp;<span class="op" id="2964350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2964354">return</span>&nbsp;<span class="ident" id="2964361">nil</span><span class="op" id="2964364">,</span>&nbsp;<span class="ident" id="2964366">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2964371">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2964374">names</span><span class="op" id="2964379">,</span>&nbsp;<span class="ident" id="2964381">err</span>&nbsp;<span class="op" id="2964385">:=</span>&nbsp;<span class="ident" id="2964388">f</span><span class="op" id="2964389">.</span><span class="ident" id="2964390">Readdirnames</span><span class="op" id="2964402">(</span><span class="op" id="2964403">-</span><span class="num" id="2964404">1</span><span class="op" id="2964405">)</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2964408">f</span><span class="op" id="2964409">.</span><span class="ident" id="2964410">Close</span><span class="op" id="2964415">(</span><span class="op" id="2964416">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2964419">if</span>&nbsp;<span class="ident" id="2964422">err</span>&nbsp;<span class="op" id="2964426">!=</span>&nbsp;<span class="ident" id="2964429">nil</span>&nbsp;<span class="op" id="2964433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2964437">return</span>&nbsp;<span class="ident" id="2964444">nil</span><span class="op" id="2964447">,</span>&nbsp;<span class="ident" id="2964449">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2964454">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2964457">sort</span><span class="op" id="2964461">.</span><span class="ident" id="2964462">Strings</span><span class="op" id="2964469">(</span><span class="ident" id="2964470">names</span><span class="op" id="2964475">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2964478">return</span>&nbsp;<span class="ident" id="2964485">names</span><span class="op" id="2964490">,</span>&nbsp;<span class="ident" id="2964492">nil</span><br>
<span class="lineno"></span><span class="op" id="2964496">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2964499">//&nbsp;Base&nbsp;returns&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path.</span><br>
<span class="lineno"></span><span class="comment" id="2964541">//&nbsp;Trailing&nbsp;path&nbsp;separators&nbsp;are&nbsp;removed&nbsp;before&nbsp;extracting&nbsp;the&nbsp;last&nbsp;element.</span><br>
<span class="lineno">415</span><span class="comment" id="2964617">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Base&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2964660">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;separators,&nbsp;Base&nbsp;returns&nbsp;a&nbsp;single&nbsp;separator.</span><br>
<span class="lineno"></span><span class="keyword" id="2964741">func</span>&nbsp;<span class="ident" id="2964746">Base</span><span class="op" id="2964750">(</span><span class="ident" id="2964751">path</span>&nbsp;<span class="builtintype" id="2964756">string</span><span class="op" id="2964762">)</span>&nbsp;<span class="builtintype" id="2964764">string</span>&nbsp;<span class="op" id="2964771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2964774">if</span>&nbsp;<span class="ident" id="2964777">path</span>&nbsp;<span class="op" id="2964782">==</span>&nbsp;<span class="string" id="2964785">&#34;&#34;</span>&nbsp;<span class="op" id="2964788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2964792">return</span>&nbsp;<span class="string" id="2964799">&#34;.&#34;</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2964804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2964807">//&nbsp;Strip&nbsp;trailing&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2964835">for</span>&nbsp;<span class="builtinfunc" id="2964839">len</span><span class="op" id="2964842">(</span><span class="ident" id="2964843">path</span><span class="op" id="2964847">)</span>&nbsp;<span class="op" id="2964849">&gt;</span>&nbsp;<span class="num" id="2964851">0</span>&nbsp;<span class="op" id="2964853">&amp;&amp;</span>&nbsp;<span class="ident" id="2964856">os</span><span class="op" id="2964858">.</span><span class="ident" id="2964859">IsPathSeparator</span><span class="op" id="2964874">(</span><span class="ident" id="2964875">path</span><span class="op" id="2964879">[</span><span class="builtinfunc" id="2964880">len</span><span class="op" id="2964883">(</span><span class="ident" id="2964884">path</span><span class="op" id="2964888">)</span><span class="op" id="2964889">-</span><span class="num" id="2964890">1</span><span class="op" id="2964891">]</span><span class="op" id="2964892">)</span>&nbsp;<span class="op" id="2964894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2964898">path</span>&nbsp;<span class="op" id="2964903">=</span>&nbsp;<span class="ident" id="2964905">path</span><span class="op" id="2964909">[</span><span class="num" id="2964910">0</span>&nbsp;<span class="op" id="2964912">:</span>&nbsp;<span class="builtinfunc" id="2964914">len</span><span class="op" id="2964917">(</span><span class="ident" id="2964918">path</span><span class="op" id="2964922">)</span><span class="op" id="2964923">-</span><span class="num" id="2964924">1</span><span class="op" id="2964925">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2964928">}</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2964931">//&nbsp;Throw&nbsp;away&nbsp;volume&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2964958">path</span>&nbsp;<span class="op" id="2964963">=</span>&nbsp;<span class="ident" id="2964965">path</span><span class="op" id="2964969">[</span><span class="builtinfunc" id="2964970">len</span><span class="op" id="2964973">(</span><span class="ident" id="2964974">VolumeName</span><span class="op" id="2964984">(</span><span class="ident" id="2964985">path</span><span class="op" id="2964989">)</span><span class="op" id="2964990">)</span><span class="op" id="2964991">:</span><span class="op" id="2964992">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2964995">//&nbsp;Find&nbsp;the&nbsp;last&nbsp;element</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2965021">i</span>&nbsp;<span class="op" id="2965023">:=</span>&nbsp;<span class="builtinfunc" id="2965026">len</span><span class="op" id="2965029">(</span><span class="ident" id="2965030">path</span><span class="op" id="2965034">)</span>&nbsp;<span class="op" id="2965036">-</span>&nbsp;<span class="num" id="2965038">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2965041">for</span>&nbsp;<span class="ident" id="2965045">i</span>&nbsp;<span class="op" id="2965047">&gt;=</span>&nbsp;<span class="num" id="2965050">0</span>&nbsp;<span class="op" id="2965052">&amp;&amp;</span>&nbsp;<span class="op" id="2965055">!</span><span class="ident" id="2965056">os</span><span class="op" id="2965058">.</span><span class="ident" id="2965059">IsPathSeparator</span><span class="op" id="2965074">(</span><span class="ident" id="2965075">path</span><span class="op" id="2965079">[</span><span class="ident" id="2965080">i</span><span class="op" id="2965081">]</span><span class="op" id="2965082">)</span>&nbsp;<span class="op" id="2965084">{</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2965088">i</span><span class="op" id="2965089">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2965093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2965096">if</span>&nbsp;<span class="ident" id="2965099">i</span>&nbsp;<span class="op" id="2965101">&gt;=</span>&nbsp;<span class="num" id="2965104">0</span>&nbsp;<span class="op" id="2965106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2965110">path</span>&nbsp;<span class="op" id="2965115">=</span>&nbsp;<span class="ident" id="2965117">path</span><span class="op" id="2965121">[</span><span class="ident" id="2965122">i</span><span class="op" id="2965123">+</span><span class="num" id="2965124">1</span><span class="op" id="2965125">:</span><span class="op" id="2965126">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2965129">}</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2965132">//&nbsp;If&nbsp;empty&nbsp;now,&nbsp;it&nbsp;had&nbsp;only&nbsp;slashes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2965171">if</span>&nbsp;<span class="ident" id="2965174">path</span>&nbsp;<span class="op" id="2965179">==</span>&nbsp;<span class="string" id="2965182">&#34;&#34;</span>&nbsp;<span class="op" id="2965185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2965189">return</span>&nbsp;<span class="builtintype" id="2965196">string</span><span class="op" id="2965202">(</span><span class="ident" id="2965203">Separator</span><span class="op" id="2965212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2965215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2965218">return</span>&nbsp;<span class="ident" id="2965225">path</span><br>
<span class="lineno">440</span><span class="op" id="2965230">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2965233">//&nbsp;Dir&nbsp;returns&nbsp;all&nbsp;but&nbsp;the&nbsp;last&nbsp;element&nbsp;of&nbsp;path,&nbsp;typically&nbsp;the&nbsp;path&#39;s&nbsp;directory.</span><br>
<span class="lineno"></span><span class="comment" id="2965314">//&nbsp;After&nbsp;dropping&nbsp;the&nbsp;final&nbsp;element,&nbsp;the&nbsp;path&nbsp;is&nbsp;Cleaned&nbsp;and&nbsp;trailing</span><br>
<span class="lineno"></span><span class="comment" id="2965384">//&nbsp;slashes&nbsp;are&nbsp;removed.</span><br>
<span class="lineno">445</span><span class="comment" id="2965408">//&nbsp;If&nbsp;the&nbsp;path&nbsp;is&nbsp;empty,&nbsp;Dir&nbsp;returns&nbsp;&#34;.&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2965450">//&nbsp;If&nbsp;the&nbsp;path&nbsp;consists&nbsp;entirely&nbsp;of&nbsp;separators,&nbsp;Dir&nbsp;returns&nbsp;a&nbsp;single&nbsp;separator.</span><br>
<span class="lineno"></span><span class="comment" id="2965530">//&nbsp;The&nbsp;returned&nbsp;path&nbsp;does&nbsp;not&nbsp;end&nbsp;in&nbsp;a&nbsp;separator&nbsp;unless&nbsp;it&nbsp;is&nbsp;the&nbsp;root&nbsp;directory.</span><br>
<span class="lineno"></span><span class="keyword" id="2965612">func</span>&nbsp;<span class="ident" id="2965617">Dir</span><span class="op" id="2965620">(</span><span class="ident" id="2965621">path</span>&nbsp;<span class="builtintype" id="2965626">string</span><span class="op" id="2965632">)</span>&nbsp;<span class="builtintype" id="2965634">string</span>&nbsp;<span class="op" id="2965641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2965644">vol</span>&nbsp;<span class="op" id="2965648">:=</span>&nbsp;<span class="ident" id="2965651">VolumeName</span><span class="op" id="2965661">(</span><span class="ident" id="2965662">path</span><span class="op" id="2965666">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2965669">i</span>&nbsp;<span class="op" id="2965671">:=</span>&nbsp;<span class="builtinfunc" id="2965674">len</span><span class="op" id="2965677">(</span><span class="ident" id="2965678">path</span><span class="op" id="2965682">)</span>&nbsp;<span class="op" id="2965684">-</span>&nbsp;<span class="num" id="2965686">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2965689">for</span>&nbsp;<span class="ident" id="2965693">i</span>&nbsp;<span class="op" id="2965695">&gt;=</span>&nbsp;<span class="builtinfunc" id="2965698">len</span><span class="op" id="2965701">(</span><span class="ident" id="2965702">vol</span><span class="op" id="2965705">)</span>&nbsp;<span class="op" id="2965707">&amp;&amp;</span>&nbsp;<span class="op" id="2965710">!</span><span class="ident" id="2965711">os</span><span class="op" id="2965713">.</span><span class="ident" id="2965714">IsPathSeparator</span><span class="op" id="2965729">(</span><span class="ident" id="2965730">path</span><span class="op" id="2965734">[</span><span class="ident" id="2965735">i</span><span class="op" id="2965736">]</span><span class="op" id="2965737">)</span>&nbsp;<span class="op" id="2965739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2965743">i</span><span class="op" id="2965744">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2965748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2965751">dir</span>&nbsp;<span class="op" id="2965755">:=</span>&nbsp;<span class="ident" id="2965758">Clean</span><span class="op" id="2965763">(</span><span class="ident" id="2965764">path</span><span class="op" id="2965768">[</span><span class="builtinfunc" id="2965769">len</span><span class="op" id="2965772">(</span><span class="ident" id="2965773">vol</span><span class="op" id="2965776">)</span>&nbsp;<span class="op" id="2965778">:</span>&nbsp;<span class="ident" id="2965780">i</span><span class="op" id="2965781">+</span><span class="num" id="2965782">1</span><span class="op" id="2965783">]</span><span class="op" id="2965784">)</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2965787">return</span>&nbsp;<span class="ident" id="2965794">vol</span>&nbsp;<span class="op" id="2965798">+</span>&nbsp;<span class="ident" id="2965800">dir</span><br>
<span class="lineno"></span><span class="op" id="2965804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2965807">//&nbsp;VolumeName&nbsp;returns&nbsp;leading&nbsp;volume&nbsp;name.</span><br>
<span class="lineno"></span><span class="comment" id="2965850">//&nbsp;Given&nbsp;&#34;C:\foo\bar&#34;&nbsp;it&nbsp;returns&nbsp;&#34;C:&#34;&nbsp;under&nbsp;windows.</span><br>
<span class="lineno">460</span><span class="comment" id="2965903">//&nbsp;Given&nbsp;&#34;\\host\share\foo&#34;&nbsp;it&nbsp;returns&nbsp;&#34;\\host\share&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="2965958">//&nbsp;On&nbsp;other&nbsp;platforms&nbsp;it&nbsp;returns&nbsp;&#34;&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="2965995">func</span>&nbsp;<span class="ident" id="2966000">VolumeName</span><span class="op" id="2966010">(</span><span class="ident" id="2966011">path</span>&nbsp;<span class="builtintype" id="2966016">string</span><span class="op" id="2966022">)</span>&nbsp;<span class="op" id="2966024">(</span><span class="ident" id="2966025">v</span>&nbsp;<span class="builtintype" id="2966027">string</span><span class="op" id="2966033">)</span>&nbsp;<span class="op" id="2966035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2966038">return</span>&nbsp;<span class="ident" id="2966045">path</span><span class="op" id="2966049">[</span><span class="op" id="2966050">:</span><span class="ident" id="2966051">volumeNameLen</span><span class="op" id="2966064">(</span><span class="ident" id="2966065">path</span><span class="op" id="2966069">)</span><span class="op" id="2966070">]</span><br>
<span class="lineno"></span><span class="op" id="2966072">}</span>
</div>
</body>
</html>
