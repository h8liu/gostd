<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>io/ioutil</h2>
<ul>
<li><a href="/gostd/io/ioutil/ioutil.go.html">ioutil.go</a></li>
<li><a href="/gostd/io/ioutil/ioutil_test.go.html">ioutil_test.go</a></li>
<li><a href="/gostd/io/ioutil/tempfile.go.html">tempfile.go</a></li>
<li><a href="/gostd/io/ioutil/tempfile_test.go.html">tempfile_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7005848">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7005903">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7005957">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7006008">package</span>&nbsp;<span class="ident" id="7006016">ioutil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7006024">import</span>&nbsp;<span class="op" id="7006031">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7006034">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7006040">&#34;path/filepath&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7006057">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7006067">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7006077">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7006080">func</span>&nbsp;<span class="ident" id="7006085">TestTempFile</span><span class="op" id="7006097">(</span><span class="ident" id="7006098">t</span>&nbsp;<span class="op" id="7006100">*</span><span class="ident" id="7006101">testing</span><span class="op" id="7006108">.</span><span class="ident" id="7006109">T</span><span class="op" id="7006110">)</span>&nbsp;<span class="op" id="7006112">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006115">f</span><span class="op" id="7006116">,</span>&nbsp;<span class="ident" id="7006118">err</span>&nbsp;<span class="op" id="7006122">:=</span>&nbsp;<span class="ident" id="7006125">TempFile</span><span class="op" id="7006133">(</span><span class="string" id="7006134">&#34;/_not_exists_&#34;</span><span class="op" id="7006149">,</span>&nbsp;<span class="string" id="7006151">&#34;foo&#34;</span><span class="op" id="7006156">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7006159">if</span>&nbsp;<span class="ident" id="7006162">f</span>&nbsp;<span class="op" id="7006164">!=</span>&nbsp;<span class="ident" id="7006167">nil</span>&nbsp;<span class="op" id="7006171">||</span>&nbsp;<span class="ident" id="7006174">err</span>&nbsp;<span class="op" id="7006178">==</span>&nbsp;<span class="ident" id="7006181">nil</span>&nbsp;<span class="op" id="7006185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006189">t</span><span class="op" id="7006190">.</span><span class="ident" id="7006191">Errorf</span><span class="op" id="7006197">(</span><span class="string" id="7006198">&#34;TempFile(`/_not_exists_`,&nbsp;`foo`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="7006241">,</span>&nbsp;<span class="ident" id="7006243">f</span><span class="op" id="7006244">,</span>&nbsp;<span class="ident" id="7006246">err</span><span class="op" id="7006249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7006252">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006256">dir</span>&nbsp;<span class="op" id="7006260">:=</span>&nbsp;<span class="ident" id="7006263">os</span><span class="op" id="7006265">.</span><span class="ident" id="7006266">TempDir</span><span class="op" id="7006273">(</span><span class="op" id="7006274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006277">f</span><span class="op" id="7006278">,</span>&nbsp;<span class="ident" id="7006280">err</span>&nbsp;<span class="op" id="7006284">=</span>&nbsp;<span class="ident" id="7006286">TempFile</span><span class="op" id="7006294">(</span><span class="ident" id="7006295">dir</span><span class="op" id="7006298">,</span>&nbsp;<span class="string" id="7006300">&#34;ioutil_test&#34;</span><span class="op" id="7006313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7006316">if</span>&nbsp;<span class="ident" id="7006319">f</span>&nbsp;<span class="op" id="7006321">==</span>&nbsp;<span class="ident" id="7006324">nil</span>&nbsp;<span class="op" id="7006328">||</span>&nbsp;<span class="ident" id="7006331">err</span>&nbsp;<span class="op" id="7006335">!=</span>&nbsp;<span class="ident" id="7006338">nil</span>&nbsp;<span class="op" id="7006342">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006346">t</span><span class="op" id="7006347">.</span><span class="ident" id="7006348">Errorf</span><span class="op" id="7006354">(</span><span class="string" id="7006355">&#34;TempFile(dir,&nbsp;`ioutil_test`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="7006394">,</span>&nbsp;<span class="ident" id="7006396">f</span><span class="op" id="7006397">,</span>&nbsp;<span class="ident" id="7006399">err</span><span class="op" id="7006402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7006405">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7006408">if</span>&nbsp;<span class="ident" id="7006411">f</span>&nbsp;<span class="op" id="7006413">!=</span>&nbsp;<span class="ident" id="7006416">nil</span>&nbsp;<span class="op" id="7006420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006424">f</span><span class="op" id="7006425">.</span><span class="ident" id="7006426">Close</span><span class="op" id="7006431">(</span><span class="op" id="7006432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006436">os</span><span class="op" id="7006438">.</span><span class="ident" id="7006439">Remove</span><span class="op" id="7006445">(</span><span class="ident" id="7006446">f</span><span class="op" id="7006447">.</span><span class="ident" id="7006448">Name</span><span class="op" id="7006452">(</span><span class="op" id="7006453">)</span><span class="op" id="7006454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006458">re</span>&nbsp;<span class="op" id="7006461">:=</span>&nbsp;<span class="ident" id="7006464">regexp</span><span class="op" id="7006470">.</span><span class="ident" id="7006471">MustCompile</span><span class="op" id="7006482">(</span><span class="string" id="7006483">&#34;^&#34;</span>&nbsp;<span class="op" id="7006487">+</span>&nbsp;<span class="ident" id="7006489">regexp</span><span class="op" id="7006495">.</span><span class="ident" id="7006496">QuoteMeta</span><span class="op" id="7006505">(</span><span class="ident" id="7006506">filepath</span><span class="op" id="7006514">.</span><span class="ident" id="7006515">Join</span><span class="op" id="7006519">(</span><span class="ident" id="7006520">dir</span><span class="op" id="7006523">,</span>&nbsp;<span class="string" id="7006525">&#34;ioutil_test&#34;</span><span class="op" id="7006538">)</span><span class="op" id="7006539">)</span>&nbsp;<span class="op" id="7006541">+</span>&nbsp;<span class="string" id="7006543">&#34;[0-9]+$&#34;</span><span class="op" id="7006552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7006556">if</span>&nbsp;<span class="op" id="7006559">!</span><span class="ident" id="7006560">re</span><span class="op" id="7006562">.</span><span class="ident" id="7006563">MatchString</span><span class="op" id="7006574">(</span><span class="ident" id="7006575">f</span><span class="op" id="7006576">.</span><span class="ident" id="7006577">Name</span><span class="op" id="7006581">(</span><span class="op" id="7006582">)</span><span class="op" id="7006583">)</span>&nbsp;<span class="op" id="7006585">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006590">t</span><span class="op" id="7006591">.</span><span class="ident" id="7006592">Errorf</span><span class="op" id="7006598">(</span><span class="string" id="7006599">&#34;TempFile(`&#34;</span><span class="op" id="7006611">+</span><span class="ident" id="7006612">dir</span><span class="op" id="7006615">+</span><span class="string" id="7006616">&#34;`,&nbsp;`ioutil_test`)&nbsp;created&nbsp;bad&nbsp;name&nbsp;%s&#34;</span><span class="op" id="7006655">,</span>&nbsp;<span class="ident" id="7006657">f</span><span class="op" id="7006658">.</span><span class="ident" id="7006659">Name</span><span class="op" id="7006663">(</span><span class="op" id="7006664">)</span><span class="op" id="7006665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7006669">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7006672">}</span><br>
<span class="lineno"></span><span class="op" id="7006674">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="keyword" id="7006677">func</span>&nbsp;<span class="ident" id="7006682">TestTempDir</span><span class="op" id="7006693">(</span><span class="ident" id="7006694">t</span>&nbsp;<span class="op" id="7006696">*</span><span class="ident" id="7006697">testing</span><span class="op" id="7006704">.</span><span class="ident" id="7006705">T</span><span class="op" id="7006706">)</span>&nbsp;<span class="op" id="7006708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006711">name</span><span class="op" id="7006715">,</span>&nbsp;<span class="ident" id="7006717">err</span>&nbsp;<span class="op" id="7006721">:=</span>&nbsp;<span class="ident" id="7006724">TempDir</span><span class="op" id="7006731">(</span><span class="string" id="7006732">&#34;/_not_exists_&#34;</span><span class="op" id="7006747">,</span>&nbsp;<span class="string" id="7006749">&#34;foo&#34;</span><span class="op" id="7006754">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7006757">if</span>&nbsp;<span class="ident" id="7006760">name</span>&nbsp;<span class="op" id="7006765">!=</span>&nbsp;<span class="string" id="7006768">&#34;&#34;</span>&nbsp;<span class="op" id="7006771">||</span>&nbsp;<span class="ident" id="7006774">err</span>&nbsp;<span class="op" id="7006778">==</span>&nbsp;<span class="ident" id="7006781">nil</span>&nbsp;<span class="op" id="7006785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006789">t</span><span class="op" id="7006790">.</span><span class="ident" id="7006791">Errorf</span><span class="op" id="7006797">(</span><span class="string" id="7006798">&#34;TempDir(`/_not_exists_`,&nbsp;`foo`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="7006840">,</span>&nbsp;<span class="ident" id="7006842">name</span><span class="op" id="7006846">,</span>&nbsp;<span class="ident" id="7006848">err</span><span class="op" id="7006851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7006854">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006858">dir</span>&nbsp;<span class="op" id="7006862">:=</span>&nbsp;<span class="ident" id="7006865">os</span><span class="op" id="7006867">.</span><span class="ident" id="7006868">TempDir</span><span class="op" id="7006875">(</span><span class="op" id="7006876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006879">name</span><span class="op" id="7006883">,</span>&nbsp;<span class="ident" id="7006885">err</span>&nbsp;<span class="op" id="7006889">=</span>&nbsp;<span class="ident" id="7006891">TempDir</span><span class="op" id="7006898">(</span><span class="ident" id="7006899">dir</span><span class="op" id="7006902">,</span>&nbsp;<span class="string" id="7006904">&#34;ioutil_test&#34;</span><span class="op" id="7006917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7006920">if</span>&nbsp;<span class="ident" id="7006923">name</span>&nbsp;<span class="op" id="7006928">==</span>&nbsp;<span class="string" id="7006931">&#34;&#34;</span>&nbsp;<span class="op" id="7006934">||</span>&nbsp;<span class="ident" id="7006937">err</span>&nbsp;<span class="op" id="7006941">!=</span>&nbsp;<span class="ident" id="7006944">nil</span>&nbsp;<span class="op" id="7006948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7006952">t</span><span class="op" id="7006953">.</span><span class="ident" id="7006954">Errorf</span><span class="op" id="7006960">(</span><span class="string" id="7006961">&#34;TempDir(dir,&nbsp;`ioutil_test`)&nbsp;=&nbsp;%v,&nbsp;%v&#34;</span><span class="op" id="7006999">,</span>&nbsp;<span class="ident" id="7007001">name</span><span class="op" id="7007005">,</span>&nbsp;<span class="ident" id="7007007">err</span><span class="op" id="7007010">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007013">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7007016">if</span>&nbsp;<span class="ident" id="7007019">name</span>&nbsp;<span class="op" id="7007024">!=</span>&nbsp;<span class="string" id="7007027">&#34;&#34;</span>&nbsp;<span class="op" id="7007030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7007034">os</span><span class="op" id="7007036">.</span><span class="ident" id="7007037">Remove</span><span class="op" id="7007043">(</span><span class="ident" id="7007044">name</span><span class="op" id="7007048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7007052">re</span>&nbsp;<span class="op" id="7007055">:=</span>&nbsp;<span class="ident" id="7007058">regexp</span><span class="op" id="7007064">.</span><span class="ident" id="7007065">MustCompile</span><span class="op" id="7007076">(</span><span class="string" id="7007077">&#34;^&#34;</span>&nbsp;<span class="op" id="7007081">+</span>&nbsp;<span class="ident" id="7007083">regexp</span><span class="op" id="7007089">.</span><span class="ident" id="7007090">QuoteMeta</span><span class="op" id="7007099">(</span><span class="ident" id="7007100">filepath</span><span class="op" id="7007108">.</span><span class="ident" id="7007109">Join</span><span class="op" id="7007113">(</span><span class="ident" id="7007114">dir</span><span class="op" id="7007117">,</span>&nbsp;<span class="string" id="7007119">&#34;ioutil_test&#34;</span><span class="op" id="7007132">)</span><span class="op" id="7007133">)</span>&nbsp;<span class="op" id="7007135">+</span>&nbsp;<span class="string" id="7007137">&#34;[0-9]+$&#34;</span><span class="op" id="7007146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7007150">if</span>&nbsp;<span class="op" id="7007153">!</span><span class="ident" id="7007154">re</span><span class="op" id="7007156">.</span><span class="ident" id="7007157">MatchString</span><span class="op" id="7007168">(</span><span class="ident" id="7007169">name</span><span class="op" id="7007173">)</span>&nbsp;<span class="op" id="7007175">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7007180">t</span><span class="op" id="7007181">.</span><span class="ident" id="7007182">Errorf</span><span class="op" id="7007188">(</span><span class="string" id="7007189">&#34;TempDir(`&#34;</span><span class="op" id="7007200">+</span><span class="ident" id="7007201">dir</span><span class="op" id="7007204">+</span><span class="string" id="7007205">&#34;`,&nbsp;`ioutil_test`)&nbsp;created&nbsp;bad&nbsp;name&nbsp;%s&#34;</span><span class="op" id="7007244">,</span>&nbsp;<span class="ident" id="7007246">name</span><span class="op" id="7007250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007254">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7007257">}</span><br>
<span class="lineno"></span><span class="op" id="7007259">}</span>
</div>
</body>
</html>
