<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="5785705">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5785760">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5785814">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5785865">//&nbsp;Package&nbsp;base32&nbsp;implements&nbsp;base32&nbsp;encoding&nbsp;as&nbsp;specified&nbsp;by&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="5785936">package</span>&nbsp;<span class="ident" id="5785944">base32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5785952">import</span>&nbsp;<span class="op" id="5785959">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785962">&#34;bytes&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785971">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785977">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5785988">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="5785998">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="5786001">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encodings<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5786022">//&nbsp;An&nbsp;Encoding&nbsp;is&nbsp;a&nbsp;radix&nbsp;32&nbsp;encoding/decoding&nbsp;scheme,&nbsp;defined&nbsp;by&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="5786090">//&nbsp;32-character&nbsp;alphabet.&nbsp;&nbsp;The&nbsp;most&nbsp;common&nbsp;is&nbsp;the&nbsp;&#34;base32&#34;&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="5786158">//&nbsp;introduced&nbsp;for&nbsp;SASL&nbsp;GSSAPI&nbsp;and&nbsp;standardized&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="comment" id="5786218">//&nbsp;The&nbsp;alternate&nbsp;&#34;base32hex&#34;&nbsp;encoding&nbsp;is&nbsp;used&nbsp;in&nbsp;DNSSEC.</span><br>
<span class="lineno"></span><span class="keyword" id="5786275">type</span>&nbsp;<span class="ident" id="5786280">Encoding</span>&nbsp;<span class="keyword" id="5786289">struct</span>&nbsp;<span class="op" id="5786296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786299">encode</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5786309">string</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786317">decodeMap</span>&nbsp;<span class="op" id="5786327">[</span><span class="num" id="5786328">256</span><span class="op" id="5786331">]</span><span class="builtintype" id="5786332">byte</span><br>
<span class="lineno"></span><span class="op" id="5786337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5786340">const</span>&nbsp;<span class="ident" id="5786346">encodeStd</span>&nbsp;<span class="op" id="5786356">=</span>&nbsp;<span class="string" id="5786358">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ234567&#34;</span><br>
<span class="lineno"></span><span class="keyword" id="5786393">const</span>&nbsp;<span class="ident" id="5786399">encodeHex</span>&nbsp;<span class="op" id="5786409">=</span>&nbsp;<span class="string" id="5786411">&#34;0123456789ABCDEFGHIJKLMNOPQRSTUV&#34;</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="5786447">//&nbsp;NewEncoding&nbsp;returns&nbsp;a&nbsp;new&nbsp;Encoding&nbsp;defined&nbsp;by&nbsp;the&nbsp;given&nbsp;alphabet,</span><br>
<span class="lineno"></span><span class="comment" id="5786516">//&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;32-byte&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="5786551">func</span>&nbsp;<span class="ident" id="5786556">NewEncoding</span><span class="op" id="5786567">(</span><span class="ident" id="5786568">encoder</span>&nbsp;<span class="builtintype" id="5786576">string</span><span class="op" id="5786582">)</span>&nbsp;<span class="op" id="5786584">*</span><span class="ident" id="5786585">Encoding</span>&nbsp;<span class="op" id="5786594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786597">e</span>&nbsp;<span class="op" id="5786599">:=</span>&nbsp;<span class="builtinfunc" id="5786602">new</span><span class="op" id="5786605">(</span><span class="ident" id="5786606">Encoding</span><span class="op" id="5786614">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786617">e</span><span class="op" id="5786618">.</span><span class="ident" id="5786619">encode</span>&nbsp;<span class="op" id="5786626">=</span>&nbsp;<span class="ident" id="5786628">encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5786637">for</span>&nbsp;<span class="ident" id="5786641">i</span>&nbsp;<span class="op" id="5786643">:=</span>&nbsp;<span class="num" id="5786646">0</span><span class="op" id="5786647">;</span>&nbsp;<span class="ident" id="5786649">i</span>&nbsp;<span class="op" id="5786651">&lt;</span>&nbsp;<span class="builtinfunc" id="5786653">len</span><span class="op" id="5786656">(</span><span class="ident" id="5786657">e</span><span class="op" id="5786658">.</span><span class="ident" id="5786659">decodeMap</span><span class="op" id="5786668">)</span><span class="op" id="5786669">;</span>&nbsp;<span class="ident" id="5786671">i</span><span class="op" id="5786672">++</span>&nbsp;<span class="op" id="5786675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786679">e</span><span class="op" id="5786680">.</span><span class="ident" id="5786681">decodeMap</span><span class="op" id="5786690">[</span><span class="ident" id="5786691">i</span><span class="op" id="5786692">]</span>&nbsp;<span class="op" id="5786694">=</span>&nbsp;<span class="num" id="5786696">0xFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5786702">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5786705">for</span>&nbsp;<span class="ident" id="5786709">i</span>&nbsp;<span class="op" id="5786711">:=</span>&nbsp;<span class="num" id="5786714">0</span><span class="op" id="5786715">;</span>&nbsp;<span class="ident" id="5786717">i</span>&nbsp;<span class="op" id="5786719">&lt;</span>&nbsp;<span class="builtinfunc" id="5786721">len</span><span class="op" id="5786724">(</span><span class="ident" id="5786725">encoder</span><span class="op" id="5786732">)</span><span class="op" id="5786733">;</span>&nbsp;<span class="ident" id="5786735">i</span><span class="op" id="5786736">++</span>&nbsp;<span class="op" id="5786739">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5786743">e</span><span class="op" id="5786744">.</span><span class="ident" id="5786745">decodeMap</span><span class="op" id="5786754">[</span><span class="ident" id="5786755">encoder</span><span class="op" id="5786762">[</span><span class="ident" id="5786763">i</span><span class="op" id="5786764">]</span><span class="op" id="5786765">]</span>&nbsp;<span class="op" id="5786767">=</span>&nbsp;<span class="builtintype" id="5786769">byte</span><span class="op" id="5786773">(</span><span class="ident" id="5786774">i</span><span class="op" id="5786775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5786778">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5786781">return</span>&nbsp;<span class="ident" id="5786788">e</span><br>
<span class="lineno"></span><span class="op" id="5786790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="5786793">//&nbsp;StdEncoding&nbsp;is&nbsp;the&nbsp;standard&nbsp;base32&nbsp;encoding,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="5786855">//&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno"></span><span class="keyword" id="5786868">var</span>&nbsp;<span class="ident" id="5786872">StdEncoding</span>&nbsp;<span class="op" id="5786884">=</span>&nbsp;<span class="ident" id="5786886">NewEncoding</span><span class="op" id="5786897">(</span><span class="ident" id="5786898">encodeStd</span><span class="op" id="5786907">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5786910">//&nbsp;HexEncoding&nbsp;is&nbsp;the&nbsp;``Extended&nbsp;Hex&nbsp;Alphabet&#39;&#39;&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4648.</span><br>
<span class="lineno">50</span><span class="comment" id="5786979">//&nbsp;It&nbsp;is&nbsp;typically&nbsp;used&nbsp;in&nbsp;DNS.</span><br>
<span class="lineno"></span><span class="keyword" id="5787011">var</span>&nbsp;<span class="ident" id="5787015">HexEncoding</span>&nbsp;<span class="op" id="5787027">=</span>&nbsp;<span class="ident" id="5787029">NewEncoding</span><span class="op" id="5787040">(</span><span class="ident" id="5787041">encodeHex</span><span class="op" id="5787050">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5787053">var</span>&nbsp;<span class="ident" id="5787057">removeNewlinesMapper</span>&nbsp;<span class="op" id="5787078">=</span>&nbsp;<span class="keyword" id="5787080">func</span><span class="op" id="5787084">(</span><span class="ident" id="5787085">r</span>&nbsp;<span class="builtintype" id="5787087">rune</span><span class="op" id="5787091">)</span>&nbsp;<span class="builtintype" id="5787093">rune</span>&nbsp;<span class="op" id="5787098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787101">if</span>&nbsp;<span class="ident" id="5787104">r</span>&nbsp;<span class="op" id="5787106">==</span>&nbsp;<span class="string" id="5787109">&#39;\r&#39;</span>&nbsp;<span class="op" id="5787114">||</span>&nbsp;<span class="ident" id="5787117">r</span>&nbsp;<span class="op" id="5787119">==</span>&nbsp;<span class="string" id="5787122">&#39;\n&#39;</span>&nbsp;<span class="op" id="5787127">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787131">return</span>&nbsp;<span class="op" id="5787138">-</span><span class="num" id="5787139">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5787142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787145">return</span>&nbsp;<span class="ident" id="5787152">r</span><br>
<span class="lineno"></span><span class="op" id="5787154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span><span class="comment" id="5787157">/*<br>
<span class="lineno"></span>&nbsp;*&nbsp;Encoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5787176">//&nbsp;Encode&nbsp;encodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc,&nbsp;writing</span><br>
<span class="lineno">65</span><span class="comment" id="5787230">//&nbsp;EncodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst.</span><br>
<span class="lineno"></span><span class="comment" id="5787268">//</span><br>
<span class="lineno"></span><span class="comment" id="5787271">//&nbsp;The&nbsp;encoding&nbsp;pads&nbsp;the&nbsp;output&nbsp;to&nbsp;a&nbsp;multiple&nbsp;of&nbsp;8&nbsp;bytes,</span><br>
<span class="lineno"></span><span class="comment" id="5787329">//&nbsp;so&nbsp;Encode&nbsp;is&nbsp;not&nbsp;appropriate&nbsp;for&nbsp;use&nbsp;on&nbsp;individual&nbsp;blocks</span><br>
<span class="lineno"></span><span class="comment" id="5787390">//&nbsp;of&nbsp;a&nbsp;large&nbsp;data&nbsp;stream.&nbsp;&nbsp;Use&nbsp;NewEncoder()&nbsp;instead.</span><br>
<span class="lineno">70</span><span class="keyword" id="5787444">func</span>&nbsp;<span class="op" id="5787449">(</span><span class="ident" id="5787450">enc</span>&nbsp;<span class="op" id="5787454">*</span><span class="ident" id="5787455">Encoding</span><span class="op" id="5787463">)</span>&nbsp;<span class="ident" id="5787465">Encode</span><span class="op" id="5787471">(</span><span class="ident" id="5787472">dst</span><span class="op" id="5787475">,</span>&nbsp;<span class="ident" id="5787477">src</span>&nbsp;<span class="op" id="5787481">[</span><span class="op" id="5787482">]</span><span class="builtintype" id="5787483">byte</span><span class="op" id="5787487">)</span>&nbsp;<span class="op" id="5787489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787492">if</span>&nbsp;<span class="builtinfunc" id="5787495">len</span><span class="op" id="5787498">(</span><span class="ident" id="5787499">src</span><span class="op" id="5787502">)</span>&nbsp;<span class="op" id="5787504">==</span>&nbsp;<span class="num" id="5787507">0</span>&nbsp;<span class="op" id="5787509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787513">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5787521">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787525">for</span>&nbsp;<span class="builtinfunc" id="5787529">len</span><span class="op" id="5787532">(</span><span class="ident" id="5787533">src</span><span class="op" id="5787536">)</span>&nbsp;<span class="op" id="5787538">&gt;</span>&nbsp;<span class="num" id="5787540">0</span>&nbsp;<span class="op" id="5787542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787546">var</span>&nbsp;<span class="ident" id="5787550">b0</span><span class="op" id="5787552">,</span>&nbsp;<span class="ident" id="5787554">b1</span><span class="op" id="5787556">,</span>&nbsp;<span class="ident" id="5787558">b2</span><span class="op" id="5787560">,</span>&nbsp;<span class="ident" id="5787562">b3</span><span class="op" id="5787564">,</span>&nbsp;<span class="ident" id="5787566">b4</span><span class="op" id="5787568">,</span>&nbsp;<span class="ident" id="5787570">b5</span><span class="op" id="5787572">,</span>&nbsp;<span class="ident" id="5787574">b6</span><span class="op" id="5787576">,</span>&nbsp;<span class="ident" id="5787578">b7</span>&nbsp;<span class="builtintype" id="5787581">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5787589">//&nbsp;Unpack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;a&nbsp;5&nbsp;byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5787638">//&nbsp;destination&nbsp;quantum</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787663">switch</span>&nbsp;<span class="builtinfunc" id="5787670">len</span><span class="op" id="5787673">(</span><span class="ident" id="5787674">src</span><span class="op" id="5787677">)</span>&nbsp;<span class="op" id="5787679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787683">default</span><span class="op" id="5787690">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787695">b7</span>&nbsp;<span class="op" id="5787698">=</span>&nbsp;<span class="ident" id="5787700">src</span><span class="op" id="5787703">[</span><span class="num" id="5787704">4</span><span class="op" id="5787705">]</span>&nbsp;<span class="op" id="5787707">&amp;</span>&nbsp;<span class="num" id="5787709">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787717">b6</span>&nbsp;<span class="op" id="5787720">=</span>&nbsp;<span class="ident" id="5787722">src</span><span class="op" id="5787725">[</span><span class="num" id="5787726">4</span><span class="op" id="5787727">]</span>&nbsp;<span class="op" id="5787729">&gt;&gt;</span>&nbsp;<span class="num" id="5787732">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787737">fallthrough</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787751">case</span>&nbsp;<span class="num" id="5787756">4</span><span class="op" id="5787757">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787762">b6</span>&nbsp;<span class="op" id="5787765">|=</span>&nbsp;<span class="op" id="5787768">(</span><span class="ident" id="5787769">src</span><span class="op" id="5787772">[</span><span class="num" id="5787773">3</span><span class="op" id="5787774">]</span>&nbsp;<span class="op" id="5787776">&lt;&lt;</span>&nbsp;<span class="num" id="5787779">3</span><span class="op" id="5787780">)</span>&nbsp;<span class="op" id="5787782">&amp;</span>&nbsp;<span class="num" id="5787784">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787792">b5</span>&nbsp;<span class="op" id="5787795">=</span>&nbsp;<span class="op" id="5787797">(</span><span class="ident" id="5787798">src</span><span class="op" id="5787801">[</span><span class="num" id="5787802">3</span><span class="op" id="5787803">]</span>&nbsp;<span class="op" id="5787805">&gt;&gt;</span>&nbsp;<span class="num" id="5787808">2</span><span class="op" id="5787809">)</span>&nbsp;<span class="op" id="5787811">&amp;</span>&nbsp;<span class="num" id="5787813">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787821">b4</span>&nbsp;<span class="op" id="5787824">=</span>&nbsp;<span class="ident" id="5787826">src</span><span class="op" id="5787829">[</span><span class="num" id="5787830">3</span><span class="op" id="5787831">]</span>&nbsp;<span class="op" id="5787833">&gt;&gt;</span>&nbsp;<span class="num" id="5787836">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787841">fallthrough</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787855">case</span>&nbsp;<span class="num" id="5787860">3</span><span class="op" id="5787861">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787866">b4</span>&nbsp;<span class="op" id="5787869">|=</span>&nbsp;<span class="op" id="5787872">(</span><span class="ident" id="5787873">src</span><span class="op" id="5787876">[</span><span class="num" id="5787877">2</span><span class="op" id="5787878">]</span>&nbsp;<span class="op" id="5787880">&lt;&lt;</span>&nbsp;<span class="num" id="5787883">1</span><span class="op" id="5787884">)</span>&nbsp;<span class="op" id="5787886">&amp;</span>&nbsp;<span class="num" id="5787888">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787896">b3</span>&nbsp;<span class="op" id="5787899">=</span>&nbsp;<span class="op" id="5787901">(</span><span class="ident" id="5787902">src</span><span class="op" id="5787905">[</span><span class="num" id="5787906">2</span><span class="op" id="5787907">]</span>&nbsp;<span class="op" id="5787909">&gt;&gt;</span>&nbsp;<span class="num" id="5787912">4</span><span class="op" id="5787913">)</span>&nbsp;<span class="op" id="5787915">&amp;</span>&nbsp;<span class="num" id="5787917">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787925">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5787939">case</span>&nbsp;<span class="num" id="5787944">2</span><span class="op" id="5787945">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787950">b3</span>&nbsp;<span class="op" id="5787953">|=</span>&nbsp;<span class="op" id="5787956">(</span><span class="ident" id="5787957">src</span><span class="op" id="5787960">[</span><span class="num" id="5787961">1</span><span class="op" id="5787962">]</span>&nbsp;<span class="op" id="5787964">&lt;&lt;</span>&nbsp;<span class="num" id="5787967">4</span><span class="op" id="5787968">)</span>&nbsp;<span class="op" id="5787970">&amp;</span>&nbsp;<span class="num" id="5787972">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5787980">b2</span>&nbsp;<span class="op" id="5787983">=</span>&nbsp;<span class="op" id="5787985">(</span><span class="ident" id="5787986">src</span><span class="op" id="5787989">[</span><span class="num" id="5787990">1</span><span class="op" id="5787991">]</span>&nbsp;<span class="op" id="5787993">&gt;&gt;</span>&nbsp;<span class="num" id="5787996">1</span><span class="op" id="5787997">)</span>&nbsp;<span class="op" id="5787999">&amp;</span>&nbsp;<span class="num" id="5788001">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788009">b1</span>&nbsp;<span class="op" id="5788012">=</span>&nbsp;<span class="op" id="5788014">(</span><span class="ident" id="5788015">src</span><span class="op" id="5788018">[</span><span class="num" id="5788019">1</span><span class="op" id="5788020">]</span>&nbsp;<span class="op" id="5788022">&gt;&gt;</span>&nbsp;<span class="num" id="5788025">6</span><span class="op" id="5788026">)</span>&nbsp;<span class="op" id="5788028">&amp;</span>&nbsp;<span class="num" id="5788030">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788038">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788052">case</span>&nbsp;<span class="num" id="5788057">1</span><span class="op" id="5788058">:</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788063">b1</span>&nbsp;<span class="op" id="5788066">|=</span>&nbsp;<span class="op" id="5788069">(</span><span class="ident" id="5788070">src</span><span class="op" id="5788073">[</span><span class="num" id="5788074">0</span><span class="op" id="5788075">]</span>&nbsp;<span class="op" id="5788077">&lt;&lt;</span>&nbsp;<span class="num" id="5788080">2</span><span class="op" id="5788081">)</span>&nbsp;<span class="op" id="5788083">&amp;</span>&nbsp;<span class="num" id="5788085">0x1F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788093">b0</span>&nbsp;<span class="op" id="5788096">=</span>&nbsp;<span class="ident" id="5788098">src</span><span class="op" id="5788101">[</span><span class="num" id="5788102">0</span><span class="op" id="5788103">]</span>&nbsp;<span class="op" id="5788105">&gt;&gt;</span>&nbsp;<span class="num" id="5788108">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5788112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5788117">//&nbsp;Encode&nbsp;5-bit&nbsp;blocks&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788168">dst</span><span class="op" id="5788171">[</span><span class="num" id="5788172">0</span><span class="op" id="5788173">]</span>&nbsp;<span class="op" id="5788175">=</span>&nbsp;<span class="ident" id="5788177">enc</span><span class="op" id="5788180">.</span><span class="ident" id="5788181">encode</span><span class="op" id="5788187">[</span><span class="ident" id="5788188">b0</span><span class="op" id="5788190">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788194">dst</span><span class="op" id="5788197">[</span><span class="num" id="5788198">1</span><span class="op" id="5788199">]</span>&nbsp;<span class="op" id="5788201">=</span>&nbsp;<span class="ident" id="5788203">enc</span><span class="op" id="5788206">.</span><span class="ident" id="5788207">encode</span><span class="op" id="5788213">[</span><span class="ident" id="5788214">b1</span><span class="op" id="5788216">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788220">dst</span><span class="op" id="5788223">[</span><span class="num" id="5788224">2</span><span class="op" id="5788225">]</span>&nbsp;<span class="op" id="5788227">=</span>&nbsp;<span class="ident" id="5788229">enc</span><span class="op" id="5788232">.</span><span class="ident" id="5788233">encode</span><span class="op" id="5788239">[</span><span class="ident" id="5788240">b2</span><span class="op" id="5788242">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788246">dst</span><span class="op" id="5788249">[</span><span class="num" id="5788250">3</span><span class="op" id="5788251">]</span>&nbsp;<span class="op" id="5788253">=</span>&nbsp;<span class="ident" id="5788255">enc</span><span class="op" id="5788258">.</span><span class="ident" id="5788259">encode</span><span class="op" id="5788265">[</span><span class="ident" id="5788266">b3</span><span class="op" id="5788268">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788272">dst</span><span class="op" id="5788275">[</span><span class="num" id="5788276">4</span><span class="op" id="5788277">]</span>&nbsp;<span class="op" id="5788279">=</span>&nbsp;<span class="ident" id="5788281">enc</span><span class="op" id="5788284">.</span><span class="ident" id="5788285">encode</span><span class="op" id="5788291">[</span><span class="ident" id="5788292">b4</span><span class="op" id="5788294">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788298">dst</span><span class="op" id="5788301">[</span><span class="num" id="5788302">5</span><span class="op" id="5788303">]</span>&nbsp;<span class="op" id="5788305">=</span>&nbsp;<span class="ident" id="5788307">enc</span><span class="op" id="5788310">.</span><span class="ident" id="5788311">encode</span><span class="op" id="5788317">[</span><span class="ident" id="5788318">b5</span><span class="op" id="5788320">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788324">dst</span><span class="op" id="5788327">[</span><span class="num" id="5788328">6</span><span class="op" id="5788329">]</span>&nbsp;<span class="op" id="5788331">=</span>&nbsp;<span class="ident" id="5788333">enc</span><span class="op" id="5788336">.</span><span class="ident" id="5788337">encode</span><span class="op" id="5788343">[</span><span class="ident" id="5788344">b6</span><span class="op" id="5788346">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788350">dst</span><span class="op" id="5788353">[</span><span class="num" id="5788354">7</span><span class="op" id="5788355">]</span>&nbsp;<span class="op" id="5788357">=</span>&nbsp;<span class="ident" id="5788359">enc</span><span class="op" id="5788362">.</span><span class="ident" id="5788363">encode</span><span class="op" id="5788369">[</span><span class="ident" id="5788370">b7</span><span class="op" id="5788372">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5788377">//&nbsp;Pad&nbsp;the&nbsp;final&nbsp;quantum</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788404">if</span>&nbsp;<span class="builtinfunc" id="5788407">len</span><span class="op" id="5788410">(</span><span class="ident" id="5788411">src</span><span class="op" id="5788414">)</span>&nbsp;<span class="op" id="5788416">&lt;</span>&nbsp;<span class="num" id="5788418">5</span>&nbsp;<span class="op" id="5788420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788425">dst</span><span class="op" id="5788428">[</span><span class="num" id="5788429">7</span><span class="op" id="5788430">]</span>&nbsp;<span class="op" id="5788432">=</span>&nbsp;<span class="string" id="5788434">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788441">if</span>&nbsp;<span class="builtinfunc" id="5788444">len</span><span class="op" id="5788447">(</span><span class="ident" id="5788448">src</span><span class="op" id="5788451">)</span>&nbsp;<span class="op" id="5788453">&lt;</span>&nbsp;<span class="num" id="5788455">4</span>&nbsp;<span class="op" id="5788457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788463">dst</span><span class="op" id="5788466">[</span><span class="num" id="5788467">6</span><span class="op" id="5788468">]</span>&nbsp;<span class="op" id="5788470">=</span>&nbsp;<span class="string" id="5788472">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788480">dst</span><span class="op" id="5788483">[</span><span class="num" id="5788484">5</span><span class="op" id="5788485">]</span>&nbsp;<span class="op" id="5788487">=</span>&nbsp;<span class="string" id="5788489">&#39;=&#39;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788497">if</span>&nbsp;<span class="builtinfunc" id="5788500">len</span><span class="op" id="5788503">(</span><span class="ident" id="5788504">src</span><span class="op" id="5788507">)</span>&nbsp;<span class="op" id="5788509">&lt;</span>&nbsp;<span class="num" id="5788511">3</span>&nbsp;<span class="op" id="5788513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788520">dst</span><span class="op" id="5788523">[</span><span class="num" id="5788524">4</span><span class="op" id="5788525">]</span>&nbsp;<span class="op" id="5788527">=</span>&nbsp;<span class="string" id="5788529">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788538">if</span>&nbsp;<span class="builtinfunc" id="5788541">len</span><span class="op" id="5788544">(</span><span class="ident" id="5788545">src</span><span class="op" id="5788548">)</span>&nbsp;<span class="op" id="5788550">&lt;</span>&nbsp;<span class="num" id="5788552">2</span>&nbsp;<span class="op" id="5788554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788562">dst</span><span class="op" id="5788565">[</span><span class="num" id="5788566">3</span><span class="op" id="5788567">]</span>&nbsp;<span class="op" id="5788569">=</span>&nbsp;<span class="string" id="5788571">&#39;=&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788581">dst</span><span class="op" id="5788584">[</span><span class="num" id="5788585">2</span><span class="op" id="5788586">]</span>&nbsp;<span class="op" id="5788588">=</span>&nbsp;<span class="string" id="5788590">&#39;=&#39;</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5788599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5788605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5788610">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788615">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5788623">}</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788627">src</span>&nbsp;<span class="op" id="5788631">=</span>&nbsp;<span class="ident" id="5788633">src</span><span class="op" id="5788636">[</span><span class="num" id="5788637">5</span><span class="op" id="5788638">:</span><span class="op" id="5788639">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788643">dst</span>&nbsp;<span class="op" id="5788647">=</span>&nbsp;<span class="ident" id="5788649">dst</span><span class="op" id="5788652">[</span><span class="num" id="5788653">8</span><span class="op" id="5788654">:</span><span class="op" id="5788655">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5788658">}</span><br>
<span class="lineno"></span><span class="op" id="5788660">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="5788663">//&nbsp;EncodeToString&nbsp;returns&nbsp;the&nbsp;base32&nbsp;encoding&nbsp;of&nbsp;src.</span><br>
<span class="lineno"></span><span class="keyword" id="5788717">func</span>&nbsp;<span class="op" id="5788722">(</span><span class="ident" id="5788723">enc</span>&nbsp;<span class="op" id="5788727">*</span><span class="ident" id="5788728">Encoding</span><span class="op" id="5788736">)</span>&nbsp;<span class="ident" id="5788738">EncodeToString</span><span class="op" id="5788752">(</span><span class="ident" id="5788753">src</span>&nbsp;<span class="op" id="5788757">[</span><span class="op" id="5788758">]</span><span class="builtintype" id="5788759">byte</span><span class="op" id="5788763">)</span>&nbsp;<span class="builtintype" id="5788765">string</span>&nbsp;<span class="op" id="5788772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788775">buf</span>&nbsp;<span class="op" id="5788779">:=</span>&nbsp;<span class="builtinfunc" id="5788782">make</span><span class="op" id="5788786">(</span><span class="op" id="5788787">[</span><span class="op" id="5788788">]</span><span class="builtintype" id="5788789">byte</span><span class="op" id="5788793">,</span>&nbsp;<span class="ident" id="5788795">enc</span><span class="op" id="5788798">.</span><span class="ident" id="5788799">EncodedLen</span><span class="op" id="5788809">(</span><span class="builtinfunc" id="5788810">len</span><span class="op" id="5788813">(</span><span class="ident" id="5788814">src</span><span class="op" id="5788817">)</span><span class="op" id="5788818">)</span><span class="op" id="5788819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788822">enc</span><span class="op" id="5788825">.</span><span class="ident" id="5788826">Encode</span><span class="op" id="5788832">(</span><span class="ident" id="5788833">buf</span><span class="op" id="5788836">,</span>&nbsp;<span class="ident" id="5788838">src</span><span class="op" id="5788841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5788844">return</span>&nbsp;<span class="builtintype" id="5788851">string</span><span class="op" id="5788857">(</span><span class="ident" id="5788858">buf</span><span class="op" id="5788861">)</span><br>
<span class="lineno">140</span><span class="op" id="5788863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5788866">type</span>&nbsp;<span class="ident" id="5788871">encoder</span>&nbsp;<span class="keyword" id="5788879">struct</span>&nbsp;<span class="op" id="5788886">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788889">err</span>&nbsp;&nbsp;<span class="builtintype" id="5788894">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788901">enc</span>&nbsp;&nbsp;<span class="op" id="5788906">*</span><span class="ident" id="5788907">Encoding</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788917">w</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5788922">io</span><span class="op" id="5788924">.</span><span class="ident" id="5788925">Writer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788933">buf</span>&nbsp;&nbsp;<span class="op" id="5788938">[</span><span class="num" id="5788939">5</span><span class="op" id="5788940">]</span><span class="builtintype" id="5788941">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5788949">//&nbsp;buffered&nbsp;data&nbsp;waiting&nbsp;to&nbsp;be&nbsp;encoded</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5788989">nbuf</span>&nbsp;<span class="builtintype" id="5788994">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5789005">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;in&nbsp;buf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789032">out</span>&nbsp;&nbsp;<span class="op" id="5789037">[</span><span class="num" id="5789038">1024</span><span class="op" id="5789042">]</span><span class="builtintype" id="5789043">byte</span>&nbsp;<span class="comment" id="5789048">//&nbsp;output&nbsp;buffer</span><br>
<span class="lineno"></span><span class="op" id="5789065">}</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span><span class="keyword" id="5789068">func</span>&nbsp;<span class="op" id="5789073">(</span><span class="ident" id="5789074">e</span>&nbsp;<span class="op" id="5789076">*</span><span class="ident" id="5789077">encoder</span><span class="op" id="5789084">)</span>&nbsp;<span class="ident" id="5789086">Write</span><span class="op" id="5789091">(</span><span class="ident" id="5789092">p</span>&nbsp;<span class="op" id="5789094">[</span><span class="op" id="5789095">]</span><span class="builtintype" id="5789096">byte</span><span class="op" id="5789100">)</span>&nbsp;<span class="op" id="5789102">(</span><span class="ident" id="5789103">n</span>&nbsp;<span class="builtintype" id="5789105">int</span><span class="op" id="5789108">,</span>&nbsp;<span class="ident" id="5789110">err</span>&nbsp;<span class="builtintype" id="5789114">error</span><span class="op" id="5789119">)</span>&nbsp;<span class="op" id="5789121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789124">if</span>&nbsp;<span class="ident" id="5789127">e</span><span class="op" id="5789128">.</span><span class="ident" id="5789129">err</span>&nbsp;<span class="op" id="5789133">!=</span>&nbsp;<span class="ident" id="5789136">nil</span>&nbsp;<span class="op" id="5789140">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789144">return</span>&nbsp;<span class="num" id="5789151">0</span><span class="op" id="5789152">,</span>&nbsp;<span class="ident" id="5789154">e</span><span class="op" id="5789155">.</span><span class="ident" id="5789156">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789161">}</span><br>
<span class="lineno">155</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5789165">//&nbsp;Leading&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789185">if</span>&nbsp;<span class="ident" id="5789188">e</span><span class="op" id="5789189">.</span><span class="ident" id="5789190">nbuf</span>&nbsp;<span class="op" id="5789195">&gt;</span>&nbsp;<span class="num" id="5789197">0</span>&nbsp;<span class="op" id="5789199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789203">var</span>&nbsp;<span class="ident" id="5789207">i</span>&nbsp;<span class="builtintype" id="5789209">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789215">for</span>&nbsp;<span class="ident" id="5789219">i</span>&nbsp;<span class="op" id="5789221">=</span>&nbsp;<span class="num" id="5789223">0</span><span class="op" id="5789224">;</span>&nbsp;<span class="ident" id="5789226">i</span>&nbsp;<span class="op" id="5789228">&lt;</span>&nbsp;<span class="builtinfunc" id="5789230">len</span><span class="op" id="5789233">(</span><span class="ident" id="5789234">p</span><span class="op" id="5789235">)</span>&nbsp;<span class="op" id="5789237">&amp;&amp;</span>&nbsp;<span class="ident" id="5789240">e</span><span class="op" id="5789241">.</span><span class="ident" id="5789242">nbuf</span>&nbsp;<span class="op" id="5789247">&lt;</span>&nbsp;<span class="num" id="5789249">5</span><span class="op" id="5789250">;</span>&nbsp;<span class="ident" id="5789252">i</span><span class="op" id="5789253">++</span>&nbsp;<span class="op" id="5789256">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789261">e</span><span class="op" id="5789262">.</span><span class="ident" id="5789263">buf</span><span class="op" id="5789266">[</span><span class="ident" id="5789267">e</span><span class="op" id="5789268">.</span><span class="ident" id="5789269">nbuf</span><span class="op" id="5789273">]</span>&nbsp;<span class="op" id="5789275">=</span>&nbsp;<span class="ident" id="5789277">p</span><span class="op" id="5789278">[</span><span class="ident" id="5789279">i</span><span class="op" id="5789280">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789285">e</span><span class="op" id="5789286">.</span><span class="ident" id="5789287">nbuf</span><span class="op" id="5789291">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789296">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789300">n</span>&nbsp;<span class="op" id="5789302">+=</span>&nbsp;<span class="ident" id="5789305">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789309">p</span>&nbsp;<span class="op" id="5789311">=</span>&nbsp;<span class="ident" id="5789313">p</span><span class="op" id="5789314">[</span><span class="ident" id="5789315">i</span><span class="op" id="5789316">:</span><span class="op" id="5789317">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789321">if</span>&nbsp;<span class="ident" id="5789324">e</span><span class="op" id="5789325">.</span><span class="ident" id="5789326">nbuf</span>&nbsp;<span class="op" id="5789331">&lt;</span>&nbsp;<span class="num" id="5789333">5</span>&nbsp;<span class="op" id="5789335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789340">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789349">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789353">e</span><span class="op" id="5789354">.</span><span class="ident" id="5789355">enc</span><span class="op" id="5789358">.</span><span class="ident" id="5789359">Encode</span><span class="op" id="5789365">(</span><span class="ident" id="5789366">e</span><span class="op" id="5789367">.</span><span class="ident" id="5789368">out</span><span class="op" id="5789371">[</span><span class="num" id="5789372">0</span><span class="op" id="5789373">:</span><span class="op" id="5789374">]</span><span class="op" id="5789375">,</span>&nbsp;<span class="ident" id="5789377">e</span><span class="op" id="5789378">.</span><span class="ident" id="5789379">buf</span><span class="op" id="5789382">[</span><span class="num" id="5789383">0</span><span class="op" id="5789384">:</span><span class="op" id="5789385">]</span><span class="op" id="5789386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789390">if</span>&nbsp;<span class="ident" id="5789393">_</span><span class="op" id="5789394">,</span>&nbsp;<span class="ident" id="5789396">e</span><span class="op" id="5789397">.</span><span class="ident" id="5789398">err</span>&nbsp;<span class="op" id="5789402">=</span>&nbsp;<span class="ident" id="5789404">e</span><span class="op" id="5789405">.</span><span class="ident" id="5789406">w</span><span class="op" id="5789407">.</span><span class="ident" id="5789408">Write</span><span class="op" id="5789413">(</span><span class="ident" id="5789414">e</span><span class="op" id="5789415">.</span><span class="ident" id="5789416">out</span><span class="op" id="5789419">[</span><span class="num" id="5789420">0</span><span class="op" id="5789421">:</span><span class="num" id="5789422">8</span><span class="op" id="5789423">]</span><span class="op" id="5789424">)</span><span class="op" id="5789425">;</span>&nbsp;<span class="ident" id="5789427">e</span><span class="op" id="5789428">.</span><span class="ident" id="5789429">err</span>&nbsp;<span class="op" id="5789433">!=</span>&nbsp;<span class="ident" id="5789436">nil</span>&nbsp;<span class="op" id="5789440">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789445">return</span>&nbsp;<span class="ident" id="5789452">n</span><span class="op" id="5789453">,</span>&nbsp;<span class="ident" id="5789455">e</span><span class="op" id="5789456">.</span><span class="ident" id="5789457">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789467">e</span><span class="op" id="5789468">.</span><span class="ident" id="5789469">nbuf</span>&nbsp;<span class="op" id="5789474">=</span>&nbsp;<span class="num" id="5789476">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5789483">//&nbsp;Large&nbsp;interior&nbsp;chunks.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789510">for</span>&nbsp;<span class="builtinfunc" id="5789514">len</span><span class="op" id="5789517">(</span><span class="ident" id="5789518">p</span><span class="op" id="5789519">)</span>&nbsp;<span class="op" id="5789521">&gt;=</span>&nbsp;<span class="num" id="5789524">5</span>&nbsp;<span class="op" id="5789526">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789530">nn</span>&nbsp;<span class="op" id="5789533">:=</span>&nbsp;<span class="builtinfunc" id="5789536">len</span><span class="op" id="5789539">(</span><span class="ident" id="5789540">e</span><span class="op" id="5789541">.</span><span class="ident" id="5789542">out</span><span class="op" id="5789545">)</span>&nbsp;<span class="op" id="5789547">/</span>&nbsp;<span class="num" id="5789549">8</span>&nbsp;<span class="op" id="5789551">*</span>&nbsp;<span class="num" id="5789553">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789557">if</span>&nbsp;<span class="ident" id="5789560">nn</span>&nbsp;<span class="op" id="5789563">&gt;</span>&nbsp;<span class="builtinfunc" id="5789565">len</span><span class="op" id="5789568">(</span><span class="ident" id="5789569">p</span><span class="op" id="5789570">)</span>&nbsp;<span class="op" id="5789572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789577">nn</span>&nbsp;<span class="op" id="5789580">=</span>&nbsp;<span class="builtinfunc" id="5789582">len</span><span class="op" id="5789585">(</span><span class="ident" id="5789586">p</span><span class="op" id="5789587">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789592">nn</span>&nbsp;<span class="op" id="5789595">-=</span>&nbsp;<span class="ident" id="5789598">nn</span>&nbsp;<span class="op" id="5789601">%</span>&nbsp;<span class="num" id="5789603">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789611">e</span><span class="op" id="5789612">.</span><span class="ident" id="5789613">enc</span><span class="op" id="5789616">.</span><span class="ident" id="5789617">Encode</span><span class="op" id="5789623">(</span><span class="ident" id="5789624">e</span><span class="op" id="5789625">.</span><span class="ident" id="5789626">out</span><span class="op" id="5789629">[</span><span class="num" id="5789630">0</span><span class="op" id="5789631">:</span><span class="op" id="5789632">]</span><span class="op" id="5789633">,</span>&nbsp;<span class="ident" id="5789635">p</span><span class="op" id="5789636">[</span><span class="num" id="5789637">0</span><span class="op" id="5789638">:</span><span class="ident" id="5789639">nn</span><span class="op" id="5789641">]</span><span class="op" id="5789642">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789646">if</span>&nbsp;<span class="ident" id="5789649">_</span><span class="op" id="5789650">,</span>&nbsp;<span class="ident" id="5789652">e</span><span class="op" id="5789653">.</span><span class="ident" id="5789654">err</span>&nbsp;<span class="op" id="5789658">=</span>&nbsp;<span class="ident" id="5789660">e</span><span class="op" id="5789661">.</span><span class="ident" id="5789662">w</span><span class="op" id="5789663">.</span><span class="ident" id="5789664">Write</span><span class="op" id="5789669">(</span><span class="ident" id="5789670">e</span><span class="op" id="5789671">.</span><span class="ident" id="5789672">out</span><span class="op" id="5789675">[</span><span class="num" id="5789676">0</span>&nbsp;<span class="op" id="5789678">:</span>&nbsp;<span class="ident" id="5789680">nn</span><span class="op" id="5789682">/</span><span class="num" id="5789683">5</span><span class="op" id="5789684">*</span><span class="num" id="5789685">8</span><span class="op" id="5789686">]</span><span class="op" id="5789687">)</span><span class="op" id="5789688">;</span>&nbsp;<span class="ident" id="5789690">e</span><span class="op" id="5789691">.</span><span class="ident" id="5789692">err</span>&nbsp;<span class="op" id="5789696">!=</span>&nbsp;<span class="ident" id="5789699">nil</span>&nbsp;<span class="op" id="5789703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789708">return</span>&nbsp;<span class="ident" id="5789715">n</span><span class="op" id="5789716">,</span>&nbsp;<span class="ident" id="5789718">e</span><span class="op" id="5789719">.</span><span class="ident" id="5789720">err</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789726">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789730">n</span>&nbsp;<span class="op" id="5789732">+=</span>&nbsp;<span class="ident" id="5789735">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789740">p</span>&nbsp;<span class="op" id="5789742">=</span>&nbsp;<span class="ident" id="5789744">p</span><span class="op" id="5789745">[</span><span class="ident" id="5789746">nn</span><span class="op" id="5789748">:</span><span class="op" id="5789749">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789752">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5789756">//&nbsp;Trailing&nbsp;fringe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789777">for</span>&nbsp;<span class="ident" id="5789781">i</span>&nbsp;<span class="op" id="5789783">:=</span>&nbsp;<span class="num" id="5789786">0</span><span class="op" id="5789787">;</span>&nbsp;<span class="ident" id="5789789">i</span>&nbsp;<span class="op" id="5789791">&lt;</span>&nbsp;<span class="builtinfunc" id="5789793">len</span><span class="op" id="5789796">(</span><span class="ident" id="5789797">p</span><span class="op" id="5789798">)</span><span class="op" id="5789799">;</span>&nbsp;<span class="ident" id="5789801">i</span><span class="op" id="5789802">++</span>&nbsp;<span class="op" id="5789805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789809">e</span><span class="op" id="5789810">.</span><span class="ident" id="5789811">buf</span><span class="op" id="5789814">[</span><span class="ident" id="5789815">i</span><span class="op" id="5789816">]</span>&nbsp;<span class="op" id="5789818">=</span>&nbsp;<span class="ident" id="5789820">p</span><span class="op" id="5789821">[</span><span class="ident" id="5789822">i</span><span class="op" id="5789823">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5789826">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789829">e</span><span class="op" id="5789830">.</span><span class="ident" id="5789831">nbuf</span>&nbsp;<span class="op" id="5789836">=</span>&nbsp;<span class="builtinfunc" id="5789838">len</span><span class="op" id="5789841">(</span><span class="ident" id="5789842">p</span><span class="op" id="5789843">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5789846">n</span>&nbsp;<span class="op" id="5789848">+=</span>&nbsp;<span class="builtinfunc" id="5789851">len</span><span class="op" id="5789854">(</span><span class="ident" id="5789855">p</span><span class="op" id="5789856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5789859">return</span><br>
<span class="lineno"></span><span class="op" id="5789866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5789869">//&nbsp;Close&nbsp;flushes&nbsp;any&nbsp;pending&nbsp;output&nbsp;from&nbsp;the&nbsp;encoder.</span><br>
<span class="lineno">200</span><span class="comment" id="5789923">//&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;to&nbsp;call&nbsp;Write&nbsp;after&nbsp;calling&nbsp;Close.</span><br>
<span class="lineno"></span><span class="keyword" id="5789976">func</span>&nbsp;<span class="op" id="5789981">(</span><span class="ident" id="5789982">e</span>&nbsp;<span class="op" id="5789984">*</span><span class="ident" id="5789985">encoder</span><span class="op" id="5789992">)</span>&nbsp;<span class="ident" id="5789994">Close</span><span class="op" id="5789999">(</span><span class="op" id="5790000">)</span>&nbsp;<span class="builtintype" id="5790002">error</span>&nbsp;<span class="op" id="5790008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5790011">//&nbsp;If&nbsp;there&#39;s&nbsp;anything&nbsp;left&nbsp;in&nbsp;the&nbsp;buffer,&nbsp;flush&nbsp;it&nbsp;out</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5790068">if</span>&nbsp;<span class="ident" id="5790071">e</span><span class="op" id="5790072">.</span><span class="ident" id="5790073">err</span>&nbsp;<span class="op" id="5790077">==</span>&nbsp;<span class="ident" id="5790080">nil</span>&nbsp;<span class="op" id="5790084">&amp;&amp;</span>&nbsp;<span class="ident" id="5790087">e</span><span class="op" id="5790088">.</span><span class="ident" id="5790089">nbuf</span>&nbsp;<span class="op" id="5790094">&gt;</span>&nbsp;<span class="num" id="5790096">0</span>&nbsp;<span class="op" id="5790098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5790102">e</span><span class="op" id="5790103">.</span><span class="ident" id="5790104">enc</span><span class="op" id="5790107">.</span><span class="ident" id="5790108">Encode</span><span class="op" id="5790114">(</span><span class="ident" id="5790115">e</span><span class="op" id="5790116">.</span><span class="ident" id="5790117">out</span><span class="op" id="5790120">[</span><span class="num" id="5790121">0</span><span class="op" id="5790122">:</span><span class="op" id="5790123">]</span><span class="op" id="5790124">,</span>&nbsp;<span class="ident" id="5790126">e</span><span class="op" id="5790127">.</span><span class="ident" id="5790128">buf</span><span class="op" id="5790131">[</span><span class="num" id="5790132">0</span><span class="op" id="5790133">:</span><span class="ident" id="5790134">e</span><span class="op" id="5790135">.</span><span class="ident" id="5790136">nbuf</span><span class="op" id="5790140">]</span><span class="op" id="5790141">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5790145">e</span><span class="op" id="5790146">.</span><span class="ident" id="5790147">nbuf</span>&nbsp;<span class="op" id="5790152">=</span>&nbsp;<span class="num" id="5790154">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5790158">_</span><span class="op" id="5790159">,</span>&nbsp;<span class="ident" id="5790161">e</span><span class="op" id="5790162">.</span><span class="ident" id="5790163">err</span>&nbsp;<span class="op" id="5790167">=</span>&nbsp;<span class="ident" id="5790169">e</span><span class="op" id="5790170">.</span><span class="ident" id="5790171">w</span><span class="op" id="5790172">.</span><span class="ident" id="5790173">Write</span><span class="op" id="5790178">(</span><span class="ident" id="5790179">e</span><span class="op" id="5790180">.</span><span class="ident" id="5790181">out</span><span class="op" id="5790184">[</span><span class="num" id="5790185">0</span><span class="op" id="5790186">:</span><span class="num" id="5790187">8</span><span class="op" id="5790188">]</span><span class="op" id="5790189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5790192">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5790195">return</span>&nbsp;<span class="ident" id="5790202">e</span><span class="op" id="5790203">.</span><span class="ident" id="5790204">err</span><br>
<span class="lineno"></span><span class="op" id="5790208">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="5790211">//&nbsp;NewEncoder&nbsp;returns&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;encoder.&nbsp;&nbsp;Data&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5790279">//&nbsp;the&nbsp;returned&nbsp;writer&nbsp;will&nbsp;be&nbsp;encoded&nbsp;using&nbsp;enc&nbsp;and&nbsp;then&nbsp;written&nbsp;to&nbsp;w.</span><br>
<span class="lineno"></span><span class="comment" id="5790351">//&nbsp;Base32&nbsp;encodings&nbsp;operate&nbsp;in&nbsp;5-byte&nbsp;blocks;&nbsp;when&nbsp;finished</span><br>
<span class="lineno"></span><span class="comment" id="5790411">//&nbsp;writing,&nbsp;the&nbsp;caller&nbsp;must&nbsp;Close&nbsp;the&nbsp;returned&nbsp;encoder&nbsp;to&nbsp;flush&nbsp;any</span><br>
<span class="lineno">215</span><span class="comment" id="5790479">//&nbsp;partially&nbsp;written&nbsp;blocks.</span><br>
<span class="lineno"></span><span class="keyword" id="5790508">func</span>&nbsp;<span class="ident" id="5790513">NewEncoder</span><span class="op" id="5790523">(</span><span class="ident" id="5790524">enc</span>&nbsp;<span class="op" id="5790528">*</span><span class="ident" id="5790529">Encoding</span><span class="op" id="5790537">,</span>&nbsp;<span class="ident" id="5790539">w</span>&nbsp;<span class="ident" id="5790541">io</span><span class="op" id="5790543">.</span><span class="ident" id="5790544">Writer</span><span class="op" id="5790550">)</span>&nbsp;<span class="ident" id="5790552">io</span><span class="op" id="5790554">.</span><span class="ident" id="5790555">WriteCloser</span>&nbsp;<span class="op" id="5790567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5790570">return</span>&nbsp;<span class="op" id="5790577">&amp;</span><span class="ident" id="5790578">encoder</span><span class="op" id="5790585">{</span><span class="ident" id="5790586">enc</span><span class="op" id="5790589">:</span>&nbsp;<span class="ident" id="5790591">enc</span><span class="op" id="5790594">,</span>&nbsp;<span class="ident" id="5790596">w</span><span class="op" id="5790597">:</span>&nbsp;<span class="ident" id="5790599">w</span><span class="op" id="5790600">}</span><br>
<span class="lineno"></span><span class="op" id="5790602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="5790605">//&nbsp;EncodedLen&nbsp;returns&nbsp;the&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;base32&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="5790670">//&nbsp;of&nbsp;an&nbsp;input&nbsp;buffer&nbsp;of&nbsp;length&nbsp;n.</span><br>
<span class="lineno"></span><span class="keyword" id="5790705">func</span>&nbsp;<span class="op" id="5790710">(</span><span class="ident" id="5790711">enc</span>&nbsp;<span class="op" id="5790715">*</span><span class="ident" id="5790716">Encoding</span><span class="op" id="5790724">)</span>&nbsp;<span class="ident" id="5790726">EncodedLen</span><span class="op" id="5790736">(</span><span class="ident" id="5790737">n</span>&nbsp;<span class="builtintype" id="5790739">int</span><span class="op" id="5790742">)</span>&nbsp;<span class="builtintype" id="5790744">int</span>&nbsp;<span class="op" id="5790748">{</span>&nbsp;<span class="keyword" id="5790750">return</span>&nbsp;<span class="op" id="5790757">(</span><span class="ident" id="5790758">n</span>&nbsp;<span class="op" id="5790760">+</span>&nbsp;<span class="num" id="5790762">4</span><span class="op" id="5790763">)</span>&nbsp;<span class="op" id="5790765">/</span>&nbsp;<span class="num" id="5790767">5</span>&nbsp;<span class="op" id="5790769">*</span>&nbsp;<span class="num" id="5790771">8</span>&nbsp;<span class="op" id="5790773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5790776">/*<br>
<span class="lineno">225</span>&nbsp;*&nbsp;Decoder<br>
<span class="lineno"></span>&nbsp;*/</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5790795">type</span>&nbsp;<span class="ident" id="5790800">CorruptInputError</span>&nbsp;<span class="ident" id="5790818">int64</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span><span class="keyword" id="5790825">func</span>&nbsp;<span class="op" id="5790830">(</span><span class="ident" id="5790831">e</span>&nbsp;<span class="ident" id="5790833">CorruptInputError</span><span class="op" id="5790850">)</span>&nbsp;<span class="ident" id="5790852">Error</span><span class="op" id="5790857">(</span><span class="op" id="5790858">)</span>&nbsp;<span class="builtintype" id="5790860">string</span>&nbsp;<span class="op" id="5790867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5790870">return</span>&nbsp;<span class="string" id="5790877">&#34;illegal&nbsp;base32&nbsp;data&nbsp;at&nbsp;input&nbsp;byte&nbsp;&#34;</span>&nbsp;<span class="op" id="5790914">+</span>&nbsp;<span class="ident" id="5790916">strconv</span><span class="op" id="5790923">.</span><span class="ident" id="5790924">FormatInt</span><span class="op" id="5790933">(</span><span class="ident" id="5790934">int64</span><span class="op" id="5790939">(</span><span class="ident" id="5790940">e</span><span class="op" id="5790941">)</span><span class="op" id="5790942">,</span>&nbsp;<span class="num" id="5790944">10</span><span class="op" id="5790946">)</span><br>
<span class="lineno"></span><span class="op" id="5790948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5790951">//&nbsp;decode&nbsp;is&nbsp;like&nbsp;Decode&nbsp;but&nbsp;returns&nbsp;an&nbsp;additional&nbsp;&#39;end&#39;&nbsp;value,&nbsp;which</span><br>
<span class="lineno">235</span><span class="comment" id="5791021">//&nbsp;indicates&nbsp;if&nbsp;end-of-message&nbsp;padding&nbsp;was&nbsp;encountered&nbsp;and&nbsp;thus&nbsp;any</span><br>
<span class="lineno"></span><span class="comment" id="5791089">//&nbsp;additional&nbsp;data&nbsp;is&nbsp;an&nbsp;error.&nbsp;This&nbsp;method&nbsp;assumes&nbsp;that&nbsp;src&nbsp;has&nbsp;been</span><br>
<span class="lineno"></span><span class="comment" id="5791159">//&nbsp;stripped&nbsp;of&nbsp;all&nbsp;supported&nbsp;whitespace&nbsp;(&#39;\r&#39;&nbsp;and&nbsp;&#39;\n&#39;).</span><br>
<span class="lineno"></span><span class="keyword" id="5791216">func</span>&nbsp;<span class="op" id="5791221">(</span><span class="ident" id="5791222">enc</span>&nbsp;<span class="op" id="5791226">*</span><span class="ident" id="5791227">Encoding</span><span class="op" id="5791235">)</span>&nbsp;<span class="ident" id="5791237">decode</span><span class="op" id="5791243">(</span><span class="ident" id="5791244">dst</span><span class="op" id="5791247">,</span>&nbsp;<span class="ident" id="5791249">src</span>&nbsp;<span class="op" id="5791253">[</span><span class="op" id="5791254">]</span><span class="builtintype" id="5791255">byte</span><span class="op" id="5791259">)</span>&nbsp;<span class="op" id="5791261">(</span><span class="ident" id="5791262">n</span>&nbsp;<span class="builtintype" id="5791264">int</span><span class="op" id="5791267">,</span>&nbsp;<span class="ident" id="5791269">end</span>&nbsp;<span class="builtintype" id="5791273">bool</span><span class="op" id="5791277">,</span>&nbsp;<span class="ident" id="5791279">err</span>&nbsp;<span class="builtintype" id="5791283">error</span><span class="op" id="5791288">)</span>&nbsp;<span class="op" id="5791290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791293">olen</span>&nbsp;<span class="op" id="5791298">:=</span>&nbsp;<span class="builtinfunc" id="5791301">len</span><span class="op" id="5791304">(</span><span class="ident" id="5791305">src</span><span class="op" id="5791308">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791311">for</span>&nbsp;<span class="builtinfunc" id="5791315">len</span><span class="op" id="5791318">(</span><span class="ident" id="5791319">src</span><span class="op" id="5791322">)</span>&nbsp;<span class="op" id="5791324">&gt;</span>&nbsp;<span class="num" id="5791326">0</span>&nbsp;<span class="op" id="5791328">&amp;&amp;</span>&nbsp;<span class="op" id="5791331">!</span><span class="ident" id="5791332">end</span>&nbsp;<span class="op" id="5791336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5791340">//&nbsp;Decode&nbsp;quantum&nbsp;using&nbsp;the&nbsp;base32&nbsp;alphabet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791386">var</span>&nbsp;<span class="ident" id="5791390">dbuf</span>&nbsp;<span class="op" id="5791395">[</span><span class="num" id="5791396">8</span><span class="op" id="5791397">]</span><span class="builtintype" id="5791398">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791405">dlen</span>&nbsp;<span class="op" id="5791410">:=</span>&nbsp;<span class="num" id="5791413">8</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791418">for</span>&nbsp;<span class="ident" id="5791422">j</span>&nbsp;<span class="op" id="5791424">:=</span>&nbsp;<span class="num" id="5791427">0</span><span class="op" id="5791428">;</span>&nbsp;<span class="ident" id="5791430">j</span>&nbsp;<span class="op" id="5791432">&lt;</span>&nbsp;<span class="num" id="5791434">8</span><span class="op" id="5791435">;</span>&nbsp;<span class="op" id="5791437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791442">if</span>&nbsp;<span class="builtinfunc" id="5791445">len</span><span class="op" id="5791448">(</span><span class="ident" id="5791449">src</span><span class="op" id="5791452">)</span>&nbsp;<span class="op" id="5791454">==</span>&nbsp;<span class="num" id="5791457">0</span>&nbsp;<span class="op" id="5791459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791465">return</span>&nbsp;<span class="ident" id="5791472">n</span><span class="op" id="5791473">,</span>&nbsp;<span class="ident" id="5791475">false</span><span class="op" id="5791480">,</span>&nbsp;<span class="ident" id="5791482">CorruptInputError</span><span class="op" id="5791499">(</span><span class="ident" id="5791500">olen</span>&nbsp;<span class="op" id="5791505">-</span>&nbsp;<span class="builtinfunc" id="5791507">len</span><span class="op" id="5791510">(</span><span class="ident" id="5791511">src</span><span class="op" id="5791514">)</span>&nbsp;<span class="op" id="5791516">-</span>&nbsp;<span class="ident" id="5791518">j</span><span class="op" id="5791519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5791524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791529">in</span>&nbsp;<span class="op" id="5791532">:=</span>&nbsp;<span class="ident" id="5791535">src</span><span class="op" id="5791538">[</span><span class="num" id="5791539">0</span><span class="op" id="5791540">]</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791545">src</span>&nbsp;<span class="op" id="5791549">=</span>&nbsp;<span class="ident" id="5791551">src</span><span class="op" id="5791554">[</span><span class="num" id="5791555">1</span><span class="op" id="5791556">:</span><span class="op" id="5791557">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791562">if</span>&nbsp;<span class="ident" id="5791565">in</span>&nbsp;<span class="op" id="5791568">==</span>&nbsp;<span class="string" id="5791571">&#39;=&#39;</span>&nbsp;<span class="op" id="5791575">&amp;&amp;</span>&nbsp;<span class="ident" id="5791578">j</span>&nbsp;<span class="op" id="5791580">&gt;=</span>&nbsp;<span class="num" id="5791583">2</span>&nbsp;<span class="op" id="5791585">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="5791588">len</span><span class="op" id="5791591">(</span><span class="ident" id="5791592">src</span><span class="op" id="5791595">)</span>&nbsp;<span class="op" id="5791597">&lt;</span>&nbsp;<span class="num" id="5791599">8</span>&nbsp;<span class="op" id="5791601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5791607">//&nbsp;We&#39;ve&nbsp;reached&nbsp;the&nbsp;end&nbsp;and&nbsp;there&#39;s&nbsp;padding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791656">if</span>&nbsp;<span class="builtinfunc" id="5791659">len</span><span class="op" id="5791662">(</span><span class="ident" id="5791663">src</span><span class="op" id="5791666">)</span><span class="op" id="5791667">+</span><span class="ident" id="5791668">j</span>&nbsp;<span class="op" id="5791670">&lt;</span>&nbsp;<span class="num" id="5791672">8</span><span class="op" id="5791673">-</span><span class="num" id="5791674">1</span>&nbsp;<span class="op" id="5791676">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5791683">//&nbsp;not&nbsp;enough&nbsp;padding</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791710">return</span>&nbsp;<span class="ident" id="5791717">n</span><span class="op" id="5791718">,</span>&nbsp;<span class="ident" id="5791720">false</span><span class="op" id="5791725">,</span>&nbsp;<span class="ident" id="5791727">CorruptInputError</span><span class="op" id="5791744">(</span><span class="ident" id="5791745">olen</span><span class="op" id="5791749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5791755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791761">for</span>&nbsp;<span class="ident" id="5791765">k</span>&nbsp;<span class="op" id="5791767">:=</span>&nbsp;<span class="num" id="5791770">0</span><span class="op" id="5791771">;</span>&nbsp;<span class="ident" id="5791773">k</span>&nbsp;<span class="op" id="5791775">&lt;</span>&nbsp;<span class="num" id="5791777">8</span><span class="op" id="5791778">-</span><span class="num" id="5791779">1</span><span class="op" id="5791780">-</span><span class="ident" id="5791781">j</span><span class="op" id="5791782">;</span>&nbsp;<span class="ident" id="5791784">k</span><span class="op" id="5791785">++</span>&nbsp;<span class="op" id="5791788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791795">if</span>&nbsp;<span class="builtinfunc" id="5791798">len</span><span class="op" id="5791801">(</span><span class="ident" id="5791802">src</span><span class="op" id="5791805">)</span>&nbsp;<span class="op" id="5791807">&gt;</span>&nbsp;<span class="ident" id="5791809">k</span>&nbsp;<span class="op" id="5791811">&amp;&amp;</span>&nbsp;<span class="ident" id="5791814">src</span><span class="op" id="5791817">[</span><span class="ident" id="5791818">k</span><span class="op" id="5791819">]</span>&nbsp;<span class="op" id="5791821">!=</span>&nbsp;<span class="string" id="5791824">&#39;=&#39;</span>&nbsp;<span class="op" id="5791828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5791836">//&nbsp;incorrect&nbsp;padding</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5791863">return</span>&nbsp;<span class="ident" id="5791870">n</span><span class="op" id="5791871">,</span>&nbsp;<span class="ident" id="5791873">false</span><span class="op" id="5791878">,</span>&nbsp;<span class="ident" id="5791880">CorruptInputError</span><span class="op" id="5791897">(</span><span class="ident" id="5791898">olen</span>&nbsp;<span class="op" id="5791903">-</span>&nbsp;<span class="builtinfunc" id="5791905">len</span><span class="op" id="5791908">(</span><span class="ident" id="5791909">src</span><span class="op" id="5791912">)</span>&nbsp;<span class="op" id="5791914">+</span>&nbsp;<span class="ident" id="5791916">k</span>&nbsp;<span class="op" id="5791918">-</span>&nbsp;<span class="num" id="5791920">1</span><span class="op" id="5791921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5791928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5791934">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5791940">dlen</span><span class="op" id="5791944">,</span>&nbsp;<span class="ident" id="5791946">end</span>&nbsp;<span class="op" id="5791950">=</span>&nbsp;<span class="ident" id="5791952">j</span><span class="op" id="5791953">,</span>&nbsp;<span class="ident" id="5791955">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5791964">//&nbsp;7,&nbsp;5&nbsp;and&nbsp;2&nbsp;are&nbsp;not&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;so&nbsp;1,&nbsp;3&nbsp;and&nbsp;6&nbsp;are&nbsp;not</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5792039">//&nbsp;valid&nbsp;dlen&nbsp;values.&nbsp;See&nbsp;RFC&nbsp;4648&nbsp;Section&nbsp;6&nbsp;&#34;Base&nbsp;32&nbsp;Encoding&#34;&nbsp;listing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5792115">//&nbsp;the&nbsp;five&nbsp;valid&nbsp;padding&nbsp;lengths,&nbsp;and&nbsp;Section&nbsp;9&nbsp;&#34;Illustrations&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5792187">//&nbsp;Examples&#34;&nbsp;for&nbsp;an&nbsp;illustration&nbsp;for&nbsp;how&nbsp;the&nbsp;1st,&nbsp;3rd&nbsp;and&nbsp;6th&nbsp;base32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5792260">//&nbsp;src&nbsp;bytes&nbsp;do&nbsp;not&nbsp;yield&nbsp;enough&nbsp;information&nbsp;to&nbsp;decode&nbsp;a&nbsp;dst&nbsp;byte.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792331">if</span>&nbsp;<span class="ident" id="5792334">dlen</span>&nbsp;<span class="op" id="5792339">==</span>&nbsp;<span class="num" id="5792342">1</span>&nbsp;<span class="op" id="5792344">||</span>&nbsp;<span class="ident" id="5792347">dlen</span>&nbsp;<span class="op" id="5792352">==</span>&nbsp;<span class="num" id="5792355">3</span>&nbsp;<span class="op" id="5792357">||</span>&nbsp;<span class="ident" id="5792360">dlen</span>&nbsp;<span class="op" id="5792365">==</span>&nbsp;<span class="num" id="5792368">6</span>&nbsp;<span class="op" id="5792370">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792377">return</span>&nbsp;<span class="ident" id="5792384">n</span><span class="op" id="5792385">,</span>&nbsp;<span class="ident" id="5792387">false</span><span class="op" id="5792392">,</span>&nbsp;<span class="ident" id="5792394">CorruptInputError</span><span class="op" id="5792411">(</span><span class="ident" id="5792412">olen</span>&nbsp;<span class="op" id="5792417">-</span>&nbsp;<span class="builtinfunc" id="5792419">len</span><span class="op" id="5792422">(</span><span class="ident" id="5792423">src</span><span class="op" id="5792426">)</span>&nbsp;<span class="op" id="5792428">-</span>&nbsp;<span class="num" id="5792430">1</span><span class="op" id="5792431">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5792437">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792443">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5792452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5792457">dbuf</span><span class="op" id="5792461">[</span><span class="ident" id="5792462">j</span><span class="op" id="5792463">]</span>&nbsp;<span class="op" id="5792465">=</span>&nbsp;<span class="ident" id="5792467">enc</span><span class="op" id="5792470">.</span><span class="ident" id="5792471">decodeMap</span><span class="op" id="5792480">[</span><span class="ident" id="5792481">in</span><span class="op" id="5792483">]</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792488">if</span>&nbsp;<span class="ident" id="5792491">dbuf</span><span class="op" id="5792495">[</span><span class="ident" id="5792496">j</span><span class="op" id="5792497">]</span>&nbsp;<span class="op" id="5792499">==</span>&nbsp;<span class="num" id="5792502">0xFF</span>&nbsp;<span class="op" id="5792507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792513">return</span>&nbsp;<span class="ident" id="5792520">n</span><span class="op" id="5792521">,</span>&nbsp;<span class="ident" id="5792523">false</span><span class="op" id="5792528">,</span>&nbsp;<span class="ident" id="5792530">CorruptInputError</span><span class="op" id="5792547">(</span><span class="ident" id="5792548">olen</span>&nbsp;<span class="op" id="5792553">-</span>&nbsp;<span class="builtinfunc" id="5792555">len</span><span class="op" id="5792558">(</span><span class="ident" id="5792559">src</span><span class="op" id="5792562">)</span>&nbsp;<span class="op" id="5792564">-</span>&nbsp;<span class="num" id="5792566">1</span><span class="op" id="5792567">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5792572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5792577">j</span><span class="op" id="5792578">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5792583">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5792588">//&nbsp;Pack&nbsp;8x&nbsp;5-bit&nbsp;source&nbsp;blocks&nbsp;into&nbsp;5&nbsp;byte&nbsp;destination</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5792645">//&nbsp;quantum</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792658">switch</span>&nbsp;<span class="ident" id="5792665">dlen</span>&nbsp;<span class="op" id="5792670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792674">case</span>&nbsp;<span class="num" id="5792679">8</span><span class="op" id="5792680">:</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5792685">dst</span><span class="op" id="5792688">[</span><span class="num" id="5792689">4</span><span class="op" id="5792690">]</span>&nbsp;<span class="op" id="5792692">=</span>&nbsp;<span class="ident" id="5792694">dbuf</span><span class="op" id="5792698">[</span><span class="num" id="5792699">6</span><span class="op" id="5792700">]</span><span class="op" id="5792701">&lt;&lt;</span><span class="num" id="5792703">5</span>&nbsp;<span class="op" id="5792705">|</span>&nbsp;<span class="ident" id="5792707">dbuf</span><span class="op" id="5792711">[</span><span class="num" id="5792712">7</span><span class="op" id="5792713">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792718">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792732">case</span>&nbsp;<span class="num" id="5792737">7</span><span class="op" id="5792738">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5792743">dst</span><span class="op" id="5792746">[</span><span class="num" id="5792747">3</span><span class="op" id="5792748">]</span>&nbsp;<span class="op" id="5792750">=</span>&nbsp;<span class="ident" id="5792752">dbuf</span><span class="op" id="5792756">[</span><span class="num" id="5792757">4</span><span class="op" id="5792758">]</span><span class="op" id="5792759">&lt;&lt;</span><span class="num" id="5792761">7</span>&nbsp;<span class="op" id="5792763">|</span>&nbsp;<span class="ident" id="5792765">dbuf</span><span class="op" id="5792769">[</span><span class="num" id="5792770">5</span><span class="op" id="5792771">]</span><span class="op" id="5792772">&lt;&lt;</span><span class="num" id="5792774">2</span>&nbsp;<span class="op" id="5792776">|</span>&nbsp;<span class="ident" id="5792778">dbuf</span><span class="op" id="5792782">[</span><span class="num" id="5792783">6</span><span class="op" id="5792784">]</span><span class="op" id="5792785">&gt;&gt;</span><span class="num" id="5792787">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792792">fallthrough</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792806">case</span>&nbsp;<span class="num" id="5792811">5</span><span class="op" id="5792812">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5792817">dst</span><span class="op" id="5792820">[</span><span class="num" id="5792821">2</span><span class="op" id="5792822">]</span>&nbsp;<span class="op" id="5792824">=</span>&nbsp;<span class="ident" id="5792826">dbuf</span><span class="op" id="5792830">[</span><span class="num" id="5792831">3</span><span class="op" id="5792832">]</span><span class="op" id="5792833">&lt;&lt;</span><span class="num" id="5792835">4</span>&nbsp;<span class="op" id="5792837">|</span>&nbsp;<span class="ident" id="5792839">dbuf</span><span class="op" id="5792843">[</span><span class="num" id="5792844">4</span><span class="op" id="5792845">]</span><span class="op" id="5792846">&gt;&gt;</span><span class="num" id="5792848">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792853">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792867">case</span>&nbsp;<span class="num" id="5792872">4</span><span class="op" id="5792873">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5792878">dst</span><span class="op" id="5792881">[</span><span class="num" id="5792882">1</span><span class="op" id="5792883">]</span>&nbsp;<span class="op" id="5792885">=</span>&nbsp;<span class="ident" id="5792887">dbuf</span><span class="op" id="5792891">[</span><span class="num" id="5792892">1</span><span class="op" id="5792893">]</span><span class="op" id="5792894">&lt;&lt;</span><span class="num" id="5792896">6</span>&nbsp;<span class="op" id="5792898">|</span>&nbsp;<span class="ident" id="5792900">dbuf</span><span class="op" id="5792904">[</span><span class="num" id="5792905">2</span><span class="op" id="5792906">]</span><span class="op" id="5792907">&lt;&lt;</span><span class="num" id="5792909">1</span>&nbsp;<span class="op" id="5792911">|</span>&nbsp;<span class="ident" id="5792913">dbuf</span><span class="op" id="5792917">[</span><span class="num" id="5792918">3</span><span class="op" id="5792919">]</span><span class="op" id="5792920">&gt;&gt;</span><span class="num" id="5792922">4</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792927">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5792941">case</span>&nbsp;<span class="num" id="5792946">2</span><span class="op" id="5792947">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5792952">dst</span><span class="op" id="5792955">[</span><span class="num" id="5792956">0</span><span class="op" id="5792957">]</span>&nbsp;<span class="op" id="5792959">=</span>&nbsp;<span class="ident" id="5792961">dbuf</span><span class="op" id="5792965">[</span><span class="num" id="5792966">0</span><span class="op" id="5792967">]</span><span class="op" id="5792968">&lt;&lt;</span><span class="num" id="5792970">3</span>&nbsp;<span class="op" id="5792972">|</span>&nbsp;<span class="ident" id="5792974">dbuf</span><span class="op" id="5792978">[</span><span class="num" id="5792979">1</span><span class="op" id="5792980">]</span><span class="op" id="5792981">&gt;&gt;</span><span class="num" id="5792983">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5792987">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5792991">dst</span>&nbsp;<span class="op" id="5792995">=</span>&nbsp;<span class="ident" id="5792997">dst</span><span class="op" id="5793000">[</span><span class="num" id="5793001">5</span><span class="op" id="5793002">:</span><span class="op" id="5793003">]</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793007">switch</span>&nbsp;<span class="ident" id="5793014">dlen</span>&nbsp;<span class="op" id="5793019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793023">case</span>&nbsp;<span class="num" id="5793028">2</span><span class="op" id="5793029">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793034">n</span>&nbsp;<span class="op" id="5793036">+=</span>&nbsp;<span class="num" id="5793039">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793043">case</span>&nbsp;<span class="num" id="5793048">4</span><span class="op" id="5793049">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793054">n</span>&nbsp;<span class="op" id="5793056">+=</span>&nbsp;<span class="num" id="5793059">2</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793063">case</span>&nbsp;<span class="num" id="5793068">5</span><span class="op" id="5793069">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793074">n</span>&nbsp;<span class="op" id="5793076">+=</span>&nbsp;<span class="num" id="5793079">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793083">case</span>&nbsp;<span class="num" id="5793088">7</span><span class="op" id="5793089">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793094">n</span>&nbsp;<span class="op" id="5793096">+=</span>&nbsp;<span class="num" id="5793099">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793103">case</span>&nbsp;<span class="num" id="5793108">8</span><span class="op" id="5793109">:</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793114">n</span>&nbsp;<span class="op" id="5793116">+=</span>&nbsp;<span class="num" id="5793119">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5793123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5793126">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793129">return</span>&nbsp;<span class="ident" id="5793136">n</span><span class="op" id="5793137">,</span>&nbsp;<span class="ident" id="5793139">end</span><span class="op" id="5793142">,</span>&nbsp;<span class="ident" id="5793144">nil</span><br>
<span class="lineno"></span><span class="op" id="5793148">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="comment" id="5793151">//&nbsp;Decode&nbsp;decodes&nbsp;src&nbsp;using&nbsp;the&nbsp;encoding&nbsp;enc.&nbsp;&nbsp;It&nbsp;writes&nbsp;at&nbsp;most</span><br>
<span class="lineno"></span><span class="comment" id="5793216">//&nbsp;DecodedLen(len(src))&nbsp;bytes&nbsp;to&nbsp;dst&nbsp;and&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;bytes</span><br>
<span class="lineno"></span><span class="comment" id="5793285">//&nbsp;written.&nbsp;&nbsp;If&nbsp;src&nbsp;contains&nbsp;invalid&nbsp;base32&nbsp;data,&nbsp;it&nbsp;will&nbsp;return&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5793354">//&nbsp;number&nbsp;of&nbsp;bytes&nbsp;successfully&nbsp;written&nbsp;and&nbsp;CorruptInputError.</span><br>
<span class="lineno">320</span><span class="comment" id="5793417">//&nbsp;New&nbsp;line&nbsp;characters&nbsp;(\r&nbsp;and&nbsp;\n)&nbsp;are&nbsp;ignored.</span><br>
<span class="lineno"></span><span class="keyword" id="5793465">func</span>&nbsp;<span class="op" id="5793470">(</span><span class="ident" id="5793471">enc</span>&nbsp;<span class="op" id="5793475">*</span><span class="ident" id="5793476">Encoding</span><span class="op" id="5793484">)</span>&nbsp;<span class="ident" id="5793486">Decode</span><span class="op" id="5793492">(</span><span class="ident" id="5793493">dst</span><span class="op" id="5793496">,</span>&nbsp;<span class="ident" id="5793498">src</span>&nbsp;<span class="op" id="5793502">[</span><span class="op" id="5793503">]</span><span class="builtintype" id="5793504">byte</span><span class="op" id="5793508">)</span>&nbsp;<span class="op" id="5793510">(</span><span class="ident" id="5793511">n</span>&nbsp;<span class="builtintype" id="5793513">int</span><span class="op" id="5793516">,</span>&nbsp;<span class="ident" id="5793518">err</span>&nbsp;<span class="builtintype" id="5793522">error</span><span class="op" id="5793527">)</span>&nbsp;<span class="op" id="5793529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793532">src</span>&nbsp;<span class="op" id="5793536">=</span>&nbsp;<span class="ident" id="5793538">bytes</span><span class="op" id="5793543">.</span><span class="ident" id="5793544">Map</span><span class="op" id="5793547">(</span><span class="ident" id="5793548">removeNewlinesMapper</span><span class="op" id="5793568">,</span>&nbsp;<span class="ident" id="5793570">src</span><span class="op" id="5793573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793576">n</span><span class="op" id="5793577">,</span>&nbsp;<span class="ident" id="5793579">_</span><span class="op" id="5793580">,</span>&nbsp;<span class="ident" id="5793582">err</span>&nbsp;<span class="op" id="5793586">=</span>&nbsp;<span class="ident" id="5793588">enc</span><span class="op" id="5793591">.</span><span class="ident" id="5793592">decode</span><span class="op" id="5793598">(</span><span class="ident" id="5793599">dst</span><span class="op" id="5793602">,</span>&nbsp;<span class="ident" id="5793604">src</span><span class="op" id="5793607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793610">return</span><br>
<span class="lineno">325</span><span class="op" id="5793617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5793620">//&nbsp;DecodeString&nbsp;returns&nbsp;the&nbsp;bytes&nbsp;represented&nbsp;by&nbsp;the&nbsp;base32&nbsp;string&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5793690">func</span>&nbsp;<span class="op" id="5793695">(</span><span class="ident" id="5793696">enc</span>&nbsp;<span class="op" id="5793700">*</span><span class="ident" id="5793701">Encoding</span><span class="op" id="5793709">)</span>&nbsp;<span class="ident" id="5793711">DecodeString</span><span class="op" id="5793723">(</span><span class="ident" id="5793724">s</span>&nbsp;<span class="builtintype" id="5793726">string</span><span class="op" id="5793732">)</span>&nbsp;<span class="op" id="5793734">(</span><span class="op" id="5793735">[</span><span class="op" id="5793736">]</span><span class="builtintype" id="5793737">byte</span><span class="op" id="5793741">,</span>&nbsp;<span class="builtintype" id="5793743">error</span><span class="op" id="5793748">)</span>&nbsp;<span class="op" id="5793750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793753">s</span>&nbsp;<span class="op" id="5793755">=</span>&nbsp;<span class="ident" id="5793757">strings</span><span class="op" id="5793764">.</span><span class="ident" id="5793765">Map</span><span class="op" id="5793768">(</span><span class="ident" id="5793769">removeNewlinesMapper</span><span class="op" id="5793789">,</span>&nbsp;<span class="ident" id="5793791">s</span><span class="op" id="5793792">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793795">dbuf</span>&nbsp;<span class="op" id="5793800">:=</span>&nbsp;<span class="builtinfunc" id="5793803">make</span><span class="op" id="5793807">(</span><span class="op" id="5793808">[</span><span class="op" id="5793809">]</span><span class="builtintype" id="5793810">byte</span><span class="op" id="5793814">,</span>&nbsp;<span class="ident" id="5793816">enc</span><span class="op" id="5793819">.</span><span class="ident" id="5793820">DecodedLen</span><span class="op" id="5793830">(</span><span class="builtinfunc" id="5793831">len</span><span class="op" id="5793834">(</span><span class="ident" id="5793835">s</span><span class="op" id="5793836">)</span><span class="op" id="5793837">)</span><span class="op" id="5793838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793841">n</span><span class="op" id="5793842">,</span>&nbsp;<span class="ident" id="5793844">_</span><span class="op" id="5793845">,</span>&nbsp;<span class="ident" id="5793847">err</span>&nbsp;<span class="op" id="5793851">:=</span>&nbsp;<span class="ident" id="5793854">enc</span><span class="op" id="5793857">.</span><span class="ident" id="5793858">decode</span><span class="op" id="5793864">(</span><span class="ident" id="5793865">dbuf</span><span class="op" id="5793869">,</span>&nbsp;<span class="op" id="5793871">[</span><span class="op" id="5793872">]</span><span class="builtintype" id="5793873">byte</span><span class="op" id="5793877">(</span><span class="ident" id="5793878">s</span><span class="op" id="5793879">)</span><span class="op" id="5793880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5793883">return</span>&nbsp;<span class="ident" id="5793890">dbuf</span><span class="op" id="5793894">[</span><span class="op" id="5793895">:</span><span class="ident" id="5793896">n</span><span class="op" id="5793897">]</span><span class="op" id="5793898">,</span>&nbsp;<span class="ident" id="5793900">err</span><br>
<span class="lineno"></span><span class="op" id="5793904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span><span class="keyword" id="5793907">type</span>&nbsp;<span class="ident" id="5793912">decoder</span>&nbsp;<span class="keyword" id="5793920">struct</span>&nbsp;<span class="op" id="5793927">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793930">err</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5793937">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793944">enc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5793951">*</span><span class="ident" id="5793952">Encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793962">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5793969">io</span><span class="op" id="5793971">.</span><span class="ident" id="5793972">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5793980">end</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5793987">bool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5793998">//&nbsp;saw&nbsp;end&nbsp;of&nbsp;message</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794021">buf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5794028">[</span><span class="num" id="5794029">1024</span><span class="op" id="5794033">]</span><span class="builtintype" id="5794034">byte</span>&nbsp;<span class="comment" id="5794039">//&nbsp;leftover&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794058">nbuf</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5794065">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794070">out</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5794077">[</span><span class="op" id="5794078">]</span><span class="builtintype" id="5794079">byte</span>&nbsp;<span class="comment" id="5794084">//&nbsp;leftover&nbsp;decoded&nbsp;output</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794112">outbuf</span>&nbsp;<span class="op" id="5794119">[</span><span class="num" id="5794120">1024</span>&nbsp;<span class="op" id="5794125">/</span>&nbsp;<span class="num" id="5794127">8</span>&nbsp;<span class="op" id="5794129">*</span>&nbsp;<span class="num" id="5794131">5</span><span class="op" id="5794132">]</span><span class="builtintype" id="5794133">byte</span><br>
<span class="lineno"></span><span class="op" id="5794138">}</span><br>
<span class="lineno">345</span><br>
<span class="lineno"></span><span class="keyword" id="5794141">func</span>&nbsp;<span class="op" id="5794146">(</span><span class="ident" id="5794147">d</span>&nbsp;<span class="op" id="5794149">*</span><span class="ident" id="5794150">decoder</span><span class="op" id="5794157">)</span>&nbsp;<span class="ident" id="5794159">Read</span><span class="op" id="5794163">(</span><span class="ident" id="5794164">p</span>&nbsp;<span class="op" id="5794166">[</span><span class="op" id="5794167">]</span><span class="builtintype" id="5794168">byte</span><span class="op" id="5794172">)</span>&nbsp;<span class="op" id="5794174">(</span><span class="ident" id="5794175">n</span>&nbsp;<span class="builtintype" id="5794177">int</span><span class="op" id="5794180">,</span>&nbsp;<span class="ident" id="5794182">err</span>&nbsp;<span class="builtintype" id="5794186">error</span><span class="op" id="5794191">)</span>&nbsp;<span class="op" id="5794193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794196">if</span>&nbsp;<span class="ident" id="5794199">d</span><span class="op" id="5794200">.</span><span class="ident" id="5794201">err</span>&nbsp;<span class="op" id="5794205">!=</span>&nbsp;<span class="ident" id="5794208">nil</span>&nbsp;<span class="op" id="5794212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794216">return</span>&nbsp;<span class="num" id="5794223">0</span><span class="op" id="5794224">,</span>&nbsp;<span class="ident" id="5794226">d</span><span class="op" id="5794227">.</span><span class="ident" id="5794228">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794233">}</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5794237">//&nbsp;Use&nbsp;leftover&nbsp;decoded&nbsp;output&nbsp;from&nbsp;last&nbsp;read.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794285">if</span>&nbsp;<span class="builtinfunc" id="5794288">len</span><span class="op" id="5794291">(</span><span class="ident" id="5794292">d</span><span class="op" id="5794293">.</span><span class="ident" id="5794294">out</span><span class="op" id="5794297">)</span>&nbsp;<span class="op" id="5794299">&gt;</span>&nbsp;<span class="num" id="5794301">0</span>&nbsp;<span class="op" id="5794303">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794307">n</span>&nbsp;<span class="op" id="5794309">=</span>&nbsp;<span class="builtinfunc" id="5794311">copy</span><span class="op" id="5794315">(</span><span class="ident" id="5794316">p</span><span class="op" id="5794317">,</span>&nbsp;<span class="ident" id="5794319">d</span><span class="op" id="5794320">.</span><span class="ident" id="5794321">out</span><span class="op" id="5794324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794328">d</span><span class="op" id="5794329">.</span><span class="ident" id="5794330">out</span>&nbsp;<span class="op" id="5794334">=</span>&nbsp;<span class="ident" id="5794336">d</span><span class="op" id="5794337">.</span><span class="ident" id="5794338">out</span><span class="op" id="5794341">[</span><span class="ident" id="5794342">n</span><span class="op" id="5794343">:</span><span class="op" id="5794344">]</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794348">return</span>&nbsp;<span class="ident" id="5794355">n</span><span class="op" id="5794356">,</span>&nbsp;<span class="ident" id="5794358">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794363">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5794367">//&nbsp;Read&nbsp;a&nbsp;chunk.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794385">nn</span>&nbsp;<span class="op" id="5794388">:=</span>&nbsp;<span class="builtinfunc" id="5794391">len</span><span class="op" id="5794394">(</span><span class="ident" id="5794395">p</span><span class="op" id="5794396">)</span>&nbsp;<span class="op" id="5794398">/</span>&nbsp;<span class="num" id="5794400">5</span>&nbsp;<span class="op" id="5794402">*</span>&nbsp;<span class="num" id="5794404">8</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794407">if</span>&nbsp;<span class="ident" id="5794410">nn</span>&nbsp;<span class="op" id="5794413">&lt;</span>&nbsp;<span class="num" id="5794415">8</span>&nbsp;<span class="op" id="5794417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794421">nn</span>&nbsp;<span class="op" id="5794424">=</span>&nbsp;<span class="num" id="5794426">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794432">if</span>&nbsp;<span class="ident" id="5794435">nn</span>&nbsp;<span class="op" id="5794438">&gt;</span>&nbsp;<span class="builtinfunc" id="5794440">len</span><span class="op" id="5794443">(</span><span class="ident" id="5794444">d</span><span class="op" id="5794445">.</span><span class="ident" id="5794446">buf</span><span class="op" id="5794449">)</span>&nbsp;<span class="op" id="5794451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794455">nn</span>&nbsp;<span class="op" id="5794458">=</span>&nbsp;<span class="builtinfunc" id="5794460">len</span><span class="op" id="5794463">(</span><span class="ident" id="5794464">d</span><span class="op" id="5794465">.</span><span class="ident" id="5794466">buf</span><span class="op" id="5794469">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794475">nn</span><span class="op" id="5794477">,</span>&nbsp;<span class="ident" id="5794479">d</span><span class="op" id="5794480">.</span><span class="ident" id="5794481">err</span>&nbsp;<span class="op" id="5794485">=</span>&nbsp;<span class="ident" id="5794487">io</span><span class="op" id="5794489">.</span><span class="ident" id="5794490">ReadAtLeast</span><span class="op" id="5794501">(</span><span class="ident" id="5794502">d</span><span class="op" id="5794503">.</span><span class="ident" id="5794504">r</span><span class="op" id="5794505">,</span>&nbsp;<span class="ident" id="5794507">d</span><span class="op" id="5794508">.</span><span class="ident" id="5794509">buf</span><span class="op" id="5794512">[</span><span class="ident" id="5794513">d</span><span class="op" id="5794514">.</span><span class="ident" id="5794515">nbuf</span><span class="op" id="5794519">:</span><span class="ident" id="5794520">nn</span><span class="op" id="5794522">]</span><span class="op" id="5794523">,</span>&nbsp;<span class="num" id="5794525">8</span><span class="op" id="5794526">-</span><span class="ident" id="5794527">d</span><span class="op" id="5794528">.</span><span class="ident" id="5794529">nbuf</span><span class="op" id="5794533">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794536">d</span><span class="op" id="5794537">.</span><span class="ident" id="5794538">nbuf</span>&nbsp;<span class="op" id="5794543">+=</span>&nbsp;<span class="ident" id="5794546">nn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794550">if</span>&nbsp;<span class="ident" id="5794553">d</span><span class="op" id="5794554">.</span><span class="ident" id="5794555">nbuf</span>&nbsp;<span class="op" id="5794560">&lt;</span>&nbsp;<span class="num" id="5794562">8</span>&nbsp;<span class="op" id="5794564">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794568">return</span>&nbsp;<span class="num" id="5794575">0</span><span class="op" id="5794576">,</span>&nbsp;<span class="ident" id="5794578">d</span><span class="op" id="5794579">.</span><span class="ident" id="5794580">err</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794585">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5794589">//&nbsp;Decode&nbsp;chunk&nbsp;into&nbsp;p,&nbsp;or&nbsp;d.out&nbsp;and&nbsp;then&nbsp;p&nbsp;if&nbsp;p&nbsp;is&nbsp;too&nbsp;small.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794653">nr</span>&nbsp;<span class="op" id="5794656">:=</span>&nbsp;<span class="ident" id="5794659">d</span><span class="op" id="5794660">.</span><span class="ident" id="5794661">nbuf</span>&nbsp;<span class="op" id="5794666">/</span>&nbsp;<span class="num" id="5794668">8</span>&nbsp;<span class="op" id="5794670">*</span>&nbsp;<span class="num" id="5794672">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794675">nw</span>&nbsp;<span class="op" id="5794678">:=</span>&nbsp;<span class="ident" id="5794681">d</span><span class="op" id="5794682">.</span><span class="ident" id="5794683">nbuf</span>&nbsp;<span class="op" id="5794688">/</span>&nbsp;<span class="num" id="5794690">8</span>&nbsp;<span class="op" id="5794692">*</span>&nbsp;<span class="num" id="5794694">5</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794697">if</span>&nbsp;<span class="ident" id="5794700">nw</span>&nbsp;<span class="op" id="5794703">&gt;</span>&nbsp;<span class="builtinfunc" id="5794705">len</span><span class="op" id="5794708">(</span><span class="ident" id="5794709">p</span><span class="op" id="5794710">)</span>&nbsp;<span class="op" id="5794712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794716">nw</span><span class="op" id="5794718">,</span>&nbsp;<span class="ident" id="5794720">d</span><span class="op" id="5794721">.</span><span class="ident" id="5794722">end</span><span class="op" id="5794725">,</span>&nbsp;<span class="ident" id="5794727">d</span><span class="op" id="5794728">.</span><span class="ident" id="5794729">err</span>&nbsp;<span class="op" id="5794733">=</span>&nbsp;<span class="ident" id="5794735">d</span><span class="op" id="5794736">.</span><span class="ident" id="5794737">enc</span><span class="op" id="5794740">.</span><span class="ident" id="5794741">decode</span><span class="op" id="5794747">(</span><span class="ident" id="5794748">d</span><span class="op" id="5794749">.</span><span class="ident" id="5794750">outbuf</span><span class="op" id="5794756">[</span><span class="num" id="5794757">0</span><span class="op" id="5794758">:</span><span class="op" id="5794759">]</span><span class="op" id="5794760">,</span>&nbsp;<span class="ident" id="5794762">d</span><span class="op" id="5794763">.</span><span class="ident" id="5794764">buf</span><span class="op" id="5794767">[</span><span class="num" id="5794768">0</span><span class="op" id="5794769">:</span><span class="ident" id="5794770">nr</span><span class="op" id="5794772">]</span><span class="op" id="5794773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794777">d</span><span class="op" id="5794778">.</span><span class="ident" id="5794779">out</span>&nbsp;<span class="op" id="5794783">=</span>&nbsp;<span class="ident" id="5794785">d</span><span class="op" id="5794786">.</span><span class="ident" id="5794787">outbuf</span><span class="op" id="5794793">[</span><span class="num" id="5794794">0</span><span class="op" id="5794795">:</span><span class="ident" id="5794796">nw</span><span class="op" id="5794798">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794802">n</span>&nbsp;<span class="op" id="5794804">=</span>&nbsp;<span class="builtinfunc" id="5794806">copy</span><span class="op" id="5794810">(</span><span class="ident" id="5794811">p</span><span class="op" id="5794812">,</span>&nbsp;<span class="ident" id="5794814">d</span><span class="op" id="5794815">.</span><span class="ident" id="5794816">out</span><span class="op" id="5794819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794823">d</span><span class="op" id="5794824">.</span><span class="ident" id="5794825">out</span>&nbsp;<span class="op" id="5794829">=</span>&nbsp;<span class="ident" id="5794831">d</span><span class="op" id="5794832">.</span><span class="ident" id="5794833">out</span><span class="op" id="5794836">[</span><span class="ident" id="5794837">n</span><span class="op" id="5794838">:</span><span class="op" id="5794839">]</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794842">}</span>&nbsp;<span class="keyword" id="5794844">else</span>&nbsp;<span class="op" id="5794849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794853">n</span><span class="op" id="5794854">,</span>&nbsp;<span class="ident" id="5794856">d</span><span class="op" id="5794857">.</span><span class="ident" id="5794858">end</span><span class="op" id="5794861">,</span>&nbsp;<span class="ident" id="5794863">d</span><span class="op" id="5794864">.</span><span class="ident" id="5794865">err</span>&nbsp;<span class="op" id="5794869">=</span>&nbsp;<span class="ident" id="5794871">d</span><span class="op" id="5794872">.</span><span class="ident" id="5794873">enc</span><span class="op" id="5794876">.</span><span class="ident" id="5794877">decode</span><span class="op" id="5794883">(</span><span class="ident" id="5794884">p</span><span class="op" id="5794885">,</span>&nbsp;<span class="ident" id="5794887">d</span><span class="op" id="5794888">.</span><span class="ident" id="5794889">buf</span><span class="op" id="5794892">[</span><span class="num" id="5794893">0</span><span class="op" id="5794894">:</span><span class="ident" id="5794895">nr</span><span class="op" id="5794897">]</span><span class="op" id="5794898">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794901">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794904">d</span><span class="op" id="5794905">.</span><span class="ident" id="5794906">nbuf</span>&nbsp;<span class="op" id="5794911">-=</span>&nbsp;<span class="ident" id="5794914">nr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794918">for</span>&nbsp;<span class="ident" id="5794922">i</span>&nbsp;<span class="op" id="5794924">:=</span>&nbsp;<span class="num" id="5794927">0</span><span class="op" id="5794928">;</span>&nbsp;<span class="ident" id="5794930">i</span>&nbsp;<span class="op" id="5794932">&lt;</span>&nbsp;<span class="ident" id="5794934">d</span><span class="op" id="5794935">.</span><span class="ident" id="5794936">nbuf</span><span class="op" id="5794940">;</span>&nbsp;<span class="ident" id="5794942">i</span><span class="op" id="5794943">++</span>&nbsp;<span class="op" id="5794946">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794950">d</span><span class="op" id="5794951">.</span><span class="ident" id="5794952">buf</span><span class="op" id="5794955">[</span><span class="ident" id="5794956">i</span><span class="op" id="5794957">]</span>&nbsp;<span class="op" id="5794959">=</span>&nbsp;<span class="ident" id="5794961">d</span><span class="op" id="5794962">.</span><span class="ident" id="5794963">buf</span><span class="op" id="5794966">[</span><span class="ident" id="5794967">i</span><span class="op" id="5794968">+</span><span class="ident" id="5794969">nr</span><span class="op" id="5794971">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5794974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5794978">if</span>&nbsp;<span class="ident" id="5794981">d</span><span class="op" id="5794982">.</span><span class="ident" id="5794983">err</span>&nbsp;<span class="op" id="5794987">==</span>&nbsp;<span class="ident" id="5794990">nil</span>&nbsp;<span class="op" id="5794994">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5794998">d</span><span class="op" id="5794999">.</span><span class="ident" id="5795000">err</span>&nbsp;<span class="op" id="5795004">=</span>&nbsp;<span class="ident" id="5795006">err</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795011">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795014">return</span>&nbsp;<span class="ident" id="5795021">n</span><span class="op" id="5795022">,</span>&nbsp;<span class="ident" id="5795024">d</span><span class="op" id="5795025">.</span><span class="ident" id="5795026">err</span><br>
<span class="lineno"></span><span class="op" id="5795030">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5795033">type</span>&nbsp;<span class="ident" id="5795038">newlineFilteringReader</span>&nbsp;<span class="keyword" id="5795061">struct</span>&nbsp;<span class="op" id="5795068">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795071">wrapped</span>&nbsp;<span class="ident" id="5795079">io</span><span class="op" id="5795081">.</span><span class="ident" id="5795082">Reader</span><br>
<span class="lineno"></span><span class="op" id="5795089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5795092">func</span>&nbsp;<span class="op" id="5795097">(</span><span class="ident" id="5795098">r</span>&nbsp;<span class="op" id="5795100">*</span><span class="ident" id="5795101">newlineFilteringReader</span><span class="op" id="5795123">)</span>&nbsp;<span class="ident" id="5795125">Read</span><span class="op" id="5795129">(</span><span class="ident" id="5795130">p</span>&nbsp;<span class="op" id="5795132">[</span><span class="op" id="5795133">]</span><span class="builtintype" id="5795134">byte</span><span class="op" id="5795138">)</span>&nbsp;<span class="op" id="5795140">(</span><span class="builtintype" id="5795141">int</span><span class="op" id="5795144">,</span>&nbsp;<span class="builtintype" id="5795146">error</span><span class="op" id="5795151">)</span>&nbsp;<span class="op" id="5795153">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795156">n</span><span class="op" id="5795157">,</span>&nbsp;<span class="ident" id="5795159">err</span>&nbsp;<span class="op" id="5795163">:=</span>&nbsp;<span class="ident" id="5795166">r</span><span class="op" id="5795167">.</span><span class="ident" id="5795168">wrapped</span><span class="op" id="5795175">.</span><span class="ident" id="5795176">Read</span><span class="op" id="5795180">(</span><span class="ident" id="5795181">p</span><span class="op" id="5795182">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795185">for</span>&nbsp;<span class="ident" id="5795189">n</span>&nbsp;<span class="op" id="5795191">&gt;</span>&nbsp;<span class="num" id="5795193">0</span>&nbsp;<span class="op" id="5795195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795199">offset</span>&nbsp;<span class="op" id="5795206">:=</span>&nbsp;<span class="num" id="5795209">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795213">for</span>&nbsp;<span class="ident" id="5795217">i</span><span class="op" id="5795218">,</span>&nbsp;<span class="ident" id="5795220">b</span>&nbsp;<span class="op" id="5795222">:=</span>&nbsp;<span class="keyword" id="5795225">range</span>&nbsp;<span class="ident" id="5795231">p</span><span class="op" id="5795232">[</span><span class="num" id="5795233">0</span><span class="op" id="5795234">:</span><span class="ident" id="5795235">n</span><span class="op" id="5795236">]</span>&nbsp;<span class="op" id="5795238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795243">if</span>&nbsp;<span class="ident" id="5795246">b</span>&nbsp;<span class="op" id="5795248">!=</span>&nbsp;<span class="string" id="5795251">&#39;\r&#39;</span>&nbsp;<span class="op" id="5795256">&amp;&amp;</span>&nbsp;<span class="ident" id="5795259">b</span>&nbsp;<span class="op" id="5795261">!=</span>&nbsp;<span class="string" id="5795264">&#39;\n&#39;</span>&nbsp;<span class="op" id="5795269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795275">if</span>&nbsp;<span class="ident" id="5795278">i</span>&nbsp;<span class="op" id="5795280">!=</span>&nbsp;<span class="ident" id="5795283">offset</span>&nbsp;<span class="op" id="5795290">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795297">p</span><span class="op" id="5795298">[</span><span class="ident" id="5795299">offset</span><span class="op" id="5795305">]</span>&nbsp;<span class="op" id="5795307">=</span>&nbsp;<span class="ident" id="5795309">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795315">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795321">offset</span><span class="op" id="5795327">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795337">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795341">if</span>&nbsp;<span class="ident" id="5795344">offset</span>&nbsp;<span class="op" id="5795351">&gt;</span>&nbsp;<span class="num" id="5795353">0</span>&nbsp;<span class="op" id="5795355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795360">return</span>&nbsp;<span class="ident" id="5795367">offset</span><span class="op" id="5795373">,</span>&nbsp;<span class="ident" id="5795375">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5795385">//&nbsp;Previous&nbsp;buffer&nbsp;entirely&nbsp;whitespace,&nbsp;read&nbsp;again</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5795438">n</span><span class="op" id="5795439">,</span>&nbsp;<span class="ident" id="5795441">err</span>&nbsp;<span class="op" id="5795445">=</span>&nbsp;<span class="ident" id="5795447">r</span><span class="op" id="5795448">.</span><span class="ident" id="5795449">wrapped</span><span class="op" id="5795456">.</span><span class="ident" id="5795457">Read</span><span class="op" id="5795461">(</span><span class="ident" id="5795462">p</span><span class="op" id="5795463">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5795466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795469">return</span>&nbsp;<span class="ident" id="5795476">n</span><span class="op" id="5795477">,</span>&nbsp;<span class="ident" id="5795479">err</span><br>
<span class="lineno"></span><span class="op" id="5795483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5795486">//&nbsp;NewDecoder&nbsp;constructs&nbsp;a&nbsp;new&nbsp;base32&nbsp;stream&nbsp;decoder.</span><br>
<span class="lineno">420</span><span class="keyword" id="5795540">func</span>&nbsp;<span class="ident" id="5795545">NewDecoder</span><span class="op" id="5795555">(</span><span class="ident" id="5795556">enc</span>&nbsp;<span class="op" id="5795560">*</span><span class="ident" id="5795561">Encoding</span><span class="op" id="5795569">,</span>&nbsp;<span class="ident" id="5795571">r</span>&nbsp;<span class="ident" id="5795573">io</span><span class="op" id="5795575">.</span><span class="ident" id="5795576">Reader</span><span class="op" id="5795582">)</span>&nbsp;<span class="ident" id="5795584">io</span><span class="op" id="5795586">.</span><span class="ident" id="5795587">Reader</span>&nbsp;<span class="op" id="5795594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5795597">return</span>&nbsp;<span class="op" id="5795604">&amp;</span><span class="ident" id="5795605">decoder</span><span class="op" id="5795612">{</span><span class="ident" id="5795613">enc</span><span class="op" id="5795616">:</span>&nbsp;<span class="ident" id="5795618">enc</span><span class="op" id="5795621">,</span>&nbsp;<span class="ident" id="5795623">r</span><span class="op" id="5795624">:</span>&nbsp;<span class="op" id="5795626">&amp;</span><span class="ident" id="5795627">newlineFilteringReader</span><span class="op" id="5795649">{</span><span class="ident" id="5795650">r</span><span class="op" id="5795651">}</span><span class="op" id="5795652">}</span><br>
<span class="lineno"></span><span class="op" id="5795654">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5795657">//&nbsp;DecodedLen&nbsp;returns&nbsp;the&nbsp;maximum&nbsp;length&nbsp;in&nbsp;bytes&nbsp;of&nbsp;the&nbsp;decoded&nbsp;data</span><br>
<span class="lineno">425</span><span class="comment" id="5795727">//&nbsp;corresponding&nbsp;to&nbsp;n&nbsp;bytes&nbsp;of&nbsp;base32-encoded&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="5795779">func</span>&nbsp;<span class="op" id="5795784">(</span><span class="ident" id="5795785">enc</span>&nbsp;<span class="op" id="5795789">*</span><span class="ident" id="5795790">Encoding</span><span class="op" id="5795798">)</span>&nbsp;<span class="ident" id="5795800">DecodedLen</span><span class="op" id="5795810">(</span><span class="ident" id="5795811">n</span>&nbsp;<span class="builtintype" id="5795813">int</span><span class="op" id="5795816">)</span>&nbsp;<span class="builtintype" id="5795818">int</span>&nbsp;<span class="op" id="5795822">{</span>&nbsp;<span class="keyword" id="5795824">return</span>&nbsp;<span class="ident" id="5795831">n</span>&nbsp;<span class="op" id="5795833">/</span>&nbsp;<span class="num" id="5795835">8</span>&nbsp;<span class="op" id="5795837">*</span>&nbsp;<span class="num" id="5795839">5</span>&nbsp;<span class="op" id="5795841">}</span>
</div>
</body>
</html>
