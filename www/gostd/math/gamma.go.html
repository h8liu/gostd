<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html" class="current">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2134865">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2134920">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2134974">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2135025">package</span>&nbsp;<span class="ident" id="2135033">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2135039">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2135099">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cprob/gamma.c.</span><br>
<span class="lineno"></span><span class="comment" id="2135164">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">10</span><span class="comment" id="2135222">//</span><br>
<span class="lineno"></span><span class="comment" id="2135225">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tgamma.c</span><br>
<span class="lineno"></span><span class="comment" id="2135242">//</span><br>
<span class="lineno"></span><span class="comment" id="2135245">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2135268">//</span><br>
<span class="lineno">15</span><span class="comment" id="2135271">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2135284">//</span><br>
<span class="lineno"></span><span class="comment" id="2135287">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;tgamma();</span><br>
<span class="lineno"></span><span class="comment" id="2135313">//&nbsp;extern&nbsp;int&nbsp;signgam;</span><br>
<span class="lineno"></span><span class="comment" id="2135336">//</span><br>
<span class="lineno">20</span><span class="comment" id="2135339">//&nbsp;y&nbsp;=&nbsp;tgamma(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2135359">//</span><br>
<span class="lineno"></span><span class="comment" id="2135362">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2135378">//</span><br>
<span class="lineno"></span><span class="comment" id="2135381">//&nbsp;Returns&nbsp;gamma&nbsp;function&nbsp;of&nbsp;the&nbsp;argument.&nbsp;&nbsp;The&nbsp;result&nbsp;is</span><br>
<span class="lineno">25</span><span class="comment" id="2135439">//&nbsp;correctly&nbsp;signed,&nbsp;and&nbsp;the&nbsp;sign&nbsp;(+1&nbsp;or&nbsp;-1)&nbsp;is&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="2135492">//&nbsp;returned&nbsp;in&nbsp;a&nbsp;global&nbsp;(extern)&nbsp;variable&nbsp;named&nbsp;signgam.</span><br>
<span class="lineno"></span><span class="comment" id="2135549">//&nbsp;This&nbsp;variable&nbsp;is&nbsp;also&nbsp;filled&nbsp;in&nbsp;by&nbsp;the&nbsp;logarithmic&nbsp;gamma</span><br>
<span class="lineno"></span><span class="comment" id="2135609">//&nbsp;function&nbsp;lgamma().</span><br>
<span class="lineno"></span><span class="comment" id="2135631">//</span><br>
<span class="lineno">30</span><span class="comment" id="2135634">//&nbsp;Arguments&nbsp;|x|&nbsp;&lt;=&nbsp;34&nbsp;are&nbsp;reduced&nbsp;by&nbsp;recurrence&nbsp;and&nbsp;the&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2135700">//&nbsp;approximated&nbsp;by&nbsp;a&nbsp;rational&nbsp;function&nbsp;of&nbsp;degree&nbsp;6/7&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2135760">//&nbsp;interval&nbsp;(2,3).&nbsp;&nbsp;Large&nbsp;arguments&nbsp;are&nbsp;handled&nbsp;by&nbsp;Stirling&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="2135822">//&nbsp;formula.&nbsp;Large&nbsp;negative&nbsp;arguments&nbsp;are&nbsp;made&nbsp;positive&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="2135883">//&nbsp;a&nbsp;reflection&nbsp;formula.</span><br>
<span class="lineno">35</span><span class="comment" id="2135908">//</span><br>
<span class="lineno"></span><span class="comment" id="2135911">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2135924">//</span><br>
<span class="lineno"></span><span class="comment" id="2135927">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2135967">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2136025">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-34,&nbsp;34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.3e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.5e-17</span><br>
<span class="lineno"></span><span class="comment" id="2136085">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;-170,-33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.3e-16</span><br>
<span class="lineno"></span><span class="comment" id="2136145">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-33,&nbsp;&nbsp;33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.4e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2136205">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33,&nbsp;171.6&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2136265">//</span><br>
<span class="lineno">45</span><span class="comment" id="2136268">//&nbsp;Error&nbsp;for&nbsp;arguments&nbsp;outside&nbsp;the&nbsp;test&nbsp;range&nbsp;will&nbsp;be&nbsp;larger</span><br>
<span class="lineno"></span><span class="comment" id="2136329">//&nbsp;owing&nbsp;to&nbsp;error&nbsp;amplification&nbsp;by&nbsp;the&nbsp;exponential&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="2136390">//</span><br>
<span class="lineno"></span><span class="comment" id="2136393">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="2136441">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">50</span><span class="comment" id="2136505">//</span><br>
<span class="lineno"></span><span class="comment" id="2136508">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2136569">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2136639">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="2136714">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">55</span><span class="comment" id="2136781">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2136854">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2136926">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2136940">//</span><br>
<span class="lineno"></span><span class="comment" id="2136943">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">60</span><span class="comment" id="2137009">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2137075">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2137088">//</span><br>
<span class="lineno"></span><span class="comment" id="2137091">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2137115">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2137145">var</span>&nbsp;<span class="ident" id="2137149">_gamP</span>&nbsp;<span class="op" id="2137155">=</span>&nbsp;<span class="op" id="2137157">[</span><span class="op" id="2137158">...</span><span class="op" id="2137161">]</span><span class="builtintype" id="2137162">float64</span><span class="op" id="2137169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137172">1.60119522476751861407e-04</span><span class="op" id="2137198">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137201">1.19135147006586384913e-03</span><span class="op" id="2137227">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137230">1.04213797561761569935e-02</span><span class="op" id="2137256">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137259">4.76367800457137231464e-02</span><span class="op" id="2137285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137288">2.07448227648435975150e-01</span><span class="op" id="2137314">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137317">4.94214826801497100753e-01</span><span class="op" id="2137343">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137346">9.99999999999999996796e-01</span><span class="op" id="2137372">,</span><br>
<span class="lineno"></span><span class="op" id="2137374">}</span><br>
<span class="lineno">75</span><span class="keyword" id="2137376">var</span>&nbsp;<span class="ident" id="2137380">_gamQ</span>&nbsp;<span class="op" id="2137386">=</span>&nbsp;<span class="op" id="2137388">[</span><span class="op" id="2137389">...</span><span class="op" id="2137392">]</span><span class="builtintype" id="2137393">float64</span><span class="op" id="2137400">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2137403">-</span><span class="num" id="2137404">2.31581873324120129819e-05</span><span class="op" id="2137430">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137433">5.39605580493303397842e-04</span><span class="op" id="2137459">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2137462">-</span><span class="num" id="2137463">4.45641913851797240494e-03</span><span class="op" id="2137489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137492">1.18139785222060435552e-02</span><span class="op" id="2137518">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137521">3.58236398605498653373e-02</span><span class="op" id="2137547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2137550">-</span><span class="num" id="2137551">2.34591795718243348568e-01</span><span class="op" id="2137577">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137580">7.14304917030273074085e-02</span><span class="op" id="2137606">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137609">1.00000000000000000320e+00</span><span class="op" id="2137635">,</span><br>
<span class="lineno"></span><span class="op" id="2137637">}</span><br>
<span class="lineno">85</span><span class="keyword" id="2137639">var</span>&nbsp;<span class="ident" id="2137643">_gamS</span>&nbsp;<span class="op" id="2137649">=</span>&nbsp;<span class="op" id="2137651">[</span><span class="op" id="2137652">...</span><span class="op" id="2137655">]</span><span class="builtintype" id="2137656">float64</span><span class="op" id="2137663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137666">7.87311395793093628397e-04</span><span class="op" id="2137692">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2137695">-</span><span class="num" id="2137696">2.29549961613378126380e-04</span><span class="op" id="2137722">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2137725">-</span><span class="num" id="2137726">2.68132617805781232825e-03</span><span class="op" id="2137752">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137755">3.47222221605458667310e-03</span><span class="op" id="2137781">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2137784">8.33333333333482257126e-02</span><span class="op" id="2137810">,</span><br>
<span class="lineno"></span><span class="op" id="2137812">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2137815">//&nbsp;Gamma&nbsp;function&nbsp;computed&nbsp;by&nbsp;Stirling&#39;s&nbsp;formula.</span><br>
<span class="lineno"></span><span class="comment" id="2137865">//&nbsp;The&nbsp;polynomial&nbsp;is&nbsp;valid&nbsp;for&nbsp;33&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;172.</span><br>
<span class="lineno">95</span><span class="keyword" id="2137912">func</span>&nbsp;<span class="ident" id="2137917">stirling</span><span class="op" id="2137925">(</span><span class="ident" id="2137926">x</span>&nbsp;<span class="builtintype" id="2137928">float64</span><span class="op" id="2137935">)</span>&nbsp;<span class="builtintype" id="2137937">float64</span>&nbsp;<span class="op" id="2137945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2137948">const</span>&nbsp;<span class="op" id="2137954">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2137958">SqrtTwoPi</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2137970">=</span>&nbsp;<span class="num" id="2137972">2.506628274631000502417</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2137998">MaxStirling</span>&nbsp;<span class="op" id="2138010">=</span>&nbsp;<span class="num" id="2138012">143.01608</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2138023">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138026">w</span>&nbsp;<span class="op" id="2138028">:=</span>&nbsp;<span class="num" id="2138031">1</span>&nbsp;<span class="op" id="2138033">/</span>&nbsp;<span class="ident" id="2138035">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138038">w</span>&nbsp;<span class="op" id="2138040">=</span>&nbsp;<span class="num" id="2138042">1</span>&nbsp;<span class="op" id="2138044">+</span>&nbsp;<span class="ident" id="2138046">w</span><span class="op" id="2138047">*</span><span class="op" id="2138048">(</span><span class="op" id="2138049">(</span><span class="op" id="2138050">(</span><span class="op" id="2138051">(</span><span class="ident" id="2138052">_gamS</span><span class="op" id="2138057">[</span><span class="num" id="2138058">0</span><span class="op" id="2138059">]</span><span class="op" id="2138060">*</span><span class="ident" id="2138061">w</span><span class="op" id="2138062">+</span><span class="ident" id="2138063">_gamS</span><span class="op" id="2138068">[</span><span class="num" id="2138069">1</span><span class="op" id="2138070">]</span><span class="op" id="2138071">)</span><span class="op" id="2138072">*</span><span class="ident" id="2138073">w</span><span class="op" id="2138074">+</span><span class="ident" id="2138075">_gamS</span><span class="op" id="2138080">[</span><span class="num" id="2138081">2</span><span class="op" id="2138082">]</span><span class="op" id="2138083">)</span><span class="op" id="2138084">*</span><span class="ident" id="2138085">w</span><span class="op" id="2138086">+</span><span class="ident" id="2138087">_gamS</span><span class="op" id="2138092">[</span><span class="num" id="2138093">3</span><span class="op" id="2138094">]</span><span class="op" id="2138095">)</span><span class="op" id="2138096">*</span><span class="ident" id="2138097">w</span><span class="op" id="2138098">+</span><span class="ident" id="2138099">_gamS</span><span class="op" id="2138104">[</span><span class="num" id="2138105">4</span><span class="op" id="2138106">]</span><span class="op" id="2138107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138110">y</span>&nbsp;<span class="op" id="2138112">:=</span>&nbsp;<span class="ident" id="2138115">Exp</span><span class="op" id="2138118">(</span><span class="ident" id="2138119">x</span><span class="op" id="2138120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138123">if</span>&nbsp;<span class="ident" id="2138126">x</span>&nbsp;<span class="op" id="2138128">&gt;</span>&nbsp;<span class="ident" id="2138130">MaxStirling</span>&nbsp;<span class="op" id="2138142">{</span>&nbsp;<span class="comment" id="2138144">//&nbsp;avoid&nbsp;Pow()&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138170">v</span>&nbsp;<span class="op" id="2138172">:=</span>&nbsp;<span class="ident" id="2138175">Pow</span><span class="op" id="2138178">(</span><span class="ident" id="2138179">x</span><span class="op" id="2138180">,</span>&nbsp;<span class="num" id="2138182">0.5</span><span class="op" id="2138185">*</span><span class="ident" id="2138186">x</span><span class="op" id="2138187">-</span><span class="num" id="2138188">0.25</span><span class="op" id="2138192">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138196">y</span>&nbsp;<span class="op" id="2138198">=</span>&nbsp;<span class="ident" id="2138200">v</span>&nbsp;<span class="op" id="2138202">*</span>&nbsp;<span class="op" id="2138204">(</span><span class="ident" id="2138205">v</span>&nbsp;<span class="op" id="2138207">/</span>&nbsp;<span class="ident" id="2138209">y</span><span class="op" id="2138210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2138213">}</span>&nbsp;<span class="keyword" id="2138215">else</span>&nbsp;<span class="op" id="2138220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138224">y</span>&nbsp;<span class="op" id="2138226">=</span>&nbsp;<span class="ident" id="2138228">Pow</span><span class="op" id="2138231">(</span><span class="ident" id="2138232">x</span><span class="op" id="2138233">,</span>&nbsp;<span class="ident" id="2138235">x</span><span class="op" id="2138236">-</span><span class="num" id="2138237">0.5</span><span class="op" id="2138240">)</span>&nbsp;<span class="op" id="2138242">/</span>&nbsp;<span class="ident" id="2138244">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2138247">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138250">y</span>&nbsp;<span class="op" id="2138252">=</span>&nbsp;<span class="ident" id="2138254">SqrtTwoPi</span>&nbsp;<span class="op" id="2138264">*</span>&nbsp;<span class="ident" id="2138266">y</span>&nbsp;<span class="op" id="2138268">*</span>&nbsp;<span class="ident" id="2138270">w</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138273">return</span>&nbsp;<span class="ident" id="2138280">y</span><br>
<span class="lineno"></span><span class="op" id="2138282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2138285">//&nbsp;Gamma&nbsp;returns&nbsp;the&nbsp;Gamma&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2138327">//</span><br>
<span class="lineno">115</span><span class="comment" id="2138330">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2138352">//&nbsp;&nbsp;&nbsp;&nbspGamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2138374">//&nbsp;&nbsp;&nbsp;&nbspGamma(+0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2138394">//&nbsp;&nbsp;&nbsp;&nbspGamma(-0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2138414">//&nbsp;&nbsp;&nbsp;&nbspGamma(x)&nbsp;=&nbsp;NaN&nbsp;for&nbsp;integer&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno">120</span><span class="comment" id="2138450">//&nbsp;&nbsp;&nbsp;&nbspGamma(-Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2138471">//&nbsp;&nbsp;&nbsp;&nbspGamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2138491">func</span>&nbsp;<span class="ident" id="2138496">Gamma</span><span class="op" id="2138501">(</span><span class="ident" id="2138502">x</span>&nbsp;<span class="builtintype" id="2138504">float64</span><span class="op" id="2138511">)</span>&nbsp;<span class="builtintype" id="2138513">float64</span>&nbsp;<span class="op" id="2138521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138524">const</span>&nbsp;<span class="ident" id="2138530">Euler</span>&nbsp;<span class="op" id="2138536">=</span>&nbsp;<span class="num" id="2138538">0.57721566490153286060651209008240243104215933593992</span>&nbsp;<span class="comment" id="2138591">//&nbsp;A001620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2138603">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138621">switch</span>&nbsp;<span class="op" id="2138628">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138631">case</span>&nbsp;<span class="ident" id="2138636">isNegInt</span><span class="op" id="2138644">(</span><span class="ident" id="2138645">x</span><span class="op" id="2138646">)</span>&nbsp;<span class="op" id="2138648">||</span>&nbsp;<span class="ident" id="2138651">IsInf</span><span class="op" id="2138656">(</span><span class="ident" id="2138657">x</span><span class="op" id="2138658">,</span>&nbsp;<span class="op" id="2138660">-</span><span class="num" id="2138661">1</span><span class="op" id="2138662">)</span>&nbsp;<span class="op" id="2138664">||</span>&nbsp;<span class="ident" id="2138667">IsNaN</span><span class="op" id="2138672">(</span><span class="ident" id="2138673">x</span><span class="op" id="2138674">)</span><span class="op" id="2138675">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138679">return</span>&nbsp;<span class="ident" id="2138686">NaN</span><span class="op" id="2138689">(</span><span class="op" id="2138690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138693">case</span>&nbsp;<span class="ident" id="2138698">x</span>&nbsp;<span class="op" id="2138700">==</span>&nbsp;<span class="num" id="2138703">0</span><span class="op" id="2138704">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138708">if</span>&nbsp;<span class="ident" id="2138711">Signbit</span><span class="op" id="2138718">(</span><span class="ident" id="2138719">x</span><span class="op" id="2138720">)</span>&nbsp;<span class="op" id="2138722">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138727">return</span>&nbsp;<span class="ident" id="2138734">Inf</span><span class="op" id="2138737">(</span><span class="op" id="2138738">-</span><span class="num" id="2138739">1</span><span class="op" id="2138740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2138744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138748">return</span>&nbsp;<span class="ident" id="2138755">Inf</span><span class="op" id="2138758">(</span><span class="num" id="2138759">1</span><span class="op" id="2138760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138763">case</span>&nbsp;<span class="ident" id="2138768">x</span>&nbsp;<span class="op" id="2138770">&lt;</span>&nbsp;<span class="op" id="2138772">-</span><span class="num" id="2138773">170.5674972726612</span>&nbsp;<span class="op" id="2138791">||</span>&nbsp;<span class="ident" id="2138794">x</span>&nbsp;<span class="op" id="2138796">&gt;</span>&nbsp;<span class="num" id="2138798">171.61447887182298</span><span class="op" id="2138816">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138820">return</span>&nbsp;<span class="ident" id="2138827">Inf</span><span class="op" id="2138830">(</span><span class="num" id="2138831">1</span><span class="op" id="2138832">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2138835">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138838">q</span>&nbsp;<span class="op" id="2138840">:=</span>&nbsp;<span class="ident" id="2138843">Abs</span><span class="op" id="2138846">(</span><span class="ident" id="2138847">x</span><span class="op" id="2138848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138851">p</span>&nbsp;<span class="op" id="2138853">:=</span>&nbsp;<span class="ident" id="2138856">Floor</span><span class="op" id="2138861">(</span><span class="ident" id="2138862">q</span><span class="op" id="2138863">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138866">if</span>&nbsp;<span class="ident" id="2138869">q</span>&nbsp;<span class="op" id="2138871">&gt;</span>&nbsp;<span class="num" id="2138873">33</span>&nbsp;<span class="op" id="2138876">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138880">if</span>&nbsp;<span class="ident" id="2138883">x</span>&nbsp;<span class="op" id="2138885">&gt;=</span>&nbsp;<span class="num" id="2138888">0</span>&nbsp;<span class="op" id="2138890">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138895">return</span>&nbsp;<span class="ident" id="2138902">stirling</span><span class="op" id="2138910">(</span><span class="ident" id="2138911">x</span><span class="op" id="2138912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2138916">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138920">signgam</span>&nbsp;<span class="op" id="2138928">:=</span>&nbsp;<span class="num" id="2138931">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138935">if</span>&nbsp;<span class="ident" id="2138938">ip</span>&nbsp;<span class="op" id="2138941">:=</span>&nbsp;<span class="builtintype" id="2138944">int</span><span class="op" id="2138947">(</span><span class="ident" id="2138948">p</span><span class="op" id="2138949">)</span><span class="op" id="2138950">;</span>&nbsp;<span class="ident" id="2138952">ip</span><span class="op" id="2138954">&amp;</span><span class="num" id="2138955">1</span>&nbsp;<span class="op" id="2138957">==</span>&nbsp;<span class="num" id="2138960">0</span>&nbsp;<span class="op" id="2138962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138967">signgam</span>&nbsp;<span class="op" id="2138975">=</span>&nbsp;<span class="op" id="2138977">-</span><span class="num" id="2138978">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2138982">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2138986">z</span>&nbsp;<span class="op" id="2138988">:=</span>&nbsp;<span class="ident" id="2138991">q</span>&nbsp;<span class="op" id="2138993">-</span>&nbsp;<span class="ident" id="2138995">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2138999">if</span>&nbsp;<span class="ident" id="2139002">z</span>&nbsp;<span class="op" id="2139004">&gt;</span>&nbsp;<span class="num" id="2139006">0.5</span>&nbsp;<span class="op" id="2139010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139015">p</span>&nbsp;<span class="op" id="2139017">=</span>&nbsp;<span class="ident" id="2139019">p</span>&nbsp;<span class="op" id="2139021">+</span>&nbsp;<span class="num" id="2139023">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139028">z</span>&nbsp;<span class="op" id="2139030">=</span>&nbsp;<span class="ident" id="2139032">q</span>&nbsp;<span class="op" id="2139034">-</span>&nbsp;<span class="ident" id="2139036">p</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139044">z</span>&nbsp;<span class="op" id="2139046">=</span>&nbsp;<span class="ident" id="2139048">q</span>&nbsp;<span class="op" id="2139050">*</span>&nbsp;<span class="ident" id="2139052">Sin</span><span class="op" id="2139055">(</span><span class="ident" id="2139056">Pi</span><span class="op" id="2139058">*</span><span class="ident" id="2139059">z</span><span class="op" id="2139060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139064">if</span>&nbsp;<span class="ident" id="2139067">z</span>&nbsp;<span class="op" id="2139069">==</span>&nbsp;<span class="num" id="2139072">0</span>&nbsp;<span class="op" id="2139074">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139079">return</span>&nbsp;<span class="ident" id="2139086">Inf</span><span class="op" id="2139089">(</span><span class="ident" id="2139090">signgam</span><span class="op" id="2139097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139101">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139105">z</span>&nbsp;<span class="op" id="2139107">=</span>&nbsp;<span class="ident" id="2139109">Pi</span>&nbsp;<span class="op" id="2139112">/</span>&nbsp;<span class="op" id="2139114">(</span><span class="ident" id="2139115">Abs</span><span class="op" id="2139118">(</span><span class="ident" id="2139119">z</span><span class="op" id="2139120">)</span>&nbsp;<span class="op" id="2139122">*</span>&nbsp;<span class="ident" id="2139124">stirling</span><span class="op" id="2139132">(</span><span class="ident" id="2139133">q</span><span class="op" id="2139134">)</span><span class="op" id="2139135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139139">return</span>&nbsp;<span class="builtintype" id="2139146">float64</span><span class="op" id="2139153">(</span><span class="ident" id="2139154">signgam</span><span class="op" id="2139161">)</span>&nbsp;<span class="op" id="2139163">*</span>&nbsp;<span class="ident" id="2139165">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139168">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2139172">//&nbsp;Reduce&nbsp;argument</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139192">z</span>&nbsp;<span class="op" id="2139194">:=</span>&nbsp;<span class="num" id="2139197">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139202">for</span>&nbsp;<span class="ident" id="2139206">x</span>&nbsp;<span class="op" id="2139208">&gt;=</span>&nbsp;<span class="num" id="2139211">3</span>&nbsp;<span class="op" id="2139213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139217">x</span>&nbsp;<span class="op" id="2139219">=</span>&nbsp;<span class="ident" id="2139221">x</span>&nbsp;<span class="op" id="2139223">-</span>&nbsp;<span class="num" id="2139225">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139229">z</span>&nbsp;<span class="op" id="2139231">=</span>&nbsp;<span class="ident" id="2139233">z</span>&nbsp;<span class="op" id="2139235">*</span>&nbsp;<span class="ident" id="2139237">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139240">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139243">for</span>&nbsp;<span class="ident" id="2139247">x</span>&nbsp;<span class="op" id="2139249">&lt;</span>&nbsp;<span class="num" id="2139251">0</span>&nbsp;<span class="op" id="2139253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139257">if</span>&nbsp;<span class="ident" id="2139260">x</span>&nbsp;<span class="op" id="2139262">&gt;</span>&nbsp;<span class="op" id="2139264">-</span><span class="num" id="2139265">1e-09</span>&nbsp;<span class="op" id="2139271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139276">goto</span>&nbsp;<span class="ident" id="2139281">small</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139293">z</span>&nbsp;<span class="op" id="2139295">=</span>&nbsp;<span class="ident" id="2139297">z</span>&nbsp;<span class="op" id="2139299">/</span>&nbsp;<span class="ident" id="2139301">x</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139305">x</span>&nbsp;<span class="op" id="2139307">=</span>&nbsp;<span class="ident" id="2139309">x</span>&nbsp;<span class="op" id="2139311">+</span>&nbsp;<span class="num" id="2139313">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139316">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139319">for</span>&nbsp;<span class="ident" id="2139323">x</span>&nbsp;<span class="op" id="2139325">&lt;</span>&nbsp;<span class="num" id="2139327">2</span>&nbsp;<span class="op" id="2139329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139333">if</span>&nbsp;<span class="ident" id="2139336">x</span>&nbsp;<span class="op" id="2139338">&lt;</span>&nbsp;<span class="num" id="2139340">1e-09</span>&nbsp;<span class="op" id="2139346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139351">goto</span>&nbsp;<span class="ident" id="2139356">small</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139364">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139368">z</span>&nbsp;<span class="op" id="2139370">=</span>&nbsp;<span class="ident" id="2139372">z</span>&nbsp;<span class="op" id="2139374">/</span>&nbsp;<span class="ident" id="2139376">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139380">x</span>&nbsp;<span class="op" id="2139382">=</span>&nbsp;<span class="ident" id="2139384">x</span>&nbsp;<span class="op" id="2139386">+</span>&nbsp;<span class="num" id="2139388">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139395">if</span>&nbsp;<span class="ident" id="2139398">x</span>&nbsp;<span class="op" id="2139400">==</span>&nbsp;<span class="num" id="2139403">2</span>&nbsp;<span class="op" id="2139405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139409">return</span>&nbsp;<span class="ident" id="2139416">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139419">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139423">x</span>&nbsp;<span class="op" id="2139425">=</span>&nbsp;<span class="ident" id="2139427">x</span>&nbsp;<span class="op" id="2139429">-</span>&nbsp;<span class="num" id="2139431">2</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139434">p</span>&nbsp;<span class="op" id="2139436">=</span>&nbsp;<span class="op" id="2139438">(</span><span class="op" id="2139439">(</span><span class="op" id="2139440">(</span><span class="op" id="2139441">(</span><span class="op" id="2139442">(</span><span class="ident" id="2139443">x</span><span class="op" id="2139444">*</span><span class="ident" id="2139445">_gamP</span><span class="op" id="2139450">[</span><span class="num" id="2139451">0</span><span class="op" id="2139452">]</span><span class="op" id="2139453">+</span><span class="ident" id="2139454">_gamP</span><span class="op" id="2139459">[</span><span class="num" id="2139460">1</span><span class="op" id="2139461">]</span><span class="op" id="2139462">)</span><span class="op" id="2139463">*</span><span class="ident" id="2139464">x</span><span class="op" id="2139465">+</span><span class="ident" id="2139466">_gamP</span><span class="op" id="2139471">[</span><span class="num" id="2139472">2</span><span class="op" id="2139473">]</span><span class="op" id="2139474">)</span><span class="op" id="2139475">*</span><span class="ident" id="2139476">x</span><span class="op" id="2139477">+</span><span class="ident" id="2139478">_gamP</span><span class="op" id="2139483">[</span><span class="num" id="2139484">3</span><span class="op" id="2139485">]</span><span class="op" id="2139486">)</span><span class="op" id="2139487">*</span><span class="ident" id="2139488">x</span><span class="op" id="2139489">+</span><span class="ident" id="2139490">_gamP</span><span class="op" id="2139495">[</span><span class="num" id="2139496">4</span><span class="op" id="2139497">]</span><span class="op" id="2139498">)</span><span class="op" id="2139499">*</span><span class="ident" id="2139500">x</span><span class="op" id="2139501">+</span><span class="ident" id="2139502">_gamP</span><span class="op" id="2139507">[</span><span class="num" id="2139508">5</span><span class="op" id="2139509">]</span><span class="op" id="2139510">)</span><span class="op" id="2139511">*</span><span class="ident" id="2139512">x</span>&nbsp;<span class="op" id="2139514">+</span>&nbsp;<span class="ident" id="2139516">_gamP</span><span class="op" id="2139521">[</span><span class="num" id="2139522">6</span><span class="op" id="2139523">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139526">q</span>&nbsp;<span class="op" id="2139528">=</span>&nbsp;<span class="op" id="2139530">(</span><span class="op" id="2139531">(</span><span class="op" id="2139532">(</span><span class="op" id="2139533">(</span><span class="op" id="2139534">(</span><span class="op" id="2139535">(</span><span class="ident" id="2139536">x</span><span class="op" id="2139537">*</span><span class="ident" id="2139538">_gamQ</span><span class="op" id="2139543">[</span><span class="num" id="2139544">0</span><span class="op" id="2139545">]</span><span class="op" id="2139546">+</span><span class="ident" id="2139547">_gamQ</span><span class="op" id="2139552">[</span><span class="num" id="2139553">1</span><span class="op" id="2139554">]</span><span class="op" id="2139555">)</span><span class="op" id="2139556">*</span><span class="ident" id="2139557">x</span><span class="op" id="2139558">+</span><span class="ident" id="2139559">_gamQ</span><span class="op" id="2139564">[</span><span class="num" id="2139565">2</span><span class="op" id="2139566">]</span><span class="op" id="2139567">)</span><span class="op" id="2139568">*</span><span class="ident" id="2139569">x</span><span class="op" id="2139570">+</span><span class="ident" id="2139571">_gamQ</span><span class="op" id="2139576">[</span><span class="num" id="2139577">3</span><span class="op" id="2139578">]</span><span class="op" id="2139579">)</span><span class="op" id="2139580">*</span><span class="ident" id="2139581">x</span><span class="op" id="2139582">+</span><span class="ident" id="2139583">_gamQ</span><span class="op" id="2139588">[</span><span class="num" id="2139589">4</span><span class="op" id="2139590">]</span><span class="op" id="2139591">)</span><span class="op" id="2139592">*</span><span class="ident" id="2139593">x</span><span class="op" id="2139594">+</span><span class="ident" id="2139595">_gamQ</span><span class="op" id="2139600">[</span><span class="num" id="2139601">5</span><span class="op" id="2139602">]</span><span class="op" id="2139603">)</span><span class="op" id="2139604">*</span><span class="ident" id="2139605">x</span><span class="op" id="2139606">+</span><span class="ident" id="2139607">_gamQ</span><span class="op" id="2139612">[</span><span class="num" id="2139613">6</span><span class="op" id="2139614">]</span><span class="op" id="2139615">)</span><span class="op" id="2139616">*</span><span class="ident" id="2139617">x</span>&nbsp;<span class="op" id="2139619">+</span>&nbsp;<span class="ident" id="2139621">_gamQ</span><span class="op" id="2139626">[</span><span class="num" id="2139627">7</span><span class="op" id="2139628">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139631">return</span>&nbsp;<span class="ident" id="2139638">z</span>&nbsp;<span class="op" id="2139640">*</span>&nbsp;<span class="ident" id="2139642">p</span>&nbsp;<span class="op" id="2139644">/</span>&nbsp;<span class="ident" id="2139646">q</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="2139649">small</span><span class="op" id="2139654">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139657">if</span>&nbsp;<span class="ident" id="2139660">x</span>&nbsp;<span class="op" id="2139662">==</span>&nbsp;<span class="num" id="2139665">0</span>&nbsp;<span class="op" id="2139667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139671">return</span>&nbsp;<span class="ident" id="2139678">Inf</span><span class="op" id="2139681">(</span><span class="num" id="2139682">1</span><span class="op" id="2139683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139686">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139689">return</span>&nbsp;<span class="ident" id="2139696">z</span>&nbsp;<span class="op" id="2139698">/</span>&nbsp;<span class="op" id="2139700">(</span><span class="op" id="2139701">(</span><span class="num" id="2139702">1</span>&nbsp;<span class="op" id="2139704">+</span>&nbsp;<span class="ident" id="2139706">Euler</span><span class="op" id="2139711">*</span><span class="ident" id="2139712">x</span><span class="op" id="2139713">)</span>&nbsp;<span class="op" id="2139715">*</span>&nbsp;<span class="ident" id="2139717">x</span><span class="op" id="2139718">)</span><br>
<span class="lineno"></span><span class="op" id="2139720">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="2139723">func</span>&nbsp;<span class="ident" id="2139728">isNegInt</span><span class="op" id="2139736">(</span><span class="ident" id="2139737">x</span>&nbsp;<span class="builtintype" id="2139739">float64</span><span class="op" id="2139746">)</span>&nbsp;<span class="builtintype" id="2139748">bool</span>&nbsp;<span class="op" id="2139753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139756">if</span>&nbsp;<span class="ident" id="2139759">x</span>&nbsp;<span class="op" id="2139761">&lt;</span>&nbsp;<span class="num" id="2139763">0</span>&nbsp;<span class="op" id="2139765">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2139769">_</span><span class="op" id="2139770">,</span>&nbsp;<span class="ident" id="2139772">xf</span>&nbsp;<span class="op" id="2139775">:=</span>&nbsp;<span class="ident" id="2139778">Modf</span><span class="op" id="2139782">(</span><span class="ident" id="2139783">x</span><span class="op" id="2139784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139788">return</span>&nbsp;<span class="ident" id="2139795">xf</span>&nbsp;<span class="op" id="2139798">==</span>&nbsp;<span class="num" id="2139801">0</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2139804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2139807">return</span>&nbsp;<span class="builtintype" id="2139814">false</span><br>
<span class="lineno"></span><span class="op" id="2139820">}</span>
</div>
</body>
</html>
