<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4009679">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4009734">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4009788">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4009839">package</span>&nbsp;<span class="ident" id="4009847">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4009853">import</span>&nbsp;<span class="op" id="4009860">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4009863">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4009883">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4009900">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4009910">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="4009916">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4009919">//&nbsp;pkcs8&nbsp;reflects&nbsp;an&nbsp;ASN.1,&nbsp;PKCS#8&nbsp;PrivateKey.&nbsp;See</span><br>
<span class="lineno">15</span><span class="comment" id="4009970">//&nbsp;ftp://ftp.rsasecurity.com/pub/pkcs/pkcs-8/pkcs-8v1_2.asn</span><br>
<span class="lineno"></span><span class="comment" id="4010030">//&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="4010046">type</span>&nbsp;<span class="ident" id="4010051">pkcs8</span>&nbsp;<span class="keyword" id="4010057">struct</span>&nbsp;<span class="op" id="4010064">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010067">Version</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4010078">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010083">Algo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4010094"><a href="/crypto/x509/pkcs8.go.html#4009863">pkix</a></span><span class="op" id="4010098">.</span><span class="ident" id="4010099">AlgorithmIdentifier</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010120">PrivateKey</span>&nbsp;<span class="op" id="4010131">[</span><span class="op" id="4010132">]</span><span class="builtintype" id="4010133">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4010139">//&nbsp;optional&nbsp;attributes&nbsp;omitted.</span><br>
<span class="lineno"></span><span class="op" id="4010171">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4010174">//&nbsp;ParsePKCS8PrivateKey&nbsp;parses&nbsp;an&nbsp;unencrypted,&nbsp;PKCS#8&nbsp;private&nbsp;key.&nbsp;See</span><br>
<span class="lineno">25</span><span class="comment" id="4010245">//&nbsp;http://www.rsa.com/rsalabs/node.asp?id=2130&nbsp;and&nbsp;RFC5208.</span><br>
<span class="lineno"></span><span class="keyword" id="4010305">func</span>&nbsp;<span class="ident" id="4010310">ParsePKCS8PrivateKey</span><span class="op" id="4010330">(</span><span class="ident" id="4010331">der</span>&nbsp;<span class="op" id="4010335">[</span><span class="op" id="4010336">]</span><span class="builtintype" id="4010337">byte</span><span class="op" id="4010341">)</span>&nbsp;<span class="op" id="4010343">(</span><span class="ident" id="4010344">key</span>&nbsp;<span class="keyword" id="4010348">interface</span><span class="op" id="4010357">{</span><span class="op" id="4010358">}</span><span class="op" id="4010359">,</span>&nbsp;<span class="ident" id="4010361">err</span>&nbsp;<span class="builtintype" id="4010365">error</span><span class="op" id="4010370">)</span>&nbsp;<span class="op" id="4010372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010375">var</span>&nbsp;<span class="ident" id="4010379">privKey</span>&nbsp;<span class="ident" id="4010387"><a href="/crypto/x509/pkcs8.go.html#4010051">pkcs8</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010394">if</span>&nbsp;<span class="ident" id="4010397">_</span><span class="op" id="4010398">,</span>&nbsp;<span class="ident" id="4010400">err</span>&nbsp;<span class="op" id="4010404">:=</span>&nbsp;<span class="ident" id="4010407"><a href="/crypto/x509/pkcs8.go.html#4009883">asn1</a></span><span class="op" id="4010411">.</span><span class="ident" id="4010412">Unmarshal</span><span class="op" id="4010421">(</span><span class="ident" id="4010422"><a href="/crypto/x509/pkcs8.go.html#4010331">der</a></span><span class="op" id="4010425">,</span>&nbsp;<span class="op" id="4010427">&amp;</span><span class="ident" id="4010428"><a href="/crypto/x509/pkcs8.go.html#4010379">privKey</a></span><span class="op" id="4010435">)</span><span class="op" id="4010436">;</span>&nbsp;<span class="ident" id="4010438"><a href="/crypto/x509/pkcs8.go.html#4010400">err</a></span>&nbsp;<span class="op" id="4010442">!=</span>&nbsp;<span class="ident" id="4010445">nil</span>&nbsp;<span class="op" id="4010449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010453">return</span>&nbsp;<span class="ident" id="4010460">nil</span><span class="op" id="4010463">,</span>&nbsp;<span class="ident" id="4010465"><a href="/crypto/x509/pkcs8.go.html#4010400">err</a></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4010470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010473">switch</span>&nbsp;<span class="op" id="4010480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010483">case</span>&nbsp;<span class="ident" id="4010488"><a href="/crypto/x509/pkcs8.go.html#4010379">privKey</a></span><span class="op" id="4010495">.</span><span class="ident" id="4010496">Algo</span><span class="op" id="4010500">.</span><span class="ident" id="4010501">Algorithm</span><span class="op" id="4010510">.</span><span class="ident" id="4010511">Equal</span><span class="op" id="4010516">(</span><span class="ident" id="4010517"><a href="/crypto/x509/x509.go.html#4038357">oidPublicKeyRSA</a></span><span class="op" id="4010532">)</span><span class="op" id="4010533">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010537"><a href="/crypto/x509/pkcs8.go.html#4010344">key</a></span><span class="op" id="4010540">,</span>&nbsp;<span class="ident" id="4010542"><a href="/crypto/x509/pkcs8.go.html#4010361">err</a></span>&nbsp;<span class="op" id="4010546">=</span>&nbsp;<span class="ident" id="4010548"><a href="/crypto/x509/pkcs1.go.html#4007677">ParsePKCS1PrivateKey</a></span><span class="op" id="4010568">(</span><span class="ident" id="4010569"><a href="/crypto/x509/pkcs8.go.html#4010379">privKey</a></span><span class="op" id="4010576">.</span><span class="ident" id="4010577">PrivateKey</span><span class="op" id="4010587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010591">if</span>&nbsp;<span class="ident" id="4010594"><a href="/crypto/x509/pkcs8.go.html#4010361">err</a></span>&nbsp;<span class="op" id="4010598">!=</span>&nbsp;<span class="ident" id="4010601">nil</span>&nbsp;<span class="op" id="4010605">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010610">return</span>&nbsp;<span class="ident" id="4010617">nil</span><span class="op" id="4010620">,</span>&nbsp;<span class="ident" id="4010622"><a href="/crypto/x509/pkcs8.go.html#4009900">errors</a></span><span class="op" id="4010628">.</span><span class="ident" id="4010629">New</span><span class="op" id="4010632">(</span><span class="string" id="4010633">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="4010694">+</span>&nbsp;<span class="ident" id="4010696"><a href="/crypto/x509/pkcs8.go.html#4010361">err</a></span><span class="op" id="4010699">.</span><span class="ident" id="4010700">Error</span><span class="op" id="4010705">(</span><span class="op" id="4010706">)</span><span class="op" id="4010707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4010711">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010715">return</span>&nbsp;<span class="ident" id="4010722"><a href="/crypto/x509/pkcs8.go.html#4010344">key</a></span><span class="op" id="4010725">,</span>&nbsp;<span class="ident" id="4010727">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010733">case</span>&nbsp;<span class="ident" id="4010738"><a href="/crypto/x509/pkcs8.go.html#4010379">privKey</a></span><span class="op" id="4010745">.</span><span class="ident" id="4010746">Algo</span><span class="op" id="4010750">.</span><span class="ident" id="4010751">Algorithm</span><span class="op" id="4010760">.</span><span class="ident" id="4010761">Equal</span><span class="op" id="4010766">(</span><span class="ident" id="4010767"><a href="/crypto/x509/x509.go.html#4038495">oidPublicKeyECDSA</a></span><span class="op" id="4010784">)</span><span class="op" id="4010785">:</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010789">bytes</span>&nbsp;<span class="op" id="4010795">:=</span>&nbsp;<span class="ident" id="4010798"><a href="/crypto/x509/pkcs8.go.html#4010379">privKey</a></span><span class="op" id="4010805">.</span><span class="ident" id="4010806">Algo</span><span class="op" id="4010810">.</span><span class="ident" id="4010811">Parameters</span><span class="op" id="4010821">.</span><span class="ident" id="4010822">FullBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010834">namedCurveOID</span>&nbsp;<span class="op" id="4010848">:=</span>&nbsp;<span class="builtinfunc" id="4010851">new</span><span class="op" id="4010854">(</span><span class="ident" id="4010855"><a href="/crypto/x509/pkcs8.go.html#4009883">asn1</a></span><span class="op" id="4010859">.</span><span class="ident" id="4010860">ObjectIdentifier</span><span class="op" id="4010876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4010880">if</span>&nbsp;<span class="ident" id="4010883">_</span><span class="op" id="4010884">,</span>&nbsp;<span class="ident" id="4010886">err</span>&nbsp;<span class="op" id="4010890">:=</span>&nbsp;<span class="ident" id="4010893"><a href="/crypto/x509/pkcs8.go.html#4009883">asn1</a></span><span class="op" id="4010897">.</span><span class="ident" id="4010898">Unmarshal</span><span class="op" id="4010907">(</span><span class="ident" id="4010908"><a href="/crypto/x509/pkcs8.go.html#4010789">bytes</a></span><span class="op" id="4010913">,</span>&nbsp;<span class="ident" id="4010915"><a href="/crypto/x509/pkcs8.go.html#4010834">namedCurveOID</a></span><span class="op" id="4010928">)</span><span class="op" id="4010929">;</span>&nbsp;<span class="ident" id="4010931"><a href="/crypto/x509/pkcs8.go.html#4010886">err</a></span>&nbsp;<span class="op" id="4010935">!=</span>&nbsp;<span class="ident" id="4010938">nil</span>&nbsp;<span class="op" id="4010942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010947"><a href="/crypto/x509/pkcs8.go.html#4010834">namedCurveOID</a></span>&nbsp;<span class="op" id="4010961">=</span>&nbsp;<span class="ident" id="4010963">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4010969">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4010973"><a href="/crypto/x509/pkcs8.go.html#4010344">key</a></span><span class="op" id="4010976">,</span>&nbsp;<span class="ident" id="4010978"><a href="/crypto/x509/pkcs8.go.html#4010361">err</a></span>&nbsp;<span class="op" id="4010982">=</span>&nbsp;<span class="ident" id="4010984"><a href="/crypto/x509/sec1.go.html#4015115">parseECPrivateKey</a></span><span class="op" id="4011001">(</span><span class="ident" id="4011002"><a href="/crypto/x509/pkcs8.go.html#4010834">namedCurveOID</a></span><span class="op" id="4011015">,</span>&nbsp;<span class="ident" id="4011017"><a href="/crypto/x509/pkcs8.go.html#4010379">privKey</a></span><span class="op" id="4011024">.</span><span class="ident" id="4011025">PrivateKey</span><span class="op" id="4011035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011039">if</span>&nbsp;<span class="ident" id="4011042"><a href="/crypto/x509/pkcs8.go.html#4010361">err</a></span>&nbsp;<span class="op" id="4011046">!=</span>&nbsp;<span class="ident" id="4011049">nil</span>&nbsp;<span class="op" id="4011053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011058">return</span>&nbsp;<span class="ident" id="4011065">nil</span><span class="op" id="4011068">,</span>&nbsp;<span class="ident" id="4011070"><a href="/crypto/x509/pkcs8.go.html#4009900">errors</a></span><span class="op" id="4011076">.</span><span class="ident" id="4011077">New</span><span class="op" id="4011080">(</span><span class="string" id="4011081">&#34;x509:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;EC&nbsp;private&nbsp;key&nbsp;embedded&nbsp;in&nbsp;PKCS#8:&nbsp;&#34;</span>&nbsp;<span class="op" id="4011141">+</span>&nbsp;<span class="ident" id="4011143"><a href="/crypto/x509/pkcs8.go.html#4010361">err</a></span><span class="op" id="4011146">.</span><span class="ident" id="4011147">Error</span><span class="op" id="4011152">(</span><span class="op" id="4011153">)</span><span class="op" id="4011154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4011158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011162">return</span>&nbsp;<span class="ident" id="4011169"><a href="/crypto/x509/pkcs8.go.html#4010344">key</a></span><span class="op" id="4011172">,</span>&nbsp;<span class="ident" id="4011174">nil</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011180">default</span><span class="op" id="4011187">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4011191">return</span>&nbsp;<span class="ident" id="4011198">nil</span><span class="op" id="4011201">,</span>&nbsp;<span class="ident" id="4011203"><a href="/crypto/x509/pkcs8.go.html#4009910">fmt</a></span><span class="op" id="4011206">.</span><span class="ident" id="4011207">Errorf</span><span class="op" id="4011213">(</span><span class="string" id="4011214">&#34;x509:&nbsp;PKCS#8&nbsp;wrapping&nbsp;contained&nbsp;private&nbsp;key&nbsp;with&nbsp;unknown&nbsp;algorithm:&nbsp;%v&#34;</span><span class="op" id="4011286">,</span>&nbsp;<span class="ident" id="4011288"><a href="/crypto/x509/pkcs8.go.html#4010379">privKey</a></span><span class="op" id="4011295">.</span><span class="ident" id="4011296">Algo</span><span class="op" id="4011300">.</span><span class="ident" id="4011301">Algorithm</span><span class="op" id="4011310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4011313">}</span><br>
<span class="lineno"></span><span class="op" id="4011315">}</span>
</div>
</body>
</html>
