<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>index/suffixarray</h2>
<ul>
<li><a href="/gostd/index/suffixarray/qsufsort.go.html">qsufsort.go</a></li>
<li><a href="/gostd/index/suffixarray/suffixarray.go.html">suffixarray.go</a></li>
<li><a href="/gostd/index/suffixarray/suffixarray_test.go.html" class="current">suffixarray_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="7583587">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7583642">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7583696">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7583747">package</span>&nbsp;<span class="ident" id="7583755">suffixarray</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7583768">import</span>&nbsp;<span class="op" id="7583775">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7583778">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7583787">&#34;math/rand&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7583800">&#34;regexp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7583810">&#34;sort&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7583818">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7583829">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7583839">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="7583842">type</span>&nbsp;<span class="ident" id="7583847">testCase</span>&nbsp;<span class="keyword" id="7583856">struct</span>&nbsp;<span class="op" id="7583863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583866">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7583875">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7583884">//&nbsp;name&nbsp;of&nbsp;test&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583906">source</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7583915">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="7583924">//&nbsp;source&nbsp;to&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7583944">patterns</span>&nbsp;<span class="op" id="7583953">[</span><span class="op" id="7583954">]</span><span class="builtintype" id="7583955">string</span>&nbsp;<span class="comment" id="7583962">//&nbsp;patterns&nbsp;to&nbsp;lookup</span><br>
<span class="lineno">20</span><span class="op" id="7583984">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7583987">var</span>&nbsp;<span class="ident" id="7583991">testCases</span>&nbsp;<span class="op" id="7584001">=</span>&nbsp;<span class="op" id="7584003">[</span><span class="op" id="7584004">]</span><span class="ident" id="7584005">testCase</span><span class="op" id="7584013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584020">&#34;empty&nbsp;string&#34;</span><span class="op" id="7584034">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584038">&#34;&#34;</span><span class="op" id="7584040">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584044">[</span><span class="op" id="7584045">]</span><span class="builtintype" id="7584046">string</span><span class="op" id="7584052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584057">&#34;&#34;</span><span class="op" id="7584059">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584064">&#34;foo&#34;</span><span class="op" id="7584069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584074">&#34;(foo)&#34;</span><span class="op" id="7584081">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584086">&#34;.*&#34;</span><span class="op" id="7584090">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584095">&#34;a*&#34;</span><span class="op" id="7584099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584103">}</span><span class="op" id="7584104">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584107">}</span><span class="op" id="7584108">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584112">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584116">&#34;all&nbsp;a&#39;s&#34;</span><span class="op" id="7584125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584129">&#34;aaaaaaaaaa&#34;</span><span class="op" id="7584141">,</span>&nbsp;<span class="comment" id="7584143">//&nbsp;10&nbsp;a&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584155">[</span><span class="op" id="7584156">]</span><span class="builtintype" id="7584157">string</span><span class="op" id="7584163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584168">&#34;&#34;</span><span class="op" id="7584170">,</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584175">&#34;a&#34;</span><span class="op" id="7584178">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584183">&#34;aa&#34;</span><span class="op" id="7584187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584192">&#34;aaa&#34;</span><span class="op" id="7584197">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584202">&#34;aaaa&#34;</span><span class="op" id="7584208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584213">&#34;aaaaa&#34;</span><span class="op" id="7584220">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584225">&#34;aaaaaa&#34;</span><span class="op" id="7584233">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584238">&#34;aaaaaaa&#34;</span><span class="op" id="7584247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584252">&#34;aaaaaaaa&#34;</span><span class="op" id="7584262">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584267">&#34;aaaaaaaaa&#34;</span><span class="op" id="7584278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584283">&#34;aaaaaaaaaa&#34;</span><span class="op" id="7584295">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584300">&#34;aaaaaaaaaaa&#34;</span><span class="op" id="7584313">,</span>&nbsp;<span class="comment" id="7584315">//&nbsp;11&nbsp;a&#39;s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584328">&#34;.&#34;</span><span class="op" id="7584331">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584336">&#34;.*&#34;</span><span class="op" id="7584340">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584345">&#34;a+&#34;</span><span class="op" id="7584349">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584354">&#34;aa+&#34;</span><span class="op" id="7584359">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584364">&#34;aaaa[b]?&#34;</span><span class="op" id="7584374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584379">&#34;aaa*&#34;</span><span class="op" id="7584385">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584389">}</span><span class="op" id="7584390">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584393">}</span><span class="op" id="7584394">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584398">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584402">&#34;abc&#34;</span><span class="op" id="7584407">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584411">&#34;abc&#34;</span><span class="op" id="7584416">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584420">[</span><span class="op" id="7584421">]</span><span class="builtintype" id="7584422">string</span><span class="op" id="7584428">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584433">&#34;a&#34;</span><span class="op" id="7584436">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584441">&#34;b&#34;</span><span class="op" id="7584444">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584449">&#34;c&#34;</span><span class="op" id="7584452">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584457">&#34;ab&#34;</span><span class="op" id="7584461">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584466">&#34;bc&#34;</span><span class="op" id="7584470">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584475">&#34;abc&#34;</span><span class="op" id="7584480">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584485">&#34;a.c&#34;</span><span class="op" id="7584490">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584495">&#34;a(b|c)&#34;</span><span class="op" id="7584503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584508">&#34;abc?&#34;</span><span class="op" id="7584514">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584518">}</span><span class="op" id="7584519">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584522">}</span><span class="op" id="7584523">,</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584531">&#34;barbara*3&#34;</span><span class="op" id="7584542">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584546">&#34;barbarabarbarabarbara&#34;</span><span class="op" id="7584569">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584573">[</span><span class="op" id="7584574">]</span><span class="builtintype" id="7584575">string</span><span class="op" id="7584581">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584586">&#34;a&#34;</span><span class="op" id="7584589">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584594">&#34;bar&#34;</span><span class="op" id="7584599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584604">&#34;rab&#34;</span><span class="op" id="7584609">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584614">&#34;arab&#34;</span><span class="op" id="7584620">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584625">&#34;barbar&#34;</span><span class="op" id="7584633">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584638">&#34;bara?bar&#34;</span><span class="op" id="7584648">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584652">}</span><span class="op" id="7584653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584656">}</span><span class="op" id="7584657">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584661">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584665">&#34;typing&nbsp;drill&#34;</span><span class="op" id="7584679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584683">&#34;Now&nbsp;is&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;good&nbsp;men&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&nbsp;country.&#34;</span><span class="op" id="7584754">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584758">[</span><span class="op" id="7584759">]</span><span class="builtintype" id="7584760">string</span><span class="op" id="7584766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584771">&#34;Now&#34;</span><span class="op" id="7584776">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584781">&#34;the&nbsp;time&#34;</span><span class="op" id="7584791">,</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584796">&#34;to&nbsp;come&nbsp;the&nbsp;aid&#34;</span><span class="op" id="7584813">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584818">&#34;is&nbsp;the&nbsp;time&nbsp;for&nbsp;all&nbsp;good&nbsp;men&nbsp;to&nbsp;come&nbsp;to&nbsp;the&nbsp;aid&nbsp;of&nbsp;their&#34;</span><span class="op" id="7584876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584881">&#34;to&nbsp;(come|the)?&#34;</span><span class="op" id="7584897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584901">}</span><span class="op" id="7584902">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584905">}</span><span class="op" id="7584906">,</span><br>
<span class="lineno">100</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584914">&#34;godoc&nbsp;simulation&#34;</span><span class="op" id="7584932">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7584936">&#34;package&nbsp;main\n\nimport(\n&nbsp;&nbsp;&nbsp;&nbsp;\&#34;rand\&#34;\n&nbsp;&nbsp;&nbsp;&nbsp;&#34;</span><span class="op" id="7584981">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584985">[</span><span class="op" id="7584986">]</span><span class="builtintype" id="7584987">string</span><span class="op" id="7584993">{</span><span class="op" id="7584994">}</span><span class="op" id="7584995">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7584998">}</span><span class="op" id="7584999">,</span><br>
<span class="lineno"></span><span class="op" id="7585001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7585004">//&nbsp;find&nbsp;all&nbsp;occurrences&nbsp;of&nbsp;s&nbsp;in&nbsp;source;&nbsp;report&nbsp;at&nbsp;most&nbsp;n&nbsp;occurrences</span><br>
<span class="lineno"></span><span class="keyword" id="7585073">func</span>&nbsp;<span class="ident" id="7585078">find</span><span class="op" id="7585082">(</span><span class="ident" id="7585083">src</span><span class="op" id="7585086">,</span>&nbsp;<span class="ident" id="7585088">s</span>&nbsp;<span class="builtintype" id="7585090">string</span><span class="op" id="7585096">,</span>&nbsp;<span class="ident" id="7585098">n</span>&nbsp;<span class="builtintype" id="7585100">int</span><span class="op" id="7585103">)</span>&nbsp;<span class="op" id="7585105">[</span><span class="op" id="7585106">]</span><span class="builtintype" id="7585107">int</span>&nbsp;<span class="op" id="7585111">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7585114">var</span>&nbsp;<span class="ident" id="7585118">res</span>&nbsp;<span class="op" id="7585122">[</span><span class="op" id="7585123">]</span><span class="builtintype" id="7585124">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7585129">if</span>&nbsp;<span class="ident" id="7585132">s</span>&nbsp;<span class="op" id="7585134">!=</span>&nbsp;<span class="string" id="7585137">&#34;&#34;</span>&nbsp;<span class="op" id="7585140">&amp;&amp;</span>&nbsp;<span class="ident" id="7585143">n</span>&nbsp;<span class="op" id="7585145">!=</span>&nbsp;<span class="num" id="7585148">0</span>&nbsp;<span class="op" id="7585150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7585154">//&nbsp;find&nbsp;at&nbsp;most&nbsp;n&nbsp;occurrences&nbsp;of&nbsp;s&nbsp;in&nbsp;src</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7585198">for</span>&nbsp;<span class="ident" id="7585202">i</span>&nbsp;<span class="op" id="7585204">:=</span>&nbsp;<span class="op" id="7585207">-</span><span class="num" id="7585208">1</span><span class="op" id="7585209">;</span>&nbsp;<span class="ident" id="7585211">n</span>&nbsp;<span class="op" id="7585213">&lt;</span>&nbsp;<span class="num" id="7585215">0</span>&nbsp;<span class="op" id="7585217">||</span>&nbsp;<span class="builtinfunc" id="7585220">len</span><span class="op" id="7585223">(</span><span class="ident" id="7585224">res</span><span class="op" id="7585227">)</span>&nbsp;<span class="op" id="7585229">&lt;</span>&nbsp;<span class="ident" id="7585231">n</span><span class="op" id="7585232">;</span>&nbsp;<span class="op" id="7585234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585239">j</span>&nbsp;<span class="op" id="7585241">:=</span>&nbsp;<span class="ident" id="7585244">strings</span><span class="op" id="7585251">.</span><span class="ident" id="7585252">Index</span><span class="op" id="7585257">(</span><span class="ident" id="7585258">src</span><span class="op" id="7585261">[</span><span class="ident" id="7585262">i</span><span class="op" id="7585263">+</span><span class="num" id="7585264">1</span><span class="op" id="7585265">:</span><span class="op" id="7585266">]</span><span class="op" id="7585267">,</span>&nbsp;<span class="ident" id="7585269">s</span><span class="op" id="7585270">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7585275">if</span>&nbsp;<span class="ident" id="7585278">j</span>&nbsp;<span class="op" id="7585280">&lt;</span>&nbsp;<span class="num" id="7585282">0</span>&nbsp;<span class="op" id="7585284">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7585290">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7585299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585304">i</span>&nbsp;<span class="op" id="7585306">+=</span>&nbsp;<span class="ident" id="7585309">j</span>&nbsp;<span class="op" id="7585311">+</span>&nbsp;<span class="num" id="7585313">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585318">res</span>&nbsp;<span class="op" id="7585322">=</span>&nbsp;<span class="builtinfunc" id="7585324">append</span><span class="op" id="7585330">(</span><span class="ident" id="7585331">res</span><span class="op" id="7585334">,</span>&nbsp;<span class="ident" id="7585336">i</span><span class="op" id="7585337">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7585341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7585344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7585347">return</span>&nbsp;<span class="ident" id="7585354">res</span><br>
<span class="lineno"></span><span class="op" id="7585358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="keyword" id="7585361">func</span>&nbsp;<span class="ident" id="7585366">testLookup</span><span class="op" id="7585376">(</span><span class="ident" id="7585377">t</span>&nbsp;<span class="op" id="7585379">*</span><span class="ident" id="7585380">testing</span><span class="op" id="7585387">.</span><span class="ident" id="7585388">T</span><span class="op" id="7585389">,</span>&nbsp;<span class="ident" id="7585391">tc</span>&nbsp;<span class="op" id="7585394">*</span><span class="ident" id="7585395">testCase</span><span class="op" id="7585403">,</span>&nbsp;<span class="ident" id="7585405">x</span>&nbsp;<span class="op" id="7585407">*</span><span class="ident" id="7585408">Index</span><span class="op" id="7585413">,</span>&nbsp;<span class="ident" id="7585415">s</span>&nbsp;<span class="builtintype" id="7585417">string</span><span class="op" id="7585423">,</span>&nbsp;<span class="ident" id="7585425">n</span>&nbsp;<span class="builtintype" id="7585427">int</span><span class="op" id="7585430">)</span>&nbsp;<span class="op" id="7585432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585435">res</span>&nbsp;<span class="op" id="7585439">:=</span>&nbsp;<span class="ident" id="7585442">x</span><span class="op" id="7585443">.</span><span class="ident" id="7585444">Lookup</span><span class="op" id="7585450">(</span><span class="op" id="7585451">[</span><span class="op" id="7585452">]</span><span class="builtintype" id="7585453">byte</span><span class="op" id="7585457">(</span><span class="ident" id="7585458">s</span><span class="op" id="7585459">)</span><span class="op" id="7585460">,</span>&nbsp;<span class="ident" id="7585462">n</span><span class="op" id="7585463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585466">exp</span>&nbsp;<span class="op" id="7585470">:=</span>&nbsp;<span class="ident" id="7585473">find</span><span class="op" id="7585477">(</span><span class="ident" id="7585478">tc</span><span class="op" id="7585480">.</span><span class="ident" id="7585481">source</span><span class="op" id="7585487">,</span>&nbsp;<span class="ident" id="7585489">s</span><span class="op" id="7585490">,</span>&nbsp;<span class="ident" id="7585492">n</span><span class="op" id="7585493">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7585497">//&nbsp;check&nbsp;that&nbsp;the&nbsp;lengths&nbsp;match</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7585530">if</span>&nbsp;<span class="builtinfunc" id="7585533">len</span><span class="op" id="7585536">(</span><span class="ident" id="7585537">res</span><span class="op" id="7585540">)</span>&nbsp;<span class="op" id="7585542">!=</span>&nbsp;<span class="builtinfunc" id="7585545">len</span><span class="op" id="7585548">(</span><span class="ident" id="7585549">exp</span><span class="op" id="7585552">)</span>&nbsp;<span class="op" id="7585554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7585558">t</span><span class="op" id="7585559">.</span><span class="ident" id="7585560">Errorf</span><span class="op" id="7585566">(</span><span class="string" id="7585567">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;expected&nbsp;%d&nbsp;results;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7585625">,</span>&nbsp;<span class="ident" id="7585627">tc</span><span class="op" id="7585629">.</span><span class="ident" id="7585630">name</span><span class="op" id="7585634">,</span>&nbsp;<span class="ident" id="7585636">s</span><span class="op" id="7585637">,</span>&nbsp;<span class="ident" id="7585639">n</span><span class="op" id="7585640">,</span>&nbsp;<span class="builtinfunc" id="7585642">len</span><span class="op" id="7585645">(</span><span class="ident" id="7585646">exp</span><span class="op" id="7585649">)</span><span class="op" id="7585650">,</span>&nbsp;<span class="builtinfunc" id="7585652">len</span><span class="op" id="7585655">(</span><span class="ident" id="7585656">res</span><span class="op" id="7585659">)</span><span class="op" id="7585660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7585663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7585667">//&nbsp;if&nbsp;n&nbsp;&gt;=&nbsp;0&nbsp;the&nbsp;number&nbsp;of&nbsp;results&nbsp;is&nbsp;limited&nbsp;---&nbsp;unless&nbsp;n&nbsp;&gt;=&nbsp;all&nbsp;results,</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7585743">//&nbsp;we&nbsp;may&nbsp;obtain&nbsp;different&nbsp;positions&nbsp;from&nbsp;the&nbsp;Index&nbsp;and&nbsp;from&nbsp;find&nbsp;(because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7585819">//&nbsp;Index&nbsp;may&nbsp;not&nbsp;find&nbsp;the&nbsp;results&nbsp;in&nbsp;the&nbsp;same&nbsp;order&nbsp;as&nbsp;find)&nbsp;=&gt;&nbsp;in&nbsp;general</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7585895">//&nbsp;we&nbsp;cannot&nbsp;simply&nbsp;check&nbsp;that&nbsp;the&nbsp;res&nbsp;and&nbsp;exp&nbsp;lists&nbsp;are&nbsp;equal</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7585960">//&nbsp;check&nbsp;that&nbsp;each&nbsp;result&nbsp;is&nbsp;in&nbsp;fact&nbsp;a&nbsp;correct&nbsp;match&nbsp;and&nbsp;there&nbsp;are&nbsp;no&nbsp;duplicates</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586042">sort</span><span class="op" id="7586046">.</span><span class="ident" id="7586047">Ints</span><span class="op" id="7586051">(</span><span class="ident" id="7586052">res</span><span class="op" id="7586055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7586058">for</span>&nbsp;<span class="ident" id="7586062">i</span><span class="op" id="7586063">,</span>&nbsp;<span class="ident" id="7586065">r</span>&nbsp;<span class="op" id="7586067">:=</span>&nbsp;<span class="keyword" id="7586070">range</span>&nbsp;<span class="ident" id="7586076">res</span>&nbsp;<span class="op" id="7586080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7586084">if</span>&nbsp;<span class="ident" id="7586087">r</span>&nbsp;<span class="op" id="7586089">&lt;</span>&nbsp;<span class="num" id="7586091">0</span>&nbsp;<span class="op" id="7586093">||</span>&nbsp;<span class="builtinfunc" id="7586096">len</span><span class="op" id="7586099">(</span><span class="ident" id="7586100">tc</span><span class="op" id="7586102">.</span><span class="ident" id="7586103">source</span><span class="op" id="7586109">)</span>&nbsp;<span class="op" id="7586111">&lt;=</span>&nbsp;<span class="ident" id="7586114">r</span>&nbsp;<span class="op" id="7586116">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586121">t</span><span class="op" id="7586122">.</span><span class="ident" id="7586123">Errorf</span><span class="op" id="7586129">(</span><span class="string" id="7586130">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;index&nbsp;%d&nbsp;out&nbsp;of&nbsp;range&nbsp;[0,&nbsp;%d[&#34;</span><span class="op" id="7586201">,</span>&nbsp;<span class="ident" id="7586203">tc</span><span class="op" id="7586205">.</span><span class="ident" id="7586206">name</span><span class="op" id="7586210">,</span>&nbsp;<span class="ident" id="7586212">s</span><span class="op" id="7586213">,</span>&nbsp;<span class="ident" id="7586215">i</span><span class="op" id="7586216">,</span>&nbsp;<span class="ident" id="7586218">n</span><span class="op" id="7586219">,</span>&nbsp;<span class="ident" id="7586221">r</span><span class="op" id="7586222">,</span>&nbsp;<span class="builtinfunc" id="7586224">len</span><span class="op" id="7586227">(</span><span class="ident" id="7586228">tc</span><span class="op" id="7586230">.</span><span class="ident" id="7586231">source</span><span class="op" id="7586237">)</span><span class="op" id="7586238">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7586242">}</span>&nbsp;<span class="keyword" id="7586244">else</span>&nbsp;<span class="keyword" id="7586249">if</span>&nbsp;<span class="op" id="7586252">!</span><span class="ident" id="7586253">strings</span><span class="op" id="7586260">.</span><span class="ident" id="7586261">HasPrefix</span><span class="op" id="7586270">(</span><span class="ident" id="7586271">tc</span><span class="op" id="7586273">.</span><span class="ident" id="7586274">source</span><span class="op" id="7586280">[</span><span class="ident" id="7586281">r</span><span class="op" id="7586282">:</span><span class="op" id="7586283">]</span><span class="op" id="7586284">,</span>&nbsp;<span class="ident" id="7586286">s</span><span class="op" id="7586287">)</span>&nbsp;<span class="op" id="7586289">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586294">t</span><span class="op" id="7586295">.</span><span class="ident" id="7586296">Errorf</span><span class="op" id="7586302">(</span><span class="string" id="7586303">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;index&nbsp;%d&nbsp;not&nbsp;a&nbsp;match&#34;</span><span class="op" id="7586365">,</span>&nbsp;<span class="ident" id="7586367">tc</span><span class="op" id="7586369">.</span><span class="ident" id="7586370">name</span><span class="op" id="7586374">,</span>&nbsp;<span class="ident" id="7586376">s</span><span class="op" id="7586377">,</span>&nbsp;<span class="ident" id="7586379">i</span><span class="op" id="7586380">,</span>&nbsp;<span class="ident" id="7586382">n</span><span class="op" id="7586383">,</span>&nbsp;<span class="ident" id="7586385">r</span><span class="op" id="7586386">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7586390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7586394">if</span>&nbsp;<span class="ident" id="7586397">i</span>&nbsp;<span class="op" id="7586399">&gt;</span>&nbsp;<span class="num" id="7586401">0</span>&nbsp;<span class="op" id="7586403">&amp;&amp;</span>&nbsp;<span class="ident" id="7586406">res</span><span class="op" id="7586409">[</span><span class="ident" id="7586410">i</span><span class="op" id="7586411">-</span><span class="num" id="7586412">1</span><span class="op" id="7586413">]</span>&nbsp;<span class="op" id="7586415">==</span>&nbsp;<span class="ident" id="7586418">r</span>&nbsp;<span class="op" id="7586420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586425">t</span><span class="op" id="7586426">.</span><span class="ident" id="7586427">Errorf</span><span class="op" id="7586433">(</span><span class="string" id="7586434">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;found&nbsp;duplicate&nbsp;index&nbsp;%d&#34;</span><span class="op" id="7586500">,</span>&nbsp;<span class="ident" id="7586502">tc</span><span class="op" id="7586504">.</span><span class="ident" id="7586505">name</span><span class="op" id="7586509">,</span>&nbsp;<span class="ident" id="7586511">s</span><span class="op" id="7586512">,</span>&nbsp;<span class="ident" id="7586514">i</span><span class="op" id="7586515">,</span>&nbsp;<span class="ident" id="7586517">n</span><span class="op" id="7586518">,</span>&nbsp;<span class="ident" id="7586520">r</span><span class="op" id="7586521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7586525">}</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7586528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7586532">if</span>&nbsp;<span class="ident" id="7586535">n</span>&nbsp;<span class="op" id="7586537">&lt;</span>&nbsp;<span class="num" id="7586539">0</span>&nbsp;<span class="op" id="7586541">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7586545">//&nbsp;all&nbsp;results&nbsp;computed&nbsp;-&nbsp;sorted&nbsp;res&nbsp;and&nbsp;exp&nbsp;must&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7586606">for</span>&nbsp;<span class="ident" id="7586610">i</span><span class="op" id="7586611">,</span>&nbsp;<span class="ident" id="7586613">r</span>&nbsp;<span class="op" id="7586615">:=</span>&nbsp;<span class="keyword" id="7586618">range</span>&nbsp;<span class="ident" id="7586624">res</span>&nbsp;<span class="op" id="7586628">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586633">e</span>&nbsp;<span class="op" id="7586635">:=</span>&nbsp;<span class="ident" id="7586638">exp</span><span class="op" id="7586641">[</span><span class="ident" id="7586642">i</span><span class="op" id="7586643">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7586648">if</span>&nbsp;<span class="ident" id="7586651">r</span>&nbsp;<span class="op" id="7586653">!=</span>&nbsp;<span class="ident" id="7586656">e</span>&nbsp;<span class="op" id="7586658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586664">t</span><span class="op" id="7586665">.</span><span class="ident" id="7586666">Errorf</span><span class="op" id="7586672">(</span><span class="string" id="7586673">&#34;test&nbsp;%q,&nbsp;lookup&nbsp;%q,&nbsp;result&nbsp;%d:&nbsp;expected&nbsp;index&nbsp;%d;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7586731">,</span>&nbsp;<span class="ident" id="7586733">tc</span><span class="op" id="7586735">.</span><span class="ident" id="7586736">name</span><span class="op" id="7586740">,</span>&nbsp;<span class="ident" id="7586742">s</span><span class="op" id="7586743">,</span>&nbsp;<span class="ident" id="7586745">i</span><span class="op" id="7586746">,</span>&nbsp;<span class="ident" id="7586748">e</span><span class="op" id="7586749">,</span>&nbsp;<span class="ident" id="7586751">r</span><span class="op" id="7586752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7586757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7586761">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7586764">}</span><br>
<span class="lineno"></span><span class="op" id="7586766">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7586769">func</span>&nbsp;<span class="ident" id="7586774">testFindAllIndex</span><span class="op" id="7586790">(</span><span class="ident" id="7586791">t</span>&nbsp;<span class="op" id="7586793">*</span><span class="ident" id="7586794">testing</span><span class="op" id="7586801">.</span><span class="ident" id="7586802">T</span><span class="op" id="7586803">,</span>&nbsp;<span class="ident" id="7586805">tc</span>&nbsp;<span class="op" id="7586808">*</span><span class="ident" id="7586809">testCase</span><span class="op" id="7586817">,</span>&nbsp;<span class="ident" id="7586819">x</span>&nbsp;<span class="op" id="7586821">*</span><span class="ident" id="7586822">Index</span><span class="op" id="7586827">,</span>&nbsp;<span class="ident" id="7586829">rx</span>&nbsp;<span class="op" id="7586832">*</span><span class="ident" id="7586833">regexp</span><span class="op" id="7586839">.</span><span class="ident" id="7586840">Regexp</span><span class="op" id="7586846">,</span>&nbsp;<span class="ident" id="7586848">n</span>&nbsp;<span class="builtintype" id="7586850">int</span><span class="op" id="7586853">)</span>&nbsp;<span class="op" id="7586855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586858">res</span>&nbsp;<span class="op" id="7586862">:=</span>&nbsp;<span class="ident" id="7586865">x</span><span class="op" id="7586866">.</span><span class="ident" id="7586867">FindAllIndex</span><span class="op" id="7586879">(</span><span class="ident" id="7586880">rx</span><span class="op" id="7586882">,</span>&nbsp;<span class="ident" id="7586884">n</span><span class="op" id="7586885">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586888">exp</span>&nbsp;<span class="op" id="7586892">:=</span>&nbsp;<span class="ident" id="7586895">rx</span><span class="op" id="7586897">.</span><span class="ident" id="7586898">FindAllStringIndex</span><span class="op" id="7586916">(</span><span class="ident" id="7586917">tc</span><span class="op" id="7586919">.</span><span class="ident" id="7586920">source</span><span class="op" id="7586926">,</span>&nbsp;<span class="ident" id="7586928">n</span><span class="op" id="7586929">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7586933">//&nbsp;check&nbsp;that&nbsp;the&nbsp;lengths&nbsp;match</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7586966">if</span>&nbsp;<span class="builtinfunc" id="7586969">len</span><span class="op" id="7586972">(</span><span class="ident" id="7586973">res</span><span class="op" id="7586976">)</span>&nbsp;<span class="op" id="7586978">!=</span>&nbsp;<span class="builtinfunc" id="7586981">len</span><span class="op" id="7586984">(</span><span class="ident" id="7586985">exp</span><span class="op" id="7586988">)</span>&nbsp;<span class="op" id="7586990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7586994">t</span><span class="op" id="7586995">.</span><span class="ident" id="7586996">Errorf</span><span class="op" id="7587002">(</span><span class="string" id="7587003">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;expected&nbsp;%d&nbsp;results;&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7587067">,</span>&nbsp;<span class="ident" id="7587069">tc</span><span class="op" id="7587071">.</span><span class="ident" id="7587072">name</span><span class="op" id="7587076">,</span>&nbsp;<span class="ident" id="7587078">rx</span><span class="op" id="7587080">,</span>&nbsp;<span class="ident" id="7587082">n</span><span class="op" id="7587083">,</span>&nbsp;<span class="builtinfunc" id="7587085">len</span><span class="op" id="7587088">(</span><span class="ident" id="7587089">exp</span><span class="op" id="7587092">)</span><span class="op" id="7587093">,</span>&nbsp;<span class="builtinfunc" id="7587095">len</span><span class="op" id="7587098">(</span><span class="ident" id="7587099">res</span><span class="op" id="7587102">)</span><span class="op" id="7587103">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7587106">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7587110">//&nbsp;if&nbsp;n&nbsp;&gt;=&nbsp;0&nbsp;the&nbsp;number&nbsp;of&nbsp;results&nbsp;is&nbsp;limited&nbsp;---&nbsp;unless&nbsp;n&nbsp;&gt;=&nbsp;all&nbsp;results,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7587186">//&nbsp;we&nbsp;may&nbsp;obtain&nbsp;different&nbsp;positions&nbsp;from&nbsp;the&nbsp;Index&nbsp;and&nbsp;from&nbsp;regexp&nbsp;(because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7587264">//&nbsp;Index&nbsp;may&nbsp;not&nbsp;find&nbsp;the&nbsp;results&nbsp;in&nbsp;the&nbsp;same&nbsp;order&nbsp;as&nbsp;regexp)&nbsp;=&gt;&nbsp;in&nbsp;general</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7587342">//&nbsp;we&nbsp;cannot&nbsp;simply&nbsp;check&nbsp;that&nbsp;the&nbsp;res&nbsp;and&nbsp;exp&nbsp;lists&nbsp;are&nbsp;equal</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7587407">//&nbsp;check&nbsp;that&nbsp;each&nbsp;result&nbsp;is&nbsp;in&nbsp;fact&nbsp;a&nbsp;correct&nbsp;match&nbsp;and&nbsp;the&nbsp;result&nbsp;is&nbsp;sorted</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7587486">for</span>&nbsp;<span class="ident" id="7587490">i</span><span class="op" id="7587491">,</span>&nbsp;<span class="ident" id="7587493">r</span>&nbsp;<span class="op" id="7587495">:=</span>&nbsp;<span class="keyword" id="7587498">range</span>&nbsp;<span class="ident" id="7587504">res</span>&nbsp;<span class="op" id="7587508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7587512">if</span>&nbsp;<span class="ident" id="7587515">r</span><span class="op" id="7587516">[</span><span class="num" id="7587517">0</span><span class="op" id="7587518">]</span>&nbsp;<span class="op" id="7587520">&lt;</span>&nbsp;<span class="num" id="7587522">0</span>&nbsp;<span class="op" id="7587524">||</span>&nbsp;<span class="ident" id="7587527">r</span><span class="op" id="7587528">[</span><span class="num" id="7587529">0</span><span class="op" id="7587530">]</span>&nbsp;<span class="op" id="7587532">&gt;</span>&nbsp;<span class="ident" id="7587534">r</span><span class="op" id="7587535">[</span><span class="num" id="7587536">1</span><span class="op" id="7587537">]</span>&nbsp;<span class="op" id="7587539">||</span>&nbsp;<span class="builtinfunc" id="7587542">len</span><span class="op" id="7587545">(</span><span class="ident" id="7587546">tc</span><span class="op" id="7587548">.</span><span class="ident" id="7587549">source</span><span class="op" id="7587555">)</span>&nbsp;<span class="op" id="7587557">&lt;</span>&nbsp;<span class="ident" id="7587559">r</span><span class="op" id="7587560">[</span><span class="num" id="7587561">1</span><span class="op" id="7587562">]</span>&nbsp;<span class="op" id="7587564">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7587569">t</span><span class="op" id="7587570">.</span><span class="ident" id="7587571">Errorf</span><span class="op" id="7587577">(</span><span class="string" id="7587578">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;==&nbsp;%d):&nbsp;illegal&nbsp;match&nbsp;[%d,&nbsp;%d]&#34;</span><span class="op" id="7587649">,</span>&nbsp;<span class="ident" id="7587651">tc</span><span class="op" id="7587653">.</span><span class="ident" id="7587654">name</span><span class="op" id="7587658">,</span>&nbsp;<span class="ident" id="7587660">rx</span><span class="op" id="7587662">,</span>&nbsp;<span class="ident" id="7587664">i</span><span class="op" id="7587665">,</span>&nbsp;<span class="ident" id="7587667">n</span><span class="op" id="7587668">,</span>&nbsp;<span class="ident" id="7587670">r</span><span class="op" id="7587671">[</span><span class="num" id="7587672">0</span><span class="op" id="7587673">]</span><span class="op" id="7587674">,</span>&nbsp;<span class="ident" id="7587676">r</span><span class="op" id="7587677">[</span><span class="num" id="7587678">1</span><span class="op" id="7587679">]</span><span class="op" id="7587680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7587684">}</span>&nbsp;<span class="keyword" id="7587686">else</span>&nbsp;<span class="keyword" id="7587691">if</span>&nbsp;<span class="op" id="7587694">!</span><span class="ident" id="7587695">rx</span><span class="op" id="7587697">.</span><span class="ident" id="7587698">MatchString</span><span class="op" id="7587709">(</span><span class="ident" id="7587710">tc</span><span class="op" id="7587712">.</span><span class="ident" id="7587713">source</span><span class="op" id="7587719">[</span><span class="ident" id="7587720">r</span><span class="op" id="7587721">[</span><span class="num" id="7587722">0</span><span class="op" id="7587723">]</span><span class="op" id="7587724">:</span><span class="ident" id="7587725">r</span><span class="op" id="7587726">[</span><span class="num" id="7587727">1</span><span class="op" id="7587728">]</span><span class="op" id="7587729">]</span><span class="op" id="7587730">)</span>&nbsp;<span class="op" id="7587732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7587737">t</span><span class="op" id="7587738">.</span><span class="ident" id="7587739">Errorf</span><span class="op" id="7587745">(</span><span class="string" id="7587746">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q,&nbsp;result&nbsp;%d&nbsp;(n&nbsp;=&nbsp;%d):&nbsp;[%d,&nbsp;%d]&nbsp;not&nbsp;a&nbsp;match&#34;</span><span class="op" id="7587814">,</span>&nbsp;<span class="ident" id="7587816">tc</span><span class="op" id="7587818">.</span><span class="ident" id="7587819">name</span><span class="op" id="7587823">,</span>&nbsp;<span class="ident" id="7587825">rx</span><span class="op" id="7587827">,</span>&nbsp;<span class="ident" id="7587829">i</span><span class="op" id="7587830">,</span>&nbsp;<span class="ident" id="7587832">n</span><span class="op" id="7587833">,</span>&nbsp;<span class="ident" id="7587835">r</span><span class="op" id="7587836">[</span><span class="num" id="7587837">0</span><span class="op" id="7587838">]</span><span class="op" id="7587839">,</span>&nbsp;<span class="ident" id="7587841">r</span><span class="op" id="7587842">[</span><span class="num" id="7587843">1</span><span class="op" id="7587844">]</span><span class="op" id="7587845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7587849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7587852">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7587856">if</span>&nbsp;<span class="ident" id="7587859">n</span>&nbsp;<span class="op" id="7587861">&lt;</span>&nbsp;<span class="num" id="7587863">0</span>&nbsp;<span class="op" id="7587865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7587869">//&nbsp;all&nbsp;results&nbsp;computed&nbsp;-&nbsp;sorted&nbsp;res&nbsp;and&nbsp;exp&nbsp;must&nbsp;be&nbsp;equal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7587930">for</span>&nbsp;<span class="ident" id="7587934">i</span><span class="op" id="7587935">,</span>&nbsp;<span class="ident" id="7587937">r</span>&nbsp;<span class="op" id="7587939">:=</span>&nbsp;<span class="keyword" id="7587942">range</span>&nbsp;<span class="ident" id="7587948">res</span>&nbsp;<span class="op" id="7587952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7587957">e</span>&nbsp;<span class="op" id="7587959">:=</span>&nbsp;<span class="ident" id="7587962">exp</span><span class="op" id="7587965">[</span><span class="ident" id="7587966">i</span><span class="op" id="7587967">]</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7587972">if</span>&nbsp;<span class="ident" id="7587975">r</span><span class="op" id="7587976">[</span><span class="num" id="7587977">0</span><span class="op" id="7587978">]</span>&nbsp;<span class="op" id="7587980">!=</span>&nbsp;<span class="ident" id="7587983">e</span><span class="op" id="7587984">[</span><span class="num" id="7587985">0</span><span class="op" id="7587986">]</span>&nbsp;<span class="op" id="7587988">||</span>&nbsp;<span class="ident" id="7587991">r</span><span class="op" id="7587992">[</span><span class="num" id="7587993">1</span><span class="op" id="7587994">]</span>&nbsp;<span class="op" id="7587996">!=</span>&nbsp;<span class="ident" id="7587999">e</span><span class="op" id="7588000">[</span><span class="num" id="7588001">1</span><span class="op" id="7588002">]</span>&nbsp;<span class="op" id="7588004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588010">t</span><span class="op" id="7588011">.</span><span class="ident" id="7588012">Errorf</span><span class="op" id="7588018">(</span><span class="string" id="7588019">&#34;test&nbsp;%q,&nbsp;FindAllIndex&nbsp;%q,&nbsp;result&nbsp;%d:&nbsp;expected&nbsp;match&nbsp;[%d,&nbsp;%d];&nbsp;got&nbsp;[%d,&nbsp;%d]&#34;</span><span class="op" id="7588095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588102">tc</span><span class="op" id="7588104">.</span><span class="ident" id="7588105">name</span><span class="op" id="7588109">,</span>&nbsp;<span class="ident" id="7588111">rx</span><span class="op" id="7588113">,</span>&nbsp;<span class="ident" id="7588115">i</span><span class="op" id="7588116">,</span>&nbsp;<span class="ident" id="7588118">e</span><span class="op" id="7588119">[</span><span class="num" id="7588120">0</span><span class="op" id="7588121">]</span><span class="op" id="7588122">,</span>&nbsp;<span class="ident" id="7588124">e</span><span class="op" id="7588125">[</span><span class="num" id="7588126">1</span><span class="op" id="7588127">]</span><span class="op" id="7588128">,</span>&nbsp;<span class="ident" id="7588130">r</span><span class="op" id="7588131">[</span><span class="num" id="7588132">0</span><span class="op" id="7588133">]</span><span class="op" id="7588134">,</span>&nbsp;<span class="ident" id="7588136">r</span><span class="op" id="7588137">[</span><span class="num" id="7588138">1</span><span class="op" id="7588139">]</span><span class="op" id="7588140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7588145">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7588149">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7588152">}</span><br>
<span class="lineno"></span><span class="op" id="7588154">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7588157">func</span>&nbsp;<span class="ident" id="7588162">testLookups</span><span class="op" id="7588173">(</span><span class="ident" id="7588174">t</span>&nbsp;<span class="op" id="7588176">*</span><span class="ident" id="7588177">testing</span><span class="op" id="7588184">.</span><span class="ident" id="7588185">T</span><span class="op" id="7588186">,</span>&nbsp;<span class="ident" id="7588188">tc</span>&nbsp;<span class="op" id="7588191">*</span><span class="ident" id="7588192">testCase</span><span class="op" id="7588200">,</span>&nbsp;<span class="ident" id="7588202">x</span>&nbsp;<span class="op" id="7588204">*</span><span class="ident" id="7588205">Index</span><span class="op" id="7588210">,</span>&nbsp;<span class="ident" id="7588212">n</span>&nbsp;<span class="builtintype" id="7588214">int</span><span class="op" id="7588217">)</span>&nbsp;<span class="op" id="7588219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7588222">for</span>&nbsp;<span class="ident" id="7588226">_</span><span class="op" id="7588227">,</span>&nbsp;<span class="ident" id="7588229">pat</span>&nbsp;<span class="op" id="7588233">:=</span>&nbsp;<span class="keyword" id="7588236">range</span>&nbsp;<span class="ident" id="7588242">tc</span><span class="op" id="7588244">.</span><span class="ident" id="7588245">patterns</span>&nbsp;<span class="op" id="7588254">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588258">testLookup</span><span class="op" id="7588268">(</span><span class="ident" id="7588269">t</span><span class="op" id="7588270">,</span>&nbsp;<span class="ident" id="7588272">tc</span><span class="op" id="7588274">,</span>&nbsp;<span class="ident" id="7588276">x</span><span class="op" id="7588277">,</span>&nbsp;<span class="ident" id="7588279">pat</span><span class="op" id="7588282">,</span>&nbsp;<span class="ident" id="7588284">n</span><span class="op" id="7588285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7588289">if</span>&nbsp;<span class="ident" id="7588292">rx</span><span class="op" id="7588294">,</span>&nbsp;<span class="ident" id="7588296">err</span>&nbsp;<span class="op" id="7588300">:=</span>&nbsp;<span class="ident" id="7588303">regexp</span><span class="op" id="7588309">.</span><span class="ident" id="7588310">Compile</span><span class="op" id="7588317">(</span><span class="ident" id="7588318">pat</span><span class="op" id="7588321">)</span><span class="op" id="7588322">;</span>&nbsp;<span class="ident" id="7588324">err</span>&nbsp;<span class="op" id="7588328">==</span>&nbsp;<span class="builtintype" id="7588331">nil</span>&nbsp;<span class="op" id="7588335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588340">testFindAllIndex</span><span class="op" id="7588356">(</span><span class="ident" id="7588357">t</span><span class="op" id="7588358">,</span>&nbsp;<span class="ident" id="7588360">tc</span><span class="op" id="7588362">,</span>&nbsp;<span class="ident" id="7588364">x</span><span class="op" id="7588365">,</span>&nbsp;<span class="ident" id="7588367">rx</span><span class="op" id="7588369">,</span>&nbsp;<span class="ident" id="7588371">n</span><span class="op" id="7588372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7588376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7588379">}</span><br>
<span class="lineno">205</span><span class="op" id="7588381">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7588384">//&nbsp;index&nbsp;is&nbsp;used&nbsp;to&nbsp;hide&nbsp;the&nbsp;sort.Interface</span><br>
<span class="lineno"></span><span class="keyword" id="7588428">type</span>&nbsp;<span class="ident" id="7588433">index</span>&nbsp;<span class="ident" id="7588439">Index</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="7588446">func</span>&nbsp;<span class="op" id="7588451">(</span><span class="ident" id="7588452">x</span>&nbsp;<span class="op" id="7588454">*</span><span class="ident" id="7588455">index</span><span class="op" id="7588460">)</span>&nbsp;<span class="ident" id="7588462">Len</span><span class="op" id="7588465">(</span><span class="op" id="7588466">)</span>&nbsp;<span class="builtintype" id="7588468">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7588482">{</span>&nbsp;<span class="keyword" id="7588484">return</span>&nbsp;<span class="builtinfunc" id="7588491">len</span><span class="op" id="7588494">(</span><span class="ident" id="7588495">x</span><span class="op" id="7588496">.</span><span class="ident" id="7588497">sa</span><span class="op" id="7588499">)</span>&nbsp;<span class="op" id="7588501">}</span><br>
<span class="lineno"></span><span class="keyword" id="7588503">func</span>&nbsp;<span class="op" id="7588508">(</span><span class="ident" id="7588509">x</span>&nbsp;<span class="op" id="7588511">*</span><span class="ident" id="7588512">index</span><span class="op" id="7588517">)</span>&nbsp;<span class="ident" id="7588519">Less</span><span class="op" id="7588523">(</span><span class="ident" id="7588524">i</span><span class="op" id="7588525">,</span>&nbsp;<span class="ident" id="7588527">j</span>&nbsp;<span class="builtintype" id="7588529">int</span><span class="op" id="7588532">)</span>&nbsp;<span class="builtintype" id="7588534">bool</span>&nbsp;<span class="op" id="7588539">{</span>&nbsp;<span class="keyword" id="7588541">return</span>&nbsp;<span class="ident" id="7588548">bytes</span><span class="op" id="7588553">.</span><span class="ident" id="7588554">Compare</span><span class="op" id="7588561">(</span><span class="ident" id="7588562">x</span><span class="op" id="7588563">.</span><span class="ident" id="7588564">at</span><span class="op" id="7588566">(</span><span class="ident" id="7588567">i</span><span class="op" id="7588568">)</span><span class="op" id="7588569">,</span>&nbsp;<span class="ident" id="7588571">x</span><span class="op" id="7588572">.</span><span class="ident" id="7588573">at</span><span class="op" id="7588575">(</span><span class="ident" id="7588576">j</span><span class="op" id="7588577">)</span><span class="op" id="7588578">)</span>&nbsp;<span class="op" id="7588580">&lt;</span>&nbsp;<span class="num" id="7588582">0</span>&nbsp;<span class="op" id="7588584">}</span><br>
<span class="lineno"></span><span class="keyword" id="7588586">func</span>&nbsp;<span class="op" id="7588591">(</span><span class="ident" id="7588592">x</span>&nbsp;<span class="op" id="7588594">*</span><span class="ident" id="7588595">index</span><span class="op" id="7588600">)</span>&nbsp;<span class="ident" id="7588602">Swap</span><span class="op" id="7588606">(</span><span class="ident" id="7588607">i</span><span class="op" id="7588608">,</span>&nbsp;<span class="ident" id="7588610">j</span>&nbsp;<span class="builtintype" id="7588612">int</span><span class="op" id="7588615">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7588622">{</span>&nbsp;<span class="ident" id="7588624">x</span><span class="op" id="7588625">.</span><span class="ident" id="7588626">sa</span><span class="op" id="7588628">[</span><span class="ident" id="7588629">i</span><span class="op" id="7588630">]</span><span class="op" id="7588631">,</span>&nbsp;<span class="ident" id="7588633">x</span><span class="op" id="7588634">.</span><span class="ident" id="7588635">sa</span><span class="op" id="7588637">[</span><span class="ident" id="7588638">j</span><span class="op" id="7588639">]</span>&nbsp;<span class="op" id="7588641">=</span>&nbsp;<span class="ident" id="7588643">x</span><span class="op" id="7588644">.</span><span class="ident" id="7588645">sa</span><span class="op" id="7588647">[</span><span class="ident" id="7588648">j</span><span class="op" id="7588649">]</span><span class="op" id="7588650">,</span>&nbsp;<span class="ident" id="7588652">x</span><span class="op" id="7588653">.</span><span class="ident" id="7588654">sa</span><span class="op" id="7588656">[</span><span class="ident" id="7588657">i</span><span class="op" id="7588658">]</span>&nbsp;<span class="op" id="7588660">}</span><br>
<span class="lineno"></span><span class="keyword" id="7588662">func</span>&nbsp;<span class="op" id="7588667">(</span><span class="ident" id="7588668">a</span>&nbsp;<span class="op" id="7588670">*</span><span class="ident" id="7588671">index</span><span class="op" id="7588676">)</span>&nbsp;<span class="ident" id="7588678">at</span><span class="op" id="7588680">(</span><span class="ident" id="7588681">i</span>&nbsp;<span class="builtintype" id="7588683">int</span><span class="op" id="7588686">)</span>&nbsp;<span class="op" id="7588688">[</span><span class="op" id="7588689">]</span><span class="builtintype" id="7588690">byte</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7588698">{</span>&nbsp;<span class="keyword" id="7588700">return</span>&nbsp;<span class="ident" id="7588707">a</span><span class="op" id="7588708">.</span><span class="ident" id="7588709">data</span><span class="op" id="7588713">[</span><span class="ident" id="7588714">a</span><span class="op" id="7588715">.</span><span class="ident" id="7588716">sa</span><span class="op" id="7588718">[</span><span class="ident" id="7588719">i</span><span class="op" id="7588720">]</span><span class="op" id="7588721">:</span><span class="op" id="7588722">]</span>&nbsp;<span class="op" id="7588724">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="7588727">func</span>&nbsp;<span class="ident" id="7588732">testConstruction</span><span class="op" id="7588748">(</span><span class="ident" id="7588749">t</span>&nbsp;<span class="op" id="7588751">*</span><span class="ident" id="7588752">testing</span><span class="op" id="7588759">.</span><span class="ident" id="7588760">T</span><span class="op" id="7588761">,</span>&nbsp;<span class="ident" id="7588763">tc</span>&nbsp;<span class="op" id="7588766">*</span><span class="ident" id="7588767">testCase</span><span class="op" id="7588775">,</span>&nbsp;<span class="ident" id="7588777">x</span>&nbsp;<span class="op" id="7588779">*</span><span class="ident" id="7588780">Index</span><span class="op" id="7588785">)</span>&nbsp;<span class="op" id="7588787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7588790">if</span>&nbsp;<span class="op" id="7588793">!</span><span class="ident" id="7588794">sort</span><span class="op" id="7588798">.</span><span class="ident" id="7588799">IsSorted</span><span class="op" id="7588807">(</span><span class="op" id="7588808">(</span><span class="op" id="7588809">*</span><span class="ident" id="7588810">index</span><span class="op" id="7588815">)</span><span class="op" id="7588816">(</span><span class="ident" id="7588817">x</span><span class="op" id="7588818">)</span><span class="op" id="7588819">)</span>&nbsp;<span class="op" id="7588821">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7588825">t</span><span class="op" id="7588826">.</span><span class="ident" id="7588827">Errorf</span><span class="op" id="7588833">(</span><span class="string" id="7588834">&#34;failed&nbsp;testConstruction&nbsp;%s&#34;</span><span class="op" id="7588862">,</span>&nbsp;<span class="ident" id="7588864">tc</span><span class="op" id="7588866">.</span><span class="ident" id="7588867">name</span><span class="op" id="7588871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7588874">}</span><br>
<span class="lineno"></span><span class="op" id="7588876">}</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="keyword" id="7588879">func</span>&nbsp;<span class="ident" id="7588884">equal</span><span class="op" id="7588889">(</span><span class="ident" id="7588890">x</span><span class="op" id="7588891">,</span>&nbsp;<span class="ident" id="7588893">y</span>&nbsp;<span class="op" id="7588895">*</span><span class="ident" id="7588896">Index</span><span class="op" id="7588901">)</span>&nbsp;<span class="builtintype" id="7588903">bool</span>&nbsp;<span class="op" id="7588908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7588911">if</span>&nbsp;<span class="op" id="7588914">!</span><span class="ident" id="7588915">bytes</span><span class="op" id="7588920">.</span><span class="ident" id="7588921">Equal</span><span class="op" id="7588926">(</span><span class="ident" id="7588927">x</span><span class="op" id="7588928">.</span><span class="ident" id="7588929">data</span><span class="op" id="7588933">,</span>&nbsp;<span class="ident" id="7588935">y</span><span class="op" id="7588936">.</span><span class="ident" id="7588937">data</span><span class="op" id="7588941">)</span>&nbsp;<span class="op" id="7588943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7588947">return</span>&nbsp;<span class="builtintype" id="7588954">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7588961">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7588964">for</span>&nbsp;<span class="ident" id="7588968">i</span><span class="op" id="7588969">,</span>&nbsp;<span class="ident" id="7588971">j</span>&nbsp;<span class="op" id="7588973">:=</span>&nbsp;<span class="keyword" id="7588976">range</span>&nbsp;<span class="ident" id="7588982">x</span><span class="op" id="7588983">.</span><span class="ident" id="7588984">sa</span>&nbsp;<span class="op" id="7588987">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7588991">if</span>&nbsp;<span class="ident" id="7588994">j</span>&nbsp;<span class="op" id="7588996">!=</span>&nbsp;<span class="ident" id="7588999">y</span><span class="op" id="7589000">.</span><span class="ident" id="7589001">sa</span><span class="op" id="7589003">[</span><span class="ident" id="7589004">i</span><span class="op" id="7589005">]</span>&nbsp;<span class="op" id="7589007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7589012">return</span>&nbsp;<span class="builtintype" id="7589019">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7589027">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7589030">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7589033">return</span>&nbsp;<span class="builtintype" id="7589040">true</span><br>
<span class="lineno"></span><span class="op" id="7589045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7589048">//&nbsp;returns&nbsp;the&nbsp;serialized&nbsp;index&nbsp;size</span><br>
<span class="lineno"></span><span class="keyword" id="7589085">func</span>&nbsp;<span class="ident" id="7589090">testSaveRestore</span><span class="op" id="7589105">(</span><span class="ident" id="7589106">t</span>&nbsp;<span class="op" id="7589108">*</span><span class="ident" id="7589109">testing</span><span class="op" id="7589116">.</span><span class="ident" id="7589117">T</span><span class="op" id="7589118">,</span>&nbsp;<span class="ident" id="7589120">tc</span>&nbsp;<span class="op" id="7589123">*</span><span class="ident" id="7589124">testCase</span><span class="op" id="7589132">,</span>&nbsp;<span class="ident" id="7589134">x</span>&nbsp;<span class="op" id="7589136">*</span><span class="ident" id="7589137">Index</span><span class="op" id="7589142">)</span>&nbsp;<span class="builtintype" id="7589144">int</span>&nbsp;<span class="op" id="7589148">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7589151">var</span>&nbsp;<span class="ident" id="7589155">buf</span>&nbsp;<span class="ident" id="7589159">bytes</span><span class="op" id="7589164">.</span><span class="ident" id="7589165">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7589173">if</span>&nbsp;<span class="ident" id="7589176">err</span>&nbsp;<span class="op" id="7589180">:=</span>&nbsp;<span class="ident" id="7589183">x</span><span class="op" id="7589184">.</span><span class="ident" id="7589185">Write</span><span class="op" id="7589190">(</span><span class="op" id="7589191">&amp;</span><span class="ident" id="7589192">buf</span><span class="op" id="7589195">)</span><span class="op" id="7589196">;</span>&nbsp;<span class="ident" id="7589198">err</span>&nbsp;<span class="op" id="7589202">!=</span>&nbsp;<span class="builtintype" id="7589205">nil</span>&nbsp;<span class="op" id="7589209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589213">t</span><span class="op" id="7589214">.</span><span class="ident" id="7589215">Errorf</span><span class="op" id="7589221">(</span><span class="string" id="7589222">&#34;failed&nbsp;writing&nbsp;index&nbsp;%s&nbsp;(%s)&#34;</span><span class="op" id="7589252">,</span>&nbsp;<span class="ident" id="7589254">tc</span><span class="op" id="7589256">.</span><span class="ident" id="7589257">name</span><span class="op" id="7589261">,</span>&nbsp;<span class="ident" id="7589263">err</span><span class="op" id="7589266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7589269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589272">size</span>&nbsp;<span class="op" id="7589277">:=</span>&nbsp;<span class="ident" id="7589280">buf</span><span class="op" id="7589283">.</span><span class="ident" id="7589284">Len</span><span class="op" id="7589287">(</span><span class="op" id="7589288">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7589291">var</span>&nbsp;<span class="ident" id="7589295">y</span>&nbsp;<span class="ident" id="7589297">Index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7589304">if</span>&nbsp;<span class="ident" id="7589307">err</span>&nbsp;<span class="op" id="7589311">:=</span>&nbsp;<span class="ident" id="7589314">y</span><span class="op" id="7589315">.</span><span class="ident" id="7589316">Read</span><span class="op" id="7589320">(</span><span class="op" id="7589321">&amp;</span><span class="ident" id="7589322">buf</span><span class="op" id="7589325">)</span><span class="op" id="7589326">;</span>&nbsp;<span class="ident" id="7589328">err</span>&nbsp;<span class="op" id="7589332">!=</span>&nbsp;<span class="builtintype" id="7589335">nil</span>&nbsp;<span class="op" id="7589339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589343">t</span><span class="op" id="7589344">.</span><span class="ident" id="7589345">Errorf</span><span class="op" id="7589351">(</span><span class="string" id="7589352">&#34;failed&nbsp;reading&nbsp;index&nbsp;%s&nbsp;(%s)&#34;</span><span class="op" id="7589382">,</span>&nbsp;<span class="ident" id="7589384">tc</span><span class="op" id="7589386">.</span><span class="ident" id="7589387">name</span><span class="op" id="7589391">,</span>&nbsp;<span class="ident" id="7589393">err</span><span class="op" id="7589396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7589399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7589402">if</span>&nbsp;<span class="op" id="7589405">!</span><span class="ident" id="7589406">equal</span><span class="op" id="7589411">(</span><span class="ident" id="7589412">x</span><span class="op" id="7589413">,</span>&nbsp;<span class="op" id="7589415">&amp;</span><span class="ident" id="7589416">y</span><span class="op" id="7589417">)</span>&nbsp;<span class="op" id="7589419">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589423">t</span><span class="op" id="7589424">.</span><span class="ident" id="7589425">Errorf</span><span class="op" id="7589431">(</span><span class="string" id="7589432">&#34;restored&nbsp;index&nbsp;doesn&#39;t&nbsp;match&nbsp;saved&nbsp;index&nbsp;%s&#34;</span><span class="op" id="7589477">,</span>&nbsp;<span class="ident" id="7589479">tc</span><span class="op" id="7589481">.</span><span class="ident" id="7589482">name</span><span class="op" id="7589486">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7589489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7589492">return</span>&nbsp;<span class="ident" id="7589499">size</span><br>
<span class="lineno"></span><span class="op" id="7589504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">250</span><span class="keyword" id="7589507">func</span>&nbsp;<span class="ident" id="7589512">TestIndex</span><span class="op" id="7589521">(</span><span class="ident" id="7589522">t</span>&nbsp;<span class="op" id="7589524">*</span><span class="ident" id="7589525">testing</span><span class="op" id="7589532">.</span><span class="ident" id="7589533">T</span><span class="op" id="7589534">)</span>&nbsp;<span class="op" id="7589536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7589539">for</span>&nbsp;<span class="ident" id="7589543">_</span><span class="op" id="7589544">,</span>&nbsp;<span class="ident" id="7589546">tc</span>&nbsp;<span class="op" id="7589549">:=</span>&nbsp;<span class="keyword" id="7589552">range</span>&nbsp;<span class="ident" id="7589558">testCases</span>&nbsp;<span class="op" id="7589568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589572">x</span>&nbsp;<span class="op" id="7589574">:=</span>&nbsp;<span class="ident" id="7589577">New</span><span class="op" id="7589580">(</span><span class="op" id="7589581">[</span><span class="op" id="7589582">]</span><span class="builtintype" id="7589583">byte</span><span class="op" id="7589587">(</span><span class="ident" id="7589588">tc</span><span class="op" id="7589590">.</span><span class="ident" id="7589591">source</span><span class="op" id="7589597">)</span><span class="op" id="7589598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589602">testConstruction</span><span class="op" id="7589618">(</span><span class="ident" id="7589619">t</span><span class="op" id="7589620">,</span>&nbsp;<span class="op" id="7589622">&amp;</span><span class="ident" id="7589623">tc</span><span class="op" id="7589625">,</span>&nbsp;<span class="ident" id="7589627">x</span><span class="op" id="7589628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589632">testSaveRestore</span><span class="op" id="7589647">(</span><span class="ident" id="7589648">t</span><span class="op" id="7589649">,</span>&nbsp;<span class="op" id="7589651">&amp;</span><span class="ident" id="7589652">tc</span><span class="op" id="7589654">,</span>&nbsp;<span class="ident" id="7589656">x</span><span class="op" id="7589657">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589661">testLookups</span><span class="op" id="7589672">(</span><span class="ident" id="7589673">t</span><span class="op" id="7589674">,</span>&nbsp;<span class="op" id="7589676">&amp;</span><span class="ident" id="7589677">tc</span><span class="op" id="7589679">,</span>&nbsp;<span class="ident" id="7589681">x</span><span class="op" id="7589682">,</span>&nbsp;<span class="num" id="7589684">0</span><span class="op" id="7589685">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589689">testLookups</span><span class="op" id="7589700">(</span><span class="ident" id="7589701">t</span><span class="op" id="7589702">,</span>&nbsp;<span class="op" id="7589704">&amp;</span><span class="ident" id="7589705">tc</span><span class="op" id="7589707">,</span>&nbsp;<span class="ident" id="7589709">x</span><span class="op" id="7589710">,</span>&nbsp;<span class="num" id="7589712">1</span><span class="op" id="7589713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589717">testLookups</span><span class="op" id="7589728">(</span><span class="ident" id="7589729">t</span><span class="op" id="7589730">,</span>&nbsp;<span class="op" id="7589732">&amp;</span><span class="ident" id="7589733">tc</span><span class="op" id="7589735">,</span>&nbsp;<span class="ident" id="7589737">x</span><span class="op" id="7589738">,</span>&nbsp;<span class="num" id="7589740">10</span><span class="op" id="7589742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589746">testLookups</span><span class="op" id="7589757">(</span><span class="ident" id="7589758">t</span><span class="op" id="7589759">,</span>&nbsp;<span class="op" id="7589761">&amp;</span><span class="ident" id="7589762">tc</span><span class="op" id="7589764">,</span>&nbsp;<span class="ident" id="7589766">x</span><span class="op" id="7589767">,</span>&nbsp;<span class="num" id="7589769">2e9</span><span class="op" id="7589772">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7589776">testLookups</span><span class="op" id="7589787">(</span><span class="ident" id="7589788">t</span><span class="op" id="7589789">,</span>&nbsp;<span class="op" id="7589791">&amp;</span><span class="ident" id="7589792">tc</span><span class="op" id="7589794">,</span>&nbsp;<span class="ident" id="7589796">x</span><span class="op" id="7589797">,</span>&nbsp;<span class="op" id="7589799">-</span><span class="num" id="7589800">1</span><span class="op" id="7589801">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7589804">}</span><br>
<span class="lineno"></span><span class="op" id="7589806">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7589809">//&nbsp;Of&nbsp;all&nbsp;possible&nbsp;inputs,&nbsp;the&nbsp;random&nbsp;bytes&nbsp;have&nbsp;the&nbsp;least&nbsp;amount&nbsp;of&nbsp;substring</span><br>
<span class="lineno"></span><span class="comment" id="7589888">//&nbsp;repetition,&nbsp;and&nbsp;the&nbsp;repeated&nbsp;bytes&nbsp;have&nbsp;the&nbsp;most.&nbsp;For&nbsp;most&nbsp;algorithms,</span><br>
<span class="lineno">265</span><span class="comment" id="7589962">//&nbsp;the&nbsp;running&nbsp;time&nbsp;of&nbsp;every&nbsp;input&nbsp;will&nbsp;be&nbsp;between&nbsp;these&nbsp;two.</span><br>
<span class="lineno"></span><span class="keyword" id="7590024">func</span>&nbsp;<span class="ident" id="7590029">benchmarkNew</span><span class="op" id="7590041">(</span><span class="ident" id="7590042">b</span>&nbsp;<span class="op" id="7590044">*</span><span class="ident" id="7590045">testing</span><span class="op" id="7590052">.</span><span class="ident" id="7590053">B</span><span class="op" id="7590054">,</span>&nbsp;<span class="ident" id="7590056">random</span>&nbsp;<span class="builtintype" id="7590063">bool</span><span class="op" id="7590067">)</span>&nbsp;<span class="op" id="7590069">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590072">b</span><span class="op" id="7590073">.</span><span class="ident" id="7590074">StopTimer</span><span class="op" id="7590083">(</span><span class="op" id="7590084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590087">data</span>&nbsp;<span class="op" id="7590092">:=</span>&nbsp;<span class="builtinfunc" id="7590095">make</span><span class="op" id="7590099">(</span><span class="op" id="7590100">[</span><span class="op" id="7590101">]</span><span class="builtintype" id="7590102">byte</span><span class="op" id="7590106">,</span>&nbsp;<span class="num" id="7590108">1e6</span><span class="op" id="7590111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7590114">if</span>&nbsp;<span class="ident" id="7590117">random</span>&nbsp;<span class="op" id="7590124">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7590128">for</span>&nbsp;<span class="ident" id="7590132">i</span>&nbsp;<span class="op" id="7590134">:=</span>&nbsp;<span class="keyword" id="7590137">range</span>&nbsp;<span class="ident" id="7590143">data</span>&nbsp;<span class="op" id="7590148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590153">data</span><span class="op" id="7590157">[</span><span class="ident" id="7590158">i</span><span class="op" id="7590159">]</span>&nbsp;<span class="op" id="7590161">=</span>&nbsp;<span class="builtintype" id="7590163">byte</span><span class="op" id="7590167">(</span><span class="ident" id="7590168">rand</span><span class="op" id="7590172">.</span><span class="ident" id="7590173">Intn</span><span class="op" id="7590177">(</span><span class="num" id="7590178">256</span><span class="op" id="7590181">)</span><span class="op" id="7590182">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7590186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7590189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590192">b</span><span class="op" id="7590193">.</span><span class="ident" id="7590194">StartTimer</span><span class="op" id="7590204">(</span><span class="op" id="7590205">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7590208">for</span>&nbsp;<span class="ident" id="7590212">i</span>&nbsp;<span class="op" id="7590214">:=</span>&nbsp;<span class="num" id="7590217">0</span><span class="op" id="7590218">;</span>&nbsp;<span class="ident" id="7590220">i</span>&nbsp;<span class="op" id="7590222">&lt;</span>&nbsp;<span class="ident" id="7590224">b</span><span class="op" id="7590225">.</span><span class="ident" id="7590226">N</span><span class="op" id="7590227">;</span>&nbsp;<span class="ident" id="7590229">i</span><span class="op" id="7590230">++</span>&nbsp;<span class="op" id="7590233">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590237">New</span><span class="op" id="7590240">(</span><span class="ident" id="7590241">data</span><span class="op" id="7590245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7590248">}</span><br>
<span class="lineno"></span><span class="op" id="7590250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="keyword" id="7590253">func</span>&nbsp;<span class="ident" id="7590258">BenchmarkNewIndexRandom</span><span class="op" id="7590281">(</span><span class="ident" id="7590282">b</span>&nbsp;<span class="op" id="7590284">*</span><span class="ident" id="7590285">testing</span><span class="op" id="7590292">.</span><span class="ident" id="7590293">B</span><span class="op" id="7590294">)</span>&nbsp;<span class="op" id="7590296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590299">benchmarkNew</span><span class="op" id="7590311">(</span><span class="ident" id="7590312">b</span><span class="op" id="7590313">,</span>&nbsp;<span class="builtintype" id="7590315">true</span><span class="op" id="7590319">)</span><br>
<span class="lineno"></span><span class="op" id="7590321">}</span><br>
<span class="lineno"></span><span class="keyword" id="7590323">func</span>&nbsp;<span class="ident" id="7590328">BenchmarkNewIndexRepeat</span><span class="op" id="7590351">(</span><span class="ident" id="7590352">b</span>&nbsp;<span class="op" id="7590354">*</span><span class="ident" id="7590355">testing</span><span class="op" id="7590362">.</span><span class="ident" id="7590363">B</span><span class="op" id="7590364">)</span>&nbsp;<span class="op" id="7590366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590369">benchmarkNew</span><span class="op" id="7590381">(</span><span class="ident" id="7590382">b</span><span class="op" id="7590383">,</span>&nbsp;<span class="builtintype" id="7590385">false</span><span class="op" id="7590390">)</span><br>
<span class="lineno">285</span><span class="op" id="7590392">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7590395">func</span>&nbsp;<span class="ident" id="7590400">BenchmarkSaveRestore</span><span class="op" id="7590420">(</span><span class="ident" id="7590421">b</span>&nbsp;<span class="op" id="7590423">*</span><span class="ident" id="7590424">testing</span><span class="op" id="7590431">.</span><span class="ident" id="7590432">B</span><span class="op" id="7590433">)</span>&nbsp;<span class="op" id="7590435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590438">b</span><span class="op" id="7590439">.</span><span class="ident" id="7590440">StopTimer</span><span class="op" id="7590449">(</span><span class="op" id="7590450">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590453">r</span>&nbsp;<span class="op" id="7590455">:=</span>&nbsp;<span class="ident" id="7590458">rand</span><span class="op" id="7590462">.</span><span class="ident" id="7590463">New</span><span class="op" id="7590466">(</span><span class="ident" id="7590467">rand</span><span class="op" id="7590471">.</span><span class="ident" id="7590472">NewSource</span><span class="op" id="7590481">(</span><span class="num" id="7590482">0x5a77a1</span><span class="op" id="7590490">)</span><span class="op" id="7590491">)</span>&nbsp;<span class="comment" id="7590493">//&nbsp;guarantee&nbsp;always&nbsp;same&nbsp;sequence</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590528">data</span>&nbsp;<span class="op" id="7590533">:=</span>&nbsp;<span class="builtinfunc" id="7590536">make</span><span class="op" id="7590540">(</span><span class="op" id="7590541">[</span><span class="op" id="7590542">]</span><span class="builtintype" id="7590543">byte</span><span class="op" id="7590547">,</span>&nbsp;<span class="num" id="7590549">1</span><span class="op" id="7590550">&lt;&lt;</span><span class="num" id="7590552">20</span><span class="op" id="7590554">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7590568">//&nbsp;1MB&nbsp;of&nbsp;data&nbsp;to&nbsp;index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7590593">for</span>&nbsp;<span class="ident" id="7590597">i</span>&nbsp;<span class="op" id="7590599">:=</span>&nbsp;<span class="keyword" id="7590602">range</span>&nbsp;<span class="ident" id="7590608">data</span>&nbsp;<span class="op" id="7590613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590617">data</span><span class="op" id="7590621">[</span><span class="ident" id="7590622">i</span><span class="op" id="7590623">]</span>&nbsp;<span class="op" id="7590625">=</span>&nbsp;<span class="builtintype" id="7590627">byte</span><span class="op" id="7590631">(</span><span class="ident" id="7590632">r</span><span class="op" id="7590633">.</span><span class="ident" id="7590634">Intn</span><span class="op" id="7590638">(</span><span class="num" id="7590639">256</span><span class="op" id="7590642">)</span><span class="op" id="7590643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7590646">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590649">x</span>&nbsp;<span class="op" id="7590651">:=</span>&nbsp;<span class="ident" id="7590654">New</span><span class="op" id="7590657">(</span><span class="ident" id="7590658">data</span><span class="op" id="7590662">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590665">size</span>&nbsp;<span class="op" id="7590670">:=</span>&nbsp;<span class="ident" id="7590673">testSaveRestore</span><span class="op" id="7590688">(</span><span class="builtintype" id="7590689">nil</span><span class="op" id="7590692">,</span>&nbsp;<span class="builtintype" id="7590694">nil</span><span class="op" id="7590697">,</span>&nbsp;<span class="ident" id="7590699">x</span><span class="op" id="7590700">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="7590708">//&nbsp;verify&nbsp;correctness</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590731">buf</span>&nbsp;<span class="op" id="7590735">:=</span>&nbsp;<span class="ident" id="7590738">bytes</span><span class="op" id="7590743">.</span><span class="ident" id="7590744">NewBuffer</span><span class="op" id="7590753">(</span><span class="builtinfunc" id="7590754">make</span><span class="op" id="7590758">(</span><span class="op" id="7590759">[</span><span class="op" id="7590760">]</span><span class="builtintype" id="7590761">byte</span><span class="op" id="7590765">,</span>&nbsp;<span class="ident" id="7590767">size</span><span class="op" id="7590771">)</span><span class="op" id="7590772">)</span>&nbsp;<span class="comment" id="7590774">//&nbsp;avoid&nbsp;growing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590792">b</span><span class="op" id="7590793">.</span><span class="ident" id="7590794">SetBytes</span><span class="op" id="7590802">(</span><span class="builtintype" id="7590803">int64</span><span class="op" id="7590808">(</span><span class="ident" id="7590809">size</span><span class="op" id="7590813">)</span><span class="op" id="7590814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590817">b</span><span class="op" id="7590818">.</span><span class="ident" id="7590819">StartTimer</span><span class="op" id="7590829">(</span><span class="op" id="7590830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7590833">for</span>&nbsp;<span class="ident" id="7590837">i</span>&nbsp;<span class="op" id="7590839">:=</span>&nbsp;<span class="num" id="7590842">0</span><span class="op" id="7590843">;</span>&nbsp;<span class="ident" id="7590845">i</span>&nbsp;<span class="op" id="7590847">&lt;</span>&nbsp;<span class="ident" id="7590849">b</span><span class="op" id="7590850">.</span><span class="ident" id="7590851">N</span><span class="op" id="7590852">;</span>&nbsp;<span class="ident" id="7590854">i</span><span class="op" id="7590855">++</span>&nbsp;<span class="op" id="7590858">{</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590862">x</span><span class="op" id="7590863">.</span><span class="ident" id="7590864">Write</span><span class="op" id="7590869">(</span><span class="ident" id="7590870">buf</span><span class="op" id="7590873">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="7590877">var</span>&nbsp;<span class="ident" id="7590881">y</span>&nbsp;<span class="ident" id="7590883">Index</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7590891">y</span><span class="op" id="7590892">.</span><span class="ident" id="7590893">Read</span><span class="op" id="7590897">(</span><span class="ident" id="7590898">buf</span><span class="op" id="7590901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="7590904">}</span><br>
<span class="lineno"></span><span class="op" id="7590906">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
