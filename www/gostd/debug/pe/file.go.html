<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>debug/pe</h2>
<ul>
<li><a href="/gostd/debug/pe/file.go.html" class="current">file.go</a></li>
<li><a href="/gostd/debug/pe/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/debug/pe/pe.go.html">pe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5796614">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5796670">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5796724">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5796775">//&nbsp;Package&nbsp;pe&nbsp;implements&nbsp;access&nbsp;to&nbsp;PE&nbsp;(Microsoft&nbsp;Windows&nbsp;Portable&nbsp;Executable)&nbsp;files.</span><br>
<span class="lineno"></span><span class="keyword" id="5796860">package</span>&nbsp;<span class="ident" id="5796868">pe</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5796872">import</span>&nbsp;<span class="op" id="5796879">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5796882">&#34;debug/dwarf&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5796897">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5796916">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5796926">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5796933">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5796939">&#34;os&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="5796945">&#34;strconv&#34;</span><br>
<span class="lineno"></span><span class="op" id="5796955">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5796958">//&nbsp;A&nbsp;File&nbsp;represents&nbsp;an&nbsp;open&nbsp;PE&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5796996">type</span>&nbsp;<span class="ident" id="5797001">File</span>&nbsp;<span class="keyword" id="5797006">struct</span>&nbsp;<span class="op" id="5797013">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797016">FileHeader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797028">OptionalHeader</span>&nbsp;<span class="keyword" id="5797043">interface</span><span class="op" id="5797052">{</span><span class="op" id="5797053">}</span>&nbsp;<span class="comment" id="5797055">//&nbsp;of&nbsp;type&nbsp;*OptionalHeader32&nbsp;or&nbsp;*OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797106">Sections</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5797121">[</span><span class="op" id="5797122">]</span><span class="op" id="5797123">*</span><span class="ident" id="5797124">Section</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797133">Symbols</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5797148">[</span><span class="op" id="5797149">]</span><span class="op" id="5797150">*</span><span class="ident" id="5797151">Symbol</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797160">closer</span>&nbsp;<span class="ident" id="5797167">io</span><span class="op" id="5797169">.</span><span class="ident" id="5797170">Closer</span><br>
<span class="lineno"></span><span class="op" id="5797177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5797180">type</span>&nbsp;<span class="ident" id="5797185">SectionHeader</span>&nbsp;<span class="keyword" id="5797199">struct</span>&nbsp;<span class="op" id="5797206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797209">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5797230">string</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797238">VirtualSize</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5797259">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797267">VirtualAddress</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5797288">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797296">Size</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5797317">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797325">Offset</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5797346">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797354">PointerToRelocations</span>&nbsp;<span class="builtintype" id="5797375">uint32</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797383">PointerToLineNumbers</span>&nbsp;<span class="builtintype" id="5797404">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797412">NumberOfRelocations</span>&nbsp;&nbsp;<span class="builtintype" id="5797433">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797441">NumberOfLineNumbers</span>&nbsp;&nbsp;<span class="builtintype" id="5797462">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797470">Characteristics</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5797491">uint32</span><br>
<span class="lineno"></span><span class="op" id="5797498">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="5797501">type</span>&nbsp;<span class="ident" id="5797506">Section</span>&nbsp;<span class="keyword" id="5797514">struct</span>&nbsp;<span class="op" id="5797521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797524">SectionHeader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5797540">//&nbsp;Embed&nbsp;ReaderAt&nbsp;for&nbsp;ReadAt&nbsp;method.</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5797578">//&nbsp;Do&nbsp;not&nbsp;embed&nbsp;SectionReader&nbsp;directly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5797618">//&nbsp;to&nbsp;avoid&nbsp;having&nbsp;Read&nbsp;and&nbsp;Seek.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5797653">//&nbsp;If&nbsp;a&nbsp;client&nbsp;wants&nbsp;Read&nbsp;and&nbsp;Seek&nbsp;it&nbsp;must&nbsp;use</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5797701">//&nbsp;Open()&nbsp;to&nbsp;avoid&nbsp;fighting&nbsp;over&nbsp;the&nbsp;seek&nbsp;offset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5797751">//&nbsp;with&nbsp;other&nbsp;clients.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797775">io</span><span class="op" id="5797777">.</span><span class="ident" id="5797778">ReaderAt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797788">sr</span>&nbsp;<span class="op" id="5797791">*</span><span class="ident" id="5797792">io</span><span class="op" id="5797794">.</span><span class="ident" id="5797795">SectionReader</span><br>
<span class="lineno"></span><span class="op" id="5797809">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5797812">type</span>&nbsp;<span class="ident" id="5797817">Symbol</span>&nbsp;<span class="keyword" id="5797824">struct</span>&nbsp;<span class="op" id="5797831">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797834">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5797848">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797856">Value</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5797870">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797878">SectionNumber</span>&nbsp;<span class="builtintype" id="5797892">int16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797899">Type</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5797913">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797921">StorageClass</span>&nbsp;&nbsp;<span class="builtintype" id="5797935">uint8</span><br>
<span class="lineno">60</span><span class="op" id="5797941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5797944">type</span>&nbsp;<span class="ident" id="5797949">ImportDirectory</span>&nbsp;<span class="keyword" id="5797965">struct</span>&nbsp;<span class="op" id="5797972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5797975">OriginalFirstThunk</span>&nbsp;<span class="builtintype" id="5797994">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5798002">TimeDateStamp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5798021">uint32</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5798029">ForwarderChain</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5798048">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5798056">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5798075">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5798083">FirstThunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="5798102">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5798111">dll</span>&nbsp;<span class="builtintype" id="5798115">string</span><br>
<span class="lineno">70</span><span class="op" id="5798122">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5798125">//&nbsp;Data&nbsp;reads&nbsp;and&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5798183">func</span>&nbsp;<span class="op" id="5798188">(</span><span class="ident" id="5798189">s</span>&nbsp;<span class="op" id="5798191">*</span><span class="ident" id="5798192">Section</span><span class="op" id="5798199">)</span>&nbsp;<span class="ident" id="5798201">Data</span><span class="op" id="5798205">(</span><span class="op" id="5798206">)</span>&nbsp;<span class="op" id="5798208">(</span><span class="op" id="5798209">[</span><span class="op" id="5798210">]</span><span class="builtintype" id="5798211">byte</span><span class="op" id="5798215">,</span>&nbsp;<span class="builtintype" id="5798217">error</span><span class="op" id="5798222">)</span>&nbsp;<span class="op" id="5798224">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5798227">dat</span>&nbsp;<span class="op" id="5798231">:=</span>&nbsp;<span class="builtinfunc" id="5798234">make</span><span class="op" id="5798238">(</span><span class="op" id="5798239">[</span><span class="op" id="5798240">]</span><span class="builtintype" id="5798241">byte</span><span class="op" id="5798245">,</span>&nbsp;<span class="ident" id="5798247">s</span><span class="op" id="5798248">.</span><span class="ident" id="5798249">sr</span><span class="op" id="5798251">.</span><span class="ident" id="5798252">Size</span><span class="op" id="5798256">(</span><span class="op" id="5798257">)</span><span class="op" id="5798258">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5798261">n</span><span class="op" id="5798262">,</span>&nbsp;<span class="ident" id="5798264">err</span>&nbsp;<span class="op" id="5798268">:=</span>&nbsp;<span class="ident" id="5798271">s</span><span class="op" id="5798272">.</span><span class="ident" id="5798273">sr</span><span class="op" id="5798275">.</span><span class="ident" id="5798276">ReadAt</span><span class="op" id="5798282">(</span><span class="ident" id="5798283">dat</span><span class="op" id="5798286">,</span>&nbsp;<span class="num" id="5798288">0</span><span class="op" id="5798289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5798292">if</span>&nbsp;<span class="ident" id="5798295">n</span>&nbsp;<span class="op" id="5798297">==</span>&nbsp;<span class="builtinfunc" id="5798300">len</span><span class="op" id="5798303">(</span><span class="ident" id="5798304">dat</span><span class="op" id="5798307">)</span>&nbsp;<span class="op" id="5798309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5798313">err</span>&nbsp;<span class="op" id="5798317">=</span>&nbsp;<span class="builtintype" id="5798319">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5798324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5798327">return</span>&nbsp;<span class="ident" id="5798334">dat</span><span class="op" id="5798337">[</span><span class="num" id="5798338">0</span><span class="op" id="5798339">:</span><span class="ident" id="5798340">n</span><span class="op" id="5798341">]</span><span class="op" id="5798342">,</span>&nbsp;<span class="ident" id="5798344">err</span><br>
<span class="lineno">80</span><span class="op" id="5798348">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5798351">//&nbsp;Open&nbsp;returns&nbsp;a&nbsp;new&nbsp;ReadSeeker&nbsp;reading&nbsp;the&nbsp;PE&nbsp;section.</span><br>
<span class="lineno"></span><span class="keyword" id="5798408">func</span>&nbsp;<span class="op" id="5798413">(</span><span class="ident" id="5798414">s</span>&nbsp;<span class="op" id="5798416">*</span><span class="ident" id="5798417">Section</span><span class="op" id="5798424">)</span>&nbsp;<span class="ident" id="5798426">Open</span><span class="op" id="5798430">(</span><span class="op" id="5798431">)</span>&nbsp;<span class="ident" id="5798433">io</span><span class="op" id="5798435">.</span><span class="ident" id="5798436">ReadSeeker</span>&nbsp;<span class="op" id="5798447">{</span>&nbsp;<span class="keyword" id="5798449">return</span>&nbsp;<span class="ident" id="5798456">io</span><span class="op" id="5798458">.</span><span class="ident" id="5798459">NewSectionReader</span><span class="op" id="5798475">(</span><span class="ident" id="5798476">s</span><span class="op" id="5798477">.</span><span class="ident" id="5798478">sr</span><span class="op" id="5798480">,</span>&nbsp;<span class="num" id="5798482">0</span><span class="op" id="5798483">,</span>&nbsp;<span class="num" id="5798485">1</span><span class="op" id="5798486">&lt;&lt;</span><span class="num" id="5798488">63</span><span class="op" id="5798490">-</span><span class="num" id="5798491">1</span><span class="op" id="5798492">)</span>&nbsp;<span class="op" id="5798494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span><span class="keyword" id="5798497">type</span>&nbsp;<span class="ident" id="5798502">FormatError</span>&nbsp;<span class="keyword" id="5798514">struct</span>&nbsp;<span class="op" id="5798521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5798524">off</span>&nbsp;<span class="builtintype" id="5798528">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5798535">msg</span>&nbsp;<span class="builtintype" id="5798539">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5798547">val</span>&nbsp;<span class="keyword" id="5798551">interface</span><span class="op" id="5798560">{</span><span class="op" id="5798561">}</span><br>
<span class="lineno"></span><span class="op" id="5798563">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="5798566">func</span>&nbsp;<span class="op" id="5798571">(</span><span class="ident" id="5798572">e</span>&nbsp;<span class="op" id="5798574">*</span><span class="ident" id="5798575">FormatError</span><span class="op" id="5798586">)</span>&nbsp;<span class="ident" id="5798588">Error</span><span class="op" id="5798593">(</span><span class="op" id="5798594">)</span>&nbsp;<span class="builtintype" id="5798596">string</span>&nbsp;<span class="op" id="5798603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5798606">msg</span>&nbsp;<span class="op" id="5798610">:=</span>&nbsp;<span class="ident" id="5798613">e</span><span class="op" id="5798614">.</span><span class="ident" id="5798615">msg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5798620">if</span>&nbsp;<span class="ident" id="5798623">e</span><span class="op" id="5798624">.</span><span class="ident" id="5798625">val</span>&nbsp;<span class="op" id="5798629">!=</span>&nbsp;<span class="builtintype" id="5798632">nil</span>&nbsp;<span class="op" id="5798636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5798640">msg</span>&nbsp;<span class="op" id="5798644">+=</span>&nbsp;<span class="ident" id="5798647">fmt</span><span class="op" id="5798650">.</span><span class="ident" id="5798651">Sprintf</span><span class="op" id="5798658">(</span><span class="string" id="5798659">&#34;&nbsp;&#39;%v&#39;&#34;</span><span class="op" id="5798666">,</span>&nbsp;<span class="ident" id="5798668">e</span><span class="op" id="5798669">.</span><span class="ident" id="5798670">val</span><span class="op" id="5798673">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5798676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5798679">msg</span>&nbsp;<span class="op" id="5798683">+=</span>&nbsp;<span class="ident" id="5798686">fmt</span><span class="op" id="5798689">.</span><span class="ident" id="5798690">Sprintf</span><span class="op" id="5798697">(</span><span class="string" id="5798698">&#34;&nbsp;in&nbsp;record&nbsp;at&nbsp;byte&nbsp;%#x&#34;</span><span class="op" id="5798722">,</span>&nbsp;<span class="ident" id="5798724">e</span><span class="op" id="5798725">.</span><span class="ident" id="5798726">off</span><span class="op" id="5798729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5798732">return</span>&nbsp;<span class="ident" id="5798739">msg</span><br>
<span class="lineno"></span><span class="op" id="5798743">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="comment" id="5798746">//&nbsp;Open&nbsp;opens&nbsp;the&nbsp;named&nbsp;file&nbsp;using&nbsp;os.Open&nbsp;and&nbsp;prepares&nbsp;it&nbsp;for&nbsp;use&nbsp;as&nbsp;a&nbsp;PE&nbsp;binary.</span><br>
<span class="lineno"></span><span class="keyword" id="5798829">func</span>&nbsp;<span class="ident" id="5798834">Open</span><span class="op" id="5798838">(</span><span class="ident" id="5798839">name</span>&nbsp;<span class="builtintype" id="5798844">string</span><span class="op" id="5798850">)</span>&nbsp;<span class="op" id="5798852">(</span><span class="op" id="5798853">*</span><span class="ident" id="5798854">File</span><span class="op" id="5798858">,</span>&nbsp;<span class="builtintype" id="5798860">error</span><span class="op" id="5798865">)</span>&nbsp;<span class="op" id="5798867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5798870">f</span><span class="op" id="5798871">,</span>&nbsp;<span class="ident" id="5798873">err</span>&nbsp;<span class="op" id="5798877">:=</span>&nbsp;<span class="ident" id="5798880">os</span><span class="op" id="5798882">.</span><span class="ident" id="5798883">Open</span><span class="op" id="5798887">(</span><span class="ident" id="5798888">name</span><span class="op" id="5798892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5798895">if</span>&nbsp;<span class="ident" id="5798898">err</span>&nbsp;<span class="op" id="5798902">!=</span>&nbsp;<span class="builtintype" id="5798905">nil</span>&nbsp;<span class="op" id="5798909">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5798913">return</span>&nbsp;<span class="builtintype" id="5798920">nil</span><span class="op" id="5798923">,</span>&nbsp;<span class="ident" id="5798925">err</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5798930">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5798933">ff</span><span class="op" id="5798935">,</span>&nbsp;<span class="ident" id="5798937">err</span>&nbsp;<span class="op" id="5798941">:=</span>&nbsp;<span class="ident" id="5798944">NewFile</span><span class="op" id="5798951">(</span><span class="ident" id="5798952">f</span><span class="op" id="5798953">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5798956">if</span>&nbsp;<span class="ident" id="5798959">err</span>&nbsp;<span class="op" id="5798963">!=</span>&nbsp;<span class="builtintype" id="5798966">nil</span>&nbsp;<span class="op" id="5798970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5798974">f</span><span class="op" id="5798975">.</span><span class="ident" id="5798976">Close</span><span class="op" id="5798981">(</span><span class="op" id="5798982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5798986">return</span>&nbsp;<span class="builtintype" id="5798993">nil</span><span class="op" id="5798996">,</span>&nbsp;<span class="ident" id="5798998">err</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5799003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5799006">ff</span><span class="op" id="5799008">.</span><span class="ident" id="5799009">closer</span>&nbsp;<span class="op" id="5799016">=</span>&nbsp;<span class="ident" id="5799018">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5799021">return</span>&nbsp;<span class="ident" id="5799028">ff</span><span class="op" id="5799030">,</span>&nbsp;<span class="builtintype" id="5799032">nil</span><br>
<span class="lineno"></span><span class="op" id="5799036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="comment" id="5799039">//&nbsp;Close&nbsp;closes&nbsp;the&nbsp;File.</span><br>
<span class="lineno"></span><span class="comment" id="5799065">//&nbsp;If&nbsp;the&nbsp;File&nbsp;was&nbsp;created&nbsp;using&nbsp;NewFile&nbsp;directly&nbsp;instead&nbsp;of&nbsp;Open,</span><br>
<span class="lineno"></span><span class="comment" id="5799132">//&nbsp;Close&nbsp;has&nbsp;no&nbsp;effect.</span><br>
<span class="lineno"></span><span class="keyword" id="5799156">func</span>&nbsp;<span class="op" id="5799161">(</span><span class="ident" id="5799162">f</span>&nbsp;<span class="op" id="5799164">*</span><span class="ident" id="5799165">File</span><span class="op" id="5799169">)</span>&nbsp;<span class="ident" id="5799171">Close</span><span class="op" id="5799176">(</span><span class="op" id="5799177">)</span>&nbsp;<span class="builtintype" id="5799179">error</span>&nbsp;<span class="op" id="5799185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5799188">var</span>&nbsp;<span class="ident" id="5799192">err</span>&nbsp;<span class="builtintype" id="5799196">error</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5799203">if</span>&nbsp;<span class="ident" id="5799206">f</span><span class="op" id="5799207">.</span><span class="ident" id="5799208">closer</span>&nbsp;<span class="op" id="5799215">!=</span>&nbsp;<span class="builtintype" id="5799218">nil</span>&nbsp;<span class="op" id="5799222">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5799226">err</span>&nbsp;<span class="op" id="5799230">=</span>&nbsp;<span class="ident" id="5799232">f</span><span class="op" id="5799233">.</span><span class="ident" id="5799234">closer</span><span class="op" id="5799240">.</span><span class="ident" id="5799241">Close</span><span class="op" id="5799246">(</span><span class="op" id="5799247">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5799251">f</span><span class="op" id="5799252">.</span><span class="ident" id="5799253">closer</span>&nbsp;<span class="op" id="5799260">=</span>&nbsp;<span class="builtintype" id="5799262">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5799267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5799270">return</span>&nbsp;<span class="ident" id="5799277">err</span><br>
<span class="lineno">125</span><span class="op" id="5799281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5799284">var</span>&nbsp;<span class="op" id="5799288">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5799291">sizeofOptionalHeader32</span>&nbsp;<span class="op" id="5799314">=</span>&nbsp;<span class="builtintype" id="5799316">uint16</span><span class="op" id="5799322">(</span><span class="ident" id="5799323">binary</span><span class="op" id="5799329">.</span><span class="ident" id="5799330">Size</span><span class="op" id="5799334">(</span><span class="ident" id="5799335">OptionalHeader32</span><span class="op" id="5799351">{</span><span class="op" id="5799352">}</span><span class="op" id="5799353">)</span><span class="op" id="5799354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5799357">sizeofOptionalHeader64</span>&nbsp;<span class="op" id="5799380">=</span>&nbsp;<span class="builtintype" id="5799382">uint16</span><span class="op" id="5799388">(</span><span class="ident" id="5799389">binary</span><span class="op" id="5799395">.</span><span class="ident" id="5799396">Size</span><span class="op" id="5799400">(</span><span class="ident" id="5799401">OptionalHeader64</span><span class="op" id="5799417">{</span><span class="op" id="5799418">}</span><span class="op" id="5799419">)</span><span class="op" id="5799420">)</span><br>
<span class="lineno">130</span><span class="op" id="5799422">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5799425">//&nbsp;NewFile&nbsp;creates&nbsp;a&nbsp;new&nbsp;File&nbsp;for&nbsp;accessing&nbsp;a&nbsp;PE&nbsp;binary&nbsp;in&nbsp;an&nbsp;underlying&nbsp;reader.</span><br>
<span class="lineno"></span><span class="keyword" id="5799506">func</span>&nbsp;<span class="ident" id="5799511">NewFile</span><span class="op" id="5799518">(</span><span class="ident" id="5799519">r</span>&nbsp;<span class="ident" id="5799521">io</span><span class="op" id="5799523">.</span><span class="ident" id="5799524">ReaderAt</span><span class="op" id="5799532">)</span>&nbsp;<span class="op" id="5799534">(</span><span class="op" id="5799535">*</span><span class="ident" id="5799536">File</span><span class="op" id="5799540">,</span>&nbsp;<span class="builtintype" id="5799542">error</span><span class="op" id="5799547">)</span>&nbsp;<span class="op" id="5799549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5799552">f</span>&nbsp;<span class="op" id="5799554">:=</span>&nbsp;<span class="builtinfunc" id="5799557">new</span><span class="op" id="5799560">(</span><span class="ident" id="5799561">File</span><span class="op" id="5799565">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5799568">sr</span>&nbsp;<span class="op" id="5799571">:=</span>&nbsp;<span class="ident" id="5799574">io</span><span class="op" id="5799576">.</span><span class="ident" id="5799577">NewSectionReader</span><span class="op" id="5799593">(</span><span class="ident" id="5799594">r</span><span class="op" id="5799595">,</span>&nbsp;<span class="num" id="5799597">0</span><span class="op" id="5799598">,</span>&nbsp;<span class="num" id="5799600">1</span><span class="op" id="5799601">&lt;&lt;</span><span class="num" id="5799603">63</span><span class="op" id="5799605">-</span><span class="num" id="5799606">1</span><span class="op" id="5799607">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5799611">var</span>&nbsp;<span class="ident" id="5799615">dosheader</span>&nbsp;<span class="op" id="5799625">[</span><span class="num" id="5799626">96</span><span class="op" id="5799628">]</span><span class="builtintype" id="5799629">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5799635">if</span>&nbsp;<span class="ident" id="5799638">_</span><span class="op" id="5799639">,</span>&nbsp;<span class="ident" id="5799641">err</span>&nbsp;<span class="op" id="5799645">:=</span>&nbsp;<span class="ident" id="5799648">r</span><span class="op" id="5799649">.</span><span class="ident" id="5799650">ReadAt</span><span class="op" id="5799656">(</span><span class="ident" id="5799657">dosheader</span><span class="op" id="5799666">[</span><span class="num" id="5799667">0</span><span class="op" id="5799668">:</span><span class="op" id="5799669">]</span><span class="op" id="5799670">,</span>&nbsp;<span class="num" id="5799672">0</span><span class="op" id="5799673">)</span><span class="op" id="5799674">;</span>&nbsp;<span class="ident" id="5799676">err</span>&nbsp;<span class="op" id="5799680">!=</span>&nbsp;<span class="builtintype" id="5799683">nil</span>&nbsp;<span class="op" id="5799687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5799691">return</span>&nbsp;<span class="builtintype" id="5799698">nil</span><span class="op" id="5799701">,</span>&nbsp;<span class="ident" id="5799703">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5799708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5799711">var</span>&nbsp;<span class="ident" id="5799715">base</span>&nbsp;<span class="builtintype" id="5799720">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5799727">if</span>&nbsp;<span class="ident" id="5799730">dosheader</span><span class="op" id="5799739">[</span><span class="num" id="5799740">0</span><span class="op" id="5799741">]</span>&nbsp;<span class="op" id="5799743">==</span>&nbsp;<span class="string" id="5799746">&#39;M&#39;</span>&nbsp;<span class="op" id="5799750">&amp;&amp;</span>&nbsp;<span class="ident" id="5799753">dosheader</span><span class="op" id="5799762">[</span><span class="num" id="5799763">1</span><span class="op" id="5799764">]</span>&nbsp;<span class="op" id="5799766">==</span>&nbsp;<span class="string" id="5799769">&#39;Z&#39;</span>&nbsp;<span class="op" id="5799773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5799777">signoff</span>&nbsp;<span class="op" id="5799785">:=</span>&nbsp;<span class="builtintype" id="5799788">int64</span><span class="op" id="5799793">(</span><span class="ident" id="5799794">binary</span><span class="op" id="5799800">.</span><span class="ident" id="5799801">LittleEndian</span><span class="op" id="5799813">.</span><span class="ident" id="5799814">Uint32</span><span class="op" id="5799820">(</span><span class="ident" id="5799821">dosheader</span><span class="op" id="5799830">[</span><span class="num" id="5799831">0x3c</span><span class="op" id="5799835">:</span><span class="op" id="5799836">]</span><span class="op" id="5799837">)</span><span class="op" id="5799838">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5799842">var</span>&nbsp;<span class="ident" id="5799846">sign</span>&nbsp;<span class="op" id="5799851">[</span><span class="num" id="5799852">4</span><span class="op" id="5799853">]</span><span class="builtintype" id="5799854">byte</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5799861">r</span><span class="op" id="5799862">.</span><span class="ident" id="5799863">ReadAt</span><span class="op" id="5799869">(</span><span class="ident" id="5799870">sign</span><span class="op" id="5799874">[</span><span class="op" id="5799875">:</span><span class="op" id="5799876">]</span><span class="op" id="5799877">,</span>&nbsp;<span class="ident" id="5799879">signoff</span><span class="op" id="5799886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5799890">if</span>&nbsp;<span class="op" id="5799893">!</span><span class="op" id="5799894">(</span><span class="ident" id="5799895">sign</span><span class="op" id="5799899">[</span><span class="num" id="5799900">0</span><span class="op" id="5799901">]</span>&nbsp;<span class="op" id="5799903">==</span>&nbsp;<span class="string" id="5799906">&#39;P&#39;</span>&nbsp;<span class="op" id="5799910">&amp;&amp;</span>&nbsp;<span class="ident" id="5799913">sign</span><span class="op" id="5799917">[</span><span class="num" id="5799918">1</span><span class="op" id="5799919">]</span>&nbsp;<span class="op" id="5799921">==</span>&nbsp;<span class="string" id="5799924">&#39;E&#39;</span>&nbsp;<span class="op" id="5799928">&amp;&amp;</span>&nbsp;<span class="ident" id="5799931">sign</span><span class="op" id="5799935">[</span><span class="num" id="5799936">2</span><span class="op" id="5799937">]</span>&nbsp;<span class="op" id="5799939">==</span>&nbsp;<span class="num" id="5799942">0</span>&nbsp;<span class="op" id="5799944">&amp;&amp;</span>&nbsp;<span class="ident" id="5799947">sign</span><span class="op" id="5799951">[</span><span class="num" id="5799952">3</span><span class="op" id="5799953">]</span>&nbsp;<span class="op" id="5799955">==</span>&nbsp;<span class="num" id="5799958">0</span><span class="op" id="5799959">)</span>&nbsp;<span class="op" id="5799961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5799966">return</span>&nbsp;<span class="builtintype" id="5799973">nil</span><span class="op" id="5799976">,</span>&nbsp;<span class="ident" id="5799978">errors</span><span class="op" id="5799984">.</span><span class="ident" id="5799985">New</span><span class="op" id="5799988">(</span><span class="string" id="5799989">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="5800014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5800018">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5800022">base</span>&nbsp;<span class="op" id="5800027">=</span>&nbsp;<span class="ident" id="5800029">signoff</span>&nbsp;<span class="op" id="5800037">+</span>&nbsp;<span class="num" id="5800039">4</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5800042">}</span>&nbsp;<span class="keyword" id="5800044">else</span>&nbsp;<span class="op" id="5800049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5800053">base</span>&nbsp;<span class="op" id="5800058">=</span>&nbsp;<span class="builtintype" id="5800060">int64</span><span class="op" id="5800065">(</span><span class="num" id="5800066">0</span><span class="op" id="5800067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5800070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5800073">sr</span><span class="op" id="5800075">.</span><span class="ident" id="5800076">Seek</span><span class="op" id="5800080">(</span><span class="ident" id="5800081">base</span><span class="op" id="5800085">,</span>&nbsp;<span class="ident" id="5800087">os</span><span class="op" id="5800089">.</span><span class="ident" id="5800090">SEEK_SET</span><span class="op" id="5800098">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5800101">if</span>&nbsp;<span class="ident" id="5800104">err</span>&nbsp;<span class="op" id="5800108">:=</span>&nbsp;<span class="ident" id="5800111">binary</span><span class="op" id="5800117">.</span><span class="ident" id="5800118">Read</span><span class="op" id="5800122">(</span><span class="ident" id="5800123">sr</span><span class="op" id="5800125">,</span>&nbsp;<span class="ident" id="5800127">binary</span><span class="op" id="5800133">.</span><span class="ident" id="5800134">LittleEndian</span><span class="op" id="5800146">,</span>&nbsp;<span class="op" id="5800148">&amp;</span><span class="ident" id="5800149">f</span><span class="op" id="5800150">.</span><span class="ident" id="5800151">FileHeader</span><span class="op" id="5800161">)</span><span class="op" id="5800162">;</span>&nbsp;<span class="ident" id="5800164">err</span>&nbsp;<span class="op" id="5800168">!=</span>&nbsp;<span class="builtintype" id="5800171">nil</span>&nbsp;<span class="op" id="5800175">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5800179">return</span>&nbsp;<span class="builtintype" id="5800186">nil</span><span class="op" id="5800189">,</span>&nbsp;<span class="ident" id="5800191">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5800196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5800199">if</span>&nbsp;<span class="ident" id="5800202">f</span><span class="op" id="5800203">.</span><span class="ident" id="5800204">FileHeader</span><span class="op" id="5800214">.</span><span class="ident" id="5800215">Machine</span>&nbsp;<span class="op" id="5800223">!=</span>&nbsp;<span class="ident" id="5800226">IMAGE_FILE_MACHINE_UNKNOWN</span>&nbsp;<span class="op" id="5800253">&amp;&amp;</span>&nbsp;<span class="ident" id="5800256">f</span><span class="op" id="5800257">.</span><span class="ident" id="5800258">FileHeader</span><span class="op" id="5800268">.</span><span class="ident" id="5800269">Machine</span>&nbsp;<span class="op" id="5800277">!=</span>&nbsp;<span class="ident" id="5800280">IMAGE_FILE_MACHINE_AMD64</span>&nbsp;<span class="op" id="5800305">&amp;&amp;</span>&nbsp;<span class="ident" id="5800308">f</span><span class="op" id="5800309">.</span><span class="ident" id="5800310">FileHeader</span><span class="op" id="5800320">.</span><span class="ident" id="5800321">Machine</span>&nbsp;<span class="op" id="5800329">!=</span>&nbsp;<span class="ident" id="5800332">IMAGE_FILE_MACHINE_I386</span>&nbsp;<span class="op" id="5800356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5800360">return</span>&nbsp;<span class="builtintype" id="5800367">nil</span><span class="op" id="5800370">,</span>&nbsp;<span class="ident" id="5800372">errors</span><span class="op" id="5800378">.</span><span class="ident" id="5800379">New</span><span class="op" id="5800382">(</span><span class="string" id="5800383">&#34;Invalid&nbsp;PE&nbsp;File&nbsp;Format.&#34;</span><span class="op" id="5800408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5800411">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5800415">var</span>&nbsp;<span class="ident" id="5800419">ss</span>&nbsp;<span class="op" id="5800422">[</span><span class="op" id="5800423">]</span><span class="builtintype" id="5800424">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5800430">if</span>&nbsp;<span class="ident" id="5800433">f</span><span class="op" id="5800434">.</span><span class="ident" id="5800435">FileHeader</span><span class="op" id="5800445">.</span><span class="ident" id="5800446">NumberOfSymbols</span>&nbsp;<span class="op" id="5800462">&gt;</span>&nbsp;<span class="num" id="5800464">0</span>&nbsp;<span class="op" id="5800466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5800470">//&nbsp;Get&nbsp;COFF&nbsp;string&nbsp;table,&nbsp;which&nbsp;is&nbsp;located&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5800552">sr</span><span class="op" id="5800554">.</span><span class="ident" id="5800555">Seek</span><span class="op" id="5800559">(</span><span class="builtintype" id="5800560">int64</span><span class="op" id="5800565">(</span><span class="ident" id="5800566">f</span><span class="op" id="5800567">.</span><span class="ident" id="5800568">FileHeader</span><span class="op" id="5800578">.</span><span class="ident" id="5800579">PointerToSymbolTable</span><span class="op" id="5800599">+</span><span class="ident" id="5800600">COFFSymbolSize</span><span class="op" id="5800614">*</span><span class="ident" id="5800615">f</span><span class="op" id="5800616">.</span><span class="ident" id="5800617">FileHeader</span><span class="op" id="5800627">.</span><span class="ident" id="5800628">NumberOfSymbols</span><span class="op" id="5800643">)</span><span class="op" id="5800644">,</span>&nbsp;<span class="ident" id="5800646">os</span><span class="op" id="5800648">.</span><span class="ident" id="5800649">SEEK_SET</span><span class="op" id="5800657">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5800661">var</span>&nbsp;<span class="ident" id="5800665">l</span>&nbsp;<span class="builtintype" id="5800667">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5800676">if</span>&nbsp;<span class="ident" id="5800679">err</span>&nbsp;<span class="op" id="5800683">:=</span>&nbsp;<span class="ident" id="5800686">binary</span><span class="op" id="5800692">.</span><span class="ident" id="5800693">Read</span><span class="op" id="5800697">(</span><span class="ident" id="5800698">sr</span><span class="op" id="5800700">,</span>&nbsp;<span class="ident" id="5800702">binary</span><span class="op" id="5800708">.</span><span class="ident" id="5800709">LittleEndian</span><span class="op" id="5800721">,</span>&nbsp;<span class="op" id="5800723">&amp;</span><span class="ident" id="5800724">l</span><span class="op" id="5800725">)</span><span class="op" id="5800726">;</span>&nbsp;<span class="ident" id="5800728">err</span>&nbsp;<span class="op" id="5800732">!=</span>&nbsp;<span class="builtintype" id="5800735">nil</span>&nbsp;<span class="op" id="5800739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5800744">return</span>&nbsp;<span class="builtintype" id="5800751">nil</span><span class="op" id="5800754">,</span>&nbsp;<span class="ident" id="5800756">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5800762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5800766">ss</span>&nbsp;<span class="op" id="5800769">=</span>&nbsp;<span class="builtinfunc" id="5800771">make</span><span class="op" id="5800775">(</span><span class="op" id="5800776">[</span><span class="op" id="5800777">]</span><span class="builtintype" id="5800778">byte</span><span class="op" id="5800782">,</span>&nbsp;<span class="ident" id="5800784">l</span><span class="op" id="5800785">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5800789">if</span>&nbsp;<span class="ident" id="5800792">_</span><span class="op" id="5800793">,</span>&nbsp;<span class="ident" id="5800795">err</span>&nbsp;<span class="op" id="5800799">:=</span>&nbsp;<span class="ident" id="5800802">r</span><span class="op" id="5800803">.</span><span class="ident" id="5800804">ReadAt</span><span class="op" id="5800810">(</span><span class="ident" id="5800811">ss</span><span class="op" id="5800813">,</span>&nbsp;<span class="builtintype" id="5800815">int64</span><span class="op" id="5800820">(</span><span class="ident" id="5800821">f</span><span class="op" id="5800822">.</span><span class="ident" id="5800823">FileHeader</span><span class="op" id="5800833">.</span><span class="ident" id="5800834">PointerToSymbolTable</span><span class="op" id="5800854">+</span><span class="ident" id="5800855">COFFSymbolSize</span><span class="op" id="5800869">*</span><span class="ident" id="5800870">f</span><span class="op" id="5800871">.</span><span class="ident" id="5800872">FileHeader</span><span class="op" id="5800882">.</span><span class="ident" id="5800883">NumberOfSymbols</span><span class="op" id="5800898">)</span><span class="op" id="5800899">)</span><span class="op" id="5800900">;</span>&nbsp;<span class="ident" id="5800902">err</span>&nbsp;<span class="op" id="5800906">!=</span>&nbsp;<span class="builtintype" id="5800909">nil</span>&nbsp;<span class="op" id="5800913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5800918">return</span>&nbsp;<span class="builtintype" id="5800925">nil</span><span class="op" id="5800928">,</span>&nbsp;<span class="ident" id="5800930">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5800936">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5800941">//&nbsp;Process&nbsp;COFF&nbsp;symbol&nbsp;table.</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5800973">sr</span><span class="op" id="5800975">.</span><span class="ident" id="5800976">Seek</span><span class="op" id="5800980">(</span><span class="builtintype" id="5800981">int64</span><span class="op" id="5800986">(</span><span class="ident" id="5800987">f</span><span class="op" id="5800988">.</span><span class="ident" id="5800989">FileHeader</span><span class="op" id="5800999">.</span><span class="ident" id="5801000">PointerToSymbolTable</span><span class="op" id="5801020">)</span><span class="op" id="5801021">,</span>&nbsp;<span class="ident" id="5801023">os</span><span class="op" id="5801025">.</span><span class="ident" id="5801026">SEEK_SET</span><span class="op" id="5801034">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5801038">aux</span>&nbsp;<span class="op" id="5801042">:=</span>&nbsp;<span class="builtintype" id="5801045">uint8</span><span class="op" id="5801050">(</span><span class="num" id="5801051">0</span><span class="op" id="5801052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5801056">for</span>&nbsp;<span class="ident" id="5801060">i</span>&nbsp;<span class="op" id="5801062">:=</span>&nbsp;<span class="num" id="5801065">0</span><span class="op" id="5801066">;</span>&nbsp;<span class="ident" id="5801068">i</span>&nbsp;<span class="op" id="5801070">&lt;</span>&nbsp;<span class="builtintype" id="5801072">int</span><span class="op" id="5801075">(</span><span class="ident" id="5801076">f</span><span class="op" id="5801077">.</span><span class="ident" id="5801078">FileHeader</span><span class="op" id="5801088">.</span><span class="ident" id="5801089">NumberOfSymbols</span><span class="op" id="5801104">)</span><span class="op" id="5801105">;</span>&nbsp;<span class="ident" id="5801107">i</span><span class="op" id="5801108">++</span>&nbsp;<span class="op" id="5801111">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5801116">cs</span>&nbsp;<span class="op" id="5801119">:=</span>&nbsp;<span class="builtinfunc" id="5801122">new</span><span class="op" id="5801125">(</span><span class="ident" id="5801126">COFFSymbol</span><span class="op" id="5801136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5801141">if</span>&nbsp;<span class="ident" id="5801144">err</span>&nbsp;<span class="op" id="5801148">:=</span>&nbsp;<span class="ident" id="5801151">binary</span><span class="op" id="5801157">.</span><span class="ident" id="5801158">Read</span><span class="op" id="5801162">(</span><span class="ident" id="5801163">sr</span><span class="op" id="5801165">,</span>&nbsp;<span class="ident" id="5801167">binary</span><span class="op" id="5801173">.</span><span class="ident" id="5801174">LittleEndian</span><span class="op" id="5801186">,</span>&nbsp;<span class="ident" id="5801188">cs</span><span class="op" id="5801190">)</span><span class="op" id="5801191">;</span>&nbsp;<span class="ident" id="5801193">err</span>&nbsp;<span class="op" id="5801197">!=</span>&nbsp;<span class="builtintype" id="5801200">nil</span>&nbsp;<span class="op" id="5801204">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5801210">return</span>&nbsp;<span class="builtintype" id="5801217">nil</span><span class="op" id="5801220">,</span>&nbsp;<span class="ident" id="5801222">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5801229">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5801234">if</span>&nbsp;<span class="ident" id="5801237">aux</span>&nbsp;<span class="op" id="5801241">&gt;</span>&nbsp;<span class="num" id="5801243">0</span>&nbsp;<span class="op" id="5801245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5801251">aux</span><span class="op" id="5801254">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5801261">continue</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5801273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5801278">var</span>&nbsp;<span class="ident" id="5801282">name</span>&nbsp;<span class="builtintype" id="5801287">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5801297">if</span>&nbsp;<span class="ident" id="5801300">cs</span><span class="op" id="5801302">.</span><span class="ident" id="5801303">Name</span><span class="op" id="5801307">[</span><span class="num" id="5801308">0</span><span class="op" id="5801309">]</span>&nbsp;<span class="op" id="5801311">==</span>&nbsp;<span class="num" id="5801314">0</span>&nbsp;<span class="op" id="5801316">&amp;&amp;</span>&nbsp;<span class="ident" id="5801319">cs</span><span class="op" id="5801321">.</span><span class="ident" id="5801322">Name</span><span class="op" id="5801326">[</span><span class="num" id="5801327">1</span><span class="op" id="5801328">]</span>&nbsp;<span class="op" id="5801330">==</span>&nbsp;<span class="num" id="5801333">0</span>&nbsp;<span class="op" id="5801335">&amp;&amp;</span>&nbsp;<span class="ident" id="5801338">cs</span><span class="op" id="5801340">.</span><span class="ident" id="5801341">Name</span><span class="op" id="5801345">[</span><span class="num" id="5801346">2</span><span class="op" id="5801347">]</span>&nbsp;<span class="op" id="5801349">==</span>&nbsp;<span class="num" id="5801352">0</span>&nbsp;<span class="op" id="5801354">&amp;&amp;</span>&nbsp;<span class="ident" id="5801357">cs</span><span class="op" id="5801359">.</span><span class="ident" id="5801360">Name</span><span class="op" id="5801364">[</span><span class="num" id="5801365">3</span><span class="op" id="5801366">]</span>&nbsp;<span class="op" id="5801368">==</span>&nbsp;<span class="num" id="5801371">0</span>&nbsp;<span class="op" id="5801373">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5801379">si</span>&nbsp;<span class="op" id="5801382">:=</span>&nbsp;<span class="builtintype" id="5801385">int</span><span class="op" id="5801388">(</span><span class="ident" id="5801389">binary</span><span class="op" id="5801395">.</span><span class="ident" id="5801396">LittleEndian</span><span class="op" id="5801408">.</span><span class="ident" id="5801409">Uint32</span><span class="op" id="5801415">(</span><span class="ident" id="5801416">cs</span><span class="op" id="5801418">.</span><span class="ident" id="5801419">Name</span><span class="op" id="5801423">[</span><span class="num" id="5801424">4</span><span class="op" id="5801425">:</span><span class="op" id="5801426">]</span><span class="op" id="5801427">)</span><span class="op" id="5801428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5801434">name</span><span class="op" id="5801438">,</span>&nbsp;<span class="ident" id="5801440">_</span>&nbsp;<span class="op" id="5801442">=</span>&nbsp;<span class="ident" id="5801444">getString</span><span class="op" id="5801453">(</span><span class="ident" id="5801454">ss</span><span class="op" id="5801456">,</span>&nbsp;<span class="ident" id="5801458">si</span><span class="op" id="5801460">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5801465">}</span>&nbsp;<span class="keyword" id="5801467">else</span>&nbsp;<span class="op" id="5801472">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5801478">name</span>&nbsp;<span class="op" id="5801483">=</span>&nbsp;<span class="ident" id="5801485">cstring</span><span class="op" id="5801492">(</span><span class="ident" id="5801493">cs</span><span class="op" id="5801495">.</span><span class="ident" id="5801496">Name</span><span class="op" id="5801500">[</span><span class="op" id="5801501">:</span><span class="op" id="5801502">]</span><span class="op" id="5801503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5801508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5801513">aux</span>&nbsp;<span class="op" id="5801517">=</span>&nbsp;<span class="ident" id="5801519">cs</span><span class="op" id="5801521">.</span><span class="ident" id="5801522">NumberOfAuxSymbols</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5801544">s</span>&nbsp;<span class="op" id="5801546">:=</span>&nbsp;<span class="op" id="5801549">&amp;</span><span class="ident" id="5801550">Symbol</span><span class="op" id="5801556">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5801562">Name</span><span class="op" id="5801566">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5801577">name</span><span class="op" id="5801581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5801587">Value</span><span class="op" id="5801592">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5801602">cs</span><span class="op" id="5801604">.</span><span class="ident" id="5801605">Value</span><span class="op" id="5801610">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5801616">SectionNumber</span><span class="op" id="5801629">:</span>&nbsp;<span class="ident" id="5801631">cs</span><span class="op" id="5801633">.</span><span class="ident" id="5801634">SectionNumber</span><span class="op" id="5801647">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5801653">Type</span><span class="op" id="5801657">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5801668">cs</span><span class="op" id="5801670">.</span><span class="ident" id="5801671">Type</span><span class="op" id="5801675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5801681">StorageClass</span><span class="op" id="5801693">:</span>&nbsp;&nbsp;<span class="ident" id="5801696">cs</span><span class="op" id="5801698">.</span><span class="ident" id="5801699">StorageClass</span><span class="op" id="5801711">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5801716">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5801721">f</span><span class="op" id="5801722">.</span><span class="ident" id="5801723">Symbols</span>&nbsp;<span class="op" id="5801731">=</span>&nbsp;<span class="builtinfunc" id="5801733">append</span><span class="op" id="5801739">(</span><span class="ident" id="5801740">f</span><span class="op" id="5801741">.</span><span class="ident" id="5801742">Symbols</span><span class="op" id="5801749">,</span>&nbsp;<span class="ident" id="5801751">s</span><span class="op" id="5801752">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5801756">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5801759">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5801763">//&nbsp;Read&nbsp;optional&nbsp;header.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5801789">sr</span><span class="op" id="5801791">.</span><span class="ident" id="5801792">Seek</span><span class="op" id="5801796">(</span><span class="ident" id="5801797">base</span><span class="op" id="5801801">,</span>&nbsp;<span class="ident" id="5801803">os</span><span class="op" id="5801805">.</span><span class="ident" id="5801806">SEEK_SET</span><span class="op" id="5801814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5801817">if</span>&nbsp;<span class="ident" id="5801820">err</span>&nbsp;<span class="op" id="5801824">:=</span>&nbsp;<span class="ident" id="5801827">binary</span><span class="op" id="5801833">.</span><span class="ident" id="5801834">Read</span><span class="op" id="5801838">(</span><span class="ident" id="5801839">sr</span><span class="op" id="5801841">,</span>&nbsp;<span class="ident" id="5801843">binary</span><span class="op" id="5801849">.</span><span class="ident" id="5801850">LittleEndian</span><span class="op" id="5801862">,</span>&nbsp;<span class="op" id="5801864">&amp;</span><span class="ident" id="5801865">f</span><span class="op" id="5801866">.</span><span class="ident" id="5801867">FileHeader</span><span class="op" id="5801877">)</span><span class="op" id="5801878">;</span>&nbsp;<span class="ident" id="5801880">err</span>&nbsp;<span class="op" id="5801884">!=</span>&nbsp;<span class="builtintype" id="5801887">nil</span>&nbsp;<span class="op" id="5801891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5801895">return</span>&nbsp;<span class="builtintype" id="5801902">nil</span><span class="op" id="5801905">,</span>&nbsp;<span class="ident" id="5801907">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5801912">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5801915">var</span>&nbsp;<span class="ident" id="5801919">oh32</span>&nbsp;<span class="ident" id="5801924">OptionalHeader32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5801942">var</span>&nbsp;<span class="ident" id="5801946">oh64</span>&nbsp;<span class="ident" id="5801951">OptionalHeader64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5801969">switch</span>&nbsp;<span class="ident" id="5801976">f</span><span class="op" id="5801977">.</span><span class="ident" id="5801978">FileHeader</span><span class="op" id="5801988">.</span><span class="ident" id="5801989">SizeOfOptionalHeader</span>&nbsp;<span class="op" id="5802010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5802013">case</span>&nbsp;<span class="ident" id="5802018">sizeofOptionalHeader32</span><span class="op" id="5802040">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5802044">if</span>&nbsp;<span class="ident" id="5802047">err</span>&nbsp;<span class="op" id="5802051">:=</span>&nbsp;<span class="ident" id="5802054">binary</span><span class="op" id="5802060">.</span><span class="ident" id="5802061">Read</span><span class="op" id="5802065">(</span><span class="ident" id="5802066">sr</span><span class="op" id="5802068">,</span>&nbsp;<span class="ident" id="5802070">binary</span><span class="op" id="5802076">.</span><span class="ident" id="5802077">LittleEndian</span><span class="op" id="5802089">,</span>&nbsp;<span class="op" id="5802091">&amp;</span><span class="ident" id="5802092">oh32</span><span class="op" id="5802096">)</span><span class="op" id="5802097">;</span>&nbsp;<span class="ident" id="5802099">err</span>&nbsp;<span class="op" id="5802103">!=</span>&nbsp;<span class="builtintype" id="5802106">nil</span>&nbsp;<span class="op" id="5802110">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5802115">return</span>&nbsp;<span class="builtintype" id="5802122">nil</span><span class="op" id="5802125">,</span>&nbsp;<span class="ident" id="5802127">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5802133">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5802137">if</span>&nbsp;<span class="ident" id="5802140">oh32</span><span class="op" id="5802144">.</span><span class="ident" id="5802145">Magic</span>&nbsp;<span class="op" id="5802151">!=</span>&nbsp;<span class="num" id="5802154">0x10b</span>&nbsp;<span class="op" id="5802160">{</span>&nbsp;<span class="comment" id="5802162">//&nbsp;PE32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5802173">return</span>&nbsp;<span class="builtintype" id="5802180">nil</span><span class="op" id="5802183">,</span>&nbsp;<span class="ident" id="5802185">fmt</span><span class="op" id="5802188">.</span><span class="ident" id="5802189">Errorf</span><span class="op" id="5802195">(</span><span class="string" id="5802196">&#34;pe32&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="5802247">,</span>&nbsp;<span class="ident" id="5802249">oh32</span><span class="op" id="5802253">.</span><span class="ident" id="5802254">Magic</span><span class="op" id="5802259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5802263">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5802267">f</span><span class="op" id="5802268">.</span><span class="ident" id="5802269">OptionalHeader</span>&nbsp;<span class="op" id="5802284">=</span>&nbsp;<span class="op" id="5802286">&amp;</span><span class="ident" id="5802287">oh32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5802293">case</span>&nbsp;<span class="ident" id="5802298">sizeofOptionalHeader64</span><span class="op" id="5802320">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5802324">if</span>&nbsp;<span class="ident" id="5802327">err</span>&nbsp;<span class="op" id="5802331">:=</span>&nbsp;<span class="ident" id="5802334">binary</span><span class="op" id="5802340">.</span><span class="ident" id="5802341">Read</span><span class="op" id="5802345">(</span><span class="ident" id="5802346">sr</span><span class="op" id="5802348">,</span>&nbsp;<span class="ident" id="5802350">binary</span><span class="op" id="5802356">.</span><span class="ident" id="5802357">LittleEndian</span><span class="op" id="5802369">,</span>&nbsp;<span class="op" id="5802371">&amp;</span><span class="ident" id="5802372">oh64</span><span class="op" id="5802376">)</span><span class="op" id="5802377">;</span>&nbsp;<span class="ident" id="5802379">err</span>&nbsp;<span class="op" id="5802383">!=</span>&nbsp;<span class="builtintype" id="5802386">nil</span>&nbsp;<span class="op" id="5802390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5802395">return</span>&nbsp;<span class="builtintype" id="5802402">nil</span><span class="op" id="5802405">,</span>&nbsp;<span class="ident" id="5802407">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5802413">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5802417">if</span>&nbsp;<span class="ident" id="5802420">oh64</span><span class="op" id="5802424">.</span><span class="ident" id="5802425">Magic</span>&nbsp;<span class="op" id="5802431">!=</span>&nbsp;<span class="num" id="5802434">0x20b</span>&nbsp;<span class="op" id="5802440">{</span>&nbsp;<span class="comment" id="5802442">//&nbsp;PE32+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5802454">return</span>&nbsp;<span class="builtintype" id="5802461">nil</span><span class="op" id="5802464">,</span>&nbsp;<span class="ident" id="5802466">fmt</span><span class="op" id="5802469">.</span><span class="ident" id="5802470">Errorf</span><span class="op" id="5802476">(</span><span class="string" id="5802477">&#34;pe32+&nbsp;optional&nbsp;header&nbsp;has&nbsp;unexpected&nbsp;Magic&nbsp;of&nbsp;0x%x&#34;</span><span class="op" id="5802529">,</span>&nbsp;<span class="ident" id="5802531">oh64</span><span class="op" id="5802535">.</span><span class="ident" id="5802536">Magic</span><span class="op" id="5802541">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5802545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5802549">f</span><span class="op" id="5802550">.</span><span class="ident" id="5802551">OptionalHeader</span>&nbsp;<span class="op" id="5802566">=</span>&nbsp;<span class="op" id="5802568">&amp;</span><span class="ident" id="5802569">oh64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5802575">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5802579">//&nbsp;Process&nbsp;sections.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5802601">f</span><span class="op" id="5802602">.</span><span class="ident" id="5802603">Sections</span>&nbsp;<span class="op" id="5802612">=</span>&nbsp;<span class="builtinfunc" id="5802614">make</span><span class="op" id="5802618">(</span><span class="op" id="5802619">[</span><span class="op" id="5802620">]</span><span class="op" id="5802621">*</span><span class="ident" id="5802622">Section</span><span class="op" id="5802629">,</span>&nbsp;<span class="ident" id="5802631">f</span><span class="op" id="5802632">.</span><span class="ident" id="5802633">FileHeader</span><span class="op" id="5802643">.</span><span class="ident" id="5802644">NumberOfSections</span><span class="op" id="5802660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5802663">for</span>&nbsp;<span class="ident" id="5802667">i</span>&nbsp;<span class="op" id="5802669">:=</span>&nbsp;<span class="num" id="5802672">0</span><span class="op" id="5802673">;</span>&nbsp;<span class="ident" id="5802675">i</span>&nbsp;<span class="op" id="5802677">&lt;</span>&nbsp;<span class="builtintype" id="5802679">int</span><span class="op" id="5802682">(</span><span class="ident" id="5802683">f</span><span class="op" id="5802684">.</span><span class="ident" id="5802685">FileHeader</span><span class="op" id="5802695">.</span><span class="ident" id="5802696">NumberOfSections</span><span class="op" id="5802712">)</span><span class="op" id="5802713">;</span>&nbsp;<span class="ident" id="5802715">i</span><span class="op" id="5802716">++</span>&nbsp;<span class="op" id="5802719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5802723">sh</span>&nbsp;<span class="op" id="5802726">:=</span>&nbsp;<span class="builtinfunc" id="5802729">new</span><span class="op" id="5802732">(</span><span class="ident" id="5802733">SectionHeader32</span><span class="op" id="5802748">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5802752">if</span>&nbsp;<span class="ident" id="5802755">err</span>&nbsp;<span class="op" id="5802759">:=</span>&nbsp;<span class="ident" id="5802762">binary</span><span class="op" id="5802768">.</span><span class="ident" id="5802769">Read</span><span class="op" id="5802773">(</span><span class="ident" id="5802774">sr</span><span class="op" id="5802776">,</span>&nbsp;<span class="ident" id="5802778">binary</span><span class="op" id="5802784">.</span><span class="ident" id="5802785">LittleEndian</span><span class="op" id="5802797">,</span>&nbsp;<span class="ident" id="5802799">sh</span><span class="op" id="5802801">)</span><span class="op" id="5802802">;</span>&nbsp;<span class="ident" id="5802804">err</span>&nbsp;<span class="op" id="5802808">!=</span>&nbsp;<span class="builtintype" id="5802811">nil</span>&nbsp;<span class="op" id="5802815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5802820">return</span>&nbsp;<span class="builtintype" id="5802827">nil</span><span class="op" id="5802830">,</span>&nbsp;<span class="ident" id="5802832">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5802838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5802842">var</span>&nbsp;<span class="ident" id="5802846">name</span>&nbsp;<span class="builtintype" id="5802851">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5802860">if</span>&nbsp;<span class="ident" id="5802863">sh</span><span class="op" id="5802865">.</span><span class="ident" id="5802866">Name</span><span class="op" id="5802870">[</span><span class="num" id="5802871">0</span><span class="op" id="5802872">]</span>&nbsp;<span class="op" id="5802874">==</span>&nbsp;<span class="string" id="5802877">&#39;\x2F&#39;</span>&nbsp;<span class="op" id="5802884">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5802889">si</span><span class="op" id="5802891">,</span>&nbsp;<span class="ident" id="5802893">_</span>&nbsp;<span class="op" id="5802895">:=</span>&nbsp;<span class="ident" id="5802898">strconv</span><span class="op" id="5802905">.</span><span class="ident" id="5802906">Atoi</span><span class="op" id="5802910">(</span><span class="ident" id="5802911">cstring</span><span class="op" id="5802918">(</span><span class="ident" id="5802919">sh</span><span class="op" id="5802921">.</span><span class="ident" id="5802922">Name</span><span class="op" id="5802926">[</span><span class="num" id="5802927">1</span><span class="op" id="5802928">:</span><span class="op" id="5802929">]</span><span class="op" id="5802930">)</span><span class="op" id="5802931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5802936">name</span><span class="op" id="5802940">,</span>&nbsp;<span class="ident" id="5802942">_</span>&nbsp;<span class="op" id="5802944">=</span>&nbsp;<span class="ident" id="5802946">getString</span><span class="op" id="5802955">(</span><span class="ident" id="5802956">ss</span><span class="op" id="5802958">,</span>&nbsp;<span class="ident" id="5802960">si</span><span class="op" id="5802962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5802966">}</span>&nbsp;<span class="keyword" id="5802968">else</span>&nbsp;<span class="op" id="5802973">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5802978">name</span>&nbsp;<span class="op" id="5802983">=</span>&nbsp;<span class="ident" id="5802985">cstring</span><span class="op" id="5802992">(</span><span class="ident" id="5802993">sh</span><span class="op" id="5802995">.</span><span class="ident" id="5802996">Name</span><span class="op" id="5803000">[</span><span class="num" id="5803001">0</span><span class="op" id="5803002">:</span><span class="op" id="5803003">]</span><span class="op" id="5803004">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5803008">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803012">s</span>&nbsp;<span class="op" id="5803014">:=</span>&nbsp;<span class="builtinfunc" id="5803017">new</span><span class="op" id="5803020">(</span><span class="ident" id="5803021">Section</span><span class="op" id="5803028">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803032">s</span><span class="op" id="5803033">.</span><span class="ident" id="5803034">SectionHeader</span>&nbsp;<span class="op" id="5803048">=</span>&nbsp;<span class="ident" id="5803050">SectionHeader</span><span class="op" id="5803063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803068">Name</span><span class="op" id="5803072">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803090">name</span><span class="op" id="5803094">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803099">VirtualSize</span><span class="op" id="5803110">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803121">sh</span><span class="op" id="5803123">.</span><span class="ident" id="5803124">VirtualSize</span><span class="op" id="5803135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803140">VirtualAddress</span><span class="op" id="5803154">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803162">sh</span><span class="op" id="5803164">.</span><span class="ident" id="5803165">VirtualAddress</span><span class="op" id="5803179">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803184">Size</span><span class="op" id="5803188">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803206">sh</span><span class="op" id="5803208">.</span><span class="ident" id="5803209">SizeOfRawData</span><span class="op" id="5803222">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803227">Offset</span><span class="op" id="5803233">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803249">sh</span><span class="op" id="5803251">.</span><span class="ident" id="5803252">PointerToRawData</span><span class="op" id="5803268">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803273">PointerToRelocations</span><span class="op" id="5803293">:</span>&nbsp;<span class="ident" id="5803295">sh</span><span class="op" id="5803297">.</span><span class="ident" id="5803298">PointerToRelocations</span><span class="op" id="5803318">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803323">PointerToLineNumbers</span><span class="op" id="5803343">:</span>&nbsp;<span class="ident" id="5803345">sh</span><span class="op" id="5803347">.</span><span class="ident" id="5803348">PointerToLineNumbers</span><span class="op" id="5803368">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803373">NumberOfRelocations</span><span class="op" id="5803392">:</span>&nbsp;&nbsp;<span class="ident" id="5803395">sh</span><span class="op" id="5803397">.</span><span class="ident" id="5803398">NumberOfRelocations</span><span class="op" id="5803417">,</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803422">NumberOfLineNumbers</span><span class="op" id="5803441">:</span>&nbsp;&nbsp;<span class="ident" id="5803444">sh</span><span class="op" id="5803446">.</span><span class="ident" id="5803447">NumberOfLineNumbers</span><span class="op" id="5803466">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803471">Characteristics</span><span class="op" id="5803486">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803493">sh</span><span class="op" id="5803495">.</span><span class="ident" id="5803496">Characteristics</span><span class="op" id="5803511">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5803515">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803519">s</span><span class="op" id="5803520">.</span><span class="ident" id="5803521">sr</span>&nbsp;<span class="op" id="5803524">=</span>&nbsp;<span class="ident" id="5803526">io</span><span class="op" id="5803528">.</span><span class="ident" id="5803529">NewSectionReader</span><span class="op" id="5803545">(</span><span class="ident" id="5803546">r</span><span class="op" id="5803547">,</span>&nbsp;<span class="builtintype" id="5803549">int64</span><span class="op" id="5803554">(</span><span class="ident" id="5803555">s</span><span class="op" id="5803556">.</span><span class="ident" id="5803557">SectionHeader</span><span class="op" id="5803570">.</span><span class="ident" id="5803571">Offset</span><span class="op" id="5803577">)</span><span class="op" id="5803578">,</span>&nbsp;<span class="builtintype" id="5803580">int64</span><span class="op" id="5803585">(</span><span class="ident" id="5803586">s</span><span class="op" id="5803587">.</span><span class="ident" id="5803588">SectionHeader</span><span class="op" id="5803601">.</span><span class="ident" id="5803602">Size</span><span class="op" id="5803606">)</span><span class="op" id="5803607">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803611">s</span><span class="op" id="5803612">.</span><span class="ident" id="5803613">ReaderAt</span>&nbsp;<span class="op" id="5803622">=</span>&nbsp;<span class="ident" id="5803624">s</span><span class="op" id="5803625">.</span><span class="ident" id="5803626">sr</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5803631">f</span><span class="op" id="5803632">.</span><span class="ident" id="5803633">Sections</span><span class="op" id="5803641">[</span><span class="ident" id="5803642">i</span><span class="op" id="5803643">]</span>&nbsp;<span class="op" id="5803645">=</span>&nbsp;<span class="ident" id="5803647">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5803650">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5803653">return</span>&nbsp;<span class="ident" id="5803660">f</span><span class="op" id="5803661">,</span>&nbsp;<span class="builtintype" id="5803663">nil</span><br>
<span class="lineno"></span><span class="op" id="5803667">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="keyword" id="5803670">func</span>&nbsp;<span class="ident" id="5803675">cstring</span><span class="op" id="5803682">(</span><span class="ident" id="5803683">b</span>&nbsp;<span class="op" id="5803685">[</span><span class="op" id="5803686">]</span><span class="builtintype" id="5803687">byte</span><span class="op" id="5803691">)</span>&nbsp;<span class="builtintype" id="5803693">string</span>&nbsp;<span class="op" id="5803700">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5803703">var</span>&nbsp;<span class="ident" id="5803707">i</span>&nbsp;<span class="builtintype" id="5803709">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5803714">for</span>&nbsp;<span class="ident" id="5803718">i</span>&nbsp;<span class="op" id="5803720">=</span>&nbsp;<span class="num" id="5803722">0</span><span class="op" id="5803723">;</span>&nbsp;<span class="ident" id="5803725">i</span>&nbsp;<span class="op" id="5803727">&lt;</span>&nbsp;<span class="builtinfunc" id="5803729">len</span><span class="op" id="5803732">(</span><span class="ident" id="5803733">b</span><span class="op" id="5803734">)</span>&nbsp;<span class="op" id="5803736">&amp;&amp;</span>&nbsp;<span class="ident" id="5803739">b</span><span class="op" id="5803740">[</span><span class="ident" id="5803741">i</span><span class="op" id="5803742">]</span>&nbsp;<span class="op" id="5803744">!=</span>&nbsp;<span class="num" id="5803747">0</span><span class="op" id="5803748">;</span>&nbsp;<span class="ident" id="5803750">i</span><span class="op" id="5803751">++</span>&nbsp;<span class="op" id="5803754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5803757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5803760">return</span>&nbsp;<span class="builtintype" id="5803767">string</span><span class="op" id="5803773">(</span><span class="ident" id="5803774">b</span><span class="op" id="5803775">[</span><span class="num" id="5803776">0</span><span class="op" id="5803777">:</span><span class="ident" id="5803778">i</span><span class="op" id="5803779">]</span><span class="op" id="5803780">)</span><br>
<span class="lineno">270</span><span class="op" id="5803782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5803785">//&nbsp;getString&nbsp;extracts&nbsp;a&nbsp;string&nbsp;from&nbsp;symbol&nbsp;string&nbsp;table.</span><br>
<span class="lineno"></span><span class="keyword" id="5803842">func</span>&nbsp;<span class="ident" id="5803847">getString</span><span class="op" id="5803856">(</span><span class="ident" id="5803857">section</span>&nbsp;<span class="op" id="5803865">[</span><span class="op" id="5803866">]</span><span class="builtintype" id="5803867">byte</span><span class="op" id="5803871">,</span>&nbsp;<span class="ident" id="5803873">start</span>&nbsp;<span class="builtintype" id="5803879">int</span><span class="op" id="5803882">)</span>&nbsp;<span class="op" id="5803884">(</span><span class="builtintype" id="5803885">string</span><span class="op" id="5803891">,</span>&nbsp;<span class="builtintype" id="5803893">bool</span><span class="op" id="5803897">)</span>&nbsp;<span class="op" id="5803899">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5803902">if</span>&nbsp;<span class="ident" id="5803905">start</span>&nbsp;<span class="op" id="5803911">&lt;</span>&nbsp;<span class="num" id="5803913">0</span>&nbsp;<span class="op" id="5803915">||</span>&nbsp;<span class="ident" id="5803918">start</span>&nbsp;<span class="op" id="5803924">&gt;=</span>&nbsp;<span class="builtinfunc" id="5803927">len</span><span class="op" id="5803930">(</span><span class="ident" id="5803931">section</span><span class="op" id="5803938">)</span>&nbsp;<span class="op" id="5803940">{</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5803944">return</span>&nbsp;<span class="string" id="5803951">&#34;&#34;</span><span class="op" id="5803953">,</span>&nbsp;<span class="builtintype" id="5803955">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5803962">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5803966">for</span>&nbsp;<span class="ident" id="5803970">end</span>&nbsp;<span class="op" id="5803974">:=</span>&nbsp;<span class="ident" id="5803977">start</span><span class="op" id="5803982">;</span>&nbsp;<span class="ident" id="5803984">end</span>&nbsp;<span class="op" id="5803988">&lt;</span>&nbsp;<span class="builtinfunc" id="5803990">len</span><span class="op" id="5803993">(</span><span class="ident" id="5803994">section</span><span class="op" id="5804001">)</span><span class="op" id="5804002">;</span>&nbsp;<span class="ident" id="5804004">end</span><span class="op" id="5804007">++</span>&nbsp;<span class="op" id="5804010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5804014">if</span>&nbsp;<span class="ident" id="5804017">section</span><span class="op" id="5804024">[</span><span class="ident" id="5804025">end</span><span class="op" id="5804028">]</span>&nbsp;<span class="op" id="5804030">==</span>&nbsp;<span class="num" id="5804033">0</span>&nbsp;<span class="op" id="5804035">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5804040">return</span>&nbsp;<span class="builtintype" id="5804047">string</span><span class="op" id="5804053">(</span><span class="ident" id="5804054">section</span><span class="op" id="5804061">[</span><span class="ident" id="5804062">start</span><span class="op" id="5804067">:</span><span class="ident" id="5804068">end</span><span class="op" id="5804071">]</span><span class="op" id="5804072">)</span><span class="op" id="5804073">,</span>&nbsp;<span class="builtintype" id="5804075">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5804082">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5804085">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5804088">return</span>&nbsp;<span class="string" id="5804095">&#34;&#34;</span><span class="op" id="5804097">,</span>&nbsp;<span class="builtintype" id="5804099">false</span><br>
<span class="lineno"></span><span class="op" id="5804105">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="5804108">//&nbsp;Section&nbsp;returns&nbsp;the&nbsp;first&nbsp;section&nbsp;with&nbsp;the&nbsp;given&nbsp;name,&nbsp;or&nbsp;nil&nbsp;if&nbsp;no&nbsp;such</span><br>
<span class="lineno"></span><span class="comment" id="5804184">//&nbsp;section&nbsp;exists.</span><br>
<span class="lineno"></span><span class="keyword" id="5804203">func</span>&nbsp;<span class="op" id="5804208">(</span><span class="ident" id="5804209">f</span>&nbsp;<span class="op" id="5804211">*</span><span class="ident" id="5804212">File</span><span class="op" id="5804216">)</span>&nbsp;<span class="ident" id="5804218">Section</span><span class="op" id="5804225">(</span><span class="ident" id="5804226">name</span>&nbsp;<span class="builtintype" id="5804231">string</span><span class="op" id="5804237">)</span>&nbsp;<span class="op" id="5804239">*</span><span class="ident" id="5804240">Section</span>&nbsp;<span class="op" id="5804248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5804251">for</span>&nbsp;<span class="ident" id="5804255">_</span><span class="op" id="5804256">,</span>&nbsp;<span class="ident" id="5804258">s</span>&nbsp;<span class="op" id="5804260">:=</span>&nbsp;<span class="keyword" id="5804263">range</span>&nbsp;<span class="ident" id="5804269">f</span><span class="op" id="5804270">.</span><span class="ident" id="5804271">Sections</span>&nbsp;<span class="op" id="5804280">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5804284">if</span>&nbsp;<span class="ident" id="5804287">s</span><span class="op" id="5804288">.</span><span class="ident" id="5804289">Name</span>&nbsp;<span class="op" id="5804294">==</span>&nbsp;<span class="ident" id="5804297">name</span>&nbsp;<span class="op" id="5804302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5804307">return</span>&nbsp;<span class="ident" id="5804314">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5804318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5804321">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5804324">return</span>&nbsp;<span class="builtintype" id="5804331">nil</span><br>
<span class="lineno">295</span><span class="op" id="5804335">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5804338">func</span>&nbsp;<span class="op" id="5804343">(</span><span class="ident" id="5804344">f</span>&nbsp;<span class="op" id="5804346">*</span><span class="ident" id="5804347">File</span><span class="op" id="5804351">)</span>&nbsp;<span class="ident" id="5804353">DWARF</span><span class="op" id="5804358">(</span><span class="op" id="5804359">)</span>&nbsp;<span class="op" id="5804361">(</span><span class="op" id="5804362">*</span><span class="ident" id="5804363">dwarf</span><span class="op" id="5804368">.</span><span class="ident" id="5804369">Data</span><span class="op" id="5804373">,</span>&nbsp;<span class="builtintype" id="5804375">error</span><span class="op" id="5804380">)</span>&nbsp;<span class="op" id="5804382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5804385">//&nbsp;There&nbsp;are&nbsp;many&nbsp;other&nbsp;DWARF&nbsp;sections,&nbsp;but&nbsp;these</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5804436">//&nbsp;are&nbsp;the&nbsp;required&nbsp;ones,&nbsp;and&nbsp;the&nbsp;debug/dwarf&nbsp;package</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5804491">//&nbsp;does&nbsp;not&nbsp;use&nbsp;the&nbsp;others,&nbsp;so&nbsp;don&#39;t&nbsp;bother&nbsp;loading&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5804550">var</span>&nbsp;<span class="ident" id="5804554">names</span>&nbsp;<span class="op" id="5804560">=</span>&nbsp;<span class="op" id="5804562">[</span><span class="op" id="5804563">...</span><span class="op" id="5804566">]</span><span class="builtintype" id="5804567">string</span><span class="op" id="5804573">{</span><span class="string" id="5804574">&#34;abbrev&#34;</span><span class="op" id="5804582">,</span>&nbsp;<span class="string" id="5804584">&#34;info&#34;</span><span class="op" id="5804590">,</span>&nbsp;<span class="string" id="5804592">&#34;str&#34;</span><span class="op" id="5804597">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5804600">var</span>&nbsp;<span class="ident" id="5804604">dat</span>&nbsp;<span class="op" id="5804608">[</span><span class="builtinfunc" id="5804609">len</span><span class="op" id="5804612">(</span><span class="ident" id="5804613">names</span><span class="op" id="5804618">)</span><span class="op" id="5804619">]</span><span class="op" id="5804620">[</span><span class="op" id="5804621">]</span><span class="builtintype" id="5804622">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5804628">for</span>&nbsp;<span class="ident" id="5804632">i</span><span class="op" id="5804633">,</span>&nbsp;<span class="ident" id="5804635">name</span>&nbsp;<span class="op" id="5804640">:=</span>&nbsp;<span class="keyword" id="5804643">range</span>&nbsp;<span class="ident" id="5804649">names</span>&nbsp;<span class="op" id="5804655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5804659">name</span>&nbsp;<span class="op" id="5804664">=</span>&nbsp;<span class="string" id="5804666">&#34;.debug_&#34;</span>&nbsp;<span class="op" id="5804676">+</span>&nbsp;<span class="ident" id="5804678">name</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5804685">s</span>&nbsp;<span class="op" id="5804687">:=</span>&nbsp;<span class="ident" id="5804690">f</span><span class="op" id="5804691">.</span><span class="ident" id="5804692">Section</span><span class="op" id="5804699">(</span><span class="ident" id="5804700">name</span><span class="op" id="5804704">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5804708">if</span>&nbsp;<span class="ident" id="5804711">s</span>&nbsp;<span class="op" id="5804713">==</span>&nbsp;<span class="builtintype" id="5804716">nil</span>&nbsp;<span class="op" id="5804720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5804725">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5804736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5804740">b</span><span class="op" id="5804741">,</span>&nbsp;<span class="ident" id="5804743">err</span>&nbsp;<span class="op" id="5804747">:=</span>&nbsp;<span class="ident" id="5804750">s</span><span class="op" id="5804751">.</span><span class="ident" id="5804752">Data</span><span class="op" id="5804756">(</span><span class="op" id="5804757">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5804761">if</span>&nbsp;<span class="ident" id="5804764">err</span>&nbsp;<span class="op" id="5804768">!=</span>&nbsp;<span class="builtintype" id="5804771">nil</span>&nbsp;<span class="op" id="5804775">&amp;&amp;</span>&nbsp;<span class="builtintype" id="5804778">uint32</span><span class="op" id="5804784">(</span><span class="builtinfunc" id="5804785">len</span><span class="op" id="5804788">(</span><span class="ident" id="5804789">b</span><span class="op" id="5804790">)</span><span class="op" id="5804791">)</span>&nbsp;<span class="op" id="5804793">&lt;</span>&nbsp;<span class="ident" id="5804795">s</span><span class="op" id="5804796">.</span><span class="ident" id="5804797">Size</span>&nbsp;<span class="op" id="5804802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5804807">return</span>&nbsp;<span class="builtintype" id="5804814">nil</span><span class="op" id="5804817">,</span>&nbsp;<span class="ident" id="5804819">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5804825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5804829">dat</span><span class="op" id="5804832">[</span><span class="ident" id="5804833">i</span><span class="op" id="5804834">]</span>&nbsp;<span class="op" id="5804836">=</span>&nbsp;<span class="ident" id="5804838">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5804841">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5804845">abbrev</span><span class="op" id="5804851">,</span>&nbsp;<span class="ident" id="5804853">info</span><span class="op" id="5804857">,</span>&nbsp;<span class="ident" id="5804859">str</span>&nbsp;<span class="op" id="5804863">:=</span>&nbsp;<span class="ident" id="5804866">dat</span><span class="op" id="5804869">[</span><span class="num" id="5804870">0</span><span class="op" id="5804871">]</span><span class="op" id="5804872">,</span>&nbsp;<span class="ident" id="5804874">dat</span><span class="op" id="5804877">[</span><span class="num" id="5804878">1</span><span class="op" id="5804879">]</span><span class="op" id="5804880">,</span>&nbsp;<span class="ident" id="5804882">dat</span><span class="op" id="5804885">[</span><span class="num" id="5804886">2</span><span class="op" id="5804887">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5804890">return</span>&nbsp;<span class="ident" id="5804897">dwarf</span><span class="op" id="5804902">.</span><span class="ident" id="5804903">New</span><span class="op" id="5804906">(</span><span class="ident" id="5804907">abbrev</span><span class="op" id="5804913">,</span>&nbsp;<span class="builtintype" id="5804915">nil</span><span class="op" id="5804918">,</span>&nbsp;<span class="builtintype" id="5804920">nil</span><span class="op" id="5804923">,</span>&nbsp;<span class="ident" id="5804925">info</span><span class="op" id="5804929">,</span>&nbsp;<span class="builtintype" id="5804931">nil</span><span class="op" id="5804934">,</span>&nbsp;<span class="builtintype" id="5804936">nil</span><span class="op" id="5804939">,</span>&nbsp;<span class="builtintype" id="5804941">nil</span><span class="op" id="5804944">,</span>&nbsp;<span class="ident" id="5804946">str</span><span class="op" id="5804949">)</span><br>
<span class="lineno"></span><span class="op" id="5804951">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="comment" id="5804954">//&nbsp;ImportedSymbols&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;symbols</span><br>
<span class="lineno"></span><span class="comment" id="5805006">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5805061">//&nbsp;satisfied&nbsp;by&nbsp;other&nbsp;libraries&nbsp;at&nbsp;dynamic&nbsp;load&nbsp;time.</span><br>
<span class="lineno"></span><span class="comment" id="5805115">//&nbsp;It&nbsp;does&nbsp;not&nbsp;return&nbsp;weak&nbsp;symbols.</span><br>
<span class="lineno"></span><span class="keyword" id="5805151">func</span>&nbsp;<span class="op" id="5805156">(</span><span class="ident" id="5805157">f</span>&nbsp;<span class="op" id="5805159">*</span><span class="ident" id="5805160">File</span><span class="op" id="5805164">)</span>&nbsp;<span class="ident" id="5805166">ImportedSymbols</span><span class="op" id="5805181">(</span><span class="op" id="5805182">)</span>&nbsp;<span class="op" id="5805184">(</span><span class="op" id="5805185">[</span><span class="op" id="5805186">]</span><span class="builtintype" id="5805187">string</span><span class="op" id="5805193">,</span>&nbsp;<span class="builtintype" id="5805195">error</span><span class="op" id="5805200">)</span>&nbsp;<span class="op" id="5805202">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5805205">pe64</span>&nbsp;<span class="op" id="5805210">:=</span>&nbsp;<span class="ident" id="5805213">f</span><span class="op" id="5805214">.</span><span class="ident" id="5805215">Machine</span>&nbsp;<span class="op" id="5805223">==</span>&nbsp;<span class="ident" id="5805226">IMAGE_FILE_MACHINE_AMD64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5805252">ds</span>&nbsp;<span class="op" id="5805255">:=</span>&nbsp;<span class="ident" id="5805258">f</span><span class="op" id="5805259">.</span><span class="ident" id="5805260">Section</span><span class="op" id="5805267">(</span><span class="string" id="5805268">&#34;.idata&#34;</span><span class="op" id="5805276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5805279">if</span>&nbsp;<span class="ident" id="5805282">ds</span>&nbsp;<span class="op" id="5805285">==</span>&nbsp;<span class="builtintype" id="5805288">nil</span>&nbsp;<span class="op" id="5805292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5805296">//&nbsp;not&nbsp;dynamic,&nbsp;so&nbsp;no&nbsp;libraries</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5805330">return</span>&nbsp;<span class="builtintype" id="5805337">nil</span><span class="op" id="5805340">,</span>&nbsp;<span class="builtintype" id="5805342">nil</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5805347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5805350">d</span><span class="op" id="5805351">,</span>&nbsp;<span class="ident" id="5805353">err</span>&nbsp;<span class="op" id="5805357">:=</span>&nbsp;<span class="ident" id="5805360">ds</span><span class="op" id="5805362">.</span><span class="ident" id="5805363">Data</span><span class="op" id="5805367">(</span><span class="op" id="5805368">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5805371">if</span>&nbsp;<span class="ident" id="5805374">err</span>&nbsp;<span class="op" id="5805378">!=</span>&nbsp;<span class="builtintype" id="5805381">nil</span>&nbsp;<span class="op" id="5805385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5805389">return</span>&nbsp;<span class="builtintype" id="5805396">nil</span><span class="op" id="5805399">,</span>&nbsp;<span class="ident" id="5805401">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5805406">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5805409">var</span>&nbsp;<span class="ident" id="5805413">ida</span>&nbsp;<span class="op" id="5805417">[</span><span class="op" id="5805418">]</span><span class="ident" id="5805419">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5805436">for</span>&nbsp;<span class="builtinfunc" id="5805440">len</span><span class="op" id="5805443">(</span><span class="ident" id="5805444">d</span><span class="op" id="5805445">)</span>&nbsp;<span class="op" id="5805447">&gt;</span>&nbsp;<span class="num" id="5805449">0</span>&nbsp;<span class="op" id="5805451">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5805455">var</span>&nbsp;<span class="ident" id="5805459">dt</span>&nbsp;<span class="ident" id="5805462">ImportDirectory</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5805480">dt</span><span class="op" id="5805482">.</span><span class="ident" id="5805483">OriginalFirstThunk</span>&nbsp;<span class="op" id="5805502">=</span>&nbsp;<span class="ident" id="5805504">binary</span><span class="op" id="5805510">.</span><span class="ident" id="5805511">LittleEndian</span><span class="op" id="5805523">.</span><span class="ident" id="5805524">Uint32</span><span class="op" id="5805530">(</span><span class="ident" id="5805531">d</span><span class="op" id="5805532">[</span><span class="num" id="5805533">0</span><span class="op" id="5805534">:</span><span class="num" id="5805535">4</span><span class="op" id="5805536">]</span><span class="op" id="5805537">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5805541">dt</span><span class="op" id="5805543">.</span><span class="ident" id="5805544">Name</span>&nbsp;<span class="op" id="5805549">=</span>&nbsp;<span class="ident" id="5805551">binary</span><span class="op" id="5805557">.</span><span class="ident" id="5805558">LittleEndian</span><span class="op" id="5805570">.</span><span class="ident" id="5805571">Uint32</span><span class="op" id="5805577">(</span><span class="ident" id="5805578">d</span><span class="op" id="5805579">[</span><span class="num" id="5805580">12</span><span class="op" id="5805582">:</span><span class="num" id="5805583">16</span><span class="op" id="5805585">]</span><span class="op" id="5805586">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5805590">dt</span><span class="op" id="5805592">.</span><span class="ident" id="5805593">FirstThunk</span>&nbsp;<span class="op" id="5805604">=</span>&nbsp;<span class="ident" id="5805606">binary</span><span class="op" id="5805612">.</span><span class="ident" id="5805613">LittleEndian</span><span class="op" id="5805625">.</span><span class="ident" id="5805626">Uint32</span><span class="op" id="5805632">(</span><span class="ident" id="5805633">d</span><span class="op" id="5805634">[</span><span class="num" id="5805635">16</span><span class="op" id="5805637">:</span><span class="num" id="5805638">20</span><span class="op" id="5805640">]</span><span class="op" id="5805641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5805645">d</span>&nbsp;<span class="op" id="5805647">=</span>&nbsp;<span class="ident" id="5805649">d</span><span class="op" id="5805650">[</span><span class="num" id="5805651">20</span><span class="op" id="5805653">:</span><span class="op" id="5805654">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5805658">if</span>&nbsp;<span class="ident" id="5805661">dt</span><span class="op" id="5805663">.</span><span class="ident" id="5805664">OriginalFirstThunk</span>&nbsp;<span class="op" id="5805683">==</span>&nbsp;<span class="num" id="5805686">0</span>&nbsp;<span class="op" id="5805688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5805693">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5805701">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5805705">ida</span>&nbsp;<span class="op" id="5805709">=</span>&nbsp;<span class="builtinfunc" id="5805711">append</span><span class="op" id="5805717">(</span><span class="ident" id="5805718">ida</span><span class="op" id="5805721">,</span>&nbsp;<span class="ident" id="5805723">dt</span><span class="op" id="5805725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5805728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5805731">names</span><span class="op" id="5805736">,</span>&nbsp;<span class="ident" id="5805738">_</span>&nbsp;<span class="op" id="5805740">:=</span>&nbsp;<span class="ident" id="5805743">ds</span><span class="op" id="5805745">.</span><span class="ident" id="5805746">Data</span><span class="op" id="5805750">(</span><span class="op" id="5805751">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5805754">var</span>&nbsp;<span class="ident" id="5805758">all</span>&nbsp;<span class="op" id="5805762">[</span><span class="op" id="5805763">]</span><span class="builtintype" id="5805764">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5805772">for</span>&nbsp;<span class="ident" id="5805776">_</span><span class="op" id="5805777">,</span>&nbsp;<span class="ident" id="5805779">dt</span>&nbsp;<span class="op" id="5805782">:=</span>&nbsp;<span class="keyword" id="5805785">range</span>&nbsp;<span class="ident" id="5805791">ida</span>&nbsp;<span class="op" id="5805795">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5805799">dt</span><span class="op" id="5805801">.</span><span class="ident" id="5805802">dll</span><span class="op" id="5805805">,</span>&nbsp;<span class="ident" id="5805807">_</span>&nbsp;<span class="op" id="5805809">=</span>&nbsp;<span class="ident" id="5805811">getString</span><span class="op" id="5805820">(</span><span class="ident" id="5805821">names</span><span class="op" id="5805826">,</span>&nbsp;<span class="builtintype" id="5805828">int</span><span class="op" id="5805831">(</span><span class="ident" id="5805832">dt</span><span class="op" id="5805834">.</span><span class="ident" id="5805835">Name</span><span class="op" id="5805839">-</span><span class="ident" id="5805840">ds</span><span class="op" id="5805842">.</span><span class="ident" id="5805843">VirtualAddress</span><span class="op" id="5805857">)</span><span class="op" id="5805858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5805862">d</span><span class="op" id="5805863">,</span>&nbsp;<span class="ident" id="5805865">_</span>&nbsp;<span class="op" id="5805867">=</span>&nbsp;<span class="ident" id="5805869">ds</span><span class="op" id="5805871">.</span><span class="ident" id="5805872">Data</span><span class="op" id="5805876">(</span><span class="op" id="5805877">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5805881">//&nbsp;seek&nbsp;to&nbsp;OriginalFirstThunk</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5805913">d</span>&nbsp;<span class="op" id="5805915">=</span>&nbsp;<span class="ident" id="5805917">d</span><span class="op" id="5805918">[</span><span class="ident" id="5805919">dt</span><span class="op" id="5805921">.</span><span class="ident" id="5805922">OriginalFirstThunk</span><span class="op" id="5805940">-</span><span class="ident" id="5805941">ds</span><span class="op" id="5805943">.</span><span class="ident" id="5805944">VirtualAddress</span><span class="op" id="5805958">:</span><span class="op" id="5805959">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5805963">for</span>&nbsp;<span class="builtinfunc" id="5805967">len</span><span class="op" id="5805970">(</span><span class="ident" id="5805971">d</span><span class="op" id="5805972">)</span>&nbsp;<span class="op" id="5805974">&gt;</span>&nbsp;<span class="num" id="5805976">0</span>&nbsp;<span class="op" id="5805978">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5805983">if</span>&nbsp;<span class="ident" id="5805986">pe64</span>&nbsp;<span class="op" id="5805991">{</span>&nbsp;<span class="comment" id="5805993">//&nbsp;64bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5806006">va</span>&nbsp;<span class="op" id="5806009">:=</span>&nbsp;<span class="ident" id="5806012">binary</span><span class="op" id="5806018">.</span><span class="ident" id="5806019">LittleEndian</span><span class="op" id="5806031">.</span><span class="ident" id="5806032">Uint64</span><span class="op" id="5806038">(</span><span class="ident" id="5806039">d</span><span class="op" id="5806040">[</span><span class="num" id="5806041">0</span><span class="op" id="5806042">:</span><span class="num" id="5806043">8</span><span class="op" id="5806044">]</span><span class="op" id="5806045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5806051">d</span>&nbsp;<span class="op" id="5806053">=</span>&nbsp;<span class="ident" id="5806055">d</span><span class="op" id="5806056">[</span><span class="num" id="5806057">8</span><span class="op" id="5806058">:</span><span class="op" id="5806059">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5806065">if</span>&nbsp;<span class="ident" id="5806068">va</span>&nbsp;<span class="op" id="5806071">==</span>&nbsp;<span class="num" id="5806074">0</span>&nbsp;<span class="op" id="5806076">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5806083">break</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5806093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5806099">if</span>&nbsp;<span class="ident" id="5806102">va</span><span class="op" id="5806104">&amp;</span><span class="num" id="5806105">0x8000000000000000</span>&nbsp;<span class="op" id="5806124">&gt;</span>&nbsp;<span class="num" id="5806126">0</span>&nbsp;<span class="op" id="5806128">{</span>&nbsp;<span class="comment" id="5806130">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5806149">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5806192">}</span>&nbsp;<span class="keyword" id="5806194">else</span>&nbsp;<span class="op" id="5806199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5806206">fn</span><span class="op" id="5806208">,</span>&nbsp;<span class="ident" id="5806210">_</span>&nbsp;<span class="op" id="5806212">:=</span>&nbsp;<span class="ident" id="5806215">getString</span><span class="op" id="5806224">(</span><span class="ident" id="5806225">names</span><span class="op" id="5806230">,</span>&nbsp;<span class="builtintype" id="5806232">int</span><span class="op" id="5806235">(</span><span class="builtintype" id="5806236">uint32</span><span class="op" id="5806242">(</span><span class="ident" id="5806243">va</span><span class="op" id="5806245">)</span><span class="op" id="5806246">-</span><span class="ident" id="5806247">ds</span><span class="op" id="5806249">.</span><span class="ident" id="5806250">VirtualAddress</span><span class="op" id="5806264">+</span><span class="num" id="5806265">2</span><span class="op" id="5806266">)</span><span class="op" id="5806267">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5806274">all</span>&nbsp;<span class="op" id="5806278">=</span>&nbsp;<span class="builtinfunc" id="5806280">append</span><span class="op" id="5806286">(</span><span class="ident" id="5806287">all</span><span class="op" id="5806290">,</span>&nbsp;<span class="ident" id="5806292">fn</span><span class="op" id="5806294">+</span><span class="string" id="5806295">&#34;:&#34;</span><span class="op" id="5806298">+</span><span class="ident" id="5806299">dt</span><span class="op" id="5806301">.</span><span class="ident" id="5806302">dll</span><span class="op" id="5806305">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5806311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5806316">}</span>&nbsp;<span class="keyword" id="5806318">else</span>&nbsp;<span class="op" id="5806323">{</span>&nbsp;<span class="comment" id="5806325">//&nbsp;32bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5806338">va</span>&nbsp;<span class="op" id="5806341">:=</span>&nbsp;<span class="ident" id="5806344">binary</span><span class="op" id="5806350">.</span><span class="ident" id="5806351">LittleEndian</span><span class="op" id="5806363">.</span><span class="ident" id="5806364">Uint32</span><span class="op" id="5806370">(</span><span class="ident" id="5806371">d</span><span class="op" id="5806372">[</span><span class="num" id="5806373">0</span><span class="op" id="5806374">:</span><span class="num" id="5806375">4</span><span class="op" id="5806376">]</span><span class="op" id="5806377">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5806383">d</span>&nbsp;<span class="op" id="5806385">=</span>&nbsp;<span class="ident" id="5806387">d</span><span class="op" id="5806388">[</span><span class="num" id="5806389">4</span><span class="op" id="5806390">:</span><span class="op" id="5806391">]</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5806397">if</span>&nbsp;<span class="ident" id="5806400">va</span>&nbsp;<span class="op" id="5806403">==</span>&nbsp;<span class="num" id="5806406">0</span>&nbsp;<span class="op" id="5806408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5806415">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5806425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5806431">if</span>&nbsp;<span class="ident" id="5806434">va</span><span class="op" id="5806436">&amp;</span><span class="num" id="5806437">0x80000000</span>&nbsp;<span class="op" id="5806448">&gt;</span>&nbsp;<span class="num" id="5806450">0</span>&nbsp;<span class="op" id="5806452">{</span>&nbsp;<span class="comment" id="5806454">//&nbsp;is&nbsp;Ordinal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5806473">//&nbsp;TODO&nbsp;add&nbsp;dynimport&nbsp;ordinal&nbsp;support.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5806517">//ord&nbsp;:=&nbsp;va&amp;0x0000FFFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5806544">}</span>&nbsp;<span class="keyword" id="5806546">else</span>&nbsp;<span class="op" id="5806551">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5806558">fn</span><span class="op" id="5806560">,</span>&nbsp;<span class="ident" id="5806562">_</span>&nbsp;<span class="op" id="5806564">:=</span>&nbsp;<span class="ident" id="5806567">getString</span><span class="op" id="5806576">(</span><span class="ident" id="5806577">names</span><span class="op" id="5806582">,</span>&nbsp;<span class="builtintype" id="5806584">int</span><span class="op" id="5806587">(</span><span class="ident" id="5806588">va</span><span class="op" id="5806590">-</span><span class="ident" id="5806591">ds</span><span class="op" id="5806593">.</span><span class="ident" id="5806594">VirtualAddress</span><span class="op" id="5806608">+</span><span class="num" id="5806609">2</span><span class="op" id="5806610">)</span><span class="op" id="5806611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5806618">all</span>&nbsp;<span class="op" id="5806622">=</span>&nbsp;<span class="builtinfunc" id="5806624">append</span><span class="op" id="5806630">(</span><span class="ident" id="5806631">all</span><span class="op" id="5806634">,</span>&nbsp;<span class="ident" id="5806636">fn</span><span class="op" id="5806638">+</span><span class="string" id="5806639">&#34;:&#34;</span><span class="op" id="5806642">+</span><span class="ident" id="5806643">dt</span><span class="op" id="5806645">.</span><span class="ident" id="5806646">dll</span><span class="op" id="5806649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5806655">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5806660">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5806664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5806667">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5806671">return</span>&nbsp;<span class="ident" id="5806678">all</span><span class="op" id="5806681">,</span>&nbsp;<span class="builtintype" id="5806683">nil</span><br>
<span class="lineno">385</span><span class="op" id="5806687">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5806690">//&nbsp;ImportedLibraries&nbsp;returns&nbsp;the&nbsp;names&nbsp;of&nbsp;all&nbsp;libraries</span><br>
<span class="lineno"></span><span class="comment" id="5806746">//&nbsp;referred&nbsp;to&nbsp;by&nbsp;the&nbsp;binary&nbsp;f&nbsp;that&nbsp;are&nbsp;expected&nbsp;to&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="5806801">//&nbsp;linked&nbsp;with&nbsp;the&nbsp;binary&nbsp;at&nbsp;dynamic&nbsp;link&nbsp;time.</span><br>
<span class="lineno">390</span><span class="keyword" id="5806849">func</span>&nbsp;<span class="op" id="5806854">(</span><span class="ident" id="5806855">f</span>&nbsp;<span class="op" id="5806857">*</span><span class="ident" id="5806858">File</span><span class="op" id="5806862">)</span>&nbsp;<span class="ident" id="5806864">ImportedLibraries</span><span class="op" id="5806881">(</span><span class="op" id="5806882">)</span>&nbsp;<span class="op" id="5806884">(</span><span class="op" id="5806885">[</span><span class="op" id="5806886">]</span><span class="builtintype" id="5806887">string</span><span class="op" id="5806893">,</span>&nbsp;<span class="builtintype" id="5806895">error</span><span class="op" id="5806900">)</span>&nbsp;<span class="op" id="5806902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5806905">//&nbsp;TODO</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5806914">//&nbsp;cgo&nbsp;-dynimport&nbsp;don&#39;t&nbsp;use&nbsp;this&nbsp;for&nbsp;windows&nbsp;PE,&nbsp;so&nbsp;just&nbsp;return.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="5806980">return</span>&nbsp;<span class="builtintype" id="5806987">nil</span><span class="op" id="5806990">,</span>&nbsp;<span class="builtintype" id="5806992">nil</span><br>
<span class="lineno"></span><span class="op" id="5806996">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
