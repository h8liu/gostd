<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5054985">package</span>&nbsp;<span class="ident" id="5054993">arch8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5055000">import</span>&nbsp;<span class="op" id="5055007">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5055010">&#34;math&#34;</span><br>
<span class="lineno">5</span><span class="op" id="5055017">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5055020">//&nbsp;InstReg&nbsp;executes&nbsp;register&nbsp;based&nbsp;instructions</span><br>
<span class="lineno"></span><span class="keyword" id="5055068">type</span>&nbsp;<span class="ident" id="5055073">instReg</span>&nbsp;<span class="keyword" id="5055081">struct</span><span class="op" id="5055087">{</span><span class="op" id="5055088">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="comment" id="5055091">//&nbsp;I&nbsp;executes&nbsp;the&nbsp;register&nbsp;instruction.</span><br>
<span class="lineno"></span><span class="comment" id="5055131">//&nbsp;Might&nbsp;return&nbsp;invalid&nbsp;instruction&nbsp;exception.</span><br>
<span class="lineno"></span><span class="keyword" id="5055178">func</span>&nbsp;<span class="op" id="5055183">(</span><span class="ident" id="5055184">i</span>&nbsp;<span class="op" id="5055186">*</span><span class="ident" id="5055187">instReg</span><span class="op" id="5055194">)</span>&nbsp;<span class="ident" id="5055196">I</span><span class="op" id="5055197">(</span><span class="ident" id="5055198">cpu</span>&nbsp;<span class="op" id="5055202">*</span><span class="ident" id="5055203">cpu</span><span class="op" id="5055206">,</span>&nbsp;<span class="ident" id="5055208">in</span>&nbsp;<span class="builtintype" id="5055211">uint32</span><span class="op" id="5055217">)</span>&nbsp;<span class="op" id="5055219">*</span><span class="ident" id="5055220">Excep</span>&nbsp;<span class="op" id="5055226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5055229">//&nbsp;bit&nbsp;(32:24]&nbsp;==&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5055250">if</span>&nbsp;<span class="op" id="5055253">(</span><span class="op" id="5055254">(</span><span class="ident" id="5055255">in</span>&nbsp;<span class="op" id="5055258">&gt;&gt;</span>&nbsp;<span class="num" id="5055261">24</span><span class="op" id="5055263">)</span>&nbsp;<span class="op" id="5055265">&amp;</span>&nbsp;<span class="num" id="5055267">0xff</span><span class="op" id="5055271">)</span>&nbsp;<span class="op" id="5055273">!=</span>&nbsp;<span class="num" id="5055276">0</span>&nbsp;<span class="op" id="5055278">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5055282">panic</span><span class="op" id="5055287">(</span><span class="string" id="5055288">&#34;not&nbsp;a&nbsp;register&nbsp;inst&#34;</span><span class="op" id="5055309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5055312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5055316">dest</span>&nbsp;<span class="op" id="5055321">:=</span>&nbsp;<span class="op" id="5055324">(</span><span class="ident" id="5055325">in</span>&nbsp;<span class="op" id="5055328">&gt;&gt;</span>&nbsp;<span class="num" id="5055331">21</span><span class="op" id="5055333">)</span>&nbsp;<span class="op" id="5055335">&amp;</span>&nbsp;<span class="num" id="5055337">0x7</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5055343">//&nbsp;(24:21]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5055355">src1</span>&nbsp;<span class="op" id="5055360">:=</span>&nbsp;<span class="op" id="5055363">(</span><span class="ident" id="5055364">in</span>&nbsp;<span class="op" id="5055367">&gt;&gt;</span>&nbsp;<span class="num" id="5055370">18</span><span class="op" id="5055372">)</span>&nbsp;<span class="op" id="5055374">&amp;</span>&nbsp;<span class="num" id="5055376">0x7</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5055382">//&nbsp;(21:18]</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5055394">src2</span>&nbsp;<span class="op" id="5055399">:=</span>&nbsp;<span class="op" id="5055402">(</span><span class="ident" id="5055403">in</span>&nbsp;<span class="op" id="5055406">&gt;&gt;</span>&nbsp;<span class="num" id="5055409">15</span><span class="op" id="5055411">)</span>&nbsp;<span class="op" id="5055413">&amp;</span>&nbsp;<span class="num" id="5055415">0x7</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="5055421">//&nbsp;(18:15]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5055433">shift</span>&nbsp;<span class="op" id="5055439">:=</span>&nbsp;<span class="op" id="5055442">(</span><span class="ident" id="5055443">in</span>&nbsp;<span class="op" id="5055446">&gt;&gt;</span>&nbsp;<span class="num" id="5055449">10</span><span class="op" id="5055451">)</span>&nbsp;<span class="op" id="5055453">&amp;</span>&nbsp;<span class="num" id="5055455">0x1f</span>&nbsp;<span class="comment" id="5055460">//&nbsp;(15:10]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5055472">isFloat</span>&nbsp;<span class="op" id="5055480">:=</span>&nbsp;<span class="op" id="5055483">(</span><span class="ident" id="5055484">in</span>&nbsp;<span class="op" id="5055487">&gt;&gt;</span>&nbsp;<span class="num" id="5055490">8</span><span class="op" id="5055491">)</span>&nbsp;<span class="op" id="5055493">&amp;</span>&nbsp;<span class="num" id="5055495">0x1</span>&nbsp;<span class="comment" id="5055499">//&nbsp;(9:8]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5055509">funct</span>&nbsp;<span class="op" id="5055515">:=</span>&nbsp;<span class="ident" id="5055518">in</span>&nbsp;<span class="op" id="5055521">&amp;</span>&nbsp;<span class="num" id="5055523">0xff</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="5055536">//&nbsp;(8:0]</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5055547">s1</span>&nbsp;<span class="op" id="5055550">:=</span>&nbsp;<span class="ident" id="5055553">cpu</span><span class="op" id="5055556">.</span><span class="ident" id="5055557">regs</span><span class="op" id="5055561">[</span><span class="ident" id="5055562">src1</span><span class="op" id="5055566">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5055569">s2</span>&nbsp;<span class="op" id="5055572">:=</span>&nbsp;<span class="ident" id="5055575">cpu</span><span class="op" id="5055578">.</span><span class="ident" id="5055579">regs</span><span class="op" id="5055583">[</span><span class="ident" id="5055584">src2</span><span class="op" id="5055588">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5055591">d</span>&nbsp;<span class="op" id="5055593">:=</span>&nbsp;<span class="builtintype" id="5055596">uint32</span><span class="op" id="5055602">(</span><span class="num" id="5055603">0</span><span class="op" id="5055604">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5055608">if</span>&nbsp;<span class="ident" id="5055611">isFloat</span>&nbsp;<span class="op" id="5055619">==</span>&nbsp;<span class="num" id="5055622">0</span>&nbsp;<span class="op" id="5055624">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5055628">switch</span>&nbsp;<span class="ident" id="5055635">funct</span>&nbsp;<span class="op" id="5055641">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5055645">case</span>&nbsp;<span class="num" id="5055650">0</span><span class="op" id="5055651">:</span>&nbsp;<span class="comment" id="5055653">//&nbsp;sll</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5055663">d</span>&nbsp;<span class="op" id="5055665">=</span>&nbsp;<span class="ident" id="5055667">s1</span>&nbsp;<span class="op" id="5055670">&lt;&lt;</span>&nbsp;<span class="ident" id="5055673">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5055681">case</span>&nbsp;<span class="num" id="5055686">1</span><span class="op" id="5055687">:</span>&nbsp;<span class="comment" id="5055689">//&nbsp;srl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5055699">d</span>&nbsp;<span class="op" id="5055701">=</span>&nbsp;<span class="ident" id="5055703">s1</span>&nbsp;<span class="op" id="5055706">&gt;&gt;</span>&nbsp;<span class="ident" id="5055709">shift</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5055717">case</span>&nbsp;<span class="num" id="5055722">2</span><span class="op" id="5055723">:</span>&nbsp;<span class="comment" id="5055725">//&nbsp;sra</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5055735">d</span>&nbsp;<span class="op" id="5055737">=</span>&nbsp;<span class="builtintype" id="5055739">uint32</span><span class="op" id="5055745">(</span><span class="builtintype" id="5055746">int32</span><span class="op" id="5055751">(</span><span class="ident" id="5055752">s1</span><span class="op" id="5055754">)</span>&nbsp;<span class="op" id="5055756">&gt;&gt;</span>&nbsp;<span class="ident" id="5055759">shift</span><span class="op" id="5055764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5055768">case</span>&nbsp;<span class="num" id="5055773">3</span><span class="op" id="5055774">:</span>&nbsp;<span class="comment" id="5055776">//&nbsp;sllv</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5055787">d</span>&nbsp;<span class="op" id="5055789">=</span>&nbsp;<span class="ident" id="5055791">s1</span>&nbsp;<span class="op" id="5055794">&lt;&lt;</span>&nbsp;<span class="ident" id="5055797">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5055802">case</span>&nbsp;<span class="num" id="5055807">4</span><span class="op" id="5055808">:</span>&nbsp;<span class="comment" id="5055810">//&nbsp;srlv</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5055821">d</span>&nbsp;<span class="op" id="5055823">=</span>&nbsp;<span class="ident" id="5055825">s1</span>&nbsp;<span class="op" id="5055828">&gt;&gt;</span>&nbsp;<span class="ident" id="5055831">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5055836">case</span>&nbsp;<span class="num" id="5055841">5</span><span class="op" id="5055842">:</span>&nbsp;<span class="comment" id="5055844">//&nbsp;srla</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5055855">d</span>&nbsp;<span class="op" id="5055857">=</span>&nbsp;<span class="builtintype" id="5055859">uint32</span><span class="op" id="5055865">(</span><span class="builtintype" id="5055866">int32</span><span class="op" id="5055871">(</span><span class="ident" id="5055872">s1</span><span class="op" id="5055874">)</span>&nbsp;<span class="op" id="5055876">&gt;&gt;</span>&nbsp;<span class="ident" id="5055879">s2</span><span class="op" id="5055881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5055885">case</span>&nbsp;<span class="num" id="5055890">6</span><span class="op" id="5055891">:</span>&nbsp;<span class="comment" id="5055893">//&nbsp;add</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5055903">d</span>&nbsp;<span class="op" id="5055905">=</span>&nbsp;<span class="ident" id="5055907">s1</span>&nbsp;<span class="op" id="5055910">+</span>&nbsp;<span class="ident" id="5055912">s2</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5055917">case</span>&nbsp;<span class="num" id="5055922">7</span><span class="op" id="5055923">:</span>&nbsp;<span class="comment" id="5055925">//&nbsp;sub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5055935">d</span>&nbsp;<span class="op" id="5055937">=</span>&nbsp;<span class="ident" id="5055939">s1</span>&nbsp;<span class="op" id="5055942">-</span>&nbsp;<span class="ident" id="5055944">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5055949">case</span>&nbsp;<span class="num" id="5055954">8</span><span class="op" id="5055955">:</span>&nbsp;<span class="comment" id="5055957">//&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5055967">d</span>&nbsp;<span class="op" id="5055969">=</span>&nbsp;<span class="ident" id="5055971">s1</span>&nbsp;<span class="op" id="5055974">&amp;</span>&nbsp;<span class="ident" id="5055976">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5055981">case</span>&nbsp;<span class="num" id="5055986">9</span><span class="op" id="5055987">:</span>&nbsp;<span class="comment" id="5055989">//&nbsp;or</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5055998">d</span>&nbsp;<span class="op" id="5056000">=</span>&nbsp;<span class="ident" id="5056002">s1</span>&nbsp;<span class="op" id="5056005">|</span>&nbsp;<span class="ident" id="5056007">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056012">case</span>&nbsp;<span class="num" id="5056017">10</span><span class="op" id="5056019">:</span>&nbsp;<span class="comment" id="5056021">//&nbsp;xor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056031">d</span>&nbsp;<span class="op" id="5056033">=</span>&nbsp;<span class="ident" id="5056035">s1</span>&nbsp;<span class="op" id="5056038">^</span>&nbsp;<span class="ident" id="5056040">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056045">case</span>&nbsp;<span class="num" id="5056050">11</span><span class="op" id="5056052">:</span>&nbsp;<span class="comment" id="5056054">//&nbsp;nor</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056064">d</span>&nbsp;<span class="op" id="5056066">=</span>&nbsp;<span class="op" id="5056068">^</span><span class="op" id="5056069">(</span><span class="ident" id="5056070">s1</span>&nbsp;<span class="op" id="5056073">|</span>&nbsp;<span class="ident" id="5056075">s2</span><span class="op" id="5056077">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056081">case</span>&nbsp;<span class="num" id="5056086">12</span><span class="op" id="5056088">:</span>&nbsp;<span class="comment" id="5056090">//&nbsp;slt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056100">if</span>&nbsp;<span class="builtintype" id="5056103">int32</span><span class="op" id="5056108">(</span><span class="ident" id="5056109">s1</span><span class="op" id="5056111">)</span>&nbsp;<span class="op" id="5056113">&lt;</span>&nbsp;<span class="builtintype" id="5056115">int32</span><span class="op" id="5056120">(</span><span class="ident" id="5056121">s2</span><span class="op" id="5056123">)</span>&nbsp;<span class="op" id="5056125">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056131">d</span>&nbsp;<span class="op" id="5056133">=</span>&nbsp;<span class="num" id="5056135">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5056140">}</span>&nbsp;<span class="keyword" id="5056142">else</span>&nbsp;<span class="op" id="5056147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056153">d</span>&nbsp;<span class="op" id="5056155">=</span>&nbsp;<span class="num" id="5056157">0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5056162">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056166">case</span>&nbsp;<span class="num" id="5056171">13</span><span class="op" id="5056173">:</span>&nbsp;<span class="comment" id="5056175">//&nbsp;sltu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056186">if</span>&nbsp;<span class="ident" id="5056189">s1</span>&nbsp;<span class="op" id="5056192">&lt;</span>&nbsp;<span class="ident" id="5056194">s2</span>&nbsp;<span class="op" id="5056197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056203">d</span>&nbsp;<span class="op" id="5056205">=</span>&nbsp;<span class="num" id="5056207">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5056212">}</span>&nbsp;<span class="keyword" id="5056214">else</span>&nbsp;<span class="op" id="5056219">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056225">d</span>&nbsp;<span class="op" id="5056227">=</span>&nbsp;<span class="num" id="5056229">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5056234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056238">case</span>&nbsp;<span class="num" id="5056243">14</span><span class="op" id="5056245">:</span>&nbsp;<span class="comment" id="5056247">//&nbsp;mul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056257">d</span>&nbsp;<span class="op" id="5056259">=</span>&nbsp;<span class="builtintype" id="5056261">uint32</span><span class="op" id="5056267">(</span><span class="builtintype" id="5056268">int32</span><span class="op" id="5056273">(</span><span class="ident" id="5056274">s1</span><span class="op" id="5056276">)</span>&nbsp;<span class="op" id="5056278">*</span>&nbsp;<span class="builtintype" id="5056280">int32</span><span class="op" id="5056285">(</span><span class="ident" id="5056286">s2</span><span class="op" id="5056288">)</span><span class="op" id="5056289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056293">case</span>&nbsp;<span class="num" id="5056298">15</span><span class="op" id="5056300">:</span>&nbsp;<span class="comment" id="5056302">//&nbsp;mulu</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056313">d</span>&nbsp;<span class="op" id="5056315">=</span>&nbsp;<span class="ident" id="5056317">s1</span>&nbsp;<span class="op" id="5056320">*</span>&nbsp;<span class="ident" id="5056322">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056327">case</span>&nbsp;<span class="num" id="5056332">16</span><span class="op" id="5056334">:</span>&nbsp;<span class="comment" id="5056336">//&nbsp;div</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056346">if</span>&nbsp;<span class="ident" id="5056349">s2</span>&nbsp;<span class="op" id="5056352">==</span>&nbsp;<span class="num" id="5056355">0</span>&nbsp;<span class="op" id="5056357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056363">d</span>&nbsp;<span class="op" id="5056365">=</span>&nbsp;<span class="num" id="5056367">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5056372">}</span>&nbsp;<span class="keyword" id="5056374">else</span>&nbsp;<span class="op" id="5056379">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056385">d</span>&nbsp;<span class="op" id="5056387">=</span>&nbsp;<span class="builtintype" id="5056389">uint32</span><span class="op" id="5056395">(</span><span class="builtintype" id="5056396">int32</span><span class="op" id="5056401">(</span><span class="ident" id="5056402">s1</span><span class="op" id="5056404">)</span>&nbsp;<span class="op" id="5056406">/</span>&nbsp;<span class="builtintype" id="5056408">int32</span><span class="op" id="5056413">(</span><span class="ident" id="5056414">s2</span><span class="op" id="5056416">)</span><span class="op" id="5056417">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5056422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056426">case</span>&nbsp;<span class="num" id="5056431">17</span><span class="op" id="5056433">:</span>&nbsp;<span class="comment" id="5056435">//&nbsp;divu</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056446">if</span>&nbsp;<span class="ident" id="5056449">s2</span>&nbsp;<span class="op" id="5056452">==</span>&nbsp;<span class="num" id="5056455">0</span>&nbsp;<span class="op" id="5056457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056463">d</span>&nbsp;<span class="op" id="5056465">=</span>&nbsp;<span class="num" id="5056467">0</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5056472">}</span>&nbsp;<span class="keyword" id="5056474">else</span>&nbsp;<span class="op" id="5056479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056485">d</span>&nbsp;<span class="op" id="5056487">=</span>&nbsp;<span class="ident" id="5056489">s1</span>&nbsp;<span class="op" id="5056492">/</span>&nbsp;<span class="ident" id="5056494">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5056500">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056504">case</span>&nbsp;<span class="num" id="5056509">18</span><span class="op" id="5056511">:</span>&nbsp;<span class="comment" id="5056513">//&nbsp;mod</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056523">if</span>&nbsp;<span class="ident" id="5056526">s2</span>&nbsp;<span class="op" id="5056529">==</span>&nbsp;<span class="num" id="5056532">0</span>&nbsp;<span class="op" id="5056534">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056540">d</span>&nbsp;<span class="op" id="5056542">=</span>&nbsp;<span class="num" id="5056544">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5056549">}</span>&nbsp;<span class="keyword" id="5056551">else</span>&nbsp;<span class="op" id="5056556">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056562">d</span>&nbsp;<span class="op" id="5056564">=</span>&nbsp;<span class="builtintype" id="5056566">uint32</span><span class="op" id="5056572">(</span><span class="builtintype" id="5056573">int32</span><span class="op" id="5056578">(</span><span class="ident" id="5056579">s1</span><span class="op" id="5056581">)</span>&nbsp;<span class="op" id="5056583">%</span>&nbsp;<span class="builtintype" id="5056585">int32</span><span class="op" id="5056590">(</span><span class="ident" id="5056591">s2</span><span class="op" id="5056593">)</span><span class="op" id="5056594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5056599">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056603">case</span>&nbsp;<span class="num" id="5056608">19</span><span class="op" id="5056610">:</span>&nbsp;<span class="comment" id="5056612">//&nbsp;modu</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056623">if</span>&nbsp;<span class="ident" id="5056626">s2</span>&nbsp;<span class="op" id="5056629">==</span>&nbsp;<span class="num" id="5056632">0</span>&nbsp;<span class="op" id="5056634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056640">d</span>&nbsp;<span class="op" id="5056642">=</span>&nbsp;<span class="num" id="5056644">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5056649">}</span>&nbsp;<span class="keyword" id="5056651">else</span>&nbsp;<span class="op" id="5056656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056662">d</span>&nbsp;<span class="op" id="5056664">=</span>&nbsp;<span class="ident" id="5056666">s1</span>&nbsp;<span class="op" id="5056669">%</span>&nbsp;<span class="ident" id="5056671">s2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5056677">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056681">default</span><span class="op" id="5056688">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056693">return</span>&nbsp;<span class="ident" id="5056700">errInvalidInst</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5056717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5056720">}</span>&nbsp;<span class="keyword" id="5056722">else</span>&nbsp;<span class="op" id="5056727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056731">f1</span>&nbsp;<span class="op" id="5056734">:=</span>&nbsp;<span class="ident" id="5056737">math</span><span class="op" id="5056741">.</span><span class="ident" id="5056742">Float32frombits</span><span class="op" id="5056757">(</span><span class="ident" id="5056758">s1</span><span class="op" id="5056760">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056764">f2</span>&nbsp;<span class="op" id="5056767">:=</span>&nbsp;<span class="ident" id="5056770">math</span><span class="op" id="5056774">.</span><span class="ident" id="5056775">Float32frombits</span><span class="op" id="5056790">(</span><span class="ident" id="5056791">s2</span><span class="op" id="5056793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056797">var</span>&nbsp;<span class="ident" id="5056801">fd</span>&nbsp;<span class="builtintype" id="5056804">float32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056814">switch</span>&nbsp;<span class="ident" id="5056821">funct</span>&nbsp;<span class="op" id="5056827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056831">case</span>&nbsp;<span class="num" id="5056836">0</span><span class="op" id="5056837">:</span>&nbsp;<span class="comment" id="5056839">//&nbsp;fadd</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056850">fd</span>&nbsp;<span class="op" id="5056853">=</span>&nbsp;<span class="ident" id="5056855">f1</span>&nbsp;<span class="op" id="5056858">+</span>&nbsp;<span class="ident" id="5056860">f2</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056865">case</span>&nbsp;<span class="num" id="5056870">1</span><span class="op" id="5056871">:</span>&nbsp;<span class="comment" id="5056873">//&nbsp;fsub</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056884">fd</span>&nbsp;<span class="op" id="5056887">=</span>&nbsp;<span class="ident" id="5056889">f1</span>&nbsp;<span class="op" id="5056892">-</span>&nbsp;<span class="ident" id="5056894">f2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056899">case</span>&nbsp;<span class="num" id="5056904">2</span><span class="op" id="5056905">:</span>&nbsp;<span class="comment" id="5056907">//&nbsp;fmul</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056918">fd</span>&nbsp;<span class="op" id="5056921">=</span>&nbsp;<span class="ident" id="5056923">f1</span>&nbsp;<span class="op" id="5056926">*</span>&nbsp;<span class="ident" id="5056928">f2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056933">case</span>&nbsp;<span class="num" id="5056938">3</span><span class="op" id="5056939">:</span>&nbsp;<span class="comment" id="5056941">//&nbsp;fdiv</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056952">fd</span>&nbsp;<span class="op" id="5056955">=</span>&nbsp;<span class="ident" id="5056957">f1</span>&nbsp;<span class="op" id="5056960">/</span>&nbsp;<span class="ident" id="5056962">f2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5056967">case</span>&nbsp;<span class="num" id="5056972">4</span><span class="op" id="5056973">:</span>&nbsp;<span class="comment" id="5056975">//&nbsp;fint</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5056986">d</span>&nbsp;<span class="op" id="5056988">=</span>&nbsp;<span class="builtintype" id="5056990">uint32</span><span class="op" id="5056996">(</span><span class="ident" id="5056997">f1</span><span class="op" id="5056999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5057003">default</span><span class="op" id="5057010">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5057015">return</span>&nbsp;<span class="ident" id="5057022">errInvalidInst</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5057039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5057044">if</span>&nbsp;<span class="ident" id="5057047">funct</span>&nbsp;<span class="op" id="5057053">!=</span>&nbsp;<span class="num" id="5057056">4</span>&nbsp;<span class="op" id="5057058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5057063">d</span>&nbsp;<span class="op" id="5057065">=</span>&nbsp;<span class="ident" id="5057067">math</span><span class="op" id="5057071">.</span><span class="ident" id="5057072">Float32bits</span><span class="op" id="5057083">(</span><span class="ident" id="5057084">fd</span><span class="op" id="5057086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5057090">}</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5057093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5057097">cpu</span><span class="op" id="5057100">.</span><span class="ident" id="5057101">regs</span><span class="op" id="5057105">[</span><span class="ident" id="5057106">dest</span><span class="op" id="5057110">]</span>&nbsp;<span class="op" id="5057112">=</span>&nbsp;<span class="ident" id="5057114">d</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5057117">return</span>&nbsp;<span class="ident" id="5057124">nil</span><br>
<span class="lineno"></span><span class="op" id="5057128">}</span>
</div>
</body>
</html>
