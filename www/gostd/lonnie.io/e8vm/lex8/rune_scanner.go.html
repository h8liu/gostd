<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="keyword" id="5125880">package</span>&nbsp;<span class="ident" id="5125888">lex8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5125894">import</span>&nbsp;<span class="op" id="5125901">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5125904">&#34;bufio&#34;</span><br>
<span class="lineno">5</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5125913">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="5125918">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5125921">//&nbsp;RuneScanner&nbsp;is&nbsp;a&nbsp;rune&nbsp;scanner&nbsp;that&nbsp;scans&nbsp;runes&nbsp;from&nbsp;a&nbsp;file,</span><br>
<span class="lineno"></span><span class="comment" id="5125984">//&nbsp;and&nbsp;at&nbsp;the&nbsp;same&nbsp;time&nbsp;tracks&nbsp;the&nbsp;reading&nbsp;position.</span><br>
<span class="lineno">10</span><span class="keyword" id="5126037">type</span>&nbsp;<span class="ident" id="5126042">RuneScanner</span>&nbsp;<span class="keyword" id="5126054">struct</span>&nbsp;<span class="op" id="5126061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126064">file</span>&nbsp;<span class="builtintype" id="5126069">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126077">line</span>&nbsp;<span class="builtintype" id="5126082">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126088">rc</span>&nbsp;<span class="ident" id="5126091">io</span><span class="op" id="5126093">.</span><span class="ident" id="5126094">ReadCloser</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126106">r</span>&nbsp;&nbsp;<span class="op" id="5126109">*</span><span class="ident" id="5126110">bufio</span><span class="op" id="5126115">.</span><span class="ident" id="5126116">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126125">Err</span>&nbsp;&nbsp;<span class="builtintype" id="5126130">error</span>&nbsp;<span class="comment" id="5126136">//&nbsp;any&nbsp;error&nbsp;encountered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126162">Rune</span>&nbsp;<span class="builtintype" id="5126167">rune</span>&nbsp;&nbsp;<span class="comment" id="5126173">//&nbsp;the&nbsp;rune&nbsp;just&nbsp;read</span><br>
<span class="lineno"></span><span class="op" id="5126195">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="comment" id="5126198">//&nbsp;NewRuneScanner&nbsp;creates&nbsp;a&nbsp;scanner.</span><br>
<span class="lineno"></span><span class="keyword" id="5126235">func</span>&nbsp;<span class="ident" id="5126240">NewRuneScanner</span><span class="op" id="5126254">(</span><span class="ident" id="5126255">file</span>&nbsp;<span class="builtintype" id="5126260">string</span><span class="op" id="5126266">,</span>&nbsp;<span class="ident" id="5126268">rc</span>&nbsp;<span class="ident" id="5126271">io</span><span class="op" id="5126273">.</span><span class="ident" id="5126274">ReadCloser</span><span class="op" id="5126284">)</span>&nbsp;<span class="op" id="5126286">*</span><span class="ident" id="5126287">RuneScanner</span>&nbsp;<span class="op" id="5126299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126302">ret</span>&nbsp;<span class="op" id="5126306">:=</span>&nbsp;<span class="builtinfunc" id="5126309">new</span><span class="op" id="5126312">(</span><span class="ident" id="5126313">RuneScanner</span><span class="op" id="5126324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126327">ret</span><span class="op" id="5126330">.</span><span class="ident" id="5126331">file</span>&nbsp;<span class="op" id="5126336">=</span>&nbsp;<span class="ident" id="5126338">file</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126344">ret</span><span class="op" id="5126347">.</span><span class="ident" id="5126348">rc</span>&nbsp;<span class="op" id="5126351">=</span>&nbsp;<span class="ident" id="5126353">rc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126357">ret</span><span class="op" id="5126360">.</span><span class="ident" id="5126361">r</span>&nbsp;<span class="op" id="5126363">=</span>&nbsp;<span class="ident" id="5126365">bufio</span><span class="op" id="5126370">.</span><span class="ident" id="5126371">NewReader</span><span class="op" id="5126380">(</span><span class="ident" id="5126381">rc</span><span class="op" id="5126383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126386">ret</span><span class="op" id="5126389">.</span><span class="ident" id="5126390">line</span>&nbsp;<span class="op" id="5126395">=</span>&nbsp;<span class="num" id="5126397">1</span>&nbsp;<span class="comment" id="5126399">//&nbsp;natural&nbsp;counting</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126421">return</span>&nbsp;<span class="ident" id="5126428">ret</span><br>
<span class="lineno">30</span><span class="op" id="5126432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5126435">//&nbsp;Scan&nbsp;reads&nbsp;in&nbsp;the&nbsp;next&nbsp;rune&nbsp;to&nbsp;s.Rune.</span><br>
<span class="lineno"></span><span class="comment" id="5126477">//&nbsp;It&nbsp;closes&nbsp;the&nbsp;reader&nbsp;automatically&nbsp;when&nbsp;it&nbsp;reaches&nbsp;the&nbsp;end&nbsp;of&nbsp;file</span><br>
<span class="lineno"></span><span class="comment" id="5126547">//&nbsp;or&nbsp;when&nbsp;an&nbsp;error&nbsp;occurs.</span><br>
<span class="lineno">35</span><span class="keyword" id="5126575">func</span>&nbsp;<span class="op" id="5126580">(</span><span class="ident" id="5126581">s</span>&nbsp;<span class="op" id="5126583">*</span><span class="ident" id="5126584">RuneScanner</span><span class="op" id="5126595">)</span>&nbsp;<span class="ident" id="5126597">Scan</span><span class="op" id="5126601">(</span><span class="op" id="5126602">)</span>&nbsp;<span class="builtintype" id="5126604">bool</span>&nbsp;<span class="op" id="5126609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126612">wasEndline</span>&nbsp;<span class="op" id="5126623">:=</span>&nbsp;<span class="ident" id="5126626">s</span><span class="op" id="5126627">.</span><span class="ident" id="5126628">Rune</span>&nbsp;<span class="op" id="5126633">==</span>&nbsp;<span class="string" id="5126636">&#39;\n&#39;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126643">s</span><span class="op" id="5126644">.</span><span class="ident" id="5126645">Rune</span><span class="op" id="5126649">,</span>&nbsp;<span class="ident" id="5126651">_</span><span class="op" id="5126652">,</span>&nbsp;<span class="ident" id="5126654">s</span><span class="op" id="5126655">.</span><span class="ident" id="5126656">Err</span>&nbsp;<span class="op" id="5126660">=</span>&nbsp;<span class="ident" id="5126662">s</span><span class="op" id="5126663">.</span><span class="ident" id="5126664">r</span><span class="op" id="5126665">.</span><span class="ident" id="5126666">ReadRune</span><span class="op" id="5126674">(</span><span class="op" id="5126675">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126679">if</span>&nbsp;<span class="ident" id="5126682">s</span><span class="op" id="5126683">.</span><span class="ident" id="5126684">Err</span>&nbsp;<span class="op" id="5126688">!=</span>&nbsp;<span class="ident" id="5126691">nil</span>&nbsp;<span class="op" id="5126695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126699">closeErr</span>&nbsp;<span class="op" id="5126708">:=</span>&nbsp;<span class="ident" id="5126711">s</span><span class="op" id="5126712">.</span><span class="ident" id="5126713">rc</span><span class="op" id="5126715">.</span><span class="ident" id="5126716">Close</span><span class="op" id="5126721">(</span><span class="op" id="5126722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126726">if</span>&nbsp;<span class="ident" id="5126729">s</span><span class="op" id="5126730">.</span><span class="ident" id="5126731">Err</span>&nbsp;<span class="op" id="5126735">==</span>&nbsp;<span class="ident" id="5126738">io</span><span class="op" id="5126740">.</span><span class="ident" id="5126741">EOF</span>&nbsp;<span class="op" id="5126745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126750">s</span><span class="op" id="5126751">.</span><span class="ident" id="5126752">Err</span>&nbsp;<span class="op" id="5126756">=</span>&nbsp;<span class="ident" id="5126758">closeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5126769">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126773">return</span>&nbsp;<span class="builtintype" id="5126780">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5126787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126791">if</span>&nbsp;<span class="ident" id="5126794">wasEndline</span>&nbsp;<span class="op" id="5126805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5126809">s</span><span class="op" id="5126810">.</span><span class="ident" id="5126811">line</span><span class="op" id="5126815">++</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5126819">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126823">return</span>&nbsp;<span class="builtintype" id="5126830">true</span><br>
<span class="lineno"></span><span class="op" id="5126835">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span><span class="comment" id="5126838">//&nbsp;Pos&nbsp;returns&nbsp;the&nbsp;current&nbsp;position&nbsp;in&nbsp;the&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="5126887">func</span>&nbsp;<span class="op" id="5126892">(</span><span class="ident" id="5126893">s</span>&nbsp;<span class="op" id="5126895">*</span><span class="ident" id="5126896">RuneScanner</span><span class="op" id="5126907">)</span>&nbsp;<span class="ident" id="5126909">Pos</span><span class="op" id="5126912">(</span><span class="op" id="5126913">)</span>&nbsp;<span class="op" id="5126915">*</span><span class="ident" id="5126916">Pos</span>&nbsp;<span class="op" id="5126920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5126923">return</span>&nbsp;<span class="op" id="5126930">&amp;</span><span class="ident" id="5126931">Pos</span><span class="op" id="5126934">{</span><span class="ident" id="5126935">s</span><span class="op" id="5126936">.</span><span class="ident" id="5126937">file</span><span class="op" id="5126941">,</span>&nbsp;<span class="ident" id="5126943">s</span><span class="op" id="5126944">.</span><span class="ident" id="5126945">line</span><span class="op" id="5126949">}</span><br>
<span class="lineno"></span><span class="op" id="5126951">}</span>
</div>
</body>
</html>
