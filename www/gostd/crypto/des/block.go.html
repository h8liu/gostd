<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/des</h2>
<ul>
<li><a href="/gostd/crypto/des/block.go.html" class="current">block.go</a></li>
<li><a href="/gostd/crypto/des/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/des/const.go.html">const.go</a></li>
<li><a href="/gostd/crypto/des/des_test.go.html">des_test.go</a></li>
<li><a href="/gostd/crypto/des/example_test.go.html">example_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4473818">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4473873">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4473927">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4473978">package</span>&nbsp;<span class="ident" id="4473986">des</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4473991">import</span>&nbsp;<span class="op" id="4473998">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4474001">&#34;encoding/binary&#34;</span><br>
<span class="lineno"></span><span class="op" id="4474019">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4474022">func</span>&nbsp;<span class="ident" id="4474027">cryptBlock</span><span class="op" id="4474037">(</span><span class="ident" id="4474038">subkeys</span>&nbsp;<span class="op" id="4474046">[</span><span class="op" id="4474047">]</span><span class="ident" id="4474048">uint64</span><span class="op" id="4474054">,</span>&nbsp;<span class="ident" id="4474056">dst</span><span class="op" id="4474059">,</span>&nbsp;<span class="ident" id="4474061">src</span>&nbsp;<span class="op" id="4474065">[</span><span class="op" id="4474066">]</span><span class="builtintype" id="4474067">byte</span><span class="op" id="4474071">,</span>&nbsp;<span class="ident" id="4474073">decrypt</span>&nbsp;<span class="builtintype" id="4474081">bool</span><span class="op" id="4474085">)</span>&nbsp;<span class="op" id="4474087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4474090">b</span>&nbsp;<span class="op" id="4474092">:=</span>&nbsp;<span class="ident" id="4474095">binary</span><span class="op" id="4474101">.</span><span class="ident" id="4474102">BigEndian</span><span class="op" id="4474111">.</span><span class="ident" id="4474112">Uint64</span><span class="op" id="4474118">(</span><span class="ident" id="4474119">src</span><span class="op" id="4474122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4474125">b</span>&nbsp;<span class="op" id="4474127">=</span>&nbsp;<span class="ident" id="4474129">permuteInitialBlock</span><span class="op" id="4474148">(</span><span class="ident" id="4474149">b</span><span class="op" id="4474150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4474153">left</span><span class="op" id="4474157">,</span>&nbsp;<span class="ident" id="4474159">right</span>&nbsp;<span class="op" id="4474165">:=</span>&nbsp;<span class="builtintype" id="4474168">uint32</span><span class="op" id="4474174">(</span><span class="ident" id="4474175">b</span><span class="op" id="4474176">&gt;&gt;</span><span class="num" id="4474178">32</span><span class="op" id="4474180">)</span><span class="op" id="4474181">,</span>&nbsp;<span class="builtintype" id="4474183">uint32</span><span class="op" id="4474189">(</span><span class="ident" id="4474190">b</span><span class="op" id="4474191">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4474195">var</span>&nbsp;<span class="ident" id="4474199">subkey</span>&nbsp;<span class="ident" id="4474206">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4474214">for</span>&nbsp;<span class="ident" id="4474218">i</span>&nbsp;<span class="op" id="4474220">:=</span>&nbsp;<span class="num" id="4474223">0</span><span class="op" id="4474224">;</span>&nbsp;<span class="ident" id="4474226">i</span>&nbsp;<span class="op" id="4474228">&lt;</span>&nbsp;<span class="num" id="4474230">16</span><span class="op" id="4474232">;</span>&nbsp;<span class="ident" id="4474234">i</span><span class="op" id="4474235">++</span>&nbsp;<span class="op" id="4474238">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4474242">if</span>&nbsp;<span class="ident" id="4474245">decrypt</span>&nbsp;<span class="op" id="4474253">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4474258">subkey</span>&nbsp;<span class="op" id="4474265">=</span>&nbsp;<span class="ident" id="4474267">subkeys</span><span class="op" id="4474274">[</span><span class="num" id="4474275">15</span><span class="op" id="4474277">-</span><span class="ident" id="4474278">i</span><span class="op" id="4474279">]</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4474283">}</span>&nbsp;<span class="keyword" id="4474285">else</span>&nbsp;<span class="op" id="4474290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4474295">subkey</span>&nbsp;<span class="op" id="4474302">=</span>&nbsp;<span class="ident" id="4474304">subkeys</span><span class="op" id="4474311">[</span><span class="ident" id="4474312">i</span><span class="op" id="4474313">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4474317">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4474322">left</span><span class="op" id="4474326">,</span>&nbsp;<span class="ident" id="4474328">right</span>&nbsp;<span class="op" id="4474334">=</span>&nbsp;<span class="ident" id="4474336">right</span><span class="op" id="4474341">,</span>&nbsp;<span class="ident" id="4474343">left</span><span class="op" id="4474347">^</span><span class="ident" id="4474348">feistel</span><span class="op" id="4474355">(</span><span class="ident" id="4474356">right</span><span class="op" id="4474361">,</span>&nbsp;<span class="ident" id="4474363">subkey</span><span class="op" id="4474369">)</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4474372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4474375">//&nbsp;switch&nbsp;left&nbsp;&amp;&nbsp;right&nbsp;and&nbsp;perform&nbsp;final&nbsp;permutation</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4474429">preOutput</span>&nbsp;<span class="op" id="4474439">:=</span>&nbsp;<span class="op" id="4474442">(</span><span class="ident" id="4474443">uint64</span><span class="op" id="4474449">(</span><span class="ident" id="4474450">right</span><span class="op" id="4474455">)</span>&nbsp;<span class="op" id="4474457">&lt;&lt;</span>&nbsp;<span class="num" id="4474460">32</span><span class="op" id="4474462">)</span>&nbsp;<span class="op" id="4474464">|</span>&nbsp;<span class="ident" id="4474466">uint64</span><span class="op" id="4474472">(</span><span class="ident" id="4474473">left</span><span class="op" id="4474477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4474480">binary</span><span class="op" id="4474486">.</span><span class="ident" id="4474487">BigEndian</span><span class="op" id="4474496">.</span><span class="ident" id="4474497">PutUint64</span><span class="op" id="4474506">(</span><span class="ident" id="4474507">dst</span><span class="op" id="4474510">,</span>&nbsp;<span class="ident" id="4474512">permuteFinalBlock</span><span class="op" id="4474529">(</span><span class="ident" id="4474530">preOutput</span><span class="op" id="4474539">)</span><span class="op" id="4474540">)</span><br>
<span class="lineno"></span><span class="op" id="4474542">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4474545">//&nbsp;Encrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="4474604">func</span>&nbsp;<span class="ident" id="4474609">encryptBlock</span><span class="op" id="4474621">(</span><span class="ident" id="4474622">subkeys</span>&nbsp;<span class="op" id="4474630">[</span><span class="op" id="4474631">]</span><span class="ident" id="4474632">uint64</span><span class="op" id="4474638">,</span>&nbsp;<span class="ident" id="4474640">dst</span><span class="op" id="4474643">,</span>&nbsp;<span class="ident" id="4474645">src</span>&nbsp;<span class="op" id="4474649">[</span><span class="op" id="4474650">]</span><span class="builtintype" id="4474651">byte</span><span class="op" id="4474655">)</span>&nbsp;<span class="op" id="4474657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4474660">cryptBlock</span><span class="op" id="4474670">(</span><span class="ident" id="4474671">subkeys</span><span class="op" id="4474678">,</span>&nbsp;<span class="ident" id="4474680">dst</span><span class="op" id="4474683">,</span>&nbsp;<span class="ident" id="4474685">src</span><span class="op" id="4474688">,</span>&nbsp;<span class="builtintype" id="4474690">false</span><span class="op" id="4474695">)</span><br>
<span class="lineno"></span><span class="op" id="4474697">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="comment" id="4474700">//&nbsp;Decrypt&nbsp;one&nbsp;block&nbsp;from&nbsp;src&nbsp;into&nbsp;dst,&nbsp;using&nbsp;the&nbsp;subkeys.</span><br>
<span class="lineno"></span><span class="keyword" id="4474759">func</span>&nbsp;<span class="ident" id="4474764">decryptBlock</span><span class="op" id="4474776">(</span><span class="ident" id="4474777">subkeys</span>&nbsp;<span class="op" id="4474785">[</span><span class="op" id="4474786">]</span><span class="ident" id="4474787">uint64</span><span class="op" id="4474793">,</span>&nbsp;<span class="ident" id="4474795">dst</span><span class="op" id="4474798">,</span>&nbsp;<span class="ident" id="4474800">src</span>&nbsp;<span class="op" id="4474804">[</span><span class="op" id="4474805">]</span><span class="builtintype" id="4474806">byte</span><span class="op" id="4474810">)</span>&nbsp;<span class="op" id="4474812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4474815">cryptBlock</span><span class="op" id="4474825">(</span><span class="ident" id="4474826">subkeys</span><span class="op" id="4474833">,</span>&nbsp;<span class="ident" id="4474835">dst</span><span class="op" id="4474838">,</span>&nbsp;<span class="ident" id="4474840">src</span><span class="op" id="4474843">,</span>&nbsp;<span class="builtintype" id="4474845">true</span><span class="op" id="4474849">)</span><br>
<span class="lineno"></span><span class="op" id="4474851">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="4474854">//&nbsp;DES&nbsp;Feistel&nbsp;function</span><br>
<span class="lineno"></span><span class="keyword" id="4474878">func</span>&nbsp;<span class="ident" id="4474883">feistel</span><span class="op" id="4474890">(</span><span class="ident" id="4474891">right</span>&nbsp;<span class="builtintype" id="4474897">uint32</span><span class="op" id="4474903">,</span>&nbsp;<span class="ident" id="4474905">key</span>&nbsp;<span class="ident" id="4474909">uint64</span><span class="op" id="4474915">)</span>&nbsp;<span class="op" id="4474917">(</span><span class="ident" id="4474918">result</span>&nbsp;<span class="builtintype" id="4474925">uint32</span><span class="op" id="4474931">)</span>&nbsp;<span class="op" id="4474933">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4474936">sBoxLocations</span>&nbsp;<span class="op" id="4474950">:=</span>&nbsp;<span class="ident" id="4474953">key</span>&nbsp;<span class="op" id="4474957">^</span>&nbsp;<span class="ident" id="4474959">expandBlock</span><span class="op" id="4474970">(</span><span class="ident" id="4474971">right</span><span class="op" id="4474976">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4474979">var</span>&nbsp;<span class="ident" id="4474983">sBoxResult</span>&nbsp;<span class="builtintype" id="4474994">uint32</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4475002">for</span>&nbsp;<span class="ident" id="4475006">i</span>&nbsp;<span class="op" id="4475008">:=</span>&nbsp;<span class="builtintype" id="4475011">uint8</span><span class="op" id="4475016">(</span><span class="num" id="4475017">0</span><span class="op" id="4475018">)</span><span class="op" id="4475019">;</span>&nbsp;<span class="ident" id="4475021">i</span>&nbsp;<span class="op" id="4475023">&lt;</span>&nbsp;<span class="num" id="4475025">8</span><span class="op" id="4475026">;</span>&nbsp;<span class="ident" id="4475028">i</span><span class="op" id="4475029">++</span>&nbsp;<span class="op" id="4475032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4475036">sBoxLocation</span>&nbsp;<span class="op" id="4475049">:=</span>&nbsp;<span class="builtintype" id="4475052">uint8</span><span class="op" id="4475057">(</span><span class="ident" id="4475058">sBoxLocations</span><span class="op" id="4475071">&gt;&gt;</span><span class="num" id="4475073">42</span><span class="op" id="4475075">)</span>&nbsp;<span class="op" id="4475077">&amp;</span>&nbsp;<span class="num" id="4475079">0x3f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4475086">sBoxLocations</span>&nbsp;<span class="op" id="4475100">&lt;&lt;=</span>&nbsp;<span class="num" id="4475104">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4475108">//&nbsp;row&nbsp;determined&nbsp;by&nbsp;1st&nbsp;and&nbsp;6th&nbsp;bit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4475147">//&nbsp;column&nbsp;is&nbsp;middle&nbsp;four&nbsp;bits</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4475179">row</span>&nbsp;<span class="op" id="4475183">:=</span>&nbsp;<span class="op" id="4475186">(</span><span class="ident" id="4475187">sBoxLocation</span>&nbsp;<span class="op" id="4475200">&amp;</span>&nbsp;<span class="num" id="4475202">0x1</span><span class="op" id="4475205">)</span>&nbsp;<span class="op" id="4475207">|</span>&nbsp;<span class="op" id="4475209">(</span><span class="op" id="4475210">(</span><span class="ident" id="4475211">sBoxLocation</span>&nbsp;<span class="op" id="4475224">&amp;</span>&nbsp;<span class="num" id="4475226">0x20</span><span class="op" id="4475230">)</span>&nbsp;<span class="op" id="4475232">&gt;&gt;</span>&nbsp;<span class="num" id="4475235">4</span><span class="op" id="4475236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4475240">column</span>&nbsp;<span class="op" id="4475247">:=</span>&nbsp;<span class="op" id="4475250">(</span><span class="ident" id="4475251">sBoxLocation</span>&nbsp;<span class="op" id="4475264">&gt;&gt;</span>&nbsp;<span class="num" id="4475267">1</span><span class="op" id="4475268">)</span>&nbsp;<span class="op" id="4475270">&amp;</span>&nbsp;<span class="num" id="4475272">0xf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4475278">sBoxResult</span>&nbsp;<span class="op" id="4475289">^=</span>&nbsp;<span class="ident" id="4475292">feistelBox</span><span class="op" id="4475302">[</span><span class="ident" id="4475303">i</span><span class="op" id="4475304">]</span><span class="op" id="4475305">[</span><span class="num" id="4475306">16</span><span class="op" id="4475308">*</span><span class="ident" id="4475309">row</span><span class="op" id="4475312">+</span><span class="ident" id="4475313">column</span><span class="op" id="4475319">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4475322">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4475325">return</span>&nbsp;<span class="ident" id="4475332">sBoxResult</span><br>
<span class="lineno">55</span><span class="op" id="4475343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4475346">//&nbsp;feistelBox[s][16*i+j]&nbsp;contains&nbsp;the&nbsp;output&nbsp;of&nbsp;permutationFunction</span><br>
<span class="lineno"></span><span class="comment" id="4475414">//&nbsp;for&nbsp;sBoxes[s][i][j]&nbsp;&lt;&lt;&nbsp;4*(7-s)</span><br>
<span class="lineno"></span><span class="keyword" id="4475448">var</span>&nbsp;<span class="ident" id="4475452">feistelBox</span>&nbsp;<span class="op" id="4475463">[</span><span class="num" id="4475464">8</span><span class="op" id="4475465">]</span><span class="op" id="4475466">[</span><span class="num" id="4475467">64</span><span class="op" id="4475469">]</span><span class="builtintype" id="4475470">uint32</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="4475478">//&nbsp;general&nbsp;purpose&nbsp;function&nbsp;to&nbsp;perform&nbsp;DES&nbsp;block&nbsp;permutations</span><br>
<span class="lineno"></span><span class="keyword" id="4475540">func</span>&nbsp;<span class="ident" id="4475545">permuteBlock</span><span class="op" id="4475557">(</span><span class="ident" id="4475558">src</span>&nbsp;<span class="ident" id="4475562">uint64</span><span class="op" id="4475568">,</span>&nbsp;<span class="ident" id="4475570">permutation</span>&nbsp;<span class="op" id="4475582">[</span><span class="op" id="4475583">]</span><span class="builtintype" id="4475584">uint8</span><span class="op" id="4475589">)</span>&nbsp;<span class="op" id="4475591">(</span><span class="ident" id="4475592">block</span>&nbsp;<span class="ident" id="4475598">uint64</span><span class="op" id="4475604">)</span>&nbsp;<span class="op" id="4475606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4475609">for</span>&nbsp;<span class="ident" id="4475613">position</span><span class="op" id="4475621">,</span>&nbsp;<span class="ident" id="4475623">n</span>&nbsp;<span class="op" id="4475625">:=</span>&nbsp;<span class="keyword" id="4475628">range</span>&nbsp;<span class="ident" id="4475634">permutation</span>&nbsp;<span class="op" id="4475646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4475650">bit</span>&nbsp;<span class="op" id="4475654">:=</span>&nbsp;<span class="op" id="4475657">(</span><span class="ident" id="4475658">src</span>&nbsp;<span class="op" id="4475662">&gt;&gt;</span>&nbsp;<span class="ident" id="4475665">n</span><span class="op" id="4475666">)</span>&nbsp;<span class="op" id="4475668">&amp;</span>&nbsp;<span class="num" id="4475670">1</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4475674">block</span>&nbsp;<span class="op" id="4475680">|=</span>&nbsp;<span class="ident" id="4475683">bit</span>&nbsp;<span class="op" id="4475687">&lt;&lt;</span>&nbsp;<span class="builtintype" id="4475690">uint</span><span class="op" id="4475694">(</span><span class="op" id="4475695">(</span><span class="builtinfunc" id="4475696">len</span><span class="op" id="4475699">(</span><span class="ident" id="4475700">permutation</span><span class="op" id="4475711">)</span><span class="op" id="4475712">-</span><span class="num" id="4475713">1</span><span class="op" id="4475714">)</span><span class="op" id="4475715">-</span><span class="ident" id="4475716">position</span><span class="op" id="4475724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4475727">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4475730">return</span><br>
<span class="lineno"></span><span class="op" id="4475737">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="keyword" id="4475740">func</span>&nbsp;<span class="ident" id="4475745">init</span><span class="op" id="4475749">(</span><span class="op" id="4475750">)</span>&nbsp;<span class="op" id="4475752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4475755">for</span>&nbsp;<span class="ident" id="4475759">s</span>&nbsp;<span class="op" id="4475761">:=</span>&nbsp;<span class="keyword" id="4475764">range</span>&nbsp;<span class="ident" id="4475770">sBoxes</span>&nbsp;<span class="op" id="4475777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4475781">for</span>&nbsp;<span class="ident" id="4475785">i</span>&nbsp;<span class="op" id="4475787">:=</span>&nbsp;<span class="num" id="4475790">0</span><span class="op" id="4475791">;</span>&nbsp;<span class="ident" id="4475793">i</span>&nbsp;<span class="op" id="4475795">&lt;</span>&nbsp;<span class="num" id="4475797">4</span><span class="op" id="4475798">;</span>&nbsp;<span class="ident" id="4475800">i</span><span class="op" id="4475801">++</span>&nbsp;<span class="op" id="4475804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4475809">for</span>&nbsp;<span class="ident" id="4475813">j</span>&nbsp;<span class="op" id="4475815">:=</span>&nbsp;<span class="num" id="4475818">0</span><span class="op" id="4475819">;</span>&nbsp;<span class="ident" id="4475821">j</span>&nbsp;<span class="op" id="4475823">&lt;</span>&nbsp;<span class="num" id="4475825">16</span><span class="op" id="4475827">;</span>&nbsp;<span class="ident" id="4475829">j</span><span class="op" id="4475830">++</span>&nbsp;<span class="op" id="4475833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4475839">f</span>&nbsp;<span class="op" id="4475841">:=</span>&nbsp;<span class="ident" id="4475844">uint64</span><span class="op" id="4475850">(</span><span class="ident" id="4475851">sBoxes</span><span class="op" id="4475857">[</span><span class="ident" id="4475858">s</span><span class="op" id="4475859">]</span><span class="op" id="4475860">[</span><span class="ident" id="4475861">i</span><span class="op" id="4475862">]</span><span class="op" id="4475863">[</span><span class="ident" id="4475864">j</span><span class="op" id="4475865">]</span><span class="op" id="4475866">)</span>&nbsp;<span class="op" id="4475868">&lt;&lt;</span>&nbsp;<span class="op" id="4475871">(</span><span class="num" id="4475872">4</span>&nbsp;<span class="op" id="4475874">*</span>&nbsp;<span class="op" id="4475876">(</span><span class="num" id="4475877">7</span>&nbsp;<span class="op" id="4475879">-</span>&nbsp;<span class="builtintype" id="4475881">uint</span><span class="op" id="4475885">(</span><span class="ident" id="4475886">s</span><span class="op" id="4475887">)</span><span class="op" id="4475888">)</span><span class="op" id="4475889">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4475895">f</span>&nbsp;<span class="op" id="4475897">=</span>&nbsp;<span class="ident" id="4475899">permuteBlock</span><span class="op" id="4475911">(</span><span class="ident" id="4475912">uint64</span><span class="op" id="4475918">(</span><span class="ident" id="4475919">f</span><span class="op" id="4475920">)</span><span class="op" id="4475921">,</span>&nbsp;<span class="ident" id="4475923">permutationFunction</span><span class="op" id="4475942">[</span><span class="op" id="4475943">:</span><span class="op" id="4475944">]</span><span class="op" id="4475945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4475951">feistelBox</span><span class="op" id="4475961">[</span><span class="ident" id="4475962">s</span><span class="op" id="4475963">]</span><span class="op" id="4475964">[</span><span class="num" id="4475965">16</span><span class="op" id="4475967">*</span><span class="ident" id="4475968">i</span><span class="op" id="4475969">+</span><span class="ident" id="4475970">j</span><span class="op" id="4475971">]</span>&nbsp;<span class="op" id="4475973">=</span>&nbsp;<span class="builtintype" id="4475975">uint32</span><span class="op" id="4475981">(</span><span class="ident" id="4475982">f</span><span class="op" id="4475983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4475988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4475992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4475995">}</span><br>
<span class="lineno">80</span><span class="op" id="4475997">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4476000">//&nbsp;expandBlock&nbsp;expands&nbsp;an&nbsp;input&nbsp;block&nbsp;of&nbsp;32&nbsp;bits,</span><br>
<span class="lineno"></span><span class="comment" id="4476050">//&nbsp;producing&nbsp;an&nbsp;output&nbsp;block&nbsp;of&nbsp;48&nbsp;bits.</span><br>
<span class="lineno"></span><span class="keyword" id="4476091">func</span>&nbsp;<span class="ident" id="4476096">expandBlock</span><span class="op" id="4476107">(</span><span class="ident" id="4476108">src</span>&nbsp;<span class="builtintype" id="4476112">uint32</span><span class="op" id="4476118">)</span>&nbsp;<span class="op" id="4476120">(</span><span class="ident" id="4476121">block</span>&nbsp;<span class="ident" id="4476127">uint64</span><span class="op" id="4476133">)</span>&nbsp;<span class="op" id="4476135">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4476138">//&nbsp;rotate&nbsp;the&nbsp;5&nbsp;highest&nbsp;bits&nbsp;to&nbsp;the&nbsp;right.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4476182">src</span>&nbsp;<span class="op" id="4476186">=</span>&nbsp;<span class="op" id="4476188">(</span><span class="ident" id="4476189">src</span>&nbsp;<span class="op" id="4476193">&lt;&lt;</span>&nbsp;<span class="num" id="4476196">5</span><span class="op" id="4476197">)</span>&nbsp;<span class="op" id="4476199">|</span>&nbsp;<span class="op" id="4476201">(</span><span class="ident" id="4476202">src</span>&nbsp;<span class="op" id="4476206">&gt;&gt;</span>&nbsp;<span class="num" id="4476209">27</span><span class="op" id="4476211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4476214">for</span>&nbsp;<span class="ident" id="4476218">i</span>&nbsp;<span class="op" id="4476220">:=</span>&nbsp;<span class="num" id="4476223">0</span><span class="op" id="4476224">;</span>&nbsp;<span class="ident" id="4476226">i</span>&nbsp;<span class="op" id="4476228">&lt;</span>&nbsp;<span class="num" id="4476230">8</span><span class="op" id="4476231">;</span>&nbsp;<span class="ident" id="4476233">i</span><span class="op" id="4476234">++</span>&nbsp;<span class="op" id="4476237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4476241">block</span>&nbsp;<span class="op" id="4476247">&lt;&lt;=</span>&nbsp;<span class="num" id="4476251">6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4476255">//&nbsp;take&nbsp;the&nbsp;6&nbsp;bits&nbsp;on&nbsp;the&nbsp;right</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4476289">block</span>&nbsp;<span class="op" id="4476295">|=</span>&nbsp;<span class="ident" id="4476298">uint64</span><span class="op" id="4476304">(</span><span class="ident" id="4476305">src</span><span class="op" id="4476308">)</span>&nbsp;<span class="op" id="4476310">&amp;</span>&nbsp;<span class="op" id="4476312">(</span><span class="num" id="4476313">1</span><span class="op" id="4476314">&lt;&lt;</span><span class="num" id="4476316">6</span>&nbsp;<span class="op" id="4476318">-</span>&nbsp;<span class="num" id="4476320">1</span><span class="op" id="4476321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4476325">//&nbsp;advance&nbsp;by&nbsp;4&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4476349">src</span>&nbsp;<span class="op" id="4476353">=</span>&nbsp;<span class="op" id="4476355">(</span><span class="ident" id="4476356">src</span>&nbsp;<span class="op" id="4476360">&lt;&lt;</span>&nbsp;<span class="num" id="4476363">4</span><span class="op" id="4476364">)</span>&nbsp;<span class="op" id="4476366">|</span>&nbsp;<span class="op" id="4476368">(</span><span class="ident" id="4476369">src</span>&nbsp;<span class="op" id="4476373">&gt;&gt;</span>&nbsp;<span class="num" id="4476376">28</span><span class="op" id="4476378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4476381">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4476384">return</span><br>
<span class="lineno">95</span><span class="op" id="4476391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4476394">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4476458">//&nbsp;by&nbsp;initialPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="4476484">func</span>&nbsp;<span class="ident" id="4476489">permuteInitialBlock</span><span class="op" id="4476508">(</span><span class="ident" id="4476509">block</span>&nbsp;<span class="ident" id="4476515">uint64</span><span class="op" id="4476521">)</span>&nbsp;<span class="ident" id="4476523">uint64</span>&nbsp;<span class="op" id="4476530">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4476533">//&nbsp;block&nbsp;=&nbsp;b7&nbsp;b6&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b1&nbsp;b0&nbsp;(8&nbsp;bytes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4476579">b1</span>&nbsp;<span class="op" id="4476582">:=</span>&nbsp;<span class="ident" id="4476585">block</span>&nbsp;<span class="op" id="4476591">&gt;&gt;</span>&nbsp;<span class="num" id="4476594">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4476598">b2</span>&nbsp;<span class="op" id="4476601">:=</span>&nbsp;<span class="ident" id="4476604">block</span>&nbsp;<span class="op" id="4476610">&lt;&lt;</span>&nbsp;<span class="num" id="4476613">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4476617">block</span>&nbsp;<span class="op" id="4476623">^=</span>&nbsp;<span class="ident" id="4476626">b1</span>&nbsp;<span class="op" id="4476629">^</span>&nbsp;<span class="ident" id="4476631">b2</span>&nbsp;<span class="op" id="4476634">^</span>&nbsp;<span class="ident" id="4476636">b1</span><span class="op" id="4476638">&lt;&lt;</span><span class="num" id="4476640">48</span>&nbsp;<span class="op" id="4476643">^</span>&nbsp;<span class="ident" id="4476645">b2</span><span class="op" id="4476647">&gt;&gt;</span><span class="num" id="4476649">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4476654">//&nbsp;block&nbsp;=&nbsp;b1&nbsp;b0&nbsp;b5&nbsp;b4&nbsp;b3&nbsp;b2&nbsp;b7&nbsp;b6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4476690">b1</span>&nbsp;<span class="op" id="4476693">=</span>&nbsp;<span class="ident" id="4476695">block</span>&nbsp;<span class="op" id="4476701">&gt;&gt;</span>&nbsp;<span class="num" id="4476704">32</span>&nbsp;<span class="op" id="4476707">&amp;</span>&nbsp;<span class="num" id="4476709">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4476719">b2</span>&nbsp;<span class="op" id="4476722">=</span>&nbsp;<span class="op" id="4476724">(</span><span class="ident" id="4476725">block</span>&nbsp;<span class="op" id="4476731">&amp;</span>&nbsp;<span class="num" id="4476733">0xff00ff00</span><span class="op" id="4476743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4476746">block</span>&nbsp;<span class="op" id="4476752">^=</span>&nbsp;<span class="ident" id="4476755">b1</span><span class="op" id="4476757">&lt;&lt;</span><span class="num" id="4476759">32</span>&nbsp;<span class="op" id="4476762">^</span>&nbsp;<span class="ident" id="4476764">b2</span>&nbsp;<span class="op" id="4476767">^</span>&nbsp;<span class="ident" id="4476769">b1</span><span class="op" id="4476771">&lt;&lt;</span><span class="num" id="4476773">8</span>&nbsp;<span class="op" id="4476775">^</span>&nbsp;<span class="ident" id="4476777">b2</span><span class="op" id="4476779">&lt;&lt;</span><span class="num" id="4476781">24</span>&nbsp;<span class="comment" id="4476784">//&nbsp;exchange&nbsp;b0&nbsp;b4&nbsp;with&nbsp;b3&nbsp;b7</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4476815">//&nbsp;block&nbsp;is&nbsp;now&nbsp;b1&nbsp;b3&nbsp;b5&nbsp;b7&nbsp;b0&nbsp;b2&nbsp;b4&nbsp;b7,&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4476874">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4476902">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4476930">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4476958">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;56</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4476986">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477014">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20&nbsp;19&nbsp;18&nbsp;17&nbsp;16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477042">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477070">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...&nbsp;48</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477099">//&nbsp;exchange&nbsp;4,5,6,7&nbsp;with&nbsp;32,33,34,35&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4477142">b1</span>&nbsp;<span class="op" id="4477145">=</span>&nbsp;<span class="ident" id="4477147">block</span>&nbsp;<span class="op" id="4477153">&amp;</span>&nbsp;<span class="num" id="4477155">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4477175">b2</span>&nbsp;<span class="op" id="4477178">=</span>&nbsp;<span class="ident" id="4477180">block</span>&nbsp;<span class="op" id="4477186">&amp;</span>&nbsp;<span class="num" id="4477188">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4477208">block</span>&nbsp;<span class="op" id="4477214">^=</span>&nbsp;<span class="ident" id="4477217">b1</span>&nbsp;<span class="op" id="4477220">^</span>&nbsp;<span class="ident" id="4477222">b2</span>&nbsp;<span class="op" id="4477225">^</span>&nbsp;<span class="ident" id="4477227">b1</span><span class="op" id="4477229">&gt;&gt;</span><span class="num" id="4477231">12</span>&nbsp;<span class="op" id="4477234">^</span>&nbsp;<span class="ident" id="4477236">b2</span><span class="op" id="4477238">&lt;&lt;</span><span class="num" id="4477240">12</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477245">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477275">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477279">//&nbsp;&nbsp;&nbsp;[+8]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[+40]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477304">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477308">//&nbsp;&nbsp;7&nbsp;&nbsp;6&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477324">//&nbsp;23&nbsp;22&nbsp;21&nbsp;20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477340">//&nbsp;&nbsp;3&nbsp;&nbsp;2&nbsp;&nbsp;1&nbsp;&nbsp;0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477356">//&nbsp;19&nbsp;18&nbsp;17&nbsp;16&nbsp;&nbsp;&nbsp;&nbsp;[+32]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477382">//&nbsp;exchange&nbsp;0,1,4,5&nbsp;with&nbsp;18,19,22,23</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4477420">b1</span>&nbsp;<span class="op" id="4477423">=</span>&nbsp;<span class="ident" id="4477425">block</span>&nbsp;<span class="op" id="4477431">&amp;</span>&nbsp;<span class="num" id="4477433">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4477453">b2</span>&nbsp;<span class="op" id="4477456">=</span>&nbsp;<span class="ident" id="4477458">block</span>&nbsp;<span class="op" id="4477464">&amp;</span>&nbsp;<span class="num" id="4477466">0x00cc00cc00cc00cc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4477486">block</span>&nbsp;<span class="op" id="4477492">^=</span>&nbsp;<span class="ident" id="4477495">b1</span>&nbsp;<span class="op" id="4477498">^</span>&nbsp;<span class="ident" id="4477500">b2</span>&nbsp;<span class="op" id="4477503">^</span>&nbsp;<span class="ident" id="4477505">b1</span><span class="op" id="4477507">&gt;&gt;</span><span class="num" id="4477509">6</span>&nbsp;<span class="op" id="4477511">^</span>&nbsp;<span class="ident" id="4477513">b2</span><span class="op" id="4477515">&lt;&lt;</span><span class="num" id="4477517">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477521">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477551">//&nbsp;15&nbsp;14</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477561">//&nbsp;13&nbsp;12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477571">//&nbsp;11&nbsp;10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477581">//&nbsp;&nbsp;9&nbsp;&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477591">//&nbsp;&nbsp;7&nbsp;&nbsp;6</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477601">//&nbsp;&nbsp;5&nbsp;&nbsp;4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477611">//&nbsp;&nbsp;3&nbsp;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477621">//&nbsp;&nbsp;1&nbsp;&nbsp;0&nbsp;[+16]&nbsp;[+32]&nbsp;[+64]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477650">//&nbsp;exchange&nbsp;0,2,4,6&nbsp;with&nbsp;9,11,13,15:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4477688">b1</span>&nbsp;<span class="op" id="4477691">=</span>&nbsp;<span class="ident" id="4477693">block</span>&nbsp;<span class="op" id="4477699">&amp;</span>&nbsp;<span class="num" id="4477701">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4477721">block</span>&nbsp;<span class="op" id="4477727">^=</span>&nbsp;<span class="ident" id="4477730">b1</span>&nbsp;<span class="op" id="4477733">^</span>&nbsp;<span class="ident" id="4477735">b1</span><span class="op" id="4477737">&gt;&gt;</span><span class="num" id="4477739">33</span>&nbsp;<span class="op" id="4477742">^</span>&nbsp;<span class="ident" id="4477744">b1</span><span class="op" id="4477746">&lt;&lt;</span><span class="num" id="4477748">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477753">//&nbsp;block&nbsp;is&nbsp;the&nbsp;permutation:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477783">//&nbsp;6&nbsp;14&nbsp;22&nbsp;30&nbsp;38&nbsp;46&nbsp;54&nbsp;62</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477810">//&nbsp;4&nbsp;12&nbsp;20&nbsp;28&nbsp;36&nbsp;44&nbsp;52&nbsp;60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477837">//&nbsp;2&nbsp;10&nbsp;18&nbsp;26&nbsp;34&nbsp;42&nbsp;50&nbsp;58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477864">//&nbsp;0&nbsp;&nbsp;8&nbsp;16&nbsp;24&nbsp;32&nbsp;40&nbsp;48&nbsp;56</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477891">//&nbsp;7&nbsp;15&nbsp;23&nbsp;31&nbsp;39&nbsp;47&nbsp;55&nbsp;63</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477918">//&nbsp;5&nbsp;13&nbsp;21&nbsp;29&nbsp;37&nbsp;45&nbsp;53&nbsp;61</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477945">//&nbsp;3&nbsp;11&nbsp;19&nbsp;27&nbsp;35&nbsp;43&nbsp;51&nbsp;59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4477972">//&nbsp;1&nbsp;&nbsp;9&nbsp;17&nbsp;25&nbsp;33&nbsp;41&nbsp;49&nbsp;57</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4477999">return</span>&nbsp;<span class="ident" id="4478006">block</span><br>
<span class="lineno"></span><span class="op" id="4478012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="comment" id="4478015">//&nbsp;permuteInitialBlock&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;the&nbsp;permutation&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="4478079">//&nbsp;by&nbsp;finalPermutation.</span><br>
<span class="lineno"></span><span class="keyword" id="4478103">func</span>&nbsp;<span class="ident" id="4478108">permuteFinalBlock</span><span class="op" id="4478125">(</span><span class="ident" id="4478126">block</span>&nbsp;<span class="ident" id="4478132">uint64</span><span class="op" id="4478138">)</span>&nbsp;<span class="ident" id="4478140">uint64</span>&nbsp;<span class="op" id="4478147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4478150">//&nbsp;Perform&nbsp;the&nbsp;same&nbsp;bit&nbsp;exchanges&nbsp;as&nbsp;permuteInitialBlock</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4478208">//&nbsp;but&nbsp;in&nbsp;reverse&nbsp;order.</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4478234">b1</span>&nbsp;<span class="op" id="4478237">:=</span>&nbsp;<span class="ident" id="4478240">block</span>&nbsp;<span class="op" id="4478246">&amp;</span>&nbsp;<span class="num" id="4478248">0xaaaaaaaa55555555</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4478268">block</span>&nbsp;<span class="op" id="4478274">^=</span>&nbsp;<span class="ident" id="4478277">b1</span>&nbsp;<span class="op" id="4478280">^</span>&nbsp;<span class="ident" id="4478282">b1</span><span class="op" id="4478284">&gt;&gt;</span><span class="num" id="4478286">33</span>&nbsp;<span class="op" id="4478289">^</span>&nbsp;<span class="ident" id="4478291">b1</span><span class="op" id="4478293">&lt;&lt;</span><span class="num" id="4478295">33</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4478300">b1</span>&nbsp;<span class="op" id="4478303">=</span>&nbsp;<span class="ident" id="4478305">block</span>&nbsp;<span class="op" id="4478311">&amp;</span>&nbsp;<span class="num" id="4478313">0x3300330033003300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4478333">b2</span>&nbsp;<span class="op" id="4478336">:=</span>&nbsp;<span class="ident" id="4478339">block</span>&nbsp;<span class="op" id="4478345">&amp;</span>&nbsp;<span class="num" id="4478347">0x00cc00cc00cc00cc</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4478367">block</span>&nbsp;<span class="op" id="4478373">^=</span>&nbsp;<span class="ident" id="4478376">b1</span>&nbsp;<span class="op" id="4478379">^</span>&nbsp;<span class="ident" id="4478381">b2</span>&nbsp;<span class="op" id="4478384">^</span>&nbsp;<span class="ident" id="4478386">b1</span><span class="op" id="4478388">&gt;&gt;</span><span class="num" id="4478390">6</span>&nbsp;<span class="op" id="4478392">^</span>&nbsp;<span class="ident" id="4478394">b2</span><span class="op" id="4478396">&lt;&lt;</span><span class="num" id="4478398">6</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4478402">b1</span>&nbsp;<span class="op" id="4478405">=</span>&nbsp;<span class="ident" id="4478407">block</span>&nbsp;<span class="op" id="4478413">&amp;</span>&nbsp;<span class="num" id="4478415">0x0f0f00000f0f0000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4478435">b2</span>&nbsp;<span class="op" id="4478438">=</span>&nbsp;<span class="ident" id="4478440">block</span>&nbsp;<span class="op" id="4478446">&amp;</span>&nbsp;<span class="num" id="4478448">0x0000f0f00000f0f0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4478468">block</span>&nbsp;<span class="op" id="4478474">^=</span>&nbsp;<span class="ident" id="4478477">b1</span>&nbsp;<span class="op" id="4478480">^</span>&nbsp;<span class="ident" id="4478482">b2</span>&nbsp;<span class="op" id="4478485">^</span>&nbsp;<span class="ident" id="4478487">b1</span><span class="op" id="4478489">&gt;&gt;</span><span class="num" id="4478491">12</span>&nbsp;<span class="op" id="4478494">^</span>&nbsp;<span class="ident" id="4478496">b2</span><span class="op" id="4478498">&lt;&lt;</span><span class="num" id="4478500">12</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4478505">b1</span>&nbsp;<span class="op" id="4478508">=</span>&nbsp;<span class="ident" id="4478510">block</span>&nbsp;<span class="op" id="4478516">&gt;&gt;</span>&nbsp;<span class="num" id="4478519">32</span>&nbsp;<span class="op" id="4478522">&amp;</span>&nbsp;<span class="num" id="4478524">0xff00ff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4478534">b2</span>&nbsp;<span class="op" id="4478537">=</span>&nbsp;<span class="op" id="4478539">(</span><span class="ident" id="4478540">block</span>&nbsp;<span class="op" id="4478546">&amp;</span>&nbsp;<span class="num" id="4478548">0xff00ff00</span><span class="op" id="4478558">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4478561">block</span>&nbsp;<span class="op" id="4478567">^=</span>&nbsp;<span class="ident" id="4478570">b1</span><span class="op" id="4478572">&lt;&lt;</span><span class="num" id="4478574">32</span>&nbsp;<span class="op" id="4478577">^</span>&nbsp;<span class="ident" id="4478579">b2</span>&nbsp;<span class="op" id="4478582">^</span>&nbsp;<span class="ident" id="4478584">b1</span><span class="op" id="4478586">&lt;&lt;</span><span class="num" id="4478588">8</span>&nbsp;<span class="op" id="4478590">^</span>&nbsp;<span class="ident" id="4478592">b2</span><span class="op" id="4478594">&lt;&lt;</span><span class="num" id="4478596">24</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4478601">b1</span>&nbsp;<span class="op" id="4478604">=</span>&nbsp;<span class="ident" id="4478606">block</span>&nbsp;<span class="op" id="4478612">&gt;&gt;</span>&nbsp;<span class="num" id="4478615">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4478619">b2</span>&nbsp;<span class="op" id="4478622">=</span>&nbsp;<span class="ident" id="4478624">block</span>&nbsp;<span class="op" id="4478630">&lt;&lt;</span>&nbsp;<span class="num" id="4478633">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4478637">block</span>&nbsp;<span class="op" id="4478643">^=</span>&nbsp;<span class="ident" id="4478646">b1</span>&nbsp;<span class="op" id="4478649">^</span>&nbsp;<span class="ident" id="4478651">b2</span>&nbsp;<span class="op" id="4478654">^</span>&nbsp;<span class="ident" id="4478656">b1</span><span class="op" id="4478658">&lt;&lt;</span><span class="num" id="4478660">48</span>&nbsp;<span class="op" id="4478663">^</span>&nbsp;<span class="ident" id="4478665">b2</span><span class="op" id="4478667">&gt;&gt;</span><span class="num" id="4478669">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4478673">return</span>&nbsp;<span class="ident" id="4478680">block</span><br>
<span class="lineno"></span><span class="op" id="4478686">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="4478689">//&nbsp;creates&nbsp;16&nbsp;28-bit&nbsp;blocks&nbsp;rotated&nbsp;according</span><br>
<span class="lineno"></span><span class="comment" id="4478735">//&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span><span class="keyword" id="4478763">func</span>&nbsp;<span class="ident" id="4478768">ksRotate</span><span class="op" id="4478776">(</span><span class="ident" id="4478777">in</span>&nbsp;<span class="builtintype" id="4478780">uint32</span><span class="op" id="4478786">)</span>&nbsp;<span class="op" id="4478788">(</span><span class="ident" id="4478789">out</span>&nbsp;<span class="op" id="4478793">[</span><span class="op" id="4478794">]</span><span class="builtintype" id="4478795">uint32</span><span class="op" id="4478801">)</span>&nbsp;<span class="op" id="4478803">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4478806">out</span>&nbsp;<span class="op" id="4478810">=</span>&nbsp;<span class="builtinfunc" id="4478812">make</span><span class="op" id="4478816">(</span><span class="op" id="4478817">[</span><span class="op" id="4478818">]</span><span class="builtintype" id="4478819">uint32</span><span class="op" id="4478825">,</span>&nbsp;<span class="num" id="4478827">16</span><span class="op" id="4478829">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4478832">last</span>&nbsp;<span class="op" id="4478837">:=</span>&nbsp;<span class="ident" id="4478840">in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4478844">for</span>&nbsp;<span class="ident" id="4478848">i</span>&nbsp;<span class="op" id="4478850">:=</span>&nbsp;<span class="num" id="4478853">0</span><span class="op" id="4478854">;</span>&nbsp;<span class="ident" id="4478856">i</span>&nbsp;<span class="op" id="4478858">&lt;</span>&nbsp;<span class="num" id="4478860">16</span><span class="op" id="4478862">;</span>&nbsp;<span class="ident" id="4478864">i</span><span class="op" id="4478865">++</span>&nbsp;<span class="op" id="4478868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4478872">//&nbsp;28-bit&nbsp;circular&nbsp;left&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4478904">left</span>&nbsp;<span class="op" id="4478909">:=</span>&nbsp;<span class="op" id="4478912">(</span><span class="ident" id="4478913">last</span>&nbsp;<span class="op" id="4478918">&lt;&lt;</span>&nbsp;<span class="op" id="4478921">(</span><span class="num" id="4478922">4</span>&nbsp;<span class="op" id="4478924">+</span>&nbsp;<span class="ident" id="4478926">ksRotations</span><span class="op" id="4478937">[</span><span class="ident" id="4478938">i</span><span class="op" id="4478939">]</span><span class="op" id="4478940">)</span><span class="op" id="4478941">)</span>&nbsp;<span class="op" id="4478943">&gt;&gt;</span>&nbsp;<span class="num" id="4478946">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4478950">right</span>&nbsp;<span class="op" id="4478956">:=</span>&nbsp;<span class="op" id="4478959">(</span><span class="ident" id="4478960">last</span>&nbsp;<span class="op" id="4478965">&lt;&lt;</span>&nbsp;<span class="num" id="4478968">4</span><span class="op" id="4478969">)</span>&nbsp;<span class="op" id="4478971">&gt;&gt;</span>&nbsp;<span class="op" id="4478974">(</span><span class="num" id="4478975">32</span>&nbsp;<span class="op" id="4478978">-</span>&nbsp;<span class="ident" id="4478980">ksRotations</span><span class="op" id="4478991">[</span><span class="ident" id="4478992">i</span><span class="op" id="4478993">]</span><span class="op" id="4478994">)</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4478998">out</span><span class="op" id="4479001">[</span><span class="ident" id="4479002">i</span><span class="op" id="4479003">]</span>&nbsp;<span class="op" id="4479005">=</span>&nbsp;<span class="ident" id="4479007">left</span>&nbsp;<span class="op" id="4479012">|</span>&nbsp;<span class="ident" id="4479014">right</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4479022">last</span>&nbsp;<span class="op" id="4479027">=</span>&nbsp;<span class="ident" id="4479029">out</span><span class="op" id="4479032">[</span><span class="ident" id="4479033">i</span><span class="op" id="4479034">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4479037">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4479040">return</span><br>
<span class="lineno"></span><span class="op" id="4479047">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="4479050">//&nbsp;creates&nbsp;16&nbsp;56-bit&nbsp;subkeys&nbsp;from&nbsp;the&nbsp;original&nbsp;key</span><br>
<span class="lineno"></span><span class="keyword" id="4479101">func</span>&nbsp;<span class="op" id="4479106">(</span><span class="ident" id="4479107">c</span>&nbsp;<span class="op" id="4479109">*</span><span class="ident" id="4479110">desCipher</span><span class="op" id="4479119">)</span>&nbsp;<span class="ident" id="4479121">generateSubkeys</span><span class="op" id="4479136">(</span><span class="ident" id="4479137">keyBytes</span>&nbsp;<span class="op" id="4479146">[</span><span class="op" id="4479147">]</span><span class="builtintype" id="4479148">byte</span><span class="op" id="4479152">)</span>&nbsp;<span class="op" id="4479154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4479157">//&nbsp;apply&nbsp;PC1&nbsp;permutation&nbsp;to&nbsp;key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4479190">key</span>&nbsp;<span class="op" id="4479194">:=</span>&nbsp;<span class="ident" id="4479197">binary</span><span class="op" id="4479203">.</span><span class="ident" id="4479204">BigEndian</span><span class="op" id="4479213">.</span><span class="ident" id="4479214">Uint64</span><span class="op" id="4479220">(</span><span class="ident" id="4479221">keyBytes</span><span class="op" id="4479229">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4479232">permutedKey</span>&nbsp;<span class="op" id="4479244">:=</span>&nbsp;<span class="ident" id="4479247">permuteBlock</span><span class="op" id="4479259">(</span><span class="ident" id="4479260">key</span><span class="op" id="4479263">,</span>&nbsp;<span class="ident" id="4479265">permutedChoice1</span><span class="op" id="4479280">[</span><span class="op" id="4479281">:</span><span class="op" id="4479282">]</span><span class="op" id="4479283">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4479287">//&nbsp;rotate&nbsp;halves&nbsp;of&nbsp;permuted&nbsp;key&nbsp;according&nbsp;to&nbsp;the&nbsp;rotation&nbsp;schedule</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4479356">leftRotations</span>&nbsp;<span class="op" id="4479370">:=</span>&nbsp;<span class="ident" id="4479373">ksRotate</span><span class="op" id="4479381">(</span><span class="builtintype" id="4479382">uint32</span><span class="op" id="4479388">(</span><span class="ident" id="4479389">permutedKey</span>&nbsp;<span class="op" id="4479401">&gt;&gt;</span>&nbsp;<span class="num" id="4479404">28</span><span class="op" id="4479406">)</span><span class="op" id="4479407">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4479410">rightRotations</span>&nbsp;<span class="op" id="4479425">:=</span>&nbsp;<span class="ident" id="4479428">ksRotate</span><span class="op" id="4479436">(</span><span class="builtintype" id="4479437">uint32</span><span class="op" id="4479443">(</span><span class="ident" id="4479444">permutedKey</span><span class="op" id="4479455">&lt;&lt;</span><span class="num" id="4479457">4</span><span class="op" id="4479458">)</span>&nbsp;<span class="op" id="4479460">&gt;&gt;</span>&nbsp;<span class="num" id="4479463">4</span><span class="op" id="4479464">)</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4479468">//&nbsp;generate&nbsp;subkeys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4479489">for</span>&nbsp;<span class="ident" id="4479493">i</span>&nbsp;<span class="op" id="4479495">:=</span>&nbsp;<span class="num" id="4479498">0</span><span class="op" id="4479499">;</span>&nbsp;<span class="ident" id="4479501">i</span>&nbsp;<span class="op" id="4479503">&lt;</span>&nbsp;<span class="num" id="4479505">16</span><span class="op" id="4479507">;</span>&nbsp;<span class="ident" id="4479509">i</span><span class="op" id="4479510">++</span>&nbsp;<span class="op" id="4479513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4479517">//&nbsp;combine&nbsp;halves&nbsp;to&nbsp;form&nbsp;56-bit&nbsp;input&nbsp;to&nbsp;PC2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4479565">pc2Input</span>&nbsp;<span class="op" id="4479574">:=</span>&nbsp;<span class="ident" id="4479577">uint64</span><span class="op" id="4479583">(</span><span class="ident" id="4479584">leftRotations</span><span class="op" id="4479597">[</span><span class="ident" id="4479598">i</span><span class="op" id="4479599">]</span><span class="op" id="4479600">)</span><span class="op" id="4479601">&lt;&lt;</span><span class="num" id="4479603">28</span>&nbsp;<span class="op" id="4479606">|</span>&nbsp;<span class="ident" id="4479608">uint64</span><span class="op" id="4479614">(</span><span class="ident" id="4479615">rightRotations</span><span class="op" id="4479629">[</span><span class="ident" id="4479630">i</span><span class="op" id="4479631">]</span><span class="op" id="4479632">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4479636">//&nbsp;apply&nbsp;PC2&nbsp;permutation&nbsp;to&nbsp;7&nbsp;byte&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4479679">c</span><span class="op" id="4479680">.</span><span class="ident" id="4479681">subkeys</span><span class="op" id="4479688">[</span><span class="ident" id="4479689">i</span><span class="op" id="4479690">]</span>&nbsp;<span class="op" id="4479692">=</span>&nbsp;<span class="ident" id="4479694">permuteBlock</span><span class="op" id="4479706">(</span><span class="ident" id="4479707">pc2Input</span><span class="op" id="4479715">,</span>&nbsp;<span class="ident" id="4479717">permutedChoice2</span><span class="op" id="4479732">[</span><span class="op" id="4479733">:</span><span class="op" id="4479734">]</span><span class="op" id="4479735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4479738">}</span><br>
<span class="lineno"></span><span class="op" id="4479740">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
