<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4286990">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4287045">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4287099">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4287150">package</span>&nbsp;<span class="ident" id="4287158">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4287164">//&nbsp;RFC&nbsp;1423&nbsp;describes&nbsp;the&nbsp;encryption&nbsp;of&nbsp;PEM&nbsp;blocks.&nbsp;The&nbsp;algorithm&nbsp;used&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4287238">//&nbsp;generate&nbsp;a&nbsp;key&nbsp;from&nbsp;the&nbsp;password&nbsp;was&nbsp;derived&nbsp;by&nbsp;looking&nbsp;at&nbsp;the&nbsp;OpenSSL</span><br>
<span class="lineno"></span><span class="comment" id="4287312">//&nbsp;implementation.</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="keyword" id="4287332">import</span>&nbsp;<span class="op" id="4287339">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4287342">&#34;crypto/aes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4287356">&#34;crypto/cipher&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4287373">&#34;crypto/des&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4287387">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4287401">&#34;encoding/hex&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4287417">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4287433">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4287443">&#34;io&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4287449">&#34;strings&#34;</span><br>
<span class="lineno"></span><span class="op" id="4287459">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4287462">type</span>&nbsp;<span class="ident" id="4287467">PEMCipher</span>&nbsp;<span class="builtintype" id="4287477">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="4287482">//&nbsp;Possible&nbsp;values&nbsp;for&nbsp;the&nbsp;EncryptPEMBlock&nbsp;encryption&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="4287547">const</span>&nbsp;<span class="op" id="4287553">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4287556">_</span>&nbsp;<span class="ident" id="4287558"><a href="/crypto/x509/pem_decrypt.go.html#4287467">PEMCipher</a></span>&nbsp;<span class="op" id="4287568">=</span>&nbsp;<span class="ident" id="4287570">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4287576">PEMCipherDES</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4287590">PEMCipher3DES</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4287605">PEMCipherAES128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4287622">PEMCipherAES192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4287639">PEMCipherAES256</span><br>
<span class="lineno"></span><span class="op" id="4287655">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="4287658">//&nbsp;rfc1423Algo&nbsp;holds&nbsp;a&nbsp;method&nbsp;for&nbsp;enciphering&nbsp;a&nbsp;PEM&nbsp;block.</span><br>
<span class="lineno"></span><span class="keyword" id="4287717">type</span>&nbsp;<span class="ident" id="4287722">rfc1423Algo</span>&nbsp;<span class="keyword" id="4287734">struct</span>&nbsp;<span class="op" id="4287741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4287744">cipher</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4287755"><a href="/crypto/x509/pem_decrypt.go.html#4287467">PEMCipher</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4287766">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4287777">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4287785">cipherFunc</span>&nbsp;<span class="keyword" id="4287796">func</span><span class="op" id="4287800">(</span><span class="ident" id="4287801">key</span>&nbsp;<span class="op" id="4287805">[</span><span class="op" id="4287806">]</span><span class="builtintype" id="4287807">byte</span><span class="op" id="4287811">)</span>&nbsp;<span class="op" id="4287813">(</span><span class="ident" id="4287814"><a href="/crypto/x509/pem_decrypt.go.html#4287356">cipher</a></span><span class="op" id="4287820">.</span><span class="ident" id="4287821">Block</span><span class="op" id="4287826">,</span>&nbsp;<span class="builtintype" id="4287828">error</span><span class="op" id="4287833">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4287836">keySize</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4287847">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4287852">blockSize</span>&nbsp;&nbsp;<span class="builtintype" id="4287863">int</span><br>
<span class="lineno"></span><span class="op" id="4287867">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4287870">//&nbsp;rfc1423Algos&nbsp;holds&nbsp;a&nbsp;slice&nbsp;of&nbsp;the&nbsp;possible&nbsp;ways&nbsp;to&nbsp;encrypt&nbsp;a&nbsp;PEM</span><br>
<span class="lineno">45</span><span class="comment" id="4287938">//&nbsp;block.&nbsp;&nbsp;The&nbsp;ivSize&nbsp;numbers&nbsp;were&nbsp;taken&nbsp;from&nbsp;the&nbsp;OpenSSL&nbsp;source.</span><br>
<span class="lineno"></span><span class="keyword" id="4288004">var</span>&nbsp;<span class="ident" id="4288008">rfc1423Algos</span>&nbsp;<span class="op" id="4288021">=</span>&nbsp;<span class="op" id="4288023">[</span><span class="op" id="4288024">]</span><span class="ident" id="4288025"><a href="/crypto/x509/pem_decrypt.go.html#4287722">rfc1423Algo</a></span><span class="op" id="4288036">{</span><span class="op" id="4288037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288040">cipher</span><span class="op" id="4288046">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4288052"><a href="/crypto/x509/pem_decrypt.go.html#4287576">PEMCipherDES</a></span><span class="op" id="4288064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288067">name</span><span class="op" id="4288071">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4288079">&#34;DES-CBC&#34;</span><span class="op" id="4288088">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288091">cipherFunc</span><span class="op" id="4288101">:</span>&nbsp;<span class="ident" id="4288103"><a href="/crypto/x509/pem_decrypt.go.html#4287373">des</a></span><span class="op" id="4288106">.</span><span class="ident" id="4288107">NewCipher</span><span class="op" id="4288116">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288119">keySize</span><span class="op" id="4288126">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4288131">8</span><span class="op" id="4288132">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288135">blockSize</span><span class="op" id="4288144">:</span>&nbsp;&nbsp;<span class="ident" id="4288147"><a href="/crypto/x509/pem_decrypt.go.html#4287373">des</a></span><span class="op" id="4288150">.</span><span class="ident" id="4288151">BlockSize</span><span class="op" id="4288160">,</span><br>
<span class="lineno"></span><span class="op" id="4288162">}</span><span class="op" id="4288163">,</span>&nbsp;<span class="op" id="4288165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288168">cipher</span><span class="op" id="4288174">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4288180"><a href="/crypto/x509/pem_decrypt.go.html#4287590">PEMCipher3DES</a></span><span class="op" id="4288193">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288196">name</span><span class="op" id="4288200">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4288208">&#34;DES-EDE3-CBC&#34;</span><span class="op" id="4288222">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288225">cipherFunc</span><span class="op" id="4288235">:</span>&nbsp;<span class="ident" id="4288237"><a href="/crypto/x509/pem_decrypt.go.html#4287373">des</a></span><span class="op" id="4288240">.</span><span class="ident" id="4288241">NewTripleDESCipher</span><span class="op" id="4288259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288262">keySize</span><span class="op" id="4288269">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4288274">24</span><span class="op" id="4288276">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288279">blockSize</span><span class="op" id="4288288">:</span>&nbsp;&nbsp;<span class="ident" id="4288291"><a href="/crypto/x509/pem_decrypt.go.html#4287373">des</a></span><span class="op" id="4288294">.</span><span class="ident" id="4288295">BlockSize</span><span class="op" id="4288304">,</span><br>
<span class="lineno"></span><span class="op" id="4288306">}</span><span class="op" id="4288307">,</span>&nbsp;<span class="op" id="4288309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288312">cipher</span><span class="op" id="4288318">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4288324"><a href="/crypto/x509/pem_decrypt.go.html#4287605">PEMCipherAES128</a></span><span class="op" id="4288339">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288342">name</span><span class="op" id="4288346">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4288354">&#34;AES-128-CBC&#34;</span><span class="op" id="4288367">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288370">cipherFunc</span><span class="op" id="4288380">:</span>&nbsp;<span class="ident" id="4288382"><a href="/crypto/x509/pem_decrypt.go.html#4287342">aes</a></span><span class="op" id="4288385">.</span><span class="ident" id="4288386">NewCipher</span><span class="op" id="4288395">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288398">keySize</span><span class="op" id="4288405">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4288410">16</span><span class="op" id="4288412">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288415">blockSize</span><span class="op" id="4288424">:</span>&nbsp;&nbsp;<span class="ident" id="4288427"><a href="/crypto/x509/pem_decrypt.go.html#4287342">aes</a></span><span class="op" id="4288430">.</span><span class="ident" id="4288431">BlockSize</span><span class="op" id="4288440">,</span><br>
<span class="lineno"></span><span class="op" id="4288442">}</span><span class="op" id="4288443">,</span>&nbsp;<span class="op" id="4288445">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288448">cipher</span><span class="op" id="4288454">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4288460"><a href="/crypto/x509/pem_decrypt.go.html#4287622">PEMCipherAES192</a></span><span class="op" id="4288475">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288478">name</span><span class="op" id="4288482">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4288490">&#34;AES-192-CBC&#34;</span><span class="op" id="4288503">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288506">cipherFunc</span><span class="op" id="4288516">:</span>&nbsp;<span class="ident" id="4288518"><a href="/crypto/x509/pem_decrypt.go.html#4287342">aes</a></span><span class="op" id="4288521">.</span><span class="ident" id="4288522">NewCipher</span><span class="op" id="4288531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288534">keySize</span><span class="op" id="4288541">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4288546">24</span><span class="op" id="4288548">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288551">blockSize</span><span class="op" id="4288560">:</span>&nbsp;&nbsp;<span class="ident" id="4288563"><a href="/crypto/x509/pem_decrypt.go.html#4287342">aes</a></span><span class="op" id="4288566">.</span><span class="ident" id="4288567">BlockSize</span><span class="op" id="4288576">,</span><br>
<span class="lineno">70</span><span class="op" id="4288578">}</span><span class="op" id="4288579">,</span>&nbsp;<span class="op" id="4288581">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288584">cipher</span><span class="op" id="4288590">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4288596"><a href="/crypto/x509/pem_decrypt.go.html#4287639">PEMCipherAES256</a></span><span class="op" id="4288611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288614">name</span><span class="op" id="4288618">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4288626">&#34;AES-256-CBC&#34;</span><span class="op" id="4288639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288642">cipherFunc</span><span class="op" id="4288652">:</span>&nbsp;<span class="ident" id="4288654"><a href="/crypto/x509/pem_decrypt.go.html#4287342">aes</a></span><span class="op" id="4288657">.</span><span class="ident" id="4288658">NewCipher</span><span class="op" id="4288667">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288670">keySize</span><span class="op" id="4288677">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="4288682">32</span><span class="op" id="4288684">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288687">blockSize</span><span class="op" id="4288696">:</span>&nbsp;&nbsp;<span class="ident" id="4288699"><a href="/crypto/x509/pem_decrypt.go.html#4287342">aes</a></span><span class="op" id="4288702">.</span><span class="ident" id="4288703">BlockSize</span><span class="op" id="4288712">,</span><br>
<span class="lineno"></span><span class="op" id="4288714">}</span><span class="op" id="4288715">,</span><br>
<span class="lineno"></span><span class="op" id="4288717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4288720">//&nbsp;deriveKey&nbsp;uses&nbsp;a&nbsp;key&nbsp;derivation&nbsp;function&nbsp;to&nbsp;stretch&nbsp;the&nbsp;password&nbsp;into&nbsp;a&nbsp;key</span><br>
<span class="lineno">80</span><span class="comment" id="4288799">//&nbsp;with&nbsp;the&nbsp;number&nbsp;of&nbsp;bits&nbsp;our&nbsp;cipher&nbsp;requires.&nbsp;This&nbsp;algorithm&nbsp;was&nbsp;derived&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="4288879">//&nbsp;the&nbsp;OpenSSL&nbsp;source.</span><br>
<span class="lineno"></span><span class="keyword" id="4288902">func</span>&nbsp;<span class="op" id="4288907">(</span><span class="ident" id="4288908">c</span>&nbsp;<span class="ident" id="4288910"><a href="/crypto/x509/pem_decrypt.go.html#4287722">rfc1423Algo</a></span><span class="op" id="4288921">)</span>&nbsp;<span class="ident" id="4288923">deriveKey</span><span class="op" id="4288932">(</span><span class="ident" id="4288933">password</span><span class="op" id="4288941">,</span>&nbsp;<span class="ident" id="4288943">salt</span>&nbsp;<span class="op" id="4288948">[</span><span class="op" id="4288949">]</span><span class="builtintype" id="4288950">byte</span><span class="op" id="4288954">)</span>&nbsp;<span class="op" id="4288956">[</span><span class="op" id="4288957">]</span><span class="builtintype" id="4288958">byte</span>&nbsp;<span class="op" id="4288963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288966">hash</span>&nbsp;<span class="op" id="4288971">:=</span>&nbsp;<span class="ident" id="4288974"><a href="/crypto/x509/pem_decrypt.go.html#4287387">md5</a></span><span class="op" id="4288977">.</span><span class="ident" id="4288978">New</span><span class="op" id="4288981">(</span><span class="op" id="4288982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4288985">out</span>&nbsp;<span class="op" id="4288989">:=</span>&nbsp;<span class="builtinfunc" id="4288992">make</span><span class="op" id="4288996">(</span><span class="op" id="4288997">[</span><span class="op" id="4288998">]</span><span class="builtintype" id="4288999">byte</span><span class="op" id="4289003">,</span>&nbsp;<span class="ident" id="4289005"><a href="/crypto/x509/pem_decrypt.go.html#4288908">c</a></span><span class="op" id="4289006">.</span><span class="ident" id="4289007">keySize</span><span class="op" id="4289014">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289017">var</span>&nbsp;<span class="ident" id="4289021">digest</span>&nbsp;<span class="op" id="4289028">[</span><span class="op" id="4289029">]</span><span class="builtintype" id="4289030">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289037">for</span>&nbsp;<span class="ident" id="4289041">i</span>&nbsp;<span class="op" id="4289043">:=</span>&nbsp;<span class="num" id="4289046">0</span><span class="op" id="4289047">;</span>&nbsp;<span class="ident" id="4289049"><a href="/crypto/x509/pem_decrypt.go.html#4289041">i</a></span>&nbsp;<span class="op" id="4289051">&lt;</span>&nbsp;<span class="builtinfunc" id="4289053">len</span><span class="op" id="4289056">(</span><span class="ident" id="4289057"><a href="/crypto/x509/pem_decrypt.go.html#4288985">out</a></span><span class="op" id="4289060">)</span><span class="op" id="4289061">;</span>&nbsp;<span class="ident" id="4289063"><a href="/crypto/x509/pem_decrypt.go.html#4289041">i</a></span>&nbsp;<span class="op" id="4289065">+=</span>&nbsp;<span class="builtinfunc" id="4289068">len</span><span class="op" id="4289071">(</span><span class="ident" id="4289072"><a href="/crypto/x509/pem_decrypt.go.html#4289021">digest</a></span><span class="op" id="4289078">)</span>&nbsp;<span class="op" id="4289080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289084"><a href="/crypto/x509/pem_decrypt.go.html#4288966">hash</a></span><span class="op" id="4289088">.</span><span class="ident" id="4289089">Reset</span><span class="op" id="4289094">(</span><span class="op" id="4289095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289099"><a href="/crypto/x509/pem_decrypt.go.html#4288966">hash</a></span><span class="op" id="4289103">.</span><span class="ident" id="4289104">Write</span><span class="op" id="4289109">(</span><span class="ident" id="4289110"><a href="/crypto/x509/pem_decrypt.go.html#4289021">digest</a></span><span class="op" id="4289116">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289120"><a href="/crypto/x509/pem_decrypt.go.html#4288966">hash</a></span><span class="op" id="4289124">.</span><span class="ident" id="4289125">Write</span><span class="op" id="4289130">(</span><span class="ident" id="4289131"><a href="/crypto/x509/pem_decrypt.go.html#4288933">password</a></span><span class="op" id="4289139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289143"><a href="/crypto/x509/pem_decrypt.go.html#4288966">hash</a></span><span class="op" id="4289147">.</span><span class="ident" id="4289148">Write</span><span class="op" id="4289153">(</span><span class="ident" id="4289154"><a href="/crypto/x509/pem_decrypt.go.html#4288943">salt</a></span><span class="op" id="4289158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289162"><a href="/crypto/x509/pem_decrypt.go.html#4289021">digest</a></span>&nbsp;<span class="op" id="4289169">=</span>&nbsp;<span class="ident" id="4289171"><a href="/crypto/x509/pem_decrypt.go.html#4288966">hash</a></span><span class="op" id="4289175">.</span><span class="ident" id="4289176">Sum</span><span class="op" id="4289179">(</span><span class="ident" id="4289180"><a href="/crypto/x509/pem_decrypt.go.html#4289021">digest</a></span><span class="op" id="4289186">[</span><span class="op" id="4289187">:</span><span class="num" id="4289188">0</span><span class="op" id="4289189">]</span><span class="op" id="4289190">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4289194">copy</span><span class="op" id="4289198">(</span><span class="ident" id="4289199"><a href="/crypto/x509/pem_decrypt.go.html#4288985">out</a></span><span class="op" id="4289202">[</span><span class="ident" id="4289203"><a href="/crypto/x509/pem_decrypt.go.html#4289041">i</a></span><span class="op" id="4289204">:</span><span class="op" id="4289205">]</span><span class="op" id="4289206">,</span>&nbsp;<span class="ident" id="4289208"><a href="/crypto/x509/pem_decrypt.go.html#4289021">digest</a></span><span class="op" id="4289214">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4289217">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289220">return</span>&nbsp;<span class="ident" id="4289227"><a href="/crypto/x509/pem_decrypt.go.html#4288985">out</a></span><br>
<span class="lineno"></span><span class="op" id="4289231">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4289234">//&nbsp;IsEncryptedPEMBlock&nbsp;returns&nbsp;if&nbsp;the&nbsp;PEM&nbsp;block&nbsp;is&nbsp;password&nbsp;encrypted.</span><br>
<span class="lineno"></span><span class="keyword" id="4289305">func</span>&nbsp;<span class="ident" id="4289310">IsEncryptedPEMBlock</span><span class="op" id="4289329">(</span><span class="ident" id="4289330">b</span>&nbsp;<span class="op" id="4289332">*</span><span class="ident" id="4289333"><a href="/crypto/x509/pem_decrypt.go.html#4287417">pem</a></span><span class="op" id="4289336">.</span><span class="ident" id="4289337">Block</span><span class="op" id="4289342">)</span>&nbsp;<span class="builtintype" id="4289344">bool</span>&nbsp;<span class="op" id="4289349">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289352">_</span><span class="op" id="4289353">,</span>&nbsp;<span class="ident" id="4289355">ok</span>&nbsp;<span class="op" id="4289358">:=</span>&nbsp;<span class="ident" id="4289361"><a href="/crypto/x509/pem_decrypt.go.html#4289330">b</a></span><span class="op" id="4289362">.</span><span class="ident" id="4289363">Headers</span><span class="op" id="4289370">[</span><span class="string" id="4289371">&#34;DEK-Info&#34;</span><span class="op" id="4289381">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4289384">return</span>&nbsp;<span class="ident" id="4289391"><a href="/crypto/x509/pem_decrypt.go.html#4289355">ok</a></span><br>
<span class="lineno"></span><span class="op" id="4289394">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4289397">//&nbsp;IncorrectPasswordError&nbsp;is&nbsp;returned&nbsp;when&nbsp;an&nbsp;incorrect&nbsp;password&nbsp;is&nbsp;detected.</span><br>
<span class="lineno">105</span><span class="keyword" id="4289475">var</span>&nbsp;<span class="ident" id="4289479">IncorrectPasswordError</span>&nbsp;<span class="op" id="4289502">=</span>&nbsp;<span class="ident" id="4289504"><a href="/crypto/x509/pem_decrypt.go.html#4287433">errors</a></span><span class="op" id="4289510">.</span><span class="ident" id="4289511">New</span><span class="op" id="4289514">(</span><span class="string" id="4289515">&#34;x509:&nbsp;decryption&nbsp;password&nbsp;incorrect&#34;</span><span class="op" id="4289552">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4289555">//&nbsp;DecryptPEMBlock&nbsp;takes&nbsp;a&nbsp;password&nbsp;encrypted&nbsp;PEM&nbsp;block&nbsp;and&nbsp;the&nbsp;password&nbsp;used&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4289636">//&nbsp;encrypt&nbsp;it&nbsp;and&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;decrypted&nbsp;DER&nbsp;encoded&nbsp;bytes.&nbsp;It&nbsp;inspects</span><br>
<span class="lineno"></span><span class="comment" id="4289714">//&nbsp;the&nbsp;DEK-Info&nbsp;header&nbsp;to&nbsp;determine&nbsp;the&nbsp;algorithm&nbsp;used&nbsp;for&nbsp;decryption.&nbsp;If&nbsp;no</span><br>
<span class="lineno">110</span><span class="comment" id="4289791">//&nbsp;DEK-Info&nbsp;header&nbsp;is&nbsp;present,&nbsp;an&nbsp;error&nbsp;is&nbsp;returned.&nbsp;If&nbsp;an&nbsp;incorrect&nbsp;password</span><br>
<span class="lineno"></span><span class="comment" id="4289869">//&nbsp;is&nbsp;detected&nbsp;an&nbsp;IncorrectPasswordError&nbsp;is&nbsp;returned.</span><br>
<span class="lineno"></span><span class="keyword" id="4289923">func</span>&nbsp;<span class="ident" id="4289928">DecryptPEMBlock</span><span class="op" id="4289943">(</span><span class="ident" id="4289944">b</span>&nbsp;<span class="op" id="4289946">*</span><span class="ident" id="4289947"><a href="/crypto/x509/pem_decrypt.go.html#4287417">pem</a></span><span class="op" id="4289950">.</span><span class="ident" id="4289951">Block</span><span class="op" id="4289956">,</span>&nbsp;<span class="ident" id="4289958">password</span>&nbsp;<span class="op" id="4289967">[</span><span class="op" id="4289968">]</span><span class="builtintype" id="4289969">byte</span><span class="op" id="4289973">)</span>&nbsp;<span class="op" id="4289975">(</span><span class="op" id="4289976">[</span><span class="op" id="4289977">]</span><span class="builtintype" id="4289978">byte</span><span class="op" id="4289982">,</span>&nbsp;<span class="builtintype" id="4289984">error</span><span class="op" id="4289989">)</span>&nbsp;<span class="op" id="4289991">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4289994">dek</span><span class="op" id="4289997">,</span>&nbsp;<span class="ident" id="4289999">ok</span>&nbsp;<span class="op" id="4290002">:=</span>&nbsp;<span class="ident" id="4290005"><a href="/crypto/x509/pem_decrypt.go.html#4289944">b</a></span><span class="op" id="4290006">.</span><span class="ident" id="4290007">Headers</span><span class="op" id="4290014">[</span><span class="string" id="4290015">&#34;DEK-Info&#34;</span><span class="op" id="4290025">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290028">if</span>&nbsp;<span class="op" id="4290031">!</span><span class="ident" id="4290032"><a href="/crypto/x509/pem_decrypt.go.html#4289999">ok</a></span>&nbsp;<span class="op" id="4290035">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290039">return</span>&nbsp;<span class="ident" id="4290046">nil</span><span class="op" id="4290049">,</span>&nbsp;<span class="ident" id="4290051"><a href="/crypto/x509/pem_decrypt.go.html#4287433">errors</a></span><span class="op" id="4290057">.</span><span class="ident" id="4290058">New</span><span class="op" id="4290061">(</span><span class="string" id="4290062">&#34;x509:&nbsp;no&nbsp;DEK-Info&nbsp;header&nbsp;in&nbsp;block&#34;</span><span class="op" id="4290097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4290100">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4290104">idx</span>&nbsp;<span class="op" id="4290108">:=</span>&nbsp;<span class="ident" id="4290111"><a href="/crypto/x509/pem_decrypt.go.html#4287449">strings</a></span><span class="op" id="4290118">.</span><span class="ident" id="4290119">Index</span><span class="op" id="4290124">(</span><span class="ident" id="4290125"><a href="/crypto/x509/pem_decrypt.go.html#4289994">dek</a></span><span class="op" id="4290128">,</span>&nbsp;<span class="string" id="4290130">&#34;,&#34;</span><span class="op" id="4290133">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290136">if</span>&nbsp;<span class="ident" id="4290139"><a href="/crypto/x509/pem_decrypt.go.html#4290104">idx</a></span>&nbsp;<span class="op" id="4290143">==</span>&nbsp;<span class="op" id="4290146">-</span><span class="num" id="4290147">1</span>&nbsp;<span class="op" id="4290149">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290153">return</span>&nbsp;<span class="ident" id="4290160">nil</span><span class="op" id="4290163">,</span>&nbsp;<span class="ident" id="4290165"><a href="/crypto/x509/pem_decrypt.go.html#4287433">errors</a></span><span class="op" id="4290171">.</span><span class="ident" id="4290172">New</span><span class="op" id="4290175">(</span><span class="string" id="4290176">&#34;x509:&nbsp;malformed&nbsp;DEK-Info&nbsp;header&#34;</span><span class="op" id="4290209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4290212">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4290216">mode</span><span class="op" id="4290220">,</span>&nbsp;<span class="ident" id="4290222">hexIV</span>&nbsp;<span class="op" id="4290228">:=</span>&nbsp;<span class="ident" id="4290231"><a href="/crypto/x509/pem_decrypt.go.html#4289994">dek</a></span><span class="op" id="4290234">[</span><span class="op" id="4290235">:</span><span class="ident" id="4290236"><a href="/crypto/x509/pem_decrypt.go.html#4290104">idx</a></span><span class="op" id="4290239">]</span><span class="op" id="4290240">,</span>&nbsp;<span class="ident" id="4290242"><a href="/crypto/x509/pem_decrypt.go.html#4289994">dek</a></span><span class="op" id="4290245">[</span><span class="ident" id="4290246"><a href="/crypto/x509/pem_decrypt.go.html#4290104">idx</a></span><span class="op" id="4290249">+</span><span class="num" id="4290250">1</span><span class="op" id="4290251">:</span><span class="op" id="4290252">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4290255">ciph</span>&nbsp;<span class="op" id="4290260">:=</span>&nbsp;<span class="ident" id="4290263"><a href="/crypto/x509/pem_decrypt.go.html#4292979">cipherByName</a></span><span class="op" id="4290275">(</span><span class="ident" id="4290276"><a href="/crypto/x509/pem_decrypt.go.html#4290216">mode</a></span><span class="op" id="4290280">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290283">if</span>&nbsp;<span class="ident" id="4290286"><a href="/crypto/x509/pem_decrypt.go.html#4290255">ciph</a></span>&nbsp;<span class="op" id="4290291">==</span>&nbsp;<span class="ident" id="4290294">nil</span>&nbsp;<span class="op" id="4290298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290302">return</span>&nbsp;<span class="ident" id="4290309">nil</span><span class="op" id="4290312">,</span>&nbsp;<span class="ident" id="4290314"><a href="/crypto/x509/pem_decrypt.go.html#4287433">errors</a></span><span class="op" id="4290320">.</span><span class="ident" id="4290321">New</span><span class="op" id="4290324">(</span><span class="string" id="4290325">&#34;x509:&nbsp;unknown&nbsp;encryption&nbsp;mode&#34;</span><span class="op" id="4290356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4290359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4290362">iv</span><span class="op" id="4290364">,</span>&nbsp;<span class="ident" id="4290366">err</span>&nbsp;<span class="op" id="4290370">:=</span>&nbsp;<span class="ident" id="4290373"><a href="/crypto/x509/pem_decrypt.go.html#4287401">hex</a></span><span class="op" id="4290376">.</span><span class="ident" id="4290377">DecodeString</span><span class="op" id="4290389">(</span><span class="ident" id="4290390"><a href="/crypto/x509/pem_decrypt.go.html#4290222">hexIV</a></span><span class="op" id="4290395">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290398">if</span>&nbsp;<span class="ident" id="4290401"><a href="/crypto/x509/pem_decrypt.go.html#4290366">err</a></span>&nbsp;<span class="op" id="4290405">!=</span>&nbsp;<span class="ident" id="4290408">nil</span>&nbsp;<span class="op" id="4290412">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290416">return</span>&nbsp;<span class="ident" id="4290423">nil</span><span class="op" id="4290426">,</span>&nbsp;<span class="ident" id="4290428"><a href="/crypto/x509/pem_decrypt.go.html#4290366">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4290433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290436">if</span>&nbsp;<span class="builtinfunc" id="4290439">len</span><span class="op" id="4290442">(</span><span class="ident" id="4290443"><a href="/crypto/x509/pem_decrypt.go.html#4290362">iv</a></span><span class="op" id="4290445">)</span>&nbsp;<span class="op" id="4290447">!=</span>&nbsp;<span class="ident" id="4290450"><a href="/crypto/x509/pem_decrypt.go.html#4290255">ciph</a></span><span class="op" id="4290454">.</span><span class="ident" id="4290455">blockSize</span>&nbsp;<span class="op" id="4290465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290469">return</span>&nbsp;<span class="ident" id="4290476">nil</span><span class="op" id="4290479">,</span>&nbsp;<span class="ident" id="4290481"><a href="/crypto/x509/pem_decrypt.go.html#4287433">errors</a></span><span class="op" id="4290487">.</span><span class="ident" id="4290488">New</span><span class="op" id="4290491">(</span><span class="string" id="4290492">&#34;x509:&nbsp;incorrect&nbsp;IV&nbsp;size&#34;</span><span class="op" id="4290517">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4290520">}</span><br>
<span class="lineno">135</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4290524">//&nbsp;Based&nbsp;on&nbsp;the&nbsp;OpenSSL&nbsp;implementation.&nbsp;The&nbsp;salt&nbsp;is&nbsp;the&nbsp;first&nbsp;8&nbsp;bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4290595">//&nbsp;of&nbsp;the&nbsp;initialization&nbsp;vector.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4290629">key</span>&nbsp;<span class="op" id="4290633">:=</span>&nbsp;<span class="ident" id="4290636"><a href="/crypto/x509/pem_decrypt.go.html#4290255">ciph</a></span><span class="op" id="4290640">.</span><span class="ident" id="4290641">deriveKey</span><span class="op" id="4290650">(</span><span class="ident" id="4290651"><a href="/crypto/x509/pem_decrypt.go.html#4289958">password</a></span><span class="op" id="4290659">,</span>&nbsp;<span class="ident" id="4290661"><a href="/crypto/x509/pem_decrypt.go.html#4290362">iv</a></span><span class="op" id="4290663">[</span><span class="op" id="4290664">:</span><span class="num" id="4290665">8</span><span class="op" id="4290666">]</span><span class="op" id="4290667">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4290670">block</span><span class="op" id="4290675">,</span>&nbsp;<span class="ident" id="4290677"><a href="/crypto/x509/pem_decrypt.go.html#4290366">err</a></span>&nbsp;<span class="op" id="4290681">:=</span>&nbsp;<span class="ident" id="4290684"><a href="/crypto/x509/pem_decrypt.go.html#4290255">ciph</a></span><span class="op" id="4290688">.</span><span class="ident" id="4290689">cipherFunc</span><span class="op" id="4290699">(</span><span class="ident" id="4290700"><a href="/crypto/x509/pem_decrypt.go.html#4290629">key</a></span><span class="op" id="4290703">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290706">if</span>&nbsp;<span class="ident" id="4290709"><a href="/crypto/x509/pem_decrypt.go.html#4290366">err</a></span>&nbsp;<span class="op" id="4290713">!=</span>&nbsp;<span class="ident" id="4290716">nil</span>&nbsp;<span class="op" id="4290720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4290724">return</span>&nbsp;<span class="ident" id="4290731">nil</span><span class="op" id="4290734">,</span>&nbsp;<span class="ident" id="4290736"><a href="/crypto/x509/pem_decrypt.go.html#4290366">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4290741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4290745">data</span>&nbsp;<span class="op" id="4290750">:=</span>&nbsp;<span class="builtinfunc" id="4290753">make</span><span class="op" id="4290757">(</span><span class="op" id="4290758">[</span><span class="op" id="4290759">]</span><span class="builtintype" id="4290760">byte</span><span class="op" id="4290764">,</span>&nbsp;<span class="builtinfunc" id="4290766">len</span><span class="op" id="4290769">(</span><span class="ident" id="4290770"><a href="/crypto/x509/pem_decrypt.go.html#4289944">b</a></span><span class="op" id="4290771">.</span><span class="ident" id="4290772">Bytes</span><span class="op" id="4290777">)</span><span class="op" id="4290778">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4290781">dec</span>&nbsp;<span class="op" id="4290785">:=</span>&nbsp;<span class="ident" id="4290788"><a href="/crypto/x509/pem_decrypt.go.html#4287356">cipher</a></span><span class="op" id="4290794">.</span><span class="ident" id="4290795">NewCBCDecrypter</span><span class="op" id="4290810">(</span><span class="ident" id="4290811"><a href="/crypto/x509/pem_decrypt.go.html#4290670">block</a></span><span class="op" id="4290816">,</span>&nbsp;<span class="ident" id="4290818"><a href="/crypto/x509/pem_decrypt.go.html#4290362">iv</a></span><span class="op" id="4290820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4290823"><a href="/crypto/x509/pem_decrypt.go.html#4290781">dec</a></span><span class="op" id="4290826">.</span><span class="ident" id="4290827">CryptBlocks</span><span class="op" id="4290838">(</span><span class="ident" id="4290839"><a href="/crypto/x509/pem_decrypt.go.html#4290745">data</a></span><span class="op" id="4290843">,</span>&nbsp;<span class="ident" id="4290845"><a href="/crypto/x509/pem_decrypt.go.html#4289944">b</a></span><span class="op" id="4290846">.</span><span class="ident" id="4290847">Bytes</span><span class="op" id="4290852">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4290856">//&nbsp;Blocks&nbsp;are&nbsp;padded&nbsp;using&nbsp;a&nbsp;scheme&nbsp;where&nbsp;the&nbsp;last&nbsp;n&nbsp;bytes&nbsp;of&nbsp;padding&nbsp;are&nbsp;all</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4290935">//&nbsp;equal&nbsp;to&nbsp;n.&nbsp;It&nbsp;can&nbsp;pad&nbsp;from&nbsp;1&nbsp;to&nbsp;blocksize&nbsp;bytes&nbsp;inclusive.&nbsp;See&nbsp;RFC&nbsp;1423.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4291013">//&nbsp;For&nbsp;example:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4291030">//&nbsp;&nbsp;&nbsp;&nbsp[x&nbsp;y&nbsp;z&nbsp;2&nbsp;2]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4291046">//&nbsp;&nbsp;&nbsp;&nbsp[x&nbsp;y&nbsp;7&nbsp;7&nbsp;7&nbsp;7&nbsp;7&nbsp;7&nbsp;7]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4291070">//&nbsp;If&nbsp;we&nbsp;detect&nbsp;a&nbsp;bad&nbsp;padding,&nbsp;we&nbsp;assume&nbsp;it&nbsp;is&nbsp;an&nbsp;invalid&nbsp;password.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4291139">dlen</span>&nbsp;<span class="op" id="4291144">:=</span>&nbsp;<span class="builtinfunc" id="4291147">len</span><span class="op" id="4291150">(</span><span class="ident" id="4291151"><a href="/crypto/x509/pem_decrypt.go.html#4290745">data</a></span><span class="op" id="4291155">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4291158">if</span>&nbsp;<span class="ident" id="4291161"><a href="/crypto/x509/pem_decrypt.go.html#4291139">dlen</a></span>&nbsp;<span class="op" id="4291166">==</span>&nbsp;<span class="num" id="4291169">0</span>&nbsp;<span class="op" id="4291171">||</span>&nbsp;<span class="ident" id="4291174"><a href="/crypto/x509/pem_decrypt.go.html#4291139">dlen</a></span><span class="op" id="4291178">%</span><span class="ident" id="4291179"><a href="/crypto/x509/pem_decrypt.go.html#4290255">ciph</a></span><span class="op" id="4291183">.</span><span class="ident" id="4291184">blockSize</span>&nbsp;<span class="op" id="4291194">!=</span>&nbsp;<span class="num" id="4291197">0</span>&nbsp;<span class="op" id="4291199">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4291203">return</span>&nbsp;<span class="ident" id="4291210">nil</span><span class="op" id="4291213">,</span>&nbsp;<span class="ident" id="4291215"><a href="/crypto/x509/pem_decrypt.go.html#4287433">errors</a></span><span class="op" id="4291221">.</span><span class="ident" id="4291222">New</span><span class="op" id="4291225">(</span><span class="string" id="4291226">&#34;x509:&nbsp;invalid&nbsp;padding&#34;</span><span class="op" id="4291249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4291252">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4291255">last</span>&nbsp;<span class="op" id="4291260">:=</span>&nbsp;<span class="builtintype" id="4291263">int</span><span class="op" id="4291266">(</span><span class="ident" id="4291267"><a href="/crypto/x509/pem_decrypt.go.html#4290745">data</a></span><span class="op" id="4291271">[</span><span class="ident" id="4291272"><a href="/crypto/x509/pem_decrypt.go.html#4291139">dlen</a></span><span class="op" id="4291276">-</span><span class="num" id="4291277">1</span><span class="op" id="4291278">]</span><span class="op" id="4291279">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4291282">if</span>&nbsp;<span class="ident" id="4291285"><a href="/crypto/x509/pem_decrypt.go.html#4291139">dlen</a></span>&nbsp;<span class="op" id="4291290">&lt;</span>&nbsp;<span class="ident" id="4291292"><a href="/crypto/x509/pem_decrypt.go.html#4291255">last</a></span>&nbsp;<span class="op" id="4291297">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4291301">return</span>&nbsp;<span class="ident" id="4291308">nil</span><span class="op" id="4291311">,</span>&nbsp;<span class="ident" id="4291313"><a href="/crypto/x509/pem_decrypt.go.html#4289479">IncorrectPasswordError</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4291337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4291340">if</span>&nbsp;<span class="ident" id="4291343"><a href="/crypto/x509/pem_decrypt.go.html#4291255">last</a></span>&nbsp;<span class="op" id="4291348">==</span>&nbsp;<span class="num" id="4291351">0</span>&nbsp;<span class="op" id="4291353">||</span>&nbsp;<span class="ident" id="4291356"><a href="/crypto/x509/pem_decrypt.go.html#4291255">last</a></span>&nbsp;<span class="op" id="4291361">&gt;</span>&nbsp;<span class="ident" id="4291363"><a href="/crypto/x509/pem_decrypt.go.html#4290255">ciph</a></span><span class="op" id="4291367">.</span><span class="ident" id="4291368">blockSize</span>&nbsp;<span class="op" id="4291378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4291382">return</span>&nbsp;<span class="ident" id="4291389">nil</span><span class="op" id="4291392">,</span>&nbsp;<span class="ident" id="4291394"><a href="/crypto/x509/pem_decrypt.go.html#4289479">IncorrectPasswordError</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4291418">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4291421">for</span>&nbsp;<span class="ident" id="4291425">_</span><span class="op" id="4291426">,</span>&nbsp;<span class="ident" id="4291428">val</span>&nbsp;<span class="op" id="4291432">:=</span>&nbsp;<span class="keyword" id="4291435">range</span>&nbsp;<span class="ident" id="4291441"><a href="/crypto/x509/pem_decrypt.go.html#4290745">data</a></span><span class="op" id="4291445">[</span><span class="ident" id="4291446"><a href="/crypto/x509/pem_decrypt.go.html#4291139">dlen</a></span><span class="op" id="4291450">-</span><span class="ident" id="4291451"><a href="/crypto/x509/pem_decrypt.go.html#4291255">last</a></span><span class="op" id="4291455">:</span><span class="op" id="4291456">]</span>&nbsp;<span class="op" id="4291458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4291462">if</span>&nbsp;<span class="builtintype" id="4291465">int</span><span class="op" id="4291468">(</span><span class="ident" id="4291469"><a href="/crypto/x509/pem_decrypt.go.html#4291428">val</a></span><span class="op" id="4291472">)</span>&nbsp;<span class="op" id="4291474">!=</span>&nbsp;<span class="ident" id="4291477"><a href="/crypto/x509/pem_decrypt.go.html#4291255">last</a></span>&nbsp;<span class="op" id="4291482">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4291487">return</span>&nbsp;<span class="ident" id="4291494">nil</span><span class="op" id="4291497">,</span>&nbsp;<span class="ident" id="4291499"><a href="/crypto/x509/pem_decrypt.go.html#4289479">IncorrectPasswordError</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4291524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4291527">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4291530">return</span>&nbsp;<span class="ident" id="4291537"><a href="/crypto/x509/pem_decrypt.go.html#4290745">data</a></span><span class="op" id="4291541">[</span><span class="op" id="4291542">:</span><span class="ident" id="4291543"><a href="/crypto/x509/pem_decrypt.go.html#4291139">dlen</a></span><span class="op" id="4291547">-</span><span class="ident" id="4291548"><a href="/crypto/x509/pem_decrypt.go.html#4291255">last</a></span><span class="op" id="4291552">]</span><span class="op" id="4291553">,</span>&nbsp;<span class="ident" id="4291555">nil</span><br>
<span class="lineno"></span><span class="op" id="4291559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4291562">//&nbsp;EncryptPEMBlock&nbsp;returns&nbsp;a&nbsp;PEM&nbsp;block&nbsp;of&nbsp;the&nbsp;specified&nbsp;type&nbsp;holding&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4291635">//&nbsp;given&nbsp;DER-encoded&nbsp;data&nbsp;encrypted&nbsp;with&nbsp;the&nbsp;specified&nbsp;algorithm&nbsp;and</span><br>
<span class="lineno">175</span><span class="comment" id="4291704">//&nbsp;password.</span><br>
<span class="lineno"></span><span class="keyword" id="4291717">func</span>&nbsp;<span class="ident" id="4291722">EncryptPEMBlock</span><span class="op" id="4291737">(</span><span class="ident" id="4291738">rand</span>&nbsp;<span class="ident" id="4291743"><a href="/crypto/x509/pem_decrypt.go.html#4287443">io</a></span><span class="op" id="4291745">.</span><span class="ident" id="4291746">Reader</span><span class="op" id="4291752">,</span>&nbsp;<span class="ident" id="4291754">blockType</span>&nbsp;<span class="builtintype" id="4291764">string</span><span class="op" id="4291770">,</span>&nbsp;<span class="ident" id="4291772">data</span><span class="op" id="4291776">,</span>&nbsp;<span class="ident" id="4291778">password</span>&nbsp;<span class="op" id="4291787">[</span><span class="op" id="4291788">]</span><span class="builtintype" id="4291789">byte</span><span class="op" id="4291793">,</span>&nbsp;<span class="ident" id="4291795">alg</span>&nbsp;<span class="ident" id="4291799"><a href="/crypto/x509/pem_decrypt.go.html#4287467">PEMCipher</a></span><span class="op" id="4291808">)</span>&nbsp;<span class="op" id="4291810">(</span><span class="op" id="4291811">*</span><span class="ident" id="4291812"><a href="/crypto/x509/pem_decrypt.go.html#4287417">pem</a></span><span class="op" id="4291815">.</span><span class="ident" id="4291816">Block</span><span class="op" id="4291821">,</span>&nbsp;<span class="builtintype" id="4291823">error</span><span class="op" id="4291828">)</span>&nbsp;<span class="op" id="4291830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4291833">ciph</span>&nbsp;<span class="op" id="4291838">:=</span>&nbsp;<span class="ident" id="4291841"><a href="/crypto/x509/pem_decrypt.go.html#4293142">cipherByKey</a></span><span class="op" id="4291852">(</span><span class="ident" id="4291853"><a href="/crypto/x509/pem_decrypt.go.html#4291795">alg</a></span><span class="op" id="4291856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4291859">if</span>&nbsp;<span class="ident" id="4291862"><a href="/crypto/x509/pem_decrypt.go.html#4291833">ciph</a></span>&nbsp;<span class="op" id="4291867">==</span>&nbsp;<span class="ident" id="4291870">nil</span>&nbsp;<span class="op" id="4291874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4291878">return</span>&nbsp;<span class="ident" id="4291885">nil</span><span class="op" id="4291888">,</span>&nbsp;<span class="ident" id="4291890"><a href="/crypto/x509/pem_decrypt.go.html#4287433">errors</a></span><span class="op" id="4291896">.</span><span class="ident" id="4291897">New</span><span class="op" id="4291900">(</span><span class="string" id="4291901">&#34;x509:&nbsp;unknown&nbsp;encryption&nbsp;mode&#34;</span><span class="op" id="4291932">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4291935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4291938">iv</span>&nbsp;<span class="op" id="4291941">:=</span>&nbsp;<span class="builtinfunc" id="4291944">make</span><span class="op" id="4291948">(</span><span class="op" id="4291949">[</span><span class="op" id="4291950">]</span><span class="builtintype" id="4291951">byte</span><span class="op" id="4291955">,</span>&nbsp;<span class="ident" id="4291957"><a href="/crypto/x509/pem_decrypt.go.html#4291833">ciph</a></span><span class="op" id="4291961">.</span><span class="ident" id="4291962">blockSize</span><span class="op" id="4291971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4291974">if</span>&nbsp;<span class="ident" id="4291977">_</span><span class="op" id="4291978">,</span>&nbsp;<span class="ident" id="4291980">err</span>&nbsp;<span class="op" id="4291984">:=</span>&nbsp;<span class="ident" id="4291987"><a href="/crypto/x509/pem_decrypt.go.html#4287443">io</a></span><span class="op" id="4291989">.</span><span class="ident" id="4291990">ReadFull</span><span class="op" id="4291998">(</span><span class="ident" id="4291999"><a href="/crypto/x509/pem_decrypt.go.html#4291738">rand</a></span><span class="op" id="4292003">,</span>&nbsp;<span class="ident" id="4292005"><a href="/crypto/x509/pem_decrypt.go.html#4291938">iv</a></span><span class="op" id="4292007">)</span><span class="op" id="4292008">;</span>&nbsp;<span class="ident" id="4292010"><a href="/crypto/x509/pem_decrypt.go.html#4291980">err</a></span>&nbsp;<span class="op" id="4292014">!=</span>&nbsp;<span class="ident" id="4292017">nil</span>&nbsp;<span class="op" id="4292021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292025">return</span>&nbsp;<span class="ident" id="4292032">nil</span><span class="op" id="4292035">,</span>&nbsp;<span class="ident" id="4292037"><a href="/crypto/x509/pem_decrypt.go.html#4287433">errors</a></span><span class="op" id="4292043">.</span><span class="ident" id="4292044">New</span><span class="op" id="4292047">(</span><span class="string" id="4292048">&#34;x509:&nbsp;cannot&nbsp;generate&nbsp;IV:&nbsp;&#34;</span>&nbsp;<span class="op" id="4292077">+</span>&nbsp;<span class="ident" id="4292079"><a href="/crypto/x509/pem_decrypt.go.html#4291980">err</a></span><span class="op" id="4292082">.</span><span class="ident" id="4292083">Error</span><span class="op" id="4292088">(</span><span class="op" id="4292089">)</span><span class="op" id="4292090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4292093">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4292096">//&nbsp;The&nbsp;salt&nbsp;is&nbsp;the&nbsp;first&nbsp;8&nbsp;bytes&nbsp;of&nbsp;the&nbsp;initialization&nbsp;vector,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4292160">//&nbsp;matching&nbsp;the&nbsp;key&nbsp;derivation&nbsp;in&nbsp;DecryptPEMBlock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292212">key</span>&nbsp;<span class="op" id="4292216">:=</span>&nbsp;<span class="ident" id="4292219"><a href="/crypto/x509/pem_decrypt.go.html#4291833">ciph</a></span><span class="op" id="4292223">.</span><span class="ident" id="4292224">deriveKey</span><span class="op" id="4292233">(</span><span class="ident" id="4292234"><a href="/crypto/x509/pem_decrypt.go.html#4291778">password</a></span><span class="op" id="4292242">,</span>&nbsp;<span class="ident" id="4292244"><a href="/crypto/x509/pem_decrypt.go.html#4291938">iv</a></span><span class="op" id="4292246">[</span><span class="op" id="4292247">:</span><span class="num" id="4292248">8</span><span class="op" id="4292249">]</span><span class="op" id="4292250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292253">block</span><span class="op" id="4292258">,</span>&nbsp;<span class="ident" id="4292260">err</span>&nbsp;<span class="op" id="4292264">:=</span>&nbsp;<span class="ident" id="4292267"><a href="/crypto/x509/pem_decrypt.go.html#4291833">ciph</a></span><span class="op" id="4292271">.</span><span class="ident" id="4292272">cipherFunc</span><span class="op" id="4292282">(</span><span class="ident" id="4292283"><a href="/crypto/x509/pem_decrypt.go.html#4292212">key</a></span><span class="op" id="4292286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292289">if</span>&nbsp;<span class="ident" id="4292292"><a href="/crypto/x509/pem_decrypt.go.html#4292260">err</a></span>&nbsp;<span class="op" id="4292296">!=</span>&nbsp;<span class="ident" id="4292299">nil</span>&nbsp;<span class="op" id="4292303">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292307">return</span>&nbsp;<span class="ident" id="4292314">nil</span><span class="op" id="4292317">,</span>&nbsp;<span class="ident" id="4292319"><a href="/crypto/x509/pem_decrypt.go.html#4292260">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4292324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292327">enc</span>&nbsp;<span class="op" id="4292331">:=</span>&nbsp;<span class="ident" id="4292334"><a href="/crypto/x509/pem_decrypt.go.html#4287356">cipher</a></span><span class="op" id="4292340">.</span><span class="ident" id="4292341">NewCBCEncrypter</span><span class="op" id="4292356">(</span><span class="ident" id="4292357"><a href="/crypto/x509/pem_decrypt.go.html#4292253">block</a></span><span class="op" id="4292362">,</span>&nbsp;<span class="ident" id="4292364"><a href="/crypto/x509/pem_decrypt.go.html#4291938">iv</a></span><span class="op" id="4292366">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292369">pad</span>&nbsp;<span class="op" id="4292373">:=</span>&nbsp;<span class="ident" id="4292376"><a href="/crypto/x509/pem_decrypt.go.html#4291833">ciph</a></span><span class="op" id="4292380">.</span><span class="ident" id="4292381">blockSize</span>&nbsp;<span class="op" id="4292391">-</span>&nbsp;<span class="builtinfunc" id="4292393">len</span><span class="op" id="4292396">(</span><span class="ident" id="4292397"><a href="/crypto/x509/pem_decrypt.go.html#4291772">data</a></span><span class="op" id="4292401">)</span><span class="op" id="4292402">%</span><span class="ident" id="4292403"><a href="/crypto/x509/pem_decrypt.go.html#4291833">ciph</a></span><span class="op" id="4292407">.</span><span class="ident" id="4292408">blockSize</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292419">encrypted</span>&nbsp;<span class="op" id="4292429">:=</span>&nbsp;<span class="builtinfunc" id="4292432">make</span><span class="op" id="4292436">(</span><span class="op" id="4292437">[</span><span class="op" id="4292438">]</span><span class="builtintype" id="4292439">byte</span><span class="op" id="4292443">,</span>&nbsp;<span class="builtinfunc" id="4292445">len</span><span class="op" id="4292448">(</span><span class="ident" id="4292449"><a href="/crypto/x509/pem_decrypt.go.html#4291772">data</a></span><span class="op" id="4292453">)</span><span class="op" id="4292454">,</span>&nbsp;<span class="builtinfunc" id="4292456">len</span><span class="op" id="4292459">(</span><span class="ident" id="4292460"><a href="/crypto/x509/pem_decrypt.go.html#4291772">data</a></span><span class="op" id="4292464">)</span><span class="op" id="4292465">+</span><span class="ident" id="4292466"><a href="/crypto/x509/pem_decrypt.go.html#4292369">pad</a></span><span class="op" id="4292469">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4292472">//&nbsp;We&nbsp;could&nbsp;save&nbsp;this&nbsp;copy&nbsp;by&nbsp;encrypting&nbsp;all&nbsp;the&nbsp;whole&nbsp;blocks&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4292538">//&nbsp;the&nbsp;data&nbsp;separately,&nbsp;but&nbsp;it&nbsp;doesn&#39;t&nbsp;seem&nbsp;worth&nbsp;the&nbsp;additional</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4292604">//&nbsp;code.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4292614">copy</span><span class="op" id="4292618">(</span><span class="ident" id="4292619"><a href="/crypto/x509/pem_decrypt.go.html#4292419">encrypted</a></span><span class="op" id="4292628">,</span>&nbsp;<span class="ident" id="4292630"><a href="/crypto/x509/pem_decrypt.go.html#4291772">data</a></span><span class="op" id="4292634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4292637">//&nbsp;See&nbsp;RFC&nbsp;1423,&nbsp;section&nbsp;1.1</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292667">for</span>&nbsp;<span class="ident" id="4292671">i</span>&nbsp;<span class="op" id="4292673">:=</span>&nbsp;<span class="num" id="4292676">0</span><span class="op" id="4292677">;</span>&nbsp;<span class="ident" id="4292679"><a href="/crypto/x509/pem_decrypt.go.html#4292671">i</a></span>&nbsp;<span class="op" id="4292681">&lt;</span>&nbsp;<span class="ident" id="4292683"><a href="/crypto/x509/pem_decrypt.go.html#4292369">pad</a></span><span class="op" id="4292686">;</span>&nbsp;<span class="ident" id="4292688"><a href="/crypto/x509/pem_decrypt.go.html#4292671">i</a></span><span class="op" id="4292689">++</span>&nbsp;<span class="op" id="4292692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292696"><a href="/crypto/x509/pem_decrypt.go.html#4292419">encrypted</a></span>&nbsp;<span class="op" id="4292706">=</span>&nbsp;<span class="builtinfunc" id="4292708">append</span><span class="op" id="4292714">(</span><span class="ident" id="4292715"><a href="/crypto/x509/pem_decrypt.go.html#4292419">encrypted</a></span><span class="op" id="4292724">,</span>&nbsp;<span class="builtintype" id="4292726">byte</span><span class="op" id="4292730">(</span><span class="ident" id="4292731"><a href="/crypto/x509/pem_decrypt.go.html#4292369">pad</a></span><span class="op" id="4292734">)</span><span class="op" id="4292735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4292738">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292741"><a href="/crypto/x509/pem_decrypt.go.html#4292327">enc</a></span><span class="op" id="4292744">.</span><span class="ident" id="4292745">CryptBlocks</span><span class="op" id="4292756">(</span><span class="ident" id="4292757"><a href="/crypto/x509/pem_decrypt.go.html#4292419">encrypted</a></span><span class="op" id="4292766">,</span>&nbsp;<span class="ident" id="4292768"><a href="/crypto/x509/pem_decrypt.go.html#4292419">encrypted</a></span><span class="op" id="4292777">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4292781">return</span>&nbsp;<span class="op" id="4292788">&amp;</span><span class="ident" id="4292789"><a href="/crypto/x509/pem_decrypt.go.html#4287417">pem</a></span><span class="op" id="4292792">.</span><span class="ident" id="4292793">Block</span><span class="op" id="4292798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292802">Type</span><span class="op" id="4292806">:</span>&nbsp;<span class="ident" id="4292808"><a href="/crypto/x509/pem_decrypt.go.html#4291754">blockType</a></span><span class="op" id="4292817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292821">Headers</span><span class="op" id="4292828">:</span>&nbsp;<span class="keyword" id="4292830">map</span><span class="op" id="4292833">[</span><span class="builtintype" id="4292834">string</span><span class="op" id="4292840">]</span><span class="builtintype" id="4292841">string</span><span class="op" id="4292847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4292852">&#34;Proc-Type&#34;</span><span class="op" id="4292863">:</span>&nbsp;<span class="string" id="4292865">&#34;4,ENCRYPTED&#34;</span><span class="op" id="4292878">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4292883">&#34;DEK-Info&#34;</span><span class="op" id="4292893">:</span>&nbsp;&nbsp;<span class="ident" id="4292896"><a href="/crypto/x509/pem_decrypt.go.html#4291833">ciph</a></span><span class="op" id="4292900">.</span><span class="ident" id="4292901">name</span>&nbsp;<span class="op" id="4292906">+</span>&nbsp;<span class="string" id="4292908">&#34;,&#34;</span>&nbsp;<span class="op" id="4292912">+</span>&nbsp;<span class="ident" id="4292914"><a href="/crypto/x509/pem_decrypt.go.html#4287401">hex</a></span><span class="op" id="4292917">.</span><span class="ident" id="4292918">EncodeToString</span><span class="op" id="4292932">(</span><span class="ident" id="4292933"><a href="/crypto/x509/pem_decrypt.go.html#4291938">iv</a></span><span class="op" id="4292935">)</span><span class="op" id="4292936">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4292940">}</span><span class="op" id="4292941">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4292945">Bytes</span><span class="op" id="4292950">:</span>&nbsp;<span class="ident" id="4292952"><a href="/crypto/x509/pem_decrypt.go.html#4292419">encrypted</a></span><span class="op" id="4292961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4292964">}</span><span class="op" id="4292965">,</span>&nbsp;<span class="ident" id="4292967">nil</span><br>
<span class="lineno"></span><span class="op" id="4292971">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="keyword" id="4292974">func</span>&nbsp;<span class="ident" id="4292979">cipherByName</span><span class="op" id="4292991">(</span><span class="ident" id="4292992">name</span>&nbsp;<span class="builtintype" id="4292997">string</span><span class="op" id="4293003">)</span>&nbsp;<span class="op" id="4293005">*</span><span class="ident" id="4293006"><a href="/crypto/x509/pem_decrypt.go.html#4287722">rfc1423Algo</a></span>&nbsp;<span class="op" id="4293018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4293021">for</span>&nbsp;<span class="ident" id="4293025">i</span>&nbsp;<span class="op" id="4293027">:=</span>&nbsp;<span class="keyword" id="4293030">range</span>&nbsp;<span class="ident" id="4293036"><a href="/crypto/x509/pem_decrypt.go.html#4288008">rfc1423Algos</a></span>&nbsp;<span class="op" id="4293049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293053">alg</span>&nbsp;<span class="op" id="4293057">:=</span>&nbsp;<span class="op" id="4293060">&amp;</span><span class="ident" id="4293061"><a href="/crypto/x509/pem_decrypt.go.html#4288008">rfc1423Algos</a></span><span class="op" id="4293073">[</span><span class="ident" id="4293074"><a href="/crypto/x509/pem_decrypt.go.html#4293025">i</a></span><span class="op" id="4293075">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4293079">if</span>&nbsp;<span class="ident" id="4293082"><a href="/crypto/x509/pem_decrypt.go.html#4293053">alg</a></span><span class="op" id="4293085">.</span><span class="ident" id="4293086">name</span>&nbsp;<span class="op" id="4293091">==</span>&nbsp;<span class="ident" id="4293094"><a href="/crypto/x509/pem_decrypt.go.html#4292992">name</a></span>&nbsp;<span class="op" id="4293099">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4293104">return</span>&nbsp;<span class="ident" id="4293111"><a href="/crypto/x509/pem_decrypt.go.html#4293053">alg</a></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4293117">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4293120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4293123">return</span>&nbsp;<span class="ident" id="4293130">nil</span><br>
<span class="lineno"></span><span class="op" id="4293134">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">225</span><span class="keyword" id="4293137">func</span>&nbsp;<span class="ident" id="4293142">cipherByKey</span><span class="op" id="4293153">(</span><span class="ident" id="4293154">key</span>&nbsp;<span class="ident" id="4293158"><a href="/crypto/x509/pem_decrypt.go.html#4287467">PEMCipher</a></span><span class="op" id="4293167">)</span>&nbsp;<span class="op" id="4293169">*</span><span class="ident" id="4293170"><a href="/crypto/x509/pem_decrypt.go.html#4287722">rfc1423Algo</a></span>&nbsp;<span class="op" id="4293182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4293185">for</span>&nbsp;<span class="ident" id="4293189">i</span>&nbsp;<span class="op" id="4293191">:=</span>&nbsp;<span class="keyword" id="4293194">range</span>&nbsp;<span class="ident" id="4293200"><a href="/crypto/x509/pem_decrypt.go.html#4288008">rfc1423Algos</a></span>&nbsp;<span class="op" id="4293213">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4293217">alg</span>&nbsp;<span class="op" id="4293221">:=</span>&nbsp;<span class="op" id="4293224">&amp;</span><span class="ident" id="4293225"><a href="/crypto/x509/pem_decrypt.go.html#4288008">rfc1423Algos</a></span><span class="op" id="4293237">[</span><span class="ident" id="4293238"><a href="/crypto/x509/pem_decrypt.go.html#4293189">i</a></span><span class="op" id="4293239">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4293243">if</span>&nbsp;<span class="ident" id="4293246"><a href="/crypto/x509/pem_decrypt.go.html#4293217">alg</a></span><span class="op" id="4293249">.</span><span class="ident" id="4293250">cipher</span>&nbsp;<span class="op" id="4293257">==</span>&nbsp;<span class="ident" id="4293260"><a href="/crypto/x509/pem_decrypt.go.html#4293154">key</a></span>&nbsp;<span class="op" id="4293264">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4293269">return</span>&nbsp;<span class="ident" id="4293276"><a href="/crypto/x509/pem_decrypt.go.html#4293217">alg</a></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4293282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4293285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4293288">return</span>&nbsp;<span class="ident" id="4293295">nil</span><br>
<span class="lineno"></span><span class="op" id="4293299">}</span>
</div>
</body>
</html>
