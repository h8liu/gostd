<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3638204">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3638260">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3638314">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3638365">package</span>&nbsp;<span class="ident" id="3638373">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3638378">import</span>&nbsp;<span class="op" id="3638385">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3638388">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3638394">&#34;syscall&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3638405">&#34;unsafe&#34;</span><br>
<span class="lineno"></span><span class="op" id="3638414">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3638417">//&nbsp;If&nbsp;the&nbsp;ifindex&nbsp;is&nbsp;zero,&nbsp;interfaceTable&nbsp;returns&nbsp;mappings&nbsp;of&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3638483">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;a&nbsp;mapping&nbsp;of&nbsp;a&nbsp;specific</span><br>
<span class="lineno">15</span><span class="comment" id="3638552">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3638566">func</span>&nbsp;<span class="ident" id="3638571">interfaceTable</span><span class="op" id="3638585">(</span><span class="ident" id="3638586">ifindex</span>&nbsp;<span class="builtintype" id="3638594">int</span><span class="op" id="3638597">)</span>&nbsp;<span class="op" id="3638599">(</span><span class="op" id="3638600">[</span><span class="op" id="3638601">]</span><span class="ident" id="3638602">Interface</span><span class="op" id="3638611">,</span>&nbsp;<span class="builtintype" id="3638613">error</span><span class="op" id="3638618">)</span>&nbsp;<span class="op" id="3638620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3638623">tab</span><span class="op" id="3638626">,</span>&nbsp;<span class="ident" id="3638628">err</span>&nbsp;<span class="op" id="3638632">:=</span>&nbsp;<span class="ident" id="3638635">syscall</span><span class="op" id="3638642">.</span><span class="ident" id="3638643">NetlinkRIB</span><span class="op" id="3638653">(</span><span class="ident" id="3638654">syscall</span><span class="op" id="3638661">.</span><span class="ident" id="3638662">RTM_GETLINK</span><span class="op" id="3638673">,</span>&nbsp;<span class="ident" id="3638675">syscall</span><span class="op" id="3638682">.</span><span class="ident" id="3638683">AF_UNSPEC</span><span class="op" id="3638692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638695">if</span>&nbsp;<span class="ident" id="3638698">err</span>&nbsp;<span class="op" id="3638702">!=</span>&nbsp;<span class="ident" id="3638705">nil</span>&nbsp;<span class="op" id="3638709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638713">return</span>&nbsp;<span class="ident" id="3638720">nil</span><span class="op" id="3638723">,</span>&nbsp;<span class="ident" id="3638725">os</span><span class="op" id="3638727">.</span><span class="ident" id="3638728">NewSyscallError</span><span class="op" id="3638743">(</span><span class="string" id="3638744">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3638757">,</span>&nbsp;<span class="ident" id="3638759">err</span><span class="op" id="3638762">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3638765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3638768">msgs</span><span class="op" id="3638772">,</span>&nbsp;<span class="ident" id="3638774">err</span>&nbsp;<span class="op" id="3638778">:=</span>&nbsp;<span class="ident" id="3638781">syscall</span><span class="op" id="3638788">.</span><span class="ident" id="3638789">ParseNetlinkMessage</span><span class="op" id="3638808">(</span><span class="ident" id="3638809">tab</span><span class="op" id="3638812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638815">if</span>&nbsp;<span class="ident" id="3638818">err</span>&nbsp;<span class="op" id="3638822">!=</span>&nbsp;<span class="ident" id="3638825">nil</span>&nbsp;<span class="op" id="3638829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638833">return</span>&nbsp;<span class="ident" id="3638840">nil</span><span class="op" id="3638843">,</span>&nbsp;<span class="ident" id="3638845">os</span><span class="op" id="3638847">.</span><span class="ident" id="3638848">NewSyscallError</span><span class="op" id="3638863">(</span><span class="string" id="3638864">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3638881">,</span>&nbsp;<span class="ident" id="3638883">err</span><span class="op" id="3638886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3638889">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638892">var</span>&nbsp;<span class="ident" id="3638896">ift</span>&nbsp;<span class="op" id="3638900">[</span><span class="op" id="3638901">]</span><span class="ident" id="3638902">Interface</span><br>
<span class="lineno"></span><span class="ident" id="3638912">loop</span><span class="op" id="3638916">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638919">for</span>&nbsp;<span class="ident" id="3638923">_</span><span class="op" id="3638924">,</span>&nbsp;<span class="ident" id="3638926">m</span>&nbsp;<span class="op" id="3638928">:=</span>&nbsp;<span class="keyword" id="3638931">range</span>&nbsp;<span class="ident" id="3638937">msgs</span>&nbsp;<span class="op" id="3638942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638946">switch</span>&nbsp;<span class="ident" id="3638953">m</span><span class="op" id="3638954">.</span><span class="ident" id="3638955">Header</span><span class="op" id="3638961">.</span><span class="ident" id="3638962">Type</span>&nbsp;<span class="op" id="3638967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638971">case</span>&nbsp;<span class="ident" id="3638976">syscall</span><span class="op" id="3638983">.</span><span class="ident" id="3638984">NLMSG_DONE</span><span class="op" id="3638994">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3638999">break</span>&nbsp;<span class="ident" id="3639005">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639012">case</span>&nbsp;<span class="ident" id="3639017">syscall</span><span class="op" id="3639024">.</span><span class="ident" id="3639025">RTM_NEWLINK</span><span class="op" id="3639036">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639041">ifim</span>&nbsp;<span class="op" id="3639046">:=</span>&nbsp;<span class="op" id="3639049">(</span><span class="op" id="3639050">*</span><span class="ident" id="3639051">syscall</span><span class="op" id="3639058">.</span><span class="ident" id="3639059">IfInfomsg</span><span class="op" id="3639068">)</span><span class="op" id="3639069">(</span><span class="ident" id="3639070">unsafe</span><span class="op" id="3639076">.</span><span class="ident" id="3639077">Pointer</span><span class="op" id="3639084">(</span><span class="op" id="3639085">&amp;</span><span class="ident" id="3639086">m</span><span class="op" id="3639087">.</span><span class="ident" id="3639088">Data</span><span class="op" id="3639092">[</span><span class="num" id="3639093">0</span><span class="op" id="3639094">]</span><span class="op" id="3639095">)</span><span class="op" id="3639096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639101">if</span>&nbsp;<span class="ident" id="3639104">ifindex</span>&nbsp;<span class="op" id="3639112">==</span>&nbsp;<span class="num" id="3639115">0</span>&nbsp;<span class="op" id="3639117">||</span>&nbsp;<span class="ident" id="3639120">ifindex</span>&nbsp;<span class="op" id="3639128">==</span>&nbsp;<span class="builtintype" id="3639131">int</span><span class="op" id="3639134">(</span><span class="ident" id="3639135">ifim</span><span class="op" id="3639139">.</span><span class="ident" id="3639140">Index</span><span class="op" id="3639145">)</span>&nbsp;<span class="op" id="3639147">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639153">attrs</span><span class="op" id="3639158">,</span>&nbsp;<span class="ident" id="3639160">err</span>&nbsp;<span class="op" id="3639164">:=</span>&nbsp;<span class="ident" id="3639167">syscall</span><span class="op" id="3639174">.</span><span class="ident" id="3639175">ParseNetlinkRouteAttr</span><span class="op" id="3639196">(</span><span class="op" id="3639197">&amp;</span><span class="ident" id="3639198">m</span><span class="op" id="3639199">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639205">if</span>&nbsp;<span class="ident" id="3639208">err</span>&nbsp;<span class="op" id="3639212">!=</span>&nbsp;<span class="ident" id="3639215">nil</span>&nbsp;<span class="op" id="3639219">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639226">return</span>&nbsp;<span class="ident" id="3639233">nil</span><span class="op" id="3639236">,</span>&nbsp;<span class="ident" id="3639238">os</span><span class="op" id="3639240">.</span><span class="ident" id="3639241">NewSyscallError</span><span class="op" id="3639256">(</span><span class="string" id="3639257">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3639276">,</span>&nbsp;<span class="ident" id="3639278">err</span><span class="op" id="3639281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639293">ift</span>&nbsp;<span class="op" id="3639297">=</span>&nbsp;<span class="builtinfunc" id="3639299">append</span><span class="op" id="3639305">(</span><span class="ident" id="3639306">ift</span><span class="op" id="3639309">,</span>&nbsp;<span class="op" id="3639311">*</span><span class="ident" id="3639312">newLink</span><span class="op" id="3639319">(</span><span class="ident" id="3639320">ifim</span><span class="op" id="3639324">,</span>&nbsp;<span class="ident" id="3639326">attrs</span><span class="op" id="3639331">)</span><span class="op" id="3639332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639338">if</span>&nbsp;<span class="ident" id="3639341">ifindex</span>&nbsp;<span class="op" id="3639349">==</span>&nbsp;<span class="builtintype" id="3639352">int</span><span class="op" id="3639355">(</span><span class="ident" id="3639356">ifim</span><span class="op" id="3639360">.</span><span class="ident" id="3639361">Index</span><span class="op" id="3639366">)</span>&nbsp;<span class="op" id="3639368">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639375">break</span>&nbsp;<span class="ident" id="3639381">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639390">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639399">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3639402">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639405">return</span>&nbsp;<span class="ident" id="3639412">ift</span><span class="op" id="3639415">,</span>&nbsp;<span class="ident" id="3639417">nil</span><br>
<span class="lineno"></span><span class="op" id="3639421">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3639424">const</span>&nbsp;<span class="op" id="3639430">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3639433">//&nbsp;See&nbsp;linux/if_arp.h.</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3639457">//&nbsp;Note&nbsp;that&nbsp;Linux&nbsp;doesn&#39;t&nbsp;support&nbsp;IPv4&nbsp;over&nbsp;IPv6&nbsp;tunneling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639519">sysARPHardwareIPv4IPv4</span>&nbsp;<span class="op" id="3639542">=</span>&nbsp;<span class="num" id="3639544">768</span>&nbsp;<span class="comment" id="3639548">//&nbsp;IPv4&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639577">sysARPHardwareIPv6IPv6</span>&nbsp;<span class="op" id="3639600">=</span>&nbsp;<span class="num" id="3639602">769</span>&nbsp;<span class="comment" id="3639606">//&nbsp;IPv6&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639635">sysARPHardwareIPv6IPv4</span>&nbsp;<span class="op" id="3639658">=</span>&nbsp;<span class="num" id="3639660">776</span>&nbsp;<span class="comment" id="3639664">//&nbsp;IPv6&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639693">sysARPHardwareGREIPv4</span>&nbsp;&nbsp;<span class="op" id="3639716">=</span>&nbsp;<span class="num" id="3639718">778</span>&nbsp;<span class="comment" id="3639722">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv4&nbsp;tunneling</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639759">sysARPHardwareGREIPv6</span>&nbsp;&nbsp;<span class="op" id="3639782">=</span>&nbsp;<span class="num" id="3639784">823</span>&nbsp;<span class="comment" id="3639788">//&nbsp;any&nbsp;over&nbsp;GRE&nbsp;over&nbsp;IPv6&nbsp;tunneling</span><br>
<span class="lineno"></span><span class="op" id="3639824">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3639827">func</span>&nbsp;<span class="ident" id="3639832">newLink</span><span class="op" id="3639839">(</span><span class="ident" id="3639840">ifim</span>&nbsp;<span class="op" id="3639845">*</span><span class="ident" id="3639846">syscall</span><span class="op" id="3639853">.</span><span class="ident" id="3639854">IfInfomsg</span><span class="op" id="3639863">,</span>&nbsp;<span class="ident" id="3639865">attrs</span>&nbsp;<span class="op" id="3639871">[</span><span class="op" id="3639872">]</span><span class="ident" id="3639873">syscall</span><span class="op" id="3639880">.</span><span class="ident" id="3639881">NetlinkRouteAttr</span><span class="op" id="3639897">)</span>&nbsp;<span class="op" id="3639899">*</span><span class="ident" id="3639900">Interface</span>&nbsp;<span class="op" id="3639910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3639913">ifi</span>&nbsp;<span class="op" id="3639917">:=</span>&nbsp;<span class="op" id="3639920">&amp;</span><span class="ident" id="3639921">Interface</span><span class="op" id="3639930">{</span><span class="ident" id="3639931">Index</span><span class="op" id="3639936">:</span>&nbsp;<span class="builtintype" id="3639938">int</span><span class="op" id="3639941">(</span><span class="ident" id="3639942">ifim</span><span class="op" id="3639946">.</span><span class="ident" id="3639947">Index</span><span class="op" id="3639952">)</span><span class="op" id="3639953">,</span>&nbsp;<span class="ident" id="3639955">Flags</span><span class="op" id="3639960">:</span>&nbsp;<span class="ident" id="3639962">linkFlags</span><span class="op" id="3639971">(</span><span class="ident" id="3639972">ifim</span><span class="op" id="3639976">.</span><span class="ident" id="3639977">Flags</span><span class="op" id="3639982">)</span><span class="op" id="3639983">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3639986">for</span>&nbsp;<span class="ident" id="3639990">_</span><span class="op" id="3639991">,</span>&nbsp;<span class="ident" id="3639993">a</span>&nbsp;<span class="op" id="3639995">:=</span>&nbsp;<span class="keyword" id="3639998">range</span>&nbsp;<span class="ident" id="3640004">attrs</span>&nbsp;<span class="op" id="3640010">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640014">switch</span>&nbsp;<span class="ident" id="3640021">a</span><span class="op" id="3640022">.</span><span class="ident" id="3640023">Attr</span><span class="op" id="3640027">.</span><span class="ident" id="3640028">Type</span>&nbsp;<span class="op" id="3640033">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640037">case</span>&nbsp;<span class="ident" id="3640042">syscall</span><span class="op" id="3640049">.</span><span class="ident" id="3640050">IFLA_ADDRESS</span><span class="op" id="3640062">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3640067">//&nbsp;We&nbsp;never&nbsp;return&nbsp;any&nbsp;/32&nbsp;or&nbsp;/128&nbsp;IP&nbsp;address</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3640116">//&nbsp;prefix&nbsp;on&nbsp;any&nbsp;IP&nbsp;tunnel&nbsp;interface&nbsp;as&nbsp;the</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3640163">//&nbsp;hardware&nbsp;address.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640187">switch</span>&nbsp;<span class="builtinfunc" id="3640194">len</span><span class="op" id="3640197">(</span><span class="ident" id="3640198">a</span><span class="op" id="3640199">.</span><span class="ident" id="3640200">Value</span><span class="op" id="3640205">)</span>&nbsp;<span class="op" id="3640207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640212">case</span>&nbsp;<span class="ident" id="3640217">IPv4len</span><span class="op" id="3640224">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640230">switch</span>&nbsp;<span class="ident" id="3640237">ifim</span><span class="op" id="3640241">.</span><span class="ident" id="3640242">Type</span>&nbsp;<span class="op" id="3640247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640253">case</span>&nbsp;<span class="ident" id="3640258">sysARPHardwareIPv4IPv4</span><span class="op" id="3640280">,</span>&nbsp;<span class="ident" id="3640282">sysARPHardwareGREIPv4</span><span class="op" id="3640303">,</span>&nbsp;<span class="ident" id="3640305">sysARPHardwareIPv6IPv4</span><span class="op" id="3640327">:</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640334">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640347">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640352">case</span>&nbsp;<span class="ident" id="3640357">IPv6len</span><span class="op" id="3640364">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640370">switch</span>&nbsp;<span class="ident" id="3640377">ifim</span><span class="op" id="3640381">.</span><span class="ident" id="3640382">Type</span>&nbsp;<span class="op" id="3640387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640393">case</span>&nbsp;<span class="ident" id="3640398">sysARPHardwareIPv6IPv6</span><span class="op" id="3640420">,</span>&nbsp;<span class="ident" id="3640422">sysARPHardwareGREIPv6</span><span class="op" id="3640443">:</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640450">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640473">var</span>&nbsp;<span class="ident" id="3640477">nonzero</span>&nbsp;<span class="builtintype" id="3640485">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640493">for</span>&nbsp;<span class="ident" id="3640497">_</span><span class="op" id="3640498">,</span>&nbsp;<span class="ident" id="3640500">b</span>&nbsp;<span class="op" id="3640502">:=</span>&nbsp;<span class="keyword" id="3640505">range</span>&nbsp;<span class="ident" id="3640511">a</span><span class="op" id="3640512">.</span><span class="ident" id="3640513">Value</span>&nbsp;<span class="op" id="3640519">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640525">if</span>&nbsp;<span class="ident" id="3640528">b</span>&nbsp;<span class="op" id="3640530">!=</span>&nbsp;<span class="num" id="3640533">0</span>&nbsp;<span class="op" id="3640535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640542">nonzero</span>&nbsp;<span class="op" id="3640550">=</span>&nbsp;<span class="builtintype" id="3640552">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640562">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640577">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640582">if</span>&nbsp;<span class="ident" id="3640585">nonzero</span>&nbsp;<span class="op" id="3640593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640599">ifi</span><span class="op" id="3640602">.</span><span class="ident" id="3640603">HardwareAddr</span>&nbsp;<span class="op" id="3640616">=</span>&nbsp;<span class="ident" id="3640618">a</span><span class="op" id="3640619">.</span><span class="ident" id="3640620">Value</span><span class="op" id="3640625">[</span><span class="op" id="3640626">:</span><span class="op" id="3640627">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640636">case</span>&nbsp;<span class="ident" id="3640641">syscall</span><span class="op" id="3640648">.</span><span class="ident" id="3640649">IFLA_IFNAME</span><span class="op" id="3640660">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640665">ifi</span><span class="op" id="3640668">.</span><span class="ident" id="3640669">Name</span>&nbsp;<span class="op" id="3640674">=</span>&nbsp;<span class="builtintype" id="3640676">string</span><span class="op" id="3640682">(</span><span class="ident" id="3640683">a</span><span class="op" id="3640684">.</span><span class="ident" id="3640685">Value</span><span class="op" id="3640690">[</span><span class="op" id="3640691">:</span><span class="builtinfunc" id="3640692">len</span><span class="op" id="3640695">(</span><span class="ident" id="3640696">a</span><span class="op" id="3640697">.</span><span class="ident" id="3640698">Value</span><span class="op" id="3640703">)</span><span class="op" id="3640704">-</span><span class="num" id="3640705">1</span><span class="op" id="3640706">]</span><span class="op" id="3640707">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640711">case</span>&nbsp;<span class="ident" id="3640716">syscall</span><span class="op" id="3640723">.</span><span class="ident" id="3640724">IFLA_MTU</span><span class="op" id="3640732">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640737">ifi</span><span class="op" id="3640740">.</span><span class="ident" id="3640741">MTU</span>&nbsp;<span class="op" id="3640745">=</span>&nbsp;<span class="builtintype" id="3640747">int</span><span class="op" id="3640750">(</span><span class="op" id="3640751">*</span><span class="op" id="3640752">(</span><span class="op" id="3640753">*</span><span class="builtintype" id="3640754">uint32</span><span class="op" id="3640760">)</span><span class="op" id="3640761">(</span><span class="ident" id="3640762">unsafe</span><span class="op" id="3640768">.</span><span class="ident" id="3640769">Pointer</span><span class="op" id="3640776">(</span><span class="op" id="3640777">&amp;</span><span class="ident" id="3640778">a</span><span class="op" id="3640779">.</span><span class="ident" id="3640780">Value</span><span class="op" id="3640785">[</span><span class="op" id="3640786">:</span><span class="num" id="3640787">4</span><span class="op" id="3640788">]</span><span class="op" id="3640789">[</span><span class="num" id="3640790">0</span><span class="op" id="3640791">]</span><span class="op" id="3640792">)</span><span class="op" id="3640793">)</span><span class="op" id="3640794">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640798">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640804">return</span>&nbsp;<span class="ident" id="3640811">ifi</span><br>
<span class="lineno">95</span><span class="op" id="3640815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3640818">func</span>&nbsp;<span class="ident" id="3640823">linkFlags</span><span class="op" id="3640832">(</span><span class="ident" id="3640833">rawFlags</span>&nbsp;<span class="builtintype" id="3640842">uint32</span><span class="op" id="3640848">)</span>&nbsp;<span class="ident" id="3640850">Flags</span>&nbsp;<span class="op" id="3640856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640859">var</span>&nbsp;<span class="ident" id="3640863">f</span>&nbsp;<span class="ident" id="3640865">Flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640872">if</span>&nbsp;<span class="ident" id="3640875">rawFlags</span><span class="op" id="3640883">&amp;</span><span class="ident" id="3640884">syscall</span><span class="op" id="3640891">.</span><span class="ident" id="3640892">IFF_UP</span>&nbsp;<span class="op" id="3640899">!=</span>&nbsp;<span class="num" id="3640902">0</span>&nbsp;<span class="op" id="3640904">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640908">f</span>&nbsp;<span class="op" id="3640910">|=</span>&nbsp;<span class="ident" id="3640913">FlagUp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640924">if</span>&nbsp;<span class="ident" id="3640927">rawFlags</span><span class="op" id="3640935">&amp;</span><span class="ident" id="3640936">syscall</span><span class="op" id="3640943">.</span><span class="ident" id="3640944">IFF_BROADCAST</span>&nbsp;<span class="op" id="3640958">!=</span>&nbsp;<span class="num" id="3640961">0</span>&nbsp;<span class="op" id="3640963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3640967">f</span>&nbsp;<span class="op" id="3640969">|=</span>&nbsp;<span class="ident" id="3640972">FlagBroadcast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3640987">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3640990">if</span>&nbsp;<span class="ident" id="3640993">rawFlags</span><span class="op" id="3641001">&amp;</span><span class="ident" id="3641002">syscall</span><span class="op" id="3641009">.</span><span class="ident" id="3641010">IFF_LOOPBACK</span>&nbsp;<span class="op" id="3641023">!=</span>&nbsp;<span class="num" id="3641026">0</span>&nbsp;<span class="op" id="3641028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3641032">f</span>&nbsp;<span class="op" id="3641034">|=</span>&nbsp;<span class="ident" id="3641037">FlagLoopback</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3641051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641054">if</span>&nbsp;<span class="ident" id="3641057">rawFlags</span><span class="op" id="3641065">&amp;</span><span class="ident" id="3641066">syscall</span><span class="op" id="3641073">.</span><span class="ident" id="3641074">IFF_POINTOPOINT</span>&nbsp;<span class="op" id="3641090">!=</span>&nbsp;<span class="num" id="3641093">0</span>&nbsp;<span class="op" id="3641095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3641099">f</span>&nbsp;<span class="op" id="3641101">|=</span>&nbsp;<span class="ident" id="3641104">FlagPointToPoint</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3641122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641125">if</span>&nbsp;<span class="ident" id="3641128">rawFlags</span><span class="op" id="3641136">&amp;</span><span class="ident" id="3641137">syscall</span><span class="op" id="3641144">.</span><span class="ident" id="3641145">IFF_MULTICAST</span>&nbsp;<span class="op" id="3641159">!=</span>&nbsp;<span class="num" id="3641162">0</span>&nbsp;<span class="op" id="3641164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3641168">f</span>&nbsp;<span class="op" id="3641170">|=</span>&nbsp;<span class="ident" id="3641173">FlagMulticast</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3641188">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641191">return</span>&nbsp;<span class="ident" id="3641198">f</span><br>
<span class="lineno">115</span><span class="op" id="3641200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3641203">//&nbsp;If&nbsp;the&nbsp;ifi&nbsp;is&nbsp;nil,&nbsp;interfaceAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;all</span><br>
<span class="lineno"></span><span class="comment" id="3641270">//&nbsp;network&nbsp;interfaces.&nbsp;&nbsp;Otherwise&nbsp;it&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno"></span><span class="comment" id="3641340">//&nbsp;interface.</span><br>
<span class="lineno">120</span><span class="keyword" id="3641354">func</span>&nbsp;<span class="ident" id="3641359">interfaceAddrTable</span><span class="op" id="3641377">(</span><span class="ident" id="3641378">ifi</span>&nbsp;<span class="op" id="3641382">*</span><span class="ident" id="3641383">Interface</span><span class="op" id="3641392">)</span>&nbsp;<span class="op" id="3641394">(</span><span class="op" id="3641395">[</span><span class="op" id="3641396">]</span><span class="ident" id="3641397">Addr</span><span class="op" id="3641401">,</span>&nbsp;<span class="builtintype" id="3641403">error</span><span class="op" id="3641408">)</span>&nbsp;<span class="op" id="3641410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3641413">tab</span><span class="op" id="3641416">,</span>&nbsp;<span class="ident" id="3641418">err</span>&nbsp;<span class="op" id="3641422">:=</span>&nbsp;<span class="ident" id="3641425">syscall</span><span class="op" id="3641432">.</span><span class="ident" id="3641433">NetlinkRIB</span><span class="op" id="3641443">(</span><span class="ident" id="3641444">syscall</span><span class="op" id="3641451">.</span><span class="ident" id="3641452">RTM_GETADDR</span><span class="op" id="3641463">,</span>&nbsp;<span class="ident" id="3641465">syscall</span><span class="op" id="3641472">.</span><span class="ident" id="3641473">AF_UNSPEC</span><span class="op" id="3641482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641485">if</span>&nbsp;<span class="ident" id="3641488">err</span>&nbsp;<span class="op" id="3641492">!=</span>&nbsp;<span class="ident" id="3641495">nil</span>&nbsp;<span class="op" id="3641499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641503">return</span>&nbsp;<span class="ident" id="3641510">nil</span><span class="op" id="3641513">,</span>&nbsp;<span class="ident" id="3641515">os</span><span class="op" id="3641517">.</span><span class="ident" id="3641518">NewSyscallError</span><span class="op" id="3641533">(</span><span class="string" id="3641534">&#34;netlink&nbsp;rib&#34;</span><span class="op" id="3641547">,</span>&nbsp;<span class="ident" id="3641549">err</span><span class="op" id="3641552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3641555">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3641558">msgs</span><span class="op" id="3641562">,</span>&nbsp;<span class="ident" id="3641564">err</span>&nbsp;<span class="op" id="3641568">:=</span>&nbsp;<span class="ident" id="3641571">syscall</span><span class="op" id="3641578">.</span><span class="ident" id="3641579">ParseNetlinkMessage</span><span class="op" id="3641598">(</span><span class="ident" id="3641599">tab</span><span class="op" id="3641602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641605">if</span>&nbsp;<span class="ident" id="3641608">err</span>&nbsp;<span class="op" id="3641612">!=</span>&nbsp;<span class="ident" id="3641615">nil</span>&nbsp;<span class="op" id="3641619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641623">return</span>&nbsp;<span class="ident" id="3641630">nil</span><span class="op" id="3641633">,</span>&nbsp;<span class="ident" id="3641635">os</span><span class="op" id="3641637">.</span><span class="ident" id="3641638">NewSyscallError</span><span class="op" id="3641653">(</span><span class="string" id="3641654">&#34;netlink&nbsp;message&#34;</span><span class="op" id="3641671">,</span>&nbsp;<span class="ident" id="3641673">err</span><span class="op" id="3641676">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3641679">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641682">var</span>&nbsp;<span class="ident" id="3641686">ift</span>&nbsp;<span class="op" id="3641690">[</span><span class="op" id="3641691">]</span><span class="ident" id="3641692">Interface</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641703">if</span>&nbsp;<span class="ident" id="3641706">ifi</span>&nbsp;<span class="op" id="3641710">==</span>&nbsp;<span class="ident" id="3641713">nil</span>&nbsp;<span class="op" id="3641717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641721">var</span>&nbsp;<span class="ident" id="3641725">err</span>&nbsp;<span class="builtintype" id="3641729">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3641737">ift</span><span class="op" id="3641740">,</span>&nbsp;<span class="ident" id="3641742">err</span>&nbsp;<span class="op" id="3641746">=</span>&nbsp;<span class="ident" id="3641748">interfaceTable</span><span class="op" id="3641762">(</span><span class="num" id="3641763">0</span><span class="op" id="3641764">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641768">if</span>&nbsp;<span class="ident" id="3641771">err</span>&nbsp;<span class="op" id="3641775">!=</span>&nbsp;<span class="ident" id="3641778">nil</span>&nbsp;<span class="op" id="3641782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641787">return</span>&nbsp;<span class="ident" id="3641794">nil</span><span class="op" id="3641797">,</span>&nbsp;<span class="ident" id="3641799">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3641805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3641808">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3641811">ifat</span><span class="op" id="3641815">,</span>&nbsp;<span class="ident" id="3641817">err</span>&nbsp;<span class="op" id="3641821">:=</span>&nbsp;<span class="ident" id="3641824">addrTable</span><span class="op" id="3641833">(</span><span class="ident" id="3641834">ift</span><span class="op" id="3641837">,</span>&nbsp;<span class="ident" id="3641839">ifi</span><span class="op" id="3641842">,</span>&nbsp;<span class="ident" id="3641844">msgs</span><span class="op" id="3641848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641851">if</span>&nbsp;<span class="ident" id="3641854">err</span>&nbsp;<span class="op" id="3641858">!=</span>&nbsp;<span class="ident" id="3641861">nil</span>&nbsp;<span class="op" id="3641865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641869">return</span>&nbsp;<span class="ident" id="3641876">nil</span><span class="op" id="3641879">,</span>&nbsp;<span class="ident" id="3641881">err</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3641886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3641889">return</span>&nbsp;<span class="ident" id="3641896">ifat</span><span class="op" id="3641900">,</span>&nbsp;<span class="ident" id="3641902">nil</span><br>
<span class="lineno"></span><span class="op" id="3641906">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3641909">func</span>&nbsp;<span class="ident" id="3641914">addrTable</span><span class="op" id="3641923">(</span><span class="ident" id="3641924">ift</span>&nbsp;<span class="op" id="3641928">[</span><span class="op" id="3641929">]</span><span class="ident" id="3641930">Interface</span><span class="op" id="3641939">,</span>&nbsp;<span class="ident" id="3641941">ifi</span>&nbsp;<span class="op" id="3641945">*</span><span class="ident" id="3641946">Interface</span><span class="op" id="3641955">,</span>&nbsp;<span class="ident" id="3641957">msgs</span>&nbsp;<span class="op" id="3641962">[</span><span class="op" id="3641963">]</span><span class="ident" id="3641964">syscall</span><span class="op" id="3641971">.</span><span class="ident" id="3641972">NetlinkMessage</span><span class="op" id="3641986">)</span>&nbsp;<span class="op" id="3641988">(</span><span class="op" id="3641989">[</span><span class="op" id="3641990">]</span><span class="ident" id="3641991">Addr</span><span class="op" id="3641995">,</span>&nbsp;<span class="builtintype" id="3641997">error</span><span class="op" id="3642002">)</span>&nbsp;<span class="op" id="3642004">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642007">var</span>&nbsp;<span class="ident" id="3642011">ifat</span>&nbsp;<span class="op" id="3642016">[</span><span class="op" id="3642017">]</span><span class="ident" id="3642018">Addr</span><br>
<span class="lineno"></span><span class="ident" id="3642023">loop</span><span class="op" id="3642027">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642030">for</span>&nbsp;<span class="ident" id="3642034">_</span><span class="op" id="3642035">,</span>&nbsp;<span class="ident" id="3642037">m</span>&nbsp;<span class="op" id="3642039">:=</span>&nbsp;<span class="keyword" id="3642042">range</span>&nbsp;<span class="ident" id="3642048">msgs</span>&nbsp;<span class="op" id="3642053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642057">switch</span>&nbsp;<span class="ident" id="3642064">m</span><span class="op" id="3642065">.</span><span class="ident" id="3642066">Header</span><span class="op" id="3642072">.</span><span class="ident" id="3642073">Type</span>&nbsp;<span class="op" id="3642078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642082">case</span>&nbsp;<span class="ident" id="3642087">syscall</span><span class="op" id="3642094">.</span><span class="ident" id="3642095">NLMSG_DONE</span><span class="op" id="3642105">:</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642110">break</span>&nbsp;<span class="ident" id="3642116">loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642123">case</span>&nbsp;<span class="ident" id="3642128">syscall</span><span class="op" id="3642135">.</span><span class="ident" id="3642136">RTM_NEWADDR</span><span class="op" id="3642147">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642152">ifam</span>&nbsp;<span class="op" id="3642157">:=</span>&nbsp;<span class="op" id="3642160">(</span><span class="op" id="3642161">*</span><span class="ident" id="3642162">syscall</span><span class="op" id="3642169">.</span><span class="ident" id="3642170">IfAddrmsg</span><span class="op" id="3642179">)</span><span class="op" id="3642180">(</span><span class="ident" id="3642181">unsafe</span><span class="op" id="3642187">.</span><span class="ident" id="3642188">Pointer</span><span class="op" id="3642195">(</span><span class="op" id="3642196">&amp;</span><span class="ident" id="3642197">m</span><span class="op" id="3642198">.</span><span class="ident" id="3642199">Data</span><span class="op" id="3642203">[</span><span class="num" id="3642204">0</span><span class="op" id="3642205">]</span><span class="op" id="3642206">)</span><span class="op" id="3642207">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642212">if</span>&nbsp;<span class="builtinfunc" id="3642215">len</span><span class="op" id="3642218">(</span><span class="ident" id="3642219">ift</span><span class="op" id="3642222">)</span>&nbsp;<span class="op" id="3642224">!=</span>&nbsp;<span class="num" id="3642227">0</span>&nbsp;<span class="op" id="3642229">||</span>&nbsp;<span class="ident" id="3642232">ifi</span><span class="op" id="3642235">.</span><span class="ident" id="3642236">Index</span>&nbsp;<span class="op" id="3642242">==</span>&nbsp;<span class="builtintype" id="3642245">int</span><span class="op" id="3642248">(</span><span class="ident" id="3642249">ifam</span><span class="op" id="3642253">.</span><span class="ident" id="3642254">Index</span><span class="op" id="3642259">)</span>&nbsp;<span class="op" id="3642261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642267">if</span>&nbsp;<span class="builtinfunc" id="3642270">len</span><span class="op" id="3642273">(</span><span class="ident" id="3642274">ift</span><span class="op" id="3642277">)</span>&nbsp;<span class="op" id="3642279">!=</span>&nbsp;<span class="num" id="3642282">0</span>&nbsp;<span class="op" id="3642284">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642291">var</span>&nbsp;<span class="ident" id="3642295">err</span>&nbsp;<span class="builtintype" id="3642299">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642310">ifi</span><span class="op" id="3642313">,</span>&nbsp;<span class="ident" id="3642315">err</span>&nbsp;<span class="op" id="3642319">=</span>&nbsp;<span class="ident" id="3642321">interfaceByIndex</span><span class="op" id="3642337">(</span><span class="ident" id="3642338">ift</span><span class="op" id="3642341">,</span>&nbsp;<span class="builtintype" id="3642343">int</span><span class="op" id="3642346">(</span><span class="ident" id="3642347">ifam</span><span class="op" id="3642351">.</span><span class="ident" id="3642352">Index</span><span class="op" id="3642357">)</span><span class="op" id="3642358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642365">if</span>&nbsp;<span class="ident" id="3642368">err</span>&nbsp;<span class="op" id="3642372">!=</span>&nbsp;<span class="ident" id="3642375">nil</span>&nbsp;<span class="op" id="3642379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642387">return</span>&nbsp;<span class="ident" id="3642394">nil</span><span class="op" id="3642397">,</span>&nbsp;<span class="ident" id="3642399">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3642408">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3642414">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642420">attrs</span><span class="op" id="3642425">,</span>&nbsp;<span class="ident" id="3642427">err</span>&nbsp;<span class="op" id="3642431">:=</span>&nbsp;<span class="ident" id="3642434">syscall</span><span class="op" id="3642441">.</span><span class="ident" id="3642442">ParseNetlinkRouteAttr</span><span class="op" id="3642463">(</span><span class="op" id="3642464">&amp;</span><span class="ident" id="3642465">m</span><span class="op" id="3642466">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642472">if</span>&nbsp;<span class="ident" id="3642475">err</span>&nbsp;<span class="op" id="3642479">!=</span>&nbsp;<span class="ident" id="3642482">nil</span>&nbsp;<span class="op" id="3642486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642493">return</span>&nbsp;<span class="ident" id="3642500">nil</span><span class="op" id="3642503">,</span>&nbsp;<span class="ident" id="3642505">os</span><span class="op" id="3642507">.</span><span class="ident" id="3642508">NewSyscallError</span><span class="op" id="3642523">(</span><span class="string" id="3642524">&#34;netlink&nbsp;routeattr&#34;</span><span class="op" id="3642543">,</span>&nbsp;<span class="ident" id="3642545">err</span><span class="op" id="3642548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3642554">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642560">ifa</span>&nbsp;<span class="op" id="3642564">:=</span>&nbsp;<span class="ident" id="3642567">newAddr</span><span class="op" id="3642574">(</span><span class="ident" id="3642575">ifi</span><span class="op" id="3642578">,</span>&nbsp;<span class="ident" id="3642580">ifam</span><span class="op" id="3642584">,</span>&nbsp;<span class="ident" id="3642586">attrs</span><span class="op" id="3642591">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642597">if</span>&nbsp;<span class="ident" id="3642600">ifa</span>&nbsp;<span class="op" id="3642604">!=</span>&nbsp;<span class="ident" id="3642607">nil</span>&nbsp;<span class="op" id="3642611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3642618">ifat</span>&nbsp;<span class="op" id="3642623">=</span>&nbsp;<span class="builtinfunc" id="3642625">append</span><span class="op" id="3642631">(</span><span class="ident" id="3642632">ifat</span><span class="op" id="3642636">,</span>&nbsp;<span class="ident" id="3642638">ifa</span><span class="op" id="3642641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3642647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3642652">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3642656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3642659">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642662">return</span>&nbsp;<span class="ident" id="3642669">ifat</span><span class="op" id="3642673">,</span>&nbsp;<span class="ident" id="3642675">nil</span><br>
<span class="lineno"></span><span class="op" id="3642679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="3642682">func</span>&nbsp;<span class="ident" id="3642687">newAddr</span><span class="op" id="3642694">(</span><span class="ident" id="3642695">ifi</span>&nbsp;<span class="op" id="3642699">*</span><span class="ident" id="3642700">Interface</span><span class="op" id="3642709">,</span>&nbsp;<span class="ident" id="3642711">ifam</span>&nbsp;<span class="op" id="3642716">*</span><span class="ident" id="3642717">syscall</span><span class="op" id="3642724">.</span><span class="ident" id="3642725">IfAddrmsg</span><span class="op" id="3642734">,</span>&nbsp;<span class="ident" id="3642736">attrs</span>&nbsp;<span class="op" id="3642742">[</span><span class="op" id="3642743">]</span><span class="ident" id="3642744">syscall</span><span class="op" id="3642751">.</span><span class="ident" id="3642752">NetlinkRouteAttr</span><span class="op" id="3642768">)</span>&nbsp;<span class="ident" id="3642770">Addr</span>&nbsp;<span class="op" id="3642775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642778">var</span>&nbsp;<span class="ident" id="3642782">ipPointToPoint</span>&nbsp;<span class="builtintype" id="3642797">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3642803">//&nbsp;Seems&nbsp;like&nbsp;we&nbsp;need&nbsp;to&nbsp;make&nbsp;sure&nbsp;whether&nbsp;the&nbsp;IP&nbsp;interface</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3642864">//&nbsp;stack&nbsp;consists&nbsp;of&nbsp;IP&nbsp;point-to-point&nbsp;numbered&nbsp;or&nbsp;unnumbered</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3642927">//&nbsp;addressing&nbsp;over&nbsp;point-to-point&nbsp;link&nbsp;encapsulation.</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3642982">if</span>&nbsp;<span class="ident" id="3642985">ifi</span><span class="op" id="3642988">.</span><span class="ident" id="3642989">Flags</span><span class="op" id="3642994">&amp;</span><span class="ident" id="3642995">FlagPointToPoint</span>&nbsp;<span class="op" id="3643012">!=</span>&nbsp;<span class="num" id="3643015">0</span>&nbsp;<span class="op" id="3643017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643021">for</span>&nbsp;<span class="ident" id="3643025">_</span><span class="op" id="3643026">,</span>&nbsp;<span class="ident" id="3643028">a</span>&nbsp;<span class="op" id="3643030">:=</span>&nbsp;<span class="keyword" id="3643033">range</span>&nbsp;<span class="ident" id="3643039">attrs</span>&nbsp;<span class="op" id="3643045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643050">if</span>&nbsp;<span class="ident" id="3643053">a</span><span class="op" id="3643054">.</span><span class="ident" id="3643055">Attr</span><span class="op" id="3643059">.</span><span class="ident" id="3643060">Type</span>&nbsp;<span class="op" id="3643065">==</span>&nbsp;<span class="ident" id="3643068">syscall</span><span class="op" id="3643075">.</span><span class="ident" id="3643076">IFA_LOCAL</span>&nbsp;<span class="op" id="3643086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643092">ipPointToPoint</span>&nbsp;<span class="op" id="3643107">=</span>&nbsp;<span class="builtintype" id="3643109">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643118">break</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643137">for</span>&nbsp;<span class="ident" id="3643141">_</span><span class="op" id="3643142">,</span>&nbsp;<span class="ident" id="3643144">a</span>&nbsp;<span class="op" id="3643146">:=</span>&nbsp;<span class="keyword" id="3643149">range</span>&nbsp;<span class="ident" id="3643155">attrs</span>&nbsp;<span class="op" id="3643161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643165">if</span>&nbsp;<span class="ident" id="3643168">ipPointToPoint</span>&nbsp;<span class="op" id="3643183">&amp;&amp;</span>&nbsp;<span class="ident" id="3643186">a</span><span class="op" id="3643187">.</span><span class="ident" id="3643188">Attr</span><span class="op" id="3643192">.</span><span class="ident" id="3643193">Type</span>&nbsp;<span class="op" id="3643198">==</span>&nbsp;<span class="ident" id="3643201">syscall</span><span class="op" id="3643208">.</span><span class="ident" id="3643209">IFA_ADDRESS</span>&nbsp;<span class="op" id="3643221">||</span>&nbsp;<span class="op" id="3643224">!</span><span class="ident" id="3643225">ipPointToPoint</span>&nbsp;<span class="op" id="3643240">&amp;&amp;</span>&nbsp;<span class="ident" id="3643243">a</span><span class="op" id="3643244">.</span><span class="ident" id="3643245">Attr</span><span class="op" id="3643249">.</span><span class="ident" id="3643250">Type</span>&nbsp;<span class="op" id="3643255">==</span>&nbsp;<span class="ident" id="3643258">syscall</span><span class="op" id="3643265">.</span><span class="ident" id="3643266">IFA_LOCAL</span>&nbsp;<span class="op" id="3643276">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643281">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643296">switch</span>&nbsp;<span class="ident" id="3643303">ifam</span><span class="op" id="3643307">.</span><span class="ident" id="3643308">Family</span>&nbsp;<span class="op" id="3643315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643319">case</span>&nbsp;<span class="ident" id="3643324">syscall</span><span class="op" id="3643331">.</span><span class="ident" id="3643332">AF_INET</span><span class="op" id="3643339">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643344">return</span>&nbsp;<span class="op" id="3643351">&amp;</span><span class="ident" id="3643352">IPNet</span><span class="op" id="3643357">{</span><span class="ident" id="3643358">IP</span><span class="op" id="3643360">:</span>&nbsp;<span class="ident" id="3643362">IPv4</span><span class="op" id="3643366">(</span><span class="ident" id="3643367">a</span><span class="op" id="3643368">.</span><span class="ident" id="3643369">Value</span><span class="op" id="3643374">[</span><span class="num" id="3643375">0</span><span class="op" id="3643376">]</span><span class="op" id="3643377">,</span>&nbsp;<span class="ident" id="3643379">a</span><span class="op" id="3643380">.</span><span class="ident" id="3643381">Value</span><span class="op" id="3643386">[</span><span class="num" id="3643387">1</span><span class="op" id="3643388">]</span><span class="op" id="3643389">,</span>&nbsp;<span class="ident" id="3643391">a</span><span class="op" id="3643392">.</span><span class="ident" id="3643393">Value</span><span class="op" id="3643398">[</span><span class="num" id="3643399">2</span><span class="op" id="3643400">]</span><span class="op" id="3643401">,</span>&nbsp;<span class="ident" id="3643403">a</span><span class="op" id="3643404">.</span><span class="ident" id="3643405">Value</span><span class="op" id="3643410">[</span><span class="num" id="3643411">3</span><span class="op" id="3643412">]</span><span class="op" id="3643413">)</span><span class="op" id="3643414">,</span>&nbsp;<span class="ident" id="3643416">Mask</span><span class="op" id="3643420">:</span>&nbsp;<span class="ident" id="3643422">CIDRMask</span><span class="op" id="3643430">(</span><span class="builtintype" id="3643431">int</span><span class="op" id="3643434">(</span><span class="ident" id="3643435">ifam</span><span class="op" id="3643439">.</span><span class="ident" id="3643440">Prefixlen</span><span class="op" id="3643449">)</span><span class="op" id="3643450">,</span>&nbsp;<span class="num" id="3643452">8</span><span class="op" id="3643453">*</span><span class="ident" id="3643454">IPv4len</span><span class="op" id="3643461">)</span><span class="op" id="3643462">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643466">case</span>&nbsp;<span class="ident" id="3643471">syscall</span><span class="op" id="3643478">.</span><span class="ident" id="3643479">AF_INET6</span><span class="op" id="3643487">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643492">ifa</span>&nbsp;<span class="op" id="3643496">:=</span>&nbsp;<span class="op" id="3643499">&amp;</span><span class="ident" id="3643500">IPNet</span><span class="op" id="3643505">{</span><span class="ident" id="3643506">IP</span><span class="op" id="3643508">:</span>&nbsp;<span class="builtinfunc" id="3643510">make</span><span class="op" id="3643514">(</span><span class="ident" id="3643515">IP</span><span class="op" id="3643517">,</span>&nbsp;<span class="ident" id="3643519">IPv6len</span><span class="op" id="3643526">)</span><span class="op" id="3643527">,</span>&nbsp;<span class="ident" id="3643529">Mask</span><span class="op" id="3643533">:</span>&nbsp;<span class="ident" id="3643535">CIDRMask</span><span class="op" id="3643543">(</span><span class="builtintype" id="3643544">int</span><span class="op" id="3643547">(</span><span class="ident" id="3643548">ifam</span><span class="op" id="3643552">.</span><span class="ident" id="3643553">Prefixlen</span><span class="op" id="3643562">)</span><span class="op" id="3643563">,</span>&nbsp;<span class="num" id="3643565">8</span><span class="op" id="3643566">*</span><span class="ident" id="3643567">IPv6len</span><span class="op" id="3643574">)</span><span class="op" id="3643575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3643580">copy</span><span class="op" id="3643584">(</span><span class="ident" id="3643585">ifa</span><span class="op" id="3643588">.</span><span class="ident" id="3643589">IP</span><span class="op" id="3643591">,</span>&nbsp;<span class="ident" id="3643593">a</span><span class="op" id="3643594">.</span><span class="ident" id="3643595">Value</span><span class="op" id="3643600">[</span><span class="op" id="3643601">:</span><span class="op" id="3643602">]</span><span class="op" id="3643603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643608">return</span>&nbsp;<span class="ident" id="3643615">ifa</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643621">}</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3643624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643627">return</span>&nbsp;<span class="ident" id="3643634">nil</span><br>
<span class="lineno"></span><span class="op" id="3643638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3643641">//&nbsp;interfaceMulticastAddrTable&nbsp;returns&nbsp;addresses&nbsp;for&nbsp;a&nbsp;specific</span><br>
<span class="lineno">205</span><span class="comment" id="3643705">//&nbsp;interface.</span><br>
<span class="lineno"></span><span class="keyword" id="3643719">func</span>&nbsp;<span class="ident" id="3643724">interfaceMulticastAddrTable</span><span class="op" id="3643751">(</span><span class="ident" id="3643752">ifi</span>&nbsp;<span class="op" id="3643756">*</span><span class="ident" id="3643757">Interface</span><span class="op" id="3643766">)</span>&nbsp;<span class="op" id="3643768">(</span><span class="op" id="3643769">[</span><span class="op" id="3643770">]</span><span class="ident" id="3643771">Addr</span><span class="op" id="3643775">,</span>&nbsp;<span class="builtintype" id="3643777">error</span><span class="op" id="3643782">)</span>&nbsp;<span class="op" id="3643784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643787">ifmat4</span>&nbsp;<span class="op" id="3643794">:=</span>&nbsp;<span class="ident" id="3643797">parseProcNetIGMP</span><span class="op" id="3643813">(</span><span class="string" id="3643814">&#34;/proc/net/igmp&#34;</span><span class="op" id="3643830">,</span>&nbsp;<span class="ident" id="3643832">ifi</span><span class="op" id="3643835">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643838">ifmat6</span>&nbsp;<span class="op" id="3643845">:=</span>&nbsp;<span class="ident" id="3643848">parseProcNetIGMP6</span><span class="op" id="3643865">(</span><span class="string" id="3643866">&#34;/proc/net/igmp6&#34;</span><span class="op" id="3643883">,</span>&nbsp;<span class="ident" id="3643885">ifi</span><span class="op" id="3643888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3643891">return</span>&nbsp;<span class="builtinfunc" id="3643898">append</span><span class="op" id="3643904">(</span><span class="ident" id="3643905">ifmat4</span><span class="op" id="3643911">,</span>&nbsp;<span class="ident" id="3643913">ifmat6</span><span class="op" id="3643919">...</span><span class="op" id="3643922">)</span><span class="op" id="3643923">,</span>&nbsp;<span class="ident" id="3643925">nil</span><br>
<span class="lineno">210</span><span class="op" id="3643929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3643932">func</span>&nbsp;<span class="ident" id="3643937">parseProcNetIGMP</span><span class="op" id="3643953">(</span><span class="ident" id="3643954">path</span>&nbsp;<span class="builtintype" id="3643959">string</span><span class="op" id="3643965">,</span>&nbsp;<span class="ident" id="3643967">ifi</span>&nbsp;<span class="op" id="3643971">*</span><span class="ident" id="3643972">Interface</span><span class="op" id="3643981">)</span>&nbsp;<span class="op" id="3643983">[</span><span class="op" id="3643984">]</span><span class="ident" id="3643985">Addr</span>&nbsp;<span class="op" id="3643990">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3643993">fd</span><span class="op" id="3643995">,</span>&nbsp;<span class="ident" id="3643997">err</span>&nbsp;<span class="op" id="3644001">:=</span>&nbsp;<span class="ident" id="3644004">open</span><span class="op" id="3644008">(</span><span class="ident" id="3644009">path</span><span class="op" id="3644013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644016">if</span>&nbsp;<span class="ident" id="3644019">err</span>&nbsp;<span class="op" id="3644023">!=</span>&nbsp;<span class="ident" id="3644026">nil</span>&nbsp;<span class="op" id="3644030">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644034">return</span>&nbsp;<span class="ident" id="3644041">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3644046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644049">defer</span>&nbsp;<span class="ident" id="3644055">fd</span><span class="op" id="3644057">.</span><span class="builtinfunc" id="3644058">close</span><span class="op" id="3644063">(</span><span class="op" id="3644064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644067">var</span>&nbsp;<span class="op" id="3644071">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644075">ifmat</span>&nbsp;<span class="op" id="3644081">[</span><span class="op" id="3644082">]</span><span class="ident" id="3644083">Addr</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644090">name</span>&nbsp;&nbsp;<span class="builtintype" id="3644096">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3644104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644107">fd</span><span class="op" id="3644109">.</span><span class="ident" id="3644110">readLine</span><span class="op" id="3644118">(</span><span class="op" id="3644119">)</span>&nbsp;<span class="comment" id="3644121">//&nbsp;skip&nbsp;first&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644141">b</span>&nbsp;<span class="op" id="3644143">:=</span>&nbsp;<span class="builtinfunc" id="3644146">make</span><span class="op" id="3644150">(</span><span class="op" id="3644151">[</span><span class="op" id="3644152">]</span><span class="builtintype" id="3644153">byte</span><span class="op" id="3644157">,</span>&nbsp;<span class="ident" id="3644159">IPv4len</span><span class="op" id="3644166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644169">for</span>&nbsp;<span class="ident" id="3644173">l</span><span class="op" id="3644174">,</span>&nbsp;<span class="ident" id="3644176">ok</span>&nbsp;<span class="op" id="3644179">:=</span>&nbsp;<span class="ident" id="3644182">fd</span><span class="op" id="3644184">.</span><span class="ident" id="3644185">readLine</span><span class="op" id="3644193">(</span><span class="op" id="3644194">)</span><span class="op" id="3644195">;</span>&nbsp;<span class="ident" id="3644197">ok</span><span class="op" id="3644199">;</span>&nbsp;<span class="ident" id="3644201">l</span><span class="op" id="3644202">,</span>&nbsp;<span class="ident" id="3644204">ok</span>&nbsp;<span class="op" id="3644207">=</span>&nbsp;<span class="ident" id="3644209">fd</span><span class="op" id="3644211">.</span><span class="ident" id="3644212">readLine</span><span class="op" id="3644220">(</span><span class="op" id="3644221">)</span>&nbsp;<span class="op" id="3644223">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644227">f</span>&nbsp;<span class="op" id="3644229">:=</span>&nbsp;<span class="ident" id="3644232">splitAtBytes</span><span class="op" id="3644244">(</span><span class="ident" id="3644245">l</span><span class="op" id="3644246">,</span>&nbsp;<span class="string" id="3644248">&#34;&nbsp;:\r\t\n&#34;</span><span class="op" id="3644258">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644262">if</span>&nbsp;<span class="builtinfunc" id="3644265">len</span><span class="op" id="3644268">(</span><span class="ident" id="3644269">f</span><span class="op" id="3644270">)</span>&nbsp;<span class="op" id="3644272">&lt;</span>&nbsp;<span class="num" id="3644274">4</span>&nbsp;<span class="op" id="3644276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644281">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3644292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644296">switch</span>&nbsp;<span class="op" id="3644303">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644307">case</span>&nbsp;<span class="ident" id="3644312">l</span><span class="op" id="3644313">[</span><span class="num" id="3644314">0</span><span class="op" id="3644315">]</span>&nbsp;<span class="op" id="3644317">!=</span>&nbsp;<span class="string" id="3644320">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3644324">&amp;&amp;</span>&nbsp;<span class="ident" id="3644327">l</span><span class="op" id="3644328">[</span><span class="num" id="3644329">0</span><span class="op" id="3644330">]</span>&nbsp;<span class="op" id="3644332">!=</span>&nbsp;<span class="string" id="3644335">&#39;\t&#39;</span><span class="op" id="3644339">:</span>&nbsp;<span class="comment" id="3644341">//&nbsp;new&nbsp;interface&nbsp;line</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644366">name</span>&nbsp;<span class="op" id="3644371">=</span>&nbsp;<span class="ident" id="3644373">f</span><span class="op" id="3644374">[</span><span class="num" id="3644375">1</span><span class="op" id="3644376">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644380">case</span>&nbsp;<span class="builtinfunc" id="3644385">len</span><span class="op" id="3644388">(</span><span class="ident" id="3644389">f</span><span class="op" id="3644390">[</span><span class="num" id="3644391">0</span><span class="op" id="3644392">]</span><span class="op" id="3644393">)</span>&nbsp;<span class="op" id="3644395">==</span>&nbsp;<span class="num" id="3644398">8</span><span class="op" id="3644399">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644404">if</span>&nbsp;<span class="ident" id="3644407">ifi</span>&nbsp;<span class="op" id="3644411">==</span>&nbsp;<span class="ident" id="3644414">nil</span>&nbsp;<span class="op" id="3644418">||</span>&nbsp;<span class="ident" id="3644421">name</span>&nbsp;<span class="op" id="3644426">==</span>&nbsp;<span class="ident" id="3644429">ifi</span><span class="op" id="3644432">.</span><span class="ident" id="3644433">Name</span>&nbsp;<span class="op" id="3644438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3644444">//&nbsp;The&nbsp;Linux&nbsp;kernel&nbsp;puts&nbsp;the&nbsp;IP</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3644480">//&nbsp;address&nbsp;in&nbsp;/proc/net/igmp&nbsp;in&nbsp;native</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3644523">//&nbsp;endianness.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644542">for</span>&nbsp;<span class="ident" id="3644546">i</span>&nbsp;<span class="op" id="3644548">:=</span>&nbsp;<span class="num" id="3644551">0</span><span class="op" id="3644552">;</span>&nbsp;<span class="ident" id="3644554">i</span><span class="op" id="3644555">+</span><span class="num" id="3644556">1</span>&nbsp;<span class="op" id="3644558">&lt;</span>&nbsp;<span class="builtinfunc" id="3644560">len</span><span class="op" id="3644563">(</span><span class="ident" id="3644564">f</span><span class="op" id="3644565">[</span><span class="num" id="3644566">0</span><span class="op" id="3644567">]</span><span class="op" id="3644568">)</span><span class="op" id="3644569">;</span>&nbsp;<span class="ident" id="3644571">i</span>&nbsp;<span class="op" id="3644573">+=</span>&nbsp;<span class="num" id="3644576">2</span>&nbsp;<span class="op" id="3644578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644585">b</span><span class="op" id="3644586">[</span><span class="ident" id="3644587">i</span><span class="op" id="3644588">/</span><span class="num" id="3644589">2</span><span class="op" id="3644590">]</span><span class="op" id="3644591">,</span>&nbsp;<span class="ident" id="3644593">_</span>&nbsp;<span class="op" id="3644595">=</span>&nbsp;<span class="ident" id="3644597">xtoi2</span><span class="op" id="3644602">(</span><span class="ident" id="3644603">f</span><span class="op" id="3644604">[</span><span class="num" id="3644605">0</span><span class="op" id="3644606">]</span><span class="op" id="3644607">[</span><span class="ident" id="3644608">i</span><span class="op" id="3644609">:</span><span class="ident" id="3644610">i</span><span class="op" id="3644611">+</span><span class="num" id="3644612">2</span><span class="op" id="3644613">]</span><span class="op" id="3644614">,</span>&nbsp;<span class="num" id="3644616">0</span><span class="op" id="3644617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3644623">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644629">i</span>&nbsp;<span class="op" id="3644631">:=</span>&nbsp;<span class="op" id="3644634">*</span><span class="op" id="3644635">(</span><span class="op" id="3644636">*</span><span class="builtintype" id="3644637">uint32</span><span class="op" id="3644643">)</span><span class="op" id="3644644">(</span><span class="ident" id="3644645">unsafe</span><span class="op" id="3644651">.</span><span class="ident" id="3644652">Pointer</span><span class="op" id="3644659">(</span><span class="op" id="3644660">&amp;</span><span class="ident" id="3644661">b</span><span class="op" id="3644662">[</span><span class="op" id="3644663">:</span><span class="num" id="3644664">4</span><span class="op" id="3644665">]</span><span class="op" id="3644666">[</span><span class="num" id="3644667">0</span><span class="op" id="3644668">]</span><span class="op" id="3644669">)</span><span class="op" id="3644670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644676">ifma</span>&nbsp;<span class="op" id="3644681">:=</span>&nbsp;<span class="ident" id="3644684">IPAddr</span><span class="op" id="3644690">{</span><span class="ident" id="3644691">IP</span><span class="op" id="3644693">:</span>&nbsp;<span class="ident" id="3644695">IPv4</span><span class="op" id="3644699">(</span><span class="builtintype" id="3644700">byte</span><span class="op" id="3644704">(</span><span class="ident" id="3644705">i</span><span class="op" id="3644706">&gt;&gt;</span><span class="num" id="3644708">24</span><span class="op" id="3644710">)</span><span class="op" id="3644711">,</span>&nbsp;<span class="builtintype" id="3644713">byte</span><span class="op" id="3644717">(</span><span class="ident" id="3644718">i</span><span class="op" id="3644719">&gt;&gt;</span><span class="num" id="3644721">16</span><span class="op" id="3644723">)</span><span class="op" id="3644724">,</span>&nbsp;<span class="builtintype" id="3644726">byte</span><span class="op" id="3644730">(</span><span class="ident" id="3644731">i</span><span class="op" id="3644732">&gt;&gt;</span><span class="num" id="3644734">8</span><span class="op" id="3644735">)</span><span class="op" id="3644736">,</span>&nbsp;<span class="builtintype" id="3644738">byte</span><span class="op" id="3644742">(</span><span class="ident" id="3644743">i</span><span class="op" id="3644744">)</span><span class="op" id="3644745">)</span><span class="op" id="3644746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644752">ifmat</span>&nbsp;<span class="op" id="3644758">=</span>&nbsp;<span class="builtinfunc" id="3644760">append</span><span class="op" id="3644766">(</span><span class="ident" id="3644767">ifmat</span><span class="op" id="3644772">,</span>&nbsp;<span class="ident" id="3644774">ifma</span><span class="op" id="3644778">.</span><span class="ident" id="3644779">toAddr</span><span class="op" id="3644785">(</span><span class="op" id="3644786">)</span><span class="op" id="3644787">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3644792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3644796">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3644799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644802">return</span>&nbsp;<span class="ident" id="3644809">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3644815">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3644818">func</span>&nbsp;<span class="ident" id="3644823">parseProcNetIGMP6</span><span class="op" id="3644840">(</span><span class="ident" id="3644841">path</span>&nbsp;<span class="builtintype" id="3644846">string</span><span class="op" id="3644852">,</span>&nbsp;<span class="ident" id="3644854">ifi</span>&nbsp;<span class="op" id="3644858">*</span><span class="ident" id="3644859">Interface</span><span class="op" id="3644868">)</span>&nbsp;<span class="op" id="3644870">[</span><span class="op" id="3644871">]</span><span class="ident" id="3644872">Addr</span>&nbsp;<span class="op" id="3644877">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644880">fd</span><span class="op" id="3644882">,</span>&nbsp;<span class="ident" id="3644884">err</span>&nbsp;<span class="op" id="3644888">:=</span>&nbsp;<span class="ident" id="3644891">open</span><span class="op" id="3644895">(</span><span class="ident" id="3644896">path</span><span class="op" id="3644900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644903">if</span>&nbsp;<span class="ident" id="3644906">err</span>&nbsp;<span class="op" id="3644910">!=</span>&nbsp;<span class="ident" id="3644913">nil</span>&nbsp;<span class="op" id="3644917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644921">return</span>&nbsp;<span class="ident" id="3644928">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3644933">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644936">defer</span>&nbsp;<span class="ident" id="3644942">fd</span><span class="op" id="3644944">.</span><span class="builtinfunc" id="3644945">close</span><span class="op" id="3644950">(</span><span class="op" id="3644951">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3644954">var</span>&nbsp;<span class="ident" id="3644958">ifmat</span>&nbsp;<span class="op" id="3644964">[</span><span class="op" id="3644965">]</span><span class="ident" id="3644966">Addr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3644972">b</span>&nbsp;<span class="op" id="3644974">:=</span>&nbsp;<span class="builtinfunc" id="3644977">make</span><span class="op" id="3644981">(</span><span class="op" id="3644982">[</span><span class="op" id="3644983">]</span><span class="builtintype" id="3644984">byte</span><span class="op" id="3644988">,</span>&nbsp;<span class="ident" id="3644990">IPv6len</span><span class="op" id="3644997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3645000">for</span>&nbsp;<span class="ident" id="3645004">l</span><span class="op" id="3645005">,</span>&nbsp;<span class="ident" id="3645007">ok</span>&nbsp;<span class="op" id="3645010">:=</span>&nbsp;<span class="ident" id="3645013">fd</span><span class="op" id="3645015">.</span><span class="ident" id="3645016">readLine</span><span class="op" id="3645024">(</span><span class="op" id="3645025">)</span><span class="op" id="3645026">;</span>&nbsp;<span class="ident" id="3645028">ok</span><span class="op" id="3645030">;</span>&nbsp;<span class="ident" id="3645032">l</span><span class="op" id="3645033">,</span>&nbsp;<span class="ident" id="3645035">ok</span>&nbsp;<span class="op" id="3645038">=</span>&nbsp;<span class="ident" id="3645040">fd</span><span class="op" id="3645042">.</span><span class="ident" id="3645043">readLine</span><span class="op" id="3645051">(</span><span class="op" id="3645052">)</span>&nbsp;<span class="op" id="3645054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3645058">f</span>&nbsp;<span class="op" id="3645060">:=</span>&nbsp;<span class="ident" id="3645063">splitAtBytes</span><span class="op" id="3645075">(</span><span class="ident" id="3645076">l</span><span class="op" id="3645077">,</span>&nbsp;<span class="string" id="3645079">&#34;&nbsp;\r\t\n&#34;</span><span class="op" id="3645088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3645092">if</span>&nbsp;<span class="builtinfunc" id="3645095">len</span><span class="op" id="3645098">(</span><span class="ident" id="3645099">f</span><span class="op" id="3645100">)</span>&nbsp;<span class="op" id="3645102">&lt;</span>&nbsp;<span class="num" id="3645104">6</span>&nbsp;<span class="op" id="3645106">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3645111">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3645122">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3645126">if</span>&nbsp;<span class="ident" id="3645129">ifi</span>&nbsp;<span class="op" id="3645133">==</span>&nbsp;<span class="ident" id="3645136">nil</span>&nbsp;<span class="op" id="3645140">||</span>&nbsp;<span class="ident" id="3645143">f</span><span class="op" id="3645144">[</span><span class="num" id="3645145">1</span><span class="op" id="3645146">]</span>&nbsp;<span class="op" id="3645148">==</span>&nbsp;<span class="ident" id="3645151">ifi</span><span class="op" id="3645154">.</span><span class="ident" id="3645155">Name</span>&nbsp;<span class="op" id="3645160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3645165">for</span>&nbsp;<span class="ident" id="3645169">i</span>&nbsp;<span class="op" id="3645171">:=</span>&nbsp;<span class="num" id="3645174">0</span><span class="op" id="3645175">;</span>&nbsp;<span class="ident" id="3645177">i</span><span class="op" id="3645178">+</span><span class="num" id="3645179">1</span>&nbsp;<span class="op" id="3645181">&lt;</span>&nbsp;<span class="builtinfunc" id="3645183">len</span><span class="op" id="3645186">(</span><span class="ident" id="3645187">f</span><span class="op" id="3645188">[</span><span class="num" id="3645189">2</span><span class="op" id="3645190">]</span><span class="op" id="3645191">)</span><span class="op" id="3645192">;</span>&nbsp;<span class="ident" id="3645194">i</span>&nbsp;<span class="op" id="3645196">+=</span>&nbsp;<span class="num" id="3645199">2</span>&nbsp;<span class="op" id="3645201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3645207">b</span><span class="op" id="3645208">[</span><span class="ident" id="3645209">i</span><span class="op" id="3645210">/</span><span class="num" id="3645211">2</span><span class="op" id="3645212">]</span><span class="op" id="3645213">,</span>&nbsp;<span class="ident" id="3645215">_</span>&nbsp;<span class="op" id="3645217">=</span>&nbsp;<span class="ident" id="3645219">xtoi2</span><span class="op" id="3645224">(</span><span class="ident" id="3645225">f</span><span class="op" id="3645226">[</span><span class="num" id="3645227">2</span><span class="op" id="3645228">]</span><span class="op" id="3645229">[</span><span class="ident" id="3645230">i</span><span class="op" id="3645231">:</span><span class="ident" id="3645232">i</span><span class="op" id="3645233">+</span><span class="num" id="3645234">2</span><span class="op" id="3645235">]</span><span class="op" id="3645236">,</span>&nbsp;<span class="num" id="3645238">0</span><span class="op" id="3645239">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3645244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3645249">ifma</span>&nbsp;<span class="op" id="3645254">:=</span>&nbsp;<span class="ident" id="3645257">IPAddr</span><span class="op" id="3645263">{</span><span class="ident" id="3645264">IP</span><span class="op" id="3645266">:</span>&nbsp;<span class="ident" id="3645268">IP</span><span class="op" id="3645270">{</span><span class="ident" id="3645271">b</span><span class="op" id="3645272">[</span><span class="num" id="3645273">0</span><span class="op" id="3645274">]</span><span class="op" id="3645275">,</span>&nbsp;<span class="ident" id="3645277">b</span><span class="op" id="3645278">[</span><span class="num" id="3645279">1</span><span class="op" id="3645280">]</span><span class="op" id="3645281">,</span>&nbsp;<span class="ident" id="3645283">b</span><span class="op" id="3645284">[</span><span class="num" id="3645285">2</span><span class="op" id="3645286">]</span><span class="op" id="3645287">,</span>&nbsp;<span class="ident" id="3645289">b</span><span class="op" id="3645290">[</span><span class="num" id="3645291">3</span><span class="op" id="3645292">]</span><span class="op" id="3645293">,</span>&nbsp;<span class="ident" id="3645295">b</span><span class="op" id="3645296">[</span><span class="num" id="3645297">4</span><span class="op" id="3645298">]</span><span class="op" id="3645299">,</span>&nbsp;<span class="ident" id="3645301">b</span><span class="op" id="3645302">[</span><span class="num" id="3645303">5</span><span class="op" id="3645304">]</span><span class="op" id="3645305">,</span>&nbsp;<span class="ident" id="3645307">b</span><span class="op" id="3645308">[</span><span class="num" id="3645309">6</span><span class="op" id="3645310">]</span><span class="op" id="3645311">,</span>&nbsp;<span class="ident" id="3645313">b</span><span class="op" id="3645314">[</span><span class="num" id="3645315">7</span><span class="op" id="3645316">]</span><span class="op" id="3645317">,</span>&nbsp;<span class="ident" id="3645319">b</span><span class="op" id="3645320">[</span><span class="num" id="3645321">8</span><span class="op" id="3645322">]</span><span class="op" id="3645323">,</span>&nbsp;<span class="ident" id="3645325">b</span><span class="op" id="3645326">[</span><span class="num" id="3645327">9</span><span class="op" id="3645328">]</span><span class="op" id="3645329">,</span>&nbsp;<span class="ident" id="3645331">b</span><span class="op" id="3645332">[</span><span class="num" id="3645333">10</span><span class="op" id="3645335">]</span><span class="op" id="3645336">,</span>&nbsp;<span class="ident" id="3645338">b</span><span class="op" id="3645339">[</span><span class="num" id="3645340">11</span><span class="op" id="3645342">]</span><span class="op" id="3645343">,</span>&nbsp;<span class="ident" id="3645345">b</span><span class="op" id="3645346">[</span><span class="num" id="3645347">12</span><span class="op" id="3645349">]</span><span class="op" id="3645350">,</span>&nbsp;<span class="ident" id="3645352">b</span><span class="op" id="3645353">[</span><span class="num" id="3645354">13</span><span class="op" id="3645356">]</span><span class="op" id="3645357">,</span>&nbsp;<span class="ident" id="3645359">b</span><span class="op" id="3645360">[</span><span class="num" id="3645361">14</span><span class="op" id="3645363">]</span><span class="op" id="3645364">,</span>&nbsp;<span class="ident" id="3645366">b</span><span class="op" id="3645367">[</span><span class="num" id="3645368">15</span><span class="op" id="3645370">]</span><span class="op" id="3645371">}</span><span class="op" id="3645372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3645377">ifmat</span>&nbsp;<span class="op" id="3645383">=</span>&nbsp;<span class="builtinfunc" id="3645385">append</span><span class="op" id="3645391">(</span><span class="ident" id="3645392">ifmat</span><span class="op" id="3645397">,</span>&nbsp;<span class="ident" id="3645399">ifma</span><span class="op" id="3645403">.</span><span class="ident" id="3645404">toAddr</span><span class="op" id="3645410">(</span><span class="op" id="3645411">)</span><span class="op" id="3645412">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3645416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3645419">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3645422">return</span>&nbsp;<span class="ident" id="3645429">ifmat</span><br>
<span class="lineno"></span><span class="op" id="3645435">}</span>
</div>
</body>
</html>
