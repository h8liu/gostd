<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha512</h2>
<ul>
<li><a href="/gostd/crypto/sha512/sha512.go.html">sha512.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512_test.go.html">sha512_test.go</a></li>
<li><a href="/gostd/crypto/sha512/sha512block_decl.go.html">sha512block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3929244">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3929299">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3929353">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3929404">//&nbsp;Package&nbsp;sha512&nbsp;implements&nbsp;the&nbsp;SHA384&nbsp;and&nbsp;SHA512&nbsp;hash&nbsp;algorithms&nbsp;as&nbsp;defined</span><br>
<span class="lineno"></span><span class="comment" id="3929482">//&nbsp;in&nbsp;FIPS&nbsp;180-2.</span><br>
<span class="lineno"></span><span class="keyword" id="3929500">package</span>&nbsp;<span class="ident" id="3929508">sha512</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3929516">import</span>&nbsp;<span class="op" id="3929523">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3929526">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3929536">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="3929543">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3929546">func</span>&nbsp;<span class="ident" id="3929551">init</span><span class="op" id="3929555">(</span><span class="op" id="3929556">)</span>&nbsp;<span class="op" id="3929558">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929561">crypto</span><span class="op" id="3929567">.</span><span class="ident" id="3929568">RegisterHash</span><span class="op" id="3929580">(</span><span class="ident" id="3929581">crypto</span><span class="op" id="3929587">.</span><span class="ident" id="3929588">SHA384</span><span class="op" id="3929594">,</span>&nbsp;<span class="ident" id="3929596">New384</span><span class="op" id="3929602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929605">crypto</span><span class="op" id="3929611">.</span><span class="ident" id="3929612">RegisterHash</span><span class="op" id="3929624">(</span><span class="ident" id="3929625">crypto</span><span class="op" id="3929631">.</span><span class="ident" id="3929632">SHA512</span><span class="op" id="3929638">,</span>&nbsp;<span class="ident" id="3929640">New</span><span class="op" id="3929643">)</span><br>
<span class="lineno"></span><span class="op" id="3929645">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3929648">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA512&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno">20</span><span class="keyword" id="3929691">const</span>&nbsp;<span class="ident" id="3929697">Size</span>&nbsp;<span class="op" id="3929702">=</span>&nbsp;<span class="num" id="3929704">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3929708">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA384&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3929751">const</span>&nbsp;<span class="ident" id="3929757">Size384</span>&nbsp;<span class="op" id="3929765">=</span>&nbsp;<span class="num" id="3929767">48</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="comment" id="3929771">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA512&nbsp;and&nbsp;SHA384&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="3929819">const</span>&nbsp;<span class="ident" id="3929825">BlockSize</span>&nbsp;<span class="op" id="3929835">=</span>&nbsp;<span class="num" id="3929837">128</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3929842">const</span>&nbsp;<span class="op" id="3929848">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929851">chunk</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3929861">=</span>&nbsp;<span class="num" id="3929863">128</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929868">init0</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3929878">=</span>&nbsp;<span class="num" id="3929880">0x6a09e667f3bcc908</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929900">init1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3929910">=</span>&nbsp;<span class="num" id="3929912">0xbb67ae8584caa73b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929932">init2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3929942">=</span>&nbsp;<span class="num" id="3929944">0x3c6ef372fe94f82b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929964">init3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3929974">=</span>&nbsp;<span class="num" id="3929976">0xa54ff53a5f1d36f1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3929996">init4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930006">=</span>&nbsp;<span class="num" id="3930008">0x510e527fade682d1</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930028">init5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930038">=</span>&nbsp;<span class="num" id="3930040">0x9b05688c2b3e6c1f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930060">init6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930070">=</span>&nbsp;<span class="num" id="3930072">0x1f83d9abfb41bd6b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930092">init7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930102">=</span>&nbsp;<span class="num" id="3930104">0x5be0cd19137e2179</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930124">init0_384</span>&nbsp;<span class="op" id="3930134">=</span>&nbsp;<span class="num" id="3930136">0xcbbb9d5dc1059ed8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930156">init1_384</span>&nbsp;<span class="op" id="3930166">=</span>&nbsp;<span class="num" id="3930168">0x629a292a367cd507</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930188">init2_384</span>&nbsp;<span class="op" id="3930198">=</span>&nbsp;<span class="num" id="3930200">0x9159015a3070dd17</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930220">init3_384</span>&nbsp;<span class="op" id="3930230">=</span>&nbsp;<span class="num" id="3930232">0x152fecd8f70e5939</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930252">init4_384</span>&nbsp;<span class="op" id="3930262">=</span>&nbsp;<span class="num" id="3930264">0x67332667ffc00b31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930284">init5_384</span>&nbsp;<span class="op" id="3930294">=</span>&nbsp;<span class="num" id="3930296">0x8eb44a8768581511</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930316">init6_384</span>&nbsp;<span class="op" id="3930326">=</span>&nbsp;<span class="num" id="3930328">0xdb0c2e0d64f98fa7</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930348">init7_384</span>&nbsp;<span class="op" id="3930358">=</span>&nbsp;<span class="num" id="3930360">0x47b5481dbefa4fa4</span><br>
<span class="lineno"></span><span class="op" id="3930379">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3930382">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="3930441">type</span>&nbsp;<span class="ident" id="3930446">digest</span>&nbsp;<span class="keyword" id="3930453">struct</span>&nbsp;<span class="op" id="3930460">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930463">h</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930469">[</span><span class="num" id="3930470">8</span><span class="op" id="3930471">]</span><span class="ident" id="3930472">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930480">x</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3930486">[</span><span class="ident" id="3930487">chunk</span><span class="op" id="3930492">]</span><span class="builtintype" id="3930493">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930499">nx</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3930505">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3930510">len</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3930516">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930524">is384</span>&nbsp;<span class="builtintype" id="3930530">bool</span>&nbsp;<span class="comment" id="3930535">//&nbsp;mark&nbsp;if&nbsp;this&nbsp;digest&nbsp;is&nbsp;SHA-384</span><br>
<span class="lineno">55</span><span class="op" id="3930569">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3930572">func</span>&nbsp;<span class="op" id="3930577">(</span><span class="ident" id="3930578">d</span>&nbsp;<span class="op" id="3930580">*</span><span class="ident" id="3930581">digest</span><span class="op" id="3930587">)</span>&nbsp;<span class="ident" id="3930589">Reset</span><span class="op" id="3930594">(</span><span class="op" id="3930595">)</span>&nbsp;<span class="op" id="3930597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3930600">if</span>&nbsp;<span class="op" id="3930603">!</span><span class="ident" id="3930604">d</span><span class="op" id="3930605">.</span><span class="ident" id="3930606">is384</span>&nbsp;<span class="op" id="3930612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930616">d</span><span class="op" id="3930617">.</span><span class="ident" id="3930618">h</span><span class="op" id="3930619">[</span><span class="num" id="3930620">0</span><span class="op" id="3930621">]</span>&nbsp;<span class="op" id="3930623">=</span>&nbsp;<span class="ident" id="3930625">init0</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930633">d</span><span class="op" id="3930634">.</span><span class="ident" id="3930635">h</span><span class="op" id="3930636">[</span><span class="num" id="3930637">1</span><span class="op" id="3930638">]</span>&nbsp;<span class="op" id="3930640">=</span>&nbsp;<span class="ident" id="3930642">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930650">d</span><span class="op" id="3930651">.</span><span class="ident" id="3930652">h</span><span class="op" id="3930653">[</span><span class="num" id="3930654">2</span><span class="op" id="3930655">]</span>&nbsp;<span class="op" id="3930657">=</span>&nbsp;<span class="ident" id="3930659">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930667">d</span><span class="op" id="3930668">.</span><span class="ident" id="3930669">h</span><span class="op" id="3930670">[</span><span class="num" id="3930671">3</span><span class="op" id="3930672">]</span>&nbsp;<span class="op" id="3930674">=</span>&nbsp;<span class="ident" id="3930676">init3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930684">d</span><span class="op" id="3930685">.</span><span class="ident" id="3930686">h</span><span class="op" id="3930687">[</span><span class="num" id="3930688">4</span><span class="op" id="3930689">]</span>&nbsp;<span class="op" id="3930691">=</span>&nbsp;<span class="ident" id="3930693">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930701">d</span><span class="op" id="3930702">.</span><span class="ident" id="3930703">h</span><span class="op" id="3930704">[</span><span class="num" id="3930705">5</span><span class="op" id="3930706">]</span>&nbsp;<span class="op" id="3930708">=</span>&nbsp;<span class="ident" id="3930710">init5</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930718">d</span><span class="op" id="3930719">.</span><span class="ident" id="3930720">h</span><span class="op" id="3930721">[</span><span class="num" id="3930722">6</span><span class="op" id="3930723">]</span>&nbsp;<span class="op" id="3930725">=</span>&nbsp;<span class="ident" id="3930727">init6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930735">d</span><span class="op" id="3930736">.</span><span class="ident" id="3930737">h</span><span class="op" id="3930738">[</span><span class="num" id="3930739">7</span><span class="op" id="3930740">]</span>&nbsp;<span class="op" id="3930742">=</span>&nbsp;<span class="ident" id="3930744">init7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3930751">}</span>&nbsp;<span class="keyword" id="3930753">else</span>&nbsp;<span class="op" id="3930758">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930762">d</span><span class="op" id="3930763">.</span><span class="ident" id="3930764">h</span><span class="op" id="3930765">[</span><span class="num" id="3930766">0</span><span class="op" id="3930767">]</span>&nbsp;<span class="op" id="3930769">=</span>&nbsp;<span class="ident" id="3930771">init0_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930783">d</span><span class="op" id="3930784">.</span><span class="ident" id="3930785">h</span><span class="op" id="3930786">[</span><span class="num" id="3930787">1</span><span class="op" id="3930788">]</span>&nbsp;<span class="op" id="3930790">=</span>&nbsp;<span class="ident" id="3930792">init1_384</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930804">d</span><span class="op" id="3930805">.</span><span class="ident" id="3930806">h</span><span class="op" id="3930807">[</span><span class="num" id="3930808">2</span><span class="op" id="3930809">]</span>&nbsp;<span class="op" id="3930811">=</span>&nbsp;<span class="ident" id="3930813">init2_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930825">d</span><span class="op" id="3930826">.</span><span class="ident" id="3930827">h</span><span class="op" id="3930828">[</span><span class="num" id="3930829">3</span><span class="op" id="3930830">]</span>&nbsp;<span class="op" id="3930832">=</span>&nbsp;<span class="ident" id="3930834">init3_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930846">d</span><span class="op" id="3930847">.</span><span class="ident" id="3930848">h</span><span class="op" id="3930849">[</span><span class="num" id="3930850">4</span><span class="op" id="3930851">]</span>&nbsp;<span class="op" id="3930853">=</span>&nbsp;<span class="ident" id="3930855">init4_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930867">d</span><span class="op" id="3930868">.</span><span class="ident" id="3930869">h</span><span class="op" id="3930870">[</span><span class="num" id="3930871">5</span><span class="op" id="3930872">]</span>&nbsp;<span class="op" id="3930874">=</span>&nbsp;<span class="ident" id="3930876">init5_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930888">d</span><span class="op" id="3930889">.</span><span class="ident" id="3930890">h</span><span class="op" id="3930891">[</span><span class="num" id="3930892">6</span><span class="op" id="3930893">]</span>&nbsp;<span class="op" id="3930895">=</span>&nbsp;<span class="ident" id="3930897">init6_384</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930909">d</span><span class="op" id="3930910">.</span><span class="ident" id="3930911">h</span><span class="op" id="3930912">[</span><span class="num" id="3930913">7</span><span class="op" id="3930914">]</span>&nbsp;<span class="op" id="3930916">=</span>&nbsp;<span class="ident" id="3930918">init7_384</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3930929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930932">d</span><span class="op" id="3930933">.</span><span class="ident" id="3930934">nx</span>&nbsp;<span class="op" id="3930937">=</span>&nbsp;<span class="num" id="3930939">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3930942">d</span><span class="op" id="3930943">.</span><span class="builtinfunc" id="3930944">len</span>&nbsp;<span class="op" id="3930948">=</span>&nbsp;<span class="num" id="3930950">0</span><br>
<span class="lineno"></span><span class="op" id="3930952">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="3930955">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA512&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="3931017">func</span>&nbsp;<span class="ident" id="3931022">New</span><span class="op" id="3931025">(</span><span class="op" id="3931026">)</span>&nbsp;<span class="ident" id="3931028">hash</span><span class="op" id="3931032">.</span><span class="ident" id="3931033">Hash</span>&nbsp;<span class="op" id="3931038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931041">d</span>&nbsp;<span class="op" id="3931043">:=</span>&nbsp;<span class="builtinfunc" id="3931046">new</span><span class="op" id="3931049">(</span><span class="ident" id="3931050">digest</span><span class="op" id="3931056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931059">d</span><span class="op" id="3931060">.</span><span class="ident" id="3931061">Reset</span><span class="op" id="3931066">(</span><span class="op" id="3931067">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3931070">return</span>&nbsp;<span class="ident" id="3931077">d</span><br>
<span class="lineno"></span><span class="op" id="3931079">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3931082">//&nbsp;New384&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA384&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="3931147">func</span>&nbsp;<span class="ident" id="3931152">New384</span><span class="op" id="3931158">(</span><span class="op" id="3931159">)</span>&nbsp;<span class="ident" id="3931161">hash</span><span class="op" id="3931165">.</span><span class="ident" id="3931166">Hash</span>&nbsp;<span class="op" id="3931171">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931174">d</span>&nbsp;<span class="op" id="3931176">:=</span>&nbsp;<span class="builtinfunc" id="3931179">new</span><span class="op" id="3931182">(</span><span class="ident" id="3931183">digest</span><span class="op" id="3931189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931192">d</span><span class="op" id="3931193">.</span><span class="ident" id="3931194">is384</span>&nbsp;<span class="op" id="3931200">=</span>&nbsp;<span class="builtintype" id="3931202">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931208">d</span><span class="op" id="3931209">.</span><span class="ident" id="3931210">Reset</span><span class="op" id="3931215">(</span><span class="op" id="3931216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3931219">return</span>&nbsp;<span class="ident" id="3931226">d</span><br>
<span class="lineno"></span><span class="op" id="3931228">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="3931231">func</span>&nbsp;<span class="op" id="3931236">(</span><span class="ident" id="3931237">d</span>&nbsp;<span class="op" id="3931239">*</span><span class="ident" id="3931240">digest</span><span class="op" id="3931246">)</span>&nbsp;<span class="ident" id="3931248">Size</span><span class="op" id="3931252">(</span><span class="op" id="3931253">)</span>&nbsp;<span class="builtintype" id="3931255">int</span>&nbsp;<span class="op" id="3931259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3931262">if</span>&nbsp;<span class="op" id="3931265">!</span><span class="ident" id="3931266">d</span><span class="op" id="3931267">.</span><span class="ident" id="3931268">is384</span>&nbsp;<span class="op" id="3931274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3931278">return</span>&nbsp;<span class="ident" id="3931285">Size</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3931291">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3931294">return</span>&nbsp;<span class="ident" id="3931301">Size384</span><br>
<span class="lineno"></span><span class="op" id="3931309">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3931312">func</span>&nbsp;<span class="op" id="3931317">(</span><span class="ident" id="3931318">d</span>&nbsp;<span class="op" id="3931320">*</span><span class="ident" id="3931321">digest</span><span class="op" id="3931327">)</span>&nbsp;<span class="ident" id="3931329">BlockSize</span><span class="op" id="3931338">(</span><span class="op" id="3931339">)</span>&nbsp;<span class="builtintype" id="3931341">int</span>&nbsp;<span class="op" id="3931345">{</span>&nbsp;<span class="keyword" id="3931347">return</span>&nbsp;<span class="ident" id="3931354">BlockSize</span>&nbsp;<span class="op" id="3931364">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="3931367">func</span>&nbsp;<span class="op" id="3931372">(</span><span class="ident" id="3931373">d</span>&nbsp;<span class="op" id="3931375">*</span><span class="ident" id="3931376">digest</span><span class="op" id="3931382">)</span>&nbsp;<span class="ident" id="3931384">Write</span><span class="op" id="3931389">(</span><span class="ident" id="3931390">p</span>&nbsp;<span class="op" id="3931392">[</span><span class="op" id="3931393">]</span><span class="builtintype" id="3931394">byte</span><span class="op" id="3931398">)</span>&nbsp;<span class="op" id="3931400">(</span><span class="ident" id="3931401">nn</span>&nbsp;<span class="builtintype" id="3931404">int</span><span class="op" id="3931407">,</span>&nbsp;<span class="ident" id="3931409">err</span>&nbsp;<span class="builtintype" id="3931413">error</span><span class="op" id="3931418">)</span>&nbsp;<span class="op" id="3931420">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931423">nn</span>&nbsp;<span class="op" id="3931426">=</span>&nbsp;<span class="builtinfunc" id="3931428">len</span><span class="op" id="3931431">(</span><span class="ident" id="3931432">p</span><span class="op" id="3931433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931436">d</span><span class="op" id="3931437">.</span><span class="builtinfunc" id="3931438">len</span>&nbsp;<span class="op" id="3931442">+=</span>&nbsp;<span class="ident" id="3931445">uint64</span><span class="op" id="3931451">(</span><span class="ident" id="3931452">nn</span><span class="op" id="3931454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3931457">if</span>&nbsp;<span class="ident" id="3931460">d</span><span class="op" id="3931461">.</span><span class="ident" id="3931462">nx</span>&nbsp;<span class="op" id="3931465">&gt;</span>&nbsp;<span class="num" id="3931467">0</span>&nbsp;<span class="op" id="3931469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931473">n</span>&nbsp;<span class="op" id="3931475">:=</span>&nbsp;<span class="builtinfunc" id="3931478">copy</span><span class="op" id="3931482">(</span><span class="ident" id="3931483">d</span><span class="op" id="3931484">.</span><span class="ident" id="3931485">x</span><span class="op" id="3931486">[</span><span class="ident" id="3931487">d</span><span class="op" id="3931488">.</span><span class="ident" id="3931489">nx</span><span class="op" id="3931491">:</span><span class="op" id="3931492">]</span><span class="op" id="3931493">,</span>&nbsp;<span class="ident" id="3931495">p</span><span class="op" id="3931496">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931500">d</span><span class="op" id="3931501">.</span><span class="ident" id="3931502">nx</span>&nbsp;<span class="op" id="3931505">+=</span>&nbsp;<span class="ident" id="3931508">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3931512">if</span>&nbsp;<span class="ident" id="3931515">d</span><span class="op" id="3931516">.</span><span class="ident" id="3931517">nx</span>&nbsp;<span class="op" id="3931520">==</span>&nbsp;<span class="ident" id="3931523">chunk</span>&nbsp;<span class="op" id="3931529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931534">block</span><span class="op" id="3931539">(</span><span class="ident" id="3931540">d</span><span class="op" id="3931541">,</span>&nbsp;<span class="ident" id="3931543">d</span><span class="op" id="3931544">.</span><span class="ident" id="3931545">x</span><span class="op" id="3931546">[</span><span class="op" id="3931547">:</span><span class="op" id="3931548">]</span><span class="op" id="3931549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931554">d</span><span class="op" id="3931555">.</span><span class="ident" id="3931556">nx</span>&nbsp;<span class="op" id="3931559">=</span>&nbsp;<span class="num" id="3931561">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3931565">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931569">p</span>&nbsp;<span class="op" id="3931571">=</span>&nbsp;<span class="ident" id="3931573">p</span><span class="op" id="3931574">[</span><span class="ident" id="3931575">n</span><span class="op" id="3931576">:</span><span class="op" id="3931577">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3931580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3931583">if</span>&nbsp;<span class="builtinfunc" id="3931586">len</span><span class="op" id="3931589">(</span><span class="ident" id="3931590">p</span><span class="op" id="3931591">)</span>&nbsp;<span class="op" id="3931593">&gt;=</span>&nbsp;<span class="ident" id="3931596">chunk</span>&nbsp;<span class="op" id="3931602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931606">n</span>&nbsp;<span class="op" id="3931608">:=</span>&nbsp;<span class="builtinfunc" id="3931611">len</span><span class="op" id="3931614">(</span><span class="ident" id="3931615">p</span><span class="op" id="3931616">)</span>&nbsp;<span class="op" id="3931618">&amp;^</span>&nbsp;<span class="op" id="3931621">(</span><span class="ident" id="3931622">chunk</span>&nbsp;<span class="op" id="3931628">-</span>&nbsp;<span class="num" id="3931630">1</span><span class="op" id="3931631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931635">block</span><span class="op" id="3931640">(</span><span class="ident" id="3931641">d</span><span class="op" id="3931642">,</span>&nbsp;<span class="ident" id="3931644">p</span><span class="op" id="3931645">[</span><span class="op" id="3931646">:</span><span class="ident" id="3931647">n</span><span class="op" id="3931648">]</span><span class="op" id="3931649">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931653">p</span>&nbsp;<span class="op" id="3931655">=</span>&nbsp;<span class="ident" id="3931657">p</span><span class="op" id="3931658">[</span><span class="ident" id="3931659">n</span><span class="op" id="3931660">:</span><span class="op" id="3931661">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3931664">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3931667">if</span>&nbsp;<span class="builtinfunc" id="3931670">len</span><span class="op" id="3931673">(</span><span class="ident" id="3931674">p</span><span class="op" id="3931675">)</span>&nbsp;<span class="op" id="3931677">&gt;</span>&nbsp;<span class="num" id="3931679">0</span>&nbsp;<span class="op" id="3931681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931685">d</span><span class="op" id="3931686">.</span><span class="ident" id="3931687">nx</span>&nbsp;<span class="op" id="3931690">=</span>&nbsp;<span class="builtinfunc" id="3931692">copy</span><span class="op" id="3931696">(</span><span class="ident" id="3931697">d</span><span class="op" id="3931698">.</span><span class="ident" id="3931699">x</span><span class="op" id="3931700">[</span><span class="op" id="3931701">:</span><span class="op" id="3931702">]</span><span class="op" id="3931703">,</span>&nbsp;<span class="ident" id="3931705">p</span><span class="op" id="3931706">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3931709">}</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3931712">return</span><br>
<span class="lineno"></span><span class="op" id="3931719">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3931722">func</span>&nbsp;<span class="op" id="3931727">(</span><span class="ident" id="3931728">d0</span>&nbsp;<span class="op" id="3931731">*</span><span class="ident" id="3931732">digest</span><span class="op" id="3931738">)</span>&nbsp;<span class="ident" id="3931740">Sum</span><span class="op" id="3931743">(</span><span class="ident" id="3931744">in</span>&nbsp;<span class="op" id="3931747">[</span><span class="op" id="3931748">]</span><span class="builtintype" id="3931749">byte</span><span class="op" id="3931753">)</span>&nbsp;<span class="op" id="3931755">[</span><span class="op" id="3931756">]</span><span class="builtintype" id="3931757">byte</span>&nbsp;<span class="op" id="3931762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3931765">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931832">d</span>&nbsp;<span class="op" id="3931834">:=</span>&nbsp;<span class="builtinfunc" id="3931837">new</span><span class="op" id="3931840">(</span><span class="ident" id="3931841">digest</span><span class="op" id="3931847">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3931850">*</span><span class="ident" id="3931851">d</span>&nbsp;<span class="op" id="3931853">=</span>&nbsp;<span class="op" id="3931855">*</span><span class="ident" id="3931856">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3931860">hash</span>&nbsp;<span class="op" id="3931865">:=</span>&nbsp;<span class="ident" id="3931868">d</span><span class="op" id="3931869">.</span><span class="ident" id="3931870">checkSum</span><span class="op" id="3931878">(</span><span class="op" id="3931879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3931882">if</span>&nbsp;<span class="ident" id="3931885">d</span><span class="op" id="3931886">.</span><span class="ident" id="3931887">is384</span>&nbsp;<span class="op" id="3931893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3931897">return</span>&nbsp;<span class="builtinfunc" id="3931904">append</span><span class="op" id="3931910">(</span><span class="ident" id="3931911">in</span><span class="op" id="3931913">,</span>&nbsp;<span class="ident" id="3931915">hash</span><span class="op" id="3931919">[</span><span class="op" id="3931920">:</span><span class="ident" id="3931921">Size384</span><span class="op" id="3931928">]</span><span class="op" id="3931929">...</span><span class="op" id="3931932">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3931935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3931938">return</span>&nbsp;<span class="builtinfunc" id="3931945">append</span><span class="op" id="3931951">(</span><span class="ident" id="3931952">in</span><span class="op" id="3931954">,</span>&nbsp;<span class="ident" id="3931956">hash</span><span class="op" id="3931960">[</span><span class="op" id="3931961">:</span><span class="op" id="3931962">]</span><span class="op" id="3931963">...</span><span class="op" id="3931966">)</span><br>
<span class="lineno"></span><span class="op" id="3931968">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3931971">func</span>&nbsp;<span class="op" id="3931976">(</span><span class="ident" id="3931977">d</span>&nbsp;<span class="op" id="3931979">*</span><span class="ident" id="3931980">digest</span><span class="op" id="3931986">)</span>&nbsp;<span class="ident" id="3931988">checkSum</span><span class="op" id="3931996">(</span><span class="op" id="3931997">)</span>&nbsp;<span class="op" id="3931999">[</span><span class="ident" id="3932000">Size</span><span class="op" id="3932004">]</span><span class="builtintype" id="3932005">byte</span>&nbsp;<span class="op" id="3932010">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3932013">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;112&nbsp;bytes&nbsp;mod&nbsp;128.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3932075">len</span>&nbsp;<span class="op" id="3932079">:=</span>&nbsp;<span class="ident" id="3932082">d</span><span class="op" id="3932083">.</span><span class="builtinfunc" id="3932084">len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3932089">var</span>&nbsp;<span class="ident" id="3932093">tmp</span>&nbsp;<span class="op" id="3932097">[</span><span class="num" id="3932098">128</span><span class="op" id="3932101">]</span><span class="builtintype" id="3932102">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932108">tmp</span><span class="op" id="3932111">[</span><span class="num" id="3932112">0</span><span class="op" id="3932113">]</span>&nbsp;<span class="op" id="3932115">=</span>&nbsp;<span class="num" id="3932117">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3932123">if</span>&nbsp;<span class="builtinfunc" id="3932126">len</span><span class="op" id="3932129">%</span><span class="num" id="3932130">128</span>&nbsp;<span class="op" id="3932134">&lt;</span>&nbsp;<span class="num" id="3932136">112</span>&nbsp;<span class="op" id="3932140">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932144">d</span><span class="op" id="3932145">.</span><span class="ident" id="3932146">Write</span><span class="op" id="3932151">(</span><span class="ident" id="3932152">tmp</span><span class="op" id="3932155">[</span><span class="num" id="3932156">0</span>&nbsp;<span class="op" id="3932158">:</span>&nbsp;<span class="num" id="3932160">112</span><span class="op" id="3932163">-</span><span class="builtinfunc" id="3932164">len</span><span class="op" id="3932167">%</span><span class="num" id="3932168">128</span><span class="op" id="3932171">]</span><span class="op" id="3932172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3932175">}</span>&nbsp;<span class="keyword" id="3932177">else</span>&nbsp;<span class="op" id="3932182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932186">d</span><span class="op" id="3932187">.</span><span class="ident" id="3932188">Write</span><span class="op" id="3932193">(</span><span class="ident" id="3932194">tmp</span><span class="op" id="3932197">[</span><span class="num" id="3932198">0</span>&nbsp;<span class="op" id="3932200">:</span>&nbsp;<span class="num" id="3932202">128</span><span class="op" id="3932205">+</span><span class="num" id="3932206">112</span><span class="op" id="3932209">-</span><span class="builtinfunc" id="3932210">len</span><span class="op" id="3932213">%</span><span class="num" id="3932214">128</span><span class="op" id="3932217">]</span><span class="op" id="3932218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3932221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3932225">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3932245">len</span>&nbsp;<span class="op" id="3932249">&lt;&lt;=</span>&nbsp;<span class="num" id="3932253">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3932256">for</span>&nbsp;<span class="ident" id="3932260">i</span>&nbsp;<span class="op" id="3932262">:=</span>&nbsp;<span class="builtintype" id="3932265">uint</span><span class="op" id="3932269">(</span><span class="num" id="3932270">0</span><span class="op" id="3932271">)</span><span class="op" id="3932272">;</span>&nbsp;<span class="ident" id="3932274">i</span>&nbsp;<span class="op" id="3932276">&lt;</span>&nbsp;<span class="num" id="3932278">16</span><span class="op" id="3932280">;</span>&nbsp;<span class="ident" id="3932282">i</span><span class="op" id="3932283">++</span>&nbsp;<span class="op" id="3932286">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932290">tmp</span><span class="op" id="3932293">[</span><span class="ident" id="3932294">i</span><span class="op" id="3932295">]</span>&nbsp;<span class="op" id="3932297">=</span>&nbsp;<span class="builtintype" id="3932299">byte</span><span class="op" id="3932303">(</span><span class="builtinfunc" id="3932304">len</span>&nbsp;<span class="op" id="3932308">&gt;&gt;</span>&nbsp;<span class="op" id="3932311">(</span><span class="num" id="3932312">120</span>&nbsp;<span class="op" id="3932316">-</span>&nbsp;<span class="num" id="3932318">8</span><span class="op" id="3932319">*</span><span class="ident" id="3932320">i</span><span class="op" id="3932321">)</span><span class="op" id="3932322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3932325">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932328">d</span><span class="op" id="3932329">.</span><span class="ident" id="3932330">Write</span><span class="op" id="3932335">(</span><span class="ident" id="3932336">tmp</span><span class="op" id="3932339">[</span><span class="num" id="3932340">0</span><span class="op" id="3932341">:</span><span class="num" id="3932342">16</span><span class="op" id="3932344">]</span><span class="op" id="3932345">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3932349">if</span>&nbsp;<span class="ident" id="3932352">d</span><span class="op" id="3932353">.</span><span class="ident" id="3932354">nx</span>&nbsp;<span class="op" id="3932357">!=</span>&nbsp;<span class="num" id="3932360">0</span>&nbsp;<span class="op" id="3932362">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3932366">panic</span><span class="op" id="3932371">(</span><span class="string" id="3932372">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="3932383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3932386">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932390">h</span>&nbsp;<span class="op" id="3932392">:=</span>&nbsp;<span class="ident" id="3932395">d</span><span class="op" id="3932396">.</span><span class="ident" id="3932397">h</span><span class="op" id="3932398">[</span><span class="op" id="3932399">:</span><span class="op" id="3932400">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3932403">if</span>&nbsp;<span class="ident" id="3932406">d</span><span class="op" id="3932407">.</span><span class="ident" id="3932408">is384</span>&nbsp;<span class="op" id="3932414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932418">h</span>&nbsp;<span class="op" id="3932420">=</span>&nbsp;<span class="ident" id="3932422">d</span><span class="op" id="3932423">.</span><span class="ident" id="3932424">h</span><span class="op" id="3932425">[</span><span class="op" id="3932426">:</span><span class="num" id="3932427">6</span><span class="op" id="3932428">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3932431">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3932435">var</span>&nbsp;<span class="ident" id="3932439">digest</span>&nbsp;<span class="op" id="3932446">[</span><span class="ident" id="3932447">Size</span><span class="op" id="3932451">]</span><span class="builtintype" id="3932452">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3932458">for</span>&nbsp;<span class="ident" id="3932462">i</span><span class="op" id="3932463">,</span>&nbsp;<span class="ident" id="3932465">s</span>&nbsp;<span class="op" id="3932467">:=</span>&nbsp;<span class="keyword" id="3932470">range</span>&nbsp;<span class="ident" id="3932476">h</span>&nbsp;<span class="op" id="3932478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932482">digest</span><span class="op" id="3932488">[</span><span class="ident" id="3932489">i</span><span class="op" id="3932490">*</span><span class="num" id="3932491">8</span><span class="op" id="3932492">]</span>&nbsp;<span class="op" id="3932494">=</span>&nbsp;<span class="builtintype" id="3932496">byte</span><span class="op" id="3932500">(</span><span class="ident" id="3932501">s</span>&nbsp;<span class="op" id="3932503">&gt;&gt;</span>&nbsp;<span class="num" id="3932506">56</span><span class="op" id="3932508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932512">digest</span><span class="op" id="3932518">[</span><span class="ident" id="3932519">i</span><span class="op" id="3932520">*</span><span class="num" id="3932521">8</span><span class="op" id="3932522">+</span><span class="num" id="3932523">1</span><span class="op" id="3932524">]</span>&nbsp;<span class="op" id="3932526">=</span>&nbsp;<span class="builtintype" id="3932528">byte</span><span class="op" id="3932532">(</span><span class="ident" id="3932533">s</span>&nbsp;<span class="op" id="3932535">&gt;&gt;</span>&nbsp;<span class="num" id="3932538">48</span><span class="op" id="3932540">)</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932544">digest</span><span class="op" id="3932550">[</span><span class="ident" id="3932551">i</span><span class="op" id="3932552">*</span><span class="num" id="3932553">8</span><span class="op" id="3932554">+</span><span class="num" id="3932555">2</span><span class="op" id="3932556">]</span>&nbsp;<span class="op" id="3932558">=</span>&nbsp;<span class="builtintype" id="3932560">byte</span><span class="op" id="3932564">(</span><span class="ident" id="3932565">s</span>&nbsp;<span class="op" id="3932567">&gt;&gt;</span>&nbsp;<span class="num" id="3932570">40</span><span class="op" id="3932572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932576">digest</span><span class="op" id="3932582">[</span><span class="ident" id="3932583">i</span><span class="op" id="3932584">*</span><span class="num" id="3932585">8</span><span class="op" id="3932586">+</span><span class="num" id="3932587">3</span><span class="op" id="3932588">]</span>&nbsp;<span class="op" id="3932590">=</span>&nbsp;<span class="builtintype" id="3932592">byte</span><span class="op" id="3932596">(</span><span class="ident" id="3932597">s</span>&nbsp;<span class="op" id="3932599">&gt;&gt;</span>&nbsp;<span class="num" id="3932602">32</span><span class="op" id="3932604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932608">digest</span><span class="op" id="3932614">[</span><span class="ident" id="3932615">i</span><span class="op" id="3932616">*</span><span class="num" id="3932617">8</span><span class="op" id="3932618">+</span><span class="num" id="3932619">4</span><span class="op" id="3932620">]</span>&nbsp;<span class="op" id="3932622">=</span>&nbsp;<span class="builtintype" id="3932624">byte</span><span class="op" id="3932628">(</span><span class="ident" id="3932629">s</span>&nbsp;<span class="op" id="3932631">&gt;&gt;</span>&nbsp;<span class="num" id="3932634">24</span><span class="op" id="3932636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932640">digest</span><span class="op" id="3932646">[</span><span class="ident" id="3932647">i</span><span class="op" id="3932648">*</span><span class="num" id="3932649">8</span><span class="op" id="3932650">+</span><span class="num" id="3932651">5</span><span class="op" id="3932652">]</span>&nbsp;<span class="op" id="3932654">=</span>&nbsp;<span class="builtintype" id="3932656">byte</span><span class="op" id="3932660">(</span><span class="ident" id="3932661">s</span>&nbsp;<span class="op" id="3932663">&gt;&gt;</span>&nbsp;<span class="num" id="3932666">16</span><span class="op" id="3932668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932672">digest</span><span class="op" id="3932678">[</span><span class="ident" id="3932679">i</span><span class="op" id="3932680">*</span><span class="num" id="3932681">8</span><span class="op" id="3932682">+</span><span class="num" id="3932683">6</span><span class="op" id="3932684">]</span>&nbsp;<span class="op" id="3932686">=</span>&nbsp;<span class="builtintype" id="3932688">byte</span><span class="op" id="3932692">(</span><span class="ident" id="3932693">s</span>&nbsp;<span class="op" id="3932695">&gt;&gt;</span>&nbsp;<span class="num" id="3932698">8</span><span class="op" id="3932699">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932703">digest</span><span class="op" id="3932709">[</span><span class="ident" id="3932710">i</span><span class="op" id="3932711">*</span><span class="num" id="3932712">8</span><span class="op" id="3932713">+</span><span class="num" id="3932714">7</span><span class="op" id="3932715">]</span>&nbsp;<span class="op" id="3932717">=</span>&nbsp;<span class="builtintype" id="3932719">byte</span><span class="op" id="3932723">(</span><span class="ident" id="3932724">s</span><span class="op" id="3932725">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3932728">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3932732">return</span>&nbsp;<span class="ident" id="3932739">digest</span><br>
<span class="lineno"></span><span class="op" id="3932746">}</span><br>
<span class="lineno">180</span><br>
<span class="lineno"></span><span class="comment" id="3932749">//&nbsp;Sum512&nbsp;returns&nbsp;the&nbsp;SHA512&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno"></span><span class="keyword" id="3932800">func</span>&nbsp;<span class="ident" id="3932805">Sum512</span><span class="op" id="3932811">(</span><span class="ident" id="3932812">data</span>&nbsp;<span class="op" id="3932817">[</span><span class="op" id="3932818">]</span><span class="builtintype" id="3932819">byte</span><span class="op" id="3932823">)</span>&nbsp;<span class="op" id="3932825">[</span><span class="ident" id="3932826">Size</span><span class="op" id="3932830">]</span><span class="builtintype" id="3932831">byte</span>&nbsp;<span class="op" id="3932836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3932839">var</span>&nbsp;<span class="ident" id="3932843">d</span>&nbsp;<span class="ident" id="3932845">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932853">d</span><span class="op" id="3932854">.</span><span class="ident" id="3932855">Reset</span><span class="op" id="3932860">(</span><span class="op" id="3932861">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3932864">d</span><span class="op" id="3932865">.</span><span class="ident" id="3932866">Write</span><span class="op" id="3932871">(</span><span class="ident" id="3932872">data</span><span class="op" id="3932876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3932879">return</span>&nbsp;<span class="ident" id="3932886">d</span><span class="op" id="3932887">.</span><span class="ident" id="3932888">checkSum</span><span class="op" id="3932896">(</span><span class="op" id="3932897">)</span><br>
<span class="lineno"></span><span class="op" id="3932899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3932902">//&nbsp;Sum384&nbsp;returns&nbsp;the&nbsp;SHA384&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">190</span><span class="keyword" id="3932953">func</span>&nbsp;<span class="ident" id="3932958">Sum384</span><span class="op" id="3932964">(</span><span class="ident" id="3932965">data</span>&nbsp;<span class="op" id="3932970">[</span><span class="op" id="3932971">]</span><span class="builtintype" id="3932972">byte</span><span class="op" id="3932976">)</span>&nbsp;<span class="op" id="3932978">(</span><span class="ident" id="3932979">sum384</span>&nbsp;<span class="op" id="3932986">[</span><span class="ident" id="3932987">Size384</span><span class="op" id="3932994">]</span><span class="builtintype" id="3932995">byte</span><span class="op" id="3932999">)</span>&nbsp;<span class="op" id="3933001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3933004">var</span>&nbsp;<span class="ident" id="3933008">d</span>&nbsp;<span class="ident" id="3933010">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3933018">d</span><span class="op" id="3933019">.</span><span class="ident" id="3933020">is384</span>&nbsp;<span class="op" id="3933026">=</span>&nbsp;<span class="builtintype" id="3933028">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3933034">d</span><span class="op" id="3933035">.</span><span class="ident" id="3933036">Reset</span><span class="op" id="3933041">(</span><span class="op" id="3933042">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3933045">d</span><span class="op" id="3933046">.</span><span class="ident" id="3933047">Write</span><span class="op" id="3933052">(</span><span class="ident" id="3933053">data</span><span class="op" id="3933057">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3933060">sum</span>&nbsp;<span class="op" id="3933064">:=</span>&nbsp;<span class="ident" id="3933067">d</span><span class="op" id="3933068">.</span><span class="ident" id="3933069">checkSum</span><span class="op" id="3933077">(</span><span class="op" id="3933078">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3933081">copy</span><span class="op" id="3933085">(</span><span class="ident" id="3933086">sum384</span><span class="op" id="3933092">[</span><span class="op" id="3933093">:</span><span class="op" id="3933094">]</span><span class="op" id="3933095">,</span>&nbsp;<span class="ident" id="3933097">sum</span><span class="op" id="3933100">[</span><span class="op" id="3933101">:</span><span class="ident" id="3933102">Size384</span><span class="op" id="3933109">]</span><span class="op" id="3933110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3933113">return</span><br>
<span class="lineno"></span><span class="op" id="3933120">}</span>
</div>
</body>
</html>
