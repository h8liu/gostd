<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6420726">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6420781">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6420835">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6420886">/*<br>
<span class="lineno"></span>Package&nbsp;mail&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;mail&nbsp;messages.<br>
<span class="lineno"></span><br>
<span class="lineno"></span>For&nbsp;the&nbsp;most&nbsp;part,&nbsp;this&nbsp;package&nbsp;follows&nbsp;the&nbsp;syntax&nbsp;as&nbsp;specified&nbsp;by&nbsp;RFC&nbsp;5322.<br>
<span class="lineno"></span>Notable&nbsp;divergences:<br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp*&nbsp;Obsolete&nbsp;address&nbsp;formats&nbsp;are&nbsp;not&nbsp;parsed,&nbsp;including&nbsp;addresses&nbsp;with<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;embedded&nbsp;route&nbsp;information.<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp*&nbsp;Group&nbsp;addresses&nbsp;are&nbsp;not&nbsp;parsed.<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp*&nbsp;The&nbsp;full&nbsp;range&nbsp;of&nbsp;spacing&nbsp;(the&nbsp;CFWS&nbsp;syntax&nbsp;element)&nbsp;is&nbsp;not&nbsp;supported,<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;such&nbsp;as&nbsp;breaking&nbsp;addresses&nbsp;across&nbsp;lines.<br>
<span class="lineno">15</span>*/</span><br>
<span class="lineno"></span><span class="keyword" id="6421293">package</span>&nbsp;<span class="ident" id="6421301">mail</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6421307">import</span>&nbsp;<span class="op" id="6421314">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6421317">&#34;bufio&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6421326">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6421335">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6421354">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6421364">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6421371">&#34;io&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6421377">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6421390">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6421397">&#34;net/textproto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6421414">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6421425">&#34;strings&#34;</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6421436">&#34;time&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6421444">&#34;unicode&#34;</span><br>
<span class="lineno"></span><span class="op" id="6421454">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6421457">var</span>&nbsp;<span class="ident" id="6421461">debug</span>&nbsp;<span class="op" id="6421467">=</span>&nbsp;<span class="ident" id="6421469"><a href="/net/mail/message.go.html#6421489">debugT</a></span><span class="op" id="6421475">(</span><span class="ident" id="6421476">false</span><span class="op" id="6421481">)</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="6421484">type</span>&nbsp;<span class="ident" id="6421489">debugT</span>&nbsp;<span class="builtintype" id="6421496">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6421502">func</span>&nbsp;<span class="op" id="6421507">(</span><span class="ident" id="6421508">d</span>&nbsp;<span class="ident" id="6421510"><a href="/net/mail/message.go.html#6421489">debugT</a></span><span class="op" id="6421516">)</span>&nbsp;<span class="ident" id="6421518">Printf</span><span class="op" id="6421524">(</span><span class="ident" id="6421525">format</span>&nbsp;<span class="builtintype" id="6421532">string</span><span class="op" id="6421538">,</span>&nbsp;<span class="ident" id="6421540">args</span>&nbsp;<span class="op" id="6421545">...</span><span class="keyword" id="6421548">interface</span><span class="op" id="6421557">{</span><span class="op" id="6421558">}</span><span class="op" id="6421559">)</span>&nbsp;<span class="op" id="6421561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6421564">if</span>&nbsp;<span class="ident" id="6421567"><a href="/net/mail/message.go.html#6421508">d</a></span>&nbsp;<span class="op" id="6421569">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6421573"><a href="/net/mail/message.go.html#6421390">log</a></span><span class="op" id="6421576">.</span><span class="ident" id="6421577">Printf</span><span class="op" id="6421583">(</span><span class="ident" id="6421584"><a href="/net/mail/message.go.html#6421525">format</a></span><span class="op" id="6421590">,</span>&nbsp;<span class="ident" id="6421592"><a href="/net/mail/message.go.html#6421540">args</a></span><span class="op" id="6421596">...</span><span class="op" id="6421599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6421602">}</span><br>
<span class="lineno"></span><span class="op" id="6421604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6421607">//&nbsp;A&nbsp;Message&nbsp;represents&nbsp;a&nbsp;parsed&nbsp;mail&nbsp;message.</span><br>
<span class="lineno">45</span><span class="keyword" id="6421654">type</span>&nbsp;<span class="ident" id="6421659">Message</span>&nbsp;<span class="keyword" id="6421667">struct</span>&nbsp;<span class="op" id="6421674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6421677">Header</span>&nbsp;<span class="ident" id="6421684"><a href="/net/mail/message.go.html#6423243">Header</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6421692">Body</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6421699"><a href="/net/mail/message.go.html#6421371">io</a></span><span class="op" id="6421701">.</span><span class="ident" id="6421702">Reader</span><br>
<span class="lineno"></span><span class="op" id="6421709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="6421712">//&nbsp;ReadMessage&nbsp;reads&nbsp;a&nbsp;message&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="comment" id="6421751">//&nbsp;The&nbsp;headers&nbsp;are&nbsp;parsed,&nbsp;and&nbsp;the&nbsp;body&nbsp;of&nbsp;the&nbsp;message&nbsp;will&nbsp;be&nbsp;available</span><br>
<span class="lineno"></span><span class="comment" id="6421824">//&nbsp;for&nbsp;reading&nbsp;from&nbsp;r.</span><br>
<span class="lineno"></span><span class="keyword" id="6421847">func</span>&nbsp;<span class="ident" id="6421852">ReadMessage</span><span class="op" id="6421863">(</span><span class="ident" id="6421864">r</span>&nbsp;<span class="ident" id="6421866"><a href="/net/mail/message.go.html#6421371">io</a></span><span class="op" id="6421868">.</span><span class="ident" id="6421869">Reader</span><span class="op" id="6421875">)</span>&nbsp;<span class="op" id="6421877">(</span><span class="ident" id="6421878">msg</span>&nbsp;<span class="op" id="6421882">*</span><span class="ident" id="6421883"><a href="/net/mail/message.go.html#6421659">Message</a></span><span class="op" id="6421890">,</span>&nbsp;<span class="ident" id="6421892">err</span>&nbsp;<span class="builtintype" id="6421896">error</span><span class="op" id="6421901">)</span>&nbsp;<span class="op" id="6421903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6421906">tp</span>&nbsp;<span class="op" id="6421909">:=</span>&nbsp;<span class="ident" id="6421912"><a href="/net/mail/message.go.html#6421397">textproto</a></span><span class="op" id="6421921">.</span><span class="ident" id="6421922">NewReader</span><span class="op" id="6421931">(</span><span class="ident" id="6421932"><a href="/net/mail/message.go.html#6421317">bufio</a></span><span class="op" id="6421937">.</span><span class="ident" id="6421938">NewReader</span><span class="op" id="6421947">(</span><span class="ident" id="6421948"><a href="/net/mail/message.go.html#6421864">r</a></span><span class="op" id="6421949">)</span><span class="op" id="6421950">)</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6421954">hdr</span><span class="op" id="6421957">,</span>&nbsp;<span class="ident" id="6421959"><a href="/net/mail/message.go.html#6421892">err</a></span>&nbsp;<span class="op" id="6421963">:=</span>&nbsp;<span class="ident" id="6421966"><a href="/net/mail/message.go.html#6421906">tp</a></span><span class="op" id="6421968">.</span><span class="ident" id="6421969">ReadMIMEHeader</span><span class="op" id="6421983">(</span><span class="op" id="6421984">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6421987">if</span>&nbsp;<span class="ident" id="6421990"><a href="/net/mail/message.go.html#6421892">err</a></span>&nbsp;<span class="op" id="6421994">!=</span>&nbsp;<span class="ident" id="6421997">nil</span>&nbsp;<span class="op" id="6422001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6422005">return</span>&nbsp;<span class="ident" id="6422012">nil</span><span class="op" id="6422015">,</span>&nbsp;<span class="ident" id="6422017"><a href="/net/mail/message.go.html#6421892">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6422022">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6422026">return</span>&nbsp;<span class="op" id="6422033">&amp;</span><span class="ident" id="6422034"><a href="/net/mail/message.go.html#6421659">Message</a></span><span class="op" id="6422041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422045">Header</span><span class="op" id="6422051">:</span>&nbsp;<span class="ident" id="6422053"><a href="/net/mail/message.go.html#6423243">Header</a></span><span class="op" id="6422059">(</span><span class="ident" id="6422060"><a href="/net/mail/message.go.html#6421954">hdr</a></span><span class="op" id="6422063">)</span><span class="op" id="6422064">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422068">Body</span><span class="op" id="6422072">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6422076"><a href="/net/mail/message.go.html#6421906">tp</a></span><span class="op" id="6422078">.</span><span class="ident" id="6422079">R</span><span class="op" id="6422080">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6422083">}</span><span class="op" id="6422084">,</span>&nbsp;<span class="ident" id="6422086">nil</span><br>
<span class="lineno">65</span><span class="op" id="6422090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6422093">//&nbsp;Layouts&nbsp;suitable&nbsp;for&nbsp;passing&nbsp;to&nbsp;time.Parse.</span><br>
<span class="lineno"></span><span class="comment" id="6422140">//&nbsp;These&nbsp;are&nbsp;tried&nbsp;in&nbsp;order.</span><br>
<span class="lineno"></span><span class="keyword" id="6422169">var</span>&nbsp;<span class="ident" id="6422173">dateLayouts</span>&nbsp;<span class="op" id="6422185">[</span><span class="op" id="6422186">]</span><span class="builtintype" id="6422187">string</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="6422195">func</span>&nbsp;<span class="ident" id="6422200">init</span><span class="op" id="6422204">(</span><span class="op" id="6422205">)</span>&nbsp;<span class="op" id="6422207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6422210">//&nbsp;Generate&nbsp;layouts&nbsp;based&nbsp;on&nbsp;RFC&nbsp;5322,&nbsp;section&nbsp;3.3.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422264">dows</span>&nbsp;<span class="op" id="6422269">:=</span>&nbsp;<span class="op" id="6422272">[</span><span class="op" id="6422273">...</span><span class="op" id="6422276">]</span><span class="builtintype" id="6422277">string</span><span class="op" id="6422283">{</span><span class="string" id="6422284">&#34;&#34;</span><span class="op" id="6422286">,</span>&nbsp;<span class="string" id="6422288">&#34;Mon,&nbsp;&#34;</span><span class="op" id="6422295">}</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6422299">//&nbsp;day-of-week</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422315">days</span>&nbsp;<span class="op" id="6422320">:=</span>&nbsp;<span class="op" id="6422323">[</span><span class="op" id="6422324">...</span><span class="op" id="6422327">]</span><span class="builtintype" id="6422328">string</span><span class="op" id="6422334">{</span><span class="string" id="6422335">&#34;2&#34;</span><span class="op" id="6422338">,</span>&nbsp;<span class="string" id="6422340">&#34;02&#34;</span><span class="op" id="6422344">}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6422350">//&nbsp;day&nbsp;=&nbsp;1*2DIGIT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422369">years</span>&nbsp;<span class="op" id="6422375">:=</span>&nbsp;<span class="op" id="6422378">[</span><span class="op" id="6422379">...</span><span class="op" id="6422382">]</span><span class="builtintype" id="6422383">string</span><span class="op" id="6422389">{</span><span class="string" id="6422390">&#34;2006&#34;</span><span class="op" id="6422396">,</span>&nbsp;<span class="string" id="6422398">&#34;06&#34;</span><span class="op" id="6422402">}</span>&nbsp;<span class="comment" id="6422404">//&nbsp;year&nbsp;=&nbsp;4*DIGIT&nbsp;/&nbsp;2*DIGIT</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422433">seconds</span>&nbsp;<span class="op" id="6422441">:=</span>&nbsp;<span class="op" id="6422444">[</span><span class="op" id="6422445">...</span><span class="op" id="6422448">]</span><span class="builtintype" id="6422449">string</span><span class="op" id="6422455">{</span><span class="string" id="6422456">&#34;:05&#34;</span><span class="op" id="6422461">,</span>&nbsp;<span class="string" id="6422463">&#34;&#34;</span><span class="op" id="6422465">}</span>&nbsp;&nbsp;<span class="comment" id="6422468">//&nbsp;second</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6422479">//&nbsp;&#34;-0700&nbsp;(MST)&#34;&nbsp;is&nbsp;not&nbsp;in&nbsp;RFC&nbsp;5322,&nbsp;but&nbsp;is&nbsp;common.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422532">zones</span>&nbsp;<span class="op" id="6422538">:=</span>&nbsp;<span class="op" id="6422541">[</span><span class="op" id="6422542">...</span><span class="op" id="6422545">]</span><span class="builtintype" id="6422546">string</span><span class="op" id="6422552">{</span><span class="string" id="6422553">&#34;-0700&#34;</span><span class="op" id="6422560">,</span>&nbsp;<span class="string" id="6422562">&#34;MST&#34;</span><span class="op" id="6422567">,</span>&nbsp;<span class="string" id="6422569">&#34;-0700&nbsp;(MST)&#34;</span><span class="op" id="6422582">}</span>&nbsp;<span class="comment" id="6422584">//&nbsp;zone&nbsp;=&nbsp;((&#34;+&#34;&nbsp;/&nbsp;&#34;-&#34;)&nbsp;4DIGIT)&nbsp;/&nbsp;&#34;GMT&#34;&nbsp;/&nbsp;...</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6422631">for</span>&nbsp;<span class="ident" id="6422635">_</span><span class="op" id="6422636">,</span>&nbsp;<span class="ident" id="6422638">dow</span>&nbsp;<span class="op" id="6422642">:=</span>&nbsp;<span class="keyword" id="6422645">range</span>&nbsp;<span class="ident" id="6422651"><a href="/net/mail/message.go.html#6422264">dows</a></span>&nbsp;<span class="op" id="6422656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6422660">for</span>&nbsp;<span class="ident" id="6422664">_</span><span class="op" id="6422665">,</span>&nbsp;<span class="ident" id="6422667">day</span>&nbsp;<span class="op" id="6422671">:=</span>&nbsp;<span class="keyword" id="6422674">range</span>&nbsp;<span class="ident" id="6422680"><a href="/net/mail/message.go.html#6422315">days</a></span>&nbsp;<span class="op" id="6422685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6422690">for</span>&nbsp;<span class="ident" id="6422694">_</span><span class="op" id="6422695">,</span>&nbsp;<span class="ident" id="6422697">year</span>&nbsp;<span class="op" id="6422702">:=</span>&nbsp;<span class="keyword" id="6422705">range</span>&nbsp;<span class="ident" id="6422711"><a href="/net/mail/message.go.html#6422369">years</a></span>&nbsp;<span class="op" id="6422717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6422723">for</span>&nbsp;<span class="ident" id="6422727">_</span><span class="op" id="6422728">,</span>&nbsp;<span class="ident" id="6422730">second</span>&nbsp;<span class="op" id="6422737">:=</span>&nbsp;<span class="keyword" id="6422740">range</span>&nbsp;<span class="ident" id="6422746"><a href="/net/mail/message.go.html#6422433">seconds</a></span>&nbsp;<span class="op" id="6422754">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6422761">for</span>&nbsp;<span class="ident" id="6422765">_</span><span class="op" id="6422766">,</span>&nbsp;<span class="ident" id="6422768">zone</span>&nbsp;<span class="op" id="6422773">:=</span>&nbsp;<span class="keyword" id="6422776">range</span>&nbsp;<span class="ident" id="6422782"><a href="/net/mail/message.go.html#6422532">zones</a></span>&nbsp;<span class="op" id="6422788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422796">s</span>&nbsp;<span class="op" id="6422798">:=</span>&nbsp;<span class="ident" id="6422801"><a href="/net/mail/message.go.html#6422638">dow</a></span>&nbsp;<span class="op" id="6422805">+</span>&nbsp;<span class="ident" id="6422807"><a href="/net/mail/message.go.html#6422667">day</a></span>&nbsp;<span class="op" id="6422811">+</span>&nbsp;<span class="string" id="6422813">&#34;&nbsp;Jan&nbsp;&#34;</span>&nbsp;<span class="op" id="6422821">+</span>&nbsp;<span class="ident" id="6422823"><a href="/net/mail/message.go.html#6422697">year</a></span>&nbsp;<span class="op" id="6422828">+</span>&nbsp;<span class="string" id="6422830">&#34;&nbsp;15:04&#34;</span>&nbsp;<span class="op" id="6422839">+</span>&nbsp;<span class="ident" id="6422841"><a href="/net/mail/message.go.html#6422730">second</a></span>&nbsp;<span class="op" id="6422848">+</span>&nbsp;<span class="string" id="6422850">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6422854">+</span>&nbsp;<span class="ident" id="6422856"><a href="/net/mail/message.go.html#6422768">zone</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6422867"><a href="/net/mail/message.go.html#6422173">dateLayouts</a></span>&nbsp;<span class="op" id="6422879">=</span>&nbsp;<span class="builtinfunc" id="6422881">append</span><span class="op" id="6422887">(</span><span class="ident" id="6422888"><a href="/net/mail/message.go.html#6422173">dateLayouts</a></span><span class="op" id="6422899">,</span>&nbsp;<span class="ident" id="6422901"><a href="/net/mail/message.go.html#6422796">s</a></span><span class="op" id="6422902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6422909">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6422915">}</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6422920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6422924">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6422927">}</span><br>
<span class="lineno"></span><span class="op" id="6422929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="6422932">func</span>&nbsp;<span class="ident" id="6422937">parseDate</span><span class="op" id="6422946">(</span><span class="ident" id="6422947">date</span>&nbsp;<span class="builtintype" id="6422952">string</span><span class="op" id="6422958">)</span>&nbsp;<span class="op" id="6422960">(</span><span class="ident" id="6422961"><a href="/net/mail/message.go.html#6421436">time</a></span><span class="op" id="6422965">.</span><span class="ident" id="6422966">Time</span><span class="op" id="6422970">,</span>&nbsp;<span class="builtintype" id="6422972">error</span><span class="op" id="6422977">)</span>&nbsp;<span class="op" id="6422979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6422982">for</span>&nbsp;<span class="ident" id="6422986">_</span><span class="op" id="6422987">,</span>&nbsp;<span class="ident" id="6422989">layout</span>&nbsp;<span class="op" id="6422996">:=</span>&nbsp;<span class="keyword" id="6422999">range</span>&nbsp;<span class="ident" id="6423005"><a href="/net/mail/message.go.html#6422173">dateLayouts</a></span>&nbsp;<span class="op" id="6423017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6423021">t</span><span class="op" id="6423022">,</span>&nbsp;<span class="ident" id="6423024">err</span>&nbsp;<span class="op" id="6423028">:=</span>&nbsp;<span class="ident" id="6423031"><a href="/net/mail/message.go.html#6421436">time</a></span><span class="op" id="6423035">.</span><span class="ident" id="6423036">Parse</span><span class="op" id="6423041">(</span><span class="ident" id="6423042"><a href="/net/mail/message.go.html#6422989">layout</a></span><span class="op" id="6423048">,</span>&nbsp;<span class="ident" id="6423050"><a href="/net/mail/message.go.html#6422947">date</a></span><span class="op" id="6423054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6423058">if</span>&nbsp;<span class="ident" id="6423061"><a href="/net/mail/message.go.html#6423024">err</a></span>&nbsp;<span class="op" id="6423065">==</span>&nbsp;<span class="ident" id="6423068">nil</span>&nbsp;<span class="op" id="6423072">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6423077">return</span>&nbsp;<span class="ident" id="6423084"><a href="/net/mail/message.go.html#6423021">t</a></span><span class="op" id="6423085">,</span>&nbsp;<span class="ident" id="6423087">nil</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6423093">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6423096">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6423099">return</span>&nbsp;<span class="ident" id="6423106"><a href="/net/mail/message.go.html#6421436">time</a></span><span class="op" id="6423110">.</span><span class="ident" id="6423111">Time</span><span class="op" id="6423115">{</span><span class="op" id="6423116">}</span><span class="op" id="6423117">,</span>&nbsp;<span class="ident" id="6423119"><a href="/net/mail/message.go.html#6421354">errors</a></span><span class="op" id="6423125">.</span><span class="ident" id="6423126">New</span><span class="op" id="6423129">(</span><span class="string" id="6423130">&#34;mail:&nbsp;header&nbsp;could&nbsp;not&nbsp;be&nbsp;parsed&#34;</span><span class="op" id="6423164">)</span><br>
<span class="lineno"></span><span class="op" id="6423166">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="6423169">//&nbsp;A&nbsp;Header&nbsp;represents&nbsp;the&nbsp;key-value&nbsp;pairs&nbsp;in&nbsp;a&nbsp;mail&nbsp;message&nbsp;header.</span><br>
<span class="lineno"></span><span class="keyword" id="6423238">type</span>&nbsp;<span class="ident" id="6423243">Header</span>&nbsp;<span class="keyword" id="6423250">map</span><span class="op" id="6423253">[</span><span class="builtintype" id="6423254">string</span><span class="op" id="6423260">]</span><span class="op" id="6423261">[</span><span class="op" id="6423262">]</span><span class="builtintype" id="6423263">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6423271">//&nbsp;Get&nbsp;gets&nbsp;the&nbsp;first&nbsp;value&nbsp;associated&nbsp;with&nbsp;the&nbsp;given&nbsp;key.</span><br>
<span class="lineno"></span><span class="comment" id="6423330">//&nbsp;If&nbsp;there&nbsp;are&nbsp;no&nbsp;values&nbsp;associated&nbsp;with&nbsp;the&nbsp;key,&nbsp;Get&nbsp;returns&nbsp;&#34;&#34;.</span><br>
<span class="lineno">110</span><span class="keyword" id="6423397">func</span>&nbsp;<span class="op" id="6423402">(</span><span class="ident" id="6423403">h</span>&nbsp;<span class="ident" id="6423405"><a href="/net/mail/message.go.html#6423243">Header</a></span><span class="op" id="6423411">)</span>&nbsp;<span class="ident" id="6423413">Get</span><span class="op" id="6423416">(</span><span class="ident" id="6423417">key</span>&nbsp;<span class="builtintype" id="6423421">string</span><span class="op" id="6423427">)</span>&nbsp;<span class="builtintype" id="6423429">string</span>&nbsp;<span class="op" id="6423436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6423439">return</span>&nbsp;<span class="ident" id="6423446"><a href="/net/mail/message.go.html#6421397">textproto</a></span><span class="op" id="6423455">.</span><span class="ident" id="6423456">MIMEHeader</span><span class="op" id="6423466">(</span><span class="ident" id="6423467"><a href="/net/mail/message.go.html#6423403">h</a></span><span class="op" id="6423468">)</span><span class="op" id="6423469">.</span><span class="ident" id="6423470">Get</span><span class="op" id="6423473">(</span><span class="ident" id="6423474"><a href="/net/mail/message.go.html#6423417">key</a></span><span class="op" id="6423477">)</span><br>
<span class="lineno"></span><span class="op" id="6423479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6423482">var</span>&nbsp;<span class="ident" id="6423486">ErrHeaderNotPresent</span>&nbsp;<span class="op" id="6423506">=</span>&nbsp;<span class="ident" id="6423508"><a href="/net/mail/message.go.html#6421354">errors</a></span><span class="op" id="6423514">.</span><span class="ident" id="6423515">New</span><span class="op" id="6423518">(</span><span class="string" id="6423519">&#34;mail:&nbsp;header&nbsp;not&nbsp;in&nbsp;message&#34;</span><span class="op" id="6423548">)</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="6423551">//&nbsp;Date&nbsp;parses&nbsp;the&nbsp;Date&nbsp;header&nbsp;field.</span><br>
<span class="lineno"></span><span class="keyword" id="6423589">func</span>&nbsp;<span class="op" id="6423594">(</span><span class="ident" id="6423595">h</span>&nbsp;<span class="ident" id="6423597"><a href="/net/mail/message.go.html#6423243">Header</a></span><span class="op" id="6423603">)</span>&nbsp;<span class="ident" id="6423605">Date</span><span class="op" id="6423609">(</span><span class="op" id="6423610">)</span>&nbsp;<span class="op" id="6423612">(</span><span class="ident" id="6423613"><a href="/net/mail/message.go.html#6421436">time</a></span><span class="op" id="6423617">.</span><span class="ident" id="6423618">Time</span><span class="op" id="6423622">,</span>&nbsp;<span class="builtintype" id="6423624">error</span><span class="op" id="6423629">)</span>&nbsp;<span class="op" id="6423631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6423634">hdr</span>&nbsp;<span class="op" id="6423638">:=</span>&nbsp;<span class="ident" id="6423641"><a href="/net/mail/message.go.html#6423595">h</a></span><span class="op" id="6423642">.</span><span class="ident" id="6423643">Get</span><span class="op" id="6423646">(</span><span class="string" id="6423647">&#34;Date&#34;</span><span class="op" id="6423653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6423656">if</span>&nbsp;<span class="ident" id="6423659"><a href="/net/mail/message.go.html#6423634">hdr</a></span>&nbsp;<span class="op" id="6423663">==</span>&nbsp;<span class="string" id="6423666">&#34;&#34;</span>&nbsp;<span class="op" id="6423669">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6423673">return</span>&nbsp;<span class="ident" id="6423680"><a href="/net/mail/message.go.html#6421436">time</a></span><span class="op" id="6423684">.</span><span class="ident" id="6423685">Time</span><span class="op" id="6423689">{</span><span class="op" id="6423690">}</span><span class="op" id="6423691">,</span>&nbsp;<span class="ident" id="6423693"><a href="/net/mail/message.go.html#6423486">ErrHeaderNotPresent</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6423714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6423717">return</span>&nbsp;<span class="ident" id="6423724"><a href="/net/mail/message.go.html#6422937">parseDate</a></span><span class="op" id="6423733">(</span><span class="ident" id="6423734"><a href="/net/mail/message.go.html#6423634">hdr</a></span><span class="op" id="6423737">)</span><br>
<span class="lineno"></span><span class="op" id="6423739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="6423742">//&nbsp;AddressList&nbsp;parses&nbsp;the&nbsp;named&nbsp;header&nbsp;field&nbsp;as&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses.</span><br>
<span class="lineno"></span><span class="keyword" id="6423811">func</span>&nbsp;<span class="op" id="6423816">(</span><span class="ident" id="6423817">h</span>&nbsp;<span class="ident" id="6423819"><a href="/net/mail/message.go.html#6423243">Header</a></span><span class="op" id="6423825">)</span>&nbsp;<span class="ident" id="6423827">AddressList</span><span class="op" id="6423838">(</span><span class="ident" id="6423839">key</span>&nbsp;<span class="builtintype" id="6423843">string</span><span class="op" id="6423849">)</span>&nbsp;<span class="op" id="6423851">(</span><span class="op" id="6423852">[</span><span class="op" id="6423853">]</span><span class="op" id="6423854">*</span><span class="ident" id="6423855"><a href="/net/mail/message.go.html#6424159">Address</a></span><span class="op" id="6423862">,</span>&nbsp;<span class="builtintype" id="6423864">error</span><span class="op" id="6423869">)</span>&nbsp;<span class="op" id="6423871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6423874">hdr</span>&nbsp;<span class="op" id="6423878">:=</span>&nbsp;<span class="ident" id="6423881"><a href="/net/mail/message.go.html#6423817">h</a></span><span class="op" id="6423882">.</span><span class="ident" id="6423883">Get</span><span class="op" id="6423886">(</span><span class="ident" id="6423887"><a href="/net/mail/message.go.html#6423839">key</a></span><span class="op" id="6423890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6423893">if</span>&nbsp;<span class="ident" id="6423896"><a href="/net/mail/message.go.html#6423874">hdr</a></span>&nbsp;<span class="op" id="6423900">==</span>&nbsp;<span class="string" id="6423903">&#34;&#34;</span>&nbsp;<span class="op" id="6423906">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6423910">return</span>&nbsp;<span class="ident" id="6423917">nil</span><span class="op" id="6423920">,</span>&nbsp;<span class="ident" id="6423922"><a href="/net/mail/message.go.html#6423486">ErrHeaderNotPresent</a></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6423943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6423946">return</span>&nbsp;<span class="ident" id="6423953"><a href="/net/mail/message.go.html#6424505">ParseAddressList</a></span><span class="op" id="6423969">(</span><span class="ident" id="6423970"><a href="/net/mail/message.go.html#6423874">hdr</a></span><span class="op" id="6423973">)</span><br>
<span class="lineno"></span><span class="op" id="6423975">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6423978">//&nbsp;Address&nbsp;represents&nbsp;a&nbsp;single&nbsp;mail&nbsp;address.</span><br>
<span class="lineno">135</span><span class="comment" id="6424023">//&nbsp;An&nbsp;address&nbsp;such&nbsp;as&nbsp;&#34;Barry&nbsp;Gibbs&nbsp;&lt;bg@example.com&gt;&#34;&nbsp;is&nbsp;represented</span><br>
<span class="lineno"></span><span class="comment" id="6424091">//&nbsp;as&nbsp;Address{Name:&nbsp;&#34;Barry&nbsp;Gibbs&#34;,&nbsp;Address:&nbsp;&#34;bg@example.com&#34;}.</span><br>
<span class="lineno"></span><span class="keyword" id="6424154">type</span>&nbsp;<span class="ident" id="6424159">Address</span>&nbsp;<span class="keyword" id="6424167">struct</span>&nbsp;<span class="op" id="6424174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6424177">Name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6424185">string</span>&nbsp;<span class="comment" id="6424192">//&nbsp;Proper&nbsp;name;&nbsp;may&nbsp;be&nbsp;empty.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6424223">Address</span>&nbsp;<span class="builtintype" id="6424231">string</span>&nbsp;<span class="comment" id="6424238">//&nbsp;user@domain</span><br>
<span class="lineno">140</span><span class="op" id="6424253">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6424256">//&nbsp;Parses&nbsp;a&nbsp;single&nbsp;RFC&nbsp;5322&nbsp;address,&nbsp;e.g.&nbsp;&#34;Barry&nbsp;Gibbs&nbsp;&lt;bg@example.com&gt;&#34;</span><br>
<span class="lineno"></span><span class="keyword" id="6424329">func</span>&nbsp;<span class="ident" id="6424334">ParseAddress</span><span class="op" id="6424346">(</span><span class="ident" id="6424347">address</span>&nbsp;<span class="builtintype" id="6424355">string</span><span class="op" id="6424361">)</span>&nbsp;<span class="op" id="6424363">(</span><span class="op" id="6424364">*</span><span class="ident" id="6424365"><a href="/net/mail/message.go.html#6424159">Address</a></span><span class="op" id="6424372">,</span>&nbsp;<span class="builtintype" id="6424374">error</span><span class="op" id="6424379">)</span>&nbsp;<span class="op" id="6424381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6424384">return</span>&nbsp;<span class="ident" id="6424391"><a href="/net/mail/message.go.html#6425797">newAddrParser</a></span><span class="op" id="6424404">(</span><span class="ident" id="6424405"><a href="/net/mail/message.go.html#6424347">address</a></span><span class="op" id="6424412">)</span><span class="op" id="6424413">.</span><span class="ident" id="6424414">parseAddress</span><span class="op" id="6424426">(</span><span class="op" id="6424427">)</span><br>
<span class="lineno">145</span><span class="op" id="6424429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6424432">//&nbsp;ParseAddressList&nbsp;parses&nbsp;the&nbsp;given&nbsp;string&nbsp;as&nbsp;a&nbsp;list&nbsp;of&nbsp;addresses.</span><br>
<span class="lineno"></span><span class="keyword" id="6424500">func</span>&nbsp;<span class="ident" id="6424505">ParseAddressList</span><span class="op" id="6424521">(</span><span class="ident" id="6424522">list</span>&nbsp;<span class="builtintype" id="6424527">string</span><span class="op" id="6424533">)</span>&nbsp;<span class="op" id="6424535">(</span><span class="op" id="6424536">[</span><span class="op" id="6424537">]</span><span class="op" id="6424538">*</span><span class="ident" id="6424539"><a href="/net/mail/message.go.html#6424159">Address</a></span><span class="op" id="6424546">,</span>&nbsp;<span class="builtintype" id="6424548">error</span><span class="op" id="6424553">)</span>&nbsp;<span class="op" id="6424555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6424558">return</span>&nbsp;<span class="ident" id="6424565"><a href="/net/mail/message.go.html#6425797">newAddrParser</a></span><span class="op" id="6424578">(</span><span class="ident" id="6424579"><a href="/net/mail/message.go.html#6424522">list</a></span><span class="op" id="6424583">)</span><span class="op" id="6424584">.</span><span class="ident" id="6424585">parseAddressList</span><span class="op" id="6424601">(</span><span class="op" id="6424602">)</span><br>
<span class="lineno">150</span><span class="op" id="6424604">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6424607">//&nbsp;String&nbsp;formats&nbsp;the&nbsp;address&nbsp;as&nbsp;a&nbsp;valid&nbsp;RFC&nbsp;5322&nbsp;address.</span><br>
<span class="lineno"></span><span class="comment" id="6424666">//&nbsp;If&nbsp;the&nbsp;address&#39;s&nbsp;name&nbsp;contains&nbsp;non-ASCII&nbsp;characters</span><br>
<span class="lineno"></span><span class="comment" id="6424721">//&nbsp;the&nbsp;name&nbsp;will&nbsp;be&nbsp;rendered&nbsp;according&nbsp;to&nbsp;RFC&nbsp;2047.</span><br>
<span class="lineno">155</span><span class="keyword" id="6424773">func</span>&nbsp;<span class="op" id="6424778">(</span><span class="ident" id="6424779">a</span>&nbsp;<span class="op" id="6424781">*</span><span class="ident" id="6424782"><a href="/net/mail/message.go.html#6424159">Address</a></span><span class="op" id="6424789">)</span>&nbsp;<span class="ident" id="6424791">String</span><span class="op" id="6424797">(</span><span class="op" id="6424798">)</span>&nbsp;<span class="builtintype" id="6424800">string</span>&nbsp;<span class="op" id="6424807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6424810">s</span>&nbsp;<span class="op" id="6424812">:=</span>&nbsp;<span class="string" id="6424815">&#34;&lt;&#34;</span>&nbsp;<span class="op" id="6424819">+</span>&nbsp;<span class="ident" id="6424821"><a href="/net/mail/message.go.html#6424779">a</a></span><span class="op" id="6424822">.</span><span class="ident" id="6424823">Address</span>&nbsp;<span class="op" id="6424831">+</span>&nbsp;<span class="string" id="6424833">&#34;&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6424838">if</span>&nbsp;<span class="ident" id="6424841"><a href="/net/mail/message.go.html#6424779">a</a></span><span class="op" id="6424842">.</span><span class="ident" id="6424843">Name</span>&nbsp;<span class="op" id="6424848">==</span>&nbsp;<span class="string" id="6424851">&#34;&#34;</span>&nbsp;<span class="op" id="6424854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6424858">return</span>&nbsp;<span class="ident" id="6424865"><a href="/net/mail/message.go.html#6424810">s</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6424868">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6424871">//&nbsp;If&nbsp;every&nbsp;character&nbsp;is&nbsp;printable&nbsp;ASCII,&nbsp;quoting&nbsp;is&nbsp;simple.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6424933">allPrintable</span>&nbsp;<span class="op" id="6424946">:=</span>&nbsp;<span class="ident" id="6424949">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6424955">for</span>&nbsp;<span class="ident" id="6424959">i</span>&nbsp;<span class="op" id="6424961">:=</span>&nbsp;<span class="num" id="6424964">0</span><span class="op" id="6424965">;</span>&nbsp;<span class="ident" id="6424967"><a href="/net/mail/message.go.html#6424959">i</a></span>&nbsp;<span class="op" id="6424969">&lt;</span>&nbsp;<span class="builtinfunc" id="6424971">len</span><span class="op" id="6424974">(</span><span class="ident" id="6424975"><a href="/net/mail/message.go.html#6424779">a</a></span><span class="op" id="6424976">.</span><span class="ident" id="6424977">Name</span><span class="op" id="6424981">)</span><span class="op" id="6424982">;</span>&nbsp;<span class="ident" id="6424984"><a href="/net/mail/message.go.html#6424959">i</a></span><span class="op" id="6424985">++</span>&nbsp;<span class="op" id="6424988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6424992">//&nbsp;isWSP&nbsp;here&nbsp;should&nbsp;actually&nbsp;be&nbsp;isFWS,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6425034">//&nbsp;but&nbsp;we&nbsp;don&#39;t&nbsp;support&nbsp;folding&nbsp;yet.</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6425073">if</span>&nbsp;<span class="op" id="6425076">!</span><span class="ident" id="6425077"><a href="/net/mail/message.go.html#6433925">isVchar</a></span><span class="op" id="6425084">(</span><span class="ident" id="6425085"><a href="/net/mail/message.go.html#6424779">a</a></span><span class="op" id="6425086">.</span><span class="ident" id="6425087">Name</span><span class="op" id="6425091">[</span><span class="ident" id="6425092"><a href="/net/mail/message.go.html#6424959">i</a></span><span class="op" id="6425093">]</span><span class="op" id="6425094">)</span>&nbsp;<span class="op" id="6425096">&amp;&amp;</span>&nbsp;<span class="op" id="6425099">!</span><span class="ident" id="6425100"><a href="/net/mail/message.go.html#6434129">isWSP</a></span><span class="op" id="6425105">(</span><span class="ident" id="6425106"><a href="/net/mail/message.go.html#6424779">a</a></span><span class="op" id="6425107">.</span><span class="ident" id="6425108">Name</span><span class="op" id="6425112">[</span><span class="ident" id="6425113"><a href="/net/mail/message.go.html#6424959">i</a></span><span class="op" id="6425114">]</span><span class="op" id="6425115">)</span>&nbsp;<span class="op" id="6425117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425122"><a href="/net/mail/message.go.html#6424933">allPrintable</a></span>&nbsp;<span class="op" id="6425135">=</span>&nbsp;<span class="ident" id="6425137">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6425146">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6425154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6425157">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6425160">if</span>&nbsp;<span class="ident" id="6425163"><a href="/net/mail/message.go.html#6424933">allPrintable</a></span>&nbsp;<span class="op" id="6425176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425180">b</span>&nbsp;<span class="op" id="6425182">:=</span>&nbsp;<span class="ident" id="6425185"><a href="/net/mail/message.go.html#6421326">bytes</a></span><span class="op" id="6425190">.</span><span class="ident" id="6425191">NewBufferString</span><span class="op" id="6425206">(</span><span class="string" id="6425207">`&#34;`</span><span class="op" id="6425210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6425214">for</span>&nbsp;<span class="ident" id="6425218">i</span>&nbsp;<span class="op" id="6425220">:=</span>&nbsp;<span class="num" id="6425223">0</span><span class="op" id="6425224">;</span>&nbsp;<span class="ident" id="6425226"><a href="/net/mail/message.go.html#6425218">i</a></span>&nbsp;<span class="op" id="6425228">&lt;</span>&nbsp;<span class="builtinfunc" id="6425230">len</span><span class="op" id="6425233">(</span><span class="ident" id="6425234"><a href="/net/mail/message.go.html#6424779">a</a></span><span class="op" id="6425235">.</span><span class="ident" id="6425236">Name</span><span class="op" id="6425240">)</span><span class="op" id="6425241">;</span>&nbsp;<span class="ident" id="6425243"><a href="/net/mail/message.go.html#6425218">i</a></span><span class="op" id="6425244">++</span>&nbsp;<span class="op" id="6425247">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6425252">if</span>&nbsp;<span class="op" id="6425255">!</span><span class="ident" id="6425256"><a href="/net/mail/message.go.html#6433704">isQtext</a></span><span class="op" id="6425263">(</span><span class="ident" id="6425264"><a href="/net/mail/message.go.html#6424779">a</a></span><span class="op" id="6425265">.</span><span class="ident" id="6425266">Name</span><span class="op" id="6425270">[</span><span class="ident" id="6425271"><a href="/net/mail/message.go.html#6425218">i</a></span><span class="op" id="6425272">]</span><span class="op" id="6425273">)</span>&nbsp;<span class="op" id="6425275">&amp;&amp;</span>&nbsp;<span class="op" id="6425278">!</span><span class="ident" id="6425279"><a href="/net/mail/message.go.html#6434129">isWSP</a></span><span class="op" id="6425284">(</span><span class="ident" id="6425285"><a href="/net/mail/message.go.html#6424779">a</a></span><span class="op" id="6425286">.</span><span class="ident" id="6425287">Name</span><span class="op" id="6425291">[</span><span class="ident" id="6425292"><a href="/net/mail/message.go.html#6425218">i</a></span><span class="op" id="6425293">]</span><span class="op" id="6425294">)</span>&nbsp;<span class="op" id="6425296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425302"><a href="/net/mail/message.go.html#6425180">b</a></span><span class="op" id="6425303">.</span><span class="ident" id="6425304">WriteByte</span><span class="op" id="6425313">(</span><span class="string" id="6425314">&#39;\\&#39;</span><span class="op" id="6425318">)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6425323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425328"><a href="/net/mail/message.go.html#6425180">b</a></span><span class="op" id="6425329">.</span><span class="ident" id="6425330">WriteByte</span><span class="op" id="6425339">(</span><span class="ident" id="6425340"><a href="/net/mail/message.go.html#6424779">a</a></span><span class="op" id="6425341">.</span><span class="ident" id="6425342">Name</span><span class="op" id="6425346">[</span><span class="ident" id="6425347"><a href="/net/mail/message.go.html#6425218">i</a></span><span class="op" id="6425348">]</span><span class="op" id="6425349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6425353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425357"><a href="/net/mail/message.go.html#6425180">b</a></span><span class="op" id="6425358">.</span><span class="ident" id="6425359">WriteString</span><span class="op" id="6425370">(</span><span class="string" id="6425371">`&#34;&nbsp;`</span><span class="op" id="6425375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425379"><a href="/net/mail/message.go.html#6425180">b</a></span><span class="op" id="6425380">.</span><span class="ident" id="6425381">WriteString</span><span class="op" id="6425392">(</span><span class="ident" id="6425393"><a href="/net/mail/message.go.html#6424810">s</a></span><span class="op" id="6425394">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6425398">return</span>&nbsp;<span class="ident" id="6425405"><a href="/net/mail/message.go.html#6425180">b</a></span><span class="op" id="6425406">.</span><span class="ident" id="6425407">String</span><span class="op" id="6425413">(</span><span class="op" id="6425414">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6425417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6425421">//&nbsp;UTF-8&nbsp;&#34;Q&#34;&nbsp;encoding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425444">b</span>&nbsp;<span class="op" id="6425446">:=</span>&nbsp;<span class="ident" id="6425449"><a href="/net/mail/message.go.html#6421326">bytes</a></span><span class="op" id="6425454">.</span><span class="ident" id="6425455">NewBufferString</span><span class="op" id="6425470">(</span><span class="string" id="6425471">&#34;=?utf-8?q?&#34;</span><span class="op" id="6425483">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6425486">for</span>&nbsp;<span class="ident" id="6425490">i</span>&nbsp;<span class="op" id="6425492">:=</span>&nbsp;<span class="num" id="6425495">0</span><span class="op" id="6425496">;</span>&nbsp;<span class="ident" id="6425498"><a href="/net/mail/message.go.html#6425490">i</a></span>&nbsp;<span class="op" id="6425500">&lt;</span>&nbsp;<span class="builtinfunc" id="6425502">len</span><span class="op" id="6425505">(</span><span class="ident" id="6425506"><a href="/net/mail/message.go.html#6424779">a</a></span><span class="op" id="6425507">.</span><span class="ident" id="6425508">Name</span><span class="op" id="6425512">)</span><span class="op" id="6425513">;</span>&nbsp;<span class="ident" id="6425515"><a href="/net/mail/message.go.html#6425490">i</a></span><span class="op" id="6425516">++</span>&nbsp;<span class="op" id="6425519">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6425523">switch</span>&nbsp;<span class="ident" id="6425530">c</span>&nbsp;<span class="op" id="6425532">:=</span>&nbsp;<span class="ident" id="6425535"><a href="/net/mail/message.go.html#6424779">a</a></span><span class="op" id="6425536">.</span><span class="ident" id="6425537">Name</span><span class="op" id="6425541">[</span><span class="ident" id="6425542"><a href="/net/mail/message.go.html#6425490">i</a></span><span class="op" id="6425543">]</span><span class="op" id="6425544">;</span>&nbsp;<span class="op" id="6425546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6425550">case</span>&nbsp;<span class="ident" id="6425555"><a href="/net/mail/message.go.html#6425530">c</a></span>&nbsp;<span class="op" id="6425557">==</span>&nbsp;<span class="string" id="6425560">&#39;&nbsp;&#39;</span><span class="op" id="6425563">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425568"><a href="/net/mail/message.go.html#6425444">b</a></span><span class="op" id="6425569">.</span><span class="ident" id="6425570">WriteByte</span><span class="op" id="6425579">(</span><span class="string" id="6425580">&#39;_&#39;</span><span class="op" id="6425583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6425587">case</span>&nbsp;<span class="ident" id="6425592"><a href="/net/mail/message.go.html#6433925">isVchar</a></span><span class="op" id="6425599">(</span><span class="ident" id="6425600"><a href="/net/mail/message.go.html#6425530">c</a></span><span class="op" id="6425601">)</span>&nbsp;<span class="op" id="6425603">&amp;&amp;</span>&nbsp;<span class="ident" id="6425606"><a href="/net/mail/message.go.html#6425530">c</a></span>&nbsp;<span class="op" id="6425608">!=</span>&nbsp;<span class="string" id="6425611">&#39;=&#39;</span>&nbsp;<span class="op" id="6425615">&amp;&amp;</span>&nbsp;<span class="ident" id="6425618"><a href="/net/mail/message.go.html#6425530">c</a></span>&nbsp;<span class="op" id="6425620">!=</span>&nbsp;<span class="string" id="6425623">&#39;?&#39;</span>&nbsp;<span class="op" id="6425627">&amp;&amp;</span>&nbsp;<span class="ident" id="6425630"><a href="/net/mail/message.go.html#6425530">c</a></span>&nbsp;<span class="op" id="6425632">!=</span>&nbsp;<span class="string" id="6425635">&#39;_&#39;</span><span class="op" id="6425638">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425643"><a href="/net/mail/message.go.html#6425444">b</a></span><span class="op" id="6425644">.</span><span class="ident" id="6425645">WriteByte</span><span class="op" id="6425654">(</span><span class="ident" id="6425655"><a href="/net/mail/message.go.html#6425530">c</a></span><span class="op" id="6425656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6425660">default</span><span class="op" id="6425667">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425672"><a href="/net/mail/message.go.html#6421364">fmt</a></span><span class="op" id="6425675">.</span><span class="ident" id="6425676">Fprintf</span><span class="op" id="6425683">(</span><span class="ident" id="6425684"><a href="/net/mail/message.go.html#6425444">b</a></span><span class="op" id="6425685">,</span>&nbsp;<span class="string" id="6425687">&#34;=%02X&#34;</span><span class="op" id="6425694">,</span>&nbsp;<span class="ident" id="6425696"><a href="/net/mail/message.go.html#6425530">c</a></span><span class="op" id="6425697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6425701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6425704">}</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425707"><a href="/net/mail/message.go.html#6425444">b</a></span><span class="op" id="6425708">.</span><span class="ident" id="6425709">WriteString</span><span class="op" id="6425720">(</span><span class="string" id="6425721">&#34;?=&nbsp;&#34;</span><span class="op" id="6425726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425729"><a href="/net/mail/message.go.html#6425444">b</a></span><span class="op" id="6425730">.</span><span class="ident" id="6425731">WriteString</span><span class="op" id="6425742">(</span><span class="ident" id="6425743"><a href="/net/mail/message.go.html#6424810">s</a></span><span class="op" id="6425744">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6425747">return</span>&nbsp;<span class="ident" id="6425754"><a href="/net/mail/message.go.html#6425444">b</a></span><span class="op" id="6425755">.</span><span class="ident" id="6425756">String</span><span class="op" id="6425762">(</span><span class="op" id="6425763">)</span><br>
<span class="lineno"></span><span class="op" id="6425765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="keyword" id="6425768">type</span>&nbsp;<span class="ident" id="6425773">addrParser</span>&nbsp;<span class="op" id="6425784">[</span><span class="op" id="6425785">]</span><span class="builtintype" id="6425786">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6425792">func</span>&nbsp;<span class="ident" id="6425797">newAddrParser</span><span class="op" id="6425810">(</span><span class="ident" id="6425811">s</span>&nbsp;<span class="builtintype" id="6425813">string</span><span class="op" id="6425819">)</span>&nbsp;<span class="op" id="6425821">*</span><span class="ident" id="6425822"><a href="/net/mail/message.go.html#6425773">addrParser</a></span>&nbsp;<span class="op" id="6425833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425836">p</span>&nbsp;<span class="op" id="6425838">:=</span>&nbsp;<span class="ident" id="6425841"><a href="/net/mail/message.go.html#6425773">addrParser</a></span><span class="op" id="6425851">(</span><span class="ident" id="6425852"><a href="/net/mail/message.go.html#6425811">s</a></span><span class="op" id="6425853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6425856">return</span>&nbsp;<span class="op" id="6425863">&amp;</span><span class="ident" id="6425864"><a href="/net/mail/message.go.html#6425836">p</a></span><br>
<span class="lineno">205</span><span class="op" id="6425866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6425869">func</span>&nbsp;<span class="op" id="6425874">(</span><span class="ident" id="6425875">p</span>&nbsp;<span class="op" id="6425877">*</span><span class="ident" id="6425878"><a href="/net/mail/message.go.html#6425773">addrParser</a></span><span class="op" id="6425888">)</span>&nbsp;<span class="ident" id="6425890">parseAddressList</span><span class="op" id="6425906">(</span><span class="op" id="6425907">)</span>&nbsp;<span class="op" id="6425909">(</span><span class="op" id="6425910">[</span><span class="op" id="6425911">]</span><span class="op" id="6425912">*</span><span class="ident" id="6425913"><a href="/net/mail/message.go.html#6424159">Address</a></span><span class="op" id="6425920">,</span>&nbsp;<span class="builtintype" id="6425922">error</span><span class="op" id="6425927">)</span>&nbsp;<span class="op" id="6425929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6425932">var</span>&nbsp;<span class="ident" id="6425936">list</span>&nbsp;<span class="op" id="6425941">[</span><span class="op" id="6425942">]</span><span class="op" id="6425943">*</span><span class="ident" id="6425944"><a href="/net/mail/message.go.html#6424159">Address</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6425953">for</span>&nbsp;<span class="op" id="6425957">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425961"><a href="/net/mail/message.go.html#6425875">p</a></span><span class="op" id="6425962">.</span><span class="ident" id="6425963">skipSpace</span><span class="op" id="6425972">(</span><span class="op" id="6425973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6425977">addr</span><span class="op" id="6425981">,</span>&nbsp;<span class="ident" id="6425983">err</span>&nbsp;<span class="op" id="6425987">:=</span>&nbsp;<span class="ident" id="6425990"><a href="/net/mail/message.go.html#6425875">p</a></span><span class="op" id="6425991">.</span><span class="ident" id="6425992">parseAddress</span><span class="op" id="6426004">(</span><span class="op" id="6426005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426009">if</span>&nbsp;<span class="ident" id="6426012"><a href="/net/mail/message.go.html#6425983">err</a></span>&nbsp;<span class="op" id="6426016">!=</span>&nbsp;<span class="ident" id="6426019">nil</span>&nbsp;<span class="op" id="6426023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426028">return</span>&nbsp;<span class="ident" id="6426035">nil</span><span class="op" id="6426038">,</span>&nbsp;<span class="ident" id="6426040"><a href="/net/mail/message.go.html#6425983">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6426046">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426050"><a href="/net/mail/message.go.html#6425936">list</a></span>&nbsp;<span class="op" id="6426055">=</span>&nbsp;<span class="builtinfunc" id="6426057">append</span><span class="op" id="6426063">(</span><span class="ident" id="6426064"><a href="/net/mail/message.go.html#6425936">list</a></span><span class="op" id="6426068">,</span>&nbsp;<span class="ident" id="6426070"><a href="/net/mail/message.go.html#6425977">addr</a></span><span class="op" id="6426074">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426079"><a href="/net/mail/message.go.html#6425875">p</a></span><span class="op" id="6426080">.</span><span class="ident" id="6426081">skipSpace</span><span class="op" id="6426090">(</span><span class="op" id="6426091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426095">if</span>&nbsp;<span class="ident" id="6426098"><a href="/net/mail/message.go.html#6425875">p</a></span><span class="op" id="6426099">.</span><span class="ident" id="6426100">empty</span><span class="op" id="6426105">(</span><span class="op" id="6426106">)</span>&nbsp;<span class="op" id="6426108">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426113">break</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6426121">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426125">if</span>&nbsp;<span class="op" id="6426128">!</span><span class="ident" id="6426129"><a href="/net/mail/message.go.html#6425875">p</a></span><span class="op" id="6426130">.</span><span class="ident" id="6426131">consume</span><span class="op" id="6426138">(</span><span class="string" id="6426139">&#39;,&#39;</span><span class="op" id="6426142">)</span>&nbsp;<span class="op" id="6426144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426149">return</span>&nbsp;<span class="ident" id="6426156">nil</span><span class="op" id="6426159">,</span>&nbsp;<span class="ident" id="6426161"><a href="/net/mail/message.go.html#6421354">errors</a></span><span class="op" id="6426167">.</span><span class="ident" id="6426168">New</span><span class="op" id="6426171">(</span><span class="string" id="6426172">&#34;mail:&nbsp;expected&nbsp;comma&#34;</span><span class="op" id="6426194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6426198">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6426201">}</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426204">return</span>&nbsp;<span class="ident" id="6426211"><a href="/net/mail/message.go.html#6425936">list</a></span><span class="op" id="6426215">,</span>&nbsp;<span class="ident" id="6426217">nil</span><br>
<span class="lineno"></span><span class="op" id="6426221">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6426224">//&nbsp;parseAddress&nbsp;parses&nbsp;a&nbsp;single&nbsp;RFC&nbsp;5322&nbsp;address&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="6426292">func</span>&nbsp;<span class="op" id="6426297">(</span><span class="ident" id="6426298">p</span>&nbsp;<span class="op" id="6426300">*</span><span class="ident" id="6426301"><a href="/net/mail/message.go.html#6425773">addrParser</a></span><span class="op" id="6426311">)</span>&nbsp;<span class="ident" id="6426313">parseAddress</span><span class="op" id="6426325">(</span><span class="op" id="6426326">)</span>&nbsp;<span class="op" id="6426328">(</span><span class="ident" id="6426329">addr</span>&nbsp;<span class="op" id="6426334">*</span><span class="ident" id="6426335"><a href="/net/mail/message.go.html#6424159">Address</a></span><span class="op" id="6426342">,</span>&nbsp;<span class="ident" id="6426344">err</span>&nbsp;<span class="builtintype" id="6426348">error</span><span class="op" id="6426353">)</span>&nbsp;<span class="op" id="6426355">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426358"><a href="/net/mail/message.go.html#6421461">debug</a></span><span class="op" id="6426363">.</span><span class="ident" id="6426364">Printf</span><span class="op" id="6426370">(</span><span class="string" id="6426371">&#34;parseAddress:&nbsp;%q&#34;</span><span class="op" id="6426389">,</span>&nbsp;<span class="op" id="6426391">*</span><span class="ident" id="6426392"><a href="/net/mail/message.go.html#6426298">p</a></span><span class="op" id="6426393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426396"><a href="/net/mail/message.go.html#6426298">p</a></span><span class="op" id="6426397">.</span><span class="ident" id="6426398">skipSpace</span><span class="op" id="6426407">(</span><span class="op" id="6426408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426411">if</span>&nbsp;<span class="ident" id="6426414"><a href="/net/mail/message.go.html#6426298">p</a></span><span class="op" id="6426415">.</span><span class="ident" id="6426416">empty</span><span class="op" id="6426421">(</span><span class="op" id="6426422">)</span>&nbsp;<span class="op" id="6426424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426428">return</span>&nbsp;<span class="ident" id="6426435">nil</span><span class="op" id="6426438">,</span>&nbsp;<span class="ident" id="6426440"><a href="/net/mail/message.go.html#6421354">errors</a></span><span class="op" id="6426446">.</span><span class="ident" id="6426447">New</span><span class="op" id="6426450">(</span><span class="string" id="6426451">&#34;mail:&nbsp;no&nbsp;address&#34;</span><span class="op" id="6426469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6426472">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6426476">//&nbsp;address&nbsp;=&nbsp;name-addr&nbsp;/&nbsp;addr-spec</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6426512">//&nbsp;TODO(dsymonds):&nbsp;Support&nbsp;parsing&nbsp;group&nbsp;address.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6426564">//&nbsp;addr-spec&nbsp;has&nbsp;a&nbsp;more&nbsp;restricted&nbsp;grammar&nbsp;than&nbsp;name-addr,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6426624">//&nbsp;so&nbsp;try&nbsp;parsing&nbsp;it&nbsp;first,&nbsp;and&nbsp;fallback&nbsp;to&nbsp;name-addr.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6426680">//&nbsp;TODO(dsymonds):&nbsp;Is&nbsp;this&nbsp;really&nbsp;correct?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426724">spec</span><span class="op" id="6426728">,</span>&nbsp;<span class="ident" id="6426730"><a href="/net/mail/message.go.html#6426344">err</a></span>&nbsp;<span class="op" id="6426734">:=</span>&nbsp;<span class="ident" id="6426737"><a href="/net/mail/message.go.html#6426298">p</a></span><span class="op" id="6426738">.</span><span class="ident" id="6426739">consumeAddrSpec</span><span class="op" id="6426754">(</span><span class="op" id="6426755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426758">if</span>&nbsp;<span class="ident" id="6426761"><a href="/net/mail/message.go.html#6426344">err</a></span>&nbsp;<span class="op" id="6426765">==</span>&nbsp;<span class="ident" id="6426768">nil</span>&nbsp;<span class="op" id="6426772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426776">return</span>&nbsp;<span class="op" id="6426783">&amp;</span><span class="ident" id="6426784"><a href="/net/mail/message.go.html#6424159">Address</a></span><span class="op" id="6426791">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426796">Address</span><span class="op" id="6426803">:</span>&nbsp;<span class="ident" id="6426805"><a href="/net/mail/message.go.html#6426724">spec</a></span><span class="op" id="6426809">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6426813">}</span><span class="op" id="6426814">,</span>&nbsp;<span class="ident" id="6426816"><a href="/net/mail/message.go.html#6426344">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6426821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426824"><a href="/net/mail/message.go.html#6421461">debug</a></span><span class="op" id="6426829">.</span><span class="ident" id="6426830">Printf</span><span class="op" id="6426836">(</span><span class="string" id="6426837">&#34;parseAddress:&nbsp;not&nbsp;an&nbsp;addr-spec:&nbsp;%v&#34;</span><span class="op" id="6426873">,</span>&nbsp;<span class="ident" id="6426875"><a href="/net/mail/message.go.html#6426344">err</a></span><span class="op" id="6426878">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426881"><a href="/net/mail/message.go.html#6421461">debug</a></span><span class="op" id="6426886">.</span><span class="ident" id="6426887">Printf</span><span class="op" id="6426893">(</span><span class="string" id="6426894">&#34;parseAddress:&nbsp;state&nbsp;is&nbsp;now&nbsp;%q&#34;</span><span class="op" id="6426925">,</span>&nbsp;<span class="op" id="6426927">*</span><span class="ident" id="6426928"><a href="/net/mail/message.go.html#6426298">p</a></span><span class="op" id="6426929">)</span><br>
<span class="lineno">250</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6426933">//&nbsp;display-name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426950">var</span>&nbsp;<span class="ident" id="6426954">displayName</span>&nbsp;<span class="builtintype" id="6426966">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6426974">if</span>&nbsp;<span class="ident" id="6426977"><a href="/net/mail/message.go.html#6426298">p</a></span><span class="op" id="6426978">.</span><span class="ident" id="6426979">peek</span><span class="op" id="6426983">(</span><span class="op" id="6426984">)</span>&nbsp;<span class="op" id="6426986">!=</span>&nbsp;<span class="string" id="6426989">&#39;&lt;&#39;</span>&nbsp;<span class="op" id="6426993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6426997"><a href="/net/mail/message.go.html#6426954">displayName</a></span><span class="op" id="6427008">,</span>&nbsp;<span class="ident" id="6427010"><a href="/net/mail/message.go.html#6426344">err</a></span>&nbsp;<span class="op" id="6427014">=</span>&nbsp;<span class="ident" id="6427016"><a href="/net/mail/message.go.html#6426298">p</a></span><span class="op" id="6427017">.</span><span class="ident" id="6427018">consumePhrase</span><span class="op" id="6427031">(</span><span class="op" id="6427032">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427036">if</span>&nbsp;<span class="ident" id="6427039"><a href="/net/mail/message.go.html#6426344">err</a></span>&nbsp;<span class="op" id="6427043">!=</span>&nbsp;<span class="ident" id="6427046">nil</span>&nbsp;<span class="op" id="6427050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427055">return</span>&nbsp;<span class="ident" id="6427062">nil</span><span class="op" id="6427065">,</span>&nbsp;<span class="ident" id="6427067"><a href="/net/mail/message.go.html#6426344">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6427073">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6427076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427079"><a href="/net/mail/message.go.html#6421461">debug</a></span><span class="op" id="6427084">.</span><span class="ident" id="6427085">Printf</span><span class="op" id="6427091">(</span><span class="string" id="6427092">&#34;parseAddress:&nbsp;displayName=%q&#34;</span><span class="op" id="6427122">,</span>&nbsp;<span class="ident" id="6427124"><a href="/net/mail/message.go.html#6426954">displayName</a></span><span class="op" id="6427135">)</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6427139">//&nbsp;angle-addr&nbsp;=&nbsp;&#34;&lt;&#34;&nbsp;addr-spec&nbsp;&#34;&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427174"><a href="/net/mail/message.go.html#6426298">p</a></span><span class="op" id="6427175">.</span><span class="ident" id="6427176">skipSpace</span><span class="op" id="6427185">(</span><span class="op" id="6427186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427189">if</span>&nbsp;<span class="op" id="6427192">!</span><span class="ident" id="6427193"><a href="/net/mail/message.go.html#6426298">p</a></span><span class="op" id="6427194">.</span><span class="ident" id="6427195">consume</span><span class="op" id="6427202">(</span><span class="string" id="6427203">&#39;&lt;&#39;</span><span class="op" id="6427206">)</span>&nbsp;<span class="op" id="6427208">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427212">return</span>&nbsp;<span class="ident" id="6427219">nil</span><span class="op" id="6427222">,</span>&nbsp;<span class="ident" id="6427224"><a href="/net/mail/message.go.html#6421354">errors</a></span><span class="op" id="6427230">.</span><span class="ident" id="6427231">New</span><span class="op" id="6427234">(</span><span class="string" id="6427235">&#34;mail:&nbsp;no&nbsp;angle-addr&#34;</span><span class="op" id="6427256">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6427259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427262"><a href="/net/mail/message.go.html#6426724">spec</a></span><span class="op" id="6427266">,</span>&nbsp;<span class="ident" id="6427268"><a href="/net/mail/message.go.html#6426344">err</a></span>&nbsp;<span class="op" id="6427272">=</span>&nbsp;<span class="ident" id="6427274"><a href="/net/mail/message.go.html#6426298">p</a></span><span class="op" id="6427275">.</span><span class="ident" id="6427276">consumeAddrSpec</span><span class="op" id="6427291">(</span><span class="op" id="6427292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427295">if</span>&nbsp;<span class="ident" id="6427298"><a href="/net/mail/message.go.html#6426344">err</a></span>&nbsp;<span class="op" id="6427302">!=</span>&nbsp;<span class="ident" id="6427305">nil</span>&nbsp;<span class="op" id="6427309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427313">return</span>&nbsp;<span class="ident" id="6427320">nil</span><span class="op" id="6427323">,</span>&nbsp;<span class="ident" id="6427325"><a href="/net/mail/message.go.html#6426344">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6427330">}</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427333">if</span>&nbsp;<span class="op" id="6427336">!</span><span class="ident" id="6427337"><a href="/net/mail/message.go.html#6426298">p</a></span><span class="op" id="6427338">.</span><span class="ident" id="6427339">consume</span><span class="op" id="6427346">(</span><span class="string" id="6427347">&#39;&gt;&#39;</span><span class="op" id="6427350">)</span>&nbsp;<span class="op" id="6427352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427356">return</span>&nbsp;<span class="ident" id="6427363">nil</span><span class="op" id="6427366">,</span>&nbsp;<span class="ident" id="6427368"><a href="/net/mail/message.go.html#6421354">errors</a></span><span class="op" id="6427374">.</span><span class="ident" id="6427375">New</span><span class="op" id="6427378">(</span><span class="string" id="6427379">&#34;mail:&nbsp;unclosed&nbsp;angle-addr&#34;</span><span class="op" id="6427406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6427409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427412"><a href="/net/mail/message.go.html#6421461">debug</a></span><span class="op" id="6427417">.</span><span class="ident" id="6427418">Printf</span><span class="op" id="6427424">(</span><span class="string" id="6427425">&#34;parseAddress:&nbsp;spec=%q&#34;</span><span class="op" id="6427448">,</span>&nbsp;<span class="ident" id="6427450"><a href="/net/mail/message.go.html#6426724">spec</a></span><span class="op" id="6427454">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427458">return</span>&nbsp;<span class="op" id="6427465">&amp;</span><span class="ident" id="6427466"><a href="/net/mail/message.go.html#6424159">Address</a></span><span class="op" id="6427473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427477">Name</span><span class="op" id="6427481">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6427486"><a href="/net/mail/message.go.html#6426954">displayName</a></span><span class="op" id="6427497">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427501">Address</span><span class="op" id="6427508">:</span>&nbsp;<span class="ident" id="6427510"><a href="/net/mail/message.go.html#6426724">spec</a></span><span class="op" id="6427514">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6427517">}</span><span class="op" id="6427518">,</span>&nbsp;<span class="ident" id="6427520">nil</span><br>
<span class="lineno"></span><span class="op" id="6427524">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="comment" id="6427527">//&nbsp;consumeAddrSpec&nbsp;parses&nbsp;a&nbsp;single&nbsp;RFC&nbsp;5322&nbsp;addr-spec&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="6427600">func</span>&nbsp;<span class="op" id="6427605">(</span><span class="ident" id="6427606">p</span>&nbsp;<span class="op" id="6427608">*</span><span class="ident" id="6427609"><a href="/net/mail/message.go.html#6425773">addrParser</a></span><span class="op" id="6427619">)</span>&nbsp;<span class="ident" id="6427621">consumeAddrSpec</span><span class="op" id="6427636">(</span><span class="op" id="6427637">)</span>&nbsp;<span class="op" id="6427639">(</span><span class="ident" id="6427640">spec</span>&nbsp;<span class="builtintype" id="6427645">string</span><span class="op" id="6427651">,</span>&nbsp;<span class="ident" id="6427653">err</span>&nbsp;<span class="builtintype" id="6427657">error</span><span class="op" id="6427662">)</span>&nbsp;<span class="op" id="6427664">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427667"><a href="/net/mail/message.go.html#6421461">debug</a></span><span class="op" id="6427672">.</span><span class="ident" id="6427673">Printf</span><span class="op" id="6427679">(</span><span class="string" id="6427680">&#34;consumeAddrSpec:&nbsp;%q&#34;</span><span class="op" id="6427701">,</span>&nbsp;<span class="op" id="6427703">*</span><span class="ident" id="6427704"><a href="/net/mail/message.go.html#6427606">p</a></span><span class="op" id="6427705">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427709">orig</span>&nbsp;<span class="op" id="6427714">:=</span>&nbsp;<span class="op" id="6427717">*</span><span class="ident" id="6427718"><a href="/net/mail/message.go.html#6427606">p</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427721">defer</span>&nbsp;<span class="keyword" id="6427727">func</span><span class="op" id="6427731">(</span><span class="op" id="6427732">)</span>&nbsp;<span class="op" id="6427734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427738">if</span>&nbsp;<span class="ident" id="6427741"><a href="/net/mail/message.go.html#6427653">err</a></span>&nbsp;<span class="op" id="6427745">!=</span>&nbsp;<span class="ident" id="6427748">nil</span>&nbsp;<span class="op" id="6427752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6427757">*</span><span class="ident" id="6427758"><a href="/net/mail/message.go.html#6427606">p</a></span>&nbsp;<span class="op" id="6427760">=</span>&nbsp;<span class="ident" id="6427762"><a href="/net/mail/message.go.html#6427709">orig</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6427769">}</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6427772">}</span><span class="op" id="6427773">(</span><span class="op" id="6427774">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6427778">//&nbsp;local-part&nbsp;=&nbsp;dot-atom&nbsp;/&nbsp;quoted-string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427820">var</span>&nbsp;<span class="ident" id="6427824">localPart</span>&nbsp;<span class="builtintype" id="6427834">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427842"><a href="/net/mail/message.go.html#6427606">p</a></span><span class="op" id="6427843">.</span><span class="ident" id="6427844">skipSpace</span><span class="op" id="6427853">(</span><span class="op" id="6427854">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427857">if</span>&nbsp;<span class="ident" id="6427860"><a href="/net/mail/message.go.html#6427606">p</a></span><span class="op" id="6427861">.</span><span class="ident" id="6427862">empty</span><span class="op" id="6427867">(</span><span class="op" id="6427868">)</span>&nbsp;<span class="op" id="6427870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427874">return</span>&nbsp;<span class="string" id="6427881">&#34;&#34;</span><span class="op" id="6427883">,</span>&nbsp;<span class="ident" id="6427885"><a href="/net/mail/message.go.html#6421354">errors</a></span><span class="op" id="6427891">.</span><span class="ident" id="6427892">New</span><span class="op" id="6427895">(</span><span class="string" id="6427896">&#34;mail:&nbsp;no&nbsp;addr-spec&#34;</span><span class="op" id="6427916">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6427919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6427922">if</span>&nbsp;<span class="ident" id="6427925"><a href="/net/mail/message.go.html#6427606">p</a></span><span class="op" id="6427926">.</span><span class="ident" id="6427927">peek</span><span class="op" id="6427931">(</span><span class="op" id="6427932">)</span>&nbsp;<span class="op" id="6427934">==</span>&nbsp;<span class="string" id="6427937">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="6427941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6427945">//&nbsp;quoted-string</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6427964"><a href="/net/mail/message.go.html#6421461">debug</a></span><span class="op" id="6427969">.</span><span class="ident" id="6427970">Printf</span><span class="op" id="6427976">(</span><span class="string" id="6427977">&#34;consumeAddrSpec:&nbsp;parsing&nbsp;quoted-string&#34;</span><span class="op" id="6428017">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428021"><a href="/net/mail/message.go.html#6427824">localPart</a></span><span class="op" id="6428030">,</span>&nbsp;<span class="ident" id="6428032"><a href="/net/mail/message.go.html#6427653">err</a></span>&nbsp;<span class="op" id="6428036">=</span>&nbsp;<span class="ident" id="6428038"><a href="/net/mail/message.go.html#6427606">p</a></span><span class="op" id="6428039">.</span><span class="ident" id="6428040">consumeQuotedString</span><span class="op" id="6428059">(</span><span class="op" id="6428060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6428063">}</span>&nbsp;<span class="keyword" id="6428065">else</span>&nbsp;<span class="op" id="6428070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6428074">//&nbsp;dot-atom</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428088"><a href="/net/mail/message.go.html#6421461">debug</a></span><span class="op" id="6428093">.</span><span class="ident" id="6428094">Printf</span><span class="op" id="6428100">(</span><span class="string" id="6428101">&#34;consumeAddrSpec:&nbsp;parsing&nbsp;dot-atom&#34;</span><span class="op" id="6428136">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428140"><a href="/net/mail/message.go.html#6427824">localPart</a></span><span class="op" id="6428149">,</span>&nbsp;<span class="ident" id="6428151"><a href="/net/mail/message.go.html#6427653">err</a></span>&nbsp;<span class="op" id="6428155">=</span>&nbsp;<span class="ident" id="6428157"><a href="/net/mail/message.go.html#6427606">p</a></span><span class="op" id="6428158">.</span><span class="ident" id="6428159">consumeAtom</span><span class="op" id="6428170">(</span><span class="ident" id="6428171">true</span><span class="op" id="6428175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6428178">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428181">if</span>&nbsp;<span class="ident" id="6428184"><a href="/net/mail/message.go.html#6427653">err</a></span>&nbsp;<span class="op" id="6428188">!=</span>&nbsp;<span class="ident" id="6428191">nil</span>&nbsp;<span class="op" id="6428195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428199"><a href="/net/mail/message.go.html#6421461">debug</a></span><span class="op" id="6428204">.</span><span class="ident" id="6428205">Printf</span><span class="op" id="6428211">(</span><span class="string" id="6428212">&#34;consumeAddrSpec:&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="6428241">,</span>&nbsp;<span class="ident" id="6428243"><a href="/net/mail/message.go.html#6427653">err</a></span><span class="op" id="6428246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428250">return</span>&nbsp;<span class="string" id="6428257">&#34;&#34;</span><span class="op" id="6428259">,</span>&nbsp;<span class="ident" id="6428261"><a href="/net/mail/message.go.html#6427653">err</a></span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6428266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428270">if</span>&nbsp;<span class="op" id="6428273">!</span><span class="ident" id="6428274"><a href="/net/mail/message.go.html#6427606">p</a></span><span class="op" id="6428275">.</span><span class="ident" id="6428276">consume</span><span class="op" id="6428283">(</span><span class="string" id="6428284">&#39;@&#39;</span><span class="op" id="6428287">)</span>&nbsp;<span class="op" id="6428289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428293">return</span>&nbsp;<span class="string" id="6428300">&#34;&#34;</span><span class="op" id="6428302">,</span>&nbsp;<span class="ident" id="6428304"><a href="/net/mail/message.go.html#6421354">errors</a></span><span class="op" id="6428310">.</span><span class="ident" id="6428311">New</span><span class="op" id="6428314">(</span><span class="string" id="6428315">&#34;mail:&nbsp;missing&nbsp;@&nbsp;in&nbsp;addr-spec&#34;</span><span class="op" id="6428345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6428348">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6428352">//&nbsp;domain&nbsp;=&nbsp;dot-atom&nbsp;/&nbsp;domain-literal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428391">var</span>&nbsp;<span class="ident" id="6428395">domain</span>&nbsp;<span class="builtintype" id="6428402">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428410"><a href="/net/mail/message.go.html#6427606">p</a></span><span class="op" id="6428411">.</span><span class="ident" id="6428412">skipSpace</span><span class="op" id="6428421">(</span><span class="op" id="6428422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428425">if</span>&nbsp;<span class="ident" id="6428428"><a href="/net/mail/message.go.html#6427606">p</a></span><span class="op" id="6428429">.</span><span class="ident" id="6428430">empty</span><span class="op" id="6428435">(</span><span class="op" id="6428436">)</span>&nbsp;<span class="op" id="6428438">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428442">return</span>&nbsp;<span class="string" id="6428449">&#34;&#34;</span><span class="op" id="6428451">,</span>&nbsp;<span class="ident" id="6428453"><a href="/net/mail/message.go.html#6421354">errors</a></span><span class="op" id="6428459">.</span><span class="ident" id="6428460">New</span><span class="op" id="6428463">(</span><span class="string" id="6428464">&#34;mail:&nbsp;no&nbsp;domain&nbsp;in&nbsp;addr-spec&#34;</span><span class="op" id="6428494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6428497">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6428500">//&nbsp;TODO(dsymonds):&nbsp;Handle&nbsp;domain-literal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428542"><a href="/net/mail/message.go.html#6428395">domain</a></span><span class="op" id="6428548">,</span>&nbsp;<span class="ident" id="6428550"><a href="/net/mail/message.go.html#6427653">err</a></span>&nbsp;<span class="op" id="6428554">=</span>&nbsp;<span class="ident" id="6428556"><a href="/net/mail/message.go.html#6427606">p</a></span><span class="op" id="6428557">.</span><span class="ident" id="6428558">consumeAtom</span><span class="op" id="6428569">(</span><span class="ident" id="6428570">true</span><span class="op" id="6428574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428577">if</span>&nbsp;<span class="ident" id="6428580"><a href="/net/mail/message.go.html#6427653">err</a></span>&nbsp;<span class="op" id="6428584">!=</span>&nbsp;<span class="ident" id="6428587">nil</span>&nbsp;<span class="op" id="6428591">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428595">return</span>&nbsp;<span class="string" id="6428602">&#34;&#34;</span><span class="op" id="6428604">,</span>&nbsp;<span class="ident" id="6428606"><a href="/net/mail/message.go.html#6427653">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6428611">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428615">return</span>&nbsp;<span class="ident" id="6428622"><a href="/net/mail/message.go.html#6427824">localPart</a></span>&nbsp;<span class="op" id="6428632">+</span>&nbsp;<span class="string" id="6428634">&#34;@&#34;</span>&nbsp;<span class="op" id="6428638">+</span>&nbsp;<span class="ident" id="6428640"><a href="/net/mail/message.go.html#6428395">domain</a></span><span class="op" id="6428646">,</span>&nbsp;<span class="ident" id="6428648">nil</span><br>
<span class="lineno"></span><span class="op" id="6428652">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="comment" id="6428655">//&nbsp;consumePhrase&nbsp;parses&nbsp;the&nbsp;RFC&nbsp;5322&nbsp;phrase&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="6428718">func</span>&nbsp;<span class="op" id="6428723">(</span><span class="ident" id="6428724">p</span>&nbsp;<span class="op" id="6428726">*</span><span class="ident" id="6428727"><a href="/net/mail/message.go.html#6425773">addrParser</a></span><span class="op" id="6428737">)</span>&nbsp;<span class="ident" id="6428739">consumePhrase</span><span class="op" id="6428752">(</span><span class="op" id="6428753">)</span>&nbsp;<span class="op" id="6428755">(</span><span class="ident" id="6428756">phrase</span>&nbsp;<span class="builtintype" id="6428763">string</span><span class="op" id="6428769">,</span>&nbsp;<span class="ident" id="6428771">err</span>&nbsp;<span class="builtintype" id="6428775">error</span><span class="op" id="6428780">)</span>&nbsp;<span class="op" id="6428782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428785"><a href="/net/mail/message.go.html#6421461">debug</a></span><span class="op" id="6428790">.</span><span class="ident" id="6428791">Printf</span><span class="op" id="6428797">(</span><span class="string" id="6428798">&#34;consumePhrase:&nbsp;[%s]&#34;</span><span class="op" id="6428819">,</span>&nbsp;<span class="op" id="6428821">*</span><span class="ident" id="6428822"><a href="/net/mail/message.go.html#6428724">p</a></span><span class="op" id="6428823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6428826">//&nbsp;phrase&nbsp;=&nbsp;1*word</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428846">var</span>&nbsp;<span class="ident" id="6428850">words</span>&nbsp;<span class="op" id="6428856">[</span><span class="op" id="6428857">]</span><span class="builtintype" id="6428858">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428866">for</span>&nbsp;<span class="op" id="6428870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6428874">//&nbsp;word&nbsp;=&nbsp;atom&nbsp;/&nbsp;quoted-string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428907">var</span>&nbsp;<span class="ident" id="6428911">word</span>&nbsp;<span class="builtintype" id="6428916">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6428925"><a href="/net/mail/message.go.html#6428724">p</a></span><span class="op" id="6428926">.</span><span class="ident" id="6428927">skipSpace</span><span class="op" id="6428936">(</span><span class="op" id="6428937">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428941">if</span>&nbsp;<span class="ident" id="6428944"><a href="/net/mail/message.go.html#6428724">p</a></span><span class="op" id="6428945">.</span><span class="ident" id="6428946">empty</span><span class="op" id="6428951">(</span><span class="op" id="6428952">)</span>&nbsp;<span class="op" id="6428954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6428959">return</span>&nbsp;<span class="string" id="6428966">&#34;&#34;</span><span class="op" id="6428968">,</span>&nbsp;<span class="ident" id="6428970"><a href="/net/mail/message.go.html#6421354">errors</a></span><span class="op" id="6428976">.</span><span class="ident" id="6428977">New</span><span class="op" id="6428980">(</span><span class="string" id="6428981">&#34;mail:&nbsp;missing&nbsp;phrase&#34;</span><span class="op" id="6429003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6429007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6429011">if</span>&nbsp;<span class="ident" id="6429014"><a href="/net/mail/message.go.html#6428724">p</a></span><span class="op" id="6429015">.</span><span class="ident" id="6429016">peek</span><span class="op" id="6429020">(</span><span class="op" id="6429021">)</span>&nbsp;<span class="op" id="6429023">==</span>&nbsp;<span class="string" id="6429026">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="6429030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6429035">//&nbsp;quoted-string</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6429055"><a href="/net/mail/message.go.html#6428911">word</a></span><span class="op" id="6429059">,</span>&nbsp;<span class="ident" id="6429061"><a href="/net/mail/message.go.html#6428771">err</a></span>&nbsp;<span class="op" id="6429065">=</span>&nbsp;<span class="ident" id="6429067"><a href="/net/mail/message.go.html#6428724">p</a></span><span class="op" id="6429068">.</span><span class="ident" id="6429069">consumeQuotedString</span><span class="op" id="6429088">(</span><span class="op" id="6429089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6429093">}</span>&nbsp;<span class="keyword" id="6429095">else</span>&nbsp;<span class="op" id="6429100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6429105">//&nbsp;atom</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6429116">//&nbsp;We&nbsp;actually&nbsp;parse&nbsp;dot-atom&nbsp;here&nbsp;to&nbsp;be&nbsp;more&nbsp;permissive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6429176">//&nbsp;than&nbsp;what&nbsp;RFC&nbsp;5322&nbsp;specifies.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6429212"><a href="/net/mail/message.go.html#6428911">word</a></span><span class="op" id="6429216">,</span>&nbsp;<span class="ident" id="6429218"><a href="/net/mail/message.go.html#6428771">err</a></span>&nbsp;<span class="op" id="6429222">=</span>&nbsp;<span class="ident" id="6429224"><a href="/net/mail/message.go.html#6428724">p</a></span><span class="op" id="6429225">.</span><span class="ident" id="6429226">consumeAtom</span><span class="op" id="6429237">(</span><span class="ident" id="6429238">true</span><span class="op" id="6429242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6429246">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6429251">//&nbsp;RFC&nbsp;2047&nbsp;encoded-word&nbsp;starts&nbsp;with&nbsp;=?,&nbsp;ends&nbsp;with&nbsp;?=,&nbsp;and&nbsp;has&nbsp;two&nbsp;other&nbsp;?s.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6429330">if</span>&nbsp;<span class="ident" id="6429333"><a href="/net/mail/message.go.html#6428771">err</a></span>&nbsp;<span class="op" id="6429337">==</span>&nbsp;<span class="ident" id="6429340">nil</span>&nbsp;<span class="op" id="6429344">&amp;&amp;</span>&nbsp;<span class="ident" id="6429347"><a href="/net/mail/message.go.html#6421425">strings</a></span><span class="op" id="6429354">.</span><span class="ident" id="6429355">HasPrefix</span><span class="op" id="6429364">(</span><span class="ident" id="6429365"><a href="/net/mail/message.go.html#6428911">word</a></span><span class="op" id="6429369">,</span>&nbsp;<span class="string" id="6429371">&#34;=?&#34;</span><span class="op" id="6429375">)</span>&nbsp;<span class="op" id="6429377">&amp;&amp;</span>&nbsp;<span class="ident" id="6429380"><a href="/net/mail/message.go.html#6421425">strings</a></span><span class="op" id="6429387">.</span><span class="ident" id="6429388">HasSuffix</span><span class="op" id="6429397">(</span><span class="ident" id="6429398"><a href="/net/mail/message.go.html#6428911">word</a></span><span class="op" id="6429402">,</span>&nbsp;<span class="string" id="6429404">&#34;?=&#34;</span><span class="op" id="6429408">)</span>&nbsp;<span class="op" id="6429410">&amp;&amp;</span>&nbsp;<span class="ident" id="6429413"><a href="/net/mail/message.go.html#6421425">strings</a></span><span class="op" id="6429420">.</span><span class="ident" id="6429421">Count</span><span class="op" id="6429426">(</span><span class="ident" id="6429427"><a href="/net/mail/message.go.html#6428911">word</a></span><span class="op" id="6429431">,</span>&nbsp;<span class="string" id="6429433">&#34;?&#34;</span><span class="op" id="6429436">)</span>&nbsp;<span class="op" id="6429438">==</span>&nbsp;<span class="num" id="6429441">4</span>&nbsp;<span class="op" id="6429443">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6429448"><a href="/net/mail/message.go.html#6428911">word</a></span><span class="op" id="6429452">,</span>&nbsp;<span class="ident" id="6429454"><a href="/net/mail/message.go.html#6428771">err</a></span>&nbsp;<span class="op" id="6429458">=</span>&nbsp;<span class="ident" id="6429460"><a href="/net/mail/message.go.html#6431491">decodeRFC2047Word</a></span><span class="op" id="6429477">(</span><span class="ident" id="6429478"><a href="/net/mail/message.go.html#6428911">word</a></span><span class="op" id="6429482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6429486">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6429491">if</span>&nbsp;<span class="ident" id="6429494"><a href="/net/mail/message.go.html#6428771">err</a></span>&nbsp;<span class="op" id="6429498">!=</span>&nbsp;<span class="ident" id="6429501">nil</span>&nbsp;<span class="op" id="6429505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6429510">break</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6429518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6429522"><a href="/net/mail/message.go.html#6421461">debug</a></span><span class="op" id="6429527">.</span><span class="ident" id="6429528">Printf</span><span class="op" id="6429534">(</span><span class="string" id="6429535">&#34;consumePhrase:&nbsp;consumed&nbsp;%q&#34;</span><span class="op" id="6429563">,</span>&nbsp;<span class="ident" id="6429565"><a href="/net/mail/message.go.html#6428911">word</a></span><span class="op" id="6429569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6429573"><a href="/net/mail/message.go.html#6428850">words</a></span>&nbsp;<span class="op" id="6429579">=</span>&nbsp;<span class="builtinfunc" id="6429581">append</span><span class="op" id="6429587">(</span><span class="ident" id="6429588"><a href="/net/mail/message.go.html#6428850">words</a></span><span class="op" id="6429593">,</span>&nbsp;<span class="ident" id="6429595"><a href="/net/mail/message.go.html#6428911">word</a></span><span class="op" id="6429599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6429602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6429605">//&nbsp;Ignore&nbsp;any&nbsp;error&nbsp;if&nbsp;we&nbsp;got&nbsp;at&nbsp;least&nbsp;one&nbsp;word.</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6429655">if</span>&nbsp;<span class="ident" id="6429658"><a href="/net/mail/message.go.html#6428771">err</a></span>&nbsp;<span class="op" id="6429662">!=</span>&nbsp;<span class="ident" id="6429665">nil</span>&nbsp;<span class="op" id="6429669">&amp;&amp;</span>&nbsp;<span class="builtinfunc" id="6429672">len</span><span class="op" id="6429675">(</span><span class="ident" id="6429676"><a href="/net/mail/message.go.html#6428850">words</a></span><span class="op" id="6429681">)</span>&nbsp;<span class="op" id="6429683">==</span>&nbsp;<span class="num" id="6429686">0</span>&nbsp;<span class="op" id="6429688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6429692"><a href="/net/mail/message.go.html#6421461">debug</a></span><span class="op" id="6429697">.</span><span class="ident" id="6429698">Printf</span><span class="op" id="6429704">(</span><span class="string" id="6429705">&#34;consumePhrase:&nbsp;hit&nbsp;err:&nbsp;%v&#34;</span><span class="op" id="6429733">,</span>&nbsp;<span class="ident" id="6429735"><a href="/net/mail/message.go.html#6428771">err</a></span><span class="op" id="6429738">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6429742">return</span>&nbsp;<span class="string" id="6429749">&#34;&#34;</span><span class="op" id="6429751">,</span>&nbsp;<span class="ident" id="6429753"><a href="/net/mail/message.go.html#6421364">fmt</a></span><span class="op" id="6429756">.</span><span class="ident" id="6429757">Errorf</span><span class="op" id="6429763">(</span><span class="string" id="6429764">&#34;mail:&nbsp;missing&nbsp;word&nbsp;in&nbsp;phrase:&nbsp;%v&#34;</span><span class="op" id="6429798">,</span>&nbsp;<span class="ident" id="6429800"><a href="/net/mail/message.go.html#6428771">err</a></span><span class="op" id="6429803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6429806">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6429809"><a href="/net/mail/message.go.html#6428756">phrase</a></span>&nbsp;<span class="op" id="6429816">=</span>&nbsp;<span class="ident" id="6429818"><a href="/net/mail/message.go.html#6421425">strings</a></span><span class="op" id="6429825">.</span><span class="ident" id="6429826">Join</span><span class="op" id="6429830">(</span><span class="ident" id="6429831"><a href="/net/mail/message.go.html#6428850">words</a></span><span class="op" id="6429836">,</span>&nbsp;<span class="string" id="6429838">&#34;&nbsp;&#34;</span><span class="op" id="6429841">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6429844">return</span>&nbsp;<span class="ident" id="6429851"><a href="/net/mail/message.go.html#6428756">phrase</a></span><span class="op" id="6429857">,</span>&nbsp;<span class="ident" id="6429859">nil</span><br>
<span class="lineno"></span><span class="op" id="6429863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6429866">//&nbsp;consumeQuotedString&nbsp;parses&nbsp;the&nbsp;quoted&nbsp;string&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;p.</span><br>
<span class="lineno"></span><span class="keyword" id="6429933">func</span>&nbsp;<span class="op" id="6429938">(</span><span class="ident" id="6429939">p</span>&nbsp;<span class="op" id="6429941">*</span><span class="ident" id="6429942"><a href="/net/mail/message.go.html#6425773">addrParser</a></span><span class="op" id="6429952">)</span>&nbsp;<span class="ident" id="6429954">consumeQuotedString</span><span class="op" id="6429973">(</span><span class="op" id="6429974">)</span>&nbsp;<span class="op" id="6429976">(</span><span class="ident" id="6429977">qs</span>&nbsp;<span class="builtintype" id="6429980">string</span><span class="op" id="6429986">,</span>&nbsp;<span class="ident" id="6429988">err</span>&nbsp;<span class="builtintype" id="6429992">error</span><span class="op" id="6429997">)</span>&nbsp;<span class="op" id="6429999">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6430002">//&nbsp;Assume&nbsp;first&nbsp;byte&nbsp;is&nbsp;&#39;&#34;&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6430032">i</span>&nbsp;<span class="op" id="6430034">:=</span>&nbsp;<span class="num" id="6430037">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6430040">qsb</span>&nbsp;<span class="op" id="6430044">:=</span>&nbsp;<span class="builtinfunc" id="6430047">make</span><span class="op" id="6430051">(</span><span class="op" id="6430052">[</span><span class="op" id="6430053">]</span><span class="builtintype" id="6430054">byte</span><span class="op" id="6430058">,</span>&nbsp;<span class="num" id="6430060">0</span><span class="op" id="6430061">,</span>&nbsp;<span class="num" id="6430063">10</span><span class="op" id="6430065">)</span><br>
<span class="lineno"></span><span class="ident" id="6430067">Loop</span><span class="op" id="6430071">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6430074">for</span>&nbsp;<span class="op" id="6430078">{</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6430082">if</span>&nbsp;<span class="ident" id="6430085"><a href="/net/mail/message.go.html#6430032">i</a></span>&nbsp;<span class="op" id="6430087">&gt;=</span>&nbsp;<span class="ident" id="6430090"><a href="/net/mail/message.go.html#6429939">p</a></span><span class="op" id="6430091">.</span><span class="builtinfunc" id="6430092">len</span><span class="op" id="6430095">(</span><span class="op" id="6430096">)</span>&nbsp;<span class="op" id="6430098">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6430103">return</span>&nbsp;<span class="string" id="6430110">&#34;&#34;</span><span class="op" id="6430112">,</span>&nbsp;<span class="ident" id="6430114"><a href="/net/mail/message.go.html#6421354">errors</a></span><span class="op" id="6430120">.</span><span class="ident" id="6430121">New</span><span class="op" id="6430124">(</span><span class="string" id="6430125">&#34;mail:&nbsp;unclosed&nbsp;quoted-string&#34;</span><span class="op" id="6430155">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6430159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6430163">switch</span>&nbsp;<span class="ident" id="6430170">c</span>&nbsp;<span class="op" id="6430172">:=</span>&nbsp;<span class="op" id="6430175">(</span><span class="op" id="6430176">*</span><span class="ident" id="6430177"><a href="/net/mail/message.go.html#6429939">p</a></span><span class="op" id="6430178">)</span><span class="op" id="6430179">[</span><span class="ident" id="6430180"><a href="/net/mail/message.go.html#6430032">i</a></span><span class="op" id="6430181">]</span><span class="op" id="6430182">;</span>&nbsp;<span class="op" id="6430184">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6430188">case</span>&nbsp;<span class="ident" id="6430193"><a href="/net/mail/message.go.html#6430170">c</a></span>&nbsp;<span class="op" id="6430195">==</span>&nbsp;<span class="string" id="6430198">&#39;&#34;&#39;</span><span class="op" id="6430201">:</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6430206">break</span>&nbsp;<span class="ident" id="6430212">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6430219">case</span>&nbsp;<span class="ident" id="6430224"><a href="/net/mail/message.go.html#6430170">c</a></span>&nbsp;<span class="op" id="6430226">==</span>&nbsp;<span class="string" id="6430229">&#39;\\&#39;</span><span class="op" id="6430233">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6430238">if</span>&nbsp;<span class="ident" id="6430241"><a href="/net/mail/message.go.html#6430032">i</a></span><span class="op" id="6430242">+</span><span class="num" id="6430243">1</span>&nbsp;<span class="op" id="6430245">==</span>&nbsp;<span class="ident" id="6430248"><a href="/net/mail/message.go.html#6429939">p</a></span><span class="op" id="6430249">.</span><span class="builtinfunc" id="6430250">len</span><span class="op" id="6430253">(</span><span class="op" id="6430254">)</span>&nbsp;<span class="op" id="6430256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6430262">return</span>&nbsp;<span class="string" id="6430269">&#34;&#34;</span><span class="op" id="6430271">,</span>&nbsp;<span class="ident" id="6430273"><a href="/net/mail/message.go.html#6421354">errors</a></span><span class="op" id="6430279">.</span><span class="ident" id="6430280">New</span><span class="op" id="6430283">(</span><span class="string" id="6430284">&#34;mail:&nbsp;unclosed&nbsp;quoted-string&#34;</span><span class="op" id="6430314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6430319">}</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6430324"><a href="/net/mail/message.go.html#6430040">qsb</a></span>&nbsp;<span class="op" id="6430328">=</span>&nbsp;<span class="builtinfunc" id="6430330">append</span><span class="op" id="6430336">(</span><span class="ident" id="6430337"><a href="/net/mail/message.go.html#6430040">qsb</a></span><span class="op" id="6430340">,</span>&nbsp;<span class="op" id="6430342">(</span><span class="op" id="6430343">*</span><span class="ident" id="6430344"><a href="/net/mail/message.go.html#6429939">p</a></span><span class="op" id="6430345">)</span><span class="op" id="6430346">[</span><span class="ident" id="6430347"><a href="/net/mail/message.go.html#6430032">i</a></span><span class="op" id="6430348">+</span><span class="num" id="6430349">1</span><span class="op" id="6430350">]</span><span class="op" id="6430351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6430356"><a href="/net/mail/message.go.html#6430032">i</a></span>&nbsp;<span class="op" id="6430358">+=</span>&nbsp;<span class="num" id="6430361">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6430365">case</span>&nbsp;<span class="ident" id="6430370"><a href="/net/mail/message.go.html#6433704">isQtext</a></span><span class="op" id="6430377">(</span><span class="ident" id="6430378"><a href="/net/mail/message.go.html#6430170">c</a></span><span class="op" id="6430379">)</span><span class="op" id="6430380">,</span>&nbsp;<span class="ident" id="6430382"><a href="/net/mail/message.go.html#6430170">c</a></span>&nbsp;<span class="op" id="6430384">==</span>&nbsp;<span class="string" id="6430387">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="6430391">||</span>&nbsp;<span class="ident" id="6430394"><a href="/net/mail/message.go.html#6430170">c</a></span>&nbsp;<span class="op" id="6430396">==</span>&nbsp;<span class="string" id="6430399">&#39;\t&#39;</span><span class="op" id="6430403">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6430408">//&nbsp;qtext&nbsp;(printable&nbsp;US-ASCII&nbsp;excluding&nbsp;&#34;&nbsp;and&nbsp;\),&nbsp;or</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6430463">//&nbsp;FWS&nbsp;(almost;&nbsp;we&#39;re&nbsp;ignoring&nbsp;CRLF)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6430503"><a href="/net/mail/message.go.html#6430040">qsb</a></span>&nbsp;<span class="op" id="6430507">=</span>&nbsp;<span class="builtinfunc" id="6430509">append</span><span class="op" id="6430515">(</span><span class="ident" id="6430516"><a href="/net/mail/message.go.html#6430040">qsb</a></span><span class="op" id="6430519">,</span>&nbsp;<span class="ident" id="6430521"><a href="/net/mail/message.go.html#6430170">c</a></span><span class="op" id="6430522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6430527"><a href="/net/mail/message.go.html#6430032">i</a></span><span class="op" id="6430528">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6430533">default</span><span class="op" id="6430540">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6430545">return</span>&nbsp;<span class="string" id="6430552">&#34;&#34;</span><span class="op" id="6430554">,</span>&nbsp;<span class="ident" id="6430556"><a href="/net/mail/message.go.html#6421364">fmt</a></span><span class="op" id="6430559">.</span><span class="ident" id="6430560">Errorf</span><span class="op" id="6430566">(</span><span class="string" id="6430567">&#34;mail:&nbsp;bad&nbsp;character&nbsp;in&nbsp;quoted-string:&nbsp;%q&#34;</span><span class="op" id="6430609">,</span>&nbsp;<span class="ident" id="6430611"><a href="/net/mail/message.go.html#6430170">c</a></span><span class="op" id="6430612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6430616">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6430619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6430622">*</span><span class="ident" id="6430623"><a href="/net/mail/message.go.html#6429939">p</a></span>&nbsp;<span class="op" id="6430625">=</span>&nbsp;<span class="op" id="6430627">(</span><span class="op" id="6430628">*</span><span class="ident" id="6430629"><a href="/net/mail/message.go.html#6429939">p</a></span><span class="op" id="6430630">)</span><span class="op" id="6430631">[</span><span class="ident" id="6430632"><a href="/net/mail/message.go.html#6430032">i</a></span><span class="op" id="6430633">+</span><span class="num" id="6430634">1</span><span class="op" id="6430635">:</span><span class="op" id="6430636">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6430639">return</span>&nbsp;<span class="builtintype" id="6430646">string</span><span class="op" id="6430652">(</span><span class="ident" id="6430653"><a href="/net/mail/message.go.html#6430040">qsb</a></span><span class="op" id="6430656">)</span><span class="op" id="6430657">,</span>&nbsp;<span class="ident" id="6430659">nil</span><br>
<span class="lineno"></span><span class="op" id="6430663">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">405</span><span class="comment" id="6430666">//&nbsp;consumeAtom&nbsp;parses&nbsp;an&nbsp;RFC&nbsp;5322&nbsp;atom&nbsp;at&nbsp;the&nbsp;start&nbsp;of&nbsp;p.</span><br>
<span class="lineno"></span><span class="comment" id="6430724">//&nbsp;If&nbsp;dot&nbsp;is&nbsp;true,&nbsp;consumeAtom&nbsp;parses&nbsp;an&nbsp;RFC&nbsp;5322&nbsp;dot-atom&nbsp;instead.</span><br>
<span class="lineno"></span><span class="keyword" id="6430792">func</span>&nbsp;<span class="op" id="6430797">(</span><span class="ident" id="6430798">p</span>&nbsp;<span class="op" id="6430800">*</span><span class="ident" id="6430801"><a href="/net/mail/message.go.html#6425773">addrParser</a></span><span class="op" id="6430811">)</span>&nbsp;<span class="ident" id="6430813">consumeAtom</span><span class="op" id="6430824">(</span><span class="ident" id="6430825">dot</span>&nbsp;<span class="builtintype" id="6430829">bool</span><span class="op" id="6430833">)</span>&nbsp;<span class="op" id="6430835">(</span><span class="ident" id="6430836">atom</span>&nbsp;<span class="builtintype" id="6430841">string</span><span class="op" id="6430847">,</span>&nbsp;<span class="ident" id="6430849">err</span>&nbsp;<span class="builtintype" id="6430853">error</span><span class="op" id="6430858">)</span>&nbsp;<span class="op" id="6430860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6430863">if</span>&nbsp;<span class="op" id="6430866">!</span><span class="ident" id="6430867"><a href="/net/mail/message.go.html#6433519">isAtext</a></span><span class="op" id="6430874">(</span><span class="ident" id="6430875"><a href="/net/mail/message.go.html#6430798">p</a></span><span class="op" id="6430876">.</span><span class="ident" id="6430877">peek</span><span class="op" id="6430881">(</span><span class="op" id="6430882">)</span><span class="op" id="6430883">,</span>&nbsp;<span class="ident" id="6430885">false</span><span class="op" id="6430890">)</span>&nbsp;<span class="op" id="6430892">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6430896">return</span>&nbsp;<span class="string" id="6430903">&#34;&#34;</span><span class="op" id="6430905">,</span>&nbsp;<span class="ident" id="6430907"><a href="/net/mail/message.go.html#6421354">errors</a></span><span class="op" id="6430913">.</span><span class="ident" id="6430914">New</span><span class="op" id="6430917">(</span><span class="string" id="6430918">&#34;mail:&nbsp;invalid&nbsp;string&#34;</span><span class="op" id="6430940">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6430943">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6430946">i</span>&nbsp;<span class="op" id="6430948">:=</span>&nbsp;<span class="num" id="6430951">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6430954">for</span>&nbsp;<span class="op" id="6430958">;</span>&nbsp;<span class="ident" id="6430960"><a href="/net/mail/message.go.html#6430946">i</a></span>&nbsp;<span class="op" id="6430962">&lt;</span>&nbsp;<span class="ident" id="6430964"><a href="/net/mail/message.go.html#6430798">p</a></span><span class="op" id="6430965">.</span><span class="builtinfunc" id="6430966">len</span><span class="op" id="6430969">(</span><span class="op" id="6430970">)</span>&nbsp;<span class="op" id="6430972">&amp;&amp;</span>&nbsp;<span class="ident" id="6430975"><a href="/net/mail/message.go.html#6433519">isAtext</a></span><span class="op" id="6430982">(</span><span class="op" id="6430983">(</span><span class="op" id="6430984">*</span><span class="ident" id="6430985"><a href="/net/mail/message.go.html#6430798">p</a></span><span class="op" id="6430986">)</span><span class="op" id="6430987">[</span><span class="ident" id="6430988"><a href="/net/mail/message.go.html#6430946">i</a></span><span class="op" id="6430989">]</span><span class="op" id="6430990">,</span>&nbsp;<span class="ident" id="6430992"><a href="/net/mail/message.go.html#6430825">dot</a></span><span class="op" id="6430995">)</span><span class="op" id="6430996">;</span>&nbsp;<span class="ident" id="6430998"><a href="/net/mail/message.go.html#6430946">i</a></span><span class="op" id="6430999">++</span>&nbsp;<span class="op" id="6431002">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6431005">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6431008"><a href="/net/mail/message.go.html#6430836">atom</a></span><span class="op" id="6431012">,</span>&nbsp;<span class="op" id="6431014">*</span><span class="ident" id="6431015"><a href="/net/mail/message.go.html#6430798">p</a></span>&nbsp;<span class="op" id="6431017">=</span>&nbsp;<span class="builtintype" id="6431019">string</span><span class="op" id="6431025">(</span><span class="op" id="6431026">(</span><span class="op" id="6431027">*</span><span class="ident" id="6431028"><a href="/net/mail/message.go.html#6430798">p</a></span><span class="op" id="6431029">)</span><span class="op" id="6431030">[</span><span class="op" id="6431031">:</span><span class="ident" id="6431032"><a href="/net/mail/message.go.html#6430946">i</a></span><span class="op" id="6431033">]</span><span class="op" id="6431034">)</span><span class="op" id="6431035">,</span>&nbsp;<span class="op" id="6431037">(</span><span class="op" id="6431038">*</span><span class="ident" id="6431039"><a href="/net/mail/message.go.html#6430798">p</a></span><span class="op" id="6431040">)</span><span class="op" id="6431041">[</span><span class="ident" id="6431042"><a href="/net/mail/message.go.html#6430946">i</a></span><span class="op" id="6431043">:</span><span class="op" id="6431044">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6431047">return</span>&nbsp;<span class="ident" id="6431054"><a href="/net/mail/message.go.html#6430836">atom</a></span><span class="op" id="6431058">,</span>&nbsp;<span class="ident" id="6431060">nil</span><br>
<span class="lineno"></span><span class="op" id="6431064">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6431067">func</span>&nbsp;<span class="op" id="6431072">(</span><span class="ident" id="6431073">p</span>&nbsp;<span class="op" id="6431075">*</span><span class="ident" id="6431076"><a href="/net/mail/message.go.html#6425773">addrParser</a></span><span class="op" id="6431086">)</span>&nbsp;<span class="ident" id="6431088">consume</span><span class="op" id="6431095">(</span><span class="ident" id="6431096">c</span>&nbsp;<span class="builtintype" id="6431098">byte</span><span class="op" id="6431102">)</span>&nbsp;<span class="builtintype" id="6431104">bool</span>&nbsp;<span class="op" id="6431109">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6431112">if</span>&nbsp;<span class="ident" id="6431115"><a href="/net/mail/message.go.html#6431073">p</a></span><span class="op" id="6431116">.</span><span class="ident" id="6431117">empty</span><span class="op" id="6431122">(</span><span class="op" id="6431123">)</span>&nbsp;<span class="op" id="6431125">||</span>&nbsp;<span class="ident" id="6431128"><a href="/net/mail/message.go.html#6431073">p</a></span><span class="op" id="6431129">.</span><span class="ident" id="6431130">peek</span><span class="op" id="6431134">(</span><span class="op" id="6431135">)</span>&nbsp;<span class="op" id="6431137">!=</span>&nbsp;<span class="ident" id="6431140"><a href="/net/mail/message.go.html#6431096">c</a></span>&nbsp;<span class="op" id="6431142">{</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6431146">return</span>&nbsp;<span class="ident" id="6431153">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6431160">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6431163">*</span><span class="ident" id="6431164"><a href="/net/mail/message.go.html#6431073">p</a></span>&nbsp;<span class="op" id="6431166">=</span>&nbsp;<span class="op" id="6431168">(</span><span class="op" id="6431169">*</span><span class="ident" id="6431170"><a href="/net/mail/message.go.html#6431073">p</a></span><span class="op" id="6431171">)</span><span class="op" id="6431172">[</span><span class="num" id="6431173">1</span><span class="op" id="6431174">:</span><span class="op" id="6431175">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6431178">return</span>&nbsp;<span class="ident" id="6431185">true</span><br>
<span class="lineno"></span><span class="op" id="6431190">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span><span class="comment" id="6431193">//&nbsp;skipSpace&nbsp;skips&nbsp;the&nbsp;leading&nbsp;space&nbsp;and&nbsp;tab&nbsp;characters.</span><br>
<span class="lineno"></span><span class="keyword" id="6431250">func</span>&nbsp;<span class="op" id="6431255">(</span><span class="ident" id="6431256">p</span>&nbsp;<span class="op" id="6431258">*</span><span class="ident" id="6431259"><a href="/net/mail/message.go.html#6425773">addrParser</a></span><span class="op" id="6431269">)</span>&nbsp;<span class="ident" id="6431271">skipSpace</span><span class="op" id="6431280">(</span><span class="op" id="6431281">)</span>&nbsp;<span class="op" id="6431283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6431286">*</span><span class="ident" id="6431287"><a href="/net/mail/message.go.html#6431256">p</a></span>&nbsp;<span class="op" id="6431289">=</span>&nbsp;<span class="ident" id="6431291"><a href="/net/mail/message.go.html#6421326">bytes</a></span><span class="op" id="6431296">.</span><span class="ident" id="6431297">TrimLeft</span><span class="op" id="6431305">(</span><span class="op" id="6431306">*</span><span class="ident" id="6431307"><a href="/net/mail/message.go.html#6431256">p</a></span><span class="op" id="6431308">,</span>&nbsp;<span class="string" id="6431310">&#34;&nbsp;\t&#34;</span><span class="op" id="6431315">)</span><br>
<span class="lineno"></span><span class="op" id="6431317">}</span><br>
<span class="lineno">430</span><br>
<span class="lineno"></span><span class="keyword" id="6431320">func</span>&nbsp;<span class="op" id="6431325">(</span><span class="ident" id="6431326">p</span>&nbsp;<span class="op" id="6431328">*</span><span class="ident" id="6431329"><a href="/net/mail/message.go.html#6425773">addrParser</a></span><span class="op" id="6431339">)</span>&nbsp;<span class="ident" id="6431341">peek</span><span class="op" id="6431345">(</span><span class="op" id="6431346">)</span>&nbsp;<span class="builtintype" id="6431348">byte</span>&nbsp;<span class="op" id="6431353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6431356">return</span>&nbsp;<span class="op" id="6431363">(</span><span class="op" id="6431364">*</span><span class="ident" id="6431365"><a href="/net/mail/message.go.html#6431326">p</a></span><span class="op" id="6431366">)</span><span class="op" id="6431367">[</span><span class="num" id="6431368">0</span><span class="op" id="6431369">]</span><br>
<span class="lineno"></span><span class="op" id="6431371">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="keyword" id="6431374">func</span>&nbsp;<span class="op" id="6431379">(</span><span class="ident" id="6431380">p</span>&nbsp;<span class="op" id="6431382">*</span><span class="ident" id="6431383"><a href="/net/mail/message.go.html#6425773">addrParser</a></span><span class="op" id="6431393">)</span>&nbsp;<span class="ident" id="6431395">empty</span><span class="op" id="6431400">(</span><span class="op" id="6431401">)</span>&nbsp;<span class="builtintype" id="6431403">bool</span>&nbsp;<span class="op" id="6431408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6431411">return</span>&nbsp;<span class="ident" id="6431418"><a href="/net/mail/message.go.html#6431380">p</a></span><span class="op" id="6431419">.</span><span class="builtinfunc" id="6431420">len</span><span class="op" id="6431423">(</span><span class="op" id="6431424">)</span>&nbsp;<span class="op" id="6431426">==</span>&nbsp;<span class="num" id="6431429">0</span><br>
<span class="lineno"></span><span class="op" id="6431431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6431434">func</span>&nbsp;<span class="op" id="6431439">(</span><span class="ident" id="6431440">p</span>&nbsp;<span class="op" id="6431442">*</span><span class="ident" id="6431443"><a href="/net/mail/message.go.html#6425773">addrParser</a></span><span class="op" id="6431453">)</span>&nbsp;<span class="builtinfunc" id="6431455">len</span><span class="op" id="6431458">(</span><span class="op" id="6431459">)</span>&nbsp;<span class="builtintype" id="6431461">int</span>&nbsp;<span class="op" id="6431465">{</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6431468">return</span>&nbsp;<span class="builtinfunc" id="6431475">len</span><span class="op" id="6431478">(</span><span class="op" id="6431479">*</span><span class="ident" id="6431480"><a href="/net/mail/message.go.html#6431440">p</a></span><span class="op" id="6431481">)</span><br>
<span class="lineno"></span><span class="op" id="6431483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6431486">func</span>&nbsp;<span class="ident" id="6431491">decodeRFC2047Word</span><span class="op" id="6431508">(</span><span class="ident" id="6431509">s</span>&nbsp;<span class="builtintype" id="6431511">string</span><span class="op" id="6431517">)</span>&nbsp;<span class="op" id="6431519">(</span><span class="builtintype" id="6431520">string</span><span class="op" id="6431526">,</span>&nbsp;<span class="builtintype" id="6431528">error</span><span class="op" id="6431533">)</span>&nbsp;<span class="op" id="6431535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6431538">fields</span>&nbsp;<span class="op" id="6431545">:=</span>&nbsp;<span class="ident" id="6431548"><a href="/net/mail/message.go.html#6421425">strings</a></span><span class="op" id="6431555">.</span><span class="ident" id="6431556">Split</span><span class="op" id="6431561">(</span><span class="ident" id="6431562"><a href="/net/mail/message.go.html#6431509">s</a></span><span class="op" id="6431563">,</span>&nbsp;<span class="string" id="6431565">&#34;?&#34;</span><span class="op" id="6431568">)</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6431571">if</span>&nbsp;<span class="builtinfunc" id="6431574">len</span><span class="op" id="6431577">(</span><span class="ident" id="6431578"><a href="/net/mail/message.go.html#6431538">fields</a></span><span class="op" id="6431584">)</span>&nbsp;<span class="op" id="6431586">!=</span>&nbsp;<span class="num" id="6431589">5</span>&nbsp;<span class="op" id="6431591">||</span>&nbsp;<span class="ident" id="6431594"><a href="/net/mail/message.go.html#6431538">fields</a></span><span class="op" id="6431600">[</span><span class="num" id="6431601">0</span><span class="op" id="6431602">]</span>&nbsp;<span class="op" id="6431604">!=</span>&nbsp;<span class="string" id="6431607">&#34;=&#34;</span>&nbsp;<span class="op" id="6431611">||</span>&nbsp;<span class="ident" id="6431614"><a href="/net/mail/message.go.html#6431538">fields</a></span><span class="op" id="6431620">[</span><span class="num" id="6431621">4</span><span class="op" id="6431622">]</span>&nbsp;<span class="op" id="6431624">!=</span>&nbsp;<span class="string" id="6431627">&#34;=&#34;</span>&nbsp;<span class="op" id="6431631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6431635">return</span>&nbsp;<span class="string" id="6431642">&#34;&#34;</span><span class="op" id="6431644">,</span>&nbsp;<span class="ident" id="6431646"><a href="/net/mail/message.go.html#6421354">errors</a></span><span class="op" id="6431652">.</span><span class="ident" id="6431653">New</span><span class="op" id="6431656">(</span><span class="string" id="6431657">&#34;address&nbsp;not&nbsp;RFC&nbsp;2047&nbsp;encoded&#34;</span><span class="op" id="6431687">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6431690">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6431693">charset</span><span class="op" id="6431700">,</span>&nbsp;<span class="ident" id="6431702">enc</span>&nbsp;<span class="op" id="6431706">:=</span>&nbsp;<span class="ident" id="6431709"><a href="/net/mail/message.go.html#6421425">strings</a></span><span class="op" id="6431716">.</span><span class="ident" id="6431717">ToLower</span><span class="op" id="6431724">(</span><span class="ident" id="6431725"><a href="/net/mail/message.go.html#6431538">fields</a></span><span class="op" id="6431731">[</span><span class="num" id="6431732">1</span><span class="op" id="6431733">]</span><span class="op" id="6431734">)</span><span class="op" id="6431735">,</span>&nbsp;<span class="ident" id="6431737"><a href="/net/mail/message.go.html#6421425">strings</a></span><span class="op" id="6431744">.</span><span class="ident" id="6431745">ToLower</span><span class="op" id="6431752">(</span><span class="ident" id="6431753"><a href="/net/mail/message.go.html#6431538">fields</a></span><span class="op" id="6431759">[</span><span class="num" id="6431760">2</span><span class="op" id="6431761">]</span><span class="op" id="6431762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6431765">if</span>&nbsp;<span class="ident" id="6431768"><a href="/net/mail/message.go.html#6431693">charset</a></span>&nbsp;<span class="op" id="6431776">!=</span>&nbsp;<span class="string" id="6431779">&#34;us-ascii&#34;</span>&nbsp;<span class="op" id="6431790">&amp;&amp;</span>&nbsp;<span class="ident" id="6431793"><a href="/net/mail/message.go.html#6431693">charset</a></span>&nbsp;<span class="op" id="6431801">!=</span>&nbsp;<span class="string" id="6431804">&#34;iso-8859-1&#34;</span>&nbsp;<span class="op" id="6431817">&amp;&amp;</span>&nbsp;<span class="ident" id="6431820"><a href="/net/mail/message.go.html#6431693">charset</a></span>&nbsp;<span class="op" id="6431828">!=</span>&nbsp;<span class="string" id="6431831">&#34;utf-8&#34;</span>&nbsp;<span class="op" id="6431839">{</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6431843">return</span>&nbsp;<span class="string" id="6431850">&#34;&#34;</span><span class="op" id="6431852">,</span>&nbsp;<span class="ident" id="6431854"><a href="/net/mail/message.go.html#6421364">fmt</a></span><span class="op" id="6431857">.</span><span class="ident" id="6431858">Errorf</span><span class="op" id="6431864">(</span><span class="string" id="6431865">&#34;charset&nbsp;not&nbsp;supported:&nbsp;%q&#34;</span><span class="op" id="6431892">,</span>&nbsp;<span class="ident" id="6431894"><a href="/net/mail/message.go.html#6431693">charset</a></span><span class="op" id="6431901">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6431904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6431908">in</span>&nbsp;<span class="op" id="6431911">:=</span>&nbsp;<span class="ident" id="6431914"><a href="/net/mail/message.go.html#6421326">bytes</a></span><span class="op" id="6431919">.</span><span class="ident" id="6431920">NewBufferString</span><span class="op" id="6431935">(</span><span class="ident" id="6431936"><a href="/net/mail/message.go.html#6431538">fields</a></span><span class="op" id="6431942">[</span><span class="num" id="6431943">3</span><span class="op" id="6431944">]</span><span class="op" id="6431945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6431948">var</span>&nbsp;<span class="ident" id="6431952">r</span>&nbsp;<span class="ident" id="6431954"><a href="/net/mail/message.go.html#6421371">io</a></span><span class="op" id="6431956">.</span><span class="ident" id="6431957">Reader</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6431965">switch</span>&nbsp;<span class="ident" id="6431972"><a href="/net/mail/message.go.html#6431702">enc</a></span>&nbsp;<span class="op" id="6431976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6431979">case</span>&nbsp;<span class="string" id="6431984">&#34;b&#34;</span><span class="op" id="6431987">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6431991"><a href="/net/mail/message.go.html#6431952">r</a></span>&nbsp;<span class="op" id="6431993">=</span>&nbsp;<span class="ident" id="6431995"><a href="/net/mail/message.go.html#6421335">base64</a></span><span class="op" id="6432001">.</span><span class="ident" id="6432002">NewDecoder</span><span class="op" id="6432012">(</span><span class="ident" id="6432013"><a href="/net/mail/message.go.html#6421335">base64</a></span><span class="op" id="6432019">.</span><span class="ident" id="6432020">StdEncoding</span><span class="op" id="6432031">,</span>&nbsp;<span class="ident" id="6432033"><a href="/net/mail/message.go.html#6431908">in</a></span><span class="op" id="6432035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432038">case</span>&nbsp;<span class="string" id="6432043">&#34;q&#34;</span><span class="op" id="6432046">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6432050"><a href="/net/mail/message.go.html#6431952">r</a></span>&nbsp;<span class="op" id="6432052">=</span>&nbsp;<span class="ident" id="6432054"><a href="/net/mail/message.go.html#6432636">qDecoder</a></span><span class="op" id="6432062">{</span><span class="ident" id="6432063">r</span><span class="op" id="6432064">:</span>&nbsp;<span class="ident" id="6432066"><a href="/net/mail/message.go.html#6431908">in</a></span><span class="op" id="6432068">}</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432071">default</span><span class="op" id="6432078">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432082">return</span>&nbsp;<span class="string" id="6432089">&#34;&#34;</span><span class="op" id="6432091">,</span>&nbsp;<span class="ident" id="6432093"><a href="/net/mail/message.go.html#6421364">fmt</a></span><span class="op" id="6432096">.</span><span class="ident" id="6432097">Errorf</span><span class="op" id="6432103">(</span><span class="string" id="6432104">&#34;RFC&nbsp;2047&nbsp;encoding&nbsp;not&nbsp;supported:&nbsp;%q&#34;</span><span class="op" id="6432141">,</span>&nbsp;<span class="ident" id="6432143"><a href="/net/mail/message.go.html#6431702">enc</a></span><span class="op" id="6432146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6432149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6432153">dec</span><span class="op" id="6432156">,</span>&nbsp;<span class="ident" id="6432158">err</span>&nbsp;<span class="op" id="6432162">:=</span>&nbsp;<span class="ident" id="6432165"><a href="/net/mail/message.go.html#6421377">ioutil</a></span><span class="op" id="6432171">.</span><span class="ident" id="6432172">ReadAll</span><span class="op" id="6432179">(</span><span class="ident" id="6432180"><a href="/net/mail/message.go.html#6431952">r</a></span><span class="op" id="6432181">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432184">if</span>&nbsp;<span class="ident" id="6432187"><a href="/net/mail/message.go.html#6432158">err</a></span>&nbsp;<span class="op" id="6432191">!=</span>&nbsp;<span class="ident" id="6432194">nil</span>&nbsp;<span class="op" id="6432198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432202">return</span>&nbsp;<span class="string" id="6432209">&#34;&#34;</span><span class="op" id="6432211">,</span>&nbsp;<span class="ident" id="6432213"><a href="/net/mail/message.go.html#6432158">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6432218">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432222">switch</span>&nbsp;<span class="ident" id="6432229"><a href="/net/mail/message.go.html#6431693">charset</a></span>&nbsp;<span class="op" id="6432237">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432240">case</span>&nbsp;<span class="string" id="6432245">&#34;us-ascii&#34;</span><span class="op" id="6432255">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6432259">b</span>&nbsp;<span class="op" id="6432261">:=</span>&nbsp;<span class="builtinfunc" id="6432264">new</span><span class="op" id="6432267">(</span><span class="ident" id="6432268"><a href="/net/mail/message.go.html#6421326">bytes</a></span><span class="op" id="6432273">.</span><span class="ident" id="6432274">Buffer</span><span class="op" id="6432280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432284">for</span>&nbsp;<span class="ident" id="6432288">_</span><span class="op" id="6432289">,</span>&nbsp;<span class="ident" id="6432291">c</span>&nbsp;<span class="op" id="6432293">:=</span>&nbsp;<span class="keyword" id="6432296">range</span>&nbsp;<span class="ident" id="6432302"><a href="/net/mail/message.go.html#6432153">dec</a></span>&nbsp;<span class="op" id="6432306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432311">if</span>&nbsp;<span class="ident" id="6432314"><a href="/net/mail/message.go.html#6432291">c</a></span>&nbsp;<span class="op" id="6432316">&gt;=</span>&nbsp;<span class="num" id="6432319">0x80</span>&nbsp;<span class="op" id="6432324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6432330"><a href="/net/mail/message.go.html#6432259">b</a></span><span class="op" id="6432331">.</span><span class="ident" id="6432332">WriteRune</span><span class="op" id="6432341">(</span><span class="ident" id="6432342"><a href="/net/mail/message.go.html#6421444">unicode</a></span><span class="op" id="6432349">.</span><span class="ident" id="6432350">ReplacementChar</span><span class="op" id="6432365">)</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6432370">}</span>&nbsp;<span class="keyword" id="6432372">else</span>&nbsp;<span class="op" id="6432377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6432383"><a href="/net/mail/message.go.html#6432259">b</a></span><span class="op" id="6432384">.</span><span class="ident" id="6432385">WriteRune</span><span class="op" id="6432394">(</span><span class="builtintype" id="6432395">rune</span><span class="op" id="6432399">(</span><span class="ident" id="6432400"><a href="/net/mail/message.go.html#6432291">c</a></span><span class="op" id="6432401">)</span><span class="op" id="6432402">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6432407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6432411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432415">return</span>&nbsp;<span class="ident" id="6432422"><a href="/net/mail/message.go.html#6432259">b</a></span><span class="op" id="6432423">.</span><span class="ident" id="6432424">String</span><span class="op" id="6432430">(</span><span class="op" id="6432431">)</span><span class="op" id="6432432">,</span>&nbsp;<span class="ident" id="6432434">nil</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432439">case</span>&nbsp;<span class="string" id="6432444">&#34;iso-8859-1&#34;</span><span class="op" id="6432456">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6432460">b</span>&nbsp;<span class="op" id="6432462">:=</span>&nbsp;<span class="builtinfunc" id="6432465">new</span><span class="op" id="6432468">(</span><span class="ident" id="6432469"><a href="/net/mail/message.go.html#6421326">bytes</a></span><span class="op" id="6432474">.</span><span class="ident" id="6432475">Buffer</span><span class="op" id="6432481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432485">for</span>&nbsp;<span class="ident" id="6432489">_</span><span class="op" id="6432490">,</span>&nbsp;<span class="ident" id="6432492">c</span>&nbsp;<span class="op" id="6432494">:=</span>&nbsp;<span class="keyword" id="6432497">range</span>&nbsp;<span class="ident" id="6432503"><a href="/net/mail/message.go.html#6432153">dec</a></span>&nbsp;<span class="op" id="6432507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6432512"><a href="/net/mail/message.go.html#6432460">b</a></span><span class="op" id="6432513">.</span><span class="ident" id="6432514">WriteRune</span><span class="op" id="6432523">(</span><span class="builtintype" id="6432524">rune</span><span class="op" id="6432528">(</span><span class="ident" id="6432529"><a href="/net/mail/message.go.html#6432492">c</a></span><span class="op" id="6432530">)</span><span class="op" id="6432531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6432535">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432539">return</span>&nbsp;<span class="ident" id="6432546"><a href="/net/mail/message.go.html#6432460">b</a></span><span class="op" id="6432547">.</span><span class="ident" id="6432548">String</span><span class="op" id="6432554">(</span><span class="op" id="6432555">)</span><span class="op" id="6432556">,</span>&nbsp;<span class="ident" id="6432558">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432563">case</span>&nbsp;<span class="string" id="6432568">&#34;utf-8&#34;</span><span class="op" id="6432575">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432579">return</span>&nbsp;<span class="builtintype" id="6432586">string</span><span class="op" id="6432592">(</span><span class="ident" id="6432593"><a href="/net/mail/message.go.html#6432153">dec</a></span><span class="op" id="6432596">)</span><span class="op" id="6432597">,</span>&nbsp;<span class="ident" id="6432599">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6432604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6432607">panic</span><span class="op" id="6432612">(</span><span class="string" id="6432613">&#34;unreachable&#34;</span><span class="op" id="6432626">)</span><br>
<span class="lineno">490</span><span class="op" id="6432628">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6432631">type</span>&nbsp;<span class="ident" id="6432636">qDecoder</span>&nbsp;<span class="keyword" id="6432645">struct</span>&nbsp;<span class="op" id="6432652">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6432655">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6432663"><a href="/net/mail/message.go.html#6421371">io</a></span><span class="op" id="6432665">.</span><span class="ident" id="6432666">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6432674">scratch</span>&nbsp;<span class="op" id="6432682">[</span><span class="num" id="6432683">2</span><span class="op" id="6432684">]</span><span class="builtintype" id="6432685">byte</span><br>
<span class="lineno">495</span><span class="op" id="6432690">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6432693">func</span>&nbsp;<span class="op" id="6432698">(</span><span class="ident" id="6432699">qd</span>&nbsp;<span class="ident" id="6432702"><a href="/net/mail/message.go.html#6432636">qDecoder</a></span><span class="op" id="6432710">)</span>&nbsp;<span class="ident" id="6432712">Read</span><span class="op" id="6432716">(</span><span class="ident" id="6432717">p</span>&nbsp;<span class="op" id="6432719">[</span><span class="op" id="6432720">]</span><span class="builtintype" id="6432721">byte</span><span class="op" id="6432725">)</span>&nbsp;<span class="op" id="6432727">(</span><span class="ident" id="6432728">n</span>&nbsp;<span class="builtintype" id="6432730">int</span><span class="op" id="6432733">,</span>&nbsp;<span class="ident" id="6432735">err</span>&nbsp;<span class="builtintype" id="6432739">error</span><span class="op" id="6432744">)</span>&nbsp;<span class="op" id="6432746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6432749">//&nbsp;This&nbsp;method&nbsp;writes&nbsp;at&nbsp;most&nbsp;one&nbsp;byte&nbsp;into&nbsp;p.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432797">if</span>&nbsp;<span class="builtinfunc" id="6432800">len</span><span class="op" id="6432803">(</span><span class="ident" id="6432804"><a href="/net/mail/message.go.html#6432717">p</a></span><span class="op" id="6432805">)</span>&nbsp;<span class="op" id="6432807">==</span>&nbsp;<span class="num" id="6432810">0</span>&nbsp;<span class="op" id="6432812">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432816">return</span>&nbsp;<span class="num" id="6432823">0</span><span class="op" id="6432824">,</span>&nbsp;<span class="ident" id="6432826">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6432831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432834">if</span>&nbsp;<span class="ident" id="6432837">_</span><span class="op" id="6432838">,</span>&nbsp;<span class="ident" id="6432840">err</span>&nbsp;<span class="op" id="6432844">:=</span>&nbsp;<span class="ident" id="6432847"><a href="/net/mail/message.go.html#6432699">qd</a></span><span class="op" id="6432849">.</span><span class="ident" id="6432850">r</span><span class="op" id="6432851">.</span><span class="ident" id="6432852">Read</span><span class="op" id="6432856">(</span><span class="ident" id="6432857"><a href="/net/mail/message.go.html#6432699">qd</a></span><span class="op" id="6432859">.</span><span class="ident" id="6432860">scratch</span><span class="op" id="6432867">[</span><span class="op" id="6432868">:</span><span class="num" id="6432869">1</span><span class="op" id="6432870">]</span><span class="op" id="6432871">)</span><span class="op" id="6432872">;</span>&nbsp;<span class="ident" id="6432874"><a href="/net/mail/message.go.html#6432840">err</a></span>&nbsp;<span class="op" id="6432878">!=</span>&nbsp;<span class="ident" id="6432881">nil</span>&nbsp;<span class="op" id="6432885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432889">return</span>&nbsp;<span class="num" id="6432896">0</span><span class="op" id="6432897">,</span>&nbsp;<span class="ident" id="6432899"><a href="/net/mail/message.go.html#6432840">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6432904">}</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432907">switch</span>&nbsp;<span class="ident" id="6432914">c</span>&nbsp;<span class="op" id="6432916">:=</span>&nbsp;<span class="ident" id="6432919"><a href="/net/mail/message.go.html#6432699">qd</a></span><span class="op" id="6432921">.</span><span class="ident" id="6432922">scratch</span><span class="op" id="6432929">[</span><span class="num" id="6432930">0</span><span class="op" id="6432931">]</span><span class="op" id="6432932">;</span>&nbsp;<span class="op" id="6432934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432937">case</span>&nbsp;<span class="ident" id="6432942"><a href="/net/mail/message.go.html#6432914">c</a></span>&nbsp;<span class="op" id="6432944">==</span>&nbsp;<span class="string" id="6432947">&#39;=&#39;</span><span class="op" id="6432950">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6432954">if</span>&nbsp;<span class="ident" id="6432957">_</span><span class="op" id="6432958">,</span>&nbsp;<span class="ident" id="6432960">err</span>&nbsp;<span class="op" id="6432964">:=</span>&nbsp;<span class="ident" id="6432967"><a href="/net/mail/message.go.html#6421371">io</a></span><span class="op" id="6432969">.</span><span class="ident" id="6432970">ReadFull</span><span class="op" id="6432978">(</span><span class="ident" id="6432979"><a href="/net/mail/message.go.html#6432699">qd</a></span><span class="op" id="6432981">.</span><span class="ident" id="6432982">r</span><span class="op" id="6432983">,</span>&nbsp;<span class="ident" id="6432985"><a href="/net/mail/message.go.html#6432699">qd</a></span><span class="op" id="6432987">.</span><span class="ident" id="6432988">scratch</span><span class="op" id="6432995">[</span><span class="op" id="6432996">:</span><span class="num" id="6432997">2</span><span class="op" id="6432998">]</span><span class="op" id="6432999">)</span><span class="op" id="6433000">;</span>&nbsp;<span class="ident" id="6433002"><a href="/net/mail/message.go.html#6432960">err</a></span>&nbsp;<span class="op" id="6433006">!=</span>&nbsp;<span class="ident" id="6433009">nil</span>&nbsp;<span class="op" id="6433013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433018">return</span>&nbsp;<span class="num" id="6433025">0</span><span class="op" id="6433026">,</span>&nbsp;<span class="ident" id="6433028"><a href="/net/mail/message.go.html#6432960">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6433034">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6433038">x</span><span class="op" id="6433039">,</span>&nbsp;<span class="ident" id="6433041">err</span>&nbsp;<span class="op" id="6433045">:=</span>&nbsp;<span class="ident" id="6433048"><a href="/net/mail/message.go.html#6421414">strconv</a></span><span class="op" id="6433055">.</span><span class="ident" id="6433056">ParseInt</span><span class="op" id="6433064">(</span><span class="builtintype" id="6433065">string</span><span class="op" id="6433071">(</span><span class="ident" id="6433072"><a href="/net/mail/message.go.html#6432699">qd</a></span><span class="op" id="6433074">.</span><span class="ident" id="6433075">scratch</span><span class="op" id="6433082">[</span><span class="op" id="6433083">:</span><span class="num" id="6433084">2</span><span class="op" id="6433085">]</span><span class="op" id="6433086">)</span><span class="op" id="6433087">,</span>&nbsp;<span class="num" id="6433089">16</span><span class="op" id="6433091">,</span>&nbsp;<span class="num" id="6433093">64</span><span class="op" id="6433095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433099">if</span>&nbsp;<span class="ident" id="6433102"><a href="/net/mail/message.go.html#6433041">err</a></span>&nbsp;<span class="op" id="6433106">!=</span>&nbsp;<span class="ident" id="6433109">nil</span>&nbsp;<span class="op" id="6433113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433118">return</span>&nbsp;<span class="num" id="6433125">0</span><span class="op" id="6433126">,</span>&nbsp;<span class="ident" id="6433128"><a href="/net/mail/message.go.html#6421364">fmt</a></span><span class="op" id="6433131">.</span><span class="ident" id="6433132">Errorf</span><span class="op" id="6433138">(</span><span class="string" id="6433139">&#34;mail:&nbsp;invalid&nbsp;RFC&nbsp;2047&nbsp;encoding:&nbsp;%q&#34;</span><span class="op" id="6433176">,</span>&nbsp;<span class="ident" id="6433178"><a href="/net/mail/message.go.html#6432699">qd</a></span><span class="op" id="6433180">.</span><span class="ident" id="6433181">scratch</span><span class="op" id="6433188">[</span><span class="op" id="6433189">:</span><span class="num" id="6433190">2</span><span class="op" id="6433191">]</span><span class="op" id="6433192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6433196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6433200"><a href="/net/mail/message.go.html#6432717">p</a></span><span class="op" id="6433201">[</span><span class="num" id="6433202">0</span><span class="op" id="6433203">]</span>&nbsp;<span class="op" id="6433205">=</span>&nbsp;<span class="builtintype" id="6433207">byte</span><span class="op" id="6433211">(</span><span class="ident" id="6433212"><a href="/net/mail/message.go.html#6433038">x</a></span><span class="op" id="6433213">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433216">case</span>&nbsp;<span class="ident" id="6433221"><a href="/net/mail/message.go.html#6432914">c</a></span>&nbsp;<span class="op" id="6433223">==</span>&nbsp;<span class="string" id="6433226">&#39;_&#39;</span><span class="op" id="6433229">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6433233"><a href="/net/mail/message.go.html#6432717">p</a></span><span class="op" id="6433234">[</span><span class="num" id="6433235">0</span><span class="op" id="6433236">]</span>&nbsp;<span class="op" id="6433238">=</span>&nbsp;<span class="string" id="6433240">&#39;&nbsp;&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433245">default</span><span class="op" id="6433252">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6433256"><a href="/net/mail/message.go.html#6432717">p</a></span><span class="op" id="6433257">[</span><span class="num" id="6433258">0</span><span class="op" id="6433259">]</span>&nbsp;<span class="op" id="6433261">=</span>&nbsp;<span class="ident" id="6433263"><a href="/net/mail/message.go.html#6432914">c</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6433266">}</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433269">return</span>&nbsp;<span class="num" id="6433276">1</span><span class="op" id="6433277">,</span>&nbsp;<span class="ident" id="6433279">nil</span><br>
<span class="lineno"></span><span class="op" id="6433283">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6433286">var</span>&nbsp;<span class="ident" id="6433290">atextChars</span>&nbsp;<span class="op" id="6433301">=</span>&nbsp;<span class="op" id="6433303">[</span><span class="op" id="6433304">]</span><span class="builtintype" id="6433305">byte</span><span class="op" id="6433309">(</span><span class="string" id="6433310">&#34;ABCDEFGHIJKLMNOPQRSTUVWXYZ&#34;</span>&nbsp;<span class="op" id="6433339">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6433342">&#34;abcdefghijklmnopqrstuvwxyz&#34;</span>&nbsp;<span class="op" id="6433371">+</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6433374">&#34;0123456789&#34;</span>&nbsp;<span class="op" id="6433387">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6433390">&#34;!#$%&amp;&#39;*+-/=?^_`{|}~&#34;</span><span class="op" id="6433411">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6433414">//&nbsp;isAtext&nbsp;returns&nbsp;true&nbsp;if&nbsp;c&nbsp;is&nbsp;an&nbsp;RFC&nbsp;5322&nbsp;atext&nbsp;character.</span><br>
<span class="lineno"></span><span class="comment" id="6433475">//&nbsp;If&nbsp;dot&nbsp;is&nbsp;true,&nbsp;period&nbsp;is&nbsp;included.</span><br>
<span class="lineno">530</span><span class="keyword" id="6433514">func</span>&nbsp;<span class="ident" id="6433519">isAtext</span><span class="op" id="6433526">(</span><span class="ident" id="6433527">c</span>&nbsp;<span class="builtintype" id="6433529">byte</span><span class="op" id="6433533">,</span>&nbsp;<span class="ident" id="6433535">dot</span>&nbsp;<span class="builtintype" id="6433539">bool</span><span class="op" id="6433543">)</span>&nbsp;<span class="builtintype" id="6433545">bool</span>&nbsp;<span class="op" id="6433550">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433553">if</span>&nbsp;<span class="ident" id="6433556"><a href="/net/mail/message.go.html#6433535">dot</a></span>&nbsp;<span class="op" id="6433560">&amp;&amp;</span>&nbsp;<span class="ident" id="6433563"><a href="/net/mail/message.go.html#6433527">c</a></span>&nbsp;<span class="op" id="6433565">==</span>&nbsp;<span class="string" id="6433568">&#39;.&#39;</span>&nbsp;<span class="op" id="6433572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433576">return</span>&nbsp;<span class="ident" id="6433583">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6433589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433592">return</span>&nbsp;<span class="ident" id="6433599"><a href="/net/mail/message.go.html#6421326">bytes</a></span><span class="op" id="6433604">.</span><span class="ident" id="6433605">IndexByte</span><span class="op" id="6433614">(</span><span class="ident" id="6433615"><a href="/net/mail/message.go.html#6433290">atextChars</a></span><span class="op" id="6433625">,</span>&nbsp;<span class="ident" id="6433627"><a href="/net/mail/message.go.html#6433527">c</a></span><span class="op" id="6433628">)</span>&nbsp;<span class="op" id="6433630">&gt;=</span>&nbsp;<span class="num" id="6433633">0</span><br>
<span class="lineno">535</span><span class="op" id="6433635">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6433638">//&nbsp;isQtext&nbsp;returns&nbsp;true&nbsp;if&nbsp;c&nbsp;is&nbsp;an&nbsp;RFC&nbsp;5322&nbsp;qtext&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="6433699">func</span>&nbsp;<span class="ident" id="6433704">isQtext</span><span class="op" id="6433711">(</span><span class="ident" id="6433712">c</span>&nbsp;<span class="builtintype" id="6433714">byte</span><span class="op" id="6433718">)</span>&nbsp;<span class="builtintype" id="6433720">bool</span>&nbsp;<span class="op" id="6433725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6433728">//&nbsp;Printable&nbsp;US-ASCII,&nbsp;excluding&nbsp;backslash&nbsp;or&nbsp;quote.</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433782">if</span>&nbsp;<span class="ident" id="6433785"><a href="/net/mail/message.go.html#6433712">c</a></span>&nbsp;<span class="op" id="6433787">==</span>&nbsp;<span class="string" id="6433790">&#39;\\&#39;</span>&nbsp;<span class="op" id="6433795">||</span>&nbsp;<span class="ident" id="6433798"><a href="/net/mail/message.go.html#6433712">c</a></span>&nbsp;<span class="op" id="6433800">==</span>&nbsp;<span class="string" id="6433803">&#39;&#34;&#39;</span>&nbsp;<span class="op" id="6433807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433811">return</span>&nbsp;<span class="ident" id="6433818">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6433825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433828">return</span>&nbsp;<span class="string" id="6433835">&#39;!&#39;</span>&nbsp;<span class="op" id="6433839">&lt;=</span>&nbsp;<span class="ident" id="6433842"><a href="/net/mail/message.go.html#6433712">c</a></span>&nbsp;<span class="op" id="6433844">&amp;&amp;</span>&nbsp;<span class="ident" id="6433847"><a href="/net/mail/message.go.html#6433712">c</a></span>&nbsp;<span class="op" id="6433849">&lt;=</span>&nbsp;<span class="string" id="6433852">&#39;~&#39;</span><br>
<span class="lineno"></span><span class="op" id="6433856">}</span><br>
<span class="lineno">545</span><br>
<span class="lineno"></span><span class="comment" id="6433859">//&nbsp;isVchar&nbsp;returns&nbsp;true&nbsp;if&nbsp;c&nbsp;is&nbsp;an&nbsp;RFC&nbsp;5322&nbsp;VCHAR&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="6433920">func</span>&nbsp;<span class="ident" id="6433925">isVchar</span><span class="op" id="6433932">(</span><span class="ident" id="6433933">c</span>&nbsp;<span class="builtintype" id="6433935">byte</span><span class="op" id="6433939">)</span>&nbsp;<span class="builtintype" id="6433941">bool</span>&nbsp;<span class="op" id="6433946">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6433949">//&nbsp;Visible&nbsp;(printing)&nbsp;characters.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6433984">return</span>&nbsp;<span class="string" id="6433991">&#39;!&#39;</span>&nbsp;<span class="op" id="6433995">&lt;=</span>&nbsp;<span class="ident" id="6433998"><a href="/net/mail/message.go.html#6433933">c</a></span>&nbsp;<span class="op" id="6434000">&amp;&amp;</span>&nbsp;<span class="ident" id="6434003"><a href="/net/mail/message.go.html#6433933">c</a></span>&nbsp;<span class="op" id="6434005">&lt;=</span>&nbsp;<span class="string" id="6434008">&#39;~&#39;</span><br>
<span class="lineno">550</span><span class="op" id="6434012">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6434015">//&nbsp;isWSP&nbsp;returns&nbsp;true&nbsp;if&nbsp;c&nbsp;is&nbsp;a&nbsp;WSP&nbsp;(white&nbsp;space).</span><br>
<span class="lineno"></span><span class="comment" id="6434066">//&nbsp;WSP&nbsp;is&nbsp;a&nbsp;space&nbsp;or&nbsp;horizontal&nbsp;tab&nbsp;(RFC5234&nbsp;Appendix&nbsp;B).</span><br>
<span class="lineno"></span><span class="keyword" id="6434124">func</span>&nbsp;<span class="ident" id="6434129">isWSP</span><span class="op" id="6434134">(</span><span class="ident" id="6434135">c</span>&nbsp;<span class="builtintype" id="6434137">byte</span><span class="op" id="6434141">)</span>&nbsp;<span class="builtintype" id="6434143">bool</span>&nbsp;<span class="op" id="6434148">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6434151">return</span>&nbsp;<span class="ident" id="6434158"><a href="/net/mail/message.go.html#6434135">c</a></span>&nbsp;<span class="op" id="6434160">==</span>&nbsp;<span class="string" id="6434163">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="6434167">||</span>&nbsp;<span class="ident" id="6434170"><a href="/net/mail/message.go.html#6434135">c</a></span>&nbsp;<span class="op" id="6434172">==</span>&nbsp;<span class="string" id="6434175">&#39;\t&#39;</span><br>
<span class="lineno"></span><span class="op" id="6434180">}</span>
</div>
</body>
</html>
