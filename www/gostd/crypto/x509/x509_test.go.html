<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6818589">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6818644">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6818698">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6818749">package</span>&nbsp;<span class="ident" id="6818757">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6818763">import</span>&nbsp;<span class="op" id="6818770">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6818773">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6818782">&#34;crypto/dsa&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6818796">&#34;crypto/ecdsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6818812">&#34;crypto/elliptic&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6818831">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6818846">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6818860">_</span>&nbsp;<span class="string" id="6818862">&#34;crypto/sha256&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6818879">_</span>&nbsp;<span class="string" id="6818881">&#34;crypto/sha512&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6818898">&#34;crypto/x509/pkix&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6818918">&#34;encoding/asn1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6818935">&#34;encoding/base64&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6818954">&#34;encoding/hex&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6818970">&#34;encoding/pem&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6818986">&#34;math/big&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6818998">&#34;net&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6819005">&#34;os/exec&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6819016">&#34;reflect&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6819027">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6819038">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6819049">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="6819056">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="6819059">func</span>&nbsp;<span class="ident" id="6819064">TestParsePKCS1PrivateKey</span><span class="op" id="6819088">(</span><span class="ident" id="6819089">t</span>&nbsp;<span class="op" id="6819091">*</span><span class="ident" id="6819092">testing</span><span class="op" id="6819099">.</span><span class="ident" id="6819100">T</span><span class="op" id="6819101">)</span>&nbsp;<span class="op" id="6819103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819106">block</span><span class="op" id="6819111">,</span>&nbsp;<span class="ident" id="6819113">_</span>&nbsp;<span class="op" id="6819115">:=</span>&nbsp;<span class="ident" id="6819118">pem</span><span class="op" id="6819121">.</span><span class="ident" id="6819122">Decode</span><span class="op" id="6819128">(</span><span class="op" id="6819129">[</span><span class="op" id="6819130">]</span><span class="builtintype" id="6819131">byte</span><span class="op" id="6819135">(</span><span class="ident" id="6819136">pemPrivateKey</span><span class="op" id="6819149">)</span><span class="op" id="6819150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819153">priv</span><span class="op" id="6819157">,</span>&nbsp;<span class="ident" id="6819159">err</span>&nbsp;<span class="op" id="6819163">:=</span>&nbsp;<span class="ident" id="6819166">ParsePKCS1PrivateKey</span><span class="op" id="6819186">(</span><span class="ident" id="6819187">block</span><span class="op" id="6819192">.</span><span class="ident" id="6819193">Bytes</span><span class="op" id="6819198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6819201">if</span>&nbsp;<span class="ident" id="6819204">err</span>&nbsp;<span class="op" id="6819208">!=</span>&nbsp;<span class="ident" id="6819211">nil</span>&nbsp;<span class="op" id="6819215">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819219">t</span><span class="op" id="6819220">.</span><span class="ident" id="6819221">Errorf</span><span class="op" id="6819227">(</span><span class="string" id="6819228">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6819261">,</span>&nbsp;<span class="ident" id="6819263">err</span><span class="op" id="6819266">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6819270">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819278">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6819281">if</span>&nbsp;<span class="ident" id="6819284">priv</span><span class="op" id="6819288">.</span><span class="ident" id="6819289">PublicKey</span><span class="op" id="6819298">.</span><span class="ident" id="6819299">N</span><span class="op" id="6819300">.</span><span class="ident" id="6819301">Cmp</span><span class="op" id="6819304">(</span><span class="ident" id="6819305">rsaPrivateKey</span><span class="op" id="6819318">.</span><span class="ident" id="6819319">PublicKey</span><span class="op" id="6819328">.</span><span class="ident" id="6819329">N</span><span class="op" id="6819330">)</span>&nbsp;<span class="op" id="6819332">!=</span>&nbsp;<span class="num" id="6819335">0</span>&nbsp;<span class="op" id="6819337">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819342">priv</span><span class="op" id="6819346">.</span><span class="ident" id="6819347">PublicKey</span><span class="op" id="6819356">.</span><span class="ident" id="6819357">E</span>&nbsp;<span class="op" id="6819359">!=</span>&nbsp;<span class="ident" id="6819362">rsaPrivateKey</span><span class="op" id="6819375">.</span><span class="ident" id="6819376">PublicKey</span><span class="op" id="6819385">.</span><span class="ident" id="6819386">E</span>&nbsp;<span class="op" id="6819388">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819393">priv</span><span class="op" id="6819397">.</span><span class="ident" id="6819398">D</span><span class="op" id="6819399">.</span><span class="ident" id="6819400">Cmp</span><span class="op" id="6819403">(</span><span class="ident" id="6819404">rsaPrivateKey</span><span class="op" id="6819417">.</span><span class="ident" id="6819418">D</span><span class="op" id="6819419">)</span>&nbsp;<span class="op" id="6819421">!=</span>&nbsp;<span class="num" id="6819424">0</span>&nbsp;<span class="op" id="6819426">||</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819431">priv</span><span class="op" id="6819435">.</span><span class="ident" id="6819436">Primes</span><span class="op" id="6819442">[</span><span class="num" id="6819443">0</span><span class="op" id="6819444">]</span><span class="op" id="6819445">.</span><span class="ident" id="6819446">Cmp</span><span class="op" id="6819449">(</span><span class="ident" id="6819450">rsaPrivateKey</span><span class="op" id="6819463">.</span><span class="ident" id="6819464">Primes</span><span class="op" id="6819470">[</span><span class="num" id="6819471">0</span><span class="op" id="6819472">]</span><span class="op" id="6819473">)</span>&nbsp;<span class="op" id="6819475">!=</span>&nbsp;<span class="num" id="6819478">0</span>&nbsp;<span class="op" id="6819480">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819485">priv</span><span class="op" id="6819489">.</span><span class="ident" id="6819490">Primes</span><span class="op" id="6819496">[</span><span class="num" id="6819497">1</span><span class="op" id="6819498">]</span><span class="op" id="6819499">.</span><span class="ident" id="6819500">Cmp</span><span class="op" id="6819503">(</span><span class="ident" id="6819504">rsaPrivateKey</span><span class="op" id="6819517">.</span><span class="ident" id="6819518">Primes</span><span class="op" id="6819524">[</span><span class="num" id="6819525">1</span><span class="op" id="6819526">]</span><span class="op" id="6819527">)</span>&nbsp;<span class="op" id="6819529">!=</span>&nbsp;<span class="num" id="6819532">0</span>&nbsp;<span class="op" id="6819534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819538">t</span><span class="op" id="6819539">.</span><span class="ident" id="6819540">Errorf</span><span class="op" id="6819546">(</span><span class="string" id="6819547">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="6819565">,</span>&nbsp;<span class="ident" id="6819567">priv</span><span class="op" id="6819571">,</span>&nbsp;<span class="ident" id="6819573">rsaPrivateKey</span><span class="op" id="6819586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819589">}</span><br>
<span class="lineno"></span><span class="op" id="6819591">}</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="keyword" id="6819594">func</span>&nbsp;<span class="ident" id="6819599">TestParsePKIXPublicKey</span><span class="op" id="6819621">(</span><span class="ident" id="6819622">t</span>&nbsp;<span class="op" id="6819624">*</span><span class="ident" id="6819625">testing</span><span class="op" id="6819632">.</span><span class="ident" id="6819633">T</span><span class="op" id="6819634">)</span>&nbsp;<span class="op" id="6819636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819639">block</span><span class="op" id="6819644">,</span>&nbsp;<span class="ident" id="6819646">_</span>&nbsp;<span class="op" id="6819648">:=</span>&nbsp;<span class="ident" id="6819651">pem</span><span class="op" id="6819654">.</span><span class="ident" id="6819655">Decode</span><span class="op" id="6819661">(</span><span class="op" id="6819662">[</span><span class="op" id="6819663">]</span><span class="builtintype" id="6819664">byte</span><span class="op" id="6819668">(</span><span class="ident" id="6819669">pemPublicKey</span><span class="op" id="6819681">)</span><span class="op" id="6819682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819685">pub</span><span class="op" id="6819688">,</span>&nbsp;<span class="ident" id="6819690">err</span>&nbsp;<span class="op" id="6819694">:=</span>&nbsp;<span class="ident" id="6819697">ParsePKIXPublicKey</span><span class="op" id="6819715">(</span><span class="ident" id="6819716">block</span><span class="op" id="6819721">.</span><span class="ident" id="6819722">Bytes</span><span class="op" id="6819727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6819730">if</span>&nbsp;<span class="ident" id="6819733">err</span>&nbsp;<span class="op" id="6819737">!=</span>&nbsp;<span class="ident" id="6819740">nil</span>&nbsp;<span class="op" id="6819744">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819748">t</span><span class="op" id="6819749">.</span><span class="ident" id="6819750">Errorf</span><span class="op" id="6819756">(</span><span class="string" id="6819757">&#34;Failed&nbsp;to&nbsp;parse&nbsp;RSA&nbsp;public&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6819793">,</span>&nbsp;<span class="ident" id="6819795">err</span><span class="op" id="6819798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6819802">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819813">rsaPub</span><span class="op" id="6819819">,</span>&nbsp;<span class="ident" id="6819821">ok</span>&nbsp;<span class="op" id="6819824">:=</span>&nbsp;<span class="ident" id="6819827">pub</span><span class="op" id="6819830">.</span><span class="op" id="6819831">(</span><span class="op" id="6819832">*</span><span class="ident" id="6819833">rsa</span><span class="op" id="6819836">.</span><span class="ident" id="6819837">PublicKey</span><span class="op" id="6819846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6819849">if</span>&nbsp;<span class="op" id="6819852">!</span><span class="ident" id="6819853">ok</span>&nbsp;<span class="op" id="6819856">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819860">t</span><span class="op" id="6819861">.</span><span class="ident" id="6819862">Errorf</span><span class="op" id="6819868">(</span><span class="string" id="6819869">&#34;Value&nbsp;returned&nbsp;from&nbsp;ParsePKIXPublicKey&nbsp;was&nbsp;not&nbsp;an&nbsp;RSA&nbsp;public&nbsp;key&#34;</span><span class="op" id="6819935">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6819939">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6819947">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6819951">pubBytes2</span><span class="op" id="6819960">,</span>&nbsp;<span class="ident" id="6819962">err</span>&nbsp;<span class="op" id="6819966">:=</span>&nbsp;<span class="ident" id="6819969">MarshalPKIXPublicKey</span><span class="op" id="6819989">(</span><span class="ident" id="6819990">rsaPub</span><span class="op" id="6819996">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6819999">if</span>&nbsp;<span class="ident" id="6820002">err</span>&nbsp;<span class="op" id="6820006">!=</span>&nbsp;<span class="ident" id="6820009">nil</span>&nbsp;<span class="op" id="6820013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6820017">t</span><span class="op" id="6820018">.</span><span class="ident" id="6820019">Errorf</span><span class="op" id="6820025">(</span><span class="string" id="6820026">&#34;Failed&nbsp;to&nbsp;marshal&nbsp;RSA&nbsp;public&nbsp;key&nbsp;for&nbsp;the&nbsp;second&nbsp;time:&nbsp;%s&#34;</span><span class="op" id="6820084">,</span>&nbsp;<span class="ident" id="6820086">err</span><span class="op" id="6820089">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6820093">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6820101">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6820104">if</span>&nbsp;<span class="op" id="6820107">!</span><span class="ident" id="6820108">bytes</span><span class="op" id="6820113">.</span><span class="ident" id="6820114">Equal</span><span class="op" id="6820119">(</span><span class="ident" id="6820120">pubBytes2</span><span class="op" id="6820129">,</span>&nbsp;<span class="ident" id="6820131">block</span><span class="op" id="6820136">.</span><span class="ident" id="6820137">Bytes</span><span class="op" id="6820142">)</span>&nbsp;<span class="op" id="6820144">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6820148">t</span><span class="op" id="6820149">.</span><span class="ident" id="6820150">Errorf</span><span class="op" id="6820156">(</span><span class="string" id="6820157">&#34;Reserialization&nbsp;of&nbsp;public&nbsp;key&nbsp;didn&#39;t&nbsp;match.&nbsp;got&nbsp;%x,&nbsp;want&nbsp;%x&#34;</span><span class="op" id="6820218">,</span>&nbsp;<span class="ident" id="6820220">pubBytes2</span><span class="op" id="6820229">,</span>&nbsp;<span class="ident" id="6820231">block</span><span class="op" id="6820236">.</span><span class="ident" id="6820237">Bytes</span><span class="op" id="6820242">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6820245">}</span><br>
<span class="lineno"></span><span class="op" id="6820247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6820250">var</span>&nbsp;<span class="ident" id="6820254">pemPublicKey</span>&nbsp;<span class="op" id="6820267">=</span>&nbsp;<span class="string" id="6820269">`-----BEGIN&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno">70</span>MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA3VoPN9PKUjKFLMwOge6+<br>
<span class="lineno"></span>wnDi8sbETGIx2FKXGgqtAKpzmem53kRGEQg8WeqRmp12wgp74TGpkEXsGae7RS1k<br>
<span class="lineno"></span>enJCnma4fii+noGH7R0qKgHvPrI2Bwa9hzsH8tHxpyM3qrXslOmD45EH9SxIDUBJ<br>
<span class="lineno"></span>FehNdaPbLP1gFyahKMsdfxFJLUvbUycuZSJ2ZnIgeVxwm4qbSvZInL9Iu4FzuPtg<br>
<span class="lineno"></span>fINKcbbovy1qq4KvPIrXzhbY3PWDc6btxCf3SE0JdE1MCPThntB62/bLMSQ7xdDR<br>
<span class="lineno">75</span>FF53oIpvxe/SCOymfWq/LW849Ytv3Xwod0+wzAP8STXG4HSELS4UedPYeHJJJYcZ<br>
<span class="lineno"></span>+QIDAQAB<br>
<span class="lineno"></span>-----END&nbsp;PUBLIC&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="6820724">var</span>&nbsp;<span class="ident" id="6820728">pemPrivateKey</span>&nbsp;<span class="op" id="6820742">=</span>&nbsp;<span class="string" id="6820744">`-----BEGIN&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>MIIBOgIBAAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0<br>
<span class="lineno"></span>fd7Ai2KW5ToIwzFofvJcS/STa6HA5gQenRUCAwEAAQJBAIq9amn00aS0h/CrjXqu<br>
<span class="lineno"></span>/ThglAXJmZhOMPVn4eiu7/ROixi9sex436MaVeMqSNf7Ex9a8fRNfWss7Sqd9eWu<br>
<span class="lineno"></span>RTUCIQDasvGASLqmjeffBNLTXV2A5g4t+kLVCpsEIZAycV5GswIhANEPLmax0ME/<br>
<span class="lineno">85</span>EO+ZJ79TJKN5yiGBRsv5yvx5UiHxajEXAiAhAol5N4EUyq6I9w1rYdhPMGpLfk7A<br>
<span class="lineno"></span>IU2snfRJ6Nq2CQIgFrPsWRCkV+gOYcajD17rEqmuLrdIRexpg8N1DOSXoJ8CIGlS<br>
<span class="lineno"></span>tAboUGBxTDq3ZroNism3DaMIbKPyYrAqhKov1h5V<br>
<span class="lineno"></span>-----END&nbsp;RSA&nbsp;PRIVATE&nbsp;KEY-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="6821241">func</span>&nbsp;<span class="ident" id="6821246">bigFromString</span><span class="op" id="6821259">(</span><span class="ident" id="6821260">s</span>&nbsp;<span class="builtintype" id="6821262">string</span><span class="op" id="6821268">)</span>&nbsp;<span class="op" id="6821270">*</span><span class="ident" id="6821271">big</span><span class="op" id="6821274">.</span><span class="ident" id="6821275">Int</span>&nbsp;<span class="op" id="6821279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821282">ret</span>&nbsp;<span class="op" id="6821286">:=</span>&nbsp;<span class="builtinfunc" id="6821289">new</span><span class="op" id="6821292">(</span><span class="ident" id="6821293">big</span><span class="op" id="6821296">.</span><span class="ident" id="6821297">Int</span><span class="op" id="6821300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821303">ret</span><span class="op" id="6821306">.</span><span class="ident" id="6821307">SetString</span><span class="op" id="6821316">(</span><span class="ident" id="6821317">s</span><span class="op" id="6821318">,</span>&nbsp;<span class="num" id="6821320">10</span><span class="op" id="6821322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6821325">return</span>&nbsp;<span class="ident" id="6821332">ret</span><br>
<span class="lineno">95</span><span class="op" id="6821336">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6821339">func</span>&nbsp;<span class="ident" id="6821344">fromBase10</span><span class="op" id="6821354">(</span><span class="ident" id="6821355">base10</span>&nbsp;<span class="builtintype" id="6821362">string</span><span class="op" id="6821368">)</span>&nbsp;<span class="op" id="6821370">*</span><span class="ident" id="6821371">big</span><span class="op" id="6821374">.</span><span class="ident" id="6821375">Int</span>&nbsp;<span class="op" id="6821379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821382">i</span>&nbsp;<span class="op" id="6821384">:=</span>&nbsp;<span class="builtinfunc" id="6821387">new</span><span class="op" id="6821390">(</span><span class="ident" id="6821391">big</span><span class="op" id="6821394">.</span><span class="ident" id="6821395">Int</span><span class="op" id="6821398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821401">i</span><span class="op" id="6821402">.</span><span class="ident" id="6821403">SetString</span><span class="op" id="6821412">(</span><span class="ident" id="6821413">base10</span><span class="op" id="6821419">,</span>&nbsp;<span class="num" id="6821421">10</span><span class="op" id="6821423">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6821426">return</span>&nbsp;<span class="ident" id="6821433">i</span><br>
<span class="lineno"></span><span class="op" id="6821435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6821438">func</span>&nbsp;<span class="ident" id="6821443">bigFromHexString</span><span class="op" id="6821459">(</span><span class="ident" id="6821460">s</span>&nbsp;<span class="builtintype" id="6821462">string</span><span class="op" id="6821468">)</span>&nbsp;<span class="op" id="6821470">*</span><span class="ident" id="6821471">big</span><span class="op" id="6821474">.</span><span class="ident" id="6821475">Int</span>&nbsp;<span class="op" id="6821479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821482">ret</span>&nbsp;<span class="op" id="6821486">:=</span>&nbsp;<span class="builtinfunc" id="6821489">new</span><span class="op" id="6821492">(</span><span class="ident" id="6821493">big</span><span class="op" id="6821496">.</span><span class="ident" id="6821497">Int</span><span class="op" id="6821500">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821503">ret</span><span class="op" id="6821506">.</span><span class="ident" id="6821507">SetString</span><span class="op" id="6821516">(</span><span class="ident" id="6821517">s</span><span class="op" id="6821518">,</span>&nbsp;<span class="num" id="6821520">16</span><span class="op" id="6821522">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6821525">return</span>&nbsp;<span class="ident" id="6821532">ret</span><br>
<span class="lineno"></span><span class="op" id="6821536">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6821539">var</span>&nbsp;<span class="ident" id="6821543">rsaPrivateKey</span>&nbsp;<span class="op" id="6821557">=</span>&nbsp;<span class="op" id="6821559">&amp;</span><span class="ident" id="6821560">rsa</span><span class="op" id="6821563">.</span><span class="ident" id="6821564">PrivateKey</span><span class="op" id="6821574">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821577">PublicKey</span><span class="op" id="6821586">:</span>&nbsp;<span class="ident" id="6821588">rsa</span><span class="op" id="6821591">.</span><span class="ident" id="6821592">PublicKey</span><span class="op" id="6821601">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821605">N</span><span class="op" id="6821606">:</span>&nbsp;<span class="ident" id="6821608">bigFromString</span><span class="op" id="6821621">(</span><span class="string" id="6821622">&#34;9353930466774385905609975137998169297361893554149986716853295022578535724979677252958524466350471210367835187480748268864277464700638583474144061408845077&#34;</span><span class="op" id="6821778">)</span><span class="op" id="6821779">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821783">E</span><span class="op" id="6821784">:</span>&nbsp;<span class="num" id="6821786">65537</span><span class="op" id="6821791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6821794">}</span><span class="op" id="6821795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821798">D</span><span class="op" id="6821799">:</span>&nbsp;<span class="ident" id="6821801">bigFromString</span><span class="op" id="6821814">(</span><span class="string" id="6821815">&#34;7266398431328116344057699379749222532279343923819063639497049039389899328538543087657733766554155839834519529439851673014800261285757759040931985506583861&#34;</span><span class="op" id="6821971">)</span><span class="op" id="6821972">,</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821975">Primes</span><span class="op" id="6821981">:</span>&nbsp;<span class="op" id="6821983">[</span><span class="op" id="6821984">]</span><span class="op" id="6821985">*</span><span class="ident" id="6821986">big</span><span class="op" id="6821989">.</span><span class="ident" id="6821990">Int</span><span class="op" id="6821993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6821997">bigFromString</span><span class="op" id="6822010">(</span><span class="string" id="6822011">&#34;98920366548084643601728869055592650835572950932266967461790948584315647051443&#34;</span><span class="op" id="6822090">)</span><span class="op" id="6822091">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6822095">bigFromString</span><span class="op" id="6822108">(</span><span class="string" id="6822109">&#34;94560208308847015747498523884063394671606671904944666360068158221458669711639&#34;</span><span class="op" id="6822188">)</span><span class="op" id="6822189">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6822192">}</span><span class="op" id="6822193">,</span><br>
<span class="lineno"></span><span class="op" id="6822195">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span><span class="keyword" id="6822198">func</span>&nbsp;<span class="ident" id="6822203">TestMarshalRSAPrivateKey</span><span class="op" id="6822227">(</span><span class="ident" id="6822228">t</span>&nbsp;<span class="op" id="6822230">*</span><span class="ident" id="6822231">testing</span><span class="op" id="6822238">.</span><span class="ident" id="6822239">T</span><span class="op" id="6822240">)</span>&nbsp;<span class="op" id="6822242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6822245">priv</span>&nbsp;<span class="op" id="6822250">:=</span>&nbsp;<span class="op" id="6822253">&amp;</span><span class="ident" id="6822254">rsa</span><span class="op" id="6822257">.</span><span class="ident" id="6822258">PrivateKey</span><span class="op" id="6822268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6822272">PublicKey</span><span class="op" id="6822281">:</span>&nbsp;<span class="ident" id="6822283">rsa</span><span class="op" id="6822286">.</span><span class="ident" id="6822287">PublicKey</span><span class="op" id="6822296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6822301">N</span><span class="op" id="6822302">:</span>&nbsp;<span class="ident" id="6822304">fromBase10</span><span class="op" id="6822314">(</span><span class="string" id="6822315">&#34;16346378922382193400538269749936049106320265317511766357599732575277382844051791096569333808598921852351577762718529818072849191122419410612033592401403764925096136759934497687765453905884149505175426053037420486697072448609022753683683718057795566811401938833367954642951433473337066311978821180526439641496973296037000052546108507805269279414789035461158073156772151892452251106173507240488993608650881929629163465099476849643165682709047462010581308719577053905787496296934240246311806555924593059995202856826239801816771116902778517096212527979497399966526283516447337775509777558018145573127308919204297111496233&#34;</span><span class="op" id="6822934">)</span><span class="op" id="6822935">,</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6822940">E</span><span class="op" id="6822941">:</span>&nbsp;<span class="num" id="6822943">3</span><span class="op" id="6822944">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6822948">}</span><span class="op" id="6822949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6822953">D</span><span class="op" id="6822954">:</span>&nbsp;<span class="ident" id="6822956">fromBase10</span><span class="op" id="6822966">(</span><span class="string" id="6822967">&#34;10897585948254795600358846499957366070880176878341177571733155050184921896034527397712889205732614568234385175145686545381899460748279607074689061600935843283397424506622998458510302603922766336783617368686090042765718290914099334449154829375179958369993407724946186243249568928237086215759259909861748642124071874879861299389874230489928271621259294894142840428407196932444474088857746123104978617098858619445675532587787023228852383149557470077802718705420275739737958953794088728369933811184572620857678792001136676902250566845618813972833750098806496641114644760255910789397593428910198080271317419213080834885003&#34;</span><span class="op" id="6823586">)</span><span class="op" id="6823587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6823591">Primes</span><span class="op" id="6823597">:</span>&nbsp;<span class="op" id="6823599">[</span><span class="op" id="6823600">]</span><span class="op" id="6823601">*</span><span class="ident" id="6823602">big</span><span class="op" id="6823605">.</span><span class="ident" id="6823606">Int</span><span class="op" id="6823609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6823614">fromBase10</span><span class="op" id="6823624">(</span><span class="string" id="6823625">&#34;1025363189502892836833747188838978207017355117492483312747347695538428729137306368764177201532277413433182799108299960196606011786562992097313508180436744488171474690412562218914213688661311117337381958560443&#34;</span><span class="op" id="6823835">)</span><span class="op" id="6823836">,</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6823841">fromBase10</span><span class="op" id="6823851">(</span><span class="string" id="6823852">&#34;3467903426626310123395340254094941045497208049900750380025518552334536945536837294961497712862519984786362199788654739924501424784631315081391467293694361474867825728031147665777546570788493758372218019373&#34;</span><span class="op" id="6824059">)</span><span class="op" id="6824060">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6824065">fromBase10</span><span class="op" id="6824075">(</span><span class="string" id="6824076">&#34;4597024781409332673052708605078359346966325141767460991205742124888960305710298765592730135879076084498363772408626791576005136245060321874472727132746643162385746062759369754202494417496879741537284589047&#34;</span><span class="op" id="6824283">)</span><span class="op" id="6824284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6824288">}</span><span class="op" id="6824289">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6824292">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6824296">derBytes</span>&nbsp;<span class="op" id="6824305">:=</span>&nbsp;<span class="ident" id="6824308">MarshalPKCS1PrivateKey</span><span class="op" id="6824330">(</span><span class="ident" id="6824331">priv</span><span class="op" id="6824335">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6824339">priv2</span><span class="op" id="6824344">,</span>&nbsp;<span class="ident" id="6824346">err</span>&nbsp;<span class="op" id="6824350">:=</span>&nbsp;<span class="ident" id="6824353">ParsePKCS1PrivateKey</span><span class="op" id="6824373">(</span><span class="ident" id="6824374">derBytes</span><span class="op" id="6824382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6824385">if</span>&nbsp;<span class="ident" id="6824388">err</span>&nbsp;<span class="op" id="6824392">!=</span>&nbsp;<span class="ident" id="6824395">nil</span>&nbsp;<span class="op" id="6824399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6824403">t</span><span class="op" id="6824404">.</span><span class="ident" id="6824405">Errorf</span><span class="op" id="6824411">(</span><span class="string" id="6824412">&#34;error&nbsp;parsing&nbsp;serialized&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6824446">,</span>&nbsp;<span class="ident" id="6824448">err</span><span class="op" id="6824451">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6824455">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6824463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6824466">if</span>&nbsp;<span class="ident" id="6824469">priv</span><span class="op" id="6824473">.</span><span class="ident" id="6824474">PublicKey</span><span class="op" id="6824483">.</span><span class="ident" id="6824484">N</span><span class="op" id="6824485">.</span><span class="ident" id="6824486">Cmp</span><span class="op" id="6824489">(</span><span class="ident" id="6824490">priv2</span><span class="op" id="6824495">.</span><span class="ident" id="6824496">PublicKey</span><span class="op" id="6824505">.</span><span class="ident" id="6824506">N</span><span class="op" id="6824507">)</span>&nbsp;<span class="op" id="6824509">!=</span>&nbsp;<span class="num" id="6824512">0</span>&nbsp;<span class="op" id="6824514">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6824519">priv</span><span class="op" id="6824523">.</span><span class="ident" id="6824524">PublicKey</span><span class="op" id="6824533">.</span><span class="ident" id="6824534">E</span>&nbsp;<span class="op" id="6824536">!=</span>&nbsp;<span class="ident" id="6824539">priv2</span><span class="op" id="6824544">.</span><span class="ident" id="6824545">PublicKey</span><span class="op" id="6824554">.</span><span class="ident" id="6824555">E</span>&nbsp;<span class="op" id="6824557">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6824562">priv</span><span class="op" id="6824566">.</span><span class="ident" id="6824567">D</span><span class="op" id="6824568">.</span><span class="ident" id="6824569">Cmp</span><span class="op" id="6824572">(</span><span class="ident" id="6824573">priv2</span><span class="op" id="6824578">.</span><span class="ident" id="6824579">D</span><span class="op" id="6824580">)</span>&nbsp;<span class="op" id="6824582">!=</span>&nbsp;<span class="num" id="6824585">0</span>&nbsp;<span class="op" id="6824587">||</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6824592">len</span><span class="op" id="6824595">(</span><span class="ident" id="6824596">priv2</span><span class="op" id="6824601">.</span><span class="ident" id="6824602">Primes</span><span class="op" id="6824608">)</span>&nbsp;<span class="op" id="6824610">!=</span>&nbsp;<span class="num" id="6824613">3</span>&nbsp;<span class="op" id="6824615">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6824620">priv</span><span class="op" id="6824624">.</span><span class="ident" id="6824625">Primes</span><span class="op" id="6824631">[</span><span class="num" id="6824632">0</span><span class="op" id="6824633">]</span><span class="op" id="6824634">.</span><span class="ident" id="6824635">Cmp</span><span class="op" id="6824638">(</span><span class="ident" id="6824639">priv2</span><span class="op" id="6824644">.</span><span class="ident" id="6824645">Primes</span><span class="op" id="6824651">[</span><span class="num" id="6824652">0</span><span class="op" id="6824653">]</span><span class="op" id="6824654">)</span>&nbsp;<span class="op" id="6824656">!=</span>&nbsp;<span class="num" id="6824659">0</span>&nbsp;<span class="op" id="6824661">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6824666">priv</span><span class="op" id="6824670">.</span><span class="ident" id="6824671">Primes</span><span class="op" id="6824677">[</span><span class="num" id="6824678">1</span><span class="op" id="6824679">]</span><span class="op" id="6824680">.</span><span class="ident" id="6824681">Cmp</span><span class="op" id="6824684">(</span><span class="ident" id="6824685">priv2</span><span class="op" id="6824690">.</span><span class="ident" id="6824691">Primes</span><span class="op" id="6824697">[</span><span class="num" id="6824698">1</span><span class="op" id="6824699">]</span><span class="op" id="6824700">)</span>&nbsp;<span class="op" id="6824702">!=</span>&nbsp;<span class="num" id="6824705">0</span>&nbsp;<span class="op" id="6824707">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6824712">priv</span><span class="op" id="6824716">.</span><span class="ident" id="6824717">Primes</span><span class="op" id="6824723">[</span><span class="num" id="6824724">2</span><span class="op" id="6824725">]</span><span class="op" id="6824726">.</span><span class="ident" id="6824727">Cmp</span><span class="op" id="6824730">(</span><span class="ident" id="6824731">priv2</span><span class="op" id="6824736">.</span><span class="ident" id="6824737">Primes</span><span class="op" id="6824743">[</span><span class="num" id="6824744">2</span><span class="op" id="6824745">]</span><span class="op" id="6824746">)</span>&nbsp;<span class="op" id="6824748">!=</span>&nbsp;<span class="num" id="6824751">0</span>&nbsp;<span class="op" id="6824753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6824757">t</span><span class="op" id="6824758">.</span><span class="ident" id="6824759">Errorf</span><span class="op" id="6824765">(</span><span class="string" id="6824766">&#34;got:%+v&nbsp;want:%+v&#34;</span><span class="op" id="6824784">,</span>&nbsp;<span class="ident" id="6824786">priv</span><span class="op" id="6824790">,</span>&nbsp;<span class="ident" id="6824792">priv2</span><span class="op" id="6824797">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6824800">}</span><br>
<span class="lineno"></span><span class="op" id="6824802">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6824805">type</span>&nbsp;<span class="ident" id="6824810">matchHostnamesTest</span>&nbsp;<span class="keyword" id="6824829">struct</span>&nbsp;<span class="op" id="6824836">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6824839">pattern</span><span class="op" id="6824846">,</span>&nbsp;<span class="ident" id="6824848">host</span>&nbsp;<span class="builtintype" id="6824853">string</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6824861">ok</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6824875">bool</span><br>
<span class="lineno"></span><span class="op" id="6824880">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6824883">var</span>&nbsp;<span class="ident" id="6824887">matchHostnamesTests</span>&nbsp;<span class="op" id="6824907">=</span>&nbsp;<span class="op" id="6824909">[</span><span class="op" id="6824910">]</span><span class="ident" id="6824911">matchHostnamesTest</span><span class="op" id="6824929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6824932">{</span><span class="string" id="6824933">&#34;a.b.c&#34;</span><span class="op" id="6824940">,</span>&nbsp;<span class="string" id="6824942">&#34;a.b.c&#34;</span><span class="op" id="6824949">,</span>&nbsp;<span class="builtintype" id="6824951">true</span><span class="op" id="6824955">}</span><span class="op" id="6824956">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6824959">{</span><span class="string" id="6824960">&#34;a.b.c&#34;</span><span class="op" id="6824967">,</span>&nbsp;<span class="string" id="6824969">&#34;b.b.c&#34;</span><span class="op" id="6824976">,</span>&nbsp;<span class="builtintype" id="6824978">false</span><span class="op" id="6824983">}</span><span class="op" id="6824984">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6824987">{</span><span class="string" id="6824988">&#34;&#34;</span><span class="op" id="6824990">,</span>&nbsp;<span class="string" id="6824992">&#34;b.b.c&#34;</span><span class="op" id="6824999">,</span>&nbsp;<span class="builtintype" id="6825001">false</span><span class="op" id="6825006">}</span><span class="op" id="6825007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6825010">{</span><span class="string" id="6825011">&#34;a.b.c&#34;</span><span class="op" id="6825018">,</span>&nbsp;<span class="string" id="6825020">&#34;&#34;</span><span class="op" id="6825022">,</span>&nbsp;<span class="builtintype" id="6825024">false</span><span class="op" id="6825029">}</span><span class="op" id="6825030">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6825033">{</span><span class="string" id="6825034">&#34;example.com&#34;</span><span class="op" id="6825047">,</span>&nbsp;<span class="string" id="6825049">&#34;example.com&#34;</span><span class="op" id="6825062">,</span>&nbsp;<span class="builtintype" id="6825064">true</span><span class="op" id="6825068">}</span><span class="op" id="6825069">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6825072">{</span><span class="string" id="6825073">&#34;example.com&#34;</span><span class="op" id="6825086">,</span>&nbsp;<span class="string" id="6825088">&#34;www.example.com&#34;</span><span class="op" id="6825105">,</span>&nbsp;<span class="builtintype" id="6825107">false</span><span class="op" id="6825112">}</span><span class="op" id="6825113">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6825116">{</span><span class="string" id="6825117">&#34;*.example.com&#34;</span><span class="op" id="6825132">,</span>&nbsp;<span class="string" id="6825134">&#34;www.example.com&#34;</span><span class="op" id="6825151">,</span>&nbsp;<span class="builtintype" id="6825153">true</span><span class="op" id="6825157">}</span><span class="op" id="6825158">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6825161">{</span><span class="string" id="6825162">&#34;*.example.com&#34;</span><span class="op" id="6825177">,</span>&nbsp;<span class="string" id="6825179">&#34;xyz.www.example.com&#34;</span><span class="op" id="6825200">,</span>&nbsp;<span class="builtintype" id="6825202">false</span><span class="op" id="6825207">}</span><span class="op" id="6825208">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6825211">{</span><span class="string" id="6825212">&#34;*.*.example.com&#34;</span><span class="op" id="6825229">,</span>&nbsp;<span class="string" id="6825231">&#34;xyz.www.example.com&#34;</span><span class="op" id="6825252">,</span>&nbsp;<span class="builtintype" id="6825254">true</span><span class="op" id="6825258">}</span><span class="op" id="6825259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6825262">{</span><span class="string" id="6825263">&#34;*.www.*.com&#34;</span><span class="op" id="6825276">,</span>&nbsp;<span class="string" id="6825278">&#34;xyz.www.example.com&#34;</span><span class="op" id="6825299">,</span>&nbsp;<span class="builtintype" id="6825301">true</span><span class="op" id="6825305">}</span><span class="op" id="6825306">,</span><br>
<span class="lineno"></span><span class="op" id="6825308">}</span><br>
<span class="lineno">170</span><br>
<span class="lineno"></span><span class="keyword" id="6825311">func</span>&nbsp;<span class="ident" id="6825316">TestMatchHostnames</span><span class="op" id="6825334">(</span><span class="ident" id="6825335">t</span>&nbsp;<span class="op" id="6825337">*</span><span class="ident" id="6825338">testing</span><span class="op" id="6825345">.</span><span class="ident" id="6825346">T</span><span class="op" id="6825347">)</span>&nbsp;<span class="op" id="6825349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6825352">for</span>&nbsp;<span class="ident" id="6825356">i</span><span class="op" id="6825357">,</span>&nbsp;<span class="ident" id="6825359">test</span>&nbsp;<span class="op" id="6825364">:=</span>&nbsp;<span class="keyword" id="6825367">range</span>&nbsp;<span class="ident" id="6825373">matchHostnamesTests</span>&nbsp;<span class="op" id="6825393">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6825397">r</span>&nbsp;<span class="op" id="6825399">:=</span>&nbsp;<span class="ident" id="6825402">matchHostnames</span><span class="op" id="6825416">(</span><span class="ident" id="6825417">test</span><span class="op" id="6825421">.</span><span class="ident" id="6825422">pattern</span><span class="op" id="6825429">,</span>&nbsp;<span class="ident" id="6825431">test</span><span class="op" id="6825435">.</span><span class="ident" id="6825436">host</span><span class="op" id="6825440">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6825444">if</span>&nbsp;<span class="ident" id="6825447">r</span>&nbsp;<span class="op" id="6825449">!=</span>&nbsp;<span class="ident" id="6825452">test</span><span class="op" id="6825456">.</span><span class="ident" id="6825457">ok</span>&nbsp;<span class="op" id="6825460">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6825465">t</span><span class="op" id="6825466">.</span><span class="ident" id="6825467">Errorf</span><span class="op" id="6825473">(</span><span class="string" id="6825474">&#34;#%d&nbsp;mismatch&nbsp;got:&nbsp;%t&nbsp;want:&nbsp;%t&#34;</span><span class="op" id="6825505">,</span>&nbsp;<span class="ident" id="6825507">i</span><span class="op" id="6825508">,</span>&nbsp;<span class="ident" id="6825510">r</span><span class="op" id="6825511">,</span>&nbsp;<span class="ident" id="6825513">test</span><span class="op" id="6825517">.</span><span class="ident" id="6825518">ok</span><span class="op" id="6825520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6825524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6825527">}</span><br>
<span class="lineno"></span><span class="op" id="6825529">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span><span class="keyword" id="6825532">func</span>&nbsp;<span class="ident" id="6825537">TestMatchIP</span><span class="op" id="6825548">(</span><span class="ident" id="6825549">t</span>&nbsp;<span class="op" id="6825551">*</span><span class="ident" id="6825552">testing</span><span class="op" id="6825559">.</span><span class="ident" id="6825560">T</span><span class="op" id="6825561">)</span>&nbsp;<span class="op" id="6825563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6825566">//&nbsp;Check&nbsp;that&nbsp;pattern&nbsp;matching&nbsp;is&nbsp;working.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6825610">c</span>&nbsp;<span class="op" id="6825612">:=</span>&nbsp;<span class="op" id="6825615">&amp;</span><span class="ident" id="6825616">Certificate</span><span class="op" id="6825627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6825631">DNSNames</span><span class="op" id="6825639">:</span>&nbsp;<span class="op" id="6825641">[</span><span class="op" id="6825642">]</span><span class="builtintype" id="6825643">string</span><span class="op" id="6825649">{</span><span class="string" id="6825650">&#34;*.foo.bar.baz&#34;</span><span class="op" id="6825665">}</span><span class="op" id="6825666">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6825670">Subject</span><span class="op" id="6825677">:</span>&nbsp;<span class="ident" id="6825679">pkix</span><span class="op" id="6825683">.</span><span class="ident" id="6825684">Name</span><span class="op" id="6825688">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6825693">CommonName</span><span class="op" id="6825703">:</span>&nbsp;<span class="string" id="6825705">&#34;*.foo.bar.baz&#34;</span><span class="op" id="6825720">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6825724">}</span><span class="op" id="6825725">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6825728">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6825731">err</span>&nbsp;<span class="op" id="6825735">:=</span>&nbsp;<span class="ident" id="6825738">c</span><span class="op" id="6825739">.</span><span class="ident" id="6825740">VerifyHostname</span><span class="op" id="6825754">(</span><span class="string" id="6825755">&#34;quux.foo.bar.baz&#34;</span><span class="op" id="6825773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6825776">if</span>&nbsp;<span class="ident" id="6825779">err</span>&nbsp;<span class="op" id="6825783">!=</span>&nbsp;<span class="ident" id="6825786">nil</span>&nbsp;<span class="op" id="6825790">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6825794">t</span><span class="op" id="6825795">.</span><span class="ident" id="6825796">Fatalf</span><span class="op" id="6825802">(</span><span class="string" id="6825803">&#34;VerifyHostname(quux.foo.bar.baz):&nbsp;%v&#34;</span><span class="op" id="6825841">,</span>&nbsp;<span class="ident" id="6825843">err</span><span class="op" id="6825846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6825849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6825853">//&nbsp;But&nbsp;check&nbsp;that&nbsp;if&nbsp;we&nbsp;change&nbsp;it&nbsp;to&nbsp;be&nbsp;matching&nbsp;against&nbsp;an&nbsp;IP&nbsp;address,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6825926">//&nbsp;it&nbsp;is&nbsp;rejected.</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6825946">c</span>&nbsp;<span class="op" id="6825948">=</span>&nbsp;<span class="op" id="6825950">&amp;</span><span class="ident" id="6825951">Certificate</span><span class="op" id="6825962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6825966">DNSNames</span><span class="op" id="6825974">:</span>&nbsp;<span class="op" id="6825976">[</span><span class="op" id="6825977">]</span><span class="builtintype" id="6825978">string</span><span class="op" id="6825984">{</span><span class="string" id="6825985">&#34;*.2.3.4&#34;</span><span class="op" id="6825994">}</span><span class="op" id="6825995">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6825999">Subject</span><span class="op" id="6826006">:</span>&nbsp;<span class="ident" id="6826008">pkix</span><span class="op" id="6826012">.</span><span class="ident" id="6826013">Name</span><span class="op" id="6826017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6826022">CommonName</span><span class="op" id="6826032">:</span>&nbsp;<span class="string" id="6826034">&#34;*.2.3.4&#34;</span><span class="op" id="6826043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6826047">}</span><span class="op" id="6826048">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6826051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6826054">err</span>&nbsp;<span class="op" id="6826058">=</span>&nbsp;<span class="ident" id="6826060">c</span><span class="op" id="6826061">.</span><span class="ident" id="6826062">VerifyHostname</span><span class="op" id="6826076">(</span><span class="string" id="6826077">&#34;1.2.3.4&#34;</span><span class="op" id="6826086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6826089">if</span>&nbsp;<span class="ident" id="6826092">err</span>&nbsp;<span class="op" id="6826096">==</span>&nbsp;<span class="ident" id="6826099">nil</span>&nbsp;<span class="op" id="6826103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6826107">t</span><span class="op" id="6826108">.</span><span class="ident" id="6826109">Fatalf</span><span class="op" id="6826115">(</span><span class="string" id="6826116">&#34;VerifyHostname(1.2.3.4)&nbsp;should&nbsp;have&nbsp;failed,&nbsp;did&nbsp;not&#34;</span><span class="op" id="6826169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6826172">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6826176">c</span>&nbsp;<span class="op" id="6826178">=</span>&nbsp;<span class="op" id="6826180">&amp;</span><span class="ident" id="6826181">Certificate</span><span class="op" id="6826192">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6826196">IPAddresses</span><span class="op" id="6826207">:</span>&nbsp;<span class="op" id="6826209">[</span><span class="op" id="6826210">]</span><span class="ident" id="6826211">net</span><span class="op" id="6826214">.</span><span class="ident" id="6826215">IP</span><span class="op" id="6826217">{</span><span class="ident" id="6826218">net</span><span class="op" id="6826221">.</span><span class="ident" id="6826222">ParseIP</span><span class="op" id="6826229">(</span><span class="string" id="6826230">&#34;127.0.0.1&#34;</span><span class="op" id="6826241">)</span><span class="op" id="6826242">,</span>&nbsp;<span class="ident" id="6826244">net</span><span class="op" id="6826247">.</span><span class="ident" id="6826248">ParseIP</span><span class="op" id="6826255">(</span><span class="string" id="6826256">&#34;::1&#34;</span><span class="op" id="6826261">)</span><span class="op" id="6826262">}</span><span class="op" id="6826263">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6826266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6826269">err</span>&nbsp;<span class="op" id="6826273">=</span>&nbsp;<span class="ident" id="6826275">c</span><span class="op" id="6826276">.</span><span class="ident" id="6826277">VerifyHostname</span><span class="op" id="6826291">(</span><span class="string" id="6826292">&#34;127.0.0.1&#34;</span><span class="op" id="6826303">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6826306">if</span>&nbsp;<span class="ident" id="6826309">err</span>&nbsp;<span class="op" id="6826313">!=</span>&nbsp;<span class="ident" id="6826316">nil</span>&nbsp;<span class="op" id="6826320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6826324">t</span><span class="op" id="6826325">.</span><span class="ident" id="6826326">Fatalf</span><span class="op" id="6826332">(</span><span class="string" id="6826333">&#34;VerifyHostname(127.0.0.1):&nbsp;%v&#34;</span><span class="op" id="6826364">,</span>&nbsp;<span class="ident" id="6826366">err</span><span class="op" id="6826369">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6826372">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6826375">err</span>&nbsp;<span class="op" id="6826379">=</span>&nbsp;<span class="ident" id="6826381">c</span><span class="op" id="6826382">.</span><span class="ident" id="6826383">VerifyHostname</span><span class="op" id="6826397">(</span><span class="string" id="6826398">&#34;::1&#34;</span><span class="op" id="6826403">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6826406">if</span>&nbsp;<span class="ident" id="6826409">err</span>&nbsp;<span class="op" id="6826413">!=</span>&nbsp;<span class="ident" id="6826416">nil</span>&nbsp;<span class="op" id="6826420">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6826424">t</span><span class="op" id="6826425">.</span><span class="ident" id="6826426">Fatalf</span><span class="op" id="6826432">(</span><span class="string" id="6826433">&#34;VerifyHostname(::1):&nbsp;%v&#34;</span><span class="op" id="6826458">,</span>&nbsp;<span class="ident" id="6826460">err</span><span class="op" id="6826463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6826466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6826469">err</span>&nbsp;<span class="op" id="6826473">=</span>&nbsp;<span class="ident" id="6826475">c</span><span class="op" id="6826476">.</span><span class="ident" id="6826477">VerifyHostname</span><span class="op" id="6826491">(</span><span class="string" id="6826492">&#34;[::1]&#34;</span><span class="op" id="6826499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6826502">if</span>&nbsp;<span class="ident" id="6826505">err</span>&nbsp;<span class="op" id="6826509">!=</span>&nbsp;<span class="ident" id="6826512">nil</span>&nbsp;<span class="op" id="6826516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6826520">t</span><span class="op" id="6826521">.</span><span class="ident" id="6826522">Fatalf</span><span class="op" id="6826528">(</span><span class="string" id="6826529">&#34;VerifyHostname([::1]):&nbsp;%v&#34;</span><span class="op" id="6826556">,</span>&nbsp;<span class="ident" id="6826558">err</span><span class="op" id="6826561">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6826564">}</span><br>
<span class="lineno"></span><span class="op" id="6826566">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6826569">func</span>&nbsp;<span class="ident" id="6826574">TestCertificateParse</span><span class="op" id="6826594">(</span><span class="ident" id="6826595">t</span>&nbsp;<span class="op" id="6826597">*</span><span class="ident" id="6826598">testing</span><span class="op" id="6826605">.</span><span class="ident" id="6826606">T</span><span class="op" id="6826607">)</span>&nbsp;<span class="op" id="6826609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6826612">s</span><span class="op" id="6826613">,</span>&nbsp;<span class="ident" id="6826615">_</span>&nbsp;<span class="op" id="6826617">:=</span>&nbsp;<span class="ident" id="6826620">hex</span><span class="op" id="6826623">.</span><span class="ident" id="6826624">DecodeString</span><span class="op" id="6826636">(</span><span class="ident" id="6826637">certBytes</span><span class="op" id="6826646">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6826649">certs</span><span class="op" id="6826654">,</span>&nbsp;<span class="ident" id="6826656">err</span>&nbsp;<span class="op" id="6826660">:=</span>&nbsp;<span class="ident" id="6826663">ParseCertificates</span><span class="op" id="6826680">(</span><span class="ident" id="6826681">s</span><span class="op" id="6826682">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6826685">if</span>&nbsp;<span class="ident" id="6826688">err</span>&nbsp;<span class="op" id="6826692">!=</span>&nbsp;<span class="ident" id="6826695">nil</span>&nbsp;<span class="op" id="6826699">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6826703">t</span><span class="op" id="6826704">.</span><span class="ident" id="6826705">Error</span><span class="op" id="6826710">(</span><span class="ident" id="6826711">err</span><span class="op" id="6826714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6826717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6826720">if</span>&nbsp;<span class="builtinfunc" id="6826723">len</span><span class="op" id="6826726">(</span><span class="ident" id="6826727">certs</span><span class="op" id="6826732">)</span>&nbsp;<span class="op" id="6826734">!=</span>&nbsp;<span class="num" id="6826737">2</span>&nbsp;<span class="op" id="6826739">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6826743">t</span><span class="op" id="6826744">.</span><span class="ident" id="6826745">Errorf</span><span class="op" id="6826751">(</span><span class="string" id="6826752">&#34;Wrong&nbsp;number&nbsp;of&nbsp;certs:&nbsp;got&nbsp;%d&nbsp;want&nbsp;2&#34;</span><span class="op" id="6826790">,</span>&nbsp;<span class="builtinfunc" id="6826792">len</span><span class="op" id="6826795">(</span><span class="ident" id="6826796">certs</span><span class="op" id="6826801">)</span><span class="op" id="6826802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6826806">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6826814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6826818">err</span>&nbsp;<span class="op" id="6826822">=</span>&nbsp;<span class="ident" id="6826824">certs</span><span class="op" id="6826829">[</span><span class="num" id="6826830">0</span><span class="op" id="6826831">]</span><span class="op" id="6826832">.</span><span class="ident" id="6826833">CheckSignatureFrom</span><span class="op" id="6826851">(</span><span class="ident" id="6826852">certs</span><span class="op" id="6826857">[</span><span class="num" id="6826858">1</span><span class="op" id="6826859">]</span><span class="op" id="6826860">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6826863">if</span>&nbsp;<span class="ident" id="6826866">err</span>&nbsp;<span class="op" id="6826870">!=</span>&nbsp;<span class="ident" id="6826873">nil</span>&nbsp;<span class="op" id="6826877">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6826881">t</span><span class="op" id="6826882">.</span><span class="ident" id="6826883">Error</span><span class="op" id="6826888">(</span><span class="ident" id="6826889">err</span><span class="op" id="6826892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6826895">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6826899">if</span>&nbsp;<span class="ident" id="6826902">err</span>&nbsp;<span class="op" id="6826906">:=</span>&nbsp;<span class="ident" id="6826909">certs</span><span class="op" id="6826914">[</span><span class="num" id="6826915">0</span><span class="op" id="6826916">]</span><span class="op" id="6826917">.</span><span class="ident" id="6826918">VerifyHostname</span><span class="op" id="6826932">(</span><span class="string" id="6826933">&#34;mail.google.com&#34;</span><span class="op" id="6826950">)</span><span class="op" id="6826951">;</span>&nbsp;<span class="ident" id="6826953">err</span>&nbsp;<span class="op" id="6826957">!=</span>&nbsp;<span class="ident" id="6826960">nil</span>&nbsp;<span class="op" id="6826964">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6826968">t</span><span class="op" id="6826969">.</span><span class="ident" id="6826970">Error</span><span class="op" id="6826975">(</span><span class="ident" id="6826976">err</span><span class="op" id="6826979">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6826982">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6826986">const</span>&nbsp;<span class="ident" id="6826992">expectedExtensions</span>&nbsp;<span class="op" id="6827011">=</span>&nbsp;<span class="num" id="6827013">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6827016">if</span>&nbsp;<span class="ident" id="6827019">n</span>&nbsp;<span class="op" id="6827021">:=</span>&nbsp;<span class="builtinfunc" id="6827024">len</span><span class="op" id="6827027">(</span><span class="ident" id="6827028">certs</span><span class="op" id="6827033">[</span><span class="num" id="6827034">0</span><span class="op" id="6827035">]</span><span class="op" id="6827036">.</span><span class="ident" id="6827037">Extensions</span><span class="op" id="6827047">)</span><span class="op" id="6827048">;</span>&nbsp;<span class="ident" id="6827050">n</span>&nbsp;<span class="op" id="6827052">!=</span>&nbsp;<span class="ident" id="6827055">expectedExtensions</span>&nbsp;<span class="op" id="6827074">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6827078">t</span><span class="op" id="6827079">.</span><span class="ident" id="6827080">Errorf</span><span class="op" id="6827086">(</span><span class="string" id="6827087">&#34;want&nbsp;%d&nbsp;extensions,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6827115">,</span>&nbsp;<span class="ident" id="6827117">expectedExtensions</span><span class="op" id="6827135">,</span>&nbsp;<span class="ident" id="6827137">n</span><span class="op" id="6827138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6827141">}</span><br>
<span class="lineno"></span><span class="op" id="6827143">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6827146">var</span>&nbsp;<span class="ident" id="6827150">certBytes</span>&nbsp;<span class="op" id="6827160">=</span>&nbsp;<span class="string" id="6827162">&#34;308203223082028ba00302010202106edf0d9499fd4533dd1297fc42a93be1300d06092a864886&#34;</span>&nbsp;<span class="op" id="6827243">+</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6827246">&#34;f70d0101050500304c310b3009060355040613025a4131253023060355040a131c546861777465&#34;</span>&nbsp;<span class="op" id="6827327">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6827330">&#34;20436f6e73756c74696e67202850747929204c74642e311630140603550403130d546861777465&#34;</span>&nbsp;<span class="op" id="6827411">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6827414">&#34;20534743204341301e170d3039303332353136343932395a170d3130303332353136343932395a&#34;</span>&nbsp;<span class="op" id="6827495">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6827498">&#34;3069310b3009060355040613025553311330110603550408130a43616c69666f726e6961311630&#34;</span>&nbsp;<span class="op" id="6827579">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6827582">&#34;140603550407130d4d6f756e7461696e205669657731133011060355040a130a476f6f676c6520&#34;</span>&nbsp;<span class="op" id="6827663">+</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6827666">&#34;496e63311830160603550403130f6d61696c2e676f6f676c652e636f6d30819f300d06092a8648&#34;</span>&nbsp;<span class="op" id="6827747">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6827750">&#34;86f70d010101050003818d0030818902818100c5d6f892fccaf5614b064149e80a2c9581a218ef&#34;</span>&nbsp;<span class="op" id="6827831">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6827834">&#34;41ec35bd7a58125ae76f9ea54ddc893abbeb029f6b73616bf0ffd868791fba7af9c4aebf3706ba&#34;</span>&nbsp;<span class="op" id="6827915">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6827918">&#34;3eeaeed27435b4ddcfb157c05f351d66aa87fee0de072d66d773affbd36ab78bef090e0cc861a9&#34;</span>&nbsp;<span class="op" id="6827999">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6828002">&#34;03ac90dd98b51c9c41566c017f0beec3bff391051ffba0f5cc6850ad2a590203010001a381e730&#34;</span>&nbsp;<span class="op" id="6828083">+</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6828086">&#34;81e430280603551d250421301f06082b0601050507030106082b06010505070302060960864801&#34;</span>&nbsp;<span class="op" id="6828167">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6828170">&#34;86f842040130360603551d1f042f302d302ba029a0278625687474703a2f2f63726c2e74686177&#34;</span>&nbsp;<span class="op" id="6828251">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6828254">&#34;74652e636f6d2f54686177746553474343412e63726c307206082b060105050701010466306430&#34;</span>&nbsp;<span class="op" id="6828335">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6828338">&#34;2206082b060105050730018616687474703a2f2f6f6373702e7468617774652e636f6d303e0608&#34;</span>&nbsp;<span class="op" id="6828419">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6828422">&#34;2b060105050730028632687474703a2f2f7777772e7468617774652e636f6d2f7265706f736974&#34;</span>&nbsp;<span class="op" id="6828503">+</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6828506">&#34;6f72792f5468617774655f5347435f43412e637274300c0603551d130101ff04023000300d0609&#34;</span>&nbsp;<span class="op" id="6828587">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6828590">&#34;2a864886f70d01010505000381810062f1f3050ebc105e497c7aedf87e24d2f4a986bb3b837bd1&#34;</span>&nbsp;<span class="op" id="6828671">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6828674">&#34;9b91ebcad98b065992f6bd2b49b7d6d3cb2e427a99d606c7b1d46352527fac39e6a8b6726de5bf&#34;</span>&nbsp;<span class="op" id="6828755">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6828758">&#34;70212a52cba07634a5e332011bd1868e78eb5e3c93cf03072276786f207494feaa0ed9d53b2110&#34;</span>&nbsp;<span class="op" id="6828839">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6828842">&#34;a76571f90209cdae884385c882587030ee15f33d761e2e45a6bc308203233082028ca003020102&#34;</span>&nbsp;<span class="op" id="6828923">+</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6828926">&#34;020430000002300d06092a864886f70d0101050500305f310b3009060355040613025553311730&#34;</span>&nbsp;<span class="op" id="6829007">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6829010">&#34;15060355040a130e566572695369676e2c20496e632e31373035060355040b132e436c61737320&#34;</span>&nbsp;<span class="op" id="6829091">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6829094">&#34;33205075626c6963205072696d6172792043657274696669636174696f6e20417574686f726974&#34;</span>&nbsp;<span class="op" id="6829175">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6829178">&#34;79301e170d3034303531333030303030305a170d3134303531323233353935395a304c310b3009&#34;</span>&nbsp;<span class="op" id="6829259">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6829262">&#34;060355040613025a4131253023060355040a131c54686177746520436f6e73756c74696e672028&#34;</span>&nbsp;<span class="op" id="6829343">+</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6829346">&#34;50747929204c74642e311630140603550403130d5468617774652053474320434130819f300d06&#34;</span>&nbsp;<span class="op" id="6829427">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6829430">&#34;092a864886f70d010101050003818d0030818902818100d4d367d08d157faecd31fe7d1d91a13f&#34;</span>&nbsp;<span class="op" id="6829511">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6829514">&#34;0b713cacccc864fb63fc324b0794bd6f80ba2fe10493c033fc093323e90b742b71c403c6d2cde2&#34;</span>&nbsp;<span class="op" id="6829595">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6829598">&#34;2ff50963cdff48a500bfe0e7f388b72d32de9836e60aad007bc4644a3b847503f270927d0e62f5&#34;</span>&nbsp;<span class="op" id="6829679">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6829682">&#34;21ab693684317590f8bfc76c881b06957cc9e5a8de75a12c7a68dfd5ca1c875860190203010001&#34;</span>&nbsp;<span class="op" id="6829763">+</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6829766">&#34;a381fe3081fb30120603551d130101ff040830060101ff020100300b0603551d0f040403020106&#34;</span>&nbsp;<span class="op" id="6829847">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6829850">&#34;301106096086480186f842010104040302010630280603551d110421301fa41d301b3119301706&#34;</span>&nbsp;<span class="op" id="6829931">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6829934">&#34;035504031310507269766174654c6162656c332d313530310603551d1f042a30283026a024a022&#34;</span>&nbsp;<span class="op" id="6830015">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6830018">&#34;8620687474703a2f2f63726c2e766572697369676e2e636f6d2f706361332e63726c303206082b&#34;</span>&nbsp;<span class="op" id="6830099">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6830102">&#34;0601050507010104263024302206082b060105050730018616687474703a2f2f6f6373702e7468&#34;</span>&nbsp;<span class="op" id="6830183">+</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6830186">&#34;617774652e636f6d30340603551d25042d302b06082b0601050507030106082b06010505070302&#34;</span>&nbsp;<span class="op" id="6830267">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6830270">&#34;06096086480186f8420401060a6086480186f845010801300d06092a864886f70d010105050003&#34;</span>&nbsp;<span class="op" id="6830351">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6830354">&#34;81810055ac63eadea1ddd2905f9f0bce76be13518f93d9052bc81b774bad6950a1eededcfddb07&#34;</span>&nbsp;<span class="op" id="6830435">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6830438">&#34;e9e83994dcab72792f06bfab8170c4a8edea5334edef1e53d906c7562bd15cf4d18a8eb42bb137&#34;</span>&nbsp;<span class="op" id="6830519">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6830522">&#34;9048084225c53e8acb7feb6f04d16dc574a2f7a27c7b603c77cd0ece48027f012fb69b37e02a2a&#34;</span>&nbsp;<span class="op" id="6830603">+</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6830606">&#34;36dcd585d6ace53f546f961e05af&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6830638">func</span>&nbsp;<span class="ident" id="6830643">TestCreateSelfSignedCertificate</span><span class="op" id="6830674">(</span><span class="ident" id="6830675">t</span>&nbsp;<span class="op" id="6830677">*</span><span class="ident" id="6830678">testing</span><span class="op" id="6830685">.</span><span class="ident" id="6830686">T</span><span class="op" id="6830687">)</span>&nbsp;<span class="op" id="6830689">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6830692">random</span>&nbsp;<span class="op" id="6830699">:=</span>&nbsp;<span class="ident" id="6830702">rand</span><span class="op" id="6830706">.</span><span class="ident" id="6830707">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6830716">block</span><span class="op" id="6830721">,</span>&nbsp;<span class="ident" id="6830723">_</span>&nbsp;<span class="op" id="6830725">:=</span>&nbsp;<span class="ident" id="6830728">pem</span><span class="op" id="6830731">.</span><span class="ident" id="6830732">Decode</span><span class="op" id="6830738">(</span><span class="op" id="6830739">[</span><span class="op" id="6830740">]</span><span class="builtintype" id="6830741">byte</span><span class="op" id="6830745">(</span><span class="ident" id="6830746">pemPrivateKey</span><span class="op" id="6830759">)</span><span class="op" id="6830760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6830763">rsaPriv</span><span class="op" id="6830770">,</span>&nbsp;<span class="ident" id="6830772">err</span>&nbsp;<span class="op" id="6830776">:=</span>&nbsp;<span class="ident" id="6830779">ParsePKCS1PrivateKey</span><span class="op" id="6830799">(</span><span class="ident" id="6830800">block</span><span class="op" id="6830805">.</span><span class="ident" id="6830806">Bytes</span><span class="op" id="6830811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6830814">if</span>&nbsp;<span class="ident" id="6830817">err</span>&nbsp;<span class="op" id="6830821">!=</span>&nbsp;<span class="ident" id="6830824">nil</span>&nbsp;<span class="op" id="6830828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6830832">t</span><span class="op" id="6830833">.</span><span class="ident" id="6830834">Fatalf</span><span class="op" id="6830840">(</span><span class="string" id="6830841">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6830874">,</span>&nbsp;<span class="ident" id="6830876">err</span><span class="op" id="6830879">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6830882">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6830886">ecdsaPriv</span><span class="op" id="6830895">,</span>&nbsp;<span class="ident" id="6830897">err</span>&nbsp;<span class="op" id="6830901">:=</span>&nbsp;<span class="ident" id="6830904">ecdsa</span><span class="op" id="6830909">.</span><span class="ident" id="6830910">GenerateKey</span><span class="op" id="6830921">(</span><span class="ident" id="6830922">elliptic</span><span class="op" id="6830930">.</span><span class="ident" id="6830931">P256</span><span class="op" id="6830935">(</span><span class="op" id="6830936">)</span><span class="op" id="6830937">,</span>&nbsp;<span class="ident" id="6830939">rand</span><span class="op" id="6830943">.</span><span class="ident" id="6830944">Reader</span><span class="op" id="6830950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6830953">if</span>&nbsp;<span class="ident" id="6830956">err</span>&nbsp;<span class="op" id="6830960">!=</span>&nbsp;<span class="ident" id="6830963">nil</span>&nbsp;<span class="op" id="6830967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6830971">t</span><span class="op" id="6830972">.</span><span class="ident" id="6830973">Fatalf</span><span class="op" id="6830979">(</span><span class="string" id="6830980">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6831014">,</span>&nbsp;<span class="ident" id="6831016">err</span><span class="op" id="6831019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6831022">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831026">tests</span>&nbsp;<span class="op" id="6831032">:=</span>&nbsp;<span class="op" id="6831035">[</span><span class="op" id="6831036">]</span><span class="keyword" id="6831037">struct</span>&nbsp;<span class="op" id="6831044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831048">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6831058">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831067">pub</span><span class="op" id="6831070">,</span>&nbsp;<span class="ident" id="6831072">priv</span>&nbsp;<span class="keyword" id="6831077">interface</span><span class="op" id="6831086">{</span><span class="op" id="6831087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831091">checkSig</span>&nbsp;&nbsp;<span class="builtintype" id="6831101">bool</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831108">sigAlgo</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6831118">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6831138">}</span><span class="op" id="6831139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6831143">{</span><span class="string" id="6831144">&#34;RSA/RSA&#34;</span><span class="op" id="6831153">,</span>&nbsp;<span class="op" id="6831155">&amp;</span><span class="ident" id="6831156">rsaPriv</span><span class="op" id="6831163">.</span><span class="ident" id="6831164">PublicKey</span><span class="op" id="6831173">,</span>&nbsp;<span class="ident" id="6831175">rsaPriv</span><span class="op" id="6831182">,</span>&nbsp;<span class="builtintype" id="6831184">true</span><span class="op" id="6831188">,</span>&nbsp;<span class="ident" id="6831190">SHA1WithRSA</span><span class="op" id="6831201">}</span><span class="op" id="6831202">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6831206">{</span><span class="string" id="6831207">&#34;RSA/ECDSA&#34;</span><span class="op" id="6831218">,</span>&nbsp;<span class="op" id="6831220">&amp;</span><span class="ident" id="6831221">rsaPriv</span><span class="op" id="6831228">.</span><span class="ident" id="6831229">PublicKey</span><span class="op" id="6831238">,</span>&nbsp;<span class="ident" id="6831240">ecdsaPriv</span><span class="op" id="6831249">,</span>&nbsp;<span class="builtintype" id="6831251">false</span><span class="op" id="6831256">,</span>&nbsp;<span class="ident" id="6831258">ECDSAWithSHA384</span><span class="op" id="6831273">}</span><span class="op" id="6831274">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6831278">{</span><span class="string" id="6831279">&#34;ECDSA/RSA&#34;</span><span class="op" id="6831290">,</span>&nbsp;<span class="op" id="6831292">&amp;</span><span class="ident" id="6831293">ecdsaPriv</span><span class="op" id="6831302">.</span><span class="ident" id="6831303">PublicKey</span><span class="op" id="6831312">,</span>&nbsp;<span class="ident" id="6831314">rsaPriv</span><span class="op" id="6831321">,</span>&nbsp;<span class="builtintype" id="6831323">false</span><span class="op" id="6831328">,</span>&nbsp;<span class="ident" id="6831330">SHA256WithRSA</span><span class="op" id="6831343">}</span><span class="op" id="6831344">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6831348">{</span><span class="string" id="6831349">&#34;ECDSA/ECDSA&#34;</span><span class="op" id="6831362">,</span>&nbsp;<span class="op" id="6831364">&amp;</span><span class="ident" id="6831365">ecdsaPriv</span><span class="op" id="6831374">.</span><span class="ident" id="6831375">PublicKey</span><span class="op" id="6831384">,</span>&nbsp;<span class="ident" id="6831386">ecdsaPriv</span><span class="op" id="6831395">,</span>&nbsp;<span class="builtintype" id="6831397">true</span><span class="op" id="6831401">,</span>&nbsp;<span class="ident" id="6831403">ECDSAWithSHA1</span><span class="op" id="6831416">}</span><span class="op" id="6831417">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6831420">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831424">testExtKeyUsage</span>&nbsp;<span class="op" id="6831440">:=</span>&nbsp;<span class="op" id="6831443">[</span><span class="op" id="6831444">]</span><span class="ident" id="6831445">ExtKeyUsage</span><span class="op" id="6831456">{</span><span class="ident" id="6831457">ExtKeyUsageClientAuth</span><span class="op" id="6831478">,</span>&nbsp;<span class="ident" id="6831480">ExtKeyUsageServerAuth</span><span class="op" id="6831501">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831504">testUnknownExtKeyUsage</span>&nbsp;<span class="op" id="6831527">:=</span>&nbsp;<span class="op" id="6831530">[</span><span class="op" id="6831531">]</span><span class="ident" id="6831532">asn1</span><span class="op" id="6831536">.</span><span class="ident" id="6831537">ObjectIdentifier</span><span class="op" id="6831553">{</span><span class="op" id="6831554">[</span><span class="op" id="6831555">]</span><span class="builtintype" id="6831556">int</span><span class="op" id="6831559">{</span><span class="num" id="6831560">1</span><span class="op" id="6831561">,</span>&nbsp;<span class="num" id="6831563">2</span><span class="op" id="6831564">,</span>&nbsp;<span class="num" id="6831566">3</span><span class="op" id="6831567">}</span><span class="op" id="6831568">,</span>&nbsp;<span class="op" id="6831570">[</span><span class="op" id="6831571">]</span><span class="builtintype" id="6831572">int</span><span class="op" id="6831575">{</span><span class="num" id="6831576">2</span><span class="op" id="6831577">,</span>&nbsp;<span class="num" id="6831579">59</span><span class="op" id="6831581">,</span>&nbsp;<span class="num" id="6831583">1</span><span class="op" id="6831584">}</span><span class="op" id="6831585">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831588">extraExtensionData</span>&nbsp;<span class="op" id="6831607">:=</span>&nbsp;<span class="op" id="6831610">[</span><span class="op" id="6831611">]</span><span class="builtintype" id="6831612">byte</span><span class="op" id="6831616">(</span><span class="string" id="6831617">&#34;extra&nbsp;extension&#34;</span><span class="op" id="6831634">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6831638">for</span>&nbsp;<span class="ident" id="6831642">_</span><span class="op" id="6831643">,</span>&nbsp;<span class="ident" id="6831645">test</span>&nbsp;<span class="op" id="6831650">:=</span>&nbsp;<span class="keyword" id="6831653">range</span>&nbsp;<span class="ident" id="6831659">tests</span>&nbsp;<span class="op" id="6831665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831669">commonName</span>&nbsp;<span class="op" id="6831680">:=</span>&nbsp;<span class="string" id="6831683">&#34;test.example.com&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831704">template</span>&nbsp;<span class="op" id="6831713">:=</span>&nbsp;<span class="ident" id="6831716">Certificate</span><span class="op" id="6831727">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831732">SerialNumber</span><span class="op" id="6831744">:</span>&nbsp;<span class="ident" id="6831746">big</span><span class="op" id="6831749">.</span><span class="ident" id="6831750">NewInt</span><span class="op" id="6831756">(</span><span class="num" id="6831757">1</span><span class="op" id="6831758">)</span><span class="op" id="6831759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831764">Subject</span><span class="op" id="6831771">:</span>&nbsp;<span class="ident" id="6831773">pkix</span><span class="op" id="6831777">.</span><span class="ident" id="6831778">Name</span><span class="op" id="6831782">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831788">CommonName</span><span class="op" id="6831798">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6831802">commonName</span><span class="op" id="6831812">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831818">Organization</span><span class="op" id="6831830">:</span>&nbsp;<span class="op" id="6831832">[</span><span class="op" id="6831833">]</span><span class="builtintype" id="6831834">string</span><span class="op" id="6831840">{</span><span class="string" id="6831841">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="6831853">}</span><span class="op" id="6831854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6831859">}</span><span class="op" id="6831860">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831865">NotBefore</span><span class="op" id="6831874">:</span>&nbsp;<span class="ident" id="6831876">time</span><span class="op" id="6831880">.</span><span class="ident" id="6831881">Unix</span><span class="op" id="6831885">(</span><span class="num" id="6831886">1000</span><span class="op" id="6831890">,</span>&nbsp;<span class="num" id="6831892">0</span><span class="op" id="6831893">)</span><span class="op" id="6831894">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831899">NotAfter</span><span class="op" id="6831907">:</span>&nbsp;&nbsp;<span class="ident" id="6831910">time</span><span class="op" id="6831914">.</span><span class="ident" id="6831915">Unix</span><span class="op" id="6831919">(</span><span class="num" id="6831920">100000</span><span class="op" id="6831926">,</span>&nbsp;<span class="num" id="6831928">0</span><span class="op" id="6831929">)</span><span class="op" id="6831930">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831936">SignatureAlgorithm</span><span class="op" id="6831954">:</span>&nbsp;<span class="ident" id="6831956">test</span><span class="op" id="6831960">.</span><span class="ident" id="6831961">sigAlgo</span><span class="op" id="6831968">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6831974">SubjectKeyId</span><span class="op" id="6831986">:</span>&nbsp;<span class="op" id="6831988">[</span><span class="op" id="6831989">]</span><span class="builtintype" id="6831990">byte</span><span class="op" id="6831994">{</span><span class="num" id="6831995">1</span><span class="op" id="6831996">,</span>&nbsp;<span class="num" id="6831998">2</span><span class="op" id="6831999">,</span>&nbsp;<span class="num" id="6832001">3</span><span class="op" id="6832002">,</span>&nbsp;<span class="num" id="6832004">4</span><span class="op" id="6832005">}</span><span class="op" id="6832006">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832011">KeyUsage</span><span class="op" id="6832019">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6832025">KeyUsageCertSign</span><span class="op" id="6832041">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832047">ExtKeyUsage</span><span class="op" id="6832058">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6832067">testExtKeyUsage</span><span class="op" id="6832082">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832087">UnknownExtKeyUsage</span><span class="op" id="6832105">:</span>&nbsp;<span class="ident" id="6832107">testUnknownExtKeyUsage</span><span class="op" id="6832129">,</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832135">BasicConstraintsValid</span><span class="op" id="6832156">:</span>&nbsp;<span class="builtintype" id="6832158">true</span><span class="op" id="6832162">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832167">IsCA</span><span class="op" id="6832171">:</span>&nbsp;<span class="builtintype" id="6832173">true</span><span class="op" id="6832177">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832183">OCSPServer</span><span class="op" id="6832193">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6832206">[</span><span class="op" id="6832207">]</span><span class="builtintype" id="6832208">string</span><span class="op" id="6832214">{</span><span class="string" id="6832215">&#34;http://ocsp.example.com&#34;</span><span class="op" id="6832240">}</span><span class="op" id="6832241">,</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832246">IssuingCertificateURL</span><span class="op" id="6832267">:</span>&nbsp;<span class="op" id="6832269">[</span><span class="op" id="6832270">]</span><span class="builtintype" id="6832271">string</span><span class="op" id="6832277">{</span><span class="string" id="6832278">&#34;http://crt.example.com/ca1.crt&#34;</span><span class="op" id="6832310">}</span><span class="op" id="6832311">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832317">DNSNames</span><span class="op" id="6832325">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6832333">[</span><span class="op" id="6832334">]</span><span class="builtintype" id="6832335">string</span><span class="op" id="6832341">{</span><span class="string" id="6832342">&#34;test.example.com&#34;</span><span class="op" id="6832360">}</span><span class="op" id="6832361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832366">EmailAddresses</span><span class="op" id="6832380">:</span>&nbsp;<span class="op" id="6832382">[</span><span class="op" id="6832383">]</span><span class="builtintype" id="6832384">string</span><span class="op" id="6832390">{</span><span class="string" id="6832391">&#34;gopher@golang.org&#34;</span><span class="op" id="6832410">}</span><span class="op" id="6832411">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832416">IPAddresses</span><span class="op" id="6832427">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6832432">[</span><span class="op" id="6832433">]</span><span class="ident" id="6832434">net</span><span class="op" id="6832437">.</span><span class="ident" id="6832438">IP</span><span class="op" id="6832440">{</span><span class="ident" id="6832441">net</span><span class="op" id="6832444">.</span><span class="ident" id="6832445">IPv4</span><span class="op" id="6832449">(</span><span class="num" id="6832450">127</span><span class="op" id="6832453">,</span>&nbsp;<span class="num" id="6832455">0</span><span class="op" id="6832456">,</span>&nbsp;<span class="num" id="6832458">0</span><span class="op" id="6832459">,</span>&nbsp;<span class="num" id="6832461">1</span><span class="op" id="6832462">)</span><span class="op" id="6832463">.</span><span class="ident" id="6832464">To4</span><span class="op" id="6832467">(</span><span class="op" id="6832468">)</span><span class="op" id="6832469">,</span>&nbsp;<span class="ident" id="6832471">net</span><span class="op" id="6832474">.</span><span class="ident" id="6832475">ParseIP</span><span class="op" id="6832482">(</span><span class="string" id="6832483">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="6832505">)</span><span class="op" id="6832506">}</span><span class="op" id="6832507">,</span><br>
<span class="lineno">350</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832513">PolicyIdentifiers</span><span class="op" id="6832530">:</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6832534">[</span><span class="op" id="6832535">]</span><span class="ident" id="6832536">asn1</span><span class="op" id="6832540">.</span><span class="ident" id="6832541">ObjectIdentifier</span><span class="op" id="6832557">{</span><span class="op" id="6832558">[</span><span class="op" id="6832559">]</span><span class="builtintype" id="6832560">int</span><span class="op" id="6832563">{</span><span class="num" id="6832564">1</span><span class="op" id="6832565">,</span>&nbsp;<span class="num" id="6832567">2</span><span class="op" id="6832568">,</span>&nbsp;<span class="num" id="6832570">3</span><span class="op" id="6832571">}</span><span class="op" id="6832572">}</span><span class="op" id="6832573">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832578">PermittedDNSDomains</span><span class="op" id="6832597">:</span>&nbsp;<span class="op" id="6832599">[</span><span class="op" id="6832600">]</span><span class="builtintype" id="6832601">string</span><span class="op" id="6832607">{</span><span class="string" id="6832608">&#34;.example.com&#34;</span><span class="op" id="6832622">,</span>&nbsp;<span class="string" id="6832624">&#34;example.com&#34;</span><span class="op" id="6832637">}</span><span class="op" id="6832638">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832644">CRLDistributionPoints</span><span class="op" id="6832665">:</span>&nbsp;<span class="op" id="6832667">[</span><span class="op" id="6832668">]</span><span class="builtintype" id="6832669">string</span><span class="op" id="6832675">{</span><span class="string" id="6832676">&#34;http://crl1.example.com/ca1.crl&#34;</span><span class="op" id="6832709">,</span>&nbsp;<span class="string" id="6832711">&#34;http://crl2.example.com/ca1.crl&#34;</span><span class="op" id="6832744">}</span><span class="op" id="6832745">,</span><br>
<span class="lineno">355</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832751">ExtraExtensions</span><span class="op" id="6832766">:</span>&nbsp;<span class="op" id="6832768">[</span><span class="op" id="6832769">]</span><span class="ident" id="6832770">pkix</span><span class="op" id="6832774">.</span><span class="ident" id="6832775">Extension</span><span class="op" id="6832784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6832790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832797">Id</span><span class="op" id="6832799">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6832804">[</span><span class="op" id="6832805">]</span><span class="builtintype" id="6832806">int</span><span class="op" id="6832809">{</span><span class="num" id="6832810">1</span><span class="op" id="6832811">,</span>&nbsp;<span class="num" id="6832813">2</span><span class="op" id="6832814">,</span>&nbsp;<span class="num" id="6832816">3</span><span class="op" id="6832817">,</span>&nbsp;<span class="num" id="6832819">4</span><span class="op" id="6832820">}</span><span class="op" id="6832821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832828">Value</span><span class="op" id="6832833">:</span>&nbsp;<span class="ident" id="6832835">extraExtensionData</span><span class="op" id="6832853">,</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6832859">}</span><span class="op" id="6832860">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6832866">//&nbsp;This&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;SubjectKeyId,&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6832929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832936">Id</span><span class="op" id="6832938">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6832946">oidExtensionSubjectKeyId</span><span class="op" id="6832970">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832977">Critical</span><span class="op" id="6832985">:</span>&nbsp;<span class="builtintype" id="6832987">false</span><span class="op" id="6832992">,</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6832999">Value</span><span class="op" id="6833004">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6833009">[</span><span class="op" id="6833010">]</span><span class="builtintype" id="6833011">byte</span><span class="op" id="6833015">{</span><span class="num" id="6833016">0x04</span><span class="op" id="6833020">,</span>&nbsp;<span class="num" id="6833022">0x04</span><span class="op" id="6833026">,</span>&nbsp;<span class="num" id="6833028">4</span><span class="op" id="6833029">,</span>&nbsp;<span class="num" id="6833031">3</span><span class="op" id="6833032">,</span>&nbsp;<span class="num" id="6833034">2</span><span class="op" id="6833035">,</span>&nbsp;<span class="num" id="6833037">1</span><span class="op" id="6833038">}</span><span class="op" id="6833039">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6833045">}</span><span class="op" id="6833046">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6833051">}</span><span class="op" id="6833052">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6833056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6833061">derBytes</span><span class="op" id="6833069">,</span>&nbsp;<span class="ident" id="6833071">err</span>&nbsp;<span class="op" id="6833075">:=</span>&nbsp;<span class="ident" id="6833078">CreateCertificate</span><span class="op" id="6833095">(</span><span class="ident" id="6833096">random</span><span class="op" id="6833102">,</span>&nbsp;<span class="op" id="6833104">&amp;</span><span class="ident" id="6833105">template</span><span class="op" id="6833113">,</span>&nbsp;<span class="op" id="6833115">&amp;</span><span class="ident" id="6833116">template</span><span class="op" id="6833124">,</span>&nbsp;<span class="ident" id="6833126">test</span><span class="op" id="6833130">.</span><span class="ident" id="6833131">pub</span><span class="op" id="6833134">,</span>&nbsp;<span class="ident" id="6833136">test</span><span class="op" id="6833140">.</span><span class="ident" id="6833141">priv</span><span class="op" id="6833145">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6833149">if</span>&nbsp;<span class="ident" id="6833152">err</span>&nbsp;<span class="op" id="6833156">!=</span>&nbsp;<span class="ident" id="6833159">nil</span>&nbsp;<span class="op" id="6833163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6833168">t</span><span class="op" id="6833169">.</span><span class="ident" id="6833170">Errorf</span><span class="op" id="6833176">(</span><span class="string" id="6833177">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6833215">,</span>&nbsp;<span class="ident" id="6833217">test</span><span class="op" id="6833221">.</span><span class="ident" id="6833222">name</span><span class="op" id="6833226">,</span>&nbsp;<span class="ident" id="6833228">err</span><span class="op" id="6833231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6833236">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6833247">}</span><br>
<span class="lineno">375</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6833252">cert</span><span class="op" id="6833256">,</span>&nbsp;<span class="ident" id="6833258">err</span>&nbsp;<span class="op" id="6833262">:=</span>&nbsp;<span class="ident" id="6833265">ParseCertificate</span><span class="op" id="6833281">(</span><span class="ident" id="6833282">derBytes</span><span class="op" id="6833290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6833294">if</span>&nbsp;<span class="ident" id="6833297">err</span>&nbsp;<span class="op" id="6833301">!=</span>&nbsp;<span class="ident" id="6833304">nil</span>&nbsp;<span class="op" id="6833308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6833313">t</span><span class="op" id="6833314">.</span><span class="ident" id="6833315">Errorf</span><span class="op" id="6833321">(</span><span class="string" id="6833322">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6833359">,</span>&nbsp;<span class="ident" id="6833361">test</span><span class="op" id="6833365">.</span><span class="ident" id="6833366">name</span><span class="op" id="6833370">,</span>&nbsp;<span class="ident" id="6833372">err</span><span class="op" id="6833375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6833380">continue</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6833391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6833396">if</span>&nbsp;<span class="builtinfunc" id="6833399">len</span><span class="op" id="6833402">(</span><span class="ident" id="6833403">cert</span><span class="op" id="6833407">.</span><span class="ident" id="6833408">PolicyIdentifiers</span><span class="op" id="6833425">)</span>&nbsp;<span class="op" id="6833427">!=</span>&nbsp;<span class="num" id="6833430">1</span>&nbsp;<span class="op" id="6833432">||</span>&nbsp;<span class="op" id="6833435">!</span><span class="ident" id="6833436">cert</span><span class="op" id="6833440">.</span><span class="ident" id="6833441">PolicyIdentifiers</span><span class="op" id="6833458">[</span><span class="num" id="6833459">0</span><span class="op" id="6833460">]</span><span class="op" id="6833461">.</span><span class="ident" id="6833462">Equal</span><span class="op" id="6833467">(</span><span class="ident" id="6833468">template</span><span class="op" id="6833476">.</span><span class="ident" id="6833477">PolicyIdentifiers</span><span class="op" id="6833494">[</span><span class="num" id="6833495">0</span><span class="op" id="6833496">]</span><span class="op" id="6833497">)</span>&nbsp;<span class="op" id="6833499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6833504">t</span><span class="op" id="6833505">.</span><span class="ident" id="6833506">Errorf</span><span class="op" id="6833512">(</span><span class="string" id="6833513">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;policy&nbsp;identifiers:&nbsp;got:%#v&nbsp;want:%#v&#34;</span><span class="op" id="6833571">,</span>&nbsp;<span class="ident" id="6833573">test</span><span class="op" id="6833577">.</span><span class="ident" id="6833578">name</span><span class="op" id="6833582">,</span>&nbsp;<span class="ident" id="6833584">cert</span><span class="op" id="6833588">.</span><span class="ident" id="6833589">PolicyIdentifiers</span><span class="op" id="6833606">,</span>&nbsp;<span class="ident" id="6833608">template</span><span class="op" id="6833616">.</span><span class="ident" id="6833617">PolicyIdentifiers</span><span class="op" id="6833634">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6833638">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6833643">if</span>&nbsp;<span class="builtinfunc" id="6833646">len</span><span class="op" id="6833649">(</span><span class="ident" id="6833650">cert</span><span class="op" id="6833654">.</span><span class="ident" id="6833655">PermittedDNSDomains</span><span class="op" id="6833674">)</span>&nbsp;<span class="op" id="6833676">!=</span>&nbsp;<span class="num" id="6833679">2</span>&nbsp;<span class="op" id="6833681">||</span>&nbsp;<span class="ident" id="6833684">cert</span><span class="op" id="6833688">.</span><span class="ident" id="6833689">PermittedDNSDomains</span><span class="op" id="6833708">[</span><span class="num" id="6833709">0</span><span class="op" id="6833710">]</span>&nbsp;<span class="op" id="6833712">!=</span>&nbsp;<span class="string" id="6833715">&#34;.example.com&#34;</span>&nbsp;<span class="op" id="6833730">||</span>&nbsp;<span class="ident" id="6833733">cert</span><span class="op" id="6833737">.</span><span class="ident" id="6833738">PermittedDNSDomains</span><span class="op" id="6833757">[</span><span class="num" id="6833758">1</span><span class="op" id="6833759">]</span>&nbsp;<span class="op" id="6833761">!=</span>&nbsp;<span class="string" id="6833764">&#34;example.com&#34;</span>&nbsp;<span class="op" id="6833778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6833783">t</span><span class="op" id="6833784">.</span><span class="ident" id="6833785">Errorf</span><span class="op" id="6833791">(</span><span class="string" id="6833792">&#34;%s:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;name&nbsp;constraints:&nbsp;%#v&#34;</span><span class="op" id="6833835">,</span>&nbsp;<span class="ident" id="6833837">test</span><span class="op" id="6833841">.</span><span class="ident" id="6833842">name</span><span class="op" id="6833846">,</span>&nbsp;<span class="ident" id="6833848">cert</span><span class="op" id="6833852">.</span><span class="ident" id="6833853">PermittedDNSDomains</span><span class="op" id="6833872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6833876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6833881">if</span>&nbsp;<span class="ident" id="6833884">cert</span><span class="op" id="6833888">.</span><span class="ident" id="6833889">Subject</span><span class="op" id="6833896">.</span><span class="ident" id="6833897">CommonName</span>&nbsp;<span class="op" id="6833908">!=</span>&nbsp;<span class="ident" id="6833911">commonName</span>&nbsp;<span class="op" id="6833922">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6833927">t</span><span class="op" id="6833928">.</span><span class="ident" id="6833929">Errorf</span><span class="op" id="6833935">(</span><span class="string" id="6833936">&#34;%s:&nbsp;subject&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6834008">,</span>&nbsp;<span class="ident" id="6834010">test</span><span class="op" id="6834014">.</span><span class="ident" id="6834015">name</span><span class="op" id="6834019">,</span>&nbsp;<span class="ident" id="6834021">cert</span><span class="op" id="6834025">.</span><span class="ident" id="6834026">Subject</span><span class="op" id="6834033">.</span><span class="ident" id="6834034">CommonName</span><span class="op" id="6834044">,</span>&nbsp;<span class="ident" id="6834046">commonName</span><span class="op" id="6834056">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6834060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6834065">if</span>&nbsp;<span class="ident" id="6834068">cert</span><span class="op" id="6834072">.</span><span class="ident" id="6834073">Issuer</span><span class="op" id="6834079">.</span><span class="ident" id="6834080">CommonName</span>&nbsp;<span class="op" id="6834091">!=</span>&nbsp;<span class="ident" id="6834094">commonName</span>&nbsp;<span class="op" id="6834105">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6834110">t</span><span class="op" id="6834111">.</span><span class="ident" id="6834112">Errorf</span><span class="op" id="6834118">(</span><span class="string" id="6834119">&#34;%s:&nbsp;issuer&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%s,&nbsp;want&nbsp;%s&#34;</span><span class="op" id="6834190">,</span>&nbsp;<span class="ident" id="6834192">test</span><span class="op" id="6834196">.</span><span class="ident" id="6834197">name</span><span class="op" id="6834201">,</span>&nbsp;<span class="ident" id="6834203">cert</span><span class="op" id="6834207">.</span><span class="ident" id="6834208">Issuer</span><span class="op" id="6834214">.</span><span class="ident" id="6834215">CommonName</span><span class="op" id="6834225">,</span>&nbsp;<span class="ident" id="6834227">commonName</span><span class="op" id="6834237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6834241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6834246">if</span>&nbsp;<span class="ident" id="6834249">cert</span><span class="op" id="6834253">.</span><span class="ident" id="6834254">SignatureAlgorithm</span>&nbsp;<span class="op" id="6834273">!=</span>&nbsp;<span class="ident" id="6834276">test</span><span class="op" id="6834280">.</span><span class="ident" id="6834281">sigAlgo</span>&nbsp;<span class="op" id="6834289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6834294">t</span><span class="op" id="6834295">.</span><span class="ident" id="6834296">Errorf</span><span class="op" id="6834302">(</span><span class="string" id="6834303">&#34;%s:&nbsp;SignatureAlgorithm&nbsp;wasn&#39;t&nbsp;copied&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6834372">,</span>&nbsp;<span class="ident" id="6834374">test</span><span class="op" id="6834378">.</span><span class="ident" id="6834379">name</span><span class="op" id="6834383">,</span>&nbsp;<span class="ident" id="6834385">cert</span><span class="op" id="6834389">.</span><span class="ident" id="6834390">SignatureAlgorithm</span><span class="op" id="6834408">,</span>&nbsp;<span class="ident" id="6834410">test</span><span class="op" id="6834414">.</span><span class="ident" id="6834415">sigAlgo</span><span class="op" id="6834422">)</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6834426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6834431">if</span>&nbsp;<span class="op" id="6834434">!</span><span class="ident" id="6834435">reflect</span><span class="op" id="6834442">.</span><span class="ident" id="6834443">DeepEqual</span><span class="op" id="6834452">(</span><span class="ident" id="6834453">cert</span><span class="op" id="6834457">.</span><span class="ident" id="6834458">ExtKeyUsage</span><span class="op" id="6834469">,</span>&nbsp;<span class="ident" id="6834471">testExtKeyUsage</span><span class="op" id="6834486">)</span>&nbsp;<span class="op" id="6834488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6834493">t</span><span class="op" id="6834494">.</span><span class="ident" id="6834495">Errorf</span><span class="op" id="6834501">(</span><span class="string" id="6834502">&#34;%s:&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6834578">,</span>&nbsp;<span class="ident" id="6834580">test</span><span class="op" id="6834584">.</span><span class="ident" id="6834585">name</span><span class="op" id="6834589">,</span>&nbsp;<span class="ident" id="6834591">cert</span><span class="op" id="6834595">.</span><span class="ident" id="6834596">ExtKeyUsage</span><span class="op" id="6834607">,</span>&nbsp;<span class="ident" id="6834609">testExtKeyUsage</span><span class="op" id="6834624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6834628">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6834633">if</span>&nbsp;<span class="op" id="6834636">!</span><span class="ident" id="6834637">reflect</span><span class="op" id="6834644">.</span><span class="ident" id="6834645">DeepEqual</span><span class="op" id="6834654">(</span><span class="ident" id="6834655">cert</span><span class="op" id="6834659">.</span><span class="ident" id="6834660">UnknownExtKeyUsage</span><span class="op" id="6834678">,</span>&nbsp;<span class="ident" id="6834680">testUnknownExtKeyUsage</span><span class="op" id="6834702">)</span>&nbsp;<span class="op" id="6834704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6834709">t</span><span class="op" id="6834710">.</span><span class="ident" id="6834711">Errorf</span><span class="op" id="6834717">(</span><span class="string" id="6834718">&#34;%s:&nbsp;unknown&nbsp;extkeyusage&nbsp;wasn&#39;t&nbsp;correctly&nbsp;copied&nbsp;from&nbsp;the&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6834802">,</span>&nbsp;<span class="ident" id="6834804">test</span><span class="op" id="6834808">.</span><span class="ident" id="6834809">name</span><span class="op" id="6834813">,</span>&nbsp;<span class="ident" id="6834815">cert</span><span class="op" id="6834819">.</span><span class="ident" id="6834820">UnknownExtKeyUsage</span><span class="op" id="6834838">,</span>&nbsp;<span class="ident" id="6834840">testUnknownExtKeyUsage</span><span class="op" id="6834862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6834866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6834871">if</span>&nbsp;<span class="op" id="6834874">!</span><span class="ident" id="6834875">reflect</span><span class="op" id="6834882">.</span><span class="ident" id="6834883">DeepEqual</span><span class="op" id="6834892">(</span><span class="ident" id="6834893">cert</span><span class="op" id="6834897">.</span><span class="ident" id="6834898">OCSPServer</span><span class="op" id="6834908">,</span>&nbsp;<span class="ident" id="6834910">template</span><span class="op" id="6834918">.</span><span class="ident" id="6834919">OCSPServer</span><span class="op" id="6834929">)</span>&nbsp;<span class="op" id="6834931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6834936">t</span><span class="op" id="6834937">.</span><span class="ident" id="6834938">Errorf</span><span class="op" id="6834944">(</span><span class="string" id="6834945">&#34;%s:&nbsp;OCSP&nbsp;servers&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6835001">,</span>&nbsp;<span class="ident" id="6835003">test</span><span class="op" id="6835007">.</span><span class="ident" id="6835008">name</span><span class="op" id="6835012">,</span>&nbsp;<span class="ident" id="6835014">cert</span><span class="op" id="6835018">.</span><span class="ident" id="6835019">OCSPServer</span><span class="op" id="6835029">,</span>&nbsp;<span class="ident" id="6835031">template</span><span class="op" id="6835039">.</span><span class="ident" id="6835040">OCSPServer</span><span class="op" id="6835050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6835054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6835059">if</span>&nbsp;<span class="op" id="6835062">!</span><span class="ident" id="6835063">reflect</span><span class="op" id="6835070">.</span><span class="ident" id="6835071">DeepEqual</span><span class="op" id="6835080">(</span><span class="ident" id="6835081">cert</span><span class="op" id="6835085">.</span><span class="ident" id="6835086">IssuingCertificateURL</span><span class="op" id="6835107">,</span>&nbsp;<span class="ident" id="6835109">template</span><span class="op" id="6835117">.</span><span class="ident" id="6835118">IssuingCertificateURL</span><span class="op" id="6835139">)</span>&nbsp;<span class="op" id="6835141">{</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6835146">t</span><span class="op" id="6835147">.</span><span class="ident" id="6835148">Errorf</span><span class="op" id="6835154">(</span><span class="string" id="6835155">&#34;%s:&nbsp;Issuing&nbsp;certificate&nbsp;URLs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6835223">,</span>&nbsp;<span class="ident" id="6835225">test</span><span class="op" id="6835229">.</span><span class="ident" id="6835230">name</span><span class="op" id="6835234">,</span>&nbsp;<span class="ident" id="6835236">cert</span><span class="op" id="6835240">.</span><span class="ident" id="6835241">IssuingCertificateURL</span><span class="op" id="6835262">,</span>&nbsp;<span class="ident" id="6835264">template</span><span class="op" id="6835272">.</span><span class="ident" id="6835273">IssuingCertificateURL</span><span class="op" id="6835294">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6835298">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6835303">if</span>&nbsp;<span class="op" id="6835306">!</span><span class="ident" id="6835307">reflect</span><span class="op" id="6835314">.</span><span class="ident" id="6835315">DeepEqual</span><span class="op" id="6835324">(</span><span class="ident" id="6835325">cert</span><span class="op" id="6835329">.</span><span class="ident" id="6835330">DNSNames</span><span class="op" id="6835338">,</span>&nbsp;<span class="ident" id="6835340">template</span><span class="op" id="6835348">.</span><span class="ident" id="6835349">DNSNames</span><span class="op" id="6835357">)</span>&nbsp;<span class="op" id="6835359">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6835364">t</span><span class="op" id="6835365">.</span><span class="ident" id="6835366">Errorf</span><span class="op" id="6835372">(</span><span class="string" id="6835373">&#34;%s:&nbsp;SAN&nbsp;DNS&nbsp;names&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6835430">,</span>&nbsp;<span class="ident" id="6835432">test</span><span class="op" id="6835436">.</span><span class="ident" id="6835437">name</span><span class="op" id="6835441">,</span>&nbsp;<span class="ident" id="6835443">cert</span><span class="op" id="6835447">.</span><span class="ident" id="6835448">DNSNames</span><span class="op" id="6835456">,</span>&nbsp;<span class="ident" id="6835458">template</span><span class="op" id="6835466">.</span><span class="ident" id="6835467">DNSNames</span><span class="op" id="6835475">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6835479">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6835484">if</span>&nbsp;<span class="op" id="6835487">!</span><span class="ident" id="6835488">reflect</span><span class="op" id="6835495">.</span><span class="ident" id="6835496">DeepEqual</span><span class="op" id="6835505">(</span><span class="ident" id="6835506">cert</span><span class="op" id="6835510">.</span><span class="ident" id="6835511">EmailAddresses</span><span class="op" id="6835525">,</span>&nbsp;<span class="ident" id="6835527">template</span><span class="op" id="6835535">.</span><span class="ident" id="6835536">EmailAddresses</span><span class="op" id="6835550">)</span>&nbsp;<span class="op" id="6835552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6835557">t</span><span class="op" id="6835558">.</span><span class="ident" id="6835559">Errorf</span><span class="op" id="6835565">(</span><span class="string" id="6835566">&#34;%s:&nbsp;SAN&nbsp;emails&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6835620">,</span>&nbsp;<span class="ident" id="6835622">test</span><span class="op" id="6835626">.</span><span class="ident" id="6835627">name</span><span class="op" id="6835631">,</span>&nbsp;<span class="ident" id="6835633">cert</span><span class="op" id="6835637">.</span><span class="ident" id="6835638">EmailAddresses</span><span class="op" id="6835652">,</span>&nbsp;<span class="ident" id="6835654">template</span><span class="op" id="6835662">.</span><span class="ident" id="6835663">EmailAddresses</span><span class="op" id="6835677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6835681">}</span><br>
<span class="lineno">425</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6835686">if</span>&nbsp;<span class="op" id="6835689">!</span><span class="ident" id="6835690">reflect</span><span class="op" id="6835697">.</span><span class="ident" id="6835698">DeepEqual</span><span class="op" id="6835707">(</span><span class="ident" id="6835708">cert</span><span class="op" id="6835712">.</span><span class="ident" id="6835713">IPAddresses</span><span class="op" id="6835724">,</span>&nbsp;<span class="ident" id="6835726">template</span><span class="op" id="6835734">.</span><span class="ident" id="6835735">IPAddresses</span><span class="op" id="6835746">)</span>&nbsp;<span class="op" id="6835748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6835753">t</span><span class="op" id="6835754">.</span><span class="ident" id="6835755">Errorf</span><span class="op" id="6835761">(</span><span class="string" id="6835762">&#34;%s:&nbsp;SAN&nbsp;IPs&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6835813">,</span>&nbsp;<span class="ident" id="6835815">test</span><span class="op" id="6835819">.</span><span class="ident" id="6835820">name</span><span class="op" id="6835824">,</span>&nbsp;<span class="ident" id="6835826">cert</span><span class="op" id="6835830">.</span><span class="ident" id="6835831">IPAddresses</span><span class="op" id="6835842">,</span>&nbsp;<span class="ident" id="6835844">template</span><span class="op" id="6835852">.</span><span class="ident" id="6835853">IPAddresses</span><span class="op" id="6835864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6835868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6835873">if</span>&nbsp;<span class="op" id="6835876">!</span><span class="ident" id="6835877">reflect</span><span class="op" id="6835884">.</span><span class="ident" id="6835885">DeepEqual</span><span class="op" id="6835894">(</span><span class="ident" id="6835895">cert</span><span class="op" id="6835899">.</span><span class="ident" id="6835900">CRLDistributionPoints</span><span class="op" id="6835921">,</span>&nbsp;<span class="ident" id="6835923">template</span><span class="op" id="6835931">.</span><span class="ident" id="6835932">CRLDistributionPoints</span><span class="op" id="6835953">)</span>&nbsp;<span class="op" id="6835955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6835960">t</span><span class="op" id="6835961">.</span><span class="ident" id="6835962">Errorf</span><span class="op" id="6835968">(</span><span class="string" id="6835969">&#34;%s:&nbsp;CRL&nbsp;distribution&nbsp;points&nbsp;differ&nbsp;from&nbsp;template.&nbsp;Got&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6836036">,</span>&nbsp;<span class="ident" id="6836038">test</span><span class="op" id="6836042">.</span><span class="ident" id="6836043">name</span><span class="op" id="6836047">,</span>&nbsp;<span class="ident" id="6836049">cert</span><span class="op" id="6836053">.</span><span class="ident" id="6836054">CRLDistributionPoints</span><span class="op" id="6836075">,</span>&nbsp;<span class="ident" id="6836077">template</span><span class="op" id="6836085">.</span><span class="ident" id="6836086">CRLDistributionPoints</span><span class="op" id="6836107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6836111">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6836116">if</span>&nbsp;<span class="op" id="6836119">!</span><span class="ident" id="6836120">bytes</span><span class="op" id="6836125">.</span><span class="ident" id="6836126">Equal</span><span class="op" id="6836131">(</span><span class="ident" id="6836132">cert</span><span class="op" id="6836136">.</span><span class="ident" id="6836137">SubjectKeyId</span><span class="op" id="6836149">,</span>&nbsp;<span class="op" id="6836151">[</span><span class="op" id="6836152">]</span><span class="builtintype" id="6836153">byte</span><span class="op" id="6836157">{</span><span class="num" id="6836158">4</span><span class="op" id="6836159">,</span>&nbsp;<span class="num" id="6836161">3</span><span class="op" id="6836162">,</span>&nbsp;<span class="num" id="6836164">2</span><span class="op" id="6836165">,</span>&nbsp;<span class="num" id="6836167">1</span><span class="op" id="6836168">}</span><span class="op" id="6836169">)</span>&nbsp;<span class="op" id="6836171">{</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6836176">t</span><span class="op" id="6836177">.</span><span class="ident" id="6836178">Errorf</span><span class="op" id="6836184">(</span><span class="string" id="6836185">&#34;%s:&nbsp;ExtraExtensions&nbsp;didn&#39;t&nbsp;override&nbsp;SubjectKeyId&#34;</span><span class="op" id="6836235">,</span>&nbsp;<span class="ident" id="6836237">test</span><span class="op" id="6836241">.</span><span class="ident" id="6836242">name</span><span class="op" id="6836246">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6836250">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6836255">if</span>&nbsp;<span class="ident" id="6836258">bytes</span><span class="op" id="6836263">.</span><span class="ident" id="6836264">Index</span><span class="op" id="6836269">(</span><span class="ident" id="6836270">derBytes</span><span class="op" id="6836278">,</span>&nbsp;<span class="ident" id="6836280">extraExtensionData</span><span class="op" id="6836298">)</span>&nbsp;<span class="op" id="6836300">==</span>&nbsp;<span class="op" id="6836303">-</span><span class="num" id="6836304">1</span>&nbsp;<span class="op" id="6836306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6836311">t</span><span class="op" id="6836312">.</span><span class="ident" id="6836313">Errorf</span><span class="op" id="6836319">(</span><span class="string" id="6836320">&#34;%s:&nbsp;didn&#39;t&nbsp;find&nbsp;extra&nbsp;extension&nbsp;in&nbsp;DER&nbsp;output&#34;</span><span class="op" id="6836367">,</span>&nbsp;<span class="ident" id="6836369">test</span><span class="op" id="6836373">.</span><span class="ident" id="6836374">name</span><span class="op" id="6836378">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6836382">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6836387">if</span>&nbsp;<span class="ident" id="6836390">test</span><span class="op" id="6836394">.</span><span class="ident" id="6836395">checkSig</span>&nbsp;<span class="op" id="6836404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6836409">err</span>&nbsp;<span class="op" id="6836413">=</span>&nbsp;<span class="ident" id="6836415">cert</span><span class="op" id="6836419">.</span><span class="ident" id="6836420">CheckSignatureFrom</span><span class="op" id="6836438">(</span><span class="ident" id="6836439">cert</span><span class="op" id="6836443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6836448">if</span>&nbsp;<span class="ident" id="6836451">err</span>&nbsp;<span class="op" id="6836455">!=</span>&nbsp;<span class="ident" id="6836458">nil</span>&nbsp;<span class="op" id="6836462">{</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6836468">t</span><span class="op" id="6836469">.</span><span class="ident" id="6836470">Errorf</span><span class="op" id="6836476">(</span><span class="string" id="6836477">&#34;%s:&nbsp;signature&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="6836516">,</span>&nbsp;<span class="ident" id="6836518">test</span><span class="op" id="6836522">.</span><span class="ident" id="6836523">name</span><span class="op" id="6836527">,</span>&nbsp;<span class="ident" id="6836529">err</span><span class="op" id="6836532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6836537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6836541">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6836544">}</span><br>
<span class="lineno"></span><span class="op" id="6836546">}</span><br>
<span class="lineno">450</span><br>
<span class="lineno"></span><span class="comment" id="6836549">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA1&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno"></span><span class="keyword" id="6836610">var</span>&nbsp;<span class="ident" id="6836614">ecdsaSHA1CertPem</span>&nbsp;<span class="op" id="6836631">=</span>&nbsp;<span class="string" id="6836633">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDjCCAbUCCQDF6SfN0nsnrjAJBgcqhkjOPQQBMIGPMQswCQYDVQQGEwJVUzET<br>
<span class="lineno">455</span>MBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwNTW91bnRhaW4gVmlldzEVMBMG<br>
<span class="lineno"></span>A1UECgwMR29vZ2xlLCBJbmMuMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIwMjAyMDUw<br>
<span class="lineno"></span>WhcNMjIwNTE4MjAyMDUwWjCBjzELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTATBgNVBAoMDEdvb2dsZSwg<br>
<span class="lineno">460</span>SW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAhBgkqhkiG9w0BCQEWFGdv<br>
<span class="lineno"></span>bGFuZy1kZXZAZ21haWwuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE/Wgn<br>
<span class="lineno"></span>WQDo5+bz71T0327ERgd5SDDXFbXLpzIZDXTkjpe8QTEbsF+ezsQfrekrpDPC4Cd3<br>
<span class="lineno"></span>P9LY0tG+aI8IyVKdUjAJBgcqhkjOPQQBA0gAMEUCIGlsqMcRqWVIWTD6wXwe6Jk2<br>
<span class="lineno"></span>DKxL46r/FLgJYnzBEH99AiEA3fBouObsvV1R3oVkb4BQYnD4/4LeId6lAT43YvyV<br>
<span class="lineno">465</span>a/A=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6837412">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp256r1</span><br>
<span class="lineno">470</span><span class="keyword" id="6837475">var</span>&nbsp;<span class="ident" id="6837479">ecdsaSHA256p256CertPem</span>&nbsp;<span class="op" id="6837502">=</span>&nbsp;<span class="string" id="6837504">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICDzCCAbYCCQDlsuMWvgQzhTAKBggqhkjOPQQDAjCBjzELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFTAT<br>
<span class="lineno"></span>BgNVBAoMDEdvb2dsZSwgSW5jLjEXMBUGA1UEAwwOd3d3Lmdvb2dsZS5jb20xIzAh<br>
<span class="lineno">475</span>BgkqhkiG9w0BCQEWFGdvbGFuZy1kZXZAZ21haWwuY29tMB4XDTEyMDUyMTAwMTkx<br>
<span class="lineno"></span>NloXDTIyMDUxOTAwMTkxNlowgY8xCzAJBgNVBAYTAlVTMRMwEQYDVQQIDApDYWxp<br>
<span class="lineno"></span>Zm9ybmlhMRYwFAYDVQQHDA1Nb3VudGFpbiBWaWV3MRUwEwYDVQQKDAxHb29nbGUs<br>
<span class="lineno"></span>IEluYy4xFzAVBgNVBAMMDnd3dy5nb29nbGUuY29tMSMwIQYJKoZIhvcNAQkBFhRn<br>
<span class="lineno"></span>b2xhbmctZGV2QGdtYWlsLmNvbTBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABPMt<br>
<span class="lineno">480</span>2ErhxAty5EJRu9yM+MTy+hUXm3pdW1ensAv382KoGExSXAFWP7pjJnNtHO+XSwVm<br>
<span class="lineno"></span>YNtqjcAGFKpweoN//kQwCgYIKoZIzj0EAwIDRwAwRAIgIYSaUA/IB81gjbIw/hUV<br>
<span class="lineno"></span>70twxJr5EcgOo0hLp3Jm+EYCIFDO3NNcgmURbJ1kfoS3N/0O+irUtoPw38YoNkqJ<br>
<span class="lineno"></span>h5wi<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno">485</span>`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6838283">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA256&nbsp;&amp;&nbsp;secp384r1</span><br>
<span class="lineno"></span><span class="keyword" id="6838346">var</span>&nbsp;<span class="ident" id="6838350">ecdsaSHA256p384CertPem</span>&nbsp;<span class="op" id="6838373">=</span>&nbsp;<span class="string" id="6838375">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno">490</span>MIICSjCCAdECCQDje/no7mXkVzAKBggqhkjOPQQDAjCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno"></span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMDYxMDM0<br>
<span class="lineno"></span>WhcNMjIwNTE5MDYxMDM0WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno">495</span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno"></span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wdjAQBgcqhkjOPQIBBgUrgQQAIgNiAARRuzRNIKRK<br>
<span class="lineno"></span>jIktEmXanNmrTR/q/FaHXLhWRZ6nHWe26Fw7Rsrbk+VjGy4vfWtNn7xSFKrOu5ze<br>
<span class="lineno"></span>qxKnmE0h5E480MNgrUiRkaGO2GMJJVmxx20aqkXOk59U8yGA4CghE6MwCgYIKoZI<br>
<span class="lineno">500</span>zj0EAwIDZwAwZAIwBZEN8gvmRmfeP/9C1PRLzODIY4JqWub2PLRT4mv9GU+yw3Gr<br>
<span class="lineno"></span>PU9A3CHMdEcdw/MEAjBBO1lId8KOCh9UZunsSMfqXiVurpzmhWd6VYZ/32G+M+Mh<br>
<span class="lineno"></span>3yILeYQzllt/g0rKVRk=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">505</span><br>
<span class="lineno"></span><span class="comment" id="6839235">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;ECDSA&nbsp;with&nbsp;SHA384&nbsp;&amp;&nbsp;secp521r1</span><br>
<span class="lineno"></span><span class="keyword" id="6839298">var</span>&nbsp;<span class="ident" id="6839302">ecdsaSHA384p521CertPem</span>&nbsp;<span class="op" id="6839325">=</span>&nbsp;<span class="string" id="6839327">`<br>
<span class="lineno"></span>-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIICljCCAfcCCQDhp1AFD/ahKjAKBggqhkjOPQQDAzCBjjELMAkGA1UEBhMCVVMx<br>
<span class="lineno">510</span>EzARBgNVBAgMCkNhbGlmb3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDAS<br>
<span class="lineno"></span>BgNVBAoMC0dvb2dsZSwgSW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEG<br>
<span class="lineno"></span>CSqGSIb3DQEJARYUZ29sYW5nLWRldkBnbWFpbC5jb20wHhcNMTIwNTIxMTUwNDI5<br>
<span class="lineno"></span>WhcNMjIwNTE5MTUwNDI5WjCBjjELMAkGA1UEBhMCVVMxEzARBgNVBAgMCkNhbGlm<br>
<span class="lineno"></span>b3JuaWExFjAUBgNVBAcMDU1vdW50YWluIFZpZXcxFDASBgNVBAoMC0dvb2dsZSwg<br>
<span class="lineno">515</span>SW5jMRcwFQYDVQQDDA53d3cuZ29vZ2xlLmNvbTEjMCEGCSqGSIb3DQEJARYUZ29s<br>
<span class="lineno"></span>YW5nLWRldkBnbWFpbC5jb20wgZswEAYHKoZIzj0CAQYFK4EEACMDgYYABACqx9Rv<br>
<span class="lineno"></span>IssRs1LWYcNN+WffwlHw4Tv3y8/LIAA9MF1ZScIonU9nRMxt4a2uGJVCPDw6JHpz<br>
<span class="lineno"></span>PaYc0E9puLoE9AfKpwFr59Jkot7dBg55SKPEFkddoip/rvmN7NPAWjMBirOwjOkm<br>
<span class="lineno"></span>8FPthvPhGPqsu9AvgVuHu3PosWiHGNrhh379pva8MzAKBggqhkjOPQQDAwOBjAAw<br>
<span class="lineno">520</span>gYgCQgEHNmswkUdPpHqrVxp9PvLVl+xxPuHBkT+75z9JizyxtqykHQo9Uh6SWCYH<br>
<span class="lineno"></span>BF9KLolo01wMt8DjoYP5Fb3j5MH7xwJCAbWZzTOp4l4DPkIvAh4LeC4VWbwPPyqh<br>
<span class="lineno"></span>kBg71w/iEcSY3wUKgHGcJJrObZw7wys91I5kENljqw/Samdr3ka+jBJa<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span><span class="keyword" id="6840288">var</span>&nbsp;<span class="ident" id="6840292">ecdsaTests</span>&nbsp;<span class="op" id="6840303">=</span>&nbsp;<span class="op" id="6840305">[</span><span class="op" id="6840306">]</span><span class="keyword" id="6840307">struct</span>&nbsp;<span class="op" id="6840314">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6840317">sigAlgo</span>&nbsp;<span class="ident" id="6840325">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6840345">pemCert</span>&nbsp;<span class="builtintype" id="6840353">string</span><br>
<span class="lineno"></span><span class="op" id="6840360">}</span><span class="op" id="6840361">{</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6840364">{</span><span class="ident" id="6840365">ECDSAWithSHA1</span><span class="op" id="6840378">,</span>&nbsp;<span class="ident" id="6840380">ecdsaSHA1CertPem</span><span class="op" id="6840396">}</span><span class="op" id="6840397">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6840400">{</span><span class="ident" id="6840401">ECDSAWithSHA256</span><span class="op" id="6840416">,</span>&nbsp;<span class="ident" id="6840418">ecdsaSHA256p256CertPem</span><span class="op" id="6840440">}</span><span class="op" id="6840441">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6840444">{</span><span class="ident" id="6840445">ECDSAWithSHA256</span><span class="op" id="6840460">,</span>&nbsp;<span class="ident" id="6840462">ecdsaSHA256p384CertPem</span><span class="op" id="6840484">}</span><span class="op" id="6840485">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6840488">{</span><span class="ident" id="6840489">ECDSAWithSHA384</span><span class="op" id="6840504">,</span>&nbsp;<span class="ident" id="6840506">ecdsaSHA384p521CertPem</span><span class="op" id="6840528">}</span><span class="op" id="6840529">,</span><br>
<span class="lineno"></span><span class="op" id="6840531">}</span><br>
<span class="lineno">535</span><br>
<span class="lineno"></span><span class="keyword" id="6840534">func</span>&nbsp;<span class="ident" id="6840539">TestECDSA</span><span class="op" id="6840548">(</span><span class="ident" id="6840549">t</span>&nbsp;<span class="op" id="6840551">*</span><span class="ident" id="6840552">testing</span><span class="op" id="6840559">.</span><span class="ident" id="6840560">T</span><span class="op" id="6840561">)</span>&nbsp;<span class="op" id="6840563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6840566">for</span>&nbsp;<span class="ident" id="6840570">i</span><span class="op" id="6840571">,</span>&nbsp;<span class="ident" id="6840573">test</span>&nbsp;<span class="op" id="6840578">:=</span>&nbsp;<span class="keyword" id="6840581">range</span>&nbsp;<span class="ident" id="6840587">ecdsaTests</span>&nbsp;<span class="op" id="6840598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6840602">pemBlock</span><span class="op" id="6840610">,</span>&nbsp;<span class="ident" id="6840612">_</span>&nbsp;<span class="op" id="6840614">:=</span>&nbsp;<span class="ident" id="6840617">pem</span><span class="op" id="6840620">.</span><span class="ident" id="6840621">Decode</span><span class="op" id="6840627">(</span><span class="op" id="6840628">[</span><span class="op" id="6840629">]</span><span class="builtintype" id="6840630">byte</span><span class="op" id="6840634">(</span><span class="ident" id="6840635">test</span><span class="op" id="6840639">.</span><span class="ident" id="6840640">pemCert</span><span class="op" id="6840647">)</span><span class="op" id="6840648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6840652">cert</span><span class="op" id="6840656">,</span>&nbsp;<span class="ident" id="6840658">err</span>&nbsp;<span class="op" id="6840662">:=</span>&nbsp;<span class="ident" id="6840665">ParseCertificate</span><span class="op" id="6840681">(</span><span class="ident" id="6840682">pemBlock</span><span class="op" id="6840690">.</span><span class="ident" id="6840691">Bytes</span><span class="op" id="6840696">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6840700">if</span>&nbsp;<span class="ident" id="6840703">err</span>&nbsp;<span class="op" id="6840707">!=</span>&nbsp;<span class="ident" id="6840710">nil</span>&nbsp;<span class="op" id="6840714">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6840719">t</span><span class="op" id="6840720">.</span><span class="ident" id="6840721">Errorf</span><span class="op" id="6840727">(</span><span class="string" id="6840728">&#34;%d:&nbsp;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6840765">,</span>&nbsp;<span class="ident" id="6840767">i</span><span class="op" id="6840768">,</span>&nbsp;<span class="ident" id="6840770">err</span><span class="op" id="6840773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6840778">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6840789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6840793">if</span>&nbsp;<span class="ident" id="6840796">sa</span>&nbsp;<span class="op" id="6840799">:=</span>&nbsp;<span class="ident" id="6840802">cert</span><span class="op" id="6840806">.</span><span class="ident" id="6840807">SignatureAlgorithm</span><span class="op" id="6840825">;</span>&nbsp;<span class="ident" id="6840827">sa</span>&nbsp;<span class="op" id="6840830">!=</span>&nbsp;<span class="ident" id="6840833">test</span><span class="op" id="6840837">.</span><span class="ident" id="6840838">sigAlgo</span>&nbsp;<span class="op" id="6840846">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6840851">t</span><span class="op" id="6840852">.</span><span class="ident" id="6840853">Errorf</span><span class="op" id="6840859">(</span><span class="string" id="6840860">&#34;%d:&nbsp;signature&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6840900">,</span>&nbsp;<span class="ident" id="6840902">i</span><span class="op" id="6840903">,</span>&nbsp;<span class="ident" id="6840905">sa</span><span class="op" id="6840907">,</span>&nbsp;<span class="ident" id="6840909">test</span><span class="op" id="6840913">.</span><span class="ident" id="6840914">sigAlgo</span><span class="op" id="6840921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6840925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6840929">if</span>&nbsp;<span class="ident" id="6840932">parsedKey</span><span class="op" id="6840941">,</span>&nbsp;<span class="ident" id="6840943">ok</span>&nbsp;<span class="op" id="6840946">:=</span>&nbsp;<span class="ident" id="6840949">cert</span><span class="op" id="6840953">.</span><span class="ident" id="6840954">PublicKey</span><span class="op" id="6840963">.</span><span class="op" id="6840964">(</span><span class="op" id="6840965">*</span><span class="ident" id="6840966">ecdsa</span><span class="op" id="6840971">.</span><span class="ident" id="6840972">PublicKey</span><span class="op" id="6840981">)</span><span class="op" id="6840982">;</span>&nbsp;<span class="op" id="6840984">!</span><span class="ident" id="6840985">ok</span>&nbsp;<span class="op" id="6840988">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6840993">t</span><span class="op" id="6840994">.</span><span class="ident" id="6840995">Errorf</span><span class="op" id="6841001">(</span><span class="string" id="6841002">&#34;%d:&nbsp;wanted&nbsp;an&nbsp;ECDSA&nbsp;public&nbsp;key&nbsp;but&nbsp;found:&nbsp;%#v&#34;</span><span class="op" id="6841049">,</span>&nbsp;<span class="ident" id="6841051">i</span><span class="op" id="6841052">,</span>&nbsp;<span class="ident" id="6841054">parsedKey</span><span class="op" id="6841063">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6841067">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6841071">if</span>&nbsp;<span class="ident" id="6841074">pka</span>&nbsp;<span class="op" id="6841078">:=</span>&nbsp;<span class="ident" id="6841081">cert</span><span class="op" id="6841085">.</span><span class="ident" id="6841086">PublicKeyAlgorithm</span><span class="op" id="6841104">;</span>&nbsp;<span class="ident" id="6841106">pka</span>&nbsp;<span class="op" id="6841110">!=</span>&nbsp;<span class="ident" id="6841113">ECDSA</span>&nbsp;<span class="op" id="6841119">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6841124">t</span><span class="op" id="6841125">.</span><span class="ident" id="6841126">Errorf</span><span class="op" id="6841132">(</span><span class="string" id="6841133">&#34;%d:&nbsp;public&nbsp;key&nbsp;algorithm&nbsp;is&nbsp;%v,&nbsp;want&nbsp;ECDSA&#34;</span><span class="op" id="6841177">,</span>&nbsp;<span class="ident" id="6841179">i</span><span class="op" id="6841180">,</span>&nbsp;<span class="ident" id="6841182">pka</span><span class="op" id="6841185">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6841189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6841193">if</span>&nbsp;<span class="ident" id="6841196">err</span>&nbsp;<span class="op" id="6841200">=</span>&nbsp;<span class="ident" id="6841202">cert</span><span class="op" id="6841206">.</span><span class="ident" id="6841207">CheckSignatureFrom</span><span class="op" id="6841225">(</span><span class="ident" id="6841226">cert</span><span class="op" id="6841230">)</span><span class="op" id="6841231">;</span>&nbsp;<span class="ident" id="6841233">err</span>&nbsp;<span class="op" id="6841237">!=</span>&nbsp;<span class="ident" id="6841240">nil</span>&nbsp;<span class="op" id="6841244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6841249">t</span><span class="op" id="6841250">.</span><span class="ident" id="6841251">Errorf</span><span class="op" id="6841257">(</span><span class="string" id="6841258">&#34;%d:&nbsp;certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="6841299">,</span>&nbsp;<span class="ident" id="6841301">i</span><span class="op" id="6841302">,</span>&nbsp;<span class="ident" id="6841304">err</span><span class="op" id="6841307">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6841311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6841314">}</span><br>
<span class="lineno"></span><span class="op" id="6841316">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6841319">//&nbsp;Self-signed&nbsp;certificate&nbsp;using&nbsp;DSA&nbsp;with&nbsp;SHA1</span><br>
<span class="lineno">560</span><span class="keyword" id="6841366">var</span>&nbsp;<span class="ident" id="6841370">dsaCertPem</span>&nbsp;<span class="op" id="6841381">=</span>&nbsp;<span class="string" id="6841383">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIEDTCCA82gAwIBAgIJALHPghaoxeDhMAkGByqGSM44BAMweTELMAkGA1UEBhMC<br>
<span class="lineno"></span>VVMxCzAJBgNVBAgTAk5DMQ8wDQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2ds<br>
<span class="lineno"></span>ZSwgSW5jMRIwEAYDVQQDEwlKb24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFs<br>
<span class="lineno"></span>bGllQGdvb2dsZS5jb20wHhcNMTEwNTE0MDMwMTQ1WhcNMTEwNjEzMDMwMTQ1WjB5<br>
<span class="lineno">565</span>MQswCQYDVQQGEwJVUzELMAkGA1UECBMCTkMxDzANBgNVBAcTBk5ld3RvbjEUMBIG<br>
<span class="lineno"></span>A1UEChMLR29vZ2xlLCBJbmMxEjAQBgNVBAMTCUpvbiBBbGxpZTEiMCAGCSqGSIb3<br>
<span class="lineno"></span>DQEJARYTam9uYWxsaWVAZ29vZ2xlLmNvbTCCAbcwggEsBgcqhkjOOAQBMIIBHwKB<br>
<span class="lineno"></span>gQC8hLUnQ7FpFYu4WXTj6DKvXvz8QrJkNJCVMTpKAT7uBpobk32S5RrPKXocd4gN<br>
<span class="lineno"></span>8lyGB9ggS03EVlEwXvSmO0DH2MQtke2jl9j1HLydClMf4sbx5V6TV9IFw505U1iW<br>
<span class="lineno">570</span>jL7awRMgxge+FsudtJK254FjMFo03ZnOQ8ZJJ9E6AEDrlwIVAJpnBn9moyP11Ox5<br>
<span class="lineno"></span>Asc/5dnjb6dPAoGBAJFHd4KVv1iTVCvEG6gGiYop5DJh28hUQcN9kul+2A0yPUSC<br>
<span class="lineno"></span>X93oN00P8Vh3eYgSaCWZsha7zDG53MrVJ0Zf6v/X/CoZNhLldeNOepivTRAzn+Rz<br>
<span class="lineno"></span>kKUYy5l1sxYLHQKF0UGNCXfFKZT0PCmgU+PWhYNBBMn6/cIh44vp85ideo5CA4GE<br>
<span class="lineno"></span>AAKBgFmifCafzeRaohYKXJgMGSEaggCVCRq5xdyDCat+wbOkjC4mfG01/um3G8u5<br>
<span class="lineno">575</span>LxasjlWRKTR/tcAL7t0QuokVyQaYdVypZXNaMtx1db7YBuHjj3aP+8JOQRI9xz8c<br>
<span class="lineno"></span>bp5NDJ5pISiFOv4p3GZfqZPcqckDt78AtkQrmnal2txhhjF6o4HeMIHbMB0GA1Ud<br>
<span class="lineno"></span>DgQWBBQVyyr7hO11ZFFpWX50298Sa3V+rzCBqwYDVR0jBIGjMIGggBQVyyr7hO11<br>
<span class="lineno"></span>ZFFpWX50298Sa3V+r6F9pHsweTELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAk5DMQ8w<br>
<span class="lineno"></span>DQYDVQQHEwZOZXd0b24xFDASBgNVBAoTC0dvb2dsZSwgSW5jMRIwEAYDVQQDEwlK<br>
<span class="lineno">580</span>b24gQWxsaWUxIjAgBgkqhkiG9w0BCQEWE2pvbmFsbGllQGdvb2dsZS5jb22CCQCx<br>
<span class="lineno"></span>z4IWqMXg4TAMBgNVHRMEBTADAQH/MAkGByqGSM44BAMDLwAwLAIUPtn/5j8Q1jJI<br>
<span class="lineno"></span>7ggOIsgrhgUdjGQCFCsmDq1H11q9+9Wp9IMeGrTSKHIM<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>`</span><br>
<span class="lineno">585</span><br>
<span class="lineno"></span><span class="keyword" id="6842851">func</span>&nbsp;<span class="ident" id="6842856">TestParseCertificateWithDsaPublicKey</span><span class="op" id="6842892">(</span><span class="ident" id="6842893">t</span>&nbsp;<span class="op" id="6842895">*</span><span class="ident" id="6842896">testing</span><span class="op" id="6842903">.</span><span class="ident" id="6842904">T</span><span class="op" id="6842905">)</span>&nbsp;<span class="op" id="6842907">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6842910">expectedKey</span>&nbsp;<span class="op" id="6842922">:=</span>&nbsp;<span class="op" id="6842925">&amp;</span><span class="ident" id="6842926">dsa</span><span class="op" id="6842929">.</span><span class="ident" id="6842930">PublicKey</span><span class="op" id="6842939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6842943">Parameters</span><span class="op" id="6842953">:</span>&nbsp;<span class="ident" id="6842955">dsa</span><span class="op" id="6842958">.</span><span class="ident" id="6842959">Parameters</span><span class="op" id="6842969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6842974">P</span><span class="op" id="6842975">:</span>&nbsp;<span class="ident" id="6842977">bigFromHexString</span><span class="op" id="6842993">(</span><span class="string" id="6842994">&#34;00BC84B52743B169158BB85974E3E832AF5EFCFC42B264349095313A4A013EEE069A1B937D92E51ACF297A1C77880DF25C8607D8204B4DC45651305EF4A63B40C7D8C42D91EDA397D8F51CBC9D0A531FE2C6F1E55E9357D205C39D395358968CBEDAC11320C607BE16CB9DB492B6E78163305A34DD99CE43C64927D13A0040EB97&#34;</span><span class="op" id="6843254">)</span><span class="op" id="6843255">,</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6843260">Q</span><span class="op" id="6843261">:</span>&nbsp;<span class="ident" id="6843263">bigFromHexString</span><span class="op" id="6843279">(</span><span class="string" id="6843280">&#34;009A67067F66A323F5D4EC7902C73FE5D9E36FA74F&#34;</span><span class="op" id="6843324">)</span><span class="op" id="6843325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6843330">G</span><span class="op" id="6843331">:</span>&nbsp;<span class="ident" id="6843333">bigFromHexString</span><span class="op" id="6843349">(</span><span class="string" id="6843350">&#34;009147778295BF5893542BC41BA806898A29E43261DBC85441C37D92E97ED80D323D44825FDDE8374D0FF15877798812682599B216BBCC31B9DCCAD527465FEAFFD7FC2A193612E575E34E7A98AF4D10339FE47390A518CB9975B3160B1D0285D1418D0977C52994F43C29A053E3D685834104C9FAFDC221E38BE9F3989D7A8E42&#34;</span><span class="op" id="6843610">)</span><span class="op" id="6843611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6843615">}</span><span class="op" id="6843616">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6843620">Y</span><span class="op" id="6843621">:</span>&nbsp;<span class="ident" id="6843623">bigFromHexString</span><span class="op" id="6843639">(</span><span class="string" id="6843640">&#34;59A27C269FCDE45AA2160A5C980C19211A820095091AB9C5DC8309AB7EC1B3A48C2E267C6D35FEE9B71BCBB92F16AC8E559129347FB5C00BEEDD10BA8915C90698755CA965735A32DC7575BED806E1E38F768FFBC24E41123DC73F1C6E9E4D0C9E692128853AFE29DC665FA993DCA9C903B7BF00B6442B9A76A5DADC6186317A&#34;</span><span class="op" id="6843898">)</span><span class="op" id="6843899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6843902">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6843905">pemBlock</span><span class="op" id="6843913">,</span>&nbsp;<span class="ident" id="6843915">_</span>&nbsp;<span class="op" id="6843917">:=</span>&nbsp;<span class="ident" id="6843920">pem</span><span class="op" id="6843923">.</span><span class="ident" id="6843924">Decode</span><span class="op" id="6843930">(</span><span class="op" id="6843931">[</span><span class="op" id="6843932">]</span><span class="builtintype" id="6843933">byte</span><span class="op" id="6843937">(</span><span class="ident" id="6843938">dsaCertPem</span><span class="op" id="6843948">)</span><span class="op" id="6843949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6843952">cert</span><span class="op" id="6843956">,</span>&nbsp;<span class="ident" id="6843958">err</span>&nbsp;<span class="op" id="6843962">:=</span>&nbsp;<span class="ident" id="6843965">ParseCertificate</span><span class="op" id="6843981">(</span><span class="ident" id="6843982">pemBlock</span><span class="op" id="6843990">.</span><span class="ident" id="6843991">Bytes</span><span class="op" id="6843996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6843999">if</span>&nbsp;<span class="ident" id="6844002">err</span>&nbsp;<span class="op" id="6844006">!=</span>&nbsp;<span class="ident" id="6844009">nil</span>&nbsp;<span class="op" id="6844013">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6844017">t</span><span class="op" id="6844018">.</span><span class="ident" id="6844019">Fatalf</span><span class="op" id="6844025">(</span><span class="string" id="6844026">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6844059">,</span>&nbsp;<span class="ident" id="6844061">err</span><span class="op" id="6844064">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6844067">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6844070">if</span>&nbsp;<span class="ident" id="6844073">cert</span><span class="op" id="6844077">.</span><span class="ident" id="6844078">PublicKeyAlgorithm</span>&nbsp;<span class="op" id="6844097">!=</span>&nbsp;<span class="ident" id="6844100">DSA</span>&nbsp;<span class="op" id="6844104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6844108">t</span><span class="op" id="6844109">.</span><span class="ident" id="6844110">Errorf</span><span class="op" id="6844116">(</span><span class="string" id="6844117">&#34;Parsed&nbsp;key&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSA&#34;</span><span class="op" id="6844151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6844154">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6844157">parsedKey</span><span class="op" id="6844166">,</span>&nbsp;<span class="ident" id="6844168">ok</span>&nbsp;<span class="op" id="6844171">:=</span>&nbsp;<span class="ident" id="6844174">cert</span><span class="op" id="6844178">.</span><span class="ident" id="6844179">PublicKey</span><span class="op" id="6844188">.</span><span class="op" id="6844189">(</span><span class="op" id="6844190">*</span><span class="ident" id="6844191">dsa</span><span class="op" id="6844194">.</span><span class="ident" id="6844195">PublicKey</span><span class="op" id="6844204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6844207">if</span>&nbsp;<span class="op" id="6844210">!</span><span class="ident" id="6844211">ok</span>&nbsp;<span class="op" id="6844214">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6844218">t</span><span class="op" id="6844219">.</span><span class="ident" id="6844220">Fatalf</span><span class="op" id="6844226">(</span><span class="string" id="6844227">&#34;Parsed&nbsp;key&nbsp;was&nbsp;not&nbsp;a&nbsp;DSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6844261">,</span>&nbsp;<span class="ident" id="6844263">err</span><span class="op" id="6844266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6844269">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6844272">if</span>&nbsp;<span class="ident" id="6844275">expectedKey</span><span class="op" id="6844286">.</span><span class="ident" id="6844287">Y</span><span class="op" id="6844288">.</span><span class="ident" id="6844289">Cmp</span><span class="op" id="6844292">(</span><span class="ident" id="6844293">parsedKey</span><span class="op" id="6844302">.</span><span class="ident" id="6844303">Y</span><span class="op" id="6844304">)</span>&nbsp;<span class="op" id="6844306">!=</span>&nbsp;<span class="num" id="6844309">0</span>&nbsp;<span class="op" id="6844311">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6844316">expectedKey</span><span class="op" id="6844327">.</span><span class="ident" id="6844328">P</span><span class="op" id="6844329">.</span><span class="ident" id="6844330">Cmp</span><span class="op" id="6844333">(</span><span class="ident" id="6844334">parsedKey</span><span class="op" id="6844343">.</span><span class="ident" id="6844344">P</span><span class="op" id="6844345">)</span>&nbsp;<span class="op" id="6844347">!=</span>&nbsp;<span class="num" id="6844350">0</span>&nbsp;<span class="op" id="6844352">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6844357">expectedKey</span><span class="op" id="6844368">.</span><span class="ident" id="6844369">Q</span><span class="op" id="6844370">.</span><span class="ident" id="6844371">Cmp</span><span class="op" id="6844374">(</span><span class="ident" id="6844375">parsedKey</span><span class="op" id="6844384">.</span><span class="ident" id="6844385">Q</span><span class="op" id="6844386">)</span>&nbsp;<span class="op" id="6844388">!=</span>&nbsp;<span class="num" id="6844391">0</span>&nbsp;<span class="op" id="6844393">||</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6844398">expectedKey</span><span class="op" id="6844409">.</span><span class="ident" id="6844410">G</span><span class="op" id="6844411">.</span><span class="ident" id="6844412">Cmp</span><span class="op" id="6844415">(</span><span class="ident" id="6844416">parsedKey</span><span class="op" id="6844425">.</span><span class="ident" id="6844426">G</span><span class="op" id="6844427">)</span>&nbsp;<span class="op" id="6844429">!=</span>&nbsp;<span class="num" id="6844432">0</span>&nbsp;<span class="op" id="6844434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6844438">t</span><span class="op" id="6844439">.</span><span class="ident" id="6844440">Fatal</span><span class="op" id="6844445">(</span><span class="string" id="6844446">&#34;Parsed&nbsp;key&nbsp;differs&nbsp;from&nbsp;expected&nbsp;key&#34;</span><span class="op" id="6844484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6844487">}</span><br>
<span class="lineno"></span><span class="op" id="6844489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="6844492">func</span>&nbsp;<span class="ident" id="6844497">TestParseCertificateWithDSASignatureAlgorithm</span><span class="op" id="6844542">(</span><span class="ident" id="6844543">t</span>&nbsp;<span class="op" id="6844545">*</span><span class="ident" id="6844546">testing</span><span class="op" id="6844553">.</span><span class="ident" id="6844554">T</span><span class="op" id="6844555">)</span>&nbsp;<span class="op" id="6844557">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6844560">pemBlock</span><span class="op" id="6844568">,</span>&nbsp;<span class="ident" id="6844570">_</span>&nbsp;<span class="op" id="6844572">:=</span>&nbsp;<span class="ident" id="6844575">pem</span><span class="op" id="6844578">.</span><span class="ident" id="6844579">Decode</span><span class="op" id="6844585">(</span><span class="op" id="6844586">[</span><span class="op" id="6844587">]</span><span class="builtintype" id="6844588">byte</span><span class="op" id="6844592">(</span><span class="ident" id="6844593">dsaCertPem</span><span class="op" id="6844603">)</span><span class="op" id="6844604">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6844607">cert</span><span class="op" id="6844611">,</span>&nbsp;<span class="ident" id="6844613">err</span>&nbsp;<span class="op" id="6844617">:=</span>&nbsp;<span class="ident" id="6844620">ParseCertificate</span><span class="op" id="6844636">(</span><span class="ident" id="6844637">pemBlock</span><span class="op" id="6844645">.</span><span class="ident" id="6844646">Bytes</span><span class="op" id="6844651">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6844654">if</span>&nbsp;<span class="ident" id="6844657">err</span>&nbsp;<span class="op" id="6844661">!=</span>&nbsp;<span class="ident" id="6844664">nil</span>&nbsp;<span class="op" id="6844668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6844672">t</span><span class="op" id="6844673">.</span><span class="ident" id="6844674">Fatalf</span><span class="op" id="6844680">(</span><span class="string" id="6844681">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6844714">,</span>&nbsp;<span class="ident" id="6844716">err</span><span class="op" id="6844719">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6844722">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6844725">if</span>&nbsp;<span class="ident" id="6844728">cert</span><span class="op" id="6844732">.</span><span class="ident" id="6844733">SignatureAlgorithm</span>&nbsp;<span class="op" id="6844752">!=</span>&nbsp;<span class="ident" id="6844755">DSAWithSHA1</span>&nbsp;<span class="op" id="6844767">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6844771">t</span><span class="op" id="6844772">.</span><span class="ident" id="6844773">Errorf</span><span class="op" id="6844779">(</span><span class="string" id="6844780">&#34;Parsed&nbsp;signature&nbsp;algorithm&nbsp;was&nbsp;not&nbsp;DSAWithSHA1&#34;</span><span class="op" id="6844828">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6844831">}</span><br>
<span class="lineno"></span><span class="op" id="6844833">}</span><br>
<span class="lineno">625</span><br>
<span class="lineno"></span><span class="keyword" id="6844836">func</span>&nbsp;<span class="ident" id="6844841">TestVerifyCertificateWithDSASignature</span><span class="op" id="6844878">(</span><span class="ident" id="6844879">t</span>&nbsp;<span class="op" id="6844881">*</span><span class="ident" id="6844882">testing</span><span class="op" id="6844889">.</span><span class="ident" id="6844890">T</span><span class="op" id="6844891">)</span>&nbsp;<span class="op" id="6844893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6844896">pemBlock</span><span class="op" id="6844904">,</span>&nbsp;<span class="ident" id="6844906">_</span>&nbsp;<span class="op" id="6844908">:=</span>&nbsp;<span class="ident" id="6844911">pem</span><span class="op" id="6844914">.</span><span class="ident" id="6844915">Decode</span><span class="op" id="6844921">(</span><span class="op" id="6844922">[</span><span class="op" id="6844923">]</span><span class="builtintype" id="6844924">byte</span><span class="op" id="6844928">(</span><span class="ident" id="6844929">dsaCertPem</span><span class="op" id="6844939">)</span><span class="op" id="6844940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6844943">cert</span><span class="op" id="6844947">,</span>&nbsp;<span class="ident" id="6844949">err</span>&nbsp;<span class="op" id="6844953">:=</span>&nbsp;<span class="ident" id="6844956">ParseCertificate</span><span class="op" id="6844972">(</span><span class="ident" id="6844973">pemBlock</span><span class="op" id="6844981">.</span><span class="ident" id="6844982">Bytes</span><span class="op" id="6844987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6844990">if</span>&nbsp;<span class="ident" id="6844993">err</span>&nbsp;<span class="op" id="6844997">!=</span>&nbsp;<span class="ident" id="6845000">nil</span>&nbsp;<span class="op" id="6845004">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6845008">t</span><span class="op" id="6845009">.</span><span class="ident" id="6845010">Fatalf</span><span class="op" id="6845016">(</span><span class="string" id="6845017">&#34;Failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6845050">,</span>&nbsp;<span class="ident" id="6845052">err</span><span class="op" id="6845055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6845058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6845061">//&nbsp;test&nbsp;cert&nbsp;is&nbsp;self-signed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6845090">if</span>&nbsp;<span class="ident" id="6845093">err</span>&nbsp;<span class="op" id="6845097">=</span>&nbsp;<span class="ident" id="6845099">cert</span><span class="op" id="6845103">.</span><span class="ident" id="6845104">CheckSignatureFrom</span><span class="op" id="6845122">(</span><span class="ident" id="6845123">cert</span><span class="op" id="6845127">)</span><span class="op" id="6845128">;</span>&nbsp;<span class="ident" id="6845130">err</span>&nbsp;<span class="op" id="6845134">!=</span>&nbsp;<span class="ident" id="6845137">nil</span>&nbsp;<span class="op" id="6845141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6845145">t</span><span class="op" id="6845146">.</span><span class="ident" id="6845147">Fatalf</span><span class="op" id="6845153">(</span><span class="string" id="6845154">&#34;DSA&nbsp;Certificate&nbsp;verification&nbsp;failed:&nbsp;%s&#34;</span><span class="op" id="6845195">,</span>&nbsp;<span class="ident" id="6845197">err</span><span class="op" id="6845200">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6845203">}</span><br>
<span class="lineno"></span><span class="op" id="6845205">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6845208">const</span>&nbsp;<span class="ident" id="6845214">pemCertificate</span>&nbsp;<span class="op" id="6845229">=</span>&nbsp;<span class="string" id="6845231">`-----BEGIN&nbsp;CERTIFICATE-----<br>
<span class="lineno"></span>MIIB5DCCAZCgAwIBAgIBATALBgkqhkiG9w0BAQUwLTEQMA4GA1UEChMHQWNtZSBDbzEZMBcGA1UE<br>
<span class="lineno">640</span>AxMQdGVzdC5leGFtcGxlLmNvbTAeFw03MDAxMDEwMDE2NDBaFw03MDAxMDIwMzQ2NDBaMC0xEDAO<br>
<span class="lineno"></span>BgNVBAoTB0FjbWUgQ28xGTAXBgNVBAMTEHRlc3QuZXhhbXBsZS5jb20wWjALBgkqhkiG9w0BAQED<br>
<span class="lineno"></span>SwAwSAJBALKZD0nEffqM1ACuak0bijtqE2QrI/KLADv7l3kK3ppMyCuLKoF0fd7Ai2KW5ToIwzFo<br>
<span class="lineno"></span>fvJcS/STa6HA5gQenRUCAwEAAaOBnjCBmzAOBgNVHQ8BAf8EBAMCAAQwDwYDVR0TAQH/BAUwAwEB<br>
<span class="lineno"></span>/zANBgNVHQ4EBgQEAQIDBDAPBgNVHSMECDAGgAQBAgMEMBsGA1UdEQQUMBKCEHRlc3QuZXhhbXBs<br>
<span class="lineno">645</span>ZS5jb20wDwYDVR0gBAgwBjAEBgIqAzAqBgNVHR4EIzAhoB8wDoIMLmV4YW1wbGUuY29tMA2CC2V4<br>
<span class="lineno"></span>YW1wbGUuY29tMAsGCSqGSIb3DQEBBQNBAHKZKoS1wEQOGhgklx4+/yFYQlnqwKXvar/ZecQvJwui<br>
<span class="lineno"></span>0seMQnwBhwdBkHfVIU2Fu5VUMRyxlf0ZNaDXcpU581k=<br>
<span class="lineno"></span>-----END&nbsp;CERTIFICATE-----`</span><br>
<span class="lineno"></span><br>
<span class="lineno">650</span><span class="keyword" id="6845949">func</span>&nbsp;<span class="ident" id="6845954">TestCRLCreation</span><span class="op" id="6845969">(</span><span class="ident" id="6845970">t</span>&nbsp;<span class="op" id="6845972">*</span><span class="ident" id="6845973">testing</span><span class="op" id="6845980">.</span><span class="ident" id="6845981">T</span><span class="op" id="6845982">)</span>&nbsp;<span class="op" id="6845984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6845987">block</span><span class="op" id="6845992">,</span>&nbsp;<span class="ident" id="6845994">_</span>&nbsp;<span class="op" id="6845996">:=</span>&nbsp;<span class="ident" id="6845999">pem</span><span class="op" id="6846002">.</span><span class="ident" id="6846003">Decode</span><span class="op" id="6846009">(</span><span class="op" id="6846010">[</span><span class="op" id="6846011">]</span><span class="builtintype" id="6846012">byte</span><span class="op" id="6846016">(</span><span class="ident" id="6846017">pemPrivateKey</span><span class="op" id="6846030">)</span><span class="op" id="6846031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846034">priv</span><span class="op" id="6846038">,</span>&nbsp;<span class="ident" id="6846040">_</span>&nbsp;<span class="op" id="6846042">:=</span>&nbsp;<span class="ident" id="6846045">ParsePKCS1PrivateKey</span><span class="op" id="6846065">(</span><span class="ident" id="6846066">block</span><span class="op" id="6846071">.</span><span class="ident" id="6846072">Bytes</span><span class="op" id="6846077">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846080">block</span><span class="op" id="6846085">,</span>&nbsp;<span class="ident" id="6846087">_</span>&nbsp;<span class="op" id="6846089">=</span>&nbsp;<span class="ident" id="6846091">pem</span><span class="op" id="6846094">.</span><span class="ident" id="6846095">Decode</span><span class="op" id="6846101">(</span><span class="op" id="6846102">[</span><span class="op" id="6846103">]</span><span class="builtintype" id="6846104">byte</span><span class="op" id="6846108">(</span><span class="ident" id="6846109">pemCertificate</span><span class="op" id="6846123">)</span><span class="op" id="6846124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846127">cert</span><span class="op" id="6846131">,</span>&nbsp;<span class="ident" id="6846133">_</span>&nbsp;<span class="op" id="6846135">:=</span>&nbsp;<span class="ident" id="6846138">ParseCertificate</span><span class="op" id="6846154">(</span><span class="ident" id="6846155">block</span><span class="op" id="6846160">.</span><span class="ident" id="6846161">Bytes</span><span class="op" id="6846166">)</span><br>
<span class="lineno">655</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846170">now</span>&nbsp;<span class="op" id="6846174">:=</span>&nbsp;<span class="ident" id="6846177">time</span><span class="op" id="6846181">.</span><span class="ident" id="6846182">Unix</span><span class="op" id="6846186">(</span><span class="num" id="6846187">1000</span><span class="op" id="6846191">,</span>&nbsp;<span class="num" id="6846193">0</span><span class="op" id="6846194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846197">expiry</span>&nbsp;<span class="op" id="6846204">:=</span>&nbsp;<span class="ident" id="6846207">time</span><span class="op" id="6846211">.</span><span class="ident" id="6846212">Unix</span><span class="op" id="6846216">(</span><span class="num" id="6846217">10000</span><span class="op" id="6846222">,</span>&nbsp;<span class="num" id="6846224">0</span><span class="op" id="6846225">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846229">revokedCerts</span>&nbsp;<span class="op" id="6846242">:=</span>&nbsp;<span class="op" id="6846245">[</span><span class="op" id="6846246">]</span><span class="ident" id="6846247">pkix</span><span class="op" id="6846251">.</span><span class="ident" id="6846252">RevokedCertificate</span><span class="op" id="6846270">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846279">SerialNumber</span><span class="op" id="6846291">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6846295">big</span><span class="op" id="6846298">.</span><span class="ident" id="6846299">NewInt</span><span class="op" id="6846305">(</span><span class="num" id="6846306">1</span><span class="op" id="6846307">)</span><span class="op" id="6846308">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846313">RevocationTime</span><span class="op" id="6846327">:</span>&nbsp;<span class="ident" id="6846329">now</span><span class="op" id="6846332">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846336">}</span><span class="op" id="6846337">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846341">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846346">SerialNumber</span><span class="op" id="6846358">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6846362">big</span><span class="op" id="6846365">.</span><span class="ident" id="6846366">NewInt</span><span class="op" id="6846372">(</span><span class="num" id="6846373">42</span><span class="op" id="6846375">)</span><span class="op" id="6846376">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846381">RevocationTime</span><span class="op" id="6846395">:</span>&nbsp;<span class="ident" id="6846397">now</span><span class="op" id="6846400">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846404">}</span><span class="op" id="6846405">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846412">crlBytes</span><span class="op" id="6846420">,</span>&nbsp;<span class="ident" id="6846422">err</span>&nbsp;<span class="op" id="6846426">:=</span>&nbsp;<span class="ident" id="6846429">cert</span><span class="op" id="6846433">.</span><span class="ident" id="6846434">CreateCRL</span><span class="op" id="6846443">(</span><span class="ident" id="6846444">rand</span><span class="op" id="6846448">.</span><span class="ident" id="6846449">Reader</span><span class="op" id="6846455">,</span>&nbsp;<span class="ident" id="6846457">priv</span><span class="op" id="6846461">,</span>&nbsp;<span class="ident" id="6846463">revokedCerts</span><span class="op" id="6846475">,</span>&nbsp;<span class="ident" id="6846477">now</span><span class="op" id="6846480">,</span>&nbsp;<span class="ident" id="6846482">expiry</span><span class="op" id="6846488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6846491">if</span>&nbsp;<span class="ident" id="6846494">err</span>&nbsp;<span class="op" id="6846498">!=</span>&nbsp;<span class="ident" id="6846501">nil</span>&nbsp;<span class="op" id="6846505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846509">t</span><span class="op" id="6846510">.</span><span class="ident" id="6846511">Errorf</span><span class="op" id="6846517">(</span><span class="string" id="6846518">&#34;error&nbsp;creating&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="6846542">,</span>&nbsp;<span class="ident" id="6846544">err</span><span class="op" id="6846547">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846550">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846554">_</span><span class="op" id="6846555">,</span>&nbsp;<span class="ident" id="6846557">err</span>&nbsp;<span class="op" id="6846561">=</span>&nbsp;<span class="ident" id="6846563">ParseDERCRL</span><span class="op" id="6846574">(</span><span class="ident" id="6846575">crlBytes</span><span class="op" id="6846583">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6846586">if</span>&nbsp;<span class="ident" id="6846589">err</span>&nbsp;<span class="op" id="6846593">!=</span>&nbsp;<span class="ident" id="6846596">nil</span>&nbsp;<span class="op" id="6846600">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846604">t</span><span class="op" id="6846605">.</span><span class="ident" id="6846606">Errorf</span><span class="op" id="6846612">(</span><span class="string" id="6846613">&#34;error&nbsp;reparsing&nbsp;CRL:&nbsp;%s&#34;</span><span class="op" id="6846638">,</span>&nbsp;<span class="ident" id="6846640">err</span><span class="op" id="6846643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846646">}</span><br>
<span class="lineno"></span><span class="op" id="6846648">}</span><br>
<span class="lineno">680</span><br>
<span class="lineno"></span><span class="keyword" id="6846651">func</span>&nbsp;<span class="ident" id="6846656">fromBase64</span><span class="op" id="6846666">(</span><span class="ident" id="6846667">in</span>&nbsp;<span class="builtintype" id="6846670">string</span><span class="op" id="6846676">)</span>&nbsp;<span class="op" id="6846678">[</span><span class="op" id="6846679">]</span><span class="builtintype" id="6846680">byte</span>&nbsp;<span class="op" id="6846685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846688">out</span>&nbsp;<span class="op" id="6846692">:=</span>&nbsp;<span class="builtinfunc" id="6846695">make</span><span class="op" id="6846699">(</span><span class="op" id="6846700">[</span><span class="op" id="6846701">]</span><span class="builtintype" id="6846702">byte</span><span class="op" id="6846706">,</span>&nbsp;<span class="ident" id="6846708">base64</span><span class="op" id="6846714">.</span><span class="ident" id="6846715">StdEncoding</span><span class="op" id="6846726">.</span><span class="ident" id="6846727">DecodedLen</span><span class="op" id="6846737">(</span><span class="builtinfunc" id="6846738">len</span><span class="op" id="6846741">(</span><span class="ident" id="6846742">in</span><span class="op" id="6846744">)</span><span class="op" id="6846745">)</span><span class="op" id="6846746">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846749">n</span><span class="op" id="6846750">,</span>&nbsp;<span class="ident" id="6846752">err</span>&nbsp;<span class="op" id="6846756">:=</span>&nbsp;<span class="ident" id="6846759">base64</span><span class="op" id="6846765">.</span><span class="ident" id="6846766">StdEncoding</span><span class="op" id="6846777">.</span><span class="ident" id="6846778">Decode</span><span class="op" id="6846784">(</span><span class="ident" id="6846785">out</span><span class="op" id="6846788">,</span>&nbsp;<span class="op" id="6846790">[</span><span class="op" id="6846791">]</span><span class="builtintype" id="6846792">byte</span><span class="op" id="6846796">(</span><span class="ident" id="6846797">in</span><span class="op" id="6846799">)</span><span class="op" id="6846800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6846803">if</span>&nbsp;<span class="ident" id="6846806">err</span>&nbsp;<span class="op" id="6846810">!=</span>&nbsp;<span class="ident" id="6846813">nil</span>&nbsp;<span class="op" id="6846817">{</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6846821">panic</span><span class="op" id="6846826">(</span><span class="string" id="6846827">&#34;failed&nbsp;to&nbsp;base64&nbsp;decode&#34;</span><span class="op" id="6846852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6846855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6846858">return</span>&nbsp;<span class="ident" id="6846865">out</span><span class="op" id="6846868">[</span><span class="op" id="6846869">:</span><span class="ident" id="6846870">n</span><span class="op" id="6846871">]</span><br>
<span class="lineno"></span><span class="op" id="6846873">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="keyword" id="6846876">func</span>&nbsp;<span class="ident" id="6846881">TestParseDERCRL</span><span class="op" id="6846896">(</span><span class="ident" id="6846897">t</span>&nbsp;<span class="op" id="6846899">*</span><span class="ident" id="6846900">testing</span><span class="op" id="6846907">.</span><span class="ident" id="6846908">T</span><span class="op" id="6846909">)</span>&nbsp;<span class="op" id="6846911">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846914">derBytes</span>&nbsp;<span class="op" id="6846923">:=</span>&nbsp;<span class="ident" id="6846926">fromBase64</span><span class="op" id="6846936">(</span><span class="ident" id="6846937">derCRLBase64</span><span class="op" id="6846949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6846952">certList</span><span class="op" id="6846960">,</span>&nbsp;<span class="ident" id="6846962">err</span>&nbsp;<span class="op" id="6846966">:=</span>&nbsp;<span class="ident" id="6846969">ParseDERCRL</span><span class="op" id="6846980">(</span><span class="ident" id="6846981">derBytes</span><span class="op" id="6846989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6846992">if</span>&nbsp;<span class="ident" id="6846995">err</span>&nbsp;<span class="op" id="6846999">!=</span>&nbsp;<span class="ident" id="6847002">nil</span>&nbsp;<span class="op" id="6847006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847010">t</span><span class="op" id="6847011">.</span><span class="ident" id="6847012">Errorf</span><span class="op" id="6847018">(</span><span class="string" id="6847019">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="6847038">,</span>&nbsp;<span class="ident" id="6847040">err</span><span class="op" id="6847043">)</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6847047">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6847055">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847058">numCerts</span>&nbsp;<span class="op" id="6847067">:=</span>&nbsp;<span class="builtinfunc" id="6847070">len</span><span class="op" id="6847073">(</span><span class="ident" id="6847074">certList</span><span class="op" id="6847082">.</span><span class="ident" id="6847083">TBSCertList</span><span class="op" id="6847094">.</span><span class="ident" id="6847095">RevokedCertificates</span><span class="op" id="6847114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847117">expected</span>&nbsp;<span class="op" id="6847126">:=</span>&nbsp;<span class="num" id="6847129">88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6847133">if</span>&nbsp;<span class="ident" id="6847136">numCerts</span>&nbsp;<span class="op" id="6847145">!=</span>&nbsp;<span class="ident" id="6847148">expected</span>&nbsp;<span class="op" id="6847157">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847161">t</span><span class="op" id="6847162">.</span><span class="ident" id="6847163">Errorf</span><span class="op" id="6847169">(</span><span class="string" id="6847170">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="6847224">,</span>&nbsp;<span class="ident" id="6847226">numCerts</span><span class="op" id="6847234">,</span>&nbsp;<span class="ident" id="6847236">expected</span><span class="op" id="6847244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6847247">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6847251">if</span>&nbsp;<span class="ident" id="6847254">certList</span><span class="op" id="6847262">.</span><span class="ident" id="6847263">HasExpired</span><span class="op" id="6847273">(</span><span class="ident" id="6847274">time</span><span class="op" id="6847278">.</span><span class="ident" id="6847279">Unix</span><span class="op" id="6847283">(</span><span class="num" id="6847284">1302517272</span><span class="op" id="6847294">,</span>&nbsp;<span class="num" id="6847296">0</span><span class="op" id="6847297">)</span><span class="op" id="6847298">)</span>&nbsp;<span class="op" id="6847300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847304">t</span><span class="op" id="6847305">.</span><span class="ident" id="6847306">Errorf</span><span class="op" id="6847312">(</span><span class="string" id="6847313">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="6847351">)</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6847354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6847358">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="6847417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">710</span><span class="keyword" id="6847420">func</span>&nbsp;<span class="ident" id="6847425">TestCRLWithoutExpiry</span><span class="op" id="6847445">(</span><span class="ident" id="6847446">t</span>&nbsp;<span class="op" id="6847448">*</span><span class="ident" id="6847449">testing</span><span class="op" id="6847456">.</span><span class="ident" id="6847457">T</span><span class="op" id="6847458">)</span>&nbsp;<span class="op" id="6847460">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847463">derBytes</span>&nbsp;<span class="op" id="6847472">:=</span>&nbsp;<span class="ident" id="6847475">fromBase64</span><span class="op" id="6847485">(</span><span class="string" id="6847486">&#34;MIHYMIGZMAkGByqGSM44BAMwEjEQMA4GA1UEAxMHQ2FybERTUxcNOTkwODI3MDcwMDAwWjBpMBMCAgDIFw05OTA4MjIwNzAwMDBaMBMCAgDJFw05OTA4MjIwNzAwMDBaMBMCAgDTFw05OTA4MjIwNzAwMDBaMBMCAgDSFw05OTA4MjIwNzAwMDBaMBMCAgDUFw05OTA4MjQwNzAwMDBaMAkGByqGSM44BAMDLwAwLAIUfmVSdjP+NHMX0feW+aDU2G1cfT0CFAJ6W7fVWxjBz4fvftok8yqDnDWh&#34;</span><span class="op" id="6847780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847783">certList</span><span class="op" id="6847791">,</span>&nbsp;<span class="ident" id="6847793">err</span>&nbsp;<span class="op" id="6847797">:=</span>&nbsp;<span class="ident" id="6847800">ParseDERCRL</span><span class="op" id="6847811">(</span><span class="ident" id="6847812">derBytes</span><span class="op" id="6847820">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6847823">if</span>&nbsp;<span class="ident" id="6847826">err</span>&nbsp;<span class="op" id="6847830">!=</span>&nbsp;<span class="ident" id="6847833">nil</span>&nbsp;<span class="op" id="6847837">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847841">t</span><span class="op" id="6847842">.</span><span class="ident" id="6847843">Fatal</span><span class="op" id="6847848">(</span><span class="ident" id="6847849">err</span><span class="op" id="6847852">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6847855">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6847858">if</span>&nbsp;<span class="op" id="6847861">!</span><span class="ident" id="6847862">certList</span><span class="op" id="6847870">.</span><span class="ident" id="6847871">TBSCertList</span><span class="op" id="6847882">.</span><span class="ident" id="6847883">NextUpdate</span><span class="op" id="6847893">.</span><span class="ident" id="6847894">IsZero</span><span class="op" id="6847900">(</span><span class="op" id="6847901">)</span>&nbsp;<span class="op" id="6847903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847907">t</span><span class="op" id="6847908">.</span><span class="ident" id="6847909">Errorf</span><span class="op" id="6847915">(</span><span class="string" id="6847916">&#34;NextUpdate&nbsp;is&nbsp;not&nbsp;the&nbsp;zero&nbsp;value&#34;</span><span class="op" id="6847950">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6847953">}</span><br>
<span class="lineno"></span><span class="op" id="6847955">}</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span><span class="keyword" id="6847958">func</span>&nbsp;<span class="ident" id="6847963">TestParsePEMCRL</span><span class="op" id="6847978">(</span><span class="ident" id="6847979">t</span>&nbsp;<span class="op" id="6847981">*</span><span class="ident" id="6847982">testing</span><span class="op" id="6847989">.</span><span class="ident" id="6847990">T</span><span class="op" id="6847991">)</span>&nbsp;<span class="op" id="6847993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6847996">pemBytes</span>&nbsp;<span class="op" id="6848005">:=</span>&nbsp;<span class="ident" id="6848008">fromBase64</span><span class="op" id="6848018">(</span><span class="ident" id="6848019">pemCRLBase64</span><span class="op" id="6848031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848034">certList</span><span class="op" id="6848042">,</span>&nbsp;<span class="ident" id="6848044">err</span>&nbsp;<span class="op" id="6848048">:=</span>&nbsp;<span class="ident" id="6848051">ParseCRL</span><span class="op" id="6848059">(</span><span class="ident" id="6848060">pemBytes</span><span class="op" id="6848068">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6848071">if</span>&nbsp;<span class="ident" id="6848074">err</span>&nbsp;<span class="op" id="6848078">!=</span>&nbsp;<span class="ident" id="6848081">nil</span>&nbsp;<span class="op" id="6848085">{</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848089">t</span><span class="op" id="6848090">.</span><span class="ident" id="6848091">Errorf</span><span class="op" id="6848097">(</span><span class="string" id="6848098">&#34;error&nbsp;parsing:&nbsp;%s&#34;</span><span class="op" id="6848117">,</span>&nbsp;<span class="ident" id="6848119">err</span><span class="op" id="6848122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6848126">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6848134">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848137">numCerts</span>&nbsp;<span class="op" id="6848146">:=</span>&nbsp;<span class="builtinfunc" id="6848149">len</span><span class="op" id="6848152">(</span><span class="ident" id="6848153">certList</span><span class="op" id="6848161">.</span><span class="ident" id="6848162">TBSCertList</span><span class="op" id="6848173">.</span><span class="ident" id="6848174">RevokedCertificates</span><span class="op" id="6848193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848196">expected</span>&nbsp;<span class="op" id="6848205">:=</span>&nbsp;<span class="num" id="6848208">2</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6848211">if</span>&nbsp;<span class="ident" id="6848214">numCerts</span>&nbsp;<span class="op" id="6848223">!=</span>&nbsp;<span class="ident" id="6848226">expected</span>&nbsp;<span class="op" id="6848235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848239">t</span><span class="op" id="6848240">.</span><span class="ident" id="6848241">Errorf</span><span class="op" id="6848247">(</span><span class="string" id="6848248">&#34;bad&nbsp;number&nbsp;of&nbsp;revoked&nbsp;certificates.&nbsp;got:&nbsp;%d&nbsp;want:&nbsp;%d&#34;</span><span class="op" id="6848302">,</span>&nbsp;<span class="ident" id="6848304">numCerts</span><span class="op" id="6848312">,</span>&nbsp;<span class="ident" id="6848314">expected</span><span class="op" id="6848322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6848325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6848329">if</span>&nbsp;<span class="ident" id="6848332">certList</span><span class="op" id="6848340">.</span><span class="ident" id="6848341">HasExpired</span><span class="op" id="6848351">(</span><span class="ident" id="6848352">time</span><span class="op" id="6848356">.</span><span class="ident" id="6848357">Unix</span><span class="op" id="6848361">(</span><span class="num" id="6848362">1302517272</span><span class="op" id="6848372">,</span>&nbsp;<span class="num" id="6848374">0</span><span class="op" id="6848375">)</span><span class="op" id="6848376">)</span>&nbsp;<span class="op" id="6848378">{</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848382">t</span><span class="op" id="6848383">.</span><span class="ident" id="6848384">Errorf</span><span class="op" id="6848390">(</span><span class="string" id="6848391">&#34;CRL&nbsp;has&nbsp;expired&nbsp;(but&nbsp;shouldn&#39;t&nbsp;have)&#34;</span><span class="op" id="6848429">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6848432">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6848436">//&nbsp;Can&#39;t&nbsp;check&nbsp;the&nbsp;signature&nbsp;here&nbsp;without&nbsp;a&nbsp;package&nbsp;cycle.</span><br>
<span class="lineno"></span><span class="op" id="6848495">}</span><br>
<span class="lineno">740</span><br>
<span class="lineno"></span><span class="keyword" id="6848498">func</span>&nbsp;<span class="ident" id="6848503">TestImports</span><span class="op" id="6848514">(</span><span class="ident" id="6848515">t</span>&nbsp;<span class="op" id="6848517">*</span><span class="ident" id="6848518">testing</span><span class="op" id="6848525">.</span><span class="ident" id="6848526">T</span><span class="op" id="6848527">)</span>&nbsp;<span class="op" id="6848529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6848532">switch</span>&nbsp;<span class="ident" id="6848539">runtime</span><span class="op" id="6848546">.</span><span class="ident" id="6848547">GOOS</span>&nbsp;<span class="op" id="6848552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6848555">case</span>&nbsp;<span class="string" id="6848560">&#34;android&#34;</span><span class="op" id="6848569">,</span>&nbsp;<span class="string" id="6848571">&#34;nacl&#34;</span><span class="op" id="6848577">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848581">t</span><span class="op" id="6848582">.</span><span class="ident" id="6848583">Skipf</span><span class="op" id="6848588">(</span><span class="string" id="6848589">&#34;skipping&nbsp;on&nbsp;%s&#34;</span><span class="op" id="6848605">,</span>&nbsp;<span class="ident" id="6848607">runtime</span><span class="op" id="6848614">.</span><span class="ident" id="6848615">GOOS</span><span class="op" id="6848619">)</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6848622">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6848626">if</span>&nbsp;<span class="ident" id="6848629">err</span>&nbsp;<span class="op" id="6848633">:=</span>&nbsp;<span class="ident" id="6848636">exec</span><span class="op" id="6848640">.</span><span class="ident" id="6848641">Command</span><span class="op" id="6848648">(</span><span class="string" id="6848649">&#34;go&#34;</span><span class="op" id="6848653">,</span>&nbsp;<span class="string" id="6848655">&#34;run&#34;</span><span class="op" id="6848660">,</span>&nbsp;<span class="string" id="6848662">&#34;x509_test_import.go&#34;</span><span class="op" id="6848683">)</span><span class="op" id="6848684">.</span><span class="ident" id="6848685">Run</span><span class="op" id="6848688">(</span><span class="op" id="6848689">)</span><span class="op" id="6848690">;</span>&nbsp;<span class="ident" id="6848692">err</span>&nbsp;<span class="op" id="6848696">!=</span>&nbsp;<span class="ident" id="6848699">nil</span>&nbsp;<span class="op" id="6848703">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6848707">t</span><span class="op" id="6848708">.</span><span class="ident" id="6848709">Errorf</span><span class="op" id="6848715">(</span><span class="string" id="6848716">&#34;failed&nbsp;to&nbsp;run&nbsp;x509_test_import.go:&nbsp;%s&#34;</span><span class="op" id="6848755">,</span>&nbsp;<span class="ident" id="6848757">err</span><span class="op" id="6848760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6848763">}</span><br>
<span class="lineno">750</span><span class="op" id="6848765">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6848768">const</span>&nbsp;<span class="ident" id="6848774">derCRLBase64</span>&nbsp;<span class="op" id="6848787">=</span>&nbsp;<span class="string" id="6848789">&#34;MIINqzCCDJMCAQEwDQYJKoZIhvcNAQEFBQAwVjEZMBcGA1UEAxMQUEtJIEZJTk1FQ0NBTklDQTEVMBMGA1UEChMMRklOTUVDQ0FOSUNBMRUwEwYDVQQLEwxGSU5NRUNDQU5JQ0ExCzAJBgNVBAYTAklUFw0xMTA1MDQxNjU3NDJaFw0xMTA1MDQyMDU3NDJaMIIMBzAhAg4Ze1od49Lt1qIXBydAzhcNMDkwNzE2MDg0MzIyWjAAMCECDl0HSL9bcZ1Ci/UHJ0DPFw0wOTA3MTYwODQzMTNaMAAwIQIOESB9tVAmX3cY7QcnQNAXDTA5MDcxNjA4NDUyMlowADAhAg4S1tGAQ3mHt8uVBydA1RcNMDkwODA0MTUyNTIyWjAAMCECDlQ249Y7vtC25ScHJ0DWFw0wOTA4MDQxNTI1MzdaMAAwIQIOISMop3NkA4PfYwcnQNkXDTA5MDgwNDExMDAzNFowADAhAg56/BMoS29KEShTBydA2hcNMDkwODA0MTEwMTAzWjAAMCECDnBp/22HPH5CSWoHJ0DbFw0wOTA4MDQxMDU0NDlaMAAwIQIOV9IP+8CD8bK+XAcnQNwXDTA5MDgwNDEwNTcxN1owADAhAg4v5aRz0IxWqYiXBydA3RcNMDkwODA0MTA1NzQ1WjAAMCECDlOU34VzvZAybQwHJ0DeFw0wOTA4MDQxMDU4MjFaMAAwIAINO4CD9lluIxcwBydBAxcNMDkwNzIyMTUzMTU5WjAAMCECDgOllfO8Y1QA7/wHJ0ExFw0wOTA3MjQxMTQxNDNaMAAwIQIOJBX7jbiCdRdyjgcnQUQXDTA5MDkxNjA5MzAwOFowADAhAg5iYSAgmDrlH/RZBydBRRcNMDkwOTE2MDkzMDE3WjAAMCECDmu6k6srP3jcMaQHJ0FRFw0wOTA4MDQxMDU2NDBaMAAwIQIOX8aHlO0V+WVH4QcnQVMXDTA5MDgwNDEwNTcyOVowADAhAg5flK2rg3NnsRgDBydBzhcNMTEwMjAxMTUzMzQ2WjAAMCECDg35yJDL1jOPTgoHJ0HPFw0xMTAyMDExNTM0MjZaMAAwIQIOMyFJ6+e9iiGVBQcnQdAXDTA5MDkxODEzMjAwNVowADAhAg5Emb/Oykucmn8fBydB1xcNMDkwOTIxMTAxMDQ3WjAAMCECDjQKCncV+MnUavMHJ0HaFw0wOTA5MjIwODE1MjZaMAAwIQIOaxiFUt3dpd+tPwcnQfQXDTEwMDYxODA4NDI1MVowADAhAg5G7P8nO0tkrMt7BydB9RcNMTAwNjE4MDg0MjMwWjAAMCECDmTCC3SXhmDRst4HJ0H2Fw0wOTA5MjgxMjA3MjBaMAAwIQIOHoGhUr/pRwzTKgcnQfcXDTA5MDkyODEyMDcyNFowADAhAg50wrcrCiw8mQmPBydCBBcNMTAwMjE2MTMwMTA2WjAAMCECDifWmkvwyhEqwEcHJ0IFFw0xMDAyMTYxMzAxMjBaMAAwIQIOfgPmlW9fg+osNgcnQhwXDTEwMDQxMzA5NTIwMFowADAhAg4YHAGuA6LgCk7tBydCHRcNMTAwNDEzMDk1MTM4WjAAMCECDi1zH1bxkNJhokAHJ0IsFw0xMDA0MTMwOTU5MzBaMAAwIQIOMipNccsb/wo2fwcnQi0XDTEwMDQxMzA5NTkwMFowADAhAg46lCmvPl4GpP6ABydCShcNMTAwMTE5MDk1MjE3WjAAMCECDjaTcaj+wBpcGAsHJ0JLFw0xMDAxMTkwOTUyMzRaMAAwIQIOOMC13EOrBuxIOQcnQloXDTEwMDIwMTA5NDcwNVowADAhAg5KmZl+krz4RsmrBydCWxcNMTAwMjAxMDk0NjQwWjAAMCECDmLG3zQJ/fzdSsUHJ0JiFw0xMDAzMDEwOTUxNDBaMAAwIQIOP39ksgHdojf4owcnQmMXDTEwMDMwMTA5NTExN1owADAhAg4LDQzvWNRlD6v9BydCZBcNMTAwMzAxMDk0NjIyWjAAMCECDkmNfeclaFhIaaUHJ0JlFw0xMDAzMDEwOTQ2MDVaMAAwIQIOT/qWWfpH/m8NTwcnQpQXDTEwMDUxMTA5MTgyMVowADAhAg5m/ksYxvCEgJSvBydClRcNMTAwNTExMDkxODAxWjAAMCECDgvf3Ohq6JOPU9AHJ0KWFw0xMDA1MTEwOTIxMjNaMAAwIQIOKSPas10z4jNVIQcnQpcXDTEwMDUxMTA5MjEwMlowADAhAg4mCWmhoZ3lyKCDBydCohcNMTEwNDI4MTEwMjI1WjAAMCECDkeiyRsBMK0Gvr4HJ0KjFw0xMTA0MjgxMTAyMDdaMAAwIQIOa09b/nH2+55SSwcnQq4XDTExMDQwMTA4Mjk0NlowADAhAg5O7M7iq7gGplr1BydCrxcNMTEwNDAxMDgzMDE3WjAAMCECDjlT6mJxUjTvyogHJ0K1Fw0xMTAxMjcxNTQ4NTJaMAAwIQIODS/l4UUFLe21NAcnQrYXDTExMDEyNzE1NDgyOFowADAhAg5lPRA0XdOUF6lSBydDHhcNMTEwMTI4MTQzNTA1WjAAMCECDixKX4fFGGpENwgHJ0MfFw0xMTAxMjgxNDM1MzBaMAAwIQIORNBkqsPnpKTtbAcnQ08XDTEwMDkwOTA4NDg0MlowADAhAg5QL+EMM3lohedEBydDUBcNMTAwOTA5MDg0ODE5WjAAMCECDlhDnHK+HiTRAXcHJ0NUFw0xMDEwMTkxNjIxNDBaMAAwIQIOdBFqAzq/INz53gcnQ1UXDTEwMTAxOTE2MjA0NFowADAhAg4OjR7s8MgKles1BydDWhcNMTEwMTI3MTY1MzM2WjAAMCECDmfR/elHee+d0SoHJ0NbFw0xMTAxMjcxNjUzNTZaMAAwIQIOBTKv2ui+KFMI+wcnQ5YXDTEwMDkxNTEwMjE1N1owADAhAg49F3c/GSah+oRUBydDmxcNMTEwMTI3MTczMjMzWjAAMCECDggv4I61WwpKFMMHJ0OcFw0xMTAxMjcxNzMyNTVaMAAwIQIOXx/Y8sEvwS10LAcnQ6UXDTExMDEyODExMjkzN1owADAhAg5LSLbnVrSKaw/9BydDphcNMTEwMTI4MTEyOTIwWjAAMCECDmFFoCuhKUeACQQHJ0PfFw0xMTAxMTExMDE3MzdaMAAwIQIOQTDdFh2fSPF6AAcnQ+AXDTExMDExMTEwMTcxMFowADAhAg5B8AOXX61FpvbbBydD5RcNMTAxMDA2MTAxNDM2WjAAMCECDh41P2Gmi7PkwI4HJ0PmFw0xMDEwMDYxMDE2MjVaMAAwIQIOWUHGLQCd+Ale9gcnQ/0XDTExMDUwMjA3NTYxMFowADAhAg5Z2c9AYkikmgWOBydD/hcNMTEwNTAyMDc1NjM0WjAAMCECDmf/UD+/h8nf+74HJ0QVFw0xMTA0MTUwNzI4MzNaMAAwIQIOICvj4epy3MrqfwcnRBYXDTExMDQxNTA3Mjg1NlowADAhAg4bouRMfOYqgv4xBydEHxcNMTEwMzA4MTYyNDI1WjAAMCECDhebWHGoKiTp7pEHJ0QgFw0xMTAzMDgxNjI0NDhaMAAwIQIOX+qnxxAqJ8LtawcnRDcXDTExMDEzMTE1MTIyOFowADAhAg4j0fICqZ+wkOdqBydEOBcNMTEwMTMxMTUxMTQxWjAAMCECDhmXjsV4SUpWtAMHJ0RLFw0xMTAxMjgxMTI0MTJaMAAwIQIODno/w+zG43kkTwcnREwXDTExMDEyODExMjM1MlowADAhAg4b1gc88767Fr+LBydETxcNMTEwMTI4MTEwMjA4WjAAMCECDn+M3Pa1w2nyFeUHJ0RQFw0xMTAxMjgxMDU4NDVaMAAwIQIOaduoyIH61tqybAcnRJUXDTEwMTIxNTA5NDMyMlowADAhAg4nLqQPkyi3ESAKBydElhcNMTAxMjE1MDk0MzM2WjAAMCECDi504NIMH8578gQHJ0SbFw0xMTAyMTQxNDA1NDFaMAAwIQIOGuaM8PDaC5u1egcnRJwXDTExMDIxNDE0MDYwNFowADAhAg4ehYq/BXGnB5PWBydEnxcNMTEwMjA0MDgwOTUxWjAAMCECDkSD4eS4FxW5H20HJ0SgFw0xMTAyMDQwODA5MjVaMAAwIQIOOCcb6ilYObt1egcnRKEXDTExMDEyNjEwNDEyOVowADAhAg58tISWCCwFnKGnBydEohcNMTEwMjA0MDgxMzQyWjAAMCECDn5rjtabY/L/WL0HJ0TJFw0xMTAyMDQxMTAzNDFaMAAwDQYJKoZIhvcNAQEFBQADggEBAGnF2Gs0+LNiYCW1Ipm83OXQYP/bd5tFFRzyz3iepFqNfYs4D68/QihjFoRHQoXEB0OEe1tvaVnnPGnEOpi6krwekquMxo4H88B5SlyiFIqemCOIss0SxlCFs69LmfRYvPPvPEhoXtQ3ZThe0UvKG83GOklhvGl6OaiRf4Mt+m8zOT4Wox/j6aOBK6cw6qKCdmD+Yj1rrNqFGg1CnSWMoD6S6mwNgkzwdBUJZ22BwrzAAo4RHa2Uy3ef1FjwD0XtU5N3uDSxGGBEDvOe5z82rps3E22FpAA8eYl8kaXtmWqyvYU0epp4brGuTxCuBMCAsxt/OjIjeNNQbBGkwxgfYA0=&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6853465">const</span>&nbsp;<span class="ident" id="6853471">pemCRLBase64</span>&nbsp;<span class="op" id="6853484">=</span>&nbsp;<span class="string" id="6853486">&#34;LS0tLS1CRUdJTiBYNTA5IENSTC0tLS0tDQpNSUlCOWpDQ0FWOENBUUV3RFFZSktvWklodmNOQVFFRkJRQXdiREVhTUJnR0ExVUVDaE1SVWxOQklGTmxZM1Z5DQphWFI1SUVsdVl5NHhIakFjQmdOVkJBTVRGVkpUUVNCUWRXSnNhV01nVW05dmRDQkRRU0IyTVRFdU1Dd0dDU3FHDQpTSWIzRFFFSkFSWWZjbk5oYTJWdmJuSnZiM1J6YVdkdVFISnpZWE5sWTNWeWFYUjVMbU52YlJjTk1URXdNakl6DQpNVGt5T0RNd1doY05NVEV3T0RJeU1Ua3lPRE13V2pDQmpEQktBaEVBckRxb2g5RkhKSFhUN09QZ3V1bjQrQmNODQpNRGt4TVRBeU1UUXlOekE1V2pBbU1Bb0dBMVVkRlFRRENnRUpNQmdHQTFVZEdBUVJHQTh5TURBNU1URXdNakUwDQpNalExTlZvd1BnSVJBTEd6blowOTVQQjVhQU9MUGc1N2ZNTVhEVEF5TVRBeU16RTBOVEF4TkZvd0dqQVlCZ05WDQpIUmdFRVJnUE1qQXdNakV3TWpNeE5EVXdNVFJhb0RBd0xqQWZCZ05WSFNNRUdEQVdnQlQxVERGNlVRTS9MTmVMDQpsNWx2cUhHUXEzZzltekFMQmdOVkhSUUVCQUlDQUlRd0RRWUpLb1pJaHZjTkFRRUZCUUFEZ1lFQUZVNUFzNk16DQpxNVBSc2lmYW9iUVBHaDFhSkx5QytNczVBZ2MwYld5QTNHQWR4dXI1U3BQWmVSV0NCamlQL01FSEJXSkNsQkhQDQpHUmNxNXlJZDNFakRrYUV5eFJhK2k2N0x6dmhJNmMyOUVlNks5cFNZd2ppLzdSVWhtbW5Qclh0VHhsTDBsckxyDQptUVFKNnhoRFJhNUczUUE0Q21VZHNITnZicnpnbUNZcHZWRT0NCi0tLS0tRU5EIFg1MDkgQ1JMLS0tLS0NCg0K&#34;</span><br>
<span class="lineno">755</span><br>
<span class="lineno"></span><span class="keyword" id="6854490">func</span>&nbsp;<span class="ident" id="6854495">TestCreateCertificateRequest</span><span class="op" id="6854523">(</span><span class="ident" id="6854524">t</span>&nbsp;<span class="op" id="6854526">*</span><span class="ident" id="6854527">testing</span><span class="op" id="6854534">.</span><span class="ident" id="6854535">T</span><span class="op" id="6854536">)</span>&nbsp;<span class="op" id="6854538">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6854541">random</span>&nbsp;<span class="op" id="6854548">:=</span>&nbsp;<span class="ident" id="6854551">rand</span><span class="op" id="6854555">.</span><span class="ident" id="6854556">Reader</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6854565">block</span><span class="op" id="6854570">,</span>&nbsp;<span class="ident" id="6854572">_</span>&nbsp;<span class="op" id="6854574">:=</span>&nbsp;<span class="ident" id="6854577">pem</span><span class="op" id="6854580">.</span><span class="ident" id="6854581">Decode</span><span class="op" id="6854587">(</span><span class="op" id="6854588">[</span><span class="op" id="6854589">]</span><span class="builtintype" id="6854590">byte</span><span class="op" id="6854594">(</span><span class="ident" id="6854595">pemPrivateKey</span><span class="op" id="6854608">)</span><span class="op" id="6854609">)</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6854612">rsaPriv</span><span class="op" id="6854619">,</span>&nbsp;<span class="ident" id="6854621">err</span>&nbsp;<span class="op" id="6854625">:=</span>&nbsp;<span class="ident" id="6854628">ParsePKCS1PrivateKey</span><span class="op" id="6854648">(</span><span class="ident" id="6854649">block</span><span class="op" id="6854654">.</span><span class="ident" id="6854655">Bytes</span><span class="op" id="6854660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6854663">if</span>&nbsp;<span class="ident" id="6854666">err</span>&nbsp;<span class="op" id="6854670">!=</span>&nbsp;<span class="ident" id="6854673">nil</span>&nbsp;<span class="op" id="6854677">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6854681">t</span><span class="op" id="6854682">.</span><span class="ident" id="6854683">Fatalf</span><span class="op" id="6854689">(</span><span class="string" id="6854690">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6854723">,</span>&nbsp;<span class="ident" id="6854725">err</span><span class="op" id="6854728">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6854731">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6854735">ecdsa256Priv</span><span class="op" id="6854747">,</span>&nbsp;<span class="ident" id="6854749">err</span>&nbsp;<span class="op" id="6854753">:=</span>&nbsp;<span class="ident" id="6854756">ecdsa</span><span class="op" id="6854761">.</span><span class="ident" id="6854762">GenerateKey</span><span class="op" id="6854773">(</span><span class="ident" id="6854774">elliptic</span><span class="op" id="6854782">.</span><span class="ident" id="6854783">P256</span><span class="op" id="6854787">(</span><span class="op" id="6854788">)</span><span class="op" id="6854789">,</span>&nbsp;<span class="ident" id="6854791">rand</span><span class="op" id="6854795">.</span><span class="ident" id="6854796">Reader</span><span class="op" id="6854802">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6854805">if</span>&nbsp;<span class="ident" id="6854808">err</span>&nbsp;<span class="op" id="6854812">!=</span>&nbsp;<span class="ident" id="6854815">nil</span>&nbsp;<span class="op" id="6854819">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6854823">t</span><span class="op" id="6854824">.</span><span class="ident" id="6854825">Fatalf</span><span class="op" id="6854831">(</span><span class="string" id="6854832">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6854866">,</span>&nbsp;<span class="ident" id="6854868">err</span><span class="op" id="6854871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6854874">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6854878">ecdsa384Priv</span><span class="op" id="6854890">,</span>&nbsp;<span class="ident" id="6854892">err</span>&nbsp;<span class="op" id="6854896">:=</span>&nbsp;<span class="ident" id="6854899">ecdsa</span><span class="op" id="6854904">.</span><span class="ident" id="6854905">GenerateKey</span><span class="op" id="6854916">(</span><span class="ident" id="6854917">elliptic</span><span class="op" id="6854925">.</span><span class="ident" id="6854926">P384</span><span class="op" id="6854930">(</span><span class="op" id="6854931">)</span><span class="op" id="6854932">,</span>&nbsp;<span class="ident" id="6854934">rand</span><span class="op" id="6854938">.</span><span class="ident" id="6854939">Reader</span><span class="op" id="6854945">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6854948">if</span>&nbsp;<span class="ident" id="6854951">err</span>&nbsp;<span class="op" id="6854955">!=</span>&nbsp;<span class="ident" id="6854958">nil</span>&nbsp;<span class="op" id="6854962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6854966">t</span><span class="op" id="6854967">.</span><span class="ident" id="6854968">Fatalf</span><span class="op" id="6854974">(</span><span class="string" id="6854975">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6855009">,</span>&nbsp;<span class="ident" id="6855011">err</span><span class="op" id="6855014">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6855017">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6855021">ecdsa521Priv</span><span class="op" id="6855033">,</span>&nbsp;<span class="ident" id="6855035">err</span>&nbsp;<span class="op" id="6855039">:=</span>&nbsp;<span class="ident" id="6855042">ecdsa</span><span class="op" id="6855047">.</span><span class="ident" id="6855048">GenerateKey</span><span class="op" id="6855059">(</span><span class="ident" id="6855060">elliptic</span><span class="op" id="6855068">.</span><span class="ident" id="6855069">P521</span><span class="op" id="6855073">(</span><span class="op" id="6855074">)</span><span class="op" id="6855075">,</span>&nbsp;<span class="ident" id="6855077">rand</span><span class="op" id="6855081">.</span><span class="ident" id="6855082">Reader</span><span class="op" id="6855088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6855091">if</span>&nbsp;<span class="ident" id="6855094">err</span>&nbsp;<span class="op" id="6855098">!=</span>&nbsp;<span class="ident" id="6855101">nil</span>&nbsp;<span class="op" id="6855105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6855109">t</span><span class="op" id="6855110">.</span><span class="ident" id="6855111">Fatalf</span><span class="op" id="6855117">(</span><span class="string" id="6855118">&#34;Failed&nbsp;to&nbsp;generate&nbsp;ECDSA&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6855152">,</span>&nbsp;<span class="ident" id="6855154">err</span><span class="op" id="6855157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6855160">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6855164">tests</span>&nbsp;<span class="op" id="6855170">:=</span>&nbsp;<span class="op" id="6855173">[</span><span class="op" id="6855174">]</span><span class="keyword" id="6855175">struct</span>&nbsp;<span class="op" id="6855182">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6855186">name</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6855194">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6855203">priv</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="6855211">interface</span><span class="op" id="6855220">{</span><span class="op" id="6855221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6855225">sigAlgo</span>&nbsp;<span class="ident" id="6855233">SignatureAlgorithm</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6855253">}</span><span class="op" id="6855254">{</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6855258">{</span><span class="string" id="6855259">&#34;RSA&#34;</span><span class="op" id="6855264">,</span>&nbsp;<span class="ident" id="6855266">rsaPriv</span><span class="op" id="6855273">,</span>&nbsp;<span class="ident" id="6855275">SHA1WithRSA</span><span class="op" id="6855286">}</span><span class="op" id="6855287">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6855291">{</span><span class="string" id="6855292">&#34;ECDSA-256&#34;</span><span class="op" id="6855303">,</span>&nbsp;<span class="ident" id="6855305">ecdsa256Priv</span><span class="op" id="6855317">,</span>&nbsp;<span class="ident" id="6855319">ECDSAWithSHA1</span><span class="op" id="6855332">}</span><span class="op" id="6855333">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6855337">{</span><span class="string" id="6855338">&#34;ECDSA-384&#34;</span><span class="op" id="6855349">,</span>&nbsp;<span class="ident" id="6855351">ecdsa384Priv</span><span class="op" id="6855363">,</span>&nbsp;<span class="ident" id="6855365">ECDSAWithSHA1</span><span class="op" id="6855378">}</span><span class="op" id="6855379">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6855383">{</span><span class="string" id="6855384">&#34;ECDSA-521&#34;</span><span class="op" id="6855395">,</span>&nbsp;<span class="ident" id="6855397">ecdsa521Priv</span><span class="op" id="6855409">,</span>&nbsp;<span class="ident" id="6855411">ECDSAWithSHA1</span><span class="op" id="6855424">}</span><span class="op" id="6855425">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6855428">}</span><br>
<span class="lineno">790</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6855432">for</span>&nbsp;<span class="ident" id="6855436">_</span><span class="op" id="6855437">,</span>&nbsp;<span class="ident" id="6855439">test</span>&nbsp;<span class="op" id="6855444">:=</span>&nbsp;<span class="keyword" id="6855447">range</span>&nbsp;<span class="ident" id="6855453">tests</span>&nbsp;<span class="op" id="6855459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6855463">template</span>&nbsp;<span class="op" id="6855472">:=</span>&nbsp;<span class="ident" id="6855475">CertificateRequest</span><span class="op" id="6855493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6855498">Subject</span><span class="op" id="6855505">:</span>&nbsp;<span class="ident" id="6855507">pkix</span><span class="op" id="6855511">.</span><span class="ident" id="6855512">Name</span><span class="op" id="6855516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6855522">CommonName</span><span class="op" id="6855532">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6855536">&#34;test.example.com&#34;</span><span class="op" id="6855554">,</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6855560">Organization</span><span class="op" id="6855572">:</span>&nbsp;<span class="op" id="6855574">[</span><span class="op" id="6855575">]</span><span class="builtintype" id="6855576">string</span><span class="op" id="6855582">{</span><span class="string" id="6855583">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="6855595">}</span><span class="op" id="6855596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6855601">}</span><span class="op" id="6855602">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6855607">SignatureAlgorithm</span><span class="op" id="6855625">:</span>&nbsp;<span class="ident" id="6855627">test</span><span class="op" id="6855631">.</span><span class="ident" id="6855632">sigAlgo</span><span class="op" id="6855639">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6855644">DNSNames</span><span class="op" id="6855652">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6855664">[</span><span class="op" id="6855665">]</span><span class="builtintype" id="6855666">string</span><span class="op" id="6855672">{</span><span class="string" id="6855673">&#34;test.example.com&#34;</span><span class="op" id="6855691">}</span><span class="op" id="6855692">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6855697">EmailAddresses</span><span class="op" id="6855711">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6855717">[</span><span class="op" id="6855718">]</span><span class="builtintype" id="6855719">string</span><span class="op" id="6855725">{</span><span class="string" id="6855726">&#34;gopher@golang.org&#34;</span><span class="op" id="6855745">}</span><span class="op" id="6855746">,</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6855751">IPAddresses</span><span class="op" id="6855762">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6855771">[</span><span class="op" id="6855772">]</span><span class="ident" id="6855773">net</span><span class="op" id="6855776">.</span><span class="ident" id="6855777">IP</span><span class="op" id="6855779">{</span><span class="ident" id="6855780">net</span><span class="op" id="6855783">.</span><span class="ident" id="6855784">IPv4</span><span class="op" id="6855788">(</span><span class="num" id="6855789">127</span><span class="op" id="6855792">,</span>&nbsp;<span class="num" id="6855794">0</span><span class="op" id="6855795">,</span>&nbsp;<span class="num" id="6855797">0</span><span class="op" id="6855798">,</span>&nbsp;<span class="num" id="6855800">1</span><span class="op" id="6855801">)</span><span class="op" id="6855802">.</span><span class="ident" id="6855803">To4</span><span class="op" id="6855806">(</span><span class="op" id="6855807">)</span><span class="op" id="6855808">,</span>&nbsp;<span class="ident" id="6855810">net</span><span class="op" id="6855813">.</span><span class="ident" id="6855814">ParseIP</span><span class="op" id="6855821">(</span><span class="string" id="6855822">&#34;2001:4860:0:2001::68&#34;</span><span class="op" id="6855844">)</span><span class="op" id="6855845">}</span><span class="op" id="6855846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6855850">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6855855">derBytes</span><span class="op" id="6855863">,</span>&nbsp;<span class="ident" id="6855865">err</span>&nbsp;<span class="op" id="6855869">:=</span>&nbsp;<span class="ident" id="6855872">CreateCertificateRequest</span><span class="op" id="6855896">(</span><span class="ident" id="6855897">random</span><span class="op" id="6855903">,</span>&nbsp;<span class="op" id="6855905">&amp;</span><span class="ident" id="6855906">template</span><span class="op" id="6855914">,</span>&nbsp;<span class="ident" id="6855916">test</span><span class="op" id="6855920">.</span><span class="ident" id="6855921">priv</span><span class="op" id="6855925">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6855929">if</span>&nbsp;<span class="ident" id="6855932">err</span>&nbsp;<span class="op" id="6855936">!=</span>&nbsp;<span class="ident" id="6855939">nil</span>&nbsp;<span class="op" id="6855943">{</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6855948">t</span><span class="op" id="6855949">.</span><span class="ident" id="6855950">Errorf</span><span class="op" id="6855956">(</span><span class="string" id="6855957">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="6856003">,</span>&nbsp;<span class="ident" id="6856005">test</span><span class="op" id="6856009">.</span><span class="ident" id="6856010">name</span><span class="op" id="6856014">,</span>&nbsp;<span class="ident" id="6856016">err</span><span class="op" id="6856019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6856024">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6856035">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856040">out</span><span class="op" id="6856043">,</span>&nbsp;<span class="ident" id="6856045">err</span>&nbsp;<span class="op" id="6856049">:=</span>&nbsp;<span class="ident" id="6856052">ParseCertificateRequest</span><span class="op" id="6856075">(</span><span class="ident" id="6856076">derBytes</span><span class="op" id="6856084">)</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6856088">if</span>&nbsp;<span class="ident" id="6856091">err</span>&nbsp;<span class="op" id="6856095">!=</span>&nbsp;<span class="ident" id="6856098">nil</span>&nbsp;<span class="op" id="6856102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856107">t</span><span class="op" id="6856108">.</span><span class="ident" id="6856109">Errorf</span><span class="op" id="6856115">(</span><span class="string" id="6856116">&#34;%s:&nbsp;failed&nbsp;to&nbsp;create&nbsp;certificate&nbsp;request:&nbsp;%s&#34;</span><span class="op" id="6856162">,</span>&nbsp;<span class="ident" id="6856164">test</span><span class="op" id="6856168">.</span><span class="ident" id="6856169">name</span><span class="op" id="6856173">,</span>&nbsp;<span class="ident" id="6856175">err</span><span class="op" id="6856178">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6856183">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6856194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6856199">if</span>&nbsp;<span class="ident" id="6856202">out</span><span class="op" id="6856205">.</span><span class="ident" id="6856206">Subject</span><span class="op" id="6856213">.</span><span class="ident" id="6856214">CommonName</span>&nbsp;<span class="op" id="6856225">!=</span>&nbsp;<span class="ident" id="6856228">template</span><span class="op" id="6856236">.</span><span class="ident" id="6856237">Subject</span><span class="op" id="6856244">.</span><span class="ident" id="6856245">CommonName</span>&nbsp;<span class="op" id="6856256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856261">t</span><span class="op" id="6856262">.</span><span class="ident" id="6856263">Errorf</span><span class="op" id="6856269">(</span><span class="string" id="6856270">&#34;%s:&nbsp;output&nbsp;subject&nbsp;common&nbsp;name&nbsp;and&nbsp;template&nbsp;subject&nbsp;common&nbsp;name&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="6856347">,</span>&nbsp;<span class="ident" id="6856349">test</span><span class="op" id="6856353">.</span><span class="ident" id="6856354">name</span><span class="op" id="6856358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6856362">}</span>&nbsp;<span class="keyword" id="6856364">else</span>&nbsp;<span class="keyword" id="6856369">if</span>&nbsp;<span class="builtinfunc" id="6856372">len</span><span class="op" id="6856375">(</span><span class="ident" id="6856376">out</span><span class="op" id="6856379">.</span><span class="ident" id="6856380">Subject</span><span class="op" id="6856387">.</span><span class="ident" id="6856388">Organization</span><span class="op" id="6856400">)</span>&nbsp;<span class="op" id="6856402">!=</span>&nbsp;<span class="builtinfunc" id="6856405">len</span><span class="op" id="6856408">(</span><span class="ident" id="6856409">template</span><span class="op" id="6856417">.</span><span class="ident" id="6856418">Subject</span><span class="op" id="6856425">.</span><span class="ident" id="6856426">Organization</span><span class="op" id="6856438">)</span>&nbsp;<span class="op" id="6856440">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856445">t</span><span class="op" id="6856446">.</span><span class="ident" id="6856447">Errorf</span><span class="op" id="6856453">(</span><span class="string" id="6856454">&#34;%s:&nbsp;output&nbsp;subject&nbsp;organisation&nbsp;and&nbsp;template&nbsp;subject&nbsp;organisation&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="6856533">,</span>&nbsp;<span class="ident" id="6856535">test</span><span class="op" id="6856539">.</span><span class="ident" id="6856540">name</span><span class="op" id="6856544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6856548">}</span>&nbsp;<span class="keyword" id="6856550">else</span>&nbsp;<span class="keyword" id="6856555">if</span>&nbsp;<span class="builtinfunc" id="6856558">len</span><span class="op" id="6856561">(</span><span class="ident" id="6856562">out</span><span class="op" id="6856565">.</span><span class="ident" id="6856566">DNSNames</span><span class="op" id="6856574">)</span>&nbsp;<span class="op" id="6856576">!=</span>&nbsp;<span class="builtinfunc" id="6856579">len</span><span class="op" id="6856582">(</span><span class="ident" id="6856583">template</span><span class="op" id="6856591">.</span><span class="ident" id="6856592">DNSNames</span><span class="op" id="6856600">)</span>&nbsp;<span class="op" id="6856602">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856607">t</span><span class="op" id="6856608">.</span><span class="ident" id="6856609">Errorf</span><span class="op" id="6856615">(</span><span class="string" id="6856616">&#34;%s:&nbsp;output&nbsp;DNS&nbsp;names&nbsp;and&nbsp;template&nbsp;DNS&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="6856673">,</span>&nbsp;<span class="ident" id="6856675">test</span><span class="op" id="6856679">.</span><span class="ident" id="6856680">name</span><span class="op" id="6856684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6856688">}</span>&nbsp;<span class="keyword" id="6856690">else</span>&nbsp;<span class="keyword" id="6856695">if</span>&nbsp;<span class="builtinfunc" id="6856698">len</span><span class="op" id="6856701">(</span><span class="ident" id="6856702">out</span><span class="op" id="6856705">.</span><span class="ident" id="6856706">EmailAddresses</span><span class="op" id="6856720">)</span>&nbsp;<span class="op" id="6856722">!=</span>&nbsp;<span class="builtinfunc" id="6856725">len</span><span class="op" id="6856728">(</span><span class="ident" id="6856729">template</span><span class="op" id="6856737">.</span><span class="ident" id="6856738">EmailAddresses</span><span class="op" id="6856752">)</span>&nbsp;<span class="op" id="6856754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856759">t</span><span class="op" id="6856760">.</span><span class="ident" id="6856761">Errorf</span><span class="op" id="6856767">(</span><span class="string" id="6856768">&#34;%s:&nbsp;output&nbsp;email&nbsp;addresses&nbsp;and&nbsp;template&nbsp;email&nbsp;addresses&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="6856837">,</span>&nbsp;<span class="ident" id="6856839">test</span><span class="op" id="6856843">.</span><span class="ident" id="6856844">name</span><span class="op" id="6856848">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6856852">}</span>&nbsp;<span class="keyword" id="6856854">else</span>&nbsp;<span class="keyword" id="6856859">if</span>&nbsp;<span class="builtinfunc" id="6856862">len</span><span class="op" id="6856865">(</span><span class="ident" id="6856866">out</span><span class="op" id="6856869">.</span><span class="ident" id="6856870">IPAddresses</span><span class="op" id="6856881">)</span>&nbsp;<span class="op" id="6856883">!=</span>&nbsp;<span class="builtinfunc" id="6856886">len</span><span class="op" id="6856889">(</span><span class="ident" id="6856890">template</span><span class="op" id="6856898">.</span><span class="ident" id="6856899">IPAddresses</span><span class="op" id="6856910">)</span>&nbsp;<span class="op" id="6856912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6856917">t</span><span class="op" id="6856918">.</span><span class="ident" id="6856919">Errorf</span><span class="op" id="6856925">(</span><span class="string" id="6856926">&#34;%s:&nbsp;output&nbsp;IP&nbsp;addresses&nbsp;and&nbsp;template&nbsp;IP&nbsp;addresses&nbsp;names&nbsp;don&#39;t&nbsp;match&#34;</span><span class="op" id="6856995">,</span>&nbsp;<span class="ident" id="6856997">test</span><span class="op" id="6857001">.</span><span class="ident" id="6857002">name</span><span class="op" id="6857006">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6857010">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6857013">}</span><br>
<span class="lineno"></span><span class="op" id="6857015">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6857018">func</span>&nbsp;<span class="ident" id="6857023">marshalAndParseCSR</span><span class="op" id="6857041">(</span><span class="ident" id="6857042">t</span>&nbsp;<span class="op" id="6857044">*</span><span class="ident" id="6857045">testing</span><span class="op" id="6857052">.</span><span class="ident" id="6857053">T</span><span class="op" id="6857054">,</span>&nbsp;<span class="ident" id="6857056">template</span>&nbsp;<span class="op" id="6857065">*</span><span class="ident" id="6857066">CertificateRequest</span><span class="op" id="6857084">)</span>&nbsp;<span class="op" id="6857086">*</span><span class="ident" id="6857087">CertificateRequest</span>&nbsp;<span class="op" id="6857106">{</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857109">block</span><span class="op" id="6857114">,</span>&nbsp;<span class="ident" id="6857116">_</span>&nbsp;<span class="op" id="6857118">:=</span>&nbsp;<span class="ident" id="6857121">pem</span><span class="op" id="6857124">.</span><span class="ident" id="6857125">Decode</span><span class="op" id="6857131">(</span><span class="op" id="6857132">[</span><span class="op" id="6857133">]</span><span class="builtintype" id="6857134">byte</span><span class="op" id="6857138">(</span><span class="ident" id="6857139">pemPrivateKey</span><span class="op" id="6857152">)</span><span class="op" id="6857153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857156">rsaPriv</span><span class="op" id="6857163">,</span>&nbsp;<span class="ident" id="6857165">err</span>&nbsp;<span class="op" id="6857169">:=</span>&nbsp;<span class="ident" id="6857172">ParsePKCS1PrivateKey</span><span class="op" id="6857192">(</span><span class="ident" id="6857193">block</span><span class="op" id="6857198">.</span><span class="ident" id="6857199">Bytes</span><span class="op" id="6857204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6857207">if</span>&nbsp;<span class="ident" id="6857210">err</span>&nbsp;<span class="op" id="6857214">!=</span>&nbsp;<span class="ident" id="6857217">nil</span>&nbsp;<span class="op" id="6857221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857225">t</span><span class="op" id="6857226">.</span><span class="ident" id="6857227">Fatal</span><span class="op" id="6857232">(</span><span class="ident" id="6857233">err</span><span class="op" id="6857236">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6857239">}</span><br>
<span class="lineno">835</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857243">derBytes</span><span class="op" id="6857251">,</span>&nbsp;<span class="ident" id="6857253">err</span>&nbsp;<span class="op" id="6857257">:=</span>&nbsp;<span class="ident" id="6857260">CreateCertificateRequest</span><span class="op" id="6857284">(</span><span class="ident" id="6857285">rand</span><span class="op" id="6857289">.</span><span class="ident" id="6857290">Reader</span><span class="op" id="6857296">,</span>&nbsp;<span class="ident" id="6857298">template</span><span class="op" id="6857306">,</span>&nbsp;<span class="ident" id="6857308">rsaPriv</span><span class="op" id="6857315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6857318">if</span>&nbsp;<span class="ident" id="6857321">err</span>&nbsp;<span class="op" id="6857325">!=</span>&nbsp;<span class="ident" id="6857328">nil</span>&nbsp;<span class="op" id="6857332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857336">t</span><span class="op" id="6857337">.</span><span class="ident" id="6857338">Fatal</span><span class="op" id="6857343">(</span><span class="ident" id="6857344">err</span><span class="op" id="6857347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6857350">}</span><br>
<span class="lineno">840</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857354">csr</span><span class="op" id="6857357">,</span>&nbsp;<span class="ident" id="6857359">err</span>&nbsp;<span class="op" id="6857363">:=</span>&nbsp;<span class="ident" id="6857366">ParseCertificateRequest</span><span class="op" id="6857389">(</span><span class="ident" id="6857390">derBytes</span><span class="op" id="6857398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6857401">if</span>&nbsp;<span class="ident" id="6857404">err</span>&nbsp;<span class="op" id="6857408">!=</span>&nbsp;<span class="ident" id="6857411">nil</span>&nbsp;<span class="op" id="6857415">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857419">t</span><span class="op" id="6857420">.</span><span class="ident" id="6857421">Fatal</span><span class="op" id="6857426">(</span><span class="ident" id="6857427">err</span><span class="op" id="6857430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6857433">}</span><br>
<span class="lineno">845</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6857437">return</span>&nbsp;<span class="ident" id="6857444">csr</span><br>
<span class="lineno"></span><span class="op" id="6857448">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6857451">func</span>&nbsp;<span class="ident" id="6857456">TestCertificateRequestOverrides</span><span class="op" id="6857487">(</span><span class="ident" id="6857488">t</span>&nbsp;<span class="op" id="6857490">*</span><span class="ident" id="6857491">testing</span><span class="op" id="6857498">.</span><span class="ident" id="6857499">T</span><span class="op" id="6857500">)</span>&nbsp;<span class="op" id="6857502">{</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857505">sanContents</span><span class="op" id="6857516">,</span>&nbsp;<span class="ident" id="6857518">err</span>&nbsp;<span class="op" id="6857522">:=</span>&nbsp;<span class="ident" id="6857525">marshalSANs</span><span class="op" id="6857536">(</span><span class="op" id="6857537">[</span><span class="op" id="6857538">]</span><span class="builtintype" id="6857539">string</span><span class="op" id="6857545">{</span><span class="string" id="6857546">&#34;foo.example.com&#34;</span><span class="op" id="6857563">}</span><span class="op" id="6857564">,</span>&nbsp;<span class="ident" id="6857566">nil</span><span class="op" id="6857569">,</span>&nbsp;<span class="ident" id="6857571">nil</span><span class="op" id="6857574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6857577">if</span>&nbsp;<span class="ident" id="6857580">err</span>&nbsp;<span class="op" id="6857584">!=</span>&nbsp;<span class="ident" id="6857587">nil</span>&nbsp;<span class="op" id="6857591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857595">t</span><span class="op" id="6857596">.</span><span class="ident" id="6857597">Fatal</span><span class="op" id="6857602">(</span><span class="ident" id="6857603">err</span><span class="op" id="6857606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6857609">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857613">template</span>&nbsp;<span class="op" id="6857622">:=</span>&nbsp;<span class="ident" id="6857625">CertificateRequest</span><span class="op" id="6857643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857647">Subject</span><span class="op" id="6857654">:</span>&nbsp;<span class="ident" id="6857656">pkix</span><span class="op" id="6857660">.</span><span class="ident" id="6857661">Name</span><span class="op" id="6857665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857670">CommonName</span><span class="op" id="6857680">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="6857684">&#34;test.example.com&#34;</span><span class="op" id="6857702">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857707">Organization</span><span class="op" id="6857719">:</span>&nbsp;<span class="op" id="6857721">[</span><span class="op" id="6857722">]</span><span class="builtintype" id="6857723">string</span><span class="op" id="6857729">{</span><span class="string" id="6857730">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="6857742">}</span><span class="op" id="6857743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6857747">}</span><span class="op" id="6857748">,</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857752">DNSNames</span><span class="op" id="6857760">:</span>&nbsp;<span class="op" id="6857762">[</span><span class="op" id="6857763">]</span><span class="builtintype" id="6857764">string</span><span class="op" id="6857770">{</span><span class="string" id="6857771">&#34;test.example.com&#34;</span><span class="op" id="6857789">}</span><span class="op" id="6857790">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6857795">//&nbsp;An&nbsp;explicit&nbsp;extension&nbsp;should&nbsp;override&nbsp;the&nbsp;DNSNames&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6857860">//&nbsp;template.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857875">ExtraExtensions</span><span class="op" id="6857890">:</span>&nbsp;<span class="op" id="6857892">[</span><span class="op" id="6857893">]</span><span class="ident" id="6857894">pkix</span><span class="op" id="6857898">.</span><span class="ident" id="6857899">Extension</span><span class="op" id="6857908">{</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6857913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857919">Id</span><span class="op" id="6857921">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6857926">oidExtensionSubjectAltName</span><span class="op" id="6857952">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857958">Value</span><span class="op" id="6857963">:</span>&nbsp;<span class="ident" id="6857965">sanContents</span><span class="op" id="6857976">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6857981">}</span><span class="op" id="6857982">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6857986">}</span><span class="op" id="6857987">,</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6857990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6857994">csr</span>&nbsp;<span class="op" id="6857998">:=</span>&nbsp;<span class="ident" id="6858001">marshalAndParseCSR</span><span class="op" id="6858019">(</span><span class="ident" id="6858020">t</span><span class="op" id="6858021">,</span>&nbsp;<span class="op" id="6858023">&amp;</span><span class="ident" id="6858024">template</span><span class="op" id="6858032">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6858036">if</span>&nbsp;<span class="builtinfunc" id="6858039">len</span><span class="op" id="6858042">(</span><span class="ident" id="6858043">csr</span><span class="op" id="6858046">.</span><span class="ident" id="6858047">DNSNames</span><span class="op" id="6858055">)</span>&nbsp;<span class="op" id="6858057">!=</span>&nbsp;<span class="num" id="6858060">1</span>&nbsp;<span class="op" id="6858062">||</span>&nbsp;<span class="ident" id="6858065">csr</span><span class="op" id="6858068">.</span><span class="ident" id="6858069">DNSNames</span><span class="op" id="6858077">[</span><span class="num" id="6858078">0</span><span class="op" id="6858079">]</span>&nbsp;<span class="op" id="6858081">!=</span>&nbsp;<span class="string" id="6858084">&#34;foo.example.com&#34;</span>&nbsp;<span class="op" id="6858102">{</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858106">t</span><span class="op" id="6858107">.</span><span class="ident" id="6858108">Errorf</span><span class="op" id="6858114">(</span><span class="string" id="6858115">&#34;Extension&nbsp;did&nbsp;not&nbsp;override&nbsp;template.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="6858162">,</span>&nbsp;<span class="ident" id="6858164">csr</span><span class="op" id="6858167">.</span><span class="ident" id="6858168">DNSNames</span><span class="op" id="6858176">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6858179">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6858183">//&nbsp;If&nbsp;there&nbsp;is&nbsp;already&nbsp;an&nbsp;attribute&nbsp;with&nbsp;X.509&nbsp;extensions&nbsp;then&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6858251">//&nbsp;extra&nbsp;extensions&nbsp;should&nbsp;be&nbsp;added&nbsp;to&nbsp;it&nbsp;rather&nbsp;than&nbsp;creating&nbsp;a&nbsp;CSR</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6858321">//&nbsp;with&nbsp;two&nbsp;extension&nbsp;attributes.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858357">template</span><span class="op" id="6858365">.</span><span class="ident" id="6858366">Attributes</span>&nbsp;<span class="op" id="6858377">=</span>&nbsp;<span class="op" id="6858379">[</span><span class="op" id="6858380">]</span><span class="ident" id="6858381">pkix</span><span class="op" id="6858385">.</span><span class="ident" id="6858386">AttributeTypeAndValueSET</span><span class="op" id="6858410">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6858414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858419">Type</span><span class="op" id="6858423">:</span>&nbsp;<span class="ident" id="6858425">oidExtensionRequest</span><span class="op" id="6858444">,</span><br>
<span class="lineno">885</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858449">Value</span><span class="op" id="6858454">:</span>&nbsp;<span class="op" id="6858456">[</span><span class="op" id="6858457">]</span><span class="op" id="6858458">[</span><span class="op" id="6858459">]</span><span class="ident" id="6858460">pkix</span><span class="op" id="6858464">.</span><span class="ident" id="6858465">AttributeTypeAndValue</span><span class="op" id="6858486">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6858492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6858499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858507">Type</span><span class="op" id="6858511">:</span>&nbsp;&nbsp;<span class="ident" id="6858514">oidExtensionAuthorityInfoAccess</span><span class="op" id="6858545">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858553">Value</span><span class="op" id="6858558">:</span>&nbsp;<span class="op" id="6858560">[</span><span class="op" id="6858561">]</span><span class="builtintype" id="6858562">byte</span><span class="op" id="6858566">(</span><span class="string" id="6858567">&#34;foo&#34;</span><span class="op" id="6858572">)</span><span class="op" id="6858573">,</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6858580">}</span><span class="op" id="6858581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6858587">}</span><span class="op" id="6858588">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6858593">}</span><span class="op" id="6858594">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6858598">}</span><span class="op" id="6858599">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6858602">}</span><br>
<span class="lineno">895</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858606">csr</span>&nbsp;<span class="op" id="6858610">=</span>&nbsp;<span class="ident" id="6858612">marshalAndParseCSR</span><span class="op" id="6858630">(</span><span class="ident" id="6858631">t</span><span class="op" id="6858632">,</span>&nbsp;<span class="op" id="6858634">&amp;</span><span class="ident" id="6858635">template</span><span class="op" id="6858643">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6858646">if</span>&nbsp;<span class="ident" id="6858649">l</span>&nbsp;<span class="op" id="6858651">:=</span>&nbsp;<span class="builtinfunc" id="6858654">len</span><span class="op" id="6858657">(</span><span class="ident" id="6858658">csr</span><span class="op" id="6858661">.</span><span class="ident" id="6858662">Attributes</span><span class="op" id="6858672">)</span><span class="op" id="6858673">;</span>&nbsp;<span class="ident" id="6858675">l</span>&nbsp;<span class="op" id="6858677">!=</span>&nbsp;<span class="num" id="6858680">1</span>&nbsp;<span class="op" id="6858682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858686">t</span><span class="op" id="6858687">.</span><span class="ident" id="6858688">Errorf</span><span class="op" id="6858694">(</span><span class="string" id="6858695">&#34;incorrect&nbsp;number&nbsp;of&nbsp;attributes:&nbsp;%d\n&#34;</span><span class="op" id="6858733">,</span>&nbsp;<span class="ident" id="6858735">l</span><span class="op" id="6858736">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6858739">}</span><br>
<span class="lineno">900</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6858743">if</span>&nbsp;<span class="op" id="6858746">!</span><span class="ident" id="6858747">csr</span><span class="op" id="6858750">.</span><span class="ident" id="6858751">Attributes</span><span class="op" id="6858761">[</span><span class="num" id="6858762">0</span><span class="op" id="6858763">]</span><span class="op" id="6858764">.</span><span class="ident" id="6858765">Type</span><span class="op" id="6858769">.</span><span class="ident" id="6858770">Equal</span><span class="op" id="6858775">(</span><span class="ident" id="6858776">oidExtensionRequest</span><span class="op" id="6858795">)</span>&nbsp;<span class="op" id="6858797">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6858802">len</span><span class="op" id="6858805">(</span><span class="ident" id="6858806">csr</span><span class="op" id="6858809">.</span><span class="ident" id="6858810">Attributes</span><span class="op" id="6858820">[</span><span class="num" id="6858821">0</span><span class="op" id="6858822">]</span><span class="op" id="6858823">.</span><span class="ident" id="6858824">Value</span><span class="op" id="6858829">)</span>&nbsp;<span class="op" id="6858831">!=</span>&nbsp;<span class="num" id="6858834">1</span>&nbsp;<span class="op" id="6858836">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6858841">len</span><span class="op" id="6858844">(</span><span class="ident" id="6858845">csr</span><span class="op" id="6858848">.</span><span class="ident" id="6858849">Attributes</span><span class="op" id="6858859">[</span><span class="num" id="6858860">0</span><span class="op" id="6858861">]</span><span class="op" id="6858862">.</span><span class="ident" id="6858863">Value</span><span class="op" id="6858868">[</span><span class="num" id="6858869">0</span><span class="op" id="6858870">]</span><span class="op" id="6858871">)</span>&nbsp;<span class="op" id="6858873">!=</span>&nbsp;<span class="num" id="6858876">2</span>&nbsp;<span class="op" id="6858878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858882">t</span><span class="op" id="6858883">.</span><span class="ident" id="6858884">Errorf</span><span class="op" id="6858890">(</span><span class="string" id="6858891">&#34;bad&nbsp;attributes:&nbsp;%#v\n&#34;</span><span class="op" id="6858914">,</span>&nbsp;<span class="ident" id="6858916">csr</span><span class="op" id="6858919">.</span><span class="ident" id="6858920">Attributes</span><span class="op" id="6858930">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6858933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6858937">sanContents2</span><span class="op" id="6858949">,</span>&nbsp;<span class="ident" id="6858951">err</span>&nbsp;<span class="op" id="6858955">:=</span>&nbsp;<span class="ident" id="6858958">marshalSANs</span><span class="op" id="6858969">(</span><span class="op" id="6858970">[</span><span class="op" id="6858971">]</span><span class="builtintype" id="6858972">string</span><span class="op" id="6858978">{</span><span class="string" id="6858979">&#34;foo2.example.com&#34;</span><span class="op" id="6858997">}</span><span class="op" id="6858998">,</span>&nbsp;<span class="ident" id="6859000">nil</span><span class="op" id="6859003">,</span>&nbsp;<span class="ident" id="6859005">nil</span><span class="op" id="6859008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6859011">if</span>&nbsp;<span class="ident" id="6859014">err</span>&nbsp;<span class="op" id="6859018">!=</span>&nbsp;<span class="ident" id="6859021">nil</span>&nbsp;<span class="op" id="6859025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6859029">t</span><span class="op" id="6859030">.</span><span class="ident" id="6859031">Fatal</span><span class="op" id="6859036">(</span><span class="ident" id="6859037">err</span><span class="op" id="6859040">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6859043">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6859047">//&nbsp;Extensions&nbsp;in&nbsp;Attributes&nbsp;should&nbsp;override&nbsp;those&nbsp;in&nbsp;ExtraExtensions.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6859118">template</span><span class="op" id="6859126">.</span><span class="ident" id="6859127">Attributes</span><span class="op" id="6859137">[</span><span class="num" id="6859138">0</span><span class="op" id="6859139">]</span><span class="op" id="6859140">.</span><span class="ident" id="6859141">Value</span><span class="op" id="6859146">[</span><span class="num" id="6859147">0</span><span class="op" id="6859148">]</span>&nbsp;<span class="op" id="6859150">=</span>&nbsp;<span class="builtinfunc" id="6859152">append</span><span class="op" id="6859158">(</span><span class="ident" id="6859159">template</span><span class="op" id="6859167">.</span><span class="ident" id="6859168">Attributes</span><span class="op" id="6859178">[</span><span class="num" id="6859179">0</span><span class="op" id="6859180">]</span><span class="op" id="6859181">.</span><span class="ident" id="6859182">Value</span><span class="op" id="6859187">[</span><span class="num" id="6859188">0</span><span class="op" id="6859189">]</span><span class="op" id="6859190">,</span>&nbsp;<span class="ident" id="6859192">pkix</span><span class="op" id="6859196">.</span><span class="ident" id="6859197">AttributeTypeAndValue</span><span class="op" id="6859218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6859222">Type</span><span class="op" id="6859226">:</span>&nbsp;&nbsp;<span class="ident" id="6859229">oidExtensionSubjectAltName</span><span class="op" id="6859255">,</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6859259">Value</span><span class="op" id="6859264">:</span>&nbsp;<span class="ident" id="6859266">sanContents2</span><span class="op" id="6859278">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6859281">}</span><span class="op" id="6859282">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6859286">csr</span>&nbsp;<span class="op" id="6859290">=</span>&nbsp;<span class="ident" id="6859292">marshalAndParseCSR</span><span class="op" id="6859310">(</span><span class="ident" id="6859311">t</span><span class="op" id="6859312">,</span>&nbsp;<span class="op" id="6859314">&amp;</span><span class="ident" id="6859315">template</span><span class="op" id="6859323">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6859327">if</span>&nbsp;<span class="builtinfunc" id="6859330">len</span><span class="op" id="6859333">(</span><span class="ident" id="6859334">csr</span><span class="op" id="6859337">.</span><span class="ident" id="6859338">DNSNames</span><span class="op" id="6859346">)</span>&nbsp;<span class="op" id="6859348">!=</span>&nbsp;<span class="num" id="6859351">1</span>&nbsp;<span class="op" id="6859353">||</span>&nbsp;<span class="ident" id="6859356">csr</span><span class="op" id="6859359">.</span><span class="ident" id="6859360">DNSNames</span><span class="op" id="6859368">[</span><span class="num" id="6859369">0</span><span class="op" id="6859370">]</span>&nbsp;<span class="op" id="6859372">!=</span>&nbsp;<span class="string" id="6859375">&#34;foo2.example.com&#34;</span>&nbsp;<span class="op" id="6859394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6859398">t</span><span class="op" id="6859399">.</span><span class="ident" id="6859400">Errorf</span><span class="op" id="6859406">(</span><span class="string" id="6859407">&#34;Attributes&nbsp;did&nbsp;not&nbsp;override&nbsp;ExtraExtensions.&nbsp;Got&nbsp;%v\n&#34;</span><span class="op" id="6859462">,</span>&nbsp;<span class="ident" id="6859464">csr</span><span class="op" id="6859467">.</span><span class="ident" id="6859468">DNSNames</span><span class="op" id="6859476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6859479">}</span><br>
<span class="lineno"></span><span class="op" id="6859481">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">925</span><span class="keyword" id="6859484">func</span>&nbsp;<span class="ident" id="6859489">TestParseCertificateRequest</span><span class="op" id="6859516">(</span><span class="ident" id="6859517">t</span>&nbsp;<span class="op" id="6859519">*</span><span class="ident" id="6859520">testing</span><span class="op" id="6859527">.</span><span class="ident" id="6859528">T</span><span class="op" id="6859529">)</span>&nbsp;<span class="op" id="6859531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6859534">csrBytes</span>&nbsp;<span class="op" id="6859543">:=</span>&nbsp;<span class="ident" id="6859546">fromBase64</span><span class="op" id="6859556">(</span><span class="ident" id="6859557">csrBase64</span><span class="op" id="6859566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6859569">csr</span><span class="op" id="6859572">,</span>&nbsp;<span class="ident" id="6859574">err</span>&nbsp;<span class="op" id="6859578">:=</span>&nbsp;<span class="ident" id="6859581">ParseCertificateRequest</span><span class="op" id="6859604">(</span><span class="ident" id="6859605">csrBytes</span><span class="op" id="6859613">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6859616">if</span>&nbsp;<span class="ident" id="6859619">err</span>&nbsp;<span class="op" id="6859623">!=</span>&nbsp;<span class="ident" id="6859626">nil</span>&nbsp;<span class="op" id="6859630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6859634">t</span><span class="op" id="6859635">.</span><span class="ident" id="6859636">Fatalf</span><span class="op" id="6859642">(</span><span class="string" id="6859643">&#34;failed&nbsp;to&nbsp;parse&nbsp;CSR:&nbsp;%s&#34;</span><span class="op" id="6859668">,</span>&nbsp;<span class="ident" id="6859670">err</span><span class="op" id="6859673">)</span><br>
<span class="lineno">930</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6859676">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6859680">if</span>&nbsp;<span class="builtinfunc" id="6859683">len</span><span class="op" id="6859686">(</span><span class="ident" id="6859687">csr</span><span class="op" id="6859690">.</span><span class="ident" id="6859691">EmailAddresses</span><span class="op" id="6859705">)</span>&nbsp;<span class="op" id="6859707">!=</span>&nbsp;<span class="num" id="6859710">1</span>&nbsp;<span class="op" id="6859712">||</span>&nbsp;<span class="ident" id="6859715">csr</span><span class="op" id="6859718">.</span><span class="ident" id="6859719">EmailAddresses</span><span class="op" id="6859733">[</span><span class="num" id="6859734">0</span><span class="op" id="6859735">]</span>&nbsp;<span class="op" id="6859737">!=</span>&nbsp;<span class="string" id="6859740">&#34;gopher@golang.org&#34;</span>&nbsp;<span class="op" id="6859760">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6859764">t</span><span class="op" id="6859765">.</span><span class="ident" id="6859766">Errorf</span><span class="op" id="6859772">(</span><span class="string" id="6859773">&#34;incorrect&nbsp;email&nbsp;addresses&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="6859810">,</span>&nbsp;<span class="ident" id="6859812">csr</span><span class="op" id="6859815">.</span><span class="ident" id="6859816">EmailAddresses</span><span class="op" id="6859830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6859833">}</span><br>
<span class="lineno">935</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6859837">if</span>&nbsp;<span class="builtinfunc" id="6859840">len</span><span class="op" id="6859843">(</span><span class="ident" id="6859844">csr</span><span class="op" id="6859847">.</span><span class="ident" id="6859848">DNSNames</span><span class="op" id="6859856">)</span>&nbsp;<span class="op" id="6859858">!=</span>&nbsp;<span class="num" id="6859861">1</span>&nbsp;<span class="op" id="6859863">||</span>&nbsp;<span class="ident" id="6859866">csr</span><span class="op" id="6859869">.</span><span class="ident" id="6859870">DNSNames</span><span class="op" id="6859878">[</span><span class="num" id="6859879">0</span><span class="op" id="6859880">]</span>&nbsp;<span class="op" id="6859882">!=</span>&nbsp;<span class="string" id="6859885">&#34;test.example.com&#34;</span>&nbsp;<span class="op" id="6859904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6859908">t</span><span class="op" id="6859909">.</span><span class="ident" id="6859910">Errorf</span><span class="op" id="6859916">(</span><span class="string" id="6859917">&#34;incorrect&nbsp;DNS&nbsp;names&nbsp;found:&nbsp;%v&#34;</span><span class="op" id="6859948">,</span>&nbsp;<span class="ident" id="6859950">csr</span><span class="op" id="6859953">.</span><span class="ident" id="6859954">DNSNames</span><span class="op" id="6859962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6859965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">940</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6859969">if</span>&nbsp;<span class="builtinfunc" id="6859972">len</span><span class="op" id="6859975">(</span><span class="ident" id="6859976">csr</span><span class="op" id="6859979">.</span><span class="ident" id="6859980">Subject</span><span class="op" id="6859987">.</span><span class="ident" id="6859988">Country</span><span class="op" id="6859995">)</span>&nbsp;<span class="op" id="6859997">!=</span>&nbsp;<span class="num" id="6860000">1</span>&nbsp;<span class="op" id="6860002">||</span>&nbsp;<span class="ident" id="6860005">csr</span><span class="op" id="6860008">.</span><span class="ident" id="6860009">Subject</span><span class="op" id="6860016">.</span><span class="ident" id="6860017">Country</span><span class="op" id="6860024">[</span><span class="num" id="6860025">0</span><span class="op" id="6860026">]</span>&nbsp;<span class="op" id="6860028">!=</span>&nbsp;<span class="string" id="6860031">&#34;AU&#34;</span>&nbsp;<span class="op" id="6860036">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860040">t</span><span class="op" id="6860041">.</span><span class="ident" id="6860042">Errorf</span><span class="op" id="6860048">(</span><span class="string" id="6860049">&#34;incorrect&nbsp;Subject&nbsp;name:&nbsp;%v&#34;</span><span class="op" id="6860077">,</span>&nbsp;<span class="ident" id="6860079">csr</span><span class="op" id="6860082">.</span><span class="ident" id="6860083">Subject</span><span class="op" id="6860090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6860093">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860097">found</span>&nbsp;<span class="op" id="6860103">:=</span>&nbsp;<span class="builtintype" id="6860106">false</span><br>
<span class="lineno">945</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6860113">for</span>&nbsp;<span class="ident" id="6860117">_</span><span class="op" id="6860118">,</span>&nbsp;<span class="ident" id="6860120">e</span>&nbsp;<span class="op" id="6860122">:=</span>&nbsp;<span class="keyword" id="6860125">range</span>&nbsp;<span class="ident" id="6860131">csr</span><span class="op" id="6860134">.</span><span class="ident" id="6860135">Extensions</span>&nbsp;<span class="op" id="6860146">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6860150">if</span>&nbsp;<span class="ident" id="6860153">e</span><span class="op" id="6860154">.</span><span class="ident" id="6860155">Id</span><span class="op" id="6860157">.</span><span class="ident" id="6860158">Equal</span><span class="op" id="6860163">(</span><span class="ident" id="6860164">oidExtensionBasicConstraints</span><span class="op" id="6860192">)</span>&nbsp;<span class="op" id="6860194">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860199">found</span>&nbsp;<span class="op" id="6860205">=</span>&nbsp;<span class="builtintype" id="6860207">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6860215">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6860223">}</span><br>
<span class="lineno">950</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6860226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6860229">if</span>&nbsp;<span class="op" id="6860232">!</span><span class="ident" id="6860233">found</span>&nbsp;<span class="op" id="6860239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860243">t</span><span class="op" id="6860244">.</span><span class="ident" id="6860245">Errorf</span><span class="op" id="6860251">(</span><span class="string" id="6860252">&#34;basic&nbsp;constraints&nbsp;extension&nbsp;not&nbsp;found&nbsp;in&nbsp;CSR&#34;</span><span class="op" id="6860298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6860301">}</span><br>
<span class="lineno"></span><span class="op" id="6860303">}</span><br>
<span class="lineno">955</span><br>
<span class="lineno"></span><span class="keyword" id="6860306">func</span>&nbsp;<span class="ident" id="6860311">TestMaxPathLen</span><span class="op" id="6860325">(</span><span class="ident" id="6860326">t</span>&nbsp;<span class="op" id="6860328">*</span><span class="ident" id="6860329">testing</span><span class="op" id="6860336">.</span><span class="ident" id="6860337">T</span><span class="op" id="6860338">)</span>&nbsp;<span class="op" id="6860340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860343">block</span><span class="op" id="6860348">,</span>&nbsp;<span class="ident" id="6860350">_</span>&nbsp;<span class="op" id="6860352">:=</span>&nbsp;<span class="ident" id="6860355">pem</span><span class="op" id="6860358">.</span><span class="ident" id="6860359">Decode</span><span class="op" id="6860365">(</span><span class="op" id="6860366">[</span><span class="op" id="6860367">]</span><span class="builtintype" id="6860368">byte</span><span class="op" id="6860372">(</span><span class="ident" id="6860373">pemPrivateKey</span><span class="op" id="6860386">)</span><span class="op" id="6860387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860390">rsaPriv</span><span class="op" id="6860397">,</span>&nbsp;<span class="ident" id="6860399">err</span>&nbsp;<span class="op" id="6860403">:=</span>&nbsp;<span class="ident" id="6860406">ParsePKCS1PrivateKey</span><span class="op" id="6860426">(</span><span class="ident" id="6860427">block</span><span class="op" id="6860432">.</span><span class="ident" id="6860433">Bytes</span><span class="op" id="6860438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6860441">if</span>&nbsp;<span class="ident" id="6860444">err</span>&nbsp;<span class="op" id="6860448">!=</span>&nbsp;<span class="ident" id="6860451">nil</span>&nbsp;<span class="op" id="6860455">{</span><br>
<span class="lineno">960</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860459">t</span><span class="op" id="6860460">.</span><span class="ident" id="6860461">Fatalf</span><span class="op" id="6860467">(</span><span class="string" id="6860468">&#34;Failed&nbsp;to&nbsp;parse&nbsp;private&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="6860501">,</span>&nbsp;<span class="ident" id="6860503">err</span><span class="op" id="6860506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6860509">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860513">template</span>&nbsp;<span class="op" id="6860522">:=</span>&nbsp;<span class="op" id="6860525">&amp;</span><span class="ident" id="6860526">Certificate</span><span class="op" id="6860537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860541">SerialNumber</span><span class="op" id="6860553">:</span>&nbsp;<span class="ident" id="6860555">big</span><span class="op" id="6860558">.</span><span class="ident" id="6860559">NewInt</span><span class="op" id="6860565">(</span><span class="num" id="6860566">1</span><span class="op" id="6860567">)</span><span class="op" id="6860568">,</span><br>
<span class="lineno">965</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860572">Subject</span><span class="op" id="6860579">:</span>&nbsp;<span class="ident" id="6860581">pkix</span><span class="op" id="6860585">.</span><span class="ident" id="6860586">Name</span><span class="op" id="6860590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860595">CommonName</span><span class="op" id="6860605">:</span>&nbsp;<span class="string" id="6860607">&#34;Σ&nbsp;Acme&nbsp;Co&#34;</span><span class="op" id="6860619">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6860623">}</span><span class="op" id="6860624">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860628">NotBefore</span><span class="op" id="6860637">:</span>&nbsp;<span class="ident" id="6860639">time</span><span class="op" id="6860643">.</span><span class="ident" id="6860644">Unix</span><span class="op" id="6860648">(</span><span class="num" id="6860649">1000</span><span class="op" id="6860653">,</span>&nbsp;<span class="num" id="6860655">0</span><span class="op" id="6860656">)</span><span class="op" id="6860657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860661">NotAfter</span><span class="op" id="6860669">:</span>&nbsp;&nbsp;<span class="ident" id="6860672">time</span><span class="op" id="6860676">.</span><span class="ident" id="6860677">Unix</span><span class="op" id="6860681">(</span><span class="num" id="6860682">100000</span><span class="op" id="6860688">,</span>&nbsp;<span class="num" id="6860690">0</span><span class="op" id="6860691">)</span><span class="op" id="6860692">,</span><br>
<span class="lineno">970</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860697">BasicConstraintsValid</span><span class="op" id="6860718">:</span>&nbsp;<span class="builtintype" id="6860720">true</span><span class="op" id="6860724">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860728">IsCA</span><span class="op" id="6860732">:</span>&nbsp;<span class="builtintype" id="6860734">true</span><span class="op" id="6860738">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6860741">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">975</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860745">serialiseAndParse</span>&nbsp;<span class="op" id="6860763">:=</span>&nbsp;<span class="keyword" id="6860766">func</span><span class="op" id="6860770">(</span><span class="ident" id="6860771">template</span>&nbsp;<span class="op" id="6860780">*</span><span class="ident" id="6860781">Certificate</span><span class="op" id="6860792">)</span>&nbsp;<span class="op" id="6860794">*</span><span class="ident" id="6860795">Certificate</span>&nbsp;<span class="op" id="6860807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860811">derBytes</span><span class="op" id="6860819">,</span>&nbsp;<span class="ident" id="6860821">err</span>&nbsp;<span class="op" id="6860825">:=</span>&nbsp;<span class="ident" id="6860828">CreateCertificate</span><span class="op" id="6860845">(</span><span class="ident" id="6860846">rand</span><span class="op" id="6860850">.</span><span class="ident" id="6860851">Reader</span><span class="op" id="6860857">,</span>&nbsp;<span class="ident" id="6860859">template</span><span class="op" id="6860867">,</span>&nbsp;<span class="ident" id="6860869">template</span><span class="op" id="6860877">,</span>&nbsp;<span class="op" id="6860879">&amp;</span><span class="ident" id="6860880">rsaPriv</span><span class="op" id="6860887">.</span><span class="ident" id="6860888">PublicKey</span><span class="op" id="6860897">,</span>&nbsp;<span class="ident" id="6860899">rsaPriv</span><span class="op" id="6860906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6860910">if</span>&nbsp;<span class="ident" id="6860913">err</span>&nbsp;<span class="op" id="6860917">!=</span>&nbsp;<span class="ident" id="6860920">nil</span>&nbsp;<span class="op" id="6860924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6860929">t</span><span class="op" id="6860930">.</span><span class="ident" id="6860931">Fatalf</span><span class="op" id="6860937">(</span><span class="string" id="6860938">&#34;failed&nbsp;to&nbsp;create&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6860972">,</span>&nbsp;<span class="ident" id="6860974">err</span><span class="op" id="6860977">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6860982">return</span>&nbsp;<span class="ident" id="6860989">nil</span><br>
<span class="lineno">980</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6860995">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861000">cert</span><span class="op" id="6861004">,</span>&nbsp;<span class="ident" id="6861006">err</span>&nbsp;<span class="op" id="6861010">:=</span>&nbsp;<span class="ident" id="6861013">ParseCertificate</span><span class="op" id="6861029">(</span><span class="ident" id="6861030">derBytes</span><span class="op" id="6861038">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6861042">if</span>&nbsp;<span class="ident" id="6861045">err</span>&nbsp;<span class="op" id="6861049">!=</span>&nbsp;<span class="ident" id="6861052">nil</span>&nbsp;<span class="op" id="6861056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861061">t</span><span class="op" id="6861062">.</span><span class="ident" id="6861063">Fatalf</span><span class="op" id="6861069">(</span><span class="string" id="6861070">&#34;failed&nbsp;to&nbsp;parse&nbsp;certificate:&nbsp;%s&#34;</span><span class="op" id="6861103">,</span>&nbsp;<span class="ident" id="6861105">err</span><span class="op" id="6861108">)</span><br>
<span class="lineno">985</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6861113">return</span>&nbsp;<span class="ident" id="6861120">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6861126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6861131">return</span>&nbsp;<span class="ident" id="6861138">cert</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6861144">}</span><br>
<span class="lineno">990</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861148">cert1</span>&nbsp;<span class="op" id="6861154">:=</span>&nbsp;<span class="ident" id="6861157">serialiseAndParse</span><span class="op" id="6861174">(</span><span class="ident" id="6861175">template</span><span class="op" id="6861183">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6861186">if</span>&nbsp;<span class="ident" id="6861189">m</span>&nbsp;<span class="op" id="6861191">:=</span>&nbsp;<span class="ident" id="6861194">cert1</span><span class="op" id="6861199">.</span><span class="ident" id="6861200">MaxPathLen</span><span class="op" id="6861210">;</span>&nbsp;<span class="ident" id="6861212">m</span>&nbsp;<span class="op" id="6861214">!=</span>&nbsp;<span class="op" id="6861217">-</span><span class="num" id="6861218">1</span>&nbsp;<span class="op" id="6861220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861224">t</span><span class="op" id="6861225">.</span><span class="ident" id="6861226">Errorf</span><span class="op" id="6861232">(</span><span class="string" id="6861233">&#34;Omitting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;turn&nbsp;into&nbsp;-1,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6861282">,</span>&nbsp;<span class="ident" id="6861284">m</span><span class="op" id="6861285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6861288">}</span><br>
<span class="lineno">995</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6861291">if</span>&nbsp;<span class="ident" id="6861294">cert1</span><span class="op" id="6861299">.</span><span class="ident" id="6861300">MaxPathLenZero</span>&nbsp;<span class="op" id="6861315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861319">t</span><span class="op" id="6861320">.</span><span class="ident" id="6861321">Errorf</span><span class="op" id="6861327">(</span><span class="string" id="6861328">&#34;Omitting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="6861376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6861379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861383">template</span><span class="op" id="6861391">.</span><span class="ident" id="6861392">MaxPathLen</span>&nbsp;<span class="op" id="6861403">=</span>&nbsp;<span class="num" id="6861405">1</span><br>
<span class="lineno">1000</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861408">cert2</span>&nbsp;<span class="op" id="6861414">:=</span>&nbsp;<span class="ident" id="6861417">serialiseAndParse</span><span class="op" id="6861434">(</span><span class="ident" id="6861435">template</span><span class="op" id="6861443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6861446">if</span>&nbsp;<span class="ident" id="6861449">m</span>&nbsp;<span class="op" id="6861451">:=</span>&nbsp;<span class="ident" id="6861454">cert2</span><span class="op" id="6861459">.</span><span class="ident" id="6861460">MaxPathLen</span><span class="op" id="6861470">;</span>&nbsp;<span class="ident" id="6861472">m</span>&nbsp;<span class="op" id="6861474">!=</span>&nbsp;<span class="num" id="6861477">1</span>&nbsp;<span class="op" id="6861479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861483">t</span><span class="op" id="6861484">.</span><span class="ident" id="6861485">Errorf</span><span class="op" id="6861491">(</span><span class="string" id="6861492">&#34;Setting&nbsp;MaxPathLen&nbsp;didn&#39;t&nbsp;work.&nbsp;Got&nbsp;%d&nbsp;but&nbsp;set&nbsp;1&#34;</span><span class="op" id="6861542">,</span>&nbsp;<span class="ident" id="6861544">m</span><span class="op" id="6861545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6861548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6861551">if</span>&nbsp;<span class="ident" id="6861554">cert2</span><span class="op" id="6861559">.</span><span class="ident" id="6861560">MaxPathLenZero</span>&nbsp;<span class="op" id="6861575">{</span><br>
<span class="lineno">1005</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861579">t</span><span class="op" id="6861580">.</span><span class="ident" id="6861581">Errorf</span><span class="op" id="6861587">(</span><span class="string" id="6861588">&#34;Setting&nbsp;MaxPathLen&nbsp;resulted&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="6861635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6861638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861642">template</span><span class="op" id="6861650">.</span><span class="ident" id="6861651">MaxPathLen</span>&nbsp;<span class="op" id="6861662">=</span>&nbsp;<span class="num" id="6861664">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861667">template</span><span class="op" id="6861675">.</span><span class="ident" id="6861676">MaxPathLenZero</span>&nbsp;<span class="op" id="6861691">=</span>&nbsp;<span class="builtintype" id="6861693">true</span><br>
<span class="lineno">1010</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861699">cert3</span>&nbsp;<span class="op" id="6861705">:=</span>&nbsp;<span class="ident" id="6861708">serialiseAndParse</span><span class="op" id="6861725">(</span><span class="ident" id="6861726">template</span><span class="op" id="6861734">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6861737">if</span>&nbsp;<span class="ident" id="6861740">m</span>&nbsp;<span class="op" id="6861742">:=</span>&nbsp;<span class="ident" id="6861745">cert3</span><span class="op" id="6861750">.</span><span class="ident" id="6861751">MaxPathLen</span><span class="op" id="6861761">;</span>&nbsp;<span class="ident" id="6861763">m</span>&nbsp;<span class="op" id="6861765">!=</span>&nbsp;<span class="num" id="6861768">0</span>&nbsp;<span class="op" id="6861770">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861774">t</span><span class="op" id="6861775">.</span><span class="ident" id="6861776">Errorf</span><span class="op" id="6861782">(</span><span class="string" id="6861783">&#34;Setting&nbsp;MaxPathLenZero&nbsp;didn&#39;t&nbsp;work,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="6861827">,</span>&nbsp;<span class="ident" id="6861829">m</span><span class="op" id="6861830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6861833">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6861836">if</span>&nbsp;<span class="op" id="6861839">!</span><span class="ident" id="6861840">cert3</span><span class="op" id="6861845">.</span><span class="ident" id="6861846">MaxPathLenZero</span>&nbsp;<span class="op" id="6861861">{</span><br>
<span class="lineno">1015</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6861865">t</span><span class="op" id="6861866">.</span><span class="ident" id="6861867">Errorf</span><span class="op" id="6861873">(</span><span class="string" id="6861874">&#34;Setting&nbsp;MaxPathLen&nbsp;to&nbsp;zero&nbsp;didn&#39;t&nbsp;result&nbsp;in&nbsp;MaxPathLenZero&#34;</span><span class="op" id="6861934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6861937">}</span><br>
<span class="lineno"></span><span class="op" id="6861939">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6861942">//&nbsp;This&nbsp;CSR&nbsp;was&nbsp;generated&nbsp;with&nbsp;OpenSSL:</span><br>
<span class="lineno">1020</span><span class="comment" id="6861982">//&nbsp;&nbsp;openssl&nbsp;req&nbsp;-out&nbsp;CSR.csr&nbsp;-new&nbsp;-newkey&nbsp;rsa:2048&nbsp;-nodes&nbsp;-keyout&nbsp;privateKey.key&nbsp;-config&nbsp;openssl.cnf</span><br>
<span class="lineno"></span><span class="comment" id="6862083">//</span><br>
<span class="lineno"></span><span class="comment" id="6862086">//&nbsp;The&nbsp;openssl.cnf&nbsp;needs&nbsp;to&nbsp;include&nbsp;this&nbsp;section:</span><br>
<span class="lineno"></span><span class="comment" id="6862136">//&nbsp;&nbsp;&nbsp;[&nbsp;v3_req&nbsp;]</span><br>
<span class="lineno"></span><span class="comment" id="6862152">//&nbsp;&nbsp;&nbsp;basicConstraints&nbsp;=&nbsp;CA:FALSE</span><br>
<span class="lineno">1025</span><span class="comment" id="6862185">//&nbsp;&nbsp;&nbsp;keyUsage&nbsp;=&nbsp;nonRepudiation,&nbsp;digitalSignature,&nbsp;keyEncipherment</span><br>
<span class="lineno"></span><span class="comment" id="6862251">//&nbsp;&nbsp;&nbsp;subjectAltName&nbsp;=&nbsp;email:gopher@golang.org,DNS:test.example.com</span><br>
<span class="lineno"></span><span class="keyword" id="6862318">const</span>&nbsp;<span class="ident" id="6862324">csrBase64</span>&nbsp;<span class="op" id="6862334">=</span>&nbsp;<span class="string" id="6862336">&#34;MIIC4zCCAcsCAQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoMGEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAOY+MVedRg2JEnyeLcSzcsMv2VcsTfkB5+Etd6hihAh6MrGezNyASMMKuQN6YhCX1icQDiQtGsDLTtheNnSXK06tAhHjAP/hGlszRJp+5+rP2M58fDBAkUBEhskbCUWwpY14jFtVuGNJ8vF8h8IeczdolvQhX9lVai9G0EUXJMliMKdjA899H0mRs9PzHyidyrXFNiZlQXfD8Kg7gETn2Ny965iyI6ujAIYSCvam6TnxRHYH2MBKyVGvsYGbPYUQJCsgdgyajEg6ekihvQY3SzO1HSAlZAd7d1QYO4VeWJ2mY6Wu3Jpmh+AmG19S9CcHqGjd0bhuAX9cpPOKgnEmqn0CAwEAAaBZMFcGCSqGSIb3DQEJDjFKMEgwCQYDVR0TBAIwADALBgNVHQ8EBAMCBeAwLgYDVR0RBCcwJYERZ29waGVyQGdvbGFuZy5vcmeCEHRlc3QuZXhhbXBsZS5jb20wDQYJKoZIhvcNAQEFBQADggEBAC9+QpKfdabxwCWwf4IEe1cKjdXLS1ScSuw27a3kZzQiPV78WJMa6dB8dqhdH5BRwGZ/qsgLrO6ZHlNeIv2Ib41Ccq71ecHW/nXc94A1BzJ/bVdI9LZcmTUvR1/m1jCpN7UqQ0ml1u9VihK7Pe762hEYxuWDQzYEU0l15S/bXmqeq3eF1A59XT/2jwe5+NV0Wwf4UQlkTXsAQMsJ+KzrQafd8Qv2A49o048uRvmjeJDrXLawGVianZ7D5A6Fpd1rZh6XcjqBpmgLw41DRQWENOdzhy+HyphKRv1MlY8OLkNqpGMhu8DdgJVGoT16DGiickoEa7Z3UCPVNgdTkT9jq7U=&#34;</span>
</div>
</body>
</html>
