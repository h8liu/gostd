<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/elliptic</h2>
<ul>
<li><a href="/gostd/crypto/elliptic/elliptic.go.html">elliptic.go</a></li>
<li><a href="/gostd/crypto/elliptic/elliptic_test.go.html">elliptic_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224.go.html" class="current">p224.go</a></li>
<li><a href="/gostd/crypto/elliptic/p224_test.go.html">p224_test.go</a></li>
<li><a href="/gostd/crypto/elliptic/p256.go.html">p256.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4249451">//&nbsp;Copyright&nbsp;2012&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4249507">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4249561">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4249612">package</span>&nbsp;<span class="ident" id="4249620">elliptic</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4249630">//&nbsp;This&nbsp;is&nbsp;a&nbsp;constant-time,&nbsp;32-bit&nbsp;implementation&nbsp;of&nbsp;P224.&nbsp;See&nbsp;FIPS&nbsp;186-3,</span><br>
<span class="lineno"></span><span class="comment" id="4249705">//&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><span class="comment" id="4249723">//</span><br>
<span class="lineno">10</span><span class="comment" id="4249726">//&nbsp;See&nbsp;http://www.imperialviolet.org/2010/12/04/ecc.html&nbsp;([1])&nbsp;for&nbsp;background.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4249806">import</span>&nbsp;<span class="op" id="4249813">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4249816">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4249827">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="keyword" id="4249830">var</span>&nbsp;<span class="ident" id="4249834">p224</span>&nbsp;<span class="ident" id="4249839">p224Curve</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4249850">type</span>&nbsp;<span class="ident" id="4249855">p224Curve</span>&nbsp;<span class="keyword" id="4249865">struct</span>&nbsp;<span class="op" id="4249872">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4249875">*</span><span class="ident" id="4249876">CurveParams</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249889">gx</span><span class="op" id="4249891">,</span>&nbsp;<span class="ident" id="4249893">gy</span><span class="op" id="4249895">,</span>&nbsp;<span class="ident" id="4249897">b</span>&nbsp;<span class="ident" id="4249899">p224FieldElement</span><br>
<span class="lineno"></span><span class="op" id="4249916">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4249919">func</span>&nbsp;<span class="ident" id="4249924">initP224</span><span class="op" id="4249932">(</span><span class="op" id="4249933">)</span>&nbsp;<span class="op" id="4249935">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4249938">//&nbsp;See&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4249972">p224</span><span class="op" id="4249976">.</span><span class="ident" id="4249977">CurveParams</span>&nbsp;<span class="op" id="4249989">=</span>&nbsp;<span class="builtinfunc" id="4249991">new</span><span class="op" id="4249994">(</span><span class="ident" id="4249995">CurveParams</span><span class="op" id="4250006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250009">p224</span><span class="op" id="4250013">.</span><span class="ident" id="4250014">P</span><span class="op" id="4250015">,</span>&nbsp;<span class="ident" id="4250017">_</span>&nbsp;<span class="op" id="4250019">=</span>&nbsp;<span class="builtinfunc" id="4250021">new</span><span class="op" id="4250024">(</span><span class="ident" id="4250025">big</span><span class="op" id="4250028">.</span><span class="ident" id="4250029">Int</span><span class="op" id="4250032">)</span><span class="op" id="4250033">.</span><span class="ident" id="4250034">SetString</span><span class="op" id="4250043">(</span><span class="string" id="4250044">&#34;26959946667150639794667015087019630673557916260026308143510066298881&#34;</span><span class="op" id="4250114">,</span>&nbsp;<span class="num" id="4250116">10</span><span class="op" id="4250118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250121">p224</span><span class="op" id="4250125">.</span><span class="ident" id="4250126">N</span><span class="op" id="4250127">,</span>&nbsp;<span class="ident" id="4250129">_</span>&nbsp;<span class="op" id="4250131">=</span>&nbsp;<span class="builtinfunc" id="4250133">new</span><span class="op" id="4250136">(</span><span class="ident" id="4250137">big</span><span class="op" id="4250140">.</span><span class="ident" id="4250141">Int</span><span class="op" id="4250144">)</span><span class="op" id="4250145">.</span><span class="ident" id="4250146">SetString</span><span class="op" id="4250155">(</span><span class="string" id="4250156">&#34;26959946667150639794667015087019625940457807714424391721682722368061&#34;</span><span class="op" id="4250226">,</span>&nbsp;<span class="num" id="4250228">10</span><span class="op" id="4250230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250233">p224</span><span class="op" id="4250237">.</span><span class="ident" id="4250238">B</span><span class="op" id="4250239">,</span>&nbsp;<span class="ident" id="4250241">_</span>&nbsp;<span class="op" id="4250243">=</span>&nbsp;<span class="builtinfunc" id="4250245">new</span><span class="op" id="4250248">(</span><span class="ident" id="4250249">big</span><span class="op" id="4250252">.</span><span class="ident" id="4250253">Int</span><span class="op" id="4250256">)</span><span class="op" id="4250257">.</span><span class="ident" id="4250258">SetString</span><span class="op" id="4250267">(</span><span class="string" id="4250268">&#34;b4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4&#34;</span><span class="op" id="4250326">,</span>&nbsp;<span class="num" id="4250328">16</span><span class="op" id="4250330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250333">p224</span><span class="op" id="4250337">.</span><span class="ident" id="4250338">Gx</span><span class="op" id="4250340">,</span>&nbsp;<span class="ident" id="4250342">_</span>&nbsp;<span class="op" id="4250344">=</span>&nbsp;<span class="builtinfunc" id="4250346">new</span><span class="op" id="4250349">(</span><span class="ident" id="4250350">big</span><span class="op" id="4250353">.</span><span class="ident" id="4250354">Int</span><span class="op" id="4250357">)</span><span class="op" id="4250358">.</span><span class="ident" id="4250359">SetString</span><span class="op" id="4250368">(</span><span class="string" id="4250369">&#34;b70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21&#34;</span><span class="op" id="4250427">,</span>&nbsp;<span class="num" id="4250429">16</span><span class="op" id="4250431">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250434">p224</span><span class="op" id="4250438">.</span><span class="ident" id="4250439">Gy</span><span class="op" id="4250441">,</span>&nbsp;<span class="ident" id="4250443">_</span>&nbsp;<span class="op" id="4250445">=</span>&nbsp;<span class="builtinfunc" id="4250447">new</span><span class="op" id="4250450">(</span><span class="ident" id="4250451">big</span><span class="op" id="4250454">.</span><span class="ident" id="4250455">Int</span><span class="op" id="4250458">)</span><span class="op" id="4250459">.</span><span class="ident" id="4250460">SetString</span><span class="op" id="4250469">(</span><span class="string" id="4250470">&#34;bd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34&#34;</span><span class="op" id="4250528">,</span>&nbsp;<span class="num" id="4250530">16</span><span class="op" id="4250532">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250535">p224</span><span class="op" id="4250539">.</span><span class="ident" id="4250540">BitSize</span>&nbsp;<span class="op" id="4250548">=</span>&nbsp;<span class="num" id="4250550">224</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250556">p224FromBig</span><span class="op" id="4250567">(</span><span class="op" id="4250568">&amp;</span><span class="ident" id="4250569">p224</span><span class="op" id="4250573">.</span><span class="ident" id="4250574">gx</span><span class="op" id="4250576">,</span>&nbsp;<span class="ident" id="4250578">p224</span><span class="op" id="4250582">.</span><span class="ident" id="4250583">Gx</span><span class="op" id="4250585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250588">p224FromBig</span><span class="op" id="4250599">(</span><span class="op" id="4250600">&amp;</span><span class="ident" id="4250601">p224</span><span class="op" id="4250605">.</span><span class="ident" id="4250606">gy</span><span class="op" id="4250608">,</span>&nbsp;<span class="ident" id="4250610">p224</span><span class="op" id="4250614">.</span><span class="ident" id="4250615">Gy</span><span class="op" id="4250617">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250620">p224FromBig</span><span class="op" id="4250631">(</span><span class="op" id="4250632">&amp;</span><span class="ident" id="4250633">p224</span><span class="op" id="4250637">.</span><span class="ident" id="4250638">b</span><span class="op" id="4250639">,</span>&nbsp;<span class="ident" id="4250641">p224</span><span class="op" id="4250645">.</span><span class="ident" id="4250646">B</span><span class="op" id="4250647">)</span><br>
<span class="lineno"></span><span class="op" id="4250649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4250652">//&nbsp;P224&nbsp;returns&nbsp;a&nbsp;Curve&nbsp;which&nbsp;implements&nbsp;P-224&nbsp;(see&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2)</span><br>
<span class="lineno"></span><span class="keyword" id="4250731">func</span>&nbsp;<span class="ident" id="4250736">P224</span><span class="op" id="4250740">(</span><span class="op" id="4250741">)</span>&nbsp;<span class="ident" id="4250743">Curve</span>&nbsp;<span class="op" id="4250749">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250752">initonce</span><span class="op" id="4250760">.</span><span class="ident" id="4250761">Do</span><span class="op" id="4250763">(</span><span class="ident" id="4250764">initAll</span><span class="op" id="4250771">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4250774">return</span>&nbsp;<span class="ident" id="4250781">p224</span><br>
<span class="lineno"></span><span class="op" id="4250786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4250789">func</span>&nbsp;<span class="op" id="4250794">(</span><span class="ident" id="4250795">curve</span>&nbsp;<span class="ident" id="4250801">p224Curve</span><span class="op" id="4250810">)</span>&nbsp;<span class="ident" id="4250812">Params</span><span class="op" id="4250818">(</span><span class="op" id="4250819">)</span>&nbsp;<span class="op" id="4250821">*</span><span class="ident" id="4250822">CurveParams</span>&nbsp;<span class="op" id="4250834">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4250837">return</span>&nbsp;<span class="ident" id="4250844">curve</span><span class="op" id="4250849">.</span><span class="ident" id="4250850">CurveParams</span><br>
<span class="lineno"></span><span class="op" id="4250862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4250865">func</span>&nbsp;<span class="op" id="4250870">(</span><span class="ident" id="4250871">curve</span>&nbsp;<span class="ident" id="4250877">p224Curve</span><span class="op" id="4250886">)</span>&nbsp;<span class="ident" id="4250888">IsOnCurve</span><span class="op" id="4250897">(</span><span class="ident" id="4250898">bigX</span><span class="op" id="4250902">,</span>&nbsp;<span class="ident" id="4250904">bigY</span>&nbsp;<span class="op" id="4250909">*</span><span class="ident" id="4250910">big</span><span class="op" id="4250913">.</span><span class="ident" id="4250914">Int</span><span class="op" id="4250917">)</span>&nbsp;<span class="builtintype" id="4250919">bool</span>&nbsp;<span class="op" id="4250924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4250927">var</span>&nbsp;<span class="ident" id="4250931">x</span><span class="op" id="4250932">,</span>&nbsp;<span class="ident" id="4250934">y</span>&nbsp;<span class="ident" id="4250936">p224FieldElement</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250954">p224FromBig</span><span class="op" id="4250965">(</span><span class="op" id="4250966">&amp;</span><span class="ident" id="4250967">x</span><span class="op" id="4250968">,</span>&nbsp;<span class="ident" id="4250970">bigX</span><span class="op" id="4250974">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4250977">p224FromBig</span><span class="op" id="4250988">(</span><span class="op" id="4250989">&amp;</span><span class="ident" id="4250990">y</span><span class="op" id="4250991">,</span>&nbsp;<span class="ident" id="4250993">bigY</span><span class="op" id="4250997">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4251001">//&nbsp;y²&nbsp;=&nbsp;x³&nbsp;-&nbsp;3x&nbsp;+&nbsp;b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4251024">var</span>&nbsp;<span class="ident" id="4251028">tmp</span>&nbsp;<span class="ident" id="4251032">p224LargeFieldElement</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4251055">var</span>&nbsp;<span class="ident" id="4251059">x3</span>&nbsp;<span class="ident" id="4251062">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251080">p224Square</span><span class="op" id="4251090">(</span><span class="op" id="4251091">&amp;</span><span class="ident" id="4251092">x3</span><span class="op" id="4251094">,</span>&nbsp;<span class="op" id="4251096">&amp;</span><span class="ident" id="4251097">x</span><span class="op" id="4251098">,</span>&nbsp;<span class="op" id="4251100">&amp;</span><span class="ident" id="4251101">tmp</span><span class="op" id="4251104">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251107">p224Mul</span><span class="op" id="4251114">(</span><span class="op" id="4251115">&amp;</span><span class="ident" id="4251116">x3</span><span class="op" id="4251118">,</span>&nbsp;<span class="op" id="4251120">&amp;</span><span class="ident" id="4251121">x3</span><span class="op" id="4251123">,</span>&nbsp;<span class="op" id="4251125">&amp;</span><span class="ident" id="4251126">x</span><span class="op" id="4251127">,</span>&nbsp;<span class="op" id="4251129">&amp;</span><span class="ident" id="4251130">tmp</span><span class="op" id="4251133">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4251137">for</span>&nbsp;<span class="ident" id="4251141">i</span>&nbsp;<span class="op" id="4251143">:=</span>&nbsp;<span class="num" id="4251146">0</span><span class="op" id="4251147">;</span>&nbsp;<span class="ident" id="4251149">i</span>&nbsp;<span class="op" id="4251151">&lt;</span>&nbsp;<span class="num" id="4251153">8</span><span class="op" id="4251154">;</span>&nbsp;<span class="ident" id="4251156">i</span><span class="op" id="4251157">++</span>&nbsp;<span class="op" id="4251160">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251164">x</span><span class="op" id="4251165">[</span><span class="ident" id="4251166">i</span><span class="op" id="4251167">]</span>&nbsp;<span class="op" id="4251169">*=</span>&nbsp;<span class="num" id="4251172">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4251175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251178">p224Sub</span><span class="op" id="4251185">(</span><span class="op" id="4251186">&amp;</span><span class="ident" id="4251187">x3</span><span class="op" id="4251189">,</span>&nbsp;<span class="op" id="4251191">&amp;</span><span class="ident" id="4251192">x3</span><span class="op" id="4251194">,</span>&nbsp;<span class="op" id="4251196">&amp;</span><span class="ident" id="4251197">x</span><span class="op" id="4251198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251201">p224Reduce</span><span class="op" id="4251211">(</span><span class="op" id="4251212">&amp;</span><span class="ident" id="4251213">x3</span><span class="op" id="4251215">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251218">p224Add</span><span class="op" id="4251225">(</span><span class="op" id="4251226">&amp;</span><span class="ident" id="4251227">x3</span><span class="op" id="4251229">,</span>&nbsp;<span class="op" id="4251231">&amp;</span><span class="ident" id="4251232">x3</span><span class="op" id="4251234">,</span>&nbsp;<span class="op" id="4251236">&amp;</span><span class="ident" id="4251237">curve</span><span class="op" id="4251242">.</span><span class="ident" id="4251243">b</span><span class="op" id="4251244">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251247">p224Contract</span><span class="op" id="4251259">(</span><span class="op" id="4251260">&amp;</span><span class="ident" id="4251261">x3</span><span class="op" id="4251263">,</span>&nbsp;<span class="op" id="4251265">&amp;</span><span class="ident" id="4251266">x3</span><span class="op" id="4251268">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251272">p224Square</span><span class="op" id="4251282">(</span><span class="op" id="4251283">&amp;</span><span class="ident" id="4251284">y</span><span class="op" id="4251285">,</span>&nbsp;<span class="op" id="4251287">&amp;</span><span class="ident" id="4251288">y</span><span class="op" id="4251289">,</span>&nbsp;<span class="op" id="4251291">&amp;</span><span class="ident" id="4251292">tmp</span><span class="op" id="4251295">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251298">p224Contract</span><span class="op" id="4251310">(</span><span class="op" id="4251311">&amp;</span><span class="ident" id="4251312">y</span><span class="op" id="4251313">,</span>&nbsp;<span class="op" id="4251315">&amp;</span><span class="ident" id="4251316">y</span><span class="op" id="4251317">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4251321">for</span>&nbsp;<span class="ident" id="4251325">i</span>&nbsp;<span class="op" id="4251327">:=</span>&nbsp;<span class="num" id="4251330">0</span><span class="op" id="4251331">;</span>&nbsp;<span class="ident" id="4251333">i</span>&nbsp;<span class="op" id="4251335">&lt;</span>&nbsp;<span class="num" id="4251337">8</span><span class="op" id="4251338">;</span>&nbsp;<span class="ident" id="4251340">i</span><span class="op" id="4251341">++</span>&nbsp;<span class="op" id="4251344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4251348">if</span>&nbsp;<span class="ident" id="4251351">y</span><span class="op" id="4251352">[</span><span class="ident" id="4251353">i</span><span class="op" id="4251354">]</span>&nbsp;<span class="op" id="4251356">!=</span>&nbsp;<span class="ident" id="4251359">x3</span><span class="op" id="4251361">[</span><span class="ident" id="4251362">i</span><span class="op" id="4251363">]</span>&nbsp;<span class="op" id="4251365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4251370">return</span>&nbsp;<span class="builtintype" id="4251377">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4251385">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4251388">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4251391">return</span>&nbsp;<span class="builtintype" id="4251398">true</span><br>
<span class="lineno"></span><span class="op" id="4251403">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4251406">func</span>&nbsp;<span class="op" id="4251411">(</span><span class="ident" id="4251412">p224Curve</span><span class="op" id="4251421">)</span>&nbsp;<span class="ident" id="4251423">Add</span><span class="op" id="4251426">(</span><span class="ident" id="4251427">bigX1</span><span class="op" id="4251432">,</span>&nbsp;<span class="ident" id="4251434">bigY1</span><span class="op" id="4251439">,</span>&nbsp;<span class="ident" id="4251441">bigX2</span><span class="op" id="4251446">,</span>&nbsp;<span class="ident" id="4251448">bigY2</span>&nbsp;<span class="op" id="4251454">*</span><span class="ident" id="4251455">big</span><span class="op" id="4251458">.</span><span class="ident" id="4251459">Int</span><span class="op" id="4251462">)</span>&nbsp;<span class="op" id="4251464">(</span><span class="ident" id="4251465">x</span><span class="op" id="4251466">,</span>&nbsp;<span class="ident" id="4251468">y</span>&nbsp;<span class="op" id="4251470">*</span><span class="ident" id="4251471">big</span><span class="op" id="4251474">.</span><span class="ident" id="4251475">Int</span><span class="op" id="4251478">)</span>&nbsp;<span class="op" id="4251480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4251483">var</span>&nbsp;<span class="ident" id="4251487">x1</span><span class="op" id="4251489">,</span>&nbsp;<span class="ident" id="4251491">y1</span><span class="op" id="4251493">,</span>&nbsp;<span class="ident" id="4251495">z1</span><span class="op" id="4251497">,</span>&nbsp;<span class="ident" id="4251499">x2</span><span class="op" id="4251501">,</span>&nbsp;<span class="ident" id="4251503">y2</span><span class="op" id="4251505">,</span>&nbsp;<span class="ident" id="4251507">z2</span><span class="op" id="4251509">,</span>&nbsp;<span class="ident" id="4251511">x3</span><span class="op" id="4251513">,</span>&nbsp;<span class="ident" id="4251515">y3</span><span class="op" id="4251517">,</span>&nbsp;<span class="ident" id="4251519">z3</span>&nbsp;<span class="ident" id="4251522">p224FieldElement</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251541">p224FromBig</span><span class="op" id="4251552">(</span><span class="op" id="4251553">&amp;</span><span class="ident" id="4251554">x1</span><span class="op" id="4251556">,</span>&nbsp;<span class="ident" id="4251558">bigX1</span><span class="op" id="4251563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251566">p224FromBig</span><span class="op" id="4251577">(</span><span class="op" id="4251578">&amp;</span><span class="ident" id="4251579">y1</span><span class="op" id="4251581">,</span>&nbsp;<span class="ident" id="4251583">bigY1</span><span class="op" id="4251588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4251591">if</span>&nbsp;<span class="ident" id="4251594">bigX1</span><span class="op" id="4251599">.</span><span class="ident" id="4251600">Sign</span><span class="op" id="4251604">(</span><span class="op" id="4251605">)</span>&nbsp;<span class="op" id="4251607">!=</span>&nbsp;<span class="num" id="4251610">0</span>&nbsp;<span class="op" id="4251612">||</span>&nbsp;<span class="ident" id="4251615">bigY1</span><span class="op" id="4251620">.</span><span class="ident" id="4251621">Sign</span><span class="op" id="4251625">(</span><span class="op" id="4251626">)</span>&nbsp;<span class="op" id="4251628">!=</span>&nbsp;<span class="num" id="4251631">0</span>&nbsp;<span class="op" id="4251633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251637">z1</span><span class="op" id="4251639">[</span><span class="num" id="4251640">0</span><span class="op" id="4251641">]</span>&nbsp;<span class="op" id="4251643">=</span>&nbsp;<span class="num" id="4251645">1</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4251648">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251651">p224FromBig</span><span class="op" id="4251662">(</span><span class="op" id="4251663">&amp;</span><span class="ident" id="4251664">x2</span><span class="op" id="4251666">,</span>&nbsp;<span class="ident" id="4251668">bigX2</span><span class="op" id="4251673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251676">p224FromBig</span><span class="op" id="4251687">(</span><span class="op" id="4251688">&amp;</span><span class="ident" id="4251689">y2</span><span class="op" id="4251691">,</span>&nbsp;<span class="ident" id="4251693">bigY2</span><span class="op" id="4251698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4251701">if</span>&nbsp;<span class="ident" id="4251704">bigX2</span><span class="op" id="4251709">.</span><span class="ident" id="4251710">Sign</span><span class="op" id="4251714">(</span><span class="op" id="4251715">)</span>&nbsp;<span class="op" id="4251717">!=</span>&nbsp;<span class="num" id="4251720">0</span>&nbsp;<span class="op" id="4251722">||</span>&nbsp;<span class="ident" id="4251725">bigY2</span><span class="op" id="4251730">.</span><span class="ident" id="4251731">Sign</span><span class="op" id="4251735">(</span><span class="op" id="4251736">)</span>&nbsp;<span class="op" id="4251738">!=</span>&nbsp;<span class="num" id="4251741">0</span>&nbsp;<span class="op" id="4251743">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251747">z2</span><span class="op" id="4251749">[</span><span class="num" id="4251750">0</span><span class="op" id="4251751">]</span>&nbsp;<span class="op" id="4251753">=</span>&nbsp;<span class="num" id="4251755">1</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4251758">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251762">p224AddJacobian</span><span class="op" id="4251777">(</span><span class="op" id="4251778">&amp;</span><span class="ident" id="4251779">x3</span><span class="op" id="4251781">,</span>&nbsp;<span class="op" id="4251783">&amp;</span><span class="ident" id="4251784">y3</span><span class="op" id="4251786">,</span>&nbsp;<span class="op" id="4251788">&amp;</span><span class="ident" id="4251789">z3</span><span class="op" id="4251791">,</span>&nbsp;<span class="op" id="4251793">&amp;</span><span class="ident" id="4251794">x1</span><span class="op" id="4251796">,</span>&nbsp;<span class="op" id="4251798">&amp;</span><span class="ident" id="4251799">y1</span><span class="op" id="4251801">,</span>&nbsp;<span class="op" id="4251803">&amp;</span><span class="ident" id="4251804">z1</span><span class="op" id="4251806">,</span>&nbsp;<span class="op" id="4251808">&amp;</span><span class="ident" id="4251809">x2</span><span class="op" id="4251811">,</span>&nbsp;<span class="op" id="4251813">&amp;</span><span class="ident" id="4251814">y2</span><span class="op" id="4251816">,</span>&nbsp;<span class="op" id="4251818">&amp;</span><span class="ident" id="4251819">z2</span><span class="op" id="4251821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4251824">return</span>&nbsp;<span class="ident" id="4251831">p224ToAffine</span><span class="op" id="4251843">(</span><span class="op" id="4251844">&amp;</span><span class="ident" id="4251845">x3</span><span class="op" id="4251847">,</span>&nbsp;<span class="op" id="4251849">&amp;</span><span class="ident" id="4251850">y3</span><span class="op" id="4251852">,</span>&nbsp;<span class="op" id="4251854">&amp;</span><span class="ident" id="4251855">z3</span><span class="op" id="4251857">)</span><br>
<span class="lineno"></span><span class="op" id="4251859">}</span><br>
<span class="lineno">95</span><br>
<span class="lineno"></span><span class="keyword" id="4251862">func</span>&nbsp;<span class="op" id="4251867">(</span><span class="ident" id="4251868">p224Curve</span><span class="op" id="4251877">)</span>&nbsp;<span class="ident" id="4251879">Double</span><span class="op" id="4251885">(</span><span class="ident" id="4251886">bigX1</span><span class="op" id="4251891">,</span>&nbsp;<span class="ident" id="4251893">bigY1</span>&nbsp;<span class="op" id="4251899">*</span><span class="ident" id="4251900">big</span><span class="op" id="4251903">.</span><span class="ident" id="4251904">Int</span><span class="op" id="4251907">)</span>&nbsp;<span class="op" id="4251909">(</span><span class="ident" id="4251910">x</span><span class="op" id="4251911">,</span>&nbsp;<span class="ident" id="4251913">y</span>&nbsp;<span class="op" id="4251915">*</span><span class="ident" id="4251916">big</span><span class="op" id="4251919">.</span><span class="ident" id="4251920">Int</span><span class="op" id="4251923">)</span>&nbsp;<span class="op" id="4251925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4251928">var</span>&nbsp;<span class="ident" id="4251932">x1</span><span class="op" id="4251934">,</span>&nbsp;<span class="ident" id="4251936">y1</span><span class="op" id="4251938">,</span>&nbsp;<span class="ident" id="4251940">z1</span><span class="op" id="4251942">,</span>&nbsp;<span class="ident" id="4251944">x2</span><span class="op" id="4251946">,</span>&nbsp;<span class="ident" id="4251948">y2</span><span class="op" id="4251950">,</span>&nbsp;<span class="ident" id="4251952">z2</span>&nbsp;<span class="ident" id="4251955">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251974">p224FromBig</span><span class="op" id="4251985">(</span><span class="op" id="4251986">&amp;</span><span class="ident" id="4251987">x1</span><span class="op" id="4251989">,</span>&nbsp;<span class="ident" id="4251991">bigX1</span><span class="op" id="4251996">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4251999">p224FromBig</span><span class="op" id="4252010">(</span><span class="op" id="4252011">&amp;</span><span class="ident" id="4252012">y1</span><span class="op" id="4252014">,</span>&nbsp;<span class="ident" id="4252016">bigY1</span><span class="op" id="4252021">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252024">z1</span><span class="op" id="4252026">[</span><span class="num" id="4252027">0</span><span class="op" id="4252028">]</span>&nbsp;<span class="op" id="4252030">=</span>&nbsp;<span class="num" id="4252032">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252036">p224DoubleJacobian</span><span class="op" id="4252054">(</span><span class="op" id="4252055">&amp;</span><span class="ident" id="4252056">x2</span><span class="op" id="4252058">,</span>&nbsp;<span class="op" id="4252060">&amp;</span><span class="ident" id="4252061">y2</span><span class="op" id="4252063">,</span>&nbsp;<span class="op" id="4252065">&amp;</span><span class="ident" id="4252066">z2</span><span class="op" id="4252068">,</span>&nbsp;<span class="op" id="4252070">&amp;</span><span class="ident" id="4252071">x1</span><span class="op" id="4252073">,</span>&nbsp;<span class="op" id="4252075">&amp;</span><span class="ident" id="4252076">y1</span><span class="op" id="4252078">,</span>&nbsp;<span class="op" id="4252080">&amp;</span><span class="ident" id="4252081">z1</span><span class="op" id="4252083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4252086">return</span>&nbsp;<span class="ident" id="4252093">p224ToAffine</span><span class="op" id="4252105">(</span><span class="op" id="4252106">&amp;</span><span class="ident" id="4252107">x2</span><span class="op" id="4252109">,</span>&nbsp;<span class="op" id="4252111">&amp;</span><span class="ident" id="4252112">y2</span><span class="op" id="4252114">,</span>&nbsp;<span class="op" id="4252116">&amp;</span><span class="ident" id="4252117">z2</span><span class="op" id="4252119">)</span><br>
<span class="lineno">105</span><span class="op" id="4252121">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4252124">func</span>&nbsp;<span class="op" id="4252129">(</span><span class="ident" id="4252130">p224Curve</span><span class="op" id="4252139">)</span>&nbsp;<span class="ident" id="4252141">ScalarMult</span><span class="op" id="4252151">(</span><span class="ident" id="4252152">bigX1</span><span class="op" id="4252157">,</span>&nbsp;<span class="ident" id="4252159">bigY1</span>&nbsp;<span class="op" id="4252165">*</span><span class="ident" id="4252166">big</span><span class="op" id="4252169">.</span><span class="ident" id="4252170">Int</span><span class="op" id="4252173">,</span>&nbsp;<span class="ident" id="4252175">scalar</span>&nbsp;<span class="op" id="4252182">[</span><span class="op" id="4252183">]</span><span class="builtintype" id="4252184">byte</span><span class="op" id="4252188">)</span>&nbsp;<span class="op" id="4252190">(</span><span class="ident" id="4252191">x</span><span class="op" id="4252192">,</span>&nbsp;<span class="ident" id="4252194">y</span>&nbsp;<span class="op" id="4252196">*</span><span class="ident" id="4252197">big</span><span class="op" id="4252200">.</span><span class="ident" id="4252201">Int</span><span class="op" id="4252204">)</span>&nbsp;<span class="op" id="4252206">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4252209">var</span>&nbsp;<span class="ident" id="4252213">x1</span><span class="op" id="4252215">,</span>&nbsp;<span class="ident" id="4252217">y1</span><span class="op" id="4252219">,</span>&nbsp;<span class="ident" id="4252221">z1</span><span class="op" id="4252223">,</span>&nbsp;<span class="ident" id="4252225">x2</span><span class="op" id="4252227">,</span>&nbsp;<span class="ident" id="4252229">y2</span><span class="op" id="4252231">,</span>&nbsp;<span class="ident" id="4252233">z2</span>&nbsp;<span class="ident" id="4252236">p224FieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252255">p224FromBig</span><span class="op" id="4252266">(</span><span class="op" id="4252267">&amp;</span><span class="ident" id="4252268">x1</span><span class="op" id="4252270">,</span>&nbsp;<span class="ident" id="4252272">bigX1</span><span class="op" id="4252277">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252280">p224FromBig</span><span class="op" id="4252291">(</span><span class="op" id="4252292">&amp;</span><span class="ident" id="4252293">y1</span><span class="op" id="4252295">,</span>&nbsp;<span class="ident" id="4252297">bigY1</span><span class="op" id="4252302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252305">z1</span><span class="op" id="4252307">[</span><span class="num" id="4252308">0</span><span class="op" id="4252309">]</span>&nbsp;<span class="op" id="4252311">=</span>&nbsp;<span class="num" id="4252313">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252317">p224ScalarMult</span><span class="op" id="4252331">(</span><span class="op" id="4252332">&amp;</span><span class="ident" id="4252333">x2</span><span class="op" id="4252335">,</span>&nbsp;<span class="op" id="4252337">&amp;</span><span class="ident" id="4252338">y2</span><span class="op" id="4252340">,</span>&nbsp;<span class="op" id="4252342">&amp;</span><span class="ident" id="4252343">z2</span><span class="op" id="4252345">,</span>&nbsp;<span class="op" id="4252347">&amp;</span><span class="ident" id="4252348">x1</span><span class="op" id="4252350">,</span>&nbsp;<span class="op" id="4252352">&amp;</span><span class="ident" id="4252353">y1</span><span class="op" id="4252355">,</span>&nbsp;<span class="op" id="4252357">&amp;</span><span class="ident" id="4252358">z1</span><span class="op" id="4252360">,</span>&nbsp;<span class="ident" id="4252362">scalar</span><span class="op" id="4252368">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4252371">return</span>&nbsp;<span class="ident" id="4252378">p224ToAffine</span><span class="op" id="4252390">(</span><span class="op" id="4252391">&amp;</span><span class="ident" id="4252392">x2</span><span class="op" id="4252394">,</span>&nbsp;<span class="op" id="4252396">&amp;</span><span class="ident" id="4252397">y2</span><span class="op" id="4252399">,</span>&nbsp;<span class="op" id="4252401">&amp;</span><span class="ident" id="4252402">z2</span><span class="op" id="4252404">)</span><br>
<span class="lineno"></span><span class="op" id="4252406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4252409">func</span>&nbsp;<span class="op" id="4252414">(</span><span class="ident" id="4252415">curve</span>&nbsp;<span class="ident" id="4252421">p224Curve</span><span class="op" id="4252430">)</span>&nbsp;<span class="ident" id="4252432">ScalarBaseMult</span><span class="op" id="4252446">(</span><span class="ident" id="4252447">scalar</span>&nbsp;<span class="op" id="4252454">[</span><span class="op" id="4252455">]</span><span class="builtintype" id="4252456">byte</span><span class="op" id="4252460">)</span>&nbsp;<span class="op" id="4252462">(</span><span class="ident" id="4252463">x</span><span class="op" id="4252464">,</span>&nbsp;<span class="ident" id="4252466">y</span>&nbsp;<span class="op" id="4252468">*</span><span class="ident" id="4252469">big</span><span class="op" id="4252472">.</span><span class="ident" id="4252473">Int</span><span class="op" id="4252476">)</span>&nbsp;<span class="op" id="4252478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4252481">var</span>&nbsp;<span class="ident" id="4252485">z1</span><span class="op" id="4252487">,</span>&nbsp;<span class="ident" id="4252489">x2</span><span class="op" id="4252491">,</span>&nbsp;<span class="ident" id="4252493">y2</span><span class="op" id="4252495">,</span>&nbsp;<span class="ident" id="4252497">z2</span>&nbsp;<span class="ident" id="4252500">p224FieldElement</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252519">z1</span><span class="op" id="4252521">[</span><span class="num" id="4252522">0</span><span class="op" id="4252523">]</span>&nbsp;<span class="op" id="4252525">=</span>&nbsp;<span class="num" id="4252527">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4252530">p224ScalarMult</span><span class="op" id="4252544">(</span><span class="op" id="4252545">&amp;</span><span class="ident" id="4252546">x2</span><span class="op" id="4252548">,</span>&nbsp;<span class="op" id="4252550">&amp;</span><span class="ident" id="4252551">y2</span><span class="op" id="4252553">,</span>&nbsp;<span class="op" id="4252555">&amp;</span><span class="ident" id="4252556">z2</span><span class="op" id="4252558">,</span>&nbsp;<span class="op" id="4252560">&amp;</span><span class="ident" id="4252561">curve</span><span class="op" id="4252566">.</span><span class="ident" id="4252567">gx</span><span class="op" id="4252569">,</span>&nbsp;<span class="op" id="4252571">&amp;</span><span class="ident" id="4252572">curve</span><span class="op" id="4252577">.</span><span class="ident" id="4252578">gy</span><span class="op" id="4252580">,</span>&nbsp;<span class="op" id="4252582">&amp;</span><span class="ident" id="4252583">z1</span><span class="op" id="4252585">,</span>&nbsp;<span class="ident" id="4252587">scalar</span><span class="op" id="4252593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4252596">return</span>&nbsp;<span class="ident" id="4252603">p224ToAffine</span><span class="op" id="4252615">(</span><span class="op" id="4252616">&amp;</span><span class="ident" id="4252617">x2</span><span class="op" id="4252619">,</span>&nbsp;<span class="op" id="4252621">&amp;</span><span class="ident" id="4252622">y2</span><span class="op" id="4252624">,</span>&nbsp;<span class="op" id="4252626">&amp;</span><span class="ident" id="4252627">z2</span><span class="op" id="4252629">)</span><br>
<span class="lineno"></span><span class="op" id="4252631">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="comment" id="4252634">//&nbsp;Field&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4252662">//</span><br>
<span class="lineno"></span><span class="comment" id="4252665">//&nbsp;The&nbsp;field&nbsp;that&nbsp;we&#39;re&nbsp;dealing&nbsp;with&nbsp;is&nbsp;ℤ/pℤ&nbsp;where&nbsp;p&nbsp;=&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;+&nbsp;1.</span><br>
<span class="lineno"></span><span class="comment" id="4252744">//</span><br>
<span class="lineno">130</span><span class="comment" id="4252747">//&nbsp;Field&nbsp;elements&nbsp;are&nbsp;represented&nbsp;by&nbsp;a&nbsp;FieldElement,&nbsp;which&nbsp;is&nbsp;a&nbsp;typedef&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4252825">//&nbsp;array&nbsp;of&nbsp;8&nbsp;uint32&#39;s.&nbsp;The&nbsp;value&nbsp;of&nbsp;a&nbsp;FieldElement,&nbsp;a,&nbsp;is:</span><br>
<span class="lineno"></span><span class="comment" id="4252885">//&nbsp;&nbsp;&nbsp;a[0]&nbsp;+&nbsp;2**28·a[1]&nbsp;+&nbsp;2**56·a[1]&nbsp;+&nbsp;...&nbsp;+&nbsp;2**196·a[7]</span><br>
<span class="lineno"></span><span class="comment" id="4252944">//</span><br>
<span class="lineno"></span><span class="comment" id="4252947">//&nbsp;Using&nbsp;28-bit&nbsp;limbs&nbsp;means&nbsp;that&nbsp;there&#39;s&nbsp;only&nbsp;4&nbsp;bits&nbsp;of&nbsp;headroom,&nbsp;which&nbsp;is&nbsp;less</span><br>
<span class="lineno">135</span><span class="comment" id="4253027">//&nbsp;than&nbsp;we&nbsp;would&nbsp;really&nbsp;like.&nbsp;But&nbsp;it&nbsp;has&nbsp;the&nbsp;useful&nbsp;feature&nbsp;that&nbsp;we&nbsp;hit&nbsp;2**224</span><br>
<span class="lineno"></span><span class="comment" id="4253106">//&nbsp;exactly,&nbsp;making&nbsp;the&nbsp;reflections&nbsp;during&nbsp;a&nbsp;reduce&nbsp;much&nbsp;nicer.</span><br>
<span class="lineno"></span><span class="keyword" id="4253169">type</span>&nbsp;<span class="ident" id="4253174">p224FieldElement</span>&nbsp;<span class="op" id="4253191">[</span><span class="num" id="4253192">8</span><span class="op" id="4253193">]</span><span class="builtintype" id="4253194">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4253202">//&nbsp;p224P&nbsp;is&nbsp;the&nbsp;order&nbsp;of&nbsp;the&nbsp;field,&nbsp;represented&nbsp;as&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno">140</span><span class="keyword" id="4253273">var</span>&nbsp;<span class="ident" id="4253277">p224P</span>&nbsp;<span class="op" id="4253283">=</span>&nbsp;<span class="op" id="4253285">[</span><span class="num" id="4253286">8</span><span class="op" id="4253287">]</span><span class="builtintype" id="4253288">uint32</span><span class="op" id="4253294">{</span><span class="num" id="4253295">1</span><span class="op" id="4253296">,</span>&nbsp;<span class="num" id="4253298">0</span><span class="op" id="4253299">,</span>&nbsp;<span class="num" id="4253301">0</span><span class="op" id="4253302">,</span>&nbsp;<span class="num" id="4253304">0xffff000</span><span class="op" id="4253313">,</span>&nbsp;<span class="num" id="4253315">0xfffffff</span><span class="op" id="4253324">,</span>&nbsp;<span class="num" id="4253326">0xfffffff</span><span class="op" id="4253335">,</span>&nbsp;<span class="num" id="4253337">0xfffffff</span><span class="op" id="4253346">,</span>&nbsp;<span class="num" id="4253348">0xfffffff</span><span class="op" id="4253357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4253360">//&nbsp;p224IsZero&nbsp;returns&nbsp;1&nbsp;if&nbsp;a&nbsp;==&nbsp;0&nbsp;mod&nbsp;p&nbsp;and&nbsp;0&nbsp;otherwise.</span><br>
<span class="lineno"></span><span class="comment" id="4253417">//</span><br>
<span class="lineno"></span><span class="comment" id="4253420">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">145</span><span class="keyword" id="4253436">func</span>&nbsp;<span class="ident" id="4253441">p224IsZero</span><span class="op" id="4253451">(</span><span class="ident" id="4253452">a</span>&nbsp;<span class="op" id="4253454">*</span><span class="ident" id="4253455">p224FieldElement</span><span class="op" id="4253471">)</span>&nbsp;<span class="builtintype" id="4253473">uint32</span>&nbsp;<span class="op" id="4253480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4253483">//&nbsp;Since&nbsp;a&nbsp;p224FieldElement&nbsp;contains&nbsp;224&nbsp;bits&nbsp;there&nbsp;are&nbsp;two&nbsp;possible</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4253553">//&nbsp;representations&nbsp;of&nbsp;0:&nbsp;0&nbsp;and&nbsp;p.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253588">var</span>&nbsp;<span class="ident" id="4253592">minimal</span>&nbsp;<span class="ident" id="4253600">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253618">p224Contract</span><span class="op" id="4253630">(</span><span class="op" id="4253631">&amp;</span><span class="ident" id="4253632">minimal</span><span class="op" id="4253639">,</span>&nbsp;<span class="ident" id="4253641">a</span><span class="op" id="4253642">)</span><br>
<span class="lineno">150</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253646">var</span>&nbsp;<span class="ident" id="4253650">isZero</span><span class="op" id="4253656">,</span>&nbsp;<span class="ident" id="4253658">isP</span>&nbsp;<span class="builtintype" id="4253662">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4253670">for</span>&nbsp;<span class="ident" id="4253674">i</span><span class="op" id="4253675">,</span>&nbsp;<span class="ident" id="4253677">v</span>&nbsp;<span class="op" id="4253679">:=</span>&nbsp;<span class="keyword" id="4253682">range</span>&nbsp;<span class="ident" id="4253688">minimal</span>&nbsp;<span class="op" id="4253696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253700">isZero</span>&nbsp;<span class="op" id="4253707">|=</span>&nbsp;<span class="ident" id="4253710">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253714">isP</span>&nbsp;<span class="op" id="4253718">|=</span>&nbsp;<span class="ident" id="4253721">v</span>&nbsp;<span class="op" id="4253723">-</span>&nbsp;<span class="ident" id="4253725">p224P</span><span class="op" id="4253730">[</span><span class="ident" id="4253731">i</span><span class="op" id="4253732">]</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4253735">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4253739">//&nbsp;If&nbsp;either&nbsp;isZero&nbsp;or&nbsp;isP&nbsp;is&nbsp;0,&nbsp;then&nbsp;we&nbsp;should&nbsp;return&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253798">isZero</span>&nbsp;<span class="op" id="4253805">|=</span>&nbsp;<span class="ident" id="4253808">isZero</span>&nbsp;<span class="op" id="4253815">&gt;&gt;</span>&nbsp;<span class="num" id="4253818">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253822">isZero</span>&nbsp;<span class="op" id="4253829">|=</span>&nbsp;<span class="ident" id="4253832">isZero</span>&nbsp;<span class="op" id="4253839">&gt;&gt;</span>&nbsp;<span class="num" id="4253842">8</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253845">isZero</span>&nbsp;<span class="op" id="4253852">|=</span>&nbsp;<span class="ident" id="4253855">isZero</span>&nbsp;<span class="op" id="4253862">&gt;&gt;</span>&nbsp;<span class="num" id="4253865">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253868">isZero</span>&nbsp;<span class="op" id="4253875">|=</span>&nbsp;<span class="ident" id="4253878">isZero</span>&nbsp;<span class="op" id="4253885">&gt;&gt;</span>&nbsp;<span class="num" id="4253888">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253891">isZero</span>&nbsp;<span class="op" id="4253898">|=</span>&nbsp;<span class="ident" id="4253901">isZero</span>&nbsp;<span class="op" id="4253908">&gt;&gt;</span>&nbsp;<span class="num" id="4253911">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253915">isP</span>&nbsp;<span class="op" id="4253919">|=</span>&nbsp;<span class="ident" id="4253922">isP</span>&nbsp;<span class="op" id="4253926">&gt;&gt;</span>&nbsp;<span class="num" id="4253929">16</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253933">isP</span>&nbsp;<span class="op" id="4253937">|=</span>&nbsp;<span class="ident" id="4253940">isP</span>&nbsp;<span class="op" id="4253944">&gt;&gt;</span>&nbsp;<span class="num" id="4253947">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253950">isP</span>&nbsp;<span class="op" id="4253954">|=</span>&nbsp;<span class="ident" id="4253957">isP</span>&nbsp;<span class="op" id="4253961">&gt;&gt;</span>&nbsp;<span class="num" id="4253964">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253967">isP</span>&nbsp;<span class="op" id="4253971">|=</span>&nbsp;<span class="ident" id="4253974">isP</span>&nbsp;<span class="op" id="4253978">&gt;&gt;</span>&nbsp;<span class="num" id="4253981">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4253984">isP</span>&nbsp;<span class="op" id="4253988">|=</span>&nbsp;<span class="ident" id="4253991">isP</span>&nbsp;<span class="op" id="4253995">&gt;&gt;</span>&nbsp;<span class="num" id="4253998">1</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4254002">//&nbsp;For&nbsp;isZero&nbsp;and&nbsp;isP,&nbsp;the&nbsp;LSB&nbsp;is&nbsp;0&nbsp;iff&nbsp;all&nbsp;the&nbsp;bits&nbsp;are&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254066">result</span>&nbsp;<span class="op" id="4254073">:=</span>&nbsp;<span class="ident" id="4254076">isZero</span>&nbsp;<span class="op" id="4254083">&amp;</span>&nbsp;<span class="ident" id="4254085">isP</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254090">result</span>&nbsp;<span class="op" id="4254097">=</span>&nbsp;<span class="op" id="4254099">(</span><span class="op" id="4254100">^</span><span class="ident" id="4254101">result</span><span class="op" id="4254107">)</span>&nbsp;<span class="op" id="4254109">&amp;</span>&nbsp;<span class="num" id="4254111">1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254115">return</span>&nbsp;<span class="ident" id="4254122">result</span><br>
<span class="lineno">175</span><span class="op" id="4254129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4254132">//&nbsp;p224Add&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b</span><br>
<span class="lineno"></span><span class="comment" id="4254163">//</span><br>
<span class="lineno"></span><span class="comment" id="4254166">//&nbsp;a[i]&nbsp;+&nbsp;b[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno">180</span><span class="keyword" id="4254189">func</span>&nbsp;<span class="ident" id="4254194">p224Add</span><span class="op" id="4254201">(</span><span class="ident" id="4254202">out</span><span class="op" id="4254205">,</span>&nbsp;<span class="ident" id="4254207">a</span><span class="op" id="4254208">,</span>&nbsp;<span class="ident" id="4254210">b</span>&nbsp;<span class="op" id="4254212">*</span><span class="ident" id="4254213">p224FieldElement</span><span class="op" id="4254229">)</span>&nbsp;<span class="op" id="4254231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254234">for</span>&nbsp;<span class="ident" id="4254238">i</span>&nbsp;<span class="op" id="4254240">:=</span>&nbsp;<span class="num" id="4254243">0</span><span class="op" id="4254244">;</span>&nbsp;<span class="ident" id="4254246">i</span>&nbsp;<span class="op" id="4254248">&lt;</span>&nbsp;<span class="num" id="4254250">8</span><span class="op" id="4254251">;</span>&nbsp;<span class="ident" id="4254253">i</span><span class="op" id="4254254">++</span>&nbsp;<span class="op" id="4254257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254261">out</span><span class="op" id="4254264">[</span><span class="ident" id="4254265">i</span><span class="op" id="4254266">]</span>&nbsp;<span class="op" id="4254268">=</span>&nbsp;<span class="ident" id="4254270">a</span><span class="op" id="4254271">[</span><span class="ident" id="4254272">i</span><span class="op" id="4254273">]</span>&nbsp;<span class="op" id="4254275">+</span>&nbsp;<span class="ident" id="4254277">b</span><span class="op" id="4254278">[</span><span class="ident" id="4254279">i</span><span class="op" id="4254280">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4254283">}</span><br>
<span class="lineno"></span><span class="op" id="4254285">}</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span><span class="keyword" id="4254288">const</span>&nbsp;<span class="ident" id="4254294">two31p3</span>&nbsp;<span class="op" id="4254302">=</span>&nbsp;<span class="num" id="4254304">1</span><span class="op" id="4254305">&lt;&lt;</span><span class="num" id="4254307">31</span>&nbsp;<span class="op" id="4254310">+</span>&nbsp;<span class="num" id="4254312">1</span><span class="op" id="4254313">&lt;&lt;</span><span class="num" id="4254315">3</span><br>
<span class="lineno"></span><span class="keyword" id="4254317">const</span>&nbsp;<span class="ident" id="4254323">two31m3</span>&nbsp;<span class="op" id="4254331">=</span>&nbsp;<span class="num" id="4254333">1</span><span class="op" id="4254334">&lt;&lt;</span><span class="num" id="4254336">31</span>&nbsp;<span class="op" id="4254339">-</span>&nbsp;<span class="num" id="4254341">1</span><span class="op" id="4254342">&lt;&lt;</span><span class="num" id="4254344">3</span><br>
<span class="lineno"></span><span class="keyword" id="4254346">const</span>&nbsp;<span class="ident" id="4254352">two31m15m3</span>&nbsp;<span class="op" id="4254363">=</span>&nbsp;<span class="num" id="4254365">1</span><span class="op" id="4254366">&lt;&lt;</span><span class="num" id="4254368">31</span>&nbsp;<span class="op" id="4254371">-</span>&nbsp;<span class="num" id="4254373">1</span><span class="op" id="4254374">&lt;&lt;</span><span class="num" id="4254376">15</span>&nbsp;<span class="op" id="4254379">-</span>&nbsp;<span class="num" id="4254381">1</span><span class="op" id="4254382">&lt;&lt;</span><span class="num" id="4254384">3</span><br>
<span class="lineno"></span><br>
<span class="lineno">190</span><span class="comment" id="4254387">//&nbsp;p224ZeroModP31&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;31&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs&nbsp;so&nbsp;that&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span><span class="comment" id="4254464">//&nbsp;subtract&nbsp;smaller&nbsp;amounts&nbsp;without&nbsp;underflow.&nbsp;See&nbsp;the&nbsp;section&nbsp;&#34;Subtraction&#34;&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4254544">//&nbsp;[1]&nbsp;for&nbsp;reasoning.</span><br>
<span class="lineno"></span><span class="keyword" id="4254566">var</span>&nbsp;<span class="ident" id="4254570">p224ZeroModP31</span>&nbsp;<span class="op" id="4254585">=</span>&nbsp;<span class="op" id="4254587">[</span><span class="op" id="4254588">]</span><span class="builtintype" id="4254589">uint32</span><span class="op" id="4254595">{</span><span class="ident" id="4254596">two31p3</span><span class="op" id="4254603">,</span>&nbsp;<span class="ident" id="4254605">two31m3</span><span class="op" id="4254612">,</span>&nbsp;<span class="ident" id="4254614">two31m3</span><span class="op" id="4254621">,</span>&nbsp;<span class="ident" id="4254623">two31m15m3</span><span class="op" id="4254633">,</span>&nbsp;<span class="ident" id="4254635">two31m3</span><span class="op" id="4254642">,</span>&nbsp;<span class="ident" id="4254644">two31m3</span><span class="op" id="4254651">,</span>&nbsp;<span class="ident" id="4254653">two31m3</span><span class="op" id="4254660">,</span>&nbsp;<span class="ident" id="4254662">two31m3</span><span class="op" id="4254669">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="4254672">//&nbsp;p224Sub&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a-b</span><br>
<span class="lineno"></span><span class="comment" id="4254703">//</span><br>
<span class="lineno"></span><span class="comment" id="4254706">//&nbsp;a[i],&nbsp;b[i]&nbsp;&lt;&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4254728">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**32</span><br>
<span class="lineno"></span><span class="keyword" id="4254746">func</span>&nbsp;<span class="ident" id="4254751">p224Sub</span><span class="op" id="4254758">(</span><span class="ident" id="4254759">out</span><span class="op" id="4254762">,</span>&nbsp;<span class="ident" id="4254764">a</span><span class="op" id="4254765">,</span>&nbsp;<span class="ident" id="4254767">b</span>&nbsp;<span class="op" id="4254769">*</span><span class="ident" id="4254770">p224FieldElement</span><span class="op" id="4254786">)</span>&nbsp;<span class="op" id="4254788">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4254791">for</span>&nbsp;<span class="ident" id="4254795">i</span>&nbsp;<span class="op" id="4254797">:=</span>&nbsp;<span class="num" id="4254800">0</span><span class="op" id="4254801">;</span>&nbsp;<span class="ident" id="4254803">i</span>&nbsp;<span class="op" id="4254805">&lt;</span>&nbsp;<span class="num" id="4254807">8</span><span class="op" id="4254808">;</span>&nbsp;<span class="ident" id="4254810">i</span><span class="op" id="4254811">++</span>&nbsp;<span class="op" id="4254814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4254818">out</span><span class="op" id="4254821">[</span><span class="ident" id="4254822">i</span><span class="op" id="4254823">]</span>&nbsp;<span class="op" id="4254825">=</span>&nbsp;<span class="ident" id="4254827">a</span><span class="op" id="4254828">[</span><span class="ident" id="4254829">i</span><span class="op" id="4254830">]</span>&nbsp;<span class="op" id="4254832">+</span>&nbsp;<span class="ident" id="4254834">p224ZeroModP31</span><span class="op" id="4254848">[</span><span class="ident" id="4254849">i</span><span class="op" id="4254850">]</span>&nbsp;<span class="op" id="4254852">-</span>&nbsp;<span class="ident" id="4254854">b</span><span class="op" id="4254855">[</span><span class="ident" id="4254856">i</span><span class="op" id="4254857">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4254860">}</span><br>
<span class="lineno"></span><span class="op" id="4254862">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">205</span><span class="comment" id="4254865">//&nbsp;LargeFieldElement&nbsp;also&nbsp;represents&nbsp;an&nbsp;element&nbsp;of&nbsp;the&nbsp;field.&nbsp;The&nbsp;limbs&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="4254941">//&nbsp;still&nbsp;spaced&nbsp;28-bits&nbsp;apart&nbsp;and&nbsp;in&nbsp;little-endian&nbsp;order.&nbsp;So&nbsp;the&nbsp;limbs&nbsp;are&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="4255019">//&nbsp;0,&nbsp;28,&nbsp;56,&nbsp;...,&nbsp;392&nbsp;bits,&nbsp;each&nbsp;64-bits&nbsp;wide.</span><br>
<span class="lineno"></span><span class="keyword" id="4255067">type</span>&nbsp;<span class="ident" id="4255072">p224LargeFieldElement</span>&nbsp;<span class="op" id="4255094">[</span><span class="num" id="4255095">15</span><span class="op" id="4255097">]</span><span class="ident" id="4255098">uint64</span><br>
<span class="lineno"></span><br>
<span class="lineno">210</span><span class="keyword" id="4255106">const</span>&nbsp;<span class="ident" id="4255112">two63p35</span>&nbsp;<span class="op" id="4255121">=</span>&nbsp;<span class="num" id="4255123">1</span><span class="op" id="4255124">&lt;&lt;</span><span class="num" id="4255126">63</span>&nbsp;<span class="op" id="4255129">+</span>&nbsp;<span class="num" id="4255131">1</span><span class="op" id="4255132">&lt;&lt;</span><span class="num" id="4255134">35</span><br>
<span class="lineno"></span><span class="keyword" id="4255137">const</span>&nbsp;<span class="ident" id="4255143">two63m35</span>&nbsp;<span class="op" id="4255152">=</span>&nbsp;<span class="num" id="4255154">1</span><span class="op" id="4255155">&lt;&lt;</span><span class="num" id="4255157">63</span>&nbsp;<span class="op" id="4255160">-</span>&nbsp;<span class="num" id="4255162">1</span><span class="op" id="4255163">&lt;&lt;</span><span class="num" id="4255165">35</span><br>
<span class="lineno"></span><span class="keyword" id="4255168">const</span>&nbsp;<span class="ident" id="4255174">two63m35m19</span>&nbsp;<span class="op" id="4255186">=</span>&nbsp;<span class="num" id="4255188">1</span><span class="op" id="4255189">&lt;&lt;</span><span class="num" id="4255191">63</span>&nbsp;<span class="op" id="4255194">-</span>&nbsp;<span class="num" id="4255196">1</span><span class="op" id="4255197">&lt;&lt;</span><span class="num" id="4255199">35</span>&nbsp;<span class="op" id="4255202">-</span>&nbsp;<span class="num" id="4255204">1</span><span class="op" id="4255205">&lt;&lt;</span><span class="num" id="4255207">19</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4255211">//&nbsp;p224ZeroModP63&nbsp;is&nbsp;0&nbsp;mod&nbsp;p&nbsp;where&nbsp;bit&nbsp;63&nbsp;is&nbsp;set&nbsp;in&nbsp;all&nbsp;limbs.&nbsp;See&nbsp;the&nbsp;section</span><br>
<span class="lineno">215</span><span class="comment" id="4255290">//&nbsp;&#34;Subtraction&#34;&nbsp;in&nbsp;[1]&nbsp;for&nbsp;why.</span><br>
<span class="lineno"></span><span class="keyword" id="4255323">var</span>&nbsp;<span class="ident" id="4255327">p224ZeroModP63</span>&nbsp;<span class="op" id="4255342">=</span>&nbsp;<span class="op" id="4255344">[</span><span class="num" id="4255345">8</span><span class="op" id="4255346">]</span><span class="ident" id="4255347">uint64</span><span class="op" id="4255353">{</span><span class="ident" id="4255354">two63p35</span><span class="op" id="4255362">,</span>&nbsp;<span class="ident" id="4255364">two63m35</span><span class="op" id="4255372">,</span>&nbsp;<span class="ident" id="4255374">two63m35</span><span class="op" id="4255382">,</span>&nbsp;<span class="ident" id="4255384">two63m35</span><span class="op" id="4255392">,</span>&nbsp;<span class="ident" id="4255394">two63m35m19</span><span class="op" id="4255405">,</span>&nbsp;<span class="ident" id="4255407">two63m35</span><span class="op" id="4255415">,</span>&nbsp;<span class="ident" id="4255417">two63m35</span><span class="op" id="4255425">,</span>&nbsp;<span class="ident" id="4255427">two63m35</span><span class="op" id="4255435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4255438">const</span>&nbsp;<span class="ident" id="4255444">bottom12Bits</span>&nbsp;<span class="op" id="4255457">=</span>&nbsp;<span class="num" id="4255459">0xfff</span><br>
<span class="lineno"></span><span class="keyword" id="4255465">const</span>&nbsp;<span class="ident" id="4255471">bottom28Bits</span>&nbsp;<span class="op" id="4255484">=</span>&nbsp;<span class="num" id="4255486">0xfffffff</span><br>
<span class="lineno">220</span><br>
<span class="lineno"></span><span class="comment" id="4255497">//&nbsp;p224Mul&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*b</span><br>
<span class="lineno"></span><span class="comment" id="4255528">//</span><br>
<span class="lineno"></span><span class="comment" id="4255531">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29,&nbsp;b[i]&nbsp;&lt;&nbsp;2**30&nbsp;(or&nbsp;vice&nbsp;versa)</span><br>
<span class="lineno"></span><span class="comment" id="4255577">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">225</span><span class="keyword" id="4255595">func</span>&nbsp;<span class="ident" id="4255600">p224Mul</span><span class="op" id="4255607">(</span><span class="ident" id="4255608">out</span><span class="op" id="4255611">,</span>&nbsp;<span class="ident" id="4255613">a</span><span class="op" id="4255614">,</span>&nbsp;<span class="ident" id="4255616">b</span>&nbsp;<span class="op" id="4255618">*</span><span class="ident" id="4255619">p224FieldElement</span><span class="op" id="4255635">,</span>&nbsp;<span class="ident" id="4255637">tmp</span>&nbsp;<span class="op" id="4255641">*</span><span class="ident" id="4255642">p224LargeFieldElement</span><span class="op" id="4255663">)</span>&nbsp;<span class="op" id="4255665">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4255668">for</span>&nbsp;<span class="ident" id="4255672">i</span>&nbsp;<span class="op" id="4255674">:=</span>&nbsp;<span class="num" id="4255677">0</span><span class="op" id="4255678">;</span>&nbsp;<span class="ident" id="4255680">i</span>&nbsp;<span class="op" id="4255682">&lt;</span>&nbsp;<span class="num" id="4255684">15</span><span class="op" id="4255686">;</span>&nbsp;<span class="ident" id="4255688">i</span><span class="op" id="4255689">++</span>&nbsp;<span class="op" id="4255692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255696">tmp</span><span class="op" id="4255699">[</span><span class="ident" id="4255700">i</span><span class="op" id="4255701">]</span>&nbsp;<span class="op" id="4255703">=</span>&nbsp;<span class="num" id="4255705">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4255708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4255712">for</span>&nbsp;<span class="ident" id="4255716">i</span>&nbsp;<span class="op" id="4255718">:=</span>&nbsp;<span class="num" id="4255721">0</span><span class="op" id="4255722">;</span>&nbsp;<span class="ident" id="4255724">i</span>&nbsp;<span class="op" id="4255726">&lt;</span>&nbsp;<span class="num" id="4255728">8</span><span class="op" id="4255729">;</span>&nbsp;<span class="ident" id="4255731">i</span><span class="op" id="4255732">++</span>&nbsp;<span class="op" id="4255735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4255739">for</span>&nbsp;<span class="ident" id="4255743">j</span>&nbsp;<span class="op" id="4255745">:=</span>&nbsp;<span class="num" id="4255748">0</span><span class="op" id="4255749">;</span>&nbsp;<span class="ident" id="4255751">j</span>&nbsp;<span class="op" id="4255753">&lt;</span>&nbsp;<span class="num" id="4255755">8</span><span class="op" id="4255756">;</span>&nbsp;<span class="ident" id="4255758">j</span><span class="op" id="4255759">++</span>&nbsp;<span class="op" id="4255762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255767">tmp</span><span class="op" id="4255770">[</span><span class="ident" id="4255771">i</span><span class="op" id="4255772">+</span><span class="ident" id="4255773">j</span><span class="op" id="4255774">]</span>&nbsp;<span class="op" id="4255776">+=</span>&nbsp;<span class="ident" id="4255779">uint64</span><span class="op" id="4255785">(</span><span class="ident" id="4255786">a</span><span class="op" id="4255787">[</span><span class="ident" id="4255788">i</span><span class="op" id="4255789">]</span><span class="op" id="4255790">)</span>&nbsp;<span class="op" id="4255792">*</span>&nbsp;<span class="ident" id="4255794">uint64</span><span class="op" id="4255800">(</span><span class="ident" id="4255801">b</span><span class="op" id="4255802">[</span><span class="ident" id="4255803">j</span><span class="op" id="4255804">]</span><span class="op" id="4255805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4255809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4255812">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4255816">p224ReduceLarge</span><span class="op" id="4255831">(</span><span class="ident" id="4255832">out</span><span class="op" id="4255835">,</span>&nbsp;<span class="ident" id="4255837">tmp</span><span class="op" id="4255840">)</span><br>
<span class="lineno"></span><span class="op" id="4255842">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4255845">//&nbsp;Square&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a*a</span><br>
<span class="lineno">240</span><span class="comment" id="4255875">//</span><br>
<span class="lineno"></span><span class="comment" id="4255878">//&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4255894">//&nbsp;out[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="keyword" id="4255912">func</span>&nbsp;<span class="ident" id="4255917">p224Square</span><span class="op" id="4255927">(</span><span class="ident" id="4255928">out</span><span class="op" id="4255931">,</span>&nbsp;<span class="ident" id="4255933">a</span>&nbsp;<span class="op" id="4255935">*</span><span class="ident" id="4255936">p224FieldElement</span><span class="op" id="4255952">,</span>&nbsp;<span class="ident" id="4255954">tmp</span>&nbsp;<span class="op" id="4255958">*</span><span class="ident" id="4255959">p224LargeFieldElement</span><span class="op" id="4255980">)</span>&nbsp;<span class="op" id="4255982">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4255985">for</span>&nbsp;<span class="ident" id="4255989">i</span>&nbsp;<span class="op" id="4255991">:=</span>&nbsp;<span class="num" id="4255994">0</span><span class="op" id="4255995">;</span>&nbsp;<span class="ident" id="4255997">i</span>&nbsp;<span class="op" id="4255999">&lt;</span>&nbsp;<span class="num" id="4256001">15</span><span class="op" id="4256003">;</span>&nbsp;<span class="ident" id="4256005">i</span><span class="op" id="4256006">++</span>&nbsp;<span class="op" id="4256009">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256013">tmp</span><span class="op" id="4256016">[</span><span class="ident" id="4256017">i</span><span class="op" id="4256018">]</span>&nbsp;<span class="op" id="4256020">=</span>&nbsp;<span class="num" id="4256022">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4256025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256029">for</span>&nbsp;<span class="ident" id="4256033">i</span>&nbsp;<span class="op" id="4256035">:=</span>&nbsp;<span class="num" id="4256038">0</span><span class="op" id="4256039">;</span>&nbsp;<span class="ident" id="4256041">i</span>&nbsp;<span class="op" id="4256043">&lt;</span>&nbsp;<span class="num" id="4256045">8</span><span class="op" id="4256046">;</span>&nbsp;<span class="ident" id="4256048">i</span><span class="op" id="4256049">++</span>&nbsp;<span class="op" id="4256052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256056">for</span>&nbsp;<span class="ident" id="4256060">j</span>&nbsp;<span class="op" id="4256062">:=</span>&nbsp;<span class="num" id="4256065">0</span><span class="op" id="4256066">;</span>&nbsp;<span class="ident" id="4256068">j</span>&nbsp;<span class="op" id="4256070">&lt;=</span>&nbsp;<span class="ident" id="4256073">i</span><span class="op" id="4256074">;</span>&nbsp;<span class="ident" id="4256076">j</span><span class="op" id="4256077">++</span>&nbsp;<span class="op" id="4256080">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256085">r</span>&nbsp;<span class="op" id="4256087">:=</span>&nbsp;<span class="ident" id="4256090">uint64</span><span class="op" id="4256096">(</span><span class="ident" id="4256097">a</span><span class="op" id="4256098">[</span><span class="ident" id="4256099">i</span><span class="op" id="4256100">]</span><span class="op" id="4256101">)</span>&nbsp;<span class="op" id="4256103">*</span>&nbsp;<span class="ident" id="4256105">uint64</span><span class="op" id="4256111">(</span><span class="ident" id="4256112">a</span><span class="op" id="4256113">[</span><span class="ident" id="4256114">j</span><span class="op" id="4256115">]</span><span class="op" id="4256116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256121">if</span>&nbsp;<span class="ident" id="4256124">i</span>&nbsp;<span class="op" id="4256126">==</span>&nbsp;<span class="ident" id="4256129">j</span>&nbsp;<span class="op" id="4256131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256137">tmp</span><span class="op" id="4256140">[</span><span class="ident" id="4256141">i</span><span class="op" id="4256142">+</span><span class="ident" id="4256143">j</span><span class="op" id="4256144">]</span>&nbsp;<span class="op" id="4256146">+=</span>&nbsp;<span class="ident" id="4256149">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4256154">}</span>&nbsp;<span class="keyword" id="4256156">else</span>&nbsp;<span class="op" id="4256161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256167">tmp</span><span class="op" id="4256170">[</span><span class="ident" id="4256171">i</span><span class="op" id="4256172">+</span><span class="ident" id="4256173">j</span><span class="op" id="4256174">]</span>&nbsp;<span class="op" id="4256176">+=</span>&nbsp;<span class="ident" id="4256179">r</span>&nbsp;<span class="op" id="4256181">&lt;&lt;</span>&nbsp;<span class="num" id="4256184">1</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4256189">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4256193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4256196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256200">p224ReduceLarge</span><span class="op" id="4256215">(</span><span class="ident" id="4256216">out</span><span class="op" id="4256219">,</span>&nbsp;<span class="ident" id="4256221">tmp</span><span class="op" id="4256224">)</span><br>
<span class="lineno">260</span><span class="op" id="4256226">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4256229">//&nbsp;ReduceLarge&nbsp;converts&nbsp;a&nbsp;p224LargeFieldElement&nbsp;to&nbsp;a&nbsp;p224FieldElement.</span><br>
<span class="lineno"></span><span class="comment" id="4256300">//</span><br>
<span class="lineno"></span><span class="comment" id="4256303">//&nbsp;in[i]&nbsp;&lt;&nbsp;2**62</span><br>
<span class="lineno">265</span><span class="keyword" id="4256320">func</span>&nbsp;<span class="ident" id="4256325">p224ReduceLarge</span><span class="op" id="4256340">(</span><span class="ident" id="4256341">out</span>&nbsp;<span class="op" id="4256345">*</span><span class="ident" id="4256346">p224FieldElement</span><span class="op" id="4256362">,</span>&nbsp;<span class="ident" id="4256364">in</span>&nbsp;<span class="op" id="4256367">*</span><span class="ident" id="4256368">p224LargeFieldElement</span><span class="op" id="4256389">)</span>&nbsp;<span class="op" id="4256391">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256394">for</span>&nbsp;<span class="ident" id="4256398">i</span>&nbsp;<span class="op" id="4256400">:=</span>&nbsp;<span class="num" id="4256403">0</span><span class="op" id="4256404">;</span>&nbsp;<span class="ident" id="4256406">i</span>&nbsp;<span class="op" id="4256408">&lt;</span>&nbsp;<span class="num" id="4256410">8</span><span class="op" id="4256411">;</span>&nbsp;<span class="ident" id="4256413">i</span><span class="op" id="4256414">++</span>&nbsp;<span class="op" id="4256417">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256421">in</span><span class="op" id="4256423">[</span><span class="ident" id="4256424">i</span><span class="op" id="4256425">]</span>&nbsp;<span class="op" id="4256427">+=</span>&nbsp;<span class="ident" id="4256430">p224ZeroModP63</span><span class="op" id="4256444">[</span><span class="ident" id="4256445">i</span><span class="op" id="4256446">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4256449">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4256453">//&nbsp;Eliminate&nbsp;the&nbsp;coefficients&nbsp;at&nbsp;2**224&nbsp;and&nbsp;greater.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256507">for</span>&nbsp;<span class="ident" id="4256511">i</span>&nbsp;<span class="op" id="4256513">:=</span>&nbsp;<span class="num" id="4256516">14</span><span class="op" id="4256518">;</span>&nbsp;<span class="ident" id="4256520">i</span>&nbsp;<span class="op" id="4256522">&gt;=</span>&nbsp;<span class="num" id="4256525">8</span><span class="op" id="4256526">;</span>&nbsp;<span class="ident" id="4256528">i</span><span class="op" id="4256529">--</span>&nbsp;<span class="op" id="4256532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256536">in</span><span class="op" id="4256538">[</span><span class="ident" id="4256539">i</span><span class="op" id="4256540">-</span><span class="num" id="4256541">8</span><span class="op" id="4256542">]</span>&nbsp;<span class="op" id="4256544">-=</span>&nbsp;<span class="ident" id="4256547">in</span><span class="op" id="4256549">[</span><span class="ident" id="4256550">i</span><span class="op" id="4256551">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256555">in</span><span class="op" id="4256557">[</span><span class="ident" id="4256558">i</span><span class="op" id="4256559">-</span><span class="num" id="4256560">5</span><span class="op" id="4256561">]</span>&nbsp;<span class="op" id="4256563">+=</span>&nbsp;<span class="op" id="4256566">(</span><span class="ident" id="4256567">in</span><span class="op" id="4256569">[</span><span class="ident" id="4256570">i</span><span class="op" id="4256571">]</span>&nbsp;<span class="op" id="4256573">&amp;</span>&nbsp;<span class="num" id="4256575">0xffff</span><span class="op" id="4256581">)</span>&nbsp;<span class="op" id="4256583">&lt;&lt;</span>&nbsp;<span class="num" id="4256586">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256591">in</span><span class="op" id="4256593">[</span><span class="ident" id="4256594">i</span><span class="op" id="4256595">-</span><span class="num" id="4256596">4</span><span class="op" id="4256597">]</span>&nbsp;<span class="op" id="4256599">+=</span>&nbsp;<span class="ident" id="4256602">in</span><span class="op" id="4256604">[</span><span class="ident" id="4256605">i</span><span class="op" id="4256606">]</span>&nbsp;<span class="op" id="4256608">&gt;&gt;</span>&nbsp;<span class="num" id="4256611">16</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4256615">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256618">in</span><span class="op" id="4256620">[</span><span class="num" id="4256621">8</span><span class="op" id="4256622">]</span>&nbsp;<span class="op" id="4256624">=</span>&nbsp;<span class="num" id="4256626">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4256629">//&nbsp;in[0..8]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4256651">//&nbsp;As&nbsp;the&nbsp;values&nbsp;become&nbsp;small&nbsp;enough,&nbsp;we&nbsp;start&nbsp;to&nbsp;store&nbsp;them&nbsp;in&nbsp;|out|</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4256722">//&nbsp;and&nbsp;use&nbsp;32-bit&nbsp;operations.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4256753">for</span>&nbsp;<span class="ident" id="4256757">i</span>&nbsp;<span class="op" id="4256759">:=</span>&nbsp;<span class="num" id="4256762">1</span><span class="op" id="4256763">;</span>&nbsp;<span class="ident" id="4256765">i</span>&nbsp;<span class="op" id="4256767">&lt;</span>&nbsp;<span class="num" id="4256769">8</span><span class="op" id="4256770">;</span>&nbsp;<span class="ident" id="4256772">i</span><span class="op" id="4256773">++</span>&nbsp;<span class="op" id="4256776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256780">in</span><span class="op" id="4256782">[</span><span class="ident" id="4256783">i</span><span class="op" id="4256784">+</span><span class="num" id="4256785">1</span><span class="op" id="4256786">]</span>&nbsp;<span class="op" id="4256788">+=</span>&nbsp;<span class="ident" id="4256791">in</span><span class="op" id="4256793">[</span><span class="ident" id="4256794">i</span><span class="op" id="4256795">]</span>&nbsp;<span class="op" id="4256797">&gt;&gt;</span>&nbsp;<span class="num" id="4256800">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256805">out</span><span class="op" id="4256808">[</span><span class="ident" id="4256809">i</span><span class="op" id="4256810">]</span>&nbsp;<span class="op" id="4256812">=</span>&nbsp;<span class="builtintype" id="4256814">uint32</span><span class="op" id="4256820">(</span><span class="ident" id="4256821">in</span><span class="op" id="4256823">[</span><span class="ident" id="4256824">i</span><span class="op" id="4256825">]</span>&nbsp;<span class="op" id="4256827">&amp;</span>&nbsp;<span class="ident" id="4256829">bottom28Bits</span><span class="op" id="4256841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4256844">}</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256847">in</span><span class="op" id="4256849">[</span><span class="num" id="4256850">0</span><span class="op" id="4256851">]</span>&nbsp;<span class="op" id="4256853">-=</span>&nbsp;<span class="ident" id="4256856">in</span><span class="op" id="4256858">[</span><span class="num" id="4256859">8</span><span class="op" id="4256860">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256863">out</span><span class="op" id="4256866">[</span><span class="num" id="4256867">3</span><span class="op" id="4256868">]</span>&nbsp;<span class="op" id="4256870">+=</span>&nbsp;<span class="builtintype" id="4256873">uint32</span><span class="op" id="4256879">(</span><span class="ident" id="4256880">in</span><span class="op" id="4256882">[</span><span class="num" id="4256883">8</span><span class="op" id="4256884">]</span><span class="op" id="4256885">&amp;</span><span class="num" id="4256886">0xffff</span><span class="op" id="4256892">)</span>&nbsp;<span class="op" id="4256894">&lt;&lt;</span>&nbsp;<span class="num" id="4256897">12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4256901">out</span><span class="op" id="4256904">[</span><span class="num" id="4256905">4</span><span class="op" id="4256906">]</span>&nbsp;<span class="op" id="4256908">+=</span>&nbsp;<span class="builtintype" id="4256911">uint32</span><span class="op" id="4256917">(</span><span class="ident" id="4256918">in</span><span class="op" id="4256920">[</span><span class="num" id="4256921">8</span><span class="op" id="4256922">]</span>&nbsp;<span class="op" id="4256924">&gt;&gt;</span>&nbsp;<span class="num" id="4256927">16</span><span class="op" id="4256929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4256932">//&nbsp;in[0]&nbsp;&lt;&nbsp;2**64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4256950">//&nbsp;out[3]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4256969">//&nbsp;out[4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4256988">//&nbsp;out[1,2,5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257015">out</span><span class="op" id="4257018">[</span><span class="num" id="4257019">0</span><span class="op" id="4257020">]</span>&nbsp;<span class="op" id="4257022">=</span>&nbsp;<span class="builtintype" id="4257024">uint32</span><span class="op" id="4257030">(</span><span class="ident" id="4257031">in</span><span class="op" id="4257033">[</span><span class="num" id="4257034">0</span><span class="op" id="4257035">]</span>&nbsp;<span class="op" id="4257037">&amp;</span>&nbsp;<span class="ident" id="4257039">bottom28Bits</span><span class="op" id="4257051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257054">out</span><span class="op" id="4257057">[</span><span class="num" id="4257058">1</span><span class="op" id="4257059">]</span>&nbsp;<span class="op" id="4257061">+=</span>&nbsp;<span class="builtintype" id="4257064">uint32</span><span class="op" id="4257070">(</span><span class="op" id="4257071">(</span><span class="ident" id="4257072">in</span><span class="op" id="4257074">[</span><span class="num" id="4257075">0</span><span class="op" id="4257076">]</span>&nbsp;<span class="op" id="4257078">&gt;&gt;</span>&nbsp;<span class="num" id="4257081">28</span><span class="op" id="4257083">)</span>&nbsp;<span class="op" id="4257085">&amp;</span>&nbsp;<span class="ident" id="4257087">bottom28Bits</span><span class="op" id="4257099">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257102">out</span><span class="op" id="4257105">[</span><span class="num" id="4257106">2</span><span class="op" id="4257107">]</span>&nbsp;<span class="op" id="4257109">+=</span>&nbsp;<span class="builtintype" id="4257112">uint32</span><span class="op" id="4257118">(</span><span class="ident" id="4257119">in</span><span class="op" id="4257121">[</span><span class="num" id="4257122">0</span><span class="op" id="4257123">]</span>&nbsp;<span class="op" id="4257125">&gt;&gt;</span>&nbsp;<span class="num" id="4257128">56</span><span class="op" id="4257130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4257133">//&nbsp;out[0]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4257152">//&nbsp;out[1..4]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4257174">//&nbsp;out[5..7]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="op" id="4257195">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="4257198">//&nbsp;Reduce&nbsp;reduces&nbsp;the&nbsp;coefficients&nbsp;of&nbsp;a&nbsp;to&nbsp;smaller&nbsp;bounds.</span><br>
<span class="lineno"></span><span class="comment" id="4257257">//</span><br>
<span class="lineno"></span><span class="comment" id="4257260">//&nbsp;On&nbsp;entry:&nbsp;a[i]&nbsp;&lt;&nbsp;2**31&nbsp;+&nbsp;2**30</span><br>
<span class="lineno"></span><span class="comment" id="4257294">//&nbsp;On&nbsp;exit:&nbsp;a[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno">305</span><span class="keyword" id="4257319">func</span>&nbsp;<span class="ident" id="4257324">p224Reduce</span><span class="op" id="4257334">(</span><span class="ident" id="4257335">a</span>&nbsp;<span class="op" id="4257337">*</span><span class="ident" id="4257338">p224FieldElement</span><span class="op" id="4257354">)</span>&nbsp;<span class="op" id="4257356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4257359">for</span>&nbsp;<span class="ident" id="4257363">i</span>&nbsp;<span class="op" id="4257365">:=</span>&nbsp;<span class="num" id="4257368">0</span><span class="op" id="4257369">;</span>&nbsp;<span class="ident" id="4257371">i</span>&nbsp;<span class="op" id="4257373">&lt;</span>&nbsp;<span class="num" id="4257375">7</span><span class="op" id="4257376">;</span>&nbsp;<span class="ident" id="4257378">i</span><span class="op" id="4257379">++</span>&nbsp;<span class="op" id="4257382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257386">a</span><span class="op" id="4257387">[</span><span class="ident" id="4257388">i</span><span class="op" id="4257389">+</span><span class="num" id="4257390">1</span><span class="op" id="4257391">]</span>&nbsp;<span class="op" id="4257393">+=</span>&nbsp;<span class="ident" id="4257396">a</span><span class="op" id="4257397">[</span><span class="ident" id="4257398">i</span><span class="op" id="4257399">]</span>&nbsp;<span class="op" id="4257401">&gt;&gt;</span>&nbsp;<span class="num" id="4257404">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257409">a</span><span class="op" id="4257410">[</span><span class="ident" id="4257411">i</span><span class="op" id="4257412">]</span>&nbsp;<span class="op" id="4257414">&amp;=</span>&nbsp;<span class="ident" id="4257417">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4257431">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257434">top</span>&nbsp;<span class="op" id="4257438">:=</span>&nbsp;<span class="ident" id="4257441">a</span><span class="op" id="4257442">[</span><span class="num" id="4257443">7</span><span class="op" id="4257444">]</span>&nbsp;<span class="op" id="4257446">&gt;&gt;</span>&nbsp;<span class="num" id="4257449">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257453">a</span><span class="op" id="4257454">[</span><span class="num" id="4257455">7</span><span class="op" id="4257456">]</span>&nbsp;<span class="op" id="4257458">&amp;=</span>&nbsp;<span class="ident" id="4257461">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4257476">//&nbsp;top&nbsp;&lt;&nbsp;2**4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257491">mask</span>&nbsp;<span class="op" id="4257496">:=</span>&nbsp;<span class="ident" id="4257499">top</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257504">mask</span>&nbsp;<span class="op" id="4257509">|=</span>&nbsp;<span class="ident" id="4257512">mask</span>&nbsp;<span class="op" id="4257517">&gt;&gt;</span>&nbsp;<span class="num" id="4257520">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257523">mask</span>&nbsp;<span class="op" id="4257528">|=</span>&nbsp;<span class="ident" id="4257531">mask</span>&nbsp;<span class="op" id="4257536">&gt;&gt;</span>&nbsp;<span class="num" id="4257539">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257542">mask</span>&nbsp;<span class="op" id="4257547">&lt;&lt;=</span>&nbsp;<span class="num" id="4257551">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257555">mask</span>&nbsp;<span class="op" id="4257560">=</span>&nbsp;<span class="builtintype" id="4257562">uint32</span><span class="op" id="4257568">(</span><span class="builtintype" id="4257569">int32</span><span class="op" id="4257574">(</span><span class="ident" id="4257575">mask</span><span class="op" id="4257579">)</span>&nbsp;<span class="op" id="4257581">&gt;&gt;</span>&nbsp;<span class="num" id="4257584">31</span><span class="op" id="4257586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4257589">//&nbsp;Mask&nbsp;is&nbsp;all&nbsp;ones&nbsp;if&nbsp;top&nbsp;!=&nbsp;0,&nbsp;all&nbsp;zero&nbsp;otherwise</span><br>
<span class="lineno">320</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257643">a</span><span class="op" id="4257644">[</span><span class="num" id="4257645">0</span><span class="op" id="4257646">]</span>&nbsp;<span class="op" id="4257648">-=</span>&nbsp;<span class="ident" id="4257651">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257656">a</span><span class="op" id="4257657">[</span><span class="num" id="4257658">3</span><span class="op" id="4257659">]</span>&nbsp;<span class="op" id="4257661">+=</span>&nbsp;<span class="ident" id="4257664">top</span>&nbsp;<span class="op" id="4257668">&lt;&lt;</span>&nbsp;<span class="num" id="4257671">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4257676">//&nbsp;We&nbsp;may&nbsp;have&nbsp;just&nbsp;made&nbsp;a[0]&nbsp;negative&nbsp;but,&nbsp;if&nbsp;we&nbsp;did,&nbsp;then&nbsp;we&nbsp;must</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4257745">//&nbsp;have&nbsp;added&nbsp;something&nbsp;to&nbsp;a[3],&nbsp;this&nbsp;it&#39;s&nbsp;&gt;&nbsp;2**12.&nbsp;Therefore&nbsp;we&nbsp;can</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4257815">//&nbsp;carry&nbsp;down&nbsp;to&nbsp;a[0].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257839">a</span><span class="op" id="4257840">[</span><span class="num" id="4257841">3</span><span class="op" id="4257842">]</span>&nbsp;<span class="op" id="4257844">-=</span>&nbsp;<span class="num" id="4257847">1</span>&nbsp;<span class="op" id="4257849">&amp;</span>&nbsp;<span class="ident" id="4257851">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257857">a</span><span class="op" id="4257858">[</span><span class="num" id="4257859">2</span><span class="op" id="4257860">]</span>&nbsp;<span class="op" id="4257862">+=</span>&nbsp;<span class="ident" id="4257865">mask</span>&nbsp;<span class="op" id="4257870">&amp;</span>&nbsp;<span class="op" id="4257872">(</span><span class="num" id="4257873">1</span><span class="op" id="4257874">&lt;&lt;</span><span class="num" id="4257876">28</span>&nbsp;<span class="op" id="4257879">-</span>&nbsp;<span class="num" id="4257881">1</span><span class="op" id="4257882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257885">a</span><span class="op" id="4257886">[</span><span class="num" id="4257887">1</span><span class="op" id="4257888">]</span>&nbsp;<span class="op" id="4257890">+=</span>&nbsp;<span class="ident" id="4257893">mask</span>&nbsp;<span class="op" id="4257898">&amp;</span>&nbsp;<span class="op" id="4257900">(</span><span class="num" id="4257901">1</span><span class="op" id="4257902">&lt;&lt;</span><span class="num" id="4257904">28</span>&nbsp;<span class="op" id="4257907">-</span>&nbsp;<span class="num" id="4257909">1</span><span class="op" id="4257910">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4257913">a</span><span class="op" id="4257914">[</span><span class="num" id="4257915">0</span><span class="op" id="4257916">]</span>&nbsp;<span class="op" id="4257918">+=</span>&nbsp;<span class="ident" id="4257921">mask</span>&nbsp;<span class="op" id="4257926">&amp;</span>&nbsp;<span class="op" id="4257928">(</span><span class="num" id="4257929">1</span>&nbsp;<span class="op" id="4257931">&lt;&lt;</span>&nbsp;<span class="num" id="4257934">28</span><span class="op" id="4257936">)</span><br>
<span class="lineno"></span><span class="op" id="4257938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4257941">//&nbsp;p224Invert&nbsp;calculates&nbsp;*out&nbsp;=&nbsp;in**-1&nbsp;by&nbsp;computing&nbsp;in**(2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1),</span><br>
<span class="lineno"></span><span class="comment" id="4258019">//&nbsp;i.e.&nbsp;Fermat&#39;s&nbsp;little&nbsp;theorem.</span><br>
<span class="lineno">335</span><span class="keyword" id="4258052">func</span>&nbsp;<span class="ident" id="4258057">p224Invert</span><span class="op" id="4258067">(</span><span class="ident" id="4258068">out</span><span class="op" id="4258071">,</span>&nbsp;<span class="ident" id="4258073">in</span>&nbsp;<span class="op" id="4258076">*</span><span class="ident" id="4258077">p224FieldElement</span><span class="op" id="4258093">)</span>&nbsp;<span class="op" id="4258095">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4258098">var</span>&nbsp;<span class="ident" id="4258102">f1</span><span class="op" id="4258104">,</span>&nbsp;<span class="ident" id="4258106">f2</span><span class="op" id="4258108">,</span>&nbsp;<span class="ident" id="4258110">f3</span><span class="op" id="4258112">,</span>&nbsp;<span class="ident" id="4258114">f4</span>&nbsp;<span class="ident" id="4258117">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4258135">var</span>&nbsp;<span class="ident" id="4258139">c</span>&nbsp;<span class="ident" id="4258141">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258165">p224Square</span><span class="op" id="4258175">(</span><span class="op" id="4258176">&amp;</span><span class="ident" id="4258177">f1</span><span class="op" id="4258179">,</span>&nbsp;<span class="ident" id="4258181">in</span><span class="op" id="4258183">,</span>&nbsp;<span class="op" id="4258185">&amp;</span><span class="ident" id="4258186">c</span><span class="op" id="4258187">)</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4258192">//&nbsp;2</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258198">p224Mul</span><span class="op" id="4258205">(</span><span class="op" id="4258206">&amp;</span><span class="ident" id="4258207">f1</span><span class="op" id="4258209">,</span>&nbsp;<span class="op" id="4258211">&amp;</span><span class="ident" id="4258212">f1</span><span class="op" id="4258214">,</span>&nbsp;<span class="ident" id="4258216">in</span><span class="op" id="4258218">,</span>&nbsp;<span class="op" id="4258220">&amp;</span><span class="ident" id="4258221">c</span><span class="op" id="4258222">)</span>&nbsp;&nbsp;<span class="comment" id="4258225">//&nbsp;2**2&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258238">p224Square</span><span class="op" id="4258248">(</span><span class="op" id="4258249">&amp;</span><span class="ident" id="4258250">f1</span><span class="op" id="4258252">,</span>&nbsp;<span class="op" id="4258254">&amp;</span><span class="ident" id="4258255">f1</span><span class="op" id="4258257">,</span>&nbsp;<span class="op" id="4258259">&amp;</span><span class="ident" id="4258260">c</span><span class="op" id="4258261">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4258265">//&nbsp;2**3&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258278">p224Mul</span><span class="op" id="4258285">(</span><span class="op" id="4258286">&amp;</span><span class="ident" id="4258287">f1</span><span class="op" id="4258289">,</span>&nbsp;<span class="op" id="4258291">&amp;</span><span class="ident" id="4258292">f1</span><span class="op" id="4258294">,</span>&nbsp;<span class="ident" id="4258296">in</span><span class="op" id="4258298">,</span>&nbsp;<span class="op" id="4258300">&amp;</span><span class="ident" id="4258301">c</span><span class="op" id="4258302">)</span>&nbsp;&nbsp;<span class="comment" id="4258305">//&nbsp;2**3&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258318">p224Square</span><span class="op" id="4258328">(</span><span class="op" id="4258329">&amp;</span><span class="ident" id="4258330">f2</span><span class="op" id="4258332">,</span>&nbsp;<span class="op" id="4258334">&amp;</span><span class="ident" id="4258335">f1</span><span class="op" id="4258337">,</span>&nbsp;<span class="op" id="4258339">&amp;</span><span class="ident" id="4258340">c</span><span class="op" id="4258341">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4258345">//&nbsp;2**4&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258358">p224Square</span><span class="op" id="4258368">(</span><span class="op" id="4258369">&amp;</span><span class="ident" id="4258370">f2</span><span class="op" id="4258372">,</span>&nbsp;<span class="op" id="4258374">&amp;</span><span class="ident" id="4258375">f2</span><span class="op" id="4258377">,</span>&nbsp;<span class="op" id="4258379">&amp;</span><span class="ident" id="4258380">c</span><span class="op" id="4258381">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4258385">//&nbsp;2**5&nbsp;-&nbsp;4</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258398">p224Square</span><span class="op" id="4258408">(</span><span class="op" id="4258409">&amp;</span><span class="ident" id="4258410">f2</span><span class="op" id="4258412">,</span>&nbsp;<span class="op" id="4258414">&amp;</span><span class="ident" id="4258415">f2</span><span class="op" id="4258417">,</span>&nbsp;<span class="op" id="4258419">&amp;</span><span class="ident" id="4258420">c</span><span class="op" id="4258421">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4258425">//&nbsp;2**6&nbsp;-&nbsp;8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258438">p224Mul</span><span class="op" id="4258445">(</span><span class="op" id="4258446">&amp;</span><span class="ident" id="4258447">f1</span><span class="op" id="4258449">,</span>&nbsp;<span class="op" id="4258451">&amp;</span><span class="ident" id="4258452">f1</span><span class="op" id="4258454">,</span>&nbsp;<span class="op" id="4258456">&amp;</span><span class="ident" id="4258457">f2</span><span class="op" id="4258459">,</span>&nbsp;<span class="op" id="4258461">&amp;</span><span class="ident" id="4258462">c</span><span class="op" id="4258463">)</span>&nbsp;<span class="comment" id="4258465">//&nbsp;2**6&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258478">p224Square</span><span class="op" id="4258488">(</span><span class="op" id="4258489">&amp;</span><span class="ident" id="4258490">f2</span><span class="op" id="4258492">,</span>&nbsp;<span class="op" id="4258494">&amp;</span><span class="ident" id="4258495">f1</span><span class="op" id="4258497">,</span>&nbsp;<span class="op" id="4258499">&amp;</span><span class="ident" id="4258500">c</span><span class="op" id="4258501">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4258505">//&nbsp;2**7&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4258518">for</span>&nbsp;<span class="ident" id="4258522">i</span>&nbsp;<span class="op" id="4258524">:=</span>&nbsp;<span class="num" id="4258527">0</span><span class="op" id="4258528">;</span>&nbsp;<span class="ident" id="4258530">i</span>&nbsp;<span class="op" id="4258532">&lt;</span>&nbsp;<span class="num" id="4258534">5</span><span class="op" id="4258535">;</span>&nbsp;<span class="ident" id="4258537">i</span><span class="op" id="4258538">++</span>&nbsp;<span class="op" id="4258541">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4258545">//&nbsp;2**12&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258563">p224Square</span><span class="op" id="4258573">(</span><span class="op" id="4258574">&amp;</span><span class="ident" id="4258575">f2</span><span class="op" id="4258577">,</span>&nbsp;<span class="op" id="4258579">&amp;</span><span class="ident" id="4258580">f2</span><span class="op" id="4258582">,</span>&nbsp;<span class="op" id="4258584">&amp;</span><span class="ident" id="4258585">c</span><span class="op" id="4258586">)</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4258589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258592">p224Mul</span><span class="op" id="4258599">(</span><span class="op" id="4258600">&amp;</span><span class="ident" id="4258601">f2</span><span class="op" id="4258603">,</span>&nbsp;<span class="op" id="4258605">&amp;</span><span class="ident" id="4258606">f2</span><span class="op" id="4258608">,</span>&nbsp;<span class="op" id="4258610">&amp;</span><span class="ident" id="4258611">f1</span><span class="op" id="4258613">,</span>&nbsp;<span class="op" id="4258615">&amp;</span><span class="ident" id="4258616">c</span><span class="op" id="4258617">)</span>&nbsp;<span class="comment" id="4258619">//&nbsp;2**12&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258633">p224Square</span><span class="op" id="4258643">(</span><span class="op" id="4258644">&amp;</span><span class="ident" id="4258645">f3</span><span class="op" id="4258647">,</span>&nbsp;<span class="op" id="4258649">&amp;</span><span class="ident" id="4258650">f2</span><span class="op" id="4258652">,</span>&nbsp;<span class="op" id="4258654">&amp;</span><span class="ident" id="4258655">c</span><span class="op" id="4258656">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4258660">//&nbsp;2**13&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4258674">for</span>&nbsp;<span class="ident" id="4258678">i</span>&nbsp;<span class="op" id="4258680">:=</span>&nbsp;<span class="num" id="4258683">0</span><span class="op" id="4258684">;</span>&nbsp;<span class="ident" id="4258686">i</span>&nbsp;<span class="op" id="4258688">&lt;</span>&nbsp;<span class="num" id="4258690">11</span><span class="op" id="4258692">;</span>&nbsp;<span class="ident" id="4258694">i</span><span class="op" id="4258695">++</span>&nbsp;<span class="op" id="4258698">{</span>&nbsp;&nbsp;<span class="comment" id="4258701">//&nbsp;2**24&nbsp;-&nbsp;2**12</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258720">p224Square</span><span class="op" id="4258730">(</span><span class="op" id="4258731">&amp;</span><span class="ident" id="4258732">f3</span><span class="op" id="4258734">,</span>&nbsp;<span class="op" id="4258736">&amp;</span><span class="ident" id="4258737">f3</span><span class="op" id="4258739">,</span>&nbsp;<span class="op" id="4258741">&amp;</span><span class="ident" id="4258742">c</span><span class="op" id="4258743">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4258746">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258749">p224Mul</span><span class="op" id="4258756">(</span><span class="op" id="4258757">&amp;</span><span class="ident" id="4258758">f2</span><span class="op" id="4258760">,</span>&nbsp;<span class="op" id="4258762">&amp;</span><span class="ident" id="4258763">f3</span><span class="op" id="4258765">,</span>&nbsp;<span class="op" id="4258767">&amp;</span><span class="ident" id="4258768">f2</span><span class="op" id="4258770">,</span>&nbsp;<span class="op" id="4258772">&amp;</span><span class="ident" id="4258773">c</span><span class="op" id="4258774">)</span>&nbsp;<span class="comment" id="4258776">//&nbsp;2**24&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258790">p224Square</span><span class="op" id="4258800">(</span><span class="op" id="4258801">&amp;</span><span class="ident" id="4258802">f3</span><span class="op" id="4258804">,</span>&nbsp;<span class="op" id="4258806">&amp;</span><span class="ident" id="4258807">f2</span><span class="op" id="4258809">,</span>&nbsp;<span class="op" id="4258811">&amp;</span><span class="ident" id="4258812">c</span><span class="op" id="4258813">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4258817">//&nbsp;2**25&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4258831">for</span>&nbsp;<span class="ident" id="4258835">i</span>&nbsp;<span class="op" id="4258837">:=</span>&nbsp;<span class="num" id="4258840">0</span><span class="op" id="4258841">;</span>&nbsp;<span class="ident" id="4258843">i</span>&nbsp;<span class="op" id="4258845">&lt;</span>&nbsp;<span class="num" id="4258847">23</span><span class="op" id="4258849">;</span>&nbsp;<span class="ident" id="4258851">i</span><span class="op" id="4258852">++</span>&nbsp;<span class="op" id="4258855">{</span>&nbsp;&nbsp;<span class="comment" id="4258858">//&nbsp;2**48&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258877">p224Square</span><span class="op" id="4258887">(</span><span class="op" id="4258888">&amp;</span><span class="ident" id="4258889">f3</span><span class="op" id="4258891">,</span>&nbsp;<span class="op" id="4258893">&amp;</span><span class="ident" id="4258894">f3</span><span class="op" id="4258896">,</span>&nbsp;<span class="op" id="4258898">&amp;</span><span class="ident" id="4258899">c</span><span class="op" id="4258900">)</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4258903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258906">p224Mul</span><span class="op" id="4258913">(</span><span class="op" id="4258914">&amp;</span><span class="ident" id="4258915">f3</span><span class="op" id="4258917">,</span>&nbsp;<span class="op" id="4258919">&amp;</span><span class="ident" id="4258920">f3</span><span class="op" id="4258922">,</span>&nbsp;<span class="op" id="4258924">&amp;</span><span class="ident" id="4258925">f2</span><span class="op" id="4258927">,</span>&nbsp;<span class="op" id="4258929">&amp;</span><span class="ident" id="4258930">c</span><span class="op" id="4258931">)</span>&nbsp;<span class="comment" id="4258933">//&nbsp;2**48&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4258947">p224Square</span><span class="op" id="4258957">(</span><span class="op" id="4258958">&amp;</span><span class="ident" id="4258959">f4</span><span class="op" id="4258961">,</span>&nbsp;<span class="op" id="4258963">&amp;</span><span class="ident" id="4258964">f3</span><span class="op" id="4258966">,</span>&nbsp;<span class="op" id="4258968">&amp;</span><span class="ident" id="4258969">c</span><span class="op" id="4258970">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4258974">//&nbsp;2**49&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4258988">for</span>&nbsp;<span class="ident" id="4258992">i</span>&nbsp;<span class="op" id="4258994">:=</span>&nbsp;<span class="num" id="4258997">0</span><span class="op" id="4258998">;</span>&nbsp;<span class="ident" id="4259000">i</span>&nbsp;<span class="op" id="4259002">&lt;</span>&nbsp;<span class="num" id="4259004">47</span><span class="op" id="4259006">;</span>&nbsp;<span class="ident" id="4259008">i</span><span class="op" id="4259009">++</span>&nbsp;<span class="op" id="4259012">{</span>&nbsp;&nbsp;<span class="comment" id="4259015">//&nbsp;2**96&nbsp;-&nbsp;2**48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259034">p224Square</span><span class="op" id="4259044">(</span><span class="op" id="4259045">&amp;</span><span class="ident" id="4259046">f4</span><span class="op" id="4259048">,</span>&nbsp;<span class="op" id="4259050">&amp;</span><span class="ident" id="4259051">f4</span><span class="op" id="4259053">,</span>&nbsp;<span class="op" id="4259055">&amp;</span><span class="ident" id="4259056">c</span><span class="op" id="4259057">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4259060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259063">p224Mul</span><span class="op" id="4259070">(</span><span class="op" id="4259071">&amp;</span><span class="ident" id="4259072">f3</span><span class="op" id="4259074">,</span>&nbsp;<span class="op" id="4259076">&amp;</span><span class="ident" id="4259077">f3</span><span class="op" id="4259079">,</span>&nbsp;<span class="op" id="4259081">&amp;</span><span class="ident" id="4259082">f4</span><span class="op" id="4259084">,</span>&nbsp;<span class="op" id="4259086">&amp;</span><span class="ident" id="4259087">c</span><span class="op" id="4259088">)</span>&nbsp;<span class="comment" id="4259090">//&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259104">p224Square</span><span class="op" id="4259114">(</span><span class="op" id="4259115">&amp;</span><span class="ident" id="4259116">f4</span><span class="op" id="4259118">,</span>&nbsp;<span class="op" id="4259120">&amp;</span><span class="ident" id="4259121">f3</span><span class="op" id="4259123">,</span>&nbsp;<span class="op" id="4259125">&amp;</span><span class="ident" id="4259126">c</span><span class="op" id="4259127">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4259131">//&nbsp;2**97&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4259145">for</span>&nbsp;<span class="ident" id="4259149">i</span>&nbsp;<span class="op" id="4259151">:=</span>&nbsp;<span class="num" id="4259154">0</span><span class="op" id="4259155">;</span>&nbsp;<span class="ident" id="4259157">i</span>&nbsp;<span class="op" id="4259159">&lt;</span>&nbsp;<span class="num" id="4259161">23</span><span class="op" id="4259163">;</span>&nbsp;<span class="ident" id="4259165">i</span><span class="op" id="4259166">++</span>&nbsp;<span class="op" id="4259169">{</span>&nbsp;&nbsp;<span class="comment" id="4259172">//&nbsp;2**120&nbsp;-&nbsp;2**24</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259192">p224Square</span><span class="op" id="4259202">(</span><span class="op" id="4259203">&amp;</span><span class="ident" id="4259204">f4</span><span class="op" id="4259206">,</span>&nbsp;<span class="op" id="4259208">&amp;</span><span class="ident" id="4259209">f4</span><span class="op" id="4259211">,</span>&nbsp;<span class="op" id="4259213">&amp;</span><span class="ident" id="4259214">c</span><span class="op" id="4259215">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4259218">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259221">p224Mul</span><span class="op" id="4259228">(</span><span class="op" id="4259229">&amp;</span><span class="ident" id="4259230">f2</span><span class="op" id="4259232">,</span>&nbsp;<span class="op" id="4259234">&amp;</span><span class="ident" id="4259235">f4</span><span class="op" id="4259237">,</span>&nbsp;<span class="op" id="4259239">&amp;</span><span class="ident" id="4259240">f2</span><span class="op" id="4259242">,</span>&nbsp;<span class="op" id="4259244">&amp;</span><span class="ident" id="4259245">c</span><span class="op" id="4259246">)</span>&nbsp;<span class="comment" id="4259248">//&nbsp;2**120&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4259263">for</span>&nbsp;<span class="ident" id="4259267">i</span>&nbsp;<span class="op" id="4259269">:=</span>&nbsp;<span class="num" id="4259272">0</span><span class="op" id="4259273">;</span>&nbsp;<span class="ident" id="4259275">i</span>&nbsp;<span class="op" id="4259277">&lt;</span>&nbsp;<span class="num" id="4259279">6</span><span class="op" id="4259280">;</span>&nbsp;<span class="ident" id="4259282">i</span><span class="op" id="4259283">++</span>&nbsp;<span class="op" id="4259286">{</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4259290">//&nbsp;2**126&nbsp;-&nbsp;2**6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259309">p224Square</span><span class="op" id="4259319">(</span><span class="op" id="4259320">&amp;</span><span class="ident" id="4259321">f2</span><span class="op" id="4259323">,</span>&nbsp;<span class="op" id="4259325">&amp;</span><span class="ident" id="4259326">f2</span><span class="op" id="4259328">,</span>&nbsp;<span class="op" id="4259330">&amp;</span><span class="ident" id="4259331">c</span><span class="op" id="4259332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4259335">}</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259338">p224Mul</span><span class="op" id="4259345">(</span><span class="op" id="4259346">&amp;</span><span class="ident" id="4259347">f1</span><span class="op" id="4259349">,</span>&nbsp;<span class="op" id="4259351">&amp;</span><span class="ident" id="4259352">f1</span><span class="op" id="4259354">,</span>&nbsp;<span class="op" id="4259356">&amp;</span><span class="ident" id="4259357">f2</span><span class="op" id="4259359">,</span>&nbsp;<span class="op" id="4259361">&amp;</span><span class="ident" id="4259362">c</span><span class="op" id="4259363">)</span>&nbsp;<span class="comment" id="4259365">//&nbsp;2**126&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259380">p224Square</span><span class="op" id="4259390">(</span><span class="op" id="4259391">&amp;</span><span class="ident" id="4259392">f1</span><span class="op" id="4259394">,</span>&nbsp;<span class="op" id="4259396">&amp;</span><span class="ident" id="4259397">f1</span><span class="op" id="4259399">,</span>&nbsp;<span class="op" id="4259401">&amp;</span><span class="ident" id="4259402">c</span><span class="op" id="4259403">)</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="4259407">//&nbsp;2**127&nbsp;-&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259422">p224Mul</span><span class="op" id="4259429">(</span><span class="op" id="4259430">&amp;</span><span class="ident" id="4259431">f1</span><span class="op" id="4259433">,</span>&nbsp;<span class="op" id="4259435">&amp;</span><span class="ident" id="4259436">f1</span><span class="op" id="4259438">,</span>&nbsp;<span class="ident" id="4259440">in</span><span class="op" id="4259442">,</span>&nbsp;<span class="op" id="4259444">&amp;</span><span class="ident" id="4259445">c</span><span class="op" id="4259446">)</span>&nbsp;&nbsp;<span class="comment" id="4259449">//&nbsp;2**127&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4259464">for</span>&nbsp;<span class="ident" id="4259468">i</span>&nbsp;<span class="op" id="4259470">:=</span>&nbsp;<span class="num" id="4259473">0</span><span class="op" id="4259474">;</span>&nbsp;<span class="ident" id="4259476">i</span>&nbsp;<span class="op" id="4259478">&lt;</span>&nbsp;<span class="num" id="4259480">97</span><span class="op" id="4259482">;</span>&nbsp;<span class="ident" id="4259484">i</span><span class="op" id="4259485">++</span>&nbsp;<span class="op" id="4259488">{</span>&nbsp;&nbsp;<span class="comment" id="4259491">//&nbsp;2**224&nbsp;-&nbsp;2**97</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259511">p224Square</span><span class="op" id="4259521">(</span><span class="op" id="4259522">&amp;</span><span class="ident" id="4259523">f1</span><span class="op" id="4259525">,</span>&nbsp;<span class="op" id="4259527">&amp;</span><span class="ident" id="4259528">f1</span><span class="op" id="4259530">,</span>&nbsp;<span class="op" id="4259532">&amp;</span><span class="ident" id="4259533">c</span><span class="op" id="4259534">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4259537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259540">p224Mul</span><span class="op" id="4259547">(</span><span class="ident" id="4259548">out</span><span class="op" id="4259551">,</span>&nbsp;<span class="op" id="4259553">&amp;</span><span class="ident" id="4259554">f1</span><span class="op" id="4259556">,</span>&nbsp;<span class="op" id="4259558">&amp;</span><span class="ident" id="4259559">f3</span><span class="op" id="4259561">,</span>&nbsp;<span class="op" id="4259563">&amp;</span><span class="ident" id="4259564">c</span><span class="op" id="4259565">)</span>&nbsp;<span class="comment" id="4259567">//&nbsp;2**224&nbsp;-&nbsp;2**96&nbsp;-&nbsp;1</span><br>
<span class="lineno"></span><span class="op" id="4259589">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4259592">//&nbsp;p224Contract&nbsp;converts&nbsp;a&nbsp;FieldElement&nbsp;to&nbsp;its&nbsp;unique,&nbsp;minimal&nbsp;form.</span><br>
<span class="lineno">385</span><span class="comment" id="4259661">//</span><br>
<span class="lineno"></span><span class="comment" id="4259664">//&nbsp;On&nbsp;entry,&nbsp;in[i]&nbsp;&lt;&nbsp;2**29</span><br>
<span class="lineno"></span><span class="comment" id="4259691">//&nbsp;On&nbsp;exit,&nbsp;in[i]&nbsp;&lt;&nbsp;2**28</span><br>
<span class="lineno"></span><span class="keyword" id="4259717">func</span>&nbsp;<span class="ident" id="4259722">p224Contract</span><span class="op" id="4259734">(</span><span class="ident" id="4259735">out</span><span class="op" id="4259738">,</span>&nbsp;<span class="ident" id="4259740">in</span>&nbsp;<span class="op" id="4259743">*</span><span class="ident" id="4259744">p224FieldElement</span><span class="op" id="4259760">)</span>&nbsp;<span class="op" id="4259762">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4259765">copy</span><span class="op" id="4259769">(</span><span class="ident" id="4259770">out</span><span class="op" id="4259773">[</span><span class="op" id="4259774">:</span><span class="op" id="4259775">]</span><span class="op" id="4259776">,</span>&nbsp;<span class="ident" id="4259778">in</span><span class="op" id="4259780">[</span><span class="op" id="4259781">:</span><span class="op" id="4259782">]</span><span class="op" id="4259783">)</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4259787">for</span>&nbsp;<span class="ident" id="4259791">i</span>&nbsp;<span class="op" id="4259793">:=</span>&nbsp;<span class="num" id="4259796">0</span><span class="op" id="4259797">;</span>&nbsp;<span class="ident" id="4259799">i</span>&nbsp;<span class="op" id="4259801">&lt;</span>&nbsp;<span class="num" id="4259803">7</span><span class="op" id="4259804">;</span>&nbsp;<span class="ident" id="4259806">i</span><span class="op" id="4259807">++</span>&nbsp;<span class="op" id="4259810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259814">out</span><span class="op" id="4259817">[</span><span class="ident" id="4259818">i</span><span class="op" id="4259819">+</span><span class="num" id="4259820">1</span><span class="op" id="4259821">]</span>&nbsp;<span class="op" id="4259823">+=</span>&nbsp;<span class="ident" id="4259826">out</span><span class="op" id="4259829">[</span><span class="ident" id="4259830">i</span><span class="op" id="4259831">]</span>&nbsp;<span class="op" id="4259833">&gt;&gt;</span>&nbsp;<span class="num" id="4259836">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259841">out</span><span class="op" id="4259844">[</span><span class="ident" id="4259845">i</span><span class="op" id="4259846">]</span>&nbsp;<span class="op" id="4259848">&amp;=</span>&nbsp;<span class="ident" id="4259851">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4259865">}</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259868">top</span>&nbsp;<span class="op" id="4259872">:=</span>&nbsp;<span class="ident" id="4259875">out</span><span class="op" id="4259878">[</span><span class="num" id="4259879">7</span><span class="op" id="4259880">]</span>&nbsp;<span class="op" id="4259882">&gt;&gt;</span>&nbsp;<span class="num" id="4259885">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259889">out</span><span class="op" id="4259892">[</span><span class="num" id="4259893">7</span><span class="op" id="4259894">]</span>&nbsp;<span class="op" id="4259896">&amp;=</span>&nbsp;<span class="ident" id="4259899">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259914">out</span><span class="op" id="4259917">[</span><span class="num" id="4259918">0</span><span class="op" id="4259919">]</span>&nbsp;<span class="op" id="4259921">-=</span>&nbsp;<span class="ident" id="4259924">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4259929">out</span><span class="op" id="4259932">[</span><span class="num" id="4259933">3</span><span class="op" id="4259934">]</span>&nbsp;<span class="op" id="4259936">+=</span>&nbsp;<span class="ident" id="4259939">top</span>&nbsp;<span class="op" id="4259943">&lt;&lt;</span>&nbsp;<span class="num" id="4259946">12</span><br>
<span class="lineno">400</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4259951">//&nbsp;We&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[i]&nbsp;negative.&nbsp;So&nbsp;we&nbsp;carry&nbsp;down.&nbsp;If&nbsp;we&nbsp;made</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4260023">//&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is&nbsp;sufficiently&nbsp;positive</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4260093">//&nbsp;because&nbsp;we&nbsp;just&nbsp;added&nbsp;to&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4260126">for</span>&nbsp;<span class="ident" id="4260130">i</span>&nbsp;<span class="op" id="4260132">:=</span>&nbsp;<span class="num" id="4260135">0</span><span class="op" id="4260136">;</span>&nbsp;<span class="ident" id="4260138">i</span>&nbsp;<span class="op" id="4260140">&lt;</span>&nbsp;<span class="num" id="4260142">3</span><span class="op" id="4260143">;</span>&nbsp;<span class="ident" id="4260145">i</span><span class="op" id="4260146">++</span>&nbsp;<span class="op" id="4260149">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260153">mask</span>&nbsp;<span class="op" id="4260158">:=</span>&nbsp;<span class="builtintype" id="4260161">uint32</span><span class="op" id="4260167">(</span><span class="builtintype" id="4260168">int32</span><span class="op" id="4260173">(</span><span class="ident" id="4260174">out</span><span class="op" id="4260177">[</span><span class="ident" id="4260178">i</span><span class="op" id="4260179">]</span><span class="op" id="4260180">)</span>&nbsp;<span class="op" id="4260182">&gt;&gt;</span>&nbsp;<span class="num" id="4260185">31</span><span class="op" id="4260187">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260191">out</span><span class="op" id="4260194">[</span><span class="ident" id="4260195">i</span><span class="op" id="4260196">]</span>&nbsp;<span class="op" id="4260198">+=</span>&nbsp;<span class="op" id="4260201">(</span><span class="num" id="4260202">1</span>&nbsp;<span class="op" id="4260204">&lt;&lt;</span>&nbsp;<span class="num" id="4260207">28</span><span class="op" id="4260209">)</span>&nbsp;<span class="op" id="4260211">&amp;</span>&nbsp;<span class="ident" id="4260213">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260220">out</span><span class="op" id="4260223">[</span><span class="ident" id="4260224">i</span><span class="op" id="4260225">+</span><span class="num" id="4260226">1</span><span class="op" id="4260227">]</span>&nbsp;<span class="op" id="4260229">-=</span>&nbsp;<span class="num" id="4260232">1</span>&nbsp;<span class="op" id="4260234">&amp;</span>&nbsp;<span class="ident" id="4260236">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4260242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4260246">//&nbsp;We&nbsp;might&nbsp;have&nbsp;pushed&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;so&nbsp;we&nbsp;perform&nbsp;another,&nbsp;partial,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4260321">//&nbsp;carry&nbsp;chain.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4260338">for</span>&nbsp;<span class="ident" id="4260342">i</span>&nbsp;<span class="op" id="4260344">:=</span>&nbsp;<span class="num" id="4260347">3</span><span class="op" id="4260348">;</span>&nbsp;<span class="ident" id="4260350">i</span>&nbsp;<span class="op" id="4260352">&lt;</span>&nbsp;<span class="num" id="4260354">7</span><span class="op" id="4260355">;</span>&nbsp;<span class="ident" id="4260357">i</span><span class="op" id="4260358">++</span>&nbsp;<span class="op" id="4260361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260365">out</span><span class="op" id="4260368">[</span><span class="ident" id="4260369">i</span><span class="op" id="4260370">+</span><span class="num" id="4260371">1</span><span class="op" id="4260372">]</span>&nbsp;<span class="op" id="4260374">+=</span>&nbsp;<span class="ident" id="4260377">out</span><span class="op" id="4260380">[</span><span class="ident" id="4260381">i</span><span class="op" id="4260382">]</span>&nbsp;<span class="op" id="4260384">&gt;&gt;</span>&nbsp;<span class="num" id="4260387">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260392">out</span><span class="op" id="4260395">[</span><span class="ident" id="4260396">i</span><span class="op" id="4260397">]</span>&nbsp;<span class="op" id="4260399">&amp;=</span>&nbsp;<span class="ident" id="4260402">bottom28Bits</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4260416">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260419">top</span>&nbsp;<span class="op" id="4260423">=</span>&nbsp;<span class="ident" id="4260425">out</span><span class="op" id="4260428">[</span><span class="num" id="4260429">7</span><span class="op" id="4260430">]</span>&nbsp;<span class="op" id="4260432">&gt;&gt;</span>&nbsp;<span class="num" id="4260435">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260439">out</span><span class="op" id="4260442">[</span><span class="num" id="4260443">7</span><span class="op" id="4260444">]</span>&nbsp;<span class="op" id="4260446">&amp;=</span>&nbsp;<span class="ident" id="4260449">bottom28Bits</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4260464">//&nbsp;Eliminate&nbsp;top&nbsp;while&nbsp;maintaining&nbsp;the&nbsp;same&nbsp;value&nbsp;mod&nbsp;p.</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260522">out</span><span class="op" id="4260525">[</span><span class="num" id="4260526">0</span><span class="op" id="4260527">]</span>&nbsp;<span class="op" id="4260529">-=</span>&nbsp;<span class="ident" id="4260532">top</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4260537">out</span><span class="op" id="4260540">[</span><span class="num" id="4260541">3</span><span class="op" id="4260542">]</span>&nbsp;<span class="op" id="4260544">+=</span>&nbsp;<span class="ident" id="4260547">top</span>&nbsp;<span class="op" id="4260551">&lt;&lt;</span>&nbsp;<span class="num" id="4260554">12</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4260559">//&nbsp;There&nbsp;are&nbsp;two&nbsp;cases&nbsp;to&nbsp;consider&nbsp;for&nbsp;out[3]:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4260607">//&nbsp;&nbsp;&nbsp;1)&nbsp;The&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top,&nbsp;we&nbsp;didn&#39;t&nbsp;push&nbsp;out[3]&nbsp;over</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4260682">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2**28.&nbsp;In&nbsp;this&nbsp;case,&nbsp;the&nbsp;partial&nbsp;carry&nbsp;chain&nbsp;didn&#39;t&nbsp;change&nbsp;any&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4260761">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;top&nbsp;is&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4260787">//&nbsp;&nbsp;&nbsp;2)&nbsp;We&nbsp;did&nbsp;push&nbsp;out[3]&nbsp;over&nbsp;2**28&nbsp;the&nbsp;first&nbsp;time&nbsp;that&nbsp;we&nbsp;eliminated&nbsp;top.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4260865">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;first&nbsp;value&nbsp;of&nbsp;top&nbsp;was&nbsp;in&nbsp;[0..16),&nbsp;therefore,&nbsp;prior&nbsp;to&nbsp;eliminating</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4260945">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;the&nbsp;first&nbsp;top,&nbsp;0xfff1000&nbsp;&lt;=&nbsp;out[3]&nbsp;&lt;=&nbsp;0xfffffff.&nbsp;Therefore,&nbsp;after</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4261020">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;overflowing&nbsp;and&nbsp;being&nbsp;reduced&nbsp;by&nbsp;the&nbsp;second&nbsp;carry&nbsp;chain,&nbsp;out[3]&nbsp;&lt;=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4261096">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0xf000.&nbsp;Thus&nbsp;it&nbsp;cannot&nbsp;have&nbsp;overflowed&nbsp;when&nbsp;we&nbsp;eliminated&nbsp;top&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4261175">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;second&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4261198">//&nbsp;Again,&nbsp;we&nbsp;may&nbsp;just&nbsp;have&nbsp;made&nbsp;out[0]&nbsp;negative,&nbsp;so&nbsp;do&nbsp;the&nbsp;same&nbsp;carry&nbsp;down.</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4261275">//&nbsp;As&nbsp;before,&nbsp;if&nbsp;we&nbsp;made&nbsp;out[0]&nbsp;negative&nbsp;then&nbsp;we&nbsp;know&nbsp;that&nbsp;out[3]&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4261345">//&nbsp;sufficiently&nbsp;positive.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4261372">for</span>&nbsp;<span class="ident" id="4261376">i</span>&nbsp;<span class="op" id="4261378">:=</span>&nbsp;<span class="num" id="4261381">0</span><span class="op" id="4261382">;</span>&nbsp;<span class="ident" id="4261384">i</span>&nbsp;<span class="op" id="4261386">&lt;</span>&nbsp;<span class="num" id="4261388">3</span><span class="op" id="4261389">;</span>&nbsp;<span class="ident" id="4261391">i</span><span class="op" id="4261392">++</span>&nbsp;<span class="op" id="4261395">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261399">mask</span>&nbsp;<span class="op" id="4261404">:=</span>&nbsp;<span class="builtintype" id="4261407">uint32</span><span class="op" id="4261413">(</span><span class="builtintype" id="4261414">int32</span><span class="op" id="4261419">(</span><span class="ident" id="4261420">out</span><span class="op" id="4261423">[</span><span class="ident" id="4261424">i</span><span class="op" id="4261425">]</span><span class="op" id="4261426">)</span>&nbsp;<span class="op" id="4261428">&gt;&gt;</span>&nbsp;<span class="num" id="4261431">31</span><span class="op" id="4261433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261437">out</span><span class="op" id="4261440">[</span><span class="ident" id="4261441">i</span><span class="op" id="4261442">]</span>&nbsp;<span class="op" id="4261444">+=</span>&nbsp;<span class="op" id="4261447">(</span><span class="num" id="4261448">1</span>&nbsp;<span class="op" id="4261450">&lt;&lt;</span>&nbsp;<span class="num" id="4261453">28</span><span class="op" id="4261455">)</span>&nbsp;<span class="op" id="4261457">&amp;</span>&nbsp;<span class="ident" id="4261459">mask</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261466">out</span><span class="op" id="4261469">[</span><span class="ident" id="4261470">i</span><span class="op" id="4261471">+</span><span class="num" id="4261472">1</span><span class="op" id="4261473">]</span>&nbsp;<span class="op" id="4261475">-=</span>&nbsp;<span class="num" id="4261478">1</span>&nbsp;<span class="op" id="4261480">&amp;</span>&nbsp;<span class="ident" id="4261482">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4261488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4261492">//&nbsp;Now&nbsp;we&nbsp;see&nbsp;if&nbsp;the&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p&nbsp;and,&nbsp;if&nbsp;so,&nbsp;subtract&nbsp;p.</span><br>
<span class="lineno"></span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4261553">//&nbsp;First&nbsp;we&nbsp;build&nbsp;a&nbsp;mask&nbsp;from&nbsp;the&nbsp;top&nbsp;four&nbsp;limbs,&nbsp;which&nbsp;must&nbsp;all&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4261622">//&nbsp;equal&nbsp;to&nbsp;bottom28Bits&nbsp;if&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p.&nbsp;If&nbsp;top4AllOnes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4261691">//&nbsp;ends&nbsp;up&nbsp;with&nbsp;any&nbsp;zero&nbsp;bits&nbsp;in&nbsp;the&nbsp;bottom&nbsp;28&nbsp;bits,&nbsp;then&nbsp;this&nbsp;wasn&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4261762">//&nbsp;true.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261772">top4AllOnes</span>&nbsp;<span class="op" id="4261784">:=</span>&nbsp;<span class="builtintype" id="4261787">uint32</span><span class="op" id="4261793">(</span><span class="num" id="4261794">0xffffffff</span><span class="op" id="4261804">)</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4261807">for</span>&nbsp;<span class="ident" id="4261811">i</span>&nbsp;<span class="op" id="4261813">:=</span>&nbsp;<span class="num" id="4261816">4</span><span class="op" id="4261817">;</span>&nbsp;<span class="ident" id="4261819">i</span>&nbsp;<span class="op" id="4261821">&lt;</span>&nbsp;<span class="num" id="4261823">8</span><span class="op" id="4261824">;</span>&nbsp;<span class="ident" id="4261826">i</span><span class="op" id="4261827">++</span>&nbsp;<span class="op" id="4261830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261834">top4AllOnes</span>&nbsp;<span class="op" id="4261846">&amp;=</span>&nbsp;<span class="ident" id="4261849">out</span><span class="op" id="4261852">[</span><span class="ident" id="4261853">i</span><span class="op" id="4261854">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4261857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261860">top4AllOnes</span>&nbsp;<span class="op" id="4261872">|=</span>&nbsp;<span class="num" id="4261875">0xf0000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4261887">//&nbsp;Now&nbsp;we&nbsp;replicate&nbsp;any&nbsp;zero&nbsp;bits&nbsp;to&nbsp;all&nbsp;the&nbsp;bits&nbsp;in&nbsp;top4AllOnes.</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261954">top4AllOnes</span>&nbsp;<span class="op" id="4261966">&amp;=</span>&nbsp;<span class="ident" id="4261969">top4AllOnes</span>&nbsp;<span class="op" id="4261981">&gt;&gt;</span>&nbsp;<span class="num" id="4261984">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4261988">top4AllOnes</span>&nbsp;<span class="op" id="4262000">&amp;=</span>&nbsp;<span class="ident" id="4262003">top4AllOnes</span>&nbsp;<span class="op" id="4262015">&gt;&gt;</span>&nbsp;<span class="num" id="4262018">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262021">top4AllOnes</span>&nbsp;<span class="op" id="4262033">&amp;=</span>&nbsp;<span class="ident" id="4262036">top4AllOnes</span>&nbsp;<span class="op" id="4262048">&gt;&gt;</span>&nbsp;<span class="num" id="4262051">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262054">top4AllOnes</span>&nbsp;<span class="op" id="4262066">&amp;=</span>&nbsp;<span class="ident" id="4262069">top4AllOnes</span>&nbsp;<span class="op" id="4262081">&gt;&gt;</span>&nbsp;<span class="num" id="4262084">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262087">top4AllOnes</span>&nbsp;<span class="op" id="4262099">&amp;=</span>&nbsp;<span class="ident" id="4262102">top4AllOnes</span>&nbsp;<span class="op" id="4262114">&gt;&gt;</span>&nbsp;<span class="num" id="4262117">1</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262120">top4AllOnes</span>&nbsp;<span class="op" id="4262132">=</span>&nbsp;<span class="builtintype" id="4262134">uint32</span><span class="op" id="4262140">(</span><span class="builtintype" id="4262141">int32</span><span class="op" id="4262146">(</span><span class="ident" id="4262147">top4AllOnes</span><span class="op" id="4262158">&lt;&lt;</span><span class="num" id="4262160">31</span><span class="op" id="4262162">)</span>&nbsp;<span class="op" id="4262164">&gt;&gt;</span>&nbsp;<span class="num" id="4262167">31</span><span class="op" id="4262169">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4262173">//&nbsp;Now&nbsp;we&nbsp;test&nbsp;whether&nbsp;the&nbsp;bottom&nbsp;three&nbsp;limbs&nbsp;are&nbsp;non-zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262234">bottom3NonZero</span>&nbsp;<span class="op" id="4262249">:=</span>&nbsp;<span class="ident" id="4262252">out</span><span class="op" id="4262255">[</span><span class="num" id="4262256">0</span><span class="op" id="4262257">]</span>&nbsp;<span class="op" id="4262259">|</span>&nbsp;<span class="ident" id="4262261">out</span><span class="op" id="4262264">[</span><span class="num" id="4262265">1</span><span class="op" id="4262266">]</span>&nbsp;<span class="op" id="4262268">|</span>&nbsp;<span class="ident" id="4262270">out</span><span class="op" id="4262273">[</span><span class="num" id="4262274">2</span><span class="op" id="4262275">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262278">bottom3NonZero</span>&nbsp;<span class="op" id="4262293">|=</span>&nbsp;<span class="ident" id="4262296">bottom3NonZero</span>&nbsp;<span class="op" id="4262311">&gt;&gt;</span>&nbsp;<span class="num" id="4262314">16</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262318">bottom3NonZero</span>&nbsp;<span class="op" id="4262333">|=</span>&nbsp;<span class="ident" id="4262336">bottom3NonZero</span>&nbsp;<span class="op" id="4262351">&gt;&gt;</span>&nbsp;<span class="num" id="4262354">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262357">bottom3NonZero</span>&nbsp;<span class="op" id="4262372">|=</span>&nbsp;<span class="ident" id="4262375">bottom3NonZero</span>&nbsp;<span class="op" id="4262390">&gt;&gt;</span>&nbsp;<span class="num" id="4262393">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262396">bottom3NonZero</span>&nbsp;<span class="op" id="4262411">|=</span>&nbsp;<span class="ident" id="4262414">bottom3NonZero</span>&nbsp;<span class="op" id="4262429">&gt;&gt;</span>&nbsp;<span class="num" id="4262432">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262435">bottom3NonZero</span>&nbsp;<span class="op" id="4262450">|=</span>&nbsp;<span class="ident" id="4262453">bottom3NonZero</span>&nbsp;<span class="op" id="4262468">&gt;&gt;</span>&nbsp;<span class="num" id="4262471">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262474">bottom3NonZero</span>&nbsp;<span class="op" id="4262489">=</span>&nbsp;<span class="builtintype" id="4262491">uint32</span><span class="op" id="4262497">(</span><span class="builtintype" id="4262498">int32</span><span class="op" id="4262503">(</span><span class="ident" id="4262504">bottom3NonZero</span><span class="op" id="4262518">&lt;&lt;</span><span class="num" id="4262520">31</span><span class="op" id="4262522">)</span>&nbsp;<span class="op" id="4262524">&gt;&gt;</span>&nbsp;<span class="num" id="4262527">31</span><span class="op" id="4262529">)</span><br>
<span class="lineno">470</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4262533">//&nbsp;Everything&nbsp;depends&nbsp;on&nbsp;the&nbsp;value&nbsp;of&nbsp;out[3].</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4262580">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&gt;&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4262657">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;=&nbsp;0xffff000&nbsp;and&nbsp;top4AllOnes&nbsp;!=&nbsp;0&nbsp;and&nbsp;bottom3NonZero&nbsp;!=&nbsp;0,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4262730">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&gt;=&nbsp;p</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4262768">//&nbsp;&nbsp;&nbsp;&nbsp;If&nbsp;it&#39;s&nbsp;&lt;&nbsp;0xffff000,&nbsp;then&nbsp;the&nbsp;whole&nbsp;value&nbsp;is&nbsp;&lt;&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262824">n</span>&nbsp;<span class="op" id="4262826">:=</span>&nbsp;<span class="ident" id="4262829">out</span><span class="op" id="4262832">[</span><span class="num" id="4262833">3</span><span class="op" id="4262834">]</span>&nbsp;<span class="op" id="4262836">-</span>&nbsp;<span class="num" id="4262838">0xffff000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262849">out3Equal</span>&nbsp;<span class="op" id="4262859">:=</span>&nbsp;<span class="ident" id="4262862">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262865">out3Equal</span>&nbsp;<span class="op" id="4262875">|=</span>&nbsp;<span class="ident" id="4262878">out3Equal</span>&nbsp;<span class="op" id="4262888">&gt;&gt;</span>&nbsp;<span class="num" id="4262891">16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262895">out3Equal</span>&nbsp;<span class="op" id="4262905">|=</span>&nbsp;<span class="ident" id="4262908">out3Equal</span>&nbsp;<span class="op" id="4262918">&gt;&gt;</span>&nbsp;<span class="num" id="4262921">8</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262924">out3Equal</span>&nbsp;<span class="op" id="4262934">|=</span>&nbsp;<span class="ident" id="4262937">out3Equal</span>&nbsp;<span class="op" id="4262947">&gt;&gt;</span>&nbsp;<span class="num" id="4262950">4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262953">out3Equal</span>&nbsp;<span class="op" id="4262963">|=</span>&nbsp;<span class="ident" id="4262966">out3Equal</span>&nbsp;<span class="op" id="4262976">&gt;&gt;</span>&nbsp;<span class="num" id="4262979">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4262982">out3Equal</span>&nbsp;<span class="op" id="4262992">|=</span>&nbsp;<span class="ident" id="4262995">out3Equal</span>&nbsp;<span class="op" id="4263005">&gt;&gt;</span>&nbsp;<span class="num" id="4263008">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263011">out3Equal</span>&nbsp;<span class="op" id="4263021">=</span>&nbsp;<span class="op" id="4263023">^</span><span class="builtintype" id="4263024">uint32</span><span class="op" id="4263030">(</span><span class="builtintype" id="4263031">int32</span><span class="op" id="4263036">(</span><span class="ident" id="4263037">out3Equal</span><span class="op" id="4263046">&lt;&lt;</span><span class="num" id="4263048">31</span><span class="op" id="4263050">)</span>&nbsp;<span class="op" id="4263052">&gt;&gt;</span>&nbsp;<span class="num" id="4263055">31</span><span class="op" id="4263057">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4263061">//&nbsp;If&nbsp;out[3]&nbsp;&gt;&nbsp;0xffff000&nbsp;then&nbsp;n&#39;s&nbsp;MSB&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263114">out3GT</span>&nbsp;<span class="op" id="4263121">:=</span>&nbsp;<span class="op" id="4263124">^</span><span class="builtintype" id="4263125">uint32</span><span class="op" id="4263131">(</span><span class="builtintype" id="4263132">int32</span><span class="op" id="4263137">(</span><span class="ident" id="4263138">n</span><span class="op" id="4263139">)</span>&nbsp;<span class="op" id="4263141">&gt;&gt;</span>&nbsp;<span class="num" id="4263144">31</span><span class="op" id="4263146">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263150">mask</span>&nbsp;<span class="op" id="4263155">:=</span>&nbsp;<span class="ident" id="4263158">top4AllOnes</span>&nbsp;<span class="op" id="4263170">&amp;</span>&nbsp;<span class="op" id="4263172">(</span><span class="op" id="4263173">(</span><span class="ident" id="4263174">out3Equal</span>&nbsp;<span class="op" id="4263184">&amp;</span>&nbsp;<span class="ident" id="4263186">bottom3NonZero</span><span class="op" id="4263200">)</span>&nbsp;<span class="op" id="4263202">|</span>&nbsp;<span class="ident" id="4263204">out3GT</span><span class="op" id="4263210">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263213">out</span><span class="op" id="4263216">[</span><span class="num" id="4263217">0</span><span class="op" id="4263218">]</span>&nbsp;<span class="op" id="4263220">-=</span>&nbsp;<span class="num" id="4263223">1</span>&nbsp;<span class="op" id="4263225">&amp;</span>&nbsp;<span class="ident" id="4263227">mask</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263233">out</span><span class="op" id="4263236">[</span><span class="num" id="4263237">3</span><span class="op" id="4263238">]</span>&nbsp;<span class="op" id="4263240">-=</span>&nbsp;<span class="num" id="4263243">0xffff000</span>&nbsp;<span class="op" id="4263253">&amp;</span>&nbsp;<span class="ident" id="4263255">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263261">out</span><span class="op" id="4263264">[</span><span class="num" id="4263265">4</span><span class="op" id="4263266">]</span>&nbsp;<span class="op" id="4263268">-=</span>&nbsp;<span class="num" id="4263271">0xfffffff</span>&nbsp;<span class="op" id="4263281">&amp;</span>&nbsp;<span class="ident" id="4263283">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263289">out</span><span class="op" id="4263292">[</span><span class="num" id="4263293">5</span><span class="op" id="4263294">]</span>&nbsp;<span class="op" id="4263296">-=</span>&nbsp;<span class="num" id="4263299">0xfffffff</span>&nbsp;<span class="op" id="4263309">&amp;</span>&nbsp;<span class="ident" id="4263311">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263317">out</span><span class="op" id="4263320">[</span><span class="num" id="4263321">6</span><span class="op" id="4263322">]</span>&nbsp;<span class="op" id="4263324">-=</span>&nbsp;<span class="num" id="4263327">0xfffffff</span>&nbsp;<span class="op" id="4263337">&amp;</span>&nbsp;<span class="ident" id="4263339">mask</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263345">out</span><span class="op" id="4263348">[</span><span class="num" id="4263349">7</span><span class="op" id="4263350">]</span>&nbsp;<span class="op" id="4263352">-=</span>&nbsp;<span class="num" id="4263355">0xfffffff</span>&nbsp;<span class="op" id="4263365">&amp;</span>&nbsp;<span class="ident" id="4263367">mask</span><br>
<span class="lineno">495</span><span class="op" id="4263372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4263375">//&nbsp;Group&nbsp;element&nbsp;functions.</span><br>
<span class="lineno"></span><span class="comment" id="4263403">//</span><br>
<span class="lineno"></span><span class="comment" id="4263406">//&nbsp;These&nbsp;functions&nbsp;deal&nbsp;with&nbsp;group&nbsp;elements.&nbsp;The&nbsp;group&nbsp;is&nbsp;an&nbsp;elliptic&nbsp;curve</span><br>
<span class="lineno">500</span><span class="comment" id="4263482">//&nbsp;group&nbsp;with&nbsp;a&nbsp;=&nbsp;-3&nbsp;defined&nbsp;in&nbsp;FIPS&nbsp;186-3,&nbsp;section&nbsp;D.2.2.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4263542">//&nbsp;p224AddJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+b&nbsp;where&nbsp;a&nbsp;!=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="4263595">func</span>&nbsp;<span class="ident" id="4263600">p224AddJacobian</span><span class="op" id="4263615">(</span><span class="ident" id="4263616">x3</span><span class="op" id="4263618">,</span>&nbsp;<span class="ident" id="4263620">y3</span><span class="op" id="4263622">,</span>&nbsp;<span class="ident" id="4263624">z3</span><span class="op" id="4263626">,</span>&nbsp;<span class="ident" id="4263628">x1</span><span class="op" id="4263630">,</span>&nbsp;<span class="ident" id="4263632">y1</span><span class="op" id="4263634">,</span>&nbsp;<span class="ident" id="4263636">z1</span><span class="op" id="4263638">,</span>&nbsp;<span class="ident" id="4263640">x2</span><span class="op" id="4263642">,</span>&nbsp;<span class="ident" id="4263644">y2</span><span class="op" id="4263646">,</span>&nbsp;<span class="ident" id="4263648">z2</span>&nbsp;<span class="op" id="4263651">*</span><span class="ident" id="4263652">p224FieldElement</span><span class="op" id="4263668">)</span>&nbsp;<span class="op" id="4263670">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4263673">//&nbsp;See&nbsp;http://hyperelliptic.org/EFD/g1p/auto-shortw-jacobian-3.html#addition-p224Add-2007-bl</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4263767">var</span>&nbsp;<span class="ident" id="4263771">z1z1</span><span class="op" id="4263775">,</span>&nbsp;<span class="ident" id="4263777">z2z2</span><span class="op" id="4263781">,</span>&nbsp;<span class="ident" id="4263783">u1</span><span class="op" id="4263785">,</span>&nbsp;<span class="ident" id="4263787">u2</span><span class="op" id="4263789">,</span>&nbsp;<span class="ident" id="4263791">s1</span><span class="op" id="4263793">,</span>&nbsp;<span class="ident" id="4263795">s2</span><span class="op" id="4263797">,</span>&nbsp;<span class="ident" id="4263799">h</span><span class="op" id="4263800">,</span>&nbsp;<span class="ident" id="4263802">i</span><span class="op" id="4263803">,</span>&nbsp;<span class="ident" id="4263805">j</span><span class="op" id="4263806">,</span>&nbsp;<span class="ident" id="4263808">r</span><span class="op" id="4263809">,</span>&nbsp;<span class="ident" id="4263811">v</span>&nbsp;<span class="ident" id="4263813">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4263831">var</span>&nbsp;<span class="ident" id="4263835">c</span>&nbsp;<span class="ident" id="4263837">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263861">z1IsZero</span>&nbsp;<span class="op" id="4263870">:=</span>&nbsp;<span class="ident" id="4263873">p224IsZero</span><span class="op" id="4263883">(</span><span class="ident" id="4263884">z1</span><span class="op" id="4263886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263889">z2IsZero</span>&nbsp;<span class="op" id="4263898">:=</span>&nbsp;<span class="ident" id="4263901">p224IsZero</span><span class="op" id="4263911">(</span><span class="ident" id="4263912">z2</span><span class="op" id="4263914">)</span><br>
<span class="lineno">510</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4263918">//&nbsp;Z1Z1&nbsp;=&nbsp;Z1²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263934">p224Square</span><span class="op" id="4263944">(</span><span class="op" id="4263945">&amp;</span><span class="ident" id="4263946">z1z1</span><span class="op" id="4263950">,</span>&nbsp;<span class="ident" id="4263952">z1</span><span class="op" id="4263954">,</span>&nbsp;<span class="op" id="4263956">&amp;</span><span class="ident" id="4263957">c</span><span class="op" id="4263958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4263961">//&nbsp;Z2Z2&nbsp;=&nbsp;Z2²</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4263977">p224Square</span><span class="op" id="4263987">(</span><span class="op" id="4263988">&amp;</span><span class="ident" id="4263989">z2z2</span><span class="op" id="4263993">,</span>&nbsp;<span class="ident" id="4263995">z2</span><span class="op" id="4263997">,</span>&nbsp;<span class="op" id="4263999">&amp;</span><span class="ident" id="4264000">c</span><span class="op" id="4264001">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4264004">//&nbsp;U1&nbsp;=&nbsp;X1*Z2Z2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264021">p224Mul</span><span class="op" id="4264028">(</span><span class="op" id="4264029">&amp;</span><span class="ident" id="4264030">u1</span><span class="op" id="4264032">,</span>&nbsp;<span class="ident" id="4264034">x1</span><span class="op" id="4264036">,</span>&nbsp;<span class="op" id="4264038">&amp;</span><span class="ident" id="4264039">z2z2</span><span class="op" id="4264043">,</span>&nbsp;<span class="op" id="4264045">&amp;</span><span class="ident" id="4264046">c</span><span class="op" id="4264047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4264050">//&nbsp;U2&nbsp;=&nbsp;X2*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264067">p224Mul</span><span class="op" id="4264074">(</span><span class="op" id="4264075">&amp;</span><span class="ident" id="4264076">u2</span><span class="op" id="4264078">,</span>&nbsp;<span class="ident" id="4264080">x2</span><span class="op" id="4264082">,</span>&nbsp;<span class="op" id="4264084">&amp;</span><span class="ident" id="4264085">z1z1</span><span class="op" id="4264089">,</span>&nbsp;<span class="op" id="4264091">&amp;</span><span class="ident" id="4264092">c</span><span class="op" id="4264093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4264096">//&nbsp;S1&nbsp;=&nbsp;Y1*Z2*Z2Z2</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264116">p224Mul</span><span class="op" id="4264123">(</span><span class="op" id="4264124">&amp;</span><span class="ident" id="4264125">s1</span><span class="op" id="4264127">,</span>&nbsp;<span class="ident" id="4264129">z2</span><span class="op" id="4264131">,</span>&nbsp;<span class="op" id="4264133">&amp;</span><span class="ident" id="4264134">z2z2</span><span class="op" id="4264138">,</span>&nbsp;<span class="op" id="4264140">&amp;</span><span class="ident" id="4264141">c</span><span class="op" id="4264142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264145">p224Mul</span><span class="op" id="4264152">(</span><span class="op" id="4264153">&amp;</span><span class="ident" id="4264154">s1</span><span class="op" id="4264156">,</span>&nbsp;<span class="ident" id="4264158">y1</span><span class="op" id="4264160">,</span>&nbsp;<span class="op" id="4264162">&amp;</span><span class="ident" id="4264163">s1</span><span class="op" id="4264165">,</span>&nbsp;<span class="op" id="4264167">&amp;</span><span class="ident" id="4264168">c</span><span class="op" id="4264169">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4264172">//&nbsp;S2&nbsp;=&nbsp;Y2*Z1*Z1Z1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264192">p224Mul</span><span class="op" id="4264199">(</span><span class="op" id="4264200">&amp;</span><span class="ident" id="4264201">s2</span><span class="op" id="4264203">,</span>&nbsp;<span class="ident" id="4264205">z1</span><span class="op" id="4264207">,</span>&nbsp;<span class="op" id="4264209">&amp;</span><span class="ident" id="4264210">z1z1</span><span class="op" id="4264214">,</span>&nbsp;<span class="op" id="4264216">&amp;</span><span class="ident" id="4264217">c</span><span class="op" id="4264218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264221">p224Mul</span><span class="op" id="4264228">(</span><span class="op" id="4264229">&amp;</span><span class="ident" id="4264230">s2</span><span class="op" id="4264232">,</span>&nbsp;<span class="ident" id="4264234">y2</span><span class="op" id="4264236">,</span>&nbsp;<span class="op" id="4264238">&amp;</span><span class="ident" id="4264239">s2</span><span class="op" id="4264241">,</span>&nbsp;<span class="op" id="4264243">&amp;</span><span class="ident" id="4264244">c</span><span class="op" id="4264245">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4264248">//&nbsp;H&nbsp;=&nbsp;U2-U1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264262">p224Sub</span><span class="op" id="4264269">(</span><span class="op" id="4264270">&amp;</span><span class="ident" id="4264271">h</span><span class="op" id="4264272">,</span>&nbsp;<span class="op" id="4264274">&amp;</span><span class="ident" id="4264275">u2</span><span class="op" id="4264277">,</span>&nbsp;<span class="op" id="4264279">&amp;</span><span class="ident" id="4264280">u1</span><span class="op" id="4264282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264285">p224Reduce</span><span class="op" id="4264295">(</span><span class="op" id="4264296">&amp;</span><span class="ident" id="4264297">h</span><span class="op" id="4264298">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264301">xEqual</span>&nbsp;<span class="op" id="4264308">:=</span>&nbsp;<span class="ident" id="4264311">p224IsZero</span><span class="op" id="4264321">(</span><span class="op" id="4264322">&amp;</span><span class="ident" id="4264323">h</span><span class="op" id="4264324">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4264327">//&nbsp;I&nbsp;=&nbsp;(2*H)²</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4264343">for</span>&nbsp;<span class="ident" id="4264347">j</span>&nbsp;<span class="op" id="4264349">:=</span>&nbsp;<span class="num" id="4264352">0</span><span class="op" id="4264353">;</span>&nbsp;<span class="ident" id="4264355">j</span>&nbsp;<span class="op" id="4264357">&lt;</span>&nbsp;<span class="num" id="4264359">8</span><span class="op" id="4264360">;</span>&nbsp;<span class="ident" id="4264362">j</span><span class="op" id="4264363">++</span>&nbsp;<span class="op" id="4264366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264370">i</span><span class="op" id="4264371">[</span><span class="ident" id="4264372">j</span><span class="op" id="4264373">]</span>&nbsp;<span class="op" id="4264375">=</span>&nbsp;<span class="ident" id="4264377">h</span><span class="op" id="4264378">[</span><span class="ident" id="4264379">j</span><span class="op" id="4264380">]</span>&nbsp;<span class="op" id="4264382">&lt;&lt;</span>&nbsp;<span class="num" id="4264385">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4264388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264391">p224Reduce</span><span class="op" id="4264401">(</span><span class="op" id="4264402">&amp;</span><span class="ident" id="4264403">i</span><span class="op" id="4264404">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264407">p224Square</span><span class="op" id="4264417">(</span><span class="op" id="4264418">&amp;</span><span class="ident" id="4264419">i</span><span class="op" id="4264420">,</span>&nbsp;<span class="op" id="4264422">&amp;</span><span class="ident" id="4264423">i</span><span class="op" id="4264424">,</span>&nbsp;<span class="op" id="4264426">&amp;</span><span class="ident" id="4264427">c</span><span class="op" id="4264428">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4264431">//&nbsp;J&nbsp;=&nbsp;H*I</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264443">p224Mul</span><span class="op" id="4264450">(</span><span class="op" id="4264451">&amp;</span><span class="ident" id="4264452">j</span><span class="op" id="4264453">,</span>&nbsp;<span class="op" id="4264455">&amp;</span><span class="ident" id="4264456">h</span><span class="op" id="4264457">,</span>&nbsp;<span class="op" id="4264459">&amp;</span><span class="ident" id="4264460">i</span><span class="op" id="4264461">,</span>&nbsp;<span class="op" id="4264463">&amp;</span><span class="ident" id="4264464">c</span><span class="op" id="4264465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4264468">//&nbsp;r&nbsp;=&nbsp;2*(S2-S1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264486">p224Sub</span><span class="op" id="4264493">(</span><span class="op" id="4264494">&amp;</span><span class="ident" id="4264495">r</span><span class="op" id="4264496">,</span>&nbsp;<span class="op" id="4264498">&amp;</span><span class="ident" id="4264499">s2</span><span class="op" id="4264501">,</span>&nbsp;<span class="op" id="4264503">&amp;</span><span class="ident" id="4264504">s1</span><span class="op" id="4264506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264509">p224Reduce</span><span class="op" id="4264519">(</span><span class="op" id="4264520">&amp;</span><span class="ident" id="4264521">r</span><span class="op" id="4264522">)</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264525">yEqual</span>&nbsp;<span class="op" id="4264532">:=</span>&nbsp;<span class="ident" id="4264535">p224IsZero</span><span class="op" id="4264545">(</span><span class="op" id="4264546">&amp;</span><span class="ident" id="4264547">r</span><span class="op" id="4264548">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4264551">if</span>&nbsp;<span class="ident" id="4264554">xEqual</span>&nbsp;<span class="op" id="4264561">==</span>&nbsp;<span class="num" id="4264564">1</span>&nbsp;<span class="op" id="4264566">&amp;&amp;</span>&nbsp;<span class="ident" id="4264569">yEqual</span>&nbsp;<span class="op" id="4264576">==</span>&nbsp;<span class="num" id="4264579">1</span>&nbsp;<span class="op" id="4264581">&amp;&amp;</span>&nbsp;<span class="ident" id="4264584">z1IsZero</span>&nbsp;<span class="op" id="4264593">==</span>&nbsp;<span class="num" id="4264596">0</span>&nbsp;<span class="op" id="4264598">&amp;&amp;</span>&nbsp;<span class="ident" id="4264601">z2IsZero</span>&nbsp;<span class="op" id="4264610">==</span>&nbsp;<span class="num" id="4264613">0</span>&nbsp;<span class="op" id="4264615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264619">p224DoubleJacobian</span><span class="op" id="4264637">(</span><span class="ident" id="4264638">x3</span><span class="op" id="4264640">,</span>&nbsp;<span class="ident" id="4264642">y3</span><span class="op" id="4264644">,</span>&nbsp;<span class="ident" id="4264646">z3</span><span class="op" id="4264648">,</span>&nbsp;<span class="ident" id="4264650">x1</span><span class="op" id="4264652">,</span>&nbsp;<span class="ident" id="4264654">y1</span><span class="op" id="4264656">,</span>&nbsp;<span class="ident" id="4264658">z1</span><span class="op" id="4264660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4264664">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4264672">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4264675">for</span>&nbsp;<span class="ident" id="4264679">i</span>&nbsp;<span class="op" id="4264681">:=</span>&nbsp;<span class="num" id="4264684">0</span><span class="op" id="4264685">;</span>&nbsp;<span class="ident" id="4264687">i</span>&nbsp;<span class="op" id="4264689">&lt;</span>&nbsp;<span class="num" id="4264691">8</span><span class="op" id="4264692">;</span>&nbsp;<span class="ident" id="4264694">i</span><span class="op" id="4264695">++</span>&nbsp;<span class="op" id="4264698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264702">r</span><span class="op" id="4264703">[</span><span class="ident" id="4264704">i</span><span class="op" id="4264705">]</span>&nbsp;<span class="op" id="4264707">&lt;&lt;=</span>&nbsp;<span class="num" id="4264711">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4264714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264717">p224Reduce</span><span class="op" id="4264727">(</span><span class="op" id="4264728">&amp;</span><span class="ident" id="4264729">r</span><span class="op" id="4264730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4264733">//&nbsp;V&nbsp;=&nbsp;U1*I</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264746">p224Mul</span><span class="op" id="4264753">(</span><span class="op" id="4264754">&amp;</span><span class="ident" id="4264755">v</span><span class="op" id="4264756">,</span>&nbsp;<span class="op" id="4264758">&amp;</span><span class="ident" id="4264759">u1</span><span class="op" id="4264761">,</span>&nbsp;<span class="op" id="4264763">&amp;</span><span class="ident" id="4264764">i</span><span class="op" id="4264765">,</span>&nbsp;<span class="op" id="4264767">&amp;</span><span class="ident" id="4264768">c</span><span class="op" id="4264769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4264772">//&nbsp;Z3&nbsp;=&nbsp;((Z1+Z2)²-Z1Z1-Z2Z2)*H</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264805">p224Add</span><span class="op" id="4264812">(</span><span class="op" id="4264813">&amp;</span><span class="ident" id="4264814">z1z1</span><span class="op" id="4264818">,</span>&nbsp;<span class="op" id="4264820">&amp;</span><span class="ident" id="4264821">z1z1</span><span class="op" id="4264825">,</span>&nbsp;<span class="op" id="4264827">&amp;</span><span class="ident" id="4264828">z2z2</span><span class="op" id="4264832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264835">p224Add</span><span class="op" id="4264842">(</span><span class="op" id="4264843">&amp;</span><span class="ident" id="4264844">z2z2</span><span class="op" id="4264848">,</span>&nbsp;<span class="ident" id="4264850">z1</span><span class="op" id="4264852">,</span>&nbsp;<span class="ident" id="4264854">z2</span><span class="op" id="4264856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264859">p224Reduce</span><span class="op" id="4264869">(</span><span class="op" id="4264870">&amp;</span><span class="ident" id="4264871">z2z2</span><span class="op" id="4264875">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264878">p224Square</span><span class="op" id="4264888">(</span><span class="op" id="4264889">&amp;</span><span class="ident" id="4264890">z2z2</span><span class="op" id="4264894">,</span>&nbsp;<span class="op" id="4264896">&amp;</span><span class="ident" id="4264897">z2z2</span><span class="op" id="4264901">,</span>&nbsp;<span class="op" id="4264903">&amp;</span><span class="ident" id="4264904">c</span><span class="op" id="4264905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264908">p224Sub</span><span class="op" id="4264915">(</span><span class="ident" id="4264916">z3</span><span class="op" id="4264918">,</span>&nbsp;<span class="op" id="4264920">&amp;</span><span class="ident" id="4264921">z2z2</span><span class="op" id="4264925">,</span>&nbsp;<span class="op" id="4264927">&amp;</span><span class="ident" id="4264928">z1z1</span><span class="op" id="4264932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264935">p224Reduce</span><span class="op" id="4264945">(</span><span class="ident" id="4264946">z3</span><span class="op" id="4264948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4264951">p224Mul</span><span class="op" id="4264958">(</span><span class="ident" id="4264959">z3</span><span class="op" id="4264961">,</span>&nbsp;<span class="ident" id="4264963">z3</span><span class="op" id="4264965">,</span>&nbsp;<span class="op" id="4264967">&amp;</span><span class="ident" id="4264968">h</span><span class="op" id="4264969">,</span>&nbsp;<span class="op" id="4264971">&amp;</span><span class="ident" id="4264972">c</span><span class="op" id="4264973">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4264976">//&nbsp;X3&nbsp;=&nbsp;r²-J-2*V</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4264995">for</span>&nbsp;<span class="ident" id="4264999">i</span>&nbsp;<span class="op" id="4265001">:=</span>&nbsp;<span class="num" id="4265004">0</span><span class="op" id="4265005">;</span>&nbsp;<span class="ident" id="4265007">i</span>&nbsp;<span class="op" id="4265009">&lt;</span>&nbsp;<span class="num" id="4265011">8</span><span class="op" id="4265012">;</span>&nbsp;<span class="ident" id="4265014">i</span><span class="op" id="4265015">++</span>&nbsp;<span class="op" id="4265018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265022">z1z1</span><span class="op" id="4265026">[</span><span class="ident" id="4265027">i</span><span class="op" id="4265028">]</span>&nbsp;<span class="op" id="4265030">=</span>&nbsp;<span class="ident" id="4265032">v</span><span class="op" id="4265033">[</span><span class="ident" id="4265034">i</span><span class="op" id="4265035">]</span>&nbsp;<span class="op" id="4265037">&lt;&lt;</span>&nbsp;<span class="num" id="4265040">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4265043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265046">p224Add</span><span class="op" id="4265053">(</span><span class="op" id="4265054">&amp;</span><span class="ident" id="4265055">z1z1</span><span class="op" id="4265059">,</span>&nbsp;<span class="op" id="4265061">&amp;</span><span class="ident" id="4265062">j</span><span class="op" id="4265063">,</span>&nbsp;<span class="op" id="4265065">&amp;</span><span class="ident" id="4265066">z1z1</span><span class="op" id="4265070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265073">p224Reduce</span><span class="op" id="4265083">(</span><span class="op" id="4265084">&amp;</span><span class="ident" id="4265085">z1z1</span><span class="op" id="4265089">)</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265092">p224Square</span><span class="op" id="4265102">(</span><span class="ident" id="4265103">x3</span><span class="op" id="4265105">,</span>&nbsp;<span class="op" id="4265107">&amp;</span><span class="ident" id="4265108">r</span><span class="op" id="4265109">,</span>&nbsp;<span class="op" id="4265111">&amp;</span><span class="ident" id="4265112">c</span><span class="op" id="4265113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265116">p224Sub</span><span class="op" id="4265123">(</span><span class="ident" id="4265124">x3</span><span class="op" id="4265126">,</span>&nbsp;<span class="ident" id="4265128">x3</span><span class="op" id="4265130">,</span>&nbsp;<span class="op" id="4265132">&amp;</span><span class="ident" id="4265133">z1z1</span><span class="op" id="4265137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265140">p224Reduce</span><span class="op" id="4265150">(</span><span class="ident" id="4265151">x3</span><span class="op" id="4265153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4265156">//&nbsp;Y3&nbsp;=&nbsp;r*(V-X3)-2*S1*J</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4265181">for</span>&nbsp;<span class="ident" id="4265185">i</span>&nbsp;<span class="op" id="4265187">:=</span>&nbsp;<span class="num" id="4265190">0</span><span class="op" id="4265191">;</span>&nbsp;<span class="ident" id="4265193">i</span>&nbsp;<span class="op" id="4265195">&lt;</span>&nbsp;<span class="num" id="4265197">8</span><span class="op" id="4265198">;</span>&nbsp;<span class="ident" id="4265200">i</span><span class="op" id="4265201">++</span>&nbsp;<span class="op" id="4265204">{</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265208">s1</span><span class="op" id="4265210">[</span><span class="ident" id="4265211">i</span><span class="op" id="4265212">]</span>&nbsp;<span class="op" id="4265214">&lt;&lt;=</span>&nbsp;<span class="num" id="4265218">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4265221">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265224">p224Mul</span><span class="op" id="4265231">(</span><span class="op" id="4265232">&amp;</span><span class="ident" id="4265233">s1</span><span class="op" id="4265235">,</span>&nbsp;<span class="op" id="4265237">&amp;</span><span class="ident" id="4265238">s1</span><span class="op" id="4265240">,</span>&nbsp;<span class="op" id="4265242">&amp;</span><span class="ident" id="4265243">j</span><span class="op" id="4265244">,</span>&nbsp;<span class="op" id="4265246">&amp;</span><span class="ident" id="4265247">c</span><span class="op" id="4265248">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265251">p224Sub</span><span class="op" id="4265258">(</span><span class="op" id="4265259">&amp;</span><span class="ident" id="4265260">z1z1</span><span class="op" id="4265264">,</span>&nbsp;<span class="op" id="4265266">&amp;</span><span class="ident" id="4265267">v</span><span class="op" id="4265268">,</span>&nbsp;<span class="ident" id="4265270">x3</span><span class="op" id="4265272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265275">p224Reduce</span><span class="op" id="4265285">(</span><span class="op" id="4265286">&amp;</span><span class="ident" id="4265287">z1z1</span><span class="op" id="4265291">)</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265294">p224Mul</span><span class="op" id="4265301">(</span><span class="op" id="4265302">&amp;</span><span class="ident" id="4265303">z1z1</span><span class="op" id="4265307">,</span>&nbsp;<span class="op" id="4265309">&amp;</span><span class="ident" id="4265310">z1z1</span><span class="op" id="4265314">,</span>&nbsp;<span class="op" id="4265316">&amp;</span><span class="ident" id="4265317">r</span><span class="op" id="4265318">,</span>&nbsp;<span class="op" id="4265320">&amp;</span><span class="ident" id="4265321">c</span><span class="op" id="4265322">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265325">p224Sub</span><span class="op" id="4265332">(</span><span class="ident" id="4265333">y3</span><span class="op" id="4265335">,</span>&nbsp;<span class="op" id="4265337">&amp;</span><span class="ident" id="4265338">z1z1</span><span class="op" id="4265342">,</span>&nbsp;<span class="op" id="4265344">&amp;</span><span class="ident" id="4265345">s1</span><span class="op" id="4265347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265350">p224Reduce</span><span class="op" id="4265360">(</span><span class="ident" id="4265361">y3</span><span class="op" id="4265363">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265367">p224CopyConditional</span><span class="op" id="4265386">(</span><span class="ident" id="4265387">x3</span><span class="op" id="4265389">,</span>&nbsp;<span class="ident" id="4265391">x2</span><span class="op" id="4265393">,</span>&nbsp;<span class="ident" id="4265395">z1IsZero</span><span class="op" id="4265403">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265406">p224CopyConditional</span><span class="op" id="4265425">(</span><span class="ident" id="4265426">x3</span><span class="op" id="4265428">,</span>&nbsp;<span class="ident" id="4265430">x1</span><span class="op" id="4265432">,</span>&nbsp;<span class="ident" id="4265434">z2IsZero</span><span class="op" id="4265442">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265445">p224CopyConditional</span><span class="op" id="4265464">(</span><span class="ident" id="4265465">y3</span><span class="op" id="4265467">,</span>&nbsp;<span class="ident" id="4265469">y2</span><span class="op" id="4265471">,</span>&nbsp;<span class="ident" id="4265473">z1IsZero</span><span class="op" id="4265481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265484">p224CopyConditional</span><span class="op" id="4265503">(</span><span class="ident" id="4265504">y3</span><span class="op" id="4265506">,</span>&nbsp;<span class="ident" id="4265508">y1</span><span class="op" id="4265510">,</span>&nbsp;<span class="ident" id="4265512">z2IsZero</span><span class="op" id="4265520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265523">p224CopyConditional</span><span class="op" id="4265542">(</span><span class="ident" id="4265543">z3</span><span class="op" id="4265545">,</span>&nbsp;<span class="ident" id="4265547">z2</span><span class="op" id="4265549">,</span>&nbsp;<span class="ident" id="4265551">z1IsZero</span><span class="op" id="4265559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265562">p224CopyConditional</span><span class="op" id="4265581">(</span><span class="ident" id="4265582">z3</span><span class="op" id="4265584">,</span>&nbsp;<span class="ident" id="4265586">z1</span><span class="op" id="4265588">,</span>&nbsp;<span class="ident" id="4265590">z2IsZero</span><span class="op" id="4265598">)</span><br>
<span class="lineno">585</span><span class="op" id="4265600">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4265603">//&nbsp;p224DoubleJacobian&nbsp;computes&nbsp;*out&nbsp;=&nbsp;a+a.</span><br>
<span class="lineno"></span><span class="keyword" id="4265646">func</span>&nbsp;<span class="ident" id="4265651">p224DoubleJacobian</span><span class="op" id="4265669">(</span><span class="ident" id="4265670">x3</span><span class="op" id="4265672">,</span>&nbsp;<span class="ident" id="4265674">y3</span><span class="op" id="4265676">,</span>&nbsp;<span class="ident" id="4265678">z3</span><span class="op" id="4265680">,</span>&nbsp;<span class="ident" id="4265682">x1</span><span class="op" id="4265684">,</span>&nbsp;<span class="ident" id="4265686">y1</span><span class="op" id="4265688">,</span>&nbsp;<span class="ident" id="4265690">z1</span>&nbsp;<span class="op" id="4265693">*</span><span class="ident" id="4265694">p224FieldElement</span><span class="op" id="4265710">)</span>&nbsp;<span class="op" id="4265712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4265715">var</span>&nbsp;<span class="ident" id="4265719">delta</span><span class="op" id="4265724">,</span>&nbsp;<span class="ident" id="4265726">gamma</span><span class="op" id="4265731">,</span>&nbsp;<span class="ident" id="4265733">beta</span><span class="op" id="4265737">,</span>&nbsp;<span class="ident" id="4265739">alpha</span><span class="op" id="4265744">,</span>&nbsp;<span class="ident" id="4265746">t</span>&nbsp;<span class="ident" id="4265748">p224FieldElement</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4265766">var</span>&nbsp;<span class="ident" id="4265770">c</span>&nbsp;<span class="ident" id="4265772">p224LargeFieldElement</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265796">p224Square</span><span class="op" id="4265806">(</span><span class="op" id="4265807">&amp;</span><span class="ident" id="4265808">delta</span><span class="op" id="4265813">,</span>&nbsp;<span class="ident" id="4265815">z1</span><span class="op" id="4265817">,</span>&nbsp;<span class="op" id="4265819">&amp;</span><span class="ident" id="4265820">c</span><span class="op" id="4265821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265824">p224Square</span><span class="op" id="4265834">(</span><span class="op" id="4265835">&amp;</span><span class="ident" id="4265836">gamma</span><span class="op" id="4265841">,</span>&nbsp;<span class="ident" id="4265843">y1</span><span class="op" id="4265845">,</span>&nbsp;<span class="op" id="4265847">&amp;</span><span class="ident" id="4265848">c</span><span class="op" id="4265849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265852">p224Mul</span><span class="op" id="4265859">(</span><span class="op" id="4265860">&amp;</span><span class="ident" id="4265861">beta</span><span class="op" id="4265865">,</span>&nbsp;<span class="ident" id="4265867">x1</span><span class="op" id="4265869">,</span>&nbsp;<span class="op" id="4265871">&amp;</span><span class="ident" id="4265872">gamma</span><span class="op" id="4265877">,</span>&nbsp;<span class="op" id="4265879">&amp;</span><span class="ident" id="4265880">c</span><span class="op" id="4265881">)</span><br>
<span class="lineno">595</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4265885">//&nbsp;alpha&nbsp;=&nbsp;3*(X1-delta)*(X1+delta)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265921">p224Add</span><span class="op" id="4265928">(</span><span class="op" id="4265929">&amp;</span><span class="ident" id="4265930">t</span><span class="op" id="4265931">,</span>&nbsp;<span class="ident" id="4265933">x1</span><span class="op" id="4265935">,</span>&nbsp;<span class="op" id="4265937">&amp;</span><span class="ident" id="4265938">delta</span><span class="op" id="4265943">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4265946">for</span>&nbsp;<span class="ident" id="4265950">i</span>&nbsp;<span class="op" id="4265952">:=</span>&nbsp;<span class="num" id="4265955">0</span><span class="op" id="4265956">;</span>&nbsp;<span class="ident" id="4265958">i</span>&nbsp;<span class="op" id="4265960">&lt;</span>&nbsp;<span class="num" id="4265962">8</span><span class="op" id="4265963">;</span>&nbsp;<span class="ident" id="4265965">i</span><span class="op" id="4265966">++</span>&nbsp;<span class="op" id="4265969">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265973">t</span><span class="op" id="4265974">[</span><span class="ident" id="4265975">i</span><span class="op" id="4265976">]</span>&nbsp;<span class="op" id="4265978">+=</span>&nbsp;<span class="ident" id="4265981">t</span><span class="op" id="4265982">[</span><span class="ident" id="4265983">i</span><span class="op" id="4265984">]</span>&nbsp;<span class="op" id="4265986">&lt;&lt;</span>&nbsp;<span class="num" id="4265989">1</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4265992">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4265995">p224Reduce</span><span class="op" id="4266005">(</span><span class="op" id="4266006">&amp;</span><span class="ident" id="4266007">t</span><span class="op" id="4266008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266011">p224Sub</span><span class="op" id="4266018">(</span><span class="op" id="4266019">&amp;</span><span class="ident" id="4266020">alpha</span><span class="op" id="4266025">,</span>&nbsp;<span class="ident" id="4266027">x1</span><span class="op" id="4266029">,</span>&nbsp;<span class="op" id="4266031">&amp;</span><span class="ident" id="4266032">delta</span><span class="op" id="4266037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266040">p224Reduce</span><span class="op" id="4266050">(</span><span class="op" id="4266051">&amp;</span><span class="ident" id="4266052">alpha</span><span class="op" id="4266057">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266060">p224Mul</span><span class="op" id="4266067">(</span><span class="op" id="4266068">&amp;</span><span class="ident" id="4266069">alpha</span><span class="op" id="4266074">,</span>&nbsp;<span class="op" id="4266076">&amp;</span><span class="ident" id="4266077">alpha</span><span class="op" id="4266082">,</span>&nbsp;<span class="op" id="4266084">&amp;</span><span class="ident" id="4266085">t</span><span class="op" id="4266086">,</span>&nbsp;<span class="op" id="4266088">&amp;</span><span class="ident" id="4266089">c</span><span class="op" id="4266090">)</span><br>
<span class="lineno">605</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4266094">//&nbsp;Z3&nbsp;=&nbsp;(Y1+Z1)²-gamma-delta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266125">p224Add</span><span class="op" id="4266132">(</span><span class="ident" id="4266133">z3</span><span class="op" id="4266135">,</span>&nbsp;<span class="ident" id="4266137">y1</span><span class="op" id="4266139">,</span>&nbsp;<span class="ident" id="4266141">z1</span><span class="op" id="4266143">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266146">p224Reduce</span><span class="op" id="4266156">(</span><span class="ident" id="4266157">z3</span><span class="op" id="4266159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266162">p224Square</span><span class="op" id="4266172">(</span><span class="ident" id="4266173">z3</span><span class="op" id="4266175">,</span>&nbsp;<span class="ident" id="4266177">z3</span><span class="op" id="4266179">,</span>&nbsp;<span class="op" id="4266181">&amp;</span><span class="ident" id="4266182">c</span><span class="op" id="4266183">)</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266186">p224Sub</span><span class="op" id="4266193">(</span><span class="ident" id="4266194">z3</span><span class="op" id="4266196">,</span>&nbsp;<span class="ident" id="4266198">z3</span><span class="op" id="4266200">,</span>&nbsp;<span class="op" id="4266202">&amp;</span><span class="ident" id="4266203">gamma</span><span class="op" id="4266208">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266211">p224Reduce</span><span class="op" id="4266221">(</span><span class="ident" id="4266222">z3</span><span class="op" id="4266224">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266227">p224Sub</span><span class="op" id="4266234">(</span><span class="ident" id="4266235">z3</span><span class="op" id="4266237">,</span>&nbsp;<span class="ident" id="4266239">z3</span><span class="op" id="4266241">,</span>&nbsp;<span class="op" id="4266243">&amp;</span><span class="ident" id="4266244">delta</span><span class="op" id="4266249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266252">p224Reduce</span><span class="op" id="4266262">(</span><span class="ident" id="4266263">z3</span><span class="op" id="4266265">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4266269">//&nbsp;X3&nbsp;=&nbsp;alpha²-8*beta</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4266293">for</span>&nbsp;<span class="ident" id="4266297">i</span>&nbsp;<span class="op" id="4266299">:=</span>&nbsp;<span class="num" id="4266302">0</span><span class="op" id="4266303">;</span>&nbsp;<span class="ident" id="4266305">i</span>&nbsp;<span class="op" id="4266307">&lt;</span>&nbsp;<span class="num" id="4266309">8</span><span class="op" id="4266310">;</span>&nbsp;<span class="ident" id="4266312">i</span><span class="op" id="4266313">++</span>&nbsp;<span class="op" id="4266316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266320">delta</span><span class="op" id="4266325">[</span><span class="ident" id="4266326">i</span><span class="op" id="4266327">]</span>&nbsp;<span class="op" id="4266329">=</span>&nbsp;<span class="ident" id="4266331">beta</span><span class="op" id="4266335">[</span><span class="ident" id="4266336">i</span><span class="op" id="4266337">]</span>&nbsp;<span class="op" id="4266339">&lt;&lt;</span>&nbsp;<span class="num" id="4266342">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4266345">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266348">p224Reduce</span><span class="op" id="4266358">(</span><span class="op" id="4266359">&amp;</span><span class="ident" id="4266360">delta</span><span class="op" id="4266365">)</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266368">p224Square</span><span class="op" id="4266378">(</span><span class="ident" id="4266379">x3</span><span class="op" id="4266381">,</span>&nbsp;<span class="op" id="4266383">&amp;</span><span class="ident" id="4266384">alpha</span><span class="op" id="4266389">,</span>&nbsp;<span class="op" id="4266391">&amp;</span><span class="ident" id="4266392">c</span><span class="op" id="4266393">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266396">p224Sub</span><span class="op" id="4266403">(</span><span class="ident" id="4266404">x3</span><span class="op" id="4266406">,</span>&nbsp;<span class="ident" id="4266408">x3</span><span class="op" id="4266410">,</span>&nbsp;<span class="op" id="4266412">&amp;</span><span class="ident" id="4266413">delta</span><span class="op" id="4266418">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266421">p224Reduce</span><span class="op" id="4266431">(</span><span class="ident" id="4266432">x3</span><span class="op" id="4266434">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4266438">//&nbsp;Y3&nbsp;=&nbsp;alpha*(4*beta-X3)-8*gamma²</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4266475">for</span>&nbsp;<span class="ident" id="4266479">i</span>&nbsp;<span class="op" id="4266481">:=</span>&nbsp;<span class="num" id="4266484">0</span><span class="op" id="4266485">;</span>&nbsp;<span class="ident" id="4266487">i</span>&nbsp;<span class="op" id="4266489">&lt;</span>&nbsp;<span class="num" id="4266491">8</span><span class="op" id="4266492">;</span>&nbsp;<span class="ident" id="4266494">i</span><span class="op" id="4266495">++</span>&nbsp;<span class="op" id="4266498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266502">beta</span><span class="op" id="4266506">[</span><span class="ident" id="4266507">i</span><span class="op" id="4266508">]</span>&nbsp;<span class="op" id="4266510">&lt;&lt;=</span>&nbsp;<span class="num" id="4266514">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4266517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266520">p224Sub</span><span class="op" id="4266527">(</span><span class="op" id="4266528">&amp;</span><span class="ident" id="4266529">beta</span><span class="op" id="4266533">,</span>&nbsp;<span class="op" id="4266535">&amp;</span><span class="ident" id="4266536">beta</span><span class="op" id="4266540">,</span>&nbsp;<span class="ident" id="4266542">x3</span><span class="op" id="4266544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266547">p224Reduce</span><span class="op" id="4266557">(</span><span class="op" id="4266558">&amp;</span><span class="ident" id="4266559">beta</span><span class="op" id="4266563">)</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266566">p224Square</span><span class="op" id="4266576">(</span><span class="op" id="4266577">&amp;</span><span class="ident" id="4266578">gamma</span><span class="op" id="4266583">,</span>&nbsp;<span class="op" id="4266585">&amp;</span><span class="ident" id="4266586">gamma</span><span class="op" id="4266591">,</span>&nbsp;<span class="op" id="4266593">&amp;</span><span class="ident" id="4266594">c</span><span class="op" id="4266595">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4266598">for</span>&nbsp;<span class="ident" id="4266602">i</span>&nbsp;<span class="op" id="4266604">:=</span>&nbsp;<span class="num" id="4266607">0</span><span class="op" id="4266608">;</span>&nbsp;<span class="ident" id="4266610">i</span>&nbsp;<span class="op" id="4266612">&lt;</span>&nbsp;<span class="num" id="4266614">8</span><span class="op" id="4266615">;</span>&nbsp;<span class="ident" id="4266617">i</span><span class="op" id="4266618">++</span>&nbsp;<span class="op" id="4266621">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266625">gamma</span><span class="op" id="4266630">[</span><span class="ident" id="4266631">i</span><span class="op" id="4266632">]</span>&nbsp;<span class="op" id="4266634">&lt;&lt;=</span>&nbsp;<span class="num" id="4266638">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4266641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266644">p224Reduce</span><span class="op" id="4266654">(</span><span class="op" id="4266655">&amp;</span><span class="ident" id="4266656">gamma</span><span class="op" id="4266661">)</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266664">p224Mul</span><span class="op" id="4266671">(</span><span class="ident" id="4266672">y3</span><span class="op" id="4266674">,</span>&nbsp;<span class="op" id="4266676">&amp;</span><span class="ident" id="4266677">alpha</span><span class="op" id="4266682">,</span>&nbsp;<span class="op" id="4266684">&amp;</span><span class="ident" id="4266685">beta</span><span class="op" id="4266689">,</span>&nbsp;<span class="op" id="4266691">&amp;</span><span class="ident" id="4266692">c</span><span class="op" id="4266693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266696">p224Sub</span><span class="op" id="4266703">(</span><span class="ident" id="4266704">y3</span><span class="op" id="4266706">,</span>&nbsp;<span class="ident" id="4266708">y3</span><span class="op" id="4266710">,</span>&nbsp;<span class="op" id="4266712">&amp;</span><span class="ident" id="4266713">gamma</span><span class="op" id="4266718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266721">p224Reduce</span><span class="op" id="4266731">(</span><span class="ident" id="4266732">y3</span><span class="op" id="4266734">)</span><br>
<span class="lineno"></span><span class="op" id="4266736">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">640</span><span class="comment" id="4266739">//&nbsp;p224CopyConditional&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in&nbsp;iff&nbsp;the&nbsp;least-significant-bit&nbsp;of&nbsp;control</span><br>
<span class="lineno"></span><span class="comment" id="4266819">//&nbsp;is&nbsp;true,&nbsp;and&nbsp;it&nbsp;runs&nbsp;in&nbsp;constant&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4266861">func</span>&nbsp;<span class="ident" id="4266866">p224CopyConditional</span><span class="op" id="4266885">(</span><span class="ident" id="4266886">out</span><span class="op" id="4266889">,</span>&nbsp;<span class="ident" id="4266891">in</span>&nbsp;<span class="op" id="4266894">*</span><span class="ident" id="4266895">p224FieldElement</span><span class="op" id="4266911">,</span>&nbsp;<span class="ident" id="4266913">control</span>&nbsp;<span class="builtintype" id="4266921">uint32</span><span class="op" id="4266927">)</span>&nbsp;<span class="op" id="4266929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266932">control</span>&nbsp;<span class="op" id="4266940">&lt;&lt;=</span>&nbsp;<span class="num" id="4266944">31</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4266948">control</span>&nbsp;<span class="op" id="4266956">=</span>&nbsp;<span class="builtintype" id="4266958">uint32</span><span class="op" id="4266964">(</span><span class="builtintype" id="4266965">int32</span><span class="op" id="4266970">(</span><span class="ident" id="4266971">control</span><span class="op" id="4266978">)</span>&nbsp;<span class="op" id="4266980">&gt;&gt;</span>&nbsp;<span class="num" id="4266983">31</span><span class="op" id="4266985">)</span><br>
<span class="lineno">645</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4266989">for</span>&nbsp;<span class="ident" id="4266993">i</span>&nbsp;<span class="op" id="4266995">:=</span>&nbsp;<span class="num" id="4266998">0</span><span class="op" id="4266999">;</span>&nbsp;<span class="ident" id="4267001">i</span>&nbsp;<span class="op" id="4267003">&lt;</span>&nbsp;<span class="num" id="4267005">8</span><span class="op" id="4267006">;</span>&nbsp;<span class="ident" id="4267008">i</span><span class="op" id="4267009">++</span>&nbsp;<span class="op" id="4267012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267016">out</span><span class="op" id="4267019">[</span><span class="ident" id="4267020">i</span><span class="op" id="4267021">]</span>&nbsp;<span class="op" id="4267023">^=</span>&nbsp;<span class="op" id="4267026">(</span><span class="ident" id="4267027">out</span><span class="op" id="4267030">[</span><span class="ident" id="4267031">i</span><span class="op" id="4267032">]</span>&nbsp;<span class="op" id="4267034">^</span>&nbsp;<span class="ident" id="4267036">in</span><span class="op" id="4267038">[</span><span class="ident" id="4267039">i</span><span class="op" id="4267040">]</span><span class="op" id="4267041">)</span>&nbsp;<span class="op" id="4267043">&amp;</span>&nbsp;<span class="ident" id="4267045">control</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4267054">}</span><br>
<span class="lineno"></span><span class="op" id="4267056">}</span><br>
<span class="lineno">650</span><br>
<span class="lineno"></span><span class="keyword" id="4267059">func</span>&nbsp;<span class="ident" id="4267064">p224ScalarMult</span><span class="op" id="4267078">(</span><span class="ident" id="4267079">outX</span><span class="op" id="4267083">,</span>&nbsp;<span class="ident" id="4267085">outY</span><span class="op" id="4267089">,</span>&nbsp;<span class="ident" id="4267091">outZ</span><span class="op" id="4267095">,</span>&nbsp;<span class="ident" id="4267097">inX</span><span class="op" id="4267100">,</span>&nbsp;<span class="ident" id="4267102">inY</span><span class="op" id="4267105">,</span>&nbsp;<span class="ident" id="4267107">inZ</span>&nbsp;<span class="op" id="4267111">*</span><span class="ident" id="4267112">p224FieldElement</span><span class="op" id="4267128">,</span>&nbsp;<span class="ident" id="4267130">scalar</span>&nbsp;<span class="op" id="4267137">[</span><span class="op" id="4267138">]</span><span class="builtintype" id="4267139">byte</span><span class="op" id="4267143">)</span>&nbsp;<span class="op" id="4267145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267148">var</span>&nbsp;<span class="ident" id="4267152">xx</span><span class="op" id="4267154">,</span>&nbsp;<span class="ident" id="4267156">yy</span><span class="op" id="4267158">,</span>&nbsp;<span class="ident" id="4267160">zz</span>&nbsp;<span class="ident" id="4267163">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267181">for</span>&nbsp;<span class="ident" id="4267185">i</span>&nbsp;<span class="op" id="4267187">:=</span>&nbsp;<span class="num" id="4267190">0</span><span class="op" id="4267191">;</span>&nbsp;<span class="ident" id="4267193">i</span>&nbsp;<span class="op" id="4267195">&lt;</span>&nbsp;<span class="num" id="4267197">8</span><span class="op" id="4267198">;</span>&nbsp;<span class="ident" id="4267200">i</span><span class="op" id="4267201">++</span>&nbsp;<span class="op" id="4267204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267208">outX</span><span class="op" id="4267212">[</span><span class="ident" id="4267213">i</span><span class="op" id="4267214">]</span>&nbsp;<span class="op" id="4267216">=</span>&nbsp;<span class="num" id="4267218">0</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267222">outY</span><span class="op" id="4267226">[</span><span class="ident" id="4267227">i</span><span class="op" id="4267228">]</span>&nbsp;<span class="op" id="4267230">=</span>&nbsp;<span class="num" id="4267232">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267236">outZ</span><span class="op" id="4267240">[</span><span class="ident" id="4267241">i</span><span class="op" id="4267242">]</span>&nbsp;<span class="op" id="4267244">=</span>&nbsp;<span class="num" id="4267246">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4267249">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267253">for</span>&nbsp;<span class="ident" id="4267257">_</span><span class="op" id="4267258">,</span>&nbsp;<span class="builtintype" id="4267260">byte</span>&nbsp;<span class="op" id="4267265">:=</span>&nbsp;<span class="keyword" id="4267268">range</span>&nbsp;<span class="ident" id="4267274">scalar</span>&nbsp;<span class="op" id="4267281">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267285">for</span>&nbsp;<span class="ident" id="4267289">bitNum</span>&nbsp;<span class="op" id="4267296">:=</span>&nbsp;<span class="builtintype" id="4267299">uint</span><span class="op" id="4267303">(</span><span class="num" id="4267304">0</span><span class="op" id="4267305">)</span><span class="op" id="4267306">;</span>&nbsp;<span class="ident" id="4267308">bitNum</span>&nbsp;<span class="op" id="4267315">&lt;</span>&nbsp;<span class="num" id="4267317">8</span><span class="op" id="4267318">;</span>&nbsp;<span class="ident" id="4267320">bitNum</span><span class="op" id="4267326">++</span>&nbsp;<span class="op" id="4267329">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267334">p224DoubleJacobian</span><span class="op" id="4267352">(</span><span class="ident" id="4267353">outX</span><span class="op" id="4267357">,</span>&nbsp;<span class="ident" id="4267359">outY</span><span class="op" id="4267363">,</span>&nbsp;<span class="ident" id="4267365">outZ</span><span class="op" id="4267369">,</span>&nbsp;<span class="ident" id="4267371">outX</span><span class="op" id="4267375">,</span>&nbsp;<span class="ident" id="4267377">outY</span><span class="op" id="4267381">,</span>&nbsp;<span class="ident" id="4267383">outZ</span><span class="op" id="4267387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267392">bit</span>&nbsp;<span class="op" id="4267396">:=</span>&nbsp;<span class="builtintype" id="4267399">uint32</span><span class="op" id="4267405">(</span><span class="op" id="4267406">(</span><span class="builtintype" id="4267407">byte</span>&nbsp;<span class="op" id="4267412">&gt;&gt;</span>&nbsp;<span class="op" id="4267415">(</span><span class="num" id="4267416">7</span>&nbsp;<span class="op" id="4267418">-</span>&nbsp;<span class="ident" id="4267420">bitNum</span><span class="op" id="4267426">)</span><span class="op" id="4267427">)</span>&nbsp;<span class="op" id="4267429">&amp;</span>&nbsp;<span class="num" id="4267431">1</span><span class="op" id="4267432">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267437">p224AddJacobian</span><span class="op" id="4267452">(</span><span class="op" id="4267453">&amp;</span><span class="ident" id="4267454">xx</span><span class="op" id="4267456">,</span>&nbsp;<span class="op" id="4267458">&amp;</span><span class="ident" id="4267459">yy</span><span class="op" id="4267461">,</span>&nbsp;<span class="op" id="4267463">&amp;</span><span class="ident" id="4267464">zz</span><span class="op" id="4267466">,</span>&nbsp;<span class="ident" id="4267468">inX</span><span class="op" id="4267471">,</span>&nbsp;<span class="ident" id="4267473">inY</span><span class="op" id="4267476">,</span>&nbsp;<span class="ident" id="4267478">inZ</span><span class="op" id="4267481">,</span>&nbsp;<span class="ident" id="4267483">outX</span><span class="op" id="4267487">,</span>&nbsp;<span class="ident" id="4267489">outY</span><span class="op" id="4267493">,</span>&nbsp;<span class="ident" id="4267495">outZ</span><span class="op" id="4267499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267504">p224CopyConditional</span><span class="op" id="4267523">(</span><span class="ident" id="4267524">outX</span><span class="op" id="4267528">,</span>&nbsp;<span class="op" id="4267530">&amp;</span><span class="ident" id="4267531">xx</span><span class="op" id="4267533">,</span>&nbsp;<span class="ident" id="4267535">bit</span><span class="op" id="4267538">)</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267543">p224CopyConditional</span><span class="op" id="4267562">(</span><span class="ident" id="4267563">outY</span><span class="op" id="4267567">,</span>&nbsp;<span class="op" id="4267569">&amp;</span><span class="ident" id="4267570">yy</span><span class="op" id="4267572">,</span>&nbsp;<span class="ident" id="4267574">bit</span><span class="op" id="4267577">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267582">p224CopyConditional</span><span class="op" id="4267601">(</span><span class="ident" id="4267602">outZ</span><span class="op" id="4267606">,</span>&nbsp;<span class="op" id="4267608">&amp;</span><span class="ident" id="4267609">zz</span><span class="op" id="4267611">,</span>&nbsp;<span class="ident" id="4267613">bit</span><span class="op" id="4267616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4267620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4267623">}</span><br>
<span class="lineno"></span><span class="op" id="4267625">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span><span class="comment" id="4267628">//&nbsp;p224ToAffine&nbsp;converts&nbsp;from&nbsp;Jacobian&nbsp;to&nbsp;affine&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4267683">func</span>&nbsp;<span class="ident" id="4267688">p224ToAffine</span><span class="op" id="4267700">(</span><span class="ident" id="4267701">x</span><span class="op" id="4267702">,</span>&nbsp;<span class="ident" id="4267704">y</span><span class="op" id="4267705">,</span>&nbsp;<span class="ident" id="4267707">z</span>&nbsp;<span class="op" id="4267709">*</span><span class="ident" id="4267710">p224FieldElement</span><span class="op" id="4267726">)</span>&nbsp;<span class="op" id="4267728">(</span><span class="op" id="4267729">*</span><span class="ident" id="4267730">big</span><span class="op" id="4267733">.</span><span class="ident" id="4267734">Int</span><span class="op" id="4267737">,</span>&nbsp;<span class="op" id="4267739">*</span><span class="ident" id="4267740">big</span><span class="op" id="4267743">.</span><span class="ident" id="4267744">Int</span><span class="op" id="4267747">)</span>&nbsp;<span class="op" id="4267749">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267752">var</span>&nbsp;<span class="ident" id="4267756">zinv</span><span class="op" id="4267760">,</span>&nbsp;<span class="ident" id="4267762">zinvsq</span><span class="op" id="4267768">,</span>&nbsp;<span class="ident" id="4267770">outx</span><span class="op" id="4267774">,</span>&nbsp;<span class="ident" id="4267776">outy</span>&nbsp;<span class="ident" id="4267781">p224FieldElement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267799">var</span>&nbsp;<span class="ident" id="4267803">tmp</span>&nbsp;<span class="ident" id="4267807">p224LargeFieldElement</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267831">if</span>&nbsp;<span class="ident" id="4267834">isPointAtInfinity</span>&nbsp;<span class="op" id="4267852">:=</span>&nbsp;<span class="ident" id="4267855">p224IsZero</span><span class="op" id="4267865">(</span><span class="ident" id="4267866">z</span><span class="op" id="4267867">)</span><span class="op" id="4267868">;</span>&nbsp;<span class="ident" id="4267870">isPointAtInfinity</span>&nbsp;<span class="op" id="4267888">==</span>&nbsp;<span class="num" id="4267891">1</span>&nbsp;<span class="op" id="4267893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4267897">return</span>&nbsp;<span class="builtinfunc" id="4267904">new</span><span class="op" id="4267907">(</span><span class="ident" id="4267908">big</span><span class="op" id="4267911">.</span><span class="ident" id="4267912">Int</span><span class="op" id="4267915">)</span><span class="op" id="4267916">,</span>&nbsp;<span class="builtinfunc" id="4267918">new</span><span class="op" id="4267921">(</span><span class="ident" id="4267922">big</span><span class="op" id="4267925">.</span><span class="ident" id="4267926">Int</span><span class="op" id="4267929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4267932">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267936">p224Invert</span><span class="op" id="4267946">(</span><span class="op" id="4267947">&amp;</span><span class="ident" id="4267948">zinv</span><span class="op" id="4267952">,</span>&nbsp;<span class="ident" id="4267954">z</span><span class="op" id="4267955">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267958">p224Square</span><span class="op" id="4267968">(</span><span class="op" id="4267969">&amp;</span><span class="ident" id="4267970">zinvsq</span><span class="op" id="4267976">,</span>&nbsp;<span class="op" id="4267978">&amp;</span><span class="ident" id="4267979">zinv</span><span class="op" id="4267983">,</span>&nbsp;<span class="op" id="4267985">&amp;</span><span class="ident" id="4267986">tmp</span><span class="op" id="4267989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4267992">p224Mul</span><span class="op" id="4267999">(</span><span class="ident" id="4268000">x</span><span class="op" id="4268001">,</span>&nbsp;<span class="ident" id="4268003">x</span><span class="op" id="4268004">,</span>&nbsp;<span class="op" id="4268006">&amp;</span><span class="ident" id="4268007">zinvsq</span><span class="op" id="4268013">,</span>&nbsp;<span class="op" id="4268015">&amp;</span><span class="ident" id="4268016">tmp</span><span class="op" id="4268019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268022">p224Mul</span><span class="op" id="4268029">(</span><span class="op" id="4268030">&amp;</span><span class="ident" id="4268031">zinvsq</span><span class="op" id="4268037">,</span>&nbsp;<span class="op" id="4268039">&amp;</span><span class="ident" id="4268040">zinvsq</span><span class="op" id="4268046">,</span>&nbsp;<span class="op" id="4268048">&amp;</span><span class="ident" id="4268049">zinv</span><span class="op" id="4268053">,</span>&nbsp;<span class="op" id="4268055">&amp;</span><span class="ident" id="4268056">tmp</span><span class="op" id="4268059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268062">p224Mul</span><span class="op" id="4268069">(</span><span class="ident" id="4268070">y</span><span class="op" id="4268071">,</span>&nbsp;<span class="ident" id="4268073">y</span><span class="op" id="4268074">,</span>&nbsp;<span class="op" id="4268076">&amp;</span><span class="ident" id="4268077">zinvsq</span><span class="op" id="4268083">,</span>&nbsp;<span class="op" id="4268085">&amp;</span><span class="ident" id="4268086">tmp</span><span class="op" id="4268089">)</span><br>
<span class="lineno">685</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268093">p224Contract</span><span class="op" id="4268105">(</span><span class="op" id="4268106">&amp;</span><span class="ident" id="4268107">outx</span><span class="op" id="4268111">,</span>&nbsp;<span class="ident" id="4268113">x</span><span class="op" id="4268114">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268117">p224Contract</span><span class="op" id="4268129">(</span><span class="op" id="4268130">&amp;</span><span class="ident" id="4268131">outy</span><span class="op" id="4268135">,</span>&nbsp;<span class="ident" id="4268137">y</span><span class="op" id="4268138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268141">return</span>&nbsp;<span class="ident" id="4268148">p224ToBig</span><span class="op" id="4268157">(</span><span class="op" id="4268158">&amp;</span><span class="ident" id="4268159">outx</span><span class="op" id="4268163">)</span><span class="op" id="4268164">,</span>&nbsp;<span class="ident" id="4268166">p224ToBig</span><span class="op" id="4268175">(</span><span class="op" id="4268176">&amp;</span><span class="ident" id="4268177">outy</span><span class="op" id="4268181">)</span><br>
<span class="lineno"></span><span class="op" id="4268183">}</span><br>
<span class="lineno">690</span><br>
<span class="lineno"></span><span class="comment" id="4268186">//&nbsp;get28BitsFromEnd&nbsp;returns&nbsp;the&nbsp;least-significant&nbsp;28&nbsp;bits&nbsp;from&nbsp;buf&gt;&gt;shift,</span><br>
<span class="lineno"></span><span class="comment" id="4268261">//&nbsp;where&nbsp;buf&nbsp;is&nbsp;interpreted&nbsp;as&nbsp;a&nbsp;big-endian&nbsp;number.</span><br>
<span class="lineno"></span><span class="keyword" id="4268313">func</span>&nbsp;<span class="ident" id="4268318">get28BitsFromEnd</span><span class="op" id="4268334">(</span><span class="ident" id="4268335">buf</span>&nbsp;<span class="op" id="4268339">[</span><span class="op" id="4268340">]</span><span class="builtintype" id="4268341">byte</span><span class="op" id="4268345">,</span>&nbsp;<span class="ident" id="4268347">shift</span>&nbsp;<span class="builtintype" id="4268353">uint</span><span class="op" id="4268357">)</span>&nbsp;<span class="op" id="4268359">(</span><span class="builtintype" id="4268360">uint32</span><span class="op" id="4268366">,</span>&nbsp;<span class="op" id="4268368">[</span><span class="op" id="4268369">]</span><span class="builtintype" id="4268370">byte</span><span class="op" id="4268374">)</span>&nbsp;<span class="op" id="4268376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268379">var</span>&nbsp;<span class="ident" id="4268383">ret</span>&nbsp;<span class="builtintype" id="4268387">uint32</span><br>
<span class="lineno">695</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268396">for</span>&nbsp;<span class="ident" id="4268400">i</span>&nbsp;<span class="op" id="4268402">:=</span>&nbsp;<span class="builtintype" id="4268405">uint</span><span class="op" id="4268409">(</span><span class="num" id="4268410">0</span><span class="op" id="4268411">)</span><span class="op" id="4268412">;</span>&nbsp;<span class="ident" id="4268414">i</span>&nbsp;<span class="op" id="4268416">&lt;</span>&nbsp;<span class="num" id="4268418">4</span><span class="op" id="4268419">;</span>&nbsp;<span class="ident" id="4268421">i</span><span class="op" id="4268422">++</span>&nbsp;<span class="op" id="4268425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268429">var</span>&nbsp;<span class="ident" id="4268433">b</span>&nbsp;<span class="builtintype" id="4268435">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268442">if</span>&nbsp;<span class="ident" id="4268445">l</span>&nbsp;<span class="op" id="4268447">:=</span>&nbsp;<span class="builtinfunc" id="4268450">len</span><span class="op" id="4268453">(</span><span class="ident" id="4268454">buf</span><span class="op" id="4268457">)</span><span class="op" id="4268458">;</span>&nbsp;<span class="ident" id="4268460">l</span>&nbsp;<span class="op" id="4268462">&gt;</span>&nbsp;<span class="num" id="4268464">0</span>&nbsp;<span class="op" id="4268466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268471">b</span>&nbsp;<span class="op" id="4268473">=</span>&nbsp;<span class="ident" id="4268475">buf</span><span class="op" id="4268478">[</span><span class="ident" id="4268479">l</span><span class="op" id="4268480">-</span><span class="num" id="4268481">1</span><span class="op" id="4268482">]</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4268487">//&nbsp;We&nbsp;don&#39;t&nbsp;remove&nbsp;the&nbsp;byte&nbsp;if&nbsp;we&#39;re&nbsp;about&nbsp;to&nbsp;return&nbsp;and&nbsp;we&#39;re&nbsp;not</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4268557">//&nbsp;reading&nbsp;all&nbsp;of&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268582">if</span>&nbsp;<span class="ident" id="4268585">i</span>&nbsp;<span class="op" id="4268587">!=</span>&nbsp;<span class="num" id="4268590">3</span>&nbsp;<span class="op" id="4268592">||</span>&nbsp;<span class="ident" id="4268595">shift</span>&nbsp;<span class="op" id="4268601">==</span>&nbsp;<span class="num" id="4268604">4</span>&nbsp;<span class="op" id="4268606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268612">buf</span>&nbsp;<span class="op" id="4268616">=</span>&nbsp;<span class="ident" id="4268618">buf</span><span class="op" id="4268621">[</span><span class="op" id="4268622">:</span><span class="ident" id="4268623">l</span><span class="op" id="4268624">-</span><span class="num" id="4268625">1</span><span class="op" id="4268626">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4268631">}</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4268635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268639">ret</span>&nbsp;<span class="op" id="4268643">|=</span>&nbsp;<span class="builtintype" id="4268646">uint32</span><span class="op" id="4268652">(</span><span class="ident" id="4268653">b</span><span class="op" id="4268654">)</span>&nbsp;<span class="op" id="4268656">&lt;&lt;</span>&nbsp;<span class="op" id="4268659">(</span><span class="num" id="4268660">8</span>&nbsp;<span class="op" id="4268662">*</span>&nbsp;<span class="ident" id="4268664">i</span><span class="op" id="4268665">)</span>&nbsp;<span class="op" id="4268667">&gt;&gt;</span>&nbsp;<span class="ident" id="4268670">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4268677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268680">ret</span>&nbsp;<span class="op" id="4268684">&amp;=</span>&nbsp;<span class="ident" id="4268687">bottom28Bits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4268701">return</span>&nbsp;<span class="ident" id="4268708">ret</span><span class="op" id="4268711">,</span>&nbsp;<span class="ident" id="4268713">buf</span><br>
<span class="lineno">710</span><span class="op" id="4268717">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4268720">//&nbsp;p224FromBig&nbsp;sets&nbsp;*out&nbsp;=&nbsp;*in.</span><br>
<span class="lineno"></span><span class="keyword" id="4268752">func</span>&nbsp;<span class="ident" id="4268757">p224FromBig</span><span class="op" id="4268768">(</span><span class="ident" id="4268769">out</span>&nbsp;<span class="op" id="4268773">*</span><span class="ident" id="4268774">p224FieldElement</span><span class="op" id="4268790">,</span>&nbsp;<span class="ident" id="4268792">in</span>&nbsp;<span class="op" id="4268795">*</span><span class="ident" id="4268796">big</span><span class="op" id="4268799">.</span><span class="ident" id="4268800">Int</span><span class="op" id="4268803">)</span>&nbsp;<span class="op" id="4268805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268808">bytes</span>&nbsp;<span class="op" id="4268814">:=</span>&nbsp;<span class="ident" id="4268817">in</span><span class="op" id="4268819">.</span><span class="ident" id="4268820">Bytes</span><span class="op" id="4268825">(</span><span class="op" id="4268826">)</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268829">out</span><span class="op" id="4268832">[</span><span class="num" id="4268833">0</span><span class="op" id="4268834">]</span><span class="op" id="4268835">,</span>&nbsp;<span class="ident" id="4268837">bytes</span>&nbsp;<span class="op" id="4268843">=</span>&nbsp;<span class="ident" id="4268845">get28BitsFromEnd</span><span class="op" id="4268861">(</span><span class="ident" id="4268862">bytes</span><span class="op" id="4268867">,</span>&nbsp;<span class="num" id="4268869">0</span><span class="op" id="4268870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268873">out</span><span class="op" id="4268876">[</span><span class="num" id="4268877">1</span><span class="op" id="4268878">]</span><span class="op" id="4268879">,</span>&nbsp;<span class="ident" id="4268881">bytes</span>&nbsp;<span class="op" id="4268887">=</span>&nbsp;<span class="ident" id="4268889">get28BitsFromEnd</span><span class="op" id="4268905">(</span><span class="ident" id="4268906">bytes</span><span class="op" id="4268911">,</span>&nbsp;<span class="num" id="4268913">4</span><span class="op" id="4268914">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268917">out</span><span class="op" id="4268920">[</span><span class="num" id="4268921">2</span><span class="op" id="4268922">]</span><span class="op" id="4268923">,</span>&nbsp;<span class="ident" id="4268925">bytes</span>&nbsp;<span class="op" id="4268931">=</span>&nbsp;<span class="ident" id="4268933">get28BitsFromEnd</span><span class="op" id="4268949">(</span><span class="ident" id="4268950">bytes</span><span class="op" id="4268955">,</span>&nbsp;<span class="num" id="4268957">0</span><span class="op" id="4268958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4268961">out</span><span class="op" id="4268964">[</span><span class="num" id="4268965">3</span><span class="op" id="4268966">]</span><span class="op" id="4268967">,</span>&nbsp;<span class="ident" id="4268969">bytes</span>&nbsp;<span class="op" id="4268975">=</span>&nbsp;<span class="ident" id="4268977">get28BitsFromEnd</span><span class="op" id="4268993">(</span><span class="ident" id="4268994">bytes</span><span class="op" id="4268999">,</span>&nbsp;<span class="num" id="4269001">4</span><span class="op" id="4269002">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269005">out</span><span class="op" id="4269008">[</span><span class="num" id="4269009">4</span><span class="op" id="4269010">]</span><span class="op" id="4269011">,</span>&nbsp;<span class="ident" id="4269013">bytes</span>&nbsp;<span class="op" id="4269019">=</span>&nbsp;<span class="ident" id="4269021">get28BitsFromEnd</span><span class="op" id="4269037">(</span><span class="ident" id="4269038">bytes</span><span class="op" id="4269043">,</span>&nbsp;<span class="num" id="4269045">0</span><span class="op" id="4269046">)</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269049">out</span><span class="op" id="4269052">[</span><span class="num" id="4269053">5</span><span class="op" id="4269054">]</span><span class="op" id="4269055">,</span>&nbsp;<span class="ident" id="4269057">bytes</span>&nbsp;<span class="op" id="4269063">=</span>&nbsp;<span class="ident" id="4269065">get28BitsFromEnd</span><span class="op" id="4269081">(</span><span class="ident" id="4269082">bytes</span><span class="op" id="4269087">,</span>&nbsp;<span class="num" id="4269089">4</span><span class="op" id="4269090">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269093">out</span><span class="op" id="4269096">[</span><span class="num" id="4269097">6</span><span class="op" id="4269098">]</span><span class="op" id="4269099">,</span>&nbsp;<span class="ident" id="4269101">bytes</span>&nbsp;<span class="op" id="4269107">=</span>&nbsp;<span class="ident" id="4269109">get28BitsFromEnd</span><span class="op" id="4269125">(</span><span class="ident" id="4269126">bytes</span><span class="op" id="4269131">,</span>&nbsp;<span class="num" id="4269133">0</span><span class="op" id="4269134">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269137">out</span><span class="op" id="4269140">[</span><span class="num" id="4269141">7</span><span class="op" id="4269142">]</span><span class="op" id="4269143">,</span>&nbsp;<span class="ident" id="4269145">bytes</span>&nbsp;<span class="op" id="4269151">=</span>&nbsp;<span class="ident" id="4269153">get28BitsFromEnd</span><span class="op" id="4269169">(</span><span class="ident" id="4269170">bytes</span><span class="op" id="4269175">,</span>&nbsp;<span class="num" id="4269177">4</span><span class="op" id="4269178">)</span><br>
<span class="lineno"></span><span class="op" id="4269180">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span><span class="comment" id="4269183">//&nbsp;p224ToBig&nbsp;returns&nbsp;in&nbsp;as&nbsp;a&nbsp;big.Int.</span><br>
<span class="lineno"></span><span class="keyword" id="4269221">func</span>&nbsp;<span class="ident" id="4269226">p224ToBig</span><span class="op" id="4269235">(</span><span class="ident" id="4269236">in</span>&nbsp;<span class="op" id="4269239">*</span><span class="ident" id="4269240">p224FieldElement</span><span class="op" id="4269256">)</span>&nbsp;<span class="op" id="4269258">*</span><span class="ident" id="4269259">big</span><span class="op" id="4269262">.</span><span class="ident" id="4269263">Int</span>&nbsp;<span class="op" id="4269267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4269270">var</span>&nbsp;<span class="ident" id="4269274">buf</span>&nbsp;<span class="op" id="4269278">[</span><span class="num" id="4269279">28</span><span class="op" id="4269281">]</span><span class="builtintype" id="4269282">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269288">buf</span><span class="op" id="4269291">[</span><span class="num" id="4269292">27</span><span class="op" id="4269294">]</span>&nbsp;<span class="op" id="4269296">=</span>&nbsp;<span class="builtintype" id="4269298">byte</span><span class="op" id="4269302">(</span><span class="ident" id="4269303">in</span><span class="op" id="4269305">[</span><span class="num" id="4269306">0</span><span class="op" id="4269307">]</span><span class="op" id="4269308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269311">buf</span><span class="op" id="4269314">[</span><span class="num" id="4269315">26</span><span class="op" id="4269317">]</span>&nbsp;<span class="op" id="4269319">=</span>&nbsp;<span class="builtintype" id="4269321">byte</span><span class="op" id="4269325">(</span><span class="ident" id="4269326">in</span><span class="op" id="4269328">[</span><span class="num" id="4269329">0</span><span class="op" id="4269330">]</span>&nbsp;<span class="op" id="4269332">&gt;&gt;</span>&nbsp;<span class="num" id="4269335">8</span><span class="op" id="4269336">)</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269339">buf</span><span class="op" id="4269342">[</span><span class="num" id="4269343">25</span><span class="op" id="4269345">]</span>&nbsp;<span class="op" id="4269347">=</span>&nbsp;<span class="builtintype" id="4269349">byte</span><span class="op" id="4269353">(</span><span class="ident" id="4269354">in</span><span class="op" id="4269356">[</span><span class="num" id="4269357">0</span><span class="op" id="4269358">]</span>&nbsp;<span class="op" id="4269360">&gt;&gt;</span>&nbsp;<span class="num" id="4269363">16</span><span class="op" id="4269365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269368">buf</span><span class="op" id="4269371">[</span><span class="num" id="4269372">24</span><span class="op" id="4269374">]</span>&nbsp;<span class="op" id="4269376">=</span>&nbsp;<span class="builtintype" id="4269378">byte</span><span class="op" id="4269382">(</span><span class="op" id="4269383">(</span><span class="op" id="4269384">(</span><span class="ident" id="4269385">in</span><span class="op" id="4269387">[</span><span class="num" id="4269388">0</span><span class="op" id="4269389">]</span>&nbsp;<span class="op" id="4269391">&gt;&gt;</span>&nbsp;<span class="num" id="4269394">24</span><span class="op" id="4269396">)</span>&nbsp;<span class="op" id="4269398">&amp;</span>&nbsp;<span class="num" id="4269400">0x0f</span><span class="op" id="4269404">)</span>&nbsp;<span class="op" id="4269406">|</span>&nbsp;<span class="op" id="4269408">(</span><span class="ident" id="4269409">in</span><span class="op" id="4269411">[</span><span class="num" id="4269412">1</span><span class="op" id="4269413">]</span><span class="op" id="4269414">&lt;&lt;</span><span class="num" id="4269416">4</span><span class="op" id="4269417">)</span><span class="op" id="4269418">&amp;</span><span class="num" id="4269419">0xf0</span><span class="op" id="4269423">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269427">buf</span><span class="op" id="4269430">[</span><span class="num" id="4269431">23</span><span class="op" id="4269433">]</span>&nbsp;<span class="op" id="4269435">=</span>&nbsp;<span class="builtintype" id="4269437">byte</span><span class="op" id="4269441">(</span><span class="ident" id="4269442">in</span><span class="op" id="4269444">[</span><span class="num" id="4269445">1</span><span class="op" id="4269446">]</span>&nbsp;<span class="op" id="4269448">&gt;&gt;</span>&nbsp;<span class="num" id="4269451">4</span><span class="op" id="4269452">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269455">buf</span><span class="op" id="4269458">[</span><span class="num" id="4269459">22</span><span class="op" id="4269461">]</span>&nbsp;<span class="op" id="4269463">=</span>&nbsp;<span class="builtintype" id="4269465">byte</span><span class="op" id="4269469">(</span><span class="ident" id="4269470">in</span><span class="op" id="4269472">[</span><span class="num" id="4269473">1</span><span class="op" id="4269474">]</span>&nbsp;<span class="op" id="4269476">&gt;&gt;</span>&nbsp;<span class="num" id="4269479">12</span><span class="op" id="4269481">)</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269484">buf</span><span class="op" id="4269487">[</span><span class="num" id="4269488">21</span><span class="op" id="4269490">]</span>&nbsp;<span class="op" id="4269492">=</span>&nbsp;<span class="builtintype" id="4269494">byte</span><span class="op" id="4269498">(</span><span class="ident" id="4269499">in</span><span class="op" id="4269501">[</span><span class="num" id="4269502">1</span><span class="op" id="4269503">]</span>&nbsp;<span class="op" id="4269505">&gt;&gt;</span>&nbsp;<span class="num" id="4269508">20</span><span class="op" id="4269510">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269514">buf</span><span class="op" id="4269517">[</span><span class="num" id="4269518">20</span><span class="op" id="4269520">]</span>&nbsp;<span class="op" id="4269522">=</span>&nbsp;<span class="builtintype" id="4269524">byte</span><span class="op" id="4269528">(</span><span class="ident" id="4269529">in</span><span class="op" id="4269531">[</span><span class="num" id="4269532">2</span><span class="op" id="4269533">]</span><span class="op" id="4269534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269537">buf</span><span class="op" id="4269540">[</span><span class="num" id="4269541">19</span><span class="op" id="4269543">]</span>&nbsp;<span class="op" id="4269545">=</span>&nbsp;<span class="builtintype" id="4269547">byte</span><span class="op" id="4269551">(</span><span class="ident" id="4269552">in</span><span class="op" id="4269554">[</span><span class="num" id="4269555">2</span><span class="op" id="4269556">]</span>&nbsp;<span class="op" id="4269558">&gt;&gt;</span>&nbsp;<span class="num" id="4269561">8</span><span class="op" id="4269562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269565">buf</span><span class="op" id="4269568">[</span><span class="num" id="4269569">18</span><span class="op" id="4269571">]</span>&nbsp;<span class="op" id="4269573">=</span>&nbsp;<span class="builtintype" id="4269575">byte</span><span class="op" id="4269579">(</span><span class="ident" id="4269580">in</span><span class="op" id="4269582">[</span><span class="num" id="4269583">2</span><span class="op" id="4269584">]</span>&nbsp;<span class="op" id="4269586">&gt;&gt;</span>&nbsp;<span class="num" id="4269589">16</span><span class="op" id="4269591">)</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269594">buf</span><span class="op" id="4269597">[</span><span class="num" id="4269598">17</span><span class="op" id="4269600">]</span>&nbsp;<span class="op" id="4269602">=</span>&nbsp;<span class="builtintype" id="4269604">byte</span><span class="op" id="4269608">(</span><span class="op" id="4269609">(</span><span class="op" id="4269610">(</span><span class="ident" id="4269611">in</span><span class="op" id="4269613">[</span><span class="num" id="4269614">2</span><span class="op" id="4269615">]</span>&nbsp;<span class="op" id="4269617">&gt;&gt;</span>&nbsp;<span class="num" id="4269620">24</span><span class="op" id="4269622">)</span>&nbsp;<span class="op" id="4269624">&amp;</span>&nbsp;<span class="num" id="4269626">0x0f</span><span class="op" id="4269630">)</span>&nbsp;<span class="op" id="4269632">|</span>&nbsp;<span class="op" id="4269634">(</span><span class="ident" id="4269635">in</span><span class="op" id="4269637">[</span><span class="num" id="4269638">3</span><span class="op" id="4269639">]</span><span class="op" id="4269640">&lt;&lt;</span><span class="num" id="4269642">4</span><span class="op" id="4269643">)</span><span class="op" id="4269644">&amp;</span><span class="num" id="4269645">0xf0</span><span class="op" id="4269649">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269653">buf</span><span class="op" id="4269656">[</span><span class="num" id="4269657">16</span><span class="op" id="4269659">]</span>&nbsp;<span class="op" id="4269661">=</span>&nbsp;<span class="builtintype" id="4269663">byte</span><span class="op" id="4269667">(</span><span class="ident" id="4269668">in</span><span class="op" id="4269670">[</span><span class="num" id="4269671">3</span><span class="op" id="4269672">]</span>&nbsp;<span class="op" id="4269674">&gt;&gt;</span>&nbsp;<span class="num" id="4269677">4</span><span class="op" id="4269678">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269681">buf</span><span class="op" id="4269684">[</span><span class="num" id="4269685">15</span><span class="op" id="4269687">]</span>&nbsp;<span class="op" id="4269689">=</span>&nbsp;<span class="builtintype" id="4269691">byte</span><span class="op" id="4269695">(</span><span class="ident" id="4269696">in</span><span class="op" id="4269698">[</span><span class="num" id="4269699">3</span><span class="op" id="4269700">]</span>&nbsp;<span class="op" id="4269702">&gt;&gt;</span>&nbsp;<span class="num" id="4269705">12</span><span class="op" id="4269707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269710">buf</span><span class="op" id="4269713">[</span><span class="num" id="4269714">14</span><span class="op" id="4269716">]</span>&nbsp;<span class="op" id="4269718">=</span>&nbsp;<span class="builtintype" id="4269720">byte</span><span class="op" id="4269724">(</span><span class="ident" id="4269725">in</span><span class="op" id="4269727">[</span><span class="num" id="4269728">3</span><span class="op" id="4269729">]</span>&nbsp;<span class="op" id="4269731">&gt;&gt;</span>&nbsp;<span class="num" id="4269734">20</span><span class="op" id="4269736">)</span><br>
<span class="lineno">745</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269740">buf</span><span class="op" id="4269743">[</span><span class="num" id="4269744">13</span><span class="op" id="4269746">]</span>&nbsp;<span class="op" id="4269748">=</span>&nbsp;<span class="builtintype" id="4269750">byte</span><span class="op" id="4269754">(</span><span class="ident" id="4269755">in</span><span class="op" id="4269757">[</span><span class="num" id="4269758">4</span><span class="op" id="4269759">]</span><span class="op" id="4269760">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269763">buf</span><span class="op" id="4269766">[</span><span class="num" id="4269767">12</span><span class="op" id="4269769">]</span>&nbsp;<span class="op" id="4269771">=</span>&nbsp;<span class="builtintype" id="4269773">byte</span><span class="op" id="4269777">(</span><span class="ident" id="4269778">in</span><span class="op" id="4269780">[</span><span class="num" id="4269781">4</span><span class="op" id="4269782">]</span>&nbsp;<span class="op" id="4269784">&gt;&gt;</span>&nbsp;<span class="num" id="4269787">8</span><span class="op" id="4269788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269791">buf</span><span class="op" id="4269794">[</span><span class="num" id="4269795">11</span><span class="op" id="4269797">]</span>&nbsp;<span class="op" id="4269799">=</span>&nbsp;<span class="builtintype" id="4269801">byte</span><span class="op" id="4269805">(</span><span class="ident" id="4269806">in</span><span class="op" id="4269808">[</span><span class="num" id="4269809">4</span><span class="op" id="4269810">]</span>&nbsp;<span class="op" id="4269812">&gt;&gt;</span>&nbsp;<span class="num" id="4269815">16</span><span class="op" id="4269817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269820">buf</span><span class="op" id="4269823">[</span><span class="num" id="4269824">10</span><span class="op" id="4269826">]</span>&nbsp;<span class="op" id="4269828">=</span>&nbsp;<span class="builtintype" id="4269830">byte</span><span class="op" id="4269834">(</span><span class="op" id="4269835">(</span><span class="op" id="4269836">(</span><span class="ident" id="4269837">in</span><span class="op" id="4269839">[</span><span class="num" id="4269840">4</span><span class="op" id="4269841">]</span>&nbsp;<span class="op" id="4269843">&gt;&gt;</span>&nbsp;<span class="num" id="4269846">24</span><span class="op" id="4269848">)</span>&nbsp;<span class="op" id="4269850">&amp;</span>&nbsp;<span class="num" id="4269852">0x0f</span><span class="op" id="4269856">)</span>&nbsp;<span class="op" id="4269858">|</span>&nbsp;<span class="op" id="4269860">(</span><span class="ident" id="4269861">in</span><span class="op" id="4269863">[</span><span class="num" id="4269864">5</span><span class="op" id="4269865">]</span><span class="op" id="4269866">&lt;&lt;</span><span class="num" id="4269868">4</span><span class="op" id="4269869">)</span><span class="op" id="4269870">&amp;</span><span class="num" id="4269871">0xf0</span><span class="op" id="4269875">)</span><br>
<span class="lineno">750</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269879">buf</span><span class="op" id="4269882">[</span><span class="num" id="4269883">9</span><span class="op" id="4269884">]</span>&nbsp;<span class="op" id="4269886">=</span>&nbsp;<span class="builtintype" id="4269888">byte</span><span class="op" id="4269892">(</span><span class="ident" id="4269893">in</span><span class="op" id="4269895">[</span><span class="num" id="4269896">5</span><span class="op" id="4269897">]</span>&nbsp;<span class="op" id="4269899">&gt;&gt;</span>&nbsp;<span class="num" id="4269902">4</span><span class="op" id="4269903">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269906">buf</span><span class="op" id="4269909">[</span><span class="num" id="4269910">8</span><span class="op" id="4269911">]</span>&nbsp;<span class="op" id="4269913">=</span>&nbsp;<span class="builtintype" id="4269915">byte</span><span class="op" id="4269919">(</span><span class="ident" id="4269920">in</span><span class="op" id="4269922">[</span><span class="num" id="4269923">5</span><span class="op" id="4269924">]</span>&nbsp;<span class="op" id="4269926">&gt;&gt;</span>&nbsp;<span class="num" id="4269929">12</span><span class="op" id="4269931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269934">buf</span><span class="op" id="4269937">[</span><span class="num" id="4269938">7</span><span class="op" id="4269939">]</span>&nbsp;<span class="op" id="4269941">=</span>&nbsp;<span class="builtintype" id="4269943">byte</span><span class="op" id="4269947">(</span><span class="ident" id="4269948">in</span><span class="op" id="4269950">[</span><span class="num" id="4269951">5</span><span class="op" id="4269952">]</span>&nbsp;<span class="op" id="4269954">&gt;&gt;</span>&nbsp;<span class="num" id="4269957">20</span><span class="op" id="4269959">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269963">buf</span><span class="op" id="4269966">[</span><span class="num" id="4269967">6</span><span class="op" id="4269968">]</span>&nbsp;<span class="op" id="4269970">=</span>&nbsp;<span class="builtintype" id="4269972">byte</span><span class="op" id="4269976">(</span><span class="ident" id="4269977">in</span><span class="op" id="4269979">[</span><span class="num" id="4269980">6</span><span class="op" id="4269981">]</span><span class="op" id="4269982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4269985">buf</span><span class="op" id="4269988">[</span><span class="num" id="4269989">5</span><span class="op" id="4269990">]</span>&nbsp;<span class="op" id="4269992">=</span>&nbsp;<span class="builtintype" id="4269994">byte</span><span class="op" id="4269998">(</span><span class="ident" id="4269999">in</span><span class="op" id="4270001">[</span><span class="num" id="4270002">6</span><span class="op" id="4270003">]</span>&nbsp;<span class="op" id="4270005">&gt;&gt;</span>&nbsp;<span class="num" id="4270008">8</span><span class="op" id="4270009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4270012">buf</span><span class="op" id="4270015">[</span><span class="num" id="4270016">4</span><span class="op" id="4270017">]</span>&nbsp;<span class="op" id="4270019">=</span>&nbsp;<span class="builtintype" id="4270021">byte</span><span class="op" id="4270025">(</span><span class="ident" id="4270026">in</span><span class="op" id="4270028">[</span><span class="num" id="4270029">6</span><span class="op" id="4270030">]</span>&nbsp;<span class="op" id="4270032">&gt;&gt;</span>&nbsp;<span class="num" id="4270035">16</span><span class="op" id="4270037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4270040">buf</span><span class="op" id="4270043">[</span><span class="num" id="4270044">3</span><span class="op" id="4270045">]</span>&nbsp;<span class="op" id="4270047">=</span>&nbsp;<span class="builtintype" id="4270049">byte</span><span class="op" id="4270053">(</span><span class="op" id="4270054">(</span><span class="op" id="4270055">(</span><span class="ident" id="4270056">in</span><span class="op" id="4270058">[</span><span class="num" id="4270059">6</span><span class="op" id="4270060">]</span>&nbsp;<span class="op" id="4270062">&gt;&gt;</span>&nbsp;<span class="num" id="4270065">24</span><span class="op" id="4270067">)</span>&nbsp;<span class="op" id="4270069">&amp;</span>&nbsp;<span class="num" id="4270071">0x0f</span><span class="op" id="4270075">)</span>&nbsp;<span class="op" id="4270077">|</span>&nbsp;<span class="op" id="4270079">(</span><span class="ident" id="4270080">in</span><span class="op" id="4270082">[</span><span class="num" id="4270083">7</span><span class="op" id="4270084">]</span><span class="op" id="4270085">&lt;&lt;</span><span class="num" id="4270087">4</span><span class="op" id="4270088">)</span><span class="op" id="4270089">&amp;</span><span class="num" id="4270090">0xf0</span><span class="op" id="4270094">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4270098">buf</span><span class="op" id="4270101">[</span><span class="num" id="4270102">2</span><span class="op" id="4270103">]</span>&nbsp;<span class="op" id="4270105">=</span>&nbsp;<span class="builtintype" id="4270107">byte</span><span class="op" id="4270111">(</span><span class="ident" id="4270112">in</span><span class="op" id="4270114">[</span><span class="num" id="4270115">7</span><span class="op" id="4270116">]</span>&nbsp;<span class="op" id="4270118">&gt;&gt;</span>&nbsp;<span class="num" id="4270121">4</span><span class="op" id="4270122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4270125">buf</span><span class="op" id="4270128">[</span><span class="num" id="4270129">1</span><span class="op" id="4270130">]</span>&nbsp;<span class="op" id="4270132">=</span>&nbsp;<span class="builtintype" id="4270134">byte</span><span class="op" id="4270138">(</span><span class="ident" id="4270139">in</span><span class="op" id="4270141">[</span><span class="num" id="4270142">7</span><span class="op" id="4270143">]</span>&nbsp;<span class="op" id="4270145">&gt;&gt;</span>&nbsp;<span class="num" id="4270148">12</span><span class="op" id="4270150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4270153">buf</span><span class="op" id="4270156">[</span><span class="num" id="4270157">0</span><span class="op" id="4270158">]</span>&nbsp;<span class="op" id="4270160">=</span>&nbsp;<span class="builtintype" id="4270162">byte</span><span class="op" id="4270166">(</span><span class="ident" id="4270167">in</span><span class="op" id="4270169">[</span><span class="num" id="4270170">7</span><span class="op" id="4270171">]</span>&nbsp;<span class="op" id="4270173">&gt;&gt;</span>&nbsp;<span class="num" id="4270176">20</span><span class="op" id="4270178">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4270182">return</span>&nbsp;<span class="builtinfunc" id="4270189">new</span><span class="op" id="4270192">(</span><span class="ident" id="4270193">big</span><span class="op" id="4270196">.</span><span class="ident" id="4270197">Int</span><span class="op" id="4270200">)</span><span class="op" id="4270201">.</span><span class="ident" id="4270202">SetBytes</span><span class="op" id="4270210">(</span><span class="ident" id="4270211">buf</span><span class="op" id="4270214">[</span><span class="op" id="4270215">:</span><span class="op" id="4270216">]</span><span class="op" id="4270217">)</span><br>
<span class="lineno">765</span><span class="op" id="4270219">}</span>
</div>
</body>
</html>
