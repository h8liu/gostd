<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template</h2>
<ul>
<li><a href="/gostd/text/template/doc.go.html">doc.go</a></li>
<li><a href="/gostd/text/template/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/text/template/examplefiles_test.go.html">examplefiles_test.go</a></li>
<li><a href="/gostd/text/template/examplefunc_test.go.html">examplefunc_test.go</a></li>
<li><a href="/gostd/text/template/exec.go.html">exec.go</a></li>
<li><a href="/gostd/text/template/exec_test.go.html">exec_test.go</a></li>
<li><a href="/gostd/text/template/funcs.go.html">funcs.go</a></li>
<li><a href="/gostd/text/template/helper.go.html">helper.go</a></li>
<li><a href="/gostd/text/template/multi_test.go.html">multi_test.go</a></li>
<li><a href="/gostd/text/template/template.go.html">template.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5713844">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5713899">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5713953">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5714004">package</span>&nbsp;<span class="ident" id="5714012">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5714022">import</span>&nbsp;<span class="op" id="5714029">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714032">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714041">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714051">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714058">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714064">&#34;net/url&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714075">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714086">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714097">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714108">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5714123">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5714126">//&nbsp;FuncMap&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;map&nbsp;defining&nbsp;the&nbsp;mapping&nbsp;from&nbsp;names&nbsp;to&nbsp;functions.</span><br>
<span class="lineno">20</span><span class="comment" id="5714206">//&nbsp;Each&nbsp;function&nbsp;must&nbsp;have&nbsp;either&nbsp;a&nbsp;single&nbsp;return&nbsp;value,&nbsp;or&nbsp;two&nbsp;return&nbsp;values&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5714287">//&nbsp;which&nbsp;the&nbsp;second&nbsp;has&nbsp;type&nbsp;error.&nbsp;In&nbsp;that&nbsp;case,&nbsp;if&nbsp;the&nbsp;second&nbsp;(error)</span><br>
<span class="lineno"></span><span class="comment" id="5714359">//&nbsp;return&nbsp;value&nbsp;evaluates&nbsp;to&nbsp;non-nil&nbsp;during&nbsp;execution,&nbsp;execution&nbsp;terminates&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="5714439">//&nbsp;Execute&nbsp;returns&nbsp;that&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5714470">type</span>&nbsp;<span class="ident" id="5714475">FuncMap</span>&nbsp;<span class="keyword" id="5714483">map</span><span class="op" id="5714486">[</span><span class="builtintype" id="5714487">string</span><span class="op" id="5714493">]</span><span class="keyword" id="5714494">interface</span><span class="op" id="5714503">{</span><span class="op" id="5714504">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="5714507">var</span>&nbsp;<span class="ident" id="5714511">builtins</span>&nbsp;<span class="op" id="5714520">=</span>&nbsp;<span class="ident" id="5714522">FuncMap</span><span class="op" id="5714529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714532">&#34;and&#34;</span><span class="op" id="5714537">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714544">and</span><span class="op" id="5714547">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714550">&#34;call&#34;</span><span class="op" id="5714556">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714562">call</span><span class="op" id="5714566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714569">&#34;html&#34;</span><span class="op" id="5714575">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714581">HTMLEscaper</span><span class="op" id="5714592">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714595">&#34;index&#34;</span><span class="op" id="5714602">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714607">index</span><span class="op" id="5714612">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714615">&#34;js&#34;</span><span class="op" id="5714619">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714627">JSEscaper</span><span class="op" id="5714636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714639">&#34;len&#34;</span><span class="op" id="5714644">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714651">length</span><span class="op" id="5714657">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714660">&#34;not&#34;</span><span class="op" id="5714665">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714672">not</span><span class="op" id="5714675">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714678">&#34;or&#34;</span><span class="op" id="5714682">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714690">or</span><span class="op" id="5714692">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714695">&#34;print&#34;</span><span class="op" id="5714702">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5714707">fmt</span><span class="op" id="5714710">.</span><span class="ident" id="5714711">Sprint</span><span class="op" id="5714717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714720">&#34;printf&#34;</span><span class="op" id="5714728">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="5714732">fmt</span><span class="op" id="5714735">.</span><span class="ident" id="5714736">Sprintf</span><span class="op" id="5714743">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714746">&#34;println&#34;</span><span class="op" id="5714755">:</span>&nbsp;&nbsp;<span class="ident" id="5714758">fmt</span><span class="op" id="5714761">.</span><span class="ident" id="5714762">Sprintln</span><span class="op" id="5714770">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714773">&#34;urlquery&#34;</span><span class="op" id="5714783">:</span>&nbsp;<span class="ident" id="5714785">URLQueryEscaper</span><span class="op" id="5714800">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5714804">//&nbsp;Comparisons</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714820">&#34;eq&#34;</span><span class="op" id="5714824">:</span>&nbsp;<span class="ident" id="5714826">eq</span><span class="op" id="5714828">,</span>&nbsp;<span class="comment" id="5714830">//&nbsp;==</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714837">&#34;ge&#34;</span><span class="op" id="5714841">:</span>&nbsp;<span class="ident" id="5714843">ge</span><span class="op" id="5714845">,</span>&nbsp;<span class="comment" id="5714847">//&nbsp;&gt;=</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714854">&#34;gt&#34;</span><span class="op" id="5714858">:</span>&nbsp;<span class="ident" id="5714860">gt</span><span class="op" id="5714862">,</span>&nbsp;<span class="comment" id="5714864">//&nbsp;&gt;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714870">&#34;le&#34;</span><span class="op" id="5714874">:</span>&nbsp;<span class="ident" id="5714876">le</span><span class="op" id="5714878">,</span>&nbsp;<span class="comment" id="5714880">//&nbsp;&lt;=</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714887">&#34;lt&#34;</span><span class="op" id="5714891">:</span>&nbsp;<span class="ident" id="5714893">lt</span><span class="op" id="5714895">,</span>&nbsp;<span class="comment" id="5714897">//&nbsp;&lt;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5714903">&#34;ne&#34;</span><span class="op" id="5714907">:</span>&nbsp;<span class="ident" id="5714909">ne</span><span class="op" id="5714911">,</span>&nbsp;<span class="comment" id="5714913">//&nbsp;!=</span><br>
<span class="lineno"></span><span class="op" id="5714919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5714922">var</span>&nbsp;<span class="ident" id="5714926">builtinFuncs</span>&nbsp;<span class="op" id="5714939">=</span>&nbsp;<span class="ident" id="5714941">createValueFuncs</span><span class="op" id="5714957">(</span><span class="ident" id="5714958">builtins</span><span class="op" id="5714966">)</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="5714969">//&nbsp;createValueFuncs&nbsp;turns&nbsp;a&nbsp;FuncMap&nbsp;into&nbsp;a&nbsp;map[string]reflect.Value</span><br>
<span class="lineno"></span><span class="keyword" id="5715037">func</span>&nbsp;<span class="ident" id="5715042">createValueFuncs</span><span class="op" id="5715058">(</span><span class="ident" id="5715059">funcMap</span>&nbsp;<span class="ident" id="5715067">FuncMap</span><span class="op" id="5715074">)</span>&nbsp;<span class="keyword" id="5715076">map</span><span class="op" id="5715079">[</span><span class="builtintype" id="5715080">string</span><span class="op" id="5715086">]</span><span class="ident" id="5715087">reflect</span><span class="op" id="5715094">.</span><span class="ident" id="5715095">Value</span>&nbsp;<span class="op" id="5715101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715104">m</span>&nbsp;<span class="op" id="5715106">:=</span>&nbsp;<span class="builtinfunc" id="5715109">make</span><span class="op" id="5715113">(</span><span class="keyword" id="5715114">map</span><span class="op" id="5715117">[</span><span class="builtintype" id="5715118">string</span><span class="op" id="5715124">]</span><span class="ident" id="5715125">reflect</span><span class="op" id="5715132">.</span><span class="ident" id="5715133">Value</span><span class="op" id="5715138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715141">addValueFuncs</span><span class="op" id="5715154">(</span><span class="ident" id="5715155">m</span><span class="op" id="5715156">,</span>&nbsp;<span class="ident" id="5715158">funcMap</span><span class="op" id="5715165">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715168">return</span>&nbsp;<span class="ident" id="5715175">m</span><br>
<span class="lineno"></span><span class="op" id="5715177">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5715180">//&nbsp;addValueFuncs&nbsp;adds&nbsp;to&nbsp;values&nbsp;the&nbsp;functions&nbsp;in&nbsp;funcs,&nbsp;converting&nbsp;them&nbsp;to&nbsp;reflect.Values.</span><br>
<span class="lineno"></span><span class="keyword" id="5715271">func</span>&nbsp;<span class="ident" id="5715276">addValueFuncs</span><span class="op" id="5715289">(</span><span class="ident" id="5715290">out</span>&nbsp;<span class="keyword" id="5715294">map</span><span class="op" id="5715297">[</span><span class="builtintype" id="5715298">string</span><span class="op" id="5715304">]</span><span class="ident" id="5715305">reflect</span><span class="op" id="5715312">.</span><span class="ident" id="5715313">Value</span><span class="op" id="5715318">,</span>&nbsp;<span class="ident" id="5715320">in</span>&nbsp;<span class="ident" id="5715323">FuncMap</span><span class="op" id="5715330">)</span>&nbsp;<span class="op" id="5715332">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715335">for</span>&nbsp;<span class="ident" id="5715339">name</span><span class="op" id="5715343">,</span>&nbsp;<span class="ident" id="5715345">fn</span>&nbsp;<span class="op" id="5715348">:=</span>&nbsp;<span class="keyword" id="5715351">range</span>&nbsp;<span class="ident" id="5715357">in</span>&nbsp;<span class="op" id="5715360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715364">v</span>&nbsp;<span class="op" id="5715366">:=</span>&nbsp;<span class="ident" id="5715369">reflect</span><span class="op" id="5715376">.</span><span class="ident" id="5715377">ValueOf</span><span class="op" id="5715384">(</span><span class="ident" id="5715385">fn</span><span class="op" id="5715387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715391">if</span>&nbsp;<span class="ident" id="5715394">v</span><span class="op" id="5715395">.</span><span class="ident" id="5715396">Kind</span><span class="op" id="5715400">(</span><span class="op" id="5715401">)</span>&nbsp;<span class="op" id="5715403">!=</span>&nbsp;<span class="ident" id="5715406">reflect</span><span class="op" id="5715413">.</span><span class="ident" id="5715414">Func</span>&nbsp;<span class="op" id="5715419">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5715424">panic</span><span class="op" id="5715429">(</span><span class="string" id="5715430">&#34;value&nbsp;for&nbsp;&#34;</span>&nbsp;<span class="op" id="5715443">+</span>&nbsp;<span class="ident" id="5715445">name</span>&nbsp;<span class="op" id="5715450">+</span>&nbsp;<span class="string" id="5715452">&#34;&nbsp;not&nbsp;a&nbsp;function&#34;</span><span class="op" id="5715469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715473">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715477">if</span>&nbsp;<span class="op" id="5715480">!</span><span class="ident" id="5715481">goodFunc</span><span class="op" id="5715489">(</span><span class="ident" id="5715490">v</span><span class="op" id="5715491">.</span><span class="ident" id="5715492">Type</span><span class="op" id="5715496">(</span><span class="op" id="5715497">)</span><span class="op" id="5715498">)</span>&nbsp;<span class="op" id="5715500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5715505">panic</span><span class="op" id="5715510">(</span><span class="ident" id="5715511">fmt</span><span class="op" id="5715514">.</span><span class="ident" id="5715515">Errorf</span><span class="op" id="5715521">(</span><span class="string" id="5715522">&#34;can&#39;t&nbsp;install&nbsp;method/function&nbsp;%q&nbsp;with&nbsp;%d&nbsp;results&#34;</span><span class="op" id="5715572">,</span>&nbsp;<span class="ident" id="5715574">name</span><span class="op" id="5715578">,</span>&nbsp;<span class="ident" id="5715580">v</span><span class="op" id="5715581">.</span><span class="ident" id="5715582">Type</span><span class="op" id="5715586">(</span><span class="op" id="5715587">)</span><span class="op" id="5715588">.</span><span class="ident" id="5715589">NumOut</span><span class="op" id="5715595">(</span><span class="op" id="5715596">)</span><span class="op" id="5715597">)</span><span class="op" id="5715598">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715606">out</span><span class="op" id="5715609">[</span><span class="ident" id="5715610">name</span><span class="op" id="5715614">]</span>&nbsp;<span class="op" id="5715616">=</span>&nbsp;<span class="ident" id="5715618">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715621">}</span><br>
<span class="lineno">70</span><span class="op" id="5715623">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5715626">//&nbsp;addFuncs&nbsp;adds&nbsp;to&nbsp;values&nbsp;the&nbsp;functions&nbsp;in&nbsp;funcs.&nbsp;It&nbsp;does&nbsp;no&nbsp;checking&nbsp;of&nbsp;the&nbsp;input&nbsp;-</span><br>
<span class="lineno"></span><span class="comment" id="5715712">//&nbsp;call&nbsp;addValueFuncs&nbsp;first.</span><br>
<span class="lineno"></span><span class="keyword" id="5715741">func</span>&nbsp;<span class="ident" id="5715746">addFuncs</span><span class="op" id="5715754">(</span><span class="ident" id="5715755">out</span><span class="op" id="5715758">,</span>&nbsp;<span class="ident" id="5715760">in</span>&nbsp;<span class="ident" id="5715763">FuncMap</span><span class="op" id="5715770">)</span>&nbsp;<span class="op" id="5715772">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5715775">for</span>&nbsp;<span class="ident" id="5715779">name</span><span class="op" id="5715783">,</span>&nbsp;<span class="ident" id="5715785">fn</span>&nbsp;<span class="op" id="5715788">:=</span>&nbsp;<span class="keyword" id="5715791">range</span>&nbsp;<span class="ident" id="5715797">in</span>&nbsp;<span class="op" id="5715800">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5715804">out</span><span class="op" id="5715807">[</span><span class="ident" id="5715808">name</span><span class="op" id="5715812">]</span>&nbsp;<span class="op" id="5715814">=</span>&nbsp;<span class="ident" id="5715816">fn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5715820">}</span><br>
<span class="lineno"></span><span class="op" id="5715822">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="comment" id="5715825">//&nbsp;goodFunc&nbsp;checks&nbsp;that&nbsp;the&nbsp;function&nbsp;or&nbsp;method&nbsp;has&nbsp;the&nbsp;right&nbsp;result&nbsp;signature.</span><br>
<span class="lineno"></span><span class="keyword" id="5715904">func</span>&nbsp;<span class="ident" id="5715909">goodFunc</span><span class="op" id="5715917">(</span><span class="ident" id="5715918">typ</span>&nbsp;<span class="ident" id="5715922">reflect</span><span class="op" id="5715929">.</span><span class="ident" id="5715930">Type</span><span class="op" id="5715934">)</span>&nbsp;<span class="builtintype" id="5715936">bool</span>&nbsp;<span class="op" id="5715941">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5715944">//&nbsp;We&nbsp;allow&nbsp;functions&nbsp;with&nbsp;1&nbsp;result&nbsp;or&nbsp;2&nbsp;results&nbsp;where&nbsp;the&nbsp;second&nbsp;is&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716024">switch</span>&nbsp;<span class="op" id="5716031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716034">case</span>&nbsp;<span class="ident" id="5716039">typ</span><span class="op" id="5716042">.</span><span class="ident" id="5716043">NumOut</span><span class="op" id="5716049">(</span><span class="op" id="5716050">)</span>&nbsp;<span class="op" id="5716052">==</span>&nbsp;<span class="num" id="5716055">1</span><span class="op" id="5716056">:</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716060">return</span>&nbsp;<span class="builtintype" id="5716067">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716073">case</span>&nbsp;<span class="ident" id="5716078">typ</span><span class="op" id="5716081">.</span><span class="ident" id="5716082">NumOut</span><span class="op" id="5716088">(</span><span class="op" id="5716089">)</span>&nbsp;<span class="op" id="5716091">==</span>&nbsp;<span class="num" id="5716094">2</span>&nbsp;<span class="op" id="5716096">&amp;&amp;</span>&nbsp;<span class="ident" id="5716099">typ</span><span class="op" id="5716102">.</span><span class="ident" id="5716103">Out</span><span class="op" id="5716106">(</span><span class="num" id="5716107">1</span><span class="op" id="5716108">)</span>&nbsp;<span class="op" id="5716110">==</span>&nbsp;<span class="ident" id="5716113">errorType</span><span class="op" id="5716122">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716126">return</span>&nbsp;<span class="builtintype" id="5716133">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716139">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716142">return</span>&nbsp;<span class="builtintype" id="5716149">false</span><br>
<span class="lineno">90</span><span class="op" id="5716155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5716158">//&nbsp;findFunction&nbsp;looks&nbsp;for&nbsp;a&nbsp;function&nbsp;in&nbsp;the&nbsp;template,&nbsp;and&nbsp;global&nbsp;map.</span><br>
<span class="lineno"></span><span class="keyword" id="5716228">func</span>&nbsp;<span class="ident" id="5716233">findFunction</span><span class="op" id="5716245">(</span><span class="ident" id="5716246">name</span>&nbsp;<span class="builtintype" id="5716251">string</span><span class="op" id="5716257">,</span>&nbsp;<span class="ident" id="5716259">tmpl</span>&nbsp;<span class="op" id="5716264">*</span><span class="ident" id="5716265">Template</span><span class="op" id="5716273">)</span>&nbsp;<span class="op" id="5716275">(</span><span class="ident" id="5716276">reflect</span><span class="op" id="5716283">.</span><span class="ident" id="5716284">Value</span><span class="op" id="5716289">,</span>&nbsp;<span class="builtintype" id="5716291">bool</span><span class="op" id="5716295">)</span>&nbsp;<span class="op" id="5716297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716300">if</span>&nbsp;<span class="ident" id="5716303">tmpl</span>&nbsp;<span class="op" id="5716308">!=</span>&nbsp;<span class="ident" id="5716311">nil</span>&nbsp;<span class="op" id="5716315">&amp;&amp;</span>&nbsp;<span class="ident" id="5716318">tmpl</span><span class="op" id="5716322">.</span><span class="ident" id="5716323">common</span>&nbsp;<span class="op" id="5716330">!=</span>&nbsp;<span class="ident" id="5716333">nil</span>&nbsp;<span class="op" id="5716337">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716341">if</span>&nbsp;<span class="ident" id="5716344">fn</span>&nbsp;<span class="op" id="5716347">:=</span>&nbsp;<span class="ident" id="5716350">tmpl</span><span class="op" id="5716354">.</span><span class="ident" id="5716355">execFuncs</span><span class="op" id="5716364">[</span><span class="ident" id="5716365">name</span><span class="op" id="5716369">]</span><span class="op" id="5716370">;</span>&nbsp;<span class="ident" id="5716372">fn</span><span class="op" id="5716374">.</span><span class="ident" id="5716375">IsValid</span><span class="op" id="5716382">(</span><span class="op" id="5716383">)</span>&nbsp;<span class="op" id="5716385">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716390">return</span>&nbsp;<span class="ident" id="5716397">fn</span><span class="op" id="5716399">,</span>&nbsp;<span class="builtintype" id="5716401">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716408">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716414">if</span>&nbsp;<span class="ident" id="5716417">fn</span>&nbsp;<span class="op" id="5716420">:=</span>&nbsp;<span class="ident" id="5716423">builtinFuncs</span><span class="op" id="5716435">[</span><span class="ident" id="5716436">name</span><span class="op" id="5716440">]</span><span class="op" id="5716441">;</span>&nbsp;<span class="ident" id="5716443">fn</span><span class="op" id="5716445">.</span><span class="ident" id="5716446">IsValid</span><span class="op" id="5716453">(</span><span class="op" id="5716454">)</span>&nbsp;<span class="op" id="5716456">{</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716460">return</span>&nbsp;<span class="ident" id="5716467">fn</span><span class="op" id="5716469">,</span>&nbsp;<span class="builtintype" id="5716471">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716480">return</span>&nbsp;<span class="ident" id="5716487">reflect</span><span class="op" id="5716494">.</span><span class="ident" id="5716495">Value</span><span class="op" id="5716500">{</span><span class="op" id="5716501">}</span><span class="op" id="5716502">,</span>&nbsp;<span class="builtintype" id="5716504">false</span><br>
<span class="lineno"></span><span class="op" id="5716510">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="comment" id="5716513">//&nbsp;Indexing.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5716527">//&nbsp;index&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;indexing&nbsp;its&nbsp;first&nbsp;argument&nbsp;by&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="5716603">//&nbsp;arguments.&nbsp;&nbsp;Thus&nbsp;&#34;index&nbsp;x&nbsp;1&nbsp;2&nbsp;3&#34;&nbsp;is,&nbsp;in&nbsp;Go&nbsp;syntax,&nbsp;x[1][2][3].&nbsp;Each</span><br>
<span class="lineno"></span><span class="comment" id="5716674">//&nbsp;indexed&nbsp;item&nbsp;must&nbsp;be&nbsp;a&nbsp;map,&nbsp;slice,&nbsp;or&nbsp;array.</span><br>
<span class="lineno">110</span><span class="keyword" id="5716722">func</span>&nbsp;<span class="ident" id="5716727">index</span><span class="op" id="5716732">(</span><span class="ident" id="5716733">item</span>&nbsp;<span class="keyword" id="5716738">interface</span><span class="op" id="5716747">{</span><span class="op" id="5716748">}</span><span class="op" id="5716749">,</span>&nbsp;<span class="ident" id="5716751">indices</span>&nbsp;<span class="op" id="5716759">...</span><span class="keyword" id="5716762">interface</span><span class="op" id="5716771">{</span><span class="op" id="5716772">}</span><span class="op" id="5716773">)</span>&nbsp;<span class="op" id="5716775">(</span><span class="keyword" id="5716776">interface</span><span class="op" id="5716785">{</span><span class="op" id="5716786">}</span><span class="op" id="5716787">,</span>&nbsp;<span class="builtintype" id="5716789">error</span><span class="op" id="5716794">)</span>&nbsp;<span class="op" id="5716796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716799">v</span>&nbsp;<span class="op" id="5716801">:=</span>&nbsp;<span class="ident" id="5716804">reflect</span><span class="op" id="5716811">.</span><span class="ident" id="5716812">ValueOf</span><span class="op" id="5716819">(</span><span class="ident" id="5716820">item</span><span class="op" id="5716824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716827">for</span>&nbsp;<span class="ident" id="5716831">_</span><span class="op" id="5716832">,</span>&nbsp;<span class="ident" id="5716834">i</span>&nbsp;<span class="op" id="5716836">:=</span>&nbsp;<span class="keyword" id="5716839">range</span>&nbsp;<span class="ident" id="5716845">indices</span>&nbsp;<span class="op" id="5716853">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5716857">index</span>&nbsp;<span class="op" id="5716863">:=</span>&nbsp;<span class="ident" id="5716866">reflect</span><span class="op" id="5716873">.</span><span class="ident" id="5716874">ValueOf</span><span class="op" id="5716881">(</span><span class="ident" id="5716882">i</span><span class="op" id="5716883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716887">var</span>&nbsp;<span class="ident" id="5716891">isNil</span>&nbsp;<span class="builtintype" id="5716897">bool</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716904">if</span>&nbsp;<span class="ident" id="5716907">v</span><span class="op" id="5716908">,</span>&nbsp;<span class="ident" id="5716910">isNil</span>&nbsp;<span class="op" id="5716916">=</span>&nbsp;<span class="ident" id="5716918">indirect</span><span class="op" id="5716926">(</span><span class="ident" id="5716927">v</span><span class="op" id="5716928">)</span><span class="op" id="5716929">;</span>&nbsp;<span class="ident" id="5716931">isNil</span>&nbsp;<span class="op" id="5716937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716942">return</span>&nbsp;<span class="ident" id="5716949">nil</span><span class="op" id="5716952">,</span>&nbsp;<span class="ident" id="5716954">fmt</span><span class="op" id="5716957">.</span><span class="ident" id="5716958">Errorf</span><span class="op" id="5716964">(</span><span class="string" id="5716965">&#34;index&nbsp;of&nbsp;nil&nbsp;pointer&#34;</span><span class="op" id="5716987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5716991">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5716995">switch</span>&nbsp;<span class="ident" id="5717002">v</span><span class="op" id="5717003">.</span><span class="ident" id="5717004">Kind</span><span class="op" id="5717008">(</span><span class="op" id="5717009">)</span>&nbsp;<span class="op" id="5717011">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717015">case</span>&nbsp;<span class="ident" id="5717020">reflect</span><span class="op" id="5717027">.</span><span class="ident" id="5717028">Array</span><span class="op" id="5717033">,</span>&nbsp;<span class="ident" id="5717035">reflect</span><span class="op" id="5717042">.</span><span class="ident" id="5717043">Slice</span><span class="op" id="5717048">,</span>&nbsp;<span class="ident" id="5717050">reflect</span><span class="op" id="5717057">.</span><span class="ident" id="5717058">String</span><span class="op" id="5717064">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717069">var</span>&nbsp;<span class="ident" id="5717073">x</span>&nbsp;<span class="ident" id="5717075">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717084">switch</span>&nbsp;<span class="ident" id="5717091">index</span><span class="op" id="5717096">.</span><span class="ident" id="5717097">Kind</span><span class="op" id="5717101">(</span><span class="op" id="5717102">)</span>&nbsp;<span class="op" id="5717104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717109">case</span>&nbsp;<span class="ident" id="5717114">reflect</span><span class="op" id="5717121">.</span><span class="ident" id="5717122">Int</span><span class="op" id="5717125">,</span>&nbsp;<span class="ident" id="5717127">reflect</span><span class="op" id="5717134">.</span><span class="ident" id="5717135">Int8</span><span class="op" id="5717139">,</span>&nbsp;<span class="ident" id="5717141">reflect</span><span class="op" id="5717148">.</span><span class="ident" id="5717149">Int16</span><span class="op" id="5717154">,</span>&nbsp;<span class="ident" id="5717156">reflect</span><span class="op" id="5717163">.</span><span class="ident" id="5717164">Int32</span><span class="op" id="5717169">,</span>&nbsp;<span class="ident" id="5717171">reflect</span><span class="op" id="5717178">.</span><span class="ident" id="5717179">Int64</span><span class="op" id="5717184">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717190">x</span>&nbsp;<span class="op" id="5717192">=</span>&nbsp;<span class="ident" id="5717194">index</span><span class="op" id="5717199">.</span><span class="ident" id="5717200">Int</span><span class="op" id="5717203">(</span><span class="op" id="5717204">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717209">case</span>&nbsp;<span class="ident" id="5717214">reflect</span><span class="op" id="5717221">.</span><span class="ident" id="5717222">Uint</span><span class="op" id="5717226">,</span>&nbsp;<span class="ident" id="5717228">reflect</span><span class="op" id="5717235">.</span><span class="ident" id="5717236">Uint8</span><span class="op" id="5717241">,</span>&nbsp;<span class="ident" id="5717243">reflect</span><span class="op" id="5717250">.</span><span class="ident" id="5717251">Uint16</span><span class="op" id="5717257">,</span>&nbsp;<span class="ident" id="5717259">reflect</span><span class="op" id="5717266">.</span><span class="ident" id="5717267">Uint32</span><span class="op" id="5717273">,</span>&nbsp;<span class="ident" id="5717275">reflect</span><span class="op" id="5717282">.</span><span class="ident" id="5717283">Uint64</span><span class="op" id="5717289">,</span>&nbsp;<span class="ident" id="5717291">reflect</span><span class="op" id="5717298">.</span><span class="ident" id="5717299">Uintptr</span><span class="op" id="5717306">:</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717312">x</span>&nbsp;<span class="op" id="5717314">=</span>&nbsp;<span class="ident" id="5717316">int64</span><span class="op" id="5717321">(</span><span class="ident" id="5717322">index</span><span class="op" id="5717327">.</span><span class="ident" id="5717328">Uint</span><span class="op" id="5717332">(</span><span class="op" id="5717333">)</span><span class="op" id="5717334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717339">default</span><span class="op" id="5717346">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717352">return</span>&nbsp;<span class="ident" id="5717359">nil</span><span class="op" id="5717362">,</span>&nbsp;<span class="ident" id="5717364">fmt</span><span class="op" id="5717367">.</span><span class="ident" id="5717368">Errorf</span><span class="op" id="5717374">(</span><span class="string" id="5717375">&#34;cannot&nbsp;index&nbsp;slice/array&nbsp;with&nbsp;type&nbsp;%s&#34;</span><span class="op" id="5717414">,</span>&nbsp;<span class="ident" id="5717416">index</span><span class="op" id="5717421">.</span><span class="ident" id="5717422">Type</span><span class="op" id="5717426">(</span><span class="op" id="5717427">)</span><span class="op" id="5717428">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5717433">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717438">if</span>&nbsp;<span class="ident" id="5717441">x</span>&nbsp;<span class="op" id="5717443">&lt;</span>&nbsp;<span class="num" id="5717445">0</span>&nbsp;<span class="op" id="5717447">||</span>&nbsp;<span class="ident" id="5717450">x</span>&nbsp;<span class="op" id="5717452">&gt;=</span>&nbsp;<span class="ident" id="5717455">int64</span><span class="op" id="5717460">(</span><span class="ident" id="5717461">v</span><span class="op" id="5717462">.</span><span class="ident" id="5717463">Len</span><span class="op" id="5717466">(</span><span class="op" id="5717467">)</span><span class="op" id="5717468">)</span>&nbsp;<span class="op" id="5717470">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717476">return</span>&nbsp;<span class="ident" id="5717483">nil</span><span class="op" id="5717486">,</span>&nbsp;<span class="ident" id="5717488">fmt</span><span class="op" id="5717491">.</span><span class="ident" id="5717492">Errorf</span><span class="op" id="5717498">(</span><span class="string" id="5717499">&#34;index&nbsp;out&nbsp;of&nbsp;range:&nbsp;%d&#34;</span><span class="op" id="5717523">,</span>&nbsp;<span class="ident" id="5717525">x</span><span class="op" id="5717526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5717531">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717536">v</span>&nbsp;<span class="op" id="5717538">=</span>&nbsp;<span class="ident" id="5717540">v</span><span class="op" id="5717541">.</span><span class="ident" id="5717542">Index</span><span class="op" id="5717547">(</span><span class="builtintype" id="5717548">int</span><span class="op" id="5717551">(</span><span class="ident" id="5717552">x</span><span class="op" id="5717553">)</span><span class="op" id="5717554">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717558">case</span>&nbsp;<span class="ident" id="5717563">reflect</span><span class="op" id="5717570">.</span><span class="ident" id="5717571">Map</span><span class="op" id="5717574">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717579">if</span>&nbsp;<span class="op" id="5717582">!</span><span class="ident" id="5717583">index</span><span class="op" id="5717588">.</span><span class="ident" id="5717589">IsValid</span><span class="op" id="5717596">(</span><span class="op" id="5717597">)</span>&nbsp;<span class="op" id="5717599">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717605">index</span>&nbsp;<span class="op" id="5717611">=</span>&nbsp;<span class="ident" id="5717613">reflect</span><span class="op" id="5717620">.</span><span class="ident" id="5717621">Zero</span><span class="op" id="5717625">(</span><span class="ident" id="5717626">v</span><span class="op" id="5717627">.</span><span class="ident" id="5717628">Type</span><span class="op" id="5717632">(</span><span class="op" id="5717633">)</span><span class="op" id="5717634">.</span><span class="ident" id="5717635">Key</span><span class="op" id="5717638">(</span><span class="op" id="5717639">)</span><span class="op" id="5717640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5717645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717650">if</span>&nbsp;<span class="op" id="5717653">!</span><span class="ident" id="5717654">index</span><span class="op" id="5717659">.</span><span class="ident" id="5717660">Type</span><span class="op" id="5717664">(</span><span class="op" id="5717665">)</span><span class="op" id="5717666">.</span><span class="ident" id="5717667">AssignableTo</span><span class="op" id="5717679">(</span><span class="ident" id="5717680">v</span><span class="op" id="5717681">.</span><span class="ident" id="5717682">Type</span><span class="op" id="5717686">(</span><span class="op" id="5717687">)</span><span class="op" id="5717688">.</span><span class="ident" id="5717689">Key</span><span class="op" id="5717692">(</span><span class="op" id="5717693">)</span><span class="op" id="5717694">)</span>&nbsp;<span class="op" id="5717696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717702">return</span>&nbsp;<span class="ident" id="5717709">nil</span><span class="op" id="5717712">,</span>&nbsp;<span class="ident" id="5717714">fmt</span><span class="op" id="5717717">.</span><span class="ident" id="5717718">Errorf</span><span class="op" id="5717724">(</span><span class="string" id="5717725">&#34;%s&nbsp;is&nbsp;not&nbsp;index&nbsp;type&nbsp;for&nbsp;%s&#34;</span><span class="op" id="5717754">,</span>&nbsp;<span class="ident" id="5717756">index</span><span class="op" id="5717761">.</span><span class="ident" id="5717762">Type</span><span class="op" id="5717766">(</span><span class="op" id="5717767">)</span><span class="op" id="5717768">,</span>&nbsp;<span class="ident" id="5717770">v</span><span class="op" id="5717771">.</span><span class="ident" id="5717772">Type</span><span class="op" id="5717776">(</span><span class="op" id="5717777">)</span><span class="op" id="5717778">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5717783">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717788">if</span>&nbsp;<span class="ident" id="5717791">x</span>&nbsp;<span class="op" id="5717793">:=</span>&nbsp;<span class="ident" id="5717796">v</span><span class="op" id="5717797">.</span><span class="ident" id="5717798">MapIndex</span><span class="op" id="5717806">(</span><span class="ident" id="5717807">index</span><span class="op" id="5717812">)</span><span class="op" id="5717813">;</span>&nbsp;<span class="ident" id="5717815">x</span><span class="op" id="5717816">.</span><span class="ident" id="5717817">IsValid</span><span class="op" id="5717824">(</span><span class="op" id="5717825">)</span>&nbsp;<span class="op" id="5717827">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717833">v</span>&nbsp;<span class="op" id="5717835">=</span>&nbsp;<span class="ident" id="5717837">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5717842">}</span>&nbsp;<span class="keyword" id="5717844">else</span>&nbsp;<span class="op" id="5717849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5717855">v</span>&nbsp;<span class="op" id="5717857">=</span>&nbsp;<span class="ident" id="5717859">reflect</span><span class="op" id="5717866">.</span><span class="ident" id="5717867">Zero</span><span class="op" id="5717871">(</span><span class="ident" id="5717872">v</span><span class="op" id="5717873">.</span><span class="ident" id="5717874">Type</span><span class="op" id="5717878">(</span><span class="op" id="5717879">)</span><span class="op" id="5717880">.</span><span class="ident" id="5717881">Elem</span><span class="op" id="5717885">(</span><span class="op" id="5717886">)</span><span class="op" id="5717887">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5717892">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717896">default</span><span class="op" id="5717903">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717908">return</span>&nbsp;<span class="ident" id="5717915">nil</span><span class="op" id="5717918">,</span>&nbsp;<span class="ident" id="5717920">fmt</span><span class="op" id="5717923">.</span><span class="ident" id="5717924">Errorf</span><span class="op" id="5717930">(</span><span class="string" id="5717931">&#34;can&#39;t&nbsp;index&nbsp;item&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="5717960">,</span>&nbsp;<span class="ident" id="5717962">v</span><span class="op" id="5717963">.</span><span class="ident" id="5717964">Type</span><span class="op" id="5717968">(</span><span class="op" id="5717969">)</span><span class="op" id="5717970">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5717974">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5717977">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5717980">return</span>&nbsp;<span class="ident" id="5717987">v</span><span class="op" id="5717988">.</span><span class="ident" id="5717989">Interface</span><span class="op" id="5717998">(</span><span class="op" id="5717999">)</span><span class="op" id="5718000">,</span>&nbsp;<span class="ident" id="5718002">nil</span><br>
<span class="lineno">150</span><span class="op" id="5718006">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5718009">//&nbsp;Length</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5718020">//&nbsp;length&nbsp;returns&nbsp;the&nbsp;length&nbsp;of&nbsp;the&nbsp;item,&nbsp;with&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;has&nbsp;no&nbsp;defined&nbsp;length.</span><br>
<span class="lineno">155</span><span class="keyword" id="5718105">func</span>&nbsp;<span class="ident" id="5718110">length</span><span class="op" id="5718116">(</span><span class="ident" id="5718117">item</span>&nbsp;<span class="keyword" id="5718122">interface</span><span class="op" id="5718131">{</span><span class="op" id="5718132">}</span><span class="op" id="5718133">)</span>&nbsp;<span class="op" id="5718135">(</span><span class="builtintype" id="5718136">int</span><span class="op" id="5718139">,</span>&nbsp;<span class="builtintype" id="5718141">error</span><span class="op" id="5718146">)</span>&nbsp;<span class="op" id="5718148">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718151">v</span><span class="op" id="5718152">,</span>&nbsp;<span class="ident" id="5718154">isNil</span>&nbsp;<span class="op" id="5718160">:=</span>&nbsp;<span class="ident" id="5718163">indirect</span><span class="op" id="5718171">(</span><span class="ident" id="5718172">reflect</span><span class="op" id="5718179">.</span><span class="ident" id="5718180">ValueOf</span><span class="op" id="5718187">(</span><span class="ident" id="5718188">item</span><span class="op" id="5718192">)</span><span class="op" id="5718193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718196">if</span>&nbsp;<span class="ident" id="5718199">isNil</span>&nbsp;<span class="op" id="5718205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718209">return</span>&nbsp;<span class="num" id="5718216">0</span><span class="op" id="5718217">,</span>&nbsp;<span class="ident" id="5718219">fmt</span><span class="op" id="5718222">.</span><span class="ident" id="5718223">Errorf</span><span class="op" id="5718229">(</span><span class="string" id="5718230">&#34;len&nbsp;of&nbsp;nil&nbsp;pointer&#34;</span><span class="op" id="5718250">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718253">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718256">switch</span>&nbsp;<span class="ident" id="5718263">v</span><span class="op" id="5718264">.</span><span class="ident" id="5718265">Kind</span><span class="op" id="5718269">(</span><span class="op" id="5718270">)</span>&nbsp;<span class="op" id="5718272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718275">case</span>&nbsp;<span class="ident" id="5718280">reflect</span><span class="op" id="5718287">.</span><span class="ident" id="5718288">Array</span><span class="op" id="5718293">,</span>&nbsp;<span class="ident" id="5718295">reflect</span><span class="op" id="5718302">.</span><span class="ident" id="5718303">Chan</span><span class="op" id="5718307">,</span>&nbsp;<span class="ident" id="5718309">reflect</span><span class="op" id="5718316">.</span><span class="ident" id="5718317">Map</span><span class="op" id="5718320">,</span>&nbsp;<span class="ident" id="5718322">reflect</span><span class="op" id="5718329">.</span><span class="ident" id="5718330">Slice</span><span class="op" id="5718335">,</span>&nbsp;<span class="ident" id="5718337">reflect</span><span class="op" id="5718344">.</span><span class="ident" id="5718345">String</span><span class="op" id="5718351">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718355">return</span>&nbsp;<span class="ident" id="5718362">v</span><span class="op" id="5718363">.</span><span class="ident" id="5718364">Len</span><span class="op" id="5718367">(</span><span class="op" id="5718368">)</span><span class="op" id="5718369">,</span>&nbsp;<span class="ident" id="5718371">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718379">return</span>&nbsp;<span class="num" id="5718386">0</span><span class="op" id="5718387">,</span>&nbsp;<span class="ident" id="5718389">fmt</span><span class="op" id="5718392">.</span><span class="ident" id="5718393">Errorf</span><span class="op" id="5718399">(</span><span class="string" id="5718400">&#34;len&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="5718416">,</span>&nbsp;<span class="ident" id="5718418">v</span><span class="op" id="5718419">.</span><span class="ident" id="5718420">Type</span><span class="op" id="5718424">(</span><span class="op" id="5718425">)</span><span class="op" id="5718426">)</span><br>
<span class="lineno">165</span><span class="op" id="5718428">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5718431">//&nbsp;Function&nbsp;invocation</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5718455">//&nbsp;call&nbsp;returns&nbsp;the&nbsp;result&nbsp;of&nbsp;evaluating&nbsp;the&nbsp;first&nbsp;argument&nbsp;as&nbsp;a&nbsp;function.</span><br>
<span class="lineno">170</span><span class="comment" id="5718530">//&nbsp;The&nbsp;function&nbsp;must&nbsp;return&nbsp;1&nbsp;result,&nbsp;or&nbsp;2&nbsp;results,&nbsp;the&nbsp;second&nbsp;of&nbsp;which&nbsp;is&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="5718615">func</span>&nbsp;<span class="ident" id="5718620">call</span><span class="op" id="5718624">(</span><span class="ident" id="5718625">fn</span>&nbsp;<span class="keyword" id="5718628">interface</span><span class="op" id="5718637">{</span><span class="op" id="5718638">}</span><span class="op" id="5718639">,</span>&nbsp;<span class="ident" id="5718641">args</span>&nbsp;<span class="op" id="5718646">...</span><span class="keyword" id="5718649">interface</span><span class="op" id="5718658">{</span><span class="op" id="5718659">}</span><span class="op" id="5718660">)</span>&nbsp;<span class="op" id="5718662">(</span><span class="keyword" id="5718663">interface</span><span class="op" id="5718672">{</span><span class="op" id="5718673">}</span><span class="op" id="5718674">,</span>&nbsp;<span class="builtintype" id="5718676">error</span><span class="op" id="5718681">)</span>&nbsp;<span class="op" id="5718683">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718686">v</span>&nbsp;<span class="op" id="5718688">:=</span>&nbsp;<span class="ident" id="5718691">reflect</span><span class="op" id="5718698">.</span><span class="ident" id="5718699">ValueOf</span><span class="op" id="5718706">(</span><span class="ident" id="5718707">fn</span><span class="op" id="5718709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718712">typ</span>&nbsp;<span class="op" id="5718716">:=</span>&nbsp;<span class="ident" id="5718719">v</span><span class="op" id="5718720">.</span><span class="ident" id="5718721">Type</span><span class="op" id="5718725">(</span><span class="op" id="5718726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718729">if</span>&nbsp;<span class="ident" id="5718732">typ</span><span class="op" id="5718735">.</span><span class="ident" id="5718736">Kind</span><span class="op" id="5718740">(</span><span class="op" id="5718741">)</span>&nbsp;<span class="op" id="5718743">!=</span>&nbsp;<span class="ident" id="5718746">reflect</span><span class="op" id="5718753">.</span><span class="ident" id="5718754">Func</span>&nbsp;<span class="op" id="5718759">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718763">return</span>&nbsp;<span class="ident" id="5718770">nil</span><span class="op" id="5718773">,</span>&nbsp;<span class="ident" id="5718775">fmt</span><span class="op" id="5718778">.</span><span class="ident" id="5718779">Errorf</span><span class="op" id="5718785">(</span><span class="string" id="5718786">&#34;non-function&nbsp;of&nbsp;type&nbsp;%s&#34;</span><span class="op" id="5718811">,</span>&nbsp;<span class="ident" id="5718813">typ</span><span class="op" id="5718816">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718819">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718822">if</span>&nbsp;<span class="op" id="5718825">!</span><span class="ident" id="5718826">goodFunc</span><span class="op" id="5718834">(</span><span class="ident" id="5718835">typ</span><span class="op" id="5718838">)</span>&nbsp;<span class="op" id="5718840">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718844">return</span>&nbsp;<span class="ident" id="5718851">nil</span><span class="op" id="5718854">,</span>&nbsp;<span class="ident" id="5718856">fmt</span><span class="op" id="5718859">.</span><span class="ident" id="5718860">Errorf</span><span class="op" id="5718866">(</span><span class="string" id="5718867">&#34;function&nbsp;called&nbsp;with&nbsp;%d&nbsp;args;&nbsp;should&nbsp;be&nbsp;1&nbsp;or&nbsp;2&#34;</span><span class="op" id="5718915">,</span>&nbsp;<span class="ident" id="5718917">typ</span><span class="op" id="5718920">.</span><span class="ident" id="5718921">NumOut</span><span class="op" id="5718927">(</span><span class="op" id="5718928">)</span><span class="op" id="5718929">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5718932">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5718935">numIn</span>&nbsp;<span class="op" id="5718941">:=</span>&nbsp;<span class="ident" id="5718944">typ</span><span class="op" id="5718947">.</span><span class="ident" id="5718948">NumIn</span><span class="op" id="5718953">(</span><span class="op" id="5718954">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718957">var</span>&nbsp;<span class="ident" id="5718961">dddType</span>&nbsp;<span class="ident" id="5718969">reflect</span><span class="op" id="5718976">.</span><span class="ident" id="5718977">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5718983">if</span>&nbsp;<span class="ident" id="5718986">typ</span><span class="op" id="5718989">.</span><span class="ident" id="5718990">IsVariadic</span><span class="op" id="5719000">(</span><span class="op" id="5719001">)</span>&nbsp;<span class="op" id="5719003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719007">if</span>&nbsp;<span class="builtinfunc" id="5719010">len</span><span class="op" id="5719013">(</span><span class="ident" id="5719014">args</span><span class="op" id="5719018">)</span>&nbsp;<span class="op" id="5719020">&lt;</span>&nbsp;<span class="ident" id="5719022">numIn</span><span class="op" id="5719027">-</span><span class="num" id="5719028">1</span>&nbsp;<span class="op" id="5719030">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719035">return</span>&nbsp;<span class="ident" id="5719042">nil</span><span class="op" id="5719045">,</span>&nbsp;<span class="ident" id="5719047">fmt</span><span class="op" id="5719050">.</span><span class="ident" id="5719051">Errorf</span><span class="op" id="5719057">(</span><span class="string" id="5719058">&#34;wrong&nbsp;number&nbsp;of&nbsp;args:&nbsp;got&nbsp;%d&nbsp;want&nbsp;at&nbsp;least&nbsp;%d&#34;</span><span class="op" id="5719105">,</span>&nbsp;<span class="builtinfunc" id="5719107">len</span><span class="op" id="5719110">(</span><span class="ident" id="5719111">args</span><span class="op" id="5719115">)</span><span class="op" id="5719116">,</span>&nbsp;<span class="ident" id="5719118">numIn</span><span class="op" id="5719123">-</span><span class="num" id="5719124">1</span><span class="op" id="5719125">)</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719129">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719133">dddType</span>&nbsp;<span class="op" id="5719141">=</span>&nbsp;<span class="ident" id="5719143">typ</span><span class="op" id="5719146">.</span><span class="ident" id="5719147">In</span><span class="op" id="5719149">(</span><span class="ident" id="5719150">numIn</span>&nbsp;<span class="op" id="5719156">-</span>&nbsp;<span class="num" id="5719158">1</span><span class="op" id="5719159">)</span><span class="op" id="5719160">.</span><span class="ident" id="5719161">Elem</span><span class="op" id="5719165">(</span><span class="op" id="5719166">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719169">}</span>&nbsp;<span class="keyword" id="5719171">else</span>&nbsp;<span class="op" id="5719176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719180">if</span>&nbsp;<span class="builtinfunc" id="5719183">len</span><span class="op" id="5719186">(</span><span class="ident" id="5719187">args</span><span class="op" id="5719191">)</span>&nbsp;<span class="op" id="5719193">!=</span>&nbsp;<span class="ident" id="5719196">numIn</span>&nbsp;<span class="op" id="5719202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719207">return</span>&nbsp;<span class="ident" id="5719214">nil</span><span class="op" id="5719217">,</span>&nbsp;<span class="ident" id="5719219">fmt</span><span class="op" id="5719222">.</span><span class="ident" id="5719223">Errorf</span><span class="op" id="5719229">(</span><span class="string" id="5719230">&#34;wrong&nbsp;number&nbsp;of&nbsp;args:&nbsp;got&nbsp;%d&nbsp;want&nbsp;%d&#34;</span><span class="op" id="5719268">,</span>&nbsp;<span class="builtinfunc" id="5719270">len</span><span class="op" id="5719273">(</span><span class="ident" id="5719274">args</span><span class="op" id="5719278">)</span><span class="op" id="5719279">,</span>&nbsp;<span class="ident" id="5719281">numIn</span><span class="op" id="5719286">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719290">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719293">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719296">argv</span>&nbsp;<span class="op" id="5719301">:=</span>&nbsp;<span class="builtinfunc" id="5719304">make</span><span class="op" id="5719308">(</span><span class="op" id="5719309">[</span><span class="op" id="5719310">]</span><span class="ident" id="5719311">reflect</span><span class="op" id="5719318">.</span><span class="ident" id="5719319">Value</span><span class="op" id="5719324">,</span>&nbsp;<span class="builtinfunc" id="5719326">len</span><span class="op" id="5719329">(</span><span class="ident" id="5719330">args</span><span class="op" id="5719334">)</span><span class="op" id="5719335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719338">for</span>&nbsp;<span class="ident" id="5719342">i</span><span class="op" id="5719343">,</span>&nbsp;<span class="ident" id="5719345">arg</span>&nbsp;<span class="op" id="5719349">:=</span>&nbsp;<span class="keyword" id="5719352">range</span>&nbsp;<span class="ident" id="5719358">args</span>&nbsp;<span class="op" id="5719363">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719367">value</span>&nbsp;<span class="op" id="5719373">:=</span>&nbsp;<span class="ident" id="5719376">reflect</span><span class="op" id="5719383">.</span><span class="ident" id="5719384">ValueOf</span><span class="op" id="5719391">(</span><span class="ident" id="5719392">arg</span><span class="op" id="5719395">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5719399">//&nbsp;Compute&nbsp;the&nbsp;expected&nbsp;type.&nbsp;Clumsy&nbsp;because&nbsp;of&nbsp;variadics.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719460">var</span>&nbsp;<span class="ident" id="5719464">argType</span>&nbsp;<span class="ident" id="5719472">reflect</span><span class="op" id="5719479">.</span><span class="ident" id="5719480">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719487">if</span>&nbsp;<span class="op" id="5719490">!</span><span class="ident" id="5719491">typ</span><span class="op" id="5719494">.</span><span class="ident" id="5719495">IsVariadic</span><span class="op" id="5719505">(</span><span class="op" id="5719506">)</span>&nbsp;<span class="op" id="5719508">||</span>&nbsp;<span class="ident" id="5719511">i</span>&nbsp;<span class="op" id="5719513">&lt;</span>&nbsp;<span class="ident" id="5719515">numIn</span><span class="op" id="5719520">-</span><span class="num" id="5719521">1</span>&nbsp;<span class="op" id="5719523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719528">argType</span>&nbsp;<span class="op" id="5719536">=</span>&nbsp;<span class="ident" id="5719538">typ</span><span class="op" id="5719541">.</span><span class="ident" id="5719542">In</span><span class="op" id="5719544">(</span><span class="ident" id="5719545">i</span><span class="op" id="5719546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719550">}</span>&nbsp;<span class="keyword" id="5719552">else</span>&nbsp;<span class="op" id="5719557">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719562">argType</span>&nbsp;<span class="op" id="5719570">=</span>&nbsp;<span class="ident" id="5719572">dddType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719586">if</span>&nbsp;<span class="op" id="5719589">!</span><span class="ident" id="5719590">value</span><span class="op" id="5719595">.</span><span class="ident" id="5719596">IsValid</span><span class="op" id="5719603">(</span><span class="op" id="5719604">)</span>&nbsp;<span class="op" id="5719606">&amp;&amp;</span>&nbsp;<span class="ident" id="5719609">canBeNil</span><span class="op" id="5719617">(</span><span class="ident" id="5719618">argType</span><span class="op" id="5719625">)</span>&nbsp;<span class="op" id="5719627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719632">value</span>&nbsp;<span class="op" id="5719638">=</span>&nbsp;<span class="ident" id="5719640">reflect</span><span class="op" id="5719647">.</span><span class="ident" id="5719648">Zero</span><span class="op" id="5719652">(</span><span class="ident" id="5719653">argType</span><span class="op" id="5719660">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719664">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719668">if</span>&nbsp;<span class="op" id="5719671">!</span><span class="ident" id="5719672">value</span><span class="op" id="5719677">.</span><span class="ident" id="5719678">Type</span><span class="op" id="5719682">(</span><span class="op" id="5719683">)</span><span class="op" id="5719684">.</span><span class="ident" id="5719685">AssignableTo</span><span class="op" id="5719697">(</span><span class="ident" id="5719698">argType</span><span class="op" id="5719705">)</span>&nbsp;<span class="op" id="5719707">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719712">return</span>&nbsp;<span class="ident" id="5719719">nil</span><span class="op" id="5719722">,</span>&nbsp;<span class="ident" id="5719724">fmt</span><span class="op" id="5719727">.</span><span class="ident" id="5719728">Errorf</span><span class="op" id="5719734">(</span><span class="string" id="5719735">&#34;arg&nbsp;%d&nbsp;has&nbsp;type&nbsp;%s;&nbsp;should&nbsp;be&nbsp;%s&#34;</span><span class="op" id="5719769">,</span>&nbsp;<span class="ident" id="5719771">i</span><span class="op" id="5719772">,</span>&nbsp;<span class="ident" id="5719774">value</span><span class="op" id="5719779">.</span><span class="ident" id="5719780">Type</span><span class="op" id="5719784">(</span><span class="op" id="5719785">)</span><span class="op" id="5719786">,</span>&nbsp;<span class="ident" id="5719788">argType</span><span class="op" id="5719795">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719799">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719803">argv</span><span class="op" id="5719807">[</span><span class="ident" id="5719808">i</span><span class="op" id="5719809">]</span>&nbsp;<span class="op" id="5719811">=</span>&nbsp;<span class="ident" id="5719813">value</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719820">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5719823">result</span>&nbsp;<span class="op" id="5719830">:=</span>&nbsp;<span class="ident" id="5719833">v</span><span class="op" id="5719834">.</span><span class="ident" id="5719835">Call</span><span class="op" id="5719839">(</span><span class="ident" id="5719840">argv</span><span class="op" id="5719844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719847">if</span>&nbsp;<span class="builtinfunc" id="5719850">len</span><span class="op" id="5719853">(</span><span class="ident" id="5719854">result</span><span class="op" id="5719860">)</span>&nbsp;<span class="op" id="5719862">==</span>&nbsp;<span class="num" id="5719865">2</span>&nbsp;<span class="op" id="5719867">&amp;&amp;</span>&nbsp;<span class="op" id="5719870">!</span><span class="ident" id="5719871">result</span><span class="op" id="5719877">[</span><span class="num" id="5719878">1</span><span class="op" id="5719879">]</span><span class="op" id="5719880">.</span><span class="ident" id="5719881">IsNil</span><span class="op" id="5719886">(</span><span class="op" id="5719887">)</span>&nbsp;<span class="op" id="5719889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719893">return</span>&nbsp;<span class="ident" id="5719900">result</span><span class="op" id="5719906">[</span><span class="num" id="5719907">0</span><span class="op" id="5719908">]</span><span class="op" id="5719909">.</span><span class="ident" id="5719910">Interface</span><span class="op" id="5719919">(</span><span class="op" id="5719920">)</span><span class="op" id="5719921">,</span>&nbsp;<span class="ident" id="5719923">result</span><span class="op" id="5719929">[</span><span class="num" id="5719930">1</span><span class="op" id="5719931">]</span><span class="op" id="5719932">.</span><span class="ident" id="5719933">Interface</span><span class="op" id="5719942">(</span><span class="op" id="5719943">)</span><span class="op" id="5719944">.</span><span class="op" id="5719945">(</span><span class="builtintype" id="5719946">error</span><span class="op" id="5719951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5719954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5719957">return</span>&nbsp;<span class="ident" id="5719964">result</span><span class="op" id="5719970">[</span><span class="num" id="5719971">0</span><span class="op" id="5719972">]</span><span class="op" id="5719973">.</span><span class="ident" id="5719974">Interface</span><span class="op" id="5719983">(</span><span class="op" id="5719984">)</span><span class="op" id="5719985">,</span>&nbsp;<span class="ident" id="5719987">nil</span><br>
<span class="lineno">215</span><span class="op" id="5719991">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5719994">//&nbsp;Boolean&nbsp;logic.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5720013">func</span>&nbsp;<span class="ident" id="5720018">truth</span><span class="op" id="5720023">(</span><span class="ident" id="5720024">a</span>&nbsp;<span class="keyword" id="5720026">interface</span><span class="op" id="5720035">{</span><span class="op" id="5720036">}</span><span class="op" id="5720037">)</span>&nbsp;<span class="builtintype" id="5720039">bool</span>&nbsp;<span class="op" id="5720044">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720047">t</span><span class="op" id="5720048">,</span>&nbsp;<span class="ident" id="5720050">_</span>&nbsp;<span class="op" id="5720052">:=</span>&nbsp;<span class="ident" id="5720055">isTrue</span><span class="op" id="5720061">(</span><span class="ident" id="5720062">reflect</span><span class="op" id="5720069">.</span><span class="ident" id="5720070">ValueOf</span><span class="op" id="5720077">(</span><span class="ident" id="5720078">a</span><span class="op" id="5720079">)</span><span class="op" id="5720080">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720083">return</span>&nbsp;<span class="ident" id="5720090">t</span><br>
<span class="lineno"></span><span class="op" id="5720092">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5720095">//&nbsp;and&nbsp;computes&nbsp;the&nbsp;Boolean&nbsp;AND&nbsp;of&nbsp;its&nbsp;arguments,&nbsp;returning</span><br>
<span class="lineno">225</span><span class="comment" id="5720155">//&nbsp;the&nbsp;first&nbsp;false&nbsp;argument&nbsp;it&nbsp;encounters,&nbsp;or&nbsp;the&nbsp;last&nbsp;argument.</span><br>
<span class="lineno"></span><span class="keyword" id="5720220">func</span>&nbsp;<span class="ident" id="5720225">and</span><span class="op" id="5720228">(</span><span class="ident" id="5720229">arg0</span>&nbsp;<span class="keyword" id="5720234">interface</span><span class="op" id="5720243">{</span><span class="op" id="5720244">}</span><span class="op" id="5720245">,</span>&nbsp;<span class="ident" id="5720247">args</span>&nbsp;<span class="op" id="5720252">...</span><span class="keyword" id="5720255">interface</span><span class="op" id="5720264">{</span><span class="op" id="5720265">}</span><span class="op" id="5720266">)</span>&nbsp;<span class="keyword" id="5720268">interface</span><span class="op" id="5720277">{</span><span class="op" id="5720278">}</span>&nbsp;<span class="op" id="5720280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720283">if</span>&nbsp;<span class="op" id="5720286">!</span><span class="ident" id="5720287">truth</span><span class="op" id="5720292">(</span><span class="ident" id="5720293">arg0</span><span class="op" id="5720297">)</span>&nbsp;<span class="op" id="5720299">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720303">return</span>&nbsp;<span class="ident" id="5720310">arg0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720316">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720319">for</span>&nbsp;<span class="ident" id="5720323">i</span>&nbsp;<span class="op" id="5720325">:=</span>&nbsp;<span class="keyword" id="5720328">range</span>&nbsp;<span class="ident" id="5720334">args</span>&nbsp;<span class="op" id="5720339">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720343">arg0</span>&nbsp;<span class="op" id="5720348">=</span>&nbsp;<span class="ident" id="5720350">args</span><span class="op" id="5720354">[</span><span class="ident" id="5720355">i</span><span class="op" id="5720356">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720360">if</span>&nbsp;<span class="op" id="5720363">!</span><span class="ident" id="5720364">truth</span><span class="op" id="5720369">(</span><span class="ident" id="5720370">arg0</span><span class="op" id="5720374">)</span>&nbsp;<span class="op" id="5720376">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720381">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720389">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720392">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720395">return</span>&nbsp;<span class="ident" id="5720402">arg0</span><br>
<span class="lineno"></span><span class="op" id="5720407">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5720410">//&nbsp;or&nbsp;computes&nbsp;the&nbsp;Boolean&nbsp;OR&nbsp;of&nbsp;its&nbsp;arguments,&nbsp;returning</span><br>
<span class="lineno">240</span><span class="comment" id="5720468">//&nbsp;the&nbsp;first&nbsp;true&nbsp;argument&nbsp;it&nbsp;encounters,&nbsp;or&nbsp;the&nbsp;last&nbsp;argument.</span><br>
<span class="lineno"></span><span class="keyword" id="5720532">func</span>&nbsp;<span class="ident" id="5720537">or</span><span class="op" id="5720539">(</span><span class="ident" id="5720540">arg0</span>&nbsp;<span class="keyword" id="5720545">interface</span><span class="op" id="5720554">{</span><span class="op" id="5720555">}</span><span class="op" id="5720556">,</span>&nbsp;<span class="ident" id="5720558">args</span>&nbsp;<span class="op" id="5720563">...</span><span class="keyword" id="5720566">interface</span><span class="op" id="5720575">{</span><span class="op" id="5720576">}</span><span class="op" id="5720577">)</span>&nbsp;<span class="keyword" id="5720579">interface</span><span class="op" id="5720588">{</span><span class="op" id="5720589">}</span>&nbsp;<span class="op" id="5720591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720594">if</span>&nbsp;<span class="ident" id="5720597">truth</span><span class="op" id="5720602">(</span><span class="ident" id="5720603">arg0</span><span class="op" id="5720607">)</span>&nbsp;<span class="op" id="5720609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720613">return</span>&nbsp;<span class="ident" id="5720620">arg0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720626">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720629">for</span>&nbsp;<span class="ident" id="5720633">i</span>&nbsp;<span class="op" id="5720635">:=</span>&nbsp;<span class="keyword" id="5720638">range</span>&nbsp;<span class="ident" id="5720644">args</span>&nbsp;<span class="op" id="5720649">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720653">arg0</span>&nbsp;<span class="op" id="5720658">=</span>&nbsp;<span class="ident" id="5720660">args</span><span class="op" id="5720664">[</span><span class="ident" id="5720665">i</span><span class="op" id="5720666">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720670">if</span>&nbsp;<span class="ident" id="5720673">truth</span><span class="op" id="5720678">(</span><span class="ident" id="5720679">arg0</span><span class="op" id="5720683">)</span>&nbsp;<span class="op" id="5720685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720690">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720698">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5720701">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720704">return</span>&nbsp;<span class="ident" id="5720711">arg0</span><br>
<span class="lineno"></span><span class="op" id="5720716">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5720719">//&nbsp;not&nbsp;returns&nbsp;the&nbsp;Boolean&nbsp;negation&nbsp;of&nbsp;its&nbsp;argument.</span><br>
<span class="lineno">255</span><span class="keyword" id="5720772">func</span>&nbsp;<span class="ident" id="5720777">not</span><span class="op" id="5720780">(</span><span class="ident" id="5720781">arg</span>&nbsp;<span class="keyword" id="5720785">interface</span><span class="op" id="5720794">{</span><span class="op" id="5720795">}</span><span class="op" id="5720796">)</span>&nbsp;<span class="op" id="5720798">(</span><span class="ident" id="5720799">truth</span>&nbsp;<span class="builtintype" id="5720805">bool</span><span class="op" id="5720809">)</span>&nbsp;<span class="op" id="5720811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720814">truth</span><span class="op" id="5720819">,</span>&nbsp;<span class="ident" id="5720821">_</span>&nbsp;<span class="op" id="5720823">=</span>&nbsp;<span class="ident" id="5720825">isTrue</span><span class="op" id="5720831">(</span><span class="ident" id="5720832">reflect</span><span class="op" id="5720839">.</span><span class="ident" id="5720840">ValueOf</span><span class="op" id="5720847">(</span><span class="ident" id="5720848">arg</span><span class="op" id="5720851">)</span><span class="op" id="5720852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5720855">return</span>&nbsp;<span class="op" id="5720862">!</span><span class="ident" id="5720863">truth</span><br>
<span class="lineno"></span><span class="op" id="5720869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="5720872">//&nbsp;Comparison.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5720888">//&nbsp;TODO:&nbsp;Perhaps&nbsp;allow&nbsp;comparison&nbsp;between&nbsp;signed&nbsp;and&nbsp;unsigned&nbsp;integers.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5720961">var</span>&nbsp;<span class="op" id="5720965">(</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5720968">errBadComparisonType</span>&nbsp;<span class="op" id="5720989">=</span>&nbsp;<span class="ident" id="5720991">errors</span><span class="op" id="5720997">.</span><span class="ident" id="5720998">New</span><span class="op" id="5721001">(</span><span class="string" id="5721002">&#34;invalid&nbsp;type&nbsp;for&nbsp;comparison&#34;</span><span class="op" id="5721031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721034">errBadComparison</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5721055">=</span>&nbsp;<span class="ident" id="5721057">errors</span><span class="op" id="5721063">.</span><span class="ident" id="5721064">New</span><span class="op" id="5721067">(</span><span class="string" id="5721068">&#34;incompatible&nbsp;types&nbsp;for&nbsp;comparison&#34;</span><span class="op" id="5721103">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721106">errNoComparison</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5721127">=</span>&nbsp;<span class="ident" id="5721129">errors</span><span class="op" id="5721135">.</span><span class="ident" id="5721136">New</span><span class="op" id="5721139">(</span><span class="string" id="5721140">&#34;missing&nbsp;argument&nbsp;for&nbsp;comparison&#34;</span><span class="op" id="5721173">)</span><br>
<span class="lineno"></span><span class="op" id="5721175">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">270</span><span class="keyword" id="5721178">type</span>&nbsp;<span class="ident" id="5721183">kind</span>&nbsp;<span class="builtintype" id="5721188">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5721193">const</span>&nbsp;<span class="op" id="5721199">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721202">invalidKind</span>&nbsp;<span class="ident" id="5721214">kind</span>&nbsp;<span class="op" id="5721219">=</span>&nbsp;<span class="ident" id="5721221">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721227">boolKind</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721237">complexKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721250">intKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721259">floatKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721270">integerKind</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721283">stringKind</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721295">uintKind</span><br>
<span class="lineno"></span><span class="op" id="5721304">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5721307">func</span>&nbsp;<span class="ident" id="5721312">basicKind</span><span class="op" id="5721321">(</span><span class="ident" id="5721322">v</span>&nbsp;<span class="ident" id="5721324">reflect</span><span class="op" id="5721331">.</span><span class="ident" id="5721332">Value</span><span class="op" id="5721337">)</span>&nbsp;<span class="op" id="5721339">(</span><span class="ident" id="5721340">kind</span><span class="op" id="5721344">,</span>&nbsp;<span class="builtintype" id="5721346">error</span><span class="op" id="5721351">)</span>&nbsp;<span class="op" id="5721353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721356">switch</span>&nbsp;<span class="ident" id="5721363">v</span><span class="op" id="5721364">.</span><span class="ident" id="5721365">Kind</span><span class="op" id="5721369">(</span><span class="op" id="5721370">)</span>&nbsp;<span class="op" id="5721372">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721375">case</span>&nbsp;<span class="ident" id="5721380">reflect</span><span class="op" id="5721387">.</span><span class="ident" id="5721388">Bool</span><span class="op" id="5721392">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721396">return</span>&nbsp;<span class="ident" id="5721403">boolKind</span><span class="op" id="5721411">,</span>&nbsp;<span class="ident" id="5721413">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721418">case</span>&nbsp;<span class="ident" id="5721423">reflect</span><span class="op" id="5721430">.</span><span class="ident" id="5721431">Int</span><span class="op" id="5721434">,</span>&nbsp;<span class="ident" id="5721436">reflect</span><span class="op" id="5721443">.</span><span class="ident" id="5721444">Int8</span><span class="op" id="5721448">,</span>&nbsp;<span class="ident" id="5721450">reflect</span><span class="op" id="5721457">.</span><span class="ident" id="5721458">Int16</span><span class="op" id="5721463">,</span>&nbsp;<span class="ident" id="5721465">reflect</span><span class="op" id="5721472">.</span><span class="ident" id="5721473">Int32</span><span class="op" id="5721478">,</span>&nbsp;<span class="ident" id="5721480">reflect</span><span class="op" id="5721487">.</span><span class="ident" id="5721488">Int64</span><span class="op" id="5721493">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721497">return</span>&nbsp;<span class="ident" id="5721504">intKind</span><span class="op" id="5721511">,</span>&nbsp;<span class="ident" id="5721513">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721518">case</span>&nbsp;<span class="ident" id="5721523">reflect</span><span class="op" id="5721530">.</span><span class="ident" id="5721531">Uint</span><span class="op" id="5721535">,</span>&nbsp;<span class="ident" id="5721537">reflect</span><span class="op" id="5721544">.</span><span class="ident" id="5721545">Uint8</span><span class="op" id="5721550">,</span>&nbsp;<span class="ident" id="5721552">reflect</span><span class="op" id="5721559">.</span><span class="ident" id="5721560">Uint16</span><span class="op" id="5721566">,</span>&nbsp;<span class="ident" id="5721568">reflect</span><span class="op" id="5721575">.</span><span class="ident" id="5721576">Uint32</span><span class="op" id="5721582">,</span>&nbsp;<span class="ident" id="5721584">reflect</span><span class="op" id="5721591">.</span><span class="ident" id="5721592">Uint64</span><span class="op" id="5721598">,</span>&nbsp;<span class="ident" id="5721600">reflect</span><span class="op" id="5721607">.</span><span class="ident" id="5721608">Uintptr</span><span class="op" id="5721615">:</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721619">return</span>&nbsp;<span class="ident" id="5721626">uintKind</span><span class="op" id="5721634">,</span>&nbsp;<span class="ident" id="5721636">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721641">case</span>&nbsp;<span class="ident" id="5721646">reflect</span><span class="op" id="5721653">.</span><span class="ident" id="5721654">Float32</span><span class="op" id="5721661">,</span>&nbsp;<span class="ident" id="5721663">reflect</span><span class="op" id="5721670">.</span><span class="ident" id="5721671">Float64</span><span class="op" id="5721678">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721682">return</span>&nbsp;<span class="ident" id="5721689">floatKind</span><span class="op" id="5721698">,</span>&nbsp;<span class="ident" id="5721700">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721705">case</span>&nbsp;<span class="ident" id="5721710">reflect</span><span class="op" id="5721717">.</span><span class="ident" id="5721718">Complex64</span><span class="op" id="5721727">,</span>&nbsp;<span class="ident" id="5721729">reflect</span><span class="op" id="5721736">.</span><span class="ident" id="5721737">Complex128</span><span class="op" id="5721747">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721751">return</span>&nbsp;<span class="ident" id="5721758">complexKind</span><span class="op" id="5721769">,</span>&nbsp;<span class="ident" id="5721771">nil</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721776">case</span>&nbsp;<span class="ident" id="5721781">reflect</span><span class="op" id="5721788">.</span><span class="ident" id="5721789">String</span><span class="op" id="5721795">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721799">return</span>&nbsp;<span class="ident" id="5721806">stringKind</span><span class="op" id="5721816">,</span>&nbsp;<span class="ident" id="5721818">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5721823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5721826">return</span>&nbsp;<span class="ident" id="5721833">invalidKind</span><span class="op" id="5721844">,</span>&nbsp;<span class="ident" id="5721846">errBadComparisonType</span><br>
<span class="lineno"></span><span class="op" id="5721867">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="5721870">//&nbsp;eq&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;==&nbsp;b&nbsp;||&nbsp;a&nbsp;==&nbsp;c&nbsp;||&nbsp;...</span><br>
<span class="lineno"></span><span class="keyword" id="5721925">func</span>&nbsp;<span class="ident" id="5721930">eq</span><span class="op" id="5721932">(</span><span class="ident" id="5721933">arg1</span>&nbsp;<span class="keyword" id="5721938">interface</span><span class="op" id="5721947">{</span><span class="op" id="5721948">}</span><span class="op" id="5721949">,</span>&nbsp;<span class="ident" id="5721951">arg2</span>&nbsp;<span class="op" id="5721956">...</span><span class="keyword" id="5721959">interface</span><span class="op" id="5721968">{</span><span class="op" id="5721969">}</span><span class="op" id="5721970">)</span>&nbsp;<span class="op" id="5721972">(</span><span class="builtintype" id="5721973">bool</span><span class="op" id="5721977">,</span>&nbsp;<span class="builtintype" id="5721979">error</span><span class="op" id="5721984">)</span>&nbsp;<span class="op" id="5721986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5721989">v1</span>&nbsp;<span class="op" id="5721992">:=</span>&nbsp;<span class="ident" id="5721995">reflect</span><span class="op" id="5722002">.</span><span class="ident" id="5722003">ValueOf</span><span class="op" id="5722010">(</span><span class="ident" id="5722011">arg1</span><span class="op" id="5722015">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722018">k1</span><span class="op" id="5722020">,</span>&nbsp;<span class="ident" id="5722022">err</span>&nbsp;<span class="op" id="5722026">:=</span>&nbsp;<span class="ident" id="5722029">basicKind</span><span class="op" id="5722038">(</span><span class="ident" id="5722039">v1</span><span class="op" id="5722041">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722044">if</span>&nbsp;<span class="ident" id="5722047">err</span>&nbsp;<span class="op" id="5722051">!=</span>&nbsp;<span class="ident" id="5722054">nil</span>&nbsp;<span class="op" id="5722058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722062">return</span>&nbsp;<span class="builtintype" id="5722069">false</span><span class="op" id="5722074">,</span>&nbsp;<span class="ident" id="5722076">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722081">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722084">if</span>&nbsp;<span class="builtinfunc" id="5722087">len</span><span class="op" id="5722090">(</span><span class="ident" id="5722091">arg2</span><span class="op" id="5722095">)</span>&nbsp;<span class="op" id="5722097">==</span>&nbsp;<span class="num" id="5722100">0</span>&nbsp;<span class="op" id="5722102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722106">return</span>&nbsp;<span class="builtintype" id="5722113">false</span><span class="op" id="5722118">,</span>&nbsp;<span class="ident" id="5722120">errNoComparison</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722140">for</span>&nbsp;<span class="ident" id="5722144">_</span><span class="op" id="5722145">,</span>&nbsp;<span class="ident" id="5722147">arg</span>&nbsp;<span class="op" id="5722151">:=</span>&nbsp;<span class="keyword" id="5722154">range</span>&nbsp;<span class="ident" id="5722160">arg2</span>&nbsp;<span class="op" id="5722165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722169">v2</span>&nbsp;<span class="op" id="5722172">:=</span>&nbsp;<span class="ident" id="5722175">reflect</span><span class="op" id="5722182">.</span><span class="ident" id="5722183">ValueOf</span><span class="op" id="5722190">(</span><span class="ident" id="5722191">arg</span><span class="op" id="5722194">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722198">k2</span><span class="op" id="5722200">,</span>&nbsp;<span class="ident" id="5722202">err</span>&nbsp;<span class="op" id="5722206">:=</span>&nbsp;<span class="ident" id="5722209">basicKind</span><span class="op" id="5722218">(</span><span class="ident" id="5722219">v2</span><span class="op" id="5722221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722225">if</span>&nbsp;<span class="ident" id="5722228">err</span>&nbsp;<span class="op" id="5722232">!=</span>&nbsp;<span class="ident" id="5722235">nil</span>&nbsp;<span class="op" id="5722239">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722244">return</span>&nbsp;<span class="builtintype" id="5722251">false</span><span class="op" id="5722256">,</span>&nbsp;<span class="ident" id="5722258">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722268">truth</span>&nbsp;<span class="op" id="5722274">:=</span>&nbsp;<span class="builtintype" id="5722277">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722285">if</span>&nbsp;<span class="ident" id="5722288">k1</span>&nbsp;<span class="op" id="5722291">!=</span>&nbsp;<span class="ident" id="5722294">k2</span>&nbsp;<span class="op" id="5722297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5722302">//&nbsp;Special&nbsp;case:&nbsp;Can&nbsp;compare&nbsp;integer&nbsp;values&nbsp;regardless&nbsp;of&nbsp;type&#39;s&nbsp;sign.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722376">switch</span>&nbsp;<span class="op" id="5722383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722388">case</span>&nbsp;<span class="ident" id="5722393">k1</span>&nbsp;<span class="op" id="5722396">==</span>&nbsp;<span class="ident" id="5722399">intKind</span>&nbsp;<span class="op" id="5722407">&amp;&amp;</span>&nbsp;<span class="ident" id="5722410">k2</span>&nbsp;<span class="op" id="5722413">==</span>&nbsp;<span class="ident" id="5722416">uintKind</span><span class="op" id="5722424">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722430">truth</span>&nbsp;<span class="op" id="5722436">=</span>&nbsp;<span class="ident" id="5722438">v1</span><span class="op" id="5722440">.</span><span class="ident" id="5722441">Int</span><span class="op" id="5722444">(</span><span class="op" id="5722445">)</span>&nbsp;<span class="op" id="5722447">&gt;=</span>&nbsp;<span class="num" id="5722450">0</span>&nbsp;<span class="op" id="5722452">&amp;&amp;</span>&nbsp;<span class="ident" id="5722455">uint64</span><span class="op" id="5722461">(</span><span class="ident" id="5722462">v1</span><span class="op" id="5722464">.</span><span class="ident" id="5722465">Int</span><span class="op" id="5722468">(</span><span class="op" id="5722469">)</span><span class="op" id="5722470">)</span>&nbsp;<span class="op" id="5722472">==</span>&nbsp;<span class="ident" id="5722475">v2</span><span class="op" id="5722477">.</span><span class="ident" id="5722478">Uint</span><span class="op" id="5722482">(</span><span class="op" id="5722483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722488">case</span>&nbsp;<span class="ident" id="5722493">k1</span>&nbsp;<span class="op" id="5722496">==</span>&nbsp;<span class="ident" id="5722499">uintKind</span>&nbsp;<span class="op" id="5722508">&amp;&amp;</span>&nbsp;<span class="ident" id="5722511">k2</span>&nbsp;<span class="op" id="5722514">==</span>&nbsp;<span class="ident" id="5722517">intKind</span><span class="op" id="5722524">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722530">truth</span>&nbsp;<span class="op" id="5722536">=</span>&nbsp;<span class="ident" id="5722538">v2</span><span class="op" id="5722540">.</span><span class="ident" id="5722541">Int</span><span class="op" id="5722544">(</span><span class="op" id="5722545">)</span>&nbsp;<span class="op" id="5722547">&gt;=</span>&nbsp;<span class="num" id="5722550">0</span>&nbsp;<span class="op" id="5722552">&amp;&amp;</span>&nbsp;<span class="ident" id="5722555">v1</span><span class="op" id="5722557">.</span><span class="ident" id="5722558">Uint</span><span class="op" id="5722562">(</span><span class="op" id="5722563">)</span>&nbsp;<span class="op" id="5722565">==</span>&nbsp;<span class="ident" id="5722568">uint64</span><span class="op" id="5722574">(</span><span class="ident" id="5722575">v2</span><span class="op" id="5722577">.</span><span class="ident" id="5722578">Int</span><span class="op" id="5722581">(</span><span class="op" id="5722582">)</span><span class="op" id="5722583">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722588">default</span><span class="op" id="5722595">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722601">return</span>&nbsp;<span class="builtintype" id="5722608">false</span><span class="op" id="5722613">,</span>&nbsp;<span class="ident" id="5722615">errBadComparison</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5722639">}</span>&nbsp;<span class="keyword" id="5722641">else</span>&nbsp;<span class="op" id="5722646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722651">switch</span>&nbsp;<span class="ident" id="5722658">k1</span>&nbsp;<span class="op" id="5722661">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722666">case</span>&nbsp;<span class="ident" id="5722671">boolKind</span><span class="op" id="5722679">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722685">truth</span>&nbsp;<span class="op" id="5722691">=</span>&nbsp;<span class="ident" id="5722693">v1</span><span class="op" id="5722695">.</span><span class="ident" id="5722696">Bool</span><span class="op" id="5722700">(</span><span class="op" id="5722701">)</span>&nbsp;<span class="op" id="5722703">==</span>&nbsp;<span class="ident" id="5722706">v2</span><span class="op" id="5722708">.</span><span class="ident" id="5722709">Bool</span><span class="op" id="5722713">(</span><span class="op" id="5722714">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722719">case</span>&nbsp;<span class="ident" id="5722724">complexKind</span><span class="op" id="5722735">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722741">truth</span>&nbsp;<span class="op" id="5722747">=</span>&nbsp;<span class="ident" id="5722749">v1</span><span class="op" id="5722751">.</span><span class="ident" id="5722752">Complex</span><span class="op" id="5722759">(</span><span class="op" id="5722760">)</span>&nbsp;<span class="op" id="5722762">==</span>&nbsp;<span class="ident" id="5722765">v2</span><span class="op" id="5722767">.</span><span class="ident" id="5722768">Complex</span><span class="op" id="5722775">(</span><span class="op" id="5722776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722781">case</span>&nbsp;<span class="ident" id="5722786">floatKind</span><span class="op" id="5722795">:</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722801">truth</span>&nbsp;<span class="op" id="5722807">=</span>&nbsp;<span class="ident" id="5722809">v1</span><span class="op" id="5722811">.</span><span class="ident" id="5722812">Float</span><span class="op" id="5722817">(</span><span class="op" id="5722818">)</span>&nbsp;<span class="op" id="5722820">==</span>&nbsp;<span class="ident" id="5722823">v2</span><span class="op" id="5722825">.</span><span class="ident" id="5722826">Float</span><span class="op" id="5722831">(</span><span class="op" id="5722832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722837">case</span>&nbsp;<span class="ident" id="5722842">intKind</span><span class="op" id="5722849">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722855">truth</span>&nbsp;<span class="op" id="5722861">=</span>&nbsp;<span class="ident" id="5722863">v1</span><span class="op" id="5722865">.</span><span class="ident" id="5722866">Int</span><span class="op" id="5722869">(</span><span class="op" id="5722870">)</span>&nbsp;<span class="op" id="5722872">==</span>&nbsp;<span class="ident" id="5722875">v2</span><span class="op" id="5722877">.</span><span class="ident" id="5722878">Int</span><span class="op" id="5722881">(</span><span class="op" id="5722882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722887">case</span>&nbsp;<span class="ident" id="5722892">stringKind</span><span class="op" id="5722902">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722908">truth</span>&nbsp;<span class="op" id="5722914">=</span>&nbsp;<span class="ident" id="5722916">v1</span><span class="op" id="5722918">.</span><span class="ident" id="5722919">String</span><span class="op" id="5722925">(</span><span class="op" id="5722926">)</span>&nbsp;<span class="op" id="5722928">==</span>&nbsp;<span class="ident" id="5722931">v2</span><span class="op" id="5722933">.</span><span class="ident" id="5722934">String</span><span class="op" id="5722940">(</span><span class="op" id="5722941">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722946">case</span>&nbsp;<span class="ident" id="5722951">uintKind</span><span class="op" id="5722959">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5722965">truth</span>&nbsp;<span class="op" id="5722971">=</span>&nbsp;<span class="ident" id="5722973">v1</span><span class="op" id="5722975">.</span><span class="ident" id="5722976">Uint</span><span class="op" id="5722980">(</span><span class="op" id="5722981">)</span>&nbsp;<span class="op" id="5722983">==</span>&nbsp;<span class="ident" id="5722986">v2</span><span class="op" id="5722988">.</span><span class="ident" id="5722989">Uint</span><span class="op" id="5722993">(</span><span class="op" id="5722994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5722999">default</span><span class="op" id="5723006">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5723012">panic</span><span class="op" id="5723017">(</span><span class="string" id="5723018">&#34;invalid&nbsp;kind&#34;</span><span class="op" id="5723032">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723037">}</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723045">if</span>&nbsp;<span class="ident" id="5723048">truth</span>&nbsp;<span class="op" id="5723054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723059">return</span>&nbsp;<span class="builtintype" id="5723066">true</span><span class="op" id="5723070">,</span>&nbsp;<span class="ident" id="5723072">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723078">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723081">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723084">return</span>&nbsp;<span class="builtintype" id="5723091">false</span><span class="op" id="5723096">,</span>&nbsp;<span class="ident" id="5723098">nil</span><br>
<span class="lineno"></span><span class="op" id="5723102">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5723105">//&nbsp;ne&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;!=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="5723144">func</span>&nbsp;<span class="ident" id="5723149">ne</span><span class="op" id="5723151">(</span><span class="ident" id="5723152">arg1</span><span class="op" id="5723156">,</span>&nbsp;<span class="ident" id="5723158">arg2</span>&nbsp;<span class="keyword" id="5723163">interface</span><span class="op" id="5723172">{</span><span class="op" id="5723173">}</span><span class="op" id="5723174">)</span>&nbsp;<span class="op" id="5723176">(</span><span class="builtintype" id="5723177">bool</span><span class="op" id="5723181">,</span>&nbsp;<span class="builtintype" id="5723183">error</span><span class="op" id="5723188">)</span>&nbsp;<span class="op" id="5723190">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5723193">//&nbsp;!=&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;==.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723222">equal</span><span class="op" id="5723227">,</span>&nbsp;<span class="ident" id="5723229">err</span>&nbsp;<span class="op" id="5723233">:=</span>&nbsp;<span class="ident" id="5723236">eq</span><span class="op" id="5723238">(</span><span class="ident" id="5723239">arg1</span><span class="op" id="5723243">,</span>&nbsp;<span class="ident" id="5723245">arg2</span><span class="op" id="5723249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723252">return</span>&nbsp;<span class="op" id="5723259">!</span><span class="ident" id="5723260">equal</span><span class="op" id="5723265">,</span>&nbsp;<span class="ident" id="5723267">err</span><br>
<span class="lineno"></span><span class="op" id="5723271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">360</span><span class="comment" id="5723274">//&nbsp;lt&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;&lt;&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="5723312">func</span>&nbsp;<span class="ident" id="5723317">lt</span><span class="op" id="5723319">(</span><span class="ident" id="5723320">arg1</span><span class="op" id="5723324">,</span>&nbsp;<span class="ident" id="5723326">arg2</span>&nbsp;<span class="keyword" id="5723331">interface</span><span class="op" id="5723340">{</span><span class="op" id="5723341">}</span><span class="op" id="5723342">)</span>&nbsp;<span class="op" id="5723344">(</span><span class="builtintype" id="5723345">bool</span><span class="op" id="5723349">,</span>&nbsp;<span class="builtintype" id="5723351">error</span><span class="op" id="5723356">)</span>&nbsp;<span class="op" id="5723358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723361">v1</span>&nbsp;<span class="op" id="5723364">:=</span>&nbsp;<span class="ident" id="5723367">reflect</span><span class="op" id="5723374">.</span><span class="ident" id="5723375">ValueOf</span><span class="op" id="5723382">(</span><span class="ident" id="5723383">arg1</span><span class="op" id="5723387">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723390">k1</span><span class="op" id="5723392">,</span>&nbsp;<span class="ident" id="5723394">err</span>&nbsp;<span class="op" id="5723398">:=</span>&nbsp;<span class="ident" id="5723401">basicKind</span><span class="op" id="5723410">(</span><span class="ident" id="5723411">v1</span><span class="op" id="5723413">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723416">if</span>&nbsp;<span class="ident" id="5723419">err</span>&nbsp;<span class="op" id="5723423">!=</span>&nbsp;<span class="ident" id="5723426">nil</span>&nbsp;<span class="op" id="5723430">{</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723434">return</span>&nbsp;<span class="builtintype" id="5723441">false</span><span class="op" id="5723446">,</span>&nbsp;<span class="ident" id="5723448">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723453">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723456">v2</span>&nbsp;<span class="op" id="5723459">:=</span>&nbsp;<span class="ident" id="5723462">reflect</span><span class="op" id="5723469">.</span><span class="ident" id="5723470">ValueOf</span><span class="op" id="5723477">(</span><span class="ident" id="5723478">arg2</span><span class="op" id="5723482">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723485">k2</span><span class="op" id="5723487">,</span>&nbsp;<span class="ident" id="5723489">err</span>&nbsp;<span class="op" id="5723493">:=</span>&nbsp;<span class="ident" id="5723496">basicKind</span><span class="op" id="5723505">(</span><span class="ident" id="5723506">v2</span><span class="op" id="5723508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723511">if</span>&nbsp;<span class="ident" id="5723514">err</span>&nbsp;<span class="op" id="5723518">!=</span>&nbsp;<span class="ident" id="5723521">nil</span>&nbsp;<span class="op" id="5723525">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723529">return</span>&nbsp;<span class="builtintype" id="5723536">false</span><span class="op" id="5723541">,</span>&nbsp;<span class="ident" id="5723543">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723551">truth</span>&nbsp;<span class="op" id="5723557">:=</span>&nbsp;<span class="builtintype" id="5723560">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723567">if</span>&nbsp;<span class="ident" id="5723570">k1</span>&nbsp;<span class="op" id="5723573">!=</span>&nbsp;<span class="ident" id="5723576">k2</span>&nbsp;<span class="op" id="5723579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5723583">//&nbsp;Special&nbsp;case:&nbsp;Can&nbsp;compare&nbsp;integer&nbsp;values&nbsp;regardless&nbsp;of&nbsp;type&#39;s&nbsp;sign.</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723656">switch</span>&nbsp;<span class="op" id="5723663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723667">case</span>&nbsp;<span class="ident" id="5723672">k1</span>&nbsp;<span class="op" id="5723675">==</span>&nbsp;<span class="ident" id="5723678">intKind</span>&nbsp;<span class="op" id="5723686">&amp;&amp;</span>&nbsp;<span class="ident" id="5723689">k2</span>&nbsp;<span class="op" id="5723692">==</span>&nbsp;<span class="ident" id="5723695">uintKind</span><span class="op" id="5723703">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723708">truth</span>&nbsp;<span class="op" id="5723714">=</span>&nbsp;<span class="ident" id="5723716">v1</span><span class="op" id="5723718">.</span><span class="ident" id="5723719">Int</span><span class="op" id="5723722">(</span><span class="op" id="5723723">)</span>&nbsp;<span class="op" id="5723725">&lt;</span>&nbsp;<span class="num" id="5723727">0</span>&nbsp;<span class="op" id="5723729">||</span>&nbsp;<span class="ident" id="5723732">uint64</span><span class="op" id="5723738">(</span><span class="ident" id="5723739">v1</span><span class="op" id="5723741">.</span><span class="ident" id="5723742">Int</span><span class="op" id="5723745">(</span><span class="op" id="5723746">)</span><span class="op" id="5723747">)</span>&nbsp;<span class="op" id="5723749">&lt;</span>&nbsp;<span class="ident" id="5723751">v2</span><span class="op" id="5723753">.</span><span class="ident" id="5723754">Uint</span><span class="op" id="5723758">(</span><span class="op" id="5723759">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723763">case</span>&nbsp;<span class="ident" id="5723768">k1</span>&nbsp;<span class="op" id="5723771">==</span>&nbsp;<span class="ident" id="5723774">uintKind</span>&nbsp;<span class="op" id="5723783">&amp;&amp;</span>&nbsp;<span class="ident" id="5723786">k2</span>&nbsp;<span class="op" id="5723789">==</span>&nbsp;<span class="ident" id="5723792">intKind</span><span class="op" id="5723799">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5723804">truth</span>&nbsp;<span class="op" id="5723810">=</span>&nbsp;<span class="ident" id="5723812">v2</span><span class="op" id="5723814">.</span><span class="ident" id="5723815">Int</span><span class="op" id="5723818">(</span><span class="op" id="5723819">)</span>&nbsp;<span class="op" id="5723821">&gt;=</span>&nbsp;<span class="num" id="5723824">0</span>&nbsp;<span class="op" id="5723826">&amp;&amp;</span>&nbsp;<span class="ident" id="5723829">v1</span><span class="op" id="5723831">.</span><span class="ident" id="5723832">Uint</span><span class="op" id="5723836">(</span><span class="op" id="5723837">)</span>&nbsp;<span class="op" id="5723839">&lt;</span>&nbsp;<span class="ident" id="5723841">uint64</span><span class="op" id="5723847">(</span><span class="ident" id="5723848">v2</span><span class="op" id="5723850">.</span><span class="ident" id="5723851">Int</span><span class="op" id="5723854">(</span><span class="op" id="5723855">)</span><span class="op" id="5723856">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723860">default</span><span class="op" id="5723867">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723872">return</span>&nbsp;<span class="builtintype" id="5723879">false</span><span class="op" id="5723884">,</span>&nbsp;<span class="ident" id="5723886">errBadComparison</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723905">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5723908">}</span>&nbsp;<span class="keyword" id="5723910">else</span>&nbsp;<span class="op" id="5723915">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723919">switch</span>&nbsp;<span class="ident" id="5723926">k1</span>&nbsp;<span class="op" id="5723929">{</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723933">case</span>&nbsp;<span class="ident" id="5723938">boolKind</span><span class="op" id="5723946">,</span>&nbsp;<span class="ident" id="5723948">complexKind</span><span class="op" id="5723959">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5723964">return</span>&nbsp;<span class="builtintype" id="5723971">false</span><span class="op" id="5723976">,</span>&nbsp;<span class="ident" id="5723978">errBadComparisonType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724001">case</span>&nbsp;<span class="ident" id="5724006">floatKind</span><span class="op" id="5724015">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724020">truth</span>&nbsp;<span class="op" id="5724026">=</span>&nbsp;<span class="ident" id="5724028">v1</span><span class="op" id="5724030">.</span><span class="ident" id="5724031">Float</span><span class="op" id="5724036">(</span><span class="op" id="5724037">)</span>&nbsp;<span class="op" id="5724039">&lt;</span>&nbsp;<span class="ident" id="5724041">v2</span><span class="op" id="5724043">.</span><span class="ident" id="5724044">Float</span><span class="op" id="5724049">(</span><span class="op" id="5724050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724054">case</span>&nbsp;<span class="ident" id="5724059">intKind</span><span class="op" id="5724066">:</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724071">truth</span>&nbsp;<span class="op" id="5724077">=</span>&nbsp;<span class="ident" id="5724079">v1</span><span class="op" id="5724081">.</span><span class="ident" id="5724082">Int</span><span class="op" id="5724085">(</span><span class="op" id="5724086">)</span>&nbsp;<span class="op" id="5724088">&lt;</span>&nbsp;<span class="ident" id="5724090">v2</span><span class="op" id="5724092">.</span><span class="ident" id="5724093">Int</span><span class="op" id="5724096">(</span><span class="op" id="5724097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724101">case</span>&nbsp;<span class="ident" id="5724106">stringKind</span><span class="op" id="5724116">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724121">truth</span>&nbsp;<span class="op" id="5724127">=</span>&nbsp;<span class="ident" id="5724129">v1</span><span class="op" id="5724131">.</span><span class="ident" id="5724132">String</span><span class="op" id="5724138">(</span><span class="op" id="5724139">)</span>&nbsp;<span class="op" id="5724141">&lt;</span>&nbsp;<span class="ident" id="5724143">v2</span><span class="op" id="5724145">.</span><span class="ident" id="5724146">String</span><span class="op" id="5724152">(</span><span class="op" id="5724153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724157">case</span>&nbsp;<span class="ident" id="5724162">uintKind</span><span class="op" id="5724170">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724175">truth</span>&nbsp;<span class="op" id="5724181">=</span>&nbsp;<span class="ident" id="5724183">v1</span><span class="op" id="5724185">.</span><span class="ident" id="5724186">Uint</span><span class="op" id="5724190">(</span><span class="op" id="5724191">)</span>&nbsp;<span class="op" id="5724193">&lt;</span>&nbsp;<span class="ident" id="5724195">v2</span><span class="op" id="5724197">.</span><span class="ident" id="5724198">Uint</span><span class="op" id="5724202">(</span><span class="op" id="5724203">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724207">default</span><span class="op" id="5724214">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="5724219">panic</span><span class="op" id="5724224">(</span><span class="string" id="5724225">&#34;invalid&nbsp;kind&#34;</span><span class="op" id="5724239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724243">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724249">return</span>&nbsp;<span class="ident" id="5724256">truth</span><span class="op" id="5724261">,</span>&nbsp;<span class="ident" id="5724263">nil</span><br>
<span class="lineno">400</span><span class="op" id="5724267">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5724270">//&nbsp;le&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;&lt;=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="5724307">func</span>&nbsp;<span class="ident" id="5724312">le</span><span class="op" id="5724314">(</span><span class="ident" id="5724315">arg1</span><span class="op" id="5724319">,</span>&nbsp;<span class="ident" id="5724321">arg2</span>&nbsp;<span class="keyword" id="5724326">interface</span><span class="op" id="5724335">{</span><span class="op" id="5724336">}</span><span class="op" id="5724337">)</span>&nbsp;<span class="op" id="5724339">(</span><span class="builtintype" id="5724340">bool</span><span class="op" id="5724344">,</span>&nbsp;<span class="builtintype" id="5724346">error</span><span class="op" id="5724351">)</span>&nbsp;<span class="op" id="5724353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5724356">//&nbsp;&lt;=&nbsp;is&nbsp;&lt;&nbsp;or&nbsp;==.</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724375">lessThan</span><span class="op" id="5724383">,</span>&nbsp;<span class="ident" id="5724385">err</span>&nbsp;<span class="op" id="5724389">:=</span>&nbsp;<span class="ident" id="5724392">lt</span><span class="op" id="5724394">(</span><span class="ident" id="5724395">arg1</span><span class="op" id="5724399">,</span>&nbsp;<span class="ident" id="5724401">arg2</span><span class="op" id="5724405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724408">if</span>&nbsp;<span class="ident" id="5724411">lessThan</span>&nbsp;<span class="op" id="5724420">||</span>&nbsp;<span class="ident" id="5724423">err</span>&nbsp;<span class="op" id="5724427">!=</span>&nbsp;<span class="ident" id="5724430">nil</span>&nbsp;<span class="op" id="5724434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724438">return</span>&nbsp;<span class="ident" id="5724445">lessThan</span><span class="op" id="5724453">,</span>&nbsp;<span class="ident" id="5724455">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724460">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724463">return</span>&nbsp;<span class="ident" id="5724470">eq</span><span class="op" id="5724472">(</span><span class="ident" id="5724473">arg1</span><span class="op" id="5724477">,</span>&nbsp;<span class="ident" id="5724479">arg2</span><span class="op" id="5724483">)</span><br>
<span class="lineno">410</span><span class="op" id="5724485">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5724488">//&nbsp;gt&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;&gt;&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="5724526">func</span>&nbsp;<span class="ident" id="5724531">gt</span><span class="op" id="5724533">(</span><span class="ident" id="5724534">arg1</span><span class="op" id="5724538">,</span>&nbsp;<span class="ident" id="5724540">arg2</span>&nbsp;<span class="keyword" id="5724545">interface</span><span class="op" id="5724554">{</span><span class="op" id="5724555">}</span><span class="op" id="5724556">)</span>&nbsp;<span class="op" id="5724558">(</span><span class="builtintype" id="5724559">bool</span><span class="op" id="5724563">,</span>&nbsp;<span class="builtintype" id="5724565">error</span><span class="op" id="5724570">)</span>&nbsp;<span class="op" id="5724572">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5724575">//&nbsp;&gt;&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;&lt;=.</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724603">lessOrEqual</span><span class="op" id="5724614">,</span>&nbsp;<span class="ident" id="5724616">err</span>&nbsp;<span class="op" id="5724620">:=</span>&nbsp;<span class="ident" id="5724623">le</span><span class="op" id="5724625">(</span><span class="ident" id="5724626">arg1</span><span class="op" id="5724630">,</span>&nbsp;<span class="ident" id="5724632">arg2</span><span class="op" id="5724636">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724639">if</span>&nbsp;<span class="ident" id="5724642">err</span>&nbsp;<span class="op" id="5724646">!=</span>&nbsp;<span class="ident" id="5724649">nil</span>&nbsp;<span class="op" id="5724653">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724657">return</span>&nbsp;<span class="builtintype" id="5724664">false</span><span class="op" id="5724669">,</span>&nbsp;<span class="ident" id="5724671">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724679">return</span>&nbsp;<span class="op" id="5724686">!</span><span class="ident" id="5724687">lessOrEqual</span><span class="op" id="5724698">,</span>&nbsp;<span class="ident" id="5724700">nil</span><br>
<span class="lineno">420</span><span class="op" id="5724704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5724707">//&nbsp;ge&nbsp;evaluates&nbsp;the&nbsp;comparison&nbsp;a&nbsp;&gt;=&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="5724746">func</span>&nbsp;<span class="ident" id="5724751">ge</span><span class="op" id="5724753">(</span><span class="ident" id="5724754">arg1</span><span class="op" id="5724758">,</span>&nbsp;<span class="ident" id="5724760">arg2</span>&nbsp;<span class="keyword" id="5724765">interface</span><span class="op" id="5724774">{</span><span class="op" id="5724775">}</span><span class="op" id="5724776">)</span>&nbsp;<span class="op" id="5724778">(</span><span class="builtintype" id="5724779">bool</span><span class="op" id="5724783">,</span>&nbsp;<span class="builtintype" id="5724785">error</span><span class="op" id="5724790">)</span>&nbsp;<span class="op" id="5724792">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5724795">//&nbsp;&gt;=&nbsp;is&nbsp;the&nbsp;inverse&nbsp;of&nbsp;&lt;.</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724823">lessThan</span><span class="op" id="5724831">,</span>&nbsp;<span class="ident" id="5724833">err</span>&nbsp;<span class="op" id="5724837">:=</span>&nbsp;<span class="ident" id="5724840">lt</span><span class="op" id="5724842">(</span><span class="ident" id="5724843">arg1</span><span class="op" id="5724847">,</span>&nbsp;<span class="ident" id="5724849">arg2</span><span class="op" id="5724853">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724856">if</span>&nbsp;<span class="ident" id="5724859">err</span>&nbsp;<span class="op" id="5724863">!=</span>&nbsp;<span class="ident" id="5724866">nil</span>&nbsp;<span class="op" id="5724870">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724874">return</span>&nbsp;<span class="builtintype" id="5724881">false</span><span class="op" id="5724886">,</span>&nbsp;<span class="ident" id="5724888">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5724893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5724896">return</span>&nbsp;<span class="op" id="5724903">!</span><span class="ident" id="5724904">lessThan</span><span class="op" id="5724912">,</span>&nbsp;<span class="ident" id="5724914">nil</span><br>
<span class="lineno">430</span><span class="op" id="5724918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5724921">//&nbsp;HTML&nbsp;escaping.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5724940">var</span>&nbsp;<span class="op" id="5724944">(</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5724947">htmlQuot</span>&nbsp;<span class="op" id="5724956">=</span>&nbsp;<span class="op" id="5724958">[</span><span class="op" id="5724959">]</span><span class="builtintype" id="5724960">byte</span><span class="op" id="5724964">(</span><span class="string" id="5724965">&#34;&amp;#34;&#34;</span><span class="op" id="5724972">)</span>&nbsp;<span class="comment" id="5724974">//&nbsp;shorter&nbsp;than&nbsp;&#34;&amp;quot;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725000">htmlApos</span>&nbsp;<span class="op" id="5725009">=</span>&nbsp;<span class="op" id="5725011">[</span><span class="op" id="5725012">]</span><span class="builtintype" id="5725013">byte</span><span class="op" id="5725017">(</span><span class="string" id="5725018">&#34;&amp;#39;&#34;</span><span class="op" id="5725025">)</span>&nbsp;<span class="comment" id="5725027">//&nbsp;shorter&nbsp;than&nbsp;&#34;&amp;apos;&#34;&nbsp;and&nbsp;apos&nbsp;was&nbsp;not&nbsp;in&nbsp;HTML&nbsp;until&nbsp;HTML5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725090">htmlAmp</span>&nbsp;&nbsp;<span class="op" id="5725099">=</span>&nbsp;<span class="op" id="5725101">[</span><span class="op" id="5725102">]</span><span class="builtintype" id="5725103">byte</span><span class="op" id="5725107">(</span><span class="string" id="5725108">&#34;&amp;amp;&#34;</span><span class="op" id="5725115">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725118">htmlLt</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5725127">=</span>&nbsp;<span class="op" id="5725129">[</span><span class="op" id="5725130">]</span><span class="builtintype" id="5725131">byte</span><span class="op" id="5725135">(</span><span class="string" id="5725136">&#34;&amp;lt;&#34;</span><span class="op" id="5725142">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725145">htmlGt</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5725154">=</span>&nbsp;<span class="op" id="5725156">[</span><span class="op" id="5725157">]</span><span class="builtintype" id="5725158">byte</span><span class="op" id="5725162">(</span><span class="string" id="5725163">&#34;&amp;gt;&#34;</span><span class="op" id="5725169">)</span><br>
<span class="lineno">440</span><span class="op" id="5725171">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5725174">//&nbsp;HTMLEscape&nbsp;writes&nbsp;to&nbsp;w&nbsp;the&nbsp;escaped&nbsp;HTML&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="5725254">func</span>&nbsp;<span class="ident" id="5725259">HTMLEscape</span><span class="op" id="5725269">(</span><span class="ident" id="5725270">w</span>&nbsp;<span class="ident" id="5725272">io</span><span class="op" id="5725274">.</span><span class="ident" id="5725275">Writer</span><span class="op" id="5725281">,</span>&nbsp;<span class="ident" id="5725283">b</span>&nbsp;<span class="op" id="5725285">[</span><span class="op" id="5725286">]</span><span class="builtintype" id="5725287">byte</span><span class="op" id="5725291">)</span>&nbsp;<span class="op" id="5725293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725296">last</span>&nbsp;<span class="op" id="5725301">:=</span>&nbsp;<span class="num" id="5725304">0</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725307">for</span>&nbsp;<span class="ident" id="5725311">i</span><span class="op" id="5725312">,</span>&nbsp;<span class="ident" id="5725314">c</span>&nbsp;<span class="op" id="5725316">:=</span>&nbsp;<span class="keyword" id="5725319">range</span>&nbsp;<span class="ident" id="5725325">b</span>&nbsp;<span class="op" id="5725327">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725331">var</span>&nbsp;<span class="ident" id="5725335">html</span>&nbsp;<span class="op" id="5725340">[</span><span class="op" id="5725341">]</span><span class="builtintype" id="5725342">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725349">switch</span>&nbsp;<span class="ident" id="5725356">c</span>&nbsp;<span class="op" id="5725358">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725362">case</span>&nbsp;<span class="string" id="5725367">&#39;&#34;&#39;</span><span class="op" id="5725370">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725375">html</span>&nbsp;<span class="op" id="5725380">=</span>&nbsp;<span class="ident" id="5725382">htmlQuot</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725393">case</span>&nbsp;<span class="string" id="5725398">&#39;\&#39;&#39;</span><span class="op" id="5725402">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725407">html</span>&nbsp;<span class="op" id="5725412">=</span>&nbsp;<span class="ident" id="5725414">htmlApos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725425">case</span>&nbsp;<span class="string" id="5725430">&#39;&amp;&#39;</span><span class="op" id="5725433">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725438">html</span>&nbsp;<span class="op" id="5725443">=</span>&nbsp;<span class="ident" id="5725445">htmlAmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725455">case</span>&nbsp;<span class="string" id="5725460">&#39;&lt;&#39;</span><span class="op" id="5725463">:</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725468">html</span>&nbsp;<span class="op" id="5725473">=</span>&nbsp;<span class="ident" id="5725475">htmlLt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725484">case</span>&nbsp;<span class="string" id="5725489">&#39;&gt;&#39;</span><span class="op" id="5725492">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725497">html</span>&nbsp;<span class="op" id="5725502">=</span>&nbsp;<span class="ident" id="5725504">htmlGt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725513">default</span><span class="op" id="5725520">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725525">continue</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725540">w</span><span class="op" id="5725541">.</span><span class="ident" id="5725542">Write</span><span class="op" id="5725547">(</span><span class="ident" id="5725548">b</span><span class="op" id="5725549">[</span><span class="ident" id="5725550">last</span><span class="op" id="5725554">:</span><span class="ident" id="5725555">i</span><span class="op" id="5725556">]</span><span class="op" id="5725557">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725561">w</span><span class="op" id="5725562">.</span><span class="ident" id="5725563">Write</span><span class="op" id="5725568">(</span><span class="ident" id="5725569">html</span><span class="op" id="5725573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725577">last</span>&nbsp;<span class="op" id="5725582">=</span>&nbsp;<span class="ident" id="5725584">i</span>&nbsp;<span class="op" id="5725586">+</span>&nbsp;<span class="num" id="5725588">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725591">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725594">w</span><span class="op" id="5725595">.</span><span class="ident" id="5725596">Write</span><span class="op" id="5725601">(</span><span class="ident" id="5725602">b</span><span class="op" id="5725603">[</span><span class="ident" id="5725604">last</span><span class="op" id="5725608">:</span><span class="op" id="5725609">]</span><span class="op" id="5725610">)</span><br>
<span class="lineno"></span><span class="op" id="5725612">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5725615">//&nbsp;HTMLEscapeString&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;HTML&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5725697">func</span>&nbsp;<span class="ident" id="5725702">HTMLEscapeString</span><span class="op" id="5725718">(</span><span class="ident" id="5725719">s</span>&nbsp;<span class="builtintype" id="5725721">string</span><span class="op" id="5725727">)</span>&nbsp;<span class="builtintype" id="5725729">string</span>&nbsp;<span class="op" id="5725736">{</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5725739">//&nbsp;Avoid&nbsp;allocation&nbsp;if&nbsp;we&nbsp;can.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725771">if</span>&nbsp;<span class="ident" id="5725774">strings</span><span class="op" id="5725781">.</span><span class="ident" id="5725782">IndexAny</span><span class="op" id="5725790">(</span><span class="ident" id="5725791">s</span><span class="op" id="5725792">,</span>&nbsp;<span class="string" id="5725794">`&#39;&#34;&amp;&lt;&gt;`</span><span class="op" id="5725801">)</span>&nbsp;<span class="op" id="5725803">&lt;</span>&nbsp;<span class="num" id="5725805">0</span>&nbsp;<span class="op" id="5725807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725811">return</span>&nbsp;<span class="ident" id="5725818">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5725821">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725824">var</span>&nbsp;<span class="ident" id="5725828">b</span>&nbsp;<span class="ident" id="5725830">bytes</span><span class="op" id="5725835">.</span><span class="ident" id="5725836">Buffer</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5725844">HTMLEscape</span><span class="op" id="5725854">(</span><span class="op" id="5725855">&amp;</span><span class="ident" id="5725856">b</span><span class="op" id="5725857">,</span>&nbsp;<span class="op" id="5725859">[</span><span class="op" id="5725860">]</span><span class="builtintype" id="5725861">byte</span><span class="op" id="5725865">(</span><span class="ident" id="5725866">s</span><span class="op" id="5725867">)</span><span class="op" id="5725868">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5725871">return</span>&nbsp;<span class="ident" id="5725878">b</span><span class="op" id="5725879">.</span><span class="ident" id="5725880">String</span><span class="op" id="5725886">(</span><span class="op" id="5725887">)</span><br>
<span class="lineno"></span><span class="op" id="5725889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5725892">//&nbsp;HTMLEscaper&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;HTML&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;textual</span><br>
<span class="lineno">480</span><span class="comment" id="5725958">//&nbsp;representation&nbsp;of&nbsp;its&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="keyword" id="5725994">func</span>&nbsp;<span class="ident" id="5725999">HTMLEscaper</span><span class="op" id="5726010">(</span><span class="ident" id="5726011">args</span>&nbsp;<span class="op" id="5726016">...</span><span class="keyword" id="5726019">interface</span><span class="op" id="5726028">{</span><span class="op" id="5726029">}</span><span class="op" id="5726030">)</span>&nbsp;<span class="builtintype" id="5726032">string</span>&nbsp;<span class="op" id="5726039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726042">return</span>&nbsp;<span class="ident" id="5726049">HTMLEscapeString</span><span class="op" id="5726065">(</span><span class="ident" id="5726066">evalArgs</span><span class="op" id="5726074">(</span><span class="ident" id="5726075">args</span><span class="op" id="5726079">)</span><span class="op" id="5726080">)</span><br>
<span class="lineno"></span><span class="op" id="5726082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span><span class="comment" id="5726085">//&nbsp;JavaScript&nbsp;escaping.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5726110">var</span>&nbsp;<span class="op" id="5726114">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726117">jsLowUni</span>&nbsp;<span class="op" id="5726126">=</span>&nbsp;<span class="op" id="5726128">[</span><span class="op" id="5726129">]</span><span class="builtintype" id="5726130">byte</span><span class="op" id="5726134">(</span><span class="string" id="5726135">`\u00`</span><span class="op" id="5726141">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726144">hex</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5726153">=</span>&nbsp;<span class="op" id="5726155">[</span><span class="op" id="5726156">]</span><span class="builtintype" id="5726157">byte</span><span class="op" id="5726161">(</span><span class="string" id="5726162">&#34;0123456789ABCDEF&#34;</span><span class="op" id="5726180">)</span><br>
<span class="lineno">490</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726184">jsBackslash</span>&nbsp;<span class="op" id="5726196">=</span>&nbsp;<span class="op" id="5726198">[</span><span class="op" id="5726199">]</span><span class="builtintype" id="5726200">byte</span><span class="op" id="5726204">(</span><span class="string" id="5726205">`\\`</span><span class="op" id="5726209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726212">jsApos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5726224">=</span>&nbsp;<span class="op" id="5726226">[</span><span class="op" id="5726227">]</span><span class="builtintype" id="5726228">byte</span><span class="op" id="5726232">(</span><span class="string" id="5726233">`\&#39;`</span><span class="op" id="5726237">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726240">jsQuot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5726252">=</span>&nbsp;<span class="op" id="5726254">[</span><span class="op" id="5726255">]</span><span class="builtintype" id="5726256">byte</span><span class="op" id="5726260">(</span><span class="string" id="5726261">`\&#34;`</span><span class="op" id="5726265">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726268">jsLt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5726280">=</span>&nbsp;<span class="op" id="5726282">[</span><span class="op" id="5726283">]</span><span class="builtintype" id="5726284">byte</span><span class="op" id="5726288">(</span><span class="string" id="5726289">`\x3C`</span><span class="op" id="5726295">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726298">jsGt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="5726310">=</span>&nbsp;<span class="op" id="5726312">[</span><span class="op" id="5726313">]</span><span class="builtintype" id="5726314">byte</span><span class="op" id="5726318">(</span><span class="string" id="5726319">`\x3E`</span><span class="op" id="5726325">)</span><br>
<span class="lineno"></span><span class="op" id="5726327">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5726330">//&nbsp;JSEscape&nbsp;writes&nbsp;to&nbsp;w&nbsp;the&nbsp;escaped&nbsp;JavaScript&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;b.</span><br>
<span class="lineno"></span><span class="keyword" id="5726414">func</span>&nbsp;<span class="ident" id="5726419">JSEscape</span><span class="op" id="5726427">(</span><span class="ident" id="5726428">w</span>&nbsp;<span class="ident" id="5726430">io</span><span class="op" id="5726432">.</span><span class="ident" id="5726433">Writer</span><span class="op" id="5726439">,</span>&nbsp;<span class="ident" id="5726441">b</span>&nbsp;<span class="op" id="5726443">[</span><span class="op" id="5726444">]</span><span class="builtintype" id="5726445">byte</span><span class="op" id="5726449">)</span>&nbsp;<span class="op" id="5726451">{</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726454">last</span>&nbsp;<span class="op" id="5726459">:=</span>&nbsp;<span class="num" id="5726462">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726465">for</span>&nbsp;<span class="ident" id="5726469">i</span>&nbsp;<span class="op" id="5726471">:=</span>&nbsp;<span class="num" id="5726474">0</span><span class="op" id="5726475">;</span>&nbsp;<span class="ident" id="5726477">i</span>&nbsp;<span class="op" id="5726479">&lt;</span>&nbsp;<span class="builtinfunc" id="5726481">len</span><span class="op" id="5726484">(</span><span class="ident" id="5726485">b</span><span class="op" id="5726486">)</span><span class="op" id="5726487">;</span>&nbsp;<span class="ident" id="5726489">i</span><span class="op" id="5726490">++</span>&nbsp;<span class="op" id="5726493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726497">c</span>&nbsp;<span class="op" id="5726499">:=</span>&nbsp;<span class="ident" id="5726502">b</span><span class="op" id="5726503">[</span><span class="ident" id="5726504">i</span><span class="op" id="5726505">]</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726510">if</span>&nbsp;<span class="op" id="5726513">!</span><span class="ident" id="5726514">jsIsSpecial</span><span class="op" id="5726525">(</span><span class="builtintype" id="5726526">rune</span><span class="op" id="5726530">(</span><span class="ident" id="5726531">c</span><span class="op" id="5726532">)</span><span class="op" id="5726533">)</span>&nbsp;<span class="op" id="5726535">{</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5726540">//&nbsp;fast&nbsp;path:&nbsp;nothing&nbsp;to&nbsp;do</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726571">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5726582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726586">w</span><span class="op" id="5726587">.</span><span class="ident" id="5726588">Write</span><span class="op" id="5726593">(</span><span class="ident" id="5726594">b</span><span class="op" id="5726595">[</span><span class="ident" id="5726596">last</span><span class="op" id="5726600">:</span><span class="ident" id="5726601">i</span><span class="op" id="5726602">]</span><span class="op" id="5726603">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726608">if</span>&nbsp;<span class="ident" id="5726611">c</span>&nbsp;<span class="op" id="5726613">&lt;</span>&nbsp;<span class="ident" id="5726615">utf8</span><span class="op" id="5726619">.</span><span class="ident" id="5726620">RuneSelf</span>&nbsp;<span class="op" id="5726629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5726634">//&nbsp;Quotes,&nbsp;slashes&nbsp;and&nbsp;angle&nbsp;brackets&nbsp;get&nbsp;quoted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5726687">//&nbsp;Control&nbsp;characters&nbsp;get&nbsp;written&nbsp;as&nbsp;\u00XX.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726735">switch</span>&nbsp;<span class="ident" id="5726742">c</span>&nbsp;<span class="op" id="5726744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726749">case</span>&nbsp;<span class="string" id="5726754">&#39;\\&#39;</span><span class="op" id="5726758">:</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726764">w</span><span class="op" id="5726765">.</span><span class="ident" id="5726766">Write</span><span class="op" id="5726771">(</span><span class="ident" id="5726772">jsBackslash</span><span class="op" id="5726783">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726788">case</span>&nbsp;<span class="string" id="5726793">&#39;\&#39;&#39;</span><span class="op" id="5726797">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726803">w</span><span class="op" id="5726804">.</span><span class="ident" id="5726805">Write</span><span class="op" id="5726810">(</span><span class="ident" id="5726811">jsApos</span><span class="op" id="5726817">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726822">case</span>&nbsp;<span class="string" id="5726827">&#39;&#34;&#39;</span><span class="op" id="5726830">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726836">w</span><span class="op" id="5726837">.</span><span class="ident" id="5726838">Write</span><span class="op" id="5726843">(</span><span class="ident" id="5726844">jsQuot</span><span class="op" id="5726850">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726855">case</span>&nbsp;<span class="string" id="5726860">&#39;&lt;&#39;</span><span class="op" id="5726863">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726869">w</span><span class="op" id="5726870">.</span><span class="ident" id="5726871">Write</span><span class="op" id="5726876">(</span><span class="ident" id="5726877">jsLt</span><span class="op" id="5726881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726886">case</span>&nbsp;<span class="string" id="5726891">&#39;&gt;&#39;</span><span class="op" id="5726894">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726900">w</span><span class="op" id="5726901">.</span><span class="ident" id="5726902">Write</span><span class="op" id="5726907">(</span><span class="ident" id="5726908">jsGt</span><span class="op" id="5726912">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5726917">default</span><span class="op" id="5726924">:</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726930">w</span><span class="op" id="5726931">.</span><span class="ident" id="5726932">Write</span><span class="op" id="5726937">(</span><span class="ident" id="5726938">jsLowUni</span><span class="op" id="5726946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726952">t</span><span class="op" id="5726953">,</span>&nbsp;<span class="ident" id="5726955">b</span>&nbsp;<span class="op" id="5726957">:=</span>&nbsp;<span class="ident" id="5726960">c</span><span class="op" id="5726961">&gt;&gt;</span><span class="num" id="5726963">4</span><span class="op" id="5726964">,</span>&nbsp;<span class="ident" id="5726966">c</span><span class="op" id="5726967">&amp;</span><span class="num" id="5726968">0x0f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5726977">w</span><span class="op" id="5726978">.</span><span class="ident" id="5726979">Write</span><span class="op" id="5726984">(</span><span class="ident" id="5726985">hex</span><span class="op" id="5726988">[</span><span class="ident" id="5726989">t</span>&nbsp;<span class="op" id="5726991">:</span>&nbsp;<span class="ident" id="5726993">t</span><span class="op" id="5726994">+</span><span class="num" id="5726995">1</span><span class="op" id="5726996">]</span><span class="op" id="5726997">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727003">w</span><span class="op" id="5727004">.</span><span class="ident" id="5727005">Write</span><span class="op" id="5727010">(</span><span class="ident" id="5727011">hex</span><span class="op" id="5727014">[</span><span class="ident" id="5727015">b</span>&nbsp;<span class="op" id="5727017">:</span>&nbsp;<span class="ident" id="5727019">b</span><span class="op" id="5727020">+</span><span class="num" id="5727021">1</span><span class="op" id="5727022">]</span><span class="op" id="5727023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727028">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727032">}</span>&nbsp;<span class="keyword" id="5727034">else</span>&nbsp;<span class="op" id="5727039">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5727044">//&nbsp;Unicode&nbsp;rune.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727064">r</span><span class="op" id="5727065">,</span>&nbsp;<span class="ident" id="5727067">size</span>&nbsp;<span class="op" id="5727072">:=</span>&nbsp;<span class="ident" id="5727075">utf8</span><span class="op" id="5727079">.</span><span class="ident" id="5727080">DecodeRune</span><span class="op" id="5727090">(</span><span class="ident" id="5727091">b</span><span class="op" id="5727092">[</span><span class="ident" id="5727093">i</span><span class="op" id="5727094">:</span><span class="op" id="5727095">]</span><span class="op" id="5727096">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727101">if</span>&nbsp;<span class="ident" id="5727104">unicode</span><span class="op" id="5727111">.</span><span class="ident" id="5727112">IsPrint</span><span class="op" id="5727119">(</span><span class="ident" id="5727120">r</span><span class="op" id="5727121">)</span>&nbsp;<span class="op" id="5727123">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727129">w</span><span class="op" id="5727130">.</span><span class="ident" id="5727131">Write</span><span class="op" id="5727136">(</span><span class="ident" id="5727137">b</span><span class="op" id="5727138">[</span><span class="ident" id="5727139">i</span>&nbsp;<span class="op" id="5727141">:</span>&nbsp;<span class="ident" id="5727143">i</span><span class="op" id="5727144">+</span><span class="ident" id="5727145">size</span><span class="op" id="5727149">]</span><span class="op" id="5727150">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727155">}</span>&nbsp;<span class="keyword" id="5727157">else</span>&nbsp;<span class="op" id="5727162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727168">fmt</span><span class="op" id="5727171">.</span><span class="ident" id="5727172">Fprintf</span><span class="op" id="5727179">(</span><span class="ident" id="5727180">w</span><span class="op" id="5727181">,</span>&nbsp;<span class="string" id="5727183">&#34;\\u%04X&#34;</span><span class="op" id="5727192">,</span>&nbsp;<span class="ident" id="5727194">r</span><span class="op" id="5727195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727200">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727205">i</span>&nbsp;<span class="op" id="5727207">+=</span>&nbsp;<span class="ident" id="5727210">size</span>&nbsp;<span class="op" id="5727215">-</span>&nbsp;<span class="num" id="5727217">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727221">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727225">last</span>&nbsp;<span class="op" id="5727230">=</span>&nbsp;<span class="ident" id="5727232">i</span>&nbsp;<span class="op" id="5727234">+</span>&nbsp;<span class="num" id="5727236">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727242">w</span><span class="op" id="5727243">.</span><span class="ident" id="5727244">Write</span><span class="op" id="5727249">(</span><span class="ident" id="5727250">b</span><span class="op" id="5727251">[</span><span class="ident" id="5727252">last</span><span class="op" id="5727256">:</span><span class="op" id="5727257">]</span><span class="op" id="5727258">)</span><br>
<span class="lineno"></span><span class="op" id="5727260">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">545</span><span class="comment" id="5727263">//&nbsp;JSEscapeString&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;JavaScript&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;plain&nbsp;text&nbsp;data&nbsp;s.</span><br>
<span class="lineno"></span><span class="keyword" id="5727349">func</span>&nbsp;<span class="ident" id="5727354">JSEscapeString</span><span class="op" id="5727368">(</span><span class="ident" id="5727369">s</span>&nbsp;<span class="builtintype" id="5727371">string</span><span class="op" id="5727377">)</span>&nbsp;<span class="builtintype" id="5727379">string</span>&nbsp;<span class="op" id="5727386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5727389">//&nbsp;Avoid&nbsp;allocation&nbsp;if&nbsp;we&nbsp;can.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727421">if</span>&nbsp;<span class="ident" id="5727424">strings</span><span class="op" id="5727431">.</span><span class="ident" id="5727432">IndexFunc</span><span class="op" id="5727441">(</span><span class="ident" id="5727442">s</span><span class="op" id="5727443">,</span>&nbsp;<span class="ident" id="5727445">jsIsSpecial</span><span class="op" id="5727456">)</span>&nbsp;<span class="op" id="5727458">&lt;</span>&nbsp;<span class="num" id="5727460">0</span>&nbsp;<span class="op" id="5727462">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727466">return</span>&nbsp;<span class="ident" id="5727473">s</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727479">var</span>&nbsp;<span class="ident" id="5727483">b</span>&nbsp;<span class="ident" id="5727485">bytes</span><span class="op" id="5727490">.</span><span class="ident" id="5727491">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5727499">JSEscape</span><span class="op" id="5727507">(</span><span class="op" id="5727508">&amp;</span><span class="ident" id="5727509">b</span><span class="op" id="5727510">,</span>&nbsp;<span class="op" id="5727512">[</span><span class="op" id="5727513">]</span><span class="builtintype" id="5727514">byte</span><span class="op" id="5727518">(</span><span class="ident" id="5727519">s</span><span class="op" id="5727520">)</span><span class="op" id="5727521">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727524">return</span>&nbsp;<span class="ident" id="5727531">b</span><span class="op" id="5727532">.</span><span class="ident" id="5727533">String</span><span class="op" id="5727539">(</span><span class="op" id="5727540">)</span><br>
<span class="lineno"></span><span class="op" id="5727542">}</span><br>
<span class="lineno">555</span><br>
<span class="lineno"></span><span class="keyword" id="5727545">func</span>&nbsp;<span class="ident" id="5727550">jsIsSpecial</span><span class="op" id="5727561">(</span><span class="ident" id="5727562">r</span>&nbsp;<span class="builtintype" id="5727564">rune</span><span class="op" id="5727568">)</span>&nbsp;<span class="builtintype" id="5727570">bool</span>&nbsp;<span class="op" id="5727575">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727578">switch</span>&nbsp;<span class="ident" id="5727585">r</span>&nbsp;<span class="op" id="5727587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727590">case</span>&nbsp;<span class="string" id="5727595">&#39;\\&#39;</span><span class="op" id="5727599">,</span>&nbsp;<span class="string" id="5727601">&#39;\&#39;&#39;</span><span class="op" id="5727605">,</span>&nbsp;<span class="string" id="5727607">&#39;&#34;&#39;</span><span class="op" id="5727610">,</span>&nbsp;<span class="string" id="5727612">&#39;&lt;&#39;</span><span class="op" id="5727615">,</span>&nbsp;<span class="string" id="5727617">&#39;&gt;&#39;</span><span class="op" id="5727620">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727624">return</span>&nbsp;<span class="builtintype" id="5727631">true</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5727637">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727640">return</span>&nbsp;<span class="ident" id="5727647">r</span>&nbsp;<span class="op" id="5727649">&lt;</span>&nbsp;<span class="string" id="5727651">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="5727655">||</span>&nbsp;<span class="ident" id="5727658">utf8</span><span class="op" id="5727662">.</span><span class="ident" id="5727663">RuneSelf</span>&nbsp;<span class="op" id="5727672">&lt;=</span>&nbsp;<span class="ident" id="5727675">r</span><br>
<span class="lineno"></span><span class="op" id="5727677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5727680">//&nbsp;JSEscaper&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;JavaScript&nbsp;equivalent&nbsp;of&nbsp;the&nbsp;textual</span><br>
<span class="lineno">565</span><span class="comment" id="5727750">//&nbsp;representation&nbsp;of&nbsp;its&nbsp;arguments.</span><br>
<span class="lineno"></span><span class="keyword" id="5727786">func</span>&nbsp;<span class="ident" id="5727791">JSEscaper</span><span class="op" id="5727800">(</span><span class="ident" id="5727801">args</span>&nbsp;<span class="op" id="5727806">...</span><span class="keyword" id="5727809">interface</span><span class="op" id="5727818">{</span><span class="op" id="5727819">}</span><span class="op" id="5727820">)</span>&nbsp;<span class="builtintype" id="5727822">string</span>&nbsp;<span class="op" id="5727829">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5727832">return</span>&nbsp;<span class="ident" id="5727839">JSEscapeString</span><span class="op" id="5727853">(</span><span class="ident" id="5727854">evalArgs</span><span class="op" id="5727862">(</span><span class="ident" id="5727863">args</span><span class="op" id="5727867">)</span><span class="op" id="5727868">)</span><br>
<span class="lineno"></span><span class="op" id="5727870">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">570</span><span class="comment" id="5727873">//&nbsp;URLQueryEscaper&nbsp;returns&nbsp;the&nbsp;escaped&nbsp;value&nbsp;of&nbsp;the&nbsp;textual&nbsp;representation&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="5727951">//&nbsp;its&nbsp;arguments&nbsp;in&nbsp;a&nbsp;form&nbsp;suitable&nbsp;for&nbsp;embedding&nbsp;in&nbsp;a&nbsp;URL&nbsp;query.</span><br>
<span class="lineno"></span><span class="keyword" id="5728017">func</span>&nbsp;<span class="ident" id="5728022">URLQueryEscaper</span><span class="op" id="5728037">(</span><span class="ident" id="5728038">args</span>&nbsp;<span class="op" id="5728043">...</span><span class="keyword" id="5728046">interface</span><span class="op" id="5728055">{</span><span class="op" id="5728056">}</span><span class="op" id="5728057">)</span>&nbsp;<span class="builtintype" id="5728059">string</span>&nbsp;<span class="op" id="5728066">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5728069">return</span>&nbsp;<span class="ident" id="5728076">url</span><span class="op" id="5728079">.</span><span class="ident" id="5728080">QueryEscape</span><span class="op" id="5728091">(</span><span class="ident" id="5728092">evalArgs</span><span class="op" id="5728100">(</span><span class="ident" id="5728101">args</span><span class="op" id="5728105">)</span><span class="op" id="5728106">)</span><br>
<span class="lineno"></span><span class="op" id="5728108">}</span><br>
<span class="lineno">575</span><br>
<span class="lineno"></span><span class="comment" id="5728111">//&nbsp;evalArgs&nbsp;formats&nbsp;the&nbsp;list&nbsp;of&nbsp;arguments&nbsp;into&nbsp;a&nbsp;string.&nbsp;It&nbsp;is&nbsp;therefore&nbsp;equivalent&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="5728198">//&nbsp;&nbsp;&nbsp;&nbspfmt.Sprint(args...)</span><br>
<span class="lineno"></span><span class="comment" id="5728221">//&nbsp;except&nbsp;that&nbsp;each&nbsp;argument&nbsp;is&nbsp;indirected&nbsp;(if&nbsp;a&nbsp;pointer),&nbsp;as&nbsp;required,</span><br>
<span class="lineno"></span><span class="comment" id="5728293">//&nbsp;using&nbsp;the&nbsp;same&nbsp;rules&nbsp;as&nbsp;the&nbsp;default&nbsp;string&nbsp;evaluation&nbsp;during&nbsp;template</span><br>
<span class="lineno">580</span><span class="comment" id="5728366">//&nbsp;execution.</span><br>
<span class="lineno"></span><span class="keyword" id="5728380">func</span>&nbsp;<span class="ident" id="5728385">evalArgs</span><span class="op" id="5728393">(</span><span class="ident" id="5728394">args</span>&nbsp;<span class="op" id="5728399">[</span><span class="op" id="5728400">]</span><span class="keyword" id="5728401">interface</span><span class="op" id="5728410">{</span><span class="op" id="5728411">}</span><span class="op" id="5728412">)</span>&nbsp;<span class="builtintype" id="5728414">string</span>&nbsp;<span class="op" id="5728421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728424">ok</span>&nbsp;<span class="op" id="5728427">:=</span>&nbsp;<span class="builtintype" id="5728430">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5728437">var</span>&nbsp;<span class="ident" id="5728441">s</span>&nbsp;<span class="builtintype" id="5728443">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5728451">//&nbsp;Fast&nbsp;path&nbsp;for&nbsp;simple&nbsp;common&nbsp;case.</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5728489">if</span>&nbsp;<span class="builtinfunc" id="5728492">len</span><span class="op" id="5728495">(</span><span class="ident" id="5728496">args</span><span class="op" id="5728500">)</span>&nbsp;<span class="op" id="5728502">==</span>&nbsp;<span class="num" id="5728505">1</span>&nbsp;<span class="op" id="5728507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728511">s</span><span class="op" id="5728512">,</span>&nbsp;<span class="ident" id="5728514">ok</span>&nbsp;<span class="op" id="5728517">=</span>&nbsp;<span class="ident" id="5728519">args</span><span class="op" id="5728523">[</span><span class="num" id="5728524">0</span><span class="op" id="5728525">]</span><span class="op" id="5728526">.</span><span class="op" id="5728527">(</span><span class="builtintype" id="5728528">string</span><span class="op" id="5728534">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5728537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5728540">if</span>&nbsp;<span class="op" id="5728543">!</span><span class="ident" id="5728544">ok</span>&nbsp;<span class="op" id="5728547">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5728551">for</span>&nbsp;<span class="ident" id="5728555">i</span><span class="op" id="5728556">,</span>&nbsp;<span class="ident" id="5728558">arg</span>&nbsp;<span class="op" id="5728562">:=</span>&nbsp;<span class="keyword" id="5728565">range</span>&nbsp;<span class="ident" id="5728571">args</span>&nbsp;<span class="op" id="5728576">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728581">a</span><span class="op" id="5728582">,</span>&nbsp;<span class="ident" id="5728584">ok</span>&nbsp;<span class="op" id="5728587">:=</span>&nbsp;<span class="ident" id="5728590">printableValue</span><span class="op" id="5728604">(</span><span class="ident" id="5728605">reflect</span><span class="op" id="5728612">.</span><span class="ident" id="5728613">ValueOf</span><span class="op" id="5728620">(</span><span class="ident" id="5728621">arg</span><span class="op" id="5728624">)</span><span class="op" id="5728625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5728630">if</span>&nbsp;<span class="ident" id="5728633">ok</span>&nbsp;<span class="op" id="5728636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728642">args</span><span class="op" id="5728646">[</span><span class="ident" id="5728647">i</span><span class="op" id="5728648">]</span>&nbsp;<span class="op" id="5728650">=</span>&nbsp;<span class="ident" id="5728652">a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5728657">}</span>&nbsp;<span class="comment" id="5728659">//&nbsp;else&nbsp;left&nbsp;fmt&nbsp;do&nbsp;its&nbsp;thing</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5728691">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5728695">s</span>&nbsp;<span class="op" id="5728697">=</span>&nbsp;<span class="ident" id="5728699">fmt</span><span class="op" id="5728702">.</span><span class="ident" id="5728703">Sprint</span><span class="op" id="5728709">(</span><span class="ident" id="5728710">args</span><span class="op" id="5728714">...</span><span class="op" id="5728717">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5728720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5728723">return</span>&nbsp;<span class="ident" id="5728730">s</span><br>
<span class="lineno"></span><span class="op" id="5728732">}</span>
</div>
</body>
</html>
