<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4585302">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4585357">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4585411">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4585462">package</span>&nbsp;<span class="ident" id="4585470">flate</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4585477">import</span>&nbsp;<span class="op" id="4585484">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4585487">&#34;math&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4585495">&#34;sort&#34;</span><br>
<span class="lineno">10</span><span class="op" id="4585502">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4585505">type</span>&nbsp;<span class="ident" id="4585510">huffmanEncoder</span>&nbsp;<span class="keyword" id="4585525">struct</span>&nbsp;<span class="op" id="4585532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585535">codeBits</span>&nbsp;<span class="op" id="4585544">[</span><span class="op" id="4585545">]</span><span class="builtintype" id="4585546">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585553">code</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4585562">[</span><span class="op" id="4585563">]</span><span class="builtintype" id="4585564">uint16</span><br>
<span class="lineno">15</span><span class="op" id="4585571">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4585574">type</span>&nbsp;<span class="ident" id="4585579">literalNode</span>&nbsp;<span class="keyword" id="4585591">struct</span>&nbsp;<span class="op" id="4585598">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585601">literal</span>&nbsp;<span class="builtintype" id="4585609">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585617">freq</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4585625">int32</span><br>
<span class="lineno">20</span><span class="op" id="4585631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4585634">//&nbsp;A&nbsp;levelInfo&nbsp;describes&nbsp;the&nbsp;state&nbsp;of&nbsp;the&nbsp;constructed&nbsp;tree&nbsp;for&nbsp;a&nbsp;given&nbsp;depth.</span><br>
<span class="lineno"></span><span class="keyword" id="4585712">type</span>&nbsp;<span class="ident" id="4585717">levelInfo</span>&nbsp;<span class="keyword" id="4585727">struct</span>&nbsp;<span class="op" id="4585734">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4585737">//&nbsp;Our&nbsp;level.&nbsp;&nbsp;for&nbsp;better&nbsp;printing</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585773">level</span>&nbsp;<span class="builtintype" id="4585779">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4585787">//&nbsp;The&nbsp;frequency&nbsp;of&nbsp;the&nbsp;last&nbsp;node&nbsp;at&nbsp;this&nbsp;level</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585836">lastFreq</span>&nbsp;<span class="builtintype" id="4585845">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4585853">//&nbsp;The&nbsp;frequency&nbsp;of&nbsp;the&nbsp;next&nbsp;character&nbsp;to&nbsp;add&nbsp;to&nbsp;this&nbsp;level</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4585914">nextCharFreq</span>&nbsp;<span class="builtintype" id="4585927">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4585935">//&nbsp;The&nbsp;frequency&nbsp;of&nbsp;the&nbsp;next&nbsp;pair&nbsp;(from&nbsp;level&nbsp;below)&nbsp;to&nbsp;add&nbsp;to&nbsp;this&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4586011">//&nbsp;Only&nbsp;valid&nbsp;if&nbsp;the&nbsp;&#34;needed&#34;&nbsp;value&nbsp;of&nbsp;the&nbsp;next&nbsp;lower&nbsp;level&nbsp;is&nbsp;0.</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586078">nextPairFreq</span>&nbsp;<span class="builtintype" id="4586091">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4586099">//&nbsp;The&nbsp;number&nbsp;of&nbsp;chains&nbsp;remaining&nbsp;to&nbsp;generate&nbsp;for&nbsp;this&nbsp;level&nbsp;before&nbsp;moving</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4586175">//&nbsp;up&nbsp;to&nbsp;the&nbsp;next&nbsp;level</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586200">needed</span>&nbsp;<span class="builtintype" id="4586207">int32</span><br>
<span class="lineno">40</span><span class="op" id="4586213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4586216">func</span>&nbsp;<span class="ident" id="4586221">maxNode</span><span class="op" id="4586228">(</span><span class="op" id="4586229">)</span>&nbsp;<span class="ident" id="4586231"><a href="/compress/flate/huffman_code.go.html#4585579">literalNode</a></span>&nbsp;<span class="op" id="4586243">{</span>&nbsp;<span class="keyword" id="4586245">return</span>&nbsp;<span class="ident" id="4586252"><a href="/compress/flate/huffman_code.go.html#4585579">literalNode</a></span><span class="op" id="4586263">{</span><span class="ident" id="4586264"><a href="/compress/flate/huffman_code.go.html#4585487">math</a></span><span class="op" id="4586268">.</span><span class="ident" id="4586269">MaxUint16</span><span class="op" id="4586278">,</span>&nbsp;<span class="ident" id="4586280"><a href="/compress/flate/huffman_code.go.html#4585487">math</a></span><span class="op" id="4586284">.</span><span class="ident" id="4586285">MaxInt32</span><span class="op" id="4586293">}</span>&nbsp;<span class="op" id="4586295">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4586298">func</span>&nbsp;<span class="ident" id="4586303">newHuffmanEncoder</span><span class="op" id="4586320">(</span><span class="ident" id="4586321">size</span>&nbsp;<span class="builtintype" id="4586326">int</span><span class="op" id="4586329">)</span>&nbsp;<span class="op" id="4586331">*</span><span class="ident" id="4586332"><a href="/compress/flate/huffman_code.go.html#4585510">huffmanEncoder</a></span>&nbsp;<span class="op" id="4586347">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586350">return</span>&nbsp;<span class="op" id="4586357">&amp;</span><span class="ident" id="4586358"><a href="/compress/flate/huffman_code.go.html#4585510">huffmanEncoder</a></span><span class="op" id="4586372">{</span><span class="builtinfunc" id="4586373">make</span><span class="op" id="4586377">(</span><span class="op" id="4586378">[</span><span class="op" id="4586379">]</span><span class="builtintype" id="4586380">uint8</span><span class="op" id="4586385">,</span>&nbsp;<span class="ident" id="4586387"><a href="/compress/flate/huffman_code.go.html#4586321">size</a></span><span class="op" id="4586391">)</span><span class="op" id="4586392">,</span>&nbsp;<span class="builtinfunc" id="4586394">make</span><span class="op" id="4586398">(</span><span class="op" id="4586399">[</span><span class="op" id="4586400">]</span><span class="builtintype" id="4586401">uint16</span><span class="op" id="4586407">,</span>&nbsp;<span class="ident" id="4586409"><a href="/compress/flate/huffman_code.go.html#4586321">size</a></span><span class="op" id="4586413">)</span><span class="op" id="4586414">}</span><br>
<span class="lineno"></span><span class="op" id="4586416">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4586419">//&nbsp;Generates&nbsp;a&nbsp;HuffmanCode&nbsp;corresponding&nbsp;to&nbsp;the&nbsp;fixed&nbsp;literal&nbsp;table</span><br>
<span class="lineno"></span><span class="keyword" id="4586487">func</span>&nbsp;<span class="ident" id="4586492">generateFixedLiteralEncoding</span><span class="op" id="4586520">(</span><span class="op" id="4586521">)</span>&nbsp;<span class="op" id="4586523">*</span><span class="ident" id="4586524"><a href="/compress/flate/huffman_code.go.html#4585510">huffmanEncoder</a></span>&nbsp;<span class="op" id="4586539">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586542">h</span>&nbsp;<span class="op" id="4586544">:=</span>&nbsp;<span class="ident" id="4586547"><a href="/compress/flate/huffman_code.go.html#4586303">newHuffmanEncoder</a></span><span class="op" id="4586564">(</span><span class="ident" id="4586565"><a href="/compress/flate/inflate.go.html#4595270">maxLit</a></span><span class="op" id="4586571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586574">codeBits</span>&nbsp;<span class="op" id="4586583">:=</span>&nbsp;<span class="ident" id="4586586"><a href="/compress/flate/huffman_code.go.html#4586542">h</a></span><span class="op" id="4586587">.</span><span class="ident" id="4586588">codeBits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586598">code</span>&nbsp;<span class="op" id="4586603">:=</span>&nbsp;<span class="ident" id="4586606"><a href="/compress/flate/huffman_code.go.html#4586542">h</a></span><span class="op" id="4586607">.</span><span class="ident" id="4586608">code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586614">var</span>&nbsp;<span class="ident" id="4586618">ch</span>&nbsp;<span class="builtintype" id="4586621">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586629">for</span>&nbsp;<span class="ident" id="4586633"><a href="/compress/flate/huffman_code.go.html#4586618">ch</a></span>&nbsp;<span class="op" id="4586636">=</span>&nbsp;<span class="num" id="4586638">0</span><span class="op" id="4586639">;</span>&nbsp;<span class="ident" id="4586641"><a href="/compress/flate/huffman_code.go.html#4586618">ch</a></span>&nbsp;<span class="op" id="4586644">&lt;</span>&nbsp;<span class="ident" id="4586646"><a href="/compress/flate/inflate.go.html#4595270">maxLit</a></span><span class="op" id="4586652">;</span>&nbsp;<span class="ident" id="4586654"><a href="/compress/flate/huffman_code.go.html#4586618">ch</a></span><span class="op" id="4586656">++</span>&nbsp;<span class="op" id="4586659">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586663">var</span>&nbsp;<span class="ident" id="4586667">bits</span>&nbsp;<span class="builtintype" id="4586672">uint16</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586681">var</span>&nbsp;<span class="ident" id="4586685">size</span>&nbsp;<span class="builtintype" id="4586690">uint8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586698">switch</span>&nbsp;<span class="op" id="4586705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586709">case</span>&nbsp;<span class="ident" id="4586714"><a href="/compress/flate/huffman_code.go.html#4586618">ch</a></span>&nbsp;<span class="op" id="4586717">&lt;</span>&nbsp;<span class="num" id="4586719">144</span><span class="op" id="4586722">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4586727">//&nbsp;size&nbsp;8,&nbsp;000110000&nbsp;&nbsp;..&nbsp;10111111</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586764"><a href="/compress/flate/huffman_code.go.html#4586667">bits</a></span>&nbsp;<span class="op" id="4586769">=</span>&nbsp;<span class="ident" id="4586771"><a href="/compress/flate/huffman_code.go.html#4586618">ch</a></span>&nbsp;<span class="op" id="4586774">+</span>&nbsp;<span class="num" id="4586776">48</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586782"><a href="/compress/flate/huffman_code.go.html#4586685">size</a></span>&nbsp;<span class="op" id="4586787">=</span>&nbsp;<span class="num" id="4586789">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586794">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586802">case</span>&nbsp;<span class="ident" id="4586807"><a href="/compress/flate/huffman_code.go.html#4586618">ch</a></span>&nbsp;<span class="op" id="4586810">&lt;</span>&nbsp;<span class="num" id="4586812">256</span><span class="op" id="4586815">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4586820">//&nbsp;size&nbsp;9,&nbsp;110010000&nbsp;..&nbsp;111111111</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586857"><a href="/compress/flate/huffman_code.go.html#4586667">bits</a></span>&nbsp;<span class="op" id="4586862">=</span>&nbsp;<span class="ident" id="4586864"><a href="/compress/flate/huffman_code.go.html#4586618">ch</a></span>&nbsp;<span class="op" id="4586867">+</span>&nbsp;<span class="num" id="4586869">400</span>&nbsp;<span class="op" id="4586873">-</span>&nbsp;<span class="num" id="4586875">144</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586882"><a href="/compress/flate/huffman_code.go.html#4586685">size</a></span>&nbsp;<span class="op" id="4586887">=</span>&nbsp;<span class="num" id="4586889">9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586894">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586902">case</span>&nbsp;<span class="ident" id="4586907"><a href="/compress/flate/huffman_code.go.html#4586618">ch</a></span>&nbsp;<span class="op" id="4586910">&lt;</span>&nbsp;<span class="num" id="4586912">280</span><span class="op" id="4586915">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4586920">//&nbsp;size&nbsp;7,&nbsp;0000000&nbsp;..&nbsp;0010111</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586953"><a href="/compress/flate/huffman_code.go.html#4586667">bits</a></span>&nbsp;<span class="op" id="4586958">=</span>&nbsp;<span class="ident" id="4586960"><a href="/compress/flate/huffman_code.go.html#4586618">ch</a></span>&nbsp;<span class="op" id="4586963">-</span>&nbsp;<span class="num" id="4586965">256</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4586972"><a href="/compress/flate/huffman_code.go.html#4586685">size</a></span>&nbsp;<span class="op" id="4586977">=</span>&nbsp;<span class="num" id="4586979">7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586984">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4586992">default</span><span class="op" id="4586999">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4587004">//&nbsp;size&nbsp;8,&nbsp;11000000&nbsp;..&nbsp;11000111</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587039"><a href="/compress/flate/huffman_code.go.html#4586667">bits</a></span>&nbsp;<span class="op" id="4587044">=</span>&nbsp;<span class="ident" id="4587046"><a href="/compress/flate/huffman_code.go.html#4586618">ch</a></span>&nbsp;<span class="op" id="4587049">+</span>&nbsp;<span class="num" id="4587051">192</span>&nbsp;<span class="op" id="4587055">-</span>&nbsp;<span class="num" id="4587057">280</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587064"><a href="/compress/flate/huffman_code.go.html#4586685">size</a></span>&nbsp;<span class="op" id="4587069">=</span>&nbsp;<span class="num" id="4587071">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4587075">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587079"><a href="/compress/flate/huffman_code.go.html#4586574">codeBits</a></span><span class="op" id="4587087">[</span><span class="ident" id="4587088"><a href="/compress/flate/huffman_code.go.html#4586618">ch</a></span><span class="op" id="4587090">]</span>&nbsp;<span class="op" id="4587092">=</span>&nbsp;<span class="ident" id="4587094"><a href="/compress/flate/huffman_code.go.html#4586685">size</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587101"><a href="/compress/flate/huffman_code.go.html#4586598">code</a></span><span class="op" id="4587105">[</span><span class="ident" id="4587106"><a href="/compress/flate/huffman_code.go.html#4586618">ch</a></span><span class="op" id="4587108">]</span>&nbsp;<span class="op" id="4587110">=</span>&nbsp;<span class="ident" id="4587112"><a href="/compress/flate/reverse_bits.go.html#4613479">reverseBits</a></span><span class="op" id="4587123">(</span><span class="ident" id="4587124"><a href="/compress/flate/huffman_code.go.html#4586667">bits</a></span><span class="op" id="4587128">,</span>&nbsp;<span class="ident" id="4587130"><a href="/compress/flate/huffman_code.go.html#4586685">size</a></span><span class="op" id="4587134">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4587137">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4587140">return</span>&nbsp;<span class="ident" id="4587147"><a href="/compress/flate/huffman_code.go.html#4586542">h</a></span><br>
<span class="lineno"></span><span class="op" id="4587149">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4587152">func</span>&nbsp;<span class="ident" id="4587157">generateFixedOffsetEncoding</span><span class="op" id="4587184">(</span><span class="op" id="4587185">)</span>&nbsp;<span class="op" id="4587187">*</span><span class="ident" id="4587188"><a href="/compress/flate/huffman_code.go.html#4585510">huffmanEncoder</a></span>&nbsp;<span class="op" id="4587203">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587206">h</span>&nbsp;<span class="op" id="4587208">:=</span>&nbsp;<span class="ident" id="4587211"><a href="/compress/flate/huffman_code.go.html#4586303">newHuffmanEncoder</a></span><span class="op" id="4587228">(</span><span class="num" id="4587229">30</span><span class="op" id="4587231">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587234">codeBits</span>&nbsp;<span class="op" id="4587243">:=</span>&nbsp;<span class="ident" id="4587246"><a href="/compress/flate/huffman_code.go.html#4587206">h</a></span><span class="op" id="4587247">.</span><span class="ident" id="4587248">codeBits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587258">code</span>&nbsp;<span class="op" id="4587263">:=</span>&nbsp;<span class="ident" id="4587266"><a href="/compress/flate/huffman_code.go.html#4587206">h</a></span><span class="op" id="4587267">.</span><span class="ident" id="4587268">code</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4587274">for</span>&nbsp;<span class="ident" id="4587278">ch</span>&nbsp;<span class="op" id="4587281">:=</span>&nbsp;<span class="builtintype" id="4587284">uint16</span><span class="op" id="4587290">(</span><span class="num" id="4587291">0</span><span class="op" id="4587292">)</span><span class="op" id="4587293">;</span>&nbsp;<span class="ident" id="4587295"><a href="/compress/flate/huffman_code.go.html#4587278">ch</a></span>&nbsp;<span class="op" id="4587298">&lt;</span>&nbsp;<span class="num" id="4587300">30</span><span class="op" id="4587302">;</span>&nbsp;<span class="ident" id="4587304"><a href="/compress/flate/huffman_code.go.html#4587278">ch</a></span><span class="op" id="4587306">++</span>&nbsp;<span class="op" id="4587309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587313"><a href="/compress/flate/huffman_code.go.html#4587234">codeBits</a></span><span class="op" id="4587321">[</span><span class="ident" id="4587322"><a href="/compress/flate/huffman_code.go.html#4587278">ch</a></span><span class="op" id="4587324">]</span>&nbsp;<span class="op" id="4587326">=</span>&nbsp;<span class="num" id="4587328">5</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587332"><a href="/compress/flate/huffman_code.go.html#4587258">code</a></span><span class="op" id="4587336">[</span><span class="ident" id="4587337"><a href="/compress/flate/huffman_code.go.html#4587278">ch</a></span><span class="op" id="4587339">]</span>&nbsp;<span class="op" id="4587341">=</span>&nbsp;<span class="ident" id="4587343"><a href="/compress/flate/reverse_bits.go.html#4613479">reverseBits</a></span><span class="op" id="4587354">(</span><span class="ident" id="4587355"><a href="/compress/flate/huffman_code.go.html#4587278">ch</a></span><span class="op" id="4587357">,</span>&nbsp;<span class="num" id="4587359">5</span><span class="op" id="4587360">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4587363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4587366">return</span>&nbsp;<span class="ident" id="4587373"><a href="/compress/flate/huffman_code.go.html#4587206">h</a></span><br>
<span class="lineno"></span><span class="op" id="4587375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="4587378">var</span>&nbsp;<span class="ident" id="4587382">fixedLiteralEncoding</span>&nbsp;<span class="op" id="4587403">*</span><span class="ident" id="4587404"><a href="/compress/flate/huffman_code.go.html#4585510">huffmanEncoder</a></span>&nbsp;<span class="op" id="4587419">=</span>&nbsp;<span class="ident" id="4587421"><a href="/compress/flate/huffman_code.go.html#4586492">generateFixedLiteralEncoding</a></span><span class="op" id="4587449">(</span><span class="op" id="4587450">)</span><br>
<span class="lineno"></span><span class="keyword" id="4587452">var</span>&nbsp;<span class="ident" id="4587456">fixedOffsetEncoding</span>&nbsp;<span class="op" id="4587476">*</span><span class="ident" id="4587477"><a href="/compress/flate/huffman_code.go.html#4585510">huffmanEncoder</a></span>&nbsp;<span class="op" id="4587492">=</span>&nbsp;<span class="ident" id="4587494"><a href="/compress/flate/huffman_code.go.html#4587157">generateFixedOffsetEncoding</a></span><span class="op" id="4587521">(</span><span class="op" id="4587522">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4587525">func</span>&nbsp;<span class="op" id="4587530">(</span><span class="ident" id="4587531">h</span>&nbsp;<span class="op" id="4587533">*</span><span class="ident" id="4587534"><a href="/compress/flate/huffman_code.go.html#4585510">huffmanEncoder</a></span><span class="op" id="4587548">)</span>&nbsp;<span class="ident" id="4587550">bitLength</span><span class="op" id="4587559">(</span><span class="ident" id="4587560">freq</span>&nbsp;<span class="op" id="4587565">[</span><span class="op" id="4587566">]</span><span class="builtintype" id="4587567">int32</span><span class="op" id="4587572">)</span>&nbsp;<span class="ident" id="4587574">int64</span>&nbsp;<span class="op" id="4587580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4587583">var</span>&nbsp;<span class="ident" id="4587587">total</span>&nbsp;<span class="ident" id="4587593">int64</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4587600">for</span>&nbsp;<span class="ident" id="4587604">i</span><span class="op" id="4587605">,</span>&nbsp;<span class="ident" id="4587607">f</span>&nbsp;<span class="op" id="4587609">:=</span>&nbsp;<span class="keyword" id="4587612">range</span>&nbsp;<span class="ident" id="4587618"><a href="/compress/flate/huffman_code.go.html#4587560">freq</a></span>&nbsp;<span class="op" id="4587623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4587627">if</span>&nbsp;<span class="ident" id="4587630"><a href="/compress/flate/huffman_code.go.html#4587607">f</a></span>&nbsp;<span class="op" id="4587632">!=</span>&nbsp;<span class="num" id="4587635">0</span>&nbsp;<span class="op" id="4587637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4587642"><a href="/compress/flate/huffman_code.go.html#4587587">total</a></span>&nbsp;<span class="op" id="4587648">+=</span>&nbsp;<span class="ident" id="4587651">int64</span><span class="op" id="4587656">(</span><span class="ident" id="4587657"><a href="/compress/flate/huffman_code.go.html#4587607">f</a></span><span class="op" id="4587658">)</span>&nbsp;<span class="op" id="4587660">*</span>&nbsp;<span class="ident" id="4587662">int64</span><span class="op" id="4587667">(</span><span class="ident" id="4587668"><a href="/compress/flate/huffman_code.go.html#4587531">h</a></span><span class="op" id="4587669">.</span><span class="ident" id="4587670">codeBits</span><span class="op" id="4587678">[</span><span class="ident" id="4587679"><a href="/compress/flate/huffman_code.go.html#4587604">i</a></span><span class="op" id="4587680">]</span><span class="op" id="4587681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4587685">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4587688">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4587691">return</span>&nbsp;<span class="ident" id="4587698"><a href="/compress/flate/huffman_code.go.html#4587587">total</a></span><br>
<span class="lineno"></span><span class="op" id="4587704">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4587707">const</span>&nbsp;<span class="ident" id="4587713">maxBitsLimit</span>&nbsp;<span class="op" id="4587726">=</span>&nbsp;<span class="num" id="4587728">16</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span><span class="comment" id="4587732">//&nbsp;Return&nbsp;the&nbsp;number&nbsp;of&nbsp;literals&nbsp;assigned&nbsp;to&nbsp;each&nbsp;bit&nbsp;size&nbsp;in&nbsp;the&nbsp;Huffman&nbsp;encoding</span><br>
<span class="lineno"></span><span class="comment" id="4587815">//</span><br>
<span class="lineno"></span><span class="comment" id="4587818">//&nbsp;This&nbsp;method&nbsp;is&nbsp;only&nbsp;called&nbsp;when&nbsp;list.length&nbsp;&gt;=&nbsp;3</span><br>
<span class="lineno"></span><span class="comment" id="4587870">//&nbsp;The&nbsp;cases&nbsp;of&nbsp;0,&nbsp;1,&nbsp;and&nbsp;2&nbsp;literals&nbsp;are&nbsp;handled&nbsp;by&nbsp;special&nbsp;case&nbsp;code.</span><br>
<span class="lineno"></span><span class="comment" id="4587941">//</span><br>
<span class="lineno">115</span><span class="comment" id="4587944">//&nbsp;list&nbsp;&nbsp;An&nbsp;array&nbsp;of&nbsp;the&nbsp;literals&nbsp;with&nbsp;non-zero&nbsp;frequencies</span><br>
<span class="lineno"></span><span class="comment" id="4588004">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;their&nbsp;associated&nbsp;frequencies.&nbsp;&nbsp;The&nbsp;array&nbsp;is&nbsp;in&nbsp;order&nbsp;of&nbsp;increasing</span><br>
<span class="lineno"></span><span class="comment" id="4588090">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frequency,&nbsp;and&nbsp;has&nbsp;as&nbsp;its&nbsp;last&nbsp;element&nbsp;a&nbsp;special&nbsp;element&nbsp;with&nbsp;frequency</span><br>
<span class="lineno"></span><span class="comment" id="4588177">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MaxInt32</span><br>
<span class="lineno"></span><span class="comment" id="4588201">//&nbsp;maxBits&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;The&nbsp;maximum&nbsp;number&nbsp;of&nbsp;bits&nbsp;that&nbsp;should&nbsp;be&nbsp;used&nbsp;to&nbsp;encode&nbsp;any&nbsp;literal.</span><br>
<span class="lineno">120</span><span class="comment" id="4588286">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Must&nbsp;be&nbsp;less&nbsp;than&nbsp;16.</span><br>
<span class="lineno"></span><span class="comment" id="4588323">//&nbsp;return&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;An&nbsp;integer&nbsp;array&nbsp;in&nbsp;which&nbsp;array[i]&nbsp;indicates&nbsp;the&nbsp;number&nbsp;of&nbsp;literals</span><br>
<span class="lineno"></span><span class="comment" id="4588406">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;that&nbsp;should&nbsp;be&nbsp;encoded&nbsp;in&nbsp;i&nbsp;bits.</span><br>
<span class="lineno"></span><span class="keyword" id="4588455">func</span>&nbsp;<span class="op" id="4588460">(</span><span class="ident" id="4588461">h</span>&nbsp;<span class="op" id="4588463">*</span><span class="ident" id="4588464"><a href="/compress/flate/huffman_code.go.html#4585510">huffmanEncoder</a></span><span class="op" id="4588478">)</span>&nbsp;<span class="ident" id="4588480">bitCounts</span><span class="op" id="4588489">(</span><span class="ident" id="4588490">list</span>&nbsp;<span class="op" id="4588495">[</span><span class="op" id="4588496">]</span><span class="ident" id="4588497"><a href="/compress/flate/huffman_code.go.html#4585579">literalNode</a></span><span class="op" id="4588508">,</span>&nbsp;<span class="ident" id="4588510">maxBits</span>&nbsp;<span class="builtintype" id="4588518">int32</span><span class="op" id="4588523">)</span>&nbsp;<span class="op" id="4588525">[</span><span class="op" id="4588526">]</span><span class="builtintype" id="4588527">int32</span>&nbsp;<span class="op" id="4588533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4588536">if</span>&nbsp;<span class="ident" id="4588539"><a href="/compress/flate/huffman_code.go.html#4588510">maxBits</a></span>&nbsp;<span class="op" id="4588547">&gt;=</span>&nbsp;<span class="ident" id="4588550"><a href="/compress/flate/huffman_code.go.html#4587713">maxBitsLimit</a></span>&nbsp;<span class="op" id="4588563">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4588567">panic</span><span class="op" id="4588572">(</span><span class="string" id="4588573">&#34;flate:&nbsp;maxBits&nbsp;too&nbsp;large&#34;</span><span class="op" id="4588599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4588602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588605">n</span>&nbsp;<span class="op" id="4588607">:=</span>&nbsp;<span class="builtintype" id="4588610">int32</span><span class="op" id="4588615">(</span><span class="builtinfunc" id="4588616">len</span><span class="op" id="4588619">(</span><span class="ident" id="4588620"><a href="/compress/flate/huffman_code.go.html#4588490">list</a></span><span class="op" id="4588624">)</span><span class="op" id="4588625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588628"><a href="/compress/flate/huffman_code.go.html#4588490">list</a></span>&nbsp;<span class="op" id="4588633">=</span>&nbsp;<span class="ident" id="4588635"><a href="/compress/flate/huffman_code.go.html#4588490">list</a></span><span class="op" id="4588639">[</span><span class="num" id="4588640">0</span>&nbsp;<span class="op" id="4588642">:</span>&nbsp;<span class="ident" id="4588644"><a href="/compress/flate/huffman_code.go.html#4588605">n</a></span><span class="op" id="4588645">+</span><span class="num" id="4588646">1</span><span class="op" id="4588647">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588650"><a href="/compress/flate/huffman_code.go.html#4588490">list</a></span><span class="op" id="4588654">[</span><span class="ident" id="4588655"><a href="/compress/flate/huffman_code.go.html#4588605">n</a></span><span class="op" id="4588656">]</span>&nbsp;<span class="op" id="4588658">=</span>&nbsp;<span class="ident" id="4588660"><a href="/compress/flate/huffman_code.go.html#4586221">maxNode</a></span><span class="op" id="4588667">(</span><span class="op" id="4588668">)</span><br>
<span class="lineno">130</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4588672">//&nbsp;The&nbsp;tree&nbsp;can&#39;t&nbsp;have&nbsp;greater&nbsp;depth&nbsp;than&nbsp;n&nbsp;-&nbsp;1,&nbsp;no&nbsp;matter&nbsp;what.&nbsp;&nbsp;This</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4588744">//&nbsp;saves&nbsp;a&nbsp;little&nbsp;bit&nbsp;of&nbsp;work&nbsp;in&nbsp;some&nbsp;small&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4588795">if</span>&nbsp;<span class="ident" id="4588798"><a href="/compress/flate/huffman_code.go.html#4588510">maxBits</a></span>&nbsp;<span class="op" id="4588806">&gt;</span>&nbsp;<span class="ident" id="4588808"><a href="/compress/flate/huffman_code.go.html#4588605">n</a></span><span class="op" id="4588809">-</span><span class="num" id="4588810">1</span>&nbsp;<span class="op" id="4588812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4588816"><a href="/compress/flate/huffman_code.go.html#4588510">maxBits</a></span>&nbsp;<span class="op" id="4588824">=</span>&nbsp;<span class="ident" id="4588826"><a href="/compress/flate/huffman_code.go.html#4588605">n</a></span>&nbsp;<span class="op" id="4588828">-</span>&nbsp;<span class="num" id="4588830">1</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4588833">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4588837">//&nbsp;Create&nbsp;information&nbsp;about&nbsp;each&nbsp;of&nbsp;the&nbsp;levels.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4588886">//&nbsp;A&nbsp;bogus&nbsp;&#34;Level&nbsp;0&#34;&nbsp;whose&nbsp;sole&nbsp;purpose&nbsp;is&nbsp;so&nbsp;that</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4588938">//&nbsp;level1.prev.needed==0.&nbsp;&nbsp;This&nbsp;makes&nbsp;level1.nextPairFreq</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4588997">//&nbsp;be&nbsp;a&nbsp;legitimate&nbsp;value&nbsp;that&nbsp;never&nbsp;gets&nbsp;chosen.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589047">var</span>&nbsp;<span class="ident" id="4589051">levels</span>&nbsp;<span class="op" id="4589058">[</span><span class="ident" id="4589059"><a href="/compress/flate/huffman_code.go.html#4587713">maxBitsLimit</a></span><span class="op" id="4589071">]</span><span class="ident" id="4589072"><a href="/compress/flate/huffman_code.go.html#4585717">levelInfo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4589083">//&nbsp;leafCounts[i]&nbsp;counts&nbsp;the&nbsp;number&nbsp;of&nbsp;literals&nbsp;at&nbsp;the&nbsp;left</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4589143">//&nbsp;of&nbsp;ancestors&nbsp;of&nbsp;the&nbsp;rightmost&nbsp;node&nbsp;at&nbsp;level&nbsp;i.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4589194">//&nbsp;leafCounts[i][j]&nbsp;is&nbsp;the&nbsp;number&nbsp;of&nbsp;literals&nbsp;at&nbsp;the&nbsp;left</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4589253">//&nbsp;of&nbsp;the&nbsp;level&nbsp;j&nbsp;ancestor.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589282">var</span>&nbsp;<span class="ident" id="4589286">leafCounts</span>&nbsp;<span class="op" id="4589297">[</span><span class="ident" id="4589298"><a href="/compress/flate/huffman_code.go.html#4587713">maxBitsLimit</a></span><span class="op" id="4589310">]</span><span class="op" id="4589311">[</span><span class="ident" id="4589312"><a href="/compress/flate/huffman_code.go.html#4587713">maxBitsLimit</a></span><span class="op" id="4589324">]</span><span class="builtintype" id="4589325">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589333">for</span>&nbsp;<span class="ident" id="4589337">level</span>&nbsp;<span class="op" id="4589343">:=</span>&nbsp;<span class="builtintype" id="4589346">int32</span><span class="op" id="4589351">(</span><span class="num" id="4589352">1</span><span class="op" id="4589353">)</span><span class="op" id="4589354">;</span>&nbsp;<span class="ident" id="4589356"><a href="/compress/flate/huffman_code.go.html#4589337">level</a></span>&nbsp;<span class="op" id="4589362">&lt;=</span>&nbsp;<span class="ident" id="4589365"><a href="/compress/flate/huffman_code.go.html#4588510">maxBits</a></span><span class="op" id="4589372">;</span>&nbsp;<span class="ident" id="4589374"><a href="/compress/flate/huffman_code.go.html#4589337">level</a></span><span class="op" id="4589379">++</span>&nbsp;<span class="op" id="4589382">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4589386">//&nbsp;For&nbsp;every&nbsp;level,&nbsp;the&nbsp;first&nbsp;two&nbsp;items&nbsp;are&nbsp;the&nbsp;first&nbsp;two&nbsp;characters.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4589458">//&nbsp;We&nbsp;initialize&nbsp;the&nbsp;levels&nbsp;as&nbsp;if&nbsp;we&nbsp;had&nbsp;already&nbsp;figured&nbsp;this&nbsp;out.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589527"><a href="/compress/flate/huffman_code.go.html#4589051">levels</a></span><span class="op" id="4589533">[</span><span class="ident" id="4589534"><a href="/compress/flate/huffman_code.go.html#4589337">level</a></span><span class="op" id="4589539">]</span>&nbsp;<span class="op" id="4589541">=</span>&nbsp;<span class="ident" id="4589543"><a href="/compress/flate/huffman_code.go.html#4585717">levelInfo</a></span><span class="op" id="4589552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589557">level</span><span class="op" id="4589562">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4589571"><a href="/compress/flate/huffman_code.go.html#4589337">level</a></span><span class="op" id="4589576">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589581">lastFreq</span><span class="op" id="4589589">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4589595"><a href="/compress/flate/huffman_code.go.html#4588490">list</a></span><span class="op" id="4589599">[</span><span class="num" id="4589600">1</span><span class="op" id="4589601">]</span><span class="op" id="4589602">.</span><span class="ident" id="4589603">freq</span><span class="op" id="4589607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589612">nextCharFreq</span><span class="op" id="4589624">:</span>&nbsp;<span class="ident" id="4589626"><a href="/compress/flate/huffman_code.go.html#4588490">list</a></span><span class="op" id="4589630">[</span><span class="num" id="4589631">2</span><span class="op" id="4589632">]</span><span class="op" id="4589633">.</span><span class="ident" id="4589634">freq</span><span class="op" id="4589638">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589643">nextPairFreq</span><span class="op" id="4589655">:</span>&nbsp;<span class="ident" id="4589657"><a href="/compress/flate/huffman_code.go.html#4588490">list</a></span><span class="op" id="4589661">[</span><span class="num" id="4589662">0</span><span class="op" id="4589663">]</span><span class="op" id="4589664">.</span><span class="ident" id="4589665">freq</span>&nbsp;<span class="op" id="4589670">+</span>&nbsp;<span class="ident" id="4589672"><a href="/compress/flate/huffman_code.go.html#4588490">list</a></span><span class="op" id="4589676">[</span><span class="num" id="4589677">1</span><span class="op" id="4589678">]</span><span class="op" id="4589679">.</span><span class="ident" id="4589680">freq</span><span class="op" id="4589684">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4589688">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589692"><a href="/compress/flate/huffman_code.go.html#4589286">leafCounts</a></span><span class="op" id="4589702">[</span><span class="ident" id="4589703"><a href="/compress/flate/huffman_code.go.html#4589337">level</a></span><span class="op" id="4589708">]</span><span class="op" id="4589709">[</span><span class="ident" id="4589710"><a href="/compress/flate/huffman_code.go.html#4589337">level</a></span><span class="op" id="4589715">]</span>&nbsp;<span class="op" id="4589717">=</span>&nbsp;<span class="num" id="4589719">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589723">if</span>&nbsp;<span class="ident" id="4589726"><a href="/compress/flate/huffman_code.go.html#4589337">level</a></span>&nbsp;<span class="op" id="4589732">==</span>&nbsp;<span class="num" id="4589735">1</span>&nbsp;<span class="op" id="4589737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589742"><a href="/compress/flate/huffman_code.go.html#4589051">levels</a></span><span class="op" id="4589748">[</span><span class="ident" id="4589749"><a href="/compress/flate/huffman_code.go.html#4589337">level</a></span><span class="op" id="4589754">]</span><span class="op" id="4589755">.</span><span class="ident" id="4589756">nextPairFreq</span>&nbsp;<span class="op" id="4589769">=</span>&nbsp;<span class="ident" id="4589771"><a href="/compress/flate/huffman_code.go.html#4585487">math</a></span><span class="op" id="4589775">.</span><span class="ident" id="4589776">MaxInt32</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4589787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4589790">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4589794">//&nbsp;We&nbsp;need&nbsp;a&nbsp;total&nbsp;of&nbsp;2*n&nbsp;-&nbsp;2&nbsp;items&nbsp;at&nbsp;top&nbsp;level&nbsp;and&nbsp;have&nbsp;already&nbsp;generated&nbsp;2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589874"><a href="/compress/flate/huffman_code.go.html#4589051">levels</a></span><span class="op" id="4589880">[</span><span class="ident" id="4589881"><a href="/compress/flate/huffman_code.go.html#4588510">maxBits</a></span><span class="op" id="4589888">]</span><span class="op" id="4589889">.</span><span class="ident" id="4589890">needed</span>&nbsp;<span class="op" id="4589897">=</span>&nbsp;<span class="num" id="4589899">2</span><span class="op" id="4589900">*</span><span class="ident" id="4589901"><a href="/compress/flate/huffman_code.go.html#4588605">n</a></span>&nbsp;<span class="op" id="4589903">-</span>&nbsp;<span class="num" id="4589905">4</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589909">level</span>&nbsp;<span class="op" id="4589915">:=</span>&nbsp;<span class="ident" id="4589918"><a href="/compress/flate/huffman_code.go.html#4588510">maxBits</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589927">for</span>&nbsp;<span class="op" id="4589931">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4589935">l</span>&nbsp;<span class="op" id="4589937">:=</span>&nbsp;<span class="op" id="4589940">&amp;</span><span class="ident" id="4589941"><a href="/compress/flate/huffman_code.go.html#4589051">levels</a></span><span class="op" id="4589947">[</span><span class="ident" id="4589948"><a href="/compress/flate/huffman_code.go.html#4589909">level</a></span><span class="op" id="4589953">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4589957">if</span>&nbsp;<span class="ident" id="4589960"><a href="/compress/flate/huffman_code.go.html#4589935">l</a></span><span class="op" id="4589961">.</span><span class="ident" id="4589962">nextPairFreq</span>&nbsp;<span class="op" id="4589975">==</span>&nbsp;<span class="ident" id="4589978"><a href="/compress/flate/huffman_code.go.html#4585487">math</a></span><span class="op" id="4589982">.</span><span class="ident" id="4589983">MaxInt32</span>&nbsp;<span class="op" id="4589992">&amp;&amp;</span>&nbsp;<span class="ident" id="4589995"><a href="/compress/flate/huffman_code.go.html#4589935">l</a></span><span class="op" id="4589996">.</span><span class="ident" id="4589997">nextCharFreq</span>&nbsp;<span class="op" id="4590010">==</span>&nbsp;<span class="ident" id="4590013"><a href="/compress/flate/huffman_code.go.html#4585487">math</a></span><span class="op" id="4590017">.</span><span class="ident" id="4590018">MaxInt32</span>&nbsp;<span class="op" id="4590027">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4590032">//&nbsp;We&#39;ve&nbsp;run&nbsp;out&nbsp;of&nbsp;both&nbsp;leafs&nbsp;and&nbsp;pairs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4590077">//&nbsp;End&nbsp;all&nbsp;calculations&nbsp;for&nbsp;this&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4590120">//&nbsp;To&nbsp;make&nbsp;sure&nbsp;we&nbsp;never&nbsp;come&nbsp;back&nbsp;to&nbsp;this&nbsp;level&nbsp;or&nbsp;any&nbsp;lower&nbsp;level,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4590192">//&nbsp;set&nbsp;nextPairFreq&nbsp;impossibly&nbsp;large.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590233"><a href="/compress/flate/huffman_code.go.html#4589935">l</a></span><span class="op" id="4590234">.</span><span class="ident" id="4590235">needed</span>&nbsp;<span class="op" id="4590242">=</span>&nbsp;<span class="num" id="4590244">0</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590249"><a href="/compress/flate/huffman_code.go.html#4589051">levels</a></span><span class="op" id="4590255">[</span><span class="ident" id="4590256"><a href="/compress/flate/huffman_code.go.html#4589909">level</a></span><span class="op" id="4590261">+</span><span class="num" id="4590262">1</span><span class="op" id="4590263">]</span><span class="op" id="4590264">.</span><span class="ident" id="4590265">nextPairFreq</span>&nbsp;<span class="op" id="4590278">=</span>&nbsp;<span class="ident" id="4590280"><a href="/compress/flate/huffman_code.go.html#4585487">math</a></span><span class="op" id="4590284">.</span><span class="ident" id="4590285">MaxInt32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590297"><a href="/compress/flate/huffman_code.go.html#4589909">level</a></span><span class="op" id="4590302">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590308">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4590319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590324">prevFreq</span>&nbsp;<span class="op" id="4590333">:=</span>&nbsp;<span class="ident" id="4590336"><a href="/compress/flate/huffman_code.go.html#4589935">l</a></span><span class="op" id="4590337">.</span><span class="ident" id="4590338">lastFreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4590349">if</span>&nbsp;<span class="ident" id="4590352"><a href="/compress/flate/huffman_code.go.html#4589935">l</a></span><span class="op" id="4590353">.</span><span class="ident" id="4590354">nextCharFreq</span>&nbsp;<span class="op" id="4590367">&lt;</span>&nbsp;<span class="ident" id="4590369"><a href="/compress/flate/huffman_code.go.html#4589935">l</a></span><span class="op" id="4590370">.</span><span class="ident" id="4590371">nextPairFreq</span>&nbsp;<span class="op" id="4590384">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4590389">//&nbsp;The&nbsp;next&nbsp;item&nbsp;on&nbsp;this&nbsp;row&nbsp;is&nbsp;a&nbsp;leaf&nbsp;node.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590437">n</span>&nbsp;<span class="op" id="4590439">:=</span>&nbsp;<span class="ident" id="4590442"><a href="/compress/flate/huffman_code.go.html#4589286">leafCounts</a></span><span class="op" id="4590452">[</span><span class="ident" id="4590453"><a href="/compress/flate/huffman_code.go.html#4589909">level</a></span><span class="op" id="4590458">]</span><span class="op" id="4590459">[</span><span class="ident" id="4590460"><a href="/compress/flate/huffman_code.go.html#4589909">level</a></span><span class="op" id="4590465">]</span>&nbsp;<span class="op" id="4590467">+</span>&nbsp;<span class="num" id="4590469">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590474"><a href="/compress/flate/huffman_code.go.html#4589935">l</a></span><span class="op" id="4590475">.</span><span class="ident" id="4590476">lastFreq</span>&nbsp;<span class="op" id="4590485">=</span>&nbsp;<span class="ident" id="4590487"><a href="/compress/flate/huffman_code.go.html#4589935">l</a></span><span class="op" id="4590488">.</span><span class="ident" id="4590489">nextCharFreq</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4590505">//&nbsp;Lower&nbsp;leafCounts&nbsp;are&nbsp;the&nbsp;same&nbsp;of&nbsp;the&nbsp;previous&nbsp;node.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590563"><a href="/compress/flate/huffman_code.go.html#4589286">leafCounts</a></span><span class="op" id="4590573">[</span><span class="ident" id="4590574"><a href="/compress/flate/huffman_code.go.html#4589909">level</a></span><span class="op" id="4590579">]</span><span class="op" id="4590580">[</span><span class="ident" id="4590581"><a href="/compress/flate/huffman_code.go.html#4589909">level</a></span><span class="op" id="4590586">]</span>&nbsp;<span class="op" id="4590588">=</span>&nbsp;<span class="ident" id="4590590"><a href="/compress/flate/huffman_code.go.html#4590437">n</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590595"><a href="/compress/flate/huffman_code.go.html#4589935">l</a></span><span class="op" id="4590596">.</span><span class="ident" id="4590597">nextCharFreq</span>&nbsp;<span class="op" id="4590610">=</span>&nbsp;<span class="ident" id="4590612"><a href="/compress/flate/huffman_code.go.html#4588490">list</a></span><span class="op" id="4590616">[</span><span class="ident" id="4590617"><a href="/compress/flate/huffman_code.go.html#4590437">n</a></span><span class="op" id="4590618">]</span><span class="op" id="4590619">.</span><span class="ident" id="4590620">freq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4590627">}</span>&nbsp;<span class="keyword" id="4590629">else</span>&nbsp;<span class="op" id="4590634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4590639">//&nbsp;The&nbsp;next&nbsp;item&nbsp;on&nbsp;this&nbsp;row&nbsp;is&nbsp;a&nbsp;pair&nbsp;from&nbsp;the&nbsp;previous&nbsp;row.</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4590704">//&nbsp;nextPairFreq&nbsp;isn&#39;t&nbsp;valid&nbsp;until&nbsp;we&nbsp;generate&nbsp;two</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4590757">//&nbsp;more&nbsp;values&nbsp;in&nbsp;the&nbsp;level&nbsp;below</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590794"><a href="/compress/flate/huffman_code.go.html#4589935">l</a></span><span class="op" id="4590795">.</span><span class="ident" id="4590796">lastFreq</span>&nbsp;<span class="op" id="4590805">=</span>&nbsp;<span class="ident" id="4590807"><a href="/compress/flate/huffman_code.go.html#4589935">l</a></span><span class="op" id="4590808">.</span><span class="ident" id="4590809">nextPairFreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4590825">//&nbsp;Take&nbsp;leaf&nbsp;counts&nbsp;from&nbsp;the&nbsp;lower&nbsp;level,&nbsp;except&nbsp;counts[level]&nbsp;remains&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4590909">copy</span><span class="op" id="4590913">(</span><span class="ident" id="4590914"><a href="/compress/flate/huffman_code.go.html#4589286">leafCounts</a></span><span class="op" id="4590924">[</span><span class="ident" id="4590925"><a href="/compress/flate/huffman_code.go.html#4589909">level</a></span><span class="op" id="4590930">]</span><span class="op" id="4590931">[</span><span class="op" id="4590932">:</span><span class="ident" id="4590933"><a href="/compress/flate/huffman_code.go.html#4589909">level</a></span><span class="op" id="4590938">]</span><span class="op" id="4590939">,</span>&nbsp;<span class="ident" id="4590941"><a href="/compress/flate/huffman_code.go.html#4589286">leafCounts</a></span><span class="op" id="4590951">[</span><span class="ident" id="4590952"><a href="/compress/flate/huffman_code.go.html#4589909">level</a></span><span class="op" id="4590957">-</span><span class="num" id="4590958">1</span><span class="op" id="4590959">]</span><span class="op" id="4590960">[</span><span class="op" id="4590961">:</span><span class="ident" id="4590962"><a href="/compress/flate/huffman_code.go.html#4589909">level</a></span><span class="op" id="4590967">]</span><span class="op" id="4590968">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4590973"><a href="/compress/flate/huffman_code.go.html#4589051">levels</a></span><span class="op" id="4590979">[</span><span class="ident" id="4590980"><a href="/compress/flate/huffman_code.go.html#4589935">l</a></span><span class="op" id="4590981">.</span><span class="ident" id="4590982">level</span><span class="op" id="4590987">-</span><span class="num" id="4590988">1</span><span class="op" id="4590989">]</span><span class="op" id="4590990">.</span><span class="ident" id="4590991">needed</span>&nbsp;<span class="op" id="4590998">=</span>&nbsp;<span class="num" id="4591000">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591004">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591009">if</span>&nbsp;<span class="ident" id="4591012"><a href="/compress/flate/huffman_code.go.html#4589935">l</a></span><span class="op" id="4591013">.</span><span class="ident" id="4591014">needed</span><span class="op" id="4591020">--</span><span class="op" id="4591022">;</span>&nbsp;<span class="ident" id="4591024"><a href="/compress/flate/huffman_code.go.html#4589935">l</a></span><span class="op" id="4591025">.</span><span class="ident" id="4591026">needed</span>&nbsp;<span class="op" id="4591033">==</span>&nbsp;<span class="num" id="4591036">0</span>&nbsp;<span class="op" id="4591038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4591043">//&nbsp;We&#39;ve&nbsp;done&nbsp;everything&nbsp;we&nbsp;need&nbsp;to&nbsp;do&nbsp;for&nbsp;this&nbsp;level.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4591101">//&nbsp;Continue&nbsp;calculating&nbsp;one&nbsp;level&nbsp;up.&nbsp;&nbsp;Fill&nbsp;in&nbsp;nextPairFreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4591164">//&nbsp;of&nbsp;that&nbsp;level&nbsp;with&nbsp;the&nbsp;sum&nbsp;of&nbsp;the&nbsp;two&nbsp;nodes&nbsp;we&#39;ve&nbsp;just&nbsp;calculated&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4591239">//&nbsp;this&nbsp;level.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591257">if</span>&nbsp;<span class="ident" id="4591260"><a href="/compress/flate/huffman_code.go.html#4589935">l</a></span><span class="op" id="4591261">.</span><span class="ident" id="4591262">level</span>&nbsp;<span class="op" id="4591268">==</span>&nbsp;<span class="ident" id="4591271"><a href="/compress/flate/huffman_code.go.html#4588510">maxBits</a></span>&nbsp;<span class="op" id="4591279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4591285">//&nbsp;All&nbsp;done!</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591302">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591311">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591316"><a href="/compress/flate/huffman_code.go.html#4589051">levels</a></span><span class="op" id="4591322">[</span><span class="ident" id="4591323"><a href="/compress/flate/huffman_code.go.html#4589935">l</a></span><span class="op" id="4591324">.</span><span class="ident" id="4591325">level</span><span class="op" id="4591330">+</span><span class="num" id="4591331">1</span><span class="op" id="4591332">]</span><span class="op" id="4591333">.</span><span class="ident" id="4591334">nextPairFreq</span>&nbsp;<span class="op" id="4591347">=</span>&nbsp;<span class="ident" id="4591349"><a href="/compress/flate/huffman_code.go.html#4590324">prevFreq</a></span>&nbsp;<span class="op" id="4591358">+</span>&nbsp;<span class="ident" id="4591360"><a href="/compress/flate/huffman_code.go.html#4589935">l</a></span><span class="op" id="4591361">.</span><span class="ident" id="4591362">lastFreq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591374"><a href="/compress/flate/huffman_code.go.html#4589909">level</a></span><span class="op" id="4591379">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591384">}</span>&nbsp;<span class="keyword" id="4591386">else</span>&nbsp;<span class="op" id="4591391">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4591396">//&nbsp;If&nbsp;we&nbsp;stole&nbsp;from&nbsp;below,&nbsp;move&nbsp;down&nbsp;temporarily&nbsp;to&nbsp;replenish&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591465">for</span>&nbsp;<span class="ident" id="4591469"><a href="/compress/flate/huffman_code.go.html#4589051">levels</a></span><span class="op" id="4591475">[</span><span class="ident" id="4591476"><a href="/compress/flate/huffman_code.go.html#4589909">level</a></span><span class="op" id="4591481">-</span><span class="num" id="4591482">1</span><span class="op" id="4591483">]</span><span class="op" id="4591484">.</span><span class="ident" id="4591485">needed</span>&nbsp;<span class="op" id="4591492">&gt;</span>&nbsp;<span class="num" id="4591494">0</span>&nbsp;<span class="op" id="4591496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591502"><a href="/compress/flate/huffman_code.go.html#4589909">level</a></span><span class="op" id="4591507">--</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591517">}</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591520">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4591524">//&nbsp;Somethings&nbsp;is&nbsp;wrong&nbsp;if&nbsp;at&nbsp;the&nbsp;end,&nbsp;the&nbsp;top&nbsp;level&nbsp;is&nbsp;null&nbsp;or&nbsp;hasn&#39;t&nbsp;used</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4591600">//&nbsp;all&nbsp;of&nbsp;the&nbsp;leaves.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591623">if</span>&nbsp;<span class="ident" id="4591626"><a href="/compress/flate/huffman_code.go.html#4589286">leafCounts</a></span><span class="op" id="4591636">[</span><span class="ident" id="4591637"><a href="/compress/flate/huffman_code.go.html#4588510">maxBits</a></span><span class="op" id="4591644">]</span><span class="op" id="4591645">[</span><span class="ident" id="4591646"><a href="/compress/flate/huffman_code.go.html#4588510">maxBits</a></span><span class="op" id="4591653">]</span>&nbsp;<span class="op" id="4591655">!=</span>&nbsp;<span class="ident" id="4591658"><a href="/compress/flate/huffman_code.go.html#4588605">n</a></span>&nbsp;<span class="op" id="4591660">{</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4591664">panic</span><span class="op" id="4591669">(</span><span class="string" id="4591670">&#34;leafCounts[maxBits][maxBits]&nbsp;!=&nbsp;n&#34;</span><span class="op" id="4591705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591712">bitCount</span>&nbsp;<span class="op" id="4591721">:=</span>&nbsp;<span class="builtinfunc" id="4591724">make</span><span class="op" id="4591728">(</span><span class="op" id="4591729">[</span><span class="op" id="4591730">]</span><span class="builtintype" id="4591731">int32</span><span class="op" id="4591736">,</span>&nbsp;<span class="ident" id="4591738"><a href="/compress/flate/huffman_code.go.html#4588510">maxBits</a></span><span class="op" id="4591745">+</span><span class="num" id="4591746">1</span><span class="op" id="4591747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591750">bits</span>&nbsp;<span class="op" id="4591755">:=</span>&nbsp;<span class="num" id="4591758">1</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591761">counts</span>&nbsp;<span class="op" id="4591768">:=</span>&nbsp;<span class="op" id="4591771">&amp;</span><span class="ident" id="4591772"><a href="/compress/flate/huffman_code.go.html#4589286">leafCounts</a></span><span class="op" id="4591782">[</span><span class="ident" id="4591783"><a href="/compress/flate/huffman_code.go.html#4588510">maxBits</a></span><span class="op" id="4591790">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591793">for</span>&nbsp;<span class="ident" id="4591797">level</span>&nbsp;<span class="op" id="4591803">:=</span>&nbsp;<span class="ident" id="4591806"><a href="/compress/flate/huffman_code.go.html#4588510">maxBits</a></span><span class="op" id="4591813">;</span>&nbsp;<span class="ident" id="4591815"><a href="/compress/flate/huffman_code.go.html#4591797">level</a></span>&nbsp;<span class="op" id="4591821">&gt;</span>&nbsp;<span class="num" id="4591823">0</span><span class="op" id="4591824">;</span>&nbsp;<span class="ident" id="4591826"><a href="/compress/flate/huffman_code.go.html#4591797">level</a></span><span class="op" id="4591831">--</span>&nbsp;<span class="op" id="4591834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4591838">//&nbsp;chain.leafCount&nbsp;gives&nbsp;the&nbsp;number&nbsp;of&nbsp;literals&nbsp;requiring&nbsp;at&nbsp;least&nbsp;&#34;bits&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4591914">//&nbsp;bits&nbsp;to&nbsp;encode.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591935"><a href="/compress/flate/huffman_code.go.html#4591712">bitCount</a></span><span class="op" id="4591943">[</span><span class="ident" id="4591944"><a href="/compress/flate/huffman_code.go.html#4591750">bits</a></span><span class="op" id="4591948">]</span>&nbsp;<span class="op" id="4591950">=</span>&nbsp;<span class="ident" id="4591952"><a href="/compress/flate/huffman_code.go.html#4591761">counts</a></span><span class="op" id="4591958">[</span><span class="ident" id="4591959"><a href="/compress/flate/huffman_code.go.html#4591797">level</a></span><span class="op" id="4591964">]</span>&nbsp;<span class="op" id="4591966">-</span>&nbsp;<span class="ident" id="4591968"><a href="/compress/flate/huffman_code.go.html#4591761">counts</a></span><span class="op" id="4591974">[</span><span class="ident" id="4591975"><a href="/compress/flate/huffman_code.go.html#4591797">level</a></span><span class="op" id="4591980">-</span><span class="num" id="4591981">1</span><span class="op" id="4591982">]</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4591986"><a href="/compress/flate/huffman_code.go.html#4591750">bits</a></span><span class="op" id="4591990">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4591994">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4591997">return</span>&nbsp;<span class="ident" id="4592004"><a href="/compress/flate/huffman_code.go.html#4591712">bitCount</a></span><br>
<span class="lineno"></span><span class="op" id="4592013">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="comment" id="4592016">//&nbsp;Look&nbsp;at&nbsp;the&nbsp;leaves&nbsp;and&nbsp;assign&nbsp;them&nbsp;a&nbsp;bit&nbsp;count&nbsp;and&nbsp;an&nbsp;encoding&nbsp;as&nbsp;specified</span><br>
<span class="lineno"></span><span class="comment" id="4592095">//&nbsp;in&nbsp;RFC&nbsp;1951&nbsp;3.2.2</span><br>
<span class="lineno"></span><span class="keyword" id="4592116">func</span>&nbsp;<span class="op" id="4592121">(</span><span class="ident" id="4592122">h</span>&nbsp;<span class="op" id="4592124">*</span><span class="ident" id="4592125"><a href="/compress/flate/huffman_code.go.html#4585510">huffmanEncoder</a></span><span class="op" id="4592139">)</span>&nbsp;<span class="ident" id="4592141">assignEncodingAndSize</span><span class="op" id="4592162">(</span><span class="ident" id="4592163">bitCount</span>&nbsp;<span class="op" id="4592172">[</span><span class="op" id="4592173">]</span><span class="builtintype" id="4592174">int32</span><span class="op" id="4592179">,</span>&nbsp;<span class="ident" id="4592181">list</span>&nbsp;<span class="op" id="4592186">[</span><span class="op" id="4592187">]</span><span class="ident" id="4592188"><a href="/compress/flate/huffman_code.go.html#4585579">literalNode</a></span><span class="op" id="4592199">)</span>&nbsp;<span class="op" id="4592201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592204">code</span>&nbsp;<span class="op" id="4592209">:=</span>&nbsp;<span class="builtintype" id="4592212">uint16</span><span class="op" id="4592218">(</span><span class="num" id="4592219">0</span><span class="op" id="4592220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4592223">for</span>&nbsp;<span class="ident" id="4592227">n</span><span class="op" id="4592228">,</span>&nbsp;<span class="ident" id="4592230">bits</span>&nbsp;<span class="op" id="4592235">:=</span>&nbsp;<span class="keyword" id="4592238">range</span>&nbsp;<span class="ident" id="4592244"><a href="/compress/flate/huffman_code.go.html#4592163">bitCount</a></span>&nbsp;<span class="op" id="4592253">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592257"><a href="/compress/flate/huffman_code.go.html#4592204">code</a></span>&nbsp;<span class="op" id="4592262">&lt;&lt;=</span>&nbsp;<span class="num" id="4592266">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4592270">if</span>&nbsp;<span class="ident" id="4592273"><a href="/compress/flate/huffman_code.go.html#4592227">n</a></span>&nbsp;<span class="op" id="4592275">==</span>&nbsp;<span class="num" id="4592278">0</span>&nbsp;<span class="op" id="4592280">||</span>&nbsp;<span class="ident" id="4592283"><a href="/compress/flate/huffman_code.go.html#4592230">bits</a></span>&nbsp;<span class="op" id="4592288">==</span>&nbsp;<span class="num" id="4592291">0</span>&nbsp;<span class="op" id="4592293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4592298">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4592309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4592313">//&nbsp;The&nbsp;literals&nbsp;list[len(list)-bits]&nbsp;..&nbsp;list[len(list)-bits]</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4592376">//&nbsp;are&nbsp;encoded&nbsp;using&nbsp;&#34;bits&#34;&nbsp;bits,&nbsp;and&nbsp;get&nbsp;the&nbsp;values</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4592431">//&nbsp;code,&nbsp;code&nbsp;+&nbsp;1,&nbsp;....&nbsp;&nbsp;The&nbsp;code&nbsp;values&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4592478">//&nbsp;assigned&nbsp;in&nbsp;literal&nbsp;order&nbsp;(not&nbsp;frequency&nbsp;order).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592532">chunk</span>&nbsp;<span class="op" id="4592538">:=</span>&nbsp;<span class="ident" id="4592541"><a href="/compress/flate/huffman_code.go.html#4592181">list</a></span><span class="op" id="4592545">[</span><span class="builtinfunc" id="4592546">len</span><span class="op" id="4592549">(</span><span class="ident" id="4592550"><a href="/compress/flate/huffman_code.go.html#4592181">list</a></span><span class="op" id="4592554">)</span><span class="op" id="4592555">-</span><span class="builtintype" id="4592556">int</span><span class="op" id="4592559">(</span><span class="ident" id="4592560"><a href="/compress/flate/huffman_code.go.html#4592230">bits</a></span><span class="op" id="4592564">)</span><span class="op" id="4592565">:</span><span class="op" id="4592566">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592570"><a href="/compress/flate/huffman_code.go.html#4594536">sortByLiteral</a></span><span class="op" id="4592583">(</span><span class="ident" id="4592584"><a href="/compress/flate/huffman_code.go.html#4592532">chunk</a></span><span class="op" id="4592589">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4592593">for</span>&nbsp;<span class="ident" id="4592597">_</span><span class="op" id="4592598">,</span>&nbsp;<span class="ident" id="4592600">node</span>&nbsp;<span class="op" id="4592605">:=</span>&nbsp;<span class="keyword" id="4592608">range</span>&nbsp;<span class="ident" id="4592614"><a href="/compress/flate/huffman_code.go.html#4592532">chunk</a></span>&nbsp;<span class="op" id="4592620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592625"><a href="/compress/flate/huffman_code.go.html#4592122">h</a></span><span class="op" id="4592626">.</span><span class="ident" id="4592627">codeBits</span><span class="op" id="4592635">[</span><span class="ident" id="4592636"><a href="/compress/flate/huffman_code.go.html#4592600">node</a></span><span class="op" id="4592640">.</span><span class="ident" id="4592641">literal</span><span class="op" id="4592648">]</span>&nbsp;<span class="op" id="4592650">=</span>&nbsp;<span class="builtintype" id="4592652">uint8</span><span class="op" id="4592657">(</span><span class="ident" id="4592658"><a href="/compress/flate/huffman_code.go.html#4592227">n</a></span><span class="op" id="4592659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592664"><a href="/compress/flate/huffman_code.go.html#4592122">h</a></span><span class="op" id="4592665">.</span><span class="ident" id="4592666">code</span><span class="op" id="4592670">[</span><span class="ident" id="4592671"><a href="/compress/flate/huffman_code.go.html#4592600">node</a></span><span class="op" id="4592675">.</span><span class="ident" id="4592676">literal</span><span class="op" id="4592683">]</span>&nbsp;<span class="op" id="4592685">=</span>&nbsp;<span class="ident" id="4592687"><a href="/compress/flate/reverse_bits.go.html#4613479">reverseBits</a></span><span class="op" id="4592698">(</span><span class="ident" id="4592699"><a href="/compress/flate/huffman_code.go.html#4592204">code</a></span><span class="op" id="4592703">,</span>&nbsp;<span class="builtintype" id="4592705">uint8</span><span class="op" id="4592710">(</span><span class="ident" id="4592711"><a href="/compress/flate/huffman_code.go.html#4592227">n</a></span><span class="op" id="4592712">)</span><span class="op" id="4592713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592718"><a href="/compress/flate/huffman_code.go.html#4592204">code</a></span><span class="op" id="4592722">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4592727">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4592731"><a href="/compress/flate/huffman_code.go.html#4592181">list</a></span>&nbsp;<span class="op" id="4592736">=</span>&nbsp;<span class="ident" id="4592738"><a href="/compress/flate/huffman_code.go.html#4592181">list</a></span><span class="op" id="4592742">[</span><span class="num" id="4592743">0</span>&nbsp;<span class="op" id="4592745">:</span>&nbsp;<span class="builtinfunc" id="4592747">len</span><span class="op" id="4592750">(</span><span class="ident" id="4592751"><a href="/compress/flate/huffman_code.go.html#4592181">list</a></span><span class="op" id="4592755">)</span><span class="op" id="4592756">-</span><span class="builtintype" id="4592757">int</span><span class="op" id="4592760">(</span><span class="ident" id="4592761"><a href="/compress/flate/huffman_code.go.html#4592230">bits</a></span><span class="op" id="4592765">)</span><span class="op" id="4592766">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4592769">}</span><br>
<span class="lineno"></span><span class="op" id="4592771">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4592774">//&nbsp;Update&nbsp;this&nbsp;Huffman&nbsp;Code&nbsp;object&nbsp;to&nbsp;be&nbsp;the&nbsp;minimum&nbsp;code&nbsp;for&nbsp;the&nbsp;specified&nbsp;frequency&nbsp;count.</span><br>
<span class="lineno">260</span><span class="comment" id="4592867">//</span><br>
<span class="lineno"></span><span class="comment" id="4592870">//&nbsp;freq&nbsp;&nbsp;An&nbsp;array&nbsp;of&nbsp;frequencies,&nbsp;in&nbsp;which&nbsp;frequency[i]&nbsp;gives&nbsp;the&nbsp;frequency&nbsp;of&nbsp;literal&nbsp;i.</span><br>
<span class="lineno"></span><span class="comment" id="4592960">//&nbsp;maxBits&nbsp;&nbsp;The&nbsp;maximum&nbsp;number&nbsp;of&nbsp;bits&nbsp;to&nbsp;use&nbsp;for&nbsp;any&nbsp;literal.</span><br>
<span class="lineno"></span><span class="keyword" id="4593023">func</span>&nbsp;<span class="op" id="4593028">(</span><span class="ident" id="4593029">h</span>&nbsp;<span class="op" id="4593031">*</span><span class="ident" id="4593032"><a href="/compress/flate/huffman_code.go.html#4585510">huffmanEncoder</a></span><span class="op" id="4593046">)</span>&nbsp;<span class="ident" id="4593048">generate</span><span class="op" id="4593056">(</span><span class="ident" id="4593057">freq</span>&nbsp;<span class="op" id="4593062">[</span><span class="op" id="4593063">]</span><span class="builtintype" id="4593064">int32</span><span class="op" id="4593069">,</span>&nbsp;<span class="ident" id="4593071">maxBits</span>&nbsp;<span class="builtintype" id="4593079">int32</span><span class="op" id="4593084">)</span>&nbsp;<span class="op" id="4593086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593089">list</span>&nbsp;<span class="op" id="4593094">:=</span>&nbsp;<span class="builtinfunc" id="4593097">make</span><span class="op" id="4593101">(</span><span class="op" id="4593102">[</span><span class="op" id="4593103">]</span><span class="ident" id="4593104"><a href="/compress/flate/huffman_code.go.html#4585579">literalNode</a></span><span class="op" id="4593115">,</span>&nbsp;<span class="builtinfunc" id="4593117">len</span><span class="op" id="4593120">(</span><span class="ident" id="4593121"><a href="/compress/flate/huffman_code.go.html#4593057">freq</a></span><span class="op" id="4593125">)</span><span class="op" id="4593126">+</span><span class="num" id="4593127">1</span><span class="op" id="4593128">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4593131">//&nbsp;Number&nbsp;of&nbsp;non-zero&nbsp;literals</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593163">count</span>&nbsp;<span class="op" id="4593169">:=</span>&nbsp;<span class="num" id="4593172">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4593175">//&nbsp;Set&nbsp;list&nbsp;to&nbsp;be&nbsp;the&nbsp;set&nbsp;of&nbsp;all&nbsp;non-zero&nbsp;literals&nbsp;and&nbsp;their&nbsp;frequencies</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593249">for</span>&nbsp;<span class="ident" id="4593253">i</span><span class="op" id="4593254">,</span>&nbsp;<span class="ident" id="4593256">f</span>&nbsp;<span class="op" id="4593258">:=</span>&nbsp;<span class="keyword" id="4593261">range</span>&nbsp;<span class="ident" id="4593267"><a href="/compress/flate/huffman_code.go.html#4593057">freq</a></span>&nbsp;<span class="op" id="4593272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593276">if</span>&nbsp;<span class="ident" id="4593279"><a href="/compress/flate/huffman_code.go.html#4593256">f</a></span>&nbsp;<span class="op" id="4593281">!=</span>&nbsp;<span class="num" id="4593284">0</span>&nbsp;<span class="op" id="4593286">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593291"><a href="/compress/flate/huffman_code.go.html#4593089">list</a></span><span class="op" id="4593295">[</span><span class="ident" id="4593296"><a href="/compress/flate/huffman_code.go.html#4593163">count</a></span><span class="op" id="4593301">]</span>&nbsp;<span class="op" id="4593303">=</span>&nbsp;<span class="ident" id="4593305"><a href="/compress/flate/huffman_code.go.html#4585579">literalNode</a></span><span class="op" id="4593316">{</span><span class="builtintype" id="4593317">uint16</span><span class="op" id="4593323">(</span><span class="ident" id="4593324"><a href="/compress/flate/huffman_code.go.html#4593253">i</a></span><span class="op" id="4593325">)</span><span class="op" id="4593326">,</span>&nbsp;<span class="ident" id="4593328"><a href="/compress/flate/huffman_code.go.html#4593256">f</a></span><span class="op" id="4593329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593334"><a href="/compress/flate/huffman_code.go.html#4593163">count</a></span><span class="op" id="4593339">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4593344">}</span>&nbsp;<span class="keyword" id="4593346">else</span>&nbsp;<span class="op" id="4593351">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593356"><a href="/compress/flate/huffman_code.go.html#4593029">h</a></span><span class="op" id="4593357">.</span><span class="ident" id="4593358">codeBits</span><span class="op" id="4593366">[</span><span class="ident" id="4593367"><a href="/compress/flate/huffman_code.go.html#4593253">i</a></span><span class="op" id="4593368">]</span>&nbsp;<span class="op" id="4593370">=</span>&nbsp;<span class="num" id="4593372">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4593376">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4593379">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4593382">//&nbsp;If&nbsp;freq[]&nbsp;is&nbsp;shorter&nbsp;than&nbsp;codeBits[],&nbsp;fill&nbsp;rest&nbsp;of&nbsp;codeBits[]&nbsp;with&nbsp;zeros</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593459"><a href="/compress/flate/huffman_code.go.html#4593029">h</a></span><span class="op" id="4593460">.</span><span class="ident" id="4593461">codeBits</span>&nbsp;<span class="op" id="4593470">=</span>&nbsp;<span class="ident" id="4593472"><a href="/compress/flate/huffman_code.go.html#4593029">h</a></span><span class="op" id="4593473">.</span><span class="ident" id="4593474">codeBits</span><span class="op" id="4593482">[</span><span class="num" id="4593483">0</span><span class="op" id="4593484">:</span><span class="builtinfunc" id="4593485">len</span><span class="op" id="4593488">(</span><span class="ident" id="4593489"><a href="/compress/flate/huffman_code.go.html#4593057">freq</a></span><span class="op" id="4593493">)</span><span class="op" id="4593494">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593497"><a href="/compress/flate/huffman_code.go.html#4593089">list</a></span>&nbsp;<span class="op" id="4593502">=</span>&nbsp;<span class="ident" id="4593504"><a href="/compress/flate/huffman_code.go.html#4593089">list</a></span><span class="op" id="4593508">[</span><span class="num" id="4593509">0</span><span class="op" id="4593510">:</span><span class="ident" id="4593511"><a href="/compress/flate/huffman_code.go.html#4593163">count</a></span><span class="op" id="4593516">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593519">if</span>&nbsp;<span class="ident" id="4593522"><a href="/compress/flate/huffman_code.go.html#4593163">count</a></span>&nbsp;<span class="op" id="4593528">&lt;=</span>&nbsp;<span class="num" id="4593531">2</span>&nbsp;<span class="op" id="4593533">{</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4593537">//&nbsp;Handle&nbsp;the&nbsp;small&nbsp;cases&nbsp;here,&nbsp;because&nbsp;they&nbsp;are&nbsp;awkward&nbsp;for&nbsp;the&nbsp;general&nbsp;case&nbsp;code.&nbsp;&nbsp;With</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4593629">//&nbsp;two&nbsp;or&nbsp;fewer&nbsp;literals,&nbsp;everything&nbsp;has&nbsp;bit&nbsp;length&nbsp;1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593686">for</span>&nbsp;<span class="ident" id="4593690">i</span><span class="op" id="4593691">,</span>&nbsp;<span class="ident" id="4593693">node</span>&nbsp;<span class="op" id="4593698">:=</span>&nbsp;<span class="keyword" id="4593701">range</span>&nbsp;<span class="ident" id="4593707"><a href="/compress/flate/huffman_code.go.html#4593089">list</a></span>&nbsp;<span class="op" id="4593712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4593717">//&nbsp;&#34;list&#34;&nbsp;is&nbsp;in&nbsp;order&nbsp;of&nbsp;increasing&nbsp;literal&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593771"><a href="/compress/flate/huffman_code.go.html#4593029">h</a></span><span class="op" id="4593772">.</span><span class="ident" id="4593773">codeBits</span><span class="op" id="4593781">[</span><span class="ident" id="4593782"><a href="/compress/flate/huffman_code.go.html#4593693">node</a></span><span class="op" id="4593786">.</span><span class="ident" id="4593787">literal</span><span class="op" id="4593794">]</span>&nbsp;<span class="op" id="4593796">=</span>&nbsp;<span class="num" id="4593798">1</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593803"><a href="/compress/flate/huffman_code.go.html#4593029">h</a></span><span class="op" id="4593804">.</span><span class="ident" id="4593805">code</span><span class="op" id="4593809">[</span><span class="ident" id="4593810"><a href="/compress/flate/huffman_code.go.html#4593693">node</a></span><span class="op" id="4593814">.</span><span class="ident" id="4593815">literal</span><span class="op" id="4593822">]</span>&nbsp;<span class="op" id="4593824">=</span>&nbsp;<span class="builtintype" id="4593826">uint16</span><span class="op" id="4593832">(</span><span class="ident" id="4593833"><a href="/compress/flate/huffman_code.go.html#4593690">i</a></span><span class="op" id="4593834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4593838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4593842">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4593850">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593853"><a href="/compress/flate/huffman_code.go.html#4594327">sortByFreq</a></span><span class="op" id="4593863">(</span><span class="ident" id="4593864"><a href="/compress/flate/huffman_code.go.html#4593089">list</a></span><span class="op" id="4593868">)</span><br>
<span class="lineno">290</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4593872">//&nbsp;Get&nbsp;the&nbsp;number&nbsp;of&nbsp;literals&nbsp;for&nbsp;each&nbsp;bit&nbsp;count</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593922">bitCount</span>&nbsp;<span class="op" id="4593931">:=</span>&nbsp;<span class="ident" id="4593934"><a href="/compress/flate/huffman_code.go.html#4593029">h</a></span><span class="op" id="4593935">.</span><span class="ident" id="4593936">bitCounts</span><span class="op" id="4593945">(</span><span class="ident" id="4593946"><a href="/compress/flate/huffman_code.go.html#4593089">list</a></span><span class="op" id="4593950">,</span>&nbsp;<span class="ident" id="4593952"><a href="/compress/flate/huffman_code.go.html#4593071">maxBits</a></span><span class="op" id="4593959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4593962">//&nbsp;And&nbsp;do&nbsp;the&nbsp;assignment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4593988"><a href="/compress/flate/huffman_code.go.html#4593029">h</a></span><span class="op" id="4593989">.</span><span class="ident" id="4593990">assignEncodingAndSize</span><span class="op" id="4594011">(</span><span class="ident" id="4594012"><a href="/compress/flate/huffman_code.go.html#4593922">bitCount</a></span><span class="op" id="4594020">,</span>&nbsp;<span class="ident" id="4594022"><a href="/compress/flate/huffman_code.go.html#4593089">list</a></span><span class="op" id="4594026">)</span><br>
<span class="lineno">295</span><span class="op" id="4594028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4594031">type</span>&nbsp;<span class="ident" id="4594036">literalNodeSorter</span>&nbsp;<span class="keyword" id="4594054">struct</span>&nbsp;<span class="op" id="4594061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594064">a</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4594069">[</span><span class="op" id="4594070">]</span><span class="ident" id="4594071"><a href="/compress/flate/huffman_code.go.html#4585579">literalNode</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594084">less</span>&nbsp;<span class="keyword" id="4594089">func</span><span class="op" id="4594093">(</span><span class="ident" id="4594094">i</span><span class="op" id="4594095">,</span>&nbsp;<span class="ident" id="4594097">j</span>&nbsp;<span class="builtintype" id="4594099">int</span><span class="op" id="4594102">)</span>&nbsp;<span class="builtintype" id="4594104">bool</span><br>
<span class="lineno">300</span><span class="op" id="4594109">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4594112">func</span>&nbsp;<span class="op" id="4594117">(</span><span class="ident" id="4594118">s</span>&nbsp;<span class="ident" id="4594120"><a href="/compress/flate/huffman_code.go.html#4594036">literalNodeSorter</a></span><span class="op" id="4594137">)</span>&nbsp;<span class="ident" id="4594139">Len</span><span class="op" id="4594142">(</span><span class="op" id="4594143">)</span>&nbsp;<span class="builtintype" id="4594145">int</span>&nbsp;<span class="op" id="4594149">{</span>&nbsp;<span class="keyword" id="4594151">return</span>&nbsp;<span class="builtinfunc" id="4594158">len</span><span class="op" id="4594161">(</span><span class="ident" id="4594162"><a href="/compress/flate/huffman_code.go.html#4594118">s</a></span><span class="op" id="4594163">.</span><span class="ident" id="4594164">a</span><span class="op" id="4594165">)</span>&nbsp;<span class="op" id="4594167">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4594170">func</span>&nbsp;<span class="op" id="4594175">(</span><span class="ident" id="4594176">s</span>&nbsp;<span class="ident" id="4594178"><a href="/compress/flate/huffman_code.go.html#4594036">literalNodeSorter</a></span><span class="op" id="4594195">)</span>&nbsp;<span class="ident" id="4594197">Less</span><span class="op" id="4594201">(</span><span class="ident" id="4594202">i</span><span class="op" id="4594203">,</span>&nbsp;<span class="ident" id="4594205">j</span>&nbsp;<span class="builtintype" id="4594207">int</span><span class="op" id="4594210">)</span>&nbsp;<span class="builtintype" id="4594212">bool</span>&nbsp;<span class="op" id="4594217">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4594220">return</span>&nbsp;<span class="ident" id="4594227"><a href="/compress/flate/huffman_code.go.html#4594176">s</a></span><span class="op" id="4594228">.</span><span class="ident" id="4594229">less</span><span class="op" id="4594233">(</span><span class="ident" id="4594234"><a href="/compress/flate/huffman_code.go.html#4594202">i</a></span><span class="op" id="4594235">,</span>&nbsp;<span class="ident" id="4594237"><a href="/compress/flate/huffman_code.go.html#4594205">j</a></span><span class="op" id="4594238">)</span><br>
<span class="lineno"></span><span class="op" id="4594240">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4594243">func</span>&nbsp;<span class="op" id="4594248">(</span><span class="ident" id="4594249">s</span>&nbsp;<span class="ident" id="4594251"><a href="/compress/flate/huffman_code.go.html#4594036">literalNodeSorter</a></span><span class="op" id="4594268">)</span>&nbsp;<span class="ident" id="4594270">Swap</span><span class="op" id="4594274">(</span><span class="ident" id="4594275">i</span><span class="op" id="4594276">,</span>&nbsp;<span class="ident" id="4594278">j</span>&nbsp;<span class="builtintype" id="4594280">int</span><span class="op" id="4594283">)</span>&nbsp;<span class="op" id="4594285">{</span>&nbsp;<span class="ident" id="4594287"><a href="/compress/flate/huffman_code.go.html#4594249">s</a></span><span class="op" id="4594288">.</span><span class="ident" id="4594289">a</span><span class="op" id="4594290">[</span><span class="ident" id="4594291"><a href="/compress/flate/huffman_code.go.html#4594275">i</a></span><span class="op" id="4594292">]</span><span class="op" id="4594293">,</span>&nbsp;<span class="ident" id="4594295"><a href="/compress/flate/huffman_code.go.html#4594249">s</a></span><span class="op" id="4594296">.</span><span class="ident" id="4594297">a</span><span class="op" id="4594298">[</span><span class="ident" id="4594299"><a href="/compress/flate/huffman_code.go.html#4594278">j</a></span><span class="op" id="4594300">]</span>&nbsp;<span class="op" id="4594302">=</span>&nbsp;<span class="ident" id="4594304"><a href="/compress/flate/huffman_code.go.html#4594249">s</a></span><span class="op" id="4594305">.</span><span class="ident" id="4594306">a</span><span class="op" id="4594307">[</span><span class="ident" id="4594308"><a href="/compress/flate/huffman_code.go.html#4594278">j</a></span><span class="op" id="4594309">]</span><span class="op" id="4594310">,</span>&nbsp;<span class="ident" id="4594312"><a href="/compress/flate/huffman_code.go.html#4594249">s</a></span><span class="op" id="4594313">.</span><span class="ident" id="4594314">a</span><span class="op" id="4594315">[</span><span class="ident" id="4594316"><a href="/compress/flate/huffman_code.go.html#4594275">i</a></span><span class="op" id="4594317">]</span>&nbsp;<span class="op" id="4594319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="keyword" id="4594322">func</span>&nbsp;<span class="ident" id="4594327">sortByFreq</span><span class="op" id="4594337">(</span><span class="ident" id="4594338">a</span>&nbsp;<span class="op" id="4594340">[</span><span class="op" id="4594341">]</span><span class="ident" id="4594342"><a href="/compress/flate/huffman_code.go.html#4585579">literalNode</a></span><span class="op" id="4594353">)</span>&nbsp;<span class="op" id="4594355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594358">s</span>&nbsp;<span class="op" id="4594360">:=</span>&nbsp;<span class="op" id="4594363">&amp;</span><span class="ident" id="4594364"><a href="/compress/flate/huffman_code.go.html#4594036">literalNodeSorter</a></span><span class="op" id="4594381">{</span><span class="ident" id="4594382"><a href="/compress/flate/huffman_code.go.html#4594338">a</a></span><span class="op" id="4594383">,</span>&nbsp;<span class="keyword" id="4594385">func</span><span class="op" id="4594389">(</span><span class="ident" id="4594390">i</span><span class="op" id="4594391">,</span>&nbsp;<span class="ident" id="4594393">j</span>&nbsp;<span class="builtintype" id="4594395">int</span><span class="op" id="4594398">)</span>&nbsp;<span class="builtintype" id="4594400">bool</span>&nbsp;<span class="op" id="4594405">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4594409">if</span>&nbsp;<span class="ident" id="4594412"><a href="/compress/flate/huffman_code.go.html#4594338">a</a></span><span class="op" id="4594413">[</span><span class="ident" id="4594414"><a href="/compress/flate/huffman_code.go.html#4594390">i</a></span><span class="op" id="4594415">]</span><span class="op" id="4594416">.</span><span class="ident" id="4594417">freq</span>&nbsp;<span class="op" id="4594422">==</span>&nbsp;<span class="ident" id="4594425"><a href="/compress/flate/huffman_code.go.html#4594338">a</a></span><span class="op" id="4594426">[</span><span class="ident" id="4594427"><a href="/compress/flate/huffman_code.go.html#4594393">j</a></span><span class="op" id="4594428">]</span><span class="op" id="4594429">.</span><span class="ident" id="4594430">freq</span>&nbsp;<span class="op" id="4594435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4594440">return</span>&nbsp;<span class="ident" id="4594447"><a href="/compress/flate/huffman_code.go.html#4594338">a</a></span><span class="op" id="4594448">[</span><span class="ident" id="4594449"><a href="/compress/flate/huffman_code.go.html#4594390">i</a></span><span class="op" id="4594450">]</span><span class="op" id="4594451">.</span><span class="ident" id="4594452">literal</span>&nbsp;<span class="op" id="4594460">&lt;</span>&nbsp;<span class="ident" id="4594462"><a href="/compress/flate/huffman_code.go.html#4594338">a</a></span><span class="op" id="4594463">[</span><span class="ident" id="4594464"><a href="/compress/flate/huffman_code.go.html#4594393">j</a></span><span class="op" id="4594465">]</span><span class="op" id="4594466">.</span><span class="ident" id="4594467">literal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4594477">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4594481">return</span>&nbsp;<span class="ident" id="4594488"><a href="/compress/flate/huffman_code.go.html#4594338">a</a></span><span class="op" id="4594489">[</span><span class="ident" id="4594490"><a href="/compress/flate/huffman_code.go.html#4594390">i</a></span><span class="op" id="4594491">]</span><span class="op" id="4594492">.</span><span class="ident" id="4594493">freq</span>&nbsp;<span class="op" id="4594498">&lt;</span>&nbsp;<span class="ident" id="4594500"><a href="/compress/flate/huffman_code.go.html#4594338">a</a></span><span class="op" id="4594501">[</span><span class="ident" id="4594502"><a href="/compress/flate/huffman_code.go.html#4594393">j</a></span><span class="op" id="4594503">]</span><span class="op" id="4594504">.</span><span class="ident" id="4594505">freq</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4594511">}</span><span class="op" id="4594512">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594515"><a href="/compress/flate/huffman_code.go.html#4585495">sort</a></span><span class="op" id="4594519">.</span><span class="ident" id="4594520">Sort</span><span class="op" id="4594524">(</span><span class="ident" id="4594525"><a href="/compress/flate/huffman_code.go.html#4594358">s</a></span><span class="op" id="4594526">)</span><br>
<span class="lineno"></span><span class="op" id="4594528">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">320</span><span class="keyword" id="4594531">func</span>&nbsp;<span class="ident" id="4594536">sortByLiteral</span><span class="op" id="4594549">(</span><span class="ident" id="4594550">a</span>&nbsp;<span class="op" id="4594552">[</span><span class="op" id="4594553">]</span><span class="ident" id="4594554"><a href="/compress/flate/huffman_code.go.html#4585579">literalNode</a></span><span class="op" id="4594565">)</span>&nbsp;<span class="op" id="4594567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594570">s</span>&nbsp;<span class="op" id="4594572">:=</span>&nbsp;<span class="op" id="4594575">&amp;</span><span class="ident" id="4594576"><a href="/compress/flate/huffman_code.go.html#4594036">literalNodeSorter</a></span><span class="op" id="4594593">{</span><span class="ident" id="4594594"><a href="/compress/flate/huffman_code.go.html#4594550">a</a></span><span class="op" id="4594595">,</span>&nbsp;<span class="keyword" id="4594597">func</span><span class="op" id="4594601">(</span><span class="ident" id="4594602">i</span><span class="op" id="4594603">,</span>&nbsp;<span class="ident" id="4594605">j</span>&nbsp;<span class="builtintype" id="4594607">int</span><span class="op" id="4594610">)</span>&nbsp;<span class="builtintype" id="4594612">bool</span>&nbsp;<span class="op" id="4594617">{</span>&nbsp;<span class="keyword" id="4594619">return</span>&nbsp;<span class="ident" id="4594626"><a href="/compress/flate/huffman_code.go.html#4594550">a</a></span><span class="op" id="4594627">[</span><span class="ident" id="4594628"><a href="/compress/flate/huffman_code.go.html#4594602">i</a></span><span class="op" id="4594629">]</span><span class="op" id="4594630">.</span><span class="ident" id="4594631">literal</span>&nbsp;<span class="op" id="4594639">&lt;</span>&nbsp;<span class="ident" id="4594641"><a href="/compress/flate/huffman_code.go.html#4594550">a</a></span><span class="op" id="4594642">[</span><span class="ident" id="4594643"><a href="/compress/flate/huffman_code.go.html#4594605">j</a></span><span class="op" id="4594644">]</span><span class="op" id="4594645">.</span><span class="ident" id="4594646">literal</span>&nbsp;<span class="op" id="4594654">}</span><span class="op" id="4594655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4594658"><a href="/compress/flate/huffman_code.go.html#4585495">sort</a></span><span class="op" id="4594662">.</span><span class="ident" id="4594663">Sort</span><span class="op" id="4594667">(</span><span class="ident" id="4594668"><a href="/compress/flate/huffman_code.go.html#4594570">s</a></span><span class="op" id="4594669">)</span><br>
<span class="lineno"></span><span class="op" id="4594671">}</span>
</div>
</body>
</html>
