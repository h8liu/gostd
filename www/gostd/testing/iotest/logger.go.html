<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6214054">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6214109">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6214163">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6214214">package</span>&nbsp;<span class="ident" id="6214222">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6214230">import</span>&nbsp;<span class="op" id="6214237">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6214240">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6214246">&#34;log&#34;</span><br>
<span class="lineno">10</span><span class="op" id="6214252">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6214255">type</span>&nbsp;<span class="ident" id="6214260">writeLogger</span>&nbsp;<span class="keyword" id="6214272">struct</span>&nbsp;<span class="op" id="6214279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214282">prefix</span>&nbsp;<span class="builtintype" id="6214289">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214297">w</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6214304">io</span><span class="op" id="6214306">.</span><span class="ident" id="6214307">Writer</span><br>
<span class="lineno">15</span><span class="op" id="6214314">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6214317">func</span>&nbsp;<span class="op" id="6214322">(</span><span class="ident" id="6214323">l</span>&nbsp;<span class="op" id="6214325">*</span><span class="ident" id="6214326">writeLogger</span><span class="op" id="6214337">)</span>&nbsp;<span class="ident" id="6214339">Write</span><span class="op" id="6214344">(</span><span class="ident" id="6214345">p</span>&nbsp;<span class="op" id="6214347">[</span><span class="op" id="6214348">]</span><span class="builtintype" id="6214349">byte</span><span class="op" id="6214353">)</span>&nbsp;<span class="op" id="6214355">(</span><span class="ident" id="6214356">n</span>&nbsp;<span class="builtintype" id="6214358">int</span><span class="op" id="6214361">,</span>&nbsp;<span class="ident" id="6214363">err</span>&nbsp;<span class="builtintype" id="6214367">error</span><span class="op" id="6214372">)</span>&nbsp;<span class="op" id="6214374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214377">n</span><span class="op" id="6214378">,</span>&nbsp;<span class="ident" id="6214380">err</span>&nbsp;<span class="op" id="6214384">=</span>&nbsp;<span class="ident" id="6214386">l</span><span class="op" id="6214387">.</span><span class="ident" id="6214388">w</span><span class="op" id="6214389">.</span><span class="ident" id="6214390">Write</span><span class="op" id="6214395">(</span><span class="ident" id="6214396">p</span><span class="op" id="6214397">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214400">if</span>&nbsp;<span class="ident" id="6214403">err</span>&nbsp;<span class="op" id="6214407">!=</span>&nbsp;<span class="ident" id="6214410">nil</span>&nbsp;<span class="op" id="6214414">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214418">log</span><span class="op" id="6214421">.</span><span class="ident" id="6214422">Printf</span><span class="op" id="6214428">(</span><span class="string" id="6214429">&#34;%s&nbsp;%x:&nbsp;%v&#34;</span><span class="op" id="6214440">,</span>&nbsp;<span class="ident" id="6214442">l</span><span class="op" id="6214443">.</span><span class="ident" id="6214444">prefix</span><span class="op" id="6214450">,</span>&nbsp;<span class="ident" id="6214452">p</span><span class="op" id="6214453">[</span><span class="num" id="6214454">0</span><span class="op" id="6214455">:</span><span class="ident" id="6214456">n</span><span class="op" id="6214457">]</span><span class="op" id="6214458">,</span>&nbsp;<span class="ident" id="6214460">err</span><span class="op" id="6214463">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6214466">}</span>&nbsp;<span class="keyword" id="6214468">else</span>&nbsp;<span class="op" id="6214473">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214477">log</span><span class="op" id="6214480">.</span><span class="ident" id="6214481">Printf</span><span class="op" id="6214487">(</span><span class="string" id="6214488">&#34;%s&nbsp;%x&#34;</span><span class="op" id="6214495">,</span>&nbsp;<span class="ident" id="6214497">l</span><span class="op" id="6214498">.</span><span class="ident" id="6214499">prefix</span><span class="op" id="6214505">,</span>&nbsp;<span class="ident" id="6214507">p</span><span class="op" id="6214508">[</span><span class="num" id="6214509">0</span><span class="op" id="6214510">:</span><span class="ident" id="6214511">n</span><span class="op" id="6214512">]</span><span class="op" id="6214513">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6214516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214519">return</span><br>
<span class="lineno">25</span><span class="op" id="6214526">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6214529">//&nbsp;NewWriteLogger&nbsp;returns&nbsp;a&nbsp;writer&nbsp;that&nbsp;behaves&nbsp;like&nbsp;w&nbsp;except</span><br>
<span class="lineno"></span><span class="comment" id="6214591">//&nbsp;that&nbsp;it&nbsp;logs&nbsp;(using&nbsp;log.Printf)&nbsp;each&nbsp;write&nbsp;to&nbsp;standard&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="6214656">//&nbsp;printing&nbsp;the&nbsp;prefix&nbsp;and&nbsp;the&nbsp;hexadecimal&nbsp;data&nbsp;written.</span><br>
<span class="lineno">30</span><span class="keyword" id="6214713">func</span>&nbsp;<span class="ident" id="6214718">NewWriteLogger</span><span class="op" id="6214732">(</span><span class="ident" id="6214733">prefix</span>&nbsp;<span class="builtintype" id="6214740">string</span><span class="op" id="6214746">,</span>&nbsp;<span class="ident" id="6214748">w</span>&nbsp;<span class="ident" id="6214750">io</span><span class="op" id="6214752">.</span><span class="ident" id="6214753">Writer</span><span class="op" id="6214759">)</span>&nbsp;<span class="ident" id="6214761">io</span><span class="op" id="6214763">.</span><span class="ident" id="6214764">Writer</span>&nbsp;<span class="op" id="6214771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214774">return</span>&nbsp;<span class="op" id="6214781">&amp;</span><span class="ident" id="6214782">writeLogger</span><span class="op" id="6214793">{</span><span class="ident" id="6214794">prefix</span><span class="op" id="6214800">,</span>&nbsp;<span class="ident" id="6214802">w</span><span class="op" id="6214803">}</span><br>
<span class="lineno"></span><span class="op" id="6214805">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6214808">type</span>&nbsp;<span class="ident" id="6214813">readLogger</span>&nbsp;<span class="keyword" id="6214824">struct</span>&nbsp;<span class="op" id="6214831">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214834">prefix</span>&nbsp;<span class="builtintype" id="6214841">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214849">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6214856">io</span><span class="op" id="6214858">.</span><span class="ident" id="6214859">Reader</span><br>
<span class="lineno"></span><span class="op" id="6214866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6214869">func</span>&nbsp;<span class="op" id="6214874">(</span><span class="ident" id="6214875">l</span>&nbsp;<span class="op" id="6214877">*</span><span class="ident" id="6214878">readLogger</span><span class="op" id="6214888">)</span>&nbsp;<span class="ident" id="6214890">Read</span><span class="op" id="6214894">(</span><span class="ident" id="6214895">p</span>&nbsp;<span class="op" id="6214897">[</span><span class="op" id="6214898">]</span><span class="builtintype" id="6214899">byte</span><span class="op" id="6214903">)</span>&nbsp;<span class="op" id="6214905">(</span><span class="ident" id="6214906">n</span>&nbsp;<span class="builtintype" id="6214908">int</span><span class="op" id="6214911">,</span>&nbsp;<span class="ident" id="6214913">err</span>&nbsp;<span class="builtintype" id="6214917">error</span><span class="op" id="6214922">)</span>&nbsp;<span class="op" id="6214924">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214927">n</span><span class="op" id="6214928">,</span>&nbsp;<span class="ident" id="6214930">err</span>&nbsp;<span class="op" id="6214934">=</span>&nbsp;<span class="ident" id="6214936">l</span><span class="op" id="6214937">.</span><span class="ident" id="6214938">r</span><span class="op" id="6214939">.</span><span class="ident" id="6214940">Read</span><span class="op" id="6214944">(</span><span class="ident" id="6214945">p</span><span class="op" id="6214946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6214949">if</span>&nbsp;<span class="ident" id="6214952">err</span>&nbsp;<span class="op" id="6214956">!=</span>&nbsp;<span class="ident" id="6214959">nil</span>&nbsp;<span class="op" id="6214963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6214967">log</span><span class="op" id="6214970">.</span><span class="ident" id="6214971">Printf</span><span class="op" id="6214977">(</span><span class="string" id="6214978">&#34;%s&nbsp;%x:&nbsp;%v&#34;</span><span class="op" id="6214989">,</span>&nbsp;<span class="ident" id="6214991">l</span><span class="op" id="6214992">.</span><span class="ident" id="6214993">prefix</span><span class="op" id="6214999">,</span>&nbsp;<span class="ident" id="6215001">p</span><span class="op" id="6215002">[</span><span class="num" id="6215003">0</span><span class="op" id="6215004">:</span><span class="ident" id="6215005">n</span><span class="op" id="6215006">]</span><span class="op" id="6215007">,</span>&nbsp;<span class="ident" id="6215009">err</span><span class="op" id="6215012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6215015">}</span>&nbsp;<span class="keyword" id="6215017">else</span>&nbsp;<span class="op" id="6215022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6215026">log</span><span class="op" id="6215029">.</span><span class="ident" id="6215030">Printf</span><span class="op" id="6215036">(</span><span class="string" id="6215037">&#34;%s&nbsp;%x&#34;</span><span class="op" id="6215044">,</span>&nbsp;<span class="ident" id="6215046">l</span><span class="op" id="6215047">.</span><span class="ident" id="6215048">prefix</span><span class="op" id="6215054">,</span>&nbsp;<span class="ident" id="6215056">p</span><span class="op" id="6215057">[</span><span class="num" id="6215058">0</span><span class="op" id="6215059">:</span><span class="ident" id="6215060">n</span><span class="op" id="6215061">]</span><span class="op" id="6215062">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6215065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215068">return</span><br>
<span class="lineno"></span><span class="op" id="6215075">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6215078">//&nbsp;NewReadLogger&nbsp;returns&nbsp;a&nbsp;reader&nbsp;that&nbsp;behaves&nbsp;like&nbsp;r&nbsp;except</span><br>
<span class="lineno">50</span><span class="comment" id="6215139">//&nbsp;that&nbsp;it&nbsp;logs&nbsp;(using&nbsp;log.Print)&nbsp;each&nbsp;read&nbsp;to&nbsp;standard&nbsp;error,</span><br>
<span class="lineno"></span><span class="comment" id="6215202">//&nbsp;printing&nbsp;the&nbsp;prefix&nbsp;and&nbsp;the&nbsp;hexadecimal&nbsp;data&nbsp;written.</span><br>
<span class="lineno"></span><span class="keyword" id="6215259">func</span>&nbsp;<span class="ident" id="6215264">NewReadLogger</span><span class="op" id="6215277">(</span><span class="ident" id="6215278">prefix</span>&nbsp;<span class="builtintype" id="6215285">string</span><span class="op" id="6215291">,</span>&nbsp;<span class="ident" id="6215293">r</span>&nbsp;<span class="ident" id="6215295">io</span><span class="op" id="6215297">.</span><span class="ident" id="6215298">Reader</span><span class="op" id="6215304">)</span>&nbsp;<span class="ident" id="6215306">io</span><span class="op" id="6215308">.</span><span class="ident" id="6215309">Reader</span>&nbsp;<span class="op" id="6215316">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6215319">return</span>&nbsp;<span class="op" id="6215326">&amp;</span><span class="ident" id="6215327">readLogger</span><span class="op" id="6215337">{</span><span class="ident" id="6215338">prefix</span><span class="op" id="6215344">,</span>&nbsp;<span class="ident" id="6215346">r</span><span class="op" id="6215347">}</span><br>
<span class="lineno"></span><span class="op" id="6215349">}</span>
</div>
</body>
</html>
