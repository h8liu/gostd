<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing/iotest</h2>
<ul>
<li><a href="/gostd/testing/iotest/logger.go.html">logger.go</a></li>
<li><a href="/gostd/testing/iotest/reader.go.html">reader.go</a></li>
<li><a href="/gostd/testing/iotest/writer.go.html">writer.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6222653">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6222708">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6222762">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="6222813">//&nbsp;Package&nbsp;iotest&nbsp;implements&nbsp;Readers&nbsp;and&nbsp;Writers&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="6222889">package</span>&nbsp;<span class="ident" id="6222897">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6222905">import</span>&nbsp;<span class="op" id="6222912">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6222915">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6222925">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="6222930">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6222933">//&nbsp;OneByteReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements</span><br>
<span class="lineno"></span><span class="comment" id="6222983">//&nbsp;each&nbsp;non-empty&nbsp;Read&nbsp;by&nbsp;reading&nbsp;one&nbsp;byte&nbsp;from&nbsp;r.</span><br>
<span class="lineno">15</span><span class="keyword" id="6223034">func</span>&nbsp;<span class="ident" id="6223039">OneByteReader</span><span class="op" id="6223052">(</span><span class="ident" id="6223053">r</span>&nbsp;<span class="ident" id="6223055">io</span><span class="op" id="6223057">.</span><span class="ident" id="6223058">Reader</span><span class="op" id="6223064">)</span>&nbsp;<span class="ident" id="6223066">io</span><span class="op" id="6223068">.</span><span class="ident" id="6223069">Reader</span>&nbsp;<span class="op" id="6223076">{</span>&nbsp;<span class="keyword" id="6223078">return</span>&nbsp;<span class="op" id="6223085">&amp;</span><span class="ident" id="6223086">oneByteReader</span><span class="op" id="6223099">{</span><span class="ident" id="6223100">r</span><span class="op" id="6223101">}</span>&nbsp;<span class="op" id="6223103">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6223106">type</span>&nbsp;<span class="ident" id="6223111">oneByteReader</span>&nbsp;<span class="keyword" id="6223125">struct</span>&nbsp;<span class="op" id="6223132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6223135">r</span>&nbsp;<span class="ident" id="6223137">io</span><span class="op" id="6223139">.</span><span class="ident" id="6223140">Reader</span><br>
<span class="lineno"></span><span class="op" id="6223147">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="6223150">func</span>&nbsp;<span class="op" id="6223155">(</span><span class="ident" id="6223156">r</span>&nbsp;<span class="op" id="6223158">*</span><span class="ident" id="6223159">oneByteReader</span><span class="op" id="6223172">)</span>&nbsp;<span class="ident" id="6223174">Read</span><span class="op" id="6223178">(</span><span class="ident" id="6223179">p</span>&nbsp;<span class="op" id="6223181">[</span><span class="op" id="6223182">]</span><span class="builtintype" id="6223183">byte</span><span class="op" id="6223187">)</span>&nbsp;<span class="op" id="6223189">(</span><span class="builtintype" id="6223190">int</span><span class="op" id="6223193">,</span>&nbsp;<span class="builtintype" id="6223195">error</span><span class="op" id="6223200">)</span>&nbsp;<span class="op" id="6223202">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6223205">if</span>&nbsp;<span class="builtinfunc" id="6223208">len</span><span class="op" id="6223211">(</span><span class="ident" id="6223212">p</span><span class="op" id="6223213">)</span>&nbsp;<span class="op" id="6223215">==</span>&nbsp;<span class="num" id="6223218">0</span>&nbsp;<span class="op" id="6223220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6223224">return</span>&nbsp;<span class="num" id="6223231">0</span><span class="op" id="6223232">,</span>&nbsp;<span class="ident" id="6223234">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6223239">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6223242">return</span>&nbsp;<span class="ident" id="6223249">r</span><span class="op" id="6223250">.</span><span class="ident" id="6223251">r</span><span class="op" id="6223252">.</span><span class="ident" id="6223253">Read</span><span class="op" id="6223257">(</span><span class="ident" id="6223258">p</span><span class="op" id="6223259">[</span><span class="num" id="6223260">0</span><span class="op" id="6223261">:</span><span class="num" id="6223262">1</span><span class="op" id="6223263">]</span><span class="op" id="6223264">)</span><br>
<span class="lineno"></span><span class="op" id="6223266">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6223269">//&nbsp;HalfReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="6223321">//&nbsp;by&nbsp;reading&nbsp;half&nbsp;as&nbsp;many&nbsp;requested&nbsp;bytes&nbsp;from&nbsp;r.</span><br>
<span class="lineno">30</span><span class="keyword" id="6223372">func</span>&nbsp;<span class="ident" id="6223377">HalfReader</span><span class="op" id="6223387">(</span><span class="ident" id="6223388">r</span>&nbsp;<span class="ident" id="6223390">io</span><span class="op" id="6223392">.</span><span class="ident" id="6223393">Reader</span><span class="op" id="6223399">)</span>&nbsp;<span class="ident" id="6223401">io</span><span class="op" id="6223403">.</span><span class="ident" id="6223404">Reader</span>&nbsp;<span class="op" id="6223411">{</span>&nbsp;<span class="keyword" id="6223413">return</span>&nbsp;<span class="op" id="6223420">&amp;</span><span class="ident" id="6223421">halfReader</span><span class="op" id="6223431">{</span><span class="ident" id="6223432">r</span><span class="op" id="6223433">}</span>&nbsp;<span class="op" id="6223435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6223438">type</span>&nbsp;<span class="ident" id="6223443">halfReader</span>&nbsp;<span class="keyword" id="6223454">struct</span>&nbsp;<span class="op" id="6223461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6223464">r</span>&nbsp;<span class="ident" id="6223466">io</span><span class="op" id="6223468">.</span><span class="ident" id="6223469">Reader</span><br>
<span class="lineno"></span><span class="op" id="6223476">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="6223479">func</span>&nbsp;<span class="op" id="6223484">(</span><span class="ident" id="6223485">r</span>&nbsp;<span class="op" id="6223487">*</span><span class="ident" id="6223488">halfReader</span><span class="op" id="6223498">)</span>&nbsp;<span class="ident" id="6223500">Read</span><span class="op" id="6223504">(</span><span class="ident" id="6223505">p</span>&nbsp;<span class="op" id="6223507">[</span><span class="op" id="6223508">]</span><span class="builtintype" id="6223509">byte</span><span class="op" id="6223513">)</span>&nbsp;<span class="op" id="6223515">(</span><span class="builtintype" id="6223516">int</span><span class="op" id="6223519">,</span>&nbsp;<span class="builtintype" id="6223521">error</span><span class="op" id="6223526">)</span>&nbsp;<span class="op" id="6223528">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6223531">return</span>&nbsp;<span class="ident" id="6223538">r</span><span class="op" id="6223539">.</span><span class="ident" id="6223540">r</span><span class="op" id="6223541">.</span><span class="ident" id="6223542">Read</span><span class="op" id="6223546">(</span><span class="ident" id="6223547">p</span><span class="op" id="6223548">[</span><span class="num" id="6223549">0</span>&nbsp;<span class="op" id="6223551">:</span>&nbsp;<span class="op" id="6223553">(</span><span class="builtinfunc" id="6223554">len</span><span class="op" id="6223557">(</span><span class="ident" id="6223558">p</span><span class="op" id="6223559">)</span><span class="op" id="6223560">+</span><span class="num" id="6223561">1</span><span class="op" id="6223562">)</span><span class="op" id="6223563">/</span><span class="num" id="6223564">2</span><span class="op" id="6223565">]</span><span class="op" id="6223566">)</span><br>
<span class="lineno"></span><span class="op" id="6223568">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="6223571">//&nbsp;DataErrReader&nbsp;changes&nbsp;the&nbsp;way&nbsp;errors&nbsp;are&nbsp;handled&nbsp;by&nbsp;a&nbsp;Reader.&nbsp;Normally,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="6223648">//&nbsp;Reader&nbsp;returns&nbsp;an&nbsp;error&nbsp;(typically&nbsp;EOF)&nbsp;from&nbsp;the&nbsp;first&nbsp;Read&nbsp;call&nbsp;after&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6223726">//&nbsp;last&nbsp;piece&nbsp;of&nbsp;data&nbsp;is&nbsp;read.&nbsp;DataErrReader&nbsp;wraps&nbsp;a&nbsp;Reader&nbsp;and&nbsp;changes&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="6223802">//&nbsp;behavior&nbsp;so&nbsp;the&nbsp;final&nbsp;error&nbsp;is&nbsp;returned&nbsp;along&nbsp;with&nbsp;the&nbsp;final&nbsp;data,&nbsp;instead</span><br>
<span class="lineno"></span><span class="comment" id="6223880">//&nbsp;of&nbsp;in&nbsp;the&nbsp;first&nbsp;call&nbsp;after&nbsp;the&nbsp;final&nbsp;data.</span><br>
<span class="lineno">45</span><span class="keyword" id="6223926">func</span>&nbsp;<span class="ident" id="6223931">DataErrReader</span><span class="op" id="6223944">(</span><span class="ident" id="6223945">r</span>&nbsp;<span class="ident" id="6223947">io</span><span class="op" id="6223949">.</span><span class="ident" id="6223950">Reader</span><span class="op" id="6223956">)</span>&nbsp;<span class="ident" id="6223958">io</span><span class="op" id="6223960">.</span><span class="ident" id="6223961">Reader</span>&nbsp;<span class="op" id="6223968">{</span>&nbsp;<span class="keyword" id="6223970">return</span>&nbsp;<span class="op" id="6223977">&amp;</span><span class="ident" id="6223978">dataErrReader</span><span class="op" id="6223991">{</span><span class="ident" id="6223992">r</span><span class="op" id="6223993">,</span>&nbsp;<span class="ident" id="6223995">nil</span><span class="op" id="6223998">,</span>&nbsp;<span class="builtinfunc" id="6224000">make</span><span class="op" id="6224004">(</span><span class="op" id="6224005">[</span><span class="op" id="6224006">]</span><span class="builtintype" id="6224007">byte</span><span class="op" id="6224011">,</span>&nbsp;<span class="num" id="6224013">1024</span><span class="op" id="6224017">)</span><span class="op" id="6224018">}</span>&nbsp;<span class="op" id="6224020">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6224023">type</span>&nbsp;<span class="ident" id="6224028">dataErrReader</span>&nbsp;<span class="keyword" id="6224042">struct</span>&nbsp;<span class="op" id="6224049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6224052">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6224059">io</span><span class="op" id="6224061">.</span><span class="ident" id="6224062">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6224070">unread</span>&nbsp;<span class="op" id="6224077">[</span><span class="op" id="6224078">]</span><span class="builtintype" id="6224079">byte</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6224085">data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6224092">[</span><span class="op" id="6224093">]</span><span class="builtintype" id="6224094">byte</span><br>
<span class="lineno"></span><span class="op" id="6224099">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6224102">func</span>&nbsp;<span class="op" id="6224107">(</span><span class="ident" id="6224108">r</span>&nbsp;<span class="op" id="6224110">*</span><span class="ident" id="6224111">dataErrReader</span><span class="op" id="6224124">)</span>&nbsp;<span class="ident" id="6224126">Read</span><span class="op" id="6224130">(</span><span class="ident" id="6224131">p</span>&nbsp;<span class="op" id="6224133">[</span><span class="op" id="6224134">]</span><span class="builtintype" id="6224135">byte</span><span class="op" id="6224139">)</span>&nbsp;<span class="op" id="6224141">(</span><span class="ident" id="6224142">n</span>&nbsp;<span class="builtintype" id="6224144">int</span><span class="op" id="6224147">,</span>&nbsp;<span class="ident" id="6224149">err</span>&nbsp;<span class="builtintype" id="6224153">error</span><span class="op" id="6224158">)</span>&nbsp;<span class="op" id="6224160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6224163">//&nbsp;loop&nbsp;because&nbsp;first&nbsp;call&nbsp;needs&nbsp;two&nbsp;reads:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6224208">//&nbsp;one&nbsp;to&nbsp;get&nbsp;data&nbsp;and&nbsp;a&nbsp;second&nbsp;to&nbsp;look&nbsp;for&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6224263">for</span>&nbsp;<span class="op" id="6224267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6224271">if</span>&nbsp;<span class="builtinfunc" id="6224274">len</span><span class="op" id="6224277">(</span><span class="ident" id="6224278">r</span><span class="op" id="6224279">.</span><span class="ident" id="6224280">unread</span><span class="op" id="6224286">)</span>&nbsp;<span class="op" id="6224288">==</span>&nbsp;<span class="num" id="6224291">0</span>&nbsp;<span class="op" id="6224293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6224298">n1</span><span class="op" id="6224300">,</span>&nbsp;<span class="ident" id="6224302">err1</span>&nbsp;<span class="op" id="6224307">:=</span>&nbsp;<span class="ident" id="6224310">r</span><span class="op" id="6224311">.</span><span class="ident" id="6224312">r</span><span class="op" id="6224313">.</span><span class="ident" id="6224314">Read</span><span class="op" id="6224318">(</span><span class="ident" id="6224319">r</span><span class="op" id="6224320">.</span><span class="ident" id="6224321">data</span><span class="op" id="6224325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6224330">r</span><span class="op" id="6224331">.</span><span class="ident" id="6224332">unread</span>&nbsp;<span class="op" id="6224339">=</span>&nbsp;<span class="ident" id="6224341">r</span><span class="op" id="6224342">.</span><span class="ident" id="6224343">data</span><span class="op" id="6224347">[</span><span class="num" id="6224348">0</span><span class="op" id="6224349">:</span><span class="ident" id="6224350">n1</span><span class="op" id="6224352">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6224357">err</span>&nbsp;<span class="op" id="6224361">=</span>&nbsp;<span class="ident" id="6224363">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6224370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6224374">if</span>&nbsp;<span class="ident" id="6224377">n</span>&nbsp;<span class="op" id="6224379">&gt;</span>&nbsp;<span class="num" id="6224381">0</span>&nbsp;<span class="op" id="6224383">||</span>&nbsp;<span class="ident" id="6224386">err</span>&nbsp;<span class="op" id="6224390">!=</span>&nbsp;<span class="ident" id="6224393">nil</span>&nbsp;<span class="op" id="6224397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6224402">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6224410">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6224414">n</span>&nbsp;<span class="op" id="6224416">=</span>&nbsp;<span class="builtinfunc" id="6224418">copy</span><span class="op" id="6224422">(</span><span class="ident" id="6224423">p</span><span class="op" id="6224424">,</span>&nbsp;<span class="ident" id="6224426">r</span><span class="op" id="6224427">.</span><span class="ident" id="6224428">unread</span><span class="op" id="6224434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6224438">r</span><span class="op" id="6224439">.</span><span class="ident" id="6224440">unread</span>&nbsp;<span class="op" id="6224447">=</span>&nbsp;<span class="ident" id="6224449">r</span><span class="op" id="6224450">.</span><span class="ident" id="6224451">unread</span><span class="op" id="6224457">[</span><span class="ident" id="6224458">n</span><span class="op" id="6224459">:</span><span class="op" id="6224460">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6224463">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6224466">return</span><br>
<span class="lineno"></span><span class="op" id="6224473">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="6224476">var</span>&nbsp;<span class="ident" id="6224480">ErrTimeout</span>&nbsp;<span class="op" id="6224491">=</span>&nbsp;<span class="ident" id="6224493">errors</span><span class="op" id="6224499">.</span><span class="ident" id="6224500">New</span><span class="op" id="6224503">(</span><span class="string" id="6224504">&#34;timeout&#34;</span><span class="op" id="6224513">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6224516">//&nbsp;TimeoutReader&nbsp;returns&nbsp;ErrTimeout&nbsp;on&nbsp;the&nbsp;second&nbsp;read</span><br>
<span class="lineno"></span><span class="comment" id="6224571">//&nbsp;with&nbsp;no&nbsp;data.&nbsp;&nbsp;Subsequent&nbsp;calls&nbsp;to&nbsp;read&nbsp;succeed.</span><br>
<span class="lineno">75</span><span class="keyword" id="6224623">func</span>&nbsp;<span class="ident" id="6224628">TimeoutReader</span><span class="op" id="6224641">(</span><span class="ident" id="6224642">r</span>&nbsp;<span class="ident" id="6224644">io</span><span class="op" id="6224646">.</span><span class="ident" id="6224647">Reader</span><span class="op" id="6224653">)</span>&nbsp;<span class="ident" id="6224655">io</span><span class="op" id="6224657">.</span><span class="ident" id="6224658">Reader</span>&nbsp;<span class="op" id="6224665">{</span>&nbsp;<span class="keyword" id="6224667">return</span>&nbsp;<span class="op" id="6224674">&amp;</span><span class="ident" id="6224675">timeoutReader</span><span class="op" id="6224688">{</span><span class="ident" id="6224689">r</span><span class="op" id="6224690">,</span>&nbsp;<span class="num" id="6224692">0</span><span class="op" id="6224693">}</span>&nbsp;<span class="op" id="6224695">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6224698">type</span>&nbsp;<span class="ident" id="6224703">timeoutReader</span>&nbsp;<span class="keyword" id="6224717">struct</span>&nbsp;<span class="op" id="6224724">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6224727">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6224733">io</span><span class="op" id="6224735">.</span><span class="ident" id="6224736">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6224744">count</span>&nbsp;<span class="builtintype" id="6224750">int</span><br>
<span class="lineno">80</span><span class="op" id="6224754">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6224757">func</span>&nbsp;<span class="op" id="6224762">(</span><span class="ident" id="6224763">r</span>&nbsp;<span class="op" id="6224765">*</span><span class="ident" id="6224766">timeoutReader</span><span class="op" id="6224779">)</span>&nbsp;<span class="ident" id="6224781">Read</span><span class="op" id="6224785">(</span><span class="ident" id="6224786">p</span>&nbsp;<span class="op" id="6224788">[</span><span class="op" id="6224789">]</span><span class="builtintype" id="6224790">byte</span><span class="op" id="6224794">)</span>&nbsp;<span class="op" id="6224796">(</span><span class="builtintype" id="6224797">int</span><span class="op" id="6224800">,</span>&nbsp;<span class="builtintype" id="6224802">error</span><span class="op" id="6224807">)</span>&nbsp;<span class="op" id="6224809">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6224812">r</span><span class="op" id="6224813">.</span><span class="ident" id="6224814">count</span><span class="op" id="6224819">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6224823">if</span>&nbsp;<span class="ident" id="6224826">r</span><span class="op" id="6224827">.</span><span class="ident" id="6224828">count</span>&nbsp;<span class="op" id="6224834">==</span>&nbsp;<span class="num" id="6224837">2</span>&nbsp;<span class="op" id="6224839">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6224843">return</span>&nbsp;<span class="num" id="6224850">0</span><span class="op" id="6224851">,</span>&nbsp;<span class="ident" id="6224853">ErrTimeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6224865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6224868">return</span>&nbsp;<span class="ident" id="6224875">r</span><span class="op" id="6224876">.</span><span class="ident" id="6224877">r</span><span class="op" id="6224878">.</span><span class="ident" id="6224879">Read</span><span class="op" id="6224883">(</span><span class="ident" id="6224884">p</span><span class="op" id="6224885">)</span><br>
<span class="lineno"></span><span class="op" id="6224887">}</span>
</div>
</body>
</html>
