<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/aes</h2>
<ul>
<li><a href="/gostd/crypto/aes/aes_test.go.html">aes_test.go</a></li>
<li><a href="/gostd/crypto/aes/block.go.html">block.go</a></li>
<li><a href="/gostd/crypto/aes/cipher.go.html">cipher.go</a></li>
<li><a href="/gostd/crypto/aes/cipher_asm.go.html">cipher_asm.go</a></li>
<li><a href="/gostd/crypto/aes/const.go.html">const.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6492636">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6492691">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6492745">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6492796">package</span>&nbsp;<span class="ident" id="6492804">aes</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6492809">import</span>&nbsp;<span class="op" id="6492816">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6492819">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="6492829">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="6492832">//&nbsp;See&nbsp;const.go&nbsp;for&nbsp;overview&nbsp;of&nbsp;math&nbsp;here.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6492876">//&nbsp;Test&nbsp;that&nbsp;powx&nbsp;is&nbsp;initialized&nbsp;correctly.</span><br>
<span class="lineno"></span><span class="comment" id="6492920">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;it&nbsp;too.)</span><br>
<span class="lineno">15</span><span class="keyword" id="6492965">func</span>&nbsp;<span class="ident" id="6492970">TestPowx</span><span class="op" id="6492978">(</span><span class="ident" id="6492979">t</span>&nbsp;<span class="op" id="6492981">*</span><span class="ident" id="6492982">testing</span><span class="op" id="6492989">.</span><span class="ident" id="6492990">T</span><span class="op" id="6492991">)</span>&nbsp;<span class="op" id="6492993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6492996">p</span>&nbsp;<span class="op" id="6492998">:=</span>&nbsp;<span class="num" id="6493001">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493004">for</span>&nbsp;<span class="ident" id="6493008">i</span>&nbsp;<span class="op" id="6493010">:=</span>&nbsp;<span class="num" id="6493013">0</span><span class="op" id="6493014">;</span>&nbsp;<span class="ident" id="6493016">i</span>&nbsp;<span class="op" id="6493018">&lt;</span>&nbsp;<span class="builtinfunc" id="6493020">len</span><span class="op" id="6493023">(</span><span class="ident" id="6493024">powx</span><span class="op" id="6493028">)</span><span class="op" id="6493029">;</span>&nbsp;<span class="ident" id="6493031">i</span><span class="op" id="6493032">++</span>&nbsp;<span class="op" id="6493035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493039">if</span>&nbsp;<span class="ident" id="6493042">powx</span><span class="op" id="6493046">[</span><span class="ident" id="6493047">i</span><span class="op" id="6493048">]</span>&nbsp;<span class="op" id="6493050">!=</span>&nbsp;<span class="builtintype" id="6493053">byte</span><span class="op" id="6493057">(</span><span class="ident" id="6493058">p</span><span class="op" id="6493059">)</span>&nbsp;<span class="op" id="6493061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493066">t</span><span class="op" id="6493067">.</span><span class="ident" id="6493068">Errorf</span><span class="op" id="6493074">(</span><span class="string" id="6493075">&#34;powx[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6493101">,</span>&nbsp;<span class="ident" id="6493103">i</span><span class="op" id="6493104">,</span>&nbsp;<span class="ident" id="6493106">powx</span><span class="op" id="6493110">[</span><span class="ident" id="6493111">i</span><span class="op" id="6493112">]</span><span class="op" id="6493113">,</span>&nbsp;<span class="ident" id="6493115">p</span><span class="op" id="6493116">)</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6493120">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493124">p</span>&nbsp;<span class="op" id="6493126">&lt;&lt;=</span>&nbsp;<span class="num" id="6493130">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493134">if</span>&nbsp;<span class="ident" id="6493137">p</span><span class="op" id="6493138">&amp;</span><span class="num" id="6493139">0x100</span>&nbsp;<span class="op" id="6493145">!=</span>&nbsp;<span class="num" id="6493148">0</span>&nbsp;<span class="op" id="6493150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493155">p</span>&nbsp;<span class="op" id="6493157">^=</span>&nbsp;<span class="ident" id="6493160">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6493167">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6493170">}</span><br>
<span class="lineno"></span><span class="op" id="6493172">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6493175">//&nbsp;Multiply&nbsp;b&nbsp;and&nbsp;c&nbsp;as&nbsp;GF(2)&nbsp;polynomials&nbsp;modulo&nbsp;poly</span><br>
<span class="lineno"></span><span class="keyword" id="6493228">func</span>&nbsp;<span class="ident" id="6493233">mul</span><span class="op" id="6493236">(</span><span class="ident" id="6493237">b</span><span class="op" id="6493238">,</span>&nbsp;<span class="ident" id="6493240">c</span>&nbsp;<span class="builtintype" id="6493242">uint32</span><span class="op" id="6493248">)</span>&nbsp;<span class="builtintype" id="6493250">uint32</span>&nbsp;<span class="op" id="6493257">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493260">i</span>&nbsp;<span class="op" id="6493262">:=</span>&nbsp;<span class="ident" id="6493265">b</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493268">j</span>&nbsp;<span class="op" id="6493270">:=</span>&nbsp;<span class="ident" id="6493273">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493276">s</span>&nbsp;<span class="op" id="6493278">:=</span>&nbsp;<span class="builtintype" id="6493281">uint32</span><span class="op" id="6493287">(</span><span class="num" id="6493288">0</span><span class="op" id="6493289">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493292">for</span>&nbsp;<span class="ident" id="6493296">k</span>&nbsp;<span class="op" id="6493298">:=</span>&nbsp;<span class="builtintype" id="6493301">uint32</span><span class="op" id="6493307">(</span><span class="num" id="6493308">1</span><span class="op" id="6493309">)</span><span class="op" id="6493310">;</span>&nbsp;<span class="ident" id="6493312">k</span>&nbsp;<span class="op" id="6493314">&lt;</span>&nbsp;<span class="num" id="6493316">0x100</span>&nbsp;<span class="op" id="6493322">&amp;&amp;</span>&nbsp;<span class="ident" id="6493325">j</span>&nbsp;<span class="op" id="6493327">!=</span>&nbsp;<span class="num" id="6493330">0</span><span class="op" id="6493331">;</span>&nbsp;<span class="ident" id="6493333">k</span>&nbsp;<span class="op" id="6493335">&lt;&lt;=</span>&nbsp;<span class="num" id="6493339">1</span>&nbsp;<span class="op" id="6493341">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6493345">//&nbsp;Invariant:&nbsp;k&nbsp;==&nbsp;1&lt;&lt;n,&nbsp;i&nbsp;==&nbsp;b&nbsp;*&nbsp;x‚Åø</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493387">if</span>&nbsp;<span class="ident" id="6493390">j</span><span class="op" id="6493391">&amp;</span><span class="ident" id="6493392">k</span>&nbsp;<span class="op" id="6493394">!=</span>&nbsp;<span class="num" id="6493397">0</span>&nbsp;<span class="op" id="6493399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6493404">//&nbsp;s&nbsp;+=&nbsp;i&nbsp;in&nbsp;GF(2);&nbsp;xor&nbsp;in&nbsp;binary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493441">s</span>&nbsp;<span class="op" id="6493443">^=</span>&nbsp;<span class="ident" id="6493446">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493451">j</span>&nbsp;<span class="op" id="6493453">^=</span>&nbsp;<span class="ident" id="6493456">k</span>&nbsp;<span class="comment" id="6493458">//&nbsp;turn&nbsp;off&nbsp;bit&nbsp;to&nbsp;end&nbsp;loop&nbsp;early</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6493494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6493499">//&nbsp;i&nbsp;*=&nbsp;x&nbsp;in&nbsp;GF(2)&nbsp;modulo&nbsp;the&nbsp;polynomial</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493542">i</span>&nbsp;<span class="op" id="6493544">&lt;&lt;=</span>&nbsp;<span class="num" id="6493548">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493552">if</span>&nbsp;<span class="ident" id="6493555">i</span><span class="op" id="6493556">&amp;</span><span class="num" id="6493557">0x100</span>&nbsp;<span class="op" id="6493563">!=</span>&nbsp;<span class="num" id="6493566">0</span>&nbsp;<span class="op" id="6493568">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493573">i</span>&nbsp;<span class="op" id="6493575">^=</span>&nbsp;<span class="ident" id="6493578">poly</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6493585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6493588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493591">return</span>&nbsp;<span class="ident" id="6493598">s</span><br>
<span class="lineno"></span><span class="op" id="6493600">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="comment" id="6493603">//&nbsp;Test&nbsp;all&nbsp;mul&nbsp;inputs&nbsp;against&nbsp;bit-by-bit&nbsp;n¬≤&nbsp;algorithm.</span><br>
<span class="lineno"></span><span class="keyword" id="6493660">func</span>&nbsp;<span class="ident" id="6493665">TestMul</span><span class="op" id="6493672">(</span><span class="ident" id="6493673">t</span>&nbsp;<span class="op" id="6493675">*</span><span class="ident" id="6493676">testing</span><span class="op" id="6493683">.</span><span class="ident" id="6493684">T</span><span class="op" id="6493685">)</span>&nbsp;<span class="op" id="6493687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493690">for</span>&nbsp;<span class="ident" id="6493694">i</span>&nbsp;<span class="op" id="6493696">:=</span>&nbsp;<span class="builtintype" id="6493699">uint32</span><span class="op" id="6493705">(</span><span class="num" id="6493706">0</span><span class="op" id="6493707">)</span><span class="op" id="6493708">;</span>&nbsp;<span class="ident" id="6493710">i</span>&nbsp;<span class="op" id="6493712">&lt;</span>&nbsp;<span class="num" id="6493714">256</span><span class="op" id="6493717">;</span>&nbsp;<span class="ident" id="6493719">i</span><span class="op" id="6493720">++</span>&nbsp;<span class="op" id="6493723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493727">for</span>&nbsp;<span class="ident" id="6493731">j</span>&nbsp;<span class="op" id="6493733">:=</span>&nbsp;<span class="builtintype" id="6493736">uint32</span><span class="op" id="6493742">(</span><span class="num" id="6493743">0</span><span class="op" id="6493744">)</span><span class="op" id="6493745">;</span>&nbsp;<span class="ident" id="6493747">j</span>&nbsp;<span class="op" id="6493749">&lt;</span>&nbsp;<span class="num" id="6493751">256</span><span class="op" id="6493754">;</span>&nbsp;<span class="ident" id="6493756">j</span><span class="op" id="6493757">++</span>&nbsp;<span class="op" id="6493760">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6493765">//&nbsp;Multiply&nbsp;i,&nbsp;j&nbsp;bit&nbsp;by&nbsp;bit.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493797">s</span>&nbsp;<span class="op" id="6493799">:=</span>&nbsp;<span class="builtintype" id="6493802">uint8</span><span class="op" id="6493807">(</span><span class="num" id="6493808">0</span><span class="op" id="6493809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493814">for</span>&nbsp;<span class="ident" id="6493818">k</span>&nbsp;<span class="op" id="6493820">:=</span>&nbsp;<span class="builtintype" id="6493823">uint</span><span class="op" id="6493827">(</span><span class="num" id="6493828">0</span><span class="op" id="6493829">)</span><span class="op" id="6493830">;</span>&nbsp;<span class="ident" id="6493832">k</span>&nbsp;<span class="op" id="6493834">&lt;</span>&nbsp;<span class="num" id="6493836">8</span><span class="op" id="6493837">;</span>&nbsp;<span class="ident" id="6493839">k</span><span class="op" id="6493840">++</span>&nbsp;<span class="op" id="6493843">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493849">for</span>&nbsp;<span class="ident" id="6493853">l</span>&nbsp;<span class="op" id="6493855">:=</span>&nbsp;<span class="builtintype" id="6493858">uint</span><span class="op" id="6493862">(</span><span class="num" id="6493863">0</span><span class="op" id="6493864">)</span><span class="op" id="6493865">;</span>&nbsp;<span class="ident" id="6493867">l</span>&nbsp;<span class="op" id="6493869">&lt;</span>&nbsp;<span class="num" id="6493871">8</span><span class="op" id="6493872">;</span>&nbsp;<span class="ident" id="6493874">l</span><span class="op" id="6493875">++</span>&nbsp;<span class="op" id="6493878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493885">if</span>&nbsp;<span class="ident" id="6493888">i</span><span class="op" id="6493889">&amp;</span><span class="op" id="6493890">(</span><span class="num" id="6493891">1</span><span class="op" id="6493892">&lt;&lt;</span><span class="ident" id="6493894">k</span><span class="op" id="6493895">)</span>&nbsp;<span class="op" id="6493897">!=</span>&nbsp;<span class="num" id="6493900">0</span>&nbsp;<span class="op" id="6493902">&amp;&amp;</span>&nbsp;<span class="ident" id="6493905">j</span><span class="op" id="6493906">&amp;</span><span class="op" id="6493907">(</span><span class="num" id="6493908">1</span><span class="op" id="6493909">&lt;&lt;</span><span class="ident" id="6493911">l</span><span class="op" id="6493912">)</span>&nbsp;<span class="op" id="6493914">!=</span>&nbsp;<span class="num" id="6493917">0</span>&nbsp;<span class="op" id="6493919">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6493927">s</span>&nbsp;<span class="op" id="6493929">^=</span>&nbsp;<span class="ident" id="6493932">powx</span><span class="op" id="6493936">[</span><span class="ident" id="6493937">k</span><span class="op" id="6493938">+</span><span class="ident" id="6493939">l</span><span class="op" id="6493940">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6493947">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6493953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6493958">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6493963">if</span>&nbsp;<span class="ident" id="6493966">x</span>&nbsp;<span class="op" id="6493968">:=</span>&nbsp;<span class="ident" id="6493971">mul</span><span class="op" id="6493974">(</span><span class="ident" id="6493975">i</span><span class="op" id="6493976">,</span>&nbsp;<span class="ident" id="6493978">j</span><span class="op" id="6493979">)</span><span class="op" id="6493980">;</span>&nbsp;<span class="ident" id="6493982">x</span>&nbsp;<span class="op" id="6493984">!=</span>&nbsp;<span class="builtintype" id="6493987">uint32</span><span class="op" id="6493993">(</span><span class="ident" id="6493994">s</span><span class="op" id="6493995">)</span>&nbsp;<span class="op" id="6493997">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494003">t</span><span class="op" id="6494004">.</span><span class="ident" id="6494005">Fatalf</span><span class="op" id="6494011">(</span><span class="string" id="6494012">&#34;mul(%#x,&nbsp;%#x)&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6494043">,</span>&nbsp;<span class="ident" id="6494045">i</span><span class="op" id="6494046">,</span>&nbsp;<span class="ident" id="6494048">j</span><span class="op" id="6494049">,</span>&nbsp;<span class="ident" id="6494051">x</span><span class="op" id="6494052">,</span>&nbsp;<span class="ident" id="6494054">s</span><span class="op" id="6494055">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6494060">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6494064">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6494067">}</span><br>
<span class="lineno"></span><span class="op" id="6494069">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="comment" id="6494072">//&nbsp;Check&nbsp;that&nbsp;S-boxes&nbsp;are&nbsp;inverses&nbsp;of&nbsp;each&nbsp;other.</span><br>
<span class="lineno"></span><span class="comment" id="6494122">//&nbsp;They&nbsp;have&nbsp;more&nbsp;structure&nbsp;that&nbsp;we&nbsp;could&nbsp;test,</span><br>
<span class="lineno"></span><span class="comment" id="6494170">//&nbsp;but&nbsp;if&nbsp;this&nbsp;sanity&nbsp;check&nbsp;passes,&nbsp;we&#39;ll&nbsp;assume</span><br>
<span class="lineno"></span><span class="comment" id="6494219">//&nbsp;the&nbsp;cut&nbsp;and&nbsp;paste&nbsp;from&nbsp;the&nbsp;FIPS&nbsp;PDF&nbsp;worked.</span><br>
<span class="lineno">75</span><span class="keyword" id="6494266">func</span>&nbsp;<span class="ident" id="6494271">TestSboxes</span><span class="op" id="6494281">(</span><span class="ident" id="6494282">t</span>&nbsp;<span class="op" id="6494284">*</span><span class="ident" id="6494285">testing</span><span class="op" id="6494292">.</span><span class="ident" id="6494293">T</span><span class="op" id="6494294">)</span>&nbsp;<span class="op" id="6494296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6494299">for</span>&nbsp;<span class="ident" id="6494303">i</span>&nbsp;<span class="op" id="6494305">:=</span>&nbsp;<span class="num" id="6494308">0</span><span class="op" id="6494309">;</span>&nbsp;<span class="ident" id="6494311">i</span>&nbsp;<span class="op" id="6494313">&lt;</span>&nbsp;<span class="num" id="6494315">256</span><span class="op" id="6494318">;</span>&nbsp;<span class="ident" id="6494320">i</span><span class="op" id="6494321">++</span>&nbsp;<span class="op" id="6494324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6494328">if</span>&nbsp;<span class="ident" id="6494331">j</span>&nbsp;<span class="op" id="6494333">:=</span>&nbsp;<span class="ident" id="6494336">sbox0</span><span class="op" id="6494341">[</span><span class="ident" id="6494342">sbox1</span><span class="op" id="6494347">[</span><span class="ident" id="6494348">i</span><span class="op" id="6494349">]</span><span class="op" id="6494350">]</span><span class="op" id="6494351">;</span>&nbsp;<span class="ident" id="6494353">j</span>&nbsp;<span class="op" id="6494355">!=</span>&nbsp;<span class="builtintype" id="6494358">byte</span><span class="op" id="6494362">(</span><span class="ident" id="6494363">i</span><span class="op" id="6494364">)</span>&nbsp;<span class="op" id="6494366">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494371">t</span><span class="op" id="6494372">.</span><span class="ident" id="6494373">Errorf</span><span class="op" id="6494379">(</span><span class="string" id="6494380">&#34;sbox0[sbox1[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="6494405">,</span>&nbsp;<span class="ident" id="6494407">i</span><span class="op" id="6494408">,</span>&nbsp;<span class="ident" id="6494410">j</span><span class="op" id="6494411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6494415">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6494419">if</span>&nbsp;<span class="ident" id="6494422">j</span>&nbsp;<span class="op" id="6494424">:=</span>&nbsp;<span class="ident" id="6494427">sbox1</span><span class="op" id="6494432">[</span><span class="ident" id="6494433">sbox0</span><span class="op" id="6494438">[</span><span class="ident" id="6494439">i</span><span class="op" id="6494440">]</span><span class="op" id="6494441">]</span><span class="op" id="6494442">;</span>&nbsp;<span class="ident" id="6494444">j</span>&nbsp;<span class="op" id="6494446">!=</span>&nbsp;<span class="builtintype" id="6494449">byte</span><span class="op" id="6494453">(</span><span class="ident" id="6494454">i</span><span class="op" id="6494455">)</span>&nbsp;<span class="op" id="6494457">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494462">t</span><span class="op" id="6494463">.</span><span class="ident" id="6494464">Errorf</span><span class="op" id="6494470">(</span><span class="string" id="6494471">&#34;sbox1[sbox0[%#x]]&nbsp;=&nbsp;%#x&#34;</span><span class="op" id="6494496">,</span>&nbsp;<span class="ident" id="6494498">i</span><span class="op" id="6494499">,</span>&nbsp;<span class="ident" id="6494501">j</span><span class="op" id="6494502">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6494506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6494509">}</span><br>
<span class="lineno"></span><span class="op" id="6494511">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="6494514">//&nbsp;Test&nbsp;that&nbsp;encryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno"></span><span class="comment" id="6494558">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="6494605">func</span>&nbsp;<span class="ident" id="6494610">TestTe</span><span class="op" id="6494616">(</span><span class="ident" id="6494617">t</span>&nbsp;<span class="op" id="6494619">*</span><span class="ident" id="6494620">testing</span><span class="op" id="6494627">.</span><span class="ident" id="6494628">T</span><span class="op" id="6494629">)</span>&nbsp;<span class="op" id="6494631">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6494634">for</span>&nbsp;<span class="ident" id="6494638">i</span>&nbsp;<span class="op" id="6494640">:=</span>&nbsp;<span class="num" id="6494643">0</span><span class="op" id="6494644">;</span>&nbsp;<span class="ident" id="6494646">i</span>&nbsp;<span class="op" id="6494648">&lt;</span>&nbsp;<span class="num" id="6494650">256</span><span class="op" id="6494653">;</span>&nbsp;<span class="ident" id="6494655">i</span><span class="op" id="6494656">++</span>&nbsp;<span class="op" id="6494659">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494663">s</span>&nbsp;<span class="op" id="6494665">:=</span>&nbsp;<span class="builtintype" id="6494668">uint32</span><span class="op" id="6494674">(</span><span class="ident" id="6494675">sbox0</span><span class="op" id="6494680">[</span><span class="ident" id="6494681">i</span><span class="op" id="6494682">]</span><span class="op" id="6494683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494687">s2</span>&nbsp;<span class="op" id="6494690">:=</span>&nbsp;<span class="ident" id="6494693">mul</span><span class="op" id="6494696">(</span><span class="ident" id="6494697">s</span><span class="op" id="6494698">,</span>&nbsp;<span class="num" id="6494700">2</span><span class="op" id="6494701">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494705">s3</span>&nbsp;<span class="op" id="6494708">:=</span>&nbsp;<span class="ident" id="6494711">mul</span><span class="op" id="6494714">(</span><span class="ident" id="6494715">s</span><span class="op" id="6494716">,</span>&nbsp;<span class="num" id="6494718">3</span><span class="op" id="6494719">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494723">w</span>&nbsp;<span class="op" id="6494725">:=</span>&nbsp;<span class="ident" id="6494728">s2</span><span class="op" id="6494730">&lt;&lt;</span><span class="num" id="6494732">24</span>&nbsp;<span class="op" id="6494735">|</span>&nbsp;<span class="ident" id="6494737">s</span><span class="op" id="6494738">&lt;&lt;</span><span class="num" id="6494740">16</span>&nbsp;<span class="op" id="6494743">|</span>&nbsp;<span class="ident" id="6494745">s</span><span class="op" id="6494746">&lt;&lt;</span><span class="num" id="6494748">8</span>&nbsp;<span class="op" id="6494750">|</span>&nbsp;<span class="ident" id="6494752">s3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494757">te</span>&nbsp;<span class="op" id="6494760">:=</span>&nbsp;<span class="op" id="6494763">[</span><span class="op" id="6494764">]</span><span class="op" id="6494765">[</span><span class="num" id="6494766">256</span><span class="op" id="6494769">]</span><span class="builtintype" id="6494770">uint32</span><span class="op" id="6494776">{</span><span class="ident" id="6494777">te0</span><span class="op" id="6494780">,</span>&nbsp;<span class="ident" id="6494782">te1</span><span class="op" id="6494785">,</span>&nbsp;<span class="ident" id="6494787">te2</span><span class="op" id="6494790">,</span>&nbsp;<span class="ident" id="6494792">te3</span><span class="op" id="6494795">}</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6494799">for</span>&nbsp;<span class="ident" id="6494803">j</span>&nbsp;<span class="op" id="6494805">:=</span>&nbsp;<span class="num" id="6494808">0</span><span class="op" id="6494809">;</span>&nbsp;<span class="ident" id="6494811">j</span>&nbsp;<span class="op" id="6494813">&lt;</span>&nbsp;<span class="num" id="6494815">4</span><span class="op" id="6494816">;</span>&nbsp;<span class="ident" id="6494818">j</span><span class="op" id="6494819">++</span>&nbsp;<span class="op" id="6494822">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6494827">if</span>&nbsp;<span class="ident" id="6494830">x</span>&nbsp;<span class="op" id="6494832">:=</span>&nbsp;<span class="ident" id="6494835">te</span><span class="op" id="6494837">[</span><span class="ident" id="6494838">j</span><span class="op" id="6494839">]</span><span class="op" id="6494840">[</span><span class="ident" id="6494841">i</span><span class="op" id="6494842">]</span><span class="op" id="6494843">;</span>&nbsp;<span class="ident" id="6494845">x</span>&nbsp;<span class="op" id="6494847">!=</span>&nbsp;<span class="ident" id="6494850">w</span>&nbsp;<span class="op" id="6494852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494858">t</span><span class="op" id="6494859">.</span><span class="ident" id="6494860">Fatalf</span><span class="op" id="6494866">(</span><span class="string" id="6494867">&#34;te[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6494895">,</span>&nbsp;<span class="ident" id="6494897">j</span><span class="op" id="6494898">,</span>&nbsp;<span class="ident" id="6494900">i</span><span class="op" id="6494901">,</span>&nbsp;<span class="ident" id="6494903">x</span><span class="op" id="6494904">,</span>&nbsp;<span class="ident" id="6494906">w</span><span class="op" id="6494907">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6494912">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6494917">w</span>&nbsp;<span class="op" id="6494919">=</span>&nbsp;<span class="ident" id="6494921">w</span><span class="op" id="6494922">&lt;&lt;</span><span class="num" id="6494924">24</span>&nbsp;<span class="op" id="6494927">|</span>&nbsp;<span class="ident" id="6494929">w</span><span class="op" id="6494930">&gt;&gt;</span><span class="num" id="6494932">8</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6494936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6494939">}</span><br>
<span class="lineno"></span><span class="op" id="6494941">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6494944">//&nbsp;Test&nbsp;that&nbsp;decryption&nbsp;tables&nbsp;are&nbsp;correct.</span><br>
<span class="lineno">105</span><span class="comment" id="6494988">//&nbsp;(Can&nbsp;adapt&nbsp;this&nbsp;code&nbsp;to&nbsp;generate&nbsp;them&nbsp;too.)</span><br>
<span class="lineno"></span><span class="keyword" id="6495035">func</span>&nbsp;<span class="ident" id="6495040">TestTd</span><span class="op" id="6495046">(</span><span class="ident" id="6495047">t</span>&nbsp;<span class="op" id="6495049">*</span><span class="ident" id="6495050">testing</span><span class="op" id="6495057">.</span><span class="ident" id="6495058">T</span><span class="op" id="6495059">)</span>&nbsp;<span class="op" id="6495061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6495064">for</span>&nbsp;<span class="ident" id="6495068">i</span>&nbsp;<span class="op" id="6495070">:=</span>&nbsp;<span class="num" id="6495073">0</span><span class="op" id="6495074">;</span>&nbsp;<span class="ident" id="6495076">i</span>&nbsp;<span class="op" id="6495078">&lt;</span>&nbsp;<span class="num" id="6495080">256</span><span class="op" id="6495083">;</span>&nbsp;<span class="ident" id="6495085">i</span><span class="op" id="6495086">++</span>&nbsp;<span class="op" id="6495089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6495093">s</span>&nbsp;<span class="op" id="6495095">:=</span>&nbsp;<span class="builtintype" id="6495098">uint32</span><span class="op" id="6495104">(</span><span class="ident" id="6495105">sbox1</span><span class="op" id="6495110">[</span><span class="ident" id="6495111">i</span><span class="op" id="6495112">]</span><span class="op" id="6495113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6495117">s9</span>&nbsp;<span class="op" id="6495120">:=</span>&nbsp;<span class="ident" id="6495123">mul</span><span class="op" id="6495126">(</span><span class="ident" id="6495127">s</span><span class="op" id="6495128">,</span>&nbsp;<span class="num" id="6495130">0x9</span><span class="op" id="6495133">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6495137">sb</span>&nbsp;<span class="op" id="6495140">:=</span>&nbsp;<span class="ident" id="6495143">mul</span><span class="op" id="6495146">(</span><span class="ident" id="6495147">s</span><span class="op" id="6495148">,</span>&nbsp;<span class="num" id="6495150">0xb</span><span class="op" id="6495153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6495157">sd</span>&nbsp;<span class="op" id="6495160">:=</span>&nbsp;<span class="ident" id="6495163">mul</span><span class="op" id="6495166">(</span><span class="ident" id="6495167">s</span><span class="op" id="6495168">,</span>&nbsp;<span class="num" id="6495170">0xd</span><span class="op" id="6495173">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6495177">se</span>&nbsp;<span class="op" id="6495180">:=</span>&nbsp;<span class="ident" id="6495183">mul</span><span class="op" id="6495186">(</span><span class="ident" id="6495187">s</span><span class="op" id="6495188">,</span>&nbsp;<span class="num" id="6495190">0xe</span><span class="op" id="6495193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6495197">w</span>&nbsp;<span class="op" id="6495199">:=</span>&nbsp;<span class="ident" id="6495202">se</span><span class="op" id="6495204">&lt;&lt;</span><span class="num" id="6495206">24</span>&nbsp;<span class="op" id="6495209">|</span>&nbsp;<span class="ident" id="6495211">s9</span><span class="op" id="6495213">&lt;&lt;</span><span class="num" id="6495215">16</span>&nbsp;<span class="op" id="6495218">|</span>&nbsp;<span class="ident" id="6495220">sd</span><span class="op" id="6495222">&lt;&lt;</span><span class="num" id="6495224">8</span>&nbsp;<span class="op" id="6495226">|</span>&nbsp;<span class="ident" id="6495228">sb</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6495233">td</span>&nbsp;<span class="op" id="6495236">:=</span>&nbsp;<span class="op" id="6495239">[</span><span class="op" id="6495240">]</span><span class="op" id="6495241">[</span><span class="num" id="6495242">256</span><span class="op" id="6495245">]</span><span class="builtintype" id="6495246">uint32</span><span class="op" id="6495252">{</span><span class="ident" id="6495253">td0</span><span class="op" id="6495256">,</span>&nbsp;<span class="ident" id="6495258">td1</span><span class="op" id="6495261">,</span>&nbsp;<span class="ident" id="6495263">td2</span><span class="op" id="6495266">,</span>&nbsp;<span class="ident" id="6495268">td3</span><span class="op" id="6495271">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6495275">for</span>&nbsp;<span class="ident" id="6495279">j</span>&nbsp;<span class="op" id="6495281">:=</span>&nbsp;<span class="num" id="6495284">0</span><span class="op" id="6495285">;</span>&nbsp;<span class="ident" id="6495287">j</span>&nbsp;<span class="op" id="6495289">&lt;</span>&nbsp;<span class="num" id="6495291">4</span><span class="op" id="6495292">;</span>&nbsp;<span class="ident" id="6495294">j</span><span class="op" id="6495295">++</span>&nbsp;<span class="op" id="6495298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6495303">if</span>&nbsp;<span class="ident" id="6495306">x</span>&nbsp;<span class="op" id="6495308">:=</span>&nbsp;<span class="ident" id="6495311">td</span><span class="op" id="6495313">[</span><span class="ident" id="6495314">j</span><span class="op" id="6495315">]</span><span class="op" id="6495316">[</span><span class="ident" id="6495317">i</span><span class="op" id="6495318">]</span><span class="op" id="6495319">;</span>&nbsp;<span class="ident" id="6495321">x</span>&nbsp;<span class="op" id="6495323">!=</span>&nbsp;<span class="ident" id="6495326">w</span>&nbsp;<span class="op" id="6495328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6495334">t</span><span class="op" id="6495335">.</span><span class="ident" id="6495336">Fatalf</span><span class="op" id="6495342">(</span><span class="string" id="6495343">&#34;td[%d][%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6495371">,</span>&nbsp;<span class="ident" id="6495373">j</span><span class="op" id="6495374">,</span>&nbsp;<span class="ident" id="6495376">i</span><span class="op" id="6495377">,</span>&nbsp;<span class="ident" id="6495379">x</span><span class="op" id="6495380">,</span>&nbsp;<span class="ident" id="6495382">w</span><span class="op" id="6495383">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6495388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6495393">w</span>&nbsp;<span class="op" id="6495395">=</span>&nbsp;<span class="ident" id="6495397">w</span><span class="op" id="6495398">&lt;&lt;</span><span class="num" id="6495400">24</span>&nbsp;<span class="op" id="6495403">|</span>&nbsp;<span class="ident" id="6495405">w</span><span class="op" id="6495406">&gt;&gt;</span><span class="num" id="6495408">8</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6495412">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6495415">}</span><br>
<span class="lineno"></span><span class="op" id="6495417">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6495420">//&nbsp;Test&nbsp;vectors&nbsp;are&nbsp;from&nbsp;FIPS&nbsp;197:</span><br>
<span class="lineno">125</span><span class="comment" id="6495455">//&nbsp;&nbsp;&nbsp;&nbsphttp://www.csrc.nist.gov/publications/fips/fips197/fips-197.pdf</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6495523">//&nbsp;Appendix&nbsp;A&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Key&nbsp;expansion&nbsp;examples</span><br>
<span class="lineno"></span><span class="keyword" id="6495573">type</span>&nbsp;<span class="ident" id="6495578">KeyTest</span>&nbsp;<span class="keyword" id="6495586">struct</span>&nbsp;<span class="op" id="6495593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6495596">key</span>&nbsp;<span class="op" id="6495600">[</span><span class="op" id="6495601">]</span><span class="builtintype" id="6495602">byte</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6495608">enc</span>&nbsp;<span class="op" id="6495612">[</span><span class="op" id="6495613">]</span><span class="builtintype" id="6495614">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6495622">dec</span>&nbsp;<span class="op" id="6495626">[</span><span class="op" id="6495627">]</span><span class="builtintype" id="6495628">uint32</span>&nbsp;<span class="comment" id="6495635">//&nbsp;decryption&nbsp;expansion;&nbsp;not&nbsp;in&nbsp;FIPS&nbsp;197,&nbsp;computed&nbsp;from&nbsp;C&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="op" id="6495709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6495712">var</span>&nbsp;<span class="ident" id="6495716">keyTests</span>&nbsp;<span class="op" id="6495725">=</span>&nbsp;<span class="op" id="6495727">[</span><span class="op" id="6495728">]</span><span class="ident" id="6495729">KeyTest</span><span class="op" id="6495736">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6495739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6495743">//&nbsp;A.1.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;128-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6495788">[</span><span class="op" id="6495789">]</span><span class="builtintype" id="6495790">byte</span><span class="op" id="6495794">{</span><span class="num" id="6495795">0x2b</span><span class="op" id="6495799">,</span>&nbsp;<span class="num" id="6495801">0x7e</span><span class="op" id="6495805">,</span>&nbsp;<span class="num" id="6495807">0x15</span><span class="op" id="6495811">,</span>&nbsp;<span class="num" id="6495813">0x16</span><span class="op" id="6495817">,</span>&nbsp;<span class="num" id="6495819">0x28</span><span class="op" id="6495823">,</span>&nbsp;<span class="num" id="6495825">0xae</span><span class="op" id="6495829">,</span>&nbsp;<span class="num" id="6495831">0xd2</span><span class="op" id="6495835">,</span>&nbsp;<span class="num" id="6495837">0xa6</span><span class="op" id="6495841">,</span>&nbsp;<span class="num" id="6495843">0xab</span><span class="op" id="6495847">,</span>&nbsp;<span class="num" id="6495849">0xf7</span><span class="op" id="6495853">,</span>&nbsp;<span class="num" id="6495855">0x15</span><span class="op" id="6495859">,</span>&nbsp;<span class="num" id="6495861">0x88</span><span class="op" id="6495865">,</span>&nbsp;<span class="num" id="6495867">0x09</span><span class="op" id="6495871">,</span>&nbsp;<span class="num" id="6495873">0xcf</span><span class="op" id="6495877">,</span>&nbsp;<span class="num" id="6495879">0x4f</span><span class="op" id="6495883">,</span>&nbsp;<span class="num" id="6495885">0x3c</span><span class="op" id="6495889">}</span><span class="op" id="6495890">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6495894">[</span><span class="op" id="6495895">]</span><span class="builtintype" id="6495896">uint32</span><span class="op" id="6495902">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6495907">0x2b7e1516</span><span class="op" id="6495917">,</span>&nbsp;<span class="num" id="6495919">0x28aed2a6</span><span class="op" id="6495929">,</span>&nbsp;<span class="num" id="6495931">0xabf71588</span><span class="op" id="6495941">,</span>&nbsp;<span class="num" id="6495943">0x09cf4f3c</span><span class="op" id="6495953">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6495958">0xa0fafe17</span><span class="op" id="6495968">,</span>&nbsp;<span class="num" id="6495970">0x88542cb1</span><span class="op" id="6495980">,</span>&nbsp;<span class="num" id="6495982">0x23a33939</span><span class="op" id="6495992">,</span>&nbsp;<span class="num" id="6495994">0x2a6c7605</span><span class="op" id="6496004">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496009">0xf2c295f2</span><span class="op" id="6496019">,</span>&nbsp;<span class="num" id="6496021">0x7a96b943</span><span class="op" id="6496031">,</span>&nbsp;<span class="num" id="6496033">0x5935807a</span><span class="op" id="6496043">,</span>&nbsp;<span class="num" id="6496045">0x7359f67f</span><span class="op" id="6496055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496060">0x3d80477d</span><span class="op" id="6496070">,</span>&nbsp;<span class="num" id="6496072">0x4716fe3e</span><span class="op" id="6496082">,</span>&nbsp;<span class="num" id="6496084">0x1e237e44</span><span class="op" id="6496094">,</span>&nbsp;<span class="num" id="6496096">0x6d7a883b</span><span class="op" id="6496106">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496111">0xef44a541</span><span class="op" id="6496121">,</span>&nbsp;<span class="num" id="6496123">0xa8525b7f</span><span class="op" id="6496133">,</span>&nbsp;<span class="num" id="6496135">0xb671253b</span><span class="op" id="6496145">,</span>&nbsp;<span class="num" id="6496147">0xdb0bad00</span><span class="op" id="6496157">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496162">0xd4d1c6f8</span><span class="op" id="6496172">,</span>&nbsp;<span class="num" id="6496174">0x7c839d87</span><span class="op" id="6496184">,</span>&nbsp;<span class="num" id="6496186">0xcaf2b8bc</span><span class="op" id="6496196">,</span>&nbsp;<span class="num" id="6496198">0x11f915bc</span><span class="op" id="6496208">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496213">0x6d88a37a</span><span class="op" id="6496223">,</span>&nbsp;<span class="num" id="6496225">0x110b3efd</span><span class="op" id="6496235">,</span>&nbsp;<span class="num" id="6496237">0xdbf98641</span><span class="op" id="6496247">,</span>&nbsp;<span class="num" id="6496249">0xca0093fd</span><span class="op" id="6496259">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496264">0x4e54f70e</span><span class="op" id="6496274">,</span>&nbsp;<span class="num" id="6496276">0x5f5fc9f3</span><span class="op" id="6496286">,</span>&nbsp;<span class="num" id="6496288">0x84a64fb2</span><span class="op" id="6496298">,</span>&nbsp;<span class="num" id="6496300">0x4ea6dc4f</span><span class="op" id="6496310">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496315">0xead27321</span><span class="op" id="6496325">,</span>&nbsp;<span class="num" id="6496327">0xb58dbad2</span><span class="op" id="6496337">,</span>&nbsp;<span class="num" id="6496339">0x312bf560</span><span class="op" id="6496349">,</span>&nbsp;<span class="num" id="6496351">0x7f8d292f</span><span class="op" id="6496361">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496366">0xac7766f3</span><span class="op" id="6496376">,</span>&nbsp;<span class="num" id="6496378">0x19fadc21</span><span class="op" id="6496388">,</span>&nbsp;<span class="num" id="6496390">0x28d12941</span><span class="op" id="6496400">,</span>&nbsp;<span class="num" id="6496402">0x575c006e</span><span class="op" id="6496412">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496417">0xd014f9a8</span><span class="op" id="6496427">,</span>&nbsp;<span class="num" id="6496429">0xc9ee2589</span><span class="op" id="6496439">,</span>&nbsp;<span class="num" id="6496441">0xe13f0cc8</span><span class="op" id="6496451">,</span>&nbsp;<span class="num" id="6496453">0xb6630ca6</span><span class="op" id="6496463">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6496467">}</span><span class="op" id="6496468">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6496472">[</span><span class="op" id="6496473">]</span><span class="builtintype" id="6496474">uint32</span><span class="op" id="6496480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496485">0xd014f9a8</span><span class="op" id="6496495">,</span>&nbsp;<span class="num" id="6496497">0xc9ee2589</span><span class="op" id="6496507">,</span>&nbsp;<span class="num" id="6496509">0xe13f0cc8</span><span class="op" id="6496519">,</span>&nbsp;<span class="num" id="6496521">0xb6630ca6</span><span class="op" id="6496531">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496536">0xc7b5a63</span><span class="op" id="6496545">,</span>&nbsp;<span class="num" id="6496547">0x1319eafe</span><span class="op" id="6496557">,</span>&nbsp;<span class="num" id="6496559">0xb0398890</span><span class="op" id="6496569">,</span>&nbsp;<span class="num" id="6496571">0x664cfbb4</span><span class="op" id="6496581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496586">0xdf7d925a</span><span class="op" id="6496596">,</span>&nbsp;<span class="num" id="6496598">0x1f62b09d</span><span class="op" id="6496608">,</span>&nbsp;<span class="num" id="6496610">0xa320626e</span><span class="op" id="6496620">,</span>&nbsp;<span class="num" id="6496622">0xd6757324</span><span class="op" id="6496632">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496637">0x12c07647</span><span class="op" id="6496647">,</span>&nbsp;<span class="num" id="6496649">0xc01f22c7</span><span class="op" id="6496659">,</span>&nbsp;<span class="num" id="6496661">0xbc42d2f3</span><span class="op" id="6496671">,</span>&nbsp;<span class="num" id="6496673">0x7555114a</span><span class="op" id="6496683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496688">0x6efcd876</span><span class="op" id="6496698">,</span>&nbsp;<span class="num" id="6496700">0xd2df5480</span><span class="op" id="6496710">,</span>&nbsp;<span class="num" id="6496712">0x7c5df034</span><span class="op" id="6496722">,</span>&nbsp;<span class="num" id="6496724">0xc917c3b9</span><span class="op" id="6496734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496739">0x6ea30afc</span><span class="op" id="6496749">,</span>&nbsp;<span class="num" id="6496751">0xbc238cf6</span><span class="op" id="6496761">,</span>&nbsp;<span class="num" id="6496763">0xae82a4b4</span><span class="op" id="6496773">,</span>&nbsp;<span class="num" id="6496775">0xb54a338d</span><span class="op" id="6496785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496790">0x90884413</span><span class="op" id="6496800">,</span>&nbsp;<span class="num" id="6496802">0xd280860a</span><span class="op" id="6496812">,</span>&nbsp;<span class="num" id="6496814">0x12a12842</span><span class="op" id="6496824">,</span>&nbsp;<span class="num" id="6496826">0x1bc89739</span><span class="op" id="6496836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496841">0x7c1f13f7</span><span class="op" id="6496851">,</span>&nbsp;<span class="num" id="6496853">0x4208c219</span><span class="op" id="6496863">,</span>&nbsp;<span class="num" id="6496865">0xc021ae48</span><span class="op" id="6496875">,</span>&nbsp;<span class="num" id="6496877">0x969bf7b</span><span class="op" id="6496886">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496891">0xcc7505eb</span><span class="op" id="6496901">,</span>&nbsp;<span class="num" id="6496903">0x3e17d1ee</span><span class="op" id="6496913">,</span>&nbsp;<span class="num" id="6496915">0x82296c51</span><span class="op" id="6496925">,</span>&nbsp;<span class="num" id="6496927">0xc9481133</span><span class="op" id="6496937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496942">0x2b3708a7</span><span class="op" id="6496952">,</span>&nbsp;<span class="num" id="6496954">0xf262d405</span><span class="op" id="6496964">,</span>&nbsp;<span class="num" id="6496966">0xbc3ebdbf</span><span class="op" id="6496976">,</span>&nbsp;<span class="num" id="6496978">0x4b617d62</span><span class="op" id="6496988">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6496993">0x2b7e1516</span><span class="op" id="6497003">,</span>&nbsp;<span class="num" id="6497005">0x28aed2a6</span><span class="op" id="6497015">,</span>&nbsp;<span class="num" id="6497017">0xabf71588</span><span class="op" id="6497027">,</span>&nbsp;<span class="num" id="6497029">0x9cf4f3c</span><span class="op" id="6497038">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6497042">}</span><span class="op" id="6497043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6497046">}</span><span class="op" id="6497047">,</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6497050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6497054">//&nbsp;A.2.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;192-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6497099">[</span><span class="op" id="6497100">]</span><span class="builtintype" id="6497101">byte</span><span class="op" id="6497105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6497110">0x8e</span><span class="op" id="6497114">,</span>&nbsp;<span class="num" id="6497116">0x73</span><span class="op" id="6497120">,</span>&nbsp;<span class="num" id="6497122">0xb0</span><span class="op" id="6497126">,</span>&nbsp;<span class="num" id="6497128">0xf7</span><span class="op" id="6497132">,</span>&nbsp;<span class="num" id="6497134">0xda</span><span class="op" id="6497138">,</span>&nbsp;<span class="num" id="6497140">0x0e</span><span class="op" id="6497144">,</span>&nbsp;<span class="num" id="6497146">0x64</span><span class="op" id="6497150">,</span>&nbsp;<span class="num" id="6497152">0x52</span><span class="op" id="6497156">,</span>&nbsp;<span class="num" id="6497158">0xc8</span><span class="op" id="6497162">,</span>&nbsp;<span class="num" id="6497164">0x10</span><span class="op" id="6497168">,</span>&nbsp;<span class="num" id="6497170">0xf3</span><span class="op" id="6497174">,</span>&nbsp;<span class="num" id="6497176">0x2b</span><span class="op" id="6497180">,</span>&nbsp;<span class="num" id="6497182">0x80</span><span class="op" id="6497186">,</span>&nbsp;<span class="num" id="6497188">0x90</span><span class="op" id="6497192">,</span>&nbsp;<span class="num" id="6497194">0x79</span><span class="op" id="6497198">,</span>&nbsp;<span class="num" id="6497200">0xe5</span><span class="op" id="6497204">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6497209">0x62</span><span class="op" id="6497213">,</span>&nbsp;<span class="num" id="6497215">0xf8</span><span class="op" id="6497219">,</span>&nbsp;<span class="num" id="6497221">0xea</span><span class="op" id="6497225">,</span>&nbsp;<span class="num" id="6497227">0xd2</span><span class="op" id="6497231">,</span>&nbsp;<span class="num" id="6497233">0x52</span><span class="op" id="6497237">,</span>&nbsp;<span class="num" id="6497239">0x2c</span><span class="op" id="6497243">,</span>&nbsp;<span class="num" id="6497245">0x6b</span><span class="op" id="6497249">,</span>&nbsp;<span class="num" id="6497251">0x7b</span><span class="op" id="6497255">,</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6497259">}</span><span class="op" id="6497260">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6497264">[</span><span class="op" id="6497265">]</span><span class="builtintype" id="6497266">uint32</span><span class="op" id="6497272">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6497277">0x8e73b0f7</span><span class="op" id="6497287">,</span>&nbsp;<span class="num" id="6497289">0xda0e6452</span><span class="op" id="6497299">,</span>&nbsp;<span class="num" id="6497301">0xc810f32b</span><span class="op" id="6497311">,</span>&nbsp;<span class="num" id="6497313">0x809079e5</span><span class="op" id="6497323">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6497328">0x62f8ead2</span><span class="op" id="6497338">,</span>&nbsp;<span class="num" id="6497340">0x522c6b7b</span><span class="op" id="6497350">,</span>&nbsp;<span class="num" id="6497352">0xfe0c91f7</span><span class="op" id="6497362">,</span>&nbsp;<span class="num" id="6497364">0x2402f5a5</span><span class="op" id="6497374">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6497379">0xec12068e</span><span class="op" id="6497389">,</span>&nbsp;<span class="num" id="6497391">0x6c827f6b</span><span class="op" id="6497401">,</span>&nbsp;<span class="num" id="6497403">0x0e7a95b9</span><span class="op" id="6497413">,</span>&nbsp;<span class="num" id="6497415">0x5c56fec2</span><span class="op" id="6497425">,</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6497430">0x4db7b4bd</span><span class="op" id="6497440">,</span>&nbsp;<span class="num" id="6497442">0x69b54118</span><span class="op" id="6497452">,</span>&nbsp;<span class="num" id="6497454">0x85a74796</span><span class="op" id="6497464">,</span>&nbsp;<span class="num" id="6497466">0xe92538fd</span><span class="op" id="6497476">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6497481">0xe75fad44</span><span class="op" id="6497491">,</span>&nbsp;<span class="num" id="6497493">0xbb095386</span><span class="op" id="6497503">,</span>&nbsp;<span class="num" id="6497505">0x485af057</span><span class="op" id="6497515">,</span>&nbsp;<span class="num" id="6497517">0x21efb14f</span><span class="op" id="6497527">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6497532">0xa448f6d9</span><span class="op" id="6497542">,</span>&nbsp;<span class="num" id="6497544">0x4d6dce24</span><span class="op" id="6497554">,</span>&nbsp;<span class="num" id="6497556">0xaa326360</span><span class="op" id="6497566">,</span>&nbsp;<span class="num" id="6497568">0x113b30e6</span><span class="op" id="6497578">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6497583">0xa25e7ed5</span><span class="op" id="6497593">,</span>&nbsp;<span class="num" id="6497595">0x83b1cf9a</span><span class="op" id="6497605">,</span>&nbsp;<span class="num" id="6497607">0x27f93943</span><span class="op" id="6497617">,</span>&nbsp;<span class="num" id="6497619">0x6a94f767</span><span class="op" id="6497629">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6497634">0xc0a69407</span><span class="op" id="6497644">,</span>&nbsp;<span class="num" id="6497646">0xd19da4e1</span><span class="op" id="6497656">,</span>&nbsp;<span class="num" id="6497658">0xec1786eb</span><span class="op" id="6497668">,</span>&nbsp;<span class="num" id="6497670">0x6fa64971</span><span class="op" id="6497680">,</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6497685">0x485f7032</span><span class="op" id="6497695">,</span>&nbsp;<span class="num" id="6497697">0x22cb8755</span><span class="op" id="6497707">,</span>&nbsp;<span class="num" id="6497709">0xe26d1352</span><span class="op" id="6497719">,</span>&nbsp;<span class="num" id="6497721">0x33f0b7b3</span><span class="op" id="6497731">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6497736">0x40beeb28</span><span class="op" id="6497746">,</span>&nbsp;<span class="num" id="6497748">0x2f18a259</span><span class="op" id="6497758">,</span>&nbsp;<span class="num" id="6497760">0x6747d26b</span><span class="op" id="6497770">,</span>&nbsp;<span class="num" id="6497772">0x458c553e</span><span class="op" id="6497782">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6497787">0xa7e1466c</span><span class="op" id="6497797">,</span>&nbsp;<span class="num" id="6497799">0x9411f1df</span><span class="op" id="6497809">,</span>&nbsp;<span class="num" id="6497811">0x821f750a</span><span class="op" id="6497821">,</span>&nbsp;<span class="num" id="6497823">0xad07d753</span><span class="op" id="6497833">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6497838">0xca400538</span><span class="op" id="6497848">,</span>&nbsp;<span class="num" id="6497850">0x8fcc5006</span><span class="op" id="6497860">,</span>&nbsp;<span class="num" id="6497862">0x282d166a</span><span class="op" id="6497872">,</span>&nbsp;<span class="num" id="6497874">0xbc3ce7b5</span><span class="op" id="6497884">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6497889">0xe98ba06f</span><span class="op" id="6497899">,</span>&nbsp;<span class="num" id="6497901">0x448c773c</span><span class="op" id="6497911">,</span>&nbsp;<span class="num" id="6497913">0x8ecc7204</span><span class="op" id="6497923">,</span>&nbsp;<span class="num" id="6497925">0x01002202</span><span class="op" id="6497935">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6497939">}</span><span class="op" id="6497940">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6497944">nil</span><span class="op" id="6497947">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6497950">}</span><span class="op" id="6497951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6497954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6497958">//&nbsp;A.3.&nbsp;&nbsp;Expansion&nbsp;of&nbsp;a&nbsp;256-bit&nbsp;Cipher&nbsp;Key</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6498003">[</span><span class="op" id="6498004">]</span><span class="builtintype" id="6498005">byte</span><span class="op" id="6498009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6498014">0x60</span><span class="op" id="6498018">,</span>&nbsp;<span class="num" id="6498020">0x3d</span><span class="op" id="6498024">,</span>&nbsp;<span class="num" id="6498026">0xeb</span><span class="op" id="6498030">,</span>&nbsp;<span class="num" id="6498032">0x10</span><span class="op" id="6498036">,</span>&nbsp;<span class="num" id="6498038">0x15</span><span class="op" id="6498042">,</span>&nbsp;<span class="num" id="6498044">0xca</span><span class="op" id="6498048">,</span>&nbsp;<span class="num" id="6498050">0x71</span><span class="op" id="6498054">,</span>&nbsp;<span class="num" id="6498056">0xbe</span><span class="op" id="6498060">,</span>&nbsp;<span class="num" id="6498062">0x2b</span><span class="op" id="6498066">,</span>&nbsp;<span class="num" id="6498068">0x73</span><span class="op" id="6498072">,</span>&nbsp;<span class="num" id="6498074">0xae</span><span class="op" id="6498078">,</span>&nbsp;<span class="num" id="6498080">0xf0</span><span class="op" id="6498084">,</span>&nbsp;<span class="num" id="6498086">0x85</span><span class="op" id="6498090">,</span>&nbsp;<span class="num" id="6498092">0x7d</span><span class="op" id="6498096">,</span>&nbsp;<span class="num" id="6498098">0x77</span><span class="op" id="6498102">,</span>&nbsp;<span class="num" id="6498104">0x81</span><span class="op" id="6498108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6498113">0x1f</span><span class="op" id="6498117">,</span>&nbsp;<span class="num" id="6498119">0x35</span><span class="op" id="6498123">,</span>&nbsp;<span class="num" id="6498125">0x2c</span><span class="op" id="6498129">,</span>&nbsp;<span class="num" id="6498131">0x07</span><span class="op" id="6498135">,</span>&nbsp;<span class="num" id="6498137">0x3b</span><span class="op" id="6498141">,</span>&nbsp;<span class="num" id="6498143">0x61</span><span class="op" id="6498147">,</span>&nbsp;<span class="num" id="6498149">0x08</span><span class="op" id="6498153">,</span>&nbsp;<span class="num" id="6498155">0xd7</span><span class="op" id="6498159">,</span>&nbsp;<span class="num" id="6498161">0x2d</span><span class="op" id="6498165">,</span>&nbsp;<span class="num" id="6498167">0x98</span><span class="op" id="6498171">,</span>&nbsp;<span class="num" id="6498173">0x10</span><span class="op" id="6498177">,</span>&nbsp;<span class="num" id="6498179">0xa3</span><span class="op" id="6498183">,</span>&nbsp;<span class="num" id="6498185">0x09</span><span class="op" id="6498189">,</span>&nbsp;<span class="num" id="6498191">0x14</span><span class="op" id="6498195">,</span>&nbsp;<span class="num" id="6498197">0xdf</span><span class="op" id="6498201">,</span>&nbsp;<span class="num" id="6498203">0xf4</span><span class="op" id="6498207">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6498211">}</span><span class="op" id="6498212">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6498216">[</span><span class="op" id="6498217">]</span><span class="builtintype" id="6498218">uint32</span><span class="op" id="6498224">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6498229">0x603deb10</span><span class="op" id="6498239">,</span>&nbsp;<span class="num" id="6498241">0x15ca71be</span><span class="op" id="6498251">,</span>&nbsp;<span class="num" id="6498253">0x2b73aef0</span><span class="op" id="6498263">,</span>&nbsp;<span class="num" id="6498265">0x857d7781</span><span class="op" id="6498275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6498280">0x1f352c07</span><span class="op" id="6498290">,</span>&nbsp;<span class="num" id="6498292">0x3b6108d7</span><span class="op" id="6498302">,</span>&nbsp;<span class="num" id="6498304">0x2d9810a3</span><span class="op" id="6498314">,</span>&nbsp;<span class="num" id="6498316">0x0914dff4</span><span class="op" id="6498326">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6498331">0x9ba35411</span><span class="op" id="6498341">,</span>&nbsp;<span class="num" id="6498343">0x8e6925af</span><span class="op" id="6498353">,</span>&nbsp;<span class="num" id="6498355">0xa51a8b5f</span><span class="op" id="6498365">,</span>&nbsp;<span class="num" id="6498367">0x2067fcde</span><span class="op" id="6498377">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6498382">0xa8b09c1a</span><span class="op" id="6498392">,</span>&nbsp;<span class="num" id="6498394">0x93d194cd</span><span class="op" id="6498404">,</span>&nbsp;<span class="num" id="6498406">0xbe49846e</span><span class="op" id="6498416">,</span>&nbsp;<span class="num" id="6498418">0xb75d5b9a</span><span class="op" id="6498428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6498433">0xd59aecb8</span><span class="op" id="6498443">,</span>&nbsp;<span class="num" id="6498445">0x5bf3c917</span><span class="op" id="6498455">,</span>&nbsp;<span class="num" id="6498457">0xfee94248</span><span class="op" id="6498467">,</span>&nbsp;<span class="num" id="6498469">0xde8ebe96</span><span class="op" id="6498479">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6498484">0xb5a9328a</span><span class="op" id="6498494">,</span>&nbsp;<span class="num" id="6498496">0x2678a647</span><span class="op" id="6498506">,</span>&nbsp;<span class="num" id="6498508">0x98312229</span><span class="op" id="6498518">,</span>&nbsp;<span class="num" id="6498520">0x2f6c79b3</span><span class="op" id="6498530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6498535">0x812c81ad</span><span class="op" id="6498545">,</span>&nbsp;<span class="num" id="6498547">0xdadf48ba</span><span class="op" id="6498557">,</span>&nbsp;<span class="num" id="6498559">0x24360af2</span><span class="op" id="6498569">,</span>&nbsp;<span class="num" id="6498571">0xfab8b464</span><span class="op" id="6498581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6498586">0x98c5bfc9</span><span class="op" id="6498596">,</span>&nbsp;<span class="num" id="6498598">0xbebd198e</span><span class="op" id="6498608">,</span>&nbsp;<span class="num" id="6498610">0x268c3ba7</span><span class="op" id="6498620">,</span>&nbsp;<span class="num" id="6498622">0x09e04214</span><span class="op" id="6498632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6498637">0x68007bac</span><span class="op" id="6498647">,</span>&nbsp;<span class="num" id="6498649">0xb2df3316</span><span class="op" id="6498659">,</span>&nbsp;<span class="num" id="6498661">0x96e939e4</span><span class="op" id="6498671">,</span>&nbsp;<span class="num" id="6498673">0x6c518d80</span><span class="op" id="6498683">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6498688">0xc814e204</span><span class="op" id="6498698">,</span>&nbsp;<span class="num" id="6498700">0x76a9fb8a</span><span class="op" id="6498710">,</span>&nbsp;<span class="num" id="6498712">0x5025c02d</span><span class="op" id="6498722">,</span>&nbsp;<span class="num" id="6498724">0x59c58239</span><span class="op" id="6498734">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6498739">0xde136967</span><span class="op" id="6498749">,</span>&nbsp;<span class="num" id="6498751">0x6ccc5a71</span><span class="op" id="6498761">,</span>&nbsp;<span class="num" id="6498763">0xfa256395</span><span class="op" id="6498773">,</span>&nbsp;<span class="num" id="6498775">0x9674ee15</span><span class="op" id="6498785">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6498790">0x5886ca5d</span><span class="op" id="6498800">,</span>&nbsp;<span class="num" id="6498802">0x2e2f31d7</span><span class="op" id="6498812">,</span>&nbsp;<span class="num" id="6498814">0x7e0af1fa</span><span class="op" id="6498824">,</span>&nbsp;<span class="num" id="6498826">0x27cf73c3</span><span class="op" id="6498836">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6498841">0x749c47ab</span><span class="op" id="6498851">,</span>&nbsp;<span class="num" id="6498853">0x18501dda</span><span class="op" id="6498863">,</span>&nbsp;<span class="num" id="6498865">0xe2757e4f</span><span class="op" id="6498875">,</span>&nbsp;<span class="num" id="6498877">0x7401905a</span><span class="op" id="6498887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6498892">0xcafaaae3</span><span class="op" id="6498902">,</span>&nbsp;<span class="num" id="6498904">0xe4d59b34</span><span class="op" id="6498914">,</span>&nbsp;<span class="num" id="6498916">0x9adf6ace</span><span class="op" id="6498926">,</span>&nbsp;<span class="num" id="6498928">0xbd10190d</span><span class="op" id="6498938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6498943">0xfe4890d1</span><span class="op" id="6498953">,</span>&nbsp;<span class="num" id="6498955">0xe6188d0b</span><span class="op" id="6498965">,</span>&nbsp;<span class="num" id="6498967">0x046df344</span><span class="op" id="6498977">,</span>&nbsp;<span class="num" id="6498979">0x706c631e</span><span class="op" id="6498989">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6498993">}</span><span class="op" id="6498994">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6498998">nil</span><span class="op" id="6499001">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6499004">}</span><span class="op" id="6499005">,</span><br>
<span class="lineno"></span><span class="op" id="6499007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span><span class="comment" id="6499010">//&nbsp;Test&nbsp;key&nbsp;expansion&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="6499059">func</span>&nbsp;<span class="ident" id="6499064">TestExpandKey</span><span class="op" id="6499077">(</span><span class="ident" id="6499078">t</span>&nbsp;<span class="op" id="6499080">*</span><span class="ident" id="6499081">testing</span><span class="op" id="6499088">.</span><span class="ident" id="6499089">T</span><span class="op" id="6499090">)</span>&nbsp;<span class="op" id="6499092">{</span><br>
<span class="lineno"></span><span class="ident" id="6499094">L</span><span class="op" id="6499095">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499098">for</span>&nbsp;<span class="ident" id="6499102">i</span><span class="op" id="6499103">,</span>&nbsp;<span class="ident" id="6499105">tt</span>&nbsp;<span class="op" id="6499108">:=</span>&nbsp;<span class="keyword" id="6499111">range</span>&nbsp;<span class="ident" id="6499117">keyTests</span>&nbsp;<span class="op" id="6499126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499130">enc</span>&nbsp;<span class="op" id="6499134">:=</span>&nbsp;<span class="builtinfunc" id="6499137">make</span><span class="op" id="6499141">(</span><span class="op" id="6499142">[</span><span class="op" id="6499143">]</span><span class="builtintype" id="6499144">uint32</span><span class="op" id="6499150">,</span>&nbsp;<span class="builtinfunc" id="6499152">len</span><span class="op" id="6499155">(</span><span class="ident" id="6499156">tt</span><span class="op" id="6499158">.</span><span class="ident" id="6499159">enc</span><span class="op" id="6499162">)</span><span class="op" id="6499163">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499167">var</span>&nbsp;<span class="ident" id="6499171">dec</span>&nbsp;<span class="op" id="6499175">[</span><span class="op" id="6499176">]</span><span class="builtintype" id="6499177">uint32</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499186">if</span>&nbsp;<span class="ident" id="6499189">tt</span><span class="op" id="6499191">.</span><span class="ident" id="6499192">dec</span>&nbsp;<span class="op" id="6499196">!=</span>&nbsp;<span class="ident" id="6499199">nil</span>&nbsp;<span class="op" id="6499203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499208">dec</span>&nbsp;<span class="op" id="6499212">=</span>&nbsp;<span class="builtinfunc" id="6499214">make</span><span class="op" id="6499218">(</span><span class="op" id="6499219">[</span><span class="op" id="6499220">]</span><span class="builtintype" id="6499221">uint32</span><span class="op" id="6499227">,</span>&nbsp;<span class="builtinfunc" id="6499229">len</span><span class="op" id="6499232">(</span><span class="ident" id="6499233">tt</span><span class="op" id="6499235">.</span><span class="ident" id="6499236">dec</span><span class="op" id="6499239">)</span><span class="op" id="6499240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6499244">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6499248">//&nbsp;This&nbsp;test&nbsp;could&nbsp;only&nbsp;test&nbsp;Go&nbsp;version&nbsp;of&nbsp;expandKey&nbsp;because&nbsp;asm</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6499315">//&nbsp;version&nbsp;might&nbsp;use&nbsp;different&nbsp;memory&nbsp;layout&nbsp;for&nbsp;expanded&nbsp;keys</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6499380">//&nbsp;This&nbsp;is&nbsp;OK&nbsp;because&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;expanded&nbsp;keys&nbsp;to&nbsp;the&nbsp;outside</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499449">expandKeyGo</span><span class="op" id="6499460">(</span><span class="ident" id="6499461">tt</span><span class="op" id="6499463">.</span><span class="ident" id="6499464">key</span><span class="op" id="6499467">,</span>&nbsp;<span class="ident" id="6499469">enc</span><span class="op" id="6499472">,</span>&nbsp;<span class="ident" id="6499474">dec</span><span class="op" id="6499477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499481">for</span>&nbsp;<span class="ident" id="6499485">j</span><span class="op" id="6499486">,</span>&nbsp;<span class="ident" id="6499488">v</span>&nbsp;<span class="op" id="6499490">:=</span>&nbsp;<span class="keyword" id="6499493">range</span>&nbsp;<span class="ident" id="6499499">enc</span>&nbsp;<span class="op" id="6499503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499508">if</span>&nbsp;<span class="ident" id="6499511">v</span>&nbsp;<span class="op" id="6499513">!=</span>&nbsp;<span class="ident" id="6499516">tt</span><span class="op" id="6499518">.</span><span class="ident" id="6499519">enc</span><span class="op" id="6499522">[</span><span class="ident" id="6499523">j</span><span class="op" id="6499524">]</span>&nbsp;<span class="op" id="6499526">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499532">t</span><span class="op" id="6499533">.</span><span class="ident" id="6499534">Errorf</span><span class="op" id="6499540">(</span><span class="string" id="6499541">&#34;key&nbsp;%d:&nbsp;enc[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6499574">,</span>&nbsp;<span class="ident" id="6499576">i</span><span class="op" id="6499577">,</span>&nbsp;<span class="ident" id="6499579">j</span><span class="op" id="6499580">,</span>&nbsp;<span class="ident" id="6499582">v</span><span class="op" id="6499583">,</span>&nbsp;<span class="ident" id="6499585">tt</span><span class="op" id="6499587">.</span><span class="ident" id="6499588">enc</span><span class="op" id="6499591">[</span><span class="ident" id="6499592">j</span><span class="op" id="6499593">]</span><span class="op" id="6499594">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499600">continue</span>&nbsp;<span class="ident" id="6499609">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6499614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6499618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499622">if</span>&nbsp;<span class="ident" id="6499625">dec</span>&nbsp;<span class="op" id="6499629">!=</span>&nbsp;<span class="ident" id="6499632">nil</span>&nbsp;<span class="op" id="6499636">{</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499641">for</span>&nbsp;<span class="ident" id="6499645">j</span><span class="op" id="6499646">,</span>&nbsp;<span class="ident" id="6499648">v</span>&nbsp;<span class="op" id="6499650">:=</span>&nbsp;<span class="keyword" id="6499653">range</span>&nbsp;<span class="ident" id="6499659">dec</span>&nbsp;<span class="op" id="6499663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499669">if</span>&nbsp;<span class="ident" id="6499672">v</span>&nbsp;<span class="op" id="6499674">!=</span>&nbsp;<span class="ident" id="6499677">tt</span><span class="op" id="6499679">.</span><span class="ident" id="6499680">dec</span><span class="op" id="6499683">[</span><span class="ident" id="6499684">j</span><span class="op" id="6499685">]</span>&nbsp;<span class="op" id="6499687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499694">t</span><span class="op" id="6499695">.</span><span class="ident" id="6499696">Errorf</span><span class="op" id="6499702">(</span><span class="string" id="6499703">&#34;key&nbsp;%d:&nbsp;dec[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6499736">,</span>&nbsp;<span class="ident" id="6499738">i</span><span class="op" id="6499739">,</span>&nbsp;<span class="ident" id="6499741">j</span><span class="op" id="6499742">,</span>&nbsp;<span class="ident" id="6499744">v</span><span class="op" id="6499745">,</span>&nbsp;<span class="ident" id="6499747">tt</span><span class="op" id="6499749">.</span><span class="ident" id="6499750">dec</span><span class="op" id="6499753">[</span><span class="ident" id="6499754">j</span><span class="op" id="6499755">]</span><span class="op" id="6499756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6499763">continue</span>&nbsp;<span class="ident" id="6499772">L</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6499778">}</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6499783">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6499787">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6499790">}</span><br>
<span class="lineno"></span><span class="op" id="6499792">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="6499795">//&nbsp;Appendix&nbsp;B,&nbsp;C&nbsp;of&nbsp;FIPS&nbsp;197:&nbsp;Cipher&nbsp;examples,&nbsp;Example&nbsp;vectors.</span><br>
<span class="lineno"></span><span class="keyword" id="6499859">type</span>&nbsp;<span class="ident" id="6499864">CryptTest</span>&nbsp;<span class="keyword" id="6499874">struct</span>&nbsp;<span class="op" id="6499881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499884">key</span>&nbsp;<span class="op" id="6499888">[</span><span class="op" id="6499889">]</span><span class="builtintype" id="6499890">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499896">in</span>&nbsp;&nbsp;<span class="op" id="6499900">[</span><span class="op" id="6499901">]</span><span class="builtintype" id="6499902">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6499908">out</span>&nbsp;<span class="op" id="6499912">[</span><span class="op" id="6499913">]</span><span class="builtintype" id="6499914">byte</span><br>
<span class="lineno">250</span><span class="op" id="6499919">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6499922">var</span>&nbsp;<span class="ident" id="6499926">encryptTests</span>&nbsp;<span class="op" id="6499939">=</span>&nbsp;<span class="op" id="6499941">[</span><span class="op" id="6499942">]</span><span class="ident" id="6499943">CryptTest</span><span class="op" id="6499952">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6499955">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6499959">//&nbsp;Appendix&nbsp;B.</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6499976">[</span><span class="op" id="6499977">]</span><span class="builtintype" id="6499978">byte</span><span class="op" id="6499982">{</span><span class="num" id="6499983">0x2b</span><span class="op" id="6499987">,</span>&nbsp;<span class="num" id="6499989">0x7e</span><span class="op" id="6499993">,</span>&nbsp;<span class="num" id="6499995">0x15</span><span class="op" id="6499999">,</span>&nbsp;<span class="num" id="6500001">0x16</span><span class="op" id="6500005">,</span>&nbsp;<span class="num" id="6500007">0x28</span><span class="op" id="6500011">,</span>&nbsp;<span class="num" id="6500013">0xae</span><span class="op" id="6500017">,</span>&nbsp;<span class="num" id="6500019">0xd2</span><span class="op" id="6500023">,</span>&nbsp;<span class="num" id="6500025">0xa6</span><span class="op" id="6500029">,</span>&nbsp;<span class="num" id="6500031">0xab</span><span class="op" id="6500035">,</span>&nbsp;<span class="num" id="6500037">0xf7</span><span class="op" id="6500041">,</span>&nbsp;<span class="num" id="6500043">0x15</span><span class="op" id="6500047">,</span>&nbsp;<span class="num" id="6500049">0x88</span><span class="op" id="6500053">,</span>&nbsp;<span class="num" id="6500055">0x09</span><span class="op" id="6500059">,</span>&nbsp;<span class="num" id="6500061">0xcf</span><span class="op" id="6500065">,</span>&nbsp;<span class="num" id="6500067">0x4f</span><span class="op" id="6500071">,</span>&nbsp;<span class="num" id="6500073">0x3c</span><span class="op" id="6500077">}</span><span class="op" id="6500078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500082">[</span><span class="op" id="6500083">]</span><span class="builtintype" id="6500084">byte</span><span class="op" id="6500088">{</span><span class="num" id="6500089">0x32</span><span class="op" id="6500093">,</span>&nbsp;<span class="num" id="6500095">0x43</span><span class="op" id="6500099">,</span>&nbsp;<span class="num" id="6500101">0xf6</span><span class="op" id="6500105">,</span>&nbsp;<span class="num" id="6500107">0xa8</span><span class="op" id="6500111">,</span>&nbsp;<span class="num" id="6500113">0x88</span><span class="op" id="6500117">,</span>&nbsp;<span class="num" id="6500119">0x5a</span><span class="op" id="6500123">,</span>&nbsp;<span class="num" id="6500125">0x30</span><span class="op" id="6500129">,</span>&nbsp;<span class="num" id="6500131">0x8d</span><span class="op" id="6500135">,</span>&nbsp;<span class="num" id="6500137">0x31</span><span class="op" id="6500141">,</span>&nbsp;<span class="num" id="6500143">0x31</span><span class="op" id="6500147">,</span>&nbsp;<span class="num" id="6500149">0x98</span><span class="op" id="6500153">,</span>&nbsp;<span class="num" id="6500155">0xa2</span><span class="op" id="6500159">,</span>&nbsp;<span class="num" id="6500161">0xe0</span><span class="op" id="6500165">,</span>&nbsp;<span class="num" id="6500167">0x37</span><span class="op" id="6500171">,</span>&nbsp;<span class="num" id="6500173">0x07</span><span class="op" id="6500177">,</span>&nbsp;<span class="num" id="6500179">0x34</span><span class="op" id="6500183">}</span><span class="op" id="6500184">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500188">[</span><span class="op" id="6500189">]</span><span class="builtintype" id="6500190">byte</span><span class="op" id="6500194">{</span><span class="num" id="6500195">0x39</span><span class="op" id="6500199">,</span>&nbsp;<span class="num" id="6500201">0x25</span><span class="op" id="6500205">,</span>&nbsp;<span class="num" id="6500207">0x84</span><span class="op" id="6500211">,</span>&nbsp;<span class="num" id="6500213">0x1d</span><span class="op" id="6500217">,</span>&nbsp;<span class="num" id="6500219">0x02</span><span class="op" id="6500223">,</span>&nbsp;<span class="num" id="6500225">0xdc</span><span class="op" id="6500229">,</span>&nbsp;<span class="num" id="6500231">0x09</span><span class="op" id="6500235">,</span>&nbsp;<span class="num" id="6500237">0xfb</span><span class="op" id="6500241">,</span>&nbsp;<span class="num" id="6500243">0xdc</span><span class="op" id="6500247">,</span>&nbsp;<span class="num" id="6500249">0x11</span><span class="op" id="6500253">,</span>&nbsp;<span class="num" id="6500255">0x85</span><span class="op" id="6500259">,</span>&nbsp;<span class="num" id="6500261">0x97</span><span class="op" id="6500265">,</span>&nbsp;<span class="num" id="6500267">0x19</span><span class="op" id="6500271">,</span>&nbsp;<span class="num" id="6500273">0x6a</span><span class="op" id="6500277">,</span>&nbsp;<span class="num" id="6500279">0x0b</span><span class="op" id="6500283">,</span>&nbsp;<span class="num" id="6500285">0x32</span><span class="op" id="6500289">}</span><span class="op" id="6500290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500293">}</span><span class="op" id="6500294">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500297">{</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6500301">//&nbsp;Appendix&nbsp;C.1.&nbsp;&nbsp;AES-128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500329">[</span><span class="op" id="6500330">]</span><span class="builtintype" id="6500331">byte</span><span class="op" id="6500335">{</span><span class="num" id="6500336">0x00</span><span class="op" id="6500340">,</span>&nbsp;<span class="num" id="6500342">0x01</span><span class="op" id="6500346">,</span>&nbsp;<span class="num" id="6500348">0x02</span><span class="op" id="6500352">,</span>&nbsp;<span class="num" id="6500354">0x03</span><span class="op" id="6500358">,</span>&nbsp;<span class="num" id="6500360">0x04</span><span class="op" id="6500364">,</span>&nbsp;<span class="num" id="6500366">0x05</span><span class="op" id="6500370">,</span>&nbsp;<span class="num" id="6500372">0x06</span><span class="op" id="6500376">,</span>&nbsp;<span class="num" id="6500378">0x07</span><span class="op" id="6500382">,</span>&nbsp;<span class="num" id="6500384">0x08</span><span class="op" id="6500388">,</span>&nbsp;<span class="num" id="6500390">0x09</span><span class="op" id="6500394">,</span>&nbsp;<span class="num" id="6500396">0x0a</span><span class="op" id="6500400">,</span>&nbsp;<span class="num" id="6500402">0x0b</span><span class="op" id="6500406">,</span>&nbsp;<span class="num" id="6500408">0x0c</span><span class="op" id="6500412">,</span>&nbsp;<span class="num" id="6500414">0x0d</span><span class="op" id="6500418">,</span>&nbsp;<span class="num" id="6500420">0x0e</span><span class="op" id="6500424">,</span>&nbsp;<span class="num" id="6500426">0x0f</span><span class="op" id="6500430">}</span><span class="op" id="6500431">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500435">[</span><span class="op" id="6500436">]</span><span class="builtintype" id="6500437">byte</span><span class="op" id="6500441">{</span><span class="num" id="6500442">0x00</span><span class="op" id="6500446">,</span>&nbsp;<span class="num" id="6500448">0x11</span><span class="op" id="6500452">,</span>&nbsp;<span class="num" id="6500454">0x22</span><span class="op" id="6500458">,</span>&nbsp;<span class="num" id="6500460">0x33</span><span class="op" id="6500464">,</span>&nbsp;<span class="num" id="6500466">0x44</span><span class="op" id="6500470">,</span>&nbsp;<span class="num" id="6500472">0x55</span><span class="op" id="6500476">,</span>&nbsp;<span class="num" id="6500478">0x66</span><span class="op" id="6500482">,</span>&nbsp;<span class="num" id="6500484">0x77</span><span class="op" id="6500488">,</span>&nbsp;<span class="num" id="6500490">0x88</span><span class="op" id="6500494">,</span>&nbsp;<span class="num" id="6500496">0x99</span><span class="op" id="6500500">,</span>&nbsp;<span class="num" id="6500502">0xaa</span><span class="op" id="6500506">,</span>&nbsp;<span class="num" id="6500508">0xbb</span><span class="op" id="6500512">,</span>&nbsp;<span class="num" id="6500514">0xcc</span><span class="op" id="6500518">,</span>&nbsp;<span class="num" id="6500520">0xdd</span><span class="op" id="6500524">,</span>&nbsp;<span class="num" id="6500526">0xee</span><span class="op" id="6500530">,</span>&nbsp;<span class="num" id="6500532">0xff</span><span class="op" id="6500536">}</span><span class="op" id="6500537">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500541">[</span><span class="op" id="6500542">]</span><span class="builtintype" id="6500543">byte</span><span class="op" id="6500547">{</span><span class="num" id="6500548">0x69</span><span class="op" id="6500552">,</span>&nbsp;<span class="num" id="6500554">0xc4</span><span class="op" id="6500558">,</span>&nbsp;<span class="num" id="6500560">0xe0</span><span class="op" id="6500564">,</span>&nbsp;<span class="num" id="6500566">0xd8</span><span class="op" id="6500570">,</span>&nbsp;<span class="num" id="6500572">0x6a</span><span class="op" id="6500576">,</span>&nbsp;<span class="num" id="6500578">0x7b</span><span class="op" id="6500582">,</span>&nbsp;<span class="num" id="6500584">0x04</span><span class="op" id="6500588">,</span>&nbsp;<span class="num" id="6500590">0x30</span><span class="op" id="6500594">,</span>&nbsp;<span class="num" id="6500596">0xd8</span><span class="op" id="6500600">,</span>&nbsp;<span class="num" id="6500602">0xcd</span><span class="op" id="6500606">,</span>&nbsp;<span class="num" id="6500608">0xb7</span><span class="op" id="6500612">,</span>&nbsp;<span class="num" id="6500614">0x80</span><span class="op" id="6500618">,</span>&nbsp;<span class="num" id="6500620">0x70</span><span class="op" id="6500624">,</span>&nbsp;<span class="num" id="6500626">0xb4</span><span class="op" id="6500630">,</span>&nbsp;<span class="num" id="6500632">0xc5</span><span class="op" id="6500636">,</span>&nbsp;<span class="num" id="6500638">0x5a</span><span class="op" id="6500642">}</span><span class="op" id="6500643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500646">}</span><span class="op" id="6500647">,</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6500654">//&nbsp;Appendix&nbsp;C.2.&nbsp;&nbsp;AES-192</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500682">[</span><span class="op" id="6500683">]</span><span class="builtintype" id="6500684">byte</span><span class="op" id="6500688">{</span><span class="num" id="6500689">0x00</span><span class="op" id="6500693">,</span>&nbsp;<span class="num" id="6500695">0x01</span><span class="op" id="6500699">,</span>&nbsp;<span class="num" id="6500701">0x02</span><span class="op" id="6500705">,</span>&nbsp;<span class="num" id="6500707">0x03</span><span class="op" id="6500711">,</span>&nbsp;<span class="num" id="6500713">0x04</span><span class="op" id="6500717">,</span>&nbsp;<span class="num" id="6500719">0x05</span><span class="op" id="6500723">,</span>&nbsp;<span class="num" id="6500725">0x06</span><span class="op" id="6500729">,</span>&nbsp;<span class="num" id="6500731">0x07</span><span class="op" id="6500735">,</span>&nbsp;<span class="num" id="6500737">0x08</span><span class="op" id="6500741">,</span>&nbsp;<span class="num" id="6500743">0x09</span><span class="op" id="6500747">,</span>&nbsp;<span class="num" id="6500749">0x0a</span><span class="op" id="6500753">,</span>&nbsp;<span class="num" id="6500755">0x0b</span><span class="op" id="6500759">,</span>&nbsp;<span class="num" id="6500761">0x0c</span><span class="op" id="6500765">,</span>&nbsp;<span class="num" id="6500767">0x0d</span><span class="op" id="6500771">,</span>&nbsp;<span class="num" id="6500773">0x0e</span><span class="op" id="6500777">,</span>&nbsp;<span class="num" id="6500779">0x0f</span><span class="op" id="6500783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6500788">0x10</span><span class="op" id="6500792">,</span>&nbsp;<span class="num" id="6500794">0x11</span><span class="op" id="6500798">,</span>&nbsp;<span class="num" id="6500800">0x12</span><span class="op" id="6500804">,</span>&nbsp;<span class="num" id="6500806">0x13</span><span class="op" id="6500810">,</span>&nbsp;<span class="num" id="6500812">0x14</span><span class="op" id="6500816">,</span>&nbsp;<span class="num" id="6500818">0x15</span><span class="op" id="6500822">,</span>&nbsp;<span class="num" id="6500824">0x16</span><span class="op" id="6500828">,</span>&nbsp;<span class="num" id="6500830">0x17</span><span class="op" id="6500834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500838">}</span><span class="op" id="6500839">,</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500843">[</span><span class="op" id="6500844">]</span><span class="builtintype" id="6500845">byte</span><span class="op" id="6500849">{</span><span class="num" id="6500850">0x00</span><span class="op" id="6500854">,</span>&nbsp;<span class="num" id="6500856">0x11</span><span class="op" id="6500860">,</span>&nbsp;<span class="num" id="6500862">0x22</span><span class="op" id="6500866">,</span>&nbsp;<span class="num" id="6500868">0x33</span><span class="op" id="6500872">,</span>&nbsp;<span class="num" id="6500874">0x44</span><span class="op" id="6500878">,</span>&nbsp;<span class="num" id="6500880">0x55</span><span class="op" id="6500884">,</span>&nbsp;<span class="num" id="6500886">0x66</span><span class="op" id="6500890">,</span>&nbsp;<span class="num" id="6500892">0x77</span><span class="op" id="6500896">,</span>&nbsp;<span class="num" id="6500898">0x88</span><span class="op" id="6500902">,</span>&nbsp;<span class="num" id="6500904">0x99</span><span class="op" id="6500908">,</span>&nbsp;<span class="num" id="6500910">0xaa</span><span class="op" id="6500914">,</span>&nbsp;<span class="num" id="6500916">0xbb</span><span class="op" id="6500920">,</span>&nbsp;<span class="num" id="6500922">0xcc</span><span class="op" id="6500926">,</span>&nbsp;<span class="num" id="6500928">0xdd</span><span class="op" id="6500932">,</span>&nbsp;<span class="num" id="6500934">0xee</span><span class="op" id="6500938">,</span>&nbsp;<span class="num" id="6500940">0xff</span><span class="op" id="6500944">}</span><span class="op" id="6500945">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6500949">[</span><span class="op" id="6500950">]</span><span class="builtintype" id="6500951">byte</span><span class="op" id="6500955">{</span><span class="num" id="6500956">0xdd</span><span class="op" id="6500960">,</span>&nbsp;<span class="num" id="6500962">0xa9</span><span class="op" id="6500966">,</span>&nbsp;<span class="num" id="6500968">0x7c</span><span class="op" id="6500972">,</span>&nbsp;<span class="num" id="6500974">0xa4</span><span class="op" id="6500978">,</span>&nbsp;<span class="num" id="6500980">0x86</span><span class="op" id="6500984">,</span>&nbsp;<span class="num" id="6500986">0x4c</span><span class="op" id="6500990">,</span>&nbsp;<span class="num" id="6500992">0xdf</span><span class="op" id="6500996">,</span>&nbsp;<span class="num" id="6500998">0xe0</span><span class="op" id="6501002">,</span>&nbsp;<span class="num" id="6501004">0x6e</span><span class="op" id="6501008">,</span>&nbsp;<span class="num" id="6501010">0xaf</span><span class="op" id="6501014">,</span>&nbsp;<span class="num" id="6501016">0x70</span><span class="op" id="6501020">,</span>&nbsp;<span class="num" id="6501022">0xa0</span><span class="op" id="6501026">,</span>&nbsp;<span class="num" id="6501028">0xec</span><span class="op" id="6501032">,</span>&nbsp;<span class="num" id="6501034">0x0d</span><span class="op" id="6501038">,</span>&nbsp;<span class="num" id="6501040">0x71</span><span class="op" id="6501044">,</span>&nbsp;<span class="num" id="6501046">0x91</span><span class="op" id="6501050">}</span><span class="op" id="6501051">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501054">}</span><span class="op" id="6501055">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6501062">//&nbsp;Appendix&nbsp;C.3.&nbsp;&nbsp;AES-256</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501090">[</span><span class="op" id="6501091">]</span><span class="builtintype" id="6501092">byte</span><span class="op" id="6501096">{</span><span class="num" id="6501097">0x00</span><span class="op" id="6501101">,</span>&nbsp;<span class="num" id="6501103">0x01</span><span class="op" id="6501107">,</span>&nbsp;<span class="num" id="6501109">0x02</span><span class="op" id="6501113">,</span>&nbsp;<span class="num" id="6501115">0x03</span><span class="op" id="6501119">,</span>&nbsp;<span class="num" id="6501121">0x04</span><span class="op" id="6501125">,</span>&nbsp;<span class="num" id="6501127">0x05</span><span class="op" id="6501131">,</span>&nbsp;<span class="num" id="6501133">0x06</span><span class="op" id="6501137">,</span>&nbsp;<span class="num" id="6501139">0x07</span><span class="op" id="6501143">,</span>&nbsp;<span class="num" id="6501145">0x08</span><span class="op" id="6501149">,</span>&nbsp;<span class="num" id="6501151">0x09</span><span class="op" id="6501155">,</span>&nbsp;<span class="num" id="6501157">0x0a</span><span class="op" id="6501161">,</span>&nbsp;<span class="num" id="6501163">0x0b</span><span class="op" id="6501167">,</span>&nbsp;<span class="num" id="6501169">0x0c</span><span class="op" id="6501173">,</span>&nbsp;<span class="num" id="6501175">0x0d</span><span class="op" id="6501179">,</span>&nbsp;<span class="num" id="6501181">0x0e</span><span class="op" id="6501185">,</span>&nbsp;<span class="num" id="6501187">0x0f</span><span class="op" id="6501191">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="6501196">0x10</span><span class="op" id="6501200">,</span>&nbsp;<span class="num" id="6501202">0x11</span><span class="op" id="6501206">,</span>&nbsp;<span class="num" id="6501208">0x12</span><span class="op" id="6501212">,</span>&nbsp;<span class="num" id="6501214">0x13</span><span class="op" id="6501218">,</span>&nbsp;<span class="num" id="6501220">0x14</span><span class="op" id="6501224">,</span>&nbsp;<span class="num" id="6501226">0x15</span><span class="op" id="6501230">,</span>&nbsp;<span class="num" id="6501232">0x16</span><span class="op" id="6501236">,</span>&nbsp;<span class="num" id="6501238">0x17</span><span class="op" id="6501242">,</span>&nbsp;<span class="num" id="6501244">0x18</span><span class="op" id="6501248">,</span>&nbsp;<span class="num" id="6501250">0x19</span><span class="op" id="6501254">,</span>&nbsp;<span class="num" id="6501256">0x1a</span><span class="op" id="6501260">,</span>&nbsp;<span class="num" id="6501262">0x1b</span><span class="op" id="6501266">,</span>&nbsp;<span class="num" id="6501268">0x1c</span><span class="op" id="6501272">,</span>&nbsp;<span class="num" id="6501274">0x1d</span><span class="op" id="6501278">,</span>&nbsp;<span class="num" id="6501280">0x1e</span><span class="op" id="6501284">,</span>&nbsp;<span class="num" id="6501286">0x1f</span><span class="op" id="6501290">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501294">}</span><span class="op" id="6501295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501299">[</span><span class="op" id="6501300">]</span><span class="builtintype" id="6501301">byte</span><span class="op" id="6501305">{</span><span class="num" id="6501306">0x00</span><span class="op" id="6501310">,</span>&nbsp;<span class="num" id="6501312">0x11</span><span class="op" id="6501316">,</span>&nbsp;<span class="num" id="6501318">0x22</span><span class="op" id="6501322">,</span>&nbsp;<span class="num" id="6501324">0x33</span><span class="op" id="6501328">,</span>&nbsp;<span class="num" id="6501330">0x44</span><span class="op" id="6501334">,</span>&nbsp;<span class="num" id="6501336">0x55</span><span class="op" id="6501340">,</span>&nbsp;<span class="num" id="6501342">0x66</span><span class="op" id="6501346">,</span>&nbsp;<span class="num" id="6501348">0x77</span><span class="op" id="6501352">,</span>&nbsp;<span class="num" id="6501354">0x88</span><span class="op" id="6501358">,</span>&nbsp;<span class="num" id="6501360">0x99</span><span class="op" id="6501364">,</span>&nbsp;<span class="num" id="6501366">0xaa</span><span class="op" id="6501370">,</span>&nbsp;<span class="num" id="6501372">0xbb</span><span class="op" id="6501376">,</span>&nbsp;<span class="num" id="6501378">0xcc</span><span class="op" id="6501382">,</span>&nbsp;<span class="num" id="6501384">0xdd</span><span class="op" id="6501388">,</span>&nbsp;<span class="num" id="6501390">0xee</span><span class="op" id="6501394">,</span>&nbsp;<span class="num" id="6501396">0xff</span><span class="op" id="6501400">}</span><span class="op" id="6501401">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501405">[</span><span class="op" id="6501406">]</span><span class="builtintype" id="6501407">byte</span><span class="op" id="6501411">{</span><span class="num" id="6501412">0x8e</span><span class="op" id="6501416">,</span>&nbsp;<span class="num" id="6501418">0xa2</span><span class="op" id="6501422">,</span>&nbsp;<span class="num" id="6501424">0xb7</span><span class="op" id="6501428">,</span>&nbsp;<span class="num" id="6501430">0xca</span><span class="op" id="6501434">,</span>&nbsp;<span class="num" id="6501436">0x51</span><span class="op" id="6501440">,</span>&nbsp;<span class="num" id="6501442">0x67</span><span class="op" id="6501446">,</span>&nbsp;<span class="num" id="6501448">0x45</span><span class="op" id="6501452">,</span>&nbsp;<span class="num" id="6501454">0xbf</span><span class="op" id="6501458">,</span>&nbsp;<span class="num" id="6501460">0xea</span><span class="op" id="6501464">,</span>&nbsp;<span class="num" id="6501466">0xfc</span><span class="op" id="6501470">,</span>&nbsp;<span class="num" id="6501472">0x49</span><span class="op" id="6501476">,</span>&nbsp;<span class="num" id="6501478">0x90</span><span class="op" id="6501482">,</span>&nbsp;<span class="num" id="6501484">0x4b</span><span class="op" id="6501488">,</span>&nbsp;<span class="num" id="6501490">0x49</span><span class="op" id="6501494">,</span>&nbsp;<span class="num" id="6501496">0x60</span><span class="op" id="6501500">,</span>&nbsp;<span class="num" id="6501502">0x89</span><span class="op" id="6501506">}</span><span class="op" id="6501507">,</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501510">}</span><span class="op" id="6501511">,</span><br>
<span class="lineno"></span><span class="op" id="6501513">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6501516">//&nbsp;Test&nbsp;encryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="6501564">func</span>&nbsp;<span class="ident" id="6501569">TestEncryptBlock</span><span class="op" id="6501585">(</span><span class="ident" id="6501586">t</span>&nbsp;<span class="op" id="6501588">*</span><span class="ident" id="6501589">testing</span><span class="op" id="6501596">.</span><span class="ident" id="6501597">T</span><span class="op" id="6501598">)</span>&nbsp;<span class="op" id="6501600">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501603">for</span>&nbsp;<span class="ident" id="6501607">i</span><span class="op" id="6501608">,</span>&nbsp;<span class="ident" id="6501610">tt</span>&nbsp;<span class="op" id="6501613">:=</span>&nbsp;<span class="keyword" id="6501616">range</span>&nbsp;<span class="ident" id="6501622">encryptTests</span>&nbsp;<span class="op" id="6501635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501639">n</span>&nbsp;<span class="op" id="6501641">:=</span>&nbsp;<span class="builtinfunc" id="6501644">len</span><span class="op" id="6501647">(</span><span class="ident" id="6501648">tt</span><span class="op" id="6501650">.</span><span class="ident" id="6501651">key</span><span class="op" id="6501654">)</span>&nbsp;<span class="op" id="6501656">+</span>&nbsp;<span class="num" id="6501658">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501663">enc</span>&nbsp;<span class="op" id="6501667">:=</span>&nbsp;<span class="builtinfunc" id="6501670">make</span><span class="op" id="6501674">(</span><span class="op" id="6501675">[</span><span class="op" id="6501676">]</span><span class="builtintype" id="6501677">uint32</span><span class="op" id="6501683">,</span>&nbsp;<span class="ident" id="6501685">n</span><span class="op" id="6501686">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501690">dec</span>&nbsp;<span class="op" id="6501694">:=</span>&nbsp;<span class="builtinfunc" id="6501697">make</span><span class="op" id="6501701">(</span><span class="op" id="6501702">[</span><span class="op" id="6501703">]</span><span class="builtintype" id="6501704">uint32</span><span class="op" id="6501710">,</span>&nbsp;<span class="ident" id="6501712">n</span><span class="op" id="6501713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501717">expandKey</span><span class="op" id="6501726">(</span><span class="ident" id="6501727">tt</span><span class="op" id="6501729">.</span><span class="ident" id="6501730">key</span><span class="op" id="6501733">,</span>&nbsp;<span class="ident" id="6501735">enc</span><span class="op" id="6501738">,</span>&nbsp;<span class="ident" id="6501740">dec</span><span class="op" id="6501743">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501747">out</span>&nbsp;<span class="op" id="6501751">:=</span>&nbsp;<span class="builtinfunc" id="6501754">make</span><span class="op" id="6501758">(</span><span class="op" id="6501759">[</span><span class="op" id="6501760">]</span><span class="builtintype" id="6501761">byte</span><span class="op" id="6501765">,</span>&nbsp;<span class="builtinfunc" id="6501767">len</span><span class="op" id="6501770">(</span><span class="ident" id="6501771">tt</span><span class="op" id="6501773">.</span><span class="ident" id="6501774">in</span><span class="op" id="6501776">)</span><span class="op" id="6501777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501781">encryptBlock</span><span class="op" id="6501793">(</span><span class="ident" id="6501794">enc</span><span class="op" id="6501797">,</span>&nbsp;<span class="ident" id="6501799">out</span><span class="op" id="6501802">,</span>&nbsp;<span class="ident" id="6501804">tt</span><span class="op" id="6501806">.</span><span class="ident" id="6501807">in</span><span class="op" id="6501809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501813">for</span>&nbsp;<span class="ident" id="6501817">j</span><span class="op" id="6501818">,</span>&nbsp;<span class="ident" id="6501820">v</span>&nbsp;<span class="op" id="6501822">:=</span>&nbsp;<span class="keyword" id="6501825">range</span>&nbsp;<span class="ident" id="6501831">out</span>&nbsp;<span class="op" id="6501835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501840">if</span>&nbsp;<span class="ident" id="6501843">v</span>&nbsp;<span class="op" id="6501845">!=</span>&nbsp;<span class="ident" id="6501848">tt</span><span class="op" id="6501850">.</span><span class="ident" id="6501851">out</span><span class="op" id="6501854">[</span><span class="ident" id="6501855">j</span><span class="op" id="6501856">]</span>&nbsp;<span class="op" id="6501858">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6501864">t</span><span class="op" id="6501865">.</span><span class="ident" id="6501866">Errorf</span><span class="op" id="6501872">(</span><span class="string" id="6501873">&#34;encryptBlock&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6501915">,</span>&nbsp;<span class="ident" id="6501917">i</span><span class="op" id="6501918">,</span>&nbsp;<span class="ident" id="6501920">j</span><span class="op" id="6501921">,</span>&nbsp;<span class="ident" id="6501923">v</span><span class="op" id="6501924">,</span>&nbsp;<span class="ident" id="6501926">tt</span><span class="op" id="6501928">.</span><span class="ident" id="6501929">out</span><span class="op" id="6501932">[</span><span class="ident" id="6501933">j</span><span class="op" id="6501934">]</span><span class="op" id="6501935">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6501941">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501950">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6501957">}</span><br>
<span class="lineno"></span><span class="op" id="6501959">}</span><br>
<span class="lineno">300</span><br>
<span class="lineno"></span><span class="comment" id="6501962">//&nbsp;Test&nbsp;decryptBlock&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="6502010">func</span>&nbsp;<span class="ident" id="6502015">TestDecryptBlock</span><span class="op" id="6502031">(</span><span class="ident" id="6502032">t</span>&nbsp;<span class="op" id="6502034">*</span><span class="ident" id="6502035">testing</span><span class="op" id="6502042">.</span><span class="ident" id="6502043">T</span><span class="op" id="6502044">)</span>&nbsp;<span class="op" id="6502046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502049">for</span>&nbsp;<span class="ident" id="6502053">i</span><span class="op" id="6502054">,</span>&nbsp;<span class="ident" id="6502056">tt</span>&nbsp;<span class="op" id="6502059">:=</span>&nbsp;<span class="keyword" id="6502062">range</span>&nbsp;<span class="ident" id="6502068">encryptTests</span>&nbsp;<span class="op" id="6502081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502085">n</span>&nbsp;<span class="op" id="6502087">:=</span>&nbsp;<span class="builtinfunc" id="6502090">len</span><span class="op" id="6502093">(</span><span class="ident" id="6502094">tt</span><span class="op" id="6502096">.</span><span class="ident" id="6502097">key</span><span class="op" id="6502100">)</span>&nbsp;<span class="op" id="6502102">+</span>&nbsp;<span class="num" id="6502104">28</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502109">enc</span>&nbsp;<span class="op" id="6502113">:=</span>&nbsp;<span class="builtinfunc" id="6502116">make</span><span class="op" id="6502120">(</span><span class="op" id="6502121">[</span><span class="op" id="6502122">]</span><span class="builtintype" id="6502123">uint32</span><span class="op" id="6502129">,</span>&nbsp;<span class="ident" id="6502131">n</span><span class="op" id="6502132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502136">dec</span>&nbsp;<span class="op" id="6502140">:=</span>&nbsp;<span class="builtinfunc" id="6502143">make</span><span class="op" id="6502147">(</span><span class="op" id="6502148">[</span><span class="op" id="6502149">]</span><span class="builtintype" id="6502150">uint32</span><span class="op" id="6502156">,</span>&nbsp;<span class="ident" id="6502158">n</span><span class="op" id="6502159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502163">expandKey</span><span class="op" id="6502172">(</span><span class="ident" id="6502173">tt</span><span class="op" id="6502175">.</span><span class="ident" id="6502176">key</span><span class="op" id="6502179">,</span>&nbsp;<span class="ident" id="6502181">enc</span><span class="op" id="6502184">,</span>&nbsp;<span class="ident" id="6502186">dec</span><span class="op" id="6502189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502193">plain</span>&nbsp;<span class="op" id="6502199">:=</span>&nbsp;<span class="builtinfunc" id="6502202">make</span><span class="op" id="6502206">(</span><span class="op" id="6502207">[</span><span class="op" id="6502208">]</span><span class="builtintype" id="6502209">byte</span><span class="op" id="6502213">,</span>&nbsp;<span class="builtinfunc" id="6502215">len</span><span class="op" id="6502218">(</span><span class="ident" id="6502219">tt</span><span class="op" id="6502221">.</span><span class="ident" id="6502222">in</span><span class="op" id="6502224">)</span><span class="op" id="6502225">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502229">decryptBlock</span><span class="op" id="6502241">(</span><span class="ident" id="6502242">dec</span><span class="op" id="6502245">,</span>&nbsp;<span class="ident" id="6502247">plain</span><span class="op" id="6502252">,</span>&nbsp;<span class="ident" id="6502254">tt</span><span class="op" id="6502256">.</span><span class="ident" id="6502257">out</span><span class="op" id="6502260">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502264">for</span>&nbsp;<span class="ident" id="6502268">j</span><span class="op" id="6502269">,</span>&nbsp;<span class="ident" id="6502271">v</span>&nbsp;<span class="op" id="6502273">:=</span>&nbsp;<span class="keyword" id="6502276">range</span>&nbsp;<span class="ident" id="6502282">plain</span>&nbsp;<span class="op" id="6502288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502293">if</span>&nbsp;<span class="ident" id="6502296">v</span>&nbsp;<span class="op" id="6502298">!=</span>&nbsp;<span class="ident" id="6502301">tt</span><span class="op" id="6502303">.</span><span class="ident" id="6502304">in</span><span class="op" id="6502306">[</span><span class="ident" id="6502307">j</span><span class="op" id="6502308">]</span>&nbsp;<span class="op" id="6502310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502316">t</span><span class="op" id="6502317">.</span><span class="ident" id="6502318">Errorf</span><span class="op" id="6502324">(</span><span class="string" id="6502325">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6502369">,</span>&nbsp;<span class="ident" id="6502371">i</span><span class="op" id="6502372">,</span>&nbsp;<span class="ident" id="6502374">j</span><span class="op" id="6502375">,</span>&nbsp;<span class="ident" id="6502377">v</span><span class="op" id="6502378">,</span>&nbsp;<span class="ident" id="6502380">tt</span><span class="op" id="6502382">.</span><span class="ident" id="6502383">in</span><span class="op" id="6502385">[</span><span class="ident" id="6502386">j</span><span class="op" id="6502387">]</span><span class="op" id="6502388">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502394">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502403">}</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502410">}</span><br>
<span class="lineno"></span><span class="op" id="6502412">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6502415">//&nbsp;Test&nbsp;Cipher&nbsp;Encrypt&nbsp;method&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno">320</span><span class="keyword" id="6502472">func</span>&nbsp;<span class="ident" id="6502477">TestCipherEncrypt</span><span class="op" id="6502494">(</span><span class="ident" id="6502495">t</span>&nbsp;<span class="op" id="6502497">*</span><span class="ident" id="6502498">testing</span><span class="op" id="6502505">.</span><span class="ident" id="6502506">T</span><span class="op" id="6502507">)</span>&nbsp;<span class="op" id="6502509">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502512">for</span>&nbsp;<span class="ident" id="6502516">i</span><span class="op" id="6502517">,</span>&nbsp;<span class="ident" id="6502519">tt</span>&nbsp;<span class="op" id="6502522">:=</span>&nbsp;<span class="keyword" id="6502525">range</span>&nbsp;<span class="ident" id="6502531">encryptTests</span>&nbsp;<span class="op" id="6502544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502548">c</span><span class="op" id="6502549">,</span>&nbsp;<span class="ident" id="6502551">err</span>&nbsp;<span class="op" id="6502555">:=</span>&nbsp;<span class="ident" id="6502558">NewCipher</span><span class="op" id="6502567">(</span><span class="ident" id="6502568">tt</span><span class="op" id="6502570">.</span><span class="ident" id="6502571">key</span><span class="op" id="6502574">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502578">if</span>&nbsp;<span class="ident" id="6502581">err</span>&nbsp;<span class="op" id="6502585">!=</span>&nbsp;<span class="ident" id="6502588">nil</span>&nbsp;<span class="op" id="6502592">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502597">t</span><span class="op" id="6502598">.</span><span class="ident" id="6502599">Errorf</span><span class="op" id="6502605">(</span><span class="string" id="6502606">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="6502632">,</span>&nbsp;<span class="builtinfunc" id="6502634">len</span><span class="op" id="6502637">(</span><span class="ident" id="6502638">tt</span><span class="op" id="6502640">.</span><span class="ident" id="6502641">key</span><span class="op" id="6502644">)</span><span class="op" id="6502645">,</span>&nbsp;<span class="ident" id="6502647">err</span><span class="op" id="6502650">)</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502655">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502666">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502670">out</span>&nbsp;<span class="op" id="6502674">:=</span>&nbsp;<span class="builtinfunc" id="6502677">make</span><span class="op" id="6502681">(</span><span class="op" id="6502682">[</span><span class="op" id="6502683">]</span><span class="builtintype" id="6502684">byte</span><span class="op" id="6502688">,</span>&nbsp;<span class="builtinfunc" id="6502690">len</span><span class="op" id="6502693">(</span><span class="ident" id="6502694">tt</span><span class="op" id="6502696">.</span><span class="ident" id="6502697">in</span><span class="op" id="6502699">)</span><span class="op" id="6502700">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502704">c</span><span class="op" id="6502705">.</span><span class="ident" id="6502706">Encrypt</span><span class="op" id="6502713">(</span><span class="ident" id="6502714">out</span><span class="op" id="6502717">,</span>&nbsp;<span class="ident" id="6502719">tt</span><span class="op" id="6502721">.</span><span class="ident" id="6502722">in</span><span class="op" id="6502724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502728">for</span>&nbsp;<span class="ident" id="6502732">j</span><span class="op" id="6502733">,</span>&nbsp;<span class="ident" id="6502735">v</span>&nbsp;<span class="op" id="6502737">:=</span>&nbsp;<span class="keyword" id="6502740">range</span>&nbsp;<span class="ident" id="6502746">out</span>&nbsp;<span class="op" id="6502750">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502755">if</span>&nbsp;<span class="ident" id="6502758">v</span>&nbsp;<span class="op" id="6502760">!=</span>&nbsp;<span class="ident" id="6502763">tt</span><span class="op" id="6502765">.</span><span class="ident" id="6502766">out</span><span class="op" id="6502769">[</span><span class="ident" id="6502770">j</span><span class="op" id="6502771">]</span>&nbsp;<span class="op" id="6502773">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6502779">t</span><span class="op" id="6502780">.</span><span class="ident" id="6502781">Errorf</span><span class="op" id="6502787">(</span><span class="string" id="6502788">&#34;Cipher.Encrypt&nbsp;%d:&nbsp;out[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6502832">,</span>&nbsp;<span class="ident" id="6502834">i</span><span class="op" id="6502835">,</span>&nbsp;<span class="ident" id="6502837">j</span><span class="op" id="6502838">,</span>&nbsp;<span class="ident" id="6502840">v</span><span class="op" id="6502841">,</span>&nbsp;<span class="ident" id="6502843">tt</span><span class="op" id="6502845">.</span><span class="ident" id="6502846">out</span><span class="op" id="6502849">[</span><span class="ident" id="6502850">j</span><span class="op" id="6502851">]</span><span class="op" id="6502852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502858">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502867">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502871">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6502874">}</span><br>
<span class="lineno"></span><span class="op" id="6502876">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6502879">//&nbsp;Test&nbsp;Cipher&nbsp;Decrypt&nbsp;against&nbsp;FIPS&nbsp;197&nbsp;examples.</span><br>
<span class="lineno"></span><span class="keyword" id="6502929">func</span>&nbsp;<span class="ident" id="6502934">TestCipherDecrypt</span><span class="op" id="6502951">(</span><span class="ident" id="6502952">t</span>&nbsp;<span class="op" id="6502954">*</span><span class="ident" id="6502955">testing</span><span class="op" id="6502962">.</span><span class="ident" id="6502963">T</span><span class="op" id="6502964">)</span>&nbsp;<span class="op" id="6502966">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6502969">for</span>&nbsp;<span class="ident" id="6502973">i</span><span class="op" id="6502974">,</span>&nbsp;<span class="ident" id="6502976">tt</span>&nbsp;<span class="op" id="6502979">:=</span>&nbsp;<span class="keyword" id="6502982">range</span>&nbsp;<span class="ident" id="6502988">encryptTests</span>&nbsp;<span class="op" id="6503001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503005">c</span><span class="op" id="6503006">,</span>&nbsp;<span class="ident" id="6503008">err</span>&nbsp;<span class="op" id="6503012">:=</span>&nbsp;<span class="ident" id="6503015">NewCipher</span><span class="op" id="6503024">(</span><span class="ident" id="6503025">tt</span><span class="op" id="6503027">.</span><span class="ident" id="6503028">key</span><span class="op" id="6503031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503035">if</span>&nbsp;<span class="ident" id="6503038">err</span>&nbsp;<span class="op" id="6503042">!=</span>&nbsp;<span class="ident" id="6503045">nil</span>&nbsp;<span class="op" id="6503049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503054">t</span><span class="op" id="6503055">.</span><span class="ident" id="6503056">Errorf</span><span class="op" id="6503062">(</span><span class="string" id="6503063">&#34;NewCipher(%d&nbsp;bytes)&nbsp;=&nbsp;%s&#34;</span><span class="op" id="6503089">,</span>&nbsp;<span class="builtinfunc" id="6503091">len</span><span class="op" id="6503094">(</span><span class="ident" id="6503095">tt</span><span class="op" id="6503097">.</span><span class="ident" id="6503098">key</span><span class="op" id="6503101">)</span><span class="op" id="6503102">,</span>&nbsp;<span class="ident" id="6503104">err</span><span class="op" id="6503107">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503112">continue</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6503123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503127">plain</span>&nbsp;<span class="op" id="6503133">:=</span>&nbsp;<span class="builtinfunc" id="6503136">make</span><span class="op" id="6503140">(</span><span class="op" id="6503141">[</span><span class="op" id="6503142">]</span><span class="builtintype" id="6503143">byte</span><span class="op" id="6503147">,</span>&nbsp;<span class="builtinfunc" id="6503149">len</span><span class="op" id="6503152">(</span><span class="ident" id="6503153">tt</span><span class="op" id="6503155">.</span><span class="ident" id="6503156">in</span><span class="op" id="6503158">)</span><span class="op" id="6503159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503163">c</span><span class="op" id="6503164">.</span><span class="ident" id="6503165">Decrypt</span><span class="op" id="6503172">(</span><span class="ident" id="6503173">plain</span><span class="op" id="6503178">,</span>&nbsp;<span class="ident" id="6503180">tt</span><span class="op" id="6503182">.</span><span class="ident" id="6503183">out</span><span class="op" id="6503186">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503190">for</span>&nbsp;<span class="ident" id="6503194">j</span><span class="op" id="6503195">,</span>&nbsp;<span class="ident" id="6503197">v</span>&nbsp;<span class="op" id="6503199">:=</span>&nbsp;<span class="keyword" id="6503202">range</span>&nbsp;<span class="ident" id="6503208">plain</span>&nbsp;<span class="op" id="6503214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503219">if</span>&nbsp;<span class="ident" id="6503222">v</span>&nbsp;<span class="op" id="6503224">!=</span>&nbsp;<span class="ident" id="6503227">tt</span><span class="op" id="6503229">.</span><span class="ident" id="6503230">in</span><span class="op" id="6503232">[</span><span class="ident" id="6503233">j</span><span class="op" id="6503234">]</span>&nbsp;<span class="op" id="6503236">{</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503242">t</span><span class="op" id="6503243">.</span><span class="ident" id="6503244">Errorf</span><span class="op" id="6503250">(</span><span class="string" id="6503251">&#34;decryptBlock&nbsp;%d:&nbsp;plain[%d]&nbsp;=&nbsp;%#x,&nbsp;want&nbsp;%#x&#34;</span><span class="op" id="6503295">,</span>&nbsp;<span class="ident" id="6503297">i</span><span class="op" id="6503298">,</span>&nbsp;<span class="ident" id="6503300">j</span><span class="op" id="6503301">,</span>&nbsp;<span class="ident" id="6503303">v</span><span class="op" id="6503304">,</span>&nbsp;<span class="ident" id="6503306">tt</span><span class="op" id="6503308">.</span><span class="ident" id="6503309">in</span><span class="op" id="6503311">[</span><span class="ident" id="6503312">j</span><span class="op" id="6503313">]</span><span class="op" id="6503314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6503320">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6503329">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6503333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6503336">}</span><br>
<span class="lineno">355</span><span class="op" id="6503338">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6503341">//&nbsp;Test&nbsp;short&nbsp;input/output.</span><br>
<span class="lineno"></span><span class="comment" id="6503369">//&nbsp;Assembly&nbsp;used&nbsp;to&nbsp;not&nbsp;notice.</span><br>
<span class="lineno"></span><span class="comment" id="6503401">//&nbsp;See&nbsp;issue&nbsp;7928.</span><br>
<span class="lineno">360</span><span class="keyword" id="6503420">func</span>&nbsp;<span class="ident" id="6503425">TestShortBlocks</span><span class="op" id="6503440">(</span><span class="ident" id="6503441">t</span>&nbsp;<span class="op" id="6503443">*</span><span class="ident" id="6503444">testing</span><span class="op" id="6503451">.</span><span class="ident" id="6503452">T</span><span class="op" id="6503453">)</span>&nbsp;<span class="op" id="6503455">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503458">bytes</span>&nbsp;<span class="op" id="6503464">:=</span>&nbsp;<span class="keyword" id="6503467">func</span><span class="op" id="6503471">(</span><span class="ident" id="6503472">n</span>&nbsp;<span class="builtintype" id="6503474">int</span><span class="op" id="6503477">)</span>&nbsp;<span class="op" id="6503479">[</span><span class="op" id="6503480">]</span><span class="builtintype" id="6503481">byte</span>&nbsp;<span class="op" id="6503486">{</span>&nbsp;<span class="keyword" id="6503488">return</span>&nbsp;<span class="builtinfunc" id="6503495">make</span><span class="op" id="6503499">(</span><span class="op" id="6503500">[</span><span class="op" id="6503501">]</span><span class="builtintype" id="6503502">byte</span><span class="op" id="6503506">,</span>&nbsp;<span class="ident" id="6503508">n</span><span class="op" id="6503509">)</span>&nbsp;<span class="op" id="6503511">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503515">c</span><span class="op" id="6503516">,</span>&nbsp;<span class="ident" id="6503518">_</span>&nbsp;<span class="op" id="6503520">:=</span>&nbsp;<span class="ident" id="6503523">NewCipher</span><span class="op" id="6503532">(</span><span class="ident" id="6503533">bytes</span><span class="op" id="6503538">(</span><span class="num" id="6503539">16</span><span class="op" id="6503541">)</span><span class="op" id="6503542">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503546">mustPanic</span><span class="op" id="6503555">(</span><span class="ident" id="6503556">t</span><span class="op" id="6503557">,</span>&nbsp;<span class="string" id="6503559">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6503593">,</span>&nbsp;<span class="keyword" id="6503595">func</span><span class="op" id="6503599">(</span><span class="op" id="6503600">)</span>&nbsp;<span class="op" id="6503602">{</span>&nbsp;<span class="ident" id="6503604">c</span><span class="op" id="6503605">.</span><span class="ident" id="6503606">Encrypt</span><span class="op" id="6503613">(</span><span class="ident" id="6503614">bytes</span><span class="op" id="6503619">(</span><span class="num" id="6503620">1</span><span class="op" id="6503621">)</span><span class="op" id="6503622">,</span>&nbsp;<span class="ident" id="6503624">bytes</span><span class="op" id="6503629">(</span><span class="num" id="6503630">1</span><span class="op" id="6503631">)</span><span class="op" id="6503632">)</span>&nbsp;<span class="op" id="6503634">}</span><span class="op" id="6503635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503638">mustPanic</span><span class="op" id="6503647">(</span><span class="ident" id="6503648">t</span><span class="op" id="6503649">,</span>&nbsp;<span class="string" id="6503651">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6503685">,</span>&nbsp;<span class="keyword" id="6503687">func</span><span class="op" id="6503691">(</span><span class="op" id="6503692">)</span>&nbsp;<span class="op" id="6503694">{</span>&nbsp;<span class="ident" id="6503696">c</span><span class="op" id="6503697">.</span><span class="ident" id="6503698">Decrypt</span><span class="op" id="6503705">(</span><span class="ident" id="6503706">bytes</span><span class="op" id="6503711">(</span><span class="num" id="6503712">1</span><span class="op" id="6503713">)</span><span class="op" id="6503714">,</span>&nbsp;<span class="ident" id="6503716">bytes</span><span class="op" id="6503721">(</span><span class="num" id="6503722">1</span><span class="op" id="6503723">)</span><span class="op" id="6503724">)</span>&nbsp;<span class="op" id="6503726">}</span><span class="op" id="6503727">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503730">mustPanic</span><span class="op" id="6503739">(</span><span class="ident" id="6503740">t</span><span class="op" id="6503741">,</span>&nbsp;<span class="string" id="6503743">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6503777">,</span>&nbsp;<span class="keyword" id="6503779">func</span><span class="op" id="6503783">(</span><span class="op" id="6503784">)</span>&nbsp;<span class="op" id="6503786">{</span>&nbsp;<span class="ident" id="6503788">c</span><span class="op" id="6503789">.</span><span class="ident" id="6503790">Encrypt</span><span class="op" id="6503797">(</span><span class="ident" id="6503798">bytes</span><span class="op" id="6503803">(</span><span class="num" id="6503804">100</span><span class="op" id="6503807">)</span><span class="op" id="6503808">,</span>&nbsp;<span class="ident" id="6503810">bytes</span><span class="op" id="6503815">(</span><span class="num" id="6503816">1</span><span class="op" id="6503817">)</span><span class="op" id="6503818">)</span>&nbsp;<span class="op" id="6503820">}</span><span class="op" id="6503821">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503824">mustPanic</span><span class="op" id="6503833">(</span><span class="ident" id="6503834">t</span><span class="op" id="6503835">,</span>&nbsp;<span class="string" id="6503837">&#34;crypto/aes:&nbsp;input&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6503871">,</span>&nbsp;<span class="keyword" id="6503873">func</span><span class="op" id="6503877">(</span><span class="op" id="6503878">)</span>&nbsp;<span class="op" id="6503880">{</span>&nbsp;<span class="ident" id="6503882">c</span><span class="op" id="6503883">.</span><span class="ident" id="6503884">Decrypt</span><span class="op" id="6503891">(</span><span class="ident" id="6503892">bytes</span><span class="op" id="6503897">(</span><span class="num" id="6503898">100</span><span class="op" id="6503901">)</span><span class="op" id="6503902">,</span>&nbsp;<span class="ident" id="6503904">bytes</span><span class="op" id="6503909">(</span><span class="num" id="6503910">1</span><span class="op" id="6503911">)</span><span class="op" id="6503912">)</span>&nbsp;<span class="op" id="6503914">}</span><span class="op" id="6503915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6503918">mustPanic</span><span class="op" id="6503927">(</span><span class="ident" id="6503928">t</span><span class="op" id="6503929">,</span>&nbsp;<span class="string" id="6503931">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6503966">,</span>&nbsp;<span class="keyword" id="6503968">func</span><span class="op" id="6503972">(</span><span class="op" id="6503973">)</span>&nbsp;<span class="op" id="6503975">{</span>&nbsp;<span class="ident" id="6503977">c</span><span class="op" id="6503978">.</span><span class="ident" id="6503979">Encrypt</span><span class="op" id="6503986">(</span><span class="ident" id="6503987">bytes</span><span class="op" id="6503992">(</span><span class="num" id="6503993">1</span><span class="op" id="6503994">)</span><span class="op" id="6503995">,</span>&nbsp;<span class="ident" id="6503997">bytes</span><span class="op" id="6504002">(</span><span class="num" id="6504003">100</span><span class="op" id="6504006">)</span><span class="op" id="6504007">)</span>&nbsp;<span class="op" id="6504009">}</span><span class="op" id="6504010">)</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504013">mustPanic</span><span class="op" id="6504022">(</span><span class="ident" id="6504023">t</span><span class="op" id="6504024">,</span>&nbsp;<span class="string" id="6504026">&#34;crypto/aes:&nbsp;output&nbsp;not&nbsp;full&nbsp;block&#34;</span><span class="op" id="6504061">,</span>&nbsp;<span class="keyword" id="6504063">func</span><span class="op" id="6504067">(</span><span class="op" id="6504068">)</span>&nbsp;<span class="op" id="6504070">{</span>&nbsp;<span class="ident" id="6504072">c</span><span class="op" id="6504073">.</span><span class="ident" id="6504074">Decrypt</span><span class="op" id="6504081">(</span><span class="ident" id="6504082">bytes</span><span class="op" id="6504087">(</span><span class="num" id="6504088">1</span><span class="op" id="6504089">)</span><span class="op" id="6504090">,</span>&nbsp;<span class="ident" id="6504092">bytes</span><span class="op" id="6504097">(</span><span class="num" id="6504098">100</span><span class="op" id="6504101">)</span><span class="op" id="6504102">)</span>&nbsp;<span class="op" id="6504104">}</span><span class="op" id="6504105">)</span><br>
<span class="lineno"></span><span class="op" id="6504107">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6504110">func</span>&nbsp;<span class="ident" id="6504115">mustPanic</span><span class="op" id="6504124">(</span><span class="ident" id="6504125">t</span>&nbsp;<span class="op" id="6504127">*</span><span class="ident" id="6504128">testing</span><span class="op" id="6504135">.</span><span class="ident" id="6504136">T</span><span class="op" id="6504137">,</span>&nbsp;<span class="ident" id="6504139">msg</span>&nbsp;<span class="builtintype" id="6504143">string</span><span class="op" id="6504149">,</span>&nbsp;<span class="ident" id="6504151">f</span>&nbsp;<span class="keyword" id="6504153">func</span><span class="op" id="6504157">(</span><span class="op" id="6504158">)</span><span class="op" id="6504159">)</span>&nbsp;<span class="op" id="6504161">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6504164">defer</span>&nbsp;<span class="keyword" id="6504170">func</span><span class="op" id="6504174">(</span><span class="op" id="6504175">)</span>&nbsp;<span class="op" id="6504177">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504181">err</span>&nbsp;<span class="op" id="6504185">:=</span>&nbsp;<span class="builtinfunc" id="6504188">recover</span><span class="op" id="6504195">(</span><span class="op" id="6504196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6504200">if</span>&nbsp;<span class="ident" id="6504203">err</span>&nbsp;<span class="op" id="6504207">==</span>&nbsp;<span class="ident" id="6504210">nil</span>&nbsp;<span class="op" id="6504214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504219">t</span><span class="op" id="6504220">.</span><span class="ident" id="6504221">Errorf</span><span class="op" id="6504227">(</span><span class="string" id="6504228">&#34;function&nbsp;did&nbsp;not&nbsp;panic,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="6504263">,</span>&nbsp;<span class="ident" id="6504265">msg</span><span class="op" id="6504268">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6504272">}</span>&nbsp;<span class="keyword" id="6504274">else</span>&nbsp;<span class="keyword" id="6504279">if</span>&nbsp;<span class="ident" id="6504282">err</span>&nbsp;<span class="op" id="6504286">!=</span>&nbsp;<span class="ident" id="6504289">msg</span>&nbsp;<span class="op" id="6504293">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504298">t</span><span class="op" id="6504299">.</span><span class="ident" id="6504300">Errorf</span><span class="op" id="6504306">(</span><span class="string" id="6504307">&#34;got&nbsp;panic&nbsp;%v,&nbsp;wanted&nbsp;%q&#34;</span><span class="op" id="6504332">,</span>&nbsp;<span class="ident" id="6504334">err</span><span class="op" id="6504337">,</span>&nbsp;<span class="ident" id="6504339">msg</span><span class="op" id="6504342">)</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6504346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6504349">}</span><span class="op" id="6504350">(</span><span class="op" id="6504351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504354">f</span><span class="op" id="6504355">(</span><span class="op" id="6504356">)</span><br>
<span class="lineno"></span><span class="op" id="6504358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="6504361">func</span>&nbsp;<span class="ident" id="6504366">BenchmarkEncrypt</span><span class="op" id="6504382">(</span><span class="ident" id="6504383">b</span>&nbsp;<span class="op" id="6504385">*</span><span class="ident" id="6504386">testing</span><span class="op" id="6504393">.</span><span class="ident" id="6504394">B</span><span class="op" id="6504395">)</span>&nbsp;<span class="op" id="6504397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504400">tt</span>&nbsp;<span class="op" id="6504403">:=</span>&nbsp;<span class="ident" id="6504406">encryptTests</span><span class="op" id="6504418">[</span><span class="num" id="6504419">0</span><span class="op" id="6504420">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504423">c</span><span class="op" id="6504424">,</span>&nbsp;<span class="ident" id="6504426">err</span>&nbsp;<span class="op" id="6504430">:=</span>&nbsp;<span class="ident" id="6504433">NewCipher</span><span class="op" id="6504442">(</span><span class="ident" id="6504443">tt</span><span class="op" id="6504445">.</span><span class="ident" id="6504446">key</span><span class="op" id="6504449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6504452">if</span>&nbsp;<span class="ident" id="6504455">err</span>&nbsp;<span class="op" id="6504459">!=</span>&nbsp;<span class="ident" id="6504462">nil</span>&nbsp;<span class="op" id="6504466">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504470">b</span><span class="op" id="6504471">.</span><span class="ident" id="6504472">Fatal</span><span class="op" id="6504477">(</span><span class="string" id="6504478">&#34;NewCipher:&#34;</span><span class="op" id="6504490">,</span>&nbsp;<span class="ident" id="6504492">err</span><span class="op" id="6504495">)</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6504498">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504501">out</span>&nbsp;<span class="op" id="6504505">:=</span>&nbsp;<span class="builtinfunc" id="6504508">make</span><span class="op" id="6504512">(</span><span class="op" id="6504513">[</span><span class="op" id="6504514">]</span><span class="builtintype" id="6504515">byte</span><span class="op" id="6504519">,</span>&nbsp;<span class="builtinfunc" id="6504521">len</span><span class="op" id="6504524">(</span><span class="ident" id="6504525">tt</span><span class="op" id="6504527">.</span><span class="ident" id="6504528">in</span><span class="op" id="6504530">)</span><span class="op" id="6504531">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504534">b</span><span class="op" id="6504535">.</span><span class="ident" id="6504536">SetBytes</span><span class="op" id="6504544">(</span><span class="ident" id="6504545">int64</span><span class="op" id="6504550">(</span><span class="builtinfunc" id="6504551">len</span><span class="op" id="6504554">(</span><span class="ident" id="6504555">out</span><span class="op" id="6504558">)</span><span class="op" id="6504559">)</span><span class="op" id="6504560">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504563">b</span><span class="op" id="6504564">.</span><span class="ident" id="6504565">ResetTimer</span><span class="op" id="6504575">(</span><span class="op" id="6504576">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6504579">for</span>&nbsp;<span class="ident" id="6504583">i</span>&nbsp;<span class="op" id="6504585">:=</span>&nbsp;<span class="num" id="6504588">0</span><span class="op" id="6504589">;</span>&nbsp;<span class="ident" id="6504591">i</span>&nbsp;<span class="op" id="6504593">&lt;</span>&nbsp;<span class="ident" id="6504595">b</span><span class="op" id="6504596">.</span><span class="ident" id="6504597">N</span><span class="op" id="6504598">;</span>&nbsp;<span class="ident" id="6504600">i</span><span class="op" id="6504601">++</span>&nbsp;<span class="op" id="6504604">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504608">c</span><span class="op" id="6504609">.</span><span class="ident" id="6504610">Encrypt</span><span class="op" id="6504617">(</span><span class="ident" id="6504618">out</span><span class="op" id="6504621">,</span>&nbsp;<span class="ident" id="6504623">tt</span><span class="op" id="6504625">.</span><span class="ident" id="6504626">in</span><span class="op" id="6504628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6504631">}</span><br>
<span class="lineno"></span><span class="op" id="6504633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6504636">func</span>&nbsp;<span class="ident" id="6504641">BenchmarkDecrypt</span><span class="op" id="6504657">(</span><span class="ident" id="6504658">b</span>&nbsp;<span class="op" id="6504660">*</span><span class="ident" id="6504661">testing</span><span class="op" id="6504668">.</span><span class="ident" id="6504669">B</span><span class="op" id="6504670">)</span>&nbsp;<span class="op" id="6504672">{</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504675">tt</span>&nbsp;<span class="op" id="6504678">:=</span>&nbsp;<span class="ident" id="6504681">encryptTests</span><span class="op" id="6504693">[</span><span class="num" id="6504694">0</span><span class="op" id="6504695">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504698">c</span><span class="op" id="6504699">,</span>&nbsp;<span class="ident" id="6504701">err</span>&nbsp;<span class="op" id="6504705">:=</span>&nbsp;<span class="ident" id="6504708">NewCipher</span><span class="op" id="6504717">(</span><span class="ident" id="6504718">tt</span><span class="op" id="6504720">.</span><span class="ident" id="6504721">key</span><span class="op" id="6504724">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6504727">if</span>&nbsp;<span class="ident" id="6504730">err</span>&nbsp;<span class="op" id="6504734">!=</span>&nbsp;<span class="ident" id="6504737">nil</span>&nbsp;<span class="op" id="6504741">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504745">b</span><span class="op" id="6504746">.</span><span class="ident" id="6504747">Fatal</span><span class="op" id="6504752">(</span><span class="string" id="6504753">&#34;NewCipher:&#34;</span><span class="op" id="6504765">,</span>&nbsp;<span class="ident" id="6504767">err</span><span class="op" id="6504770">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6504773">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504776">out</span>&nbsp;<span class="op" id="6504780">:=</span>&nbsp;<span class="builtinfunc" id="6504783">make</span><span class="op" id="6504787">(</span><span class="op" id="6504788">[</span><span class="op" id="6504789">]</span><span class="builtintype" id="6504790">byte</span><span class="op" id="6504794">,</span>&nbsp;<span class="builtinfunc" id="6504796">len</span><span class="op" id="6504799">(</span><span class="ident" id="6504800">tt</span><span class="op" id="6504802">.</span><span class="ident" id="6504803">out</span><span class="op" id="6504806">)</span><span class="op" id="6504807">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504810">b</span><span class="op" id="6504811">.</span><span class="ident" id="6504812">SetBytes</span><span class="op" id="6504820">(</span><span class="ident" id="6504821">int64</span><span class="op" id="6504826">(</span><span class="builtinfunc" id="6504827">len</span><span class="op" id="6504830">(</span><span class="ident" id="6504831">out</span><span class="op" id="6504834">)</span><span class="op" id="6504835">)</span><span class="op" id="6504836">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504839">b</span><span class="op" id="6504840">.</span><span class="ident" id="6504841">ResetTimer</span><span class="op" id="6504851">(</span><span class="op" id="6504852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6504855">for</span>&nbsp;<span class="ident" id="6504859">i</span>&nbsp;<span class="op" id="6504861">:=</span>&nbsp;<span class="num" id="6504864">0</span><span class="op" id="6504865">;</span>&nbsp;<span class="ident" id="6504867">i</span>&nbsp;<span class="op" id="6504869">&lt;</span>&nbsp;<span class="ident" id="6504871">b</span><span class="op" id="6504872">.</span><span class="ident" id="6504873">N</span><span class="op" id="6504874">;</span>&nbsp;<span class="ident" id="6504876">i</span><span class="op" id="6504877">++</span>&nbsp;<span class="op" id="6504880">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504884">c</span><span class="op" id="6504885">.</span><span class="ident" id="6504886">Decrypt</span><span class="op" id="6504893">(</span><span class="ident" id="6504894">out</span><span class="op" id="6504897">,</span>&nbsp;<span class="ident" id="6504899">tt</span><span class="op" id="6504901">.</span><span class="ident" id="6504902">out</span><span class="op" id="6504905">)</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6504908">}</span><br>
<span class="lineno"></span><span class="op" id="6504910">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6504913">func</span>&nbsp;<span class="ident" id="6504918">BenchmarkExpand</span><span class="op" id="6504933">(</span><span class="ident" id="6504934">b</span>&nbsp;<span class="op" id="6504936">*</span><span class="ident" id="6504937">testing</span><span class="op" id="6504944">.</span><span class="ident" id="6504945">B</span><span class="op" id="6504946">)</span>&nbsp;<span class="op" id="6504948">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504951">tt</span>&nbsp;<span class="op" id="6504954">:=</span>&nbsp;<span class="ident" id="6504957">encryptTests</span><span class="op" id="6504969">[</span><span class="num" id="6504970">0</span><span class="op" id="6504971">]</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504974">n</span>&nbsp;<span class="op" id="6504976">:=</span>&nbsp;<span class="builtinfunc" id="6504979">len</span><span class="op" id="6504982">(</span><span class="ident" id="6504983">tt</span><span class="op" id="6504985">.</span><span class="ident" id="6504986">key</span><span class="op" id="6504989">)</span>&nbsp;<span class="op" id="6504991">+</span>&nbsp;<span class="num" id="6504993">28</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6504997">c</span>&nbsp;<span class="op" id="6504999">:=</span>&nbsp;<span class="op" id="6505002">&amp;</span><span class="ident" id="6505003">aesCipher</span><span class="op" id="6505012">{</span><span class="builtinfunc" id="6505013">make</span><span class="op" id="6505017">(</span><span class="op" id="6505018">[</span><span class="op" id="6505019">]</span><span class="builtintype" id="6505020">uint32</span><span class="op" id="6505026">,</span>&nbsp;<span class="ident" id="6505028">n</span><span class="op" id="6505029">)</span><span class="op" id="6505030">,</span>&nbsp;<span class="builtinfunc" id="6505032">make</span><span class="op" id="6505036">(</span><span class="op" id="6505037">[</span><span class="op" id="6505038">]</span><span class="builtintype" id="6505039">uint32</span><span class="op" id="6505045">,</span>&nbsp;<span class="ident" id="6505047">n</span><span class="op" id="6505048">)</span><span class="op" id="6505049">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6505052">b</span><span class="op" id="6505053">.</span><span class="ident" id="6505054">ResetTimer</span><span class="op" id="6505064">(</span><span class="op" id="6505065">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6505068">for</span>&nbsp;<span class="ident" id="6505072">i</span>&nbsp;<span class="op" id="6505074">:=</span>&nbsp;<span class="num" id="6505077">0</span><span class="op" id="6505078">;</span>&nbsp;<span class="ident" id="6505080">i</span>&nbsp;<span class="op" id="6505082">&lt;</span>&nbsp;<span class="ident" id="6505084">b</span><span class="op" id="6505085">.</span><span class="ident" id="6505086">N</span><span class="op" id="6505087">;</span>&nbsp;<span class="ident" id="6505089">i</span><span class="op" id="6505090">++</span>&nbsp;<span class="op" id="6505093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6505097">expandKey</span><span class="op" id="6505106">(</span><span class="ident" id="6505107">tt</span><span class="op" id="6505109">.</span><span class="ident" id="6505110">key</span><span class="op" id="6505113">,</span>&nbsp;<span class="ident" id="6505115">c</span><span class="op" id="6505116">.</span><span class="ident" id="6505117">enc</span><span class="op" id="6505120">,</span>&nbsp;<span class="ident" id="6505122">c</span><span class="op" id="6505123">.</span><span class="ident" id="6505124">dec</span><span class="op" id="6505127">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6505130">}</span><br>
<span class="lineno"></span><span class="op" id="6505132">}</span>
</div>
</body>
</html>
