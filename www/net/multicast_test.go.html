<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7491282">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7491337">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7491391">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7491442">package</span>&nbsp;<span class="ident" id="7491450">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7491455">import</span>&nbsp;<span class="op" id="7491462">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7491465">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7491472">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7491478">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7491489">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="7491499">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7491502">var</span>&nbsp;<span class="ident" id="7491506">ipv4MulticastListenerTests</span>&nbsp;<span class="op" id="7491533">=</span>&nbsp;<span class="op" id="7491535">[</span><span class="op" id="7491536">]</span><span class="keyword" id="7491537">struct</span>&nbsp;<span class="op" id="7491544">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491547">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7491553">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491561">gaddr</span>&nbsp;<span class="op" id="7491567">*</span><span class="ident" id="7491568">UDPAddr</span>&nbsp;<span class="comment" id="7491576">//&nbsp;see&nbsp;RFC&nbsp;4727</span><br>
<span class="lineno"></span><span class="op" id="7491592">}</span><span class="op" id="7491593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7491596">{</span><span class="string" id="7491597">&#34;udp&#34;</span><span class="op" id="7491602">,</span>&nbsp;<span class="op" id="7491604">&amp;</span><span class="ident" id="7491605">UDPAddr</span><span class="op" id="7491612">{</span><span class="ident" id="7491613">IP</span><span class="op" id="7491615">:</span>&nbsp;<span class="ident" id="7491617">IPv4</span><span class="op" id="7491621">(</span><span class="num" id="7491622">224</span><span class="op" id="7491625">,</span>&nbsp;<span class="num" id="7491627">0</span><span class="op" id="7491628">,</span>&nbsp;<span class="num" id="7491630">0</span><span class="op" id="7491631">,</span>&nbsp;<span class="num" id="7491633">254</span><span class="op" id="7491636">)</span><span class="op" id="7491637">,</span>&nbsp;<span class="ident" id="7491639">Port</span><span class="op" id="7491643">:</span>&nbsp;<span class="num" id="7491645">12345</span><span class="op" id="7491650">}</span><span class="op" id="7491651">}</span><span class="op" id="7491652">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7491656">{</span><span class="string" id="7491657">&#34;udp4&#34;</span><span class="op" id="7491663">,</span>&nbsp;<span class="op" id="7491665">&amp;</span><span class="ident" id="7491666">UDPAddr</span><span class="op" id="7491673">{</span><span class="ident" id="7491674">IP</span><span class="op" id="7491676">:</span>&nbsp;<span class="ident" id="7491678">IPv4</span><span class="op" id="7491682">(</span><span class="num" id="7491683">224</span><span class="op" id="7491686">,</span>&nbsp;<span class="num" id="7491688">0</span><span class="op" id="7491689">,</span>&nbsp;<span class="num" id="7491691">0</span><span class="op" id="7491692">,</span>&nbsp;<span class="num" id="7491694">254</span><span class="op" id="7491697">)</span><span class="op" id="7491698">,</span>&nbsp;<span class="ident" id="7491700">Port</span><span class="op" id="7491704">:</span>&nbsp;<span class="num" id="7491706">12345</span><span class="op" id="7491711">}</span><span class="op" id="7491712">}</span><span class="op" id="7491713">,</span><br>
<span class="lineno"></span><span class="op" id="7491715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7491718">//&nbsp;TestIPv4MulticastListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="7491788">//&nbsp;test&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;group&nbsp;address&nbsp;and&nbsp;same</span><br>
<span class="lineno">25</span><span class="comment" id="7491859">//&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="7491868">func</span>&nbsp;<span class="ident" id="7491873">TestIPv4MulticastListener</span><span class="op" id="7491898">(</span><span class="ident" id="7491899">t</span>&nbsp;<span class="op" id="7491901">*</span><span class="ident" id="7491902">testing</span><span class="op" id="7491909">.</span><span class="ident" id="7491910">T</span><span class="op" id="7491911">)</span>&nbsp;<span class="op" id="7491913">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7491916">switch</span>&nbsp;<span class="ident" id="7491923">runtime</span><span class="op" id="7491930">.</span><span class="ident" id="7491931">GOOS</span>&nbsp;<span class="op" id="7491936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7491939">case</span>&nbsp;<span class="string" id="7491944">&#34;android&#34;</span><span class="op" id="7491953">,</span>&nbsp;<span class="string" id="7491955">&#34;nacl&#34;</span><span class="op" id="7491961">,</span>&nbsp;<span class="string" id="7491963">&#34;plan9&#34;</span><span class="op" id="7491970">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7491974">t</span><span class="op" id="7491975">.</span><span class="ident" id="7491976">Skipf</span><span class="op" id="7491981">(</span><span class="string" id="7491982">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7492003">,</span>&nbsp;<span class="ident" id="7492005">runtime</span><span class="op" id="7492012">.</span><span class="ident" id="7492013">GOOS</span><span class="op" id="7492017">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492020">case</span>&nbsp;<span class="string" id="7492025">&#34;solaris&#34;</span><span class="op" id="7492034">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492038">t</span><span class="op" id="7492039">.</span><span class="ident" id="7492040">Skipf</span><span class="op" id="7492045">(</span><span class="string" id="7492046">&#34;skipping&nbsp;test&nbsp;on&nbsp;solaris,&nbsp;see&nbsp;issue&nbsp;7399&#34;</span><span class="op" id="7492088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7492091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492095">closer</span>&nbsp;<span class="op" id="7492102">:=</span>&nbsp;<span class="keyword" id="7492105">func</span><span class="op" id="7492109">(</span><span class="ident" id="7492110">cs</span>&nbsp;<span class="op" id="7492113">[</span><span class="op" id="7492114">]</span><span class="op" id="7492115">*</span><span class="ident" id="7492116">UDPConn</span><span class="op" id="7492123">)</span>&nbsp;<span class="op" id="7492125">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492129">for</span>&nbsp;<span class="ident" id="7492133">_</span><span class="op" id="7492134">,</span>&nbsp;<span class="ident" id="7492136">c</span>&nbsp;<span class="op" id="7492138">:=</span>&nbsp;<span class="keyword" id="7492141">range</span>&nbsp;<span class="ident" id="7492147">cs</span>&nbsp;<span class="op" id="7492150">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492155">if</span>&nbsp;<span class="ident" id="7492158">c</span>&nbsp;<span class="op" id="7492160">!=</span>&nbsp;<span class="ident" id="7492163">nil</span>&nbsp;<span class="op" id="7492167">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492173">c</span><span class="op" id="7492174">.</span><span class="ident" id="7492175">Close</span><span class="op" id="7492180">(</span><span class="op" id="7492181">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7492186">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7492190">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7492193">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492197">for</span>&nbsp;<span class="ident" id="7492201">_</span><span class="op" id="7492202">,</span>&nbsp;<span class="ident" id="7492204">ifi</span>&nbsp;<span class="op" id="7492208">:=</span>&nbsp;<span class="keyword" id="7492211">range</span>&nbsp;<span class="op" id="7492217">[</span><span class="op" id="7492218">]</span><span class="op" id="7492219">*</span><span class="ident" id="7492220">Interface</span><span class="op" id="7492229">{</span><span class="ident" id="7492230">loopbackInterface</span><span class="op" id="7492247">(</span><span class="op" id="7492248">)</span><span class="op" id="7492249">,</span>&nbsp;<span class="ident" id="7492251">nil</span><span class="op" id="7492254">}</span>&nbsp;<span class="op" id="7492256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7492260">//&nbsp;Note&nbsp;that&nbsp;multicast&nbsp;interface&nbsp;assignment&nbsp;by&nbsp;system</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7492316">//&nbsp;is&nbsp;not&nbsp;recommended&nbsp;because&nbsp;it&nbsp;usually&nbsp;relies&nbsp;on</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7492369">//&nbsp;routing&nbsp;stuff&nbsp;for&nbsp;finding&nbsp;out&nbsp;an&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7492419">//&nbsp;nexthop&nbsp;containing&nbsp;both&nbsp;network&nbsp;and&nbsp;link&nbsp;layer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7492471">//&nbsp;adjacencies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492489">if</span>&nbsp;<span class="ident" id="7492492">ifi</span>&nbsp;<span class="op" id="7492496">==</span>&nbsp;<span class="ident" id="7492499">nil</span>&nbsp;<span class="op" id="7492503">&amp;&amp;</span>&nbsp;<span class="op" id="7492506">!</span><span class="op" id="7492507">*</span><span class="ident" id="7492508">testExternal</span>&nbsp;<span class="op" id="7492521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492526">continue</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7492537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492541">for</span>&nbsp;<span class="ident" id="7492545">_</span><span class="op" id="7492546">,</span>&nbsp;<span class="ident" id="7492548">tt</span>&nbsp;<span class="op" id="7492551">:=</span>&nbsp;<span class="keyword" id="7492554">range</span>&nbsp;<span class="ident" id="7492560">ipv4MulticastListenerTests</span>&nbsp;<span class="op" id="7492587">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492592">var</span>&nbsp;<span class="ident" id="7492596">err</span>&nbsp;<span class="builtintype" id="7492600">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492609">cs</span>&nbsp;<span class="op" id="7492612">:=</span>&nbsp;<span class="builtinfunc" id="7492615">make</span><span class="op" id="7492619">(</span><span class="op" id="7492620">[</span><span class="op" id="7492621">]</span><span class="op" id="7492622">*</span><span class="ident" id="7492623">UDPConn</span><span class="op" id="7492630">,</span>&nbsp;<span class="num" id="7492632">2</span><span class="op" id="7492633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492638">if</span>&nbsp;<span class="ident" id="7492641">cs</span><span class="op" id="7492643">[</span><span class="num" id="7492644">0</span><span class="op" id="7492645">]</span><span class="op" id="7492646">,</span>&nbsp;<span class="ident" id="7492648">err</span>&nbsp;<span class="op" id="7492652">=</span>&nbsp;<span class="ident" id="7492654">ListenMulticastUDP</span><span class="op" id="7492672">(</span><span class="ident" id="7492673">tt</span><span class="op" id="7492675">.</span><span class="ident" id="7492676">net</span><span class="op" id="7492679">,</span>&nbsp;<span class="ident" id="7492681">ifi</span><span class="op" id="7492684">,</span>&nbsp;<span class="ident" id="7492686">tt</span><span class="op" id="7492688">.</span><span class="ident" id="7492689">gaddr</span><span class="op" id="7492694">)</span><span class="op" id="7492695">;</span>&nbsp;<span class="ident" id="7492697">err</span>&nbsp;<span class="op" id="7492701">!=</span>&nbsp;<span class="ident" id="7492704">nil</span>&nbsp;<span class="op" id="7492708">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492714">t</span><span class="op" id="7492715">.</span><span class="ident" id="7492716">Fatalf</span><span class="op" id="7492722">(</span><span class="string" id="7492723">&#34;First&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7492766">,</span>&nbsp;<span class="ident" id="7492768">ifi</span><span class="op" id="7492771">,</span>&nbsp;<span class="ident" id="7492773">err</span><span class="op" id="7492776">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7492781">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492786">if</span>&nbsp;<span class="ident" id="7492789">err</span>&nbsp;<span class="op" id="7492793">:=</span>&nbsp;<span class="ident" id="7492796">checkMulticastListener</span><span class="op" id="7492818">(</span><span class="ident" id="7492819">cs</span><span class="op" id="7492821">[</span><span class="num" id="7492822">0</span><span class="op" id="7492823">]</span><span class="op" id="7492824">,</span>&nbsp;<span class="ident" id="7492826">tt</span><span class="op" id="7492828">.</span><span class="ident" id="7492829">gaddr</span><span class="op" id="7492834">.</span><span class="ident" id="7492835">IP</span><span class="op" id="7492837">)</span><span class="op" id="7492838">;</span>&nbsp;<span class="ident" id="7492840">err</span>&nbsp;<span class="op" id="7492844">!=</span>&nbsp;<span class="ident" id="7492847">nil</span>&nbsp;<span class="op" id="7492851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492857">closer</span><span class="op" id="7492863">(</span><span class="ident" id="7492864">cs</span><span class="op" id="7492866">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492872">t</span><span class="op" id="7492873">.</span><span class="ident" id="7492874">Fatal</span><span class="op" id="7492879">(</span><span class="ident" id="7492880">err</span><span class="op" id="7492883">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7492888">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7492893">if</span>&nbsp;<span class="ident" id="7492896">cs</span><span class="op" id="7492898">[</span><span class="num" id="7492899">1</span><span class="op" id="7492900">]</span><span class="op" id="7492901">,</span>&nbsp;<span class="ident" id="7492903">err</span>&nbsp;<span class="op" id="7492907">=</span>&nbsp;<span class="ident" id="7492909">ListenMulticastUDP</span><span class="op" id="7492927">(</span><span class="ident" id="7492928">tt</span><span class="op" id="7492930">.</span><span class="ident" id="7492931">net</span><span class="op" id="7492934">,</span>&nbsp;<span class="ident" id="7492936">ifi</span><span class="op" id="7492939">,</span>&nbsp;<span class="ident" id="7492941">tt</span><span class="op" id="7492943">.</span><span class="ident" id="7492944">gaddr</span><span class="op" id="7492949">)</span><span class="op" id="7492950">;</span>&nbsp;<span class="ident" id="7492952">err</span>&nbsp;<span class="op" id="7492956">!=</span>&nbsp;<span class="ident" id="7492959">nil</span>&nbsp;<span class="op" id="7492963">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492969">closer</span><span class="op" id="7492975">(</span><span class="ident" id="7492976">cs</span><span class="op" id="7492978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7492984">t</span><span class="op" id="7492985">.</span><span class="ident" id="7492986">Fatalf</span><span class="op" id="7492992">(</span><span class="string" id="7492993">&#34;Second&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7493037">,</span>&nbsp;<span class="ident" id="7493039">ifi</span><span class="op" id="7493042">,</span>&nbsp;<span class="ident" id="7493044">err</span><span class="op" id="7493047">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493052">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7493057">if</span>&nbsp;<span class="ident" id="7493060">err</span>&nbsp;<span class="op" id="7493064">:=</span>&nbsp;<span class="ident" id="7493067">checkMulticastListener</span><span class="op" id="7493089">(</span><span class="ident" id="7493090">cs</span><span class="op" id="7493092">[</span><span class="num" id="7493093">1</span><span class="op" id="7493094">]</span><span class="op" id="7493095">,</span>&nbsp;<span class="ident" id="7493097">tt</span><span class="op" id="7493099">.</span><span class="ident" id="7493100">gaddr</span><span class="op" id="7493105">.</span><span class="ident" id="7493106">IP</span><span class="op" id="7493108">)</span><span class="op" id="7493109">;</span>&nbsp;<span class="ident" id="7493111">err</span>&nbsp;<span class="op" id="7493115">!=</span>&nbsp;<span class="ident" id="7493118">nil</span>&nbsp;<span class="op" id="7493122">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7493128">closer</span><span class="op" id="7493134">(</span><span class="ident" id="7493135">cs</span><span class="op" id="7493137">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7493143">t</span><span class="op" id="7493144">.</span><span class="ident" id="7493145">Fatal</span><span class="op" id="7493150">(</span><span class="ident" id="7493151">err</span><span class="op" id="7493154">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493159">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7493164">closer</span><span class="op" id="7493170">(</span><span class="ident" id="7493171">cs</span><span class="op" id="7493173">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493177">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493180">}</span><br>
<span class="lineno"></span><span class="op" id="7493182">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7493185">var</span>&nbsp;<span class="ident" id="7493189">ipv6MulticastListenerTests</span>&nbsp;<span class="op" id="7493216">=</span>&nbsp;<span class="op" id="7493218">[</span><span class="op" id="7493219">]</span><span class="keyword" id="7493220">struct</span>&nbsp;<span class="op" id="7493227">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7493230">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7493236">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7493244">gaddr</span>&nbsp;<span class="op" id="7493250">*</span><span class="ident" id="7493251">UDPAddr</span>&nbsp;<span class="comment" id="7493259">//&nbsp;see&nbsp;RFC&nbsp;4727</span><br>
<span class="lineno"></span><span class="op" id="7493275">}</span><span class="op" id="7493276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493279">{</span><span class="string" id="7493280">&#34;udp&#34;</span><span class="op" id="7493285">,</span>&nbsp;<span class="op" id="7493287">&amp;</span><span class="ident" id="7493288">UDPAddr</span><span class="op" id="7493295">{</span><span class="ident" id="7493296">IP</span><span class="op" id="7493298">:</span>&nbsp;<span class="ident" id="7493300">ParseIP</span><span class="op" id="7493307">(</span><span class="string" id="7493308">&#34;ff01::114&#34;</span><span class="op" id="7493319">)</span><span class="op" id="7493320">,</span>&nbsp;<span class="ident" id="7493322">Port</span><span class="op" id="7493326">:</span>&nbsp;<span class="num" id="7493328">12345</span><span class="op" id="7493333">}</span><span class="op" id="7493334">}</span><span class="op" id="7493335">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493338">{</span><span class="string" id="7493339">&#34;udp&#34;</span><span class="op" id="7493344">,</span>&nbsp;<span class="op" id="7493346">&amp;</span><span class="ident" id="7493347">UDPAddr</span><span class="op" id="7493354">{</span><span class="ident" id="7493355">IP</span><span class="op" id="7493357">:</span>&nbsp;<span class="ident" id="7493359">ParseIP</span><span class="op" id="7493366">(</span><span class="string" id="7493367">&#34;ff02::114&#34;</span><span class="op" id="7493378">)</span><span class="op" id="7493379">,</span>&nbsp;<span class="ident" id="7493381">Port</span><span class="op" id="7493385">:</span>&nbsp;<span class="num" id="7493387">12345</span><span class="op" id="7493392">}</span><span class="op" id="7493393">}</span><span class="op" id="7493394">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493397">{</span><span class="string" id="7493398">&#34;udp&#34;</span><span class="op" id="7493403">,</span>&nbsp;<span class="op" id="7493405">&amp;</span><span class="ident" id="7493406">UDPAddr</span><span class="op" id="7493413">{</span><span class="ident" id="7493414">IP</span><span class="op" id="7493416">:</span>&nbsp;<span class="ident" id="7493418">ParseIP</span><span class="op" id="7493425">(</span><span class="string" id="7493426">&#34;ff04::114&#34;</span><span class="op" id="7493437">)</span><span class="op" id="7493438">,</span>&nbsp;<span class="ident" id="7493440">Port</span><span class="op" id="7493444">:</span>&nbsp;<span class="num" id="7493446">12345</span><span class="op" id="7493451">}</span><span class="op" id="7493452">}</span><span class="op" id="7493453">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493456">{</span><span class="string" id="7493457">&#34;udp&#34;</span><span class="op" id="7493462">,</span>&nbsp;<span class="op" id="7493464">&amp;</span><span class="ident" id="7493465">UDPAddr</span><span class="op" id="7493472">{</span><span class="ident" id="7493473">IP</span><span class="op" id="7493475">:</span>&nbsp;<span class="ident" id="7493477">ParseIP</span><span class="op" id="7493484">(</span><span class="string" id="7493485">&#34;ff05::114&#34;</span><span class="op" id="7493496">)</span><span class="op" id="7493497">,</span>&nbsp;<span class="ident" id="7493499">Port</span><span class="op" id="7493503">:</span>&nbsp;<span class="num" id="7493505">12345</span><span class="op" id="7493510">}</span><span class="op" id="7493511">}</span><span class="op" id="7493512">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493515">{</span><span class="string" id="7493516">&#34;udp&#34;</span><span class="op" id="7493521">,</span>&nbsp;<span class="op" id="7493523">&amp;</span><span class="ident" id="7493524">UDPAddr</span><span class="op" id="7493531">{</span><span class="ident" id="7493532">IP</span><span class="op" id="7493534">:</span>&nbsp;<span class="ident" id="7493536">ParseIP</span><span class="op" id="7493543">(</span><span class="string" id="7493544">&#34;ff08::114&#34;</span><span class="op" id="7493555">)</span><span class="op" id="7493556">,</span>&nbsp;<span class="ident" id="7493558">Port</span><span class="op" id="7493562">:</span>&nbsp;<span class="num" id="7493564">12345</span><span class="op" id="7493569">}</span><span class="op" id="7493570">}</span><span class="op" id="7493571">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493574">{</span><span class="string" id="7493575">&#34;udp&#34;</span><span class="op" id="7493580">,</span>&nbsp;<span class="op" id="7493582">&amp;</span><span class="ident" id="7493583">UDPAddr</span><span class="op" id="7493590">{</span><span class="ident" id="7493591">IP</span><span class="op" id="7493593">:</span>&nbsp;<span class="ident" id="7493595">ParseIP</span><span class="op" id="7493602">(</span><span class="string" id="7493603">&#34;ff0e::114&#34;</span><span class="op" id="7493614">)</span><span class="op" id="7493615">,</span>&nbsp;<span class="ident" id="7493617">Port</span><span class="op" id="7493621">:</span>&nbsp;<span class="num" id="7493623">12345</span><span class="op" id="7493628">}</span><span class="op" id="7493629">}</span><span class="op" id="7493630">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493634">{</span><span class="string" id="7493635">&#34;udp6&#34;</span><span class="op" id="7493641">,</span>&nbsp;<span class="op" id="7493643">&amp;</span><span class="ident" id="7493644">UDPAddr</span><span class="op" id="7493651">{</span><span class="ident" id="7493652">IP</span><span class="op" id="7493654">:</span>&nbsp;<span class="ident" id="7493656">ParseIP</span><span class="op" id="7493663">(</span><span class="string" id="7493664">&#34;ff01::114&#34;</span><span class="op" id="7493675">)</span><span class="op" id="7493676">,</span>&nbsp;<span class="ident" id="7493678">Port</span><span class="op" id="7493682">:</span>&nbsp;<span class="num" id="7493684">12345</span><span class="op" id="7493689">}</span><span class="op" id="7493690">}</span><span class="op" id="7493691">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493694">{</span><span class="string" id="7493695">&#34;udp6&#34;</span><span class="op" id="7493701">,</span>&nbsp;<span class="op" id="7493703">&amp;</span><span class="ident" id="7493704">UDPAddr</span><span class="op" id="7493711">{</span><span class="ident" id="7493712">IP</span><span class="op" id="7493714">:</span>&nbsp;<span class="ident" id="7493716">ParseIP</span><span class="op" id="7493723">(</span><span class="string" id="7493724">&#34;ff02::114&#34;</span><span class="op" id="7493735">)</span><span class="op" id="7493736">,</span>&nbsp;<span class="ident" id="7493738">Port</span><span class="op" id="7493742">:</span>&nbsp;<span class="num" id="7493744">12345</span><span class="op" id="7493749">}</span><span class="op" id="7493750">}</span><span class="op" id="7493751">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493754">{</span><span class="string" id="7493755">&#34;udp6&#34;</span><span class="op" id="7493761">,</span>&nbsp;<span class="op" id="7493763">&amp;</span><span class="ident" id="7493764">UDPAddr</span><span class="op" id="7493771">{</span><span class="ident" id="7493772">IP</span><span class="op" id="7493774">:</span>&nbsp;<span class="ident" id="7493776">ParseIP</span><span class="op" id="7493783">(</span><span class="string" id="7493784">&#34;ff04::114&#34;</span><span class="op" id="7493795">)</span><span class="op" id="7493796">,</span>&nbsp;<span class="ident" id="7493798">Port</span><span class="op" id="7493802">:</span>&nbsp;<span class="num" id="7493804">12345</span><span class="op" id="7493809">}</span><span class="op" id="7493810">}</span><span class="op" id="7493811">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493814">{</span><span class="string" id="7493815">&#34;udp6&#34;</span><span class="op" id="7493821">,</span>&nbsp;<span class="op" id="7493823">&amp;</span><span class="ident" id="7493824">UDPAddr</span><span class="op" id="7493831">{</span><span class="ident" id="7493832">IP</span><span class="op" id="7493834">:</span>&nbsp;<span class="ident" id="7493836">ParseIP</span><span class="op" id="7493843">(</span><span class="string" id="7493844">&#34;ff05::114&#34;</span><span class="op" id="7493855">)</span><span class="op" id="7493856">,</span>&nbsp;<span class="ident" id="7493858">Port</span><span class="op" id="7493862">:</span>&nbsp;<span class="num" id="7493864">12345</span><span class="op" id="7493869">}</span><span class="op" id="7493870">}</span><span class="op" id="7493871">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493874">{</span><span class="string" id="7493875">&#34;udp6&#34;</span><span class="op" id="7493881">,</span>&nbsp;<span class="op" id="7493883">&amp;</span><span class="ident" id="7493884">UDPAddr</span><span class="op" id="7493891">{</span><span class="ident" id="7493892">IP</span><span class="op" id="7493894">:</span>&nbsp;<span class="ident" id="7493896">ParseIP</span><span class="op" id="7493903">(</span><span class="string" id="7493904">&#34;ff08::114&#34;</span><span class="op" id="7493915">)</span><span class="op" id="7493916">,</span>&nbsp;<span class="ident" id="7493918">Port</span><span class="op" id="7493922">:</span>&nbsp;<span class="num" id="7493924">12345</span><span class="op" id="7493929">}</span><span class="op" id="7493930">}</span><span class="op" id="7493931">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7493934">{</span><span class="string" id="7493935">&#34;udp6&#34;</span><span class="op" id="7493941">,</span>&nbsp;<span class="op" id="7493943">&amp;</span><span class="ident" id="7493944">UDPAddr</span><span class="op" id="7493951">{</span><span class="ident" id="7493952">IP</span><span class="op" id="7493954">:</span>&nbsp;<span class="ident" id="7493956">ParseIP</span><span class="op" id="7493963">(</span><span class="string" id="7493964">&#34;ff0e::114&#34;</span><span class="op" id="7493975">)</span><span class="op" id="7493976">,</span>&nbsp;<span class="ident" id="7493978">Port</span><span class="op" id="7493982">:</span>&nbsp;<span class="num" id="7493984">12345</span><span class="op" id="7493989">}</span><span class="op" id="7493990">}</span><span class="op" id="7493991">,</span><br>
<span class="lineno"></span><span class="op" id="7493993">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="7493996">//&nbsp;TestIPv6MulticastListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="7494066">//&nbsp;test&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;group&nbsp;address&nbsp;and&nbsp;same</span><br>
<span class="lineno">95</span><span class="comment" id="7494137">//&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="7494146">func</span>&nbsp;<span class="ident" id="7494151">TestIPv6MulticastListener</span><span class="op" id="7494176">(</span><span class="ident" id="7494177">t</span>&nbsp;<span class="op" id="7494179">*</span><span class="ident" id="7494180">testing</span><span class="op" id="7494187">.</span><span class="ident" id="7494188">T</span><span class="op" id="7494189">)</span>&nbsp;<span class="op" id="7494191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494194">switch</span>&nbsp;<span class="ident" id="7494201">runtime</span><span class="op" id="7494208">.</span><span class="ident" id="7494209">GOOS</span>&nbsp;<span class="op" id="7494214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494217">case</span>&nbsp;<span class="string" id="7494222">&#34;plan9&#34;</span><span class="op" id="7494229">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7494233">t</span><span class="op" id="7494234">.</span><span class="ident" id="7494235">Skipf</span><span class="op" id="7494240">(</span><span class="string" id="7494241">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="7494262">,</span>&nbsp;<span class="ident" id="7494264">runtime</span><span class="op" id="7494271">.</span><span class="ident" id="7494272">GOOS</span><span class="op" id="7494276">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494279">case</span>&nbsp;<span class="string" id="7494284">&#34;solaris&#34;</span><span class="op" id="7494293">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7494297">t</span><span class="op" id="7494298">.</span><span class="ident" id="7494299">Skipf</span><span class="op" id="7494304">(</span><span class="string" id="7494305">&#34;skipping&nbsp;test&nbsp;on&nbsp;solaris,&nbsp;see&nbsp;issue&nbsp;7399&#34;</span><span class="op" id="7494347">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7494350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494353">if</span>&nbsp;<span class="op" id="7494356">!</span><span class="ident" id="7494357">supportsIPv6</span>&nbsp;<span class="op" id="7494370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7494374">t</span><span class="op" id="7494375">.</span><span class="ident" id="7494376">Skip</span><span class="op" id="7494380">(</span><span class="string" id="7494381">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="7494404">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7494407">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494410">if</span>&nbsp;<span class="ident" id="7494413">os</span><span class="op" id="7494415">.</span><span class="ident" id="7494416">Getuid</span><span class="op" id="7494422">(</span><span class="op" id="7494423">)</span>&nbsp;<span class="op" id="7494425">!=</span>&nbsp;<span class="num" id="7494428">0</span>&nbsp;<span class="op" id="7494430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7494434">t</span><span class="op" id="7494435">.</span><span class="ident" id="7494436">Skip</span><span class="op" id="7494440">(</span><span class="string" id="7494441">&#34;skipping&nbsp;test;&nbsp;must&nbsp;be&nbsp;root&#34;</span><span class="op" id="7494470">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7494473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7494477">closer</span>&nbsp;<span class="op" id="7494484">:=</span>&nbsp;<span class="keyword" id="7494487">func</span><span class="op" id="7494491">(</span><span class="ident" id="7494492">cs</span>&nbsp;<span class="op" id="7494495">[</span><span class="op" id="7494496">]</span><span class="op" id="7494497">*</span><span class="ident" id="7494498">UDPConn</span><span class="op" id="7494505">)</span>&nbsp;<span class="op" id="7494507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494511">for</span>&nbsp;<span class="ident" id="7494515">_</span><span class="op" id="7494516">,</span>&nbsp;<span class="ident" id="7494518">c</span>&nbsp;<span class="op" id="7494520">:=</span>&nbsp;<span class="keyword" id="7494523">range</span>&nbsp;<span class="ident" id="7494529">cs</span>&nbsp;<span class="op" id="7494532">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494537">if</span>&nbsp;<span class="ident" id="7494540">c</span>&nbsp;<span class="op" id="7494542">!=</span>&nbsp;<span class="ident" id="7494545">nil</span>&nbsp;<span class="op" id="7494549">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7494555">c</span><span class="op" id="7494556">.</span><span class="ident" id="7494557">Close</span><span class="op" id="7494562">(</span><span class="op" id="7494563">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7494568">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7494572">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7494575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494579">for</span>&nbsp;<span class="ident" id="7494583">_</span><span class="op" id="7494584">,</span>&nbsp;<span class="ident" id="7494586">ifi</span>&nbsp;<span class="op" id="7494590">:=</span>&nbsp;<span class="keyword" id="7494593">range</span>&nbsp;<span class="op" id="7494599">[</span><span class="op" id="7494600">]</span><span class="op" id="7494601">*</span><span class="ident" id="7494602">Interface</span><span class="op" id="7494611">{</span><span class="ident" id="7494612">loopbackInterface</span><span class="op" id="7494629">(</span><span class="op" id="7494630">)</span><span class="op" id="7494631">,</span>&nbsp;<span class="ident" id="7494633">nil</span><span class="op" id="7494636">}</span>&nbsp;<span class="op" id="7494638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7494642">//&nbsp;Note&nbsp;that&nbsp;multicast&nbsp;interface&nbsp;assignment&nbsp;by&nbsp;system</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7494698">//&nbsp;is&nbsp;not&nbsp;recommended&nbsp;because&nbsp;it&nbsp;usually&nbsp;relies&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7494751">//&nbsp;routing&nbsp;stuff&nbsp;for&nbsp;finding&nbsp;out&nbsp;an&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7494801">//&nbsp;nexthop&nbsp;containing&nbsp;both&nbsp;network&nbsp;and&nbsp;link&nbsp;layer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7494853">//&nbsp;adjacencies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494871">if</span>&nbsp;<span class="ident" id="7494874">ifi</span>&nbsp;<span class="op" id="7494878">==</span>&nbsp;<span class="ident" id="7494881">nil</span>&nbsp;<span class="op" id="7494885">&amp;&amp;</span>&nbsp;<span class="op" id="7494888">(</span><span class="op" id="7494889">!</span><span class="op" id="7494890">*</span><span class="ident" id="7494891">testExternal</span>&nbsp;<span class="op" id="7494904">||</span>&nbsp;<span class="op" id="7494907">!</span><span class="op" id="7494908">*</span><span class="ident" id="7494909">testIPv6</span><span class="op" id="7494917">)</span>&nbsp;<span class="op" id="7494919">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494924">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7494935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494939">for</span>&nbsp;<span class="ident" id="7494943">_</span><span class="op" id="7494944">,</span>&nbsp;<span class="ident" id="7494946">tt</span>&nbsp;<span class="op" id="7494949">:=</span>&nbsp;<span class="keyword" id="7494952">range</span>&nbsp;<span class="ident" id="7494958">ipv6MulticastListenerTests</span>&nbsp;<span class="op" id="7494985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7494990">var</span>&nbsp;<span class="ident" id="7494994">err</span>&nbsp;<span class="builtintype" id="7494998">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495007">cs</span>&nbsp;<span class="op" id="7495010">:=</span>&nbsp;<span class="builtinfunc" id="7495013">make</span><span class="op" id="7495017">(</span><span class="op" id="7495018">[</span><span class="op" id="7495019">]</span><span class="op" id="7495020">*</span><span class="ident" id="7495021">UDPConn</span><span class="op" id="7495028">,</span>&nbsp;<span class="num" id="7495030">2</span><span class="op" id="7495031">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495036">if</span>&nbsp;<span class="ident" id="7495039">cs</span><span class="op" id="7495041">[</span><span class="num" id="7495042">0</span><span class="op" id="7495043">]</span><span class="op" id="7495044">,</span>&nbsp;<span class="ident" id="7495046">err</span>&nbsp;<span class="op" id="7495050">=</span>&nbsp;<span class="ident" id="7495052">ListenMulticastUDP</span><span class="op" id="7495070">(</span><span class="ident" id="7495071">tt</span><span class="op" id="7495073">.</span><span class="ident" id="7495074">net</span><span class="op" id="7495077">,</span>&nbsp;<span class="ident" id="7495079">ifi</span><span class="op" id="7495082">,</span>&nbsp;<span class="ident" id="7495084">tt</span><span class="op" id="7495086">.</span><span class="ident" id="7495087">gaddr</span><span class="op" id="7495092">)</span><span class="op" id="7495093">;</span>&nbsp;<span class="ident" id="7495095">err</span>&nbsp;<span class="op" id="7495099">!=</span>&nbsp;<span class="ident" id="7495102">nil</span>&nbsp;<span class="op" id="7495106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495112">t</span><span class="op" id="7495113">.</span><span class="ident" id="7495114">Fatalf</span><span class="op" id="7495120">(</span><span class="string" id="7495121">&#34;First&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7495164">,</span>&nbsp;<span class="ident" id="7495166">ifi</span><span class="op" id="7495169">,</span>&nbsp;<span class="ident" id="7495171">err</span><span class="op" id="7495174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7495179">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495184">if</span>&nbsp;<span class="ident" id="7495187">err</span>&nbsp;<span class="op" id="7495191">:=</span>&nbsp;<span class="ident" id="7495194">checkMulticastListener</span><span class="op" id="7495216">(</span><span class="ident" id="7495217">cs</span><span class="op" id="7495219">[</span><span class="num" id="7495220">0</span><span class="op" id="7495221">]</span><span class="op" id="7495222">,</span>&nbsp;<span class="ident" id="7495224">tt</span><span class="op" id="7495226">.</span><span class="ident" id="7495227">gaddr</span><span class="op" id="7495232">.</span><span class="ident" id="7495233">IP</span><span class="op" id="7495235">)</span><span class="op" id="7495236">;</span>&nbsp;<span class="ident" id="7495238">err</span>&nbsp;<span class="op" id="7495242">!=</span>&nbsp;<span class="ident" id="7495245">nil</span>&nbsp;<span class="op" id="7495249">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495255">closer</span><span class="op" id="7495261">(</span><span class="ident" id="7495262">cs</span><span class="op" id="7495264">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495270">t</span><span class="op" id="7495271">.</span><span class="ident" id="7495272">Fatal</span><span class="op" id="7495277">(</span><span class="ident" id="7495278">err</span><span class="op" id="7495281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7495286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495291">if</span>&nbsp;<span class="ident" id="7495294">cs</span><span class="op" id="7495296">[</span><span class="num" id="7495297">1</span><span class="op" id="7495298">]</span><span class="op" id="7495299">,</span>&nbsp;<span class="ident" id="7495301">err</span>&nbsp;<span class="op" id="7495305">=</span>&nbsp;<span class="ident" id="7495307">ListenMulticastUDP</span><span class="op" id="7495325">(</span><span class="ident" id="7495326">tt</span><span class="op" id="7495328">.</span><span class="ident" id="7495329">net</span><span class="op" id="7495332">,</span>&nbsp;<span class="ident" id="7495334">ifi</span><span class="op" id="7495337">,</span>&nbsp;<span class="ident" id="7495339">tt</span><span class="op" id="7495341">.</span><span class="ident" id="7495342">gaddr</span><span class="op" id="7495347">)</span><span class="op" id="7495348">;</span>&nbsp;<span class="ident" id="7495350">err</span>&nbsp;<span class="op" id="7495354">!=</span>&nbsp;<span class="ident" id="7495357">nil</span>&nbsp;<span class="op" id="7495361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495367">closer</span><span class="op" id="7495373">(</span><span class="ident" id="7495374">cs</span><span class="op" id="7495376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495382">t</span><span class="op" id="7495383">.</span><span class="ident" id="7495384">Fatalf</span><span class="op" id="7495390">(</span><span class="string" id="7495391">&#34;Second&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="7495435">,</span>&nbsp;<span class="ident" id="7495437">ifi</span><span class="op" id="7495440">,</span>&nbsp;<span class="ident" id="7495442">err</span><span class="op" id="7495445">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7495450">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495455">if</span>&nbsp;<span class="ident" id="7495458">err</span>&nbsp;<span class="op" id="7495462">:=</span>&nbsp;<span class="ident" id="7495465">checkMulticastListener</span><span class="op" id="7495487">(</span><span class="ident" id="7495488">cs</span><span class="op" id="7495490">[</span><span class="num" id="7495491">1</span><span class="op" id="7495492">]</span><span class="op" id="7495493">,</span>&nbsp;<span class="ident" id="7495495">tt</span><span class="op" id="7495497">.</span><span class="ident" id="7495498">gaddr</span><span class="op" id="7495503">.</span><span class="ident" id="7495504">IP</span><span class="op" id="7495506">)</span><span class="op" id="7495507">;</span>&nbsp;<span class="ident" id="7495509">err</span>&nbsp;<span class="op" id="7495513">!=</span>&nbsp;<span class="ident" id="7495516">nil</span>&nbsp;<span class="op" id="7495520">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495526">closer</span><span class="op" id="7495532">(</span><span class="ident" id="7495533">cs</span><span class="op" id="7495535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495541">t</span><span class="op" id="7495542">.</span><span class="ident" id="7495543">Fatal</span><span class="op" id="7495548">(</span><span class="ident" id="7495549">err</span><span class="op" id="7495552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7495557">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495562">closer</span><span class="op" id="7495568">(</span><span class="ident" id="7495569">cs</span><span class="op" id="7495571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7495575">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7495578">}</span><br>
<span class="lineno"></span><span class="op" id="7495580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="7495583">func</span>&nbsp;<span class="ident" id="7495588">checkMulticastListener</span><span class="op" id="7495610">(</span><span class="ident" id="7495611">c</span>&nbsp;<span class="op" id="7495613">*</span><span class="ident" id="7495614">UDPConn</span><span class="op" id="7495621">,</span>&nbsp;<span class="ident" id="7495623">ip</span>&nbsp;<span class="ident" id="7495626">IP</span><span class="op" id="7495628">)</span>&nbsp;<span class="builtintype" id="7495630">error</span>&nbsp;<span class="op" id="7495636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495639">if</span>&nbsp;<span class="ident" id="7495642">ok</span><span class="op" id="7495644">,</span>&nbsp;<span class="ident" id="7495646">err</span>&nbsp;<span class="op" id="7495650">:=</span>&nbsp;<span class="ident" id="7495653">multicastRIBContains</span><span class="op" id="7495673">(</span><span class="ident" id="7495674">ip</span><span class="op" id="7495676">)</span><span class="op" id="7495677">;</span>&nbsp;<span class="ident" id="7495679">err</span>&nbsp;<span class="op" id="7495683">!=</span>&nbsp;<span class="ident" id="7495686">nil</span>&nbsp;<span class="op" id="7495690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495694">return</span>&nbsp;<span class="ident" id="7495701">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7495706">}</span>&nbsp;<span class="keyword" id="7495708">else</span>&nbsp;<span class="keyword" id="7495713">if</span>&nbsp;<span class="op" id="7495716">!</span><span class="ident" id="7495717">ok</span>&nbsp;<span class="op" id="7495720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495724">return</span>&nbsp;<span class="ident" id="7495731">fmt</span><span class="op" id="7495734">.</span><span class="ident" id="7495735">Errorf</span><span class="op" id="7495741">(</span><span class="string" id="7495742">&#34;%q&nbsp;not&nbsp;found&nbsp;in&nbsp;multicast&nbsp;RIB&#34;</span><span class="op" id="7495773">,</span>&nbsp;<span class="ident" id="7495775">ip</span><span class="op" id="7495777">.</span><span class="ident" id="7495778">String</span><span class="op" id="7495784">(</span><span class="op" id="7495785">)</span><span class="op" id="7495786">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7495789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7495792">la</span>&nbsp;<span class="op" id="7495795">:=</span>&nbsp;<span class="ident" id="7495798">c</span><span class="op" id="7495799">.</span><span class="ident" id="7495800">LocalAddr</span><span class="op" id="7495809">(</span><span class="op" id="7495810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495813">if</span>&nbsp;<span class="ident" id="7495816">la</span><span class="op" id="7495818">,</span>&nbsp;<span class="ident" id="7495820">ok</span>&nbsp;<span class="op" id="7495823">:=</span>&nbsp;<span class="ident" id="7495826">la</span><span class="op" id="7495828">.</span><span class="op" id="7495829">(</span><span class="op" id="7495830">*</span><span class="ident" id="7495831">UDPAddr</span><span class="op" id="7495838">)</span><span class="op" id="7495839">;</span>&nbsp;<span class="op" id="7495841">!</span><span class="ident" id="7495842">ok</span>&nbsp;<span class="op" id="7495845">||</span>&nbsp;<span class="ident" id="7495848">la</span><span class="op" id="7495850">.</span><span class="ident" id="7495851">Port</span>&nbsp;<span class="op" id="7495856">==</span>&nbsp;<span class="num" id="7495859">0</span>&nbsp;<span class="op" id="7495861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495865">return</span>&nbsp;<span class="ident" id="7495872">fmt</span><span class="op" id="7495875">.</span><span class="ident" id="7495876">Errorf</span><span class="op" id="7495882">(</span><span class="string" id="7495883">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="7495944">,</span>&nbsp;<span class="ident" id="7495946">la</span><span class="op" id="7495948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7495951">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7495954">return</span>&nbsp;<span class="ident" id="7495961">nil</span><br>
<span class="lineno"></span><span class="op" id="7495965">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7495968">func</span>&nbsp;<span class="ident" id="7495973">multicastRIBContains</span><span class="op" id="7495993">(</span><span class="ident" id="7495994">ip</span>&nbsp;<span class="ident" id="7495997">IP</span><span class="op" id="7495999">)</span>&nbsp;<span class="op" id="7496001">(</span><span class="builtintype" id="7496002">bool</span><span class="op" id="7496006">,</span>&nbsp;<span class="builtintype" id="7496008">error</span><span class="op" id="7496013">)</span>&nbsp;<span class="op" id="7496015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7496018">switch</span>&nbsp;<span class="ident" id="7496025">runtime</span><span class="op" id="7496032">.</span><span class="ident" id="7496033">GOOS</span>&nbsp;<span class="op" id="7496038">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7496041">case</span>&nbsp;<span class="string" id="7496046">&#34;dragonfly&#34;</span><span class="op" id="7496057">,</span>&nbsp;<span class="string" id="7496059">&#34;netbsd&#34;</span><span class="op" id="7496067">,</span>&nbsp;<span class="string" id="7496069">&#34;openbsd&#34;</span><span class="op" id="7496078">,</span>&nbsp;<span class="string" id="7496080">&#34;plan9&#34;</span><span class="op" id="7496087">,</span>&nbsp;<span class="string" id="7496089">&#34;solaris&#34;</span><span class="op" id="7496098">,</span>&nbsp;<span class="string" id="7496100">&#34;windows&#34;</span><span class="op" id="7496109">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7496113">return</span>&nbsp;<span class="ident" id="7496120">true</span><span class="op" id="7496124">,</span>&nbsp;<span class="ident" id="7496126">nil</span>&nbsp;<span class="comment" id="7496130">//&nbsp;not&nbsp;implemented&nbsp;yet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7496154">case</span>&nbsp;<span class="string" id="7496159">&#34;linux&#34;</span><span class="op" id="7496166">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7496170">if</span>&nbsp;<span class="ident" id="7496173">runtime</span><span class="op" id="7496180">.</span><span class="ident" id="7496181">GOARCH</span>&nbsp;<span class="op" id="7496188">==</span>&nbsp;<span class="string" id="7496191">&#34;arm&#34;</span>&nbsp;<span class="op" id="7496197">||</span>&nbsp;<span class="ident" id="7496200">runtime</span><span class="op" id="7496207">.</span><span class="ident" id="7496208">GOARCH</span>&nbsp;<span class="op" id="7496215">==</span>&nbsp;<span class="string" id="7496218">&#34;alpha&#34;</span>&nbsp;<span class="op" id="7496226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7496231">return</span>&nbsp;<span class="ident" id="7496238">true</span><span class="op" id="7496242">,</span>&nbsp;<span class="ident" id="7496244">nil</span>&nbsp;<span class="comment" id="7496248">//&nbsp;not&nbsp;implemented&nbsp;yet</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7496273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7496276">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7496279">ift</span><span class="op" id="7496282">,</span>&nbsp;<span class="ident" id="7496284">err</span>&nbsp;<span class="op" id="7496288">:=</span>&nbsp;<span class="ident" id="7496291">Interfaces</span><span class="op" id="7496301">(</span><span class="op" id="7496302">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7496305">if</span>&nbsp;<span class="ident" id="7496308">err</span>&nbsp;<span class="op" id="7496312">!=</span>&nbsp;<span class="ident" id="7496315">nil</span>&nbsp;<span class="op" id="7496319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7496323">return</span>&nbsp;<span class="ident" id="7496330">false</span><span class="op" id="7496335">,</span>&nbsp;<span class="ident" id="7496337">err</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7496342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7496345">for</span>&nbsp;<span class="ident" id="7496349">_</span><span class="op" id="7496350">,</span>&nbsp;<span class="ident" id="7496352">ifi</span>&nbsp;<span class="op" id="7496356">:=</span>&nbsp;<span class="keyword" id="7496359">range</span>&nbsp;<span class="ident" id="7496365">ift</span>&nbsp;<span class="op" id="7496369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7496373">ifmat</span><span class="op" id="7496378">,</span>&nbsp;<span class="ident" id="7496380">err</span>&nbsp;<span class="op" id="7496384">:=</span>&nbsp;<span class="ident" id="7496387">ifi</span><span class="op" id="7496390">.</span><span class="ident" id="7496391">MulticastAddrs</span><span class="op" id="7496405">(</span><span class="op" id="7496406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7496410">if</span>&nbsp;<span class="ident" id="7496413">err</span>&nbsp;<span class="op" id="7496417">!=</span>&nbsp;<span class="ident" id="7496420">nil</span>&nbsp;<span class="op" id="7496424">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7496429">return</span>&nbsp;<span class="ident" id="7496436">false</span><span class="op" id="7496441">,</span>&nbsp;<span class="ident" id="7496443">err</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7496449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7496453">for</span>&nbsp;<span class="ident" id="7496457">_</span><span class="op" id="7496458">,</span>&nbsp;<span class="ident" id="7496460">ifma</span>&nbsp;<span class="op" id="7496465">:=</span>&nbsp;<span class="keyword" id="7496468">range</span>&nbsp;<span class="ident" id="7496474">ifmat</span>&nbsp;<span class="op" id="7496480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7496485">if</span>&nbsp;<span class="ident" id="7496488">ifma</span><span class="op" id="7496492">.</span><span class="op" id="7496493">(</span><span class="op" id="7496494">*</span><span class="ident" id="7496495">IPAddr</span><span class="op" id="7496501">)</span><span class="op" id="7496502">.</span><span class="ident" id="7496503">IP</span><span class="op" id="7496505">.</span><span class="ident" id="7496506">Equal</span><span class="op" id="7496511">(</span><span class="ident" id="7496512">ip</span><span class="op" id="7496514">)</span>&nbsp;<span class="op" id="7496516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7496522">return</span>&nbsp;<span class="ident" id="7496529">true</span><span class="op" id="7496533">,</span>&nbsp;<span class="ident" id="7496535">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7496542">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7496546">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7496549">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7496552">return</span>&nbsp;<span class="ident" id="7496559">false</span><span class="op" id="7496564">,</span>&nbsp;<span class="ident" id="7496566">nil</span><br>
<span class="lineno"></span><span class="op" id="7496570">}</span>
</div>
</body>
</html>
