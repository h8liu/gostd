<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/asn1</h2>
<ul>
<li><a href="/gostd/encoding/asn1/asn1.go.html" class="current">asn1.go</a></li>
<li><a href="/gostd/encoding/asn1/asn1_test.go.html">asn1_test.go</a></li>
<li><a href="/gostd/encoding/asn1/common.go.html">common.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal_test.go.html">marshal_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4492458">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4492513">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4492567">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4492618">//&nbsp;Package&nbsp;asn1&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structures,</span><br>
<span class="lineno"></span><span class="comment" id="4492691">//&nbsp;as&nbsp;defined&nbsp;in&nbsp;ITU-T&nbsp;Rec&nbsp;X.690.</span><br>
<span class="lineno"></span><span class="comment" id="4492725">//</span><br>
<span class="lineno"></span><span class="comment" id="4492728">//&nbsp;See&nbsp;also&nbsp;``A&nbsp;Layman&#39;s&nbsp;Guide&nbsp;to&nbsp;a&nbsp;Subset&nbsp;of&nbsp;ASN.1,&nbsp;BER,&nbsp;and&nbsp;DER,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="4492797">//&nbsp;http://luca.ntop.org/Teaching/Appunti/asn1.html.</span><br>
<span class="lineno">10</span><span class="keyword" id="4492849">package</span>&nbsp;<span class="ident" id="4492857">asn1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4492863">//&nbsp;ASN.1&nbsp;is&nbsp;a&nbsp;syntax&nbsp;for&nbsp;specifying&nbsp;abstract&nbsp;objects&nbsp;and&nbsp;BER,&nbsp;DER,&nbsp;PER,&nbsp;XER&nbsp;etc</span><br>
<span class="lineno"></span><span class="comment" id="4492943">//&nbsp;are&nbsp;different&nbsp;encoding&nbsp;formats&nbsp;for&nbsp;those&nbsp;objects.&nbsp;Here,&nbsp;we&#39;ll&nbsp;be&nbsp;dealing</span><br>
<span class="lineno"></span><span class="comment" id="4493019">//&nbsp;with&nbsp;DER,&nbsp;the&nbsp;Distinguished&nbsp;Encoding&nbsp;Rules.&nbsp;DER&nbsp;is&nbsp;used&nbsp;in&nbsp;X.509&nbsp;because</span><br>
<span class="lineno">15</span><span class="comment" id="4493095">//&nbsp;it&#39;s&nbsp;fast&nbsp;to&nbsp;parse&nbsp;and,&nbsp;unlike&nbsp;BER,&nbsp;has&nbsp;a&nbsp;unique&nbsp;encoding&nbsp;for&nbsp;every&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="4493174">//&nbsp;When&nbsp;calculating&nbsp;hashes&nbsp;over&nbsp;objects,&nbsp;it&#39;s&nbsp;important&nbsp;that&nbsp;the&nbsp;resulting</span><br>
<span class="lineno"></span><span class="comment" id="4493249">//&nbsp;bytes&nbsp;be&nbsp;the&nbsp;same&nbsp;at&nbsp;both&nbsp;ends&nbsp;and&nbsp;DER&nbsp;removes&nbsp;this&nbsp;margin&nbsp;of&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4493321">//</span><br>
<span class="lineno"></span><span class="comment" id="4493324">//&nbsp;ASN.1&nbsp;is&nbsp;very&nbsp;complex&nbsp;and&nbsp;this&nbsp;package&nbsp;doesn&#39;t&nbsp;attempt&nbsp;to&nbsp;implement</span><br>
<span class="lineno">20</span><span class="comment" id="4493395">//&nbsp;everything&nbsp;by&nbsp;any&nbsp;means.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4493424">import</span>&nbsp;<span class="op" id="4493431">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4493434">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4493441">&#34;math/big&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4493453">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4493464">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4493475">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4493482">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="4493485">//&nbsp;A&nbsp;StructuralError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;valid,&nbsp;but&nbsp;the&nbsp;Go&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="4493561">//&nbsp;which&nbsp;is&nbsp;receiving&nbsp;it&nbsp;doesn&#39;t&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="4493601">type</span>&nbsp;<span class="ident" id="4493606">StructuralError</span>&nbsp;<span class="keyword" id="4493622">struct</span>&nbsp;<span class="op" id="4493629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4493632">Msg</span>&nbsp;<span class="builtintype" id="4493636">string</span><br>
<span class="lineno"></span><span class="op" id="4493643">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="4493646">func</span>&nbsp;<span class="op" id="4493651">(</span><span class="ident" id="4493652">e</span>&nbsp;<span class="ident" id="4493654">StructuralError</span><span class="op" id="4493669">)</span>&nbsp;<span class="ident" id="4493671">Error</span><span class="op" id="4493676">(</span><span class="op" id="4493677">)</span>&nbsp;<span class="builtintype" id="4493679">string</span>&nbsp;<span class="op" id="4493686">{</span>&nbsp;<span class="keyword" id="4493688">return</span>&nbsp;<span class="string" id="4493695">&#34;asn1:&nbsp;structure&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4493721">+</span>&nbsp;<span class="ident" id="4493723">e</span><span class="op" id="4493724">.</span><span class="ident" id="4493725">Msg</span>&nbsp;<span class="op" id="4493729">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4493732">//&nbsp;A&nbsp;SyntaxError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="4493790">type</span>&nbsp;<span class="ident" id="4493795">SyntaxError</span>&nbsp;<span class="keyword" id="4493807">struct</span>&nbsp;<span class="op" id="4493814">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4493817">Msg</span>&nbsp;<span class="builtintype" id="4493821">string</span><br>
<span class="lineno"></span><span class="op" id="4493828">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4493831">func</span>&nbsp;<span class="op" id="4493836">(</span><span class="ident" id="4493837">e</span>&nbsp;<span class="ident" id="4493839">SyntaxError</span><span class="op" id="4493850">)</span>&nbsp;<span class="ident" id="4493852">Error</span><span class="op" id="4493857">(</span><span class="op" id="4493858">)</span>&nbsp;<span class="builtintype" id="4493860">string</span>&nbsp;<span class="op" id="4493867">{</span>&nbsp;<span class="keyword" id="4493869">return</span>&nbsp;<span class="string" id="4493876">&#34;asn1:&nbsp;syntax&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4493899">+</span>&nbsp;<span class="ident" id="4493901">e</span><span class="op" id="4493902">.</span><span class="ident" id="4493903">Msg</span>&nbsp;<span class="op" id="4493907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="4493910">//&nbsp;We&nbsp;start&nbsp;by&nbsp;dealing&nbsp;with&nbsp;each&nbsp;of&nbsp;the&nbsp;primitive&nbsp;types&nbsp;in&nbsp;turn.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4493976">//&nbsp;BOOLEAN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4493988">func</span>&nbsp;<span class="ident" id="4493993">parseBool</span><span class="op" id="4494002">(</span><span class="ident" id="4494003">bytes</span>&nbsp;<span class="op" id="4494009">[</span><span class="op" id="4494010">]</span><span class="builtintype" id="4494011">byte</span><span class="op" id="4494015">)</span>&nbsp;<span class="op" id="4494017">(</span><span class="ident" id="4494018">ret</span>&nbsp;<span class="builtintype" id="4494022">bool</span><span class="op" id="4494026">,</span>&nbsp;<span class="ident" id="4494028">err</span>&nbsp;<span class="builtintype" id="4494032">error</span><span class="op" id="4494037">)</span>&nbsp;<span class="op" id="4494039">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4494042">if</span>&nbsp;<span class="builtinfunc" id="4494045">len</span><span class="op" id="4494048">(</span><span class="ident" id="4494049">bytes</span><span class="op" id="4494054">)</span>&nbsp;<span class="op" id="4494056">!=</span>&nbsp;<span class="num" id="4494059">1</span>&nbsp;<span class="op" id="4494061">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4494065">err</span>&nbsp;<span class="op" id="4494069">=</span>&nbsp;<span class="ident" id="4494071">SyntaxError</span><span class="op" id="4494082">{</span><span class="string" id="4494083">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4494100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4494104">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4494112">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4494116">//&nbsp;DER&nbsp;demands&nbsp;that&nbsp;&#34;If&nbsp;the&nbsp;encoding&nbsp;represents&nbsp;the&nbsp;boolean&nbsp;value&nbsp;TRUE,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4494189">//&nbsp;its&nbsp;single&nbsp;contents&nbsp;octet&nbsp;shall&nbsp;have&nbsp;all&nbsp;eight&nbsp;bits&nbsp;set&nbsp;to&nbsp;one.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4494258">//&nbsp;Thus&nbsp;only&nbsp;0&nbsp;and&nbsp;255&nbsp;are&nbsp;valid&nbsp;encoded&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4494308">switch</span>&nbsp;<span class="ident" id="4494315">bytes</span><span class="op" id="4494320">[</span><span class="num" id="4494321">0</span><span class="op" id="4494322">]</span>&nbsp;<span class="op" id="4494324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4494327">case</span>&nbsp;<span class="num" id="4494332">0</span><span class="op" id="4494333">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4494337">ret</span>&nbsp;<span class="op" id="4494341">=</span>&nbsp;<span class="builtintype" id="4494343">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4494350">case</span>&nbsp;<span class="num" id="4494355">0xff</span><span class="op" id="4494359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4494363">ret</span>&nbsp;<span class="op" id="4494367">=</span>&nbsp;<span class="builtintype" id="4494369">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4494375">default</span><span class="op" id="4494382">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4494386">err</span>&nbsp;<span class="op" id="4494390">=</span>&nbsp;<span class="ident" id="4494392">SyntaxError</span><span class="op" id="4494403">{</span><span class="string" id="4494404">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4494421">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4494424">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4494428">return</span><br>
<span class="lineno"></span><span class="op" id="4494435">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="4494438">//&nbsp;INTEGER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4494450">//&nbsp;parseInt64&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4494523">//&nbsp;returns&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4494546">func</span>&nbsp;<span class="ident" id="4494551">parseInt64</span><span class="op" id="4494561">(</span><span class="ident" id="4494562">bytes</span>&nbsp;<span class="op" id="4494568">[</span><span class="op" id="4494569">]</span><span class="builtintype" id="4494570">byte</span><span class="op" id="4494574">)</span>&nbsp;<span class="op" id="4494576">(</span><span class="ident" id="4494577">ret</span>&nbsp;<span class="builtintype" id="4494581">int64</span><span class="op" id="4494586">,</span>&nbsp;<span class="ident" id="4494588">err</span>&nbsp;<span class="builtintype" id="4494592">error</span><span class="op" id="4494597">)</span>&nbsp;<span class="op" id="4494599">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4494602">if</span>&nbsp;<span class="builtinfunc" id="4494605">len</span><span class="op" id="4494608">(</span><span class="ident" id="4494609">bytes</span><span class="op" id="4494614">)</span>&nbsp;<span class="op" id="4494616">&gt;</span>&nbsp;<span class="num" id="4494618">8</span>&nbsp;<span class="op" id="4494620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4494624">//&nbsp;We&#39;ll&nbsp;overflow&nbsp;an&nbsp;int64&nbsp;in&nbsp;this&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4494667">err</span>&nbsp;<span class="op" id="4494671">=</span>&nbsp;<span class="ident" id="4494673">StructuralError</span><span class="op" id="4494688">{</span><span class="string" id="4494689">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4494708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4494712">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4494720">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4494723">for</span>&nbsp;<span class="ident" id="4494727">bytesRead</span>&nbsp;<span class="op" id="4494737">:=</span>&nbsp;<span class="num" id="4494740">0</span><span class="op" id="4494741">;</span>&nbsp;<span class="ident" id="4494743">bytesRead</span>&nbsp;<span class="op" id="4494753">&lt;</span>&nbsp;<span class="builtinfunc" id="4494755">len</span><span class="op" id="4494758">(</span><span class="ident" id="4494759">bytes</span><span class="op" id="4494764">)</span><span class="op" id="4494765">;</span>&nbsp;<span class="ident" id="4494767">bytesRead</span><span class="op" id="4494776">++</span>&nbsp;<span class="op" id="4494779">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4494783">ret</span>&nbsp;<span class="op" id="4494787">&lt;&lt;=</span>&nbsp;<span class="num" id="4494791">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4494795">ret</span>&nbsp;<span class="op" id="4494799">|=</span>&nbsp;<span class="builtintype" id="4494802">int64</span><span class="op" id="4494807">(</span><span class="ident" id="4494808">bytes</span><span class="op" id="4494813">[</span><span class="ident" id="4494814">bytesRead</span><span class="op" id="4494823">]</span><span class="op" id="4494824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4494827">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4494831">//&nbsp;Shift&nbsp;up&nbsp;and&nbsp;down&nbsp;in&nbsp;order&nbsp;to&nbsp;sign&nbsp;extend&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4494889">ret</span>&nbsp;<span class="op" id="4494893">&lt;&lt;=</span>&nbsp;<span class="num" id="4494897">64</span>&nbsp;<span class="op" id="4494900">-</span>&nbsp;<span class="builtintype" id="4494902">uint8</span><span class="op" id="4494907">(</span><span class="builtinfunc" id="4494908">len</span><span class="op" id="4494911">(</span><span class="ident" id="4494912">bytes</span><span class="op" id="4494917">)</span><span class="op" id="4494918">)</span><span class="op" id="4494919">*</span><span class="num" id="4494920">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4494923">ret</span>&nbsp;<span class="op" id="4494927">&gt;&gt;=</span>&nbsp;<span class="num" id="4494931">64</span>&nbsp;<span class="op" id="4494934">-</span>&nbsp;<span class="builtintype" id="4494936">uint8</span><span class="op" id="4494941">(</span><span class="builtinfunc" id="4494942">len</span><span class="op" id="4494945">(</span><span class="ident" id="4494946">bytes</span><span class="op" id="4494951">)</span><span class="op" id="4494952">)</span><span class="op" id="4494953">*</span><span class="num" id="4494954">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4494957">return</span><br>
<span class="lineno"></span><span class="op" id="4494964">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="4494967">//&nbsp;parseInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4495046">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4495061">func</span>&nbsp;<span class="ident" id="4495066">parseInt32</span><span class="op" id="4495076">(</span><span class="ident" id="4495077">bytes</span>&nbsp;<span class="op" id="4495083">[</span><span class="op" id="4495084">]</span><span class="builtintype" id="4495085">byte</span><span class="op" id="4495089">)</span>&nbsp;<span class="op" id="4495091">(</span><span class="builtintype" id="4495092">int32</span><span class="op" id="4495097">,</span>&nbsp;<span class="builtintype" id="4495099">error</span><span class="op" id="4495104">)</span>&nbsp;<span class="op" id="4495106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4495109">ret64</span><span class="op" id="4495114">,</span>&nbsp;<span class="ident" id="4495116">err</span>&nbsp;<span class="op" id="4495120">:=</span>&nbsp;<span class="ident" id="4495123">parseInt64</span><span class="op" id="4495133">(</span><span class="ident" id="4495134">bytes</span><span class="op" id="4495139">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4495142">if</span>&nbsp;<span class="ident" id="4495145">err</span>&nbsp;<span class="op" id="4495149">!=</span>&nbsp;<span class="builtintype" id="4495152">nil</span>&nbsp;<span class="op" id="4495156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4495160">return</span>&nbsp;<span class="num" id="4495167">0</span><span class="op" id="4495168">,</span>&nbsp;<span class="ident" id="4495170">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4495175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4495178">if</span>&nbsp;<span class="ident" id="4495181">ret64</span>&nbsp;<span class="op" id="4495187">!=</span>&nbsp;<span class="builtintype" id="4495190">int64</span><span class="op" id="4495195">(</span><span class="builtintype" id="4495196">int32</span><span class="op" id="4495201">(</span><span class="ident" id="4495202">ret64</span><span class="op" id="4495207">)</span><span class="op" id="4495208">)</span>&nbsp;<span class="op" id="4495210">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4495214">return</span>&nbsp;<span class="num" id="4495221">0</span><span class="op" id="4495222">,</span>&nbsp;<span class="ident" id="4495224">StructuralError</span><span class="op" id="4495239">{</span><span class="string" id="4495240">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4495259">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4495262">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4495265">return</span>&nbsp;<span class="builtintype" id="4495272">int32</span><span class="op" id="4495277">(</span><span class="ident" id="4495278">ret64</span><span class="op" id="4495283">)</span><span class="op" id="4495284">,</span>&nbsp;<span class="builtintype" id="4495286">nil</span><br>
<span class="lineno"></span><span class="op" id="4495290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4495293">var</span>&nbsp;<span class="ident" id="4495297">bigOne</span>&nbsp;<span class="op" id="4495304">=</span>&nbsp;<span class="ident" id="4495306">big</span><span class="op" id="4495309">.</span><span class="ident" id="4495310">NewInt</span><span class="op" id="4495316">(</span><span class="num" id="4495317">1</span><span class="op" id="4495318">)</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4495321">//&nbsp;parseBigInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4495403">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4495418">func</span>&nbsp;<span class="ident" id="4495423">parseBigInt</span><span class="op" id="4495434">(</span><span class="ident" id="4495435">bytes</span>&nbsp;<span class="op" id="4495441">[</span><span class="op" id="4495442">]</span><span class="builtintype" id="4495443">byte</span><span class="op" id="4495447">)</span>&nbsp;<span class="op" id="4495449">*</span><span class="ident" id="4495450">big</span><span class="op" id="4495453">.</span><span class="ident" id="4495454">Int</span>&nbsp;<span class="op" id="4495458">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4495461">ret</span>&nbsp;<span class="op" id="4495465">:=</span>&nbsp;<span class="builtinfunc" id="4495468">new</span><span class="op" id="4495471">(</span><span class="ident" id="4495472">big</span><span class="op" id="4495475">.</span><span class="ident" id="4495476">Int</span><span class="op" id="4495479">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4495482">if</span>&nbsp;<span class="builtinfunc" id="4495485">len</span><span class="op" id="4495488">(</span><span class="ident" id="4495489">bytes</span><span class="op" id="4495494">)</span>&nbsp;<span class="op" id="4495496">&gt;</span>&nbsp;<span class="num" id="4495498">0</span>&nbsp;<span class="op" id="4495500">&amp;&amp;</span>&nbsp;<span class="ident" id="4495503">bytes</span><span class="op" id="4495508">[</span><span class="num" id="4495509">0</span><span class="op" id="4495510">]</span><span class="op" id="4495511">&amp;</span><span class="num" id="4495512">0x80</span>&nbsp;<span class="op" id="4495517">==</span>&nbsp;<span class="num" id="4495520">0x80</span>&nbsp;<span class="op" id="4495525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4495529">//&nbsp;This&nbsp;is&nbsp;a&nbsp;negative&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4495561">notBytes</span>&nbsp;<span class="op" id="4495570">:=</span>&nbsp;<span class="builtinfunc" id="4495573">make</span><span class="op" id="4495577">(</span><span class="op" id="4495578">[</span><span class="op" id="4495579">]</span><span class="builtintype" id="4495580">byte</span><span class="op" id="4495584">,</span>&nbsp;<span class="builtinfunc" id="4495586">len</span><span class="op" id="4495589">(</span><span class="ident" id="4495590">bytes</span><span class="op" id="4495595">)</span><span class="op" id="4495596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4495600">for</span>&nbsp;<span class="ident" id="4495604">i</span>&nbsp;<span class="op" id="4495606">:=</span>&nbsp;<span class="keyword" id="4495609">range</span>&nbsp;<span class="ident" id="4495615">notBytes</span>&nbsp;<span class="op" id="4495624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4495629">notBytes</span><span class="op" id="4495637">[</span><span class="ident" id="4495638">i</span><span class="op" id="4495639">]</span>&nbsp;<span class="op" id="4495641">=</span>&nbsp;<span class="op" id="4495643">^</span><span class="ident" id="4495644">bytes</span><span class="op" id="4495649">[</span><span class="ident" id="4495650">i</span><span class="op" id="4495651">]</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4495655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4495659">ret</span><span class="op" id="4495662">.</span><span class="ident" id="4495663">SetBytes</span><span class="op" id="4495671">(</span><span class="ident" id="4495672">notBytes</span><span class="op" id="4495680">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4495684">ret</span><span class="op" id="4495687">.</span><span class="ident" id="4495688">Add</span><span class="op" id="4495691">(</span><span class="ident" id="4495692">ret</span><span class="op" id="4495695">,</span>&nbsp;<span class="ident" id="4495697">bigOne</span><span class="op" id="4495703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4495707">ret</span><span class="op" id="4495710">.</span><span class="ident" id="4495711">Neg</span><span class="op" id="4495714">(</span><span class="ident" id="4495715">ret</span><span class="op" id="4495718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4495722">return</span>&nbsp;<span class="ident" id="4495729">ret</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4495734">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4495737">ret</span><span class="op" id="4495740">.</span><span class="ident" id="4495741">SetBytes</span><span class="op" id="4495749">(</span><span class="ident" id="4495750">bytes</span><span class="op" id="4495755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4495758">return</span>&nbsp;<span class="ident" id="4495765">ret</span><br>
<span class="lineno"></span><span class="op" id="4495769">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="4495772">//&nbsp;BIT&nbsp;STRING</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4495787">//&nbsp;BitString&nbsp;is&nbsp;the&nbsp;structure&nbsp;to&nbsp;use&nbsp;when&nbsp;you&nbsp;want&nbsp;an&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;type.&nbsp;A</span><br>
<span class="lineno"></span><span class="comment" id="4495866">//&nbsp;bit&nbsp;string&nbsp;is&nbsp;padded&nbsp;up&nbsp;to&nbsp;the&nbsp;nearest&nbsp;byte&nbsp;in&nbsp;memory&nbsp;and&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4495941">//&nbsp;valid&nbsp;bits&nbsp;is&nbsp;recorded.&nbsp;Padding&nbsp;bits&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno">130</span><span class="keyword" id="4495995">type</span>&nbsp;<span class="ident" id="4496000">BitString</span>&nbsp;<span class="keyword" id="4496010">struct</span>&nbsp;<span class="op" id="4496017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4496020">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4496030">[</span><span class="op" id="4496031">]</span><span class="builtintype" id="4496032">byte</span>&nbsp;<span class="comment" id="4496037">//&nbsp;bits&nbsp;packed&nbsp;into&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4496065">BitLength</span>&nbsp;<span class="builtintype" id="4496075">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4496082">//&nbsp;length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span><span class="op" id="4496101">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="4496104">//&nbsp;At&nbsp;returns&nbsp;the&nbsp;bit&nbsp;at&nbsp;the&nbsp;given&nbsp;index.&nbsp;If&nbsp;the&nbsp;index&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4496178">//&nbsp;returns&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword" id="4496196">func</span>&nbsp;<span class="op" id="4496201">(</span><span class="ident" id="4496202">b</span>&nbsp;<span class="ident" id="4496204">BitString</span><span class="op" id="4496213">)</span>&nbsp;<span class="ident" id="4496215">At</span><span class="op" id="4496217">(</span><span class="ident" id="4496218">i</span>&nbsp;<span class="builtintype" id="4496220">int</span><span class="op" id="4496223">)</span>&nbsp;<span class="builtintype" id="4496225">int</span>&nbsp;<span class="op" id="4496229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4496232">if</span>&nbsp;<span class="ident" id="4496235">i</span>&nbsp;<span class="op" id="4496237">&lt;</span>&nbsp;<span class="num" id="4496239">0</span>&nbsp;<span class="op" id="4496241">||</span>&nbsp;<span class="ident" id="4496244">i</span>&nbsp;<span class="op" id="4496246">&gt;=</span>&nbsp;<span class="ident" id="4496249">b</span><span class="op" id="4496250">.</span><span class="ident" id="4496251">BitLength</span>&nbsp;<span class="op" id="4496261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4496265">return</span>&nbsp;<span class="num" id="4496272">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4496275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4496278">x</span>&nbsp;<span class="op" id="4496280">:=</span>&nbsp;<span class="ident" id="4496283">i</span>&nbsp;<span class="op" id="4496285">/</span>&nbsp;<span class="num" id="4496287">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4496290">y</span>&nbsp;<span class="op" id="4496292">:=</span>&nbsp;<span class="num" id="4496295">7</span>&nbsp;<span class="op" id="4496297">-</span>&nbsp;<span class="builtintype" id="4496299">uint</span><span class="op" id="4496303">(</span><span class="ident" id="4496304">i</span><span class="op" id="4496305">%</span><span class="num" id="4496306">8</span><span class="op" id="4496307">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4496310">return</span>&nbsp;<span class="builtintype" id="4496317">int</span><span class="op" id="4496320">(</span><span class="ident" id="4496321">b</span><span class="op" id="4496322">.</span><span class="ident" id="4496323">Bytes</span><span class="op" id="4496328">[</span><span class="ident" id="4496329">x</span><span class="op" id="4496330">]</span><span class="op" id="4496331">&gt;&gt;</span><span class="ident" id="4496333">y</span><span class="op" id="4496334">)</span>&nbsp;<span class="op" id="4496336">&amp;</span>&nbsp;<span class="num" id="4496338">1</span><br>
<span class="lineno"></span><span class="op" id="4496340">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="4496343">//&nbsp;RightAlign&nbsp;returns&nbsp;a&nbsp;slice&nbsp;where&nbsp;the&nbsp;padding&nbsp;bits&nbsp;are&nbsp;at&nbsp;the&nbsp;beginning.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4496422">//&nbsp;slice&nbsp;may&nbsp;share&nbsp;memory&nbsp;with&nbsp;the&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="keyword" id="4496468">func</span>&nbsp;<span class="op" id="4496473">(</span><span class="ident" id="4496474">b</span>&nbsp;<span class="ident" id="4496476">BitString</span><span class="op" id="4496485">)</span>&nbsp;<span class="ident" id="4496487">RightAlign</span><span class="op" id="4496497">(</span><span class="op" id="4496498">)</span>&nbsp;<span class="op" id="4496500">[</span><span class="op" id="4496501">]</span><span class="builtintype" id="4496502">byte</span>&nbsp;<span class="op" id="4496507">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4496510">shift</span>&nbsp;<span class="op" id="4496516">:=</span>&nbsp;<span class="builtintype" id="4496519">uint</span><span class="op" id="4496523">(</span><span class="num" id="4496524">8</span>&nbsp;<span class="op" id="4496526">-</span>&nbsp;<span class="op" id="4496528">(</span><span class="ident" id="4496529">b</span><span class="op" id="4496530">.</span><span class="ident" id="4496531">BitLength</span>&nbsp;<span class="op" id="4496541">%</span>&nbsp;<span class="num" id="4496543">8</span><span class="op" id="4496544">)</span><span class="op" id="4496545">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4496548">if</span>&nbsp;<span class="ident" id="4496551">shift</span>&nbsp;<span class="op" id="4496557">==</span>&nbsp;<span class="num" id="4496560">8</span>&nbsp;<span class="op" id="4496562">||</span>&nbsp;<span class="builtinfunc" id="4496565">len</span><span class="op" id="4496568">(</span><span class="ident" id="4496569">b</span><span class="op" id="4496570">.</span><span class="ident" id="4496571">Bytes</span><span class="op" id="4496576">)</span>&nbsp;<span class="op" id="4496578">==</span>&nbsp;<span class="num" id="4496581">0</span>&nbsp;<span class="op" id="4496583">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4496587">return</span>&nbsp;<span class="ident" id="4496594">b</span><span class="op" id="4496595">.</span><span class="ident" id="4496596">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4496603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4496607">a</span>&nbsp;<span class="op" id="4496609">:=</span>&nbsp;<span class="builtinfunc" id="4496612">make</span><span class="op" id="4496616">(</span><span class="op" id="4496617">[</span><span class="op" id="4496618">]</span><span class="builtintype" id="4496619">byte</span><span class="op" id="4496623">,</span>&nbsp;<span class="builtinfunc" id="4496625">len</span><span class="op" id="4496628">(</span><span class="ident" id="4496629">b</span><span class="op" id="4496630">.</span><span class="ident" id="4496631">Bytes</span><span class="op" id="4496636">)</span><span class="op" id="4496637">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4496640">a</span><span class="op" id="4496641">[</span><span class="num" id="4496642">0</span><span class="op" id="4496643">]</span>&nbsp;<span class="op" id="4496645">=</span>&nbsp;<span class="ident" id="4496647">b</span><span class="op" id="4496648">.</span><span class="ident" id="4496649">Bytes</span><span class="op" id="4496654">[</span><span class="num" id="4496655">0</span><span class="op" id="4496656">]</span>&nbsp;<span class="op" id="4496658">&gt;&gt;</span>&nbsp;<span class="ident" id="4496661">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4496668">for</span>&nbsp;<span class="ident" id="4496672">i</span>&nbsp;<span class="op" id="4496674">:=</span>&nbsp;<span class="num" id="4496677">1</span><span class="op" id="4496678">;</span>&nbsp;<span class="ident" id="4496680">i</span>&nbsp;<span class="op" id="4496682">&lt;</span>&nbsp;<span class="builtinfunc" id="4496684">len</span><span class="op" id="4496687">(</span><span class="ident" id="4496688">b</span><span class="op" id="4496689">.</span><span class="ident" id="4496690">Bytes</span><span class="op" id="4496695">)</span><span class="op" id="4496696">;</span>&nbsp;<span class="ident" id="4496698">i</span><span class="op" id="4496699">++</span>&nbsp;<span class="op" id="4496702">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4496706">a</span><span class="op" id="4496707">[</span><span class="ident" id="4496708">i</span><span class="op" id="4496709">]</span>&nbsp;<span class="op" id="4496711">=</span>&nbsp;<span class="ident" id="4496713">b</span><span class="op" id="4496714">.</span><span class="ident" id="4496715">Bytes</span><span class="op" id="4496720">[</span><span class="ident" id="4496721">i</span><span class="op" id="4496722">-</span><span class="num" id="4496723">1</span><span class="op" id="4496724">]</span>&nbsp;<span class="op" id="4496726">&lt;&lt;</span>&nbsp;<span class="op" id="4496729">(</span><span class="num" id="4496730">8</span>&nbsp;<span class="op" id="4496732">-</span>&nbsp;<span class="ident" id="4496734">shift</span><span class="op" id="4496739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4496743">a</span><span class="op" id="4496744">[</span><span class="ident" id="4496745">i</span><span class="op" id="4496746">]</span>&nbsp;<span class="op" id="4496748">|=</span>&nbsp;<span class="ident" id="4496751">b</span><span class="op" id="4496752">.</span><span class="ident" id="4496753">Bytes</span><span class="op" id="4496758">[</span><span class="ident" id="4496759">i</span><span class="op" id="4496760">]</span>&nbsp;<span class="op" id="4496762">&gt;&gt;</span>&nbsp;<span class="ident" id="4496765">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4496772">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4496776">return</span>&nbsp;<span class="ident" id="4496783">a</span><br>
<span class="lineno"></span><span class="op" id="4496785">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4496788">//&nbsp;parseBitString&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;bit&nbsp;string&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno">165</span><span class="keyword" id="4496875">func</span>&nbsp;<span class="ident" id="4496880">parseBitString</span><span class="op" id="4496894">(</span><span class="ident" id="4496895">bytes</span>&nbsp;<span class="op" id="4496901">[</span><span class="op" id="4496902">]</span><span class="builtintype" id="4496903">byte</span><span class="op" id="4496907">)</span>&nbsp;<span class="op" id="4496909">(</span><span class="ident" id="4496910">ret</span>&nbsp;<span class="ident" id="4496914">BitString</span><span class="op" id="4496923">,</span>&nbsp;<span class="ident" id="4496925">err</span>&nbsp;<span class="builtintype" id="4496929">error</span><span class="op" id="4496934">)</span>&nbsp;<span class="op" id="4496936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4496939">if</span>&nbsp;<span class="builtinfunc" id="4496942">len</span><span class="op" id="4496945">(</span><span class="ident" id="4496946">bytes</span><span class="op" id="4496951">)</span>&nbsp;<span class="op" id="4496953">==</span>&nbsp;<span class="num" id="4496956">0</span>&nbsp;<span class="op" id="4496958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4496962">err</span>&nbsp;<span class="op" id="4496966">=</span>&nbsp;<span class="ident" id="4496968">SyntaxError</span><span class="op" id="4496979">{</span><span class="string" id="4496980">&#34;zero&nbsp;length&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4497004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4497008">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4497016">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4497019">paddingBits</span>&nbsp;<span class="op" id="4497031">:=</span>&nbsp;<span class="builtintype" id="4497034">int</span><span class="op" id="4497037">(</span><span class="ident" id="4497038">bytes</span><span class="op" id="4497043">[</span><span class="num" id="4497044">0</span><span class="op" id="4497045">]</span><span class="op" id="4497046">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4497049">if</span>&nbsp;<span class="ident" id="4497052">paddingBits</span>&nbsp;<span class="op" id="4497064">&gt;</span>&nbsp;<span class="num" id="4497066">7</span>&nbsp;<span class="op" id="4497068">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4497073">len</span><span class="op" id="4497076">(</span><span class="ident" id="4497077">bytes</span><span class="op" id="4497082">)</span>&nbsp;<span class="op" id="4497084">==</span>&nbsp;<span class="num" id="4497087">1</span>&nbsp;<span class="op" id="4497089">&amp;&amp;</span>&nbsp;<span class="ident" id="4497092">paddingBits</span>&nbsp;<span class="op" id="4497104">&gt;</span>&nbsp;<span class="num" id="4497106">0</span>&nbsp;<span class="op" id="4497108">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4497113">bytes</span><span class="op" id="4497118">[</span><span class="builtinfunc" id="4497119">len</span><span class="op" id="4497122">(</span><span class="ident" id="4497123">bytes</span><span class="op" id="4497128">)</span><span class="op" id="4497129">-</span><span class="num" id="4497130">1</span><span class="op" id="4497131">]</span><span class="op" id="4497132">&amp;</span><span class="op" id="4497133">(</span><span class="op" id="4497134">(</span><span class="num" id="4497135">1</span><span class="op" id="4497136">&lt;&lt;</span><span class="ident" id="4497138">bytes</span><span class="op" id="4497143">[</span><span class="num" id="4497144">0</span><span class="op" id="4497145">]</span><span class="op" id="4497146">)</span><span class="op" id="4497147">-</span><span class="num" id="4497148">1</span><span class="op" id="4497149">)</span>&nbsp;<span class="op" id="4497151">!=</span>&nbsp;<span class="num" id="4497154">0</span>&nbsp;<span class="op" id="4497156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4497160">err</span>&nbsp;<span class="op" id="4497164">=</span>&nbsp;<span class="ident" id="4497166">SyntaxError</span><span class="op" id="4497177">{</span><span class="string" id="4497178">&#34;invalid&nbsp;padding&nbsp;bits&nbsp;in&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4497214">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4497218">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4497226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4497229">ret</span><span class="op" id="4497232">.</span><span class="ident" id="4497233">BitLength</span>&nbsp;<span class="op" id="4497243">=</span>&nbsp;<span class="op" id="4497245">(</span><span class="builtinfunc" id="4497246">len</span><span class="op" id="4497249">(</span><span class="ident" id="4497250">bytes</span><span class="op" id="4497255">)</span><span class="op" id="4497256">-</span><span class="num" id="4497257">1</span><span class="op" id="4497258">)</span><span class="op" id="4497259">*</span><span class="num" id="4497260">8</span>&nbsp;<span class="op" id="4497262">-</span>&nbsp;<span class="ident" id="4497264">paddingBits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4497277">ret</span><span class="op" id="4497280">.</span><span class="ident" id="4497281">Bytes</span>&nbsp;<span class="op" id="4497287">=</span>&nbsp;<span class="ident" id="4497289">bytes</span><span class="op" id="4497294">[</span><span class="num" id="4497295">1</span><span class="op" id="4497296">:</span><span class="op" id="4497297">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4497300">return</span><br>
<span class="lineno">180</span><span class="op" id="4497307">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4497310">//&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4497332">//&nbsp;An&nbsp;ObjectIdentifier&nbsp;represents&nbsp;an&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER.</span><br>
<span class="lineno">185</span><span class="keyword" id="4497394">type</span>&nbsp;<span class="ident" id="4497399">ObjectIdentifier</span>&nbsp;<span class="op" id="4497416">[</span><span class="op" id="4497417">]</span><span class="builtintype" id="4497418">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4497423">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;oi&nbsp;and&nbsp;other&nbsp;represent&nbsp;the&nbsp;same&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="4497492">func</span>&nbsp;<span class="op" id="4497497">(</span><span class="ident" id="4497498">oi</span>&nbsp;<span class="ident" id="4497501">ObjectIdentifier</span><span class="op" id="4497517">)</span>&nbsp;<span class="ident" id="4497519">Equal</span><span class="op" id="4497524">(</span><span class="ident" id="4497525">other</span>&nbsp;<span class="ident" id="4497531">ObjectIdentifier</span><span class="op" id="4497547">)</span>&nbsp;<span class="builtintype" id="4497549">bool</span>&nbsp;<span class="op" id="4497554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4497557">if</span>&nbsp;<span class="builtinfunc" id="4497560">len</span><span class="op" id="4497563">(</span><span class="ident" id="4497564">oi</span><span class="op" id="4497566">)</span>&nbsp;<span class="op" id="4497568">!=</span>&nbsp;<span class="builtinfunc" id="4497571">len</span><span class="op" id="4497574">(</span><span class="ident" id="4497575">other</span><span class="op" id="4497580">)</span>&nbsp;<span class="op" id="4497582">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4497586">return</span>&nbsp;<span class="builtintype" id="4497593">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4497600">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4497603">for</span>&nbsp;<span class="ident" id="4497607">i</span>&nbsp;<span class="op" id="4497609">:=</span>&nbsp;<span class="num" id="4497612">0</span><span class="op" id="4497613">;</span>&nbsp;<span class="ident" id="4497615">i</span>&nbsp;<span class="op" id="4497617">&lt;</span>&nbsp;<span class="builtinfunc" id="4497619">len</span><span class="op" id="4497622">(</span><span class="ident" id="4497623">oi</span><span class="op" id="4497625">)</span><span class="op" id="4497626">;</span>&nbsp;<span class="ident" id="4497628">i</span><span class="op" id="4497629">++</span>&nbsp;<span class="op" id="4497632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4497636">if</span>&nbsp;<span class="ident" id="4497639">oi</span><span class="op" id="4497641">[</span><span class="ident" id="4497642">i</span><span class="op" id="4497643">]</span>&nbsp;<span class="op" id="4497645">!=</span>&nbsp;<span class="ident" id="4497648">other</span><span class="op" id="4497653">[</span><span class="ident" id="4497654">i</span><span class="op" id="4497655">]</span>&nbsp;<span class="op" id="4497657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4497662">return</span>&nbsp;<span class="builtintype" id="4497669">false</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4497677">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4497680">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4497684">return</span>&nbsp;<span class="builtintype" id="4497691">true</span><br>
<span class="lineno"></span><span class="op" id="4497696">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="4497699">func</span>&nbsp;<span class="op" id="4497704">(</span><span class="ident" id="4497705">oi</span>&nbsp;<span class="ident" id="4497708">ObjectIdentifier</span><span class="op" id="4497724">)</span>&nbsp;<span class="ident" id="4497726">String</span><span class="op" id="4497732">(</span><span class="op" id="4497733">)</span>&nbsp;<span class="builtintype" id="4497735">string</span>&nbsp;<span class="op" id="4497742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4497745">var</span>&nbsp;<span class="ident" id="4497749">s</span>&nbsp;<span class="builtintype" id="4497751">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4497760">for</span>&nbsp;<span class="ident" id="4497764">i</span><span class="op" id="4497765">,</span>&nbsp;<span class="ident" id="4497767">v</span>&nbsp;<span class="op" id="4497769">:=</span>&nbsp;<span class="keyword" id="4497772">range</span>&nbsp;<span class="ident" id="4497778">oi</span>&nbsp;<span class="op" id="4497781">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4497785">if</span>&nbsp;<span class="ident" id="4497788">i</span>&nbsp;<span class="op" id="4497790">&gt;</span>&nbsp;<span class="num" id="4497792">0</span>&nbsp;<span class="op" id="4497794">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4497799">s</span>&nbsp;<span class="op" id="4497801">+=</span>&nbsp;<span class="string" id="4497804">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4497810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4497814">s</span>&nbsp;<span class="op" id="4497816">+=</span>&nbsp;<span class="ident" id="4497819">strconv</span><span class="op" id="4497826">.</span><span class="ident" id="4497827">Itoa</span><span class="op" id="4497831">(</span><span class="ident" id="4497832">v</span><span class="op" id="4497833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4497836">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4497840">return</span>&nbsp;<span class="ident" id="4497847">s</span><br>
<span class="lineno"></span><span class="op" id="4497849">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4497852">//&nbsp;parseObjectIdentifier&nbsp;parses&nbsp;an&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes&nbsp;and</span><br>
<span class="lineno">215</span><span class="comment" id="4497930">//&nbsp;returns&nbsp;it.&nbsp;An&nbsp;object&nbsp;identifier&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;variable&nbsp;length&nbsp;integers</span><br>
<span class="lineno"></span><span class="comment" id="4498008">//&nbsp;that&nbsp;are&nbsp;assigned&nbsp;in&nbsp;a&nbsp;hierarchy.</span><br>
<span class="lineno"></span><span class="keyword" id="4498045">func</span>&nbsp;<span class="ident" id="4498050">parseObjectIdentifier</span><span class="op" id="4498071">(</span><span class="ident" id="4498072">bytes</span>&nbsp;<span class="op" id="4498078">[</span><span class="op" id="4498079">]</span><span class="builtintype" id="4498080">byte</span><span class="op" id="4498084">)</span>&nbsp;<span class="op" id="4498086">(</span><span class="ident" id="4498087">s</span>&nbsp;<span class="op" id="4498089">[</span><span class="op" id="4498090">]</span><span class="builtintype" id="4498091">int</span><span class="op" id="4498094">,</span>&nbsp;<span class="ident" id="4498096">err</span>&nbsp;<span class="builtintype" id="4498100">error</span><span class="op" id="4498105">)</span>&nbsp;<span class="op" id="4498107">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4498110">if</span>&nbsp;<span class="builtinfunc" id="4498113">len</span><span class="op" id="4498116">(</span><span class="ident" id="4498117">bytes</span><span class="op" id="4498122">)</span>&nbsp;<span class="op" id="4498124">==</span>&nbsp;<span class="num" id="4498127">0</span>&nbsp;<span class="op" id="4498129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4498133">err</span>&nbsp;<span class="op" id="4498137">=</span>&nbsp;<span class="ident" id="4498139">SyntaxError</span><span class="op" id="4498150">{</span><span class="string" id="4498151">&#34;zero&nbsp;length&nbsp;OBJECT&nbsp;IDENTIFIER&#34;</span><span class="op" id="4498182">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4498186">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4498194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4498198">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;we&nbsp;get&nbsp;two&nbsp;elements&nbsp;from&nbsp;the&nbsp;first&nbsp;byte&nbsp;(which&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4498271">//&nbsp;encoded&nbsp;differently)&nbsp;and&nbsp;then&nbsp;every&nbsp;varint&nbsp;is&nbsp;a&nbsp;single&nbsp;byte&nbsp;long.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4498341">s</span>&nbsp;<span class="op" id="4498343">=</span>&nbsp;<span class="builtinfunc" id="4498345">make</span><span class="op" id="4498349">(</span><span class="op" id="4498350">[</span><span class="op" id="4498351">]</span><span class="builtintype" id="4498352">int</span><span class="op" id="4498355">,</span>&nbsp;<span class="builtinfunc" id="4498357">len</span><span class="op" id="4498360">(</span><span class="ident" id="4498361">bytes</span><span class="op" id="4498366">)</span><span class="op" id="4498367">+</span><span class="num" id="4498368">1</span><span class="op" id="4498369">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4498373">//&nbsp;The&nbsp;first&nbsp;varint&nbsp;is&nbsp;40*value1&nbsp;+&nbsp;value2:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4498417">//&nbsp;According&nbsp;to&nbsp;this&nbsp;packing,&nbsp;value1&nbsp;can&nbsp;take&nbsp;the&nbsp;values&nbsp;0,&nbsp;1&nbsp;and&nbsp;2&nbsp;only.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4498492">//&nbsp;When&nbsp;value1&nbsp;=&nbsp;0&nbsp;or&nbsp;value1&nbsp;=&nbsp;1,&nbsp;then&nbsp;value2&nbsp;is&nbsp;&lt;=&nbsp;39.&nbsp;When&nbsp;value1&nbsp;=&nbsp;2,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4498566">//&nbsp;then&nbsp;there&nbsp;are&nbsp;no&nbsp;restrictions&nbsp;on&nbsp;value2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4498612">v</span><span class="op" id="4498613">,</span>&nbsp;<span class="ident" id="4498615">offset</span><span class="op" id="4498621">,</span>&nbsp;<span class="ident" id="4498623">err</span>&nbsp;<span class="op" id="4498627">:=</span>&nbsp;<span class="ident" id="4498630">parseBase128Int</span><span class="op" id="4498645">(</span><span class="ident" id="4498646">bytes</span><span class="op" id="4498651">,</span>&nbsp;<span class="num" id="4498653">0</span><span class="op" id="4498654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4498657">if</span>&nbsp;<span class="ident" id="4498660">err</span>&nbsp;<span class="op" id="4498664">!=</span>&nbsp;<span class="builtintype" id="4498667">nil</span>&nbsp;<span class="op" id="4498671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4498675">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4498683">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4498686">if</span>&nbsp;<span class="ident" id="4498689">v</span>&nbsp;<span class="op" id="4498691">&lt;</span>&nbsp;<span class="num" id="4498693">80</span>&nbsp;<span class="op" id="4498696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4498700">s</span><span class="op" id="4498701">[</span><span class="num" id="4498702">0</span><span class="op" id="4498703">]</span>&nbsp;<span class="op" id="4498705">=</span>&nbsp;<span class="ident" id="4498707">v</span>&nbsp;<span class="op" id="4498709">/</span>&nbsp;<span class="num" id="4498711">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4498716">s</span><span class="op" id="4498717">[</span><span class="num" id="4498718">1</span><span class="op" id="4498719">]</span>&nbsp;<span class="op" id="4498721">=</span>&nbsp;<span class="ident" id="4498723">v</span>&nbsp;<span class="op" id="4498725">%</span>&nbsp;<span class="num" id="4498727">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4498731">}</span>&nbsp;<span class="keyword" id="4498733">else</span>&nbsp;<span class="op" id="4498738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4498742">s</span><span class="op" id="4498743">[</span><span class="num" id="4498744">0</span><span class="op" id="4498745">]</span>&nbsp;<span class="op" id="4498747">=</span>&nbsp;<span class="num" id="4498749">2</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4498753">s</span><span class="op" id="4498754">[</span><span class="num" id="4498755">1</span><span class="op" id="4498756">]</span>&nbsp;<span class="op" id="4498758">=</span>&nbsp;<span class="ident" id="4498760">v</span>&nbsp;<span class="op" id="4498762">-</span>&nbsp;<span class="num" id="4498764">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4498768">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4498772">i</span>&nbsp;<span class="op" id="4498774">:=</span>&nbsp;<span class="num" id="4498777">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4498780">for</span>&nbsp;<span class="op" id="4498784">;</span>&nbsp;<span class="ident" id="4498786">offset</span>&nbsp;<span class="op" id="4498793">&lt;</span>&nbsp;<span class="builtinfunc" id="4498795">len</span><span class="op" id="4498798">(</span><span class="ident" id="4498799">bytes</span><span class="op" id="4498804">)</span><span class="op" id="4498805">;</span>&nbsp;<span class="ident" id="4498807">i</span><span class="op" id="4498808">++</span>&nbsp;<span class="op" id="4498811">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4498815">v</span><span class="op" id="4498816">,</span>&nbsp;<span class="ident" id="4498818">offset</span><span class="op" id="4498824">,</span>&nbsp;<span class="ident" id="4498826">err</span>&nbsp;<span class="op" id="4498830">=</span>&nbsp;<span class="ident" id="4498832">parseBase128Int</span><span class="op" id="4498847">(</span><span class="ident" id="4498848">bytes</span><span class="op" id="4498853">,</span>&nbsp;<span class="ident" id="4498855">offset</span><span class="op" id="4498861">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4498865">if</span>&nbsp;<span class="ident" id="4498868">err</span>&nbsp;<span class="op" id="4498872">!=</span>&nbsp;<span class="builtintype" id="4498875">nil</span>&nbsp;<span class="op" id="4498879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4498884">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4498893">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4498897">s</span><span class="op" id="4498898">[</span><span class="ident" id="4498899">i</span><span class="op" id="4498900">]</span>&nbsp;<span class="op" id="4498902">=</span>&nbsp;<span class="ident" id="4498904">v</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4498907">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4498910">s</span>&nbsp;<span class="op" id="4498912">=</span>&nbsp;<span class="ident" id="4498914">s</span><span class="op" id="4498915">[</span><span class="num" id="4498916">0</span><span class="op" id="4498917">:</span><span class="ident" id="4498918">i</span><span class="op" id="4498919">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4498922">return</span><br>
<span class="lineno"></span><span class="op" id="4498929">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="4498932">//&nbsp;ENUMERATED</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4498947">//&nbsp;An&nbsp;Enumerated&nbsp;is&nbsp;represented&nbsp;as&nbsp;a&nbsp;plain&nbsp;int.</span><br>
<span class="lineno"></span><span class="keyword" id="4498995">type</span>&nbsp;<span class="ident" id="4499000">Enumerated</span>&nbsp;<span class="builtintype" id="4499011">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="4499016">//&nbsp;FLAG</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4499025">//&nbsp;A&nbsp;Flag&nbsp;accepts&nbsp;any&nbsp;data&nbsp;and&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="4499083">type</span>&nbsp;<span class="ident" id="4499088">Flag</span>&nbsp;<span class="builtintype" id="4499093">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="4499099">//&nbsp;parseBase128Int&nbsp;parses&nbsp;a&nbsp;base-128&nbsp;encoded&nbsp;int&nbsp;from&nbsp;the&nbsp;given&nbsp;offset&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4499177">//&nbsp;given&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;value&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.</span><br>
<span class="lineno"></span><span class="keyword" id="4499239">func</span>&nbsp;<span class="ident" id="4499244">parseBase128Int</span><span class="op" id="4499259">(</span><span class="ident" id="4499260">bytes</span>&nbsp;<span class="op" id="4499266">[</span><span class="op" id="4499267">]</span><span class="builtintype" id="4499268">byte</span><span class="op" id="4499272">,</span>&nbsp;<span class="ident" id="4499274">initOffset</span>&nbsp;<span class="builtintype" id="4499285">int</span><span class="op" id="4499288">)</span>&nbsp;<span class="op" id="4499290">(</span><span class="ident" id="4499291">ret</span><span class="op" id="4499294">,</span>&nbsp;<span class="ident" id="4499296">offset</span>&nbsp;<span class="builtintype" id="4499303">int</span><span class="op" id="4499306">,</span>&nbsp;<span class="ident" id="4499308">err</span>&nbsp;<span class="builtintype" id="4499312">error</span><span class="op" id="4499317">)</span>&nbsp;<span class="op" id="4499319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4499322">offset</span>&nbsp;<span class="op" id="4499329">=</span>&nbsp;<span class="ident" id="4499331">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4499343">for</span>&nbsp;<span class="ident" id="4499347">shifted</span>&nbsp;<span class="op" id="4499355">:=</span>&nbsp;<span class="num" id="4499358">0</span><span class="op" id="4499359">;</span>&nbsp;<span class="ident" id="4499361">offset</span>&nbsp;<span class="op" id="4499368">&lt;</span>&nbsp;<span class="builtinfunc" id="4499370">len</span><span class="op" id="4499373">(</span><span class="ident" id="4499374">bytes</span><span class="op" id="4499379">)</span><span class="op" id="4499380">;</span>&nbsp;<span class="ident" id="4499382">shifted</span><span class="op" id="4499389">++</span>&nbsp;<span class="op" id="4499392">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4499396">if</span>&nbsp;<span class="ident" id="4499399">shifted</span>&nbsp;<span class="op" id="4499407">&gt;</span>&nbsp;<span class="num" id="4499409">4</span>&nbsp;<span class="op" id="4499411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4499416">err</span>&nbsp;<span class="op" id="4499420">=</span>&nbsp;<span class="ident" id="4499422">StructuralError</span><span class="op" id="4499437">{</span><span class="string" id="4499438">&#34;base&nbsp;128&nbsp;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4499466">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4499471">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4499480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4499484">ret</span>&nbsp;<span class="op" id="4499488">&lt;&lt;=</span>&nbsp;<span class="num" id="4499492">7</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4499496">b</span>&nbsp;<span class="op" id="4499498">:=</span>&nbsp;<span class="ident" id="4499501">bytes</span><span class="op" id="4499506">[</span><span class="ident" id="4499507">offset</span><span class="op" id="4499513">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4499517">ret</span>&nbsp;<span class="op" id="4499521">|=</span>&nbsp;<span class="builtintype" id="4499524">int</span><span class="op" id="4499527">(</span><span class="ident" id="4499528">b</span>&nbsp;<span class="op" id="4499530">&amp;</span>&nbsp;<span class="num" id="4499532">0x7f</span><span class="op" id="4499536">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4499540">offset</span><span class="op" id="4499546">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4499551">if</span>&nbsp;<span class="ident" id="4499554">b</span><span class="op" id="4499555">&amp;</span><span class="num" id="4499556">0x80</span>&nbsp;<span class="op" id="4499561">==</span>&nbsp;<span class="num" id="4499564">0</span>&nbsp;<span class="op" id="4499566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4499571">return</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4499580">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4499583">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4499586">err</span>&nbsp;<span class="op" id="4499590">=</span>&nbsp;<span class="ident" id="4499592">SyntaxError</span><span class="op" id="4499603">{</span><span class="string" id="4499604">&#34;truncated&nbsp;base&nbsp;128&nbsp;integer&#34;</span><span class="op" id="4499632">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4499635">return</span><br>
<span class="lineno"></span><span class="op" id="4499642">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="4499645">//&nbsp;UTCTime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4499657">func</span>&nbsp;<span class="ident" id="4499662">parseUTCTime</span><span class="op" id="4499674">(</span><span class="ident" id="4499675">bytes</span>&nbsp;<span class="op" id="4499681">[</span><span class="op" id="4499682">]</span><span class="builtintype" id="4499683">byte</span><span class="op" id="4499687">)</span>&nbsp;<span class="op" id="4499689">(</span><span class="ident" id="4499690">ret</span>&nbsp;<span class="ident" id="4499694">time</span><span class="op" id="4499698">.</span><span class="ident" id="4499699">Time</span><span class="op" id="4499703">,</span>&nbsp;<span class="ident" id="4499705">err</span>&nbsp;<span class="builtintype" id="4499709">error</span><span class="op" id="4499714">)</span>&nbsp;<span class="op" id="4499716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4499719">s</span>&nbsp;<span class="op" id="4499721">:=</span>&nbsp;<span class="builtintype" id="4499724">string</span><span class="op" id="4499730">(</span><span class="ident" id="4499731">bytes</span><span class="op" id="4499736">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4499739">ret</span><span class="op" id="4499742">,</span>&nbsp;<span class="ident" id="4499744">err</span>&nbsp;<span class="op" id="4499748">=</span>&nbsp;<span class="ident" id="4499750">time</span><span class="op" id="4499754">.</span><span class="ident" id="4499755">Parse</span><span class="op" id="4499760">(</span><span class="string" id="4499761">&#34;0601021504Z0700&#34;</span><span class="op" id="4499778">,</span>&nbsp;<span class="ident" id="4499780">s</span><span class="op" id="4499781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4499784">if</span>&nbsp;<span class="ident" id="4499787">err</span>&nbsp;<span class="op" id="4499791">!=</span>&nbsp;<span class="builtintype" id="4499794">nil</span>&nbsp;<span class="op" id="4499798">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4499802">ret</span><span class="op" id="4499805">,</span>&nbsp;<span class="ident" id="4499807">err</span>&nbsp;<span class="op" id="4499811">=</span>&nbsp;<span class="ident" id="4499813">time</span><span class="op" id="4499817">.</span><span class="ident" id="4499818">Parse</span><span class="op" id="4499823">(</span><span class="string" id="4499824">&#34;060102150405Z0700&#34;</span><span class="op" id="4499843">,</span>&nbsp;<span class="ident" id="4499845">s</span><span class="op" id="4499846">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4499849">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4499852">if</span>&nbsp;<span class="ident" id="4499855">err</span>&nbsp;<span class="op" id="4499859">==</span>&nbsp;<span class="builtintype" id="4499862">nil</span>&nbsp;<span class="op" id="4499866">&amp;&amp;</span>&nbsp;<span class="ident" id="4499869">ret</span><span class="op" id="4499872">.</span><span class="ident" id="4499873">Year</span><span class="op" id="4499877">(</span><span class="op" id="4499878">)</span>&nbsp;<span class="op" id="4499880">&gt;=</span>&nbsp;<span class="num" id="4499883">2050</span>&nbsp;<span class="op" id="4499888">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4499892">//&nbsp;UTCTime&nbsp;only&nbsp;encodes&nbsp;times&nbsp;prior&nbsp;to&nbsp;2050.&nbsp;See&nbsp;https://tools.ietf.org/html/rfc5280#section-4.1.2.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4499997">ret</span>&nbsp;<span class="op" id="4500001">=</span>&nbsp;<span class="ident" id="4500003">ret</span><span class="op" id="4500006">.</span><span class="ident" id="4500007">AddDate</span><span class="op" id="4500014">(</span><span class="op" id="4500015">-</span><span class="num" id="4500016">100</span><span class="op" id="4500019">,</span>&nbsp;<span class="num" id="4500021">0</span><span class="op" id="4500022">,</span>&nbsp;<span class="num" id="4500024">0</span><span class="op" id="4500025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4500028">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4500032">return</span><br>
<span class="lineno">300</span><span class="op" id="4500039">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4500042">//&nbsp;parseGeneralizedTime&nbsp;parses&nbsp;the&nbsp;GeneralizedTime&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="4500119">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4500154">func</span>&nbsp;<span class="ident" id="4500159">parseGeneralizedTime</span><span class="op" id="4500179">(</span><span class="ident" id="4500180">bytes</span>&nbsp;<span class="op" id="4500186">[</span><span class="op" id="4500187">]</span><span class="builtintype" id="4500188">byte</span><span class="op" id="4500192">)</span>&nbsp;<span class="op" id="4500194">(</span><span class="ident" id="4500195">ret</span>&nbsp;<span class="ident" id="4500199">time</span><span class="op" id="4500203">.</span><span class="ident" id="4500204">Time</span><span class="op" id="4500208">,</span>&nbsp;<span class="ident" id="4500210">err</span>&nbsp;<span class="builtintype" id="4500214">error</span><span class="op" id="4500219">)</span>&nbsp;<span class="op" id="4500221">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4500224">return</span>&nbsp;<span class="ident" id="4500231">time</span><span class="op" id="4500235">.</span><span class="ident" id="4500236">Parse</span><span class="op" id="4500241">(</span><span class="string" id="4500242">&#34;20060102150405Z0700&#34;</span><span class="op" id="4500263">,</span>&nbsp;<span class="builtintype" id="4500265">string</span><span class="op" id="4500271">(</span><span class="ident" id="4500272">bytes</span><span class="op" id="4500277">)</span><span class="op" id="4500278">)</span><br>
<span class="lineno"></span><span class="op" id="4500280">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4500283">//&nbsp;PrintableString</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4500303">//&nbsp;parsePrintableString&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;PrintableString&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4500378">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4500403">func</span>&nbsp;<span class="ident" id="4500408">parsePrintableString</span><span class="op" id="4500428">(</span><span class="ident" id="4500429">bytes</span>&nbsp;<span class="op" id="4500435">[</span><span class="op" id="4500436">]</span><span class="builtintype" id="4500437">byte</span><span class="op" id="4500441">)</span>&nbsp;<span class="op" id="4500443">(</span><span class="ident" id="4500444">ret</span>&nbsp;<span class="builtintype" id="4500448">string</span><span class="op" id="4500454">,</span>&nbsp;<span class="ident" id="4500456">err</span>&nbsp;<span class="builtintype" id="4500460">error</span><span class="op" id="4500465">)</span>&nbsp;<span class="op" id="4500467">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4500470">for</span>&nbsp;<span class="ident" id="4500474">_</span><span class="op" id="4500475">,</span>&nbsp;<span class="ident" id="4500477">b</span>&nbsp;<span class="op" id="4500479">:=</span>&nbsp;<span class="keyword" id="4500482">range</span>&nbsp;<span class="ident" id="4500488">bytes</span>&nbsp;<span class="op" id="4500494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4500498">if</span>&nbsp;<span class="op" id="4500501">!</span><span class="ident" id="4500502">isPrintable</span><span class="op" id="4500513">(</span><span class="ident" id="4500514">b</span><span class="op" id="4500515">)</span>&nbsp;<span class="op" id="4500517">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4500522">err</span>&nbsp;<span class="op" id="4500526">=</span>&nbsp;<span class="ident" id="4500528">SyntaxError</span><span class="op" id="4500539">{</span><span class="string" id="4500540">&#34;PrintableString&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4500584">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4500589">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4500598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4500601">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4500604">ret</span>&nbsp;<span class="op" id="4500608">=</span>&nbsp;<span class="builtintype" id="4500610">string</span><span class="op" id="4500616">(</span><span class="ident" id="4500617">bytes</span><span class="op" id="4500622">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4500625">return</span><br>
<span class="lineno"></span><span class="op" id="4500632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4500635">//&nbsp;isPrintable&nbsp;returns&nbsp;true&nbsp;iff&nbsp;the&nbsp;given&nbsp;b&nbsp;is&nbsp;in&nbsp;the&nbsp;ASN.1&nbsp;PrintableString&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="4500716">func</span>&nbsp;<span class="ident" id="4500721">isPrintable</span><span class="op" id="4500732">(</span><span class="ident" id="4500733">b</span>&nbsp;<span class="builtintype" id="4500735">byte</span><span class="op" id="4500739">)</span>&nbsp;<span class="builtintype" id="4500741">bool</span>&nbsp;<span class="op" id="4500746">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4500749">return</span>&nbsp;<span class="string" id="4500756">&#39;a&#39;</span>&nbsp;<span class="op" id="4500760">&lt;=</span>&nbsp;<span class="ident" id="4500763">b</span>&nbsp;<span class="op" id="4500765">&amp;&amp;</span>&nbsp;<span class="ident" id="4500768">b</span>&nbsp;<span class="op" id="4500770">&lt;=</span>&nbsp;<span class="string" id="4500773">&#39;z&#39;</span>&nbsp;<span class="op" id="4500777">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4500782">&#39;A&#39;</span>&nbsp;<span class="op" id="4500786">&lt;=</span>&nbsp;<span class="ident" id="4500789">b</span>&nbsp;<span class="op" id="4500791">&amp;&amp;</span>&nbsp;<span class="ident" id="4500794">b</span>&nbsp;<span class="op" id="4500796">&lt;=</span>&nbsp;<span class="string" id="4500799">&#39;Z&#39;</span>&nbsp;<span class="op" id="4500803">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4500808">&#39;0&#39;</span>&nbsp;<span class="op" id="4500812">&lt;=</span>&nbsp;<span class="ident" id="4500815">b</span>&nbsp;<span class="op" id="4500817">&amp;&amp;</span>&nbsp;<span class="ident" id="4500820">b</span>&nbsp;<span class="op" id="4500822">&lt;=</span>&nbsp;<span class="string" id="4500825">&#39;9&#39;</span>&nbsp;<span class="op" id="4500829">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4500834">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="4500839">&lt;=</span>&nbsp;<span class="ident" id="4500842">b</span>&nbsp;<span class="op" id="4500844">&amp;&amp;</span>&nbsp;<span class="ident" id="4500847">b</span>&nbsp;<span class="op" id="4500849">&lt;=</span>&nbsp;<span class="string" id="4500852">&#39;)&#39;</span>&nbsp;<span class="op" id="4500856">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4500861">&#39;+&#39;</span>&nbsp;<span class="op" id="4500865">&lt;=</span>&nbsp;<span class="ident" id="4500868">b</span>&nbsp;<span class="op" id="4500870">&amp;&amp;</span>&nbsp;<span class="ident" id="4500873">b</span>&nbsp;<span class="op" id="4500875">&lt;=</span>&nbsp;<span class="string" id="4500878">&#39;/&#39;</span>&nbsp;<span class="op" id="4500882">||</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4500887">b</span>&nbsp;<span class="op" id="4500889">==</span>&nbsp;<span class="string" id="4500892">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4500896">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4500901">b</span>&nbsp;<span class="op" id="4500903">==</span>&nbsp;<span class="string" id="4500906">&#39;:&#39;</span>&nbsp;<span class="op" id="4500910">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4500915">b</span>&nbsp;<span class="op" id="4500917">==</span>&nbsp;<span class="string" id="4500920">&#39;=&#39;</span>&nbsp;<span class="op" id="4500924">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4500929">b</span>&nbsp;<span class="op" id="4500931">==</span>&nbsp;<span class="string" id="4500934">&#39;?&#39;</span>&nbsp;<span class="op" id="4500938">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4500943">//&nbsp;This&nbsp;is&nbsp;technically&nbsp;not&nbsp;allowed&nbsp;in&nbsp;a&nbsp;PrintableString.</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4501002">//&nbsp;However,&nbsp;x509&nbsp;certificates&nbsp;with&nbsp;wildcard&nbsp;strings&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4501062">//&nbsp;always&nbsp;use&nbsp;the&nbsp;correct&nbsp;string&nbsp;type&nbsp;so&nbsp;we&nbsp;permit&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4501119">b</span>&nbsp;<span class="op" id="4501121">==</span>&nbsp;<span class="string" id="4501124">&#39;*&#39;</span><br>
<span class="lineno"></span><span class="op" id="4501128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="4501131">//&nbsp;IA5String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4501145">//&nbsp;parseIA5String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;IA5String&nbsp;(ASCII&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4501218">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4501248">func</span>&nbsp;<span class="ident" id="4501253">parseIA5String</span><span class="op" id="4501267">(</span><span class="ident" id="4501268">bytes</span>&nbsp;<span class="op" id="4501274">[</span><span class="op" id="4501275">]</span><span class="builtintype" id="4501276">byte</span><span class="op" id="4501280">)</span>&nbsp;<span class="op" id="4501282">(</span><span class="ident" id="4501283">ret</span>&nbsp;<span class="builtintype" id="4501287">string</span><span class="op" id="4501293">,</span>&nbsp;<span class="ident" id="4501295">err</span>&nbsp;<span class="builtintype" id="4501299">error</span><span class="op" id="4501304">)</span>&nbsp;<span class="op" id="4501306">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4501309">for</span>&nbsp;<span class="ident" id="4501313">_</span><span class="op" id="4501314">,</span>&nbsp;<span class="ident" id="4501316">b</span>&nbsp;<span class="op" id="4501318">:=</span>&nbsp;<span class="keyword" id="4501321">range</span>&nbsp;<span class="ident" id="4501327">bytes</span>&nbsp;<span class="op" id="4501333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4501337">if</span>&nbsp;<span class="ident" id="4501340">b</span>&nbsp;<span class="op" id="4501342">&gt;=</span>&nbsp;<span class="num" id="4501345">0x80</span>&nbsp;<span class="op" id="4501350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4501355">err</span>&nbsp;<span class="op" id="4501359">=</span>&nbsp;<span class="ident" id="4501361">SyntaxError</span><span class="op" id="4501372">{</span><span class="string" id="4501373">&#34;IA5String&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4501411">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4501416">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4501425">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4501428">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4501431">ret</span>&nbsp;<span class="op" id="4501435">=</span>&nbsp;<span class="builtintype" id="4501437">string</span><span class="op" id="4501443">(</span><span class="ident" id="4501444">bytes</span><span class="op" id="4501449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4501452">return</span><br>
<span class="lineno"></span><span class="op" id="4501459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="4501462">//&nbsp;T61String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4501476">//&nbsp;parseT61String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;T61String&nbsp;(8-bit&nbsp;clean&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4501555">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4501585">func</span>&nbsp;<span class="ident" id="4501590">parseT61String</span><span class="op" id="4501604">(</span><span class="ident" id="4501605">bytes</span>&nbsp;<span class="op" id="4501611">[</span><span class="op" id="4501612">]</span><span class="builtintype" id="4501613">byte</span><span class="op" id="4501617">)</span>&nbsp;<span class="op" id="4501619">(</span><span class="ident" id="4501620">ret</span>&nbsp;<span class="builtintype" id="4501624">string</span><span class="op" id="4501630">,</span>&nbsp;<span class="ident" id="4501632">err</span>&nbsp;<span class="builtintype" id="4501636">error</span><span class="op" id="4501641">)</span>&nbsp;<span class="op" id="4501643">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4501646">return</span>&nbsp;<span class="builtintype" id="4501653">string</span><span class="op" id="4501659">(</span><span class="ident" id="4501660">bytes</span><span class="op" id="4501665">)</span><span class="op" id="4501666">,</span>&nbsp;<span class="builtintype" id="4501668">nil</span><br>
<span class="lineno"></span><span class="op" id="4501672">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4501675">//&nbsp;UTF8String</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="4501690">//&nbsp;parseUTF8String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;UTF8String&nbsp;(raw&nbsp;UTF-8)&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4501767">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4501792">func</span>&nbsp;<span class="ident" id="4501797">parseUTF8String</span><span class="op" id="4501812">(</span><span class="ident" id="4501813">bytes</span>&nbsp;<span class="op" id="4501819">[</span><span class="op" id="4501820">]</span><span class="builtintype" id="4501821">byte</span><span class="op" id="4501825">)</span>&nbsp;<span class="op" id="4501827">(</span><span class="ident" id="4501828">ret</span>&nbsp;<span class="builtintype" id="4501832">string</span><span class="op" id="4501838">,</span>&nbsp;<span class="ident" id="4501840">err</span>&nbsp;<span class="builtintype" id="4501844">error</span><span class="op" id="4501849">)</span>&nbsp;<span class="op" id="4501851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4501854">return</span>&nbsp;<span class="builtintype" id="4501861">string</span><span class="op" id="4501867">(</span><span class="ident" id="4501868">bytes</span><span class="op" id="4501873">)</span><span class="op" id="4501874">,</span>&nbsp;<span class="builtintype" id="4501876">nil</span><br>
<span class="lineno"></span><span class="op" id="4501880">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="4501883">//&nbsp;A&nbsp;RawValue&nbsp;represents&nbsp;an&nbsp;undecoded&nbsp;ASN.1&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="4501935">type</span>&nbsp;<span class="ident" id="4501940">RawValue</span>&nbsp;<span class="keyword" id="4501949">struct</span>&nbsp;<span class="op" id="4501956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4501959">Class</span><span class="op" id="4501964">,</span>&nbsp;<span class="ident" id="4501966">Tag</span>&nbsp;<span class="builtintype" id="4501970">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4501975">IsCompound</span>&nbsp;<span class="builtintype" id="4501986">bool</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4501992">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4502003">[</span><span class="op" id="4502004">]</span><span class="builtintype" id="4502005">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4502011">FullBytes</span>&nbsp;&nbsp;<span class="op" id="4502022">[</span><span class="op" id="4502023">]</span><span class="builtintype" id="4502024">byte</span>&nbsp;<span class="comment" id="4502029">//&nbsp;includes&nbsp;the&nbsp;tag&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span><span class="op" id="4502060">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4502063">//&nbsp;RawContent&nbsp;is&nbsp;used&nbsp;to&nbsp;signal&nbsp;that&nbsp;the&nbsp;undecoded,&nbsp;DER&nbsp;data&nbsp;needs&nbsp;to&nbsp;be</span><br>
<span class="lineno">380</span><span class="comment" id="4502136">//&nbsp;preserved&nbsp;for&nbsp;a&nbsp;struct.&nbsp;To&nbsp;use&nbsp;it,&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;the&nbsp;struct&nbsp;must&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="4502214">//&nbsp;this&nbsp;type.&nbsp;It&#39;s&nbsp;an&nbsp;error&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;fields&nbsp;to&nbsp;have&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4502289">type</span>&nbsp;<span class="ident" id="4502294">RawContent</span>&nbsp;<span class="op" id="4502305">[</span><span class="op" id="4502306">]</span><span class="builtintype" id="4502307">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4502313">//&nbsp;Tagging</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="comment" id="4502325">//&nbsp;parseTagAndLength&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;tag&nbsp;and&nbsp;length&nbsp;pair&nbsp;from&nbsp;the&nbsp;given&nbsp;offset</span><br>
<span class="lineno"></span><span class="comment" id="4502404">//&nbsp;into&nbsp;a&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;parsed&nbsp;data&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.&nbsp;SET&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4502481">//&nbsp;SET&nbsp;OF&nbsp;(tag&nbsp;17)&nbsp;are&nbsp;mapped&nbsp;to&nbsp;SEQUENCE&nbsp;and&nbsp;SEQUENCE&nbsp;OF&nbsp;(tag&nbsp;16)&nbsp;since&nbsp;we</span><br>
<span class="lineno"></span><span class="comment" id="4502557">//&nbsp;don&#39;t&nbsp;distinguish&nbsp;between&nbsp;ordered&nbsp;and&nbsp;unordered&nbsp;objects&nbsp;in&nbsp;this&nbsp;code.</span><br>
<span class="lineno">390</span><span class="keyword" id="4502630">func</span>&nbsp;<span class="ident" id="4502635">parseTagAndLength</span><span class="op" id="4502652">(</span><span class="ident" id="4502653">bytes</span>&nbsp;<span class="op" id="4502659">[</span><span class="op" id="4502660">]</span><span class="builtintype" id="4502661">byte</span><span class="op" id="4502665">,</span>&nbsp;<span class="ident" id="4502667">initOffset</span>&nbsp;<span class="builtintype" id="4502678">int</span><span class="op" id="4502681">)</span>&nbsp;<span class="op" id="4502683">(</span><span class="ident" id="4502684">ret</span>&nbsp;<span class="ident" id="4502688">tagAndLength</span><span class="op" id="4502700">,</span>&nbsp;<span class="ident" id="4502702">offset</span>&nbsp;<span class="builtintype" id="4502709">int</span><span class="op" id="4502712">,</span>&nbsp;<span class="ident" id="4502714">err</span>&nbsp;<span class="builtintype" id="4502718">error</span><span class="op" id="4502723">)</span>&nbsp;<span class="op" id="4502725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4502728">offset</span>&nbsp;<span class="op" id="4502735">=</span>&nbsp;<span class="ident" id="4502737">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4502749">b</span>&nbsp;<span class="op" id="4502751">:=</span>&nbsp;<span class="ident" id="4502754">bytes</span><span class="op" id="4502759">[</span><span class="ident" id="4502760">offset</span><span class="op" id="4502766">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4502769">offset</span><span class="op" id="4502775">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4502779">ret</span><span class="op" id="4502782">.</span><span class="ident" id="4502783">class</span>&nbsp;<span class="op" id="4502789">=</span>&nbsp;<span class="builtintype" id="4502791">int</span><span class="op" id="4502794">(</span><span class="ident" id="4502795">b</span>&nbsp;<span class="op" id="4502797">&gt;&gt;</span>&nbsp;<span class="num" id="4502800">6</span><span class="op" id="4502801">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4502804">ret</span><span class="op" id="4502807">.</span><span class="ident" id="4502808">isCompound</span>&nbsp;<span class="op" id="4502819">=</span>&nbsp;<span class="ident" id="4502821">b</span><span class="op" id="4502822">&amp;</span><span class="num" id="4502823">0x20</span>&nbsp;<span class="op" id="4502828">==</span>&nbsp;<span class="num" id="4502831">0x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4502837">ret</span><span class="op" id="4502840">.</span><span class="ident" id="4502841">tag</span>&nbsp;<span class="op" id="4502845">=</span>&nbsp;<span class="builtintype" id="4502847">int</span><span class="op" id="4502850">(</span><span class="ident" id="4502851">b</span>&nbsp;<span class="op" id="4502853">&amp;</span>&nbsp;<span class="num" id="4502855">0x1f</span><span class="op" id="4502859">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4502863">//&nbsp;If&nbsp;the&nbsp;bottom&nbsp;five&nbsp;bits&nbsp;are&nbsp;set,&nbsp;then&nbsp;the&nbsp;tag&nbsp;number&nbsp;is&nbsp;actually&nbsp;base&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4502941">//&nbsp;encoded&nbsp;afterwards</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4502964">if</span>&nbsp;<span class="ident" id="4502967">ret</span><span class="op" id="4502970">.</span><span class="ident" id="4502971">tag</span>&nbsp;<span class="op" id="4502975">==</span>&nbsp;<span class="num" id="4502978">0x1f</span>&nbsp;<span class="op" id="4502983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4502987">ret</span><span class="op" id="4502990">.</span><span class="ident" id="4502991">tag</span><span class="op" id="4502994">,</span>&nbsp;<span class="ident" id="4502996">offset</span><span class="op" id="4503002">,</span>&nbsp;<span class="ident" id="4503004">err</span>&nbsp;<span class="op" id="4503008">=</span>&nbsp;<span class="ident" id="4503010">parseBase128Int</span><span class="op" id="4503025">(</span><span class="ident" id="4503026">bytes</span><span class="op" id="4503031">,</span>&nbsp;<span class="ident" id="4503033">offset</span><span class="op" id="4503039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4503043">if</span>&nbsp;<span class="ident" id="4503046">err</span>&nbsp;<span class="op" id="4503050">!=</span>&nbsp;<span class="builtintype" id="4503053">nil</span>&nbsp;<span class="op" id="4503057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4503062">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4503071">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4503074">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4503077">if</span>&nbsp;<span class="ident" id="4503080">offset</span>&nbsp;<span class="op" id="4503087">&gt;=</span>&nbsp;<span class="builtinfunc" id="4503090">len</span><span class="op" id="4503093">(</span><span class="ident" id="4503094">bytes</span><span class="op" id="4503099">)</span>&nbsp;<span class="op" id="4503101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4503105">err</span>&nbsp;<span class="op" id="4503109">=</span>&nbsp;<span class="ident" id="4503111">SyntaxError</span><span class="op" id="4503122">{</span><span class="string" id="4503123">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4503148">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4503152">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4503160">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4503163">b</span>&nbsp;<span class="op" id="4503165">=</span>&nbsp;<span class="ident" id="4503167">bytes</span><span class="op" id="4503172">[</span><span class="ident" id="4503173">offset</span><span class="op" id="4503179">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4503182">offset</span><span class="op" id="4503188">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4503192">if</span>&nbsp;<span class="ident" id="4503195">b</span><span class="op" id="4503196">&amp;</span><span class="num" id="4503197">0x80</span>&nbsp;<span class="op" id="4503202">==</span>&nbsp;<span class="num" id="4503205">0</span>&nbsp;<span class="op" id="4503207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4503211">//&nbsp;The&nbsp;length&nbsp;is&nbsp;encoded&nbsp;in&nbsp;the&nbsp;bottom&nbsp;7&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4503260">ret</span><span class="op" id="4503263">.</span><span class="ident" id="4503264">length</span>&nbsp;<span class="op" id="4503271">=</span>&nbsp;<span class="builtintype" id="4503273">int</span><span class="op" id="4503276">(</span><span class="ident" id="4503277">b</span>&nbsp;<span class="op" id="4503279">&amp;</span>&nbsp;<span class="num" id="4503281">0x7f</span><span class="op" id="4503285">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4503288">}</span>&nbsp;<span class="keyword" id="4503290">else</span>&nbsp;<span class="op" id="4503295">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4503299">//&nbsp;Bottom&nbsp;7&nbsp;bits&nbsp;give&nbsp;the&nbsp;number&nbsp;of&nbsp;length&nbsp;bytes&nbsp;to&nbsp;follow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4503361">numBytes</span>&nbsp;<span class="op" id="4503370">:=</span>&nbsp;<span class="builtintype" id="4503373">int</span><span class="op" id="4503376">(</span><span class="ident" id="4503377">b</span>&nbsp;<span class="op" id="4503379">&amp;</span>&nbsp;<span class="num" id="4503381">0x7f</span><span class="op" id="4503385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4503389">if</span>&nbsp;<span class="ident" id="4503392">numBytes</span>&nbsp;<span class="op" id="4503401">==</span>&nbsp;<span class="num" id="4503404">0</span>&nbsp;<span class="op" id="4503406">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4503411">err</span>&nbsp;<span class="op" id="4503415">=</span>&nbsp;<span class="ident" id="4503417">SyntaxError</span><span class="op" id="4503428">{</span><span class="string" id="4503429">&#34;indefinite&nbsp;length&nbsp;found&nbsp;(not&nbsp;DER)&#34;</span><span class="op" id="4503464">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4503469">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4503478">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4503482">ret</span><span class="op" id="4503485">.</span><span class="ident" id="4503486">length</span>&nbsp;<span class="op" id="4503493">=</span>&nbsp;<span class="num" id="4503495">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4503499">for</span>&nbsp;<span class="ident" id="4503503">i</span>&nbsp;<span class="op" id="4503505">:=</span>&nbsp;<span class="num" id="4503508">0</span><span class="op" id="4503509">;</span>&nbsp;<span class="ident" id="4503511">i</span>&nbsp;<span class="op" id="4503513">&lt;</span>&nbsp;<span class="ident" id="4503515">numBytes</span><span class="op" id="4503523">;</span>&nbsp;<span class="ident" id="4503525">i</span><span class="op" id="4503526">++</span>&nbsp;<span class="op" id="4503529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4503534">if</span>&nbsp;<span class="ident" id="4503537">offset</span>&nbsp;<span class="op" id="4503544">&gt;=</span>&nbsp;<span class="builtinfunc" id="4503547">len</span><span class="op" id="4503550">(</span><span class="ident" id="4503551">bytes</span><span class="op" id="4503556">)</span>&nbsp;<span class="op" id="4503558">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4503564">err</span>&nbsp;<span class="op" id="4503568">=</span>&nbsp;<span class="ident" id="4503570">SyntaxError</span><span class="op" id="4503581">{</span><span class="string" id="4503582">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4503607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4503613">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4503623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4503628">b</span>&nbsp;<span class="op" id="4503630">=</span>&nbsp;<span class="ident" id="4503632">bytes</span><span class="op" id="4503637">[</span><span class="ident" id="4503638">offset</span><span class="op" id="4503644">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4503649">offset</span><span class="op" id="4503655">++</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4503661">if</span>&nbsp;<span class="ident" id="4503664">ret</span><span class="op" id="4503667">.</span><span class="ident" id="4503668">length</span>&nbsp;<span class="op" id="4503675">&gt;=</span>&nbsp;<span class="num" id="4503678">1</span><span class="op" id="4503679">&lt;&lt;</span><span class="num" id="4503681">23</span>&nbsp;<span class="op" id="4503684">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4503690">//&nbsp;We&nbsp;can&#39;t&nbsp;shift&nbsp;ret.length&nbsp;up&nbsp;without</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4503734">//&nbsp;overflowing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4503754">err</span>&nbsp;<span class="op" id="4503758">=</span>&nbsp;<span class="ident" id="4503760">StructuralError</span><span class="op" id="4503775">{</span><span class="string" id="4503776">&#34;length&nbsp;too&nbsp;large&#34;</span><span class="op" id="4503794">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4503800">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4503810">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4503815">ret</span><span class="op" id="4503818">.</span><span class="ident" id="4503819">length</span>&nbsp;<span class="op" id="4503826">&lt;&lt;=</span>&nbsp;<span class="num" id="4503830">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4503835">ret</span><span class="op" id="4503838">.</span><span class="ident" id="4503839">length</span>&nbsp;<span class="op" id="4503846">|=</span>&nbsp;<span class="builtintype" id="4503849">int</span><span class="op" id="4503852">(</span><span class="ident" id="4503853">b</span><span class="op" id="4503854">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4503859">if</span>&nbsp;<span class="ident" id="4503862">ret</span><span class="op" id="4503865">.</span><span class="ident" id="4503866">length</span>&nbsp;<span class="op" id="4503873">==</span>&nbsp;<span class="num" id="4503876">0</span>&nbsp;<span class="op" id="4503878">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4503884">//&nbsp;DER&nbsp;requires&nbsp;that&nbsp;lengths&nbsp;be&nbsp;minimal.</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4503929">err</span>&nbsp;<span class="op" id="4503933">=</span>&nbsp;<span class="ident" id="4503935">StructuralError</span><span class="op" id="4503950">{</span><span class="string" id="4503951">&#34;superfluous&nbsp;leading&nbsp;zeros&nbsp;in&nbsp;length&#34;</span><span class="op" id="4503988">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4503994">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4504004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4504008">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4504011">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4504015">return</span><br>
<span class="lineno"></span><span class="op" id="4504022">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4504025">//&nbsp;parseSequenceOf&nbsp;is&nbsp;used&nbsp;for&nbsp;SEQUENCE&nbsp;OF&nbsp;and&nbsp;SET&nbsp;OF&nbsp;values.&nbsp;It&nbsp;tries&nbsp;to&nbsp;parse</span><br>
<span class="lineno">450</span><span class="comment" id="4504105">//&nbsp;a&nbsp;number&nbsp;of&nbsp;ASN.1&nbsp;values&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;them&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4504181">//&nbsp;slice&nbsp;of&nbsp;Go&nbsp;values&nbsp;of&nbsp;the&nbsp;given&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4504222">func</span>&nbsp;<span class="ident" id="4504227">parseSequenceOf</span><span class="op" id="4504242">(</span><span class="ident" id="4504243">bytes</span>&nbsp;<span class="op" id="4504249">[</span><span class="op" id="4504250">]</span><span class="builtintype" id="4504251">byte</span><span class="op" id="4504255">,</span>&nbsp;<span class="ident" id="4504257">sliceType</span>&nbsp;<span class="ident" id="4504267">reflect</span><span class="op" id="4504274">.</span><span class="ident" id="4504275">Type</span><span class="op" id="4504279">,</span>&nbsp;<span class="ident" id="4504281">elemType</span>&nbsp;<span class="ident" id="4504290">reflect</span><span class="op" id="4504297">.</span><span class="ident" id="4504298">Type</span><span class="op" id="4504302">)</span>&nbsp;<span class="op" id="4504304">(</span><span class="ident" id="4504305">ret</span>&nbsp;<span class="ident" id="4504309">reflect</span><span class="op" id="4504316">.</span><span class="ident" id="4504317">Value</span><span class="op" id="4504322">,</span>&nbsp;<span class="ident" id="4504324">err</span>&nbsp;<span class="builtintype" id="4504328">error</span><span class="op" id="4504333">)</span>&nbsp;<span class="op" id="4504335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4504338">expectedTag</span><span class="op" id="4504349">,</span>&nbsp;<span class="ident" id="4504351">compoundType</span><span class="op" id="4504363">,</span>&nbsp;<span class="ident" id="4504365">ok</span>&nbsp;<span class="op" id="4504368">:=</span>&nbsp;<span class="ident" id="4504371">getUniversalType</span><span class="op" id="4504387">(</span><span class="ident" id="4504388">elemType</span><span class="op" id="4504396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4504399">if</span>&nbsp;<span class="op" id="4504402">!</span><span class="ident" id="4504403">ok</span>&nbsp;<span class="op" id="4504406">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4504410">err</span>&nbsp;<span class="op" id="4504414">=</span>&nbsp;<span class="ident" id="4504416">StructuralError</span><span class="op" id="4504431">{</span><span class="string" id="4504432">&#34;unknown&nbsp;Go&nbsp;type&nbsp;for&nbsp;slice&#34;</span><span class="op" id="4504459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4504463">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4504471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4504475">//&nbsp;First&nbsp;we&nbsp;iterate&nbsp;over&nbsp;the&nbsp;input&nbsp;and&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;elements,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4504545">//&nbsp;checking&nbsp;that&nbsp;the&nbsp;types&nbsp;are&nbsp;correct&nbsp;in&nbsp;each&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4504599">numElements</span>&nbsp;<span class="op" id="4504611">:=</span>&nbsp;<span class="num" id="4504614">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4504617">for</span>&nbsp;<span class="ident" id="4504621">offset</span>&nbsp;<span class="op" id="4504628">:=</span>&nbsp;<span class="num" id="4504631">0</span><span class="op" id="4504632">;</span>&nbsp;<span class="ident" id="4504634">offset</span>&nbsp;<span class="op" id="4504641">&lt;</span>&nbsp;<span class="builtinfunc" id="4504643">len</span><span class="op" id="4504646">(</span><span class="ident" id="4504647">bytes</span><span class="op" id="4504652">)</span><span class="op" id="4504653">;</span>&nbsp;<span class="op" id="4504655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4504659">var</span>&nbsp;<span class="ident" id="4504663">t</span>&nbsp;<span class="ident" id="4504665">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4504680">t</span><span class="op" id="4504681">,</span>&nbsp;<span class="ident" id="4504683">offset</span><span class="op" id="4504689">,</span>&nbsp;<span class="ident" id="4504691">err</span>&nbsp;<span class="op" id="4504695">=</span>&nbsp;<span class="ident" id="4504697">parseTagAndLength</span><span class="op" id="4504714">(</span><span class="ident" id="4504715">bytes</span><span class="op" id="4504720">,</span>&nbsp;<span class="ident" id="4504722">offset</span><span class="op" id="4504728">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4504732">if</span>&nbsp;<span class="ident" id="4504735">err</span>&nbsp;<span class="op" id="4504739">!=</span>&nbsp;<span class="builtintype" id="4504742">nil</span>&nbsp;<span class="op" id="4504746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4504751">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4504760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4504764">switch</span>&nbsp;<span class="ident" id="4504771">t</span><span class="op" id="4504772">.</span><span class="ident" id="4504773">tag</span>&nbsp;<span class="op" id="4504777">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4504781">case</span>&nbsp;<span class="ident" id="4504786">tagIA5String</span><span class="op" id="4504798">,</span>&nbsp;<span class="ident" id="4504800">tagGeneralString</span><span class="op" id="4504816">,</span>&nbsp;<span class="ident" id="4504818">tagT61String</span><span class="op" id="4504830">,</span>&nbsp;<span class="ident" id="4504832">tagUTF8String</span><span class="op" id="4504845">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4504850">//&nbsp;We&nbsp;pretend&nbsp;that&nbsp;various&nbsp;other&nbsp;string&nbsp;types&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4504903">//&nbsp;PRINTABLE&nbsp;STRINGs&nbsp;so&nbsp;that&nbsp;a&nbsp;sequence&nbsp;of&nbsp;them&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4504961">//&nbsp;parsed&nbsp;into&nbsp;a&nbsp;[]string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4504991">t</span><span class="op" id="4504992">.</span><span class="ident" id="4504993">tag</span>&nbsp;<span class="op" id="4504997">=</span>&nbsp;<span class="ident" id="4504999">tagPrintableString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4505020">case</span>&nbsp;<span class="ident" id="4505025">tagGeneralizedTime</span><span class="op" id="4505043">,</span>&nbsp;<span class="ident" id="4505045">tagUTCTime</span><span class="op" id="4505055">:</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4505060">//&nbsp;Likewise,&nbsp;both&nbsp;time&nbsp;types&nbsp;are&nbsp;treated&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505114">t</span><span class="op" id="4505115">.</span><span class="ident" id="4505116">tag</span>&nbsp;<span class="op" id="4505120">=</span>&nbsp;<span class="ident" id="4505122">tagUTCTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4505135">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4505140">if</span>&nbsp;<span class="ident" id="4505143">t</span><span class="op" id="4505144">.</span><span class="ident" id="4505145">class</span>&nbsp;<span class="op" id="4505151">!=</span>&nbsp;<span class="ident" id="4505154">classUniversal</span>&nbsp;<span class="op" id="4505169">||</span>&nbsp;<span class="ident" id="4505172">t</span><span class="op" id="4505173">.</span><span class="ident" id="4505174">isCompound</span>&nbsp;<span class="op" id="4505185">!=</span>&nbsp;<span class="ident" id="4505188">compoundType</span>&nbsp;<span class="op" id="4505201">||</span>&nbsp;<span class="ident" id="4505204">t</span><span class="op" id="4505205">.</span><span class="ident" id="4505206">tag</span>&nbsp;<span class="op" id="4505210">!=</span>&nbsp;<span class="ident" id="4505213">expectedTag</span>&nbsp;<span class="op" id="4505225">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505230">err</span>&nbsp;<span class="op" id="4505234">=</span>&nbsp;<span class="ident" id="4505236">StructuralError</span><span class="op" id="4505251">{</span><span class="string" id="4505252">&#34;sequence&nbsp;tag&nbsp;mismatch&#34;</span><span class="op" id="4505275">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4505280">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4505289">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4505293">if</span>&nbsp;<span class="ident" id="4505296">invalidLength</span><span class="op" id="4505309">(</span><span class="ident" id="4505310">offset</span><span class="op" id="4505316">,</span>&nbsp;<span class="ident" id="4505318">t</span><span class="op" id="4505319">.</span><span class="ident" id="4505320">length</span><span class="op" id="4505326">,</span>&nbsp;<span class="builtinfunc" id="4505328">len</span><span class="op" id="4505331">(</span><span class="ident" id="4505332">bytes</span><span class="op" id="4505337">)</span><span class="op" id="4505338">)</span>&nbsp;<span class="op" id="4505340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505345">err</span>&nbsp;<span class="op" id="4505349">=</span>&nbsp;<span class="ident" id="4505351">SyntaxError</span><span class="op" id="4505362">{</span><span class="string" id="4505363">&#34;truncated&nbsp;sequence&#34;</span><span class="op" id="4505383">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4505388">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4505397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505401">offset</span>&nbsp;<span class="op" id="4505408">+=</span>&nbsp;<span class="ident" id="4505411">t</span><span class="op" id="4505412">.</span><span class="ident" id="4505413">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505422">numElements</span><span class="op" id="4505433">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4505437">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505440">ret</span>&nbsp;<span class="op" id="4505444">=</span>&nbsp;<span class="ident" id="4505446">reflect</span><span class="op" id="4505453">.</span><span class="ident" id="4505454">MakeSlice</span><span class="op" id="4505463">(</span><span class="ident" id="4505464">sliceType</span><span class="op" id="4505473">,</span>&nbsp;<span class="ident" id="4505475">numElements</span><span class="op" id="4505486">,</span>&nbsp;<span class="ident" id="4505488">numElements</span><span class="op" id="4505499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505502">params</span>&nbsp;<span class="op" id="4505509">:=</span>&nbsp;<span class="ident" id="4505512">fieldParameters</span><span class="op" id="4505527">{</span><span class="op" id="4505528">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505531">offset</span>&nbsp;<span class="op" id="4505538">:=</span>&nbsp;<span class="num" id="4505541">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4505544">for</span>&nbsp;<span class="ident" id="4505548">i</span>&nbsp;<span class="op" id="4505550">:=</span>&nbsp;<span class="num" id="4505553">0</span><span class="op" id="4505554">;</span>&nbsp;<span class="ident" id="4505556">i</span>&nbsp;<span class="op" id="4505558">&lt;</span>&nbsp;<span class="ident" id="4505560">numElements</span><span class="op" id="4505571">;</span>&nbsp;<span class="ident" id="4505573">i</span><span class="op" id="4505574">++</span>&nbsp;<span class="op" id="4505577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505581">offset</span><span class="op" id="4505587">,</span>&nbsp;<span class="ident" id="4505589">err</span>&nbsp;<span class="op" id="4505593">=</span>&nbsp;<span class="ident" id="4505595">parseField</span><span class="op" id="4505605">(</span><span class="ident" id="4505606">ret</span><span class="op" id="4505609">.</span><span class="ident" id="4505610">Index</span><span class="op" id="4505615">(</span><span class="ident" id="4505616">i</span><span class="op" id="4505617">)</span><span class="op" id="4505618">,</span>&nbsp;<span class="ident" id="4505620">bytes</span><span class="op" id="4505625">,</span>&nbsp;<span class="ident" id="4505627">offset</span><span class="op" id="4505633">,</span>&nbsp;<span class="ident" id="4505635">params</span><span class="op" id="4505641">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4505645">if</span>&nbsp;<span class="ident" id="4505648">err</span>&nbsp;<span class="op" id="4505652">!=</span>&nbsp;<span class="builtintype" id="4505655">nil</span>&nbsp;<span class="op" id="4505659">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4505664">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4505673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4505676">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4505679">return</span><br>
<span class="lineno">500</span><span class="op" id="4505686">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4505689">var</span>&nbsp;<span class="op" id="4505693">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505696">bitStringType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4505717">=</span>&nbsp;<span class="ident" id="4505719">reflect</span><span class="op" id="4505726">.</span><span class="ident" id="4505727">TypeOf</span><span class="op" id="4505733">(</span><span class="ident" id="4505734">BitString</span><span class="op" id="4505743">{</span><span class="op" id="4505744">}</span><span class="op" id="4505745">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505748">objectIdentifierType</span>&nbsp;<span class="op" id="4505769">=</span>&nbsp;<span class="ident" id="4505771">reflect</span><span class="op" id="4505778">.</span><span class="ident" id="4505779">TypeOf</span><span class="op" id="4505785">(</span><span class="ident" id="4505786">ObjectIdentifier</span><span class="op" id="4505802">{</span><span class="op" id="4505803">}</span><span class="op" id="4505804">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505807">enumeratedType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4505828">=</span>&nbsp;<span class="ident" id="4505830">reflect</span><span class="op" id="4505837">.</span><span class="ident" id="4505838">TypeOf</span><span class="op" id="4505844">(</span><span class="ident" id="4505845">Enumerated</span><span class="op" id="4505855">(</span><span class="num" id="4505856">0</span><span class="op" id="4505857">)</span><span class="op" id="4505858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505861">flagType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4505882">=</span>&nbsp;<span class="ident" id="4505884">reflect</span><span class="op" id="4505891">.</span><span class="ident" id="4505892">TypeOf</span><span class="op" id="4505898">(</span><span class="ident" id="4505899">Flag</span><span class="op" id="4505903">(</span><span class="builtintype" id="4505904">false</span><span class="op" id="4505909">)</span><span class="op" id="4505910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505913">timeType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4505934">=</span>&nbsp;<span class="ident" id="4505936">reflect</span><span class="op" id="4505943">.</span><span class="ident" id="4505944">TypeOf</span><span class="op" id="4505950">(</span><span class="ident" id="4505951">time</span><span class="op" id="4505955">.</span><span class="ident" id="4505956">Time</span><span class="op" id="4505960">{</span><span class="op" id="4505961">}</span><span class="op" id="4505962">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4505965">rawValueType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4505986">=</span>&nbsp;<span class="ident" id="4505988">reflect</span><span class="op" id="4505995">.</span><span class="ident" id="4505996">TypeOf</span><span class="op" id="4506002">(</span><span class="ident" id="4506003">RawValue</span><span class="op" id="4506011">{</span><span class="op" id="4506012">}</span><span class="op" id="4506013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4506016">rawContentsType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4506037">=</span>&nbsp;<span class="ident" id="4506039">reflect</span><span class="op" id="4506046">.</span><span class="ident" id="4506047">TypeOf</span><span class="op" id="4506053">(</span><span class="ident" id="4506054">RawContent</span><span class="op" id="4506064">(</span><span class="builtintype" id="4506065">nil</span><span class="op" id="4506068">)</span><span class="op" id="4506069">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4506072">bigIntType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4506093">=</span>&nbsp;<span class="ident" id="4506095">reflect</span><span class="op" id="4506102">.</span><span class="ident" id="4506103">TypeOf</span><span class="op" id="4506109">(</span><span class="builtinfunc" id="4506110">new</span><span class="op" id="4506113">(</span><span class="ident" id="4506114">big</span><span class="op" id="4506117">.</span><span class="ident" id="4506118">Int</span><span class="op" id="4506121">)</span><span class="op" id="4506122">)</span><br>
<span class="lineno"></span><span class="op" id="4506124">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4506127">//&nbsp;invalidLength&nbsp;returns&nbsp;true&nbsp;iff&nbsp;offset&nbsp;+&nbsp;length&nbsp;&gt;&nbsp;sliceLength,&nbsp;or&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4506202">//&nbsp;addition&nbsp;would&nbsp;overflow.</span><br>
<span class="lineno">515</span><span class="keyword" id="4506230">func</span>&nbsp;<span class="ident" id="4506235">invalidLength</span><span class="op" id="4506248">(</span><span class="ident" id="4506249">offset</span><span class="op" id="4506255">,</span>&nbsp;<span class="ident" id="4506257">length</span><span class="op" id="4506263">,</span>&nbsp;<span class="ident" id="4506265">sliceLength</span>&nbsp;<span class="builtintype" id="4506277">int</span><span class="op" id="4506280">)</span>&nbsp;<span class="builtintype" id="4506282">bool</span>&nbsp;<span class="op" id="4506287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4506290">return</span>&nbsp;<span class="ident" id="4506297">offset</span><span class="op" id="4506303">+</span><span class="ident" id="4506304">length</span>&nbsp;<span class="op" id="4506311">&lt;</span>&nbsp;<span class="ident" id="4506313">offset</span>&nbsp;<span class="op" id="4506320">||</span>&nbsp;<span class="ident" id="4506323">offset</span><span class="op" id="4506329">+</span><span class="ident" id="4506330">length</span>&nbsp;<span class="op" id="4506337">&gt;</span>&nbsp;<span class="ident" id="4506339">sliceLength</span><br>
<span class="lineno"></span><span class="op" id="4506351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4506354">//&nbsp;parseField&nbsp;is&nbsp;the&nbsp;main&nbsp;parsing&nbsp;function.&nbsp;Given&nbsp;a&nbsp;byte&nbsp;slice&nbsp;and&nbsp;an&nbsp;offset</span><br>
<span class="lineno">520</span><span class="comment" id="4506431">//&nbsp;into&nbsp;the&nbsp;array,&nbsp;it&nbsp;will&nbsp;try&nbsp;to&nbsp;parse&nbsp;a&nbsp;suitable&nbsp;ASN.1&nbsp;value&nbsp;out&nbsp;and&nbsp;store&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4506511">//&nbsp;in&nbsp;the&nbsp;given&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4506534">func</span>&nbsp;<span class="ident" id="4506539">parseField</span><span class="op" id="4506549">(</span><span class="ident" id="4506550">v</span>&nbsp;<span class="ident" id="4506552">reflect</span><span class="op" id="4506559">.</span><span class="ident" id="4506560">Value</span><span class="op" id="4506565">,</span>&nbsp;<span class="ident" id="4506567">bytes</span>&nbsp;<span class="op" id="4506573">[</span><span class="op" id="4506574">]</span><span class="builtintype" id="4506575">byte</span><span class="op" id="4506579">,</span>&nbsp;<span class="ident" id="4506581">initOffset</span>&nbsp;<span class="builtintype" id="4506592">int</span><span class="op" id="4506595">,</span>&nbsp;<span class="ident" id="4506597">params</span>&nbsp;<span class="ident" id="4506604">fieldParameters</span><span class="op" id="4506619">)</span>&nbsp;<span class="op" id="4506621">(</span><span class="ident" id="4506622">offset</span>&nbsp;<span class="builtintype" id="4506629">int</span><span class="op" id="4506632">,</span>&nbsp;<span class="ident" id="4506634">err</span>&nbsp;<span class="builtintype" id="4506638">error</span><span class="op" id="4506643">)</span>&nbsp;<span class="op" id="4506645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4506648">offset</span>&nbsp;<span class="op" id="4506655">=</span>&nbsp;<span class="ident" id="4506657">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4506669">fieldType</span>&nbsp;<span class="op" id="4506679">:=</span>&nbsp;<span class="ident" id="4506682">v</span><span class="op" id="4506683">.</span><span class="ident" id="4506684">Type</span><span class="op" id="4506688">(</span><span class="op" id="4506689">)</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4506693">//&nbsp;If&nbsp;we&nbsp;have&nbsp;run&nbsp;out&nbsp;of&nbsp;data,&nbsp;it&nbsp;may&nbsp;be&nbsp;that&nbsp;there&nbsp;are&nbsp;optional&nbsp;elements&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4506780">if</span>&nbsp;<span class="ident" id="4506783">offset</span>&nbsp;<span class="op" id="4506790">==</span>&nbsp;<span class="builtinfunc" id="4506793">len</span><span class="op" id="4506796">(</span><span class="ident" id="4506797">bytes</span><span class="op" id="4506802">)</span>&nbsp;<span class="op" id="4506804">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4506808">if</span>&nbsp;<span class="op" id="4506811">!</span><span class="ident" id="4506812">setDefaultValue</span><span class="op" id="4506827">(</span><span class="ident" id="4506828">v</span><span class="op" id="4506829">,</span>&nbsp;<span class="ident" id="4506831">params</span><span class="op" id="4506837">)</span>&nbsp;<span class="op" id="4506839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4506844">err</span>&nbsp;<span class="op" id="4506848">=</span>&nbsp;<span class="ident" id="4506850">SyntaxError</span><span class="op" id="4506861">{</span><span class="string" id="4506862">&#34;sequence&nbsp;truncated&#34;</span><span class="op" id="4506882">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4506886">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4506890">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4506898">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4506902">//&nbsp;Deal&nbsp;with&nbsp;raw&nbsp;values.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4506928">if</span>&nbsp;<span class="ident" id="4506931">fieldType</span>&nbsp;<span class="op" id="4506941">==</span>&nbsp;<span class="ident" id="4506944">rawValueType</span>&nbsp;<span class="op" id="4506957">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4506961">var</span>&nbsp;<span class="ident" id="4506965">t</span>&nbsp;<span class="ident" id="4506967">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4506982">t</span><span class="op" id="4506983">,</span>&nbsp;<span class="ident" id="4506985">offset</span><span class="op" id="4506991">,</span>&nbsp;<span class="ident" id="4506993">err</span>&nbsp;<span class="op" id="4506997">=</span>&nbsp;<span class="ident" id="4506999">parseTagAndLength</span><span class="op" id="4507016">(</span><span class="ident" id="4507017">bytes</span><span class="op" id="4507022">,</span>&nbsp;<span class="ident" id="4507024">offset</span><span class="op" id="4507030">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507034">if</span>&nbsp;<span class="ident" id="4507037">err</span>&nbsp;<span class="op" id="4507041">!=</span>&nbsp;<span class="builtintype" id="4507044">nil</span>&nbsp;<span class="op" id="4507048">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507053">return</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4507062">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507066">if</span>&nbsp;<span class="ident" id="4507069">invalidLength</span><span class="op" id="4507082">(</span><span class="ident" id="4507083">offset</span><span class="op" id="4507089">,</span>&nbsp;<span class="ident" id="4507091">t</span><span class="op" id="4507092">.</span><span class="ident" id="4507093">length</span><span class="op" id="4507099">,</span>&nbsp;<span class="builtinfunc" id="4507101">len</span><span class="op" id="4507104">(</span><span class="ident" id="4507105">bytes</span><span class="op" id="4507110">)</span><span class="op" id="4507111">)</span>&nbsp;<span class="op" id="4507113">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507118">err</span>&nbsp;<span class="op" id="4507122">=</span>&nbsp;<span class="ident" id="4507124">SyntaxError</span><span class="op" id="4507135">{</span><span class="string" id="4507136">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4507152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507157">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4507166">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507170">result</span>&nbsp;<span class="op" id="4507177">:=</span>&nbsp;<span class="ident" id="4507180">RawValue</span><span class="op" id="4507188">{</span><span class="ident" id="4507189">t</span><span class="op" id="4507190">.</span><span class="ident" id="4507191">class</span><span class="op" id="4507196">,</span>&nbsp;<span class="ident" id="4507198">t</span><span class="op" id="4507199">.</span><span class="ident" id="4507200">tag</span><span class="op" id="4507203">,</span>&nbsp;<span class="ident" id="4507205">t</span><span class="op" id="4507206">.</span><span class="ident" id="4507207">isCompound</span><span class="op" id="4507217">,</span>&nbsp;<span class="ident" id="4507219">bytes</span><span class="op" id="4507224">[</span><span class="ident" id="4507225">offset</span>&nbsp;<span class="op" id="4507232">:</span>&nbsp;<span class="ident" id="4507234">offset</span><span class="op" id="4507240">+</span><span class="ident" id="4507241">t</span><span class="op" id="4507242">.</span><span class="ident" id="4507243">length</span><span class="op" id="4507249">]</span><span class="op" id="4507250">,</span>&nbsp;<span class="ident" id="4507252">bytes</span><span class="op" id="4507257">[</span><span class="ident" id="4507258">initOffset</span>&nbsp;<span class="op" id="4507269">:</span>&nbsp;<span class="ident" id="4507271">offset</span><span class="op" id="4507277">+</span><span class="ident" id="4507278">t</span><span class="op" id="4507279">.</span><span class="ident" id="4507280">length</span><span class="op" id="4507286">]</span><span class="op" id="4507287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507291">offset</span>&nbsp;<span class="op" id="4507298">+=</span>&nbsp;<span class="ident" id="4507301">t</span><span class="op" id="4507302">.</span><span class="ident" id="4507303">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507312">v</span><span class="op" id="4507313">.</span><span class="ident" id="4507314">Set</span><span class="op" id="4507317">(</span><span class="ident" id="4507318">reflect</span><span class="op" id="4507325">.</span><span class="ident" id="4507326">ValueOf</span><span class="op" id="4507333">(</span><span class="ident" id="4507334">result</span><span class="op" id="4507340">)</span><span class="op" id="4507341">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507345">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4507353">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4507357">//&nbsp;Deal&nbsp;with&nbsp;the&nbsp;ANY&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507385">if</span>&nbsp;<span class="ident" id="4507388">ifaceType</span>&nbsp;<span class="op" id="4507398">:=</span>&nbsp;<span class="ident" id="4507401">fieldType</span><span class="op" id="4507410">;</span>&nbsp;<span class="ident" id="4507412">ifaceType</span><span class="op" id="4507421">.</span><span class="ident" id="4507422">Kind</span><span class="op" id="4507426">(</span><span class="op" id="4507427">)</span>&nbsp;<span class="op" id="4507429">==</span>&nbsp;<span class="ident" id="4507432">reflect</span><span class="op" id="4507439">.</span><span class="ident" id="4507440">Interface</span>&nbsp;<span class="op" id="4507450">&amp;&amp;</span>&nbsp;<span class="ident" id="4507453">ifaceType</span><span class="op" id="4507462">.</span><span class="ident" id="4507463">NumMethod</span><span class="op" id="4507472">(</span><span class="op" id="4507473">)</span>&nbsp;<span class="op" id="4507475">==</span>&nbsp;<span class="num" id="4507478">0</span>&nbsp;<span class="op" id="4507480">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507484">var</span>&nbsp;<span class="ident" id="4507488">t</span>&nbsp;<span class="ident" id="4507490">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507505">t</span><span class="op" id="4507506">,</span>&nbsp;<span class="ident" id="4507508">offset</span><span class="op" id="4507514">,</span>&nbsp;<span class="ident" id="4507516">err</span>&nbsp;<span class="op" id="4507520">=</span>&nbsp;<span class="ident" id="4507522">parseTagAndLength</span><span class="op" id="4507539">(</span><span class="ident" id="4507540">bytes</span><span class="op" id="4507545">,</span>&nbsp;<span class="ident" id="4507547">offset</span><span class="op" id="4507553">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507557">if</span>&nbsp;<span class="ident" id="4507560">err</span>&nbsp;<span class="op" id="4507564">!=</span>&nbsp;<span class="builtintype" id="4507567">nil</span>&nbsp;<span class="op" id="4507571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507576">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4507585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507589">if</span>&nbsp;<span class="ident" id="4507592">invalidLength</span><span class="op" id="4507605">(</span><span class="ident" id="4507606">offset</span><span class="op" id="4507612">,</span>&nbsp;<span class="ident" id="4507614">t</span><span class="op" id="4507615">.</span><span class="ident" id="4507616">length</span><span class="op" id="4507622">,</span>&nbsp;<span class="builtinfunc" id="4507624">len</span><span class="op" id="4507627">(</span><span class="ident" id="4507628">bytes</span><span class="op" id="4507633">)</span><span class="op" id="4507634">)</span>&nbsp;<span class="op" id="4507636">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507641">err</span>&nbsp;<span class="op" id="4507645">=</span>&nbsp;<span class="ident" id="4507647">SyntaxError</span><span class="op" id="4507658">{</span><span class="string" id="4507659">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4507675">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507680">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4507689">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507693">var</span>&nbsp;<span class="ident" id="4507697">result</span>&nbsp;<span class="keyword" id="4507704">interface</span><span class="op" id="4507713">{</span><span class="op" id="4507714">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507718">if</span>&nbsp;<span class="op" id="4507721">!</span><span class="ident" id="4507722">t</span><span class="op" id="4507723">.</span><span class="ident" id="4507724">isCompound</span>&nbsp;<span class="op" id="4507735">&amp;&amp;</span>&nbsp;<span class="ident" id="4507738">t</span><span class="op" id="4507739">.</span><span class="ident" id="4507740">class</span>&nbsp;<span class="op" id="4507746">==</span>&nbsp;<span class="ident" id="4507749">classUniversal</span>&nbsp;<span class="op" id="4507764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507769">innerBytes</span>&nbsp;<span class="op" id="4507780">:=</span>&nbsp;<span class="ident" id="4507783">bytes</span><span class="op" id="4507788">[</span><span class="ident" id="4507789">offset</span>&nbsp;<span class="op" id="4507796">:</span>&nbsp;<span class="ident" id="4507798">offset</span><span class="op" id="4507804">+</span><span class="ident" id="4507805">t</span><span class="op" id="4507806">.</span><span class="ident" id="4507807">length</span><span class="op" id="4507813">]</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507818">switch</span>&nbsp;<span class="ident" id="4507825">t</span><span class="op" id="4507826">.</span><span class="ident" id="4507827">tag</span>&nbsp;<span class="op" id="4507831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507836">case</span>&nbsp;<span class="ident" id="4507841">tagPrintableString</span><span class="op" id="4507859">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507865">result</span><span class="op" id="4507871">,</span>&nbsp;<span class="ident" id="4507873">err</span>&nbsp;<span class="op" id="4507877">=</span>&nbsp;<span class="ident" id="4507879">parsePrintableString</span><span class="op" id="4507899">(</span><span class="ident" id="4507900">innerBytes</span><span class="op" id="4507910">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507915">case</span>&nbsp;<span class="ident" id="4507920">tagIA5String</span><span class="op" id="4507932">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4507938">result</span><span class="op" id="4507944">,</span>&nbsp;<span class="ident" id="4507946">err</span>&nbsp;<span class="op" id="4507950">=</span>&nbsp;<span class="ident" id="4507952">parseIA5String</span><span class="op" id="4507966">(</span><span class="ident" id="4507967">innerBytes</span><span class="op" id="4507977">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4507982">case</span>&nbsp;<span class="ident" id="4507987">tagT61String</span><span class="op" id="4507999">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508005">result</span><span class="op" id="4508011">,</span>&nbsp;<span class="ident" id="4508013">err</span>&nbsp;<span class="op" id="4508017">=</span>&nbsp;<span class="ident" id="4508019">parseT61String</span><span class="op" id="4508033">(</span><span class="ident" id="4508034">innerBytes</span><span class="op" id="4508044">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508049">case</span>&nbsp;<span class="ident" id="4508054">tagUTF8String</span><span class="op" id="4508067">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508073">result</span><span class="op" id="4508079">,</span>&nbsp;<span class="ident" id="4508081">err</span>&nbsp;<span class="op" id="4508085">=</span>&nbsp;<span class="ident" id="4508087">parseUTF8String</span><span class="op" id="4508102">(</span><span class="ident" id="4508103">innerBytes</span><span class="op" id="4508113">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508118">case</span>&nbsp;<span class="ident" id="4508123">tagInteger</span><span class="op" id="4508133">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508139">result</span><span class="op" id="4508145">,</span>&nbsp;<span class="ident" id="4508147">err</span>&nbsp;<span class="op" id="4508151">=</span>&nbsp;<span class="ident" id="4508153">parseInt64</span><span class="op" id="4508163">(</span><span class="ident" id="4508164">innerBytes</span><span class="op" id="4508174">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508179">case</span>&nbsp;<span class="ident" id="4508184">tagBitString</span><span class="op" id="4508196">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508202">result</span><span class="op" id="4508208">,</span>&nbsp;<span class="ident" id="4508210">err</span>&nbsp;<span class="op" id="4508214">=</span>&nbsp;<span class="ident" id="4508216">parseBitString</span><span class="op" id="4508230">(</span><span class="ident" id="4508231">innerBytes</span><span class="op" id="4508241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508246">case</span>&nbsp;<span class="ident" id="4508251">tagOID</span><span class="op" id="4508257">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508263">result</span><span class="op" id="4508269">,</span>&nbsp;<span class="ident" id="4508271">err</span>&nbsp;<span class="op" id="4508275">=</span>&nbsp;<span class="ident" id="4508277">parseObjectIdentifier</span><span class="op" id="4508298">(</span><span class="ident" id="4508299">innerBytes</span><span class="op" id="4508309">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508314">case</span>&nbsp;<span class="ident" id="4508319">tagUTCTime</span><span class="op" id="4508329">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508335">result</span><span class="op" id="4508341">,</span>&nbsp;<span class="ident" id="4508343">err</span>&nbsp;<span class="op" id="4508347">=</span>&nbsp;<span class="ident" id="4508349">parseUTCTime</span><span class="op" id="4508361">(</span><span class="ident" id="4508362">innerBytes</span><span class="op" id="4508372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508377">case</span>&nbsp;<span class="ident" id="4508382">tagOctetString</span><span class="op" id="4508396">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508402">result</span>&nbsp;<span class="op" id="4508409">=</span>&nbsp;<span class="ident" id="4508411">innerBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508425">default</span><span class="op" id="4508432">:</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4508438">//&nbsp;If&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;to&nbsp;handle&nbsp;the&nbsp;type,&nbsp;we&nbsp;just&nbsp;leave&nbsp;Value&nbsp;as&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4508513">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4508517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508521">offset</span>&nbsp;<span class="op" id="4508528">+=</span>&nbsp;<span class="ident" id="4508531">t</span><span class="op" id="4508532">.</span><span class="ident" id="4508533">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508542">if</span>&nbsp;<span class="ident" id="4508545">err</span>&nbsp;<span class="op" id="4508549">!=</span>&nbsp;<span class="builtintype" id="4508552">nil</span>&nbsp;<span class="op" id="4508556">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508561">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4508570">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508574">if</span>&nbsp;<span class="ident" id="4508577">result</span>&nbsp;<span class="op" id="4508584">!=</span>&nbsp;<span class="builtintype" id="4508587">nil</span>&nbsp;<span class="op" id="4508591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508596">v</span><span class="op" id="4508597">.</span><span class="ident" id="4508598">Set</span><span class="op" id="4508601">(</span><span class="ident" id="4508602">reflect</span><span class="op" id="4508609">.</span><span class="ident" id="4508610">ValueOf</span><span class="op" id="4508617">(</span><span class="ident" id="4508618">result</span><span class="op" id="4508624">)</span><span class="op" id="4508625">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4508629">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508633">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4508641">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508644">universalTag</span><span class="op" id="4508656">,</span>&nbsp;<span class="ident" id="4508658">compoundType</span><span class="op" id="4508670">,</span>&nbsp;<span class="ident" id="4508672">ok1</span>&nbsp;<span class="op" id="4508676">:=</span>&nbsp;<span class="ident" id="4508679">getUniversalType</span><span class="op" id="4508695">(</span><span class="ident" id="4508696">fieldType</span><span class="op" id="4508705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508708">if</span>&nbsp;<span class="op" id="4508711">!</span><span class="ident" id="4508712">ok1</span>&nbsp;<span class="op" id="4508716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508720">err</span>&nbsp;<span class="op" id="4508724">=</span>&nbsp;<span class="ident" id="4508726">StructuralError</span><span class="op" id="4508741">{</span><span class="ident" id="4508742">fmt</span><span class="op" id="4508745">.</span><span class="ident" id="4508746">Sprintf</span><span class="op" id="4508753">(</span><span class="string" id="4508754">&#34;unknown&nbsp;Go&nbsp;type:&nbsp;%v&#34;</span><span class="op" id="4508775">,</span>&nbsp;<span class="ident" id="4508777">fieldType</span><span class="op" id="4508786">)</span><span class="op" id="4508787">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508791">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4508799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508803">t</span><span class="op" id="4508804">,</span>&nbsp;<span class="ident" id="4508806">offset</span><span class="op" id="4508812">,</span>&nbsp;<span class="ident" id="4508814">err</span>&nbsp;<span class="op" id="4508818">:=</span>&nbsp;<span class="ident" id="4508821">parseTagAndLength</span><span class="op" id="4508838">(</span><span class="ident" id="4508839">bytes</span><span class="op" id="4508844">,</span>&nbsp;<span class="ident" id="4508846">offset</span><span class="op" id="4508852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508855">if</span>&nbsp;<span class="ident" id="4508858">err</span>&nbsp;<span class="op" id="4508862">!=</span>&nbsp;<span class="builtintype" id="4508865">nil</span>&nbsp;<span class="op" id="4508869">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508873">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4508881">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508884">if</span>&nbsp;<span class="ident" id="4508887">params</span><span class="op" id="4508893">.</span><span class="ident" id="4508894">explicit</span>&nbsp;<span class="op" id="4508903">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508907">expectedClass</span>&nbsp;<span class="op" id="4508921">:=</span>&nbsp;<span class="ident" id="4508924">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4508947">if</span>&nbsp;<span class="ident" id="4508950">params</span><span class="op" id="4508956">.</span><span class="ident" id="4508957">application</span>&nbsp;<span class="op" id="4508969">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4508974">expectedClass</span>&nbsp;<span class="op" id="4508988">=</span>&nbsp;<span class="ident" id="4508990">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4509009">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509013">if</span>&nbsp;<span class="ident" id="4509016">t</span><span class="op" id="4509017">.</span><span class="ident" id="4509018">class</span>&nbsp;<span class="op" id="4509024">==</span>&nbsp;<span class="ident" id="4509027">expectedClass</span>&nbsp;<span class="op" id="4509041">&amp;&amp;</span>&nbsp;<span class="ident" id="4509044">t</span><span class="op" id="4509045">.</span><span class="ident" id="4509046">tag</span>&nbsp;<span class="op" id="4509050">==</span>&nbsp;<span class="op" id="4509053">*</span><span class="ident" id="4509054">params</span><span class="op" id="4509060">.</span><span class="ident" id="4509061">tag</span>&nbsp;<span class="op" id="4509065">&amp;&amp;</span>&nbsp;<span class="op" id="4509068">(</span><span class="ident" id="4509069">t</span><span class="op" id="4509070">.</span><span class="ident" id="4509071">length</span>&nbsp;<span class="op" id="4509078">==</span>&nbsp;<span class="num" id="4509081">0</span>&nbsp;<span class="op" id="4509083">||</span>&nbsp;<span class="ident" id="4509086">t</span><span class="op" id="4509087">.</span><span class="ident" id="4509088">isCompound</span><span class="op" id="4509098">)</span>&nbsp;<span class="op" id="4509100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509105">if</span>&nbsp;<span class="ident" id="4509108">t</span><span class="op" id="4509109">.</span><span class="ident" id="4509110">length</span>&nbsp;<span class="op" id="4509117">&gt;</span>&nbsp;<span class="num" id="4509119">0</span>&nbsp;<span class="op" id="4509121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4509127">t</span><span class="op" id="4509128">,</span>&nbsp;<span class="ident" id="4509130">offset</span><span class="op" id="4509136">,</span>&nbsp;<span class="ident" id="4509138">err</span>&nbsp;<span class="op" id="4509142">=</span>&nbsp;<span class="ident" id="4509144">parseTagAndLength</span><span class="op" id="4509161">(</span><span class="ident" id="4509162">bytes</span><span class="op" id="4509167">,</span>&nbsp;<span class="ident" id="4509169">offset</span><span class="op" id="4509175">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509181">if</span>&nbsp;<span class="ident" id="4509184">err</span>&nbsp;<span class="op" id="4509188">!=</span>&nbsp;<span class="builtintype" id="4509191">nil</span>&nbsp;<span class="op" id="4509195">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509202">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4509213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4509218">}</span>&nbsp;<span class="keyword" id="4509220">else</span>&nbsp;<span class="op" id="4509225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509231">if</span>&nbsp;<span class="ident" id="4509234">fieldType</span>&nbsp;<span class="op" id="4509244">!=</span>&nbsp;<span class="ident" id="4509247">flagType</span>&nbsp;<span class="op" id="4509256">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4509263">err</span>&nbsp;<span class="op" id="4509267">=</span>&nbsp;<span class="ident" id="4509269">StructuralError</span><span class="op" id="4509284">{</span><span class="string" id="4509285">&#34;zero&nbsp;length&nbsp;explicit&nbsp;tag&nbsp;was&nbsp;not&nbsp;an&nbsp;asn1.Flag&#34;</span><span class="op" id="4509332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509339">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4509350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4509356">v</span><span class="op" id="4509357">.</span><span class="ident" id="4509358">SetBool</span><span class="op" id="4509365">(</span><span class="builtintype" id="4509366">true</span><span class="op" id="4509370">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509376">return</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4509386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4509390">}</span>&nbsp;<span class="keyword" id="4509392">else</span>&nbsp;<span class="op" id="4509397">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4509402">//&nbsp;The&nbsp;tags&nbsp;didn&#39;t&nbsp;match,&nbsp;it&nbsp;might&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4509464">ok</span>&nbsp;<span class="op" id="4509467">:=</span>&nbsp;<span class="ident" id="4509470">setDefaultValue</span><span class="op" id="4509485">(</span><span class="ident" id="4509486">v</span><span class="op" id="4509487">,</span>&nbsp;<span class="ident" id="4509489">params</span><span class="op" id="4509495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509500">if</span>&nbsp;<span class="ident" id="4509503">ok</span>&nbsp;<span class="op" id="4509506">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4509512">offset</span>&nbsp;<span class="op" id="4509519">=</span>&nbsp;<span class="ident" id="4509521">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4509535">}</span>&nbsp;<span class="keyword" id="4509537">else</span>&nbsp;<span class="op" id="4509542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4509548">err</span>&nbsp;<span class="op" id="4509552">=</span>&nbsp;<span class="ident" id="4509554">StructuralError</span><span class="op" id="4509569">{</span><span class="string" id="4509570">&#34;explicitly&nbsp;tagged&nbsp;member&nbsp;didn&#39;t&nbsp;match&#34;</span><span class="op" id="4509609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4509614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509619">return</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4509628">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4509631">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4509635">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;strings:&nbsp;all&nbsp;the&nbsp;ASN.1&nbsp;string&nbsp;types&nbsp;map&nbsp;to&nbsp;the&nbsp;Go</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4509706">//&nbsp;type&nbsp;string.&nbsp;getUniversalType&nbsp;returns&nbsp;the&nbsp;tag&nbsp;for&nbsp;PrintableString</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4509776">//&nbsp;when&nbsp;it&nbsp;sees&nbsp;a&nbsp;string,&nbsp;so&nbsp;if&nbsp;we&nbsp;see&nbsp;a&nbsp;different&nbsp;string&nbsp;type&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4509847">//&nbsp;wire,&nbsp;we&nbsp;change&nbsp;the&nbsp;universal&nbsp;type&nbsp;to&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509896">if</span>&nbsp;<span class="ident" id="4509899">universalTag</span>&nbsp;<span class="op" id="4509912">==</span>&nbsp;<span class="ident" id="4509915">tagPrintableString</span>&nbsp;<span class="op" id="4509934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509938">if</span>&nbsp;<span class="ident" id="4509941">t</span><span class="op" id="4509942">.</span><span class="ident" id="4509943">class</span>&nbsp;<span class="op" id="4509949">==</span>&nbsp;<span class="ident" id="4509952">classUniversal</span>&nbsp;<span class="op" id="4509967">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509972">switch</span>&nbsp;<span class="ident" id="4509979">t</span><span class="op" id="4509980">.</span><span class="ident" id="4509981">tag</span>&nbsp;<span class="op" id="4509985">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4509990">case</span>&nbsp;<span class="ident" id="4509995">tagIA5String</span><span class="op" id="4510007">,</span>&nbsp;<span class="ident" id="4510009">tagGeneralString</span><span class="op" id="4510025">,</span>&nbsp;<span class="ident" id="4510027">tagT61String</span><span class="op" id="4510039">,</span>&nbsp;<span class="ident" id="4510041">tagUTF8String</span><span class="op" id="4510054">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4510060">universalTag</span>&nbsp;<span class="op" id="4510073">=</span>&nbsp;<span class="ident" id="4510075">t</span><span class="op" id="4510076">.</span><span class="ident" id="4510077">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4510084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4510088">}</span>&nbsp;<span class="keyword" id="4510090">else</span>&nbsp;<span class="keyword" id="4510095">if</span>&nbsp;<span class="ident" id="4510098">params</span><span class="op" id="4510104">.</span><span class="ident" id="4510105">stringType</span>&nbsp;<span class="op" id="4510116">!=</span>&nbsp;<span class="num" id="4510119">0</span>&nbsp;<span class="op" id="4510121">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4510126">universalTag</span>&nbsp;<span class="op" id="4510139">=</span>&nbsp;<span class="ident" id="4510141">params</span><span class="op" id="4510147">.</span><span class="ident" id="4510148">stringType</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4510161">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4510164">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4510168">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;time:&nbsp;UTCTime&nbsp;and&nbsp;GeneralizedTime&nbsp;both&nbsp;map&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4510239">//&nbsp;Go&nbsp;type&nbsp;time.Time.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4510262">if</span>&nbsp;<span class="ident" id="4510265">universalTag</span>&nbsp;<span class="op" id="4510278">==</span>&nbsp;<span class="ident" id="4510281">tagUTCTime</span>&nbsp;<span class="op" id="4510292">&amp;&amp;</span>&nbsp;<span class="ident" id="4510295">t</span><span class="op" id="4510296">.</span><span class="ident" id="4510297">tag</span>&nbsp;<span class="op" id="4510301">==</span>&nbsp;<span class="ident" id="4510304">tagGeneralizedTime</span>&nbsp;<span class="op" id="4510323">&amp;&amp;</span>&nbsp;<span class="ident" id="4510326">t</span><span class="op" id="4510327">.</span><span class="ident" id="4510328">class</span>&nbsp;<span class="op" id="4510334">==</span>&nbsp;<span class="ident" id="4510337">classUniversal</span>&nbsp;<span class="op" id="4510352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4510356">universalTag</span>&nbsp;<span class="op" id="4510369">=</span>&nbsp;<span class="ident" id="4510371">tagGeneralizedTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4510391">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4510395">if</span>&nbsp;<span class="ident" id="4510398">params</span><span class="op" id="4510404">.</span><span class="ident" id="4510405">set</span>&nbsp;<span class="op" id="4510409">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4510413">universalTag</span>&nbsp;<span class="op" id="4510426">=</span>&nbsp;<span class="ident" id="4510428">tagSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4510436">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4510440">expectedClass</span>&nbsp;<span class="op" id="4510454">:=</span>&nbsp;<span class="ident" id="4510457">classUniversal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4510473">expectedTag</span>&nbsp;<span class="op" id="4510485">:=</span>&nbsp;<span class="ident" id="4510488">universalTag</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4510503">if</span>&nbsp;<span class="op" id="4510506">!</span><span class="ident" id="4510507">params</span><span class="op" id="4510513">.</span><span class="ident" id="4510514">explicit</span>&nbsp;<span class="op" id="4510523">&amp;&amp;</span>&nbsp;<span class="ident" id="4510526">params</span><span class="op" id="4510532">.</span><span class="ident" id="4510533">tag</span>&nbsp;<span class="op" id="4510537">!=</span>&nbsp;<span class="builtintype" id="4510540">nil</span>&nbsp;<span class="op" id="4510544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4510548">expectedClass</span>&nbsp;<span class="op" id="4510562">=</span>&nbsp;<span class="ident" id="4510564">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4510587">expectedTag</span>&nbsp;<span class="op" id="4510599">=</span>&nbsp;<span class="op" id="4510601">*</span><span class="ident" id="4510602">params</span><span class="op" id="4510608">.</span><span class="ident" id="4510609">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4510614">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4510618">if</span>&nbsp;<span class="op" id="4510621">!</span><span class="ident" id="4510622">params</span><span class="op" id="4510628">.</span><span class="ident" id="4510629">explicit</span>&nbsp;<span class="op" id="4510638">&amp;&amp;</span>&nbsp;<span class="ident" id="4510641">params</span><span class="op" id="4510647">.</span><span class="ident" id="4510648">application</span>&nbsp;<span class="op" id="4510660">&amp;&amp;</span>&nbsp;<span class="ident" id="4510663">params</span><span class="op" id="4510669">.</span><span class="ident" id="4510670">tag</span>&nbsp;<span class="op" id="4510674">!=</span>&nbsp;<span class="builtintype" id="4510677">nil</span>&nbsp;<span class="op" id="4510681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4510685">expectedClass</span>&nbsp;<span class="op" id="4510699">=</span>&nbsp;<span class="ident" id="4510701">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4510720">expectedTag</span>&nbsp;<span class="op" id="4510732">=</span>&nbsp;<span class="op" id="4510734">*</span><span class="ident" id="4510735">params</span><span class="op" id="4510741">.</span><span class="ident" id="4510742">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4510747">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4510751">//&nbsp;We&nbsp;have&nbsp;unwrapped&nbsp;any&nbsp;explicit&nbsp;tagging&nbsp;at&nbsp;this&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4510809">if</span>&nbsp;<span class="ident" id="4510812">t</span><span class="op" id="4510813">.</span><span class="ident" id="4510814">class</span>&nbsp;<span class="op" id="4510820">!=</span>&nbsp;<span class="ident" id="4510823">expectedClass</span>&nbsp;<span class="op" id="4510837">||</span>&nbsp;<span class="ident" id="4510840">t</span><span class="op" id="4510841">.</span><span class="ident" id="4510842">tag</span>&nbsp;<span class="op" id="4510846">!=</span>&nbsp;<span class="ident" id="4510849">expectedTag</span>&nbsp;<span class="op" id="4510861">||</span>&nbsp;<span class="ident" id="4510864">t</span><span class="op" id="4510865">.</span><span class="ident" id="4510866">isCompound</span>&nbsp;<span class="op" id="4510877">!=</span>&nbsp;<span class="ident" id="4510880">compoundType</span>&nbsp;<span class="op" id="4510893">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4510897">//&nbsp;Tags&nbsp;don&#39;t&nbsp;match.&nbsp;Again,&nbsp;it&nbsp;could&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4510960">ok</span>&nbsp;<span class="op" id="4510963">:=</span>&nbsp;<span class="ident" id="4510966">setDefaultValue</span><span class="op" id="4510981">(</span><span class="ident" id="4510982">v</span><span class="op" id="4510983">,</span>&nbsp;<span class="ident" id="4510985">params</span><span class="op" id="4510991">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4510995">if</span>&nbsp;<span class="ident" id="4510998">ok</span>&nbsp;<span class="op" id="4511001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4511006">offset</span>&nbsp;<span class="op" id="4511013">=</span>&nbsp;<span class="ident" id="4511015">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4511028">}</span>&nbsp;<span class="keyword" id="4511030">else</span>&nbsp;<span class="op" id="4511035">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4511040">err</span>&nbsp;<span class="op" id="4511044">=</span>&nbsp;<span class="ident" id="4511046">StructuralError</span><span class="op" id="4511061">{</span><span class="ident" id="4511062">fmt</span><span class="op" id="4511065">.</span><span class="ident" id="4511066">Sprintf</span><span class="op" id="4511073">(</span><span class="string" id="4511074">&#34;tags&nbsp;don&#39;t&nbsp;match&nbsp;(%d&nbsp;vs&nbsp;%+v)&nbsp;%+v&nbsp;%s&nbsp;@%d&#34;</span><span class="op" id="4511115">,</span>&nbsp;<span class="ident" id="4511117">expectedTag</span><span class="op" id="4511128">,</span>&nbsp;<span class="ident" id="4511130">t</span><span class="op" id="4511131">,</span>&nbsp;<span class="ident" id="4511133">params</span><span class="op" id="4511139">,</span>&nbsp;<span class="ident" id="4511141">fieldType</span><span class="op" id="4511150">.</span><span class="ident" id="4511151">Name</span><span class="op" id="4511155">(</span><span class="op" id="4511156">)</span><span class="op" id="4511157">,</span>&nbsp;<span class="ident" id="4511159">offset</span><span class="op" id="4511165">)</span><span class="op" id="4511166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4511170">}</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4511174">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4511182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4511185">if</span>&nbsp;<span class="ident" id="4511188">invalidLength</span><span class="op" id="4511201">(</span><span class="ident" id="4511202">offset</span><span class="op" id="4511208">,</span>&nbsp;<span class="ident" id="4511210">t</span><span class="op" id="4511211">.</span><span class="ident" id="4511212">length</span><span class="op" id="4511218">,</span>&nbsp;<span class="builtinfunc" id="4511220">len</span><span class="op" id="4511223">(</span><span class="ident" id="4511224">bytes</span><span class="op" id="4511229">)</span><span class="op" id="4511230">)</span>&nbsp;<span class="op" id="4511232">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4511236">err</span>&nbsp;<span class="op" id="4511240">=</span>&nbsp;<span class="ident" id="4511242">SyntaxError</span><span class="op" id="4511253">{</span><span class="string" id="4511254">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4511270">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4511274">return</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4511282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4511285">innerBytes</span>&nbsp;<span class="op" id="4511296">:=</span>&nbsp;<span class="ident" id="4511299">bytes</span><span class="op" id="4511304">[</span><span class="ident" id="4511305">offset</span>&nbsp;<span class="op" id="4511312">:</span>&nbsp;<span class="ident" id="4511314">offset</span><span class="op" id="4511320">+</span><span class="ident" id="4511321">t</span><span class="op" id="4511322">.</span><span class="ident" id="4511323">length</span><span class="op" id="4511329">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4511332">offset</span>&nbsp;<span class="op" id="4511339">+=</span>&nbsp;<span class="ident" id="4511342">t</span><span class="op" id="4511343">.</span><span class="ident" id="4511344">length</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4511353">//&nbsp;We&nbsp;deal&nbsp;with&nbsp;the&nbsp;structures&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;first.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4511416">switch</span>&nbsp;<span class="ident" id="4511423">fieldType</span>&nbsp;<span class="op" id="4511433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4511436">case</span>&nbsp;<span class="ident" id="4511441">objectIdentifierType</span><span class="op" id="4511461">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4511465">newSlice</span><span class="op" id="4511473">,</span>&nbsp;<span class="ident" id="4511475">err1</span>&nbsp;<span class="op" id="4511480">:=</span>&nbsp;<span class="ident" id="4511483">parseObjectIdentifier</span><span class="op" id="4511504">(</span><span class="ident" id="4511505">innerBytes</span><span class="op" id="4511515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4511519">v</span><span class="op" id="4511520">.</span><span class="ident" id="4511521">Set</span><span class="op" id="4511524">(</span><span class="ident" id="4511525">reflect</span><span class="op" id="4511532">.</span><span class="ident" id="4511533">MakeSlice</span><span class="op" id="4511542">(</span><span class="ident" id="4511543">v</span><span class="op" id="4511544">.</span><span class="ident" id="4511545">Type</span><span class="op" id="4511549">(</span><span class="op" id="4511550">)</span><span class="op" id="4511551">,</span>&nbsp;<span class="builtinfunc" id="4511553">len</span><span class="op" id="4511556">(</span><span class="ident" id="4511557">newSlice</span><span class="op" id="4511565">)</span><span class="op" id="4511566">,</span>&nbsp;<span class="builtinfunc" id="4511568">len</span><span class="op" id="4511571">(</span><span class="ident" id="4511572">newSlice</span><span class="op" id="4511580">)</span><span class="op" id="4511581">)</span><span class="op" id="4511582">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4511586">if</span>&nbsp;<span class="ident" id="4511589">err1</span>&nbsp;<span class="op" id="4511594">==</span>&nbsp;<span class="builtintype" id="4511597">nil</span>&nbsp;<span class="op" id="4511601">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4511606">reflect</span><span class="op" id="4511613">.</span><span class="ident" id="4511614">Copy</span><span class="op" id="4511618">(</span><span class="ident" id="4511619">v</span><span class="op" id="4511620">,</span>&nbsp;<span class="ident" id="4511622">reflect</span><span class="op" id="4511629">.</span><span class="ident" id="4511630">ValueOf</span><span class="op" id="4511637">(</span><span class="ident" id="4511638">newSlice</span><span class="op" id="4511646">)</span><span class="op" id="4511647">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4511651">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4511655">err</span>&nbsp;<span class="op" id="4511659">=</span>&nbsp;<span class="ident" id="4511661">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4511668">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4511676">case</span>&nbsp;<span class="ident" id="4511681">bitStringType</span><span class="op" id="4511694">:</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4511698">bs</span><span class="op" id="4511700">,</span>&nbsp;<span class="ident" id="4511702">err1</span>&nbsp;<span class="op" id="4511707">:=</span>&nbsp;<span class="ident" id="4511710">parseBitString</span><span class="op" id="4511724">(</span><span class="ident" id="4511725">innerBytes</span><span class="op" id="4511735">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4511739">if</span>&nbsp;<span class="ident" id="4511742">err1</span>&nbsp;<span class="op" id="4511747">==</span>&nbsp;<span class="builtintype" id="4511750">nil</span>&nbsp;<span class="op" id="4511754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4511759">v</span><span class="op" id="4511760">.</span><span class="ident" id="4511761">Set</span><span class="op" id="4511764">(</span><span class="ident" id="4511765">reflect</span><span class="op" id="4511772">.</span><span class="ident" id="4511773">ValueOf</span><span class="op" id="4511780">(</span><span class="ident" id="4511781">bs</span><span class="op" id="4511783">)</span><span class="op" id="4511784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4511788">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4511792">err</span>&nbsp;<span class="op" id="4511796">=</span>&nbsp;<span class="ident" id="4511798">err1</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4511805">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4511813">case</span>&nbsp;<span class="ident" id="4511818">timeType</span><span class="op" id="4511826">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4511830">var</span>&nbsp;<span class="ident" id="4511834">time</span>&nbsp;<span class="ident" id="4511839">time</span><span class="op" id="4511843">.</span><span class="ident" id="4511844">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4511851">var</span>&nbsp;<span class="ident" id="4511855">err1</span>&nbsp;<span class="builtintype" id="4511860">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4511868">if</span>&nbsp;<span class="ident" id="4511871">universalTag</span>&nbsp;<span class="op" id="4511884">==</span>&nbsp;<span class="ident" id="4511887">tagUTCTime</span>&nbsp;<span class="op" id="4511898">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4511903">time</span><span class="op" id="4511907">,</span>&nbsp;<span class="ident" id="4511909">err1</span>&nbsp;<span class="op" id="4511914">=</span>&nbsp;<span class="ident" id="4511916">parseUTCTime</span><span class="op" id="4511928">(</span><span class="ident" id="4511929">innerBytes</span><span class="op" id="4511939">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4511943">}</span>&nbsp;<span class="keyword" id="4511945">else</span>&nbsp;<span class="op" id="4511950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4511955">time</span><span class="op" id="4511959">,</span>&nbsp;<span class="ident" id="4511961">err1</span>&nbsp;<span class="op" id="4511966">=</span>&nbsp;<span class="ident" id="4511968">parseGeneralizedTime</span><span class="op" id="4511988">(</span><span class="ident" id="4511989">innerBytes</span><span class="op" id="4511999">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4512003">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512007">if</span>&nbsp;<span class="ident" id="4512010">err1</span>&nbsp;<span class="op" id="4512015">==</span>&nbsp;<span class="builtintype" id="4512018">nil</span>&nbsp;<span class="op" id="4512022">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512027">v</span><span class="op" id="4512028">.</span><span class="ident" id="4512029">Set</span><span class="op" id="4512032">(</span><span class="ident" id="4512033">reflect</span><span class="op" id="4512040">.</span><span class="ident" id="4512041">ValueOf</span><span class="op" id="4512048">(</span><span class="ident" id="4512049">time</span><span class="op" id="4512053">)</span><span class="op" id="4512054">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4512058">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512062">err</span>&nbsp;<span class="op" id="4512066">=</span>&nbsp;<span class="ident" id="4512068">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512075">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512083">case</span>&nbsp;<span class="ident" id="4512088">enumeratedType</span><span class="op" id="4512102">:</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512106">parsedInt</span><span class="op" id="4512115">,</span>&nbsp;<span class="ident" id="4512117">err1</span>&nbsp;<span class="op" id="4512122">:=</span>&nbsp;<span class="ident" id="4512125">parseInt32</span><span class="op" id="4512135">(</span><span class="ident" id="4512136">innerBytes</span><span class="op" id="4512146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512150">if</span>&nbsp;<span class="ident" id="4512153">err1</span>&nbsp;<span class="op" id="4512158">==</span>&nbsp;<span class="builtintype" id="4512161">nil</span>&nbsp;<span class="op" id="4512165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512170">v</span><span class="op" id="4512171">.</span><span class="ident" id="4512172">SetInt</span><span class="op" id="4512178">(</span><span class="builtintype" id="4512179">int64</span><span class="op" id="4512184">(</span><span class="ident" id="4512185">parsedInt</span><span class="op" id="4512194">)</span><span class="op" id="4512195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4512199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512203">err</span>&nbsp;<span class="op" id="4512207">=</span>&nbsp;<span class="ident" id="4512209">err1</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512216">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512224">case</span>&nbsp;<span class="ident" id="4512229">flagType</span><span class="op" id="4512237">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512241">v</span><span class="op" id="4512242">.</span><span class="ident" id="4512243">SetBool</span><span class="op" id="4512250">(</span><span class="builtintype" id="4512251">true</span><span class="op" id="4512255">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512259">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512267">case</span>&nbsp;<span class="ident" id="4512272">bigIntType</span><span class="op" id="4512282">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512286">parsedInt</span>&nbsp;<span class="op" id="4512296">:=</span>&nbsp;<span class="ident" id="4512299">parseBigInt</span><span class="op" id="4512310">(</span><span class="ident" id="4512311">innerBytes</span><span class="op" id="4512321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512325">v</span><span class="op" id="4512326">.</span><span class="ident" id="4512327">Set</span><span class="op" id="4512330">(</span><span class="ident" id="4512331">reflect</span><span class="op" id="4512338">.</span><span class="ident" id="4512339">ValueOf</span><span class="op" id="4512346">(</span><span class="ident" id="4512347">parsedInt</span><span class="op" id="4512356">)</span><span class="op" id="4512357">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512361">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4512369">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512372">switch</span>&nbsp;<span class="ident" id="4512379">val</span>&nbsp;<span class="op" id="4512383">:=</span>&nbsp;<span class="ident" id="4512386">v</span><span class="op" id="4512387">;</span>&nbsp;<span class="ident" id="4512389">val</span><span class="op" id="4512392">.</span><span class="ident" id="4512393">Kind</span><span class="op" id="4512397">(</span><span class="op" id="4512398">)</span>&nbsp;<span class="op" id="4512400">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512403">case</span>&nbsp;<span class="ident" id="4512408">reflect</span><span class="op" id="4512415">.</span><span class="ident" id="4512416">Bool</span><span class="op" id="4512420">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512424">parsedBool</span><span class="op" id="4512434">,</span>&nbsp;<span class="ident" id="4512436">err1</span>&nbsp;<span class="op" id="4512441">:=</span>&nbsp;<span class="ident" id="4512444">parseBool</span><span class="op" id="4512453">(</span><span class="ident" id="4512454">innerBytes</span><span class="op" id="4512464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512468">if</span>&nbsp;<span class="ident" id="4512471">err1</span>&nbsp;<span class="op" id="4512476">==</span>&nbsp;<span class="builtintype" id="4512479">nil</span>&nbsp;<span class="op" id="4512483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512488">val</span><span class="op" id="4512491">.</span><span class="ident" id="4512492">SetBool</span><span class="op" id="4512499">(</span><span class="ident" id="4512500">parsedBool</span><span class="op" id="4512510">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4512514">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512518">err</span>&nbsp;<span class="op" id="4512522">=</span>&nbsp;<span class="ident" id="4512524">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512531">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512539">case</span>&nbsp;<span class="ident" id="4512544">reflect</span><span class="op" id="4512551">.</span><span class="ident" id="4512552">Int</span><span class="op" id="4512555">,</span>&nbsp;<span class="ident" id="4512557">reflect</span><span class="op" id="4512564">.</span><span class="ident" id="4512565">Int32</span><span class="op" id="4512570">,</span>&nbsp;<span class="ident" id="4512572">reflect</span><span class="op" id="4512579">.</span><span class="ident" id="4512580">Int64</span><span class="op" id="4512585">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512589">if</span>&nbsp;<span class="ident" id="4512592">val</span><span class="op" id="4512595">.</span><span class="ident" id="4512596">Type</span><span class="op" id="4512600">(</span><span class="op" id="4512601">)</span><span class="op" id="4512602">.</span><span class="ident" id="4512603">Size</span><span class="op" id="4512607">(</span><span class="op" id="4512608">)</span>&nbsp;<span class="op" id="4512610">==</span>&nbsp;<span class="num" id="4512613">4</span>&nbsp;<span class="op" id="4512615">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512620">parsedInt</span><span class="op" id="4512629">,</span>&nbsp;<span class="ident" id="4512631">err1</span>&nbsp;<span class="op" id="4512636">:=</span>&nbsp;<span class="ident" id="4512639">parseInt32</span><span class="op" id="4512649">(</span><span class="ident" id="4512650">innerBytes</span><span class="op" id="4512660">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512665">if</span>&nbsp;<span class="ident" id="4512668">err1</span>&nbsp;<span class="op" id="4512673">==</span>&nbsp;<span class="builtintype" id="4512676">nil</span>&nbsp;<span class="op" id="4512680">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512686">val</span><span class="op" id="4512689">.</span><span class="ident" id="4512690">SetInt</span><span class="op" id="4512696">(</span><span class="builtintype" id="4512697">int64</span><span class="op" id="4512702">(</span><span class="ident" id="4512703">parsedInt</span><span class="op" id="4512712">)</span><span class="op" id="4512713">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4512718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512723">err</span>&nbsp;<span class="op" id="4512727">=</span>&nbsp;<span class="ident" id="4512729">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4512736">}</span>&nbsp;<span class="keyword" id="4512738">else</span>&nbsp;<span class="op" id="4512743">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512748">parsedInt</span><span class="op" id="4512757">,</span>&nbsp;<span class="ident" id="4512759">err1</span>&nbsp;<span class="op" id="4512764">:=</span>&nbsp;<span class="ident" id="4512767">parseInt64</span><span class="op" id="4512777">(</span><span class="ident" id="4512778">innerBytes</span><span class="op" id="4512788">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512793">if</span>&nbsp;<span class="ident" id="4512796">err1</span>&nbsp;<span class="op" id="4512801">==</span>&nbsp;<span class="builtintype" id="4512804">nil</span>&nbsp;<span class="op" id="4512808">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512814">val</span><span class="op" id="4512817">.</span><span class="ident" id="4512818">SetInt</span><span class="op" id="4512824">(</span><span class="ident" id="4512825">parsedInt</span><span class="op" id="4512834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4512839">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512844">err</span>&nbsp;<span class="op" id="4512848">=</span>&nbsp;<span class="ident" id="4512850">err1</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4512857">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512861">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4512869">//&nbsp;TODO(dfc)&nbsp;Add&nbsp;support&nbsp;for&nbsp;the&nbsp;remaining&nbsp;integer&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512927">case</span>&nbsp;<span class="ident" id="4512932">reflect</span><span class="op" id="4512939">.</span><span class="ident" id="4512940">Struct</span><span class="op" id="4512946">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4512950">structType</span>&nbsp;<span class="op" id="4512961">:=</span>&nbsp;<span class="ident" id="4512964">fieldType</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4512977">if</span>&nbsp;<span class="ident" id="4512980">structType</span><span class="op" id="4512990">.</span><span class="ident" id="4512991">NumField</span><span class="op" id="4512999">(</span><span class="op" id="4513000">)</span>&nbsp;<span class="op" id="4513002">&gt;</span>&nbsp;<span class="num" id="4513004">0</span>&nbsp;<span class="op" id="4513006">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4513012">structType</span><span class="op" id="4513022">.</span><span class="ident" id="4513023">Field</span><span class="op" id="4513028">(</span><span class="num" id="4513029">0</span><span class="op" id="4513030">)</span><span class="op" id="4513031">.</span><span class="ident" id="4513032">Type</span>&nbsp;<span class="op" id="4513037">==</span>&nbsp;<span class="ident" id="4513040">rawContentsType</span>&nbsp;<span class="op" id="4513056">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4513061">bytes</span>&nbsp;<span class="op" id="4513067">:=</span>&nbsp;<span class="ident" id="4513070">bytes</span><span class="op" id="4513075">[</span><span class="ident" id="4513076">initOffset</span><span class="op" id="4513086">:</span><span class="ident" id="4513087">offset</span><span class="op" id="4513093">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4513098">val</span><span class="op" id="4513101">.</span><span class="ident" id="4513102">Field</span><span class="op" id="4513107">(</span><span class="num" id="4513108">0</span><span class="op" id="4513109">)</span><span class="op" id="4513110">.</span><span class="ident" id="4513111">Set</span><span class="op" id="4513114">(</span><span class="ident" id="4513115">reflect</span><span class="op" id="4513122">.</span><span class="ident" id="4513123">ValueOf</span><span class="op" id="4513130">(</span><span class="ident" id="4513131">RawContent</span><span class="op" id="4513141">(</span><span class="ident" id="4513142">bytes</span><span class="op" id="4513147">)</span><span class="op" id="4513148">)</span><span class="op" id="4513149">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4513153">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4513158">innerOffset</span>&nbsp;<span class="op" id="4513170">:=</span>&nbsp;<span class="num" id="4513173">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4513177">for</span>&nbsp;<span class="ident" id="4513181">i</span>&nbsp;<span class="op" id="4513183">:=</span>&nbsp;<span class="num" id="4513186">0</span><span class="op" id="4513187">;</span>&nbsp;<span class="ident" id="4513189">i</span>&nbsp;<span class="op" id="4513191">&lt;</span>&nbsp;<span class="ident" id="4513193">structType</span><span class="op" id="4513203">.</span><span class="ident" id="4513204">NumField</span><span class="op" id="4513212">(</span><span class="op" id="4513213">)</span><span class="op" id="4513214">;</span>&nbsp;<span class="ident" id="4513216">i</span><span class="op" id="4513217">++</span>&nbsp;<span class="op" id="4513220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4513225">field</span>&nbsp;<span class="op" id="4513231">:=</span>&nbsp;<span class="ident" id="4513234">structType</span><span class="op" id="4513244">.</span><span class="ident" id="4513245">Field</span><span class="op" id="4513250">(</span><span class="ident" id="4513251">i</span><span class="op" id="4513252">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4513257">if</span>&nbsp;<span class="ident" id="4513260">i</span>&nbsp;<span class="op" id="4513262">==</span>&nbsp;<span class="num" id="4513265">0</span>&nbsp;<span class="op" id="4513267">&amp;&amp;</span>&nbsp;<span class="ident" id="4513270">field</span><span class="op" id="4513275">.</span><span class="ident" id="4513276">Type</span>&nbsp;<span class="op" id="4513281">==</span>&nbsp;<span class="ident" id="4513284">rawContentsType</span>&nbsp;<span class="op" id="4513300">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4513306">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4513318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4513323">innerOffset</span><span class="op" id="4513334">,</span>&nbsp;<span class="ident" id="4513336">err</span>&nbsp;<span class="op" id="4513340">=</span>&nbsp;<span class="ident" id="4513342">parseField</span><span class="op" id="4513352">(</span><span class="ident" id="4513353">val</span><span class="op" id="4513356">.</span><span class="ident" id="4513357">Field</span><span class="op" id="4513362">(</span><span class="ident" id="4513363">i</span><span class="op" id="4513364">)</span><span class="op" id="4513365">,</span>&nbsp;<span class="ident" id="4513367">innerBytes</span><span class="op" id="4513377">,</span>&nbsp;<span class="ident" id="4513379">innerOffset</span><span class="op" id="4513390">,</span>&nbsp;<span class="ident" id="4513392">parseFieldParameters</span><span class="op" id="4513412">(</span><span class="ident" id="4513413">field</span><span class="op" id="4513418">.</span><span class="ident" id="4513419">Tag</span><span class="op" id="4513422">.</span><span class="ident" id="4513423">Get</span><span class="op" id="4513426">(</span><span class="string" id="4513427">&#34;asn1&#34;</span><span class="op" id="4513433">)</span><span class="op" id="4513434">)</span><span class="op" id="4513435">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4513440">if</span>&nbsp;<span class="ident" id="4513443">err</span>&nbsp;<span class="op" id="4513447">!=</span>&nbsp;<span class="builtintype" id="4513450">nil</span>&nbsp;<span class="op" id="4513454">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4513460">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4513470">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4513474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4513478">//&nbsp;We&nbsp;allow&nbsp;extra&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;SEQUENCE&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4513539">//&nbsp;adding&nbsp;elements&nbsp;to&nbsp;the&nbsp;end&nbsp;has&nbsp;been&nbsp;used&nbsp;in&nbsp;X.509&nbsp;as&nbsp;the</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4513601">//&nbsp;version&nbsp;numbers&nbsp;have&nbsp;increased.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4513638">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4513646">case</span>&nbsp;<span class="ident" id="4513651">reflect</span><span class="op" id="4513658">.</span><span class="ident" id="4513659">Slice</span><span class="op" id="4513664">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4513668">sliceType</span>&nbsp;<span class="op" id="4513678">:=</span>&nbsp;<span class="ident" id="4513681">fieldType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4513693">if</span>&nbsp;<span class="ident" id="4513696">sliceType</span><span class="op" id="4513705">.</span><span class="ident" id="4513706">Elem</span><span class="op" id="4513710">(</span><span class="op" id="4513711">)</span><span class="op" id="4513712">.</span><span class="ident" id="4513713">Kind</span><span class="op" id="4513717">(</span><span class="op" id="4513718">)</span>&nbsp;<span class="op" id="4513720">==</span>&nbsp;<span class="ident" id="4513723">reflect</span><span class="op" id="4513730">.</span><span class="ident" id="4513731">Uint8</span>&nbsp;<span class="op" id="4513737">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4513742">val</span><span class="op" id="4513745">.</span><span class="ident" id="4513746">Set</span><span class="op" id="4513749">(</span><span class="ident" id="4513750">reflect</span><span class="op" id="4513757">.</span><span class="ident" id="4513758">MakeSlice</span><span class="op" id="4513767">(</span><span class="ident" id="4513768">sliceType</span><span class="op" id="4513777">,</span>&nbsp;<span class="builtinfunc" id="4513779">len</span><span class="op" id="4513782">(</span><span class="ident" id="4513783">innerBytes</span><span class="op" id="4513793">)</span><span class="op" id="4513794">,</span>&nbsp;<span class="builtinfunc" id="4513796">len</span><span class="op" id="4513799">(</span><span class="ident" id="4513800">innerBytes</span><span class="op" id="4513810">)</span><span class="op" id="4513811">)</span><span class="op" id="4513812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4513817">reflect</span><span class="op" id="4513824">.</span><span class="ident" id="4513825">Copy</span><span class="op" id="4513829">(</span><span class="ident" id="4513830">val</span><span class="op" id="4513833">,</span>&nbsp;<span class="ident" id="4513835">reflect</span><span class="op" id="4513842">.</span><span class="ident" id="4513843">ValueOf</span><span class="op" id="4513850">(</span><span class="ident" id="4513851">innerBytes</span><span class="op" id="4513861">)</span><span class="op" id="4513862">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4513867">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4513876">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4513880">newSlice</span><span class="op" id="4513888">,</span>&nbsp;<span class="ident" id="4513890">err1</span>&nbsp;<span class="op" id="4513895">:=</span>&nbsp;<span class="ident" id="4513898">parseSequenceOf</span><span class="op" id="4513913">(</span><span class="ident" id="4513914">innerBytes</span><span class="op" id="4513924">,</span>&nbsp;<span class="ident" id="4513926">sliceType</span><span class="op" id="4513935">,</span>&nbsp;<span class="ident" id="4513937">sliceType</span><span class="op" id="4513946">.</span><span class="ident" id="4513947">Elem</span><span class="op" id="4513951">(</span><span class="op" id="4513952">)</span><span class="op" id="4513953">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4513957">if</span>&nbsp;<span class="ident" id="4513960">err1</span>&nbsp;<span class="op" id="4513965">==</span>&nbsp;<span class="builtintype" id="4513968">nil</span>&nbsp;<span class="op" id="4513972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4513977">val</span><span class="op" id="4513980">.</span><span class="ident" id="4513981">Set</span><span class="op" id="4513984">(</span><span class="ident" id="4513985">newSlice</span><span class="op" id="4513993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4513997">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4514001">err</span>&nbsp;<span class="op" id="4514005">=</span>&nbsp;<span class="ident" id="4514007">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4514014">return</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4514022">case</span>&nbsp;<span class="ident" id="4514027">reflect</span><span class="op" id="4514034">.</span><span class="ident" id="4514035">String</span><span class="op" id="4514041">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4514045">var</span>&nbsp;<span class="ident" id="4514049">v</span>&nbsp;<span class="builtintype" id="4514051">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4514060">switch</span>&nbsp;<span class="ident" id="4514067">universalTag</span>&nbsp;<span class="op" id="4514080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4514084">case</span>&nbsp;<span class="ident" id="4514089">tagPrintableString</span><span class="op" id="4514107">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4514112">v</span><span class="op" id="4514113">,</span>&nbsp;<span class="ident" id="4514115">err</span>&nbsp;<span class="op" id="4514119">=</span>&nbsp;<span class="ident" id="4514121">parsePrintableString</span><span class="op" id="4514141">(</span><span class="ident" id="4514142">innerBytes</span><span class="op" id="4514152">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4514156">case</span>&nbsp;<span class="ident" id="4514161">tagIA5String</span><span class="op" id="4514173">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4514178">v</span><span class="op" id="4514179">,</span>&nbsp;<span class="ident" id="4514181">err</span>&nbsp;<span class="op" id="4514185">=</span>&nbsp;<span class="ident" id="4514187">parseIA5String</span><span class="op" id="4514201">(</span><span class="ident" id="4514202">innerBytes</span><span class="op" id="4514212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4514216">case</span>&nbsp;<span class="ident" id="4514221">tagT61String</span><span class="op" id="4514233">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4514238">v</span><span class="op" id="4514239">,</span>&nbsp;<span class="ident" id="4514241">err</span>&nbsp;<span class="op" id="4514245">=</span>&nbsp;<span class="ident" id="4514247">parseT61String</span><span class="op" id="4514261">(</span><span class="ident" id="4514262">innerBytes</span><span class="op" id="4514272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4514276">case</span>&nbsp;<span class="ident" id="4514281">tagUTF8String</span><span class="op" id="4514294">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4514299">v</span><span class="op" id="4514300">,</span>&nbsp;<span class="ident" id="4514302">err</span>&nbsp;<span class="op" id="4514306">=</span>&nbsp;<span class="ident" id="4514308">parseUTF8String</span><span class="op" id="4514323">(</span><span class="ident" id="4514324">innerBytes</span><span class="op" id="4514334">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4514338">case</span>&nbsp;<span class="ident" id="4514343">tagGeneralString</span><span class="op" id="4514359">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4514364">//&nbsp;GeneralString&nbsp;is&nbsp;specified&nbsp;in&nbsp;ISO-2022/ECMA-35,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4514418">//&nbsp;A&nbsp;brief&nbsp;review&nbsp;suggests&nbsp;that&nbsp;it&nbsp;includes&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4514476">//&nbsp;that&nbsp;allow&nbsp;the&nbsp;encoding&nbsp;to&nbsp;change&nbsp;midstring&nbsp;and</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4514530">//&nbsp;such.&nbsp;We&nbsp;give&nbsp;up&nbsp;and&nbsp;pass&nbsp;it&nbsp;as&nbsp;an&nbsp;8-bit&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4514585">v</span><span class="op" id="4514586">,</span>&nbsp;<span class="ident" id="4514588">err</span>&nbsp;<span class="op" id="4514592">=</span>&nbsp;<span class="ident" id="4514594">parseT61String</span><span class="op" id="4514608">(</span><span class="ident" id="4514609">innerBytes</span><span class="op" id="4514619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4514623">default</span><span class="op" id="4514630">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4514635">err</span>&nbsp;<span class="op" id="4514639">=</span>&nbsp;<span class="ident" id="4514641">SyntaxError</span><span class="op" id="4514652">{</span><span class="ident" id="4514653">fmt</span><span class="op" id="4514656">.</span><span class="ident" id="4514657">Sprintf</span><span class="op" id="4514664">(</span><span class="string" id="4514665">&#34;internal&nbsp;error:&nbsp;unknown&nbsp;string&nbsp;type&nbsp;%d&#34;</span><span class="op" id="4514705">,</span>&nbsp;<span class="ident" id="4514707">universalTag</span><span class="op" id="4514719">)</span><span class="op" id="4514720">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4514724">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4514728">if</span>&nbsp;<span class="ident" id="4514731">err</span>&nbsp;<span class="op" id="4514735">==</span>&nbsp;<span class="builtintype" id="4514738">nil</span>&nbsp;<span class="op" id="4514742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4514747">val</span><span class="op" id="4514750">.</span><span class="ident" id="4514751">SetString</span><span class="op" id="4514760">(</span><span class="ident" id="4514761">v</span><span class="op" id="4514762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4514766">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4514770">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4514778">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4514781">err</span>&nbsp;<span class="op" id="4514785">=</span>&nbsp;<span class="ident" id="4514787">StructuralError</span><span class="op" id="4514802">{</span><span class="string" id="4514803">&#34;unsupported:&nbsp;&#34;</span>&nbsp;<span class="op" id="4514819">+</span>&nbsp;<span class="ident" id="4514821">v</span><span class="op" id="4514822">.</span><span class="ident" id="4514823">Type</span><span class="op" id="4514827">(</span><span class="op" id="4514828">)</span><span class="op" id="4514829">.</span><span class="ident" id="4514830">String</span><span class="op" id="4514836">(</span><span class="op" id="4514837">)</span><span class="op" id="4514838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4514841">return</span><br>
<span class="lineno"></span><span class="op" id="4514848">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4514851">//&nbsp;canHaveDefaultValue&nbsp;reports&nbsp;whether&nbsp;k&nbsp;is&nbsp;a&nbsp;Kind&nbsp;that&nbsp;we&nbsp;will&nbsp;set&nbsp;a&nbsp;default</span><br>
<span class="lineno">830</span><span class="comment" id="4514929">//&nbsp;value&nbsp;for.&nbsp;(A&nbsp;signed&nbsp;integer,&nbsp;essentially.)</span><br>
<span class="lineno"></span><span class="keyword" id="4514976">func</span>&nbsp;<span class="ident" id="4514981">canHaveDefaultValue</span><span class="op" id="4515000">(</span><span class="ident" id="4515001">k</span>&nbsp;<span class="ident" id="4515003">reflect</span><span class="op" id="4515010">.</span><span class="ident" id="4515011">Kind</span><span class="op" id="4515015">)</span>&nbsp;<span class="builtintype" id="4515017">bool</span>&nbsp;<span class="op" id="4515022">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4515025">switch</span>&nbsp;<span class="ident" id="4515032">k</span>&nbsp;<span class="op" id="4515034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4515037">case</span>&nbsp;<span class="ident" id="4515042">reflect</span><span class="op" id="4515049">.</span><span class="ident" id="4515050">Int</span><span class="op" id="4515053">,</span>&nbsp;<span class="ident" id="4515055">reflect</span><span class="op" id="4515062">.</span><span class="ident" id="4515063">Int8</span><span class="op" id="4515067">,</span>&nbsp;<span class="ident" id="4515069">reflect</span><span class="op" id="4515076">.</span><span class="ident" id="4515077">Int16</span><span class="op" id="4515082">,</span>&nbsp;<span class="ident" id="4515084">reflect</span><span class="op" id="4515091">.</span><span class="ident" id="4515092">Int32</span><span class="op" id="4515097">,</span>&nbsp;<span class="ident" id="4515099">reflect</span><span class="op" id="4515106">.</span><span class="ident" id="4515107">Int64</span><span class="op" id="4515112">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4515116">return</span>&nbsp;<span class="builtintype" id="4515123">true</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4515129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4515133">return</span>&nbsp;<span class="builtintype" id="4515140">false</span><br>
<span class="lineno"></span><span class="op" id="4515146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="4515149">//&nbsp;setDefaultValue&nbsp;is&nbsp;used&nbsp;to&nbsp;install&nbsp;a&nbsp;default&nbsp;value,&nbsp;from&nbsp;a&nbsp;tag&nbsp;string,&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="4515228">//&nbsp;a&nbsp;Value.&nbsp;It&nbsp;is&nbsp;successful&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;optional,&nbsp;even&nbsp;if&nbsp;a&nbsp;default&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4515308">//&nbsp;wasn&#39;t&nbsp;provided&nbsp;or&nbsp;it&nbsp;failed&nbsp;to&nbsp;install&nbsp;it&nbsp;into&nbsp;the&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4515370">func</span>&nbsp;<span class="ident" id="4515375">setDefaultValue</span><span class="op" id="4515390">(</span><span class="ident" id="4515391">v</span>&nbsp;<span class="ident" id="4515393">reflect</span><span class="op" id="4515400">.</span><span class="ident" id="4515401">Value</span><span class="op" id="4515406">,</span>&nbsp;<span class="ident" id="4515408">params</span>&nbsp;<span class="ident" id="4515415">fieldParameters</span><span class="op" id="4515430">)</span>&nbsp;<span class="op" id="4515432">(</span><span class="ident" id="4515433">ok</span>&nbsp;<span class="builtintype" id="4515436">bool</span><span class="op" id="4515440">)</span>&nbsp;<span class="op" id="4515442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4515445">if</span>&nbsp;<span class="op" id="4515448">!</span><span class="ident" id="4515449">params</span><span class="op" id="4515455">.</span><span class="ident" id="4515456">optional</span>&nbsp;<span class="op" id="4515465">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4515469">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4515477">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4515480">ok</span>&nbsp;<span class="op" id="4515483">=</span>&nbsp;<span class="builtintype" id="4515485">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4515491">if</span>&nbsp;<span class="ident" id="4515494">params</span><span class="op" id="4515500">.</span><span class="ident" id="4515501">defaultValue</span>&nbsp;<span class="op" id="4515514">==</span>&nbsp;<span class="builtintype" id="4515517">nil</span>&nbsp;<span class="op" id="4515521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4515525">return</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4515533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4515536">if</span>&nbsp;<span class="ident" id="4515539">canHaveDefaultValue</span><span class="op" id="4515558">(</span><span class="ident" id="4515559">v</span><span class="op" id="4515560">.</span><span class="ident" id="4515561">Kind</span><span class="op" id="4515565">(</span><span class="op" id="4515566">)</span><span class="op" id="4515567">)</span>&nbsp;<span class="op" id="4515569">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4515573">v</span><span class="op" id="4515574">.</span><span class="ident" id="4515575">SetInt</span><span class="op" id="4515581">(</span><span class="op" id="4515582">*</span><span class="ident" id="4515583">params</span><span class="op" id="4515589">.</span><span class="ident" id="4515590">defaultValue</span><span class="op" id="4515602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4515605">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4515608">return</span><br>
<span class="lineno">855</span><span class="op" id="4515615">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4515618">//&nbsp;Unmarshal&nbsp;parses&nbsp;the&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structure&nbsp;b</span><br>
<span class="lineno"></span><span class="comment" id="4515677">//&nbsp;and&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package&nbsp;to&nbsp;fill&nbsp;in&nbsp;an&nbsp;arbitrary&nbsp;value&nbsp;pointed&nbsp;at&nbsp;by&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="4515758">//&nbsp;Because&nbsp;Unmarshal&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package,&nbsp;the&nbsp;structs</span><br>
<span class="lineno">860</span><span class="comment" id="4515817">//&nbsp;being&nbsp;written&nbsp;to&nbsp;must&nbsp;use&nbsp;upper&nbsp;case&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span><span class="comment" id="4515870">//</span><br>
<span class="lineno"></span><span class="comment" id="4515873">//&nbsp;An&nbsp;ASN.1&nbsp;INTEGER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;int,&nbsp;int32,&nbsp;int64,</span><br>
<span class="lineno"></span><span class="comment" id="4515933">//&nbsp;or&nbsp;*big.Int&nbsp;(from&nbsp;the&nbsp;math/big&nbsp;package).</span><br>
<span class="lineno"></span><span class="comment" id="4515977">//&nbsp;If&nbsp;the&nbsp;encoded&nbsp;value&nbsp;does&nbsp;not&nbsp;fit&nbsp;in&nbsp;the&nbsp;Go&nbsp;type,</span><br>
<span class="lineno">865</span><span class="comment" id="4516030">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4516066">//</span><br>
<span class="lineno"></span><span class="comment" id="4516069">//&nbsp;An&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="comment" id="4516123">//</span><br>
<span class="lineno"></span><span class="comment" id="4516126">//&nbsp;An&nbsp;ASN.1&nbsp;OCTET&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;[]byte.</span><br>
<span class="lineno">870</span><span class="comment" id="4516179">//</span><br>
<span class="lineno"></span><span class="comment" id="4516182">//&nbsp;An&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4516233">//&nbsp;ObjectIdentifier.</span><br>
<span class="lineno"></span><span class="comment" id="4516254">//</span><br>
<span class="lineno"></span><span class="comment" id="4516257">//&nbsp;An&nbsp;ASN.1&nbsp;ENUMERATED&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;Enumerated.</span><br>
<span class="lineno">875</span><span class="comment" id="4516313">//</span><br>
<span class="lineno"></span><span class="comment" id="4516316">//&nbsp;An&nbsp;ASN.1&nbsp;UTCTIME&nbsp;or&nbsp;GENERALIZEDTIME&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;time.Time.</span><br>
<span class="lineno"></span><span class="comment" id="4516386">//</span><br>
<span class="lineno"></span><span class="comment" id="4516389">//&nbsp;An&nbsp;ASN.1&nbsp;PrintableString&nbsp;or&nbsp;IA5String&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="4516458">//</span><br>
<span class="lineno">880</span><span class="comment" id="4516461">//&nbsp;Any&nbsp;of&nbsp;the&nbsp;above&nbsp;ASN.1&nbsp;values&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="4516528">//&nbsp;The&nbsp;value&nbsp;stored&nbsp;in&nbsp;the&nbsp;interface&nbsp;has&nbsp;the&nbsp;corresponding&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4516596">//&nbsp;For&nbsp;integers,&nbsp;that&nbsp;type&nbsp;is&nbsp;int64.</span><br>
<span class="lineno"></span><span class="comment" id="4516633">//</span><br>
<span class="lineno"></span><span class="comment" id="4516636">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;OF&nbsp;x&nbsp;or&nbsp;SET&nbsp;OF&nbsp;x&nbsp;can&nbsp;be&nbsp;written</span><br>
<span class="lineno">885</span><span class="comment" id="4516689">//&nbsp;to&nbsp;a&nbsp;slice&nbsp;if&nbsp;an&nbsp;x&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;the&nbsp;slice&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4516755">//</span><br>
<span class="lineno"></span><span class="comment" id="4516758">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;or&nbsp;SET&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="4516813">//&nbsp;if&nbsp;each&nbsp;of&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;sequence&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4516863">//&nbsp;written&nbsp;to&nbsp;the&nbsp;corresponding&nbsp;element&nbsp;in&nbsp;the&nbsp;struct.</span><br>
<span class="lineno">890</span><span class="comment" id="4516918">//</span><br>
<span class="lineno"></span><span class="comment" id="4516921">//&nbsp;The&nbsp;following&nbsp;tags&nbsp;on&nbsp;struct&nbsp;fields&nbsp;have&nbsp;special&nbsp;meaning&nbsp;to&nbsp;Unmarshal:</span><br>
<span class="lineno"></span><span class="comment" id="4516995">//</span><br>
<span class="lineno"></span><span class="comment" id="4516998">//&nbsp;&nbsp;&nbsp;&nbsp;application&nbsp;&nbsp;&nbsp;&nbsp;specifies&nbsp;that&nbsp;a&nbsp;APPLICATION&nbsp;tag&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="4517054">//&nbsp;&nbsp;&nbsp;&nbsp;default:x&nbsp;&nbsp;&nbsp;&nbsp;sets&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;optional&nbsp;integer&nbsp;fields</span><br>
<span class="lineno">895</span><span class="comment" id="4517118">//&nbsp;&nbsp;&nbsp;&nbsp;explicit&nbsp;&nbsp;&nbsp;&nbsp;specifies&nbsp;that&nbsp;an&nbsp;additional,&nbsp;explicit&nbsp;tag&nbsp;wraps&nbsp;the&nbsp;implicit&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="4517196">//&nbsp;&nbsp;&nbsp;&nbsp;optional&nbsp;&nbsp;&nbsp;&nbsp;marks&nbsp;the&nbsp;field&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL</span><br>
<span class="lineno"></span><span class="comment" id="4517242">//&nbsp;&nbsp;&nbsp;&nbsp;set&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;causes&nbsp;a&nbsp;SET,&nbsp;rather&nbsp;than&nbsp;a&nbsp;SEQUENCE&nbsp;type&nbsp;to&nbsp;be&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="4517307">//&nbsp;&nbsp;&nbsp;&nbsp;tag:x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;specifies&nbsp;the&nbsp;ASN.1&nbsp;tag&nbsp;number;&nbsp;implies&nbsp;ASN.1&nbsp;CONTEXT&nbsp;SPECIFIC</span><br>
<span class="lineno"></span><span class="comment" id="4517380">//</span><br>
<span class="lineno">900</span><span class="comment" id="4517383">//&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;a&nbsp;structure&nbsp;is&nbsp;RawContent&nbsp;then&nbsp;the&nbsp;raw</span><br>
<span class="lineno"></span><span class="comment" id="4517459">//&nbsp;ASN1&nbsp;contents&nbsp;of&nbsp;the&nbsp;struct&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4517512">//</span><br>
<span class="lineno"></span><span class="comment" id="4517515">//&nbsp;If&nbsp;the&nbsp;type&nbsp;name&nbsp;of&nbsp;a&nbsp;slice&nbsp;element&nbsp;ends&nbsp;with&nbsp;&#34;SET&#34;&nbsp;then&nbsp;it&#39;s&nbsp;treated&nbsp;as&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="4517594">//&nbsp;the&nbsp;&#34;set&#34;&nbsp;tag&nbsp;was&nbsp;set&nbsp;on&nbsp;it.&nbsp;This&nbsp;can&nbsp;be&nbsp;used&nbsp;with&nbsp;nested&nbsp;slices&nbsp;where&nbsp;a</span><br>
<span class="lineno">905</span><span class="comment" id="4517670">//&nbsp;struct&nbsp;tag&nbsp;cannot&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="comment" id="4517701">//</span><br>
<span class="lineno"></span><span class="comment" id="4517704">//&nbsp;Other&nbsp;ASN.1&nbsp;types&nbsp;are&nbsp;not&nbsp;supported;&nbsp;if&nbsp;it&nbsp;encounters&nbsp;them,</span><br>
<span class="lineno"></span><span class="comment" id="4517767">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4517803">func</span>&nbsp;<span class="ident" id="4517808">Unmarshal</span><span class="op" id="4517817">(</span><span class="ident" id="4517818">b</span>&nbsp;<span class="op" id="4517820">[</span><span class="op" id="4517821">]</span><span class="builtintype" id="4517822">byte</span><span class="op" id="4517826">,</span>&nbsp;<span class="ident" id="4517828">val</span>&nbsp;<span class="keyword" id="4517832">interface</span><span class="op" id="4517841">{</span><span class="op" id="4517842">}</span><span class="op" id="4517843">)</span>&nbsp;<span class="op" id="4517845">(</span><span class="ident" id="4517846">rest</span>&nbsp;<span class="op" id="4517851">[</span><span class="op" id="4517852">]</span><span class="builtintype" id="4517853">byte</span><span class="op" id="4517857">,</span>&nbsp;<span class="ident" id="4517859">err</span>&nbsp;<span class="builtintype" id="4517863">error</span><span class="op" id="4517868">)</span>&nbsp;<span class="op" id="4517870">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4517873">return</span>&nbsp;<span class="ident" id="4517880">UnmarshalWithParams</span><span class="op" id="4517899">(</span><span class="ident" id="4517900">b</span><span class="op" id="4517901">,</span>&nbsp;<span class="ident" id="4517903">val</span><span class="op" id="4517906">,</span>&nbsp;<span class="string" id="4517908">&#34;&#34;</span><span class="op" id="4517910">)</span><br>
<span class="lineno"></span><span class="op" id="4517912">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4517915">//&nbsp;UnmarshalWithParams&nbsp;allows&nbsp;field&nbsp;parameters&nbsp;to&nbsp;be&nbsp;specified&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4517986">//&nbsp;top-level&nbsp;element.&nbsp;The&nbsp;form&nbsp;of&nbsp;the&nbsp;params&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;field&nbsp;tags.</span><br>
<span class="lineno">915</span><span class="keyword" id="4518062">func</span>&nbsp;<span class="ident" id="4518067">UnmarshalWithParams</span><span class="op" id="4518086">(</span><span class="ident" id="4518087">b</span>&nbsp;<span class="op" id="4518089">[</span><span class="op" id="4518090">]</span><span class="builtintype" id="4518091">byte</span><span class="op" id="4518095">,</span>&nbsp;<span class="ident" id="4518097">val</span>&nbsp;<span class="keyword" id="4518101">interface</span><span class="op" id="4518110">{</span><span class="op" id="4518111">}</span><span class="op" id="4518112">,</span>&nbsp;<span class="ident" id="4518114">params</span>&nbsp;<span class="builtintype" id="4518121">string</span><span class="op" id="4518127">)</span>&nbsp;<span class="op" id="4518129">(</span><span class="ident" id="4518130">rest</span>&nbsp;<span class="op" id="4518135">[</span><span class="op" id="4518136">]</span><span class="builtintype" id="4518137">byte</span><span class="op" id="4518141">,</span>&nbsp;<span class="ident" id="4518143">err</span>&nbsp;<span class="builtintype" id="4518147">error</span><span class="op" id="4518152">)</span>&nbsp;<span class="op" id="4518154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4518157">v</span>&nbsp;<span class="op" id="4518159">:=</span>&nbsp;<span class="ident" id="4518162">reflect</span><span class="op" id="4518169">.</span><span class="ident" id="4518170">ValueOf</span><span class="op" id="4518177">(</span><span class="ident" id="4518178">val</span><span class="op" id="4518181">)</span><span class="op" id="4518182">.</span><span class="ident" id="4518183">Elem</span><span class="op" id="4518187">(</span><span class="op" id="4518188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4518191">offset</span><span class="op" id="4518197">,</span>&nbsp;<span class="ident" id="4518199">err</span>&nbsp;<span class="op" id="4518203">:=</span>&nbsp;<span class="ident" id="4518206">parseField</span><span class="op" id="4518216">(</span><span class="ident" id="4518217">v</span><span class="op" id="4518218">,</span>&nbsp;<span class="ident" id="4518220">b</span><span class="op" id="4518221">,</span>&nbsp;<span class="num" id="4518223">0</span><span class="op" id="4518224">,</span>&nbsp;<span class="ident" id="4518226">parseFieldParameters</span><span class="op" id="4518246">(</span><span class="ident" id="4518247">params</span><span class="op" id="4518253">)</span><span class="op" id="4518254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4518257">if</span>&nbsp;<span class="ident" id="4518260">err</span>&nbsp;<span class="op" id="4518264">!=</span>&nbsp;<span class="builtintype" id="4518267">nil</span>&nbsp;<span class="op" id="4518271">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4518275">return</span>&nbsp;<span class="builtintype" id="4518282">nil</span><span class="op" id="4518285">,</span>&nbsp;<span class="ident" id="4518287">err</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4518292">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4518295">return</span>&nbsp;<span class="ident" id="4518302">b</span><span class="op" id="4518303">[</span><span class="ident" id="4518304">offset</span><span class="op" id="4518310">:</span><span class="op" id="4518311">]</span><span class="op" id="4518312">,</span>&nbsp;<span class="builtintype" id="4518314">nil</span><br>
<span class="lineno"></span><span class="op" id="4518318">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
