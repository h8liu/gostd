<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3600322">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3600377">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3600431">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="3600482">//&nbsp;Package&nbsp;mime&nbsp;implements&nbsp;parts&nbsp;of&nbsp;the&nbsp;MIME&nbsp;spec.</span><br>
<span class="lineno"></span><span class="keyword" id="3600533">package</span>&nbsp;<span class="ident" id="3600541">mime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3600547">import</span>&nbsp;<span class="op" id="3600554">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3600557">&#34;fmt&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3600564">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3600575">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="3600582">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3600585">var</span>&nbsp;<span class="op" id="3600589">(</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3600592">mimeLock</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3600607"><a href="/mime/type.go.html#3600575">sync</a></span><span class="op" id="3600611">.</span><span class="ident" id="3600612">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3600621">mimeTypesLower</span>&nbsp;<span class="op" id="3600636">=</span>&nbsp;<span class="keyword" id="3600638">map</span><span class="op" id="3600641">[</span><span class="builtintype" id="3600642">string</span><span class="op" id="3600648">]</span><span class="builtintype" id="3600649">string</span><span class="op" id="3600655">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3600659">&#34;.css&#34;</span><span class="op" id="3600665">:</span>&nbsp;&nbsp;<span class="string" id="3600668">&#34;text/css;&nbsp;charset=utf-8&#34;</span><span class="op" id="3600693">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3600697">&#34;.gif&#34;</span><span class="op" id="3600703">:</span>&nbsp;&nbsp;<span class="string" id="3600706">&#34;image/gif&#34;</span><span class="op" id="3600717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3600721">&#34;.htm&#34;</span><span class="op" id="3600727">:</span>&nbsp;&nbsp;<span class="string" id="3600730">&#34;text/html;&nbsp;charset=utf-8&#34;</span><span class="op" id="3600756">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3600760">&#34;.html&#34;</span><span class="op" id="3600767">:</span>&nbsp;<span class="string" id="3600769">&#34;text/html;&nbsp;charset=utf-8&#34;</span><span class="op" id="3600795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3600799">&#34;.jpg&#34;</span><span class="op" id="3600805">:</span>&nbsp;&nbsp;<span class="string" id="3600808">&#34;image/jpeg&#34;</span><span class="op" id="3600820">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3600824">&#34;.js&#34;</span><span class="op" id="3600829">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="3600833">&#34;application/x-javascript&#34;</span><span class="op" id="3600859">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3600863">&#34;.pdf&#34;</span><span class="op" id="3600869">:</span>&nbsp;&nbsp;<span class="string" id="3600872">&#34;application/pdf&#34;</span><span class="op" id="3600889">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3600893">&#34;.png&#34;</span><span class="op" id="3600899">:</span>&nbsp;&nbsp;<span class="string" id="3600902">&#34;image/png&#34;</span><span class="op" id="3600913">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3600917">&#34;.xml&#34;</span><span class="op" id="3600923">:</span>&nbsp;&nbsp;<span class="string" id="3600926">&#34;text/xml;&nbsp;charset=utf-8&#34;</span><span class="op" id="3600951">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3600954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3600957">mimeTypes</span>&nbsp;<span class="op" id="3600967">=</span>&nbsp;<span class="ident" id="3600969"><a href="/mime/type.go.html#3600999">clone</a></span><span class="op" id="3600974">(</span><span class="ident" id="3600975"><a href="/mime/type.go.html#3600621">mimeTypesLower</a></span><span class="op" id="3600989">)</span><br>
<span class="lineno"></span><span class="op" id="3600991">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="3600994">func</span>&nbsp;<span class="ident" id="3600999">clone</span><span class="op" id="3601004">(</span><span class="ident" id="3601005">m</span>&nbsp;<span class="keyword" id="3601007">map</span><span class="op" id="3601010">[</span><span class="builtintype" id="3601011">string</span><span class="op" id="3601017">]</span><span class="builtintype" id="3601018">string</span><span class="op" id="3601024">)</span>&nbsp;<span class="keyword" id="3601026">map</span><span class="op" id="3601029">[</span><span class="builtintype" id="3601030">string</span><span class="op" id="3601036">]</span><span class="builtintype" id="3601037">string</span>&nbsp;<span class="op" id="3601044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3601047">m2</span>&nbsp;<span class="op" id="3601050">:=</span>&nbsp;<span class="builtinfunc" id="3601053">make</span><span class="op" id="3601057">(</span><span class="keyword" id="3601058">map</span><span class="op" id="3601061">[</span><span class="builtintype" id="3601062">string</span><span class="op" id="3601068">]</span><span class="builtintype" id="3601069">string</span><span class="op" id="3601075">,</span>&nbsp;<span class="builtinfunc" id="3601077">len</span><span class="op" id="3601080">(</span><span class="ident" id="3601081"><a href="/mime/type.go.html#3601005">m</a></span><span class="op" id="3601082">)</span><span class="op" id="3601083">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601086">for</span>&nbsp;<span class="ident" id="3601090">k</span><span class="op" id="3601091">,</span>&nbsp;<span class="ident" id="3601093">v</span>&nbsp;<span class="op" id="3601095">:=</span>&nbsp;<span class="keyword" id="3601098">range</span>&nbsp;<span class="ident" id="3601104"><a href="/mime/type.go.html#3601005">m</a></span>&nbsp;<span class="op" id="3601106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3601110"><a href="/mime/type.go.html#3601047">m2</a></span><span class="op" id="3601112">[</span><span class="ident" id="3601113"><a href="/mime/type.go.html#3601090">k</a></span><span class="op" id="3601114">]</span>&nbsp;<span class="op" id="3601116">=</span>&nbsp;<span class="ident" id="3601118"><a href="/mime/type.go.html#3601093">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601122">if</span>&nbsp;<span class="ident" id="3601125"><a href="/mime/type.go.html#3600564">strings</a></span><span class="op" id="3601132">.</span><span class="ident" id="3601133">ToLower</span><span class="op" id="3601140">(</span><span class="ident" id="3601141"><a href="/mime/type.go.html#3601090">k</a></span><span class="op" id="3601142">)</span>&nbsp;<span class="op" id="3601144">!=</span>&nbsp;<span class="ident" id="3601147"><a href="/mime/type.go.html#3601090">k</a></span>&nbsp;<span class="op" id="3601149">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3601154">panic</span><span class="op" id="3601159">(</span><span class="string" id="3601160">&#34;keys&nbsp;in&nbsp;mimeTypesLower&nbsp;must&nbsp;be&nbsp;lowercase&#34;</span><span class="op" id="3601202">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3601206">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3601209">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3601212">return</span>&nbsp;<span class="ident" id="3601219"><a href="/mime/type.go.html#3601047">m2</a></span><br>
<span class="lineno"></span><span class="op" id="3601222">}</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="keyword" id="3601225">var</span>&nbsp;<span class="ident" id="3601229">once</span>&nbsp;<span class="ident" id="3601234"><a href="/mime/type.go.html#3600575">sync</a></span><span class="op" id="3601238">.</span><span class="ident" id="3601239">Once</span>&nbsp;<span class="comment" id="3601244">//&nbsp;guards&nbsp;initMime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3601264">//&nbsp;TypeByExtension&nbsp;returns&nbsp;the&nbsp;MIME&nbsp;type&nbsp;associated&nbsp;with&nbsp;the&nbsp;file&nbsp;extension&nbsp;ext.</span><br>
<span class="lineno"></span><span class="comment" id="3601345">//&nbsp;The&nbsp;extension&nbsp;ext&nbsp;should&nbsp;begin&nbsp;with&nbsp;a&nbsp;leading&nbsp;dot,&nbsp;as&nbsp;in&nbsp;&#34;.html&#34;.</span><br>
<span class="lineno">45</span><span class="comment" id="3601414">//&nbsp;When&nbsp;ext&nbsp;has&nbsp;no&nbsp;associated&nbsp;type,&nbsp;TypeByExtension&nbsp;returns&nbsp;&#34;&#34;.</span><br>
<span class="lineno"></span><span class="comment" id="3601478">//</span><br>
<span class="lineno"></span><span class="comment" id="3601481">//&nbsp;Extensions&nbsp;are&nbsp;looked&nbsp;up&nbsp;first&nbsp;case-sensitively,&nbsp;then&nbsp;case-insensitively.</span><br>
<span class="lineno"></span><span class="comment" id="3601558">//</span><br>
<span class="lineno"></span><span class="comment" id="3601561">//&nbsp;The&nbsp;built-in&nbsp;table&nbsp;is&nbsp;small&nbsp;but&nbsp;on&nbsp;unix&nbsp;it&nbsp;is&nbsp;augmented&nbsp;by&nbsp;the&nbsp;local</span><br>
<span class="lineno">50</span><span class="comment" id="3601633">//&nbsp;system&#39;s&nbsp;mime.types&nbsp;file(s)&nbsp;if&nbsp;available&nbsp;under&nbsp;one&nbsp;or&nbsp;more&nbsp;of&nbsp;these</span><br>
<span class="lineno"></span><span class="comment" id="3601704">//&nbsp;names:</span><br>
<span class="lineno"></span><span class="comment" id="3601714">//</span><br>
<span class="lineno"></span><span class="comment" id="3601717">//&nbsp;&nbsp;&nbsp;/etc/mime.types</span><br>
<span class="lineno"></span><span class="comment" id="3601738">//&nbsp;&nbsp;&nbsp;/etc/apache2/mime.types</span><br>
<span class="lineno">55</span><span class="comment" id="3601767">//&nbsp;&nbsp;&nbsp;/etc/apache/mime.types</span><br>
<span class="lineno"></span><span class="comment" id="3601795">//</span><br>
<span class="lineno"></span><span class="comment" id="3601798">//&nbsp;On&nbsp;Windows,&nbsp;MIME&nbsp;types&nbsp;are&nbsp;extracted&nbsp;from&nbsp;the&nbsp;registry.</span><br>
<span class="lineno"></span><span class="comment" id="3601857">//</span><br>
<span class="lineno"></span><span class="comment" id="3601860">//&nbsp;Text&nbsp;types&nbsp;have&nbsp;the&nbsp;charset&nbsp;parameter&nbsp;set&nbsp;to&nbsp;&#34;utf-8&#34;&nbsp;by&nbsp;default.</span><br>
<span class="lineno">60</span><span class="keyword" id="3601928">func</span>&nbsp;<span class="ident" id="3601933">TypeByExtension</span><span class="op" id="3601948">(</span><span class="ident" id="3601949">ext</span>&nbsp;<span class="builtintype" id="3601953">string</span><span class="op" id="3601959">)</span>&nbsp;<span class="builtintype" id="3601961">string</span>&nbsp;<span class="op" id="3601968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3601971"><a href="/mime/type.go.html#3601229">once</a></span><span class="op" id="3601975">.</span><span class="ident" id="3601976">Do</span><span class="op" id="3601978">(</span><span class="ident" id="3601979"><a href="/mime/type_unix.go.html#3604366">initMime</a></span><span class="op" id="3601987">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3601990"><a href="/mime/type.go.html#3600592">mimeLock</a></span><span class="op" id="3601998">.</span><span class="ident" id="3601999">RLock</span><span class="op" id="3602004">(</span><span class="op" id="3602005">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602008">defer</span>&nbsp;<span class="ident" id="3602014"><a href="/mime/type.go.html#3600592">mimeLock</a></span><span class="op" id="3602022">.</span><span class="ident" id="3602023">RUnlock</span><span class="op" id="3602030">(</span><span class="op" id="3602031">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3602035">//&nbsp;Case-sensitive&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3602062">v</span>&nbsp;<span class="op" id="3602064">:=</span>&nbsp;<span class="ident" id="3602067"><a href="/mime/type.go.html#3600957">mimeTypes</a></span><span class="op" id="3602076">[</span><span class="ident" id="3602077"><a href="/mime/type.go.html#3601949">ext</a></span><span class="op" id="3602080">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602083">if</span>&nbsp;<span class="ident" id="3602086"><a href="/mime/type.go.html#3602062">v</a></span>&nbsp;<span class="op" id="3602088">!=</span>&nbsp;<span class="string" id="3602091">&#34;&#34;</span>&nbsp;<span class="op" id="3602094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602098">return</span>&nbsp;<span class="ident" id="3602105"><a href="/mime/type.go.html#3602062">v</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3602108">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3602112">//&nbsp;Case-insensitive&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3602141">//&nbsp;Optimistically&nbsp;assume&nbsp;a&nbsp;short&nbsp;ASCII&nbsp;extension&nbsp;and&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3602198">//&nbsp;allocation-free&nbsp;in&nbsp;that&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602232">var</span>&nbsp;<span class="ident" id="3602236">buf</span>&nbsp;<span class="op" id="3602240">[</span><span class="num" id="3602241">10</span><span class="op" id="3602243">]</span><span class="builtintype" id="3602244">byte</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3602250">lower</span>&nbsp;<span class="op" id="3602256">:=</span>&nbsp;<span class="ident" id="3602259"><a href="/mime/type.go.html#3602236">buf</a></span><span class="op" id="3602262">[</span><span class="op" id="3602263">:</span><span class="num" id="3602264">0</span><span class="op" id="3602265">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602268">const</span>&nbsp;<span class="ident" id="3602274">utf8RuneSelf</span>&nbsp;<span class="op" id="3602287">=</span>&nbsp;<span class="num" id="3602289">0x80</span>&nbsp;<span class="comment" id="3602294">//&nbsp;from&nbsp;utf8&nbsp;package,&nbsp;but&nbsp;not&nbsp;importing&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602339">for</span>&nbsp;<span class="ident" id="3602343">i</span>&nbsp;<span class="op" id="3602345">:=</span>&nbsp;<span class="num" id="3602348">0</span><span class="op" id="3602349">;</span>&nbsp;<span class="ident" id="3602351"><a href="/mime/type.go.html#3602343">i</a></span>&nbsp;<span class="op" id="3602353">&lt;</span>&nbsp;<span class="builtinfunc" id="3602355">len</span><span class="op" id="3602358">(</span><span class="ident" id="3602359"><a href="/mime/type.go.html#3601949">ext</a></span><span class="op" id="3602362">)</span><span class="op" id="3602363">;</span>&nbsp;<span class="ident" id="3602365"><a href="/mime/type.go.html#3602343">i</a></span><span class="op" id="3602366">++</span>&nbsp;<span class="op" id="3602369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3602373">c</span>&nbsp;<span class="op" id="3602375">:=</span>&nbsp;<span class="ident" id="3602378"><a href="/mime/type.go.html#3601949">ext</a></span><span class="op" id="3602381">[</span><span class="ident" id="3602382"><a href="/mime/type.go.html#3602343">i</a></span><span class="op" id="3602383">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602387">if</span>&nbsp;<span class="ident" id="3602390"><a href="/mime/type.go.html#3602373">c</a></span>&nbsp;<span class="op" id="3602392">&gt;=</span>&nbsp;<span class="ident" id="3602395"><a href="/mime/type.go.html#3602274">utf8RuneSelf</a></span>&nbsp;<span class="op" id="3602408">{</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3602413">//&nbsp;Slow&nbsp;path.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602430">return</span>&nbsp;<span class="ident" id="3602437"><a href="/mime/type.go.html#3600621">mimeTypesLower</a></span><span class="op" id="3602451">[</span><span class="ident" id="3602452"><a href="/mime/type.go.html#3600564">strings</a></span><span class="op" id="3602459">.</span><span class="ident" id="3602460">ToLower</span><span class="op" id="3602467">(</span><span class="ident" id="3602468"><a href="/mime/type.go.html#3601949">ext</a></span><span class="op" id="3602471">)</span><span class="op" id="3602472">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3602476">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602480">if</span>&nbsp;<span class="string" id="3602483">&#39;A&#39;</span>&nbsp;<span class="op" id="3602487">&lt;=</span>&nbsp;<span class="ident" id="3602490"><a href="/mime/type.go.html#3602373">c</a></span>&nbsp;<span class="op" id="3602492">&amp;&amp;</span>&nbsp;<span class="ident" id="3602495"><a href="/mime/type.go.html#3602373">c</a></span>&nbsp;<span class="op" id="3602497">&lt;=</span>&nbsp;<span class="string" id="3602500">&#39;Z&#39;</span>&nbsp;<span class="op" id="3602504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3602509"><a href="/mime/type.go.html#3602250">lower</a></span>&nbsp;<span class="op" id="3602515">=</span>&nbsp;<span class="builtinfunc" id="3602517">append</span><span class="op" id="3602523">(</span><span class="ident" id="3602524"><a href="/mime/type.go.html#3602250">lower</a></span><span class="op" id="3602529">,</span>&nbsp;<span class="ident" id="3602531"><a href="/mime/type.go.html#3602373">c</a></span><span class="op" id="3602532">+</span><span class="op" id="3602533">(</span><span class="string" id="3602534">&#39;a&#39;</span><span class="op" id="3602537">-</span><span class="string" id="3602538">&#39;A&#39;</span><span class="op" id="3602541">)</span><span class="op" id="3602542">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3602546">}</span>&nbsp;<span class="keyword" id="3602548">else</span>&nbsp;<span class="op" id="3602553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3602558"><a href="/mime/type.go.html#3602250">lower</a></span>&nbsp;<span class="op" id="3602564">=</span>&nbsp;<span class="builtinfunc" id="3602566">append</span><span class="op" id="3602572">(</span><span class="ident" id="3602573"><a href="/mime/type.go.html#3602250">lower</a></span><span class="op" id="3602578">,</span>&nbsp;<span class="ident" id="3602580"><a href="/mime/type.go.html#3602373">c</a></span><span class="op" id="3602581">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3602585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3602588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3602591">//&nbsp;The&nbsp;conversion&nbsp;from&nbsp;[]byte&nbsp;to&nbsp;string&nbsp;doesn&#39;t&nbsp;allocate&nbsp;in</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3602652">//&nbsp;a&nbsp;map&nbsp;lookup.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602670">return</span>&nbsp;<span class="ident" id="3602677"><a href="/mime/type.go.html#3600621">mimeTypesLower</a></span><span class="op" id="3602691">[</span><span class="builtintype" id="3602692">string</span><span class="op" id="3602698">(</span><span class="ident" id="3602699"><a href="/mime/type.go.html#3602250">lower</a></span><span class="op" id="3602704">)</span><span class="op" id="3602705">]</span><br>
<span class="lineno"></span><span class="op" id="3602707">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3602710">//&nbsp;AddExtensionType&nbsp;sets&nbsp;the&nbsp;MIME&nbsp;type&nbsp;associated&nbsp;with</span><br>
<span class="lineno">95</span><span class="comment" id="3602765">//&nbsp;the&nbsp;extension&nbsp;ext&nbsp;to&nbsp;typ.&nbsp;The&nbsp;extension&nbsp;should&nbsp;begin&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="3602826">//&nbsp;a&nbsp;leading&nbsp;dot,&nbsp;as&nbsp;in&nbsp;&#34;.html&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3602859">func</span>&nbsp;<span class="ident" id="3602864">AddExtensionType</span><span class="op" id="3602880">(</span><span class="ident" id="3602881">ext</span><span class="op" id="3602884">,</span>&nbsp;<span class="ident" id="3602886">typ</span>&nbsp;<span class="builtintype" id="3602890">string</span><span class="op" id="3602896">)</span>&nbsp;<span class="builtintype" id="3602898">error</span>&nbsp;<span class="op" id="3602904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602907">if</span>&nbsp;<span class="op" id="3602910">!</span><span class="ident" id="3602911"><a href="/mime/type.go.html#3600564">strings</a></span><span class="op" id="3602918">.</span><span class="ident" id="3602919">HasPrefix</span><span class="op" id="3602928">(</span><span class="ident" id="3602929"><a href="/mime/type.go.html#3602881">ext</a></span><span class="op" id="3602932">,</span>&nbsp;<span class="string" id="3602934">&#34;.&#34;</span><span class="op" id="3602937">)</span>&nbsp;<span class="op" id="3602939">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3602943">return</span>&nbsp;<span class="ident" id="3602950"><a href="/mime/type.go.html#3600557">fmt</a></span><span class="op" id="3602953">.</span><span class="ident" id="3602954">Errorf</span><span class="op" id="3602960">(</span><span class="string" id="3602961">`mime:&nbsp;extension&nbsp;%q&nbsp;misses&nbsp;dot`</span><span class="op" id="3602992">,</span>&nbsp;<span class="ident" id="3602994"><a href="/mime/type.go.html#3602881">ext</a></span><span class="op" id="3602997">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3603000">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603003"><a href="/mime/type.go.html#3601229">once</a></span><span class="op" id="3603007">.</span><span class="ident" id="3603008">Do</span><span class="op" id="3603010">(</span><span class="ident" id="3603011"><a href="/mime/type_unix.go.html#3604366">initMime</a></span><span class="op" id="3603019">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603022">return</span>&nbsp;<span class="ident" id="3603029"><a href="/mime/type.go.html#3603064">setExtensionType</a></span><span class="op" id="3603045">(</span><span class="ident" id="3603046"><a href="/mime/type.go.html#3602881">ext</a></span><span class="op" id="3603049">,</span>&nbsp;<span class="ident" id="3603051"><a href="/mime/type.go.html#3602886">typ</a></span><span class="op" id="3603054">)</span><br>
<span class="lineno"></span><span class="op" id="3603056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">105</span><span class="keyword" id="3603059">func</span>&nbsp;<span class="ident" id="3603064">setExtensionType</span><span class="op" id="3603080">(</span><span class="ident" id="3603081">extension</span><span class="op" id="3603090">,</span>&nbsp;<span class="ident" id="3603092">mimeType</span>&nbsp;<span class="builtintype" id="3603101">string</span><span class="op" id="3603107">)</span>&nbsp;<span class="builtintype" id="3603109">error</span>&nbsp;<span class="op" id="3603115">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603118">_</span><span class="op" id="3603119">,</span>&nbsp;<span class="ident" id="3603121">param</span><span class="op" id="3603126">,</span>&nbsp;<span class="ident" id="3603128">err</span>&nbsp;<span class="op" id="3603132">:=</span>&nbsp;<span class="ident" id="3603135"><a href="/mime/mediatype.go.html#3594498">ParseMediaType</a></span><span class="op" id="3603149">(</span><span class="ident" id="3603150"><a href="/mime/type.go.html#3603092">mimeType</a></span><span class="op" id="3603158">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603161">if</span>&nbsp;<span class="ident" id="3603164"><a href="/mime/type.go.html#3603128">err</a></span>&nbsp;<span class="op" id="3603168">!=</span>&nbsp;<span class="ident" id="3603171">nil</span>&nbsp;<span class="op" id="3603175">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603179">return</span>&nbsp;<span class="ident" id="3603186"><a href="/mime/type.go.html#3603128">err</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3603191">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603194">if</span>&nbsp;<span class="ident" id="3603197"><a href="/mime/type.go.html#3600564">strings</a></span><span class="op" id="3603204">.</span><span class="ident" id="3603205">HasPrefix</span><span class="op" id="3603214">(</span><span class="ident" id="3603215"><a href="/mime/type.go.html#3603092">mimeType</a></span><span class="op" id="3603223">,</span>&nbsp;<span class="string" id="3603225">&#34;text/&#34;</span><span class="op" id="3603232">)</span>&nbsp;<span class="op" id="3603234">&amp;&amp;</span>&nbsp;<span class="ident" id="3603237"><a href="/mime/type.go.html#3603121">param</a></span><span class="op" id="3603242">[</span><span class="string" id="3603243">&#34;charset&#34;</span><span class="op" id="3603252">]</span>&nbsp;<span class="op" id="3603254">==</span>&nbsp;<span class="string" id="3603257">&#34;&#34;</span>&nbsp;<span class="op" id="3603260">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603264"><a href="/mime/type.go.html#3603121">param</a></span><span class="op" id="3603269">[</span><span class="string" id="3603270">&#34;charset&#34;</span><span class="op" id="3603279">]</span>&nbsp;<span class="op" id="3603281">=</span>&nbsp;<span class="string" id="3603283">&#34;utf-8&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603293"><a href="/mime/type.go.html#3603092">mimeType</a></span>&nbsp;<span class="op" id="3603302">=</span>&nbsp;<span class="ident" id="3603304"><a href="/mime/mediatype.go.html#3592525">FormatMediaType</a></span><span class="op" id="3603319">(</span><span class="ident" id="3603320"><a href="/mime/type.go.html#3603092">mimeType</a></span><span class="op" id="3603328">,</span>&nbsp;<span class="ident" id="3603330"><a href="/mime/type.go.html#3603121">param</a></span><span class="op" id="3603335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3603338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603341">extLower</span>&nbsp;<span class="op" id="3603350">:=</span>&nbsp;<span class="ident" id="3603353"><a href="/mime/type.go.html#3600564">strings</a></span><span class="op" id="3603360">.</span><span class="ident" id="3603361">ToLower</span><span class="op" id="3603368">(</span><span class="ident" id="3603369"><a href="/mime/type.go.html#3603081">extension</a></span><span class="op" id="3603378">)</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603382"><a href="/mime/type.go.html#3600592">mimeLock</a></span><span class="op" id="3603390">.</span><span class="ident" id="3603391">Lock</span><span class="op" id="3603395">(</span><span class="op" id="3603396">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603399"><a href="/mime/type.go.html#3600957">mimeTypes</a></span><span class="op" id="3603408">[</span><span class="ident" id="3603409"><a href="/mime/type.go.html#3603081">extension</a></span><span class="op" id="3603418">]</span>&nbsp;<span class="op" id="3603420">=</span>&nbsp;<span class="ident" id="3603422"><a href="/mime/type.go.html#3603092">mimeType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603432"><a href="/mime/type.go.html#3600621">mimeTypesLower</a></span><span class="op" id="3603446">[</span><span class="ident" id="3603447"><a href="/mime/type.go.html#3603341">extLower</a></span><span class="op" id="3603455">]</span>&nbsp;<span class="op" id="3603457">=</span>&nbsp;<span class="ident" id="3603459"><a href="/mime/type.go.html#3603092">mimeType</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3603469"><a href="/mime/type.go.html#3600592">mimeLock</a></span><span class="op" id="3603477">.</span><span class="ident" id="3603478">Unlock</span><span class="op" id="3603484">(</span><span class="op" id="3603485">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3603488">return</span>&nbsp;<span class="ident" id="3603495">nil</span><br>
<span class="lineno"></span><span class="op" id="3603499">}</span>
</div>
</body>
</html>
