<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="8285778">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8285833">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8285887">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8285938">package</span>&nbsp;<span class="ident" id="8285946">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8285951">import</span>&nbsp;<span class="op" id="8285958">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8285961">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8285968">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8285974">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8285985">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8285995">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8285998">var</span>&nbsp;<span class="ident" id="8286002">ipv4MulticastListenerTests</span>&nbsp;<span class="op" id="8286029">=</span>&nbsp;<span class="op" id="8286031">[</span><span class="op" id="8286032">]</span><span class="keyword" id="8286033">struct</span>&nbsp;<span class="op" id="8286040">{</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8286043">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8286049">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8286057">gaddr</span>&nbsp;<span class="op" id="8286063">*</span><span class="ident" id="8286064">UDPAddr</span>&nbsp;<span class="comment" id="8286072">//&nbsp;see&nbsp;RFC&nbsp;4727</span><br>
<span class="lineno"></span><span class="op" id="8286088">}</span><span class="op" id="8286089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8286092">{</span><span class="string" id="8286093">&#34;udp&#34;</span><span class="op" id="8286098">,</span>&nbsp;<span class="op" id="8286100">&amp;</span><span class="ident" id="8286101">UDPAddr</span><span class="op" id="8286108">{</span><span class="ident" id="8286109">IP</span><span class="op" id="8286111">:</span>&nbsp;<span class="ident" id="8286113">IPv4</span><span class="op" id="8286117">(</span><span class="num" id="8286118">224</span><span class="op" id="8286121">,</span>&nbsp;<span class="num" id="8286123">0</span><span class="op" id="8286124">,</span>&nbsp;<span class="num" id="8286126">0</span><span class="op" id="8286127">,</span>&nbsp;<span class="num" id="8286129">254</span><span class="op" id="8286132">)</span><span class="op" id="8286133">,</span>&nbsp;<span class="ident" id="8286135">Port</span><span class="op" id="8286139">:</span>&nbsp;<span class="num" id="8286141">12345</span><span class="op" id="8286146">}</span><span class="op" id="8286147">}</span><span class="op" id="8286148">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8286152">{</span><span class="string" id="8286153">&#34;udp4&#34;</span><span class="op" id="8286159">,</span>&nbsp;<span class="op" id="8286161">&amp;</span><span class="ident" id="8286162">UDPAddr</span><span class="op" id="8286169">{</span><span class="ident" id="8286170">IP</span><span class="op" id="8286172">:</span>&nbsp;<span class="ident" id="8286174">IPv4</span><span class="op" id="8286178">(</span><span class="num" id="8286179">224</span><span class="op" id="8286182">,</span>&nbsp;<span class="num" id="8286184">0</span><span class="op" id="8286185">,</span>&nbsp;<span class="num" id="8286187">0</span><span class="op" id="8286188">,</span>&nbsp;<span class="num" id="8286190">254</span><span class="op" id="8286193">)</span><span class="op" id="8286194">,</span>&nbsp;<span class="ident" id="8286196">Port</span><span class="op" id="8286200">:</span>&nbsp;<span class="num" id="8286202">12345</span><span class="op" id="8286207">}</span><span class="op" id="8286208">}</span><span class="op" id="8286209">,</span><br>
<span class="lineno"></span><span class="op" id="8286211">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8286214">//&nbsp;TestIPv4MulticastListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="8286284">//&nbsp;test&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;group&nbsp;address&nbsp;and&nbsp;same</span><br>
<span class="lineno">25</span><span class="comment" id="8286355">//&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="8286364">func</span>&nbsp;<span class="ident" id="8286369">TestIPv4MulticastListener</span><span class="op" id="8286394">(</span><span class="ident" id="8286395">t</span>&nbsp;<span class="op" id="8286397">*</span><span class="ident" id="8286398">testing</span><span class="op" id="8286405">.</span><span class="ident" id="8286406">T</span><span class="op" id="8286407">)</span>&nbsp;<span class="op" id="8286409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8286412">switch</span>&nbsp;<span class="ident" id="8286419">runtime</span><span class="op" id="8286426">.</span><span class="ident" id="8286427">GOOS</span>&nbsp;<span class="op" id="8286432">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8286435">case</span>&nbsp;<span class="string" id="8286440">&#34;android&#34;</span><span class="op" id="8286449">,</span>&nbsp;<span class="string" id="8286451">&#34;nacl&#34;</span><span class="op" id="8286457">,</span>&nbsp;<span class="string" id="8286459">&#34;plan9&#34;</span><span class="op" id="8286466">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8286470">t</span><span class="op" id="8286471">.</span><span class="ident" id="8286472">Skipf</span><span class="op" id="8286477">(</span><span class="string" id="8286478">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8286499">,</span>&nbsp;<span class="ident" id="8286501">runtime</span><span class="op" id="8286508">.</span><span class="ident" id="8286509">GOOS</span><span class="op" id="8286513">)</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8286516">case</span>&nbsp;<span class="string" id="8286521">&#34;solaris&#34;</span><span class="op" id="8286530">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8286534">t</span><span class="op" id="8286535">.</span><span class="ident" id="8286536">Skipf</span><span class="op" id="8286541">(</span><span class="string" id="8286542">&#34;skipping&nbsp;test&nbsp;on&nbsp;solaris,&nbsp;see&nbsp;issue&nbsp;7399&#34;</span><span class="op" id="8286584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8286587">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8286591">closer</span>&nbsp;<span class="op" id="8286598">:=</span>&nbsp;<span class="keyword" id="8286601">func</span><span class="op" id="8286605">(</span><span class="ident" id="8286606">cs</span>&nbsp;<span class="op" id="8286609">[</span><span class="op" id="8286610">]</span><span class="op" id="8286611">*</span><span class="ident" id="8286612">UDPConn</span><span class="op" id="8286619">)</span>&nbsp;<span class="op" id="8286621">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8286625">for</span>&nbsp;<span class="ident" id="8286629">_</span><span class="op" id="8286630">,</span>&nbsp;<span class="ident" id="8286632">c</span>&nbsp;<span class="op" id="8286634">:=</span>&nbsp;<span class="keyword" id="8286637">range</span>&nbsp;<span class="ident" id="8286643">cs</span>&nbsp;<span class="op" id="8286646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8286651">if</span>&nbsp;<span class="ident" id="8286654">c</span>&nbsp;<span class="op" id="8286656">!=</span>&nbsp;<span class="ident" id="8286659">nil</span>&nbsp;<span class="op" id="8286663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8286669">c</span><span class="op" id="8286670">.</span><span class="ident" id="8286671">Close</span><span class="op" id="8286676">(</span><span class="op" id="8286677">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8286682">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8286686">}</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8286689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8286693">for</span>&nbsp;<span class="ident" id="8286697">_</span><span class="op" id="8286698">,</span>&nbsp;<span class="ident" id="8286700">ifi</span>&nbsp;<span class="op" id="8286704">:=</span>&nbsp;<span class="keyword" id="8286707">range</span>&nbsp;<span class="op" id="8286713">[</span><span class="op" id="8286714">]</span><span class="op" id="8286715">*</span><span class="ident" id="8286716">Interface</span><span class="op" id="8286725">{</span><span class="ident" id="8286726">loopbackInterface</span><span class="op" id="8286743">(</span><span class="op" id="8286744">)</span><span class="op" id="8286745">,</span>&nbsp;<span class="ident" id="8286747">nil</span><span class="op" id="8286750">}</span>&nbsp;<span class="op" id="8286752">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8286756">//&nbsp;Note&nbsp;that&nbsp;multicast&nbsp;interface&nbsp;assignment&nbsp;by&nbsp;system</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8286812">//&nbsp;is&nbsp;not&nbsp;recommended&nbsp;because&nbsp;it&nbsp;usually&nbsp;relies&nbsp;on</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8286865">//&nbsp;routing&nbsp;stuff&nbsp;for&nbsp;finding&nbsp;out&nbsp;an&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8286915">//&nbsp;nexthop&nbsp;containing&nbsp;both&nbsp;network&nbsp;and&nbsp;link&nbsp;layer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8286967">//&nbsp;adjacencies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8286985">if</span>&nbsp;<span class="ident" id="8286988">ifi</span>&nbsp;<span class="op" id="8286992">==</span>&nbsp;<span class="ident" id="8286995">nil</span>&nbsp;<span class="op" id="8286999">&amp;&amp;</span>&nbsp;<span class="op" id="8287002">!</span><span class="op" id="8287003">*</span><span class="ident" id="8287004">testExternal</span>&nbsp;<span class="op" id="8287017">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8287022">continue</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8287033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8287037">for</span>&nbsp;<span class="ident" id="8287041">_</span><span class="op" id="8287042">,</span>&nbsp;<span class="ident" id="8287044">tt</span>&nbsp;<span class="op" id="8287047">:=</span>&nbsp;<span class="keyword" id="8287050">range</span>&nbsp;<span class="ident" id="8287056">ipv4MulticastListenerTests</span>&nbsp;<span class="op" id="8287083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8287088">var</span>&nbsp;<span class="ident" id="8287092">err</span>&nbsp;<span class="builtintype" id="8287096">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8287105">cs</span>&nbsp;<span class="op" id="8287108">:=</span>&nbsp;<span class="builtinfunc" id="8287111">make</span><span class="op" id="8287115">(</span><span class="op" id="8287116">[</span><span class="op" id="8287117">]</span><span class="op" id="8287118">*</span><span class="ident" id="8287119">UDPConn</span><span class="op" id="8287126">,</span>&nbsp;<span class="num" id="8287128">2</span><span class="op" id="8287129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8287134">if</span>&nbsp;<span class="ident" id="8287137">cs</span><span class="op" id="8287139">[</span><span class="num" id="8287140">0</span><span class="op" id="8287141">]</span><span class="op" id="8287142">,</span>&nbsp;<span class="ident" id="8287144">err</span>&nbsp;<span class="op" id="8287148">=</span>&nbsp;<span class="ident" id="8287150">ListenMulticastUDP</span><span class="op" id="8287168">(</span><span class="ident" id="8287169">tt</span><span class="op" id="8287171">.</span><span class="ident" id="8287172">net</span><span class="op" id="8287175">,</span>&nbsp;<span class="ident" id="8287177">ifi</span><span class="op" id="8287180">,</span>&nbsp;<span class="ident" id="8287182">tt</span><span class="op" id="8287184">.</span><span class="ident" id="8287185">gaddr</span><span class="op" id="8287190">)</span><span class="op" id="8287191">;</span>&nbsp;<span class="ident" id="8287193">err</span>&nbsp;<span class="op" id="8287197">!=</span>&nbsp;<span class="ident" id="8287200">nil</span>&nbsp;<span class="op" id="8287204">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8287210">t</span><span class="op" id="8287211">.</span><span class="ident" id="8287212">Fatalf</span><span class="op" id="8287218">(</span><span class="string" id="8287219">&#34;First&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8287262">,</span>&nbsp;<span class="ident" id="8287264">ifi</span><span class="op" id="8287267">,</span>&nbsp;<span class="ident" id="8287269">err</span><span class="op" id="8287272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8287277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8287282">if</span>&nbsp;<span class="ident" id="8287285">err</span>&nbsp;<span class="op" id="8287289">:=</span>&nbsp;<span class="ident" id="8287292">checkMulticastListener</span><span class="op" id="8287314">(</span><span class="ident" id="8287315">cs</span><span class="op" id="8287317">[</span><span class="num" id="8287318">0</span><span class="op" id="8287319">]</span><span class="op" id="8287320">,</span>&nbsp;<span class="ident" id="8287322">tt</span><span class="op" id="8287324">.</span><span class="ident" id="8287325">gaddr</span><span class="op" id="8287330">.</span><span class="ident" id="8287331">IP</span><span class="op" id="8287333">)</span><span class="op" id="8287334">;</span>&nbsp;<span class="ident" id="8287336">err</span>&nbsp;<span class="op" id="8287340">!=</span>&nbsp;<span class="ident" id="8287343">nil</span>&nbsp;<span class="op" id="8287347">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8287353">closer</span><span class="op" id="8287359">(</span><span class="ident" id="8287360">cs</span><span class="op" id="8287362">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8287368">t</span><span class="op" id="8287369">.</span><span class="ident" id="8287370">Fatal</span><span class="op" id="8287375">(</span><span class="ident" id="8287376">err</span><span class="op" id="8287379">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8287384">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8287389">if</span>&nbsp;<span class="ident" id="8287392">cs</span><span class="op" id="8287394">[</span><span class="num" id="8287395">1</span><span class="op" id="8287396">]</span><span class="op" id="8287397">,</span>&nbsp;<span class="ident" id="8287399">err</span>&nbsp;<span class="op" id="8287403">=</span>&nbsp;<span class="ident" id="8287405">ListenMulticastUDP</span><span class="op" id="8287423">(</span><span class="ident" id="8287424">tt</span><span class="op" id="8287426">.</span><span class="ident" id="8287427">net</span><span class="op" id="8287430">,</span>&nbsp;<span class="ident" id="8287432">ifi</span><span class="op" id="8287435">,</span>&nbsp;<span class="ident" id="8287437">tt</span><span class="op" id="8287439">.</span><span class="ident" id="8287440">gaddr</span><span class="op" id="8287445">)</span><span class="op" id="8287446">;</span>&nbsp;<span class="ident" id="8287448">err</span>&nbsp;<span class="op" id="8287452">!=</span>&nbsp;<span class="ident" id="8287455">nil</span>&nbsp;<span class="op" id="8287459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8287465">closer</span><span class="op" id="8287471">(</span><span class="ident" id="8287472">cs</span><span class="op" id="8287474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8287480">t</span><span class="op" id="8287481">.</span><span class="ident" id="8287482">Fatalf</span><span class="op" id="8287488">(</span><span class="string" id="8287489">&#34;Second&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8287533">,</span>&nbsp;<span class="ident" id="8287535">ifi</span><span class="op" id="8287538">,</span>&nbsp;<span class="ident" id="8287540">err</span><span class="op" id="8287543">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8287548">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8287553">if</span>&nbsp;<span class="ident" id="8287556">err</span>&nbsp;<span class="op" id="8287560">:=</span>&nbsp;<span class="ident" id="8287563">checkMulticastListener</span><span class="op" id="8287585">(</span><span class="ident" id="8287586">cs</span><span class="op" id="8287588">[</span><span class="num" id="8287589">1</span><span class="op" id="8287590">]</span><span class="op" id="8287591">,</span>&nbsp;<span class="ident" id="8287593">tt</span><span class="op" id="8287595">.</span><span class="ident" id="8287596">gaddr</span><span class="op" id="8287601">.</span><span class="ident" id="8287602">IP</span><span class="op" id="8287604">)</span><span class="op" id="8287605">;</span>&nbsp;<span class="ident" id="8287607">err</span>&nbsp;<span class="op" id="8287611">!=</span>&nbsp;<span class="ident" id="8287614">nil</span>&nbsp;<span class="op" id="8287618">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8287624">closer</span><span class="op" id="8287630">(</span><span class="ident" id="8287631">cs</span><span class="op" id="8287633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8287639">t</span><span class="op" id="8287640">.</span><span class="ident" id="8287641">Fatal</span><span class="op" id="8287646">(</span><span class="ident" id="8287647">err</span><span class="op" id="8287650">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8287655">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8287660">closer</span><span class="op" id="8287666">(</span><span class="ident" id="8287667">cs</span><span class="op" id="8287669">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8287673">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8287676">}</span><br>
<span class="lineno"></span><span class="op" id="8287678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8287681">var</span>&nbsp;<span class="ident" id="8287685">ipv6MulticastListenerTests</span>&nbsp;<span class="op" id="8287712">=</span>&nbsp;<span class="op" id="8287714">[</span><span class="op" id="8287715">]</span><span class="keyword" id="8287716">struct</span>&nbsp;<span class="op" id="8287723">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8287726">net</span>&nbsp;&nbsp;&nbsp;<span class="builtintype" id="8287732">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8287740">gaddr</span>&nbsp;<span class="op" id="8287746">*</span><span class="ident" id="8287747">UDPAddr</span>&nbsp;<span class="comment" id="8287755">//&nbsp;see&nbsp;RFC&nbsp;4727</span><br>
<span class="lineno"></span><span class="op" id="8287771">}</span><span class="op" id="8287772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8287775">{</span><span class="string" id="8287776">&#34;udp&#34;</span><span class="op" id="8287781">,</span>&nbsp;<span class="op" id="8287783">&amp;</span><span class="ident" id="8287784">UDPAddr</span><span class="op" id="8287791">{</span><span class="ident" id="8287792">IP</span><span class="op" id="8287794">:</span>&nbsp;<span class="ident" id="8287796">ParseIP</span><span class="op" id="8287803">(</span><span class="string" id="8287804">&#34;ff01::114&#34;</span><span class="op" id="8287815">)</span><span class="op" id="8287816">,</span>&nbsp;<span class="ident" id="8287818">Port</span><span class="op" id="8287822">:</span>&nbsp;<span class="num" id="8287824">12345</span><span class="op" id="8287829">}</span><span class="op" id="8287830">}</span><span class="op" id="8287831">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8287834">{</span><span class="string" id="8287835">&#34;udp&#34;</span><span class="op" id="8287840">,</span>&nbsp;<span class="op" id="8287842">&amp;</span><span class="ident" id="8287843">UDPAddr</span><span class="op" id="8287850">{</span><span class="ident" id="8287851">IP</span><span class="op" id="8287853">:</span>&nbsp;<span class="ident" id="8287855">ParseIP</span><span class="op" id="8287862">(</span><span class="string" id="8287863">&#34;ff02::114&#34;</span><span class="op" id="8287874">)</span><span class="op" id="8287875">,</span>&nbsp;<span class="ident" id="8287877">Port</span><span class="op" id="8287881">:</span>&nbsp;<span class="num" id="8287883">12345</span><span class="op" id="8287888">}</span><span class="op" id="8287889">}</span><span class="op" id="8287890">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8287893">{</span><span class="string" id="8287894">&#34;udp&#34;</span><span class="op" id="8287899">,</span>&nbsp;<span class="op" id="8287901">&amp;</span><span class="ident" id="8287902">UDPAddr</span><span class="op" id="8287909">{</span><span class="ident" id="8287910">IP</span><span class="op" id="8287912">:</span>&nbsp;<span class="ident" id="8287914">ParseIP</span><span class="op" id="8287921">(</span><span class="string" id="8287922">&#34;ff04::114&#34;</span><span class="op" id="8287933">)</span><span class="op" id="8287934">,</span>&nbsp;<span class="ident" id="8287936">Port</span><span class="op" id="8287940">:</span>&nbsp;<span class="num" id="8287942">12345</span><span class="op" id="8287947">}</span><span class="op" id="8287948">}</span><span class="op" id="8287949">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8287952">{</span><span class="string" id="8287953">&#34;udp&#34;</span><span class="op" id="8287958">,</span>&nbsp;<span class="op" id="8287960">&amp;</span><span class="ident" id="8287961">UDPAddr</span><span class="op" id="8287968">{</span><span class="ident" id="8287969">IP</span><span class="op" id="8287971">:</span>&nbsp;<span class="ident" id="8287973">ParseIP</span><span class="op" id="8287980">(</span><span class="string" id="8287981">&#34;ff05::114&#34;</span><span class="op" id="8287992">)</span><span class="op" id="8287993">,</span>&nbsp;<span class="ident" id="8287995">Port</span><span class="op" id="8287999">:</span>&nbsp;<span class="num" id="8288001">12345</span><span class="op" id="8288006">}</span><span class="op" id="8288007">}</span><span class="op" id="8288008">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288011">{</span><span class="string" id="8288012">&#34;udp&#34;</span><span class="op" id="8288017">,</span>&nbsp;<span class="op" id="8288019">&amp;</span><span class="ident" id="8288020">UDPAddr</span><span class="op" id="8288027">{</span><span class="ident" id="8288028">IP</span><span class="op" id="8288030">:</span>&nbsp;<span class="ident" id="8288032">ParseIP</span><span class="op" id="8288039">(</span><span class="string" id="8288040">&#34;ff08::114&#34;</span><span class="op" id="8288051">)</span><span class="op" id="8288052">,</span>&nbsp;<span class="ident" id="8288054">Port</span><span class="op" id="8288058">:</span>&nbsp;<span class="num" id="8288060">12345</span><span class="op" id="8288065">}</span><span class="op" id="8288066">}</span><span class="op" id="8288067">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288070">{</span><span class="string" id="8288071">&#34;udp&#34;</span><span class="op" id="8288076">,</span>&nbsp;<span class="op" id="8288078">&amp;</span><span class="ident" id="8288079">UDPAddr</span><span class="op" id="8288086">{</span><span class="ident" id="8288087">IP</span><span class="op" id="8288089">:</span>&nbsp;<span class="ident" id="8288091">ParseIP</span><span class="op" id="8288098">(</span><span class="string" id="8288099">&#34;ff0e::114&#34;</span><span class="op" id="8288110">)</span><span class="op" id="8288111">,</span>&nbsp;<span class="ident" id="8288113">Port</span><span class="op" id="8288117">:</span>&nbsp;<span class="num" id="8288119">12345</span><span class="op" id="8288124">}</span><span class="op" id="8288125">}</span><span class="op" id="8288126">,</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288130">{</span><span class="string" id="8288131">&#34;udp6&#34;</span><span class="op" id="8288137">,</span>&nbsp;<span class="op" id="8288139">&amp;</span><span class="ident" id="8288140">UDPAddr</span><span class="op" id="8288147">{</span><span class="ident" id="8288148">IP</span><span class="op" id="8288150">:</span>&nbsp;<span class="ident" id="8288152">ParseIP</span><span class="op" id="8288159">(</span><span class="string" id="8288160">&#34;ff01::114&#34;</span><span class="op" id="8288171">)</span><span class="op" id="8288172">,</span>&nbsp;<span class="ident" id="8288174">Port</span><span class="op" id="8288178">:</span>&nbsp;<span class="num" id="8288180">12345</span><span class="op" id="8288185">}</span><span class="op" id="8288186">}</span><span class="op" id="8288187">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288190">{</span><span class="string" id="8288191">&#34;udp6&#34;</span><span class="op" id="8288197">,</span>&nbsp;<span class="op" id="8288199">&amp;</span><span class="ident" id="8288200">UDPAddr</span><span class="op" id="8288207">{</span><span class="ident" id="8288208">IP</span><span class="op" id="8288210">:</span>&nbsp;<span class="ident" id="8288212">ParseIP</span><span class="op" id="8288219">(</span><span class="string" id="8288220">&#34;ff02::114&#34;</span><span class="op" id="8288231">)</span><span class="op" id="8288232">,</span>&nbsp;<span class="ident" id="8288234">Port</span><span class="op" id="8288238">:</span>&nbsp;<span class="num" id="8288240">12345</span><span class="op" id="8288245">}</span><span class="op" id="8288246">}</span><span class="op" id="8288247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288250">{</span><span class="string" id="8288251">&#34;udp6&#34;</span><span class="op" id="8288257">,</span>&nbsp;<span class="op" id="8288259">&amp;</span><span class="ident" id="8288260">UDPAddr</span><span class="op" id="8288267">{</span><span class="ident" id="8288268">IP</span><span class="op" id="8288270">:</span>&nbsp;<span class="ident" id="8288272">ParseIP</span><span class="op" id="8288279">(</span><span class="string" id="8288280">&#34;ff04::114&#34;</span><span class="op" id="8288291">)</span><span class="op" id="8288292">,</span>&nbsp;<span class="ident" id="8288294">Port</span><span class="op" id="8288298">:</span>&nbsp;<span class="num" id="8288300">12345</span><span class="op" id="8288305">}</span><span class="op" id="8288306">}</span><span class="op" id="8288307">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288310">{</span><span class="string" id="8288311">&#34;udp6&#34;</span><span class="op" id="8288317">,</span>&nbsp;<span class="op" id="8288319">&amp;</span><span class="ident" id="8288320">UDPAddr</span><span class="op" id="8288327">{</span><span class="ident" id="8288328">IP</span><span class="op" id="8288330">:</span>&nbsp;<span class="ident" id="8288332">ParseIP</span><span class="op" id="8288339">(</span><span class="string" id="8288340">&#34;ff05::114&#34;</span><span class="op" id="8288351">)</span><span class="op" id="8288352">,</span>&nbsp;<span class="ident" id="8288354">Port</span><span class="op" id="8288358">:</span>&nbsp;<span class="num" id="8288360">12345</span><span class="op" id="8288365">}</span><span class="op" id="8288366">}</span><span class="op" id="8288367">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288370">{</span><span class="string" id="8288371">&#34;udp6&#34;</span><span class="op" id="8288377">,</span>&nbsp;<span class="op" id="8288379">&amp;</span><span class="ident" id="8288380">UDPAddr</span><span class="op" id="8288387">{</span><span class="ident" id="8288388">IP</span><span class="op" id="8288390">:</span>&nbsp;<span class="ident" id="8288392">ParseIP</span><span class="op" id="8288399">(</span><span class="string" id="8288400">&#34;ff08::114&#34;</span><span class="op" id="8288411">)</span><span class="op" id="8288412">,</span>&nbsp;<span class="ident" id="8288414">Port</span><span class="op" id="8288418">:</span>&nbsp;<span class="num" id="8288420">12345</span><span class="op" id="8288425">}</span><span class="op" id="8288426">}</span><span class="op" id="8288427">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288430">{</span><span class="string" id="8288431">&#34;udp6&#34;</span><span class="op" id="8288437">,</span>&nbsp;<span class="op" id="8288439">&amp;</span><span class="ident" id="8288440">UDPAddr</span><span class="op" id="8288447">{</span><span class="ident" id="8288448">IP</span><span class="op" id="8288450">:</span>&nbsp;<span class="ident" id="8288452">ParseIP</span><span class="op" id="8288459">(</span><span class="string" id="8288460">&#34;ff0e::114&#34;</span><span class="op" id="8288471">)</span><span class="op" id="8288472">,</span>&nbsp;<span class="ident" id="8288474">Port</span><span class="op" id="8288478">:</span>&nbsp;<span class="num" id="8288480">12345</span><span class="op" id="8288485">}</span><span class="op" id="8288486">}</span><span class="op" id="8288487">,</span><br>
<span class="lineno"></span><span class="op" id="8288489">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="8288492">//&nbsp;TestIPv6MulticastListener&nbsp;tests&nbsp;both&nbsp;single&nbsp;and&nbsp;double&nbsp;listen&nbsp;to&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="8288562">//&nbsp;test&nbsp;listener&nbsp;with&nbsp;same&nbsp;address&nbsp;family,&nbsp;same&nbsp;group&nbsp;address&nbsp;and&nbsp;same</span><br>
<span class="lineno">95</span><span class="comment" id="8288633">//&nbsp;port.</span><br>
<span class="lineno"></span><span class="keyword" id="8288642">func</span>&nbsp;<span class="ident" id="8288647">TestIPv6MulticastListener</span><span class="op" id="8288672">(</span><span class="ident" id="8288673">t</span>&nbsp;<span class="op" id="8288675">*</span><span class="ident" id="8288676">testing</span><span class="op" id="8288683">.</span><span class="ident" id="8288684">T</span><span class="op" id="8288685">)</span>&nbsp;<span class="op" id="8288687">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8288690">switch</span>&nbsp;<span class="ident" id="8288697">runtime</span><span class="op" id="8288704">.</span><span class="ident" id="8288705">GOOS</span>&nbsp;<span class="op" id="8288710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8288713">case</span>&nbsp;<span class="string" id="8288718">&#34;plan9&#34;</span><span class="op" id="8288725">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288729">t</span><span class="op" id="8288730">.</span><span class="ident" id="8288731">Skipf</span><span class="op" id="8288736">(</span><span class="string" id="8288737">&#34;skipping&nbsp;test&nbsp;on&nbsp;%q&#34;</span><span class="op" id="8288758">,</span>&nbsp;<span class="ident" id="8288760">runtime</span><span class="op" id="8288767">.</span><span class="ident" id="8288768">GOOS</span><span class="op" id="8288772">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8288775">case</span>&nbsp;<span class="string" id="8288780">&#34;solaris&#34;</span><span class="op" id="8288789">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288793">t</span><span class="op" id="8288794">.</span><span class="ident" id="8288795">Skipf</span><span class="op" id="8288800">(</span><span class="string" id="8288801">&#34;skipping&nbsp;test&nbsp;on&nbsp;solaris,&nbsp;see&nbsp;issue&nbsp;7399&#34;</span><span class="op" id="8288843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288846">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8288849">if</span>&nbsp;<span class="op" id="8288852">!</span><span class="ident" id="8288853">supportsIPv6</span>&nbsp;<span class="op" id="8288866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288870">t</span><span class="op" id="8288871">.</span><span class="ident" id="8288872">Skip</span><span class="op" id="8288876">(</span><span class="string" id="8288877">&#34;ipv6&nbsp;is&nbsp;not&nbsp;supported&#34;</span><span class="op" id="8288900">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288903">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8288906">if</span>&nbsp;<span class="ident" id="8288909">os</span><span class="op" id="8288911">.</span><span class="ident" id="8288912">Getuid</span><span class="op" id="8288918">(</span><span class="op" id="8288919">)</span>&nbsp;<span class="op" id="8288921">!=</span>&nbsp;<span class="num" id="8288924">0</span>&nbsp;<span class="op" id="8288926">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288930">t</span><span class="op" id="8288931">.</span><span class="ident" id="8288932">Skip</span><span class="op" id="8288936">(</span><span class="string" id="8288937">&#34;skipping&nbsp;test;&nbsp;must&nbsp;be&nbsp;root&#34;</span><span class="op" id="8288966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8288969">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8288973">closer</span>&nbsp;<span class="op" id="8288980">:=</span>&nbsp;<span class="keyword" id="8288983">func</span><span class="op" id="8288987">(</span><span class="ident" id="8288988">cs</span>&nbsp;<span class="op" id="8288991">[</span><span class="op" id="8288992">]</span><span class="op" id="8288993">*</span><span class="ident" id="8288994">UDPConn</span><span class="op" id="8289001">)</span>&nbsp;<span class="op" id="8289003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8289007">for</span>&nbsp;<span class="ident" id="8289011">_</span><span class="op" id="8289012">,</span>&nbsp;<span class="ident" id="8289014">c</span>&nbsp;<span class="op" id="8289016">:=</span>&nbsp;<span class="keyword" id="8289019">range</span>&nbsp;<span class="ident" id="8289025">cs</span>&nbsp;<span class="op" id="8289028">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8289033">if</span>&nbsp;<span class="ident" id="8289036">c</span>&nbsp;<span class="op" id="8289038">!=</span>&nbsp;<span class="ident" id="8289041">nil</span>&nbsp;<span class="op" id="8289045">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289051">c</span><span class="op" id="8289052">.</span><span class="ident" id="8289053">Close</span><span class="op" id="8289058">(</span><span class="op" id="8289059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8289064">}</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8289068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8289071">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8289075">for</span>&nbsp;<span class="ident" id="8289079">_</span><span class="op" id="8289080">,</span>&nbsp;<span class="ident" id="8289082">ifi</span>&nbsp;<span class="op" id="8289086">:=</span>&nbsp;<span class="keyword" id="8289089">range</span>&nbsp;<span class="op" id="8289095">[</span><span class="op" id="8289096">]</span><span class="op" id="8289097">*</span><span class="ident" id="8289098">Interface</span><span class="op" id="8289107">{</span><span class="ident" id="8289108">loopbackInterface</span><span class="op" id="8289125">(</span><span class="op" id="8289126">)</span><span class="op" id="8289127">,</span>&nbsp;<span class="ident" id="8289129">nil</span><span class="op" id="8289132">}</span>&nbsp;<span class="op" id="8289134">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8289138">//&nbsp;Note&nbsp;that&nbsp;multicast&nbsp;interface&nbsp;assignment&nbsp;by&nbsp;system</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8289194">//&nbsp;is&nbsp;not&nbsp;recommended&nbsp;because&nbsp;it&nbsp;usually&nbsp;relies&nbsp;on</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8289247">//&nbsp;routing&nbsp;stuff&nbsp;for&nbsp;finding&nbsp;out&nbsp;an&nbsp;appropriate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8289297">//&nbsp;nexthop&nbsp;containing&nbsp;both&nbsp;network&nbsp;and&nbsp;link&nbsp;layer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="8289349">//&nbsp;adjacencies.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8289367">if</span>&nbsp;<span class="ident" id="8289370">ifi</span>&nbsp;<span class="op" id="8289374">==</span>&nbsp;<span class="ident" id="8289377">nil</span>&nbsp;<span class="op" id="8289381">&amp;&amp;</span>&nbsp;<span class="op" id="8289384">(</span><span class="op" id="8289385">!</span><span class="op" id="8289386">*</span><span class="ident" id="8289387">testExternal</span>&nbsp;<span class="op" id="8289400">||</span>&nbsp;<span class="op" id="8289403">!</span><span class="op" id="8289404">*</span><span class="ident" id="8289405">testIPv6</span><span class="op" id="8289413">)</span>&nbsp;<span class="op" id="8289415">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8289420">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8289431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8289435">for</span>&nbsp;<span class="ident" id="8289439">_</span><span class="op" id="8289440">,</span>&nbsp;<span class="ident" id="8289442">tt</span>&nbsp;<span class="op" id="8289445">:=</span>&nbsp;<span class="keyword" id="8289448">range</span>&nbsp;<span class="ident" id="8289454">ipv6MulticastListenerTests</span>&nbsp;<span class="op" id="8289481">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8289486">var</span>&nbsp;<span class="ident" id="8289490">err</span>&nbsp;<span class="builtintype" id="8289494">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289503">cs</span>&nbsp;<span class="op" id="8289506">:=</span>&nbsp;<span class="builtinfunc" id="8289509">make</span><span class="op" id="8289513">(</span><span class="op" id="8289514">[</span><span class="op" id="8289515">]</span><span class="op" id="8289516">*</span><span class="ident" id="8289517">UDPConn</span><span class="op" id="8289524">,</span>&nbsp;<span class="num" id="8289526">2</span><span class="op" id="8289527">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8289532">if</span>&nbsp;<span class="ident" id="8289535">cs</span><span class="op" id="8289537">[</span><span class="num" id="8289538">0</span><span class="op" id="8289539">]</span><span class="op" id="8289540">,</span>&nbsp;<span class="ident" id="8289542">err</span>&nbsp;<span class="op" id="8289546">=</span>&nbsp;<span class="ident" id="8289548">ListenMulticastUDP</span><span class="op" id="8289566">(</span><span class="ident" id="8289567">tt</span><span class="op" id="8289569">.</span><span class="ident" id="8289570">net</span><span class="op" id="8289573">,</span>&nbsp;<span class="ident" id="8289575">ifi</span><span class="op" id="8289578">,</span>&nbsp;<span class="ident" id="8289580">tt</span><span class="op" id="8289582">.</span><span class="ident" id="8289583">gaddr</span><span class="op" id="8289588">)</span><span class="op" id="8289589">;</span>&nbsp;<span class="ident" id="8289591">err</span>&nbsp;<span class="op" id="8289595">!=</span>&nbsp;<span class="ident" id="8289598">nil</span>&nbsp;<span class="op" id="8289602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289608">t</span><span class="op" id="8289609">.</span><span class="ident" id="8289610">Fatalf</span><span class="op" id="8289616">(</span><span class="string" id="8289617">&#34;First&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8289660">,</span>&nbsp;<span class="ident" id="8289662">ifi</span><span class="op" id="8289665">,</span>&nbsp;<span class="ident" id="8289667">err</span><span class="op" id="8289670">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8289675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8289680">if</span>&nbsp;<span class="ident" id="8289683">err</span>&nbsp;<span class="op" id="8289687">:=</span>&nbsp;<span class="ident" id="8289690">checkMulticastListener</span><span class="op" id="8289712">(</span><span class="ident" id="8289713">cs</span><span class="op" id="8289715">[</span><span class="num" id="8289716">0</span><span class="op" id="8289717">]</span><span class="op" id="8289718">,</span>&nbsp;<span class="ident" id="8289720">tt</span><span class="op" id="8289722">.</span><span class="ident" id="8289723">gaddr</span><span class="op" id="8289728">.</span><span class="ident" id="8289729">IP</span><span class="op" id="8289731">)</span><span class="op" id="8289732">;</span>&nbsp;<span class="ident" id="8289734">err</span>&nbsp;<span class="op" id="8289738">!=</span>&nbsp;<span class="ident" id="8289741">nil</span>&nbsp;<span class="op" id="8289745">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289751">closer</span><span class="op" id="8289757">(</span><span class="ident" id="8289758">cs</span><span class="op" id="8289760">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289766">t</span><span class="op" id="8289767">.</span><span class="ident" id="8289768">Fatal</span><span class="op" id="8289773">(</span><span class="ident" id="8289774">err</span><span class="op" id="8289777">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8289782">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8289787">if</span>&nbsp;<span class="ident" id="8289790">cs</span><span class="op" id="8289792">[</span><span class="num" id="8289793">1</span><span class="op" id="8289794">]</span><span class="op" id="8289795">,</span>&nbsp;<span class="ident" id="8289797">err</span>&nbsp;<span class="op" id="8289801">=</span>&nbsp;<span class="ident" id="8289803">ListenMulticastUDP</span><span class="op" id="8289821">(</span><span class="ident" id="8289822">tt</span><span class="op" id="8289824">.</span><span class="ident" id="8289825">net</span><span class="op" id="8289828">,</span>&nbsp;<span class="ident" id="8289830">ifi</span><span class="op" id="8289833">,</span>&nbsp;<span class="ident" id="8289835">tt</span><span class="op" id="8289837">.</span><span class="ident" id="8289838">gaddr</span><span class="op" id="8289843">)</span><span class="op" id="8289844">;</span>&nbsp;<span class="ident" id="8289846">err</span>&nbsp;<span class="op" id="8289850">!=</span>&nbsp;<span class="ident" id="8289853">nil</span>&nbsp;<span class="op" id="8289857">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289863">closer</span><span class="op" id="8289869">(</span><span class="ident" id="8289870">cs</span><span class="op" id="8289872">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8289878">t</span><span class="op" id="8289879">.</span><span class="ident" id="8289880">Fatalf</span><span class="op" id="8289886">(</span><span class="string" id="8289887">&#34;Second&nbsp;ListenMulticastUDP&nbsp;on&nbsp;%v&nbsp;failed:&nbsp;%v&#34;</span><span class="op" id="8289931">,</span>&nbsp;<span class="ident" id="8289933">ifi</span><span class="op" id="8289936">,</span>&nbsp;<span class="ident" id="8289938">err</span><span class="op" id="8289941">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8289946">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8289951">if</span>&nbsp;<span class="ident" id="8289954">err</span>&nbsp;<span class="op" id="8289958">:=</span>&nbsp;<span class="ident" id="8289961">checkMulticastListener</span><span class="op" id="8289983">(</span><span class="ident" id="8289984">cs</span><span class="op" id="8289986">[</span><span class="num" id="8289987">1</span><span class="op" id="8289988">]</span><span class="op" id="8289989">,</span>&nbsp;<span class="ident" id="8289991">tt</span><span class="op" id="8289993">.</span><span class="ident" id="8289994">gaddr</span><span class="op" id="8289999">.</span><span class="ident" id="8290000">IP</span><span class="op" id="8290002">)</span><span class="op" id="8290003">;</span>&nbsp;<span class="ident" id="8290005">err</span>&nbsp;<span class="op" id="8290009">!=</span>&nbsp;<span class="ident" id="8290012">nil</span>&nbsp;<span class="op" id="8290016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8290022">closer</span><span class="op" id="8290028">(</span><span class="ident" id="8290029">cs</span><span class="op" id="8290031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8290037">t</span><span class="op" id="8290038">.</span><span class="ident" id="8290039">Fatal</span><span class="op" id="8290044">(</span><span class="ident" id="8290045">err</span><span class="op" id="8290048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8290053">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8290058">closer</span><span class="op" id="8290064">(</span><span class="ident" id="8290065">cs</span><span class="op" id="8290067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8290071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8290074">}</span><br>
<span class="lineno"></span><span class="op" id="8290076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">150</span><span class="keyword" id="8290079">func</span>&nbsp;<span class="ident" id="8290084">checkMulticastListener</span><span class="op" id="8290106">(</span><span class="ident" id="8290107">c</span>&nbsp;<span class="op" id="8290109">*</span><span class="ident" id="8290110">UDPConn</span><span class="op" id="8290117">,</span>&nbsp;<span class="ident" id="8290119">ip</span>&nbsp;<span class="ident" id="8290122">IP</span><span class="op" id="8290124">)</span>&nbsp;<span class="builtintype" id="8290126">error</span>&nbsp;<span class="op" id="8290132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8290135">if</span>&nbsp;<span class="ident" id="8290138">ok</span><span class="op" id="8290140">,</span>&nbsp;<span class="ident" id="8290142">err</span>&nbsp;<span class="op" id="8290146">:=</span>&nbsp;<span class="ident" id="8290149">multicastRIBContains</span><span class="op" id="8290169">(</span><span class="ident" id="8290170">ip</span><span class="op" id="8290172">)</span><span class="op" id="8290173">;</span>&nbsp;<span class="ident" id="8290175">err</span>&nbsp;<span class="op" id="8290179">!=</span>&nbsp;<span class="ident" id="8290182">nil</span>&nbsp;<span class="op" id="8290186">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8290190">return</span>&nbsp;<span class="ident" id="8290197">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8290202">}</span>&nbsp;<span class="keyword" id="8290204">else</span>&nbsp;<span class="keyword" id="8290209">if</span>&nbsp;<span class="op" id="8290212">!</span><span class="ident" id="8290213">ok</span>&nbsp;<span class="op" id="8290216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8290220">return</span>&nbsp;<span class="ident" id="8290227">fmt</span><span class="op" id="8290230">.</span><span class="ident" id="8290231">Errorf</span><span class="op" id="8290237">(</span><span class="string" id="8290238">&#34;%q&nbsp;not&nbsp;found&nbsp;in&nbsp;multicast&nbsp;RIB&#34;</span><span class="op" id="8290269">,</span>&nbsp;<span class="ident" id="8290271">ip</span><span class="op" id="8290273">.</span><span class="ident" id="8290274">String</span><span class="op" id="8290280">(</span><span class="op" id="8290281">)</span><span class="op" id="8290282">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8290285">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8290288">la</span>&nbsp;<span class="op" id="8290291">:=</span>&nbsp;<span class="ident" id="8290294">c</span><span class="op" id="8290295">.</span><span class="ident" id="8290296">LocalAddr</span><span class="op" id="8290305">(</span><span class="op" id="8290306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8290309">if</span>&nbsp;<span class="ident" id="8290312">la</span><span class="op" id="8290314">,</span>&nbsp;<span class="ident" id="8290316">ok</span>&nbsp;<span class="op" id="8290319">:=</span>&nbsp;<span class="ident" id="8290322">la</span><span class="op" id="8290324">.</span><span class="op" id="8290325">(</span><span class="op" id="8290326">*</span><span class="ident" id="8290327">UDPAddr</span><span class="op" id="8290334">)</span><span class="op" id="8290335">;</span>&nbsp;<span class="op" id="8290337">!</span><span class="ident" id="8290338">ok</span>&nbsp;<span class="op" id="8290341">||</span>&nbsp;<span class="ident" id="8290344">la</span><span class="op" id="8290346">.</span><span class="ident" id="8290347">Port</span>&nbsp;<span class="op" id="8290352">==</span>&nbsp;<span class="num" id="8290355">0</span>&nbsp;<span class="op" id="8290357">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8290361">return</span>&nbsp;<span class="ident" id="8290368">fmt</span><span class="op" id="8290371">.</span><span class="ident" id="8290372">Errorf</span><span class="op" id="8290378">(</span><span class="string" id="8290379">&#34;got&nbsp;%v;&nbsp;expected&nbsp;a&nbsp;proper&nbsp;address&nbsp;with&nbsp;non-zero&nbsp;port&nbsp;number&#34;</span><span class="op" id="8290440">,</span>&nbsp;<span class="ident" id="8290442">la</span><span class="op" id="8290444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8290447">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8290450">return</span>&nbsp;<span class="ident" id="8290457">nil</span><br>
<span class="lineno"></span><span class="op" id="8290461">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8290464">func</span>&nbsp;<span class="ident" id="8290469">multicastRIBContains</span><span class="op" id="8290489">(</span><span class="ident" id="8290490">ip</span>&nbsp;<span class="ident" id="8290493">IP</span><span class="op" id="8290495">)</span>&nbsp;<span class="op" id="8290497">(</span><span class="builtintype" id="8290498">bool</span><span class="op" id="8290502">,</span>&nbsp;<span class="builtintype" id="8290504">error</span><span class="op" id="8290509">)</span>&nbsp;<span class="op" id="8290511">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8290514">switch</span>&nbsp;<span class="ident" id="8290521">runtime</span><span class="op" id="8290528">.</span><span class="ident" id="8290529">GOOS</span>&nbsp;<span class="op" id="8290534">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8290537">case</span>&nbsp;<span class="string" id="8290542">&#34;dragonfly&#34;</span><span class="op" id="8290553">,</span>&nbsp;<span class="string" id="8290555">&#34;netbsd&#34;</span><span class="op" id="8290563">,</span>&nbsp;<span class="string" id="8290565">&#34;openbsd&#34;</span><span class="op" id="8290574">,</span>&nbsp;<span class="string" id="8290576">&#34;plan9&#34;</span><span class="op" id="8290583">,</span>&nbsp;<span class="string" id="8290585">&#34;solaris&#34;</span><span class="op" id="8290594">,</span>&nbsp;<span class="string" id="8290596">&#34;windows&#34;</span><span class="op" id="8290605">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8290609">return</span>&nbsp;<span class="builtintype" id="8290616">true</span><span class="op" id="8290620">,</span>&nbsp;<span class="ident" id="8290622">nil</span>&nbsp;<span class="comment" id="8290626">//&nbsp;not&nbsp;implemented&nbsp;yet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8290650">case</span>&nbsp;<span class="string" id="8290655">&#34;linux&#34;</span><span class="op" id="8290662">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8290666">if</span>&nbsp;<span class="ident" id="8290669">runtime</span><span class="op" id="8290676">.</span><span class="ident" id="8290677">GOARCH</span>&nbsp;<span class="op" id="8290684">==</span>&nbsp;<span class="string" id="8290687">&#34;arm&#34;</span>&nbsp;<span class="op" id="8290693">||</span>&nbsp;<span class="ident" id="8290696">runtime</span><span class="op" id="8290703">.</span><span class="ident" id="8290704">GOARCH</span>&nbsp;<span class="op" id="8290711">==</span>&nbsp;<span class="string" id="8290714">&#34;alpha&#34;</span>&nbsp;<span class="op" id="8290722">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8290727">return</span>&nbsp;<span class="builtintype" id="8290734">true</span><span class="op" id="8290738">,</span>&nbsp;<span class="ident" id="8290740">nil</span>&nbsp;<span class="comment" id="8290744">//&nbsp;not&nbsp;implemented&nbsp;yet</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8290769">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8290772">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8290775">ift</span><span class="op" id="8290778">,</span>&nbsp;<span class="ident" id="8290780">err</span>&nbsp;<span class="op" id="8290784">:=</span>&nbsp;<span class="ident" id="8290787">Interfaces</span><span class="op" id="8290797">(</span><span class="op" id="8290798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8290801">if</span>&nbsp;<span class="ident" id="8290804">err</span>&nbsp;<span class="op" id="8290808">!=</span>&nbsp;<span class="ident" id="8290811">nil</span>&nbsp;<span class="op" id="8290815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8290819">return</span>&nbsp;<span class="builtintype" id="8290826">false</span><span class="op" id="8290831">,</span>&nbsp;<span class="ident" id="8290833">err</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8290838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8290841">for</span>&nbsp;<span class="ident" id="8290845">_</span><span class="op" id="8290846">,</span>&nbsp;<span class="ident" id="8290848">ifi</span>&nbsp;<span class="op" id="8290852">:=</span>&nbsp;<span class="keyword" id="8290855">range</span>&nbsp;<span class="ident" id="8290861">ift</span>&nbsp;<span class="op" id="8290865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8290869">ifmat</span><span class="op" id="8290874">,</span>&nbsp;<span class="ident" id="8290876">err</span>&nbsp;<span class="op" id="8290880">:=</span>&nbsp;<span class="ident" id="8290883">ifi</span><span class="op" id="8290886">.</span><span class="ident" id="8290887">MulticastAddrs</span><span class="op" id="8290901">(</span><span class="op" id="8290902">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8290906">if</span>&nbsp;<span class="ident" id="8290909">err</span>&nbsp;<span class="op" id="8290913">!=</span>&nbsp;<span class="ident" id="8290916">nil</span>&nbsp;<span class="op" id="8290920">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8290925">return</span>&nbsp;<span class="builtintype" id="8290932">false</span><span class="op" id="8290937">,</span>&nbsp;<span class="ident" id="8290939">err</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8290945">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8290949">for</span>&nbsp;<span class="ident" id="8290953">_</span><span class="op" id="8290954">,</span>&nbsp;<span class="ident" id="8290956">ifma</span>&nbsp;<span class="op" id="8290961">:=</span>&nbsp;<span class="keyword" id="8290964">range</span>&nbsp;<span class="ident" id="8290970">ifmat</span>&nbsp;<span class="op" id="8290976">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8290981">if</span>&nbsp;<span class="ident" id="8290984">ifma</span><span class="op" id="8290988">.</span><span class="op" id="8290989">(</span><span class="op" id="8290990">*</span><span class="ident" id="8290991">IPAddr</span><span class="op" id="8290997">)</span><span class="op" id="8290998">.</span><span class="ident" id="8290999">IP</span><span class="op" id="8291001">.</span><span class="ident" id="8291002">Equal</span><span class="op" id="8291007">(</span><span class="ident" id="8291008">ip</span><span class="op" id="8291010">)</span>&nbsp;<span class="op" id="8291012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8291018">return</span>&nbsp;<span class="builtintype" id="8291025">true</span><span class="op" id="8291029">,</span>&nbsp;<span class="ident" id="8291031">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8291038">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8291042">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8291045">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8291048">return</span>&nbsp;<span class="builtintype" id="8291055">false</span><span class="op" id="8291060">,</span>&nbsp;<span class="ident" id="8291062">nil</span><br>
<span class="lineno"></span><span class="op" id="8291066">}</span>
</div>
</body>
</html>
