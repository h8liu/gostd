<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/asn1</h2>
<ul>
<li><a href="/gostd/encoding/asn1/asn1.go.html">asn1.go</a></li>
<li><a href="/gostd/encoding/asn1/asn1_test.go.html">asn1_test.go</a></li>
<li><a href="/gostd/encoding/asn1/common.go.html">common.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal.go.html">marshal.go</a></li>
<li><a href="/gostd/encoding/asn1/marshal_test.go.html">marshal_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4403068">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4403123">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4403177">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4403228">//&nbsp;Package&nbsp;asn1&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structures,</span><br>
<span class="lineno"></span><span class="comment" id="4403301">//&nbsp;as&nbsp;defined&nbsp;in&nbsp;ITU-T&nbsp;Rec&nbsp;X.690.</span><br>
<span class="lineno"></span><span class="comment" id="4403335">//</span><br>
<span class="lineno"></span><span class="comment" id="4403338">//&nbsp;See&nbsp;also&nbsp;``A&nbsp;Layman&#39;s&nbsp;Guide&nbsp;to&nbsp;a&nbsp;Subset&nbsp;of&nbsp;ASN.1,&nbsp;BER,&nbsp;and&nbsp;DER,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="4403407">//&nbsp;http://luca.ntop.org/Teaching/Appunti/asn1.html.</span><br>
<span class="lineno">10</span><span class="keyword" id="4403459">package</span>&nbsp;<span class="ident" id="4403467">asn1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4403473">//&nbsp;ASN.1&nbsp;is&nbsp;a&nbsp;syntax&nbsp;for&nbsp;specifying&nbsp;abstract&nbsp;objects&nbsp;and&nbsp;BER,&nbsp;DER,&nbsp;PER,&nbsp;XER&nbsp;etc</span><br>
<span class="lineno"></span><span class="comment" id="4403553">//&nbsp;are&nbsp;different&nbsp;encoding&nbsp;formats&nbsp;for&nbsp;those&nbsp;objects.&nbsp;Here,&nbsp;we&#39;ll&nbsp;be&nbsp;dealing</span><br>
<span class="lineno"></span><span class="comment" id="4403629">//&nbsp;with&nbsp;DER,&nbsp;the&nbsp;Distinguished&nbsp;Encoding&nbsp;Rules.&nbsp;DER&nbsp;is&nbsp;used&nbsp;in&nbsp;X.509&nbsp;because</span><br>
<span class="lineno">15</span><span class="comment" id="4403705">//&nbsp;it&#39;s&nbsp;fast&nbsp;to&nbsp;parse&nbsp;and,&nbsp;unlike&nbsp;BER,&nbsp;has&nbsp;a&nbsp;unique&nbsp;encoding&nbsp;for&nbsp;every&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="4403784">//&nbsp;When&nbsp;calculating&nbsp;hashes&nbsp;over&nbsp;objects,&nbsp;it&#39;s&nbsp;important&nbsp;that&nbsp;the&nbsp;resulting</span><br>
<span class="lineno"></span><span class="comment" id="4403859">//&nbsp;bytes&nbsp;be&nbsp;the&nbsp;same&nbsp;at&nbsp;both&nbsp;ends&nbsp;and&nbsp;DER&nbsp;removes&nbsp;this&nbsp;margin&nbsp;of&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4403931">//</span><br>
<span class="lineno"></span><span class="comment" id="4403934">//&nbsp;ASN.1&nbsp;is&nbsp;very&nbsp;complex&nbsp;and&nbsp;this&nbsp;package&nbsp;doesn&#39;t&nbsp;attempt&nbsp;to&nbsp;implement</span><br>
<span class="lineno">20</span><span class="comment" id="4404005">//&nbsp;everything&nbsp;by&nbsp;any&nbsp;means.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4404034">import</span>&nbsp;<span class="op" id="4404041">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4404044">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4404051">&#34;math/big&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4404063">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4404074">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4404085">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4404092">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="4404095">//&nbsp;A&nbsp;StructuralError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;valid,&nbsp;but&nbsp;the&nbsp;Go&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="4404171">//&nbsp;which&nbsp;is&nbsp;receiving&nbsp;it&nbsp;doesn&#39;t&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="4404211">type</span>&nbsp;<span class="ident" id="4404216">StructuralError</span>&nbsp;<span class="keyword" id="4404232">struct</span>&nbsp;<span class="op" id="4404239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4404242">Msg</span>&nbsp;<span class="builtintype" id="4404246">string</span><br>
<span class="lineno"></span><span class="op" id="4404253">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="4404256">func</span>&nbsp;<span class="op" id="4404261">(</span><span class="ident" id="4404262">e</span>&nbsp;<span class="ident" id="4404264">StructuralError</span><span class="op" id="4404279">)</span>&nbsp;<span class="ident" id="4404281">Error</span><span class="op" id="4404286">(</span><span class="op" id="4404287">)</span>&nbsp;<span class="builtintype" id="4404289">string</span>&nbsp;<span class="op" id="4404296">{</span>&nbsp;<span class="keyword" id="4404298">return</span>&nbsp;<span class="string" id="4404305">&#34;asn1:&nbsp;structure&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4404331">+</span>&nbsp;<span class="ident" id="4404333">e</span><span class="op" id="4404334">.</span><span class="ident" id="4404335">Msg</span>&nbsp;<span class="op" id="4404339">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4404342">//&nbsp;A&nbsp;SyntaxError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="4404400">type</span>&nbsp;<span class="ident" id="4404405">SyntaxError</span>&nbsp;<span class="keyword" id="4404417">struct</span>&nbsp;<span class="op" id="4404424">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4404427">Msg</span>&nbsp;<span class="builtintype" id="4404431">string</span><br>
<span class="lineno"></span><span class="op" id="4404438">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4404441">func</span>&nbsp;<span class="op" id="4404446">(</span><span class="ident" id="4404447">e</span>&nbsp;<span class="ident" id="4404449">SyntaxError</span><span class="op" id="4404460">)</span>&nbsp;<span class="ident" id="4404462">Error</span><span class="op" id="4404467">(</span><span class="op" id="4404468">)</span>&nbsp;<span class="builtintype" id="4404470">string</span>&nbsp;<span class="op" id="4404477">{</span>&nbsp;<span class="keyword" id="4404479">return</span>&nbsp;<span class="string" id="4404486">&#34;asn1:&nbsp;syntax&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4404509">+</span>&nbsp;<span class="ident" id="4404511">e</span><span class="op" id="4404512">.</span><span class="ident" id="4404513">Msg</span>&nbsp;<span class="op" id="4404517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="4404520">//&nbsp;We&nbsp;start&nbsp;by&nbsp;dealing&nbsp;with&nbsp;each&nbsp;of&nbsp;the&nbsp;primitive&nbsp;types&nbsp;in&nbsp;turn.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4404586">//&nbsp;BOOLEAN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4404598">func</span>&nbsp;<span class="ident" id="4404603">parseBool</span><span class="op" id="4404612">(</span><span class="ident" id="4404613">bytes</span>&nbsp;<span class="op" id="4404619">[</span><span class="op" id="4404620">]</span><span class="builtintype" id="4404621">byte</span><span class="op" id="4404625">)</span>&nbsp;<span class="op" id="4404627">(</span><span class="ident" id="4404628">ret</span>&nbsp;<span class="builtintype" id="4404632">bool</span><span class="op" id="4404636">,</span>&nbsp;<span class="ident" id="4404638">err</span>&nbsp;<span class="builtintype" id="4404642">error</span><span class="op" id="4404647">)</span>&nbsp;<span class="op" id="4404649">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4404652">if</span>&nbsp;<span class="builtinfunc" id="4404655">len</span><span class="op" id="4404658">(</span><span class="ident" id="4404659">bytes</span><span class="op" id="4404664">)</span>&nbsp;<span class="op" id="4404666">!=</span>&nbsp;<span class="num" id="4404669">1</span>&nbsp;<span class="op" id="4404671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4404675">err</span>&nbsp;<span class="op" id="4404679">=</span>&nbsp;<span class="ident" id="4404681">SyntaxError</span><span class="op" id="4404692">{</span><span class="string" id="4404693">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4404710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4404714">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4404722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4404726">//&nbsp;DER&nbsp;demands&nbsp;that&nbsp;&#34;If&nbsp;the&nbsp;encoding&nbsp;represents&nbsp;the&nbsp;boolean&nbsp;value&nbsp;TRUE,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4404799">//&nbsp;its&nbsp;single&nbsp;contents&nbsp;octet&nbsp;shall&nbsp;have&nbsp;all&nbsp;eight&nbsp;bits&nbsp;set&nbsp;to&nbsp;one.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4404868">//&nbsp;Thus&nbsp;only&nbsp;0&nbsp;and&nbsp;255&nbsp;are&nbsp;valid&nbsp;encoded&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4404918">switch</span>&nbsp;<span class="ident" id="4404925">bytes</span><span class="op" id="4404930">[</span><span class="num" id="4404931">0</span><span class="op" id="4404932">]</span>&nbsp;<span class="op" id="4404934">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4404937">case</span>&nbsp;<span class="num" id="4404942">0</span><span class="op" id="4404943">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4404947">ret</span>&nbsp;<span class="op" id="4404951">=</span>&nbsp;<span class="builtintype" id="4404953">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4404960">case</span>&nbsp;<span class="num" id="4404965">0xff</span><span class="op" id="4404969">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4404973">ret</span>&nbsp;<span class="op" id="4404977">=</span>&nbsp;<span class="builtintype" id="4404979">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4404985">default</span><span class="op" id="4404992">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4404996">err</span>&nbsp;<span class="op" id="4405000">=</span>&nbsp;<span class="ident" id="4405002">SyntaxError</span><span class="op" id="4405013">{</span><span class="string" id="4405014">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4405031">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4405034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4405038">return</span><br>
<span class="lineno"></span><span class="op" id="4405045">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="4405048">//&nbsp;INTEGER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4405060">//&nbsp;parseInt64&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4405133">//&nbsp;returns&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4405156">func</span>&nbsp;<span class="ident" id="4405161">parseInt64</span><span class="op" id="4405171">(</span><span class="ident" id="4405172">bytes</span>&nbsp;<span class="op" id="4405178">[</span><span class="op" id="4405179">]</span><span class="builtintype" id="4405180">byte</span><span class="op" id="4405184">)</span>&nbsp;<span class="op" id="4405186">(</span><span class="ident" id="4405187">ret</span>&nbsp;<span class="ident" id="4405191">int64</span><span class="op" id="4405196">,</span>&nbsp;<span class="ident" id="4405198">err</span>&nbsp;<span class="builtintype" id="4405202">error</span><span class="op" id="4405207">)</span>&nbsp;<span class="op" id="4405209">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4405212">if</span>&nbsp;<span class="builtinfunc" id="4405215">len</span><span class="op" id="4405218">(</span><span class="ident" id="4405219">bytes</span><span class="op" id="4405224">)</span>&nbsp;<span class="op" id="4405226">&gt;</span>&nbsp;<span class="num" id="4405228">8</span>&nbsp;<span class="op" id="4405230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4405234">//&nbsp;We&#39;ll&nbsp;overflow&nbsp;an&nbsp;int64&nbsp;in&nbsp;this&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4405277">err</span>&nbsp;<span class="op" id="4405281">=</span>&nbsp;<span class="ident" id="4405283">StructuralError</span><span class="op" id="4405298">{</span><span class="string" id="4405299">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4405318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4405322">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4405330">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4405333">for</span>&nbsp;<span class="ident" id="4405337">bytesRead</span>&nbsp;<span class="op" id="4405347">:=</span>&nbsp;<span class="num" id="4405350">0</span><span class="op" id="4405351">;</span>&nbsp;<span class="ident" id="4405353">bytesRead</span>&nbsp;<span class="op" id="4405363">&lt;</span>&nbsp;<span class="builtinfunc" id="4405365">len</span><span class="op" id="4405368">(</span><span class="ident" id="4405369">bytes</span><span class="op" id="4405374">)</span><span class="op" id="4405375">;</span>&nbsp;<span class="ident" id="4405377">bytesRead</span><span class="op" id="4405386">++</span>&nbsp;<span class="op" id="4405389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4405393">ret</span>&nbsp;<span class="op" id="4405397">&lt;&lt;=</span>&nbsp;<span class="num" id="4405401">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4405405">ret</span>&nbsp;<span class="op" id="4405409">|=</span>&nbsp;<span class="ident" id="4405412">int64</span><span class="op" id="4405417">(</span><span class="ident" id="4405418">bytes</span><span class="op" id="4405423">[</span><span class="ident" id="4405424">bytesRead</span><span class="op" id="4405433">]</span><span class="op" id="4405434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4405437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4405441">//&nbsp;Shift&nbsp;up&nbsp;and&nbsp;down&nbsp;in&nbsp;order&nbsp;to&nbsp;sign&nbsp;extend&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4405499">ret</span>&nbsp;<span class="op" id="4405503">&lt;&lt;=</span>&nbsp;<span class="num" id="4405507">64</span>&nbsp;<span class="op" id="4405510">-</span>&nbsp;<span class="builtintype" id="4405512">uint8</span><span class="op" id="4405517">(</span><span class="builtinfunc" id="4405518">len</span><span class="op" id="4405521">(</span><span class="ident" id="4405522">bytes</span><span class="op" id="4405527">)</span><span class="op" id="4405528">)</span><span class="op" id="4405529">*</span><span class="num" id="4405530">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4405533">ret</span>&nbsp;<span class="op" id="4405537">&gt;&gt;=</span>&nbsp;<span class="num" id="4405541">64</span>&nbsp;<span class="op" id="4405544">-</span>&nbsp;<span class="builtintype" id="4405546">uint8</span><span class="op" id="4405551">(</span><span class="builtinfunc" id="4405552">len</span><span class="op" id="4405555">(</span><span class="ident" id="4405556">bytes</span><span class="op" id="4405561">)</span><span class="op" id="4405562">)</span><span class="op" id="4405563">*</span><span class="num" id="4405564">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4405567">return</span><br>
<span class="lineno"></span><span class="op" id="4405574">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="4405577">//&nbsp;parseInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4405656">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4405671">func</span>&nbsp;<span class="ident" id="4405676">parseInt32</span><span class="op" id="4405686">(</span><span class="ident" id="4405687">bytes</span>&nbsp;<span class="op" id="4405693">[</span><span class="op" id="4405694">]</span><span class="builtintype" id="4405695">byte</span><span class="op" id="4405699">)</span>&nbsp;<span class="op" id="4405701">(</span><span class="builtintype" id="4405702">int32</span><span class="op" id="4405707">,</span>&nbsp;<span class="builtintype" id="4405709">error</span><span class="op" id="4405714">)</span>&nbsp;<span class="op" id="4405716">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4405719">ret64</span><span class="op" id="4405724">,</span>&nbsp;<span class="ident" id="4405726">err</span>&nbsp;<span class="op" id="4405730">:=</span>&nbsp;<span class="ident" id="4405733">parseInt64</span><span class="op" id="4405743">(</span><span class="ident" id="4405744">bytes</span><span class="op" id="4405749">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4405752">if</span>&nbsp;<span class="ident" id="4405755">err</span>&nbsp;<span class="op" id="4405759">!=</span>&nbsp;<span class="ident" id="4405762">nil</span>&nbsp;<span class="op" id="4405766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4405770">return</span>&nbsp;<span class="num" id="4405777">0</span><span class="op" id="4405778">,</span>&nbsp;<span class="ident" id="4405780">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4405785">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4405788">if</span>&nbsp;<span class="ident" id="4405791">ret64</span>&nbsp;<span class="op" id="4405797">!=</span>&nbsp;<span class="ident" id="4405800">int64</span><span class="op" id="4405805">(</span><span class="builtintype" id="4405806">int32</span><span class="op" id="4405811">(</span><span class="ident" id="4405812">ret64</span><span class="op" id="4405817">)</span><span class="op" id="4405818">)</span>&nbsp;<span class="op" id="4405820">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4405824">return</span>&nbsp;<span class="num" id="4405831">0</span><span class="op" id="4405832">,</span>&nbsp;<span class="ident" id="4405834">StructuralError</span><span class="op" id="4405849">{</span><span class="string" id="4405850">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4405869">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4405872">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4405875">return</span>&nbsp;<span class="builtintype" id="4405882">int32</span><span class="op" id="4405887">(</span><span class="ident" id="4405888">ret64</span><span class="op" id="4405893">)</span><span class="op" id="4405894">,</span>&nbsp;<span class="ident" id="4405896">nil</span><br>
<span class="lineno"></span><span class="op" id="4405900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4405903">var</span>&nbsp;<span class="ident" id="4405907">bigOne</span>&nbsp;<span class="op" id="4405914">=</span>&nbsp;<span class="ident" id="4405916">big</span><span class="op" id="4405919">.</span><span class="ident" id="4405920">NewInt</span><span class="op" id="4405926">(</span><span class="num" id="4405927">1</span><span class="op" id="4405928">)</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4405931">//&nbsp;parseBigInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4406013">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4406028">func</span>&nbsp;<span class="ident" id="4406033">parseBigInt</span><span class="op" id="4406044">(</span><span class="ident" id="4406045">bytes</span>&nbsp;<span class="op" id="4406051">[</span><span class="op" id="4406052">]</span><span class="builtintype" id="4406053">byte</span><span class="op" id="4406057">)</span>&nbsp;<span class="op" id="4406059">*</span><span class="ident" id="4406060">big</span><span class="op" id="4406063">.</span><span class="ident" id="4406064">Int</span>&nbsp;<span class="op" id="4406068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406071">ret</span>&nbsp;<span class="op" id="4406075">:=</span>&nbsp;<span class="builtinfunc" id="4406078">new</span><span class="op" id="4406081">(</span><span class="ident" id="4406082">big</span><span class="op" id="4406085">.</span><span class="ident" id="4406086">Int</span><span class="op" id="4406089">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4406092">if</span>&nbsp;<span class="builtinfunc" id="4406095">len</span><span class="op" id="4406098">(</span><span class="ident" id="4406099">bytes</span><span class="op" id="4406104">)</span>&nbsp;<span class="op" id="4406106">&gt;</span>&nbsp;<span class="num" id="4406108">0</span>&nbsp;<span class="op" id="4406110">&amp;&amp;</span>&nbsp;<span class="ident" id="4406113">bytes</span><span class="op" id="4406118">[</span><span class="num" id="4406119">0</span><span class="op" id="4406120">]</span><span class="op" id="4406121">&amp;</span><span class="num" id="4406122">0x80</span>&nbsp;<span class="op" id="4406127">==</span>&nbsp;<span class="num" id="4406130">0x80</span>&nbsp;<span class="op" id="4406135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4406139">//&nbsp;This&nbsp;is&nbsp;a&nbsp;negative&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406171">notBytes</span>&nbsp;<span class="op" id="4406180">:=</span>&nbsp;<span class="builtinfunc" id="4406183">make</span><span class="op" id="4406187">(</span><span class="op" id="4406188">[</span><span class="op" id="4406189">]</span><span class="builtintype" id="4406190">byte</span><span class="op" id="4406194">,</span>&nbsp;<span class="builtinfunc" id="4406196">len</span><span class="op" id="4406199">(</span><span class="ident" id="4406200">bytes</span><span class="op" id="4406205">)</span><span class="op" id="4406206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4406210">for</span>&nbsp;<span class="ident" id="4406214">i</span>&nbsp;<span class="op" id="4406216">:=</span>&nbsp;<span class="keyword" id="4406219">range</span>&nbsp;<span class="ident" id="4406225">notBytes</span>&nbsp;<span class="op" id="4406234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406239">notBytes</span><span class="op" id="4406247">[</span><span class="ident" id="4406248">i</span><span class="op" id="4406249">]</span>&nbsp;<span class="op" id="4406251">=</span>&nbsp;<span class="op" id="4406253">^</span><span class="ident" id="4406254">bytes</span><span class="op" id="4406259">[</span><span class="ident" id="4406260">i</span><span class="op" id="4406261">]</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4406265">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406269">ret</span><span class="op" id="4406272">.</span><span class="ident" id="4406273">SetBytes</span><span class="op" id="4406281">(</span><span class="ident" id="4406282">notBytes</span><span class="op" id="4406290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406294">ret</span><span class="op" id="4406297">.</span><span class="ident" id="4406298">Add</span><span class="op" id="4406301">(</span><span class="ident" id="4406302">ret</span><span class="op" id="4406305">,</span>&nbsp;<span class="ident" id="4406307">bigOne</span><span class="op" id="4406313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406317">ret</span><span class="op" id="4406320">.</span><span class="ident" id="4406321">Neg</span><span class="op" id="4406324">(</span><span class="ident" id="4406325">ret</span><span class="op" id="4406328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4406332">return</span>&nbsp;<span class="ident" id="4406339">ret</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4406344">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406347">ret</span><span class="op" id="4406350">.</span><span class="ident" id="4406351">SetBytes</span><span class="op" id="4406359">(</span><span class="ident" id="4406360">bytes</span><span class="op" id="4406365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4406368">return</span>&nbsp;<span class="ident" id="4406375">ret</span><br>
<span class="lineno"></span><span class="op" id="4406379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="4406382">//&nbsp;BIT&nbsp;STRING</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4406397">//&nbsp;BitString&nbsp;is&nbsp;the&nbsp;structure&nbsp;to&nbsp;use&nbsp;when&nbsp;you&nbsp;want&nbsp;an&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;type.&nbsp;A</span><br>
<span class="lineno"></span><span class="comment" id="4406476">//&nbsp;bit&nbsp;string&nbsp;is&nbsp;padded&nbsp;up&nbsp;to&nbsp;the&nbsp;nearest&nbsp;byte&nbsp;in&nbsp;memory&nbsp;and&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4406551">//&nbsp;valid&nbsp;bits&nbsp;is&nbsp;recorded.&nbsp;Padding&nbsp;bits&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno">130</span><span class="keyword" id="4406605">type</span>&nbsp;<span class="ident" id="4406610">BitString</span>&nbsp;<span class="keyword" id="4406620">struct</span>&nbsp;<span class="op" id="4406627">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406630">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4406640">[</span><span class="op" id="4406641">]</span><span class="builtintype" id="4406642">byte</span>&nbsp;<span class="comment" id="4406647">//&nbsp;bits&nbsp;packed&nbsp;into&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406675">BitLength</span>&nbsp;<span class="builtintype" id="4406685">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4406692">//&nbsp;length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span><span class="op" id="4406711">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="4406714">//&nbsp;At&nbsp;returns&nbsp;the&nbsp;bit&nbsp;at&nbsp;the&nbsp;given&nbsp;index.&nbsp;If&nbsp;the&nbsp;index&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4406788">//&nbsp;returns&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword" id="4406806">func</span>&nbsp;<span class="op" id="4406811">(</span><span class="ident" id="4406812">b</span>&nbsp;<span class="ident" id="4406814">BitString</span><span class="op" id="4406823">)</span>&nbsp;<span class="ident" id="4406825">At</span><span class="op" id="4406827">(</span><span class="ident" id="4406828">i</span>&nbsp;<span class="builtintype" id="4406830">int</span><span class="op" id="4406833">)</span>&nbsp;<span class="builtintype" id="4406835">int</span>&nbsp;<span class="op" id="4406839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4406842">if</span>&nbsp;<span class="ident" id="4406845">i</span>&nbsp;<span class="op" id="4406847">&lt;</span>&nbsp;<span class="num" id="4406849">0</span>&nbsp;<span class="op" id="4406851">||</span>&nbsp;<span class="ident" id="4406854">i</span>&nbsp;<span class="op" id="4406856">&gt;=</span>&nbsp;<span class="ident" id="4406859">b</span><span class="op" id="4406860">.</span><span class="ident" id="4406861">BitLength</span>&nbsp;<span class="op" id="4406871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4406875">return</span>&nbsp;<span class="num" id="4406882">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4406885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406888">x</span>&nbsp;<span class="op" id="4406890">:=</span>&nbsp;<span class="ident" id="4406893">i</span>&nbsp;<span class="op" id="4406895">/</span>&nbsp;<span class="num" id="4406897">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4406900">y</span>&nbsp;<span class="op" id="4406902">:=</span>&nbsp;<span class="num" id="4406905">7</span>&nbsp;<span class="op" id="4406907">-</span>&nbsp;<span class="builtintype" id="4406909">uint</span><span class="op" id="4406913">(</span><span class="ident" id="4406914">i</span><span class="op" id="4406915">%</span><span class="num" id="4406916">8</span><span class="op" id="4406917">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4406920">return</span>&nbsp;<span class="builtintype" id="4406927">int</span><span class="op" id="4406930">(</span><span class="ident" id="4406931">b</span><span class="op" id="4406932">.</span><span class="ident" id="4406933">Bytes</span><span class="op" id="4406938">[</span><span class="ident" id="4406939">x</span><span class="op" id="4406940">]</span><span class="op" id="4406941">&gt;&gt;</span><span class="ident" id="4406943">y</span><span class="op" id="4406944">)</span>&nbsp;<span class="op" id="4406946">&amp;</span>&nbsp;<span class="num" id="4406948">1</span><br>
<span class="lineno"></span><span class="op" id="4406950">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="4406953">//&nbsp;RightAlign&nbsp;returns&nbsp;a&nbsp;slice&nbsp;where&nbsp;the&nbsp;padding&nbsp;bits&nbsp;are&nbsp;at&nbsp;the&nbsp;beginning.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4407032">//&nbsp;slice&nbsp;may&nbsp;share&nbsp;memory&nbsp;with&nbsp;the&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="keyword" id="4407078">func</span>&nbsp;<span class="op" id="4407083">(</span><span class="ident" id="4407084">b</span>&nbsp;<span class="ident" id="4407086">BitString</span><span class="op" id="4407095">)</span>&nbsp;<span class="ident" id="4407097">RightAlign</span><span class="op" id="4407107">(</span><span class="op" id="4407108">)</span>&nbsp;<span class="op" id="4407110">[</span><span class="op" id="4407111">]</span><span class="builtintype" id="4407112">byte</span>&nbsp;<span class="op" id="4407117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407120">shift</span>&nbsp;<span class="op" id="4407126">:=</span>&nbsp;<span class="builtintype" id="4407129">uint</span><span class="op" id="4407133">(</span><span class="num" id="4407134">8</span>&nbsp;<span class="op" id="4407136">-</span>&nbsp;<span class="op" id="4407138">(</span><span class="ident" id="4407139">b</span><span class="op" id="4407140">.</span><span class="ident" id="4407141">BitLength</span>&nbsp;<span class="op" id="4407151">%</span>&nbsp;<span class="num" id="4407153">8</span><span class="op" id="4407154">)</span><span class="op" id="4407155">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4407158">if</span>&nbsp;<span class="ident" id="4407161">shift</span>&nbsp;<span class="op" id="4407167">==</span>&nbsp;<span class="num" id="4407170">8</span>&nbsp;<span class="op" id="4407172">||</span>&nbsp;<span class="builtinfunc" id="4407175">len</span><span class="op" id="4407178">(</span><span class="ident" id="4407179">b</span><span class="op" id="4407180">.</span><span class="ident" id="4407181">Bytes</span><span class="op" id="4407186">)</span>&nbsp;<span class="op" id="4407188">==</span>&nbsp;<span class="num" id="4407191">0</span>&nbsp;<span class="op" id="4407193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4407197">return</span>&nbsp;<span class="ident" id="4407204">b</span><span class="op" id="4407205">.</span><span class="ident" id="4407206">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4407213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407217">a</span>&nbsp;<span class="op" id="4407219">:=</span>&nbsp;<span class="builtinfunc" id="4407222">make</span><span class="op" id="4407226">(</span><span class="op" id="4407227">[</span><span class="op" id="4407228">]</span><span class="builtintype" id="4407229">byte</span><span class="op" id="4407233">,</span>&nbsp;<span class="builtinfunc" id="4407235">len</span><span class="op" id="4407238">(</span><span class="ident" id="4407239">b</span><span class="op" id="4407240">.</span><span class="ident" id="4407241">Bytes</span><span class="op" id="4407246">)</span><span class="op" id="4407247">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407250">a</span><span class="op" id="4407251">[</span><span class="num" id="4407252">0</span><span class="op" id="4407253">]</span>&nbsp;<span class="op" id="4407255">=</span>&nbsp;<span class="ident" id="4407257">b</span><span class="op" id="4407258">.</span><span class="ident" id="4407259">Bytes</span><span class="op" id="4407264">[</span><span class="num" id="4407265">0</span><span class="op" id="4407266">]</span>&nbsp;<span class="op" id="4407268">&gt;&gt;</span>&nbsp;<span class="ident" id="4407271">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4407278">for</span>&nbsp;<span class="ident" id="4407282">i</span>&nbsp;<span class="op" id="4407284">:=</span>&nbsp;<span class="num" id="4407287">1</span><span class="op" id="4407288">;</span>&nbsp;<span class="ident" id="4407290">i</span>&nbsp;<span class="op" id="4407292">&lt;</span>&nbsp;<span class="builtinfunc" id="4407294">len</span><span class="op" id="4407297">(</span><span class="ident" id="4407298">b</span><span class="op" id="4407299">.</span><span class="ident" id="4407300">Bytes</span><span class="op" id="4407305">)</span><span class="op" id="4407306">;</span>&nbsp;<span class="ident" id="4407308">i</span><span class="op" id="4407309">++</span>&nbsp;<span class="op" id="4407312">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407316">a</span><span class="op" id="4407317">[</span><span class="ident" id="4407318">i</span><span class="op" id="4407319">]</span>&nbsp;<span class="op" id="4407321">=</span>&nbsp;<span class="ident" id="4407323">b</span><span class="op" id="4407324">.</span><span class="ident" id="4407325">Bytes</span><span class="op" id="4407330">[</span><span class="ident" id="4407331">i</span><span class="op" id="4407332">-</span><span class="num" id="4407333">1</span><span class="op" id="4407334">]</span>&nbsp;<span class="op" id="4407336">&lt;&lt;</span>&nbsp;<span class="op" id="4407339">(</span><span class="num" id="4407340">8</span>&nbsp;<span class="op" id="4407342">-</span>&nbsp;<span class="ident" id="4407344">shift</span><span class="op" id="4407349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407353">a</span><span class="op" id="4407354">[</span><span class="ident" id="4407355">i</span><span class="op" id="4407356">]</span>&nbsp;<span class="op" id="4407358">|=</span>&nbsp;<span class="ident" id="4407361">b</span><span class="op" id="4407362">.</span><span class="ident" id="4407363">Bytes</span><span class="op" id="4407368">[</span><span class="ident" id="4407369">i</span><span class="op" id="4407370">]</span>&nbsp;<span class="op" id="4407372">&gt;&gt;</span>&nbsp;<span class="ident" id="4407375">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4407382">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4407386">return</span>&nbsp;<span class="ident" id="4407393">a</span><br>
<span class="lineno"></span><span class="op" id="4407395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4407398">//&nbsp;parseBitString&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;bit&nbsp;string&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno">165</span><span class="keyword" id="4407485">func</span>&nbsp;<span class="ident" id="4407490">parseBitString</span><span class="op" id="4407504">(</span><span class="ident" id="4407505">bytes</span>&nbsp;<span class="op" id="4407511">[</span><span class="op" id="4407512">]</span><span class="builtintype" id="4407513">byte</span><span class="op" id="4407517">)</span>&nbsp;<span class="op" id="4407519">(</span><span class="ident" id="4407520">ret</span>&nbsp;<span class="ident" id="4407524">BitString</span><span class="op" id="4407533">,</span>&nbsp;<span class="ident" id="4407535">err</span>&nbsp;<span class="builtintype" id="4407539">error</span><span class="op" id="4407544">)</span>&nbsp;<span class="op" id="4407546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4407549">if</span>&nbsp;<span class="builtinfunc" id="4407552">len</span><span class="op" id="4407555">(</span><span class="ident" id="4407556">bytes</span><span class="op" id="4407561">)</span>&nbsp;<span class="op" id="4407563">==</span>&nbsp;<span class="num" id="4407566">0</span>&nbsp;<span class="op" id="4407568">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407572">err</span>&nbsp;<span class="op" id="4407576">=</span>&nbsp;<span class="ident" id="4407578">SyntaxError</span><span class="op" id="4407589">{</span><span class="string" id="4407590">&#34;zero&nbsp;length&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4407614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4407618">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4407626">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407629">paddingBits</span>&nbsp;<span class="op" id="4407641">:=</span>&nbsp;<span class="builtintype" id="4407644">int</span><span class="op" id="4407647">(</span><span class="ident" id="4407648">bytes</span><span class="op" id="4407653">[</span><span class="num" id="4407654">0</span><span class="op" id="4407655">]</span><span class="op" id="4407656">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4407659">if</span>&nbsp;<span class="ident" id="4407662">paddingBits</span>&nbsp;<span class="op" id="4407674">&gt;</span>&nbsp;<span class="num" id="4407676">7</span>&nbsp;<span class="op" id="4407678">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4407683">len</span><span class="op" id="4407686">(</span><span class="ident" id="4407687">bytes</span><span class="op" id="4407692">)</span>&nbsp;<span class="op" id="4407694">==</span>&nbsp;<span class="num" id="4407697">1</span>&nbsp;<span class="op" id="4407699">&amp;&amp;</span>&nbsp;<span class="ident" id="4407702">paddingBits</span>&nbsp;<span class="op" id="4407714">&gt;</span>&nbsp;<span class="num" id="4407716">0</span>&nbsp;<span class="op" id="4407718">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407723">bytes</span><span class="op" id="4407728">[</span><span class="builtinfunc" id="4407729">len</span><span class="op" id="4407732">(</span><span class="ident" id="4407733">bytes</span><span class="op" id="4407738">)</span><span class="op" id="4407739">-</span><span class="num" id="4407740">1</span><span class="op" id="4407741">]</span><span class="op" id="4407742">&amp;</span><span class="op" id="4407743">(</span><span class="op" id="4407744">(</span><span class="num" id="4407745">1</span><span class="op" id="4407746">&lt;&lt;</span><span class="ident" id="4407748">bytes</span><span class="op" id="4407753">[</span><span class="num" id="4407754">0</span><span class="op" id="4407755">]</span><span class="op" id="4407756">)</span><span class="op" id="4407757">-</span><span class="num" id="4407758">1</span><span class="op" id="4407759">)</span>&nbsp;<span class="op" id="4407761">!=</span>&nbsp;<span class="num" id="4407764">0</span>&nbsp;<span class="op" id="4407766">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407770">err</span>&nbsp;<span class="op" id="4407774">=</span>&nbsp;<span class="ident" id="4407776">SyntaxError</span><span class="op" id="4407787">{</span><span class="string" id="4407788">&#34;invalid&nbsp;padding&nbsp;bits&nbsp;in&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4407824">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4407828">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4407836">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407839">ret</span><span class="op" id="4407842">.</span><span class="ident" id="4407843">BitLength</span>&nbsp;<span class="op" id="4407853">=</span>&nbsp;<span class="op" id="4407855">(</span><span class="builtinfunc" id="4407856">len</span><span class="op" id="4407859">(</span><span class="ident" id="4407860">bytes</span><span class="op" id="4407865">)</span><span class="op" id="4407866">-</span><span class="num" id="4407867">1</span><span class="op" id="4407868">)</span><span class="op" id="4407869">*</span><span class="num" id="4407870">8</span>&nbsp;<span class="op" id="4407872">-</span>&nbsp;<span class="ident" id="4407874">paddingBits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4407887">ret</span><span class="op" id="4407890">.</span><span class="ident" id="4407891">Bytes</span>&nbsp;<span class="op" id="4407897">=</span>&nbsp;<span class="ident" id="4407899">bytes</span><span class="op" id="4407904">[</span><span class="num" id="4407905">1</span><span class="op" id="4407906">:</span><span class="op" id="4407907">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4407910">return</span><br>
<span class="lineno">180</span><span class="op" id="4407917">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4407920">//&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4407942">//&nbsp;An&nbsp;ObjectIdentifier&nbsp;represents&nbsp;an&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER.</span><br>
<span class="lineno">185</span><span class="keyword" id="4408004">type</span>&nbsp;<span class="ident" id="4408009">ObjectIdentifier</span>&nbsp;<span class="op" id="4408026">[</span><span class="op" id="4408027">]</span><span class="builtintype" id="4408028">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4408033">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;oi&nbsp;and&nbsp;other&nbsp;represent&nbsp;the&nbsp;same&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="4408102">func</span>&nbsp;<span class="op" id="4408107">(</span><span class="ident" id="4408108">oi</span>&nbsp;<span class="ident" id="4408111">ObjectIdentifier</span><span class="op" id="4408127">)</span>&nbsp;<span class="ident" id="4408129">Equal</span><span class="op" id="4408134">(</span><span class="ident" id="4408135">other</span>&nbsp;<span class="ident" id="4408141">ObjectIdentifier</span><span class="op" id="4408157">)</span>&nbsp;<span class="builtintype" id="4408159">bool</span>&nbsp;<span class="op" id="4408164">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408167">if</span>&nbsp;<span class="builtinfunc" id="4408170">len</span><span class="op" id="4408173">(</span><span class="ident" id="4408174">oi</span><span class="op" id="4408176">)</span>&nbsp;<span class="op" id="4408178">!=</span>&nbsp;<span class="builtinfunc" id="4408181">len</span><span class="op" id="4408184">(</span><span class="ident" id="4408185">other</span><span class="op" id="4408190">)</span>&nbsp;<span class="op" id="4408192">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408196">return</span>&nbsp;<span class="builtintype" id="4408203">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4408210">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408213">for</span>&nbsp;<span class="ident" id="4408217">i</span>&nbsp;<span class="op" id="4408219">:=</span>&nbsp;<span class="num" id="4408222">0</span><span class="op" id="4408223">;</span>&nbsp;<span class="ident" id="4408225">i</span>&nbsp;<span class="op" id="4408227">&lt;</span>&nbsp;<span class="builtinfunc" id="4408229">len</span><span class="op" id="4408232">(</span><span class="ident" id="4408233">oi</span><span class="op" id="4408235">)</span><span class="op" id="4408236">;</span>&nbsp;<span class="ident" id="4408238">i</span><span class="op" id="4408239">++</span>&nbsp;<span class="op" id="4408242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408246">if</span>&nbsp;<span class="ident" id="4408249">oi</span><span class="op" id="4408251">[</span><span class="ident" id="4408252">i</span><span class="op" id="4408253">]</span>&nbsp;<span class="op" id="4408255">!=</span>&nbsp;<span class="ident" id="4408258">other</span><span class="op" id="4408263">[</span><span class="ident" id="4408264">i</span><span class="op" id="4408265">]</span>&nbsp;<span class="op" id="4408267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408272">return</span>&nbsp;<span class="builtintype" id="4408279">false</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4408287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4408290">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408294">return</span>&nbsp;<span class="builtintype" id="4408301">true</span><br>
<span class="lineno"></span><span class="op" id="4408306">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="4408309">func</span>&nbsp;<span class="op" id="4408314">(</span><span class="ident" id="4408315">oi</span>&nbsp;<span class="ident" id="4408318">ObjectIdentifier</span><span class="op" id="4408334">)</span>&nbsp;<span class="ident" id="4408336">String</span><span class="op" id="4408342">(</span><span class="op" id="4408343">)</span>&nbsp;<span class="builtintype" id="4408345">string</span>&nbsp;<span class="op" id="4408352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408355">var</span>&nbsp;<span class="ident" id="4408359">s</span>&nbsp;<span class="builtintype" id="4408361">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408370">for</span>&nbsp;<span class="ident" id="4408374">i</span><span class="op" id="4408375">,</span>&nbsp;<span class="ident" id="4408377">v</span>&nbsp;<span class="op" id="4408379">:=</span>&nbsp;<span class="keyword" id="4408382">range</span>&nbsp;<span class="ident" id="4408388">oi</span>&nbsp;<span class="op" id="4408391">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408395">if</span>&nbsp;<span class="ident" id="4408398">i</span>&nbsp;<span class="op" id="4408400">&gt;</span>&nbsp;<span class="num" id="4408402">0</span>&nbsp;<span class="op" id="4408404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4408409">s</span>&nbsp;<span class="op" id="4408411">+=</span>&nbsp;<span class="string" id="4408414">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4408420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4408424">s</span>&nbsp;<span class="op" id="4408426">+=</span>&nbsp;<span class="ident" id="4408429">strconv</span><span class="op" id="4408436">.</span><span class="ident" id="4408437">Itoa</span><span class="op" id="4408441">(</span><span class="ident" id="4408442">v</span><span class="op" id="4408443">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4408446">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408450">return</span>&nbsp;<span class="ident" id="4408457">s</span><br>
<span class="lineno"></span><span class="op" id="4408459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4408462">//&nbsp;parseObjectIdentifier&nbsp;parses&nbsp;an&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes&nbsp;and</span><br>
<span class="lineno">215</span><span class="comment" id="4408540">//&nbsp;returns&nbsp;it.&nbsp;An&nbsp;object&nbsp;identifier&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;variable&nbsp;length&nbsp;integers</span><br>
<span class="lineno"></span><span class="comment" id="4408618">//&nbsp;that&nbsp;are&nbsp;assigned&nbsp;in&nbsp;a&nbsp;hierarchy.</span><br>
<span class="lineno"></span><span class="keyword" id="4408655">func</span>&nbsp;<span class="ident" id="4408660">parseObjectIdentifier</span><span class="op" id="4408681">(</span><span class="ident" id="4408682">bytes</span>&nbsp;<span class="op" id="4408688">[</span><span class="op" id="4408689">]</span><span class="builtintype" id="4408690">byte</span><span class="op" id="4408694">)</span>&nbsp;<span class="op" id="4408696">(</span><span class="ident" id="4408697">s</span>&nbsp;<span class="op" id="4408699">[</span><span class="op" id="4408700">]</span><span class="builtintype" id="4408701">int</span><span class="op" id="4408704">,</span>&nbsp;<span class="ident" id="4408706">err</span>&nbsp;<span class="builtintype" id="4408710">error</span><span class="op" id="4408715">)</span>&nbsp;<span class="op" id="4408717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408720">if</span>&nbsp;<span class="builtinfunc" id="4408723">len</span><span class="op" id="4408726">(</span><span class="ident" id="4408727">bytes</span><span class="op" id="4408732">)</span>&nbsp;<span class="op" id="4408734">==</span>&nbsp;<span class="num" id="4408737">0</span>&nbsp;<span class="op" id="4408739">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4408743">err</span>&nbsp;<span class="op" id="4408747">=</span>&nbsp;<span class="ident" id="4408749">SyntaxError</span><span class="op" id="4408760">{</span><span class="string" id="4408761">&#34;zero&nbsp;length&nbsp;OBJECT&nbsp;IDENTIFIER&#34;</span><span class="op" id="4408792">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4408796">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4408804">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4408808">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;we&nbsp;get&nbsp;two&nbsp;elements&nbsp;from&nbsp;the&nbsp;first&nbsp;byte&nbsp;(which&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4408881">//&nbsp;encoded&nbsp;differently)&nbsp;and&nbsp;then&nbsp;every&nbsp;varint&nbsp;is&nbsp;a&nbsp;single&nbsp;byte&nbsp;long.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4408951">s</span>&nbsp;<span class="op" id="4408953">=</span>&nbsp;<span class="builtinfunc" id="4408955">make</span><span class="op" id="4408959">(</span><span class="op" id="4408960">[</span><span class="op" id="4408961">]</span><span class="builtintype" id="4408962">int</span><span class="op" id="4408965">,</span>&nbsp;<span class="builtinfunc" id="4408967">len</span><span class="op" id="4408970">(</span><span class="ident" id="4408971">bytes</span><span class="op" id="4408976">)</span><span class="op" id="4408977">+</span><span class="num" id="4408978">1</span><span class="op" id="4408979">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4408983">//&nbsp;The&nbsp;first&nbsp;varint&nbsp;is&nbsp;40*value1&nbsp;+&nbsp;value2:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4409027">//&nbsp;According&nbsp;to&nbsp;this&nbsp;packing,&nbsp;value1&nbsp;can&nbsp;take&nbsp;the&nbsp;values&nbsp;0,&nbsp;1&nbsp;and&nbsp;2&nbsp;only.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4409102">//&nbsp;When&nbsp;value1&nbsp;=&nbsp;0&nbsp;or&nbsp;value1&nbsp;=&nbsp;1,&nbsp;then&nbsp;value2&nbsp;is&nbsp;&lt;=&nbsp;39.&nbsp;When&nbsp;value1&nbsp;=&nbsp;2,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4409176">//&nbsp;then&nbsp;there&nbsp;are&nbsp;no&nbsp;restrictions&nbsp;on&nbsp;value2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4409222">v</span><span class="op" id="4409223">,</span>&nbsp;<span class="ident" id="4409225">offset</span><span class="op" id="4409231">,</span>&nbsp;<span class="ident" id="4409233">err</span>&nbsp;<span class="op" id="4409237">:=</span>&nbsp;<span class="ident" id="4409240">parseBase128Int</span><span class="op" id="4409255">(</span><span class="ident" id="4409256">bytes</span><span class="op" id="4409261">,</span>&nbsp;<span class="num" id="4409263">0</span><span class="op" id="4409264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409267">if</span>&nbsp;<span class="ident" id="4409270">err</span>&nbsp;<span class="op" id="4409274">!=</span>&nbsp;<span class="ident" id="4409277">nil</span>&nbsp;<span class="op" id="4409281">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409285">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4409293">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409296">if</span>&nbsp;<span class="ident" id="4409299">v</span>&nbsp;<span class="op" id="4409301">&lt;</span>&nbsp;<span class="num" id="4409303">80</span>&nbsp;<span class="op" id="4409306">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4409310">s</span><span class="op" id="4409311">[</span><span class="num" id="4409312">0</span><span class="op" id="4409313">]</span>&nbsp;<span class="op" id="4409315">=</span>&nbsp;<span class="ident" id="4409317">v</span>&nbsp;<span class="op" id="4409319">/</span>&nbsp;<span class="num" id="4409321">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4409326">s</span><span class="op" id="4409327">[</span><span class="num" id="4409328">1</span><span class="op" id="4409329">]</span>&nbsp;<span class="op" id="4409331">=</span>&nbsp;<span class="ident" id="4409333">v</span>&nbsp;<span class="op" id="4409335">%</span>&nbsp;<span class="num" id="4409337">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4409341">}</span>&nbsp;<span class="keyword" id="4409343">else</span>&nbsp;<span class="op" id="4409348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4409352">s</span><span class="op" id="4409353">[</span><span class="num" id="4409354">0</span><span class="op" id="4409355">]</span>&nbsp;<span class="op" id="4409357">=</span>&nbsp;<span class="num" id="4409359">2</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4409363">s</span><span class="op" id="4409364">[</span><span class="num" id="4409365">1</span><span class="op" id="4409366">]</span>&nbsp;<span class="op" id="4409368">=</span>&nbsp;<span class="ident" id="4409370">v</span>&nbsp;<span class="op" id="4409372">-</span>&nbsp;<span class="num" id="4409374">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4409378">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4409382">i</span>&nbsp;<span class="op" id="4409384">:=</span>&nbsp;<span class="num" id="4409387">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409390">for</span>&nbsp;<span class="op" id="4409394">;</span>&nbsp;<span class="ident" id="4409396">offset</span>&nbsp;<span class="op" id="4409403">&lt;</span>&nbsp;<span class="builtinfunc" id="4409405">len</span><span class="op" id="4409408">(</span><span class="ident" id="4409409">bytes</span><span class="op" id="4409414">)</span><span class="op" id="4409415">;</span>&nbsp;<span class="ident" id="4409417">i</span><span class="op" id="4409418">++</span>&nbsp;<span class="op" id="4409421">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4409425">v</span><span class="op" id="4409426">,</span>&nbsp;<span class="ident" id="4409428">offset</span><span class="op" id="4409434">,</span>&nbsp;<span class="ident" id="4409436">err</span>&nbsp;<span class="op" id="4409440">=</span>&nbsp;<span class="ident" id="4409442">parseBase128Int</span><span class="op" id="4409457">(</span><span class="ident" id="4409458">bytes</span><span class="op" id="4409463">,</span>&nbsp;<span class="ident" id="4409465">offset</span><span class="op" id="4409471">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409475">if</span>&nbsp;<span class="ident" id="4409478">err</span>&nbsp;<span class="op" id="4409482">!=</span>&nbsp;<span class="ident" id="4409485">nil</span>&nbsp;<span class="op" id="4409489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409494">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4409503">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4409507">s</span><span class="op" id="4409508">[</span><span class="ident" id="4409509">i</span><span class="op" id="4409510">]</span>&nbsp;<span class="op" id="4409512">=</span>&nbsp;<span class="ident" id="4409514">v</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4409517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4409520">s</span>&nbsp;<span class="op" id="4409522">=</span>&nbsp;<span class="ident" id="4409524">s</span><span class="op" id="4409525">[</span><span class="num" id="4409526">0</span><span class="op" id="4409527">:</span><span class="ident" id="4409528">i</span><span class="op" id="4409529">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409532">return</span><br>
<span class="lineno"></span><span class="op" id="4409539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="4409542">//&nbsp;ENUMERATED</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4409557">//&nbsp;An&nbsp;Enumerated&nbsp;is&nbsp;represented&nbsp;as&nbsp;a&nbsp;plain&nbsp;int.</span><br>
<span class="lineno"></span><span class="keyword" id="4409605">type</span>&nbsp;<span class="ident" id="4409610">Enumerated</span>&nbsp;<span class="builtintype" id="4409621">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="4409626">//&nbsp;FLAG</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4409635">//&nbsp;A&nbsp;Flag&nbsp;accepts&nbsp;any&nbsp;data&nbsp;and&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="4409693">type</span>&nbsp;<span class="ident" id="4409698">Flag</span>&nbsp;<span class="builtintype" id="4409703">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="4409709">//&nbsp;parseBase128Int&nbsp;parses&nbsp;a&nbsp;base-128&nbsp;encoded&nbsp;int&nbsp;from&nbsp;the&nbsp;given&nbsp;offset&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4409787">//&nbsp;given&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;value&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.</span><br>
<span class="lineno"></span><span class="keyword" id="4409849">func</span>&nbsp;<span class="ident" id="4409854">parseBase128Int</span><span class="op" id="4409869">(</span><span class="ident" id="4409870">bytes</span>&nbsp;<span class="op" id="4409876">[</span><span class="op" id="4409877">]</span><span class="builtintype" id="4409878">byte</span><span class="op" id="4409882">,</span>&nbsp;<span class="ident" id="4409884">initOffset</span>&nbsp;<span class="builtintype" id="4409895">int</span><span class="op" id="4409898">)</span>&nbsp;<span class="op" id="4409900">(</span><span class="ident" id="4409901">ret</span><span class="op" id="4409904">,</span>&nbsp;<span class="ident" id="4409906">offset</span>&nbsp;<span class="builtintype" id="4409913">int</span><span class="op" id="4409916">,</span>&nbsp;<span class="ident" id="4409918">err</span>&nbsp;<span class="builtintype" id="4409922">error</span><span class="op" id="4409927">)</span>&nbsp;<span class="op" id="4409929">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4409932">offset</span>&nbsp;<span class="op" id="4409939">=</span>&nbsp;<span class="ident" id="4409941">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4409953">for</span>&nbsp;<span class="ident" id="4409957">shifted</span>&nbsp;<span class="op" id="4409965">:=</span>&nbsp;<span class="num" id="4409968">0</span><span class="op" id="4409969">;</span>&nbsp;<span class="ident" id="4409971">offset</span>&nbsp;<span class="op" id="4409978">&lt;</span>&nbsp;<span class="builtinfunc" id="4409980">len</span><span class="op" id="4409983">(</span><span class="ident" id="4409984">bytes</span><span class="op" id="4409989">)</span><span class="op" id="4409990">;</span>&nbsp;<span class="ident" id="4409992">shifted</span><span class="op" id="4409999">++</span>&nbsp;<span class="op" id="4410002">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4410006">if</span>&nbsp;<span class="ident" id="4410009">shifted</span>&nbsp;<span class="op" id="4410017">&gt;</span>&nbsp;<span class="num" id="4410019">4</span>&nbsp;<span class="op" id="4410021">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410026">err</span>&nbsp;<span class="op" id="4410030">=</span>&nbsp;<span class="ident" id="4410032">StructuralError</span><span class="op" id="4410047">{</span><span class="string" id="4410048">&#34;base&nbsp;128&nbsp;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4410076">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4410081">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4410090">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410094">ret</span>&nbsp;<span class="op" id="4410098">&lt;&lt;=</span>&nbsp;<span class="num" id="4410102">7</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410106">b</span>&nbsp;<span class="op" id="4410108">:=</span>&nbsp;<span class="ident" id="4410111">bytes</span><span class="op" id="4410116">[</span><span class="ident" id="4410117">offset</span><span class="op" id="4410123">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410127">ret</span>&nbsp;<span class="op" id="4410131">|=</span>&nbsp;<span class="builtintype" id="4410134">int</span><span class="op" id="4410137">(</span><span class="ident" id="4410138">b</span>&nbsp;<span class="op" id="4410140">&amp;</span>&nbsp;<span class="num" id="4410142">0x7f</span><span class="op" id="4410146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410150">offset</span><span class="op" id="4410156">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4410161">if</span>&nbsp;<span class="ident" id="4410164">b</span><span class="op" id="4410165">&amp;</span><span class="num" id="4410166">0x80</span>&nbsp;<span class="op" id="4410171">==</span>&nbsp;<span class="num" id="4410174">0</span>&nbsp;<span class="op" id="4410176">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4410181">return</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4410190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4410193">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410196">err</span>&nbsp;<span class="op" id="4410200">=</span>&nbsp;<span class="ident" id="4410202">SyntaxError</span><span class="op" id="4410213">{</span><span class="string" id="4410214">&#34;truncated&nbsp;base&nbsp;128&nbsp;integer&#34;</span><span class="op" id="4410242">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4410245">return</span><br>
<span class="lineno"></span><span class="op" id="4410252">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="4410255">//&nbsp;UTCTime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4410267">func</span>&nbsp;<span class="ident" id="4410272">parseUTCTime</span><span class="op" id="4410284">(</span><span class="ident" id="4410285">bytes</span>&nbsp;<span class="op" id="4410291">[</span><span class="op" id="4410292">]</span><span class="builtintype" id="4410293">byte</span><span class="op" id="4410297">)</span>&nbsp;<span class="op" id="4410299">(</span><span class="ident" id="4410300">ret</span>&nbsp;<span class="ident" id="4410304">time</span><span class="op" id="4410308">.</span><span class="ident" id="4410309">Time</span><span class="op" id="4410313">,</span>&nbsp;<span class="ident" id="4410315">err</span>&nbsp;<span class="builtintype" id="4410319">error</span><span class="op" id="4410324">)</span>&nbsp;<span class="op" id="4410326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410329">s</span>&nbsp;<span class="op" id="4410331">:=</span>&nbsp;<span class="builtintype" id="4410334">string</span><span class="op" id="4410340">(</span><span class="ident" id="4410341">bytes</span><span class="op" id="4410346">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410349">ret</span><span class="op" id="4410352">,</span>&nbsp;<span class="ident" id="4410354">err</span>&nbsp;<span class="op" id="4410358">=</span>&nbsp;<span class="ident" id="4410360">time</span><span class="op" id="4410364">.</span><span class="ident" id="4410365">Parse</span><span class="op" id="4410370">(</span><span class="string" id="4410371">&#34;0601021504Z0700&#34;</span><span class="op" id="4410388">,</span>&nbsp;<span class="ident" id="4410390">s</span><span class="op" id="4410391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4410394">if</span>&nbsp;<span class="ident" id="4410397">err</span>&nbsp;<span class="op" id="4410401">!=</span>&nbsp;<span class="ident" id="4410404">nil</span>&nbsp;<span class="op" id="4410408">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410412">ret</span><span class="op" id="4410415">,</span>&nbsp;<span class="ident" id="4410417">err</span>&nbsp;<span class="op" id="4410421">=</span>&nbsp;<span class="ident" id="4410423">time</span><span class="op" id="4410427">.</span><span class="ident" id="4410428">Parse</span><span class="op" id="4410433">(</span><span class="string" id="4410434">&#34;060102150405Z0700&#34;</span><span class="op" id="4410453">,</span>&nbsp;<span class="ident" id="4410455">s</span><span class="op" id="4410456">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4410459">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4410462">if</span>&nbsp;<span class="ident" id="4410465">err</span>&nbsp;<span class="op" id="4410469">==</span>&nbsp;<span class="ident" id="4410472">nil</span>&nbsp;<span class="op" id="4410476">&amp;&amp;</span>&nbsp;<span class="ident" id="4410479">ret</span><span class="op" id="4410482">.</span><span class="ident" id="4410483">Year</span><span class="op" id="4410487">(</span><span class="op" id="4410488">)</span>&nbsp;<span class="op" id="4410490">&gt;=</span>&nbsp;<span class="num" id="4410493">2050</span>&nbsp;<span class="op" id="4410498">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4410502">//&nbsp;UTCTime&nbsp;only&nbsp;encodes&nbsp;times&nbsp;prior&nbsp;to&nbsp;2050.&nbsp;See&nbsp;https://tools.ietf.org/html/rfc5280#section-4.1.2.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4410607">ret</span>&nbsp;<span class="op" id="4410611">=</span>&nbsp;<span class="ident" id="4410613">ret</span><span class="op" id="4410616">.</span><span class="ident" id="4410617">AddDate</span><span class="op" id="4410624">(</span><span class="op" id="4410625">-</span><span class="num" id="4410626">100</span><span class="op" id="4410629">,</span>&nbsp;<span class="num" id="4410631">0</span><span class="op" id="4410632">,</span>&nbsp;<span class="num" id="4410634">0</span><span class="op" id="4410635">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4410638">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4410642">return</span><br>
<span class="lineno">300</span><span class="op" id="4410649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4410652">//&nbsp;parseGeneralizedTime&nbsp;parses&nbsp;the&nbsp;GeneralizedTime&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="4410729">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4410764">func</span>&nbsp;<span class="ident" id="4410769">parseGeneralizedTime</span><span class="op" id="4410789">(</span><span class="ident" id="4410790">bytes</span>&nbsp;<span class="op" id="4410796">[</span><span class="op" id="4410797">]</span><span class="builtintype" id="4410798">byte</span><span class="op" id="4410802">)</span>&nbsp;<span class="op" id="4410804">(</span><span class="ident" id="4410805">ret</span>&nbsp;<span class="ident" id="4410809">time</span><span class="op" id="4410813">.</span><span class="ident" id="4410814">Time</span><span class="op" id="4410818">,</span>&nbsp;<span class="ident" id="4410820">err</span>&nbsp;<span class="builtintype" id="4410824">error</span><span class="op" id="4410829">)</span>&nbsp;<span class="op" id="4410831">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4410834">return</span>&nbsp;<span class="ident" id="4410841">time</span><span class="op" id="4410845">.</span><span class="ident" id="4410846">Parse</span><span class="op" id="4410851">(</span><span class="string" id="4410852">&#34;20060102150405Z0700&#34;</span><span class="op" id="4410873">,</span>&nbsp;<span class="builtintype" id="4410875">string</span><span class="op" id="4410881">(</span><span class="ident" id="4410882">bytes</span><span class="op" id="4410887">)</span><span class="op" id="4410888">)</span><br>
<span class="lineno"></span><span class="op" id="4410890">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4410893">//&nbsp;PrintableString</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4410913">//&nbsp;parsePrintableString&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;PrintableString&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4410988">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4411013">func</span>&nbsp;<span class="ident" id="4411018">parsePrintableString</span><span class="op" id="4411038">(</span><span class="ident" id="4411039">bytes</span>&nbsp;<span class="op" id="4411045">[</span><span class="op" id="4411046">]</span><span class="builtintype" id="4411047">byte</span><span class="op" id="4411051">)</span>&nbsp;<span class="op" id="4411053">(</span><span class="ident" id="4411054">ret</span>&nbsp;<span class="builtintype" id="4411058">string</span><span class="op" id="4411064">,</span>&nbsp;<span class="ident" id="4411066">err</span>&nbsp;<span class="builtintype" id="4411070">error</span><span class="op" id="4411075">)</span>&nbsp;<span class="op" id="4411077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4411080">for</span>&nbsp;<span class="ident" id="4411084">_</span><span class="op" id="4411085">,</span>&nbsp;<span class="ident" id="4411087">b</span>&nbsp;<span class="op" id="4411089">:=</span>&nbsp;<span class="keyword" id="4411092">range</span>&nbsp;<span class="ident" id="4411098">bytes</span>&nbsp;<span class="op" id="4411104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4411108">if</span>&nbsp;<span class="op" id="4411111">!</span><span class="ident" id="4411112">isPrintable</span><span class="op" id="4411123">(</span><span class="ident" id="4411124">b</span><span class="op" id="4411125">)</span>&nbsp;<span class="op" id="4411127">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4411132">err</span>&nbsp;<span class="op" id="4411136">=</span>&nbsp;<span class="ident" id="4411138">SyntaxError</span><span class="op" id="4411149">{</span><span class="string" id="4411150">&#34;PrintableString&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4411194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4411199">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4411208">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4411211">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4411214">ret</span>&nbsp;<span class="op" id="4411218">=</span>&nbsp;<span class="builtintype" id="4411220">string</span><span class="op" id="4411226">(</span><span class="ident" id="4411227">bytes</span><span class="op" id="4411232">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4411235">return</span><br>
<span class="lineno"></span><span class="op" id="4411242">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4411245">//&nbsp;isPrintable&nbsp;returns&nbsp;true&nbsp;iff&nbsp;the&nbsp;given&nbsp;b&nbsp;is&nbsp;in&nbsp;the&nbsp;ASN.1&nbsp;PrintableString&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="4411326">func</span>&nbsp;<span class="ident" id="4411331">isPrintable</span><span class="op" id="4411342">(</span><span class="ident" id="4411343">b</span>&nbsp;<span class="builtintype" id="4411345">byte</span><span class="op" id="4411349">)</span>&nbsp;<span class="builtintype" id="4411351">bool</span>&nbsp;<span class="op" id="4411356">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4411359">return</span>&nbsp;<span class="string" id="4411366">&#39;a&#39;</span>&nbsp;<span class="op" id="4411370">&lt;=</span>&nbsp;<span class="ident" id="4411373">b</span>&nbsp;<span class="op" id="4411375">&amp;&amp;</span>&nbsp;<span class="ident" id="4411378">b</span>&nbsp;<span class="op" id="4411380">&lt;=</span>&nbsp;<span class="string" id="4411383">&#39;z&#39;</span>&nbsp;<span class="op" id="4411387">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4411392">&#39;A&#39;</span>&nbsp;<span class="op" id="4411396">&lt;=</span>&nbsp;<span class="ident" id="4411399">b</span>&nbsp;<span class="op" id="4411401">&amp;&amp;</span>&nbsp;<span class="ident" id="4411404">b</span>&nbsp;<span class="op" id="4411406">&lt;=</span>&nbsp;<span class="string" id="4411409">&#39;Z&#39;</span>&nbsp;<span class="op" id="4411413">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4411418">&#39;0&#39;</span>&nbsp;<span class="op" id="4411422">&lt;=</span>&nbsp;<span class="ident" id="4411425">b</span>&nbsp;<span class="op" id="4411427">&amp;&amp;</span>&nbsp;<span class="ident" id="4411430">b</span>&nbsp;<span class="op" id="4411432">&lt;=</span>&nbsp;<span class="string" id="4411435">&#39;9&#39;</span>&nbsp;<span class="op" id="4411439">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4411444">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="4411449">&lt;=</span>&nbsp;<span class="ident" id="4411452">b</span>&nbsp;<span class="op" id="4411454">&amp;&amp;</span>&nbsp;<span class="ident" id="4411457">b</span>&nbsp;<span class="op" id="4411459">&lt;=</span>&nbsp;<span class="string" id="4411462">&#39;)&#39;</span>&nbsp;<span class="op" id="4411466">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4411471">&#39;+&#39;</span>&nbsp;<span class="op" id="4411475">&lt;=</span>&nbsp;<span class="ident" id="4411478">b</span>&nbsp;<span class="op" id="4411480">&amp;&amp;</span>&nbsp;<span class="ident" id="4411483">b</span>&nbsp;<span class="op" id="4411485">&lt;=</span>&nbsp;<span class="string" id="4411488">&#39;/&#39;</span>&nbsp;<span class="op" id="4411492">||</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4411497">b</span>&nbsp;<span class="op" id="4411499">==</span>&nbsp;<span class="string" id="4411502">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4411506">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4411511">b</span>&nbsp;<span class="op" id="4411513">==</span>&nbsp;<span class="string" id="4411516">&#39;:&#39;</span>&nbsp;<span class="op" id="4411520">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4411525">b</span>&nbsp;<span class="op" id="4411527">==</span>&nbsp;<span class="string" id="4411530">&#39;=&#39;</span>&nbsp;<span class="op" id="4411534">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4411539">b</span>&nbsp;<span class="op" id="4411541">==</span>&nbsp;<span class="string" id="4411544">&#39;?&#39;</span>&nbsp;<span class="op" id="4411548">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4411553">//&nbsp;This&nbsp;is&nbsp;technically&nbsp;not&nbsp;allowed&nbsp;in&nbsp;a&nbsp;PrintableString.</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4411612">//&nbsp;However,&nbsp;x509&nbsp;certificates&nbsp;with&nbsp;wildcard&nbsp;strings&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4411672">//&nbsp;always&nbsp;use&nbsp;the&nbsp;correct&nbsp;string&nbsp;type&nbsp;so&nbsp;we&nbsp;permit&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4411729">b</span>&nbsp;<span class="op" id="4411731">==</span>&nbsp;<span class="string" id="4411734">&#39;*&#39;</span><br>
<span class="lineno"></span><span class="op" id="4411738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="4411741">//&nbsp;IA5String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4411755">//&nbsp;parseIA5String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;IA5String&nbsp;(ASCII&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4411828">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4411858">func</span>&nbsp;<span class="ident" id="4411863">parseIA5String</span><span class="op" id="4411877">(</span><span class="ident" id="4411878">bytes</span>&nbsp;<span class="op" id="4411884">[</span><span class="op" id="4411885">]</span><span class="builtintype" id="4411886">byte</span><span class="op" id="4411890">)</span>&nbsp;<span class="op" id="4411892">(</span><span class="ident" id="4411893">ret</span>&nbsp;<span class="builtintype" id="4411897">string</span><span class="op" id="4411903">,</span>&nbsp;<span class="ident" id="4411905">err</span>&nbsp;<span class="builtintype" id="4411909">error</span><span class="op" id="4411914">)</span>&nbsp;<span class="op" id="4411916">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4411919">for</span>&nbsp;<span class="ident" id="4411923">_</span><span class="op" id="4411924">,</span>&nbsp;<span class="ident" id="4411926">b</span>&nbsp;<span class="op" id="4411928">:=</span>&nbsp;<span class="keyword" id="4411931">range</span>&nbsp;<span class="ident" id="4411937">bytes</span>&nbsp;<span class="op" id="4411943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4411947">if</span>&nbsp;<span class="ident" id="4411950">b</span>&nbsp;<span class="op" id="4411952">&gt;=</span>&nbsp;<span class="num" id="4411955">0x80</span>&nbsp;<span class="op" id="4411960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4411965">err</span>&nbsp;<span class="op" id="4411969">=</span>&nbsp;<span class="ident" id="4411971">SyntaxError</span><span class="op" id="4411982">{</span><span class="string" id="4411983">&#34;IA5String&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4412021">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412026">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4412035">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4412038">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412041">ret</span>&nbsp;<span class="op" id="4412045">=</span>&nbsp;<span class="builtintype" id="4412047">string</span><span class="op" id="4412053">(</span><span class="ident" id="4412054">bytes</span><span class="op" id="4412059">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412062">return</span><br>
<span class="lineno"></span><span class="op" id="4412069">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="4412072">//&nbsp;T61String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4412086">//&nbsp;parseT61String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;T61String&nbsp;(8-bit&nbsp;clean&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4412165">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4412195">func</span>&nbsp;<span class="ident" id="4412200">parseT61String</span><span class="op" id="4412214">(</span><span class="ident" id="4412215">bytes</span>&nbsp;<span class="op" id="4412221">[</span><span class="op" id="4412222">]</span><span class="builtintype" id="4412223">byte</span><span class="op" id="4412227">)</span>&nbsp;<span class="op" id="4412229">(</span><span class="ident" id="4412230">ret</span>&nbsp;<span class="builtintype" id="4412234">string</span><span class="op" id="4412240">,</span>&nbsp;<span class="ident" id="4412242">err</span>&nbsp;<span class="builtintype" id="4412246">error</span><span class="op" id="4412251">)</span>&nbsp;<span class="op" id="4412253">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412256">return</span>&nbsp;<span class="builtintype" id="4412263">string</span><span class="op" id="4412269">(</span><span class="ident" id="4412270">bytes</span><span class="op" id="4412275">)</span><span class="op" id="4412276">,</span>&nbsp;<span class="ident" id="4412278">nil</span><br>
<span class="lineno"></span><span class="op" id="4412282">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4412285">//&nbsp;UTF8String</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="4412300">//&nbsp;parseUTF8String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;UTF8String&nbsp;(raw&nbsp;UTF-8)&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4412377">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4412402">func</span>&nbsp;<span class="ident" id="4412407">parseUTF8String</span><span class="op" id="4412422">(</span><span class="ident" id="4412423">bytes</span>&nbsp;<span class="op" id="4412429">[</span><span class="op" id="4412430">]</span><span class="builtintype" id="4412431">byte</span><span class="op" id="4412435">)</span>&nbsp;<span class="op" id="4412437">(</span><span class="ident" id="4412438">ret</span>&nbsp;<span class="builtintype" id="4412442">string</span><span class="op" id="4412448">,</span>&nbsp;<span class="ident" id="4412450">err</span>&nbsp;<span class="builtintype" id="4412454">error</span><span class="op" id="4412459">)</span>&nbsp;<span class="op" id="4412461">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4412464">return</span>&nbsp;<span class="builtintype" id="4412471">string</span><span class="op" id="4412477">(</span><span class="ident" id="4412478">bytes</span><span class="op" id="4412483">)</span><span class="op" id="4412484">,</span>&nbsp;<span class="ident" id="4412486">nil</span><br>
<span class="lineno"></span><span class="op" id="4412490">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="4412493">//&nbsp;A&nbsp;RawValue&nbsp;represents&nbsp;an&nbsp;undecoded&nbsp;ASN.1&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="4412545">type</span>&nbsp;<span class="ident" id="4412550">RawValue</span>&nbsp;<span class="keyword" id="4412559">struct</span>&nbsp;<span class="op" id="4412566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412569">Class</span><span class="op" id="4412574">,</span>&nbsp;<span class="ident" id="4412576">Tag</span>&nbsp;<span class="builtintype" id="4412580">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412585">IsCompound</span>&nbsp;<span class="builtintype" id="4412596">bool</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412602">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4412613">[</span><span class="op" id="4412614">]</span><span class="builtintype" id="4412615">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4412621">FullBytes</span>&nbsp;&nbsp;<span class="op" id="4412632">[</span><span class="op" id="4412633">]</span><span class="builtintype" id="4412634">byte</span>&nbsp;<span class="comment" id="4412639">//&nbsp;includes&nbsp;the&nbsp;tag&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span><span class="op" id="4412670">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4412673">//&nbsp;RawContent&nbsp;is&nbsp;used&nbsp;to&nbsp;signal&nbsp;that&nbsp;the&nbsp;undecoded,&nbsp;DER&nbsp;data&nbsp;needs&nbsp;to&nbsp;be</span><br>
<span class="lineno">380</span><span class="comment" id="4412746">//&nbsp;preserved&nbsp;for&nbsp;a&nbsp;struct.&nbsp;To&nbsp;use&nbsp;it,&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;the&nbsp;struct&nbsp;must&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="4412824">//&nbsp;this&nbsp;type.&nbsp;It&#39;s&nbsp;an&nbsp;error&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;fields&nbsp;to&nbsp;have&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4412899">type</span>&nbsp;<span class="ident" id="4412904">RawContent</span>&nbsp;<span class="op" id="4412915">[</span><span class="op" id="4412916">]</span><span class="builtintype" id="4412917">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4412923">//&nbsp;Tagging</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="comment" id="4412935">//&nbsp;parseTagAndLength&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;tag&nbsp;and&nbsp;length&nbsp;pair&nbsp;from&nbsp;the&nbsp;given&nbsp;offset</span><br>
<span class="lineno"></span><span class="comment" id="4413014">//&nbsp;into&nbsp;a&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;parsed&nbsp;data&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.&nbsp;SET&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4413091">//&nbsp;SET&nbsp;OF&nbsp;(tag&nbsp;17)&nbsp;are&nbsp;mapped&nbsp;to&nbsp;SEQUENCE&nbsp;and&nbsp;SEQUENCE&nbsp;OF&nbsp;(tag&nbsp;16)&nbsp;since&nbsp;we</span><br>
<span class="lineno"></span><span class="comment" id="4413167">//&nbsp;don&#39;t&nbsp;distinguish&nbsp;between&nbsp;ordered&nbsp;and&nbsp;unordered&nbsp;objects&nbsp;in&nbsp;this&nbsp;code.</span><br>
<span class="lineno">390</span><span class="keyword" id="4413240">func</span>&nbsp;<span class="ident" id="4413245">parseTagAndLength</span><span class="op" id="4413262">(</span><span class="ident" id="4413263">bytes</span>&nbsp;<span class="op" id="4413269">[</span><span class="op" id="4413270">]</span><span class="builtintype" id="4413271">byte</span><span class="op" id="4413275">,</span>&nbsp;<span class="ident" id="4413277">initOffset</span>&nbsp;<span class="builtintype" id="4413288">int</span><span class="op" id="4413291">)</span>&nbsp;<span class="op" id="4413293">(</span><span class="ident" id="4413294">ret</span>&nbsp;<span class="ident" id="4413298">tagAndLength</span><span class="op" id="4413310">,</span>&nbsp;<span class="ident" id="4413312">offset</span>&nbsp;<span class="builtintype" id="4413319">int</span><span class="op" id="4413322">,</span>&nbsp;<span class="ident" id="4413324">err</span>&nbsp;<span class="builtintype" id="4413328">error</span><span class="op" id="4413333">)</span>&nbsp;<span class="op" id="4413335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413338">offset</span>&nbsp;<span class="op" id="4413345">=</span>&nbsp;<span class="ident" id="4413347">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413359">b</span>&nbsp;<span class="op" id="4413361">:=</span>&nbsp;<span class="ident" id="4413364">bytes</span><span class="op" id="4413369">[</span><span class="ident" id="4413370">offset</span><span class="op" id="4413376">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413379">offset</span><span class="op" id="4413385">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413389">ret</span><span class="op" id="4413392">.</span><span class="ident" id="4413393">class</span>&nbsp;<span class="op" id="4413399">=</span>&nbsp;<span class="builtintype" id="4413401">int</span><span class="op" id="4413404">(</span><span class="ident" id="4413405">b</span>&nbsp;<span class="op" id="4413407">&gt;&gt;</span>&nbsp;<span class="num" id="4413410">6</span><span class="op" id="4413411">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413414">ret</span><span class="op" id="4413417">.</span><span class="ident" id="4413418">isCompound</span>&nbsp;<span class="op" id="4413429">=</span>&nbsp;<span class="ident" id="4413431">b</span><span class="op" id="4413432">&amp;</span><span class="num" id="4413433">0x20</span>&nbsp;<span class="op" id="4413438">==</span>&nbsp;<span class="num" id="4413441">0x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413447">ret</span><span class="op" id="4413450">.</span><span class="ident" id="4413451">tag</span>&nbsp;<span class="op" id="4413455">=</span>&nbsp;<span class="builtintype" id="4413457">int</span><span class="op" id="4413460">(</span><span class="ident" id="4413461">b</span>&nbsp;<span class="op" id="4413463">&amp;</span>&nbsp;<span class="num" id="4413465">0x1f</span><span class="op" id="4413469">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4413473">//&nbsp;If&nbsp;the&nbsp;bottom&nbsp;five&nbsp;bits&nbsp;are&nbsp;set,&nbsp;then&nbsp;the&nbsp;tag&nbsp;number&nbsp;is&nbsp;actually&nbsp;base&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4413551">//&nbsp;encoded&nbsp;afterwards</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413574">if</span>&nbsp;<span class="ident" id="4413577">ret</span><span class="op" id="4413580">.</span><span class="ident" id="4413581">tag</span>&nbsp;<span class="op" id="4413585">==</span>&nbsp;<span class="num" id="4413588">0x1f</span>&nbsp;<span class="op" id="4413593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413597">ret</span><span class="op" id="4413600">.</span><span class="ident" id="4413601">tag</span><span class="op" id="4413604">,</span>&nbsp;<span class="ident" id="4413606">offset</span><span class="op" id="4413612">,</span>&nbsp;<span class="ident" id="4413614">err</span>&nbsp;<span class="op" id="4413618">=</span>&nbsp;<span class="ident" id="4413620">parseBase128Int</span><span class="op" id="4413635">(</span><span class="ident" id="4413636">bytes</span><span class="op" id="4413641">,</span>&nbsp;<span class="ident" id="4413643">offset</span><span class="op" id="4413649">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413653">if</span>&nbsp;<span class="ident" id="4413656">err</span>&nbsp;<span class="op" id="4413660">!=</span>&nbsp;<span class="ident" id="4413663">nil</span>&nbsp;<span class="op" id="4413667">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413672">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413681">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413684">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413687">if</span>&nbsp;<span class="ident" id="4413690">offset</span>&nbsp;<span class="op" id="4413697">&gt;=</span>&nbsp;<span class="builtinfunc" id="4413700">len</span><span class="op" id="4413703">(</span><span class="ident" id="4413704">bytes</span><span class="op" id="4413709">)</span>&nbsp;<span class="op" id="4413711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413715">err</span>&nbsp;<span class="op" id="4413719">=</span>&nbsp;<span class="ident" id="4413721">SyntaxError</span><span class="op" id="4413732">{</span><span class="string" id="4413733">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4413758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413762">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413770">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413773">b</span>&nbsp;<span class="op" id="4413775">=</span>&nbsp;<span class="ident" id="4413777">bytes</span><span class="op" id="4413782">[</span><span class="ident" id="4413783">offset</span><span class="op" id="4413789">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413792">offset</span><span class="op" id="4413798">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413802">if</span>&nbsp;<span class="ident" id="4413805">b</span><span class="op" id="4413806">&amp;</span><span class="num" id="4413807">0x80</span>&nbsp;<span class="op" id="4413812">==</span>&nbsp;<span class="num" id="4413815">0</span>&nbsp;<span class="op" id="4413817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4413821">//&nbsp;The&nbsp;length&nbsp;is&nbsp;encoded&nbsp;in&nbsp;the&nbsp;bottom&nbsp;7&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413870">ret</span><span class="op" id="4413873">.</span><span class="ident" id="4413874">length</span>&nbsp;<span class="op" id="4413881">=</span>&nbsp;<span class="builtintype" id="4413883">int</span><span class="op" id="4413886">(</span><span class="ident" id="4413887">b</span>&nbsp;<span class="op" id="4413889">&amp;</span>&nbsp;<span class="num" id="4413891">0x7f</span><span class="op" id="4413895">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4413898">}</span>&nbsp;<span class="keyword" id="4413900">else</span>&nbsp;<span class="op" id="4413905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4413909">//&nbsp;Bottom&nbsp;7&nbsp;bits&nbsp;give&nbsp;the&nbsp;number&nbsp;of&nbsp;length&nbsp;bytes&nbsp;to&nbsp;follow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4413971">numBytes</span>&nbsp;<span class="op" id="4413980">:=</span>&nbsp;<span class="builtintype" id="4413983">int</span><span class="op" id="4413986">(</span><span class="ident" id="4413987">b</span>&nbsp;<span class="op" id="4413989">&amp;</span>&nbsp;<span class="num" id="4413991">0x7f</span><span class="op" id="4413995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4413999">if</span>&nbsp;<span class="ident" id="4414002">numBytes</span>&nbsp;<span class="op" id="4414011">==</span>&nbsp;<span class="num" id="4414014">0</span>&nbsp;<span class="op" id="4414016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414021">err</span>&nbsp;<span class="op" id="4414025">=</span>&nbsp;<span class="ident" id="4414027">SyntaxError</span><span class="op" id="4414038">{</span><span class="string" id="4414039">&#34;indefinite&nbsp;length&nbsp;found&nbsp;(not&nbsp;DER)&#34;</span><span class="op" id="4414074">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414079">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4414088">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414092">ret</span><span class="op" id="4414095">.</span><span class="ident" id="4414096">length</span>&nbsp;<span class="op" id="4414103">=</span>&nbsp;<span class="num" id="4414105">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414109">for</span>&nbsp;<span class="ident" id="4414113">i</span>&nbsp;<span class="op" id="4414115">:=</span>&nbsp;<span class="num" id="4414118">0</span><span class="op" id="4414119">;</span>&nbsp;<span class="ident" id="4414121">i</span>&nbsp;<span class="op" id="4414123">&lt;</span>&nbsp;<span class="ident" id="4414125">numBytes</span><span class="op" id="4414133">;</span>&nbsp;<span class="ident" id="4414135">i</span><span class="op" id="4414136">++</span>&nbsp;<span class="op" id="4414139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414144">if</span>&nbsp;<span class="ident" id="4414147">offset</span>&nbsp;<span class="op" id="4414154">&gt;=</span>&nbsp;<span class="builtinfunc" id="4414157">len</span><span class="op" id="4414160">(</span><span class="ident" id="4414161">bytes</span><span class="op" id="4414166">)</span>&nbsp;<span class="op" id="4414168">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414174">err</span>&nbsp;<span class="op" id="4414178">=</span>&nbsp;<span class="ident" id="4414180">SyntaxError</span><span class="op" id="4414191">{</span><span class="string" id="4414192">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4414217">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414223">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4414233">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414238">b</span>&nbsp;<span class="op" id="4414240">=</span>&nbsp;<span class="ident" id="4414242">bytes</span><span class="op" id="4414247">[</span><span class="ident" id="4414248">offset</span><span class="op" id="4414254">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414259">offset</span><span class="op" id="4414265">++</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414271">if</span>&nbsp;<span class="ident" id="4414274">ret</span><span class="op" id="4414277">.</span><span class="ident" id="4414278">length</span>&nbsp;<span class="op" id="4414285">&gt;=</span>&nbsp;<span class="num" id="4414288">1</span><span class="op" id="4414289">&lt;&lt;</span><span class="num" id="4414291">23</span>&nbsp;<span class="op" id="4414294">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4414300">//&nbsp;We&nbsp;can&#39;t&nbsp;shift&nbsp;ret.length&nbsp;up&nbsp;without</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4414344">//&nbsp;overflowing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414364">err</span>&nbsp;<span class="op" id="4414368">=</span>&nbsp;<span class="ident" id="4414370">StructuralError</span><span class="op" id="4414385">{</span><span class="string" id="4414386">&#34;length&nbsp;too&nbsp;large&#34;</span><span class="op" id="4414404">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414410">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4414420">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414425">ret</span><span class="op" id="4414428">.</span><span class="ident" id="4414429">length</span>&nbsp;<span class="op" id="4414436">&lt;&lt;=</span>&nbsp;<span class="num" id="4414440">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414445">ret</span><span class="op" id="4414448">.</span><span class="ident" id="4414449">length</span>&nbsp;<span class="op" id="4414456">|=</span>&nbsp;<span class="builtintype" id="4414459">int</span><span class="op" id="4414462">(</span><span class="ident" id="4414463">b</span><span class="op" id="4414464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414469">if</span>&nbsp;<span class="ident" id="4414472">ret</span><span class="op" id="4414475">.</span><span class="ident" id="4414476">length</span>&nbsp;<span class="op" id="4414483">==</span>&nbsp;<span class="num" id="4414486">0</span>&nbsp;<span class="op" id="4414488">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4414494">//&nbsp;DER&nbsp;requires&nbsp;that&nbsp;lengths&nbsp;be&nbsp;minimal.</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414539">err</span>&nbsp;<span class="op" id="4414543">=</span>&nbsp;<span class="ident" id="4414545">StructuralError</span><span class="op" id="4414560">{</span><span class="string" id="4414561">&#34;superfluous&nbsp;leading&nbsp;zeros&nbsp;in&nbsp;length&#34;</span><span class="op" id="4414598">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414604">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4414614">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4414618">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4414621">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4414625">return</span><br>
<span class="lineno"></span><span class="op" id="4414632">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4414635">//&nbsp;parseSequenceOf&nbsp;is&nbsp;used&nbsp;for&nbsp;SEQUENCE&nbsp;OF&nbsp;and&nbsp;SET&nbsp;OF&nbsp;values.&nbsp;It&nbsp;tries&nbsp;to&nbsp;parse</span><br>
<span class="lineno">450</span><span class="comment" id="4414715">//&nbsp;a&nbsp;number&nbsp;of&nbsp;ASN.1&nbsp;values&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;them&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4414791">//&nbsp;slice&nbsp;of&nbsp;Go&nbsp;values&nbsp;of&nbsp;the&nbsp;given&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4414832">func</span>&nbsp;<span class="ident" id="4414837">parseSequenceOf</span><span class="op" id="4414852">(</span><span class="ident" id="4414853">bytes</span>&nbsp;<span class="op" id="4414859">[</span><span class="op" id="4414860">]</span><span class="builtintype" id="4414861">byte</span><span class="op" id="4414865">,</span>&nbsp;<span class="ident" id="4414867">sliceType</span>&nbsp;<span class="ident" id="4414877">reflect</span><span class="op" id="4414884">.</span><span class="ident" id="4414885">Type</span><span class="op" id="4414889">,</span>&nbsp;<span class="ident" id="4414891">elemType</span>&nbsp;<span class="ident" id="4414900">reflect</span><span class="op" id="4414907">.</span><span class="ident" id="4414908">Type</span><span class="op" id="4414912">)</span>&nbsp;<span class="op" id="4414914">(</span><span class="ident" id="4414915">ret</span>&nbsp;<span class="ident" id="4414919">reflect</span><span class="op" id="4414926">.</span><span class="ident" id="4414927">Value</span><span class="op" id="4414932">,</span>&nbsp;<span class="ident" id="4414934">err</span>&nbsp;<span class="builtintype" id="4414938">error</span><span class="op" id="4414943">)</span>&nbsp;<span class="op" id="4414945">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4414948">expectedTag</span><span class="op" id="4414959">,</span>&nbsp;<span class="ident" id="4414961">compoundType</span><span class="op" id="4414973">,</span>&nbsp;<span class="ident" id="4414975">ok</span>&nbsp;<span class="op" id="4414978">:=</span>&nbsp;<span class="ident" id="4414981">getUniversalType</span><span class="op" id="4414997">(</span><span class="ident" id="4414998">elemType</span><span class="op" id="4415006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415009">if</span>&nbsp;<span class="op" id="4415012">!</span><span class="ident" id="4415013">ok</span>&nbsp;<span class="op" id="4415016">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4415020">err</span>&nbsp;<span class="op" id="4415024">=</span>&nbsp;<span class="ident" id="4415026">StructuralError</span><span class="op" id="4415041">{</span><span class="string" id="4415042">&#34;unknown&nbsp;Go&nbsp;type&nbsp;for&nbsp;slice&#34;</span><span class="op" id="4415069">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415073">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4415081">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4415085">//&nbsp;First&nbsp;we&nbsp;iterate&nbsp;over&nbsp;the&nbsp;input&nbsp;and&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;elements,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4415155">//&nbsp;checking&nbsp;that&nbsp;the&nbsp;types&nbsp;are&nbsp;correct&nbsp;in&nbsp;each&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4415209">numElements</span>&nbsp;<span class="op" id="4415221">:=</span>&nbsp;<span class="num" id="4415224">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415227">for</span>&nbsp;<span class="ident" id="4415231">offset</span>&nbsp;<span class="op" id="4415238">:=</span>&nbsp;<span class="num" id="4415241">0</span><span class="op" id="4415242">;</span>&nbsp;<span class="ident" id="4415244">offset</span>&nbsp;<span class="op" id="4415251">&lt;</span>&nbsp;<span class="builtinfunc" id="4415253">len</span><span class="op" id="4415256">(</span><span class="ident" id="4415257">bytes</span><span class="op" id="4415262">)</span><span class="op" id="4415263">;</span>&nbsp;<span class="op" id="4415265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415269">var</span>&nbsp;<span class="ident" id="4415273">t</span>&nbsp;<span class="ident" id="4415275">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4415290">t</span><span class="op" id="4415291">,</span>&nbsp;<span class="ident" id="4415293">offset</span><span class="op" id="4415299">,</span>&nbsp;<span class="ident" id="4415301">err</span>&nbsp;<span class="op" id="4415305">=</span>&nbsp;<span class="ident" id="4415307">parseTagAndLength</span><span class="op" id="4415324">(</span><span class="ident" id="4415325">bytes</span><span class="op" id="4415330">,</span>&nbsp;<span class="ident" id="4415332">offset</span><span class="op" id="4415338">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415342">if</span>&nbsp;<span class="ident" id="4415345">err</span>&nbsp;<span class="op" id="4415349">!=</span>&nbsp;<span class="ident" id="4415352">nil</span>&nbsp;<span class="op" id="4415356">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415361">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4415370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415374">switch</span>&nbsp;<span class="ident" id="4415381">t</span><span class="op" id="4415382">.</span><span class="ident" id="4415383">tag</span>&nbsp;<span class="op" id="4415387">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415391">case</span>&nbsp;<span class="ident" id="4415396">tagIA5String</span><span class="op" id="4415408">,</span>&nbsp;<span class="ident" id="4415410">tagGeneralString</span><span class="op" id="4415426">,</span>&nbsp;<span class="ident" id="4415428">tagT61String</span><span class="op" id="4415440">,</span>&nbsp;<span class="ident" id="4415442">tagUTF8String</span><span class="op" id="4415455">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4415460">//&nbsp;We&nbsp;pretend&nbsp;that&nbsp;various&nbsp;other&nbsp;string&nbsp;types&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4415513">//&nbsp;PRINTABLE&nbsp;STRINGs&nbsp;so&nbsp;that&nbsp;a&nbsp;sequence&nbsp;of&nbsp;them&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4415571">//&nbsp;parsed&nbsp;into&nbsp;a&nbsp;[]string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4415601">t</span><span class="op" id="4415602">.</span><span class="ident" id="4415603">tag</span>&nbsp;<span class="op" id="4415607">=</span>&nbsp;<span class="ident" id="4415609">tagPrintableString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415630">case</span>&nbsp;<span class="ident" id="4415635">tagGeneralizedTime</span><span class="op" id="4415653">,</span>&nbsp;<span class="ident" id="4415655">tagUTCTime</span><span class="op" id="4415665">:</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4415670">//&nbsp;Likewise,&nbsp;both&nbsp;time&nbsp;types&nbsp;are&nbsp;treated&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4415724">t</span><span class="op" id="4415725">.</span><span class="ident" id="4415726">tag</span>&nbsp;<span class="op" id="4415730">=</span>&nbsp;<span class="ident" id="4415732">tagUTCTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4415745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415750">if</span>&nbsp;<span class="ident" id="4415753">t</span><span class="op" id="4415754">.</span><span class="ident" id="4415755">class</span>&nbsp;<span class="op" id="4415761">!=</span>&nbsp;<span class="ident" id="4415764">classUniversal</span>&nbsp;<span class="op" id="4415779">||</span>&nbsp;<span class="ident" id="4415782">t</span><span class="op" id="4415783">.</span><span class="ident" id="4415784">isCompound</span>&nbsp;<span class="op" id="4415795">!=</span>&nbsp;<span class="ident" id="4415798">compoundType</span>&nbsp;<span class="op" id="4415811">||</span>&nbsp;<span class="ident" id="4415814">t</span><span class="op" id="4415815">.</span><span class="ident" id="4415816">tag</span>&nbsp;<span class="op" id="4415820">!=</span>&nbsp;<span class="ident" id="4415823">expectedTag</span>&nbsp;<span class="op" id="4415835">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4415840">err</span>&nbsp;<span class="op" id="4415844">=</span>&nbsp;<span class="ident" id="4415846">StructuralError</span><span class="op" id="4415861">{</span><span class="string" id="4415862">&#34;sequence&nbsp;tag&nbsp;mismatch&#34;</span><span class="op" id="4415885">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415890">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4415899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415903">if</span>&nbsp;<span class="ident" id="4415906">invalidLength</span><span class="op" id="4415919">(</span><span class="ident" id="4415920">offset</span><span class="op" id="4415926">,</span>&nbsp;<span class="ident" id="4415928">t</span><span class="op" id="4415929">.</span><span class="ident" id="4415930">length</span><span class="op" id="4415936">,</span>&nbsp;<span class="builtinfunc" id="4415938">len</span><span class="op" id="4415941">(</span><span class="ident" id="4415942">bytes</span><span class="op" id="4415947">)</span><span class="op" id="4415948">)</span>&nbsp;<span class="op" id="4415950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4415955">err</span>&nbsp;<span class="op" id="4415959">=</span>&nbsp;<span class="ident" id="4415961">SyntaxError</span><span class="op" id="4415972">{</span><span class="string" id="4415973">&#34;truncated&nbsp;sequence&#34;</span><span class="op" id="4415993">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4415998">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4416007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416011">offset</span>&nbsp;<span class="op" id="4416018">+=</span>&nbsp;<span class="ident" id="4416021">t</span><span class="op" id="4416022">.</span><span class="ident" id="4416023">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416032">numElements</span><span class="op" id="4416043">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4416047">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416050">ret</span>&nbsp;<span class="op" id="4416054">=</span>&nbsp;<span class="ident" id="4416056">reflect</span><span class="op" id="4416063">.</span><span class="ident" id="4416064">MakeSlice</span><span class="op" id="4416073">(</span><span class="ident" id="4416074">sliceType</span><span class="op" id="4416083">,</span>&nbsp;<span class="ident" id="4416085">numElements</span><span class="op" id="4416096">,</span>&nbsp;<span class="ident" id="4416098">numElements</span><span class="op" id="4416109">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416112">params</span>&nbsp;<span class="op" id="4416119">:=</span>&nbsp;<span class="ident" id="4416122">fieldParameters</span><span class="op" id="4416137">{</span><span class="op" id="4416138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416141">offset</span>&nbsp;<span class="op" id="4416148">:=</span>&nbsp;<span class="num" id="4416151">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416154">for</span>&nbsp;<span class="ident" id="4416158">i</span>&nbsp;<span class="op" id="4416160">:=</span>&nbsp;<span class="num" id="4416163">0</span><span class="op" id="4416164">;</span>&nbsp;<span class="ident" id="4416166">i</span>&nbsp;<span class="op" id="4416168">&lt;</span>&nbsp;<span class="ident" id="4416170">numElements</span><span class="op" id="4416181">;</span>&nbsp;<span class="ident" id="4416183">i</span><span class="op" id="4416184">++</span>&nbsp;<span class="op" id="4416187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416191">offset</span><span class="op" id="4416197">,</span>&nbsp;<span class="ident" id="4416199">err</span>&nbsp;<span class="op" id="4416203">=</span>&nbsp;<span class="ident" id="4416205">parseField</span><span class="op" id="4416215">(</span><span class="ident" id="4416216">ret</span><span class="op" id="4416219">.</span><span class="ident" id="4416220">Index</span><span class="op" id="4416225">(</span><span class="ident" id="4416226">i</span><span class="op" id="4416227">)</span><span class="op" id="4416228">,</span>&nbsp;<span class="ident" id="4416230">bytes</span><span class="op" id="4416235">,</span>&nbsp;<span class="ident" id="4416237">offset</span><span class="op" id="4416243">,</span>&nbsp;<span class="ident" id="4416245">params</span><span class="op" id="4416251">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416255">if</span>&nbsp;<span class="ident" id="4416258">err</span>&nbsp;<span class="op" id="4416262">!=</span>&nbsp;<span class="ident" id="4416265">nil</span>&nbsp;<span class="op" id="4416269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416274">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4416283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4416286">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416289">return</span><br>
<span class="lineno">500</span><span class="op" id="4416296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4416299">var</span>&nbsp;<span class="op" id="4416303">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416306">bitStringType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416327">=</span>&nbsp;<span class="ident" id="4416329">reflect</span><span class="op" id="4416336">.</span><span class="ident" id="4416337">TypeOf</span><span class="op" id="4416343">(</span><span class="ident" id="4416344">BitString</span><span class="op" id="4416353">{</span><span class="op" id="4416354">}</span><span class="op" id="4416355">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416358">objectIdentifierType</span>&nbsp;<span class="op" id="4416379">=</span>&nbsp;<span class="ident" id="4416381">reflect</span><span class="op" id="4416388">.</span><span class="ident" id="4416389">TypeOf</span><span class="op" id="4416395">(</span><span class="ident" id="4416396">ObjectIdentifier</span><span class="op" id="4416412">{</span><span class="op" id="4416413">}</span><span class="op" id="4416414">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416417">enumeratedType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416438">=</span>&nbsp;<span class="ident" id="4416440">reflect</span><span class="op" id="4416447">.</span><span class="ident" id="4416448">TypeOf</span><span class="op" id="4416454">(</span><span class="ident" id="4416455">Enumerated</span><span class="op" id="4416465">(</span><span class="num" id="4416466">0</span><span class="op" id="4416467">)</span><span class="op" id="4416468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416471">flagType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416492">=</span>&nbsp;<span class="ident" id="4416494">reflect</span><span class="op" id="4416501">.</span><span class="ident" id="4416502">TypeOf</span><span class="op" id="4416508">(</span><span class="ident" id="4416509">Flag</span><span class="op" id="4416513">(</span><span class="builtintype" id="4416514">false</span><span class="op" id="4416519">)</span><span class="op" id="4416520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416523">timeType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416544">=</span>&nbsp;<span class="ident" id="4416546">reflect</span><span class="op" id="4416553">.</span><span class="ident" id="4416554">TypeOf</span><span class="op" id="4416560">(</span><span class="ident" id="4416561">time</span><span class="op" id="4416565">.</span><span class="ident" id="4416566">Time</span><span class="op" id="4416570">{</span><span class="op" id="4416571">}</span><span class="op" id="4416572">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416575">rawValueType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416596">=</span>&nbsp;<span class="ident" id="4416598">reflect</span><span class="op" id="4416605">.</span><span class="ident" id="4416606">TypeOf</span><span class="op" id="4416612">(</span><span class="ident" id="4416613">RawValue</span><span class="op" id="4416621">{</span><span class="op" id="4416622">}</span><span class="op" id="4416623">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416626">rawContentsType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416647">=</span>&nbsp;<span class="ident" id="4416649">reflect</span><span class="op" id="4416656">.</span><span class="ident" id="4416657">TypeOf</span><span class="op" id="4416663">(</span><span class="ident" id="4416664">RawContent</span><span class="op" id="4416674">(</span><span class="ident" id="4416675">nil</span><span class="op" id="4416678">)</span><span class="op" id="4416679">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4416682">bigIntType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4416703">=</span>&nbsp;<span class="ident" id="4416705">reflect</span><span class="op" id="4416712">.</span><span class="ident" id="4416713">TypeOf</span><span class="op" id="4416719">(</span><span class="builtinfunc" id="4416720">new</span><span class="op" id="4416723">(</span><span class="ident" id="4416724">big</span><span class="op" id="4416727">.</span><span class="ident" id="4416728">Int</span><span class="op" id="4416731">)</span><span class="op" id="4416732">)</span><br>
<span class="lineno"></span><span class="op" id="4416734">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4416737">//&nbsp;invalidLength&nbsp;returns&nbsp;true&nbsp;iff&nbsp;offset&nbsp;+&nbsp;length&nbsp;&gt;&nbsp;sliceLength,&nbsp;or&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4416812">//&nbsp;addition&nbsp;would&nbsp;overflow.</span><br>
<span class="lineno">515</span><span class="keyword" id="4416840">func</span>&nbsp;<span class="ident" id="4416845">invalidLength</span><span class="op" id="4416858">(</span><span class="ident" id="4416859">offset</span><span class="op" id="4416865">,</span>&nbsp;<span class="ident" id="4416867">length</span><span class="op" id="4416873">,</span>&nbsp;<span class="ident" id="4416875">sliceLength</span>&nbsp;<span class="builtintype" id="4416887">int</span><span class="op" id="4416890">)</span>&nbsp;<span class="builtintype" id="4416892">bool</span>&nbsp;<span class="op" id="4416897">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4416900">return</span>&nbsp;<span class="ident" id="4416907">offset</span><span class="op" id="4416913">+</span><span class="ident" id="4416914">length</span>&nbsp;<span class="op" id="4416921">&lt;</span>&nbsp;<span class="ident" id="4416923">offset</span>&nbsp;<span class="op" id="4416930">||</span>&nbsp;<span class="ident" id="4416933">offset</span><span class="op" id="4416939">+</span><span class="ident" id="4416940">length</span>&nbsp;<span class="op" id="4416947">&gt;</span>&nbsp;<span class="ident" id="4416949">sliceLength</span><br>
<span class="lineno"></span><span class="op" id="4416961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4416964">//&nbsp;parseField&nbsp;is&nbsp;the&nbsp;main&nbsp;parsing&nbsp;function.&nbsp;Given&nbsp;a&nbsp;byte&nbsp;slice&nbsp;and&nbsp;an&nbsp;offset</span><br>
<span class="lineno">520</span><span class="comment" id="4417041">//&nbsp;into&nbsp;the&nbsp;array,&nbsp;it&nbsp;will&nbsp;try&nbsp;to&nbsp;parse&nbsp;a&nbsp;suitable&nbsp;ASN.1&nbsp;value&nbsp;out&nbsp;and&nbsp;store&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4417121">//&nbsp;in&nbsp;the&nbsp;given&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4417144">func</span>&nbsp;<span class="ident" id="4417149">parseField</span><span class="op" id="4417159">(</span><span class="ident" id="4417160">v</span>&nbsp;<span class="ident" id="4417162">reflect</span><span class="op" id="4417169">.</span><span class="ident" id="4417170">Value</span><span class="op" id="4417175">,</span>&nbsp;<span class="ident" id="4417177">bytes</span>&nbsp;<span class="op" id="4417183">[</span><span class="op" id="4417184">]</span><span class="builtintype" id="4417185">byte</span><span class="op" id="4417189">,</span>&nbsp;<span class="ident" id="4417191">initOffset</span>&nbsp;<span class="builtintype" id="4417202">int</span><span class="op" id="4417205">,</span>&nbsp;<span class="ident" id="4417207">params</span>&nbsp;<span class="ident" id="4417214">fieldParameters</span><span class="op" id="4417229">)</span>&nbsp;<span class="op" id="4417231">(</span><span class="ident" id="4417232">offset</span>&nbsp;<span class="builtintype" id="4417239">int</span><span class="op" id="4417242">,</span>&nbsp;<span class="ident" id="4417244">err</span>&nbsp;<span class="builtintype" id="4417248">error</span><span class="op" id="4417253">)</span>&nbsp;<span class="op" id="4417255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417258">offset</span>&nbsp;<span class="op" id="4417265">=</span>&nbsp;<span class="ident" id="4417267">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417279">fieldType</span>&nbsp;<span class="op" id="4417289">:=</span>&nbsp;<span class="ident" id="4417292">v</span><span class="op" id="4417293">.</span><span class="ident" id="4417294">Type</span><span class="op" id="4417298">(</span><span class="op" id="4417299">)</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4417303">//&nbsp;If&nbsp;we&nbsp;have&nbsp;run&nbsp;out&nbsp;of&nbsp;data,&nbsp;it&nbsp;may&nbsp;be&nbsp;that&nbsp;there&nbsp;are&nbsp;optional&nbsp;elements&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417390">if</span>&nbsp;<span class="ident" id="4417393">offset</span>&nbsp;<span class="op" id="4417400">==</span>&nbsp;<span class="builtinfunc" id="4417403">len</span><span class="op" id="4417406">(</span><span class="ident" id="4417407">bytes</span><span class="op" id="4417412">)</span>&nbsp;<span class="op" id="4417414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417418">if</span>&nbsp;<span class="op" id="4417421">!</span><span class="ident" id="4417422">setDefaultValue</span><span class="op" id="4417437">(</span><span class="ident" id="4417438">v</span><span class="op" id="4417439">,</span>&nbsp;<span class="ident" id="4417441">params</span><span class="op" id="4417447">)</span>&nbsp;<span class="op" id="4417449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417454">err</span>&nbsp;<span class="op" id="4417458">=</span>&nbsp;<span class="ident" id="4417460">SyntaxError</span><span class="op" id="4417471">{</span><span class="string" id="4417472">&#34;sequence&nbsp;truncated&#34;</span><span class="op" id="4417492">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4417496">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417500">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4417508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4417512">//&nbsp;Deal&nbsp;with&nbsp;raw&nbsp;values.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417538">if</span>&nbsp;<span class="ident" id="4417541">fieldType</span>&nbsp;<span class="op" id="4417551">==</span>&nbsp;<span class="ident" id="4417554">rawValueType</span>&nbsp;<span class="op" id="4417567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417571">var</span>&nbsp;<span class="ident" id="4417575">t</span>&nbsp;<span class="ident" id="4417577">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417592">t</span><span class="op" id="4417593">,</span>&nbsp;<span class="ident" id="4417595">offset</span><span class="op" id="4417601">,</span>&nbsp;<span class="ident" id="4417603">err</span>&nbsp;<span class="op" id="4417607">=</span>&nbsp;<span class="ident" id="4417609">parseTagAndLength</span><span class="op" id="4417626">(</span><span class="ident" id="4417627">bytes</span><span class="op" id="4417632">,</span>&nbsp;<span class="ident" id="4417634">offset</span><span class="op" id="4417640">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417644">if</span>&nbsp;<span class="ident" id="4417647">err</span>&nbsp;<span class="op" id="4417651">!=</span>&nbsp;<span class="ident" id="4417654">nil</span>&nbsp;<span class="op" id="4417658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417663">return</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4417672">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417676">if</span>&nbsp;<span class="ident" id="4417679">invalidLength</span><span class="op" id="4417692">(</span><span class="ident" id="4417693">offset</span><span class="op" id="4417699">,</span>&nbsp;<span class="ident" id="4417701">t</span><span class="op" id="4417702">.</span><span class="ident" id="4417703">length</span><span class="op" id="4417709">,</span>&nbsp;<span class="builtinfunc" id="4417711">len</span><span class="op" id="4417714">(</span><span class="ident" id="4417715">bytes</span><span class="op" id="4417720">)</span><span class="op" id="4417721">)</span>&nbsp;<span class="op" id="4417723">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417728">err</span>&nbsp;<span class="op" id="4417732">=</span>&nbsp;<span class="ident" id="4417734">SyntaxError</span><span class="op" id="4417745">{</span><span class="string" id="4417746">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4417762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417767">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4417776">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417780">result</span>&nbsp;<span class="op" id="4417787">:=</span>&nbsp;<span class="ident" id="4417790">RawValue</span><span class="op" id="4417798">{</span><span class="ident" id="4417799">t</span><span class="op" id="4417800">.</span><span class="ident" id="4417801">class</span><span class="op" id="4417806">,</span>&nbsp;<span class="ident" id="4417808">t</span><span class="op" id="4417809">.</span><span class="ident" id="4417810">tag</span><span class="op" id="4417813">,</span>&nbsp;<span class="ident" id="4417815">t</span><span class="op" id="4417816">.</span><span class="ident" id="4417817">isCompound</span><span class="op" id="4417827">,</span>&nbsp;<span class="ident" id="4417829">bytes</span><span class="op" id="4417834">[</span><span class="ident" id="4417835">offset</span>&nbsp;<span class="op" id="4417842">:</span>&nbsp;<span class="ident" id="4417844">offset</span><span class="op" id="4417850">+</span><span class="ident" id="4417851">t</span><span class="op" id="4417852">.</span><span class="ident" id="4417853">length</span><span class="op" id="4417859">]</span><span class="op" id="4417860">,</span>&nbsp;<span class="ident" id="4417862">bytes</span><span class="op" id="4417867">[</span><span class="ident" id="4417868">initOffset</span>&nbsp;<span class="op" id="4417879">:</span>&nbsp;<span class="ident" id="4417881">offset</span><span class="op" id="4417887">+</span><span class="ident" id="4417888">t</span><span class="op" id="4417889">.</span><span class="ident" id="4417890">length</span><span class="op" id="4417896">]</span><span class="op" id="4417897">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417901">offset</span>&nbsp;<span class="op" id="4417908">+=</span>&nbsp;<span class="ident" id="4417911">t</span><span class="op" id="4417912">.</span><span class="ident" id="4417913">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4417922">v</span><span class="op" id="4417923">.</span><span class="ident" id="4417924">Set</span><span class="op" id="4417927">(</span><span class="ident" id="4417928">reflect</span><span class="op" id="4417935">.</span><span class="ident" id="4417936">ValueOf</span><span class="op" id="4417943">(</span><span class="ident" id="4417944">result</span><span class="op" id="4417950">)</span><span class="op" id="4417951">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417955">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4417963">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4417967">//&nbsp;Deal&nbsp;with&nbsp;the&nbsp;ANY&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4417995">if</span>&nbsp;<span class="ident" id="4417998">ifaceType</span>&nbsp;<span class="op" id="4418008">:=</span>&nbsp;<span class="ident" id="4418011">fieldType</span><span class="op" id="4418020">;</span>&nbsp;<span class="ident" id="4418022">ifaceType</span><span class="op" id="4418031">.</span><span class="ident" id="4418032">Kind</span><span class="op" id="4418036">(</span><span class="op" id="4418037">)</span>&nbsp;<span class="op" id="4418039">==</span>&nbsp;<span class="ident" id="4418042">reflect</span><span class="op" id="4418049">.</span><span class="ident" id="4418050">Interface</span>&nbsp;<span class="op" id="4418060">&amp;&amp;</span>&nbsp;<span class="ident" id="4418063">ifaceType</span><span class="op" id="4418072">.</span><span class="ident" id="4418073">NumMethod</span><span class="op" id="4418082">(</span><span class="op" id="4418083">)</span>&nbsp;<span class="op" id="4418085">==</span>&nbsp;<span class="num" id="4418088">0</span>&nbsp;<span class="op" id="4418090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418094">var</span>&nbsp;<span class="ident" id="4418098">t</span>&nbsp;<span class="ident" id="4418100">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418115">t</span><span class="op" id="4418116">,</span>&nbsp;<span class="ident" id="4418118">offset</span><span class="op" id="4418124">,</span>&nbsp;<span class="ident" id="4418126">err</span>&nbsp;<span class="op" id="4418130">=</span>&nbsp;<span class="ident" id="4418132">parseTagAndLength</span><span class="op" id="4418149">(</span><span class="ident" id="4418150">bytes</span><span class="op" id="4418155">,</span>&nbsp;<span class="ident" id="4418157">offset</span><span class="op" id="4418163">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418167">if</span>&nbsp;<span class="ident" id="4418170">err</span>&nbsp;<span class="op" id="4418174">!=</span>&nbsp;<span class="ident" id="4418177">nil</span>&nbsp;<span class="op" id="4418181">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418186">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4418195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418199">if</span>&nbsp;<span class="ident" id="4418202">invalidLength</span><span class="op" id="4418215">(</span><span class="ident" id="4418216">offset</span><span class="op" id="4418222">,</span>&nbsp;<span class="ident" id="4418224">t</span><span class="op" id="4418225">.</span><span class="ident" id="4418226">length</span><span class="op" id="4418232">,</span>&nbsp;<span class="builtinfunc" id="4418234">len</span><span class="op" id="4418237">(</span><span class="ident" id="4418238">bytes</span><span class="op" id="4418243">)</span><span class="op" id="4418244">)</span>&nbsp;<span class="op" id="4418246">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418251">err</span>&nbsp;<span class="op" id="4418255">=</span>&nbsp;<span class="ident" id="4418257">SyntaxError</span><span class="op" id="4418268">{</span><span class="string" id="4418269">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4418285">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418290">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4418299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418303">var</span>&nbsp;<span class="ident" id="4418307">result</span>&nbsp;<span class="keyword" id="4418314">interface</span><span class="op" id="4418323">{</span><span class="op" id="4418324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418328">if</span>&nbsp;<span class="op" id="4418331">!</span><span class="ident" id="4418332">t</span><span class="op" id="4418333">.</span><span class="ident" id="4418334">isCompound</span>&nbsp;<span class="op" id="4418345">&amp;&amp;</span>&nbsp;<span class="ident" id="4418348">t</span><span class="op" id="4418349">.</span><span class="ident" id="4418350">class</span>&nbsp;<span class="op" id="4418356">==</span>&nbsp;<span class="ident" id="4418359">classUniversal</span>&nbsp;<span class="op" id="4418374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418379">innerBytes</span>&nbsp;<span class="op" id="4418390">:=</span>&nbsp;<span class="ident" id="4418393">bytes</span><span class="op" id="4418398">[</span><span class="ident" id="4418399">offset</span>&nbsp;<span class="op" id="4418406">:</span>&nbsp;<span class="ident" id="4418408">offset</span><span class="op" id="4418414">+</span><span class="ident" id="4418415">t</span><span class="op" id="4418416">.</span><span class="ident" id="4418417">length</span><span class="op" id="4418423">]</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418428">switch</span>&nbsp;<span class="ident" id="4418435">t</span><span class="op" id="4418436">.</span><span class="ident" id="4418437">tag</span>&nbsp;<span class="op" id="4418441">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418446">case</span>&nbsp;<span class="ident" id="4418451">tagPrintableString</span><span class="op" id="4418469">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418475">result</span><span class="op" id="4418481">,</span>&nbsp;<span class="ident" id="4418483">err</span>&nbsp;<span class="op" id="4418487">=</span>&nbsp;<span class="ident" id="4418489">parsePrintableString</span><span class="op" id="4418509">(</span><span class="ident" id="4418510">innerBytes</span><span class="op" id="4418520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418525">case</span>&nbsp;<span class="ident" id="4418530">tagIA5String</span><span class="op" id="4418542">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418548">result</span><span class="op" id="4418554">,</span>&nbsp;<span class="ident" id="4418556">err</span>&nbsp;<span class="op" id="4418560">=</span>&nbsp;<span class="ident" id="4418562">parseIA5String</span><span class="op" id="4418576">(</span><span class="ident" id="4418577">innerBytes</span><span class="op" id="4418587">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418592">case</span>&nbsp;<span class="ident" id="4418597">tagT61String</span><span class="op" id="4418609">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418615">result</span><span class="op" id="4418621">,</span>&nbsp;<span class="ident" id="4418623">err</span>&nbsp;<span class="op" id="4418627">=</span>&nbsp;<span class="ident" id="4418629">parseT61String</span><span class="op" id="4418643">(</span><span class="ident" id="4418644">innerBytes</span><span class="op" id="4418654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418659">case</span>&nbsp;<span class="ident" id="4418664">tagUTF8String</span><span class="op" id="4418677">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418683">result</span><span class="op" id="4418689">,</span>&nbsp;<span class="ident" id="4418691">err</span>&nbsp;<span class="op" id="4418695">=</span>&nbsp;<span class="ident" id="4418697">parseUTF8String</span><span class="op" id="4418712">(</span><span class="ident" id="4418713">innerBytes</span><span class="op" id="4418723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418728">case</span>&nbsp;<span class="ident" id="4418733">tagInteger</span><span class="op" id="4418743">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418749">result</span><span class="op" id="4418755">,</span>&nbsp;<span class="ident" id="4418757">err</span>&nbsp;<span class="op" id="4418761">=</span>&nbsp;<span class="ident" id="4418763">parseInt64</span><span class="op" id="4418773">(</span><span class="ident" id="4418774">innerBytes</span><span class="op" id="4418784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418789">case</span>&nbsp;<span class="ident" id="4418794">tagBitString</span><span class="op" id="4418806">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418812">result</span><span class="op" id="4418818">,</span>&nbsp;<span class="ident" id="4418820">err</span>&nbsp;<span class="op" id="4418824">=</span>&nbsp;<span class="ident" id="4418826">parseBitString</span><span class="op" id="4418840">(</span><span class="ident" id="4418841">innerBytes</span><span class="op" id="4418851">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418856">case</span>&nbsp;<span class="ident" id="4418861">tagOID</span><span class="op" id="4418867">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418873">result</span><span class="op" id="4418879">,</span>&nbsp;<span class="ident" id="4418881">err</span>&nbsp;<span class="op" id="4418885">=</span>&nbsp;<span class="ident" id="4418887">parseObjectIdentifier</span><span class="op" id="4418908">(</span><span class="ident" id="4418909">innerBytes</span><span class="op" id="4418919">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418924">case</span>&nbsp;<span class="ident" id="4418929">tagUTCTime</span><span class="op" id="4418939">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4418945">result</span><span class="op" id="4418951">,</span>&nbsp;<span class="ident" id="4418953">err</span>&nbsp;<span class="op" id="4418957">=</span>&nbsp;<span class="ident" id="4418959">parseUTCTime</span><span class="op" id="4418971">(</span><span class="ident" id="4418972">innerBytes</span><span class="op" id="4418982">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4418987">case</span>&nbsp;<span class="ident" id="4418992">tagOctetString</span><span class="op" id="4419006">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419012">result</span>&nbsp;<span class="op" id="4419019">=</span>&nbsp;<span class="ident" id="4419021">innerBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419035">default</span><span class="op" id="4419042">:</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4419048">//&nbsp;If&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;to&nbsp;handle&nbsp;the&nbsp;type,&nbsp;we&nbsp;just&nbsp;leave&nbsp;Value&nbsp;as&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419127">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419131">offset</span>&nbsp;<span class="op" id="4419138">+=</span>&nbsp;<span class="ident" id="4419141">t</span><span class="op" id="4419142">.</span><span class="ident" id="4419143">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419152">if</span>&nbsp;<span class="ident" id="4419155">err</span>&nbsp;<span class="op" id="4419159">!=</span>&nbsp;<span class="ident" id="4419162">nil</span>&nbsp;<span class="op" id="4419166">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419171">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419184">if</span>&nbsp;<span class="ident" id="4419187">result</span>&nbsp;<span class="op" id="4419194">!=</span>&nbsp;<span class="ident" id="4419197">nil</span>&nbsp;<span class="op" id="4419201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419206">v</span><span class="op" id="4419207">.</span><span class="ident" id="4419208">Set</span><span class="op" id="4419211">(</span><span class="ident" id="4419212">reflect</span><span class="op" id="4419219">.</span><span class="ident" id="4419220">ValueOf</span><span class="op" id="4419227">(</span><span class="ident" id="4419228">result</span><span class="op" id="4419234">)</span><span class="op" id="4419235">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419239">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419243">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419251">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419254">universalTag</span><span class="op" id="4419266">,</span>&nbsp;<span class="ident" id="4419268">compoundType</span><span class="op" id="4419280">,</span>&nbsp;<span class="ident" id="4419282">ok1</span>&nbsp;<span class="op" id="4419286">:=</span>&nbsp;<span class="ident" id="4419289">getUniversalType</span><span class="op" id="4419305">(</span><span class="ident" id="4419306">fieldType</span><span class="op" id="4419315">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419318">if</span>&nbsp;<span class="op" id="4419321">!</span><span class="ident" id="4419322">ok1</span>&nbsp;<span class="op" id="4419326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419330">err</span>&nbsp;<span class="op" id="4419334">=</span>&nbsp;<span class="ident" id="4419336">StructuralError</span><span class="op" id="4419351">{</span><span class="ident" id="4419352">fmt</span><span class="op" id="4419355">.</span><span class="ident" id="4419356">Sprintf</span><span class="op" id="4419363">(</span><span class="string" id="4419364">&#34;unknown&nbsp;Go&nbsp;type:&nbsp;%v&#34;</span><span class="op" id="4419385">,</span>&nbsp;<span class="ident" id="4419387">fieldType</span><span class="op" id="4419396">)</span><span class="op" id="4419397">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419401">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419413">t</span><span class="op" id="4419414">,</span>&nbsp;<span class="ident" id="4419416">offset</span><span class="op" id="4419422">,</span>&nbsp;<span class="ident" id="4419424">err</span>&nbsp;<span class="op" id="4419428">:=</span>&nbsp;<span class="ident" id="4419431">parseTagAndLength</span><span class="op" id="4419448">(</span><span class="ident" id="4419449">bytes</span><span class="op" id="4419454">,</span>&nbsp;<span class="ident" id="4419456">offset</span><span class="op" id="4419462">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419465">if</span>&nbsp;<span class="ident" id="4419468">err</span>&nbsp;<span class="op" id="4419472">!=</span>&nbsp;<span class="ident" id="4419475">nil</span>&nbsp;<span class="op" id="4419479">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419483">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419491">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419494">if</span>&nbsp;<span class="ident" id="4419497">params</span><span class="op" id="4419503">.</span><span class="ident" id="4419504">explicit</span>&nbsp;<span class="op" id="4419513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419517">expectedClass</span>&nbsp;<span class="op" id="4419531">:=</span>&nbsp;<span class="ident" id="4419534">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419557">if</span>&nbsp;<span class="ident" id="4419560">params</span><span class="op" id="4419566">.</span><span class="ident" id="4419567">application</span>&nbsp;<span class="op" id="4419579">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419584">expectedClass</span>&nbsp;<span class="op" id="4419598">=</span>&nbsp;<span class="ident" id="4419600">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419619">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419623">if</span>&nbsp;<span class="ident" id="4419626">t</span><span class="op" id="4419627">.</span><span class="ident" id="4419628">class</span>&nbsp;<span class="op" id="4419634">==</span>&nbsp;<span class="ident" id="4419637">expectedClass</span>&nbsp;<span class="op" id="4419651">&amp;&amp;</span>&nbsp;<span class="ident" id="4419654">t</span><span class="op" id="4419655">.</span><span class="ident" id="4419656">tag</span>&nbsp;<span class="op" id="4419660">==</span>&nbsp;<span class="op" id="4419663">*</span><span class="ident" id="4419664">params</span><span class="op" id="4419670">.</span><span class="ident" id="4419671">tag</span>&nbsp;<span class="op" id="4419675">&amp;&amp;</span>&nbsp;<span class="op" id="4419678">(</span><span class="ident" id="4419679">t</span><span class="op" id="4419680">.</span><span class="ident" id="4419681">length</span>&nbsp;<span class="op" id="4419688">==</span>&nbsp;<span class="num" id="4419691">0</span>&nbsp;<span class="op" id="4419693">||</span>&nbsp;<span class="ident" id="4419696">t</span><span class="op" id="4419697">.</span><span class="ident" id="4419698">isCompound</span><span class="op" id="4419708">)</span>&nbsp;<span class="op" id="4419710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419715">if</span>&nbsp;<span class="ident" id="4419718">t</span><span class="op" id="4419719">.</span><span class="ident" id="4419720">length</span>&nbsp;<span class="op" id="4419727">&gt;</span>&nbsp;<span class="num" id="4419729">0</span>&nbsp;<span class="op" id="4419731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419737">t</span><span class="op" id="4419738">,</span>&nbsp;<span class="ident" id="4419740">offset</span><span class="op" id="4419746">,</span>&nbsp;<span class="ident" id="4419748">err</span>&nbsp;<span class="op" id="4419752">=</span>&nbsp;<span class="ident" id="4419754">parseTagAndLength</span><span class="op" id="4419771">(</span><span class="ident" id="4419772">bytes</span><span class="op" id="4419777">,</span>&nbsp;<span class="ident" id="4419779">offset</span><span class="op" id="4419785">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419791">if</span>&nbsp;<span class="ident" id="4419794">err</span>&nbsp;<span class="op" id="4419798">!=</span>&nbsp;<span class="ident" id="4419801">nil</span>&nbsp;<span class="op" id="4419805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419812">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419823">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419828">}</span>&nbsp;<span class="keyword" id="4419830">else</span>&nbsp;<span class="op" id="4419835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419841">if</span>&nbsp;<span class="ident" id="4419844">fieldType</span>&nbsp;<span class="op" id="4419854">!=</span>&nbsp;<span class="ident" id="4419857">flagType</span>&nbsp;<span class="op" id="4419866">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419873">err</span>&nbsp;<span class="op" id="4419877">=</span>&nbsp;<span class="ident" id="4419879">StructuralError</span><span class="op" id="4419894">{</span><span class="string" id="4419895">&#34;zero&nbsp;length&nbsp;explicit&nbsp;tag&nbsp;was&nbsp;not&nbsp;an&nbsp;asn1.Flag&#34;</span><span class="op" id="4419942">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419949">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419960">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4419966">v</span><span class="op" id="4419967">.</span><span class="ident" id="4419968">SetBool</span><span class="op" id="4419975">(</span><span class="builtintype" id="4419976">true</span><span class="op" id="4419980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4419986">return</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4419996">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420000">}</span>&nbsp;<span class="keyword" id="4420002">else</span>&nbsp;<span class="op" id="4420007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4420012">//&nbsp;The&nbsp;tags&nbsp;didn&#39;t&nbsp;match,&nbsp;it&nbsp;might&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420074">ok</span>&nbsp;<span class="op" id="4420077">:=</span>&nbsp;<span class="ident" id="4420080">setDefaultValue</span><span class="op" id="4420095">(</span><span class="ident" id="4420096">v</span><span class="op" id="4420097">,</span>&nbsp;<span class="ident" id="4420099">params</span><span class="op" id="4420105">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420110">if</span>&nbsp;<span class="ident" id="4420113">ok</span>&nbsp;<span class="op" id="4420116">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420122">offset</span>&nbsp;<span class="op" id="4420129">=</span>&nbsp;<span class="ident" id="4420131">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420145">}</span>&nbsp;<span class="keyword" id="4420147">else</span>&nbsp;<span class="op" id="4420152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420158">err</span>&nbsp;<span class="op" id="4420162">=</span>&nbsp;<span class="ident" id="4420164">StructuralError</span><span class="op" id="4420179">{</span><span class="string" id="4420180">&#34;explicitly&nbsp;tagged&nbsp;member&nbsp;didn&#39;t&nbsp;match&#34;</span><span class="op" id="4420219">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420229">return</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420241">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4420245">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;strings:&nbsp;all&nbsp;the&nbsp;ASN.1&nbsp;string&nbsp;types&nbsp;map&nbsp;to&nbsp;the&nbsp;Go</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4420316">//&nbsp;type&nbsp;string.&nbsp;getUniversalType&nbsp;returns&nbsp;the&nbsp;tag&nbsp;for&nbsp;PrintableString</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4420386">//&nbsp;when&nbsp;it&nbsp;sees&nbsp;a&nbsp;string,&nbsp;so&nbsp;if&nbsp;we&nbsp;see&nbsp;a&nbsp;different&nbsp;string&nbsp;type&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4420457">//&nbsp;wire,&nbsp;we&nbsp;change&nbsp;the&nbsp;universal&nbsp;type&nbsp;to&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420506">if</span>&nbsp;<span class="ident" id="4420509">universalTag</span>&nbsp;<span class="op" id="4420522">==</span>&nbsp;<span class="ident" id="4420525">tagPrintableString</span>&nbsp;<span class="op" id="4420544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420548">if</span>&nbsp;<span class="ident" id="4420551">t</span><span class="op" id="4420552">.</span><span class="ident" id="4420553">class</span>&nbsp;<span class="op" id="4420559">==</span>&nbsp;<span class="ident" id="4420562">classUniversal</span>&nbsp;<span class="op" id="4420577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420582">switch</span>&nbsp;<span class="ident" id="4420589">t</span><span class="op" id="4420590">.</span><span class="ident" id="4420591">tag</span>&nbsp;<span class="op" id="4420595">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420600">case</span>&nbsp;<span class="ident" id="4420605">tagIA5String</span><span class="op" id="4420617">,</span>&nbsp;<span class="ident" id="4420619">tagGeneralString</span><span class="op" id="4420635">,</span>&nbsp;<span class="ident" id="4420637">tagT61String</span><span class="op" id="4420649">,</span>&nbsp;<span class="ident" id="4420651">tagUTF8String</span><span class="op" id="4420664">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420670">universalTag</span>&nbsp;<span class="op" id="4420683">=</span>&nbsp;<span class="ident" id="4420685">t</span><span class="op" id="4420686">.</span><span class="ident" id="4420687">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420694">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420698">}</span>&nbsp;<span class="keyword" id="4420700">else</span>&nbsp;<span class="keyword" id="4420705">if</span>&nbsp;<span class="ident" id="4420708">params</span><span class="op" id="4420714">.</span><span class="ident" id="4420715">stringType</span>&nbsp;<span class="op" id="4420726">!=</span>&nbsp;<span class="num" id="4420729">0</span>&nbsp;<span class="op" id="4420731">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420736">universalTag</span>&nbsp;<span class="op" id="4420749">=</span>&nbsp;<span class="ident" id="4420751">params</span><span class="op" id="4420757">.</span><span class="ident" id="4420758">stringType</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4420774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4420778">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;time:&nbsp;UTCTime&nbsp;and&nbsp;GeneralizedTime&nbsp;both&nbsp;map&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4420849">//&nbsp;Go&nbsp;type&nbsp;time.Time.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4420872">if</span>&nbsp;<span class="ident" id="4420875">universalTag</span>&nbsp;<span class="op" id="4420888">==</span>&nbsp;<span class="ident" id="4420891">tagUTCTime</span>&nbsp;<span class="op" id="4420902">&amp;&amp;</span>&nbsp;<span class="ident" id="4420905">t</span><span class="op" id="4420906">.</span><span class="ident" id="4420907">tag</span>&nbsp;<span class="op" id="4420911">==</span>&nbsp;<span class="ident" id="4420914">tagGeneralizedTime</span>&nbsp;<span class="op" id="4420933">&amp;&amp;</span>&nbsp;<span class="ident" id="4420936">t</span><span class="op" id="4420937">.</span><span class="ident" id="4420938">class</span>&nbsp;<span class="op" id="4420944">==</span>&nbsp;<span class="ident" id="4420947">classUniversal</span>&nbsp;<span class="op" id="4420962">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4420966">universalTag</span>&nbsp;<span class="op" id="4420979">=</span>&nbsp;<span class="ident" id="4420981">tagGeneralizedTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4421001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421005">if</span>&nbsp;<span class="ident" id="4421008">params</span><span class="op" id="4421014">.</span><span class="ident" id="4421015">set</span>&nbsp;<span class="op" id="4421019">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421023">universalTag</span>&nbsp;<span class="op" id="4421036">=</span>&nbsp;<span class="ident" id="4421038">tagSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4421046">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421050">expectedClass</span>&nbsp;<span class="op" id="4421064">:=</span>&nbsp;<span class="ident" id="4421067">classUniversal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421083">expectedTag</span>&nbsp;<span class="op" id="4421095">:=</span>&nbsp;<span class="ident" id="4421098">universalTag</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421113">if</span>&nbsp;<span class="op" id="4421116">!</span><span class="ident" id="4421117">params</span><span class="op" id="4421123">.</span><span class="ident" id="4421124">explicit</span>&nbsp;<span class="op" id="4421133">&amp;&amp;</span>&nbsp;<span class="ident" id="4421136">params</span><span class="op" id="4421142">.</span><span class="ident" id="4421143">tag</span>&nbsp;<span class="op" id="4421147">!=</span>&nbsp;<span class="ident" id="4421150">nil</span>&nbsp;<span class="op" id="4421154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421158">expectedClass</span>&nbsp;<span class="op" id="4421172">=</span>&nbsp;<span class="ident" id="4421174">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421197">expectedTag</span>&nbsp;<span class="op" id="4421209">=</span>&nbsp;<span class="op" id="4421211">*</span><span class="ident" id="4421212">params</span><span class="op" id="4421218">.</span><span class="ident" id="4421219">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4421224">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421228">if</span>&nbsp;<span class="op" id="4421231">!</span><span class="ident" id="4421232">params</span><span class="op" id="4421238">.</span><span class="ident" id="4421239">explicit</span>&nbsp;<span class="op" id="4421248">&amp;&amp;</span>&nbsp;<span class="ident" id="4421251">params</span><span class="op" id="4421257">.</span><span class="ident" id="4421258">application</span>&nbsp;<span class="op" id="4421270">&amp;&amp;</span>&nbsp;<span class="ident" id="4421273">params</span><span class="op" id="4421279">.</span><span class="ident" id="4421280">tag</span>&nbsp;<span class="op" id="4421284">!=</span>&nbsp;<span class="ident" id="4421287">nil</span>&nbsp;<span class="op" id="4421291">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421295">expectedClass</span>&nbsp;<span class="op" id="4421309">=</span>&nbsp;<span class="ident" id="4421311">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421330">expectedTag</span>&nbsp;<span class="op" id="4421342">=</span>&nbsp;<span class="op" id="4421344">*</span><span class="ident" id="4421345">params</span><span class="op" id="4421351">.</span><span class="ident" id="4421352">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4421357">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4421361">//&nbsp;We&nbsp;have&nbsp;unwrapped&nbsp;any&nbsp;explicit&nbsp;tagging&nbsp;at&nbsp;this&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421419">if</span>&nbsp;<span class="ident" id="4421422">t</span><span class="op" id="4421423">.</span><span class="ident" id="4421424">class</span>&nbsp;<span class="op" id="4421430">!=</span>&nbsp;<span class="ident" id="4421433">expectedClass</span>&nbsp;<span class="op" id="4421447">||</span>&nbsp;<span class="ident" id="4421450">t</span><span class="op" id="4421451">.</span><span class="ident" id="4421452">tag</span>&nbsp;<span class="op" id="4421456">!=</span>&nbsp;<span class="ident" id="4421459">expectedTag</span>&nbsp;<span class="op" id="4421471">||</span>&nbsp;<span class="ident" id="4421474">t</span><span class="op" id="4421475">.</span><span class="ident" id="4421476">isCompound</span>&nbsp;<span class="op" id="4421487">!=</span>&nbsp;<span class="ident" id="4421490">compoundType</span>&nbsp;<span class="op" id="4421503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4421507">//&nbsp;Tags&nbsp;don&#39;t&nbsp;match.&nbsp;Again,&nbsp;it&nbsp;could&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421570">ok</span>&nbsp;<span class="op" id="4421573">:=</span>&nbsp;<span class="ident" id="4421576">setDefaultValue</span><span class="op" id="4421591">(</span><span class="ident" id="4421592">v</span><span class="op" id="4421593">,</span>&nbsp;<span class="ident" id="4421595">params</span><span class="op" id="4421601">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421605">if</span>&nbsp;<span class="ident" id="4421608">ok</span>&nbsp;<span class="op" id="4421611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421616">offset</span>&nbsp;<span class="op" id="4421623">=</span>&nbsp;<span class="ident" id="4421625">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4421638">}</span>&nbsp;<span class="keyword" id="4421640">else</span>&nbsp;<span class="op" id="4421645">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421650">err</span>&nbsp;<span class="op" id="4421654">=</span>&nbsp;<span class="ident" id="4421656">StructuralError</span><span class="op" id="4421671">{</span><span class="ident" id="4421672">fmt</span><span class="op" id="4421675">.</span><span class="ident" id="4421676">Sprintf</span><span class="op" id="4421683">(</span><span class="string" id="4421684">&#34;tags&nbsp;don&#39;t&nbsp;match&nbsp;(%d&nbsp;vs&nbsp;%+v)&nbsp;%+v&nbsp;%s&nbsp;@%d&#34;</span><span class="op" id="4421725">,</span>&nbsp;<span class="ident" id="4421727">expectedTag</span><span class="op" id="4421738">,</span>&nbsp;<span class="ident" id="4421740">t</span><span class="op" id="4421741">,</span>&nbsp;<span class="ident" id="4421743">params</span><span class="op" id="4421749">,</span>&nbsp;<span class="ident" id="4421751">fieldType</span><span class="op" id="4421760">.</span><span class="ident" id="4421761">Name</span><span class="op" id="4421765">(</span><span class="op" id="4421766">)</span><span class="op" id="4421767">,</span>&nbsp;<span class="ident" id="4421769">offset</span><span class="op" id="4421775">)</span><span class="op" id="4421776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4421780">}</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421784">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4421792">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421795">if</span>&nbsp;<span class="ident" id="4421798">invalidLength</span><span class="op" id="4421811">(</span><span class="ident" id="4421812">offset</span><span class="op" id="4421818">,</span>&nbsp;<span class="ident" id="4421820">t</span><span class="op" id="4421821">.</span><span class="ident" id="4421822">length</span><span class="op" id="4421828">,</span>&nbsp;<span class="builtinfunc" id="4421830">len</span><span class="op" id="4421833">(</span><span class="ident" id="4421834">bytes</span><span class="op" id="4421839">)</span><span class="op" id="4421840">)</span>&nbsp;<span class="op" id="4421842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421846">err</span>&nbsp;<span class="op" id="4421850">=</span>&nbsp;<span class="ident" id="4421852">SyntaxError</span><span class="op" id="4421863">{</span><span class="string" id="4421864">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4421880">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4421884">return</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4421892">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421895">innerBytes</span>&nbsp;<span class="op" id="4421906">:=</span>&nbsp;<span class="ident" id="4421909">bytes</span><span class="op" id="4421914">[</span><span class="ident" id="4421915">offset</span>&nbsp;<span class="op" id="4421922">:</span>&nbsp;<span class="ident" id="4421924">offset</span><span class="op" id="4421930">+</span><span class="ident" id="4421931">t</span><span class="op" id="4421932">.</span><span class="ident" id="4421933">length</span><span class="op" id="4421939">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4421942">offset</span>&nbsp;<span class="op" id="4421949">+=</span>&nbsp;<span class="ident" id="4421952">t</span><span class="op" id="4421953">.</span><span class="ident" id="4421954">length</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4421963">//&nbsp;We&nbsp;deal&nbsp;with&nbsp;the&nbsp;structures&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;first.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422026">switch</span>&nbsp;<span class="ident" id="4422033">fieldType</span>&nbsp;<span class="op" id="4422043">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422046">case</span>&nbsp;<span class="ident" id="4422051">objectIdentifierType</span><span class="op" id="4422071">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422075">newSlice</span><span class="op" id="4422083">,</span>&nbsp;<span class="ident" id="4422085">err1</span>&nbsp;<span class="op" id="4422090">:=</span>&nbsp;<span class="ident" id="4422093">parseObjectIdentifier</span><span class="op" id="4422114">(</span><span class="ident" id="4422115">innerBytes</span><span class="op" id="4422125">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422129">v</span><span class="op" id="4422130">.</span><span class="ident" id="4422131">Set</span><span class="op" id="4422134">(</span><span class="ident" id="4422135">reflect</span><span class="op" id="4422142">.</span><span class="ident" id="4422143">MakeSlice</span><span class="op" id="4422152">(</span><span class="ident" id="4422153">v</span><span class="op" id="4422154">.</span><span class="ident" id="4422155">Type</span><span class="op" id="4422159">(</span><span class="op" id="4422160">)</span><span class="op" id="4422161">,</span>&nbsp;<span class="builtinfunc" id="4422163">len</span><span class="op" id="4422166">(</span><span class="ident" id="4422167">newSlice</span><span class="op" id="4422175">)</span><span class="op" id="4422176">,</span>&nbsp;<span class="builtinfunc" id="4422178">len</span><span class="op" id="4422181">(</span><span class="ident" id="4422182">newSlice</span><span class="op" id="4422190">)</span><span class="op" id="4422191">)</span><span class="op" id="4422192">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422196">if</span>&nbsp;<span class="ident" id="4422199">err1</span>&nbsp;<span class="op" id="4422204">==</span>&nbsp;<span class="ident" id="4422207">nil</span>&nbsp;<span class="op" id="4422211">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422216">reflect</span><span class="op" id="4422223">.</span><span class="ident" id="4422224">Copy</span><span class="op" id="4422228">(</span><span class="ident" id="4422229">v</span><span class="op" id="4422230">,</span>&nbsp;<span class="ident" id="4422232">reflect</span><span class="op" id="4422239">.</span><span class="ident" id="4422240">ValueOf</span><span class="op" id="4422247">(</span><span class="ident" id="4422248">newSlice</span><span class="op" id="4422256">)</span><span class="op" id="4422257">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4422261">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422265">err</span>&nbsp;<span class="op" id="4422269">=</span>&nbsp;<span class="ident" id="4422271">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422278">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422286">case</span>&nbsp;<span class="ident" id="4422291">bitStringType</span><span class="op" id="4422304">:</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422308">bs</span><span class="op" id="4422310">,</span>&nbsp;<span class="ident" id="4422312">err1</span>&nbsp;<span class="op" id="4422317">:=</span>&nbsp;<span class="ident" id="4422320">parseBitString</span><span class="op" id="4422334">(</span><span class="ident" id="4422335">innerBytes</span><span class="op" id="4422345">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422349">if</span>&nbsp;<span class="ident" id="4422352">err1</span>&nbsp;<span class="op" id="4422357">==</span>&nbsp;<span class="ident" id="4422360">nil</span>&nbsp;<span class="op" id="4422364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422369">v</span><span class="op" id="4422370">.</span><span class="ident" id="4422371">Set</span><span class="op" id="4422374">(</span><span class="ident" id="4422375">reflect</span><span class="op" id="4422382">.</span><span class="ident" id="4422383">ValueOf</span><span class="op" id="4422390">(</span><span class="ident" id="4422391">bs</span><span class="op" id="4422393">)</span><span class="op" id="4422394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4422398">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422402">err</span>&nbsp;<span class="op" id="4422406">=</span>&nbsp;<span class="ident" id="4422408">err1</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422415">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422423">case</span>&nbsp;<span class="ident" id="4422428">timeType</span><span class="op" id="4422436">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422440">var</span>&nbsp;<span class="ident" id="4422444">time</span>&nbsp;<span class="ident" id="4422449">time</span><span class="op" id="4422453">.</span><span class="ident" id="4422454">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422461">var</span>&nbsp;<span class="ident" id="4422465">err1</span>&nbsp;<span class="builtintype" id="4422470">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422478">if</span>&nbsp;<span class="ident" id="4422481">universalTag</span>&nbsp;<span class="op" id="4422494">==</span>&nbsp;<span class="ident" id="4422497">tagUTCTime</span>&nbsp;<span class="op" id="4422508">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422513">time</span><span class="op" id="4422517">,</span>&nbsp;<span class="ident" id="4422519">err1</span>&nbsp;<span class="op" id="4422524">=</span>&nbsp;<span class="ident" id="4422526">parseUTCTime</span><span class="op" id="4422538">(</span><span class="ident" id="4422539">innerBytes</span><span class="op" id="4422549">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4422553">}</span>&nbsp;<span class="keyword" id="4422555">else</span>&nbsp;<span class="op" id="4422560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422565">time</span><span class="op" id="4422569">,</span>&nbsp;<span class="ident" id="4422571">err1</span>&nbsp;<span class="op" id="4422576">=</span>&nbsp;<span class="ident" id="4422578">parseGeneralizedTime</span><span class="op" id="4422598">(</span><span class="ident" id="4422599">innerBytes</span><span class="op" id="4422609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4422613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422617">if</span>&nbsp;<span class="ident" id="4422620">err1</span>&nbsp;<span class="op" id="4422625">==</span>&nbsp;<span class="ident" id="4422628">nil</span>&nbsp;<span class="op" id="4422632">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422637">v</span><span class="op" id="4422638">.</span><span class="ident" id="4422639">Set</span><span class="op" id="4422642">(</span><span class="ident" id="4422643">reflect</span><span class="op" id="4422650">.</span><span class="ident" id="4422651">ValueOf</span><span class="op" id="4422658">(</span><span class="ident" id="4422659">time</span><span class="op" id="4422663">)</span><span class="op" id="4422664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4422668">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422672">err</span>&nbsp;<span class="op" id="4422676">=</span>&nbsp;<span class="ident" id="4422678">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422685">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422693">case</span>&nbsp;<span class="ident" id="4422698">enumeratedType</span><span class="op" id="4422712">:</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422716">parsedInt</span><span class="op" id="4422725">,</span>&nbsp;<span class="ident" id="4422727">err1</span>&nbsp;<span class="op" id="4422732">:=</span>&nbsp;<span class="ident" id="4422735">parseInt32</span><span class="op" id="4422745">(</span><span class="ident" id="4422746">innerBytes</span><span class="op" id="4422756">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422760">if</span>&nbsp;<span class="ident" id="4422763">err1</span>&nbsp;<span class="op" id="4422768">==</span>&nbsp;<span class="ident" id="4422771">nil</span>&nbsp;<span class="op" id="4422775">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422780">v</span><span class="op" id="4422781">.</span><span class="ident" id="4422782">SetInt</span><span class="op" id="4422788">(</span><span class="ident" id="4422789">int64</span><span class="op" id="4422794">(</span><span class="ident" id="4422795">parsedInt</span><span class="op" id="4422804">)</span><span class="op" id="4422805">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4422809">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422813">err</span>&nbsp;<span class="op" id="4422817">=</span>&nbsp;<span class="ident" id="4422819">err1</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422826">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422834">case</span>&nbsp;<span class="ident" id="4422839">flagType</span><span class="op" id="4422847">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422851">v</span><span class="op" id="4422852">.</span><span class="ident" id="4422853">SetBool</span><span class="op" id="4422860">(</span><span class="builtintype" id="4422861">true</span><span class="op" id="4422865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422869">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422877">case</span>&nbsp;<span class="ident" id="4422882">bigIntType</span><span class="op" id="4422892">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422896">parsedInt</span>&nbsp;<span class="op" id="4422906">:=</span>&nbsp;<span class="ident" id="4422909">parseBigInt</span><span class="op" id="4422920">(</span><span class="ident" id="4422921">innerBytes</span><span class="op" id="4422931">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4422935">v</span><span class="op" id="4422936">.</span><span class="ident" id="4422937">Set</span><span class="op" id="4422940">(</span><span class="ident" id="4422941">reflect</span><span class="op" id="4422948">.</span><span class="ident" id="4422949">ValueOf</span><span class="op" id="4422956">(</span><span class="ident" id="4422957">parsedInt</span><span class="op" id="4422966">)</span><span class="op" id="4422967">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422971">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4422979">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4422982">switch</span>&nbsp;<span class="ident" id="4422989">val</span>&nbsp;<span class="op" id="4422993">:=</span>&nbsp;<span class="ident" id="4422996">v</span><span class="op" id="4422997">;</span>&nbsp;<span class="ident" id="4422999">val</span><span class="op" id="4423002">.</span><span class="ident" id="4423003">Kind</span><span class="op" id="4423007">(</span><span class="op" id="4423008">)</span>&nbsp;<span class="op" id="4423010">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423013">case</span>&nbsp;<span class="ident" id="4423018">reflect</span><span class="op" id="4423025">.</span><span class="ident" id="4423026">Bool</span><span class="op" id="4423030">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423034">parsedBool</span><span class="op" id="4423044">,</span>&nbsp;<span class="ident" id="4423046">err1</span>&nbsp;<span class="op" id="4423051">:=</span>&nbsp;<span class="ident" id="4423054">parseBool</span><span class="op" id="4423063">(</span><span class="ident" id="4423064">innerBytes</span><span class="op" id="4423074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423078">if</span>&nbsp;<span class="ident" id="4423081">err1</span>&nbsp;<span class="op" id="4423086">==</span>&nbsp;<span class="ident" id="4423089">nil</span>&nbsp;<span class="op" id="4423093">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423098">val</span><span class="op" id="4423101">.</span><span class="ident" id="4423102">SetBool</span><span class="op" id="4423109">(</span><span class="ident" id="4423110">parsedBool</span><span class="op" id="4423120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423124">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423128">err</span>&nbsp;<span class="op" id="4423132">=</span>&nbsp;<span class="ident" id="4423134">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423141">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423149">case</span>&nbsp;<span class="ident" id="4423154">reflect</span><span class="op" id="4423161">.</span><span class="ident" id="4423162">Int</span><span class="op" id="4423165">,</span>&nbsp;<span class="ident" id="4423167">reflect</span><span class="op" id="4423174">.</span><span class="ident" id="4423175">Int32</span><span class="op" id="4423180">,</span>&nbsp;<span class="ident" id="4423182">reflect</span><span class="op" id="4423189">.</span><span class="ident" id="4423190">Int64</span><span class="op" id="4423195">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423199">if</span>&nbsp;<span class="ident" id="4423202">val</span><span class="op" id="4423205">.</span><span class="ident" id="4423206">Type</span><span class="op" id="4423210">(</span><span class="op" id="4423211">)</span><span class="op" id="4423212">.</span><span class="ident" id="4423213">Size</span><span class="op" id="4423217">(</span><span class="op" id="4423218">)</span>&nbsp;<span class="op" id="4423220">==</span>&nbsp;<span class="num" id="4423223">4</span>&nbsp;<span class="op" id="4423225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423230">parsedInt</span><span class="op" id="4423239">,</span>&nbsp;<span class="ident" id="4423241">err1</span>&nbsp;<span class="op" id="4423246">:=</span>&nbsp;<span class="ident" id="4423249">parseInt32</span><span class="op" id="4423259">(</span><span class="ident" id="4423260">innerBytes</span><span class="op" id="4423270">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423275">if</span>&nbsp;<span class="ident" id="4423278">err1</span>&nbsp;<span class="op" id="4423283">==</span>&nbsp;<span class="ident" id="4423286">nil</span>&nbsp;<span class="op" id="4423290">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423296">val</span><span class="op" id="4423299">.</span><span class="ident" id="4423300">SetInt</span><span class="op" id="4423306">(</span><span class="ident" id="4423307">int64</span><span class="op" id="4423312">(</span><span class="ident" id="4423313">parsedInt</span><span class="op" id="4423322">)</span><span class="op" id="4423323">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423328">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423333">err</span>&nbsp;<span class="op" id="4423337">=</span>&nbsp;<span class="ident" id="4423339">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423346">}</span>&nbsp;<span class="keyword" id="4423348">else</span>&nbsp;<span class="op" id="4423353">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423358">parsedInt</span><span class="op" id="4423367">,</span>&nbsp;<span class="ident" id="4423369">err1</span>&nbsp;<span class="op" id="4423374">:=</span>&nbsp;<span class="ident" id="4423377">parseInt64</span><span class="op" id="4423387">(</span><span class="ident" id="4423388">innerBytes</span><span class="op" id="4423398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423403">if</span>&nbsp;<span class="ident" id="4423406">err1</span>&nbsp;<span class="op" id="4423411">==</span>&nbsp;<span class="ident" id="4423414">nil</span>&nbsp;<span class="op" id="4423418">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423424">val</span><span class="op" id="4423427">.</span><span class="ident" id="4423428">SetInt</span><span class="op" id="4423434">(</span><span class="ident" id="4423435">parsedInt</span><span class="op" id="4423444">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423449">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423454">err</span>&nbsp;<span class="op" id="4423458">=</span>&nbsp;<span class="ident" id="4423460">err1</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423467">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423471">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4423479">//&nbsp;TODO(dfc)&nbsp;Add&nbsp;support&nbsp;for&nbsp;the&nbsp;remaining&nbsp;integer&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423537">case</span>&nbsp;<span class="ident" id="4423542">reflect</span><span class="op" id="4423549">.</span><span class="ident" id="4423550">Struct</span><span class="op" id="4423556">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423560">structType</span>&nbsp;<span class="op" id="4423571">:=</span>&nbsp;<span class="ident" id="4423574">fieldType</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423587">if</span>&nbsp;<span class="ident" id="4423590">structType</span><span class="op" id="4423600">.</span><span class="ident" id="4423601">NumField</span><span class="op" id="4423609">(</span><span class="op" id="4423610">)</span>&nbsp;<span class="op" id="4423612">&gt;</span>&nbsp;<span class="num" id="4423614">0</span>&nbsp;<span class="op" id="4423616">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423622">structType</span><span class="op" id="4423632">.</span><span class="ident" id="4423633">Field</span><span class="op" id="4423638">(</span><span class="num" id="4423639">0</span><span class="op" id="4423640">)</span><span class="op" id="4423641">.</span><span class="ident" id="4423642">Type</span>&nbsp;<span class="op" id="4423647">==</span>&nbsp;<span class="ident" id="4423650">rawContentsType</span>&nbsp;<span class="op" id="4423666">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423671">bytes</span>&nbsp;<span class="op" id="4423677">:=</span>&nbsp;<span class="ident" id="4423680">bytes</span><span class="op" id="4423685">[</span><span class="ident" id="4423686">initOffset</span><span class="op" id="4423696">:</span><span class="ident" id="4423697">offset</span><span class="op" id="4423703">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423708">val</span><span class="op" id="4423711">.</span><span class="ident" id="4423712">Field</span><span class="op" id="4423717">(</span><span class="num" id="4423718">0</span><span class="op" id="4423719">)</span><span class="op" id="4423720">.</span><span class="ident" id="4423721">Set</span><span class="op" id="4423724">(</span><span class="ident" id="4423725">reflect</span><span class="op" id="4423732">.</span><span class="ident" id="4423733">ValueOf</span><span class="op" id="4423740">(</span><span class="ident" id="4423741">RawContent</span><span class="op" id="4423751">(</span><span class="ident" id="4423752">bytes</span><span class="op" id="4423757">)</span><span class="op" id="4423758">)</span><span class="op" id="4423759">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423768">innerOffset</span>&nbsp;<span class="op" id="4423780">:=</span>&nbsp;<span class="num" id="4423783">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423787">for</span>&nbsp;<span class="ident" id="4423791">i</span>&nbsp;<span class="op" id="4423793">:=</span>&nbsp;<span class="num" id="4423796">0</span><span class="op" id="4423797">;</span>&nbsp;<span class="ident" id="4423799">i</span>&nbsp;<span class="op" id="4423801">&lt;</span>&nbsp;<span class="ident" id="4423803">structType</span><span class="op" id="4423813">.</span><span class="ident" id="4423814">NumField</span><span class="op" id="4423822">(</span><span class="op" id="4423823">)</span><span class="op" id="4423824">;</span>&nbsp;<span class="ident" id="4423826">i</span><span class="op" id="4423827">++</span>&nbsp;<span class="op" id="4423830">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423835">field</span>&nbsp;<span class="op" id="4423841">:=</span>&nbsp;<span class="ident" id="4423844">structType</span><span class="op" id="4423854">.</span><span class="ident" id="4423855">Field</span><span class="op" id="4423860">(</span><span class="ident" id="4423861">i</span><span class="op" id="4423862">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423867">if</span>&nbsp;<span class="ident" id="4423870">i</span>&nbsp;<span class="op" id="4423872">==</span>&nbsp;<span class="num" id="4423875">0</span>&nbsp;<span class="op" id="4423877">&amp;&amp;</span>&nbsp;<span class="ident" id="4423880">field</span><span class="op" id="4423885">.</span><span class="ident" id="4423886">Type</span>&nbsp;<span class="op" id="4423891">==</span>&nbsp;<span class="ident" id="4423894">rawContentsType</span>&nbsp;<span class="op" id="4423910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4423916">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4423928">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4423933">innerOffset</span><span class="op" id="4423944">,</span>&nbsp;<span class="ident" id="4423946">err</span>&nbsp;<span class="op" id="4423950">=</span>&nbsp;<span class="ident" id="4423952">parseField</span><span class="op" id="4423962">(</span><span class="ident" id="4423963">val</span><span class="op" id="4423966">.</span><span class="ident" id="4423967">Field</span><span class="op" id="4423972">(</span><span class="ident" id="4423973">i</span><span class="op" id="4423974">)</span><span class="op" id="4423975">,</span>&nbsp;<span class="ident" id="4423977">innerBytes</span><span class="op" id="4423987">,</span>&nbsp;<span class="ident" id="4423989">innerOffset</span><span class="op" id="4424000">,</span>&nbsp;<span class="ident" id="4424002">parseFieldParameters</span><span class="op" id="4424022">(</span><span class="ident" id="4424023">field</span><span class="op" id="4424028">.</span><span class="ident" id="4424029">Tag</span><span class="op" id="4424032">.</span><span class="ident" id="4424033">Get</span><span class="op" id="4424036">(</span><span class="string" id="4424037">&#34;asn1&#34;</span><span class="op" id="4424043">)</span><span class="op" id="4424044">)</span><span class="op" id="4424045">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424050">if</span>&nbsp;<span class="ident" id="4424053">err</span>&nbsp;<span class="op" id="4424057">!=</span>&nbsp;<span class="ident" id="4424060">nil</span>&nbsp;<span class="op" id="4424064">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424070">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4424080">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4424084">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4424088">//&nbsp;We&nbsp;allow&nbsp;extra&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;SEQUENCE&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4424149">//&nbsp;adding&nbsp;elements&nbsp;to&nbsp;the&nbsp;end&nbsp;has&nbsp;been&nbsp;used&nbsp;in&nbsp;X.509&nbsp;as&nbsp;the</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4424211">//&nbsp;version&nbsp;numbers&nbsp;have&nbsp;increased.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424248">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424256">case</span>&nbsp;<span class="ident" id="4424261">reflect</span><span class="op" id="4424268">.</span><span class="ident" id="4424269">Slice</span><span class="op" id="4424274">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424278">sliceType</span>&nbsp;<span class="op" id="4424288">:=</span>&nbsp;<span class="ident" id="4424291">fieldType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424303">if</span>&nbsp;<span class="ident" id="4424306">sliceType</span><span class="op" id="4424315">.</span><span class="ident" id="4424316">Elem</span><span class="op" id="4424320">(</span><span class="op" id="4424321">)</span><span class="op" id="4424322">.</span><span class="ident" id="4424323">Kind</span><span class="op" id="4424327">(</span><span class="op" id="4424328">)</span>&nbsp;<span class="op" id="4424330">==</span>&nbsp;<span class="ident" id="4424333">reflect</span><span class="op" id="4424340">.</span><span class="ident" id="4424341">Uint8</span>&nbsp;<span class="op" id="4424347">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424352">val</span><span class="op" id="4424355">.</span><span class="ident" id="4424356">Set</span><span class="op" id="4424359">(</span><span class="ident" id="4424360">reflect</span><span class="op" id="4424367">.</span><span class="ident" id="4424368">MakeSlice</span><span class="op" id="4424377">(</span><span class="ident" id="4424378">sliceType</span><span class="op" id="4424387">,</span>&nbsp;<span class="builtinfunc" id="4424389">len</span><span class="op" id="4424392">(</span><span class="ident" id="4424393">innerBytes</span><span class="op" id="4424403">)</span><span class="op" id="4424404">,</span>&nbsp;<span class="builtinfunc" id="4424406">len</span><span class="op" id="4424409">(</span><span class="ident" id="4424410">innerBytes</span><span class="op" id="4424420">)</span><span class="op" id="4424421">)</span><span class="op" id="4424422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424427">reflect</span><span class="op" id="4424434">.</span><span class="ident" id="4424435">Copy</span><span class="op" id="4424439">(</span><span class="ident" id="4424440">val</span><span class="op" id="4424443">,</span>&nbsp;<span class="ident" id="4424445">reflect</span><span class="op" id="4424452">.</span><span class="ident" id="4424453">ValueOf</span><span class="op" id="4424460">(</span><span class="ident" id="4424461">innerBytes</span><span class="op" id="4424471">)</span><span class="op" id="4424472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424477">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4424486">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424490">newSlice</span><span class="op" id="4424498">,</span>&nbsp;<span class="ident" id="4424500">err1</span>&nbsp;<span class="op" id="4424505">:=</span>&nbsp;<span class="ident" id="4424508">parseSequenceOf</span><span class="op" id="4424523">(</span><span class="ident" id="4424524">innerBytes</span><span class="op" id="4424534">,</span>&nbsp;<span class="ident" id="4424536">sliceType</span><span class="op" id="4424545">,</span>&nbsp;<span class="ident" id="4424547">sliceType</span><span class="op" id="4424556">.</span><span class="ident" id="4424557">Elem</span><span class="op" id="4424561">(</span><span class="op" id="4424562">)</span><span class="op" id="4424563">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424567">if</span>&nbsp;<span class="ident" id="4424570">err1</span>&nbsp;<span class="op" id="4424575">==</span>&nbsp;<span class="ident" id="4424578">nil</span>&nbsp;<span class="op" id="4424582">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424587">val</span><span class="op" id="4424590">.</span><span class="ident" id="4424591">Set</span><span class="op" id="4424594">(</span><span class="ident" id="4424595">newSlice</span><span class="op" id="4424603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4424607">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424611">err</span>&nbsp;<span class="op" id="4424615">=</span>&nbsp;<span class="ident" id="4424617">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424624">return</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424632">case</span>&nbsp;<span class="ident" id="4424637">reflect</span><span class="op" id="4424644">.</span><span class="ident" id="4424645">String</span><span class="op" id="4424651">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424655">var</span>&nbsp;<span class="ident" id="4424659">v</span>&nbsp;<span class="builtintype" id="4424661">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424670">switch</span>&nbsp;<span class="ident" id="4424677">universalTag</span>&nbsp;<span class="op" id="4424690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424694">case</span>&nbsp;<span class="ident" id="4424699">tagPrintableString</span><span class="op" id="4424717">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424722">v</span><span class="op" id="4424723">,</span>&nbsp;<span class="ident" id="4424725">err</span>&nbsp;<span class="op" id="4424729">=</span>&nbsp;<span class="ident" id="4424731">parsePrintableString</span><span class="op" id="4424751">(</span><span class="ident" id="4424752">innerBytes</span><span class="op" id="4424762">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424766">case</span>&nbsp;<span class="ident" id="4424771">tagIA5String</span><span class="op" id="4424783">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424788">v</span><span class="op" id="4424789">,</span>&nbsp;<span class="ident" id="4424791">err</span>&nbsp;<span class="op" id="4424795">=</span>&nbsp;<span class="ident" id="4424797">parseIA5String</span><span class="op" id="4424811">(</span><span class="ident" id="4424812">innerBytes</span><span class="op" id="4424822">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424826">case</span>&nbsp;<span class="ident" id="4424831">tagT61String</span><span class="op" id="4424843">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424848">v</span><span class="op" id="4424849">,</span>&nbsp;<span class="ident" id="4424851">err</span>&nbsp;<span class="op" id="4424855">=</span>&nbsp;<span class="ident" id="4424857">parseT61String</span><span class="op" id="4424871">(</span><span class="ident" id="4424872">innerBytes</span><span class="op" id="4424882">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424886">case</span>&nbsp;<span class="ident" id="4424891">tagUTF8String</span><span class="op" id="4424904">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4424909">v</span><span class="op" id="4424910">,</span>&nbsp;<span class="ident" id="4424912">err</span>&nbsp;<span class="op" id="4424916">=</span>&nbsp;<span class="ident" id="4424918">parseUTF8String</span><span class="op" id="4424933">(</span><span class="ident" id="4424934">innerBytes</span><span class="op" id="4424944">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4424948">case</span>&nbsp;<span class="ident" id="4424953">tagGeneralString</span><span class="op" id="4424969">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4424974">//&nbsp;GeneralString&nbsp;is&nbsp;specified&nbsp;in&nbsp;ISO-2022/ECMA-35,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4425028">//&nbsp;A&nbsp;brief&nbsp;review&nbsp;suggests&nbsp;that&nbsp;it&nbsp;includes&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4425086">//&nbsp;that&nbsp;allow&nbsp;the&nbsp;encoding&nbsp;to&nbsp;change&nbsp;midstring&nbsp;and</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4425140">//&nbsp;such.&nbsp;We&nbsp;give&nbsp;up&nbsp;and&nbsp;pass&nbsp;it&nbsp;as&nbsp;an&nbsp;8-bit&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4425195">v</span><span class="op" id="4425196">,</span>&nbsp;<span class="ident" id="4425198">err</span>&nbsp;<span class="op" id="4425202">=</span>&nbsp;<span class="ident" id="4425204">parseT61String</span><span class="op" id="4425218">(</span><span class="ident" id="4425219">innerBytes</span><span class="op" id="4425229">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4425233">default</span><span class="op" id="4425240">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4425245">err</span>&nbsp;<span class="op" id="4425249">=</span>&nbsp;<span class="ident" id="4425251">SyntaxError</span><span class="op" id="4425262">{</span><span class="ident" id="4425263">fmt</span><span class="op" id="4425266">.</span><span class="ident" id="4425267">Sprintf</span><span class="op" id="4425274">(</span><span class="string" id="4425275">&#34;internal&nbsp;error:&nbsp;unknown&nbsp;string&nbsp;type&nbsp;%d&#34;</span><span class="op" id="4425315">,</span>&nbsp;<span class="ident" id="4425317">universalTag</span><span class="op" id="4425329">)</span><span class="op" id="4425330">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4425334">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4425338">if</span>&nbsp;<span class="ident" id="4425341">err</span>&nbsp;<span class="op" id="4425345">==</span>&nbsp;<span class="ident" id="4425348">nil</span>&nbsp;<span class="op" id="4425352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4425357">val</span><span class="op" id="4425360">.</span><span class="ident" id="4425361">SetString</span><span class="op" id="4425370">(</span><span class="ident" id="4425371">v</span><span class="op" id="4425372">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4425376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4425380">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4425388">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4425391">err</span>&nbsp;<span class="op" id="4425395">=</span>&nbsp;<span class="ident" id="4425397">StructuralError</span><span class="op" id="4425412">{</span><span class="string" id="4425413">&#34;unsupported:&nbsp;&#34;</span>&nbsp;<span class="op" id="4425429">+</span>&nbsp;<span class="ident" id="4425431">v</span><span class="op" id="4425432">.</span><span class="ident" id="4425433">Type</span><span class="op" id="4425437">(</span><span class="op" id="4425438">)</span><span class="op" id="4425439">.</span><span class="ident" id="4425440">String</span><span class="op" id="4425446">(</span><span class="op" id="4425447">)</span><span class="op" id="4425448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4425451">return</span><br>
<span class="lineno"></span><span class="op" id="4425458">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4425461">//&nbsp;canHaveDefaultValue&nbsp;reports&nbsp;whether&nbsp;k&nbsp;is&nbsp;a&nbsp;Kind&nbsp;that&nbsp;we&nbsp;will&nbsp;set&nbsp;a&nbsp;default</span><br>
<span class="lineno">830</span><span class="comment" id="4425539">//&nbsp;value&nbsp;for.&nbsp;(A&nbsp;signed&nbsp;integer,&nbsp;essentially.)</span><br>
<span class="lineno"></span><span class="keyword" id="4425586">func</span>&nbsp;<span class="ident" id="4425591">canHaveDefaultValue</span><span class="op" id="4425610">(</span><span class="ident" id="4425611">k</span>&nbsp;<span class="ident" id="4425613">reflect</span><span class="op" id="4425620">.</span><span class="ident" id="4425621">Kind</span><span class="op" id="4425625">)</span>&nbsp;<span class="builtintype" id="4425627">bool</span>&nbsp;<span class="op" id="4425632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4425635">switch</span>&nbsp;<span class="ident" id="4425642">k</span>&nbsp;<span class="op" id="4425644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4425647">case</span>&nbsp;<span class="ident" id="4425652">reflect</span><span class="op" id="4425659">.</span><span class="ident" id="4425660">Int</span><span class="op" id="4425663">,</span>&nbsp;<span class="ident" id="4425665">reflect</span><span class="op" id="4425672">.</span><span class="ident" id="4425673">Int8</span><span class="op" id="4425677">,</span>&nbsp;<span class="ident" id="4425679">reflect</span><span class="op" id="4425686">.</span><span class="ident" id="4425687">Int16</span><span class="op" id="4425692">,</span>&nbsp;<span class="ident" id="4425694">reflect</span><span class="op" id="4425701">.</span><span class="ident" id="4425702">Int32</span><span class="op" id="4425707">,</span>&nbsp;<span class="ident" id="4425709">reflect</span><span class="op" id="4425716">.</span><span class="ident" id="4425717">Int64</span><span class="op" id="4425722">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4425726">return</span>&nbsp;<span class="builtintype" id="4425733">true</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4425739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4425743">return</span>&nbsp;<span class="builtintype" id="4425750">false</span><br>
<span class="lineno"></span><span class="op" id="4425756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="4425759">//&nbsp;setDefaultValue&nbsp;is&nbsp;used&nbsp;to&nbsp;install&nbsp;a&nbsp;default&nbsp;value,&nbsp;from&nbsp;a&nbsp;tag&nbsp;string,&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="4425838">//&nbsp;a&nbsp;Value.&nbsp;It&nbsp;is&nbsp;successful&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;optional,&nbsp;even&nbsp;if&nbsp;a&nbsp;default&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4425918">//&nbsp;wasn&#39;t&nbsp;provided&nbsp;or&nbsp;it&nbsp;failed&nbsp;to&nbsp;install&nbsp;it&nbsp;into&nbsp;the&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4425980">func</span>&nbsp;<span class="ident" id="4425985">setDefaultValue</span><span class="op" id="4426000">(</span><span class="ident" id="4426001">v</span>&nbsp;<span class="ident" id="4426003">reflect</span><span class="op" id="4426010">.</span><span class="ident" id="4426011">Value</span><span class="op" id="4426016">,</span>&nbsp;<span class="ident" id="4426018">params</span>&nbsp;<span class="ident" id="4426025">fieldParameters</span><span class="op" id="4426040">)</span>&nbsp;<span class="op" id="4426042">(</span><span class="ident" id="4426043">ok</span>&nbsp;<span class="builtintype" id="4426046">bool</span><span class="op" id="4426050">)</span>&nbsp;<span class="op" id="4426052">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4426055">if</span>&nbsp;<span class="op" id="4426058">!</span><span class="ident" id="4426059">params</span><span class="op" id="4426065">.</span><span class="ident" id="4426066">optional</span>&nbsp;<span class="op" id="4426075">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4426079">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4426087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426090">ok</span>&nbsp;<span class="op" id="4426093">=</span>&nbsp;<span class="builtintype" id="4426095">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4426101">if</span>&nbsp;<span class="ident" id="4426104">params</span><span class="op" id="4426110">.</span><span class="ident" id="4426111">defaultValue</span>&nbsp;<span class="op" id="4426124">==</span>&nbsp;<span class="ident" id="4426127">nil</span>&nbsp;<span class="op" id="4426131">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4426135">return</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4426143">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4426146">if</span>&nbsp;<span class="ident" id="4426149">canHaveDefaultValue</span><span class="op" id="4426168">(</span><span class="ident" id="4426169">v</span><span class="op" id="4426170">.</span><span class="ident" id="4426171">Kind</span><span class="op" id="4426175">(</span><span class="op" id="4426176">)</span><span class="op" id="4426177">)</span>&nbsp;<span class="op" id="4426179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4426183">v</span><span class="op" id="4426184">.</span><span class="ident" id="4426185">SetInt</span><span class="op" id="4426191">(</span><span class="op" id="4426192">*</span><span class="ident" id="4426193">params</span><span class="op" id="4426199">.</span><span class="ident" id="4426200">defaultValue</span><span class="op" id="4426212">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4426215">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4426218">return</span><br>
<span class="lineno">855</span><span class="op" id="4426225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4426228">//&nbsp;Unmarshal&nbsp;parses&nbsp;the&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structure&nbsp;b</span><br>
<span class="lineno"></span><span class="comment" id="4426287">//&nbsp;and&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package&nbsp;to&nbsp;fill&nbsp;in&nbsp;an&nbsp;arbitrary&nbsp;value&nbsp;pointed&nbsp;at&nbsp;by&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="4426368">//&nbsp;Because&nbsp;Unmarshal&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package,&nbsp;the&nbsp;structs</span><br>
<span class="lineno">860</span><span class="comment" id="4426427">//&nbsp;being&nbsp;written&nbsp;to&nbsp;must&nbsp;use&nbsp;upper&nbsp;case&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span><span class="comment" id="4426480">//</span><br>
<span class="lineno"></span><span class="comment" id="4426483">//&nbsp;An&nbsp;ASN.1&nbsp;INTEGER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;int,&nbsp;int32,&nbsp;int64,</span><br>
<span class="lineno"></span><span class="comment" id="4426543">//&nbsp;or&nbsp;*big.Int&nbsp;(from&nbsp;the&nbsp;math/big&nbsp;package).</span><br>
<span class="lineno"></span><span class="comment" id="4426587">//&nbsp;If&nbsp;the&nbsp;encoded&nbsp;value&nbsp;does&nbsp;not&nbsp;fit&nbsp;in&nbsp;the&nbsp;Go&nbsp;type,</span><br>
<span class="lineno">865</span><span class="comment" id="4426640">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4426676">//</span><br>
<span class="lineno"></span><span class="comment" id="4426679">//&nbsp;An&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="comment" id="4426733">//</span><br>
<span class="lineno"></span><span class="comment" id="4426736">//&nbsp;An&nbsp;ASN.1&nbsp;OCTET&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;[]byte.</span><br>
<span class="lineno">870</span><span class="comment" id="4426789">//</span><br>
<span class="lineno"></span><span class="comment" id="4426792">//&nbsp;An&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4426843">//&nbsp;ObjectIdentifier.</span><br>
<span class="lineno"></span><span class="comment" id="4426864">//</span><br>
<span class="lineno"></span><span class="comment" id="4426867">//&nbsp;An&nbsp;ASN.1&nbsp;ENUMERATED&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;Enumerated.</span><br>
<span class="lineno">875</span><span class="comment" id="4426923">//</span><br>
<span class="lineno"></span><span class="comment" id="4426926">//&nbsp;An&nbsp;ASN.1&nbsp;UTCTIME&nbsp;or&nbsp;GENERALIZEDTIME&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;time.Time.</span><br>
<span class="lineno"></span><span class="comment" id="4426996">//</span><br>
<span class="lineno"></span><span class="comment" id="4426999">//&nbsp;An&nbsp;ASN.1&nbsp;PrintableString&nbsp;or&nbsp;IA5String&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="4427068">//</span><br>
<span class="lineno">880</span><span class="comment" id="4427071">//&nbsp;Any&nbsp;of&nbsp;the&nbsp;above&nbsp;ASN.1&nbsp;values&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="4427138">//&nbsp;The&nbsp;value&nbsp;stored&nbsp;in&nbsp;the&nbsp;interface&nbsp;has&nbsp;the&nbsp;corresponding&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4427206">//&nbsp;For&nbsp;integers,&nbsp;that&nbsp;type&nbsp;is&nbsp;int64.</span><br>
<span class="lineno"></span><span class="comment" id="4427243">//</span><br>
<span class="lineno"></span><span class="comment" id="4427246">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;OF&nbsp;x&nbsp;or&nbsp;SET&nbsp;OF&nbsp;x&nbsp;can&nbsp;be&nbsp;written</span><br>
<span class="lineno">885</span><span class="comment" id="4427299">//&nbsp;to&nbsp;a&nbsp;slice&nbsp;if&nbsp;an&nbsp;x&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;the&nbsp;slice&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4427365">//</span><br>
<span class="lineno"></span><span class="comment" id="4427368">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;or&nbsp;SET&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="4427423">//&nbsp;if&nbsp;each&nbsp;of&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;sequence&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4427473">//&nbsp;written&nbsp;to&nbsp;the&nbsp;corresponding&nbsp;element&nbsp;in&nbsp;the&nbsp;struct.</span><br>
<span class="lineno">890</span><span class="comment" id="4427528">//</span><br>
<span class="lineno"></span><span class="comment" id="4427531">//&nbsp;The&nbsp;following&nbsp;tags&nbsp;on&nbsp;struct&nbsp;fields&nbsp;have&nbsp;special&nbsp;meaning&nbsp;to&nbsp;Unmarshal:</span><br>
<span class="lineno"></span><span class="comment" id="4427605">//</span><br>
<span class="lineno"></span><span class="comment" id="4427608">//&nbsp;&nbsp;&nbsp;&nbspapplication&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;a&nbsp;APPLICATION&nbsp;tag&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="4427664">//&nbsp;&nbsp;&nbsp;&nbspdefault:x&nbsp;&nbsp;&nbsp;&nbspsets&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;optional&nbsp;integer&nbsp;fields</span><br>
<span class="lineno">895</span><span class="comment" id="4427728">//&nbsp;&nbsp;&nbsp;&nbspexplicit&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;an&nbsp;additional,&nbsp;explicit&nbsp;tag&nbsp;wraps&nbsp;the&nbsp;implicit&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="4427806">//&nbsp;&nbsp;&nbsp;&nbspoptional&nbsp;&nbsp;&nbsp;&nbspmarks&nbsp;the&nbsp;field&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL</span><br>
<span class="lineno"></span><span class="comment" id="4427852">//&nbsp;&nbsp;&nbsp;&nbspset&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;a&nbsp;SET,&nbsp;rather&nbsp;than&nbsp;a&nbsp;SEQUENCE&nbsp;type&nbsp;to&nbsp;be&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="4427917">//&nbsp;&nbsp;&nbsp;&nbsptag:x&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;the&nbsp;ASN.1&nbsp;tag&nbsp;number;&nbsp;implies&nbsp;ASN.1&nbsp;CONTEXT&nbsp;SPECIFIC</span><br>
<span class="lineno"></span><span class="comment" id="4427990">//</span><br>
<span class="lineno">900</span><span class="comment" id="4427993">//&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;a&nbsp;structure&nbsp;is&nbsp;RawContent&nbsp;then&nbsp;the&nbsp;raw</span><br>
<span class="lineno"></span><span class="comment" id="4428069">//&nbsp;ASN1&nbsp;contents&nbsp;of&nbsp;the&nbsp;struct&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4428122">//</span><br>
<span class="lineno"></span><span class="comment" id="4428125">//&nbsp;If&nbsp;the&nbsp;type&nbsp;name&nbsp;of&nbsp;a&nbsp;slice&nbsp;element&nbsp;ends&nbsp;with&nbsp;&#34;SET&#34;&nbsp;then&nbsp;it&#39;s&nbsp;treated&nbsp;as&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="4428204">//&nbsp;the&nbsp;&#34;set&#34;&nbsp;tag&nbsp;was&nbsp;set&nbsp;on&nbsp;it.&nbsp;This&nbsp;can&nbsp;be&nbsp;used&nbsp;with&nbsp;nested&nbsp;slices&nbsp;where&nbsp;a</span><br>
<span class="lineno">905</span><span class="comment" id="4428280">//&nbsp;struct&nbsp;tag&nbsp;cannot&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="comment" id="4428311">//</span><br>
<span class="lineno"></span><span class="comment" id="4428314">//&nbsp;Other&nbsp;ASN.1&nbsp;types&nbsp;are&nbsp;not&nbsp;supported;&nbsp;if&nbsp;it&nbsp;encounters&nbsp;them,</span><br>
<span class="lineno"></span><span class="comment" id="4428377">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4428413">func</span>&nbsp;<span class="ident" id="4428418">Unmarshal</span><span class="op" id="4428427">(</span><span class="ident" id="4428428">b</span>&nbsp;<span class="op" id="4428430">[</span><span class="op" id="4428431">]</span><span class="builtintype" id="4428432">byte</span><span class="op" id="4428436">,</span>&nbsp;<span class="ident" id="4428438">val</span>&nbsp;<span class="keyword" id="4428442">interface</span><span class="op" id="4428451">{</span><span class="op" id="4428452">}</span><span class="op" id="4428453">)</span>&nbsp;<span class="op" id="4428455">(</span><span class="ident" id="4428456">rest</span>&nbsp;<span class="op" id="4428461">[</span><span class="op" id="4428462">]</span><span class="builtintype" id="4428463">byte</span><span class="op" id="4428467">,</span>&nbsp;<span class="ident" id="4428469">err</span>&nbsp;<span class="builtintype" id="4428473">error</span><span class="op" id="4428478">)</span>&nbsp;<span class="op" id="4428480">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4428483">return</span>&nbsp;<span class="ident" id="4428490">UnmarshalWithParams</span><span class="op" id="4428509">(</span><span class="ident" id="4428510">b</span><span class="op" id="4428511">,</span>&nbsp;<span class="ident" id="4428513">val</span><span class="op" id="4428516">,</span>&nbsp;<span class="string" id="4428518">&#34;&#34;</span><span class="op" id="4428520">)</span><br>
<span class="lineno"></span><span class="op" id="4428522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4428525">//&nbsp;UnmarshalWithParams&nbsp;allows&nbsp;field&nbsp;parameters&nbsp;to&nbsp;be&nbsp;specified&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4428596">//&nbsp;top-level&nbsp;element.&nbsp;The&nbsp;form&nbsp;of&nbsp;the&nbsp;params&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;field&nbsp;tags.</span><br>
<span class="lineno">915</span><span class="keyword" id="4428672">func</span>&nbsp;<span class="ident" id="4428677">UnmarshalWithParams</span><span class="op" id="4428696">(</span><span class="ident" id="4428697">b</span>&nbsp;<span class="op" id="4428699">[</span><span class="op" id="4428700">]</span><span class="builtintype" id="4428701">byte</span><span class="op" id="4428705">,</span>&nbsp;<span class="ident" id="4428707">val</span>&nbsp;<span class="keyword" id="4428711">interface</span><span class="op" id="4428720">{</span><span class="op" id="4428721">}</span><span class="op" id="4428722">,</span>&nbsp;<span class="ident" id="4428724">params</span>&nbsp;<span class="builtintype" id="4428731">string</span><span class="op" id="4428737">)</span>&nbsp;<span class="op" id="4428739">(</span><span class="ident" id="4428740">rest</span>&nbsp;<span class="op" id="4428745">[</span><span class="op" id="4428746">]</span><span class="builtintype" id="4428747">byte</span><span class="op" id="4428751">,</span>&nbsp;<span class="ident" id="4428753">err</span>&nbsp;<span class="builtintype" id="4428757">error</span><span class="op" id="4428762">)</span>&nbsp;<span class="op" id="4428764">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428767">v</span>&nbsp;<span class="op" id="4428769">:=</span>&nbsp;<span class="ident" id="4428772">reflect</span><span class="op" id="4428779">.</span><span class="ident" id="4428780">ValueOf</span><span class="op" id="4428787">(</span><span class="ident" id="4428788">val</span><span class="op" id="4428791">)</span><span class="op" id="4428792">.</span><span class="ident" id="4428793">Elem</span><span class="op" id="4428797">(</span><span class="op" id="4428798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4428801">offset</span><span class="op" id="4428807">,</span>&nbsp;<span class="ident" id="4428809">err</span>&nbsp;<span class="op" id="4428813">:=</span>&nbsp;<span class="ident" id="4428816">parseField</span><span class="op" id="4428826">(</span><span class="ident" id="4428827">v</span><span class="op" id="4428828">,</span>&nbsp;<span class="ident" id="4428830">b</span><span class="op" id="4428831">,</span>&nbsp;<span class="num" id="4428833">0</span><span class="op" id="4428834">,</span>&nbsp;<span class="ident" id="4428836">parseFieldParameters</span><span class="op" id="4428856">(</span><span class="ident" id="4428857">params</span><span class="op" id="4428863">)</span><span class="op" id="4428864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4428867">if</span>&nbsp;<span class="ident" id="4428870">err</span>&nbsp;<span class="op" id="4428874">!=</span>&nbsp;<span class="ident" id="4428877">nil</span>&nbsp;<span class="op" id="4428881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4428885">return</span>&nbsp;<span class="ident" id="4428892">nil</span><span class="op" id="4428895">,</span>&nbsp;<span class="ident" id="4428897">err</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4428902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4428905">return</span>&nbsp;<span class="ident" id="4428912">b</span><span class="op" id="4428913">[</span><span class="ident" id="4428914">offset</span><span class="op" id="4428920">:</span><span class="op" id="4428921">]</span><span class="op" id="4428922">,</span>&nbsp;<span class="ident" id="4428924">nil</span><br>
<span class="lineno"></span><span class="op" id="4428928">}</span>
</div>
</body>
</html>
