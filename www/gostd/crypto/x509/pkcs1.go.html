<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/x509</h2>
<ul>
<li><a href="/gostd/crypto/x509/cert_pool.go.html">cert_pool.go</a></li>
<li><a href="/gostd/crypto/x509/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt.go.html">pem_decrypt.go</a></li>
<li><a href="/gostd/crypto/x509/pem_decrypt_test.go.html">pem_decrypt_test.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs1.go.html">pkcs1.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8.go.html">pkcs8.go</a></li>
<li><a href="/gostd/crypto/x509/pkcs8_test.go.html">pkcs8_test.go</a></li>
<li><a href="/gostd/crypto/x509/root.go.html">root.go</a></li>
<li><a href="/gostd/crypto/x509/root_unix.go.html">root_unix.go</a></li>
<li><a href="/gostd/crypto/x509/sec1.go.html">sec1.go</a></li>
<li><a href="/gostd/crypto/x509/sec1_test.go.html">sec1_test.go</a></li>
<li><a href="/gostd/crypto/x509/verify.go.html">verify.go</a></li>
<li><a href="/gostd/crypto/x509/verify_test.go.html">verify_test.go</a></li>
<li><a href="/gostd/crypto/x509/x509.go.html">x509.go</a></li>
<li><a href="/gostd/crypto/x509/x509_test.go.html">x509_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4617356">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4617411">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4617465">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4617516">package</span>&nbsp;<span class="ident" id="4617524">x509</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4617530">import</span>&nbsp;<span class="op" id="4617537">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4617540">&#34;crypto/rsa&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4617554">&#34;encoding/asn1&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4617571">&#34;errors&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4617581">&#34;math/big&#34;</span><br>
<span class="lineno"></span><span class="op" id="4617592">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4617595">//&nbsp;pkcs1PrivateKey&nbsp;is&nbsp;a&nbsp;structure&nbsp;which&nbsp;mirrors&nbsp;the&nbsp;PKCS#1&nbsp;ASN.1&nbsp;for&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key.</span><br>
<span class="lineno">15</span><span class="keyword" id="4617684">type</span>&nbsp;<span class="ident" id="4617689">pkcs1PrivateKey</span>&nbsp;<span class="keyword" id="4617705">struct</span>&nbsp;<span class="op" id="4617712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4617715">Version</span>&nbsp;<span class="builtintype" id="4617723">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4617728">N</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4617736">*</span><span class="ident" id="4617737">big</span><span class="op" id="4617740">.</span><span class="ident" id="4617741">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4617746">E</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4617754">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4617759">D</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4617767">*</span><span class="ident" id="4617768">big</span><span class="op" id="4617771">.</span><span class="ident" id="4617772">Int</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4617777">P</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4617785">*</span><span class="ident" id="4617786">big</span><span class="op" id="4617789">.</span><span class="ident" id="4617790">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4617795">Q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4617803">*</span><span class="ident" id="4617804">big</span><span class="op" id="4617807">.</span><span class="ident" id="4617808">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4617813">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values,&nbsp;if&nbsp;present,&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4617886">Dp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4617891">*</span><span class="ident" id="4617892">big</span><span class="op" id="4617895">.</span><span class="ident" id="4617896">Int</span>&nbsp;<span class="string" id="4617900">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4617919">Dq</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4617924">*</span><span class="ident" id="4617925">big</span><span class="op" id="4617928">.</span><span class="ident" id="4617929">Int</span>&nbsp;<span class="string" id="4617933">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4617952">Qinv</span>&nbsp;<span class="op" id="4617957">*</span><span class="ident" id="4617958">big</span><span class="op" id="4617961">.</span><span class="ident" id="4617962">Int</span>&nbsp;<span class="string" id="4617966">`asn1:&#34;optional&#34;`</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4617986">AdditionalPrimes</span>&nbsp;<span class="op" id="4618003">[</span><span class="op" id="4618004">]</span><span class="ident" id="4618005">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="string" id="4618029">`asn1:&#34;optional,omitempty&#34;`</span><br>
<span class="lineno"></span><span class="op" id="4618057">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="keyword" id="4618060">type</span>&nbsp;<span class="ident" id="4618065">pkcs1AdditionalRSAPrime</span>&nbsp;<span class="keyword" id="4618089">struct</span>&nbsp;<span class="op" id="4618096">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618099">Prime</span>&nbsp;<span class="op" id="4618105">*</span><span class="ident" id="4618106">big</span><span class="op" id="4618109">.</span><span class="ident" id="4618110">Int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4618116">//&nbsp;We&nbsp;ignore&nbsp;these&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate&nbsp;them.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618176">Exp</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4618182">*</span><span class="ident" id="4618183">big</span><span class="op" id="4618186">.</span><span class="ident" id="4618187">Int</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618192">Coeff</span>&nbsp;<span class="op" id="4618198">*</span><span class="ident" id="4618199">big</span><span class="op" id="4618202">.</span><span class="ident" id="4618203">Int</span><br>
<span class="lineno"></span><span class="op" id="4618207">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4618210">//&nbsp;ParsePKCS1PrivateKey&nbsp;returns&nbsp;an&nbsp;RSA&nbsp;private&nbsp;key&nbsp;from&nbsp;its&nbsp;ASN.1&nbsp;PKCS#1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4618301">func</span>&nbsp;<span class="ident" id="4618306">ParsePKCS1PrivateKey</span><span class="op" id="4618326">(</span><span class="ident" id="4618327">der</span>&nbsp;<span class="op" id="4618331">[</span><span class="op" id="4618332">]</span><span class="builtintype" id="4618333">byte</span><span class="op" id="4618337">)</span>&nbsp;<span class="op" id="4618339">(</span><span class="ident" id="4618340">key</span>&nbsp;<span class="op" id="4618344">*</span><span class="ident" id="4618345">rsa</span><span class="op" id="4618348">.</span><span class="ident" id="4618349">PrivateKey</span><span class="op" id="4618359">,</span>&nbsp;<span class="ident" id="4618361">err</span>&nbsp;<span class="builtintype" id="4618365">error</span><span class="op" id="4618370">)</span>&nbsp;<span class="op" id="4618372">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4618375">var</span>&nbsp;<span class="ident" id="4618379">priv</span>&nbsp;<span class="ident" id="4618384">pkcs1PrivateKey</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618401">rest</span><span class="op" id="4618405">,</span>&nbsp;<span class="ident" id="4618407">err</span>&nbsp;<span class="op" id="4618411">:=</span>&nbsp;<span class="ident" id="4618414">asn1</span><span class="op" id="4618418">.</span><span class="ident" id="4618419">Unmarshal</span><span class="op" id="4618428">(</span><span class="ident" id="4618429">der</span><span class="op" id="4618432">,</span>&nbsp;<span class="op" id="4618434">&amp;</span><span class="ident" id="4618435">priv</span><span class="op" id="4618439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4618442">if</span>&nbsp;<span class="builtinfunc" id="4618445">len</span><span class="op" id="4618448">(</span><span class="ident" id="4618449">rest</span><span class="op" id="4618453">)</span>&nbsp;<span class="op" id="4618455">&gt;</span>&nbsp;<span class="num" id="4618457">0</span>&nbsp;<span class="op" id="4618459">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618463">err</span>&nbsp;<span class="op" id="4618467">=</span>&nbsp;<span class="ident" id="4618469">asn1</span><span class="op" id="4618473">.</span><span class="ident" id="4618474">SyntaxError</span><span class="op" id="4618485">{</span><span class="ident" id="4618486">Msg</span><span class="op" id="4618489">:</span>&nbsp;<span class="string" id="4618491">&#34;trailing&nbsp;data&#34;</span><span class="op" id="4618506">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4618510">return</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4618518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4618521">if</span>&nbsp;<span class="ident" id="4618524">err</span>&nbsp;<span class="op" id="4618528">!=</span>&nbsp;<span class="ident" id="4618531">nil</span>&nbsp;<span class="op" id="4618535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4618539">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4618547">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4618551">if</span>&nbsp;<span class="ident" id="4618554">priv</span><span class="op" id="4618558">.</span><span class="ident" id="4618559">Version</span>&nbsp;<span class="op" id="4618567">&gt;</span>&nbsp;<span class="num" id="4618569">1</span>&nbsp;<span class="op" id="4618571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4618575">return</span>&nbsp;<span class="ident" id="4618582">nil</span><span class="op" id="4618585">,</span>&nbsp;<span class="ident" id="4618587">errors</span><span class="op" id="4618593">.</span><span class="ident" id="4618594">New</span><span class="op" id="4618597">(</span><span class="string" id="4618598">&#34;x509:&nbsp;unsupported&nbsp;private&nbsp;key&nbsp;version&#34;</span><span class="op" id="4618637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4618640">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4618644">if</span>&nbsp;<span class="ident" id="4618647">priv</span><span class="op" id="4618651">.</span><span class="ident" id="4618652">N</span><span class="op" id="4618653">.</span><span class="ident" id="4618654">Sign</span><span class="op" id="4618658">(</span><span class="op" id="4618659">)</span>&nbsp;<span class="op" id="4618661">&lt;=</span>&nbsp;<span class="num" id="4618664">0</span>&nbsp;<span class="op" id="4618666">||</span>&nbsp;<span class="ident" id="4618669">priv</span><span class="op" id="4618673">.</span><span class="ident" id="4618674">D</span><span class="op" id="4618675">.</span><span class="ident" id="4618676">Sign</span><span class="op" id="4618680">(</span><span class="op" id="4618681">)</span>&nbsp;<span class="op" id="4618683">&lt;=</span>&nbsp;<span class="num" id="4618686">0</span>&nbsp;<span class="op" id="4618688">||</span>&nbsp;<span class="ident" id="4618691">priv</span><span class="op" id="4618695">.</span><span class="ident" id="4618696">P</span><span class="op" id="4618697">.</span><span class="ident" id="4618698">Sign</span><span class="op" id="4618702">(</span><span class="op" id="4618703">)</span>&nbsp;<span class="op" id="4618705">&lt;=</span>&nbsp;<span class="num" id="4618708">0</span>&nbsp;<span class="op" id="4618710">||</span>&nbsp;<span class="ident" id="4618713">priv</span><span class="op" id="4618717">.</span><span class="ident" id="4618718">Q</span><span class="op" id="4618719">.</span><span class="ident" id="4618720">Sign</span><span class="op" id="4618724">(</span><span class="op" id="4618725">)</span>&nbsp;<span class="op" id="4618727">&lt;=</span>&nbsp;<span class="num" id="4618730">0</span>&nbsp;<span class="op" id="4618732">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4618736">return</span>&nbsp;<span class="ident" id="4618743">nil</span><span class="op" id="4618746">,</span>&nbsp;<span class="ident" id="4618748">errors</span><span class="op" id="4618754">.</span><span class="ident" id="4618755">New</span><span class="op" id="4618758">(</span><span class="string" id="4618759">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;value&#34;</span><span class="op" id="4618810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4618813">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618817">key</span>&nbsp;<span class="op" id="4618821">=</span>&nbsp;<span class="builtinfunc" id="4618823">new</span><span class="op" id="4618826">(</span><span class="ident" id="4618827">rsa</span><span class="op" id="4618830">.</span><span class="ident" id="4618831">PrivateKey</span><span class="op" id="4618841">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618844">key</span><span class="op" id="4618847">.</span><span class="ident" id="4618848">PublicKey</span>&nbsp;<span class="op" id="4618858">=</span>&nbsp;<span class="ident" id="4618860">rsa</span><span class="op" id="4618863">.</span><span class="ident" id="4618864">PublicKey</span><span class="op" id="4618873">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618877">E</span><span class="op" id="4618878">:</span>&nbsp;<span class="ident" id="4618880">priv</span><span class="op" id="4618884">.</span><span class="ident" id="4618885">E</span><span class="op" id="4618886">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618890">N</span><span class="op" id="4618891">:</span>&nbsp;<span class="ident" id="4618893">priv</span><span class="op" id="4618897">.</span><span class="ident" id="4618898">N</span><span class="op" id="4618899">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4618902">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618906">key</span><span class="op" id="4618909">.</span><span class="ident" id="4618910">D</span>&nbsp;<span class="op" id="4618912">=</span>&nbsp;<span class="ident" id="4618914">priv</span><span class="op" id="4618918">.</span><span class="ident" id="4618919">D</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618922">key</span><span class="op" id="4618925">.</span><span class="ident" id="4618926">Primes</span>&nbsp;<span class="op" id="4618933">=</span>&nbsp;<span class="builtinfunc" id="4618935">make</span><span class="op" id="4618939">(</span><span class="op" id="4618940">[</span><span class="op" id="4618941">]</span><span class="op" id="4618942">*</span><span class="ident" id="4618943">big</span><span class="op" id="4618946">.</span><span class="ident" id="4618947">Int</span><span class="op" id="4618950">,</span>&nbsp;<span class="num" id="4618952">2</span><span class="op" id="4618953">+</span><span class="builtinfunc" id="4618954">len</span><span class="op" id="4618957">(</span><span class="ident" id="4618958">priv</span><span class="op" id="4618962">.</span><span class="ident" id="4618963">AdditionalPrimes</span><span class="op" id="4618979">)</span><span class="op" id="4618980">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618983">key</span><span class="op" id="4618986">.</span><span class="ident" id="4618987">Primes</span><span class="op" id="4618993">[</span><span class="num" id="4618994">0</span><span class="op" id="4618995">]</span>&nbsp;<span class="op" id="4618997">=</span>&nbsp;<span class="ident" id="4618999">priv</span><span class="op" id="4619003">.</span><span class="ident" id="4619004">P</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619007">key</span><span class="op" id="4619010">.</span><span class="ident" id="4619011">Primes</span><span class="op" id="4619017">[</span><span class="num" id="4619018">1</span><span class="op" id="4619019">]</span>&nbsp;<span class="op" id="4619021">=</span>&nbsp;<span class="ident" id="4619023">priv</span><span class="op" id="4619027">.</span><span class="ident" id="4619028">Q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619031">for</span>&nbsp;<span class="ident" id="4619035">i</span><span class="op" id="4619036">,</span>&nbsp;<span class="ident" id="4619038">a</span>&nbsp;<span class="op" id="4619040">:=</span>&nbsp;<span class="keyword" id="4619043">range</span>&nbsp;<span class="ident" id="4619049">priv</span><span class="op" id="4619053">.</span><span class="ident" id="4619054">AdditionalPrimes</span>&nbsp;<span class="op" id="4619071">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619075">if</span>&nbsp;<span class="ident" id="4619078">a</span><span class="op" id="4619079">.</span><span class="ident" id="4619080">Prime</span><span class="op" id="4619085">.</span><span class="ident" id="4619086">Sign</span><span class="op" id="4619090">(</span><span class="op" id="4619091">)</span>&nbsp;<span class="op" id="4619093">&lt;=</span>&nbsp;<span class="num" id="4619096">0</span>&nbsp;<span class="op" id="4619098">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619103">return</span>&nbsp;<span class="ident" id="4619110">nil</span><span class="op" id="4619113">,</span>&nbsp;<span class="ident" id="4619115">errors</span><span class="op" id="4619121">.</span><span class="ident" id="4619122">New</span><span class="op" id="4619125">(</span><span class="string" id="4619126">&#34;x509:&nbsp;private&nbsp;key&nbsp;contains&nbsp;zero&nbsp;or&nbsp;negative&nbsp;prime&#34;</span><span class="op" id="4619177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4619181">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619185">key</span><span class="op" id="4619188">.</span><span class="ident" id="4619189">Primes</span><span class="op" id="4619195">[</span><span class="ident" id="4619196">i</span><span class="op" id="4619197">+</span><span class="num" id="4619198">2</span><span class="op" id="4619199">]</span>&nbsp;<span class="op" id="4619201">=</span>&nbsp;<span class="ident" id="4619203">a</span><span class="op" id="4619204">.</span><span class="ident" id="4619205">Prime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4619213">//&nbsp;We&nbsp;ignore&nbsp;the&nbsp;other&nbsp;two&nbsp;values&nbsp;because&nbsp;rsa&nbsp;will&nbsp;calculate</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4619276">//&nbsp;them&nbsp;as&nbsp;needed.</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4619296">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619300">err</span>&nbsp;<span class="op" id="4619304">=</span>&nbsp;<span class="ident" id="4619306">key</span><span class="op" id="4619309">.</span><span class="ident" id="4619310">Validate</span><span class="op" id="4619318">(</span><span class="op" id="4619319">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619322">if</span>&nbsp;<span class="ident" id="4619325">err</span>&nbsp;<span class="op" id="4619329">!=</span>&nbsp;<span class="ident" id="4619332">nil</span>&nbsp;<span class="op" id="4619336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619340">return</span>&nbsp;<span class="ident" id="4619347">nil</span><span class="op" id="4619350">,</span>&nbsp;<span class="ident" id="4619352">err</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4619357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619360">key</span><span class="op" id="4619363">.</span><span class="ident" id="4619364">Precompute</span><span class="op" id="4619374">(</span><span class="op" id="4619375">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619379">return</span><br>
<span class="lineno"></span><span class="op" id="4619386">}</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="4619389">//&nbsp;MarshalPKCS1PrivateKey&nbsp;converts&nbsp;a&nbsp;private&nbsp;key&nbsp;to&nbsp;ASN.1&nbsp;DER&nbsp;encoded&nbsp;form.</span><br>
<span class="lineno"></span><span class="keyword" id="4619465">func</span>&nbsp;<span class="ident" id="4619470">MarshalPKCS1PrivateKey</span><span class="op" id="4619492">(</span><span class="ident" id="4619493">key</span>&nbsp;<span class="op" id="4619497">*</span><span class="ident" id="4619498">rsa</span><span class="op" id="4619501">.</span><span class="ident" id="4619502">PrivateKey</span><span class="op" id="4619512">)</span>&nbsp;<span class="op" id="4619514">[</span><span class="op" id="4619515">]</span><span class="builtintype" id="4619516">byte</span>&nbsp;<span class="op" id="4619521">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619524">key</span><span class="op" id="4619527">.</span><span class="ident" id="4619528">Precompute</span><span class="op" id="4619538">(</span><span class="op" id="4619539">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619543">version</span>&nbsp;<span class="op" id="4619551">:=</span>&nbsp;<span class="num" id="4619554">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619557">if</span>&nbsp;<span class="builtinfunc" id="4619560">len</span><span class="op" id="4619563">(</span><span class="ident" id="4619564">key</span><span class="op" id="4619567">.</span><span class="ident" id="4619568">Primes</span><span class="op" id="4619574">)</span>&nbsp;<span class="op" id="4619576">&gt;</span>&nbsp;<span class="num" id="4619578">2</span>&nbsp;<span class="op" id="4619580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619584">version</span>&nbsp;<span class="op" id="4619592">=</span>&nbsp;<span class="num" id="4619594">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4619597">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619601">priv</span>&nbsp;<span class="op" id="4619606">:=</span>&nbsp;<span class="ident" id="4619609">pkcs1PrivateKey</span><span class="op" id="4619624">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619628">Version</span><span class="op" id="4619635">:</span>&nbsp;<span class="ident" id="4619637">version</span><span class="op" id="4619644">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619648">N</span><span class="op" id="4619649">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619657">key</span><span class="op" id="4619660">.</span><span class="ident" id="4619661">N</span><span class="op" id="4619662">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619666">E</span><span class="op" id="4619667">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619675">key</span><span class="op" id="4619678">.</span><span class="ident" id="4619679">PublicKey</span><span class="op" id="4619688">.</span><span class="ident" id="4619689">E</span><span class="op" id="4619690">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619694">D</span><span class="op" id="4619695">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619703">key</span><span class="op" id="4619706">.</span><span class="ident" id="4619707">D</span><span class="op" id="4619708">,</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619712">P</span><span class="op" id="4619713">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619721">key</span><span class="op" id="4619724">.</span><span class="ident" id="4619725">Primes</span><span class="op" id="4619731">[</span><span class="num" id="4619732">0</span><span class="op" id="4619733">]</span><span class="op" id="4619734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619738">Q</span><span class="op" id="4619739">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619747">key</span><span class="op" id="4619750">.</span><span class="ident" id="4619751">Primes</span><span class="op" id="4619757">[</span><span class="num" id="4619758">1</span><span class="op" id="4619759">]</span><span class="op" id="4619760">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619764">Dp</span><span class="op" id="4619766">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619773">key</span><span class="op" id="4619776">.</span><span class="ident" id="4619777">Precomputed</span><span class="op" id="4619788">.</span><span class="ident" id="4619789">Dp</span><span class="op" id="4619791">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619795">Dq</span><span class="op" id="4619797">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619804">key</span><span class="op" id="4619807">.</span><span class="ident" id="4619808">Precomputed</span><span class="op" id="4619819">.</span><span class="ident" id="4619820">Dq</span><span class="op" id="4619822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619826">Qinv</span><span class="op" id="4619830">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4619835">key</span><span class="op" id="4619838">.</span><span class="ident" id="4619839">Precomputed</span><span class="op" id="4619850">.</span><span class="ident" id="4619851">Qinv</span><span class="op" id="4619855">,</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4619858">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619862">priv</span><span class="op" id="4619866">.</span><span class="ident" id="4619867">AdditionalPrimes</span>&nbsp;<span class="op" id="4619884">=</span>&nbsp;<span class="builtinfunc" id="4619886">make</span><span class="op" id="4619890">(</span><span class="op" id="4619891">[</span><span class="op" id="4619892">]</span><span class="ident" id="4619893">pkcs1AdditionalRSAPrime</span><span class="op" id="4619916">,</span>&nbsp;<span class="builtinfunc" id="4619918">len</span><span class="op" id="4619921">(</span><span class="ident" id="4619922">key</span><span class="op" id="4619925">.</span><span class="ident" id="4619926">Precomputed</span><span class="op" id="4619937">.</span><span class="ident" id="4619938">CRTValues</span><span class="op" id="4619947">)</span><span class="op" id="4619948">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619951">for</span>&nbsp;<span class="ident" id="4619955">i</span><span class="op" id="4619956">,</span>&nbsp;<span class="ident" id="4619958">values</span>&nbsp;<span class="op" id="4619965">:=</span>&nbsp;<span class="keyword" id="4619968">range</span>&nbsp;<span class="ident" id="4619974">key</span><span class="op" id="4619977">.</span><span class="ident" id="4619978">Precomputed</span><span class="op" id="4619989">.</span><span class="ident" id="4619990">CRTValues</span>&nbsp;<span class="op" id="4620000">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620004">priv</span><span class="op" id="4620008">.</span><span class="ident" id="4620009">AdditionalPrimes</span><span class="op" id="4620025">[</span><span class="ident" id="4620026">i</span><span class="op" id="4620027">]</span><span class="op" id="4620028">.</span><span class="ident" id="4620029">Prime</span>&nbsp;<span class="op" id="4620035">=</span>&nbsp;<span class="ident" id="4620037">key</span><span class="op" id="4620040">.</span><span class="ident" id="4620041">Primes</span><span class="op" id="4620047">[</span><span class="num" id="4620048">2</span><span class="op" id="4620049">+</span><span class="ident" id="4620050">i</span><span class="op" id="4620051">]</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620055">priv</span><span class="op" id="4620059">.</span><span class="ident" id="4620060">AdditionalPrimes</span><span class="op" id="4620076">[</span><span class="ident" id="4620077">i</span><span class="op" id="4620078">]</span><span class="op" id="4620079">.</span><span class="ident" id="4620080">Exp</span>&nbsp;<span class="op" id="4620084">=</span>&nbsp;<span class="ident" id="4620086">values</span><span class="op" id="4620092">.</span><span class="ident" id="4620093">Exp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620099">priv</span><span class="op" id="4620103">.</span><span class="ident" id="4620104">AdditionalPrimes</span><span class="op" id="4620120">[</span><span class="ident" id="4620121">i</span><span class="op" id="4620122">]</span><span class="op" id="4620123">.</span><span class="ident" id="4620124">Coeff</span>&nbsp;<span class="op" id="4620130">=</span>&nbsp;<span class="ident" id="4620132">values</span><span class="op" id="4620138">.</span><span class="ident" id="4620139">Coeff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4620146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620150">b</span><span class="op" id="4620151">,</span>&nbsp;<span class="ident" id="4620153">_</span>&nbsp;<span class="op" id="4620155">:=</span>&nbsp;<span class="ident" id="4620158">asn1</span><span class="op" id="4620162">.</span><span class="ident" id="4620163">Marshal</span><span class="op" id="4620170">(</span><span class="ident" id="4620171">priv</span><span class="op" id="4620175">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4620178">return</span>&nbsp;<span class="ident" id="4620185">b</span><br>
<span class="lineno"></span><span class="op" id="4620187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4620190">//&nbsp;rsaPublicKey&nbsp;reflects&nbsp;the&nbsp;ASN.1&nbsp;structure&nbsp;of&nbsp;a&nbsp;PKCS#1&nbsp;public&nbsp;key.</span><br>
<span class="lineno"></span><span class="keyword" id="4620259">type</span>&nbsp;<span class="ident" id="4620264">rsaPublicKey</span>&nbsp;<span class="keyword" id="4620277">struct</span>&nbsp;<span class="op" id="4620284">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620287">N</span>&nbsp;<span class="op" id="4620289">*</span><span class="ident" id="4620290">big</span><span class="op" id="4620293">.</span><span class="ident" id="4620294">Int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620299">E</span>&nbsp;<span class="builtintype" id="4620301">int</span><br>
<span class="lineno"></span><span class="op" id="4620305">}</span>
</div>
</body>
</html>
