<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime</h2>
<ul>
<li><a href="/gostd/runtime/alg.go.html">alg.go</a></li>
<li><a href="/gostd/runtime/append_test.go.html">append_test.go</a></li>
<li><a href="/gostd/runtime/arch_amd64.go.html">arch_amd64.go</a></li>
<li><a href="/gostd/runtime/atomic.go.html">atomic.go</a></li>
<li><a href="/gostd/runtime/cgocall.go.html">cgocall.go</a></li>
<li><a href="/gostd/runtime/cgocallback.go.html">cgocallback.go</a></li>
<li><a href="/gostd/runtime/chan.go.html">chan.go</a></li>
<li><a href="/gostd/runtime/chan_test.go.html">chan_test.go</a></li>
<li><a href="/gostd/runtime/closure_test.go.html">closure_test.go</a></li>
<li><a href="/gostd/runtime/compiler.go.html">compiler.go</a></li>
<li><a href="/gostd/runtime/complex.go.html">complex.go</a></li>
<li><a href="/gostd/runtime/complex_test.go.html">complex_test.go</a></li>
<li><a href="/gostd/runtime/cpuprof.go.html">cpuprof.go</a></li>
<li><a href="/gostd/runtime/crash_test.go.html">crash_test.go</a></li>
<li><a href="/gostd/runtime/debug.go.html">debug.go</a></li>
<li><a href="/gostd/runtime/env_posix.go.html">env_posix.go</a></li>
<li><a href="/gostd/runtime/error.go.html">error.go</a></li>
<li><a href="/gostd/runtime/export_futex_test.go.html">export_futex_test.go</a></li>
<li><a href="/gostd/runtime/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/runtime/extern.go.html">extern.go</a></li>
<li><a href="/gostd/runtime/futex_test.go.html">futex_test.go</a></li>
<li><a href="/gostd/runtime/gc_test.go.html">gc_test.go</a></li>
<li><a href="/gostd/runtime/gcinfo_test.go.html">gcinfo_test.go</a></li>
<li><a href="/gostd/runtime/hash_test.go.html">hash_test.go</a></li>
<li><a href="/gostd/runtime/hashmap.go.html">hashmap.go</a></li>
<li><a href="/gostd/runtime/hashmap_fast.go.html">hashmap_fast.go</a></li>
<li><a href="/gostd/runtime/iface.go.html">iface.go</a></li>
<li><a href="/gostd/runtime/iface_test.go.html">iface_test.go</a></li>
<li><a href="/gostd/runtime/lfstack_test.go.html">lfstack_test.go</a></li>
<li><a href="/gostd/runtime/lock_futex.go.html">lock_futex.go</a></li>
<li><a href="/gostd/runtime/malloc.go.html">malloc.go</a></li>
<li><a href="/gostd/runtime/malloc_test.go.html">malloc_test.go</a></li>
<li><a href="/gostd/runtime/map_test.go.html">map_test.go</a></li>
<li><a href="/gostd/runtime/mapspeed_test.go.html">mapspeed_test.go</a></li>
<li><a href="/gostd/runtime/mem.go.html">mem.go</a></li>
<li><a href="/gostd/runtime/memmove_linux_amd64_test.go.html">memmove_linux_amd64_test.go</a></li>
<li><a href="/gostd/runtime/memmove_test.go.html">memmove_test.go</a></li>
<li><a href="/gostd/runtime/mfinal_test.go.html">mfinal_test.go</a></li>
<li><a href="/gostd/runtime/mgc0.go.html">mgc0.go</a></li>
<li><a href="/gostd/runtime/mprof.go.html">mprof.go</a></li>
<li><a href="/gostd/runtime/netpoll.go.html">netpoll.go</a></li>
<li><a href="/gostd/runtime/netpoll_epoll.go.html">netpoll_epoll.go</a></li>
<li><a href="/gostd/runtime/norace_test.go.html">norace_test.go</a></li>
<li><a href="/gostd/runtime/os_linux.go.html">os_linux.go</a></li>
<li><a href="/gostd/runtime/panic.go.html">panic.go</a></li>
<li><a href="/gostd/runtime/parfor_test.go.html">parfor_test.go</a></li>
<li><a href="/gostd/runtime/print1.go.html">print1.go</a></li>
<li><a href="/gostd/runtime/proc.go.html">proc.go</a></li>
<li><a href="/gostd/runtime/proc_test.go.html">proc_test.go</a></li>
<li><a href="/gostd/runtime/race0.go.html">race0.go</a></li>
<li><a href="/gostd/runtime/rdebug.go.html">rdebug.go</a></li>
<li><a href="/gostd/runtime/rune.go.html">rune.go</a></li>
<li><a href="/gostd/runtime/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/runtime/runtime_linux_test.go.html">runtime_linux_test.go</a></li>
<li><a href="/gostd/runtime/runtime_test.go.html">runtime_test.go</a></li>
<li><a href="/gostd/runtime/runtime_unix_test.go.html">runtime_unix_test.go</a></li>
<li><a href="/gostd/runtime/select.go.html">select.go</a></li>
<li><a href="/gostd/runtime/sema.go.html">sema.go</a></li>
<li><a href="/gostd/runtime/signal_unix.go.html">signal_unix.go</a></li>
<li><a href="/gostd/runtime/sigpanic_unix.go.html">sigpanic_unix.go</a></li>
<li><a href="/gostd/runtime/sigqueue.go.html">sigqueue.go</a></li>
<li><a href="/gostd/runtime/slice.go.html">slice.go</a></li>
<li><a href="/gostd/runtime/softfloat64.go.html">softfloat64.go</a></li>
<li><a href="/gostd/runtime/softfloat64_test.go.html">softfloat64_test.go</a></li>
<li><a href="/gostd/runtime/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/runtime/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/string.go.html">string.go</a></li>
<li><a href="/gostd/runtime/string_test.go.html">string_test.go</a></li>
<li><a href="/gostd/runtime/stubs.go.html">stubs.go</a></li>
<li><a href="/gostd/runtime/symtab.go.html">symtab.go</a></li>
<li><a href="/gostd/runtime/symtab_test.go.html">symtab_test.go</a></li>
<li><a href="/gostd/runtime/time.go.html" class="current">time.go</a></li>
<li><a href="/gostd/runtime/traceback.go.html">traceback.go</a></li>
<li><a href="/gostd/runtime/typekind.go.html">typekind.go</a></li>
<li><a href="/gostd/runtime/zgoarch_amd64.go.html">zgoarch_amd64.go</a></li>
<li><a href="/gostd/runtime/zgoos_linux.go.html">zgoos_linux.go</a></li>
<li><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html">zruntime_defs_linux_amd64.go</a></li>
<li><a href="/gostd/runtime/zversion.go.html">zversion.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1703399">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1703454">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1703508">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1703559">//&nbsp;Time-related&nbsp;runtime&nbsp;and&nbsp;pieces&nbsp;of&nbsp;package&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1703612">package</span>&nbsp;<span class="ident" id="1703620">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1703629">import</span>&nbsp;<span class="string" id="1703636">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1703646">//&nbsp;Package&nbsp;time&nbsp;knows&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1703698">//&nbsp;If&nbsp;this&nbsp;struct&nbsp;changes,&nbsp;adjust&nbsp;../time/sleep.go:/runtimeTimer.</span><br>
<span class="lineno"></span><span class="comment" id="1703764">//&nbsp;For&nbsp;GOOS=nacl,&nbsp;package&nbsp;syscall&nbsp;knows&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1703834">//&nbsp;If&nbsp;this&nbsp;struct&nbsp;changes,&nbsp;adjust&nbsp;../syscall/net_nacl.go:/runtimeTimer.</span><br>
<span class="lineno">15</span><span class="keyword" id="1703906">type</span>&nbsp;<span class="ident" id="1703911">timer</span>&nbsp;<span class="keyword" id="1703917">struct</span>&nbsp;<span class="op" id="1703924">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1703927">i</span>&nbsp;<span class="builtintype" id="1703929">int</span>&nbsp;<span class="comment" id="1703933">//&nbsp;heap&nbsp;index</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1703949">//&nbsp;Timer&nbsp;wakes&nbsp;up&nbsp;at&nbsp;when,&nbsp;and&nbsp;then&nbsp;at&nbsp;when+period,&nbsp;...&nbsp;(period&nbsp;&gt;&nbsp;0&nbsp;only)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1704024">//&nbsp;each&nbsp;time&nbsp;calling&nbsp;f(now,&nbsp;arg)&nbsp;in&nbsp;the&nbsp;timer&nbsp;goroutine,&nbsp;so&nbsp;f&nbsp;must&nbsp;be</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1704095">//&nbsp;a&nbsp;well-behaved&nbsp;function&nbsp;and&nbsp;not&nbsp;block.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704138">when</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1704145">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704152">period</span>&nbsp;<span class="ident" id="1704159">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704166">f</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1704173">func</span><span class="op" id="1704177">(</span><span class="keyword" id="1704178">interface</span><span class="op" id="1704187">{</span><span class="op" id="1704188">}</span><span class="op" id="1704189">,</span>&nbsp;<span class="builtintype" id="1704191">uintptr</span><span class="op" id="1704198">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704201">arg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1704208">interface</span><span class="op" id="1704217">{</span><span class="op" id="1704218">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704221">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1704228">uintptr</span><br>
<span class="lineno"></span><span class="op" id="1704236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1704239">var</span>&nbsp;<span class="ident" id="1704243">timers</span>&nbsp;<span class="keyword" id="1704250">struct</span>&nbsp;<span class="op" id="1704257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704260">lock</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704273">mutex</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704280">gp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1704293">*</span><span class="ident" id="1704294">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704297">created</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1704310">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704316">sleeping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1704329">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704335">rescheduling</span>&nbsp;<span class="builtintype" id="1704348">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704354">waitnote</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704367">note</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704373">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1704386">[</span><span class="op" id="1704387">]</span><span class="op" id="1704388">*</span><span class="ident" id="1704389">timer</span><br>
<span class="lineno"></span><span class="op" id="1704395">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1704398">//&nbsp;nacl&nbsp;fake&nbsp;time&nbsp;support&nbsp;-&nbsp;time&nbsp;in&nbsp;nanoseconds&nbsp;since&nbsp;1970</span><br>
<span class="lineno"></span><span class="keyword" id="1704457">var</span>&nbsp;<span class="ident" id="1704461">faketime</span>&nbsp;<span class="ident" id="1704470">int64</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="1704477">//&nbsp;Package&nbsp;time&nbsp;APIs.</span><br>
<span class="lineno"></span><span class="comment" id="1704499">//&nbsp;Godoc&nbsp;uses&nbsp;the&nbsp;comments&nbsp;in&nbsp;package&nbsp;time,&nbsp;not&nbsp;these.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1704555">//&nbsp;time.now&nbsp;is&nbsp;implemented&nbsp;in&nbsp;assembly.</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="1704596">//&nbsp;Sleep&nbsp;puts&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;to&nbsp;sleep&nbsp;for&nbsp;at&nbsp;least&nbsp;ns&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="1704670">func</span>&nbsp;<span class="ident" id="1704675">timeSleep</span><span class="op" id="1704684">(</span><span class="ident" id="1704685">ns</span>&nbsp;<span class="ident" id="1704688">int64</span><span class="op" id="1704693">)</span>&nbsp;<span class="op" id="1704695">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1704698">if</span>&nbsp;<span class="ident" id="1704701">ns</span>&nbsp;<span class="op" id="1704704">&lt;=</span>&nbsp;<span class="num" id="1704707">0</span>&nbsp;<span class="op" id="1704709">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1704713">return</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1704721">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704725">t</span>&nbsp;<span class="op" id="1704727">:=</span>&nbsp;<span class="builtinfunc" id="1704730">new</span><span class="op" id="1704733">(</span><span class="ident" id="1704734">timer</span><span class="op" id="1704739">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704742">t</span><span class="op" id="1704743">.</span><span class="ident" id="1704744">when</span>&nbsp;<span class="op" id="1704749">=</span>&nbsp;<span class="ident" id="1704751">nanotime</span><span class="op" id="1704759">(</span><span class="op" id="1704760">)</span>&nbsp;<span class="op" id="1704762">+</span>&nbsp;<span class="ident" id="1704764">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704768">t</span><span class="op" id="1704769">.</span><span class="ident" id="1704770">f</span>&nbsp;<span class="op" id="1704772">=</span>&nbsp;<span class="ident" id="1704774">goroutineReady</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704790">t</span><span class="op" id="1704791">.</span><span class="ident" id="1704792">arg</span>&nbsp;<span class="op" id="1704796">=</span>&nbsp;<span class="ident" id="1704798">getg</span><span class="op" id="1704802">(</span><span class="op" id="1704803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704806">lock</span><span class="op" id="1704810">(</span><span class="op" id="1704811">&amp;</span><span class="ident" id="1704812">timers</span><span class="op" id="1704818">.</span><span class="ident" id="1704819">lock</span><span class="op" id="1704823">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704826">addtimerLocked</span><span class="op" id="1704840">(</span><span class="ident" id="1704841">t</span><span class="op" id="1704842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704845">goparkunlock</span><span class="op" id="1704857">(</span><span class="op" id="1704858">&amp;</span><span class="ident" id="1704859">timers</span><span class="op" id="1704865">.</span><span class="ident" id="1704866">lock</span><span class="op" id="1704870">,</span>&nbsp;<span class="string" id="1704872">&#34;sleep&#34;</span><span class="op" id="1704879">)</span><br>
<span class="lineno"></span><span class="op" id="1704881">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="1704884">//&nbsp;startTimer&nbsp;adds&nbsp;t&nbsp;to&nbsp;the&nbsp;timer&nbsp;heap.</span><br>
<span class="lineno"></span><span class="keyword" id="1704924">func</span>&nbsp;<span class="ident" id="1704929">startTimer</span><span class="op" id="1704939">(</span><span class="ident" id="1704940">t</span>&nbsp;<span class="op" id="1704942">*</span><span class="ident" id="1704943">timer</span><span class="op" id="1704948">)</span>&nbsp;<span class="op" id="1704950">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1704953">if</span>&nbsp;<span class="ident" id="1704956">raceenabled</span>&nbsp;<span class="op" id="1704968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1704972">racerelease</span><span class="op" id="1704983">(</span><span class="ident" id="1704984">unsafe</span><span class="op" id="1704990">.</span><span class="ident" id="1704991">Pointer</span><span class="op" id="1704998">(</span><span class="ident" id="1704999">t</span><span class="op" id="1705000">)</span><span class="op" id="1705001">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1705004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1705007">addtimer</span><span class="op" id="1705015">(</span><span class="ident" id="1705016">t</span><span class="op" id="1705017">)</span><br>
<span class="lineno"></span><span class="op" id="1705019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1705022">//&nbsp;stopTimer&nbsp;removes&nbsp;t&nbsp;from&nbsp;the&nbsp;timer&nbsp;heap&nbsp;if&nbsp;it&nbsp;is&nbsp;there.</span><br>
<span class="lineno">70</span><span class="comment" id="1705081">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;t&nbsp;was&nbsp;removed,&nbsp;false&nbsp;if&nbsp;t&nbsp;wasn&#39;t&nbsp;even&nbsp;there.</span><br>
<span class="lineno"></span><span class="keyword" id="1705148">func</span>&nbsp;<span class="ident" id="1705153">stopTimer</span><span class="op" id="1705162">(</span><span class="ident" id="1705163">t</span>&nbsp;<span class="op" id="1705165">*</span><span class="ident" id="1705166">timer</span><span class="op" id="1705171">)</span>&nbsp;<span class="builtintype" id="1705173">bool</span>&nbsp;<span class="op" id="1705178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1705181">return</span>&nbsp;<span class="ident" id="1705188">deltimer</span><span class="op" id="1705196">(</span><span class="ident" id="1705197">t</span><span class="op" id="1705198">)</span><br>
<span class="lineno"></span><span class="op" id="1705200">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="1705203">//&nbsp;Go&nbsp;runtime.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1705219">//&nbsp;Ready&nbsp;the&nbsp;goroutine&nbsp;arg.</span><br>
<span class="lineno"></span><span class="keyword" id="1705247">func</span>&nbsp;<span class="ident" id="1705252">goroutineReady</span><span class="op" id="1705266">(</span><span class="ident" id="1705267">arg</span>&nbsp;<span class="keyword" id="1705271">interface</span><span class="op" id="1705280">{</span><span class="op" id="1705281">}</span><span class="op" id="1705282">,</span>&nbsp;<span class="ident" id="1705284">seq</span>&nbsp;<span class="builtintype" id="1705288">uintptr</span><span class="op" id="1705295">)</span>&nbsp;<span class="op" id="1705297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1705300">goready</span><span class="op" id="1705307">(</span><span class="ident" id="1705308">arg</span><span class="op" id="1705311">.</span><span class="op" id="1705312">(</span><span class="op" id="1705313">*</span><span class="ident" id="1705314">g</span><span class="op" id="1705315">)</span><span class="op" id="1705316">)</span><br>
<span class="lineno">80</span><span class="op" id="1705318">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1705321">func</span>&nbsp;<span class="ident" id="1705326">addtimer</span><span class="op" id="1705334">(</span><span class="ident" id="1705335">t</span>&nbsp;<span class="op" id="1705337">*</span><span class="ident" id="1705338">timer</span><span class="op" id="1705343">)</span>&nbsp;<span class="op" id="1705345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1705348">lock</span><span class="op" id="1705352">(</span><span class="op" id="1705353">&amp;</span><span class="ident" id="1705354">timers</span><span class="op" id="1705360">.</span><span class="ident" id="1705361">lock</span><span class="op" id="1705365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1705368">addtimerLocked</span><span class="op" id="1705382">(</span><span class="ident" id="1705383">t</span><span class="op" id="1705384">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1705387">unlock</span><span class="op" id="1705393">(</span><span class="op" id="1705394">&amp;</span><span class="ident" id="1705395">timers</span><span class="op" id="1705401">.</span><span class="ident" id="1705402">lock</span><span class="op" id="1705406">)</span><br>
<span class="lineno"></span><span class="op" id="1705408">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1705411">//&nbsp;Add&nbsp;a&nbsp;timer&nbsp;to&nbsp;the&nbsp;heap&nbsp;and&nbsp;start&nbsp;or&nbsp;kick&nbsp;the&nbsp;timer&nbsp;proc.</span><br>
<span class="lineno"></span><span class="comment" id="1705472">//&nbsp;If&nbsp;the&nbsp;new&nbsp;timer&nbsp;is&nbsp;earlier&nbsp;than&nbsp;any&nbsp;of&nbsp;the&nbsp;others.</span><br>
<span class="lineno">90</span><span class="comment" id="1705527">//&nbsp;Timers&nbsp;are&nbsp;locked.</span><br>
<span class="lineno"></span><span class="keyword" id="1705549">func</span>&nbsp;<span class="ident" id="1705554">addtimerLocked</span><span class="op" id="1705568">(</span><span class="ident" id="1705569">t</span>&nbsp;<span class="op" id="1705571">*</span><span class="ident" id="1705572">timer</span><span class="op" id="1705577">)</span>&nbsp;<span class="op" id="1705579">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1705582">//&nbsp;when&nbsp;must&nbsp;never&nbsp;be&nbsp;negative;&nbsp;otherwise&nbsp;timerproc&nbsp;will&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1705649">//&nbsp;during&nbsp;its&nbsp;delta&nbsp;calculation&nbsp;and&nbsp;never&nbsp;expire&nbsp;other&nbsp;runtime·timers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1705722">if</span>&nbsp;<span class="ident" id="1705725">t</span><span class="op" id="1705726">.</span><span class="ident" id="1705727">when</span>&nbsp;<span class="op" id="1705732">&lt;</span>&nbsp;<span class="num" id="1705734">0</span>&nbsp;<span class="op" id="1705736">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1705740">t</span><span class="op" id="1705741">.</span><span class="ident" id="1705742">when</span>&nbsp;<span class="op" id="1705747">=</span>&nbsp;<span class="num" id="1705749">1</span><span class="op" id="1705750">&lt;&lt;</span><span class="num" id="1705752">63</span>&nbsp;<span class="op" id="1705755">-</span>&nbsp;<span class="num" id="1705757">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1705760">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1705763">t</span><span class="op" id="1705764">.</span><span class="ident" id="1705765">i</span>&nbsp;<span class="op" id="1705767">=</span>&nbsp;<span class="builtinfunc" id="1705769">len</span><span class="op" id="1705772">(</span><span class="ident" id="1705773">timers</span><span class="op" id="1705779">.</span><span class="ident" id="1705780">t</span><span class="op" id="1705781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1705784">timers</span><span class="op" id="1705790">.</span><span class="ident" id="1705791">t</span>&nbsp;<span class="op" id="1705793">=</span>&nbsp;<span class="builtinfunc" id="1705795">append</span><span class="op" id="1705801">(</span><span class="ident" id="1705802">timers</span><span class="op" id="1705808">.</span><span class="ident" id="1705809">t</span><span class="op" id="1705810">,</span>&nbsp;<span class="ident" id="1705812">t</span><span class="op" id="1705813">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1705816">siftupTimer</span><span class="op" id="1705827">(</span><span class="ident" id="1705828">t</span><span class="op" id="1705829">.</span><span class="ident" id="1705830">i</span><span class="op" id="1705831">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1705834">if</span>&nbsp;<span class="ident" id="1705837">t</span><span class="op" id="1705838">.</span><span class="ident" id="1705839">i</span>&nbsp;<span class="op" id="1705841">==</span>&nbsp;<span class="num" id="1705844">0</span>&nbsp;<span class="op" id="1705846">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1705850">//&nbsp;siftup&nbsp;moved&nbsp;to&nbsp;top:&nbsp;new&nbsp;earliest&nbsp;deadline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1705899">if</span>&nbsp;<span class="ident" id="1705902">timers</span><span class="op" id="1705908">.</span><span class="ident" id="1705909">sleeping</span>&nbsp;<span class="op" id="1705918">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1705923">timers</span><span class="op" id="1705929">.</span><span class="ident" id="1705930">sleeping</span>&nbsp;<span class="op" id="1705939">=</span>&nbsp;<span class="builtintype" id="1705941">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1705950">notewakeup</span><span class="op" id="1705960">(</span><span class="op" id="1705961">&amp;</span><span class="ident" id="1705962">timers</span><span class="op" id="1705968">.</span><span class="ident" id="1705969">waitnote</span><span class="op" id="1705977">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1705981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1705985">if</span>&nbsp;<span class="ident" id="1705988">timers</span><span class="op" id="1705994">.</span><span class="ident" id="1705995">rescheduling</span>&nbsp;<span class="op" id="1706008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1706013">timers</span><span class="op" id="1706019">.</span><span class="ident" id="1706020">rescheduling</span>&nbsp;<span class="op" id="1706033">=</span>&nbsp;<span class="builtintype" id="1706035">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1706044">goready</span><span class="op" id="1706051">(</span><span class="ident" id="1706052">timers</span><span class="op" id="1706058">.</span><span class="ident" id="1706059">gp</span><span class="op" id="1706061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1706065">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1706068">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1706071">if</span>&nbsp;<span class="op" id="1706074">!</span><span class="ident" id="1706075">timers</span><span class="op" id="1706081">.</span><span class="ident" id="1706082">created</span>&nbsp;<span class="op" id="1706090">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1706094">timers</span><span class="op" id="1706100">.</span><span class="ident" id="1706101">created</span>&nbsp;<span class="op" id="1706109">=</span>&nbsp;<span class="builtintype" id="1706111">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1706118">go</span>&nbsp;<span class="ident" id="1706121">timerproc</span><span class="op" id="1706130">(</span><span class="op" id="1706131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1706134">}</span><br>
<span class="lineno">115</span><span class="op" id="1706136">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1706139">//&nbsp;Delete&nbsp;timer&nbsp;t&nbsp;from&nbsp;the&nbsp;heap.</span><br>
<span class="lineno"></span><span class="comment" id="1706172">//&nbsp;Do&nbsp;not&nbsp;need&nbsp;to&nbsp;update&nbsp;the&nbsp;timerproc:&nbsp;if&nbsp;it&nbsp;wakes&nbsp;up&nbsp;early,&nbsp;no&nbsp;big&nbsp;deal.</span><br>
<span class="lineno"></span><span class="keyword" id="1706247">func</span>&nbsp;<span class="ident" id="1706252">deltimer</span><span class="op" id="1706260">(</span><span class="ident" id="1706261">t</span>&nbsp;<span class="op" id="1706263">*</span><span class="ident" id="1706264">timer</span><span class="op" id="1706269">)</span>&nbsp;<span class="builtintype" id="1706271">bool</span>&nbsp;<span class="op" id="1706276">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1706279">//&nbsp;Dereference&nbsp;t&nbsp;so&nbsp;that&nbsp;any&nbsp;panic&nbsp;happens&nbsp;before&nbsp;the&nbsp;lock&nbsp;is&nbsp;held.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1706348">//&nbsp;Discard&nbsp;result,&nbsp;because&nbsp;t&nbsp;might&nbsp;be&nbsp;moving&nbsp;in&nbsp;the&nbsp;heap.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1706407">_</span>&nbsp;<span class="op" id="1706409">=</span>&nbsp;<span class="ident" id="1706411">t</span><span class="op" id="1706412">.</span><span class="ident" id="1706413">i</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1706417">lock</span><span class="op" id="1706421">(</span><span class="op" id="1706422">&amp;</span><span class="ident" id="1706423">timers</span><span class="op" id="1706429">.</span><span class="ident" id="1706430">lock</span><span class="op" id="1706434">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1706437">//&nbsp;t&nbsp;may&nbsp;not&nbsp;be&nbsp;registered&nbsp;anymore&nbsp;and&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1706486">//&nbsp;a&nbsp;bogus&nbsp;i&nbsp;(typically&nbsp;0,&nbsp;if&nbsp;generated&nbsp;by&nbsp;Go).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1706535">//&nbsp;Verify&nbsp;it&nbsp;before&nbsp;proceeding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1706568">i</span>&nbsp;<span class="op" id="1706570">:=</span>&nbsp;<span class="ident" id="1706573">t</span><span class="op" id="1706574">.</span><span class="ident" id="1706575">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1706578">last</span>&nbsp;<span class="op" id="1706583">:=</span>&nbsp;<span class="builtinfunc" id="1706586">len</span><span class="op" id="1706589">(</span><span class="ident" id="1706590">timers</span><span class="op" id="1706596">.</span><span class="ident" id="1706597">t</span><span class="op" id="1706598">)</span>&nbsp;<span class="op" id="1706600">-</span>&nbsp;<span class="num" id="1706602">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1706605">if</span>&nbsp;<span class="ident" id="1706608">i</span>&nbsp;<span class="op" id="1706610">&lt;</span>&nbsp;<span class="num" id="1706612">0</span>&nbsp;<span class="op" id="1706614">||</span>&nbsp;<span class="ident" id="1706617">i</span>&nbsp;<span class="op" id="1706619">&gt;</span>&nbsp;<span class="ident" id="1706621">last</span>&nbsp;<span class="op" id="1706626">||</span>&nbsp;<span class="ident" id="1706629">timers</span><span class="op" id="1706635">.</span><span class="ident" id="1706636">t</span><span class="op" id="1706637">[</span><span class="ident" id="1706638">i</span><span class="op" id="1706639">]</span>&nbsp;<span class="op" id="1706641">!=</span>&nbsp;<span class="ident" id="1706644">t</span>&nbsp;<span class="op" id="1706646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1706650">unlock</span><span class="op" id="1706656">(</span><span class="op" id="1706657">&amp;</span><span class="ident" id="1706658">timers</span><span class="op" id="1706664">.</span><span class="ident" id="1706665">lock</span><span class="op" id="1706669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1706673">return</span>&nbsp;<span class="builtintype" id="1706680">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1706687">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1706690">if</span>&nbsp;<span class="ident" id="1706693">i</span>&nbsp;<span class="op" id="1706695">!=</span>&nbsp;<span class="ident" id="1706698">last</span>&nbsp;<span class="op" id="1706703">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1706707">timers</span><span class="op" id="1706713">.</span><span class="ident" id="1706714">t</span><span class="op" id="1706715">[</span><span class="ident" id="1706716">i</span><span class="op" id="1706717">]</span>&nbsp;<span class="op" id="1706719">=</span>&nbsp;<span class="ident" id="1706721">timers</span><span class="op" id="1706727">.</span><span class="ident" id="1706728">t</span><span class="op" id="1706729">[</span><span class="ident" id="1706730">last</span><span class="op" id="1706734">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1706738">timers</span><span class="op" id="1706744">.</span><span class="ident" id="1706745">t</span><span class="op" id="1706746">[</span><span class="ident" id="1706747">i</span><span class="op" id="1706748">]</span><span class="op" id="1706749">.</span><span class="ident" id="1706750">i</span>&nbsp;<span class="op" id="1706752">=</span>&nbsp;<span class="ident" id="1706754">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1706757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1706760">timers</span><span class="op" id="1706766">.</span><span class="ident" id="1706767">t</span><span class="op" id="1706768">[</span><span class="ident" id="1706769">last</span><span class="op" id="1706773">]</span>&nbsp;<span class="op" id="1706775">=</span>&nbsp;<span class="ident" id="1706777">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1706782">timers</span><span class="op" id="1706788">.</span><span class="ident" id="1706789">t</span>&nbsp;<span class="op" id="1706791">=</span>&nbsp;<span class="ident" id="1706793">timers</span><span class="op" id="1706799">.</span><span class="ident" id="1706800">t</span><span class="op" id="1706801">[</span><span class="op" id="1706802">:</span><span class="ident" id="1706803">last</span><span class="op" id="1706807">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1706810">if</span>&nbsp;<span class="ident" id="1706813">i</span>&nbsp;<span class="op" id="1706815">!=</span>&nbsp;<span class="ident" id="1706818">last</span>&nbsp;<span class="op" id="1706823">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1706827">siftupTimer</span><span class="op" id="1706838">(</span><span class="ident" id="1706839">i</span><span class="op" id="1706840">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1706844">siftdownTimer</span><span class="op" id="1706857">(</span><span class="ident" id="1706858">i</span><span class="op" id="1706859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1706862">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1706865">unlock</span><span class="op" id="1706871">(</span><span class="op" id="1706872">&amp;</span><span class="ident" id="1706873">timers</span><span class="op" id="1706879">.</span><span class="ident" id="1706880">lock</span><span class="op" id="1706884">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1706887">return</span>&nbsp;<span class="builtintype" id="1706894">true</span><br>
<span class="lineno"></span><span class="op" id="1706899">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1706902">//&nbsp;Timerproc&nbsp;runs&nbsp;the&nbsp;time-driven&nbsp;events.</span><br>
<span class="lineno"></span><span class="comment" id="1706944">//&nbsp;It&nbsp;sleeps&nbsp;until&nbsp;the&nbsp;next&nbsp;event&nbsp;in&nbsp;the&nbsp;timers&nbsp;heap.</span><br>
<span class="lineno">150</span><span class="comment" id="1706998">//&nbsp;If&nbsp;addtimer&nbsp;inserts&nbsp;a&nbsp;new&nbsp;earlier&nbsp;event,&nbsp;addtimer1&nbsp;wakes&nbsp;timerproc&nbsp;early.</span><br>
<span class="lineno"></span><span class="keyword" id="1707075">func</span>&nbsp;<span class="ident" id="1707080">timerproc</span><span class="op" id="1707089">(</span><span class="op" id="1707090">)</span>&nbsp;<span class="op" id="1707092">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707095">timers</span><span class="op" id="1707101">.</span><span class="ident" id="1707102">gp</span>&nbsp;<span class="op" id="1707105">=</span>&nbsp;<span class="ident" id="1707107">getg</span><span class="op" id="1707111">(</span><span class="op" id="1707112">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707115">timers</span><span class="op" id="1707121">.</span><span class="ident" id="1707122">gp</span><span class="op" id="1707124">.</span><span class="ident" id="1707125">issystem</span>&nbsp;<span class="op" id="1707134">=</span>&nbsp;<span class="builtintype" id="1707136">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1707142">for</span>&nbsp;<span class="op" id="1707146">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707150">lock</span><span class="op" id="1707154">(</span><span class="op" id="1707155">&amp;</span><span class="ident" id="1707156">timers</span><span class="op" id="1707162">.</span><span class="ident" id="1707163">lock</span><span class="op" id="1707167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707171">timers</span><span class="op" id="1707177">.</span><span class="ident" id="1707178">sleeping</span>&nbsp;<span class="op" id="1707187">=</span>&nbsp;<span class="builtintype" id="1707189">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707197">now</span>&nbsp;<span class="op" id="1707201">:=</span>&nbsp;<span class="ident" id="1707204">nanotime</span><span class="op" id="1707212">(</span><span class="op" id="1707213">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707217">delta</span>&nbsp;<span class="op" id="1707223">:=</span>&nbsp;<span class="ident" id="1707226">int64</span><span class="op" id="1707231">(</span><span class="op" id="1707232">-</span><span class="num" id="1707233">1</span><span class="op" id="1707234">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1707238">for</span>&nbsp;<span class="op" id="1707242">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1707247">if</span>&nbsp;<span class="builtinfunc" id="1707250">len</span><span class="op" id="1707253">(</span><span class="ident" id="1707254">timers</span><span class="op" id="1707260">.</span><span class="ident" id="1707261">t</span><span class="op" id="1707262">)</span>&nbsp;<span class="op" id="1707264">==</span>&nbsp;<span class="num" id="1707267">0</span>&nbsp;<span class="op" id="1707269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707275">delta</span>&nbsp;<span class="op" id="1707281">=</span>&nbsp;<span class="op" id="1707283">-</span><span class="num" id="1707284">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1707290">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1707299">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707304">t</span>&nbsp;<span class="op" id="1707306">:=</span>&nbsp;<span class="ident" id="1707309">timers</span><span class="op" id="1707315">.</span><span class="ident" id="1707316">t</span><span class="op" id="1707317">[</span><span class="num" id="1707318">0</span><span class="op" id="1707319">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707324">delta</span>&nbsp;<span class="op" id="1707330">=</span>&nbsp;<span class="ident" id="1707332">t</span><span class="op" id="1707333">.</span><span class="ident" id="1707334">when</span>&nbsp;<span class="op" id="1707339">-</span>&nbsp;<span class="ident" id="1707341">now</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1707348">if</span>&nbsp;<span class="ident" id="1707351">delta</span>&nbsp;<span class="op" id="1707357">&gt;</span>&nbsp;<span class="num" id="1707359">0</span>&nbsp;<span class="op" id="1707361">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1707367">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1707376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1707381">if</span>&nbsp;<span class="ident" id="1707384">t</span><span class="op" id="1707385">.</span><span class="ident" id="1707386">period</span>&nbsp;<span class="op" id="1707393">&gt;</span>&nbsp;<span class="num" id="1707395">0</span>&nbsp;<span class="op" id="1707397">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1707403">//&nbsp;leave&nbsp;in&nbsp;heap&nbsp;but&nbsp;adjust&nbsp;next&nbsp;time&nbsp;to&nbsp;fire</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707453">t</span><span class="op" id="1707454">.</span><span class="ident" id="1707455">when</span>&nbsp;<span class="op" id="1707460">+=</span>&nbsp;<span class="ident" id="1707463">t</span><span class="op" id="1707464">.</span><span class="ident" id="1707465">period</span>&nbsp;<span class="op" id="1707472">*</span>&nbsp;<span class="op" id="1707474">(</span><span class="num" id="1707475">1</span>&nbsp;<span class="op" id="1707477">+</span>&nbsp;<span class="op" id="1707479">-</span><span class="ident" id="1707480">delta</span><span class="op" id="1707485">/</span><span class="ident" id="1707486">t</span><span class="op" id="1707487">.</span><span class="ident" id="1707488">period</span><span class="op" id="1707494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707500">siftdownTimer</span><span class="op" id="1707513">(</span><span class="num" id="1707514">0</span><span class="op" id="1707515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1707520">}</span>&nbsp;<span class="keyword" id="1707522">else</span>&nbsp;<span class="op" id="1707527">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1707533">//&nbsp;remove&nbsp;from&nbsp;heap</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707557">last</span>&nbsp;<span class="op" id="1707562">:=</span>&nbsp;<span class="builtinfunc" id="1707565">len</span><span class="op" id="1707568">(</span><span class="ident" id="1707569">timers</span><span class="op" id="1707575">.</span><span class="ident" id="1707576">t</span><span class="op" id="1707577">)</span>&nbsp;<span class="op" id="1707579">-</span>&nbsp;<span class="num" id="1707581">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1707587">if</span>&nbsp;<span class="ident" id="1707590">last</span>&nbsp;<span class="op" id="1707595">&gt;</span>&nbsp;<span class="num" id="1707597">0</span>&nbsp;<span class="op" id="1707599">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707606">timers</span><span class="op" id="1707612">.</span><span class="ident" id="1707613">t</span><span class="op" id="1707614">[</span><span class="num" id="1707615">0</span><span class="op" id="1707616">]</span>&nbsp;<span class="op" id="1707618">=</span>&nbsp;<span class="ident" id="1707620">timers</span><span class="op" id="1707626">.</span><span class="ident" id="1707627">t</span><span class="op" id="1707628">[</span><span class="ident" id="1707629">last</span><span class="op" id="1707633">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707640">timers</span><span class="op" id="1707646">.</span><span class="ident" id="1707647">t</span><span class="op" id="1707648">[</span><span class="num" id="1707649">0</span><span class="op" id="1707650">]</span><span class="op" id="1707651">.</span><span class="ident" id="1707652">i</span>&nbsp;<span class="op" id="1707654">=</span>&nbsp;<span class="num" id="1707656">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1707662">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707668">timers</span><span class="op" id="1707674">.</span><span class="ident" id="1707675">t</span><span class="op" id="1707676">[</span><span class="ident" id="1707677">last</span><span class="op" id="1707681">]</span>&nbsp;<span class="op" id="1707683">=</span>&nbsp;<span class="ident" id="1707685">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707693">timers</span><span class="op" id="1707699">.</span><span class="ident" id="1707700">t</span>&nbsp;<span class="op" id="1707702">=</span>&nbsp;<span class="ident" id="1707704">timers</span><span class="op" id="1707710">.</span><span class="ident" id="1707711">t</span><span class="op" id="1707712">[</span><span class="op" id="1707713">:</span><span class="ident" id="1707714">last</span><span class="op" id="1707718">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1707724">if</span>&nbsp;<span class="ident" id="1707727">last</span>&nbsp;<span class="op" id="1707732">&gt;</span>&nbsp;<span class="num" id="1707734">0</span>&nbsp;<span class="op" id="1707736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707743">siftdownTimer</span><span class="op" id="1707756">(</span><span class="num" id="1707757">0</span><span class="op" id="1707758">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1707764">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707770">t</span><span class="op" id="1707771">.</span><span class="ident" id="1707772">i</span>&nbsp;<span class="op" id="1707774">=</span>&nbsp;<span class="op" id="1707776">-</span><span class="num" id="1707777">1</span>&nbsp;<span class="comment" id="1707779">//&nbsp;mark&nbsp;as&nbsp;removed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1707801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707806">f</span>&nbsp;<span class="op" id="1707808">:=</span>&nbsp;<span class="ident" id="1707811">t</span><span class="op" id="1707812">.</span><span class="ident" id="1707813">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707818">arg</span>&nbsp;<span class="op" id="1707822">:=</span>&nbsp;<span class="ident" id="1707825">t</span><span class="op" id="1707826">.</span><span class="ident" id="1707827">arg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707834">seq</span>&nbsp;<span class="op" id="1707838">:=</span>&nbsp;<span class="ident" id="1707841">t</span><span class="op" id="1707842">.</span><span class="ident" id="1707843">seq</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707850">unlock</span><span class="op" id="1707856">(</span><span class="op" id="1707857">&amp;</span><span class="ident" id="1707858">timers</span><span class="op" id="1707864">.</span><span class="ident" id="1707865">lock</span><span class="op" id="1707869">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1707874">if</span>&nbsp;<span class="ident" id="1707877">raceenabled</span>&nbsp;<span class="op" id="1707889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707895">raceacquire</span><span class="op" id="1707906">(</span><span class="ident" id="1707907">unsafe</span><span class="op" id="1707913">.</span><span class="ident" id="1707914">Pointer</span><span class="op" id="1707921">(</span><span class="ident" id="1707922">t</span><span class="op" id="1707923">)</span><span class="op" id="1707924">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1707929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707934">f</span><span class="op" id="1707935">(</span><span class="ident" id="1707936">arg</span><span class="op" id="1707939">,</span>&nbsp;<span class="ident" id="1707941">seq</span><span class="op" id="1707944">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1707949">lock</span><span class="op" id="1707953">(</span><span class="op" id="1707954">&amp;</span><span class="ident" id="1707955">timers</span><span class="op" id="1707961">.</span><span class="ident" id="1707962">lock</span><span class="op" id="1707966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1707970">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1707974">if</span>&nbsp;<span class="ident" id="1707977">delta</span>&nbsp;<span class="op" id="1707983">&lt;</span>&nbsp;<span class="num" id="1707985">0</span>&nbsp;<span class="op" id="1707987">||</span>&nbsp;<span class="ident" id="1707990">faketime</span>&nbsp;<span class="op" id="1707999">&gt;</span>&nbsp;<span class="num" id="1708001">0</span>&nbsp;<span class="op" id="1708003">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1708008">//&nbsp;No&nbsp;timers&nbsp;left&nbsp;-&nbsp;put&nbsp;goroutine&nbsp;to&nbsp;sleep.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708055">timers</span><span class="op" id="1708061">.</span><span class="ident" id="1708062">rescheduling</span>&nbsp;<span class="op" id="1708075">=</span>&nbsp;<span class="builtintype" id="1708077">true</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708085">goparkunlock</span><span class="op" id="1708097">(</span><span class="op" id="1708098">&amp;</span><span class="ident" id="1708099">timers</span><span class="op" id="1708105">.</span><span class="ident" id="1708106">lock</span><span class="op" id="1708110">,</span>&nbsp;<span class="string" id="1708112">&#34;timer&nbsp;goroutine&nbsp;(idle)&#34;</span><span class="op" id="1708136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1708141">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1708152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1708156">//&nbsp;At&nbsp;least&nbsp;one&nbsp;timer&nbsp;pending.&nbsp;&nbsp;Sleep&nbsp;until&nbsp;then.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708208">timers</span><span class="op" id="1708214">.</span><span class="ident" id="1708215">sleeping</span>&nbsp;<span class="op" id="1708224">=</span>&nbsp;<span class="builtintype" id="1708226">true</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708233">noteclear</span><span class="op" id="1708242">(</span><span class="op" id="1708243">&amp;</span><span class="ident" id="1708244">timers</span><span class="op" id="1708250">.</span><span class="ident" id="1708251">waitnote</span><span class="op" id="1708259">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708263">unlock</span><span class="op" id="1708269">(</span><span class="op" id="1708270">&amp;</span><span class="ident" id="1708271">timers</span><span class="op" id="1708277">.</span><span class="ident" id="1708278">lock</span><span class="op" id="1708282">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708286">notetsleepg</span><span class="op" id="1708297">(</span><span class="op" id="1708298">&amp;</span><span class="ident" id="1708299">timers</span><span class="op" id="1708305">.</span><span class="ident" id="1708306">waitnote</span><span class="op" id="1708314">,</span>&nbsp;<span class="ident" id="1708316">delta</span><span class="op" id="1708321">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1708324">}</span><br>
<span class="lineno"></span><span class="op" id="1708326">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="1708329">func</span>&nbsp;<span class="ident" id="1708334">timejump</span><span class="op" id="1708342">(</span><span class="op" id="1708343">)</span>&nbsp;<span class="op" id="1708345">*</span><span class="ident" id="1708346">g</span>&nbsp;<span class="op" id="1708348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1708351">if</span>&nbsp;<span class="ident" id="1708354">faketime</span>&nbsp;<span class="op" id="1708363">==</span>&nbsp;<span class="num" id="1708366">0</span>&nbsp;<span class="op" id="1708368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1708372">return</span>&nbsp;<span class="ident" id="1708379">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1708384">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708388">lock</span><span class="op" id="1708392">(</span><span class="op" id="1708393">&amp;</span><span class="ident" id="1708394">timers</span><span class="op" id="1708400">.</span><span class="ident" id="1708401">lock</span><span class="op" id="1708405">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1708408">if</span>&nbsp;<span class="op" id="1708411">!</span><span class="ident" id="1708412">timers</span><span class="op" id="1708418">.</span><span class="ident" id="1708419">created</span>&nbsp;<span class="op" id="1708427">||</span>&nbsp;<span class="builtinfunc" id="1708430">len</span><span class="op" id="1708433">(</span><span class="ident" id="1708434">timers</span><span class="op" id="1708440">.</span><span class="ident" id="1708441">t</span><span class="op" id="1708442">)</span>&nbsp;<span class="op" id="1708444">==</span>&nbsp;<span class="num" id="1708447">0</span>&nbsp;<span class="op" id="1708449">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708453">unlock</span><span class="op" id="1708459">(</span><span class="op" id="1708460">&amp;</span><span class="ident" id="1708461">timers</span><span class="op" id="1708467">.</span><span class="ident" id="1708468">lock</span><span class="op" id="1708472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1708476">return</span>&nbsp;<span class="ident" id="1708483">nil</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1708488">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1708492">var</span>&nbsp;<span class="ident" id="1708496">gp</span>&nbsp;<span class="op" id="1708499">*</span><span class="ident" id="1708500">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1708503">if</span>&nbsp;<span class="ident" id="1708506">faketime</span>&nbsp;<span class="op" id="1708515">&lt;</span>&nbsp;<span class="ident" id="1708517">timers</span><span class="op" id="1708523">.</span><span class="ident" id="1708524">t</span><span class="op" id="1708525">[</span><span class="num" id="1708526">0</span><span class="op" id="1708527">]</span><span class="op" id="1708528">.</span><span class="ident" id="1708529">when</span>&nbsp;<span class="op" id="1708534">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708538">faketime</span>&nbsp;<span class="op" id="1708547">=</span>&nbsp;<span class="ident" id="1708549">timers</span><span class="op" id="1708555">.</span><span class="ident" id="1708556">t</span><span class="op" id="1708557">[</span><span class="num" id="1708558">0</span><span class="op" id="1708559">]</span><span class="op" id="1708560">.</span><span class="ident" id="1708561">when</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1708568">if</span>&nbsp;<span class="ident" id="1708571">timers</span><span class="op" id="1708577">.</span><span class="ident" id="1708578">rescheduling</span>&nbsp;<span class="op" id="1708591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708596">timers</span><span class="op" id="1708602">.</span><span class="ident" id="1708603">rescheduling</span>&nbsp;<span class="op" id="1708616">=</span>&nbsp;<span class="builtintype" id="1708618">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708627">gp</span>&nbsp;<span class="op" id="1708630">=</span>&nbsp;<span class="ident" id="1708632">timers</span><span class="op" id="1708638">.</span><span class="ident" id="1708639">gp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1708644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1708647">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708650">unlock</span><span class="op" id="1708656">(</span><span class="op" id="1708657">&amp;</span><span class="ident" id="1708658">timers</span><span class="op" id="1708664">.</span><span class="ident" id="1708665">lock</span><span class="op" id="1708669">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1708672">return</span>&nbsp;<span class="ident" id="1708679">gp</span><br>
<span class="lineno"></span><span class="op" id="1708682">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1708685">//&nbsp;Heap&nbsp;maintenance&nbsp;algorithms.</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="1708718">func</span>&nbsp;<span class="ident" id="1708723">siftupTimer</span><span class="op" id="1708734">(</span><span class="ident" id="1708735">i</span>&nbsp;<span class="builtintype" id="1708737">int</span><span class="op" id="1708740">)</span>&nbsp;<span class="op" id="1708742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708745">t</span>&nbsp;<span class="op" id="1708747">:=</span>&nbsp;<span class="ident" id="1708750">timers</span><span class="op" id="1708756">.</span><span class="ident" id="1708757">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708760">when</span>&nbsp;<span class="op" id="1708765">:=</span>&nbsp;<span class="ident" id="1708768">t</span><span class="op" id="1708769">[</span><span class="ident" id="1708770">i</span><span class="op" id="1708771">]</span><span class="op" id="1708772">.</span><span class="ident" id="1708773">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708779">tmp</span>&nbsp;<span class="op" id="1708783">:=</span>&nbsp;<span class="ident" id="1708786">t</span><span class="op" id="1708787">[</span><span class="ident" id="1708788">i</span><span class="op" id="1708789">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1708792">for</span>&nbsp;<span class="ident" id="1708796">i</span>&nbsp;<span class="op" id="1708798">&gt;</span>&nbsp;<span class="num" id="1708800">0</span>&nbsp;<span class="op" id="1708802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708806">p</span>&nbsp;<span class="op" id="1708808">:=</span>&nbsp;<span class="op" id="1708811">(</span><span class="ident" id="1708812">i</span>&nbsp;<span class="op" id="1708814">-</span>&nbsp;<span class="num" id="1708816">1</span><span class="op" id="1708817">)</span>&nbsp;<span class="op" id="1708819">/</span>&nbsp;<span class="num" id="1708821">4</span>&nbsp;<span class="comment" id="1708823">//&nbsp;parent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1708835">if</span>&nbsp;<span class="ident" id="1708838">when</span>&nbsp;<span class="op" id="1708843">&gt;=</span>&nbsp;<span class="ident" id="1708846">t</span><span class="op" id="1708847">[</span><span class="ident" id="1708848">p</span><span class="op" id="1708849">]</span><span class="op" id="1708850">.</span><span class="ident" id="1708851">when</span>&nbsp;<span class="op" id="1708856">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1708861">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1708869">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708873">t</span><span class="op" id="1708874">[</span><span class="ident" id="1708875">i</span><span class="op" id="1708876">]</span>&nbsp;<span class="op" id="1708878">=</span>&nbsp;<span class="ident" id="1708880">t</span><span class="op" id="1708881">[</span><span class="ident" id="1708882">p</span><span class="op" id="1708883">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708887">t</span><span class="op" id="1708888">[</span><span class="ident" id="1708889">i</span><span class="op" id="1708890">]</span><span class="op" id="1708891">.</span><span class="ident" id="1708892">i</span>&nbsp;<span class="op" id="1708894">=</span>&nbsp;<span class="ident" id="1708896">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708900">t</span><span class="op" id="1708901">[</span><span class="ident" id="1708902">p</span><span class="op" id="1708903">]</span>&nbsp;<span class="op" id="1708905">=</span>&nbsp;<span class="ident" id="1708907">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708913">t</span><span class="op" id="1708914">[</span><span class="ident" id="1708915">p</span><span class="op" id="1708916">]</span><span class="op" id="1708917">.</span><span class="ident" id="1708918">i</span>&nbsp;<span class="op" id="1708920">=</span>&nbsp;<span class="ident" id="1708922">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708926">i</span>&nbsp;<span class="op" id="1708928">=</span>&nbsp;<span class="ident" id="1708930">p</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1708933">}</span><br>
<span class="lineno"></span><span class="op" id="1708935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1708938">func</span>&nbsp;<span class="ident" id="1708943">siftdownTimer</span><span class="op" id="1708956">(</span><span class="ident" id="1708957">i</span>&nbsp;<span class="builtintype" id="1708959">int</span><span class="op" id="1708962">)</span>&nbsp;<span class="op" id="1708964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708967">t</span>&nbsp;<span class="op" id="1708969">:=</span>&nbsp;<span class="ident" id="1708972">timers</span><span class="op" id="1708978">.</span><span class="ident" id="1708979">t</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708982">n</span>&nbsp;<span class="op" id="1708984">:=</span>&nbsp;<span class="builtinfunc" id="1708987">len</span><span class="op" id="1708990">(</span><span class="ident" id="1708991">t</span><span class="op" id="1708992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1708995">when</span>&nbsp;<span class="op" id="1709000">:=</span>&nbsp;<span class="ident" id="1709003">t</span><span class="op" id="1709004">[</span><span class="ident" id="1709005">i</span><span class="op" id="1709006">]</span><span class="op" id="1709007">.</span><span class="ident" id="1709008">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1709014">tmp</span>&nbsp;<span class="op" id="1709018">:=</span>&nbsp;<span class="ident" id="1709021">t</span><span class="op" id="1709022">[</span><span class="ident" id="1709023">i</span><span class="op" id="1709024">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1709027">for</span>&nbsp;<span class="op" id="1709031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1709035">c</span>&nbsp;<span class="op" id="1709037">:=</span>&nbsp;<span class="ident" id="1709040">i</span><span class="op" id="1709041">*</span><span class="num" id="1709042">4</span>&nbsp;<span class="op" id="1709044">+</span>&nbsp;<span class="num" id="1709046">1</span>&nbsp;<span class="comment" id="1709048">//&nbsp;left&nbsp;child</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1709064">c3</span>&nbsp;<span class="op" id="1709067">:=</span>&nbsp;<span class="ident" id="1709070">c</span>&nbsp;<span class="op" id="1709072">+</span>&nbsp;<span class="num" id="1709074">2</span>&nbsp;&nbsp;<span class="comment" id="1709077">//&nbsp;mid&nbsp;child</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1709092">if</span>&nbsp;<span class="ident" id="1709095">c</span>&nbsp;<span class="op" id="1709097">&gt;=</span>&nbsp;<span class="ident" id="1709100">n</span>&nbsp;<span class="op" id="1709102">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1709107">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1709115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1709119">w</span>&nbsp;<span class="op" id="1709121">:=</span>&nbsp;<span class="ident" id="1709124">t</span><span class="op" id="1709125">[</span><span class="ident" id="1709126">c</span><span class="op" id="1709127">]</span><span class="op" id="1709128">.</span><span class="ident" id="1709129">when</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1709136">if</span>&nbsp;<span class="ident" id="1709139">c</span><span class="op" id="1709140">+</span><span class="num" id="1709141">1</span>&nbsp;<span class="op" id="1709143">&lt;</span>&nbsp;<span class="ident" id="1709145">n</span>&nbsp;<span class="op" id="1709147">&amp;&amp;</span>&nbsp;<span class="ident" id="1709150">t</span><span class="op" id="1709151">[</span><span class="ident" id="1709152">c</span><span class="op" id="1709153">+</span><span class="num" id="1709154">1</span><span class="op" id="1709155">]</span><span class="op" id="1709156">.</span><span class="ident" id="1709157">when</span>&nbsp;<span class="op" id="1709162">&lt;</span>&nbsp;<span class="ident" id="1709164">w</span>&nbsp;<span class="op" id="1709166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1709171">w</span>&nbsp;<span class="op" id="1709173">=</span>&nbsp;<span class="ident" id="1709175">t</span><span class="op" id="1709176">[</span><span class="ident" id="1709177">c</span><span class="op" id="1709178">+</span><span class="num" id="1709179">1</span><span class="op" id="1709180">]</span><span class="op" id="1709181">.</span><span class="ident" id="1709182">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1709190">c</span><span class="op" id="1709191">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1709196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1709200">if</span>&nbsp;<span class="ident" id="1709203">c3</span>&nbsp;<span class="op" id="1709206">&lt;</span>&nbsp;<span class="ident" id="1709208">n</span>&nbsp;<span class="op" id="1709210">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1709215">w3</span>&nbsp;<span class="op" id="1709218">:=</span>&nbsp;<span class="ident" id="1709221">t</span><span class="op" id="1709222">[</span><span class="ident" id="1709223">c3</span><span class="op" id="1709225">]</span><span class="op" id="1709226">.</span><span class="ident" id="1709227">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1709235">if</span>&nbsp;<span class="ident" id="1709238">c3</span><span class="op" id="1709240">+</span><span class="num" id="1709241">1</span>&nbsp;<span class="op" id="1709243">&lt;</span>&nbsp;<span class="ident" id="1709245">n</span>&nbsp;<span class="op" id="1709247">&amp;&amp;</span>&nbsp;<span class="ident" id="1709250">t</span><span class="op" id="1709251">[</span><span class="ident" id="1709252">c3</span><span class="op" id="1709254">+</span><span class="num" id="1709255">1</span><span class="op" id="1709256">]</span><span class="op" id="1709257">.</span><span class="ident" id="1709258">when</span>&nbsp;<span class="op" id="1709263">&lt;</span>&nbsp;<span class="ident" id="1709265">w3</span>&nbsp;<span class="op" id="1709268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1709274">w3</span>&nbsp;<span class="op" id="1709277">=</span>&nbsp;<span class="ident" id="1709279">t</span><span class="op" id="1709280">[</span><span class="ident" id="1709281">c3</span><span class="op" id="1709283">+</span><span class="num" id="1709284">1</span><span class="op" id="1709285">]</span><span class="op" id="1709286">.</span><span class="ident" id="1709287">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1709296">c3</span><span class="op" id="1709298">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1709304">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1709309">if</span>&nbsp;<span class="ident" id="1709312">w3</span>&nbsp;<span class="op" id="1709315">&lt;</span>&nbsp;<span class="ident" id="1709317">w</span>&nbsp;<span class="op" id="1709319">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1709325">w</span>&nbsp;<span class="op" id="1709327">=</span>&nbsp;<span class="ident" id="1709329">w3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1709336">c</span>&nbsp;<span class="op" id="1709338">=</span>&nbsp;<span class="ident" id="1709340">c3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1709346">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1709350">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1709354">if</span>&nbsp;<span class="ident" id="1709357">w</span>&nbsp;<span class="op" id="1709359">&gt;=</span>&nbsp;<span class="ident" id="1709362">when</span>&nbsp;<span class="op" id="1709367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1709372">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1709380">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1709384">t</span><span class="op" id="1709385">[</span><span class="ident" id="1709386">i</span><span class="op" id="1709387">]</span>&nbsp;<span class="op" id="1709389">=</span>&nbsp;<span class="ident" id="1709391">t</span><span class="op" id="1709392">[</span><span class="ident" id="1709393">c</span><span class="op" id="1709394">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1709398">t</span><span class="op" id="1709399">[</span><span class="ident" id="1709400">i</span><span class="op" id="1709401">]</span><span class="op" id="1709402">.</span><span class="ident" id="1709403">i</span>&nbsp;<span class="op" id="1709405">=</span>&nbsp;<span class="ident" id="1709407">i</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1709411">t</span><span class="op" id="1709412">[</span><span class="ident" id="1709413">c</span><span class="op" id="1709414">]</span>&nbsp;<span class="op" id="1709416">=</span>&nbsp;<span class="ident" id="1709418">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1709424">t</span><span class="op" id="1709425">[</span><span class="ident" id="1709426">c</span><span class="op" id="1709427">]</span><span class="op" id="1709428">.</span><span class="ident" id="1709429">i</span>&nbsp;<span class="op" id="1709431">=</span>&nbsp;<span class="ident" id="1709433">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1709437">i</span>&nbsp;<span class="op" id="1709439">=</span>&nbsp;<span class="ident" id="1709441">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1709444">}</span><br>
<span class="lineno"></span><span class="op" id="1709446">}</span>
</div>
</body>
</html>
