<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4540034">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4540089">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4540143">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4540194">package</span>&nbsp;<span class="ident" id="4540202">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4540212">import</span>&nbsp;<span class="op" id="4540219">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4540222">&#34;fmt&#34;</span><br>
<span class="lineno"></span><span class="op" id="4540228">)</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="4540231">//&nbsp;context&nbsp;describes&nbsp;the&nbsp;state&nbsp;an&nbsp;HTML&nbsp;parser&nbsp;must&nbsp;be&nbsp;in&nbsp;when&nbsp;it&nbsp;reaches&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4540308">//&nbsp;portion&nbsp;of&nbsp;HTML&nbsp;produced&nbsp;by&nbsp;evaluating&nbsp;a&nbsp;particular&nbsp;template&nbsp;node.</span><br>
<span class="lineno"></span><span class="comment" id="4540378">//</span><br>
<span class="lineno"></span><span class="comment" id="4540381">//&nbsp;The&nbsp;zero&nbsp;value&nbsp;of&nbsp;type&nbsp;context&nbsp;is&nbsp;the&nbsp;start&nbsp;context&nbsp;for&nbsp;a&nbsp;template&nbsp;that</span><br>
<span class="lineno">15</span><span class="comment" id="4540456">//&nbsp;produces&nbsp;an&nbsp;HTML&nbsp;fragment&nbsp;as&nbsp;defined&nbsp;at</span><br>
<span class="lineno"></span><span class="comment" id="4540499">//&nbsp;http://www.w3.org/TR/html5/syntax.html#the-end</span><br>
<span class="lineno"></span><span class="comment" id="4540549">//&nbsp;where&nbsp;the&nbsp;context&nbsp;element&nbsp;is&nbsp;null.</span><br>
<span class="lineno"></span><span class="keyword" id="4540587">type</span>&nbsp;<span class="ident" id="4540592">context</span>&nbsp;<span class="keyword" id="4540600">struct</span>&nbsp;<span class="op" id="4540607">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540610">state</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4540618">state</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540625">delim</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4540633">delim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540640">urlPart</span>&nbsp;<span class="ident" id="4540648">urlPart</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540657">jsCtx</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="4540665">jsCtx</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540672">attr</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4540680">attr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540686">element</span>&nbsp;<span class="ident" id="4540694">element</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540703">err</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4540711">*</span><span class="ident" id="4540712">Error</span><br>
<span class="lineno"></span><span class="op" id="4540718">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4540721">func</span>&nbsp;<span class="op" id="4540726">(</span><span class="ident" id="4540727">c</span>&nbsp;<span class="ident" id="4540729">context</span><span class="op" id="4540736">)</span>&nbsp;<span class="ident" id="4540738">String</span><span class="op" id="4540744">(</span><span class="op" id="4540745">)</span>&nbsp;<span class="builtintype" id="4540747">string</span>&nbsp;<span class="op" id="4540754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4540757">return</span>&nbsp;<span class="ident" id="4540764">fmt</span><span class="op" id="4540767">.</span><span class="ident" id="4540768">Sprintf</span><span class="op" id="4540775">(</span><span class="string" id="4540776">&#34;{%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v&nbsp;%v}&#34;</span><span class="op" id="4540800">,</span>&nbsp;<span class="ident" id="4540802">c</span><span class="op" id="4540803">.</span><span class="ident" id="4540804">state</span><span class="op" id="4540809">,</span>&nbsp;<span class="ident" id="4540811">c</span><span class="op" id="4540812">.</span><span class="ident" id="4540813">delim</span><span class="op" id="4540818">,</span>&nbsp;<span class="ident" id="4540820">c</span><span class="op" id="4540821">.</span><span class="ident" id="4540822">urlPart</span><span class="op" id="4540829">,</span>&nbsp;<span class="ident" id="4540831">c</span><span class="op" id="4540832">.</span><span class="ident" id="4540833">jsCtx</span><span class="op" id="4540838">,</span>&nbsp;<span class="ident" id="4540840">c</span><span class="op" id="4540841">.</span><span class="ident" id="4540842">attr</span><span class="op" id="4540846">,</span>&nbsp;<span class="ident" id="4540848">c</span><span class="op" id="4540849">.</span><span class="ident" id="4540850">element</span><span class="op" id="4540857">,</span>&nbsp;<span class="ident" id="4540859">c</span><span class="op" id="4540860">.</span><span class="ident" id="4540861">err</span><span class="op" id="4540864">)</span><br>
<span class="lineno">30</span><span class="op" id="4540866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4540869">//&nbsp;eq&nbsp;reports&nbsp;whether&nbsp;two&nbsp;contexts&nbsp;are&nbsp;equal.</span><br>
<span class="lineno"></span><span class="keyword" id="4540915">func</span>&nbsp;<span class="op" id="4540920">(</span><span class="ident" id="4540921">c</span>&nbsp;<span class="ident" id="4540923">context</span><span class="op" id="4540930">)</span>&nbsp;<span class="ident" id="4540932">eq</span><span class="op" id="4540934">(</span><span class="ident" id="4540935">d</span>&nbsp;<span class="ident" id="4540937">context</span><span class="op" id="4540944">)</span>&nbsp;<span class="builtintype" id="4540946">bool</span>&nbsp;<span class="op" id="4540951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4540954">return</span>&nbsp;<span class="ident" id="4540961">c</span><span class="op" id="4540962">.</span><span class="ident" id="4540963">state</span>&nbsp;<span class="op" id="4540969">==</span>&nbsp;<span class="ident" id="4540972">d</span><span class="op" id="4540973">.</span><span class="ident" id="4540974">state</span>&nbsp;<span class="op" id="4540980">&amp;&amp;</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4540985">c</span><span class="op" id="4540986">.</span><span class="ident" id="4540987">delim</span>&nbsp;<span class="op" id="4540993">==</span>&nbsp;<span class="ident" id="4540996">d</span><span class="op" id="4540997">.</span><span class="ident" id="4540998">delim</span>&nbsp;<span class="op" id="4541004">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541009">c</span><span class="op" id="4541010">.</span><span class="ident" id="4541011">urlPart</span>&nbsp;<span class="op" id="4541019">==</span>&nbsp;<span class="ident" id="4541022">d</span><span class="op" id="4541023">.</span><span class="ident" id="4541024">urlPart</span>&nbsp;<span class="op" id="4541032">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541037">c</span><span class="op" id="4541038">.</span><span class="ident" id="4541039">jsCtx</span>&nbsp;<span class="op" id="4541045">==</span>&nbsp;<span class="ident" id="4541048">d</span><span class="op" id="4541049">.</span><span class="ident" id="4541050">jsCtx</span>&nbsp;<span class="op" id="4541056">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541061">c</span><span class="op" id="4541062">.</span><span class="ident" id="4541063">attr</span>&nbsp;<span class="op" id="4541068">==</span>&nbsp;<span class="ident" id="4541071">d</span><span class="op" id="4541072">.</span><span class="ident" id="4541073">attr</span>&nbsp;<span class="op" id="4541078">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541083">c</span><span class="op" id="4541084">.</span><span class="ident" id="4541085">element</span>&nbsp;<span class="op" id="4541093">==</span>&nbsp;<span class="ident" id="4541096">d</span><span class="op" id="4541097">.</span><span class="ident" id="4541098">element</span>&nbsp;<span class="op" id="4541106">&amp;&amp;</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541111">c</span><span class="op" id="4541112">.</span><span class="ident" id="4541113">err</span>&nbsp;<span class="op" id="4541117">==</span>&nbsp;<span class="ident" id="4541120">d</span><span class="op" id="4541121">.</span><span class="ident" id="4541122">err</span><br>
<span class="lineno"></span><span class="op" id="4541126">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4541129">//&nbsp;mangle&nbsp;produces&nbsp;an&nbsp;identifier&nbsp;that&nbsp;includes&nbsp;a&nbsp;suffix&nbsp;that&nbsp;distinguishes&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4541207">//&nbsp;from&nbsp;template&nbsp;names&nbsp;mangled&nbsp;with&nbsp;different&nbsp;contexts.</span><br>
<span class="lineno">45</span><span class="keyword" id="4541263">func</span>&nbsp;<span class="op" id="4541268">(</span><span class="ident" id="4541269">c</span>&nbsp;<span class="ident" id="4541271">context</span><span class="op" id="4541278">)</span>&nbsp;<span class="ident" id="4541280">mangle</span><span class="op" id="4541286">(</span><span class="ident" id="4541287">templateName</span>&nbsp;<span class="builtintype" id="4541300">string</span><span class="op" id="4541306">)</span>&nbsp;<span class="builtintype" id="4541308">string</span>&nbsp;<span class="op" id="4541315">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4541318">//&nbsp;The&nbsp;mangled&nbsp;name&nbsp;for&nbsp;the&nbsp;default&nbsp;context&nbsp;is&nbsp;the&nbsp;input&nbsp;templateName.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541390">if</span>&nbsp;<span class="ident" id="4541393">c</span><span class="op" id="4541394">.</span><span class="ident" id="4541395">state</span>&nbsp;<span class="op" id="4541401">==</span>&nbsp;<span class="ident" id="4541404">stateText</span>&nbsp;<span class="op" id="4541414">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541418">return</span>&nbsp;<span class="ident" id="4541425">templateName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4541439">}</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541442">s</span>&nbsp;<span class="op" id="4541444">:=</span>&nbsp;<span class="ident" id="4541447">templateName</span>&nbsp;<span class="op" id="4541460">+</span>&nbsp;<span class="string" id="4541462">&#34;$htmltemplate_&#34;</span>&nbsp;<span class="op" id="4541479">+</span>&nbsp;<span class="ident" id="4541481">c</span><span class="op" id="4541482">.</span><span class="ident" id="4541483">state</span><span class="op" id="4541488">.</span><span class="ident" id="4541489">String</span><span class="op" id="4541495">(</span><span class="op" id="4541496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541499">if</span>&nbsp;<span class="ident" id="4541502">c</span><span class="op" id="4541503">.</span><span class="ident" id="4541504">delim</span>&nbsp;<span class="op" id="4541510">!=</span>&nbsp;<span class="num" id="4541513">0</span>&nbsp;<span class="op" id="4541515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541519">s</span>&nbsp;<span class="op" id="4541521">+=</span>&nbsp;<span class="string" id="4541524">&#34;_&#34;</span>&nbsp;<span class="op" id="4541528">+</span>&nbsp;<span class="ident" id="4541530">c</span><span class="op" id="4541531">.</span><span class="ident" id="4541532">delim</span><span class="op" id="4541537">.</span><span class="ident" id="4541538">String</span><span class="op" id="4541544">(</span><span class="op" id="4541545">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4541548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541551">if</span>&nbsp;<span class="ident" id="4541554">c</span><span class="op" id="4541555">.</span><span class="ident" id="4541556">urlPart</span>&nbsp;<span class="op" id="4541564">!=</span>&nbsp;<span class="num" id="4541567">0</span>&nbsp;<span class="op" id="4541569">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541573">s</span>&nbsp;<span class="op" id="4541575">+=</span>&nbsp;<span class="string" id="4541578">&#34;_&#34;</span>&nbsp;<span class="op" id="4541582">+</span>&nbsp;<span class="ident" id="4541584">c</span><span class="op" id="4541585">.</span><span class="ident" id="4541586">urlPart</span><span class="op" id="4541593">.</span><span class="ident" id="4541594">String</span><span class="op" id="4541600">(</span><span class="op" id="4541601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4541604">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541607">if</span>&nbsp;<span class="ident" id="4541610">c</span><span class="op" id="4541611">.</span><span class="ident" id="4541612">jsCtx</span>&nbsp;<span class="op" id="4541618">!=</span>&nbsp;<span class="num" id="4541621">0</span>&nbsp;<span class="op" id="4541623">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541627">s</span>&nbsp;<span class="op" id="4541629">+=</span>&nbsp;<span class="string" id="4541632">&#34;_&#34;</span>&nbsp;<span class="op" id="4541636">+</span>&nbsp;<span class="ident" id="4541638">c</span><span class="op" id="4541639">.</span><span class="ident" id="4541640">jsCtx</span><span class="op" id="4541645">.</span><span class="ident" id="4541646">String</span><span class="op" id="4541652">(</span><span class="op" id="4541653">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4541656">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541659">if</span>&nbsp;<span class="ident" id="4541662">c</span><span class="op" id="4541663">.</span><span class="ident" id="4541664">attr</span>&nbsp;<span class="op" id="4541669">!=</span>&nbsp;<span class="num" id="4541672">0</span>&nbsp;<span class="op" id="4541674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541678">s</span>&nbsp;<span class="op" id="4541680">+=</span>&nbsp;<span class="string" id="4541683">&#34;_&#34;</span>&nbsp;<span class="op" id="4541687">+</span>&nbsp;<span class="ident" id="4541689">c</span><span class="op" id="4541690">.</span><span class="ident" id="4541691">attr</span><span class="op" id="4541695">.</span><span class="ident" id="4541696">String</span><span class="op" id="4541702">(</span><span class="op" id="4541703">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4541706">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541709">if</span>&nbsp;<span class="ident" id="4541712">c</span><span class="op" id="4541713">.</span><span class="ident" id="4541714">element</span>&nbsp;<span class="op" id="4541722">!=</span>&nbsp;<span class="num" id="4541725">0</span>&nbsp;<span class="op" id="4541727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4541731">s</span>&nbsp;<span class="op" id="4541733">+=</span>&nbsp;<span class="string" id="4541736">&#34;_&#34;</span>&nbsp;<span class="op" id="4541740">+</span>&nbsp;<span class="ident" id="4541742">c</span><span class="op" id="4541743">.</span><span class="ident" id="4541744">element</span><span class="op" id="4541751">.</span><span class="ident" id="4541752">String</span><span class="op" id="4541758">(</span><span class="op" id="4541759">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4541762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4541765">return</span>&nbsp;<span class="ident" id="4541772">s</span><br>
<span class="lineno"></span><span class="op" id="4541774">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4541777">//&nbsp;state&nbsp;describes&nbsp;a&nbsp;high-level&nbsp;HTML&nbsp;parser&nbsp;state.</span><br>
<span class="lineno">70</span><span class="comment" id="4541828">//</span><br>
<span class="lineno"></span><span class="comment" id="4541831">//&nbsp;It&nbsp;bounds&nbsp;the&nbsp;top&nbsp;of&nbsp;the&nbsp;element&nbsp;stack,&nbsp;and&nbsp;by&nbsp;extension&nbsp;the&nbsp;HTML&nbsp;insertion</span><br>
<span class="lineno"></span><span class="comment" id="4541910">//&nbsp;mode,&nbsp;but&nbsp;also&nbsp;contains&nbsp;state&nbsp;that&nbsp;does&nbsp;not&nbsp;correspond&nbsp;to&nbsp;anything&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4541987">//&nbsp;HTML5&nbsp;parsing&nbsp;algorithm&nbsp;because&nbsp;a&nbsp;single&nbsp;token&nbsp;production&nbsp;in&nbsp;the&nbsp;HTML</span><br>
<span class="lineno"></span><span class="comment" id="4542060">//&nbsp;grammar&nbsp;may&nbsp;contain&nbsp;embedded&nbsp;actions&nbsp;in&nbsp;a&nbsp;template.&nbsp;For&nbsp;instance,&nbsp;the&nbsp;quoted</span><br>
<span class="lineno">75</span><span class="comment" id="4542140">//&nbsp;HTML&nbsp;attribute&nbsp;produced&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="4542170">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;div&nbsp;title=&#34;Hello&nbsp;{{.World}}&#34;&gt;</span><br>
<span class="lineno"></span><span class="comment" id="4542208">//&nbsp;is&nbsp;a&nbsp;single&nbsp;token&nbsp;in&nbsp;HTML&#39;s&nbsp;grammar&nbsp;but&nbsp;in&nbsp;a&nbsp;template&nbsp;spans&nbsp;several&nbsp;nodes.</span><br>
<span class="lineno"></span><span class="keyword" id="4542286">type</span>&nbsp;<span class="ident" id="4542291">state</span>&nbsp;<span class="builtintype" id="4542297">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="4542304">const</span>&nbsp;<span class="op" id="4542310">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542313">//&nbsp;stateText&nbsp;is&nbsp;parsed&nbsp;character&nbsp;data.&nbsp;An&nbsp;HTML&nbsp;parser&nbsp;is&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542374">//&nbsp;this&nbsp;state&nbsp;when&nbsp;its&nbsp;parse&nbsp;position&nbsp;is&nbsp;outside&nbsp;an&nbsp;HTML&nbsp;tag,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542437">//&nbsp;directive,&nbsp;comment,&nbsp;and&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4542487">stateText</span>&nbsp;<span class="ident" id="4542497">state</span>&nbsp;<span class="op" id="4542503">=</span>&nbsp;<span class="ident" id="4542505">iota</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542511">//&nbsp;stateTag&nbsp;occurs&nbsp;before&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;or&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4542577">stateTag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542587">//&nbsp;stateAttrName&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;attribute&nbsp;name.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542638">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;^name^&nbsp;=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4542690">stateAttrName</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542705">//&nbsp;stateAfterName&nbsp;occurs&nbsp;after&nbsp;an&nbsp;attr&nbsp;name&nbsp;has&nbsp;ended&nbsp;but&nbsp;before&nbsp;any</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542775">//&nbsp;equals&nbsp;sign.&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name^&nbsp;^=&nbsp;value`.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4542840">stateAfterName</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542856">//&nbsp;stateBeforeValue&nbsp;occurs&nbsp;after&nbsp;the&nbsp;equals&nbsp;sign&nbsp;but&nbsp;before&nbsp;the&nbsp;value.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542928">//&nbsp;It&nbsp;occurs&nbsp;between&nbsp;the&nbsp;^&#39;s&nbsp;in&nbsp;`&nbsp;name&nbsp;=^&nbsp;^value`.</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4542980">stateBeforeValue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4542998">//&nbsp;stateHTMLCmt&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;&lt;!--&nbsp;HTML&nbsp;comment&nbsp;--&gt;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4543055">stateHTMLCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4543069">//&nbsp;stateRCDATA&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;RCDATA&nbsp;element&nbsp;(&lt;textarea&gt;&nbsp;or&nbsp;&lt;title&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4543141">//&nbsp;as&nbsp;described&nbsp;at&nbsp;http://www.w3.org/TR/html5/syntax.html#elements-0</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4543211">stateRCDATA</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4543224">//&nbsp;stateAttr&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;text.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4543293">stateAttr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4543304">//&nbsp;stateURL&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;attribute&nbsp;whose&nbsp;content&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4543373">stateURL</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4543383">//&nbsp;stateJS&nbsp;occurs&nbsp;inside&nbsp;an&nbsp;event&nbsp;handler&nbsp;or&nbsp;script&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4543445">stateJS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4543454">//&nbsp;stateJSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4543520">stateJSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4543534">//&nbsp;stateJSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4543600">stateJSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4543614">//&nbsp;stateJSRegexp&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4543675">stateJSRegexp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4543690">//&nbsp;stateJSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4543758">stateJSBlockCmt</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4543775">//&nbsp;stateJSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;JavaScript&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4543838">stateJSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4543854">//&nbsp;stateCSS&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;&lt;style&gt;&nbsp;element&nbsp;or&nbsp;style&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4543919">stateCSS</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4543929">//&nbsp;stateCSSDqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4543989">stateCSSDqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4544004">//&nbsp;stateCSSSqStr&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544064">stateCSSSqStr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4544079">//&nbsp;stateCSSDqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;double&nbsp;quoted&nbsp;url(&#34;...&#34;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544143">stateCSSDqURL</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4544158">//&nbsp;stateCSSSqURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;single&nbsp;quoted&nbsp;url(&#39;...&#39;).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544222">stateCSSSqURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4544237">//&nbsp;stateCSSURL&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;unquoted&nbsp;url(...).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544292">stateCSSURL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4544305">//&nbsp;stateCSSBlockCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;/*&nbsp;block&nbsp;comment&nbsp;*/.</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544367">stateCSSBlockCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4544385">//&nbsp;stateCSSLineCmt&nbsp;occurs&nbsp;inside&nbsp;a&nbsp;CSS&nbsp;//&nbsp;line&nbsp;comment.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544442">stateCSSLineCmt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4544459">//&nbsp;stateError&nbsp;is&nbsp;an&nbsp;infectious&nbsp;error&nbsp;state&nbsp;outside&nbsp;any&nbsp;valid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4544521">//&nbsp;HTML/CSS/JS&nbsp;construct.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544548">stateError</span><br>
<span class="lineno"></span><span class="op" id="4544559">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4544562">var</span>&nbsp;<span class="ident" id="4544566">stateNames</span>&nbsp;<span class="op" id="4544577">=</span>&nbsp;<span class="op" id="4544579">[</span><span class="op" id="4544580">...</span><span class="op" id="4544583">]</span><span class="builtintype" id="4544584">string</span><span class="op" id="4544590">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544593">stateText</span><span class="op" id="4544602">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4544611">&#34;stateText&#34;</span><span class="op" id="4544622">,</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544625">stateTag</span><span class="op" id="4544633">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4544643">&#34;stateTag&#34;</span><span class="op" id="4544653">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544656">stateAttrName</span><span class="op" id="4544669">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4544674">&#34;stateAttrName&#34;</span><span class="op" id="4544689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544692">stateAfterName</span><span class="op" id="4544706">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4544710">&#34;stateAfterName&#34;</span><span class="op" id="4544726">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544729">stateBeforeValue</span><span class="op" id="4544745">:</span>&nbsp;<span class="string" id="4544747">&#34;stateBeforeValue&#34;</span><span class="op" id="4544765">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544768">stateHTMLCmt</span><span class="op" id="4544780">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4544786">&#34;stateHTMLCmt&#34;</span><span class="op" id="4544800">,</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544803">stateRCDATA</span><span class="op" id="4544814">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4544821">&#34;stateRCDATA&#34;</span><span class="op" id="4544834">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544837">stateAttr</span><span class="op" id="4544846">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4544855">&#34;stateAttr&#34;</span><span class="op" id="4544866">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544869">stateURL</span><span class="op" id="4544877">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4544887">&#34;stateURL&#34;</span><span class="op" id="4544897">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544900">stateJS</span><span class="op" id="4544907">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4544918">&#34;stateJS&#34;</span><span class="op" id="4544927">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544930">stateJSDqStr</span><span class="op" id="4544942">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4544948">&#34;stateJSDqStr&#34;</span><span class="op" id="4544962">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4544965">stateJSSqStr</span><span class="op" id="4544977">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4544983">&#34;stateJSSqStr&#34;</span><span class="op" id="4544997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545000">stateJSRegexp</span><span class="op" id="4545013">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4545018">&#34;stateJSRegexp&#34;</span><span class="op" id="4545033">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545036">stateJSBlockCmt</span><span class="op" id="4545051">:</span>&nbsp;&nbsp;<span class="string" id="4545054">&#34;stateJSBlockCmt&#34;</span><span class="op" id="4545071">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545074">stateJSLineCmt</span><span class="op" id="4545088">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4545092">&#34;stateJSLineCmt&#34;</span><span class="op" id="4545108">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545111">stateCSS</span><span class="op" id="4545119">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4545129">&#34;stateCSS&#34;</span><span class="op" id="4545139">,</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545142">stateCSSDqStr</span><span class="op" id="4545155">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4545160">&#34;stateCSSDqStr&#34;</span><span class="op" id="4545175">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545178">stateCSSSqStr</span><span class="op" id="4545191">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4545196">&#34;stateCSSSqStr&#34;</span><span class="op" id="4545211">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545214">stateCSSDqURL</span><span class="op" id="4545227">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4545232">&#34;stateCSSDqURL&#34;</span><span class="op" id="4545247">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545250">stateCSSSqURL</span><span class="op" id="4545263">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4545268">&#34;stateCSSSqURL&#34;</span><span class="op" id="4545283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545286">stateCSSURL</span><span class="op" id="4545297">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4545304">&#34;stateCSSURL&#34;</span><span class="op" id="4545317">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545320">stateCSSBlockCmt</span><span class="op" id="4545336">:</span>&nbsp;<span class="string" id="4545338">&#34;stateCSSBlockCmt&#34;</span><span class="op" id="4545356">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545359">stateCSSLineCmt</span><span class="op" id="4545374">:</span>&nbsp;&nbsp;<span class="string" id="4545377">&#34;stateCSSLineCmt&#34;</span><span class="op" id="4545394">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4545397">stateError</span><span class="op" id="4545407">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4545415">&#34;stateError&#34;</span><span class="op" id="4545427">,</span><br>
<span class="lineno"></span><span class="op" id="4545429">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">165</span><span class="keyword" id="4545432">func</span>&nbsp;<span class="op" id="4545437">(</span><span class="ident" id="4545438">s</span>&nbsp;<span class="ident" id="4545440">state</span><span class="op" id="4545445">)</span>&nbsp;<span class="ident" id="4545447">String</span><span class="op" id="4545453">(</span><span class="op" id="4545454">)</span>&nbsp;<span class="builtintype" id="4545456">string</span>&nbsp;<span class="op" id="4545463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545466">if</span>&nbsp;<span class="builtintype" id="4545469">int</span><span class="op" id="4545472">(</span><span class="ident" id="4545473">s</span><span class="op" id="4545474">)</span>&nbsp;<span class="op" id="4545476">&lt;</span>&nbsp;<span class="builtinfunc" id="4545478">len</span><span class="op" id="4545481">(</span><span class="ident" id="4545482">stateNames</span><span class="op" id="4545492">)</span>&nbsp;<span class="op" id="4545494">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545498">return</span>&nbsp;<span class="ident" id="4545505">stateNames</span><span class="op" id="4545515">[</span><span class="ident" id="4545516">s</span><span class="op" id="4545517">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4545520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545523">return</span>&nbsp;<span class="ident" id="4545530">fmt</span><span class="op" id="4545533">.</span><span class="ident" id="4545534">Sprintf</span><span class="op" id="4545541">(</span><span class="string" id="4545542">&#34;illegal&nbsp;state&nbsp;%d&#34;</span><span class="op" id="4545560">,</span>&nbsp;<span class="builtintype" id="4545562">int</span><span class="op" id="4545565">(</span><span class="ident" id="4545566">s</span><span class="op" id="4545567">)</span><span class="op" id="4545568">)</span><br>
<span class="lineno">170</span><span class="op" id="4545570">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4545573">//&nbsp;isComment&nbsp;is&nbsp;true&nbsp;for&nbsp;any&nbsp;state&nbsp;that&nbsp;contains&nbsp;content&nbsp;meant&nbsp;for&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="4545649">//&nbsp;authors&nbsp;&amp;&nbsp;maintainers,&nbsp;not&nbsp;for&nbsp;end-users&nbsp;or&nbsp;machines.</span><br>
<span class="lineno"></span><span class="keyword" id="4545706">func</span>&nbsp;<span class="ident" id="4545711">isComment</span><span class="op" id="4545720">(</span><span class="ident" id="4545721">s</span>&nbsp;<span class="ident" id="4545723">state</span><span class="op" id="4545728">)</span>&nbsp;<span class="builtintype" id="4545730">bool</span>&nbsp;<span class="op" id="4545735">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545738">switch</span>&nbsp;<span class="ident" id="4545745">s</span>&nbsp;<span class="op" id="4545747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545750">case</span>&nbsp;<span class="ident" id="4545755">stateHTMLCmt</span><span class="op" id="4545767">,</span>&nbsp;<span class="ident" id="4545769">stateJSBlockCmt</span><span class="op" id="4545784">,</span>&nbsp;<span class="ident" id="4545786">stateJSLineCmt</span><span class="op" id="4545800">,</span>&nbsp;<span class="ident" id="4545802">stateCSSBlockCmt</span><span class="op" id="4545818">,</span>&nbsp;<span class="ident" id="4545820">stateCSSLineCmt</span><span class="op" id="4545835">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545839">return</span>&nbsp;<span class="builtintype" id="4545846">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4545852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545855">return</span>&nbsp;<span class="builtintype" id="4545862">false</span><br>
<span class="lineno">180</span><span class="op" id="4545868">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4545871">//&nbsp;isInTag&nbsp;return&nbsp;whether&nbsp;s&nbsp;occurs&nbsp;solely&nbsp;inside&nbsp;an&nbsp;HTML&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="4545933">func</span>&nbsp;<span class="ident" id="4545938">isInTag</span><span class="op" id="4545945">(</span><span class="ident" id="4545946">s</span>&nbsp;<span class="ident" id="4545948">state</span><span class="op" id="4545953">)</span>&nbsp;<span class="builtintype" id="4545955">bool</span>&nbsp;<span class="op" id="4545960">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545963">switch</span>&nbsp;<span class="ident" id="4545970">s</span>&nbsp;<span class="op" id="4545972">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4545975">case</span>&nbsp;<span class="ident" id="4545980">stateTag</span><span class="op" id="4545988">,</span>&nbsp;<span class="ident" id="4545990">stateAttrName</span><span class="op" id="4546003">,</span>&nbsp;<span class="ident" id="4546005">stateAfterName</span><span class="op" id="4546019">,</span>&nbsp;<span class="ident" id="4546021">stateBeforeValue</span><span class="op" id="4546037">,</span>&nbsp;<span class="ident" id="4546039">stateAttr</span><span class="op" id="4546048">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4546052">return</span>&nbsp;<span class="builtintype" id="4546059">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4546065">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4546068">return</span>&nbsp;<span class="builtintype" id="4546075">false</span><br>
<span class="lineno"></span><span class="op" id="4546081">}</span><br>
<span class="lineno">190</span><br>
<span class="lineno"></span><span class="comment" id="4546084">//&nbsp;delim&nbsp;is&nbsp;the&nbsp;delimiter&nbsp;that&nbsp;will&nbsp;end&nbsp;the&nbsp;current&nbsp;HTML&nbsp;attribute.</span><br>
<span class="lineno"></span><span class="keyword" id="4546152">type</span>&nbsp;<span class="ident" id="4546157">delim</span>&nbsp;<span class="builtintype" id="4546163">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4546170">const</span>&nbsp;<span class="op" id="4546176">(</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4546179">//&nbsp;delimNone&nbsp;occurs&nbsp;outside&nbsp;any&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4546223">delimNone</span>&nbsp;<span class="ident" id="4546233">delim</span>&nbsp;<span class="op" id="4546239">=</span>&nbsp;<span class="ident" id="4546241">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4546247">//&nbsp;delimDoubleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;double&nbsp;quote&nbsp;(&#34;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4546321">delimDoubleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4546339">//&nbsp;delimSingleQuote&nbsp;occurs&nbsp;when&nbsp;a&nbsp;single&nbsp;quote&nbsp;(&#39;)&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4546413">delimSingleQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4546431">//&nbsp;delimSpaceOrTagEnd&nbsp;occurs&nbsp;when&nbsp;a&nbsp;space&nbsp;or&nbsp;right&nbsp;angle&nbsp;bracket&nbsp;(&gt;)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4546501">//&nbsp;closes&nbsp;the&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4546527">delimSpaceOrTagEnd</span><br>
<span class="lineno"></span><span class="op" id="4546546">)</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="keyword" id="4546549">var</span>&nbsp;<span class="ident" id="4546553">delimNames</span>&nbsp;<span class="op" id="4546564">=</span>&nbsp;<span class="op" id="4546566">[</span><span class="op" id="4546567">...</span><span class="op" id="4546570">]</span><span class="builtintype" id="4546571">string</span><span class="op" id="4546577">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4546580">delimNone</span><span class="op" id="4546589">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4546600">&#34;delimNone&#34;</span><span class="op" id="4546611">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4546614">delimDoubleQuote</span><span class="op" id="4546630">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4546634">&#34;delimDoubleQuote&#34;</span><span class="op" id="4546652">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4546655">delimSingleQuote</span><span class="op" id="4546671">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4546675">&#34;delimSingleQuote&#34;</span><span class="op" id="4546693">,</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4546696">delimSpaceOrTagEnd</span><span class="op" id="4546714">:</span>&nbsp;<span class="string" id="4546716">&#34;delimSpaceOrTagEnd&#34;</span><span class="op" id="4546736">,</span><br>
<span class="lineno"></span><span class="op" id="4546738">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4546741">func</span>&nbsp;<span class="op" id="4546746">(</span><span class="ident" id="4546747">d</span>&nbsp;<span class="ident" id="4546749">delim</span><span class="op" id="4546754">)</span>&nbsp;<span class="ident" id="4546756">String</span><span class="op" id="4546762">(</span><span class="op" id="4546763">)</span>&nbsp;<span class="builtintype" id="4546765">string</span>&nbsp;<span class="op" id="4546772">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4546775">if</span>&nbsp;<span class="builtintype" id="4546778">int</span><span class="op" id="4546781">(</span><span class="ident" id="4546782">d</span><span class="op" id="4546783">)</span>&nbsp;<span class="op" id="4546785">&lt;</span>&nbsp;<span class="builtinfunc" id="4546787">len</span><span class="op" id="4546790">(</span><span class="ident" id="4546791">delimNames</span><span class="op" id="4546801">)</span>&nbsp;<span class="op" id="4546803">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4546807">return</span>&nbsp;<span class="ident" id="4546814">delimNames</span><span class="op" id="4546824">[</span><span class="ident" id="4546825">d</span><span class="op" id="4546826">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4546829">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4546832">return</span>&nbsp;<span class="ident" id="4546839">fmt</span><span class="op" id="4546842">.</span><span class="ident" id="4546843">Sprintf</span><span class="op" id="4546850">(</span><span class="string" id="4546851">&#34;illegal&nbsp;delim&nbsp;%d&#34;</span><span class="op" id="4546869">,</span>&nbsp;<span class="builtintype" id="4546871">int</span><span class="op" id="4546874">(</span><span class="ident" id="4546875">d</span><span class="op" id="4546876">)</span><span class="op" id="4546877">)</span><br>
<span class="lineno"></span><span class="op" id="4546879">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span><span class="comment" id="4546882">//&nbsp;urlPart&nbsp;identifies&nbsp;a&nbsp;part&nbsp;in&nbsp;an&nbsp;RFC&nbsp;3986&nbsp;hierarchical&nbsp;URL&nbsp;to&nbsp;allow&nbsp;different</span><br>
<span class="lineno"></span><span class="comment" id="4546962">//&nbsp;encoding&nbsp;strategies.</span><br>
<span class="lineno"></span><span class="keyword" id="4546986">type</span>&nbsp;<span class="ident" id="4546991">urlPart</span>&nbsp;<span class="builtintype" id="4546999">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4547006">const</span>&nbsp;<span class="op" id="4547012">(</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4547015">//&nbsp;urlPartNone&nbsp;occurs&nbsp;when&nbsp;not&nbsp;in&nbsp;a&nbsp;URL,&nbsp;or&nbsp;possibly&nbsp;at&nbsp;the&nbsp;start:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4547083">//&nbsp;^&nbsp;in&nbsp;&#34;^http://auth/path?k=v#frag&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4547122">urlPartNone</span>&nbsp;<span class="ident" id="4547134">urlPart</span>&nbsp;<span class="op" id="4547142">=</span>&nbsp;<span class="ident" id="4547144">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4547150">//&nbsp;urlPartPreQuery&nbsp;occurs&nbsp;in&nbsp;the&nbsp;scheme,&nbsp;authority,&nbsp;or&nbsp;path;&nbsp;between&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4547224">//&nbsp;^s&nbsp;in&nbsp;&#34;h^ttp://auth/path^?k=v#frag&#34;.</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4547265">urlPartPreQuery</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4547282">//&nbsp;urlPartQueryOrFrag&nbsp;occurs&nbsp;in&nbsp;the&nbsp;query&nbsp;portion&nbsp;between&nbsp;the&nbsp;^s&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4547351">//&nbsp;&#34;http://auth/path?^k=v#frag^&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4547386">urlPartQueryOrFrag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4547406">//&nbsp;urlPartUnknown&nbsp;occurs&nbsp;due&nbsp;to&nbsp;joining&nbsp;of&nbsp;contexts&nbsp;both&nbsp;before&nbsp;and</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4547475">//&nbsp;after&nbsp;the&nbsp;query&nbsp;separator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4547506">urlPartUnknown</span><br>
<span class="lineno"></span><span class="op" id="4547521">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4547524">var</span>&nbsp;<span class="ident" id="4547528">urlPartNames</span>&nbsp;<span class="op" id="4547541">=</span>&nbsp;<span class="op" id="4547543">[</span><span class="op" id="4547544">...</span><span class="op" id="4547547">]</span><span class="builtintype" id="4547548">string</span><span class="op" id="4547554">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4547557">urlPartNone</span><span class="op" id="4547568">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4547577">&#34;urlPartNone&#34;</span><span class="op" id="4547590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4547593">urlPartPreQuery</span><span class="op" id="4547608">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4547613">&#34;urlPartPreQuery&#34;</span><span class="op" id="4547630">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4547633">urlPartQueryOrFrag</span><span class="op" id="4547651">:</span>&nbsp;<span class="string" id="4547653">&#34;urlPartQueryOrFrag&#34;</span><span class="op" id="4547673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4547676">urlPartUnknown</span><span class="op" id="4547690">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4547696">&#34;urlPartUnknown&#34;</span><span class="op" id="4547712">,</span><br>
<span class="lineno"></span><span class="op" id="4547714">}</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="4547717">func</span>&nbsp;<span class="op" id="4547722">(</span><span class="ident" id="4547723">u</span>&nbsp;<span class="ident" id="4547725">urlPart</span><span class="op" id="4547732">)</span>&nbsp;<span class="ident" id="4547734">String</span><span class="op" id="4547740">(</span><span class="op" id="4547741">)</span>&nbsp;<span class="builtintype" id="4547743">string</span>&nbsp;<span class="op" id="4547750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547753">if</span>&nbsp;<span class="builtintype" id="4547756">int</span><span class="op" id="4547759">(</span><span class="ident" id="4547760">u</span><span class="op" id="4547761">)</span>&nbsp;<span class="op" id="4547763">&lt;</span>&nbsp;<span class="builtinfunc" id="4547765">len</span><span class="op" id="4547768">(</span><span class="ident" id="4547769">urlPartNames</span><span class="op" id="4547781">)</span>&nbsp;<span class="op" id="4547783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547787">return</span>&nbsp;<span class="ident" id="4547794">urlPartNames</span><span class="op" id="4547806">[</span><span class="ident" id="4547807">u</span><span class="op" id="4547808">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4547811">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4547814">return</span>&nbsp;<span class="ident" id="4547821">fmt</span><span class="op" id="4547824">.</span><span class="ident" id="4547825">Sprintf</span><span class="op" id="4547832">(</span><span class="string" id="4547833">&#34;illegal&nbsp;urlPart&nbsp;%d&#34;</span><span class="op" id="4547853">,</span>&nbsp;<span class="builtintype" id="4547855">int</span><span class="op" id="4547858">(</span><span class="ident" id="4547859">u</span><span class="op" id="4547860">)</span><span class="op" id="4547861">)</span><br>
<span class="lineno"></span><span class="op" id="4547863">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4547866">//&nbsp;jsCtx&nbsp;determines&nbsp;whether&nbsp;a&nbsp;&#39;/&#39;&nbsp;starts&nbsp;a&nbsp;regular&nbsp;expression&nbsp;literal&nbsp;or&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4547941">//&nbsp;division&nbsp;operator.</span><br>
<span class="lineno">255</span><span class="keyword" id="4547963">type</span>&nbsp;<span class="ident" id="4547968">jsCtx</span>&nbsp;<span class="builtintype" id="4547974">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4547981">const</span>&nbsp;<span class="op" id="4547987">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4547990">//&nbsp;jsCtxRegexp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;regexp&nbsp;literal.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4548055">jsCtxRegexp</span>&nbsp;<span class="ident" id="4548067">jsCtx</span>&nbsp;<span class="op" id="4548073">=</span>&nbsp;<span class="ident" id="4548075">iota</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4548081">//&nbsp;jsCtxDivOp&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;would&nbsp;start&nbsp;a&nbsp;division&nbsp;operator.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4548148">jsCtxDivOp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4548160">//&nbsp;jsCtxUnknown&nbsp;occurs&nbsp;where&nbsp;a&nbsp;&#39;/&#39;&nbsp;is&nbsp;ambiguous&nbsp;due&nbsp;to&nbsp;context&nbsp;joining.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4548233">jsCtxUnknown</span><br>
<span class="lineno"></span><span class="op" id="4548246">)</span><br>
<span class="lineno">265</span><br>
<span class="lineno"></span><span class="keyword" id="4548249">func</span>&nbsp;<span class="op" id="4548254">(</span><span class="ident" id="4548255">c</span>&nbsp;<span class="ident" id="4548257">jsCtx</span><span class="op" id="4548262">)</span>&nbsp;<span class="ident" id="4548264">String</span><span class="op" id="4548270">(</span><span class="op" id="4548271">)</span>&nbsp;<span class="builtintype" id="4548273">string</span>&nbsp;<span class="op" id="4548280">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4548283">switch</span>&nbsp;<span class="ident" id="4548290">c</span>&nbsp;<span class="op" id="4548292">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4548295">case</span>&nbsp;<span class="ident" id="4548300">jsCtxRegexp</span><span class="op" id="4548311">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4548315">return</span>&nbsp;<span class="string" id="4548322">&#34;jsCtxRegexp&#34;</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4548337">case</span>&nbsp;<span class="ident" id="4548342">jsCtxDivOp</span><span class="op" id="4548352">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4548356">return</span>&nbsp;<span class="string" id="4548363">&#34;jsCtxDivOp&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4548377">case</span>&nbsp;<span class="ident" id="4548382">jsCtxUnknown</span><span class="op" id="4548394">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4548398">return</span>&nbsp;<span class="string" id="4548405">&#34;jsCtxUnknown&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4548421">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4548424">return</span>&nbsp;<span class="ident" id="4548431">fmt</span><span class="op" id="4548434">.</span><span class="ident" id="4548435">Sprintf</span><span class="op" id="4548442">(</span><span class="string" id="4548443">&#34;illegal&nbsp;jsCtx&nbsp;%d&#34;</span><span class="op" id="4548461">,</span>&nbsp;<span class="builtintype" id="4548463">int</span><span class="op" id="4548466">(</span><span class="ident" id="4548467">c</span><span class="op" id="4548468">)</span><span class="op" id="4548469">)</span><br>
<span class="lineno"></span><span class="op" id="4548471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4548474">//&nbsp;element&nbsp;identifies&nbsp;the&nbsp;HTML&nbsp;element&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag&nbsp;or&nbsp;special&nbsp;body.</span><br>
<span class="lineno"></span><span class="comment" id="4548554">//&nbsp;Certain&nbsp;HTML&nbsp;element&nbsp;(for&nbsp;example&nbsp;&lt;script&gt;&nbsp;and&nbsp;&lt;style&gt;)&nbsp;have&nbsp;bodies&nbsp;that&nbsp;are</span><br>
<span class="lineno">280</span><span class="comment" id="4548634">//&nbsp;treated&nbsp;differently&nbsp;from&nbsp;stateText&nbsp;so&nbsp;the&nbsp;element&nbsp;type&nbsp;is&nbsp;necessary&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4548708">//&nbsp;transition&nbsp;into&nbsp;the&nbsp;correct&nbsp;context&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;a&nbsp;tag&nbsp;and&nbsp;to&nbsp;identify&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4548787">//&nbsp;end&nbsp;delimiter&nbsp;for&nbsp;the&nbsp;body.</span><br>
<span class="lineno"></span><span class="keyword" id="4548818">type</span>&nbsp;<span class="ident" id="4548823">element</span>&nbsp;<span class="builtintype" id="4548831">uint8</span><br>
<span class="lineno"></span><br>
<span class="lineno">285</span><span class="keyword" id="4548838">const</span>&nbsp;<span class="op" id="4548844">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4548847">//&nbsp;elementNone&nbsp;occurs&nbsp;outside&nbsp;a&nbsp;special&nbsp;tag&nbsp;or&nbsp;special&nbsp;element&nbsp;body.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4548917">elementNone</span>&nbsp;<span class="ident" id="4548929">element</span>&nbsp;<span class="op" id="4548937">=</span>&nbsp;<span class="ident" id="4548939">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4548945">//&nbsp;elementScript&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;script&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4549009">elementScript</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4549024">//&nbsp;elementStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;raw&nbsp;text&nbsp;&lt;style&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4549086">elementStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4549100">//&nbsp;elementTextarea&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;textarea&gt;&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4549166">elementTextarea</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4549183">//&nbsp;elementTitle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;RCDATA&nbsp;&lt;title&gt;&nbsp;element.</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4549243">elementTitle</span><br>
<span class="lineno"></span><span class="op" id="4549256">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4549259">var</span>&nbsp;<span class="ident" id="4549263">elementNames</span>&nbsp;<span class="op" id="4549276">=</span>&nbsp;<span class="op" id="4549278">[</span><span class="op" id="4549279">...</span><span class="op" id="4549282">]</span><span class="builtintype" id="4549283">string</span><span class="op" id="4549289">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4549292">elementNone</span><span class="op" id="4549303">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4549309">&#34;elementNone&#34;</span><span class="op" id="4549322">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4549325">elementScript</span><span class="op" id="4549338">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4549342">&#34;elementScript&#34;</span><span class="op" id="4549357">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4549360">elementStyle</span><span class="op" id="4549372">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4549377">&#34;elementStyle&#34;</span><span class="op" id="4549391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4549394">elementTextarea</span><span class="op" id="4549409">:</span>&nbsp;<span class="string" id="4549411">&#34;elementTextarea&#34;</span><span class="op" id="4549428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4549431">elementTitle</span><span class="op" id="4549443">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4549448">&#34;elementTitle&#34;</span><span class="op" id="4549462">,</span><br>
<span class="lineno"></span><span class="op" id="4549464">}</span><br>
<span class="lineno">305</span><br>
<span class="lineno"></span><span class="keyword" id="4549467">func</span>&nbsp;<span class="op" id="4549472">(</span><span class="ident" id="4549473">e</span>&nbsp;<span class="ident" id="4549475">element</span><span class="op" id="4549482">)</span>&nbsp;<span class="ident" id="4549484">String</span><span class="op" id="4549490">(</span><span class="op" id="4549491">)</span>&nbsp;<span class="builtintype" id="4549493">string</span>&nbsp;<span class="op" id="4549500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4549503">if</span>&nbsp;<span class="builtintype" id="4549506">int</span><span class="op" id="4549509">(</span><span class="ident" id="4549510">e</span><span class="op" id="4549511">)</span>&nbsp;<span class="op" id="4549513">&lt;</span>&nbsp;<span class="builtinfunc" id="4549515">len</span><span class="op" id="4549518">(</span><span class="ident" id="4549519">elementNames</span><span class="op" id="4549531">)</span>&nbsp;<span class="op" id="4549533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4549537">return</span>&nbsp;<span class="ident" id="4549544">elementNames</span><span class="op" id="4549556">[</span><span class="ident" id="4549557">e</span><span class="op" id="4549558">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4549561">}</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4549564">return</span>&nbsp;<span class="ident" id="4549571">fmt</span><span class="op" id="4549574">.</span><span class="ident" id="4549575">Sprintf</span><span class="op" id="4549582">(</span><span class="string" id="4549583">&#34;illegal&nbsp;element&nbsp;%d&#34;</span><span class="op" id="4549603">,</span>&nbsp;<span class="builtintype" id="4549605">int</span><span class="op" id="4549608">(</span><span class="ident" id="4549609">e</span><span class="op" id="4549610">)</span><span class="op" id="4549611">)</span><br>
<span class="lineno"></span><span class="op" id="4549613">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4549616">//&nbsp;attr&nbsp;identifies&nbsp;the&nbsp;most&nbsp;recent&nbsp;HTML&nbsp;attribute&nbsp;when&nbsp;inside&nbsp;a&nbsp;start&nbsp;tag.</span><br>
<span class="lineno"></span><span class="keyword" id="4549691">type</span>&nbsp;<span class="ident" id="4549696">attr</span>&nbsp;<span class="builtintype" id="4549701">uint8</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="4549708">const</span>&nbsp;<span class="op" id="4549714">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4549717">//&nbsp;attrNone&nbsp;corresponds&nbsp;to&nbsp;a&nbsp;normal&nbsp;attribute&nbsp;or&nbsp;no&nbsp;attribute.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4549781">attrNone</span>&nbsp;<span class="ident" id="4549790">attr</span>&nbsp;<span class="op" id="4549795">=</span>&nbsp;<span class="ident" id="4549797">iota</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4549803">//&nbsp;attrScript&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;event&nbsp;handler&nbsp;attribute.</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4549861">attrScript</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4549873">//&nbsp;attrStyle&nbsp;corresponds&nbsp;to&nbsp;the&nbsp;style&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;CSS.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4549942">attrStyle</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4549953">//&nbsp;attrURL&nbsp;corresponds&nbsp;to&nbsp;an&nbsp;attribute&nbsp;whose&nbsp;value&nbsp;is&nbsp;a&nbsp;URL.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4550015">attrURL</span><br>
<span class="lineno">325</span><span class="op" id="4550023">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4550026">var</span>&nbsp;<span class="ident" id="4550030">attrNames</span>&nbsp;<span class="op" id="4550040">=</span>&nbsp;<span class="op" id="4550042">[</span><span class="op" id="4550043">...</span><span class="op" id="4550046">]</span><span class="builtintype" id="4550047">string</span><span class="op" id="4550053">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4550056">attrNone</span><span class="op" id="4550064">:</span>&nbsp;&nbsp;&nbsp;<span class="string" id="4550068">&#34;attrNone&#34;</span><span class="op" id="4550078">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4550081">attrScript</span><span class="op" id="4550091">:</span>&nbsp;<span class="string" id="4550093">&#34;attrScript&#34;</span><span class="op" id="4550105">,</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4550108">attrStyle</span><span class="op" id="4550117">:</span>&nbsp;&nbsp;<span class="string" id="4550120">&#34;attrStyle&#34;</span><span class="op" id="4550131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4550134">attrURL</span><span class="op" id="4550141">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4550146">&#34;attrURL&#34;</span><span class="op" id="4550155">,</span><br>
<span class="lineno"></span><span class="op" id="4550157">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4550160">func</span>&nbsp;<span class="op" id="4550165">(</span><span class="ident" id="4550166">a</span>&nbsp;<span class="ident" id="4550168">attr</span><span class="op" id="4550172">)</span>&nbsp;<span class="ident" id="4550174">String</span><span class="op" id="4550180">(</span><span class="op" id="4550181">)</span>&nbsp;<span class="builtintype" id="4550183">string</span>&nbsp;<span class="op" id="4550190">{</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4550193">if</span>&nbsp;<span class="builtintype" id="4550196">int</span><span class="op" id="4550199">(</span><span class="ident" id="4550200">a</span><span class="op" id="4550201">)</span>&nbsp;<span class="op" id="4550203">&lt;</span>&nbsp;<span class="builtinfunc" id="4550205">len</span><span class="op" id="4550208">(</span><span class="ident" id="4550209">attrNames</span><span class="op" id="4550218">)</span>&nbsp;<span class="op" id="4550220">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4550224">return</span>&nbsp;<span class="ident" id="4550231">attrNames</span><span class="op" id="4550240">[</span><span class="ident" id="4550241">a</span><span class="op" id="4550242">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4550245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4550248">return</span>&nbsp;<span class="ident" id="4550255">fmt</span><span class="op" id="4550258">.</span><span class="ident" id="4550259">Sprintf</span><span class="op" id="4550266">(</span><span class="string" id="4550267">&#34;illegal&nbsp;attr&nbsp;%d&#34;</span><span class="op" id="4550284">,</span>&nbsp;<span class="builtintype" id="4550286">int</span><span class="op" id="4550289">(</span><span class="ident" id="4550290">a</span><span class="op" id="4550291">)</span><span class="op" id="4550292">)</span><br>
<span class="lineno"></span><span class="op" id="4550294">}</span>
</div>
</body>
</html>
