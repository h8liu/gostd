<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6399966">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6400021">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6400075">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6400126">package</span>&nbsp;<span class="ident" id="6400134">zip</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6400139">import</span>&nbsp;<span class="op" id="6400146">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6400149">&#34;compress/flate&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6400167">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6400177">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6400183">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6400196">&#34;sync&#34;</span><br>
<span class="lineno"></span><span class="op" id="6400203">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">15</span><span class="comment" id="6400206">//&nbsp;A&nbsp;Compressor&nbsp;returns&nbsp;a&nbsp;compressing&nbsp;writer,&nbsp;writing&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6400267">//&nbsp;provided&nbsp;writer.&nbsp;On&nbsp;Close,&nbsp;any&nbsp;pending&nbsp;data&nbsp;should&nbsp;be&nbsp;flushed.</span><br>
<span class="lineno"></span><span class="keyword" id="6400333">type</span>&nbsp;<span class="ident" id="6400338">Compressor</span>&nbsp;<span class="keyword" id="6400349">func</span><span class="op" id="6400353">(</span><span class="ident" id="6400354"><a href="/archive/zip/register.go.html#6400177">io</a></span><span class="op" id="6400356">.</span><span class="ident" id="6400357">Writer</span><span class="op" id="6400363">)</span>&nbsp;<span class="op" id="6400365">(</span><span class="ident" id="6400366"><a href="/archive/zip/register.go.html#6400177">io</a></span><span class="op" id="6400368">.</span><span class="ident" id="6400369">WriteCloser</span><span class="op" id="6400380">,</span>&nbsp;<span class="builtintype" id="6400382">error</span><span class="op" id="6400387">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6400390">//&nbsp;Decompressor&nbsp;is&nbsp;a&nbsp;function&nbsp;that&nbsp;wraps&nbsp;a&nbsp;Reader&nbsp;with&nbsp;a&nbsp;decompressing&nbsp;Reader.</span><br>
<span class="lineno">20</span><span class="comment" id="6400469">//&nbsp;The&nbsp;decompressed&nbsp;ReadCloser&nbsp;is&nbsp;returned&nbsp;to&nbsp;callers&nbsp;who&nbsp;open&nbsp;files&nbsp;from</span><br>
<span class="lineno"></span><span class="comment" id="6400543">//&nbsp;within&nbsp;the&nbsp;archive.&nbsp;&nbsp;These&nbsp;callers&nbsp;are&nbsp;responsible&nbsp;for&nbsp;closing&nbsp;this&nbsp;reader</span><br>
<span class="lineno"></span><span class="comment" id="6400621">//&nbsp;when&nbsp;they&#39;re&nbsp;finished&nbsp;reading.</span><br>
<span class="lineno"></span><span class="keyword" id="6400655">type</span>&nbsp;<span class="ident" id="6400660">Decompressor</span>&nbsp;<span class="keyword" id="6400673">func</span><span class="op" id="6400677">(</span><span class="ident" id="6400678"><a href="/archive/zip/register.go.html#6400177">io</a></span><span class="op" id="6400680">.</span><span class="ident" id="6400681">Reader</span><span class="op" id="6400687">)</span>&nbsp;<span class="ident" id="6400689"><a href="/archive/zip/register.go.html#6400177">io</a></span><span class="op" id="6400691">.</span><span class="ident" id="6400692">ReadCloser</span><br>
<span class="lineno"></span><br>
<span class="lineno">25</span><span class="keyword" id="6400704">var</span>&nbsp;<span class="ident" id="6400708">flateWriterPool</span>&nbsp;<span class="ident" id="6400724"><a href="/archive/zip/register.go.html#6400196">sync</a></span><span class="op" id="6400728">.</span><span class="ident" id="6400729">Pool</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6400735">func</span>&nbsp;<span class="ident" id="6400740">newFlateWriter</span><span class="op" id="6400754">(</span><span class="ident" id="6400755">w</span>&nbsp;<span class="ident" id="6400757"><a href="/archive/zip/register.go.html#6400177">io</a></span><span class="op" id="6400759">.</span><span class="ident" id="6400760">Writer</span><span class="op" id="6400766">)</span>&nbsp;<span class="ident" id="6400768"><a href="/archive/zip/register.go.html#6400177">io</a></span><span class="op" id="6400770">.</span><span class="ident" id="6400771">WriteCloser</span>&nbsp;<span class="op" id="6400783">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6400786">fw</span><span class="op" id="6400788">,</span>&nbsp;<span class="ident" id="6400790">ok</span>&nbsp;<span class="op" id="6400793">:=</span>&nbsp;<span class="ident" id="6400796"><a href="/archive/zip/register.go.html#6400708">flateWriterPool</a></span><span class="op" id="6400811">.</span><span class="ident" id="6400812">Get</span><span class="op" id="6400815">(</span><span class="op" id="6400816">)</span><span class="op" id="6400817">.</span><span class="op" id="6400818">(</span><span class="op" id="6400819">*</span><span class="ident" id="6400820"><a href="/archive/zip/register.go.html#6400149">flate</a></span><span class="op" id="6400825">.</span><span class="ident" id="6400826">Writer</span><span class="op" id="6400832">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6400835">if</span>&nbsp;<span class="ident" id="6400838"><a href="/archive/zip/register.go.html#6400790">ok</a></span>&nbsp;<span class="op" id="6400841">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6400845"><a href="/archive/zip/register.go.html#6400786">fw</a></span><span class="op" id="6400847">.</span><span class="ident" id="6400848">Reset</span><span class="op" id="6400853">(</span><span class="ident" id="6400854"><a href="/archive/zip/register.go.html#6400755">w</a></span><span class="op" id="6400855">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6400858">}</span>&nbsp;<span class="keyword" id="6400860">else</span>&nbsp;<span class="op" id="6400865">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6400869"><a href="/archive/zip/register.go.html#6400786">fw</a></span><span class="op" id="6400871">,</span>&nbsp;<span class="ident" id="6400873">_</span>&nbsp;<span class="op" id="6400875">=</span>&nbsp;<span class="ident" id="6400877"><a href="/archive/zip/register.go.html#6400149">flate</a></span><span class="op" id="6400882">.</span><span class="ident" id="6400883">NewWriter</span><span class="op" id="6400892">(</span><span class="ident" id="6400893"><a href="/archive/zip/register.go.html#6400755">w</a></span><span class="op" id="6400894">,</span>&nbsp;<span class="num" id="6400896">5</span><span class="op" id="6400897">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6400900">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6400903">return</span>&nbsp;<span class="op" id="6400910">&amp;</span><span class="ident" id="6400911"><a href="/archive/zip/register.go.html#6400945">pooledFlateWriter</a></span><span class="op" id="6400928">{</span><span class="ident" id="6400929">fw</span><span class="op" id="6400931">:</span>&nbsp;<span class="ident" id="6400933"><a href="/archive/zip/register.go.html#6400786">fw</a></span><span class="op" id="6400935">}</span><br>
<span class="lineno">35</span><span class="op" id="6400937">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6400940">type</span>&nbsp;<span class="ident" id="6400945">pooledFlateWriter</span>&nbsp;<span class="keyword" id="6400963">struct</span>&nbsp;<span class="op" id="6400970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6400973">mu</span>&nbsp;<span class="ident" id="6400976"><a href="/archive/zip/register.go.html#6400196">sync</a></span><span class="op" id="6400980">.</span><span class="ident" id="6400981">Mutex</span>&nbsp;<span class="comment" id="6400987">//&nbsp;guards&nbsp;Close&nbsp;and&nbsp;Write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6401014">fw</span>&nbsp;<span class="op" id="6401017">*</span><span class="ident" id="6401018"><a href="/archive/zip/register.go.html#6400149">flate</a></span><span class="op" id="6401023">.</span><span class="ident" id="6401024">Writer</span><br>
<span class="lineno">40</span><span class="op" id="6401031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6401034">func</span>&nbsp;<span class="op" id="6401039">(</span><span class="ident" id="6401040">w</span>&nbsp;<span class="op" id="6401042">*</span><span class="ident" id="6401043"><a href="/archive/zip/register.go.html#6400945">pooledFlateWriter</a></span><span class="op" id="6401060">)</span>&nbsp;<span class="ident" id="6401062">Write</span><span class="op" id="6401067">(</span><span class="ident" id="6401068">p</span>&nbsp;<span class="op" id="6401070">[</span><span class="op" id="6401071">]</span><span class="builtintype" id="6401072">byte</span><span class="op" id="6401076">)</span>&nbsp;<span class="op" id="6401078">(</span><span class="ident" id="6401079">n</span>&nbsp;<span class="builtintype" id="6401081">int</span><span class="op" id="6401084">,</span>&nbsp;<span class="ident" id="6401086">err</span>&nbsp;<span class="builtintype" id="6401090">error</span><span class="op" id="6401095">)</span>&nbsp;<span class="op" id="6401097">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6401100"><a href="/archive/zip/register.go.html#6401040">w</a></span><span class="op" id="6401101">.</span><span class="ident" id="6401102">mu</span><span class="op" id="6401104">.</span><span class="ident" id="6401105">Lock</span><span class="op" id="6401109">(</span><span class="op" id="6401110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6401113">defer</span>&nbsp;<span class="ident" id="6401119"><a href="/archive/zip/register.go.html#6401040">w</a></span><span class="op" id="6401120">.</span><span class="ident" id="6401121">mu</span><span class="op" id="6401123">.</span><span class="ident" id="6401124">Unlock</span><span class="op" id="6401130">(</span><span class="op" id="6401131">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6401134">if</span>&nbsp;<span class="ident" id="6401137"><a href="/archive/zip/register.go.html#6401040">w</a></span><span class="op" id="6401138">.</span><span class="ident" id="6401139">fw</span>&nbsp;<span class="op" id="6401142">==</span>&nbsp;<span class="ident" id="6401145">nil</span>&nbsp;<span class="op" id="6401149">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6401153">return</span>&nbsp;<span class="num" id="6401160">0</span><span class="op" id="6401161">,</span>&nbsp;<span class="ident" id="6401163"><a href="/archive/zip/register.go.html#6400167">errors</a></span><span class="op" id="6401169">.</span><span class="ident" id="6401170">New</span><span class="op" id="6401173">(</span><span class="string" id="6401174">&#34;Write&nbsp;after&nbsp;Close&#34;</span><span class="op" id="6401193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6401196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6401199">return</span>&nbsp;<span class="ident" id="6401206"><a href="/archive/zip/register.go.html#6401040">w</a></span><span class="op" id="6401207">.</span><span class="ident" id="6401208">fw</span><span class="op" id="6401210">.</span><span class="ident" id="6401211">Write</span><span class="op" id="6401216">(</span><span class="ident" id="6401217"><a href="/archive/zip/register.go.html#6401068">p</a></span><span class="op" id="6401218">)</span><br>
<span class="lineno"></span><span class="op" id="6401220">}</span><br>
<span class="lineno">50</span><br>
<span class="lineno"></span><span class="keyword" id="6401223">func</span>&nbsp;<span class="op" id="6401228">(</span><span class="ident" id="6401229">w</span>&nbsp;<span class="op" id="6401231">*</span><span class="ident" id="6401232"><a href="/archive/zip/register.go.html#6400945">pooledFlateWriter</a></span><span class="op" id="6401249">)</span>&nbsp;<span class="ident" id="6401251">Close</span><span class="op" id="6401256">(</span><span class="op" id="6401257">)</span>&nbsp;<span class="builtintype" id="6401259">error</span>&nbsp;<span class="op" id="6401265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6401268"><a href="/archive/zip/register.go.html#6401229">w</a></span><span class="op" id="6401269">.</span><span class="ident" id="6401270">mu</span><span class="op" id="6401272">.</span><span class="ident" id="6401273">Lock</span><span class="op" id="6401277">(</span><span class="op" id="6401278">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6401281">defer</span>&nbsp;<span class="ident" id="6401287"><a href="/archive/zip/register.go.html#6401229">w</a></span><span class="op" id="6401288">.</span><span class="ident" id="6401289">mu</span><span class="op" id="6401291">.</span><span class="ident" id="6401292">Unlock</span><span class="op" id="6401298">(</span><span class="op" id="6401299">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6401302">var</span>&nbsp;<span class="ident" id="6401306">err</span>&nbsp;<span class="builtintype" id="6401310">error</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6401317">if</span>&nbsp;<span class="ident" id="6401320"><a href="/archive/zip/register.go.html#6401229">w</a></span><span class="op" id="6401321">.</span><span class="ident" id="6401322">fw</span>&nbsp;<span class="op" id="6401325">!=</span>&nbsp;<span class="ident" id="6401328">nil</span>&nbsp;<span class="op" id="6401332">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6401336"><a href="/archive/zip/register.go.html#6401306">err</a></span>&nbsp;<span class="op" id="6401340">=</span>&nbsp;<span class="ident" id="6401342"><a href="/archive/zip/register.go.html#6401229">w</a></span><span class="op" id="6401343">.</span><span class="ident" id="6401344">fw</span><span class="op" id="6401346">.</span><span class="ident" id="6401347">Close</span><span class="op" id="6401352">(</span><span class="op" id="6401353">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6401357"><a href="/archive/zip/register.go.html#6400708">flateWriterPool</a></span><span class="op" id="6401372">.</span><span class="ident" id="6401373">Put</span><span class="op" id="6401376">(</span><span class="ident" id="6401377"><a href="/archive/zip/register.go.html#6401229">w</a></span><span class="op" id="6401378">.</span><span class="ident" id="6401379">fw</span><span class="op" id="6401381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6401385"><a href="/archive/zip/register.go.html#6401229">w</a></span><span class="op" id="6401386">.</span><span class="ident" id="6401387">fw</span>&nbsp;<span class="op" id="6401390">=</span>&nbsp;<span class="ident" id="6401392">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6401397">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6401400">return</span>&nbsp;<span class="ident" id="6401407"><a href="/archive/zip/register.go.html#6401306">err</a></span><br>
<span class="lineno"></span><span class="op" id="6401411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6401414">var</span>&nbsp;<span class="op" id="6401418">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6401421">mu</span>&nbsp;<span class="ident" id="6401424"><a href="/archive/zip/register.go.html#6400196">sync</a></span><span class="op" id="6401428">.</span><span class="ident" id="6401429">RWMutex</span>&nbsp;<span class="comment" id="6401437">//&nbsp;guards&nbsp;compressor&nbsp;and&nbsp;decompressor&nbsp;maps</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6401482">compressors</span>&nbsp;<span class="op" id="6401494">=</span>&nbsp;<span class="keyword" id="6401496">map</span><span class="op" id="6401499">[</span><span class="builtintype" id="6401500">uint16</span><span class="op" id="6401506">]</span><span class="ident" id="6401507"><a href="/archive/zip/register.go.html#6400338">Compressor</a></span><span class="op" id="6401517">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6401521"><a href="/archive/zip/struct.go.html#6403390">Store</a></span><span class="op" id="6401526">:</span>&nbsp;&nbsp;&nbsp;<span class="keyword" id="6401530">func</span><span class="op" id="6401534">(</span><span class="ident" id="6401535">w</span>&nbsp;<span class="ident" id="6401537"><a href="/archive/zip/register.go.html#6400177">io</a></span><span class="op" id="6401539">.</span><span class="ident" id="6401540">Writer</span><span class="op" id="6401546">)</span>&nbsp;<span class="op" id="6401548">(</span><span class="ident" id="6401549"><a href="/archive/zip/register.go.html#6400177">io</a></span><span class="op" id="6401551">.</span><span class="ident" id="6401552">WriteCloser</span><span class="op" id="6401563">,</span>&nbsp;<span class="builtintype" id="6401565">error</span><span class="op" id="6401570">)</span>&nbsp;<span class="op" id="6401572">{</span>&nbsp;<span class="keyword" id="6401574">return</span>&nbsp;<span class="op" id="6401581">&amp;</span><span class="ident" id="6401582"><a href="/archive/zip/writer.go.html#6420339">nopCloser</a></span><span class="op" id="6401591">{</span><span class="ident" id="6401592"><a href="/archive/zip/register.go.html#6401535">w</a></span><span class="op" id="6401593">}</span><span class="op" id="6401594">,</span>&nbsp;<span class="ident" id="6401596">nil</span>&nbsp;<span class="op" id="6401600">}</span><span class="op" id="6401601">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6401605"><a href="/archive/zip/struct.go.html#6403410">Deflate</a></span><span class="op" id="6401612">:</span>&nbsp;<span class="keyword" id="6401614">func</span><span class="op" id="6401618">(</span><span class="ident" id="6401619">w</span>&nbsp;<span class="ident" id="6401621"><a href="/archive/zip/register.go.html#6400177">io</a></span><span class="op" id="6401623">.</span><span class="ident" id="6401624">Writer</span><span class="op" id="6401630">)</span>&nbsp;<span class="op" id="6401632">(</span><span class="ident" id="6401633"><a href="/archive/zip/register.go.html#6400177">io</a></span><span class="op" id="6401635">.</span><span class="ident" id="6401636">WriteCloser</span><span class="op" id="6401647">,</span>&nbsp;<span class="builtintype" id="6401649">error</span><span class="op" id="6401654">)</span>&nbsp;<span class="op" id="6401656">{</span>&nbsp;<span class="keyword" id="6401658">return</span>&nbsp;<span class="ident" id="6401665"><a href="/archive/zip/register.go.html#6400740">newFlateWriter</a></span><span class="op" id="6401679">(</span><span class="ident" id="6401680"><a href="/archive/zip/register.go.html#6401619">w</a></span><span class="op" id="6401681">)</span><span class="op" id="6401682">,</span>&nbsp;<span class="ident" id="6401684">nil</span>&nbsp;<span class="op" id="6401688">}</span><span class="op" id="6401689">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6401692">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6401696">decompressors</span>&nbsp;<span class="op" id="6401710">=</span>&nbsp;<span class="keyword" id="6401712">map</span><span class="op" id="6401715">[</span><span class="builtintype" id="6401716">uint16</span><span class="op" id="6401722">]</span><span class="ident" id="6401723"><a href="/archive/zip/register.go.html#6400660">Decompressor</a></span><span class="op" id="6401735">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6401739"><a href="/archive/zip/struct.go.html#6403390">Store</a></span><span class="op" id="6401744">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6401748"><a href="/archive/zip/register.go.html#6400183">ioutil</a></span><span class="op" id="6401754">.</span><span class="ident" id="6401755">NopCloser</span><span class="op" id="6401764">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6401768"><a href="/archive/zip/struct.go.html#6403410">Deflate</a></span><span class="op" id="6401775">:</span>&nbsp;<span class="ident" id="6401777"><a href="/archive/zip/register.go.html#6400149">flate</a></span><span class="op" id="6401782">.</span><span class="ident" id="6401783">NewReader</span><span class="op" id="6401792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6401795">}</span><br>
<span class="lineno">75</span><span class="op" id="6401797">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6401800">//&nbsp;RegisterDecompressor&nbsp;allows&nbsp;custom&nbsp;decompressors&nbsp;for&nbsp;a&nbsp;specified&nbsp;method&nbsp;ID.</span><br>
<span class="lineno"></span><span class="keyword" id="6401879">func</span>&nbsp;<span class="ident" id="6401884">RegisterDecompressor</span><span class="op" id="6401904">(</span><span class="ident" id="6401905">method</span>&nbsp;<span class="builtintype" id="6401912">uint16</span><span class="op" id="6401918">,</span>&nbsp;<span class="ident" id="6401920">d</span>&nbsp;<span class="ident" id="6401922"><a href="/archive/zip/register.go.html#6400660">Decompressor</a></span><span class="op" id="6401934">)</span>&nbsp;<span class="op" id="6401936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6401939"><a href="/archive/zip/register.go.html#6401421">mu</a></span><span class="op" id="6401941">.</span><span class="ident" id="6401942">Lock</span><span class="op" id="6401946">(</span><span class="op" id="6401947">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6401950">defer</span>&nbsp;<span class="ident" id="6401956"><a href="/archive/zip/register.go.html#6401421">mu</a></span><span class="op" id="6401958">.</span><span class="ident" id="6401959">Unlock</span><span class="op" id="6401965">(</span><span class="op" id="6401966">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6401970">if</span>&nbsp;<span class="ident" id="6401973">_</span><span class="op" id="6401974">,</span>&nbsp;<span class="ident" id="6401976">ok</span>&nbsp;<span class="op" id="6401979">:=</span>&nbsp;<span class="ident" id="6401982"><a href="/archive/zip/register.go.html#6401696">decompressors</a></span><span class="op" id="6401995">[</span><span class="ident" id="6401996"><a href="/archive/zip/register.go.html#6401905">method</a></span><span class="op" id="6402002">]</span><span class="op" id="6402003">;</span>&nbsp;<span class="ident" id="6402005"><a href="/archive/zip/register.go.html#6401976">ok</a></span>&nbsp;<span class="op" id="6402008">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6402012">panic</span><span class="op" id="6402017">(</span><span class="string" id="6402018">&#34;decompressor&nbsp;already&nbsp;registered&#34;</span><span class="op" id="6402051">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6402054">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6402057"><a href="/archive/zip/register.go.html#6401696">decompressors</a></span><span class="op" id="6402070">[</span><span class="ident" id="6402071"><a href="/archive/zip/register.go.html#6401905">method</a></span><span class="op" id="6402077">]</span>&nbsp;<span class="op" id="6402079">=</span>&nbsp;<span class="ident" id="6402081"><a href="/archive/zip/register.go.html#6401920">d</a></span><br>
<span class="lineno"></span><span class="op" id="6402083">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6402086">//&nbsp;RegisterCompressor&nbsp;registers&nbsp;custom&nbsp;compressors&nbsp;for&nbsp;a&nbsp;specified&nbsp;method&nbsp;ID.</span><br>
<span class="lineno"></span><span class="comment" id="6402164">//&nbsp;The&nbsp;common&nbsp;methods&nbsp;Store&nbsp;and&nbsp;Deflate&nbsp;are&nbsp;built&nbsp;in.</span><br>
<span class="lineno">90</span><span class="keyword" id="6402218">func</span>&nbsp;<span class="ident" id="6402223">RegisterCompressor</span><span class="op" id="6402241">(</span><span class="ident" id="6402242">method</span>&nbsp;<span class="builtintype" id="6402249">uint16</span><span class="op" id="6402255">,</span>&nbsp;<span class="ident" id="6402257">comp</span>&nbsp;<span class="ident" id="6402262"><a href="/archive/zip/register.go.html#6400338">Compressor</a></span><span class="op" id="6402272">)</span>&nbsp;<span class="op" id="6402274">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6402277"><a href="/archive/zip/register.go.html#6401421">mu</a></span><span class="op" id="6402279">.</span><span class="ident" id="6402280">Lock</span><span class="op" id="6402284">(</span><span class="op" id="6402285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6402288">defer</span>&nbsp;<span class="ident" id="6402294"><a href="/archive/zip/register.go.html#6401421">mu</a></span><span class="op" id="6402296">.</span><span class="ident" id="6402297">Unlock</span><span class="op" id="6402303">(</span><span class="op" id="6402304">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6402308">if</span>&nbsp;<span class="ident" id="6402311">_</span><span class="op" id="6402312">,</span>&nbsp;<span class="ident" id="6402314">ok</span>&nbsp;<span class="op" id="6402317">:=</span>&nbsp;<span class="ident" id="6402320"><a href="/archive/zip/register.go.html#6401482">compressors</a></span><span class="op" id="6402331">[</span><span class="ident" id="6402332"><a href="/archive/zip/register.go.html#6402242">method</a></span><span class="op" id="6402338">]</span><span class="op" id="6402339">;</span>&nbsp;<span class="ident" id="6402341"><a href="/archive/zip/register.go.html#6402314">ok</a></span>&nbsp;<span class="op" id="6402344">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6402348">panic</span><span class="op" id="6402353">(</span><span class="string" id="6402354">&#34;compressor&nbsp;already&nbsp;registered&#34;</span><span class="op" id="6402385">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6402388">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6402391"><a href="/archive/zip/register.go.html#6401482">compressors</a></span><span class="op" id="6402402">[</span><span class="ident" id="6402403"><a href="/archive/zip/register.go.html#6402242">method</a></span><span class="op" id="6402409">]</span>&nbsp;<span class="op" id="6402411">=</span>&nbsp;<span class="ident" id="6402413"><a href="/archive/zip/register.go.html#6402257">comp</a></span><br>
<span class="lineno"></span><span class="op" id="6402418">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span><span class="keyword" id="6402421">func</span>&nbsp;<span class="ident" id="6402426">compressor</span><span class="op" id="6402436">(</span><span class="ident" id="6402437">method</span>&nbsp;<span class="builtintype" id="6402444">uint16</span><span class="op" id="6402450">)</span>&nbsp;<span class="ident" id="6402452"><a href="/archive/zip/register.go.html#6400338">Compressor</a></span>&nbsp;<span class="op" id="6402463">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6402466"><a href="/archive/zip/register.go.html#6401421">mu</a></span><span class="op" id="6402468">.</span><span class="ident" id="6402469">RLock</span><span class="op" id="6402474">(</span><span class="op" id="6402475">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6402478">defer</span>&nbsp;<span class="ident" id="6402484"><a href="/archive/zip/register.go.html#6401421">mu</a></span><span class="op" id="6402486">.</span><span class="ident" id="6402487">RUnlock</span><span class="op" id="6402494">(</span><span class="op" id="6402495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6402498">return</span>&nbsp;<span class="ident" id="6402505"><a href="/archive/zip/register.go.html#6401482">compressors</a></span><span class="op" id="6402516">[</span><span class="ident" id="6402517"><a href="/archive/zip/register.go.html#6402437">method</a></span><span class="op" id="6402523">]</span><br>
<span class="lineno"></span><span class="op" id="6402525">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="keyword" id="6402528">func</span>&nbsp;<span class="ident" id="6402533">decompressor</span><span class="op" id="6402545">(</span><span class="ident" id="6402546">method</span>&nbsp;<span class="builtintype" id="6402553">uint16</span><span class="op" id="6402559">)</span>&nbsp;<span class="ident" id="6402561"><a href="/archive/zip/register.go.html#6400660">Decompressor</a></span>&nbsp;<span class="op" id="6402574">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6402577"><a href="/archive/zip/register.go.html#6401421">mu</a></span><span class="op" id="6402579">.</span><span class="ident" id="6402580">RLock</span><span class="op" id="6402585">(</span><span class="op" id="6402586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6402589">defer</span>&nbsp;<span class="ident" id="6402595"><a href="/archive/zip/register.go.html#6401421">mu</a></span><span class="op" id="6402597">.</span><span class="ident" id="6402598">RUnlock</span><span class="op" id="6402605">(</span><span class="op" id="6402606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6402609">return</span>&nbsp;<span class="ident" id="6402616"><a href="/archive/zip/register.go.html#6401696">decompressors</a></span><span class="op" id="6402629">[</span><span class="ident" id="6402630"><a href="/archive/zip/register.go.html#6402546">method</a></span><span class="op" id="6402636">]</span><br>
<span class="lineno">110</span><span class="op" id="6402638">}</span>
</div>
</body>
</html>
