<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2089601">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2089656">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2089710">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2089761">package</span>&nbsp;<span class="ident" id="2089769">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2089775">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2089835">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cprob/gamma.c.</span><br>
<span class="lineno"></span><span class="comment" id="2089900">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">10</span><span class="comment" id="2089958">//</span><br>
<span class="lineno"></span><span class="comment" id="2089961">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tgamma.c</span><br>
<span class="lineno"></span><span class="comment" id="2089978">//</span><br>
<span class="lineno"></span><span class="comment" id="2089981">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2090004">//</span><br>
<span class="lineno">15</span><span class="comment" id="2090007">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2090020">//</span><br>
<span class="lineno"></span><span class="comment" id="2090023">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;tgamma();</span><br>
<span class="lineno"></span><span class="comment" id="2090049">//&nbsp;extern&nbsp;int&nbsp;signgam;</span><br>
<span class="lineno"></span><span class="comment" id="2090072">//</span><br>
<span class="lineno">20</span><span class="comment" id="2090075">//&nbsp;y&nbsp;=&nbsp;tgamma(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2090095">//</span><br>
<span class="lineno"></span><span class="comment" id="2090098">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2090114">//</span><br>
<span class="lineno"></span><span class="comment" id="2090117">//&nbsp;Returns&nbsp;gamma&nbsp;function&nbsp;of&nbsp;the&nbsp;argument.&nbsp;&nbsp;The&nbsp;result&nbsp;is</span><br>
<span class="lineno">25</span><span class="comment" id="2090175">//&nbsp;correctly&nbsp;signed,&nbsp;and&nbsp;the&nbsp;sign&nbsp;(+1&nbsp;or&nbsp;-1)&nbsp;is&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="2090228">//&nbsp;returned&nbsp;in&nbsp;a&nbsp;global&nbsp;(extern)&nbsp;variable&nbsp;named&nbsp;signgam.</span><br>
<span class="lineno"></span><span class="comment" id="2090285">//&nbsp;This&nbsp;variable&nbsp;is&nbsp;also&nbsp;filled&nbsp;in&nbsp;by&nbsp;the&nbsp;logarithmic&nbsp;gamma</span><br>
<span class="lineno"></span><span class="comment" id="2090345">//&nbsp;function&nbsp;lgamma().</span><br>
<span class="lineno"></span><span class="comment" id="2090367">//</span><br>
<span class="lineno">30</span><span class="comment" id="2090370">//&nbsp;Arguments&nbsp;|x|&nbsp;&lt;=&nbsp;34&nbsp;are&nbsp;reduced&nbsp;by&nbsp;recurrence&nbsp;and&nbsp;the&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2090436">//&nbsp;approximated&nbsp;by&nbsp;a&nbsp;rational&nbsp;function&nbsp;of&nbsp;degree&nbsp;6/7&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2090496">//&nbsp;interval&nbsp;(2,3).&nbsp;&nbsp;Large&nbsp;arguments&nbsp;are&nbsp;handled&nbsp;by&nbsp;Stirling&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="2090558">//&nbsp;formula.&nbsp;Large&nbsp;negative&nbsp;arguments&nbsp;are&nbsp;made&nbsp;positive&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="2090619">//&nbsp;a&nbsp;reflection&nbsp;formula.</span><br>
<span class="lineno">35</span><span class="comment" id="2090644">//</span><br>
<span class="lineno"></span><span class="comment" id="2090647">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2090660">//</span><br>
<span class="lineno"></span><span class="comment" id="2090663">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2090703">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2090761">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-34,&nbsp;34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.3e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.5e-17</span><br>
<span class="lineno"></span><span class="comment" id="2090821">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;-170,-33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.3e-16</span><br>
<span class="lineno"></span><span class="comment" id="2090881">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-33,&nbsp;&nbsp;33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.4e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2090941">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33,&nbsp;171.6&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2091001">//</span><br>
<span class="lineno">45</span><span class="comment" id="2091004">//&nbsp;Error&nbsp;for&nbsp;arguments&nbsp;outside&nbsp;the&nbsp;test&nbsp;range&nbsp;will&nbsp;be&nbsp;larger</span><br>
<span class="lineno"></span><span class="comment" id="2091065">//&nbsp;owing&nbsp;to&nbsp;error&nbsp;amplification&nbsp;by&nbsp;the&nbsp;exponential&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="2091126">//</span><br>
<span class="lineno"></span><span class="comment" id="2091129">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="2091177">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">50</span><span class="comment" id="2091241">//</span><br>
<span class="lineno"></span><span class="comment" id="2091244">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2091305">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2091375">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="2091450">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">55</span><span class="comment" id="2091517">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2091590">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2091662">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2091676">//</span><br>
<span class="lineno"></span><span class="comment" id="2091679">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">60</span><span class="comment" id="2091745">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2091811">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2091824">//</span><br>
<span class="lineno"></span><span class="comment" id="2091827">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2091851">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2091881">var</span>&nbsp;<span class="ident" id="2091885">_gamP</span>&nbsp;<span class="op" id="2091891">=</span>&nbsp;<span class="op" id="2091893">[</span><span class="op" id="2091894">...</span><span class="op" id="2091897">]</span><span class="builtintype" id="2091898">float64</span><span class="op" id="2091905">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2091908">1.60119522476751861407e-04</span><span class="op" id="2091934">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2091937">1.19135147006586384913e-03</span><span class="op" id="2091963">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2091966">1.04213797561761569935e-02</span><span class="op" id="2091992">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2091995">4.76367800457137231464e-02</span><span class="op" id="2092021">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2092024">2.07448227648435975150e-01</span><span class="op" id="2092050">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2092053">4.94214826801497100753e-01</span><span class="op" id="2092079">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2092082">9.99999999999999996796e-01</span><span class="op" id="2092108">,</span><br>
<span class="lineno"></span><span class="op" id="2092110">}</span><br>
<span class="lineno">75</span><span class="keyword" id="2092112">var</span>&nbsp;<span class="ident" id="2092116">_gamQ</span>&nbsp;<span class="op" id="2092122">=</span>&nbsp;<span class="op" id="2092124">[</span><span class="op" id="2092125">...</span><span class="op" id="2092128">]</span><span class="builtintype" id="2092129">float64</span><span class="op" id="2092136">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2092139">-</span><span class="num" id="2092140">2.31581873324120129819e-05</span><span class="op" id="2092166">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2092169">5.39605580493303397842e-04</span><span class="op" id="2092195">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2092198">-</span><span class="num" id="2092199">4.45641913851797240494e-03</span><span class="op" id="2092225">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2092228">1.18139785222060435552e-02</span><span class="op" id="2092254">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2092257">3.58236398605498653373e-02</span><span class="op" id="2092283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2092286">-</span><span class="num" id="2092287">2.34591795718243348568e-01</span><span class="op" id="2092313">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2092316">7.14304917030273074085e-02</span><span class="op" id="2092342">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2092345">1.00000000000000000320e+00</span><span class="op" id="2092371">,</span><br>
<span class="lineno"></span><span class="op" id="2092373">}</span><br>
<span class="lineno">85</span><span class="keyword" id="2092375">var</span>&nbsp;<span class="ident" id="2092379">_gamS</span>&nbsp;<span class="op" id="2092385">=</span>&nbsp;<span class="op" id="2092387">[</span><span class="op" id="2092388">...</span><span class="op" id="2092391">]</span><span class="builtintype" id="2092392">float64</span><span class="op" id="2092399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2092402">7.87311395793093628397e-04</span><span class="op" id="2092428">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2092431">-</span><span class="num" id="2092432">2.29549961613378126380e-04</span><span class="op" id="2092458">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2092461">-</span><span class="num" id="2092462">2.68132617805781232825e-03</span><span class="op" id="2092488">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2092491">3.47222221605458667310e-03</span><span class="op" id="2092517">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="2092520">8.33333333333482257126e-02</span><span class="op" id="2092546">,</span><br>
<span class="lineno"></span><span class="op" id="2092548">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2092551">//&nbsp;Gamma&nbsp;function&nbsp;computed&nbsp;by&nbsp;Stirling&#39;s&nbsp;formula.</span><br>
<span class="lineno"></span><span class="comment" id="2092601">//&nbsp;The&nbsp;polynomial&nbsp;is&nbsp;valid&nbsp;for&nbsp;33&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;172.</span><br>
<span class="lineno">95</span><span class="keyword" id="2092648">func</span>&nbsp;<span class="ident" id="2092653">stirling</span><span class="op" id="2092661">(</span><span class="ident" id="2092662">x</span>&nbsp;<span class="builtintype" id="2092664">float64</span><span class="op" id="2092671">)</span>&nbsp;<span class="builtintype" id="2092673">float64</span>&nbsp;<span class="op" id="2092681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2092684">const</span>&nbsp;<span class="op" id="2092690">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2092694">SqrtTwoPi</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2092706">=</span>&nbsp;<span class="num" id="2092708">2.506628274631000502417</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2092734">MaxStirling</span>&nbsp;<span class="op" id="2092746">=</span>&nbsp;<span class="num" id="2092748">143.01608</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2092759">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2092762">w</span>&nbsp;<span class="op" id="2092764">:=</span>&nbsp;<span class="num" id="2092767">1</span>&nbsp;<span class="op" id="2092769">/</span>&nbsp;<span class="ident" id="2092771">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2092774">w</span>&nbsp;<span class="op" id="2092776">=</span>&nbsp;<span class="num" id="2092778">1</span>&nbsp;<span class="op" id="2092780">+</span>&nbsp;<span class="ident" id="2092782">w</span><span class="op" id="2092783">*</span><span class="op" id="2092784">(</span><span class="op" id="2092785">(</span><span class="op" id="2092786">(</span><span class="op" id="2092787">(</span><span class="ident" id="2092788">_gamS</span><span class="op" id="2092793">[</span><span class="num" id="2092794">0</span><span class="op" id="2092795">]</span><span class="op" id="2092796">*</span><span class="ident" id="2092797">w</span><span class="op" id="2092798">+</span><span class="ident" id="2092799">_gamS</span><span class="op" id="2092804">[</span><span class="num" id="2092805">1</span><span class="op" id="2092806">]</span><span class="op" id="2092807">)</span><span class="op" id="2092808">*</span><span class="ident" id="2092809">w</span><span class="op" id="2092810">+</span><span class="ident" id="2092811">_gamS</span><span class="op" id="2092816">[</span><span class="num" id="2092817">2</span><span class="op" id="2092818">]</span><span class="op" id="2092819">)</span><span class="op" id="2092820">*</span><span class="ident" id="2092821">w</span><span class="op" id="2092822">+</span><span class="ident" id="2092823">_gamS</span><span class="op" id="2092828">[</span><span class="num" id="2092829">3</span><span class="op" id="2092830">]</span><span class="op" id="2092831">)</span><span class="op" id="2092832">*</span><span class="ident" id="2092833">w</span><span class="op" id="2092834">+</span><span class="ident" id="2092835">_gamS</span><span class="op" id="2092840">[</span><span class="num" id="2092841">4</span><span class="op" id="2092842">]</span><span class="op" id="2092843">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2092846">y</span>&nbsp;<span class="op" id="2092848">:=</span>&nbsp;<span class="ident" id="2092851">Exp</span><span class="op" id="2092854">(</span><span class="ident" id="2092855">x</span><span class="op" id="2092856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2092859">if</span>&nbsp;<span class="ident" id="2092862">x</span>&nbsp;<span class="op" id="2092864">&gt;</span>&nbsp;<span class="ident" id="2092866">MaxStirling</span>&nbsp;<span class="op" id="2092878">{</span>&nbsp;<span class="comment" id="2092880">//&nbsp;avoid&nbsp;Pow()&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2092906">v</span>&nbsp;<span class="op" id="2092908">:=</span>&nbsp;<span class="ident" id="2092911">Pow</span><span class="op" id="2092914">(</span><span class="ident" id="2092915">x</span><span class="op" id="2092916">,</span>&nbsp;<span class="num" id="2092918">0.5</span><span class="op" id="2092921">*</span><span class="ident" id="2092922">x</span><span class="op" id="2092923">-</span><span class="num" id="2092924">0.25</span><span class="op" id="2092928">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2092932">y</span>&nbsp;<span class="op" id="2092934">=</span>&nbsp;<span class="ident" id="2092936">v</span>&nbsp;<span class="op" id="2092938">*</span>&nbsp;<span class="op" id="2092940">(</span><span class="ident" id="2092941">v</span>&nbsp;<span class="op" id="2092943">/</span>&nbsp;<span class="ident" id="2092945">y</span><span class="op" id="2092946">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2092949">}</span>&nbsp;<span class="keyword" id="2092951">else</span>&nbsp;<span class="op" id="2092956">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2092960">y</span>&nbsp;<span class="op" id="2092962">=</span>&nbsp;<span class="ident" id="2092964">Pow</span><span class="op" id="2092967">(</span><span class="ident" id="2092968">x</span><span class="op" id="2092969">,</span>&nbsp;<span class="ident" id="2092971">x</span><span class="op" id="2092972">-</span><span class="num" id="2092973">0.5</span><span class="op" id="2092976">)</span>&nbsp;<span class="op" id="2092978">/</span>&nbsp;<span class="ident" id="2092980">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2092983">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2092986">y</span>&nbsp;<span class="op" id="2092988">=</span>&nbsp;<span class="ident" id="2092990">SqrtTwoPi</span>&nbsp;<span class="op" id="2093000">*</span>&nbsp;<span class="ident" id="2093002">y</span>&nbsp;<span class="op" id="2093004">*</span>&nbsp;<span class="ident" id="2093006">w</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093009">return</span>&nbsp;<span class="ident" id="2093016">y</span><br>
<span class="lineno"></span><span class="op" id="2093018">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2093021">//&nbsp;Gamma&nbsp;returns&nbsp;the&nbsp;Gamma&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2093063">//</span><br>
<span class="lineno">115</span><span class="comment" id="2093066">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2093088">//&nbsp;&nbsp;&nbsp;&nbspGamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2093110">//&nbsp;&nbsp;&nbsp;&nbspGamma(+0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2093130">//&nbsp;&nbsp;&nbsp;&nbspGamma(-0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2093150">//&nbsp;&nbsp;&nbsp;&nbspGamma(x)&nbsp;=&nbsp;NaN&nbsp;for&nbsp;integer&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno">120</span><span class="comment" id="2093186">//&nbsp;&nbsp;&nbsp;&nbspGamma(-Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2093207">//&nbsp;&nbsp;&nbsp;&nbspGamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2093227">func</span>&nbsp;<span class="ident" id="2093232">Gamma</span><span class="op" id="2093237">(</span><span class="ident" id="2093238">x</span>&nbsp;<span class="builtintype" id="2093240">float64</span><span class="op" id="2093247">)</span>&nbsp;<span class="builtintype" id="2093249">float64</span>&nbsp;<span class="op" id="2093257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093260">const</span>&nbsp;<span class="ident" id="2093266">Euler</span>&nbsp;<span class="op" id="2093272">=</span>&nbsp;<span class="num" id="2093274">0.57721566490153286060651209008240243104215933593992</span>&nbsp;<span class="comment" id="2093327">//&nbsp;A001620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2093339">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093357">switch</span>&nbsp;<span class="op" id="2093364">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093367">case</span>&nbsp;<span class="ident" id="2093372">isNegInt</span><span class="op" id="2093380">(</span><span class="ident" id="2093381">x</span><span class="op" id="2093382">)</span>&nbsp;<span class="op" id="2093384">||</span>&nbsp;<span class="ident" id="2093387">IsInf</span><span class="op" id="2093392">(</span><span class="ident" id="2093393">x</span><span class="op" id="2093394">,</span>&nbsp;<span class="op" id="2093396">-</span><span class="num" id="2093397">1</span><span class="op" id="2093398">)</span>&nbsp;<span class="op" id="2093400">||</span>&nbsp;<span class="ident" id="2093403">IsNaN</span><span class="op" id="2093408">(</span><span class="ident" id="2093409">x</span><span class="op" id="2093410">)</span><span class="op" id="2093411">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093415">return</span>&nbsp;<span class="ident" id="2093422">NaN</span><span class="op" id="2093425">(</span><span class="op" id="2093426">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093429">case</span>&nbsp;<span class="ident" id="2093434">x</span>&nbsp;<span class="op" id="2093436">==</span>&nbsp;<span class="num" id="2093439">0</span><span class="op" id="2093440">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093444">if</span>&nbsp;<span class="ident" id="2093447">Signbit</span><span class="op" id="2093454">(</span><span class="ident" id="2093455">x</span><span class="op" id="2093456">)</span>&nbsp;<span class="op" id="2093458">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093463">return</span>&nbsp;<span class="ident" id="2093470">Inf</span><span class="op" id="2093473">(</span><span class="op" id="2093474">-</span><span class="num" id="2093475">1</span><span class="op" id="2093476">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2093480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093484">return</span>&nbsp;<span class="ident" id="2093491">Inf</span><span class="op" id="2093494">(</span><span class="num" id="2093495">1</span><span class="op" id="2093496">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093499">case</span>&nbsp;<span class="ident" id="2093504">x</span>&nbsp;<span class="op" id="2093506">&lt;</span>&nbsp;<span class="op" id="2093508">-</span><span class="num" id="2093509">170.5674972726612</span>&nbsp;<span class="op" id="2093527">||</span>&nbsp;<span class="ident" id="2093530">x</span>&nbsp;<span class="op" id="2093532">&gt;</span>&nbsp;<span class="num" id="2093534">171.61447887182298</span><span class="op" id="2093552">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093556">return</span>&nbsp;<span class="ident" id="2093563">Inf</span><span class="op" id="2093566">(</span><span class="num" id="2093567">1</span><span class="op" id="2093568">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2093571">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2093574">q</span>&nbsp;<span class="op" id="2093576">:=</span>&nbsp;<span class="ident" id="2093579">Abs</span><span class="op" id="2093582">(</span><span class="ident" id="2093583">x</span><span class="op" id="2093584">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2093587">p</span>&nbsp;<span class="op" id="2093589">:=</span>&nbsp;<span class="ident" id="2093592">Floor</span><span class="op" id="2093597">(</span><span class="ident" id="2093598">q</span><span class="op" id="2093599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093602">if</span>&nbsp;<span class="ident" id="2093605">q</span>&nbsp;<span class="op" id="2093607">&gt;</span>&nbsp;<span class="num" id="2093609">33</span>&nbsp;<span class="op" id="2093612">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093616">if</span>&nbsp;<span class="ident" id="2093619">x</span>&nbsp;<span class="op" id="2093621">&gt;=</span>&nbsp;<span class="num" id="2093624">0</span>&nbsp;<span class="op" id="2093626">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093631">return</span>&nbsp;<span class="ident" id="2093638">stirling</span><span class="op" id="2093646">(</span><span class="ident" id="2093647">x</span><span class="op" id="2093648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2093652">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2093656">signgam</span>&nbsp;<span class="op" id="2093664">:=</span>&nbsp;<span class="num" id="2093667">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093671">if</span>&nbsp;<span class="ident" id="2093674">ip</span>&nbsp;<span class="op" id="2093677">:=</span>&nbsp;<span class="builtintype" id="2093680">int</span><span class="op" id="2093683">(</span><span class="ident" id="2093684">p</span><span class="op" id="2093685">)</span><span class="op" id="2093686">;</span>&nbsp;<span class="ident" id="2093688">ip</span><span class="op" id="2093690">&amp;</span><span class="num" id="2093691">1</span>&nbsp;<span class="op" id="2093693">==</span>&nbsp;<span class="num" id="2093696">0</span>&nbsp;<span class="op" id="2093698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2093703">signgam</span>&nbsp;<span class="op" id="2093711">=</span>&nbsp;<span class="op" id="2093713">-</span><span class="num" id="2093714">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2093718">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2093722">z</span>&nbsp;<span class="op" id="2093724">:=</span>&nbsp;<span class="ident" id="2093727">q</span>&nbsp;<span class="op" id="2093729">-</span>&nbsp;<span class="ident" id="2093731">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093735">if</span>&nbsp;<span class="ident" id="2093738">z</span>&nbsp;<span class="op" id="2093740">&gt;</span>&nbsp;<span class="num" id="2093742">0.5</span>&nbsp;<span class="op" id="2093746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2093751">p</span>&nbsp;<span class="op" id="2093753">=</span>&nbsp;<span class="ident" id="2093755">p</span>&nbsp;<span class="op" id="2093757">+</span>&nbsp;<span class="num" id="2093759">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2093764">z</span>&nbsp;<span class="op" id="2093766">=</span>&nbsp;<span class="ident" id="2093768">q</span>&nbsp;<span class="op" id="2093770">-</span>&nbsp;<span class="ident" id="2093772">p</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2093776">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2093780">z</span>&nbsp;<span class="op" id="2093782">=</span>&nbsp;<span class="ident" id="2093784">q</span>&nbsp;<span class="op" id="2093786">*</span>&nbsp;<span class="ident" id="2093788">Sin</span><span class="op" id="2093791">(</span><span class="ident" id="2093792">Pi</span><span class="op" id="2093794">*</span><span class="ident" id="2093795">z</span><span class="op" id="2093796">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093800">if</span>&nbsp;<span class="ident" id="2093803">z</span>&nbsp;<span class="op" id="2093805">==</span>&nbsp;<span class="num" id="2093808">0</span>&nbsp;<span class="op" id="2093810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093815">return</span>&nbsp;<span class="ident" id="2093822">Inf</span><span class="op" id="2093825">(</span><span class="ident" id="2093826">signgam</span><span class="op" id="2093833">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2093837">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2093841">z</span>&nbsp;<span class="op" id="2093843">=</span>&nbsp;<span class="ident" id="2093845">Pi</span>&nbsp;<span class="op" id="2093848">/</span>&nbsp;<span class="op" id="2093850">(</span><span class="ident" id="2093851">Abs</span><span class="op" id="2093854">(</span><span class="ident" id="2093855">z</span><span class="op" id="2093856">)</span>&nbsp;<span class="op" id="2093858">*</span>&nbsp;<span class="ident" id="2093860">stirling</span><span class="op" id="2093868">(</span><span class="ident" id="2093869">q</span><span class="op" id="2093870">)</span><span class="op" id="2093871">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093875">return</span>&nbsp;<span class="builtintype" id="2093882">float64</span><span class="op" id="2093889">(</span><span class="ident" id="2093890">signgam</span><span class="op" id="2093897">)</span>&nbsp;<span class="op" id="2093899">*</span>&nbsp;<span class="ident" id="2093901">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2093904">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="2093908">//&nbsp;Reduce&nbsp;argument</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2093928">z</span>&nbsp;<span class="op" id="2093930">:=</span>&nbsp;<span class="num" id="2093933">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093938">for</span>&nbsp;<span class="ident" id="2093942">x</span>&nbsp;<span class="op" id="2093944">&gt;=</span>&nbsp;<span class="num" id="2093947">3</span>&nbsp;<span class="op" id="2093949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2093953">x</span>&nbsp;<span class="op" id="2093955">=</span>&nbsp;<span class="ident" id="2093957">x</span>&nbsp;<span class="op" id="2093959">-</span>&nbsp;<span class="num" id="2093961">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2093965">z</span>&nbsp;<span class="op" id="2093967">=</span>&nbsp;<span class="ident" id="2093969">z</span>&nbsp;<span class="op" id="2093971">*</span>&nbsp;<span class="ident" id="2093973">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2093976">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093979">for</span>&nbsp;<span class="ident" id="2093983">x</span>&nbsp;<span class="op" id="2093985">&lt;</span>&nbsp;<span class="num" id="2093987">0</span>&nbsp;<span class="op" id="2093989">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2093993">if</span>&nbsp;<span class="ident" id="2093996">x</span>&nbsp;<span class="op" id="2093998">&gt;</span>&nbsp;<span class="op" id="2094000">-</span><span class="num" id="2094001">1e-09</span>&nbsp;<span class="op" id="2094007">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2094012">goto</span>&nbsp;<span class="ident" id="2094017">small</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2094025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2094029">z</span>&nbsp;<span class="op" id="2094031">=</span>&nbsp;<span class="ident" id="2094033">z</span>&nbsp;<span class="op" id="2094035">/</span>&nbsp;<span class="ident" id="2094037">x</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2094041">x</span>&nbsp;<span class="op" id="2094043">=</span>&nbsp;<span class="ident" id="2094045">x</span>&nbsp;<span class="op" id="2094047">+</span>&nbsp;<span class="num" id="2094049">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2094052">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2094055">for</span>&nbsp;<span class="ident" id="2094059">x</span>&nbsp;<span class="op" id="2094061">&lt;</span>&nbsp;<span class="num" id="2094063">2</span>&nbsp;<span class="op" id="2094065">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2094069">if</span>&nbsp;<span class="ident" id="2094072">x</span>&nbsp;<span class="op" id="2094074">&lt;</span>&nbsp;<span class="num" id="2094076">1e-09</span>&nbsp;<span class="op" id="2094082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2094087">goto</span>&nbsp;<span class="ident" id="2094092">small</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2094100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2094104">z</span>&nbsp;<span class="op" id="2094106">=</span>&nbsp;<span class="ident" id="2094108">z</span>&nbsp;<span class="op" id="2094110">/</span>&nbsp;<span class="ident" id="2094112">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2094116">x</span>&nbsp;<span class="op" id="2094118">=</span>&nbsp;<span class="ident" id="2094120">x</span>&nbsp;<span class="op" id="2094122">+</span>&nbsp;<span class="num" id="2094124">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2094127">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2094131">if</span>&nbsp;<span class="ident" id="2094134">x</span>&nbsp;<span class="op" id="2094136">==</span>&nbsp;<span class="num" id="2094139">2</span>&nbsp;<span class="op" id="2094141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2094145">return</span>&nbsp;<span class="ident" id="2094152">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2094155">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2094159">x</span>&nbsp;<span class="op" id="2094161">=</span>&nbsp;<span class="ident" id="2094163">x</span>&nbsp;<span class="op" id="2094165">-</span>&nbsp;<span class="num" id="2094167">2</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2094170">p</span>&nbsp;<span class="op" id="2094172">=</span>&nbsp;<span class="op" id="2094174">(</span><span class="op" id="2094175">(</span><span class="op" id="2094176">(</span><span class="op" id="2094177">(</span><span class="op" id="2094178">(</span><span class="ident" id="2094179">x</span><span class="op" id="2094180">*</span><span class="ident" id="2094181">_gamP</span><span class="op" id="2094186">[</span><span class="num" id="2094187">0</span><span class="op" id="2094188">]</span><span class="op" id="2094189">+</span><span class="ident" id="2094190">_gamP</span><span class="op" id="2094195">[</span><span class="num" id="2094196">1</span><span class="op" id="2094197">]</span><span class="op" id="2094198">)</span><span class="op" id="2094199">*</span><span class="ident" id="2094200">x</span><span class="op" id="2094201">+</span><span class="ident" id="2094202">_gamP</span><span class="op" id="2094207">[</span><span class="num" id="2094208">2</span><span class="op" id="2094209">]</span><span class="op" id="2094210">)</span><span class="op" id="2094211">*</span><span class="ident" id="2094212">x</span><span class="op" id="2094213">+</span><span class="ident" id="2094214">_gamP</span><span class="op" id="2094219">[</span><span class="num" id="2094220">3</span><span class="op" id="2094221">]</span><span class="op" id="2094222">)</span><span class="op" id="2094223">*</span><span class="ident" id="2094224">x</span><span class="op" id="2094225">+</span><span class="ident" id="2094226">_gamP</span><span class="op" id="2094231">[</span><span class="num" id="2094232">4</span><span class="op" id="2094233">]</span><span class="op" id="2094234">)</span><span class="op" id="2094235">*</span><span class="ident" id="2094236">x</span><span class="op" id="2094237">+</span><span class="ident" id="2094238">_gamP</span><span class="op" id="2094243">[</span><span class="num" id="2094244">5</span><span class="op" id="2094245">]</span><span class="op" id="2094246">)</span><span class="op" id="2094247">*</span><span class="ident" id="2094248">x</span>&nbsp;<span class="op" id="2094250">+</span>&nbsp;<span class="ident" id="2094252">_gamP</span><span class="op" id="2094257">[</span><span class="num" id="2094258">6</span><span class="op" id="2094259">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2094262">q</span>&nbsp;<span class="op" id="2094264">=</span>&nbsp;<span class="op" id="2094266">(</span><span class="op" id="2094267">(</span><span class="op" id="2094268">(</span><span class="op" id="2094269">(</span><span class="op" id="2094270">(</span><span class="op" id="2094271">(</span><span class="ident" id="2094272">x</span><span class="op" id="2094273">*</span><span class="ident" id="2094274">_gamQ</span><span class="op" id="2094279">[</span><span class="num" id="2094280">0</span><span class="op" id="2094281">]</span><span class="op" id="2094282">+</span><span class="ident" id="2094283">_gamQ</span><span class="op" id="2094288">[</span><span class="num" id="2094289">1</span><span class="op" id="2094290">]</span><span class="op" id="2094291">)</span><span class="op" id="2094292">*</span><span class="ident" id="2094293">x</span><span class="op" id="2094294">+</span><span class="ident" id="2094295">_gamQ</span><span class="op" id="2094300">[</span><span class="num" id="2094301">2</span><span class="op" id="2094302">]</span><span class="op" id="2094303">)</span><span class="op" id="2094304">*</span><span class="ident" id="2094305">x</span><span class="op" id="2094306">+</span><span class="ident" id="2094307">_gamQ</span><span class="op" id="2094312">[</span><span class="num" id="2094313">3</span><span class="op" id="2094314">]</span><span class="op" id="2094315">)</span><span class="op" id="2094316">*</span><span class="ident" id="2094317">x</span><span class="op" id="2094318">+</span><span class="ident" id="2094319">_gamQ</span><span class="op" id="2094324">[</span><span class="num" id="2094325">4</span><span class="op" id="2094326">]</span><span class="op" id="2094327">)</span><span class="op" id="2094328">*</span><span class="ident" id="2094329">x</span><span class="op" id="2094330">+</span><span class="ident" id="2094331">_gamQ</span><span class="op" id="2094336">[</span><span class="num" id="2094337">5</span><span class="op" id="2094338">]</span><span class="op" id="2094339">)</span><span class="op" id="2094340">*</span><span class="ident" id="2094341">x</span><span class="op" id="2094342">+</span><span class="ident" id="2094343">_gamQ</span><span class="op" id="2094348">[</span><span class="num" id="2094349">6</span><span class="op" id="2094350">]</span><span class="op" id="2094351">)</span><span class="op" id="2094352">*</span><span class="ident" id="2094353">x</span>&nbsp;<span class="op" id="2094355">+</span>&nbsp;<span class="ident" id="2094357">_gamQ</span><span class="op" id="2094362">[</span><span class="num" id="2094363">7</span><span class="op" id="2094364">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2094367">return</span>&nbsp;<span class="ident" id="2094374">z</span>&nbsp;<span class="op" id="2094376">*</span>&nbsp;<span class="ident" id="2094378">p</span>&nbsp;<span class="op" id="2094380">/</span>&nbsp;<span class="ident" id="2094382">q</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="2094385">small</span><span class="op" id="2094390">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2094393">if</span>&nbsp;<span class="ident" id="2094396">x</span>&nbsp;<span class="op" id="2094398">==</span>&nbsp;<span class="num" id="2094401">0</span>&nbsp;<span class="op" id="2094403">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2094407">return</span>&nbsp;<span class="ident" id="2094414">Inf</span><span class="op" id="2094417">(</span><span class="num" id="2094418">1</span><span class="op" id="2094419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2094422">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2094425">return</span>&nbsp;<span class="ident" id="2094432">z</span>&nbsp;<span class="op" id="2094434">/</span>&nbsp;<span class="op" id="2094436">(</span><span class="op" id="2094437">(</span><span class="num" id="2094438">1</span>&nbsp;<span class="op" id="2094440">+</span>&nbsp;<span class="ident" id="2094442">Euler</span><span class="op" id="2094447">*</span><span class="ident" id="2094448">x</span><span class="op" id="2094449">)</span>&nbsp;<span class="op" id="2094451">*</span>&nbsp;<span class="ident" id="2094453">x</span><span class="op" id="2094454">)</span><br>
<span class="lineno"></span><span class="op" id="2094456">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="2094459">func</span>&nbsp;<span class="ident" id="2094464">isNegInt</span><span class="op" id="2094472">(</span><span class="ident" id="2094473">x</span>&nbsp;<span class="builtintype" id="2094475">float64</span><span class="op" id="2094482">)</span>&nbsp;<span class="builtintype" id="2094484">bool</span>&nbsp;<span class="op" id="2094489">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2094492">if</span>&nbsp;<span class="ident" id="2094495">x</span>&nbsp;<span class="op" id="2094497">&lt;</span>&nbsp;<span class="num" id="2094499">0</span>&nbsp;<span class="op" id="2094501">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="2094505">_</span><span class="op" id="2094506">,</span>&nbsp;<span class="ident" id="2094508">xf</span>&nbsp;<span class="op" id="2094511">:=</span>&nbsp;<span class="ident" id="2094514">Modf</span><span class="op" id="2094518">(</span><span class="ident" id="2094519">x</span><span class="op" id="2094520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2094524">return</span>&nbsp;<span class="ident" id="2094531">xf</span>&nbsp;<span class="op" id="2094534">==</span>&nbsp;<span class="num" id="2094537">0</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="2094540">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="2094543">return</span>&nbsp;<span class="builtintype" id="2094550">false</span><br>
<span class="lineno"></span><span class="op" id="2094556">}</span>
</div>
</body>
</html>
