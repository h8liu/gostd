<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="7974296">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="7974352">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="7974406">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="7974457">package</span>&nbsp;<span class="ident" id="7974465">http</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7974471">import</span>&nbsp;<span class="op" id="7974478">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7974481">&#34;bytes&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7974490">&#34;encoding/json&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7974507">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7974514">&#34;log&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7974521">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7974527">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7974538">&#34;strings&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7974549">&#34;testing&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7974560">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="7974567">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7974570">var</span>&nbsp;<span class="ident" id="7974574">writeSetCookiesTests</span>&nbsp;<span class="op" id="7974595">=</span>&nbsp;<span class="op" id="7974597">[</span><span class="op" id="7974598">]</span><span class="keyword" id="7974599">struct</span>&nbsp;<span class="op" id="7974606">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7974609">Cookie</span>&nbsp;<span class="op" id="7974616">*</span><span class="ident" id="7974617">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7974625">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7974632">string</span><br>
<span class="lineno"></span><span class="op" id="7974639">}</span><span class="op" id="7974640">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7974643">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7974647">&amp;</span><span class="ident" id="7974648">Cookie</span><span class="op" id="7974654">{</span><span class="ident" id="7974655">Name</span><span class="op" id="7974659">:</span>&nbsp;<span class="string" id="7974661">&#34;cookie-1&#34;</span><span class="op" id="7974671">,</span>&nbsp;<span class="ident" id="7974673">Value</span><span class="op" id="7974678">:</span>&nbsp;<span class="string" id="7974680">&#34;v$1&#34;</span><span class="op" id="7974685">}</span><span class="op" id="7974686">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7974690">&#34;cookie-1=v$1&#34;</span><span class="op" id="7974704">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7974707">}</span><span class="op" id="7974708">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7974711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7974715">&amp;</span><span class="ident" id="7974716">Cookie</span><span class="op" id="7974722">{</span><span class="ident" id="7974723">Name</span><span class="op" id="7974727">:</span>&nbsp;<span class="string" id="7974729">&#34;cookie-2&#34;</span><span class="op" id="7974739">,</span>&nbsp;<span class="ident" id="7974741">Value</span><span class="op" id="7974746">:</span>&nbsp;<span class="string" id="7974748">&#34;two&#34;</span><span class="op" id="7974753">,</span>&nbsp;<span class="ident" id="7974755">MaxAge</span><span class="op" id="7974761">:</span>&nbsp;<span class="num" id="7974763">3600</span><span class="op" id="7974767">}</span><span class="op" id="7974768">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7974772">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="7974800">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7974803">}</span><span class="op" id="7974804">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7974807">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7974811">&amp;</span><span class="ident" id="7974812">Cookie</span><span class="op" id="7974818">{</span><span class="ident" id="7974819">Name</span><span class="op" id="7974823">:</span>&nbsp;<span class="string" id="7974825">&#34;cookie-3&#34;</span><span class="op" id="7974835">,</span>&nbsp;<span class="ident" id="7974837">Value</span><span class="op" id="7974842">:</span>&nbsp;<span class="string" id="7974844">&#34;three&#34;</span><span class="op" id="7974851">,</span>&nbsp;<span class="ident" id="7974853">Domain</span><span class="op" id="7974859">:</span>&nbsp;<span class="string" id="7974861">&#34;.example.com&#34;</span><span class="op" id="7974875">}</span><span class="op" id="7974876">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7974880">&#34;cookie-3=three;&nbsp;Domain=example.com&#34;</span><span class="op" id="7974916">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7974919">}</span><span class="op" id="7974920">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7974923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7974927">&amp;</span><span class="ident" id="7974928">Cookie</span><span class="op" id="7974934">{</span><span class="ident" id="7974935">Name</span><span class="op" id="7974939">:</span>&nbsp;<span class="string" id="7974941">&#34;cookie-4&#34;</span><span class="op" id="7974951">,</span>&nbsp;<span class="ident" id="7974953">Value</span><span class="op" id="7974958">:</span>&nbsp;<span class="string" id="7974960">&#34;four&#34;</span><span class="op" id="7974966">,</span>&nbsp;<span class="ident" id="7974968">Path</span><span class="op" id="7974972">:</span>&nbsp;<span class="string" id="7974974">&#34;/restricted/&#34;</span><span class="op" id="7974988">}</span><span class="op" id="7974989">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7974993">&#34;cookie-4=four;&nbsp;Path=/restricted/&#34;</span><span class="op" id="7975027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975030">}</span><span class="op" id="7975031">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975034">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975038">&amp;</span><span class="ident" id="7975039">Cookie</span><span class="op" id="7975045">{</span><span class="ident" id="7975046">Name</span><span class="op" id="7975050">:</span>&nbsp;<span class="string" id="7975052">&#34;cookie-5&#34;</span><span class="op" id="7975062">,</span>&nbsp;<span class="ident" id="7975064">Value</span><span class="op" id="7975069">:</span>&nbsp;<span class="string" id="7975071">&#34;five&#34;</span><span class="op" id="7975077">,</span>&nbsp;<span class="ident" id="7975079">Domain</span><span class="op" id="7975085">:</span>&nbsp;<span class="string" id="7975087">&#34;wrong;bad.abc&#34;</span><span class="op" id="7975102">}</span><span class="op" id="7975103">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7975107">&#34;cookie-5=five&#34;</span><span class="op" id="7975122">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975125">}</span><span class="op" id="7975126">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975129">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975133">&amp;</span><span class="ident" id="7975134">Cookie</span><span class="op" id="7975140">{</span><span class="ident" id="7975141">Name</span><span class="op" id="7975145">:</span>&nbsp;<span class="string" id="7975147">&#34;cookie-6&#34;</span><span class="op" id="7975157">,</span>&nbsp;<span class="ident" id="7975159">Value</span><span class="op" id="7975164">:</span>&nbsp;<span class="string" id="7975166">&#34;six&#34;</span><span class="op" id="7975171">,</span>&nbsp;<span class="ident" id="7975173">Domain</span><span class="op" id="7975179">:</span>&nbsp;<span class="string" id="7975181">&#34;bad-.abc&#34;</span><span class="op" id="7975191">}</span><span class="op" id="7975192">,</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7975196">&#34;cookie-6=six&#34;</span><span class="op" id="7975210">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975213">}</span><span class="op" id="7975214">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975217">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975221">&amp;</span><span class="ident" id="7975222">Cookie</span><span class="op" id="7975228">{</span><span class="ident" id="7975229">Name</span><span class="op" id="7975233">:</span>&nbsp;<span class="string" id="7975235">&#34;cookie-7&#34;</span><span class="op" id="7975245">,</span>&nbsp;<span class="ident" id="7975247">Value</span><span class="op" id="7975252">:</span>&nbsp;<span class="string" id="7975254">&#34;seven&#34;</span><span class="op" id="7975261">,</span>&nbsp;<span class="ident" id="7975263">Domain</span><span class="op" id="7975269">:</span>&nbsp;<span class="string" id="7975271">&#34;127.0.0.1&#34;</span><span class="op" id="7975282">}</span><span class="op" id="7975283">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7975287">&#34;cookie-7=seven;&nbsp;Domain=127.0.0.1&#34;</span><span class="op" id="7975321">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975324">}</span><span class="op" id="7975325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975332">&amp;</span><span class="ident" id="7975333">Cookie</span><span class="op" id="7975339">{</span><span class="ident" id="7975340">Name</span><span class="op" id="7975344">:</span>&nbsp;<span class="string" id="7975346">&#34;cookie-8&#34;</span><span class="op" id="7975356">,</span>&nbsp;<span class="ident" id="7975358">Value</span><span class="op" id="7975363">:</span>&nbsp;<span class="string" id="7975365">&#34;eight&#34;</span><span class="op" id="7975372">,</span>&nbsp;<span class="ident" id="7975374">Domain</span><span class="op" id="7975380">:</span>&nbsp;<span class="string" id="7975382">&#34;::1&#34;</span><span class="op" id="7975387">}</span><span class="op" id="7975388">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7975392">&#34;cookie-8=eight&#34;</span><span class="op" id="7975408">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975411">}</span><span class="op" id="7975412">,</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7975415">//&nbsp;The&nbsp;&#34;special&#34;&nbsp;cookies&nbsp;have&nbsp;values&nbsp;containing&nbsp;commas&nbsp;or&nbsp;spaces&nbsp;which</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7975487">//&nbsp;are&nbsp;disallowed&nbsp;by&nbsp;RFC&nbsp;6265&nbsp;but&nbsp;are&nbsp;common&nbsp;in&nbsp;the&nbsp;wild.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975546">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975550">&amp;</span><span class="ident" id="7975551">Cookie</span><span class="op" id="7975557">{</span><span class="ident" id="7975558">Name</span><span class="op" id="7975562">:</span>&nbsp;<span class="string" id="7975564">&#34;special-1&#34;</span><span class="op" id="7975575">,</span>&nbsp;<span class="ident" id="7975577">Value</span><span class="op" id="7975582">:</span>&nbsp;<span class="string" id="7975584">&#34;a&nbsp;z&#34;</span><span class="op" id="7975589">}</span><span class="op" id="7975590">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7975594">`special-1=a&nbsp;z`</span><span class="op" id="7975609">,</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975612">}</span><span class="op" id="7975613">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975616">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975620">&amp;</span><span class="ident" id="7975621">Cookie</span><span class="op" id="7975627">{</span><span class="ident" id="7975628">Name</span><span class="op" id="7975632">:</span>&nbsp;<span class="string" id="7975634">&#34;special-2&#34;</span><span class="op" id="7975645">,</span>&nbsp;<span class="ident" id="7975647">Value</span><span class="op" id="7975652">:</span>&nbsp;<span class="string" id="7975654">&#34;&nbsp;z&#34;</span><span class="op" id="7975658">}</span><span class="op" id="7975659">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7975663">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7975679">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975682">}</span><span class="op" id="7975683">,</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975686">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975690">&amp;</span><span class="ident" id="7975691">Cookie</span><span class="op" id="7975697">{</span><span class="ident" id="7975698">Name</span><span class="op" id="7975702">:</span>&nbsp;<span class="string" id="7975704">&#34;special-3&#34;</span><span class="op" id="7975715">,</span>&nbsp;<span class="ident" id="7975717">Value</span><span class="op" id="7975722">:</span>&nbsp;<span class="string" id="7975724">&#34;a&nbsp;&#34;</span><span class="op" id="7975728">}</span><span class="op" id="7975729">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7975733">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7975749">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975752">}</span><span class="op" id="7975753">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975756">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975760">&amp;</span><span class="ident" id="7975761">Cookie</span><span class="op" id="7975767">{</span><span class="ident" id="7975768">Name</span><span class="op" id="7975772">:</span>&nbsp;<span class="string" id="7975774">&#34;special-4&#34;</span><span class="op" id="7975785">,</span>&nbsp;<span class="ident" id="7975787">Value</span><span class="op" id="7975792">:</span>&nbsp;<span class="string" id="7975794">&#34;&nbsp;&#34;</span><span class="op" id="7975797">}</span><span class="op" id="7975798">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7975802">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7975817">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975820">}</span><span class="op" id="7975821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975824">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975828">&amp;</span><span class="ident" id="7975829">Cookie</span><span class="op" id="7975835">{</span><span class="ident" id="7975836">Name</span><span class="op" id="7975840">:</span>&nbsp;<span class="string" id="7975842">&#34;special-5&#34;</span><span class="op" id="7975853">,</span>&nbsp;<span class="ident" id="7975855">Value</span><span class="op" id="7975860">:</span>&nbsp;<span class="string" id="7975862">&#34;a,z&#34;</span><span class="op" id="7975867">}</span><span class="op" id="7975868">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7975872">`special-5=a,z`</span><span class="op" id="7975887">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975890">}</span><span class="op" id="7975891">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975894">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975898">&amp;</span><span class="ident" id="7975899">Cookie</span><span class="op" id="7975905">{</span><span class="ident" id="7975906">Name</span><span class="op" id="7975910">:</span>&nbsp;<span class="string" id="7975912">&#34;special-6&#34;</span><span class="op" id="7975923">,</span>&nbsp;<span class="ident" id="7975925">Value</span><span class="op" id="7975930">:</span>&nbsp;<span class="string" id="7975932">&#34;,z&#34;</span><span class="op" id="7975936">}</span><span class="op" id="7975937">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7975941">`special-6=&#34;,z&#34;`</span><span class="op" id="7975957">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975960">}</span><span class="op" id="7975961">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7975968">&amp;</span><span class="ident" id="7975969">Cookie</span><span class="op" id="7975975">{</span><span class="ident" id="7975976">Name</span><span class="op" id="7975980">:</span>&nbsp;<span class="string" id="7975982">&#34;special-7&#34;</span><span class="op" id="7975993">,</span>&nbsp;<span class="ident" id="7975995">Value</span><span class="op" id="7976000">:</span>&nbsp;<span class="string" id="7976002">&#34;a,&#34;</span><span class="op" id="7976006">}</span><span class="op" id="7976007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7976011">`special-7=&#34;a,&#34;`</span><span class="op" id="7976027">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7976030">}</span><span class="op" id="7976031">,</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7976034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7976038">&amp;</span><span class="ident" id="7976039">Cookie</span><span class="op" id="7976045">{</span><span class="ident" id="7976046">Name</span><span class="op" id="7976050">:</span>&nbsp;<span class="string" id="7976052">&#34;special-8&#34;</span><span class="op" id="7976063">,</span>&nbsp;<span class="ident" id="7976065">Value</span><span class="op" id="7976070">:</span>&nbsp;<span class="string" id="7976072">&#34;,&#34;</span><span class="op" id="7976075">}</span><span class="op" id="7976076">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7976080">`special-8=&#34;,&#34;`</span><span class="op" id="7976095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7976098">}</span><span class="op" id="7976099">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7976102">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7976106">&amp;</span><span class="ident" id="7976107">Cookie</span><span class="op" id="7976113">{</span><span class="ident" id="7976114">Name</span><span class="op" id="7976118">:</span>&nbsp;<span class="string" id="7976120">&#34;empty-value&#34;</span><span class="op" id="7976133">,</span>&nbsp;<span class="ident" id="7976135">Value</span><span class="op" id="7976140">:</span>&nbsp;<span class="string" id="7976142">&#34;&#34;</span><span class="op" id="7976144">}</span><span class="op" id="7976145">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7976149">`empty-value=`</span><span class="op" id="7976163">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7976166">}</span><span class="op" id="7976167">,</span><br>
<span class="lineno"></span><span class="op" id="7976169">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="7976172">func</span>&nbsp;<span class="ident" id="7976177">TestWriteSetCookies</span><span class="op" id="7976196">(</span><span class="ident" id="7976197">t</span>&nbsp;<span class="op" id="7976199">*</span><span class="ident" id="7976200">testing</span><span class="op" id="7976207">.</span><span class="ident" id="7976208">T</span><span class="op" id="7976209">)</span>&nbsp;<span class="op" id="7976211">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7976214">defer</span>&nbsp;<span class="ident" id="7976220">log</span><span class="op" id="7976223">.</span><span class="ident" id="7976224">SetOutput</span><span class="op" id="7976233">(</span><span class="ident" id="7976234">os</span><span class="op" id="7976236">.</span><span class="ident" id="7976237">Stderr</span><span class="op" id="7976243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7976246">var</span>&nbsp;<span class="ident" id="7976250">logbuf</span>&nbsp;<span class="ident" id="7976257">bytes</span><span class="op" id="7976262">.</span><span class="ident" id="7976263">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7976271">log</span><span class="op" id="7976274">.</span><span class="ident" id="7976275">SetOutput</span><span class="op" id="7976284">(</span><span class="op" id="7976285">&amp;</span><span class="ident" id="7976286">logbuf</span><span class="op" id="7976292">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7976296">for</span>&nbsp;<span class="ident" id="7976300">i</span><span class="op" id="7976301">,</span>&nbsp;<span class="ident" id="7976303">tt</span>&nbsp;<span class="op" id="7976306">:=</span>&nbsp;<span class="keyword" id="7976309">range</span>&nbsp;<span class="ident" id="7976315">writeSetCookiesTests</span>&nbsp;<span class="op" id="7976336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7976340">if</span>&nbsp;<span class="ident" id="7976343">g</span><span class="op" id="7976344">,</span>&nbsp;<span class="ident" id="7976346">e</span>&nbsp;<span class="op" id="7976348">:=</span>&nbsp;<span class="ident" id="7976351">tt</span><span class="op" id="7976353">.</span><span class="ident" id="7976354">Cookie</span><span class="op" id="7976360">.</span><span class="ident" id="7976361">String</span><span class="op" id="7976367">(</span><span class="op" id="7976368">)</span><span class="op" id="7976369">,</span>&nbsp;<span class="ident" id="7976371">tt</span><span class="op" id="7976373">.</span><span class="ident" id="7976374">Raw</span><span class="op" id="7976377">;</span>&nbsp;<span class="ident" id="7976379">g</span>&nbsp;<span class="op" id="7976381">!=</span>&nbsp;<span class="ident" id="7976384">e</span>&nbsp;<span class="op" id="7976386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7976391">t</span><span class="op" id="7976392">.</span><span class="ident" id="7976393">Errorf</span><span class="op" id="7976399">(</span><span class="string" id="7976400">&#34;Test&nbsp;%d,&nbsp;expecting:\n%s\nGot:\n%s\n&#34;</span><span class="op" id="7976437">,</span>&nbsp;<span class="ident" id="7976439">i</span><span class="op" id="7976440">,</span>&nbsp;<span class="ident" id="7976442">e</span><span class="op" id="7976443">,</span>&nbsp;<span class="ident" id="7976445">g</span><span class="op" id="7976446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7976451">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7976462">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7976465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7976469">if</span>&nbsp;<span class="ident" id="7976472">got</span><span class="op" id="7976475">,</span>&nbsp;<span class="ident" id="7976477">sub</span>&nbsp;<span class="op" id="7976481">:=</span>&nbsp;<span class="ident" id="7976484">logbuf</span><span class="op" id="7976490">.</span><span class="ident" id="7976491">String</span><span class="op" id="7976497">(</span><span class="op" id="7976498">)</span><span class="op" id="7976499">,</span>&nbsp;<span class="string" id="7976501">&#34;dropping&nbsp;domain&nbsp;attribute&#34;</span><span class="op" id="7976528">;</span>&nbsp;<span class="op" id="7976530">!</span><span class="ident" id="7976531">strings</span><span class="op" id="7976538">.</span><span class="ident" id="7976539">Contains</span><span class="op" id="7976547">(</span><span class="ident" id="7976548">got</span><span class="op" id="7976551">,</span>&nbsp;<span class="ident" id="7976553">sub</span><span class="op" id="7976556">)</span>&nbsp;<span class="op" id="7976558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7976562">t</span><span class="op" id="7976563">.</span><span class="ident" id="7976564">Errorf</span><span class="op" id="7976570">(</span><span class="string" id="7976571">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7976618">,</span>&nbsp;<span class="ident" id="7976620">sub</span><span class="op" id="7976623">,</span>&nbsp;<span class="ident" id="7976625">got</span><span class="op" id="7976628">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7976631">}</span><br>
<span class="lineno">110</span><span class="op" id="7976633">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7976636">type</span>&nbsp;<span class="ident" id="7976641">headerOnlyResponseWriter</span>&nbsp;<span class="ident" id="7976666">Header</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7976674">func</span>&nbsp;<span class="op" id="7976679">(</span><span class="ident" id="7976680">ho</span>&nbsp;<span class="ident" id="7976683">headerOnlyResponseWriter</span><span class="op" id="7976707">)</span>&nbsp;<span class="ident" id="7976709">Header</span><span class="op" id="7976715">(</span><span class="op" id="7976716">)</span>&nbsp;<span class="ident" id="7976718">Header</span>&nbsp;<span class="op" id="7976725">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7976728">return</span>&nbsp;<span class="ident" id="7976735">Header</span><span class="op" id="7976741">(</span><span class="ident" id="7976742">ho</span><span class="op" id="7976744">)</span><br>
<span class="lineno"></span><span class="op" id="7976746">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7976749">func</span>&nbsp;<span class="op" id="7976754">(</span><span class="ident" id="7976755">ho</span>&nbsp;<span class="ident" id="7976758">headerOnlyResponseWriter</span><span class="op" id="7976782">)</span>&nbsp;<span class="ident" id="7976784">Write</span><span class="op" id="7976789">(</span><span class="op" id="7976790">[</span><span class="op" id="7976791">]</span><span class="builtintype" id="7976792">byte</span><span class="op" id="7976796">)</span>&nbsp;<span class="op" id="7976798">(</span><span class="builtintype" id="7976799">int</span><span class="op" id="7976802">,</span>&nbsp;<span class="builtintype" id="7976804">error</span><span class="op" id="7976809">)</span>&nbsp;<span class="op" id="7976811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7976814">panic</span><span class="op" id="7976819">(</span><span class="string" id="7976820">&#34;NOIMPL&#34;</span><span class="op" id="7976828">)</span><br>
<span class="lineno">120</span><span class="op" id="7976830">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7976833">func</span>&nbsp;<span class="op" id="7976838">(</span><span class="ident" id="7976839">ho</span>&nbsp;<span class="ident" id="7976842">headerOnlyResponseWriter</span><span class="op" id="7976866">)</span>&nbsp;<span class="ident" id="7976868">WriteHeader</span><span class="op" id="7976879">(</span><span class="builtintype" id="7976880">int</span><span class="op" id="7976883">)</span>&nbsp;<span class="op" id="7976885">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="7976888">panic</span><span class="op" id="7976893">(</span><span class="string" id="7976894">&#34;NOIMPL&#34;</span><span class="op" id="7976902">)</span><br>
<span class="lineno"></span><span class="op" id="7976904">}</span><br>
<span class="lineno">125</span><br>
<span class="lineno"></span><span class="keyword" id="7976907">func</span>&nbsp;<span class="ident" id="7976912">TestSetCookie</span><span class="op" id="7976925">(</span><span class="ident" id="7976926">t</span>&nbsp;<span class="op" id="7976928">*</span><span class="ident" id="7976929">testing</span><span class="op" id="7976936">.</span><span class="ident" id="7976937">T</span><span class="op" id="7976938">)</span>&nbsp;<span class="op" id="7976940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7976943">m</span>&nbsp;<span class="op" id="7976945">:=</span>&nbsp;<span class="builtinfunc" id="7976948">make</span><span class="op" id="7976952">(</span><span class="ident" id="7976953">Header</span><span class="op" id="7976959">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7976962">SetCookie</span><span class="op" id="7976971">(</span><span class="ident" id="7976972">headerOnlyResponseWriter</span><span class="op" id="7976996">(</span><span class="ident" id="7976997">m</span><span class="op" id="7976998">)</span><span class="op" id="7976999">,</span>&nbsp;<span class="op" id="7977001">&amp;</span><span class="ident" id="7977002">Cookie</span><span class="op" id="7977008">{</span><span class="ident" id="7977009">Name</span><span class="op" id="7977013">:</span>&nbsp;<span class="string" id="7977015">&#34;cookie-1&#34;</span><span class="op" id="7977025">,</span>&nbsp;<span class="ident" id="7977027">Value</span><span class="op" id="7977032">:</span>&nbsp;<span class="string" id="7977034">&#34;one&#34;</span><span class="op" id="7977039">,</span>&nbsp;<span class="ident" id="7977041">Path</span><span class="op" id="7977045">:</span>&nbsp;<span class="string" id="7977047">&#34;/restricted/&#34;</span><span class="op" id="7977061">}</span><span class="op" id="7977062">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7977065">SetCookie</span><span class="op" id="7977074">(</span><span class="ident" id="7977075">headerOnlyResponseWriter</span><span class="op" id="7977099">(</span><span class="ident" id="7977100">m</span><span class="op" id="7977101">)</span><span class="op" id="7977102">,</span>&nbsp;<span class="op" id="7977104">&amp;</span><span class="ident" id="7977105">Cookie</span><span class="op" id="7977111">{</span><span class="ident" id="7977112">Name</span><span class="op" id="7977116">:</span>&nbsp;<span class="string" id="7977118">&#34;cookie-2&#34;</span><span class="op" id="7977128">,</span>&nbsp;<span class="ident" id="7977130">Value</span><span class="op" id="7977135">:</span>&nbsp;<span class="string" id="7977137">&#34;two&#34;</span><span class="op" id="7977142">,</span>&nbsp;<span class="ident" id="7977144">MaxAge</span><span class="op" id="7977150">:</span>&nbsp;<span class="num" id="7977152">3600</span><span class="op" id="7977156">}</span><span class="op" id="7977157">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7977160">if</span>&nbsp;<span class="ident" id="7977163">l</span>&nbsp;<span class="op" id="7977165">:=</span>&nbsp;<span class="builtinfunc" id="7977168">len</span><span class="op" id="7977171">(</span><span class="ident" id="7977172">m</span><span class="op" id="7977173">[</span><span class="string" id="7977174">&#34;Set-Cookie&#34;</span><span class="op" id="7977186">]</span><span class="op" id="7977187">)</span><span class="op" id="7977188">;</span>&nbsp;<span class="ident" id="7977190">l</span>&nbsp;<span class="op" id="7977192">!=</span>&nbsp;<span class="num" id="7977195">2</span>&nbsp;<span class="op" id="7977197">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7977201">t</span><span class="op" id="7977202">.</span><span class="ident" id="7977203">Fatalf</span><span class="op" id="7977209">(</span><span class="string" id="7977210">&#34;expected&nbsp;%d&nbsp;cookies,&nbsp;got&nbsp;%d&#34;</span><span class="op" id="7977239">,</span>&nbsp;<span class="num" id="7977241">2</span><span class="op" id="7977242">,</span>&nbsp;<span class="ident" id="7977244">l</span><span class="op" id="7977245">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7977248">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7977251">if</span>&nbsp;<span class="ident" id="7977254">g</span><span class="op" id="7977255">,</span>&nbsp;<span class="ident" id="7977257">e</span>&nbsp;<span class="op" id="7977259">:=</span>&nbsp;<span class="ident" id="7977262">m</span><span class="op" id="7977263">[</span><span class="string" id="7977264">&#34;Set-Cookie&#34;</span><span class="op" id="7977276">]</span><span class="op" id="7977277">[</span><span class="num" id="7977278">0</span><span class="op" id="7977279">]</span><span class="op" id="7977280">,</span>&nbsp;<span class="string" id="7977282">&#34;cookie-1=one;&nbsp;Path=/restricted/&#34;</span><span class="op" id="7977315">;</span>&nbsp;<span class="ident" id="7977317">g</span>&nbsp;<span class="op" id="7977319">!=</span>&nbsp;<span class="ident" id="7977322">e</span>&nbsp;<span class="op" id="7977324">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7977328">t</span><span class="op" id="7977329">.</span><span class="ident" id="7977330">Errorf</span><span class="op" id="7977336">(</span><span class="string" id="7977337">&#34;cookie&nbsp;#1:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7977365">,</span>&nbsp;<span class="ident" id="7977367">e</span><span class="op" id="7977368">,</span>&nbsp;<span class="ident" id="7977370">g</span><span class="op" id="7977371">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7977374">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7977377">if</span>&nbsp;<span class="ident" id="7977380">g</span><span class="op" id="7977381">,</span>&nbsp;<span class="ident" id="7977383">e</span>&nbsp;<span class="op" id="7977385">:=</span>&nbsp;<span class="ident" id="7977388">m</span><span class="op" id="7977389">[</span><span class="string" id="7977390">&#34;Set-Cookie&#34;</span><span class="op" id="7977402">]</span><span class="op" id="7977403">[</span><span class="num" id="7977404">1</span><span class="op" id="7977405">]</span><span class="op" id="7977406">,</span>&nbsp;<span class="string" id="7977408">&#34;cookie-2=two;&nbsp;Max-Age=3600&#34;</span><span class="op" id="7977436">;</span>&nbsp;<span class="ident" id="7977438">g</span>&nbsp;<span class="op" id="7977440">!=</span>&nbsp;<span class="ident" id="7977443">e</span>&nbsp;<span class="op" id="7977445">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7977449">t</span><span class="op" id="7977450">.</span><span class="ident" id="7977451">Errorf</span><span class="op" id="7977457">(</span><span class="string" id="7977458">&#34;cookie&nbsp;#2:&nbsp;want&nbsp;%q,&nbsp;got&nbsp;%q&#34;</span><span class="op" id="7977486">,</span>&nbsp;<span class="ident" id="7977488">e</span><span class="op" id="7977489">,</span>&nbsp;<span class="ident" id="7977491">g</span><span class="op" id="7977492">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7977495">}</span><br>
<span class="lineno"></span><span class="op" id="7977497">}</span><br>
<span class="lineno">140</span><br>
<span class="lineno"></span><span class="keyword" id="7977500">var</span>&nbsp;<span class="ident" id="7977504">addCookieTests</span>&nbsp;<span class="op" id="7977519">=</span>&nbsp;<span class="op" id="7977521">[</span><span class="op" id="7977522">]</span><span class="keyword" id="7977523">struct</span>&nbsp;<span class="op" id="7977530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7977533">Cookies</span>&nbsp;<span class="op" id="7977541">[</span><span class="op" id="7977542">]</span><span class="op" id="7977543">*</span><span class="ident" id="7977544">Cookie</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7977552">Raw</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="7977560">string</span><br>
<span class="lineno"></span><span class="op" id="7977567">}</span><span class="op" id="7977568">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7977571">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7977575">[</span><span class="op" id="7977576">]</span><span class="op" id="7977577">*</span><span class="ident" id="7977578">Cookie</span><span class="op" id="7977584">{</span><span class="op" id="7977585">}</span><span class="op" id="7977586">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7977590">&#34;&#34;</span><span class="op" id="7977592">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7977595">}</span><span class="op" id="7977596">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7977599">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7977603">[</span><span class="op" id="7977604">]</span><span class="op" id="7977605">*</span><span class="ident" id="7977606">Cookie</span><span class="op" id="7977612">{</span><span class="op" id="7977613">{</span><span class="ident" id="7977614">Name</span><span class="op" id="7977618">:</span>&nbsp;<span class="string" id="7977620">&#34;cookie-1&#34;</span><span class="op" id="7977630">,</span>&nbsp;<span class="ident" id="7977632">Value</span><span class="op" id="7977637">:</span>&nbsp;<span class="string" id="7977639">&#34;v$1&#34;</span><span class="op" id="7977644">}</span><span class="op" id="7977645">}</span><span class="op" id="7977646">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7977650">&#34;cookie-1=v$1&#34;</span><span class="op" id="7977664">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7977667">}</span><span class="op" id="7977668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7977671">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7977675">[</span><span class="op" id="7977676">]</span><span class="op" id="7977677">*</span><span class="ident" id="7977678">Cookie</span><span class="op" id="7977684">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7977689">{</span><span class="ident" id="7977690">Name</span><span class="op" id="7977694">:</span>&nbsp;<span class="string" id="7977696">&#34;cookie-1&#34;</span><span class="op" id="7977706">,</span>&nbsp;<span class="ident" id="7977708">Value</span><span class="op" id="7977713">:</span>&nbsp;<span class="string" id="7977715">&#34;v$1&#34;</span><span class="op" id="7977720">}</span><span class="op" id="7977721">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7977726">{</span><span class="ident" id="7977727">Name</span><span class="op" id="7977731">:</span>&nbsp;<span class="string" id="7977733">&#34;cookie-2&#34;</span><span class="op" id="7977743">,</span>&nbsp;<span class="ident" id="7977745">Value</span><span class="op" id="7977750">:</span>&nbsp;<span class="string" id="7977752">&#34;v$2&#34;</span><span class="op" id="7977757">}</span><span class="op" id="7977758">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7977763">{</span><span class="ident" id="7977764">Name</span><span class="op" id="7977768">:</span>&nbsp;<span class="string" id="7977770">&#34;cookie-3&#34;</span><span class="op" id="7977780">,</span>&nbsp;<span class="ident" id="7977782">Value</span><span class="op" id="7977787">:</span>&nbsp;<span class="string" id="7977789">&#34;v$3&#34;</span><span class="op" id="7977794">}</span><span class="op" id="7977795">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7977799">}</span><span class="op" id="7977800">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7977804">&#34;cookie-1=v$1;&nbsp;cookie-2=v$2;&nbsp;cookie-3=v$3&#34;</span><span class="op" id="7977846">,</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7977849">}</span><span class="op" id="7977850">,</span><br>
<span class="lineno"></span><span class="op" id="7977852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7977855">func</span>&nbsp;<span class="ident" id="7977860">TestAddCookie</span><span class="op" id="7977873">(</span><span class="ident" id="7977874">t</span>&nbsp;<span class="op" id="7977876">*</span><span class="ident" id="7977877">testing</span><span class="op" id="7977884">.</span><span class="ident" id="7977885">T</span><span class="op" id="7977886">)</span>&nbsp;<span class="op" id="7977888">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7977891">for</span>&nbsp;<span class="ident" id="7977895">i</span><span class="op" id="7977896">,</span>&nbsp;<span class="ident" id="7977898">tt</span>&nbsp;<span class="op" id="7977901">:=</span>&nbsp;<span class="keyword" id="7977904">range</span>&nbsp;<span class="ident" id="7977910">addCookieTests</span>&nbsp;<span class="op" id="7977925">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7977929">req</span><span class="op" id="7977932">,</span>&nbsp;<span class="ident" id="7977934">_</span>&nbsp;<span class="op" id="7977936">:=</span>&nbsp;<span class="ident" id="7977939">NewRequest</span><span class="op" id="7977949">(</span><span class="string" id="7977950">&#34;GET&#34;</span><span class="op" id="7977955">,</span>&nbsp;<span class="string" id="7977957">&#34;http://example.com/&#34;</span><span class="op" id="7977978">,</span>&nbsp;<span class="ident" id="7977980">nil</span><span class="op" id="7977983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7977987">for</span>&nbsp;<span class="ident" id="7977991">_</span><span class="op" id="7977992">,</span>&nbsp;<span class="ident" id="7977994">c</span>&nbsp;<span class="op" id="7977996">:=</span>&nbsp;<span class="keyword" id="7977999">range</span>&nbsp;<span class="ident" id="7978005">tt</span><span class="op" id="7978007">.</span><span class="ident" id="7978008">Cookies</span>&nbsp;<span class="op" id="7978016">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7978021">req</span><span class="op" id="7978024">.</span><span class="ident" id="7978025">AddCookie</span><span class="op" id="7978034">(</span><span class="ident" id="7978035">c</span><span class="op" id="7978036">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7978040">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7978044">if</span>&nbsp;<span class="ident" id="7978047">g</span>&nbsp;<span class="op" id="7978049">:=</span>&nbsp;<span class="ident" id="7978052">req</span><span class="op" id="7978055">.</span><span class="ident" id="7978056">Header</span><span class="op" id="7978062">.</span><span class="ident" id="7978063">Get</span><span class="op" id="7978066">(</span><span class="string" id="7978067">&#34;Cookie&#34;</span><span class="op" id="7978075">)</span><span class="op" id="7978076">;</span>&nbsp;<span class="ident" id="7978078">g</span>&nbsp;<span class="op" id="7978080">!=</span>&nbsp;<span class="ident" id="7978083">tt</span><span class="op" id="7978085">.</span><span class="ident" id="7978086">Raw</span>&nbsp;<span class="op" id="7978090">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7978095">t</span><span class="op" id="7978096">.</span><span class="ident" id="7978097">Errorf</span><span class="op" id="7978103">(</span><span class="string" id="7978104">&#34;Test&nbsp;%d:\nwant:&nbsp;%s\n&nbsp;got:&nbsp;%s\n&#34;</span><span class="op" id="7978136">,</span>&nbsp;<span class="ident" id="7978138">i</span><span class="op" id="7978139">,</span>&nbsp;<span class="ident" id="7978141">tt</span><span class="op" id="7978143">.</span><span class="ident" id="7978144">Raw</span><span class="op" id="7978147">,</span>&nbsp;<span class="ident" id="7978149">g</span><span class="op" id="7978150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7978155">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7978166">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7978169">}</span><br>
<span class="lineno"></span><span class="op" id="7978171">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="keyword" id="7978174">var</span>&nbsp;<span class="ident" id="7978178">readSetCookiesTests</span>&nbsp;<span class="op" id="7978198">=</span>&nbsp;<span class="op" id="7978200">[</span><span class="op" id="7978201">]</span><span class="keyword" id="7978202">struct</span>&nbsp;<span class="op" id="7978209">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7978212">Header</span>&nbsp;&nbsp;<span class="ident" id="7978220">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7978228">Cookies</span>&nbsp;<span class="op" id="7978236">[</span><span class="op" id="7978237">]</span><span class="op" id="7978238">*</span><span class="ident" id="7978239">Cookie</span><br>
<span class="lineno"></span><span class="op" id="7978246">}</span><span class="op" id="7978247">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7978250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7978254">Header</span><span class="op" id="7978260">{</span><span class="string" id="7978261">&#34;Set-Cookie&#34;</span><span class="op" id="7978273">:</span>&nbsp;<span class="op" id="7978275">{</span><span class="string" id="7978276">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7978290">}</span><span class="op" id="7978291">}</span><span class="op" id="7978292">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7978296">[</span><span class="op" id="7978297">]</span><span class="op" id="7978298">*</span><span class="ident" id="7978299">Cookie</span><span class="op" id="7978305">{</span><span class="op" id="7978306">{</span><span class="ident" id="7978307">Name</span><span class="op" id="7978311">:</span>&nbsp;<span class="string" id="7978313">&#34;Cookie-1&#34;</span><span class="op" id="7978323">,</span>&nbsp;<span class="ident" id="7978325">Value</span><span class="op" id="7978330">:</span>&nbsp;<span class="string" id="7978332">&#34;v$1&#34;</span><span class="op" id="7978337">,</span>&nbsp;<span class="ident" id="7978339">Raw</span><span class="op" id="7978342">:</span>&nbsp;<span class="string" id="7978344">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7978358">}</span><span class="op" id="7978359">}</span><span class="op" id="7978360">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7978363">}</span><span class="op" id="7978364">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7978367">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7978371">Header</span><span class="op" id="7978377">{</span><span class="string" id="7978378">&#34;Set-Cookie&#34;</span><span class="op" id="7978390">:</span>&nbsp;<span class="op" id="7978392">{</span><span class="string" id="7978393">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="7978492">}</span><span class="op" id="7978493">}</span><span class="op" id="7978494">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7978498">[</span><span class="op" id="7978499">]</span><span class="op" id="7978500">*</span><span class="ident" id="7978501">Cookie</span><span class="op" id="7978507">{</span><span class="op" id="7978508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7978513">Name</span><span class="op" id="7978517">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7978525">&#34;NID&#34;</span><span class="op" id="7978530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7978535">Value</span><span class="op" id="7978540">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7978547">&#34;99=YsDT5i3E-CXax-&#34;</span><span class="op" id="7978566">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7978571">Path</span><span class="op" id="7978575">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7978583">&#34;/&#34;</span><span class="op" id="7978586">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7978591">Domain</span><span class="op" id="7978597">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7978603">&#34;.google.ch&#34;</span><span class="op" id="7978615">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7978620">HttpOnly</span><span class="op" id="7978628">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7978632">true</span><span class="op" id="7978636">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7978641">Expires</span><span class="op" id="7978648">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7978653">time</span><span class="op" id="7978657">.</span><span class="ident" id="7978658">Date</span><span class="op" id="7978662">(</span><span class="num" id="7978663">2011</span><span class="op" id="7978667">,</span>&nbsp;<span class="num" id="7978669">11</span><span class="op" id="7978671">,</span>&nbsp;<span class="num" id="7978673">23</span><span class="op" id="7978675">,</span>&nbsp;<span class="num" id="7978677">1</span><span class="op" id="7978678">,</span>&nbsp;<span class="num" id="7978680">5</span><span class="op" id="7978681">,</span>&nbsp;<span class="num" id="7978683">3</span><span class="op" id="7978684">,</span>&nbsp;<span class="num" id="7978686">0</span><span class="op" id="7978687">,</span>&nbsp;<span class="ident" id="7978689">time</span><span class="op" id="7978693">.</span><span class="ident" id="7978694">UTC</span><span class="op" id="7978697">)</span><span class="op" id="7978698">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7978703">RawExpires</span><span class="op" id="7978713">:</span>&nbsp;<span class="string" id="7978715">&#34;Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT&#34;</span><span class="op" id="7978746">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7978751">Raw</span><span class="op" id="7978754">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7978763">&#34;NID=99=YsDT5i3E-CXax-;&nbsp;expires=Wed,&nbsp;23-Nov-2011&nbsp;01:05:03&nbsp;GMT;&nbsp;path=/;&nbsp;domain=.google.ch;&nbsp;HttpOnly&#34;</span><span class="op" id="7978862">,</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7978866">}</span><span class="op" id="7978867">}</span><span class="op" id="7978868">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7978871">}</span><span class="op" id="7978872">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7978875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7978879">Header</span><span class="op" id="7978885">{</span><span class="string" id="7978886">&#34;Set-Cookie&#34;</span><span class="op" id="7978898">:</span>&nbsp;<span class="op" id="7978900">{</span><span class="string" id="7978901">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7978975">}</span><span class="op" id="7978976">}</span><span class="op" id="7978977">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7978981">[</span><span class="op" id="7978982">]</span><span class="op" id="7978983">*</span><span class="ident" id="7978984">Cookie</span><span class="op" id="7978990">{</span><span class="op" id="7978991">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7978996">Name</span><span class="op" id="7979000">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7979008">&#34;.ASPXAUTH&#34;</span><span class="op" id="7979019">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7979024">Value</span><span class="op" id="7979029">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7979036">&#34;7E3AA&#34;</span><span class="op" id="7979043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7979048">Path</span><span class="op" id="7979052">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7979060">&#34;/&#34;</span><span class="op" id="7979063">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7979068">Expires</span><span class="op" id="7979075">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="7979080">time</span><span class="op" id="7979084">.</span><span class="ident" id="7979085">Date</span><span class="op" id="7979089">(</span><span class="num" id="7979090">2012</span><span class="op" id="7979094">,</span>&nbsp;<span class="num" id="7979096">3</span><span class="op" id="7979097">,</span>&nbsp;<span class="num" id="7979099">7</span><span class="op" id="7979100">,</span>&nbsp;<span class="num" id="7979102">14</span><span class="op" id="7979104">,</span>&nbsp;<span class="num" id="7979106">25</span><span class="op" id="7979108">,</span>&nbsp;<span class="num" id="7979110">6</span><span class="op" id="7979111">,</span>&nbsp;<span class="num" id="7979113">0</span><span class="op" id="7979114">,</span>&nbsp;<span class="ident" id="7979116">time</span><span class="op" id="7979120">.</span><span class="ident" id="7979121">UTC</span><span class="op" id="7979124">)</span><span class="op" id="7979125">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7979130">RawExpires</span><span class="op" id="7979140">:</span>&nbsp;<span class="string" id="7979142">&#34;Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT&#34;</span><span class="op" id="7979173">,</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7979178">HttpOnly</span><span class="op" id="7979186">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="7979190">true</span><span class="op" id="7979194">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7979199">Raw</span><span class="op" id="7979202">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7979211">&#34;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7979285">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7979289">}</span><span class="op" id="7979290">}</span><span class="op" id="7979291">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7979294">}</span><span class="op" id="7979295">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7979298">{</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7979302">Header</span><span class="op" id="7979308">{</span><span class="string" id="7979309">&#34;Set-Cookie&#34;</span><span class="op" id="7979321">:</span>&nbsp;<span class="op" id="7979323">{</span><span class="string" id="7979324">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7979365">}</span><span class="op" id="7979366">}</span><span class="op" id="7979367">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7979371">[</span><span class="op" id="7979372">]</span><span class="op" id="7979373">*</span><span class="ident" id="7979374">Cookie</span><span class="op" id="7979380">{</span><span class="op" id="7979381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7979386">Name</span><span class="op" id="7979390">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7979396">&#34;ASP.NET_SessionId&#34;</span><span class="op" id="7979415">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7979420">Value</span><span class="op" id="7979425">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7979430">&#34;foo&#34;</span><span class="op" id="7979435">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7979440">Path</span><span class="op" id="7979444">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7979450">&#34;/&#34;</span><span class="op" id="7979453">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7979458">HttpOnly</span><span class="op" id="7979466">:</span>&nbsp;<span class="ident" id="7979468">true</span><span class="op" id="7979472">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7979477">Raw</span><span class="op" id="7979480">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="7979487">&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly&#34;</span><span class="op" id="7979528">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7979532">}</span><span class="op" id="7979533">}</span><span class="op" id="7979534">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7979537">}</span><span class="op" id="7979538">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7979541">//&nbsp;Make&nbsp;sure&nbsp;we&nbsp;can&nbsp;properly&nbsp;read&nbsp;back&nbsp;the&nbsp;Set-Cookie&nbsp;headers&nbsp;we&nbsp;create</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7979614">//&nbsp;for&nbsp;values&nbsp;containing&nbsp;spaces&nbsp;or&nbsp;commas:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7979658">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7979662">Header</span><span class="op" id="7979668">{</span><span class="string" id="7979669">&#34;Set-Cookie&#34;</span><span class="op" id="7979681">:</span>&nbsp;<span class="op" id="7979683">{</span><span class="string" id="7979684">`special-1=a&nbsp;z`</span><span class="op" id="7979699">}</span><span class="op" id="7979700">}</span><span class="op" id="7979701">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7979705">[</span><span class="op" id="7979706">]</span><span class="op" id="7979707">*</span><span class="ident" id="7979708">Cookie</span><span class="op" id="7979714">{</span><span class="op" id="7979715">{</span><span class="ident" id="7979716">Name</span><span class="op" id="7979720">:</span>&nbsp;<span class="string" id="7979722">&#34;special-1&#34;</span><span class="op" id="7979733">,</span>&nbsp;<span class="ident" id="7979735">Value</span><span class="op" id="7979740">:</span>&nbsp;<span class="string" id="7979742">&#34;a&nbsp;z&#34;</span><span class="op" id="7979747">,</span>&nbsp;<span class="ident" id="7979749">Raw</span><span class="op" id="7979752">:</span>&nbsp;<span class="string" id="7979754">`special-1=a&nbsp;z`</span><span class="op" id="7979769">}</span><span class="op" id="7979770">}</span><span class="op" id="7979771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7979774">}</span><span class="op" id="7979775">,</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7979778">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7979782">Header</span><span class="op" id="7979788">{</span><span class="string" id="7979789">&#34;Set-Cookie&#34;</span><span class="op" id="7979801">:</span>&nbsp;<span class="op" id="7979803">{</span><span class="string" id="7979804">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7979820">}</span><span class="op" id="7979821">}</span><span class="op" id="7979822">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7979826">[</span><span class="op" id="7979827">]</span><span class="op" id="7979828">*</span><span class="ident" id="7979829">Cookie</span><span class="op" id="7979835">{</span><span class="op" id="7979836">{</span><span class="ident" id="7979837">Name</span><span class="op" id="7979841">:</span>&nbsp;<span class="string" id="7979843">&#34;special-2&#34;</span><span class="op" id="7979854">,</span>&nbsp;<span class="ident" id="7979856">Value</span><span class="op" id="7979861">:</span>&nbsp;<span class="string" id="7979863">&#34;&nbsp;z&#34;</span><span class="op" id="7979867">,</span>&nbsp;<span class="ident" id="7979869">Raw</span><span class="op" id="7979872">:</span>&nbsp;<span class="string" id="7979874">`special-2=&#34;&nbsp;z&#34;`</span><span class="op" id="7979890">}</span><span class="op" id="7979891">}</span><span class="op" id="7979892">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7979895">}</span><span class="op" id="7979896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7979899">{</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7979903">Header</span><span class="op" id="7979909">{</span><span class="string" id="7979910">&#34;Set-Cookie&#34;</span><span class="op" id="7979922">:</span>&nbsp;<span class="op" id="7979924">{</span><span class="string" id="7979925">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7979941">}</span><span class="op" id="7979942">}</span><span class="op" id="7979943">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7979947">[</span><span class="op" id="7979948">]</span><span class="op" id="7979949">*</span><span class="ident" id="7979950">Cookie</span><span class="op" id="7979956">{</span><span class="op" id="7979957">{</span><span class="ident" id="7979958">Name</span><span class="op" id="7979962">:</span>&nbsp;<span class="string" id="7979964">&#34;special-3&#34;</span><span class="op" id="7979975">,</span>&nbsp;<span class="ident" id="7979977">Value</span><span class="op" id="7979982">:</span>&nbsp;<span class="string" id="7979984">&#34;a&nbsp;&#34;</span><span class="op" id="7979988">,</span>&nbsp;<span class="ident" id="7979990">Raw</span><span class="op" id="7979993">:</span>&nbsp;<span class="string" id="7979995">`special-3=&#34;a&nbsp;&#34;`</span><span class="op" id="7980011">}</span><span class="op" id="7980012">}</span><span class="op" id="7980013">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7980016">}</span><span class="op" id="7980017">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7980020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7980024">Header</span><span class="op" id="7980030">{</span><span class="string" id="7980031">&#34;Set-Cookie&#34;</span><span class="op" id="7980043">:</span>&nbsp;<span class="op" id="7980045">{</span><span class="string" id="7980046">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7980061">}</span><span class="op" id="7980062">}</span><span class="op" id="7980063">,</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7980067">[</span><span class="op" id="7980068">]</span><span class="op" id="7980069">*</span><span class="ident" id="7980070">Cookie</span><span class="op" id="7980076">{</span><span class="op" id="7980077">{</span><span class="ident" id="7980078">Name</span><span class="op" id="7980082">:</span>&nbsp;<span class="string" id="7980084">&#34;special-4&#34;</span><span class="op" id="7980095">,</span>&nbsp;<span class="ident" id="7980097">Value</span><span class="op" id="7980102">:</span>&nbsp;<span class="string" id="7980104">&#34;&nbsp;&#34;</span><span class="op" id="7980107">,</span>&nbsp;<span class="ident" id="7980109">Raw</span><span class="op" id="7980112">:</span>&nbsp;<span class="string" id="7980114">`special-4=&#34;&nbsp;&#34;`</span><span class="op" id="7980129">}</span><span class="op" id="7980130">}</span><span class="op" id="7980131">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7980134">}</span><span class="op" id="7980135">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7980138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7980142">Header</span><span class="op" id="7980148">{</span><span class="string" id="7980149">&#34;Set-Cookie&#34;</span><span class="op" id="7980161">:</span>&nbsp;<span class="op" id="7980163">{</span><span class="string" id="7980164">`special-5=a,z`</span><span class="op" id="7980179">}</span><span class="op" id="7980180">}</span><span class="op" id="7980181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7980185">[</span><span class="op" id="7980186">]</span><span class="op" id="7980187">*</span><span class="ident" id="7980188">Cookie</span><span class="op" id="7980194">{</span><span class="op" id="7980195">{</span><span class="ident" id="7980196">Name</span><span class="op" id="7980200">:</span>&nbsp;<span class="string" id="7980202">&#34;special-5&#34;</span><span class="op" id="7980213">,</span>&nbsp;<span class="ident" id="7980215">Value</span><span class="op" id="7980220">:</span>&nbsp;<span class="string" id="7980222">&#34;a,z&#34;</span><span class="op" id="7980227">,</span>&nbsp;<span class="ident" id="7980229">Raw</span><span class="op" id="7980232">:</span>&nbsp;<span class="string" id="7980234">`special-5=a,z`</span><span class="op" id="7980249">}</span><span class="op" id="7980250">}</span><span class="op" id="7980251">,</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7980254">}</span><span class="op" id="7980255">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7980258">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7980262">Header</span><span class="op" id="7980268">{</span><span class="string" id="7980269">&#34;Set-Cookie&#34;</span><span class="op" id="7980281">:</span>&nbsp;<span class="op" id="7980283">{</span><span class="string" id="7980284">`special-6=&#34;,z&#34;`</span><span class="op" id="7980300">}</span><span class="op" id="7980301">}</span><span class="op" id="7980302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7980306">[</span><span class="op" id="7980307">]</span><span class="op" id="7980308">*</span><span class="ident" id="7980309">Cookie</span><span class="op" id="7980315">{</span><span class="op" id="7980316">{</span><span class="ident" id="7980317">Name</span><span class="op" id="7980321">:</span>&nbsp;<span class="string" id="7980323">&#34;special-6&#34;</span><span class="op" id="7980334">,</span>&nbsp;<span class="ident" id="7980336">Value</span><span class="op" id="7980341">:</span>&nbsp;<span class="string" id="7980343">&#34;,z&#34;</span><span class="op" id="7980347">,</span>&nbsp;<span class="ident" id="7980349">Raw</span><span class="op" id="7980352">:</span>&nbsp;<span class="string" id="7980354">`special-6=&#34;,z&#34;`</span><span class="op" id="7980370">}</span><span class="op" id="7980371">}</span><span class="op" id="7980372">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7980375">}</span><span class="op" id="7980376">,</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7980379">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7980383">Header</span><span class="op" id="7980389">{</span><span class="string" id="7980390">&#34;Set-Cookie&#34;</span><span class="op" id="7980402">:</span>&nbsp;<span class="op" id="7980404">{</span><span class="string" id="7980405">`special-7=a,`</span><span class="op" id="7980419">}</span><span class="op" id="7980420">}</span><span class="op" id="7980421">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7980425">[</span><span class="op" id="7980426">]</span><span class="op" id="7980427">*</span><span class="ident" id="7980428">Cookie</span><span class="op" id="7980434">{</span><span class="op" id="7980435">{</span><span class="ident" id="7980436">Name</span><span class="op" id="7980440">:</span>&nbsp;<span class="string" id="7980442">&#34;special-7&#34;</span><span class="op" id="7980453">,</span>&nbsp;<span class="ident" id="7980455">Value</span><span class="op" id="7980460">:</span>&nbsp;<span class="string" id="7980462">&#34;a,&#34;</span><span class="op" id="7980466">,</span>&nbsp;<span class="ident" id="7980468">Raw</span><span class="op" id="7980471">:</span>&nbsp;<span class="string" id="7980473">`special-7=a,`</span><span class="op" id="7980487">}</span><span class="op" id="7980488">}</span><span class="op" id="7980489">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7980492">}</span><span class="op" id="7980493">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7980496">{</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7980500">Header</span><span class="op" id="7980506">{</span><span class="string" id="7980507">&#34;Set-Cookie&#34;</span><span class="op" id="7980519">:</span>&nbsp;<span class="op" id="7980521">{</span><span class="string" id="7980522">`special-8=&#34;,&#34;`</span><span class="op" id="7980537">}</span><span class="op" id="7980538">}</span><span class="op" id="7980539">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7980543">[</span><span class="op" id="7980544">]</span><span class="op" id="7980545">*</span><span class="ident" id="7980546">Cookie</span><span class="op" id="7980552">{</span><span class="op" id="7980553">{</span><span class="ident" id="7980554">Name</span><span class="op" id="7980558">:</span>&nbsp;<span class="string" id="7980560">&#34;special-8&#34;</span><span class="op" id="7980571">,</span>&nbsp;<span class="ident" id="7980573">Value</span><span class="op" id="7980578">:</span>&nbsp;<span class="string" id="7980580">&#34;,&#34;</span><span class="op" id="7980583">,</span>&nbsp;<span class="ident" id="7980585">Raw</span><span class="op" id="7980588">:</span>&nbsp;<span class="string" id="7980590">`special-8=&#34;,&#34;`</span><span class="op" id="7980605">}</span><span class="op" id="7980606">}</span><span class="op" id="7980607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7980610">}</span><span class="op" id="7980611">,</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7980615">//&nbsp;TODO(bradfitz):&nbsp;users&nbsp;have&nbsp;reported&nbsp;seeing&nbsp;this&nbsp;in&nbsp;the</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7980674">//&nbsp;wild,&nbsp;but&nbsp;do&nbsp;browsers&nbsp;handle&nbsp;it?&nbsp;RFC&nbsp;6265&nbsp;just&nbsp;says&nbsp;&#34;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7980737">//&nbsp;do&nbsp;that&#34;&nbsp;(section&nbsp;3)&nbsp;and&nbsp;then&nbsp;never&nbsp;mentions&nbsp;header&nbsp;folding</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7980801">//&nbsp;again.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="7980812">//&nbsp;Header{&#34;Set-Cookie&#34;:&nbsp;{&#34;ASP.NET_SessionId=foo;&nbsp;path=/;&nbsp;HttpOnly,&nbsp;.ASPXAUTH=7E3AA;&nbsp;expires=Wed,&nbsp;07-Mar-2012&nbsp;14:25:06&nbsp;GMT;&nbsp;path=/;&nbsp;HttpOnly&#34;}},</span><br>
<span class="lineno"></span><span class="op" id="7980956">}</span><br>
<span class="lineno">260</span><br>
<span class="lineno"></span><span class="keyword" id="7980959">func</span>&nbsp;<span class="ident" id="7980964">toJSON</span><span class="op" id="7980970">(</span><span class="ident" id="7980971">v</span>&nbsp;<span class="keyword" id="7980973">interface</span><span class="op" id="7980982">{</span><span class="op" id="7980983">}</span><span class="op" id="7980984">)</span>&nbsp;<span class="builtintype" id="7980986">string</span>&nbsp;<span class="op" id="7980993">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7980996">b</span><span class="op" id="7980997">,</span>&nbsp;<span class="ident" id="7980999">err</span>&nbsp;<span class="op" id="7981003">:=</span>&nbsp;<span class="ident" id="7981006">json</span><span class="op" id="7981010">.</span><span class="ident" id="7981011">Marshal</span><span class="op" id="7981018">(</span><span class="ident" id="7981019">v</span><span class="op" id="7981020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7981023">if</span>&nbsp;<span class="ident" id="7981026">err</span>&nbsp;<span class="op" id="7981030">!=</span>&nbsp;<span class="ident" id="7981033">nil</span>&nbsp;<span class="op" id="7981037">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7981041">return</span>&nbsp;<span class="ident" id="7981048">fmt</span><span class="op" id="7981051">.</span><span class="ident" id="7981052">Sprintf</span><span class="op" id="7981059">(</span><span class="string" id="7981060">&#34;%#v&#34;</span><span class="op" id="7981065">,</span>&nbsp;<span class="ident" id="7981067">v</span><span class="op" id="7981068">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981071">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7981074">return</span>&nbsp;<span class="builtintype" id="7981081">string</span><span class="op" id="7981087">(</span><span class="ident" id="7981088">b</span><span class="op" id="7981089">)</span><br>
<span class="lineno"></span><span class="op" id="7981091">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7981094">func</span>&nbsp;<span class="ident" id="7981099">TestReadSetCookies</span><span class="op" id="7981117">(</span><span class="ident" id="7981118">t</span>&nbsp;<span class="op" id="7981120">*</span><span class="ident" id="7981121">testing</span><span class="op" id="7981128">.</span><span class="ident" id="7981129">T</span><span class="op" id="7981130">)</span>&nbsp;<span class="op" id="7981132">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7981135">for</span>&nbsp;<span class="ident" id="7981139">i</span><span class="op" id="7981140">,</span>&nbsp;<span class="ident" id="7981142">tt</span>&nbsp;<span class="op" id="7981145">:=</span>&nbsp;<span class="keyword" id="7981148">range</span>&nbsp;<span class="ident" id="7981154">readSetCookiesTests</span>&nbsp;<span class="op" id="7981174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7981178">for</span>&nbsp;<span class="ident" id="7981182">n</span>&nbsp;<span class="op" id="7981184">:=</span>&nbsp;<span class="num" id="7981187">0</span><span class="op" id="7981188">;</span>&nbsp;<span class="ident" id="7981190">n</span>&nbsp;<span class="op" id="7981192">&lt;</span>&nbsp;<span class="num" id="7981194">2</span><span class="op" id="7981195">;</span>&nbsp;<span class="ident" id="7981197">n</span><span class="op" id="7981198">++</span>&nbsp;<span class="op" id="7981201">{</span>&nbsp;<span class="comment" id="7981203">//&nbsp;to&nbsp;verify&nbsp;readSetCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7981259">c</span>&nbsp;<span class="op" id="7981261">:=</span>&nbsp;<span class="ident" id="7981264">readSetCookies</span><span class="op" id="7981278">(</span><span class="ident" id="7981279">tt</span><span class="op" id="7981281">.</span><span class="ident" id="7981282">Header</span><span class="op" id="7981288">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7981293">if</span>&nbsp;<span class="op" id="7981296">!</span><span class="ident" id="7981297">reflect</span><span class="op" id="7981304">.</span><span class="ident" id="7981305">DeepEqual</span><span class="op" id="7981314">(</span><span class="ident" id="7981315">c</span><span class="op" id="7981316">,</span>&nbsp;<span class="ident" id="7981318">tt</span><span class="op" id="7981320">.</span><span class="ident" id="7981321">Cookies</span><span class="op" id="7981328">)</span>&nbsp;<span class="op" id="7981330">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7981336">t</span><span class="op" id="7981337">.</span><span class="ident" id="7981338">Errorf</span><span class="op" id="7981344">(</span><span class="string" id="7981345">&#34;#%d&nbsp;readSetCookies:&nbsp;have\n%s\nwant\n%s\n&#34;</span><span class="op" id="7981387">,</span>&nbsp;<span class="ident" id="7981389">i</span><span class="op" id="7981390">,</span>&nbsp;<span class="ident" id="7981392">toJSON</span><span class="op" id="7981398">(</span><span class="ident" id="7981399">c</span><span class="op" id="7981400">)</span><span class="op" id="7981401">,</span>&nbsp;<span class="ident" id="7981403">toJSON</span><span class="op" id="7981409">(</span><span class="ident" id="7981410">tt</span><span class="op" id="7981412">.</span><span class="ident" id="7981413">Cookies</span><span class="op" id="7981420">)</span><span class="op" id="7981421">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7981427">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981446">}</span><br>
<span class="lineno"></span><span class="op" id="7981448">}</span><br>
<span class="lineno">280</span><br>
<span class="lineno"></span><span class="keyword" id="7981451">var</span>&nbsp;<span class="ident" id="7981455">readCookiesTests</span>&nbsp;<span class="op" id="7981472">=</span>&nbsp;<span class="op" id="7981474">[</span><span class="op" id="7981475">]</span><span class="keyword" id="7981476">struct</span>&nbsp;<span class="op" id="7981483">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7981486">Header</span>&nbsp;&nbsp;<span class="ident" id="7981494">Header</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7981502">Filter</span>&nbsp;&nbsp;<span class="builtintype" id="7981510">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7981518">Cookies</span>&nbsp;<span class="op" id="7981526">[</span><span class="op" id="7981527">]</span><span class="op" id="7981528">*</span><span class="ident" id="7981529">Cookie</span><br>
<span class="lineno">285</span><span class="op" id="7981536">}</span><span class="op" id="7981537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981540">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7981544">Header</span><span class="op" id="7981550">{</span><span class="string" id="7981551">&#34;Cookie&#34;</span><span class="op" id="7981559">:</span>&nbsp;<span class="op" id="7981561">{</span><span class="string" id="7981562">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7981576">,</span>&nbsp;<span class="string" id="7981578">&#34;c2=v2&#34;</span><span class="op" id="7981585">}</span><span class="op" id="7981586">}</span><span class="op" id="7981587">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7981591">&#34;&#34;</span><span class="op" id="7981593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981597">[</span><span class="op" id="7981598">]</span><span class="op" id="7981599">*</span><span class="ident" id="7981600">Cookie</span><span class="op" id="7981606">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981611">{</span><span class="ident" id="7981612">Name</span><span class="op" id="7981616">:</span>&nbsp;<span class="string" id="7981618">&#34;Cookie-1&#34;</span><span class="op" id="7981628">,</span>&nbsp;<span class="ident" id="7981630">Value</span><span class="op" id="7981635">:</span>&nbsp;<span class="string" id="7981637">&#34;v$1&#34;</span><span class="op" id="7981642">}</span><span class="op" id="7981643">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981648">{</span><span class="ident" id="7981649">Name</span><span class="op" id="7981653">:</span>&nbsp;<span class="string" id="7981655">&#34;c2&#34;</span><span class="op" id="7981659">,</span>&nbsp;<span class="ident" id="7981661">Value</span><span class="op" id="7981666">:</span>&nbsp;<span class="string" id="7981668">&#34;v2&#34;</span><span class="op" id="7981672">}</span><span class="op" id="7981673">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981677">}</span><span class="op" id="7981678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981681">}</span><span class="op" id="7981682">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981685">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7981689">Header</span><span class="op" id="7981695">{</span><span class="string" id="7981696">&#34;Cookie&#34;</span><span class="op" id="7981704">:</span>&nbsp;<span class="op" id="7981706">{</span><span class="string" id="7981707">&#34;Cookie-1=v$1&#34;</span><span class="op" id="7981721">,</span>&nbsp;<span class="string" id="7981723">&#34;c2=v2&#34;</span><span class="op" id="7981730">}</span><span class="op" id="7981731">}</span><span class="op" id="7981732">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7981736">&#34;c2&#34;</span><span class="op" id="7981740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981744">[</span><span class="op" id="7981745">]</span><span class="op" id="7981746">*</span><span class="ident" id="7981747">Cookie</span><span class="op" id="7981753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981758">{</span><span class="ident" id="7981759">Name</span><span class="op" id="7981763">:</span>&nbsp;<span class="string" id="7981765">&#34;c2&#34;</span><span class="op" id="7981769">,</span>&nbsp;<span class="ident" id="7981771">Value</span><span class="op" id="7981776">:</span>&nbsp;<span class="string" id="7981778">&#34;v2&#34;</span><span class="op" id="7981782">}</span><span class="op" id="7981783">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981787">}</span><span class="op" id="7981788">,</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981791">}</span><span class="op" id="7981792">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981795">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7981799">Header</span><span class="op" id="7981805">{</span><span class="string" id="7981806">&#34;Cookie&#34;</span><span class="op" id="7981814">:</span>&nbsp;<span class="op" id="7981816">{</span><span class="string" id="7981817">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="7981838">}</span><span class="op" id="7981839">}</span><span class="op" id="7981840">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7981844">&#34;&#34;</span><span class="op" id="7981846">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981850">[</span><span class="op" id="7981851">]</span><span class="op" id="7981852">*</span><span class="ident" id="7981853">Cookie</span><span class="op" id="7981859">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981864">{</span><span class="ident" id="7981865">Name</span><span class="op" id="7981869">:</span>&nbsp;<span class="string" id="7981871">&#34;Cookie-1&#34;</span><span class="op" id="7981881">,</span>&nbsp;<span class="ident" id="7981883">Value</span><span class="op" id="7981888">:</span>&nbsp;<span class="string" id="7981890">&#34;v$1&#34;</span><span class="op" id="7981895">}</span><span class="op" id="7981896">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981901">{</span><span class="ident" id="7981902">Name</span><span class="op" id="7981906">:</span>&nbsp;<span class="string" id="7981908">&#34;c2&#34;</span><span class="op" id="7981912">,</span>&nbsp;<span class="ident" id="7981914">Value</span><span class="op" id="7981919">:</span>&nbsp;<span class="string" id="7981921">&#34;v2&#34;</span><span class="op" id="7981925">}</span><span class="op" id="7981926">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981930">}</span><span class="op" id="7981931">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981934">}</span><span class="op" id="7981935">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981938">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7981942">Header</span><span class="op" id="7981948">{</span><span class="string" id="7981949">&#34;Cookie&#34;</span><span class="op" id="7981957">:</span>&nbsp;<span class="op" id="7981959">{</span><span class="string" id="7981960">&#34;Cookie-1=v$1;&nbsp;c2=v2&#34;</span><span class="op" id="7981981">}</span><span class="op" id="7981982">}</span><span class="op" id="7981983">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7981987">&#34;c2&#34;</span><span class="op" id="7981991">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7981995">[</span><span class="op" id="7981996">]</span><span class="op" id="7981997">*</span><span class="ident" id="7981998">Cookie</span><span class="op" id="7982004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7982009">{</span><span class="ident" id="7982010">Name</span><span class="op" id="7982014">:</span>&nbsp;<span class="string" id="7982016">&#34;c2&#34;</span><span class="op" id="7982020">,</span>&nbsp;<span class="ident" id="7982022">Value</span><span class="op" id="7982027">:</span>&nbsp;<span class="string" id="7982029">&#34;v2&#34;</span><span class="op" id="7982033">}</span><span class="op" id="7982034">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7982038">}</span><span class="op" id="7982039">,</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7982042">}</span><span class="op" id="7982043">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7982046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7982050">Header</span><span class="op" id="7982056">{</span><span class="string" id="7982057">&#34;Cookie&#34;</span><span class="op" id="7982065">:</span>&nbsp;<span class="op" id="7982067">{</span><span class="string" id="7982068">`Cookie-1=&#34;v$1&#34;;&nbsp;c2=&#34;v2&#34;`</span><span class="op" id="7982093">}</span><span class="op" id="7982094">}</span><span class="op" id="7982095">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="7982099">&#34;&#34;</span><span class="op" id="7982101">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7982105">[</span><span class="op" id="7982106">]</span><span class="op" id="7982107">*</span><span class="ident" id="7982108">Cookie</span><span class="op" id="7982114">{</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7982119">{</span><span class="ident" id="7982120">Name</span><span class="op" id="7982124">:</span>&nbsp;<span class="string" id="7982126">&#34;Cookie-1&#34;</span><span class="op" id="7982136">,</span>&nbsp;<span class="ident" id="7982138">Value</span><span class="op" id="7982143">:</span>&nbsp;<span class="string" id="7982145">&#34;v$1&#34;</span><span class="op" id="7982150">}</span><span class="op" id="7982151">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7982156">{</span><span class="ident" id="7982157">Name</span><span class="op" id="7982161">:</span>&nbsp;<span class="string" id="7982163">&#34;c2&#34;</span><span class="op" id="7982167">,</span>&nbsp;<span class="ident" id="7982169">Value</span><span class="op" id="7982174">:</span>&nbsp;<span class="string" id="7982176">&#34;v2&#34;</span><span class="op" id="7982180">}</span><span class="op" id="7982181">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7982185">}</span><span class="op" id="7982186">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7982189">}</span><span class="op" id="7982190">,</span><br>
<span class="lineno"></span><span class="op" id="7982192">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="keyword" id="7982195">func</span>&nbsp;<span class="ident" id="7982200">TestReadCookies</span><span class="op" id="7982215">(</span><span class="ident" id="7982216">t</span>&nbsp;<span class="op" id="7982218">*</span><span class="ident" id="7982219">testing</span><span class="op" id="7982226">.</span><span class="ident" id="7982227">T</span><span class="op" id="7982228">)</span>&nbsp;<span class="op" id="7982230">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7982233">for</span>&nbsp;<span class="ident" id="7982237">i</span><span class="op" id="7982238">,</span>&nbsp;<span class="ident" id="7982240">tt</span>&nbsp;<span class="op" id="7982243">:=</span>&nbsp;<span class="keyword" id="7982246">range</span>&nbsp;<span class="ident" id="7982252">readCookiesTests</span>&nbsp;<span class="op" id="7982269">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7982273">for</span>&nbsp;<span class="ident" id="7982277">n</span>&nbsp;<span class="op" id="7982279">:=</span>&nbsp;<span class="num" id="7982282">0</span><span class="op" id="7982283">;</span>&nbsp;<span class="ident" id="7982285">n</span>&nbsp;<span class="op" id="7982287">&lt;</span>&nbsp;<span class="num" id="7982289">2</span><span class="op" id="7982290">;</span>&nbsp;<span class="ident" id="7982292">n</span><span class="op" id="7982293">++</span>&nbsp;<span class="op" id="7982296">{</span>&nbsp;<span class="comment" id="7982298">//&nbsp;to&nbsp;verify&nbsp;readCookies&nbsp;doesn&#39;t&nbsp;mutate&nbsp;its&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7982351">c</span>&nbsp;<span class="op" id="7982353">:=</span>&nbsp;<span class="ident" id="7982356">readCookies</span><span class="op" id="7982367">(</span><span class="ident" id="7982368">tt</span><span class="op" id="7982370">.</span><span class="ident" id="7982371">Header</span><span class="op" id="7982377">,</span>&nbsp;<span class="ident" id="7982379">tt</span><span class="op" id="7982381">.</span><span class="ident" id="7982382">Filter</span><span class="op" id="7982388">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7982393">if</span>&nbsp;<span class="op" id="7982396">!</span><span class="ident" id="7982397">reflect</span><span class="op" id="7982404">.</span><span class="ident" id="7982405">DeepEqual</span><span class="op" id="7982414">(</span><span class="ident" id="7982415">c</span><span class="op" id="7982416">,</span>&nbsp;<span class="ident" id="7982418">tt</span><span class="op" id="7982420">.</span><span class="ident" id="7982421">Cookies</span><span class="op" id="7982428">)</span>&nbsp;<span class="op" id="7982430">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7982436">t</span><span class="op" id="7982437">.</span><span class="ident" id="7982438">Errorf</span><span class="op" id="7982444">(</span><span class="string" id="7982445">&#34;#%d&nbsp;readCookies:\nhave:&nbsp;%s\nwant:&nbsp;%s\n&#34;</span><span class="op" id="7982485">,</span>&nbsp;<span class="ident" id="7982487">i</span><span class="op" id="7982488">,</span>&nbsp;<span class="ident" id="7982490">toJSON</span><span class="op" id="7982496">(</span><span class="ident" id="7982497">c</span><span class="op" id="7982498">)</span><span class="op" id="7982499">,</span>&nbsp;<span class="ident" id="7982501">toJSON</span><span class="op" id="7982507">(</span><span class="ident" id="7982508">tt</span><span class="op" id="7982510">.</span><span class="ident" id="7982511">Cookies</span><span class="op" id="7982518">)</span><span class="op" id="7982519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7982525">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7982537">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7982541">}</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7982544">}</span><br>
<span class="lineno"></span><span class="op" id="7982546">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7982549">func</span>&nbsp;<span class="ident" id="7982554">TestSetCookieDoubleQuotes</span><span class="op" id="7982579">(</span><span class="ident" id="7982580">t</span>&nbsp;<span class="op" id="7982582">*</span><span class="ident" id="7982583">testing</span><span class="op" id="7982590">.</span><span class="ident" id="7982591">T</span><span class="op" id="7982592">)</span>&nbsp;<span class="op" id="7982594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7982597">res</span>&nbsp;<span class="op" id="7982601">:=</span>&nbsp;<span class="op" id="7982604">&amp;</span><span class="ident" id="7982605">Response</span><span class="op" id="7982613">{</span><span class="ident" id="7982614">Header</span><span class="op" id="7982620">:</span>&nbsp;<span class="ident" id="7982622">Header</span><span class="op" id="7982628">{</span><span class="op" id="7982629">}</span><span class="op" id="7982630">}</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7982633">res</span><span class="op" id="7982636">.</span><span class="ident" id="7982637">Header</span><span class="op" id="7982643">.</span><span class="ident" id="7982644">Add</span><span class="op" id="7982647">(</span><span class="string" id="7982648">&#34;Set-Cookie&#34;</span><span class="op" id="7982660">,</span>&nbsp;<span class="string" id="7982662">`quoted0=none;&nbsp;max-age=30`</span><span class="op" id="7982688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7982691">res</span><span class="op" id="7982694">.</span><span class="ident" id="7982695">Header</span><span class="op" id="7982701">.</span><span class="ident" id="7982702">Add</span><span class="op" id="7982705">(</span><span class="string" id="7982706">&#34;Set-Cookie&#34;</span><span class="op" id="7982718">,</span>&nbsp;<span class="string" id="7982720">`quoted1=&#34;cookieValue&#34;;&nbsp;max-age=31`</span><span class="op" id="7982755">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7982758">res</span><span class="op" id="7982761">.</span><span class="ident" id="7982762">Header</span><span class="op" id="7982768">.</span><span class="ident" id="7982769">Add</span><span class="op" id="7982772">(</span><span class="string" id="7982773">&#34;Set-Cookie&#34;</span><span class="op" id="7982785">,</span>&nbsp;<span class="string" id="7982787">`quoted2=cookieAV;&nbsp;max-age=&#34;32&#34;`</span><span class="op" id="7982819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7982822">res</span><span class="op" id="7982825">.</span><span class="ident" id="7982826">Header</span><span class="op" id="7982832">.</span><span class="ident" id="7982833">Add</span><span class="op" id="7982836">(</span><span class="string" id="7982837">&#34;Set-Cookie&#34;</span><span class="op" id="7982849">,</span>&nbsp;<span class="string" id="7982851">`quoted3=&#34;both&#34;;&nbsp;max-age=&#34;33&#34;`</span><span class="op" id="7982881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7982884">got</span>&nbsp;<span class="op" id="7982888">:=</span>&nbsp;<span class="ident" id="7982891">res</span><span class="op" id="7982894">.</span><span class="ident" id="7982895">Cookies</span><span class="op" id="7982902">(</span><span class="op" id="7982903">)</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7982906">want</span>&nbsp;<span class="op" id="7982911">:=</span>&nbsp;<span class="op" id="7982914">[</span><span class="op" id="7982915">]</span><span class="op" id="7982916">*</span><span class="ident" id="7982917">Cookie</span><span class="op" id="7982923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7982927">{</span><span class="ident" id="7982928">Name</span><span class="op" id="7982932">:</span>&nbsp;<span class="string" id="7982934">&#34;quoted0&#34;</span><span class="op" id="7982943">,</span>&nbsp;<span class="ident" id="7982945">Value</span><span class="op" id="7982950">:</span>&nbsp;<span class="string" id="7982952">&#34;none&#34;</span><span class="op" id="7982958">,</span>&nbsp;<span class="ident" id="7982960">MaxAge</span><span class="op" id="7982966">:</span>&nbsp;<span class="num" id="7982968">30</span><span class="op" id="7982970">}</span><span class="op" id="7982971">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7982975">{</span><span class="ident" id="7982976">Name</span><span class="op" id="7982980">:</span>&nbsp;<span class="string" id="7982982">&#34;quoted1&#34;</span><span class="op" id="7982991">,</span>&nbsp;<span class="ident" id="7982993">Value</span><span class="op" id="7982998">:</span>&nbsp;<span class="string" id="7983000">&#34;cookieValue&#34;</span><span class="op" id="7983013">,</span>&nbsp;<span class="ident" id="7983015">MaxAge</span><span class="op" id="7983021">:</span>&nbsp;<span class="num" id="7983023">31</span><span class="op" id="7983025">}</span><span class="op" id="7983026">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983030">{</span><span class="ident" id="7983031">Name</span><span class="op" id="7983035">:</span>&nbsp;<span class="string" id="7983037">&#34;quoted2&#34;</span><span class="op" id="7983046">,</span>&nbsp;<span class="ident" id="7983048">Value</span><span class="op" id="7983053">:</span>&nbsp;<span class="string" id="7983055">&#34;cookieAV&#34;</span><span class="op" id="7983065">}</span><span class="op" id="7983066">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983070">{</span><span class="ident" id="7983071">Name</span><span class="op" id="7983075">:</span>&nbsp;<span class="string" id="7983077">&#34;quoted3&#34;</span><span class="op" id="7983086">,</span>&nbsp;<span class="ident" id="7983088">Value</span><span class="op" id="7983093">:</span>&nbsp;<span class="string" id="7983095">&#34;both&#34;</span><span class="op" id="7983101">}</span><span class="op" id="7983102">,</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7983108">if</span>&nbsp;<span class="builtinfunc" id="7983111">len</span><span class="op" id="7983114">(</span><span class="ident" id="7983115">got</span><span class="op" id="7983118">)</span>&nbsp;<span class="op" id="7983120">!=</span>&nbsp;<span class="builtinfunc" id="7983123">len</span><span class="op" id="7983126">(</span><span class="ident" id="7983127">want</span><span class="op" id="7983131">)</span>&nbsp;<span class="op" id="7983133">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7983137">t</span><span class="op" id="7983138">.</span><span class="ident" id="7983139">Fatal</span><span class="op" id="7983144">(</span><span class="string" id="7983145">&#34;got&nbsp;%d&nbsp;cookies,&nbsp;want&nbsp;%d&#34;</span><span class="op" id="7983170">,</span>&nbsp;<span class="builtinfunc" id="7983172">len</span><span class="op" id="7983175">(</span><span class="ident" id="7983176">got</span><span class="op" id="7983179">)</span><span class="op" id="7983180">,</span>&nbsp;<span class="builtinfunc" id="7983182">len</span><span class="op" id="7983185">(</span><span class="ident" id="7983186">want</span><span class="op" id="7983190">)</span><span class="op" id="7983191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983194">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7983197">for</span>&nbsp;<span class="ident" id="7983201">i</span><span class="op" id="7983202">,</span>&nbsp;<span class="ident" id="7983204">w</span>&nbsp;<span class="op" id="7983206">:=</span>&nbsp;<span class="keyword" id="7983209">range</span>&nbsp;<span class="ident" id="7983215">want</span>&nbsp;<span class="op" id="7983220">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7983224">g</span>&nbsp;<span class="op" id="7983226">:=</span>&nbsp;<span class="ident" id="7983229">got</span><span class="op" id="7983232">[</span><span class="ident" id="7983233">i</span><span class="op" id="7983234">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7983238">if</span>&nbsp;<span class="ident" id="7983241">g</span><span class="op" id="7983242">.</span><span class="ident" id="7983243">Name</span>&nbsp;<span class="op" id="7983248">!=</span>&nbsp;<span class="ident" id="7983251">w</span><span class="op" id="7983252">.</span><span class="ident" id="7983253">Name</span>&nbsp;<span class="op" id="7983258">||</span>&nbsp;<span class="ident" id="7983261">g</span><span class="op" id="7983262">.</span><span class="ident" id="7983263">Value</span>&nbsp;<span class="op" id="7983269">!=</span>&nbsp;<span class="ident" id="7983272">w</span><span class="op" id="7983273">.</span><span class="ident" id="7983274">Value</span>&nbsp;<span class="op" id="7983280">||</span>&nbsp;<span class="ident" id="7983283">g</span><span class="op" id="7983284">.</span><span class="ident" id="7983285">MaxAge</span>&nbsp;<span class="op" id="7983292">!=</span>&nbsp;<span class="ident" id="7983295">w</span><span class="op" id="7983296">.</span><span class="ident" id="7983297">MaxAge</span>&nbsp;<span class="op" id="7983304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7983309">t</span><span class="op" id="7983310">.</span><span class="ident" id="7983311">Errorf</span><span class="op" id="7983317">(</span><span class="string" id="7983318">&#34;cookie&nbsp;#%d:\ngot&nbsp;&nbsp;%v\nwant&nbsp;%v&#34;</span><span class="op" id="7983349">,</span>&nbsp;<span class="ident" id="7983351">i</span><span class="op" id="7983352">,</span>&nbsp;<span class="ident" id="7983354">g</span><span class="op" id="7983355">,</span>&nbsp;<span class="ident" id="7983357">w</span><span class="op" id="7983358">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983362">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983365">}</span><br>
<span class="lineno">360</span><span class="op" id="7983367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="7983370">func</span>&nbsp;<span class="ident" id="7983375">TestCookieSanitizeValue</span><span class="op" id="7983398">(</span><span class="ident" id="7983399">t</span>&nbsp;<span class="op" id="7983401">*</span><span class="ident" id="7983402">testing</span><span class="op" id="7983409">.</span><span class="ident" id="7983410">T</span><span class="op" id="7983411">)</span>&nbsp;<span class="op" id="7983413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7983416">defer</span>&nbsp;<span class="ident" id="7983422">log</span><span class="op" id="7983425">.</span><span class="ident" id="7983426">SetOutput</span><span class="op" id="7983435">(</span><span class="ident" id="7983436">os</span><span class="op" id="7983438">.</span><span class="ident" id="7983439">Stderr</span><span class="op" id="7983445">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7983448">var</span>&nbsp;<span class="ident" id="7983452">logbuf</span>&nbsp;<span class="ident" id="7983459">bytes</span><span class="op" id="7983464">.</span><span class="ident" id="7983465">Buffer</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7983473">log</span><span class="op" id="7983476">.</span><span class="ident" id="7983477">SetOutput</span><span class="op" id="7983486">(</span><span class="op" id="7983487">&amp;</span><span class="ident" id="7983488">logbuf</span><span class="op" id="7983494">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7983498">tests</span>&nbsp;<span class="op" id="7983504">:=</span>&nbsp;<span class="op" id="7983507">[</span><span class="op" id="7983508">]</span><span class="keyword" id="7983509">struct</span>&nbsp;<span class="op" id="7983516">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7983520">in</span><span class="op" id="7983522">,</span>&nbsp;<span class="ident" id="7983524">want</span>&nbsp;<span class="builtintype" id="7983529">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983537">}</span><span class="op" id="7983538">{</span><br>
<span class="lineno">370</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983542">{</span><span class="string" id="7983543">&#34;foo&#34;</span><span class="op" id="7983548">,</span>&nbsp;<span class="string" id="7983550">&#34;foo&#34;</span><span class="op" id="7983555">}</span><span class="op" id="7983556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983560">{</span><span class="string" id="7983561">&#34;foo;bar&#34;</span><span class="op" id="7983570">,</span>&nbsp;<span class="string" id="7983572">&#34;foobar&#34;</span><span class="op" id="7983580">}</span><span class="op" id="7983581">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983585">{</span><span class="string" id="7983586">&#34;foo\\bar&#34;</span><span class="op" id="7983596">,</span>&nbsp;<span class="string" id="7983598">&#34;foobar&#34;</span><span class="op" id="7983606">}</span><span class="op" id="7983607">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983611">{</span><span class="string" id="7983612">&#34;foo\&#34;bar&#34;</span><span class="op" id="7983622">,</span>&nbsp;<span class="string" id="7983624">&#34;foobar&#34;</span><span class="op" id="7983632">}</span><span class="op" id="7983633">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983637">{</span><span class="string" id="7983638">&#34;\x00\x7e\x7f\x80&#34;</span><span class="op" id="7983656">,</span>&nbsp;<span class="string" id="7983658">&#34;\x7e&#34;</span><span class="op" id="7983664">}</span><span class="op" id="7983665">,</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983669">{</span><span class="string" id="7983670">`&#34;withquotes&#34;`</span><span class="op" id="7983684">,</span>&nbsp;<span class="string" id="7983686">&#34;withquotes&#34;</span><span class="op" id="7983698">}</span><span class="op" id="7983699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983703">{</span><span class="string" id="7983704">&#34;a&nbsp;z&#34;</span><span class="op" id="7983709">,</span>&nbsp;<span class="string" id="7983711">&#34;a&nbsp;z&#34;</span><span class="op" id="7983716">}</span><span class="op" id="7983717">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983721">{</span><span class="string" id="7983722">&#34;&nbsp;z&#34;</span><span class="op" id="7983726">,</span>&nbsp;<span class="string" id="7983728">`&#34;&nbsp;z&#34;`</span><span class="op" id="7983734">}</span><span class="op" id="7983735">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983739">{</span><span class="string" id="7983740">&#34;a&nbsp;&#34;</span><span class="op" id="7983744">,</span>&nbsp;<span class="string" id="7983746">`&#34;a&nbsp;&#34;`</span><span class="op" id="7983752">}</span><span class="op" id="7983753">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983756">}</span><br>
<span class="lineno">380</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7983759">for</span>&nbsp;<span class="ident" id="7983763">_</span><span class="op" id="7983764">,</span>&nbsp;<span class="ident" id="7983766">tt</span>&nbsp;<span class="op" id="7983769">:=</span>&nbsp;<span class="keyword" id="7983772">range</span>&nbsp;<span class="ident" id="7983778">tests</span>&nbsp;<span class="op" id="7983784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7983788">if</span>&nbsp;<span class="ident" id="7983791">got</span>&nbsp;<span class="op" id="7983795">:=</span>&nbsp;<span class="ident" id="7983798">sanitizeCookieValue</span><span class="op" id="7983817">(</span><span class="ident" id="7983818">tt</span><span class="op" id="7983820">.</span><span class="ident" id="7983821">in</span><span class="op" id="7983823">)</span><span class="op" id="7983824">;</span>&nbsp;<span class="ident" id="7983826">got</span>&nbsp;<span class="op" id="7983830">!=</span>&nbsp;<span class="ident" id="7983833">tt</span><span class="op" id="7983835">.</span><span class="ident" id="7983836">want</span>&nbsp;<span class="op" id="7983841">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7983846">t</span><span class="op" id="7983847">.</span><span class="ident" id="7983848">Errorf</span><span class="op" id="7983854">(</span><span class="string" id="7983855">&#34;sanitizeCookieValue(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7983894">,</span>&nbsp;<span class="ident" id="7983896">tt</span><span class="op" id="7983898">.</span><span class="ident" id="7983899">in</span><span class="op" id="7983901">,</span>&nbsp;<span class="ident" id="7983903">got</span><span class="op" id="7983906">,</span>&nbsp;<span class="ident" id="7983908">tt</span><span class="op" id="7983910">.</span><span class="ident" id="7983911">want</span><span class="op" id="7983915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983919">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7983922">}</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7983926">if</span>&nbsp;<span class="ident" id="7983929">got</span><span class="op" id="7983932">,</span>&nbsp;<span class="ident" id="7983934">sub</span>&nbsp;<span class="op" id="7983938">:=</span>&nbsp;<span class="ident" id="7983941">logbuf</span><span class="op" id="7983947">.</span><span class="ident" id="7983948">String</span><span class="op" id="7983954">(</span><span class="op" id="7983955">)</span><span class="op" id="7983956">,</span>&nbsp;<span class="string" id="7983958">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="7983982">;</span>&nbsp;<span class="op" id="7983984">!</span><span class="ident" id="7983985">strings</span><span class="op" id="7983992">.</span><span class="ident" id="7983993">Contains</span><span class="op" id="7984001">(</span><span class="ident" id="7984002">got</span><span class="op" id="7984005">,</span>&nbsp;<span class="ident" id="7984007">sub</span><span class="op" id="7984010">)</span>&nbsp;<span class="op" id="7984012">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984016">t</span><span class="op" id="7984017">.</span><span class="ident" id="7984018">Errorf</span><span class="op" id="7984024">(</span><span class="string" id="7984025">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7984072">,</span>&nbsp;<span class="ident" id="7984074">sub</span><span class="op" id="7984077">,</span>&nbsp;<span class="ident" id="7984079">got</span><span class="op" id="7984082">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7984085">}</span><br>
<span class="lineno"></span><span class="op" id="7984087">}</span><br>
<span class="lineno">390</span><br>
<span class="lineno"></span><span class="keyword" id="7984090">func</span>&nbsp;<span class="ident" id="7984095">TestCookieSanitizePath</span><span class="op" id="7984117">(</span><span class="ident" id="7984118">t</span>&nbsp;<span class="op" id="7984120">*</span><span class="ident" id="7984121">testing</span><span class="op" id="7984128">.</span><span class="ident" id="7984129">T</span><span class="op" id="7984130">)</span>&nbsp;<span class="op" id="7984132">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7984135">defer</span>&nbsp;<span class="ident" id="7984141">log</span><span class="op" id="7984144">.</span><span class="ident" id="7984145">SetOutput</span><span class="op" id="7984154">(</span><span class="ident" id="7984155">os</span><span class="op" id="7984157">.</span><span class="ident" id="7984158">Stderr</span><span class="op" id="7984164">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7984167">var</span>&nbsp;<span class="ident" id="7984171">logbuf</span>&nbsp;<span class="ident" id="7984178">bytes</span><span class="op" id="7984183">.</span><span class="ident" id="7984184">Buffer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984192">log</span><span class="op" id="7984195">.</span><span class="ident" id="7984196">SetOutput</span><span class="op" id="7984205">(</span><span class="op" id="7984206">&amp;</span><span class="ident" id="7984207">logbuf</span><span class="op" id="7984213">)</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984217">tests</span>&nbsp;<span class="op" id="7984223">:=</span>&nbsp;<span class="op" id="7984226">[</span><span class="op" id="7984227">]</span><span class="keyword" id="7984228">struct</span>&nbsp;<span class="op" id="7984235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984239">in</span><span class="op" id="7984241">,</span>&nbsp;<span class="ident" id="7984243">want</span>&nbsp;<span class="builtintype" id="7984248">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7984256">}</span><span class="op" id="7984257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7984261">{</span><span class="string" id="7984262">&#34;/path&#34;</span><span class="op" id="7984269">,</span>&nbsp;<span class="string" id="7984271">&#34;/path&#34;</span><span class="op" id="7984278">}</span><span class="op" id="7984279">,</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7984283">{</span><span class="string" id="7984284">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="7984303">,</span>&nbsp;<span class="string" id="7984305">&#34;/path&nbsp;with&nbsp;space/&#34;</span><span class="op" id="7984324">}</span><span class="op" id="7984325">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7984329">{</span><span class="string" id="7984330">&#34;/just;no;semicolon\x00orstuff/&#34;</span><span class="op" id="7984362">,</span>&nbsp;<span class="string" id="7984364">&#34;/justnosemicolonorstuff/&#34;</span><span class="op" id="7984390">}</span><span class="op" id="7984391">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7984394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7984397">for</span>&nbsp;<span class="ident" id="7984401">_</span><span class="op" id="7984402">,</span>&nbsp;<span class="ident" id="7984404">tt</span>&nbsp;<span class="op" id="7984407">:=</span>&nbsp;<span class="keyword" id="7984410">range</span>&nbsp;<span class="ident" id="7984416">tests</span>&nbsp;<span class="op" id="7984422">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7984426">if</span>&nbsp;<span class="ident" id="7984429">got</span>&nbsp;<span class="op" id="7984433">:=</span>&nbsp;<span class="ident" id="7984436">sanitizeCookiePath</span><span class="op" id="7984454">(</span><span class="ident" id="7984455">tt</span><span class="op" id="7984457">.</span><span class="ident" id="7984458">in</span><span class="op" id="7984460">)</span><span class="op" id="7984461">;</span>&nbsp;<span class="ident" id="7984463">got</span>&nbsp;<span class="op" id="7984467">!=</span>&nbsp;<span class="ident" id="7984470">tt</span><span class="op" id="7984472">.</span><span class="ident" id="7984473">want</span>&nbsp;<span class="op" id="7984478">{</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984483">t</span><span class="op" id="7984484">.</span><span class="ident" id="7984485">Errorf</span><span class="op" id="7984491">(</span><span class="string" id="7984492">&#34;sanitizeCookiePath(%q)&nbsp;=&nbsp;%q;&nbsp;want&nbsp;%q&#34;</span><span class="op" id="7984530">,</span>&nbsp;<span class="ident" id="7984532">tt</span><span class="op" id="7984534">.</span><span class="ident" id="7984535">in</span><span class="op" id="7984537">,</span>&nbsp;<span class="ident" id="7984539">got</span><span class="op" id="7984542">,</span>&nbsp;<span class="ident" id="7984544">tt</span><span class="op" id="7984546">.</span><span class="ident" id="7984547">want</span><span class="op" id="7984551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7984555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7984558">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="7984562">if</span>&nbsp;<span class="ident" id="7984565">got</span><span class="op" id="7984568">,</span>&nbsp;<span class="ident" id="7984570">sub</span>&nbsp;<span class="op" id="7984574">:=</span>&nbsp;<span class="ident" id="7984577">logbuf</span><span class="op" id="7984583">.</span><span class="ident" id="7984584">String</span><span class="op" id="7984590">(</span><span class="op" id="7984591">)</span><span class="op" id="7984592">,</span>&nbsp;<span class="string" id="7984594">&#34;dropping&nbsp;invalid&nbsp;bytes&#34;</span><span class="op" id="7984618">;</span>&nbsp;<span class="op" id="7984620">!</span><span class="ident" id="7984621">strings</span><span class="op" id="7984628">.</span><span class="ident" id="7984629">Contains</span><span class="op" id="7984637">(</span><span class="ident" id="7984638">got</span><span class="op" id="7984641">,</span>&nbsp;<span class="ident" id="7984643">sub</span><span class="op" id="7984646">)</span>&nbsp;<span class="op" id="7984648">{</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="7984652">t</span><span class="op" id="7984653">.</span><span class="ident" id="7984654">Errorf</span><span class="op" id="7984660">(</span><span class="string" id="7984661">&#34;Expected&nbsp;substring&nbsp;%q&nbsp;in&nbsp;log&nbsp;output.&nbsp;Got:\n%s&#34;</span><span class="op" id="7984708">,</span>&nbsp;<span class="ident" id="7984710">sub</span><span class="op" id="7984713">,</span>&nbsp;<span class="ident" id="7984715">got</span><span class="op" id="7984718">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="7984721">}</span><br>
<span class="lineno"></span><span class="op" id="7984723">}</span>
</div>
</body>
</html>
