<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>syscall</h2>
<ul>
<li><a href="/gostd/syscall/creds_test.go.html">creds_test.go</a></li>
<li><a href="/gostd/syscall/env_unix.go.html">env_unix.go</a></li>
<li><a href="/gostd/syscall/exec_linux.go.html">exec_linux.go</a></li>
<li><a href="/gostd/syscall/exec_unix.go.html">exec_unix.go</a></li>
<li><a href="/gostd/syscall/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/syscall/flock.go.html">flock.go</a></li>
<li><a href="/gostd/syscall/lsf_linux.go.html">lsf_linux.go</a></li>
<li><a href="/gostd/syscall/mmap_unix_test.go.html">mmap_unix_test.go</a></li>
<li><a href="/gostd/syscall/netlink_linux.go.html" class="current">netlink_linux.go</a></li>
<li><a href="/gostd/syscall/race0.go.html">race0.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_linux.go.html">sockcmsg_linux.go</a></li>
<li><a href="/gostd/syscall/sockcmsg_unix.go.html">sockcmsg_unix.go</a></li>
<li><a href="/gostd/syscall/str.go.html">str.go</a></li>
<li><a href="/gostd/syscall/syscall.go.html">syscall.go</a></li>
<li><a href="/gostd/syscall/syscall_linux.go.html">syscall_linux.go</a></li>
<li><a href="/gostd/syscall/syscall_linux_amd64.go.html">syscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/syscall_test.go.html">syscall_test.go</a></li>
<li><a href="/gostd/syscall/syscall_unix.go.html">syscall_unix.go</a></li>
<li><a href="/gostd/syscall/syscall_unix_test.go.html">syscall_unix_test.go</a></li>
<li><a href="/gostd/syscall/zerrors_linux_amd64.go.html">zerrors_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsyscall_linux_amd64.go.html">zsyscall_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/zsysnum_linux_amd64.go.html">zsysnum_linux_amd64.go</a></li>
<li><a href="/gostd/syscall/ztypes_linux_amd64.go.html">ztypes_linux_amd64.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2392553">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2392609">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2392663">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="2392714">//&nbsp;Netlink&nbsp;sockets&nbsp;and&nbsp;messages</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2392747">package</span>&nbsp;<span class="ident" id="2392755">syscall</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2392764">import</span>&nbsp;<span class="string" id="2392771">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2392781">//&nbsp;Round&nbsp;the&nbsp;length&nbsp;of&nbsp;a&nbsp;netlink&nbsp;message&nbsp;up&nbsp;to&nbsp;align&nbsp;it&nbsp;properly.</span><br>
<span class="lineno"></span><span class="keyword" id="2392847">func</span>&nbsp;<span class="ident" id="2392852">nlmAlignOf</span><span class="op" id="2392862">(</span><span class="ident" id="2392863">msglen</span>&nbsp;<span class="builtintype" id="2392870">int</span><span class="op" id="2392873">)</span>&nbsp;<span class="builtintype" id="2392875">int</span>&nbsp;<span class="op" id="2392879">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2392882">return</span>&nbsp;<span class="op" id="2392889">(</span><span class="ident" id="2392890">msglen</span>&nbsp;<span class="op" id="2392897">+</span>&nbsp;<span class="ident" id="2392899">NLMSG_ALIGNTO</span>&nbsp;<span class="op" id="2392913">-</span>&nbsp;<span class="num" id="2392915">1</span><span class="op" id="2392916">)</span>&nbsp;<span class="op" id="2392918">&amp;</span>&nbsp;<span class="op" id="2392920">^</span><span class="op" id="2392921">(</span><span class="ident" id="2392922">NLMSG_ALIGNTO</span>&nbsp;<span class="op" id="2392936">-</span>&nbsp;<span class="num" id="2392938">1</span><span class="op" id="2392939">)</span><br>
<span class="lineno"></span><span class="op" id="2392941">}</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="2392944">//&nbsp;Round&nbsp;the&nbsp;length&nbsp;of&nbsp;a&nbsp;netlink&nbsp;route&nbsp;attribute&nbsp;up&nbsp;to&nbsp;align&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="2393008">//&nbsp;properly.</span><br>
<span class="lineno"></span><span class="keyword" id="2393021">func</span>&nbsp;<span class="ident" id="2393026">rtaAlignOf</span><span class="op" id="2393036">(</span><span class="ident" id="2393037">attrlen</span>&nbsp;<span class="builtintype" id="2393045">int</span><span class="op" id="2393048">)</span>&nbsp;<span class="builtintype" id="2393050">int</span>&nbsp;<span class="op" id="2393054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2393057">return</span>&nbsp;<span class="op" id="2393064">(</span><span class="ident" id="2393065">attrlen</span>&nbsp;<span class="op" id="2393073">+</span>&nbsp;<span class="ident" id="2393075">RTA_ALIGNTO</span>&nbsp;<span class="op" id="2393087">-</span>&nbsp;<span class="num" id="2393089">1</span><span class="op" id="2393090">)</span>&nbsp;<span class="op" id="2393092">&amp;</span>&nbsp;<span class="op" id="2393094">^</span><span class="op" id="2393095">(</span><span class="ident" id="2393096">RTA_ALIGNTO</span>&nbsp;<span class="op" id="2393108">-</span>&nbsp;<span class="num" id="2393110">1</span><span class="op" id="2393111">)</span><br>
<span class="lineno">20</span><span class="op" id="2393113">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2393116">//&nbsp;NetlinkRouteRequest&nbsp;represents&nbsp;a&nbsp;request&nbsp;message&nbsp;to&nbsp;receive&nbsp;routing</span><br>
<span class="lineno"></span><span class="comment" id="2393187">//&nbsp;and&nbsp;link&nbsp;states&nbsp;from&nbsp;the&nbsp;kernel.</span><br>
<span class="lineno"></span><span class="keyword" id="2393223">type</span>&nbsp;<span class="ident" id="2393228">NetlinkRouteRequest</span>&nbsp;<span class="keyword" id="2393248">struct</span>&nbsp;<span class="op" id="2393255">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393258">Header</span>&nbsp;<span class="ident" id="2393265">NlMsghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393275">Data</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="2393282">RtGenmsg</span><br>
<span class="lineno"></span><span class="op" id="2393291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2393294">func</span>&nbsp;<span class="op" id="2393299">(</span><span class="ident" id="2393300">rr</span>&nbsp;<span class="op" id="2393303">*</span><span class="ident" id="2393304">NetlinkRouteRequest</span><span class="op" id="2393323">)</span>&nbsp;<span class="ident" id="2393325">toWireFormat</span><span class="op" id="2393337">(</span><span class="op" id="2393338">)</span>&nbsp;<span class="op" id="2393340">[</span><span class="op" id="2393341">]</span><span class="builtintype" id="2393342">byte</span>&nbsp;<span class="op" id="2393347">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393350">b</span>&nbsp;<span class="op" id="2393352">:=</span>&nbsp;<span class="builtinfunc" id="2393355">make</span><span class="op" id="2393359">(</span><span class="op" id="2393360">[</span><span class="op" id="2393361">]</span><span class="builtintype" id="2393362">byte</span><span class="op" id="2393366">,</span>&nbsp;<span class="ident" id="2393368">rr</span><span class="op" id="2393370">.</span><span class="ident" id="2393371">Header</span><span class="op" id="2393377">.</span><span class="ident" id="2393378">Len</span><span class="op" id="2393381">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2393384">*</span><span class="op" id="2393385">(</span><span class="op" id="2393386">*</span><span class="builtintype" id="2393387">uint32</span><span class="op" id="2393393">)</span><span class="op" id="2393394">(</span><span class="ident" id="2393395">unsafe</span><span class="op" id="2393401">.</span><span class="ident" id="2393402">Pointer</span><span class="op" id="2393409">(</span><span class="op" id="2393410">&amp;</span><span class="ident" id="2393411">b</span><span class="op" id="2393412">[</span><span class="num" id="2393413">0</span><span class="op" id="2393414">:</span><span class="num" id="2393415">4</span><span class="op" id="2393416">]</span><span class="op" id="2393417">[</span><span class="num" id="2393418">0</span><span class="op" id="2393419">]</span><span class="op" id="2393420">)</span><span class="op" id="2393421">)</span>&nbsp;<span class="op" id="2393423">=</span>&nbsp;<span class="ident" id="2393425">rr</span><span class="op" id="2393427">.</span><span class="ident" id="2393428">Header</span><span class="op" id="2393434">.</span><span class="ident" id="2393435">Len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2393440">*</span><span class="op" id="2393441">(</span><span class="op" id="2393442">*</span><span class="builtintype" id="2393443">uint16</span><span class="op" id="2393449">)</span><span class="op" id="2393450">(</span><span class="ident" id="2393451">unsafe</span><span class="op" id="2393457">.</span><span class="ident" id="2393458">Pointer</span><span class="op" id="2393465">(</span><span class="op" id="2393466">&amp;</span><span class="ident" id="2393467">b</span><span class="op" id="2393468">[</span><span class="num" id="2393469">4</span><span class="op" id="2393470">:</span><span class="num" id="2393471">6</span><span class="op" id="2393472">]</span><span class="op" id="2393473">[</span><span class="num" id="2393474">0</span><span class="op" id="2393475">]</span><span class="op" id="2393476">)</span><span class="op" id="2393477">)</span>&nbsp;<span class="op" id="2393479">=</span>&nbsp;<span class="ident" id="2393481">rr</span><span class="op" id="2393483">.</span><span class="ident" id="2393484">Header</span><span class="op" id="2393490">.</span><span class="ident" id="2393491">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2393497">*</span><span class="op" id="2393498">(</span><span class="op" id="2393499">*</span><span class="builtintype" id="2393500">uint16</span><span class="op" id="2393506">)</span><span class="op" id="2393507">(</span><span class="ident" id="2393508">unsafe</span><span class="op" id="2393514">.</span><span class="ident" id="2393515">Pointer</span><span class="op" id="2393522">(</span><span class="op" id="2393523">&amp;</span><span class="ident" id="2393524">b</span><span class="op" id="2393525">[</span><span class="num" id="2393526">6</span><span class="op" id="2393527">:</span><span class="num" id="2393528">8</span><span class="op" id="2393529">]</span><span class="op" id="2393530">[</span><span class="num" id="2393531">0</span><span class="op" id="2393532">]</span><span class="op" id="2393533">)</span><span class="op" id="2393534">)</span>&nbsp;<span class="op" id="2393536">=</span>&nbsp;<span class="ident" id="2393538">rr</span><span class="op" id="2393540">.</span><span class="ident" id="2393541">Header</span><span class="op" id="2393547">.</span><span class="ident" id="2393548">Flags</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2393555">*</span><span class="op" id="2393556">(</span><span class="op" id="2393557">*</span><span class="builtintype" id="2393558">uint32</span><span class="op" id="2393564">)</span><span class="op" id="2393565">(</span><span class="ident" id="2393566">unsafe</span><span class="op" id="2393572">.</span><span class="ident" id="2393573">Pointer</span><span class="op" id="2393580">(</span><span class="op" id="2393581">&amp;</span><span class="ident" id="2393582">b</span><span class="op" id="2393583">[</span><span class="num" id="2393584">8</span><span class="op" id="2393585">:</span><span class="num" id="2393586">12</span><span class="op" id="2393588">]</span><span class="op" id="2393589">[</span><span class="num" id="2393590">0</span><span class="op" id="2393591">]</span><span class="op" id="2393592">)</span><span class="op" id="2393593">)</span>&nbsp;<span class="op" id="2393595">=</span>&nbsp;<span class="ident" id="2393597">rr</span><span class="op" id="2393599">.</span><span class="ident" id="2393600">Header</span><span class="op" id="2393606">.</span><span class="ident" id="2393607">Seq</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2393612">*</span><span class="op" id="2393613">(</span><span class="op" id="2393614">*</span><span class="builtintype" id="2393615">uint32</span><span class="op" id="2393621">)</span><span class="op" id="2393622">(</span><span class="ident" id="2393623">unsafe</span><span class="op" id="2393629">.</span><span class="ident" id="2393630">Pointer</span><span class="op" id="2393637">(</span><span class="op" id="2393638">&amp;</span><span class="ident" id="2393639">b</span><span class="op" id="2393640">[</span><span class="num" id="2393641">12</span><span class="op" id="2393643">:</span><span class="num" id="2393644">16</span><span class="op" id="2393646">]</span><span class="op" id="2393647">[</span><span class="num" id="2393648">0</span><span class="op" id="2393649">]</span><span class="op" id="2393650">)</span><span class="op" id="2393651">)</span>&nbsp;<span class="op" id="2393653">=</span>&nbsp;<span class="ident" id="2393655">rr</span><span class="op" id="2393657">.</span><span class="ident" id="2393658">Header</span><span class="op" id="2393664">.</span><span class="ident" id="2393665">Pid</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393670">b</span><span class="op" id="2393671">[</span><span class="num" id="2393672">16</span><span class="op" id="2393674">]</span>&nbsp;<span class="op" id="2393676">=</span>&nbsp;<span class="builtintype" id="2393678">byte</span><span class="op" id="2393682">(</span><span class="ident" id="2393683">rr</span><span class="op" id="2393685">.</span><span class="ident" id="2393686">Data</span><span class="op" id="2393690">.</span><span class="ident" id="2393691">Family</span><span class="op" id="2393697">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2393700">return</span>&nbsp;<span class="ident" id="2393707">b</span><br>
<span class="lineno"></span><span class="op" id="2393709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="2393712">func</span>&nbsp;<span class="ident" id="2393717">newNetlinkRouteRequest</span><span class="op" id="2393739">(</span><span class="ident" id="2393740">proto</span><span class="op" id="2393745">,</span>&nbsp;<span class="ident" id="2393747">seq</span><span class="op" id="2393750">,</span>&nbsp;<span class="ident" id="2393752">family</span>&nbsp;<span class="builtintype" id="2393759">int</span><span class="op" id="2393762">)</span>&nbsp;<span class="op" id="2393764">[</span><span class="op" id="2393765">]</span><span class="builtintype" id="2393766">byte</span>&nbsp;<span class="op" id="2393771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393774">rr</span>&nbsp;<span class="op" id="2393777">:=</span>&nbsp;<span class="op" id="2393780">&amp;</span><span class="ident" id="2393781">NetlinkRouteRequest</span><span class="op" id="2393800">{</span><span class="op" id="2393801">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393804">rr</span><span class="op" id="2393806">.</span><span class="ident" id="2393807">Header</span><span class="op" id="2393813">.</span><span class="ident" id="2393814">Len</span>&nbsp;<span class="op" id="2393818">=</span>&nbsp;<span class="builtintype" id="2393820">uint32</span><span class="op" id="2393826">(</span><span class="ident" id="2393827">NLMSG_HDRLEN</span>&nbsp;<span class="op" id="2393840">+</span>&nbsp;<span class="ident" id="2393842">SizeofRtGenmsg</span><span class="op" id="2393856">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393859">rr</span><span class="op" id="2393861">.</span><span class="ident" id="2393862">Header</span><span class="op" id="2393868">.</span><span class="ident" id="2393869">Type</span>&nbsp;<span class="op" id="2393874">=</span>&nbsp;<span class="builtintype" id="2393876">uint16</span><span class="op" id="2393882">(</span><span class="ident" id="2393883">proto</span><span class="op" id="2393888">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393891">rr</span><span class="op" id="2393893">.</span><span class="ident" id="2393894">Header</span><span class="op" id="2393900">.</span><span class="ident" id="2393901">Flags</span>&nbsp;<span class="op" id="2393907">=</span>&nbsp;<span class="ident" id="2393909">NLM_F_DUMP</span>&nbsp;<span class="op" id="2393920">|</span>&nbsp;<span class="ident" id="2393922">NLM_F_REQUEST</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393937">rr</span><span class="op" id="2393939">.</span><span class="ident" id="2393940">Header</span><span class="op" id="2393946">.</span><span class="ident" id="2393947">Seq</span>&nbsp;<span class="op" id="2393951">=</span>&nbsp;<span class="builtintype" id="2393953">uint32</span><span class="op" id="2393959">(</span><span class="ident" id="2393960">seq</span><span class="op" id="2393963">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2393966">rr</span><span class="op" id="2393968">.</span><span class="ident" id="2393969">Data</span><span class="op" id="2393973">.</span><span class="ident" id="2393974">Family</span>&nbsp;<span class="op" id="2393981">=</span>&nbsp;<span class="builtintype" id="2393983">uint8</span><span class="op" id="2393988">(</span><span class="ident" id="2393989">family</span><span class="op" id="2393995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2393998">return</span>&nbsp;<span class="ident" id="2394005">rr</span><span class="op" id="2394007">.</span><span class="ident" id="2394008">toWireFormat</span><span class="op" id="2394020">(</span><span class="op" id="2394021">)</span><br>
<span class="lineno"></span><span class="op" id="2394023">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="2394026">//&nbsp;NetlinkRIB&nbsp;returns&nbsp;routing&nbsp;information&nbsp;base,&nbsp;as&nbsp;known&nbsp;as&nbsp;RIB,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="2394097">//&nbsp;consists&nbsp;of&nbsp;network&nbsp;facility&nbsp;information,&nbsp;states&nbsp;and&nbsp;parameters.</span><br>
<span class="lineno"></span><span class="keyword" id="2394165">func</span>&nbsp;<span class="ident" id="2394170">NetlinkRIB</span><span class="op" id="2394180">(</span><span class="ident" id="2394181">proto</span><span class="op" id="2394186">,</span>&nbsp;<span class="ident" id="2394188">family</span>&nbsp;<span class="builtintype" id="2394195">int</span><span class="op" id="2394198">)</span>&nbsp;<span class="op" id="2394200">(</span><span class="op" id="2394201">[</span><span class="op" id="2394202">]</span><span class="builtintype" id="2394203">byte</span><span class="op" id="2394207">,</span>&nbsp;<span class="builtintype" id="2394209">error</span><span class="op" id="2394214">)</span>&nbsp;<span class="op" id="2394216">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2394219">s</span><span class="op" id="2394220">,</span>&nbsp;<span class="ident" id="2394222">err</span>&nbsp;<span class="op" id="2394226">:=</span>&nbsp;<span class="ident" id="2394229">Socket</span><span class="op" id="2394235">(</span><span class="ident" id="2394236">AF_NETLINK</span><span class="op" id="2394246">,</span>&nbsp;<span class="ident" id="2394248">SOCK_RAW</span><span class="op" id="2394256">,</span>&nbsp;<span class="ident" id="2394258">NETLINK_ROUTE</span><span class="op" id="2394271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394274">if</span>&nbsp;<span class="ident" id="2394277">err</span>&nbsp;<span class="op" id="2394281">!=</span>&nbsp;<span class="builtintype" id="2394284">nil</span>&nbsp;<span class="op" id="2394288">{</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394292">return</span>&nbsp;<span class="builtintype" id="2394299">nil</span><span class="op" id="2394302">,</span>&nbsp;<span class="ident" id="2394304">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2394309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394312">defer</span>&nbsp;<span class="ident" id="2394318">Close</span><span class="op" id="2394323">(</span><span class="ident" id="2394324">s</span><span class="op" id="2394325">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2394328">lsa</span>&nbsp;<span class="op" id="2394332">:=</span>&nbsp;<span class="op" id="2394335">&amp;</span><span class="ident" id="2394336">SockaddrNetlink</span><span class="op" id="2394351">{</span><span class="ident" id="2394352">Family</span><span class="op" id="2394358">:</span>&nbsp;<span class="ident" id="2394360">AF_NETLINK</span><span class="op" id="2394370">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394373">if</span>&nbsp;<span class="ident" id="2394376">err</span>&nbsp;<span class="op" id="2394380">:=</span>&nbsp;<span class="ident" id="2394383">Bind</span><span class="op" id="2394387">(</span><span class="ident" id="2394388">s</span><span class="op" id="2394389">,</span>&nbsp;<span class="ident" id="2394391">lsa</span><span class="op" id="2394394">)</span><span class="op" id="2394395">;</span>&nbsp;<span class="ident" id="2394397">err</span>&nbsp;<span class="op" id="2394401">!=</span>&nbsp;<span class="builtintype" id="2394404">nil</span>&nbsp;<span class="op" id="2394408">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394412">return</span>&nbsp;<span class="builtintype" id="2394419">nil</span><span class="op" id="2394422">,</span>&nbsp;<span class="ident" id="2394424">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2394429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2394432">wb</span>&nbsp;<span class="op" id="2394435">:=</span>&nbsp;<span class="ident" id="2394438">newNetlinkRouteRequest</span><span class="op" id="2394460">(</span><span class="ident" id="2394461">proto</span><span class="op" id="2394466">,</span>&nbsp;<span class="num" id="2394468">1</span><span class="op" id="2394469">,</span>&nbsp;<span class="ident" id="2394471">family</span><span class="op" id="2394477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394480">if</span>&nbsp;<span class="ident" id="2394483">err</span>&nbsp;<span class="op" id="2394487">:=</span>&nbsp;<span class="ident" id="2394490">Sendto</span><span class="op" id="2394496">(</span><span class="ident" id="2394497">s</span><span class="op" id="2394498">,</span>&nbsp;<span class="ident" id="2394500">wb</span><span class="op" id="2394502">,</span>&nbsp;<span class="num" id="2394504">0</span><span class="op" id="2394505">,</span>&nbsp;<span class="ident" id="2394507">lsa</span><span class="op" id="2394510">)</span><span class="op" id="2394511">;</span>&nbsp;<span class="ident" id="2394513">err</span>&nbsp;<span class="op" id="2394517">!=</span>&nbsp;<span class="builtintype" id="2394520">nil</span>&nbsp;<span class="op" id="2394524">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394528">return</span>&nbsp;<span class="builtintype" id="2394535">nil</span><span class="op" id="2394538">,</span>&nbsp;<span class="ident" id="2394540">err</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2394545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394548">var</span>&nbsp;<span class="ident" id="2394552">tab</span>&nbsp;<span class="op" id="2394556">[</span><span class="op" id="2394557">]</span><span class="builtintype" id="2394558">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2394564">rbNew</span>&nbsp;<span class="op" id="2394570">:=</span>&nbsp;<span class="builtinfunc" id="2394573">make</span><span class="op" id="2394577">(</span><span class="op" id="2394578">[</span><span class="op" id="2394579">]</span><span class="builtintype" id="2394580">byte</span><span class="op" id="2394584">,</span>&nbsp;<span class="ident" id="2394586">Getpagesize</span><span class="op" id="2394597">(</span><span class="op" id="2394598">)</span><span class="op" id="2394599">)</span><br>
<span class="lineno"></span><span class="ident" id="2394601">done</span><span class="op" id="2394605">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394608">for</span>&nbsp;<span class="op" id="2394612">{</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2394616">rb</span>&nbsp;<span class="op" id="2394619">:=</span>&nbsp;<span class="ident" id="2394622">rbNew</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2394630">nr</span><span class="op" id="2394632">,</span>&nbsp;<span class="ident" id="2394634">_</span><span class="op" id="2394635">,</span>&nbsp;<span class="ident" id="2394637">err</span>&nbsp;<span class="op" id="2394641">:=</span>&nbsp;<span class="ident" id="2394644">Recvfrom</span><span class="op" id="2394652">(</span><span class="ident" id="2394653">s</span><span class="op" id="2394654">,</span>&nbsp;<span class="ident" id="2394656">rb</span><span class="op" id="2394658">,</span>&nbsp;<span class="num" id="2394660">0</span><span class="op" id="2394661">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394665">if</span>&nbsp;<span class="ident" id="2394668">err</span>&nbsp;<span class="op" id="2394672">!=</span>&nbsp;<span class="builtintype" id="2394675">nil</span>&nbsp;<span class="op" id="2394679">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394684">return</span>&nbsp;<span class="builtintype" id="2394691">nil</span><span class="op" id="2394694">,</span>&nbsp;<span class="ident" id="2394696">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2394702">}</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394706">if</span>&nbsp;<span class="ident" id="2394709">nr</span>&nbsp;<span class="op" id="2394712">&lt;</span>&nbsp;<span class="ident" id="2394714">NLMSG_HDRLEN</span>&nbsp;<span class="op" id="2394727">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394732">return</span>&nbsp;<span class="builtintype" id="2394739">nil</span><span class="op" id="2394742">,</span>&nbsp;<span class="ident" id="2394744">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2394753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2394757">rb</span>&nbsp;<span class="op" id="2394760">=</span>&nbsp;<span class="ident" id="2394762">rb</span><span class="op" id="2394764">[</span><span class="op" id="2394765">:</span><span class="ident" id="2394766">nr</span><span class="op" id="2394768">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2394772">tab</span>&nbsp;<span class="op" id="2394776">=</span>&nbsp;<span class="builtinfunc" id="2394778">append</span><span class="op" id="2394784">(</span><span class="ident" id="2394785">tab</span><span class="op" id="2394788">,</span>&nbsp;<span class="ident" id="2394790">rb</span><span class="op" id="2394792">...</span><span class="op" id="2394795">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2394799">msgs</span><span class="op" id="2394803">,</span>&nbsp;<span class="ident" id="2394805">err</span>&nbsp;<span class="op" id="2394809">:=</span>&nbsp;<span class="ident" id="2394812">ParseNetlinkMessage</span><span class="op" id="2394831">(</span><span class="ident" id="2394832">rb</span><span class="op" id="2394834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394838">if</span>&nbsp;<span class="ident" id="2394841">err</span>&nbsp;<span class="op" id="2394845">!=</span>&nbsp;<span class="builtintype" id="2394848">nil</span>&nbsp;<span class="op" id="2394852">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394857">return</span>&nbsp;<span class="builtintype" id="2394864">nil</span><span class="op" id="2394867">,</span>&nbsp;<span class="ident" id="2394869">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2394875">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394879">for</span>&nbsp;<span class="ident" id="2394883">_</span><span class="op" id="2394884">,</span>&nbsp;<span class="ident" id="2394886">m</span>&nbsp;<span class="op" id="2394888">:=</span>&nbsp;<span class="keyword" id="2394891">range</span>&nbsp;<span class="ident" id="2394897">msgs</span>&nbsp;<span class="op" id="2394902">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2394907">lsa</span><span class="op" id="2394910">,</span>&nbsp;<span class="ident" id="2394912">err</span>&nbsp;<span class="op" id="2394916">:=</span>&nbsp;<span class="ident" id="2394919">Getsockname</span><span class="op" id="2394930">(</span><span class="ident" id="2394931">s</span><span class="op" id="2394932">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394937">if</span>&nbsp;<span class="ident" id="2394940">err</span>&nbsp;<span class="op" id="2394944">!=</span>&nbsp;<span class="builtintype" id="2394947">nil</span>&nbsp;<span class="op" id="2394951">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394957">return</span>&nbsp;<span class="builtintype" id="2394964">nil</span><span class="op" id="2394967">,</span>&nbsp;<span class="ident" id="2394969">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2394976">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2394981">switch</span>&nbsp;<span class="ident" id="2394988">v</span>&nbsp;<span class="op" id="2394990">:=</span>&nbsp;<span class="ident" id="2394993">lsa</span><span class="op" id="2394996">.</span><span class="op" id="2394997">(</span><span class="keyword" id="2394998">type</span><span class="op" id="2395002">)</span>&nbsp;<span class="op" id="2395004">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395009">case</span>&nbsp;<span class="op" id="2395014">*</span><span class="ident" id="2395015">SockaddrNetlink</span><span class="op" id="2395030">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395036">if</span>&nbsp;<span class="ident" id="2395039">m</span><span class="op" id="2395040">.</span><span class="ident" id="2395041">Header</span><span class="op" id="2395047">.</span><span class="ident" id="2395048">Seq</span>&nbsp;<span class="op" id="2395052">!=</span>&nbsp;<span class="num" id="2395055">1</span>&nbsp;<span class="op" id="2395057">||</span>&nbsp;<span class="ident" id="2395060">m</span><span class="op" id="2395061">.</span><span class="ident" id="2395062">Header</span><span class="op" id="2395068">.</span><span class="ident" id="2395069">Pid</span>&nbsp;<span class="op" id="2395073">!=</span>&nbsp;<span class="ident" id="2395076">v</span><span class="op" id="2395077">.</span><span class="ident" id="2395078">Pid</span>&nbsp;<span class="op" id="2395082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395089">return</span>&nbsp;<span class="builtintype" id="2395096">nil</span><span class="op" id="2395099">,</span>&nbsp;<span class="ident" id="2395101">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2395112">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395117">default</span><span class="op" id="2395124">:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395130">return</span>&nbsp;<span class="builtintype" id="2395137">nil</span><span class="op" id="2395140">,</span>&nbsp;<span class="ident" id="2395142">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2395152">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395157">if</span>&nbsp;<span class="ident" id="2395160">m</span><span class="op" id="2395161">.</span><span class="ident" id="2395162">Header</span><span class="op" id="2395168">.</span><span class="ident" id="2395169">Type</span>&nbsp;<span class="op" id="2395174">==</span>&nbsp;<span class="ident" id="2395177">NLMSG_DONE</span>&nbsp;<span class="op" id="2395188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395194">break</span>&nbsp;<span class="ident" id="2395200">done</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2395208">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395213">if</span>&nbsp;<span class="ident" id="2395216">m</span><span class="op" id="2395217">.</span><span class="ident" id="2395218">Header</span><span class="op" id="2395224">.</span><span class="ident" id="2395225">Type</span>&nbsp;<span class="op" id="2395230">==</span>&nbsp;<span class="ident" id="2395233">NLMSG_ERROR</span>&nbsp;<span class="op" id="2395245">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395251">return</span>&nbsp;<span class="builtintype" id="2395258">nil</span><span class="op" id="2395261">,</span>&nbsp;<span class="ident" id="2395263">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2395273">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2395277">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2395280">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395283">return</span>&nbsp;<span class="ident" id="2395290">tab</span><span class="op" id="2395293">,</span>&nbsp;<span class="builtintype" id="2395295">nil</span><br>
<span class="lineno"></span><span class="op" id="2395299">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2395302">//&nbsp;NetlinkMessage&nbsp;represents&nbsp;a&nbsp;netlink&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="2395350">type</span>&nbsp;<span class="ident" id="2395355">NetlinkMessage</span>&nbsp;<span class="keyword" id="2395370">struct</span>&nbsp;<span class="op" id="2395377">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395380">Header</span>&nbsp;<span class="ident" id="2395387">NlMsghdr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395397">Data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2395404">[</span><span class="op" id="2395405">]</span><span class="builtintype" id="2395406">byte</span><br>
<span class="lineno"></span><span class="op" id="2395411">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2395414">//&nbsp;ParseNetlinkMessage&nbsp;parses&nbsp;b&nbsp;as&nbsp;an&nbsp;array&nbsp;of&nbsp;netlink&nbsp;messages&nbsp;and</span><br>
<span class="lineno">115</span><span class="comment" id="2395482">//&nbsp;returns&nbsp;the&nbsp;slice&nbsp;containing&nbsp;the&nbsp;NetlinkMessage&nbsp;structures.</span><br>
<span class="lineno"></span><span class="keyword" id="2395545">func</span>&nbsp;<span class="ident" id="2395550">ParseNetlinkMessage</span><span class="op" id="2395569">(</span><span class="ident" id="2395570">b</span>&nbsp;<span class="op" id="2395572">[</span><span class="op" id="2395573">]</span><span class="builtintype" id="2395574">byte</span><span class="op" id="2395578">)</span>&nbsp;<span class="op" id="2395580">(</span><span class="op" id="2395581">[</span><span class="op" id="2395582">]</span><span class="ident" id="2395583">NetlinkMessage</span><span class="op" id="2395597">,</span>&nbsp;<span class="builtintype" id="2395599">error</span><span class="op" id="2395604">)</span>&nbsp;<span class="op" id="2395606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395609">var</span>&nbsp;<span class="ident" id="2395613">msgs</span>&nbsp;<span class="op" id="2395618">[</span><span class="op" id="2395619">]</span><span class="ident" id="2395620">NetlinkMessage</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395636">for</span>&nbsp;<span class="builtinfunc" id="2395640">len</span><span class="op" id="2395643">(</span><span class="ident" id="2395644">b</span><span class="op" id="2395645">)</span>&nbsp;<span class="op" id="2395647">&gt;=</span>&nbsp;<span class="ident" id="2395650">NLMSG_HDRLEN</span>&nbsp;<span class="op" id="2395663">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395667">h</span><span class="op" id="2395668">,</span>&nbsp;<span class="ident" id="2395670">dbuf</span><span class="op" id="2395674">,</span>&nbsp;<span class="ident" id="2395676">dlen</span><span class="op" id="2395680">,</span>&nbsp;<span class="ident" id="2395682">err</span>&nbsp;<span class="op" id="2395686">:=</span>&nbsp;<span class="ident" id="2395689">netlinkMessageHeaderAndData</span><span class="op" id="2395716">(</span><span class="ident" id="2395717">b</span><span class="op" id="2395718">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395722">if</span>&nbsp;<span class="ident" id="2395725">err</span>&nbsp;<span class="op" id="2395729">!=</span>&nbsp;<span class="builtintype" id="2395732">nil</span>&nbsp;<span class="op" id="2395736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395741">return</span>&nbsp;<span class="builtintype" id="2395748">nil</span><span class="op" id="2395751">,</span>&nbsp;<span class="ident" id="2395753">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2395759">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395763">m</span>&nbsp;<span class="op" id="2395765">:=</span>&nbsp;<span class="ident" id="2395768">NetlinkMessage</span><span class="op" id="2395782">{</span><span class="ident" id="2395783">Header</span><span class="op" id="2395789">:</span>&nbsp;<span class="op" id="2395791">*</span><span class="ident" id="2395792">h</span><span class="op" id="2395793">,</span>&nbsp;<span class="ident" id="2395795">Data</span><span class="op" id="2395799">:</span>&nbsp;<span class="ident" id="2395801">dbuf</span><span class="op" id="2395805">[</span><span class="op" id="2395806">:</span><span class="builtintype" id="2395807">int</span><span class="op" id="2395810">(</span><span class="ident" id="2395811">h</span><span class="op" id="2395812">.</span><span class="ident" id="2395813">Len</span><span class="op" id="2395816">)</span><span class="op" id="2395817">-</span><span class="ident" id="2395818">NLMSG_HDRLEN</span><span class="op" id="2395830">]</span><span class="op" id="2395831">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395835">msgs</span>&nbsp;<span class="op" id="2395840">=</span>&nbsp;<span class="builtinfunc" id="2395842">append</span><span class="op" id="2395848">(</span><span class="ident" id="2395849">msgs</span><span class="op" id="2395853">,</span>&nbsp;<span class="ident" id="2395855">m</span><span class="op" id="2395856">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395860">b</span>&nbsp;<span class="op" id="2395862">=</span>&nbsp;<span class="ident" id="2395864">b</span><span class="op" id="2395865">[</span><span class="ident" id="2395866">dlen</span><span class="op" id="2395870">:</span><span class="op" id="2395871">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2395874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2395877">return</span>&nbsp;<span class="ident" id="2395884">msgs</span><span class="op" id="2395888">,</span>&nbsp;<span class="builtintype" id="2395890">nil</span><br>
<span class="lineno"></span><span class="op" id="2395894">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span><span class="keyword" id="2395897">func</span>&nbsp;<span class="ident" id="2395902">netlinkMessageHeaderAndData</span><span class="op" id="2395929">(</span><span class="ident" id="2395930">b</span>&nbsp;<span class="op" id="2395932">[</span><span class="op" id="2395933">]</span><span class="builtintype" id="2395934">byte</span><span class="op" id="2395938">)</span>&nbsp;<span class="op" id="2395940">(</span><span class="op" id="2395941">*</span><span class="ident" id="2395942">NlMsghdr</span><span class="op" id="2395950">,</span>&nbsp;<span class="op" id="2395952">[</span><span class="op" id="2395953">]</span><span class="builtintype" id="2395954">byte</span><span class="op" id="2395958">,</span>&nbsp;<span class="builtintype" id="2395960">int</span><span class="op" id="2395963">,</span>&nbsp;<span class="builtintype" id="2395965">error</span><span class="op" id="2395970">)</span>&nbsp;<span class="op" id="2395972">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2395975">h</span>&nbsp;<span class="op" id="2395977">:=</span>&nbsp;<span class="op" id="2395980">(</span><span class="op" id="2395981">*</span><span class="ident" id="2395982">NlMsghdr</span><span class="op" id="2395990">)</span><span class="op" id="2395991">(</span><span class="ident" id="2395992">unsafe</span><span class="op" id="2395998">.</span><span class="ident" id="2395999">Pointer</span><span class="op" id="2396006">(</span><span class="op" id="2396007">&amp;</span><span class="ident" id="2396008">b</span><span class="op" id="2396009">[</span><span class="num" id="2396010">0</span><span class="op" id="2396011">]</span><span class="op" id="2396012">)</span><span class="op" id="2396013">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396016">if</span>&nbsp;<span class="builtintype" id="2396019">int</span><span class="op" id="2396022">(</span><span class="ident" id="2396023">h</span><span class="op" id="2396024">.</span><span class="ident" id="2396025">Len</span><span class="op" id="2396028">)</span>&nbsp;<span class="op" id="2396030">&lt;</span>&nbsp;<span class="ident" id="2396032">NLMSG_HDRLEN</span>&nbsp;<span class="op" id="2396045">||</span>&nbsp;<span class="builtintype" id="2396048">int</span><span class="op" id="2396051">(</span><span class="ident" id="2396052">h</span><span class="op" id="2396053">.</span><span class="ident" id="2396054">Len</span><span class="op" id="2396057">)</span>&nbsp;<span class="op" id="2396059">&gt;</span>&nbsp;<span class="builtinfunc" id="2396061">len</span><span class="op" id="2396064">(</span><span class="ident" id="2396065">b</span><span class="op" id="2396066">)</span>&nbsp;<span class="op" id="2396068">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396072">return</span>&nbsp;<span class="builtintype" id="2396079">nil</span><span class="op" id="2396082">,</span>&nbsp;<span class="builtintype" id="2396084">nil</span><span class="op" id="2396087">,</span>&nbsp;<span class="num" id="2396089">0</span><span class="op" id="2396090">,</span>&nbsp;<span class="ident" id="2396092">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2396100">}</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396103">return</span>&nbsp;<span class="ident" id="2396110">h</span><span class="op" id="2396111">,</span>&nbsp;<span class="ident" id="2396113">b</span><span class="op" id="2396114">[</span><span class="ident" id="2396115">NLMSG_HDRLEN</span><span class="op" id="2396127">:</span><span class="op" id="2396128">]</span><span class="op" id="2396129">,</span>&nbsp;<span class="ident" id="2396131">nlmAlignOf</span><span class="op" id="2396141">(</span><span class="builtintype" id="2396142">int</span><span class="op" id="2396145">(</span><span class="ident" id="2396146">h</span><span class="op" id="2396147">.</span><span class="ident" id="2396148">Len</span><span class="op" id="2396151">)</span><span class="op" id="2396152">)</span><span class="op" id="2396153">,</span>&nbsp;<span class="builtintype" id="2396155">nil</span><br>
<span class="lineno"></span><span class="op" id="2396159">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2396162">//&nbsp;NetlinkRouteAttr&nbsp;represents&nbsp;a&nbsp;netlink&nbsp;route&nbsp;attribute.</span><br>
<span class="lineno"></span><span class="keyword" id="2396220">type</span>&nbsp;<span class="ident" id="2396225">NetlinkRouteAttr</span>&nbsp;<span class="keyword" id="2396242">struct</span>&nbsp;<span class="op" id="2396249">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2396252">Attr</span>&nbsp;&nbsp;<span class="ident" id="2396258">RtAttr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2396266">Value</span>&nbsp;<span class="op" id="2396272">[</span><span class="op" id="2396273">]</span><span class="builtintype" id="2396274">byte</span><br>
<span class="lineno"></span><span class="op" id="2396279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2396282">//&nbsp;ParseNetlinkRouteAttr&nbsp;parses&nbsp;m&#39;s&nbsp;payload&nbsp;as&nbsp;an&nbsp;array&nbsp;of&nbsp;netlink</span><br>
<span class="lineno">145</span><span class="comment" id="2396349">//&nbsp;route&nbsp;attributes&nbsp;and&nbsp;returns&nbsp;the&nbsp;slice&nbsp;containing&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2396406">//&nbsp;NetlinkRouteAttr&nbsp;structures.</span><br>
<span class="lineno"></span><span class="keyword" id="2396438">func</span>&nbsp;<span class="ident" id="2396443">ParseNetlinkRouteAttr</span><span class="op" id="2396464">(</span><span class="ident" id="2396465">m</span>&nbsp;<span class="op" id="2396467">*</span><span class="ident" id="2396468">NetlinkMessage</span><span class="op" id="2396482">)</span>&nbsp;<span class="op" id="2396484">(</span><span class="op" id="2396485">[</span><span class="op" id="2396486">]</span><span class="ident" id="2396487">NetlinkRouteAttr</span><span class="op" id="2396503">,</span>&nbsp;<span class="builtintype" id="2396505">error</span><span class="op" id="2396510">)</span>&nbsp;<span class="op" id="2396512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396515">var</span>&nbsp;<span class="ident" id="2396519">b</span>&nbsp;<span class="op" id="2396521">[</span><span class="op" id="2396522">]</span><span class="builtintype" id="2396523">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396529">switch</span>&nbsp;<span class="ident" id="2396536">m</span><span class="op" id="2396537">.</span><span class="ident" id="2396538">Header</span><span class="op" id="2396544">.</span><span class="ident" id="2396545">Type</span>&nbsp;<span class="op" id="2396550">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396553">case</span>&nbsp;<span class="ident" id="2396558">RTM_NEWLINK</span><span class="op" id="2396569">,</span>&nbsp;<span class="ident" id="2396571">RTM_DELLINK</span><span class="op" id="2396582">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2396586">b</span>&nbsp;<span class="op" id="2396588">=</span>&nbsp;<span class="ident" id="2396590">m</span><span class="op" id="2396591">.</span><span class="ident" id="2396592">Data</span><span class="op" id="2396596">[</span><span class="ident" id="2396597">SizeofIfInfomsg</span><span class="op" id="2396612">:</span><span class="op" id="2396613">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396616">case</span>&nbsp;<span class="ident" id="2396621">RTM_NEWADDR</span><span class="op" id="2396632">,</span>&nbsp;<span class="ident" id="2396634">RTM_DELADDR</span><span class="op" id="2396645">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2396649">b</span>&nbsp;<span class="op" id="2396651">=</span>&nbsp;<span class="ident" id="2396653">m</span><span class="op" id="2396654">.</span><span class="ident" id="2396655">Data</span><span class="op" id="2396659">[</span><span class="ident" id="2396660">SizeofIfAddrmsg</span><span class="op" id="2396675">:</span><span class="op" id="2396676">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396679">case</span>&nbsp;<span class="ident" id="2396684">RTM_NEWROUTE</span><span class="op" id="2396696">,</span>&nbsp;<span class="ident" id="2396698">RTM_DELROUTE</span><span class="op" id="2396710">:</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2396714">b</span>&nbsp;<span class="op" id="2396716">=</span>&nbsp;<span class="ident" id="2396718">m</span><span class="op" id="2396719">.</span><span class="ident" id="2396720">Data</span><span class="op" id="2396724">[</span><span class="ident" id="2396725">SizeofRtMsg</span><span class="op" id="2396736">:</span><span class="op" id="2396737">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396740">default</span><span class="op" id="2396747">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396751">return</span>&nbsp;<span class="builtintype" id="2396758">nil</span><span class="op" id="2396761">,</span>&nbsp;<span class="ident" id="2396763">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2396771">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396774">var</span>&nbsp;<span class="ident" id="2396778">attrs</span>&nbsp;<span class="op" id="2396784">[</span><span class="op" id="2396785">]</span><span class="ident" id="2396786">NetlinkRouteAttr</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396804">for</span>&nbsp;<span class="builtinfunc" id="2396808">len</span><span class="op" id="2396811">(</span><span class="ident" id="2396812">b</span><span class="op" id="2396813">)</span>&nbsp;<span class="op" id="2396815">&gt;=</span>&nbsp;<span class="ident" id="2396818">SizeofRtAttr</span>&nbsp;<span class="op" id="2396831">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2396835">a</span><span class="op" id="2396836">,</span>&nbsp;<span class="ident" id="2396838">vbuf</span><span class="op" id="2396842">,</span>&nbsp;<span class="ident" id="2396844">alen</span><span class="op" id="2396848">,</span>&nbsp;<span class="ident" id="2396850">err</span>&nbsp;<span class="op" id="2396854">:=</span>&nbsp;<span class="ident" id="2396857">netlinkRouteAttrAndValue</span><span class="op" id="2396881">(</span><span class="ident" id="2396882">b</span><span class="op" id="2396883">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396887">if</span>&nbsp;<span class="ident" id="2396890">err</span>&nbsp;<span class="op" id="2396894">!=</span>&nbsp;<span class="builtintype" id="2396897">nil</span>&nbsp;<span class="op" id="2396901">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2396906">return</span>&nbsp;<span class="builtintype" id="2396913">nil</span><span class="op" id="2396916">,</span>&nbsp;<span class="ident" id="2396918">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2396924">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2396928">ra</span>&nbsp;<span class="op" id="2396931">:=</span>&nbsp;<span class="ident" id="2396934">NetlinkRouteAttr</span><span class="op" id="2396950">{</span><span class="ident" id="2396951">Attr</span><span class="op" id="2396955">:</span>&nbsp;<span class="op" id="2396957">*</span><span class="ident" id="2396958">a</span><span class="op" id="2396959">,</span>&nbsp;<span class="ident" id="2396961">Value</span><span class="op" id="2396966">:</span>&nbsp;<span class="ident" id="2396968">vbuf</span><span class="op" id="2396972">[</span><span class="op" id="2396973">:</span><span class="builtintype" id="2396974">int</span><span class="op" id="2396977">(</span><span class="ident" id="2396978">a</span><span class="op" id="2396979">.</span><span class="ident" id="2396980">Len</span><span class="op" id="2396983">)</span><span class="op" id="2396984">-</span><span class="ident" id="2396985">SizeofRtAttr</span><span class="op" id="2396997">]</span><span class="op" id="2396998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397002">attrs</span>&nbsp;<span class="op" id="2397008">=</span>&nbsp;<span class="builtinfunc" id="2397010">append</span><span class="op" id="2397016">(</span><span class="ident" id="2397017">attrs</span><span class="op" id="2397022">,</span>&nbsp;<span class="ident" id="2397024">ra</span><span class="op" id="2397026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397030">b</span>&nbsp;<span class="op" id="2397032">=</span>&nbsp;<span class="ident" id="2397034">b</span><span class="op" id="2397035">[</span><span class="ident" id="2397036">alen</span><span class="op" id="2397040">:</span><span class="op" id="2397041">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2397044">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2397047">return</span>&nbsp;<span class="ident" id="2397054">attrs</span><span class="op" id="2397059">,</span>&nbsp;<span class="builtintype" id="2397061">nil</span><br>
<span class="lineno">170</span><span class="op" id="2397065">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="2397068">func</span>&nbsp;<span class="ident" id="2397073">netlinkRouteAttrAndValue</span><span class="op" id="2397097">(</span><span class="ident" id="2397098">b</span>&nbsp;<span class="op" id="2397100">[</span><span class="op" id="2397101">]</span><span class="builtintype" id="2397102">byte</span><span class="op" id="2397106">)</span>&nbsp;<span class="op" id="2397108">(</span><span class="op" id="2397109">*</span><span class="ident" id="2397110">RtAttr</span><span class="op" id="2397116">,</span>&nbsp;<span class="op" id="2397118">[</span><span class="op" id="2397119">]</span><span class="builtintype" id="2397120">byte</span><span class="op" id="2397124">,</span>&nbsp;<span class="builtintype" id="2397126">int</span><span class="op" id="2397129">,</span>&nbsp;<span class="builtintype" id="2397131">error</span><span class="op" id="2397136">)</span>&nbsp;<span class="op" id="2397138">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2397141">a</span>&nbsp;<span class="op" id="2397143">:=</span>&nbsp;<span class="op" id="2397146">(</span><span class="op" id="2397147">*</span><span class="ident" id="2397148">RtAttr</span><span class="op" id="2397154">)</span><span class="op" id="2397155">(</span><span class="ident" id="2397156">unsafe</span><span class="op" id="2397162">.</span><span class="ident" id="2397163">Pointer</span><span class="op" id="2397170">(</span><span class="op" id="2397171">&amp;</span><span class="ident" id="2397172">b</span><span class="op" id="2397173">[</span><span class="num" id="2397174">0</span><span class="op" id="2397175">]</span><span class="op" id="2397176">)</span><span class="op" id="2397177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2397180">if</span>&nbsp;<span class="builtintype" id="2397183">int</span><span class="op" id="2397186">(</span><span class="ident" id="2397187">a</span><span class="op" id="2397188">.</span><span class="ident" id="2397189">Len</span><span class="op" id="2397192">)</span>&nbsp;<span class="op" id="2397194">&lt;</span>&nbsp;<span class="ident" id="2397196">SizeofRtAttr</span>&nbsp;<span class="op" id="2397209">||</span>&nbsp;<span class="builtintype" id="2397212">int</span><span class="op" id="2397215">(</span><span class="ident" id="2397216">a</span><span class="op" id="2397217">.</span><span class="ident" id="2397218">Len</span><span class="op" id="2397221">)</span>&nbsp;<span class="op" id="2397223">&gt;</span>&nbsp;<span class="builtinfunc" id="2397225">len</span><span class="op" id="2397228">(</span><span class="ident" id="2397229">b</span><span class="op" id="2397230">)</span>&nbsp;<span class="op" id="2397232">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2397236">return</span>&nbsp;<span class="builtintype" id="2397243">nil</span><span class="op" id="2397246">,</span>&nbsp;<span class="builtintype" id="2397248">nil</span><span class="op" id="2397251">,</span>&nbsp;<span class="num" id="2397253">0</span><span class="op" id="2397254">,</span>&nbsp;<span class="ident" id="2397256">EINVAL</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2397264">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2397267">return</span>&nbsp;<span class="ident" id="2397274">a</span><span class="op" id="2397275">,</span>&nbsp;<span class="ident" id="2397277">b</span><span class="op" id="2397278">[</span><span class="ident" id="2397279">SizeofRtAttr</span><span class="op" id="2397291">:</span><span class="op" id="2397292">]</span><span class="op" id="2397293">,</span>&nbsp;<span class="ident" id="2397295">rtaAlignOf</span><span class="op" id="2397305">(</span><span class="builtintype" id="2397306">int</span><span class="op" id="2397309">(</span><span class="ident" id="2397310">a</span><span class="op" id="2397311">.</span><span class="ident" id="2397312">Len</span><span class="op" id="2397315">)</span><span class="op" id="2397316">)</span><span class="op" id="2397317">,</span>&nbsp;<span class="builtintype" id="2397319">nil</span><br>
<span class="lineno"></span><span class="op" id="2397323">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
