<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/cmplx</h2>
<ul>
<li><a href="/gostd/math/cmplx/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/cmplx/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/cmplx/cmath_test.go.html">cmath_test.go</a></li>
<li><a href="/gostd/math/cmplx/conj.go.html">conj.go</a></li>
<li><a href="/gostd/math/cmplx/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/cmplx/isinf.go.html">isinf.go</a></li>
<li><a href="/gostd/math/cmplx/isnan.go.html">isnan.go</a></li>
<li><a href="/gostd/math/cmplx/log.go.html">log.go</a></li>
<li><a href="/gostd/math/cmplx/phase.go.html">phase.go</a></li>
<li><a href="/gostd/math/cmplx/polar.go.html">polar.go</a></li>
<li><a href="/gostd/math/cmplx/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/cmplx/rect.go.html">rect.go</a></li>
<li><a href="/gostd/math/cmplx/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/cmplx/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/cmplx/tan.go.html" class="current">tan.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="6266136">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6266191">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6266245">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6266296">package</span>&nbsp;<span class="ident" id="6266304">cmplx</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6266311">import</span>&nbsp;<span class="string" id="6266318">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6266326">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno">10</span><span class="comment" id="6266386">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/c9x-complex/clog.c.</span><br>
<span class="lineno"></span><span class="comment" id="6266456">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="6266514">//</span><br>
<span class="lineno"></span><span class="comment" id="6266517">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="6266565">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">15</span><span class="comment" id="6266629">//</span><br>
<span class="lineno"></span><span class="comment" id="6266632">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="6266693">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="6266763">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="6266838">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">20</span><span class="comment" id="6266905">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="6266978">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="6267050">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="6267064">//</span><br>
<span class="lineno"></span><span class="comment" id="6267067">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">25</span><span class="comment" id="6267133">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="6267199">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="6267212">//</span><br>
<span class="lineno"></span><span class="comment" id="6267215">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="6267239">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="6267269">//&nbsp;Complex&nbsp;circular&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="6267297">//</span><br>
<span class="lineno"></span><span class="comment" id="6267300">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6267316">//</span><br>
<span class="lineno">35</span><span class="comment" id="6267319">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="6267325">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno"></span><span class="comment" id="6267344">//</span><br>
<span class="lineno"></span><span class="comment" id="6267347">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6267355">//</span><br>
<span class="lineno">40</span><span class="comment" id="6267358">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="6267392">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno"></span><span class="comment" id="6267427">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cos&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;cosh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="6267460">//</span><br>
<span class="lineno"></span><span class="comment" id="6267463">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis&nbsp;the&nbsp;denominator&nbsp;is&nbsp;zero&nbsp;at&nbsp;odd&nbsp;multiples</span><br>
<span class="lineno">45</span><span class="comment" id="6267524">//&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;The&nbsp;denominator&nbsp;is&nbsp;evaluated&nbsp;by&nbsp;its&nbsp;Taylor</span><br>
<span class="lineno"></span><span class="comment" id="6267580">//&nbsp;series&nbsp;near&nbsp;these&nbsp;points.</span><br>
<span class="lineno"></span><span class="comment" id="6267609">//</span><br>
<span class="lineno"></span><span class="comment" id="6267612">//&nbsp;ctan(z)&nbsp;=&nbsp;-i&nbsp;ctanh(iz).</span><br>
<span class="lineno"></span><span class="comment" id="6267639">//</span><br>
<span class="lineno">50</span><span class="comment" id="6267642">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6267655">//</span><br>
<span class="lineno"></span><span class="comment" id="6267658">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6267698">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno"></span><span class="comment" id="6267756">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5200&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.1e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno">55</span><span class="comment" id="6267816">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;7.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="6267876">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;and&nbsp;catan(ctan(z))&nbsp;&nbsp;=&nbsp;&nbsp;z.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6267937">//&nbsp;Tan&nbsp;returns&nbsp;the&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="6267970">func</span>&nbsp;<span class="ident" id="6267975">Tan</span><span class="op" id="6267978">(</span><span class="ident" id="6267979">x</span>&nbsp;<span class="builtintype" id="6267981">complex128</span><span class="op" id="6267991">)</span>&nbsp;<span class="builtintype" id="6267993">complex128</span>&nbsp;<span class="op" id="6268004">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6268007">d</span>&nbsp;<span class="op" id="6268009">:=</span>&nbsp;<span class="ident" id="6268012">math</span><span class="op" id="6268016">.</span><span class="ident" id="6268017">Cos</span><span class="op" id="6268020">(</span><span class="num" id="6268021">2</span><span class="op" id="6268022">*</span><span class="builtinfunc" id="6268023">real</span><span class="op" id="6268027">(</span><span class="ident" id="6268028">x</span><span class="op" id="6268029">)</span><span class="op" id="6268030">)</span>&nbsp;<span class="op" id="6268032">+</span>&nbsp;<span class="ident" id="6268034">math</span><span class="op" id="6268038">.</span><span class="ident" id="6268039">Cosh</span><span class="op" id="6268043">(</span><span class="num" id="6268044">2</span><span class="op" id="6268045">*</span><span class="builtinfunc" id="6268046">imag</span><span class="op" id="6268050">(</span><span class="ident" id="6268051">x</span><span class="op" id="6268052">)</span><span class="op" id="6268053">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268056">if</span>&nbsp;<span class="ident" id="6268059">math</span><span class="op" id="6268063">.</span><span class="ident" id="6268064">Abs</span><span class="op" id="6268067">(</span><span class="ident" id="6268068">d</span><span class="op" id="6268069">)</span>&nbsp;<span class="op" id="6268071">&lt;</span>&nbsp;<span class="num" id="6268073">0.25</span>&nbsp;<span class="op" id="6268078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6268082">d</span>&nbsp;<span class="op" id="6268084">=</span>&nbsp;<span class="ident" id="6268086">tanSeries</span><span class="op" id="6268095">(</span><span class="ident" id="6268096">x</span><span class="op" id="6268097">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6268100">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268103">if</span>&nbsp;<span class="ident" id="6268106">d</span>&nbsp;<span class="op" id="6268108">==</span>&nbsp;<span class="num" id="6268111">0</span>&nbsp;<span class="op" id="6268113">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268117">return</span>&nbsp;<span class="ident" id="6268124">Inf</span><span class="op" id="6268127">(</span><span class="op" id="6268128">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6268131">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268134">return</span>&nbsp;<span class="builtinfunc" id="6268141">complex</span><span class="op" id="6268148">(</span><span class="ident" id="6268149">math</span><span class="op" id="6268153">.</span><span class="ident" id="6268154">Sin</span><span class="op" id="6268157">(</span><span class="num" id="6268158">2</span><span class="op" id="6268159">*</span><span class="builtinfunc" id="6268160">real</span><span class="op" id="6268164">(</span><span class="ident" id="6268165">x</span><span class="op" id="6268166">)</span><span class="op" id="6268167">)</span><span class="op" id="6268168">/</span><span class="ident" id="6268169">d</span><span class="op" id="6268170">,</span>&nbsp;<span class="ident" id="6268172">math</span><span class="op" id="6268176">.</span><span class="ident" id="6268177">Sinh</span><span class="op" id="6268181">(</span><span class="num" id="6268182">2</span><span class="op" id="6268183">*</span><span class="builtinfunc" id="6268184">imag</span><span class="op" id="6268188">(</span><span class="ident" id="6268189">x</span><span class="op" id="6268190">)</span><span class="op" id="6268191">)</span><span class="op" id="6268192">/</span><span class="ident" id="6268193">d</span><span class="op" id="6268194">)</span><br>
<span class="lineno"></span><span class="op" id="6268196">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="6268199">//&nbsp;Complex&nbsp;hyperbolic&nbsp;tangent</span><br>
<span class="lineno"></span><span class="comment" id="6268229">//</span><br>
<span class="lineno"></span><span class="comment" id="6268232">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6268248">//</span><br>
<span class="lineno"></span><span class="comment" id="6268251">//&nbsp;tanh&nbsp;z&nbsp;=&nbsp;(sinh&nbsp;2x&nbsp;&nbsp;+&nbsp;&nbsp;i&nbsp;sin&nbsp;2y)&nbsp;/&nbsp;(cosh&nbsp;2x&nbsp;+&nbsp;cos&nbsp;2y)&nbsp;.</span><br>
<span class="lineno">75</span><span class="comment" id="6268309">//</span><br>
<span class="lineno"></span><span class="comment" id="6268312">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6268325">//</span><br>
<span class="lineno"></span><span class="comment" id="6268328">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6268368">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">80</span><span class="comment" id="6268426">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.7e-14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.4e-16</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6268487">//&nbsp;Tanh&nbsp;returns&nbsp;the&nbsp;hyperbolic&nbsp;tangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="keyword" id="6268532">func</span>&nbsp;<span class="ident" id="6268537">Tanh</span><span class="op" id="6268541">(</span><span class="ident" id="6268542">x</span>&nbsp;<span class="builtintype" id="6268544">complex128</span><span class="op" id="6268554">)</span>&nbsp;<span class="builtintype" id="6268556">complex128</span>&nbsp;<span class="op" id="6268567">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6268570">d</span>&nbsp;<span class="op" id="6268572">:=</span>&nbsp;<span class="ident" id="6268575">math</span><span class="op" id="6268579">.</span><span class="ident" id="6268580">Cosh</span><span class="op" id="6268584">(</span><span class="num" id="6268585">2</span><span class="op" id="6268586">*</span><span class="builtinfunc" id="6268587">real</span><span class="op" id="6268591">(</span><span class="ident" id="6268592">x</span><span class="op" id="6268593">)</span><span class="op" id="6268594">)</span>&nbsp;<span class="op" id="6268596">+</span>&nbsp;<span class="ident" id="6268598">math</span><span class="op" id="6268602">.</span><span class="ident" id="6268603">Cos</span><span class="op" id="6268606">(</span><span class="num" id="6268607">2</span><span class="op" id="6268608">*</span><span class="builtinfunc" id="6268609">imag</span><span class="op" id="6268613">(</span><span class="ident" id="6268614">x</span><span class="op" id="6268615">)</span><span class="op" id="6268616">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268619">if</span>&nbsp;<span class="ident" id="6268622">d</span>&nbsp;<span class="op" id="6268624">==</span>&nbsp;<span class="num" id="6268627">0</span>&nbsp;<span class="op" id="6268629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268633">return</span>&nbsp;<span class="ident" id="6268640">Inf</span><span class="op" id="6268643">(</span><span class="op" id="6268644">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6268647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268650">return</span>&nbsp;<span class="builtinfunc" id="6268657">complex</span><span class="op" id="6268664">(</span><span class="ident" id="6268665">math</span><span class="op" id="6268669">.</span><span class="ident" id="6268670">Sinh</span><span class="op" id="6268674">(</span><span class="num" id="6268675">2</span><span class="op" id="6268676">*</span><span class="builtinfunc" id="6268677">real</span><span class="op" id="6268681">(</span><span class="ident" id="6268682">x</span><span class="op" id="6268683">)</span><span class="op" id="6268684">)</span><span class="op" id="6268685">/</span><span class="ident" id="6268686">d</span><span class="op" id="6268687">,</span>&nbsp;<span class="ident" id="6268689">math</span><span class="op" id="6268693">.</span><span class="ident" id="6268694">Sin</span><span class="op" id="6268697">(</span><span class="num" id="6268698">2</span><span class="op" id="6268699">*</span><span class="builtinfunc" id="6268700">imag</span><span class="op" id="6268704">(</span><span class="ident" id="6268705">x</span><span class="op" id="6268706">)</span><span class="op" id="6268707">)</span><span class="op" id="6268708">/</span><span class="ident" id="6268709">d</span><span class="op" id="6268710">)</span><br>
<span class="lineno"></span><span class="op" id="6268712">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="6268715">//&nbsp;Program&nbsp;to&nbsp;subtract&nbsp;nearest&nbsp;integer&nbsp;multiple&nbsp;of&nbsp;PI</span><br>
<span class="lineno"></span><span class="keyword" id="6268769">func</span>&nbsp;<span class="ident" id="6268774">reducePi</span><span class="op" id="6268782">(</span><span class="ident" id="6268783">x</span>&nbsp;<span class="builtintype" id="6268785">float64</span><span class="op" id="6268792">)</span>&nbsp;<span class="builtintype" id="6268794">float64</span>&nbsp;<span class="op" id="6268802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6268805">const</span>&nbsp;<span class="op" id="6268811">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6268815">//&nbsp;extended&nbsp;precision&nbsp;value&nbsp;of&nbsp;PI:</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6268852">DP1</span>&nbsp;<span class="op" id="6268856">=</span>&nbsp;<span class="num" id="6268858">3.14159265160560607910E0</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6268885">//&nbsp;??&nbsp;0x400921fb54000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6268912">DP2</span>&nbsp;<span class="op" id="6268916">=</span>&nbsp;<span class="num" id="6268918">1.98418714791870343106E-9</span>&nbsp;&nbsp;<span class="comment" id="6268945">//&nbsp;??&nbsp;0x3e210b4610000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6268972">DP3</span>&nbsp;<span class="op" id="6268976">=</span>&nbsp;<span class="num" id="6268978">1.14423774522196636802E-17</span>&nbsp;<span class="comment" id="6269005">//&nbsp;??&nbsp;0x3c6a62633145c06e</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6269031">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269034">t</span>&nbsp;<span class="op" id="6269036">:=</span>&nbsp;<span class="ident" id="6269039">x</span>&nbsp;<span class="op" id="6269041">/</span>&nbsp;<span class="ident" id="6269043">math</span><span class="op" id="6269047">.</span><span class="ident" id="6269048">Pi</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6269052">if</span>&nbsp;<span class="ident" id="6269055">t</span>&nbsp;<span class="op" id="6269057">&gt;=</span>&nbsp;<span class="num" id="6269060">0</span>&nbsp;<span class="op" id="6269062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269066">t</span>&nbsp;<span class="op" id="6269068">+=</span>&nbsp;<span class="num" id="6269071">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6269076">}</span>&nbsp;<span class="keyword" id="6269078">else</span>&nbsp;<span class="op" id="6269083">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269087">t</span>&nbsp;<span class="op" id="6269089">-=</span>&nbsp;<span class="num" id="6269092">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6269097">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269100">t</span>&nbsp;<span class="op" id="6269102">=</span>&nbsp;<span class="builtintype" id="6269104">float64</span><span class="op" id="6269111">(</span><span class="ident" id="6269112">int64</span><span class="op" id="6269117">(</span><span class="ident" id="6269118">t</span><span class="op" id="6269119">)</span><span class="op" id="6269120">)</span>&nbsp;<span class="comment" id="6269122">//&nbsp;int64(t)&nbsp;=&nbsp;the&nbsp;multiple</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6269150">return</span>&nbsp;<span class="op" id="6269157">(</span><span class="op" id="6269158">(</span><span class="ident" id="6269159">x</span>&nbsp;<span class="op" id="6269161">-</span>&nbsp;<span class="ident" id="6269163">t</span><span class="op" id="6269164">*</span><span class="ident" id="6269165">DP1</span><span class="op" id="6269168">)</span>&nbsp;<span class="op" id="6269170">-</span>&nbsp;<span class="ident" id="6269172">t</span><span class="op" id="6269173">*</span><span class="ident" id="6269174">DP2</span><span class="op" id="6269177">)</span>&nbsp;<span class="op" id="6269179">-</span>&nbsp;<span class="ident" id="6269181">t</span><span class="op" id="6269182">*</span><span class="ident" id="6269183">DP3</span><br>
<span class="lineno"></span><span class="op" id="6269187">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6269190">//&nbsp;Taylor&nbsp;series&nbsp;expansion&nbsp;for&nbsp;cosh(2y)&nbsp;-&nbsp;cos(2x)</span><br>
<span class="lineno">110</span><span class="keyword" id="6269240">func</span>&nbsp;<span class="ident" id="6269245">tanSeries</span><span class="op" id="6269254">(</span><span class="ident" id="6269255">z</span>&nbsp;<span class="builtintype" id="6269257">complex128</span><span class="op" id="6269267">)</span>&nbsp;<span class="builtintype" id="6269269">float64</span>&nbsp;<span class="op" id="6269277">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6269280">const</span>&nbsp;<span class="ident" id="6269286">MACHEP</span>&nbsp;<span class="op" id="6269293">=</span>&nbsp;<span class="num" id="6269295">1.0</span>&nbsp;<span class="op" id="6269299">/</span>&nbsp;<span class="op" id="6269301">(</span><span class="num" id="6269302">1</span>&nbsp;<span class="op" id="6269304">&lt;&lt;</span>&nbsp;<span class="num" id="6269307">53</span><span class="op" id="6269309">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269312">x</span>&nbsp;<span class="op" id="6269314">:=</span>&nbsp;<span class="ident" id="6269317">math</span><span class="op" id="6269321">.</span><span class="ident" id="6269322">Abs</span><span class="op" id="6269325">(</span><span class="num" id="6269326">2</span>&nbsp;<span class="op" id="6269328">*</span>&nbsp;<span class="builtinfunc" id="6269330">real</span><span class="op" id="6269334">(</span><span class="ident" id="6269335">z</span><span class="op" id="6269336">)</span><span class="op" id="6269337">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269340">y</span>&nbsp;<span class="op" id="6269342">:=</span>&nbsp;<span class="ident" id="6269345">math</span><span class="op" id="6269349">.</span><span class="ident" id="6269350">Abs</span><span class="op" id="6269353">(</span><span class="num" id="6269354">2</span>&nbsp;<span class="op" id="6269356">*</span>&nbsp;<span class="builtinfunc" id="6269358">imag</span><span class="op" id="6269362">(</span><span class="ident" id="6269363">z</span><span class="op" id="6269364">)</span><span class="op" id="6269365">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269368">x</span>&nbsp;<span class="op" id="6269370">=</span>&nbsp;<span class="ident" id="6269372">reducePi</span><span class="op" id="6269380">(</span><span class="ident" id="6269381">x</span><span class="op" id="6269382">)</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269385">x</span>&nbsp;<span class="op" id="6269387">=</span>&nbsp;<span class="ident" id="6269389">x</span>&nbsp;<span class="op" id="6269391">*</span>&nbsp;<span class="ident" id="6269393">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269396">y</span>&nbsp;<span class="op" id="6269398">=</span>&nbsp;<span class="ident" id="6269400">y</span>&nbsp;<span class="op" id="6269402">*</span>&nbsp;<span class="ident" id="6269404">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269407">x2</span>&nbsp;<span class="op" id="6269410">:=</span>&nbsp;<span class="num" id="6269413">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269418">y2</span>&nbsp;<span class="op" id="6269421">:=</span>&nbsp;<span class="num" id="6269424">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269429">f</span>&nbsp;<span class="op" id="6269431">:=</span>&nbsp;<span class="num" id="6269434">1.0</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269439">rn</span>&nbsp;<span class="op" id="6269442">:=</span>&nbsp;<span class="num" id="6269445">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269450">d</span>&nbsp;<span class="op" id="6269452">:=</span>&nbsp;<span class="num" id="6269455">0.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6269460">for</span>&nbsp;<span class="op" id="6269464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269468">rn</span>&nbsp;<span class="op" id="6269471">+=</span>&nbsp;<span class="num" id="6269474">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269478">f</span>&nbsp;<span class="op" id="6269480">*=</span>&nbsp;<span class="ident" id="6269483">rn</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269488">rn</span>&nbsp;<span class="op" id="6269491">+=</span>&nbsp;<span class="num" id="6269494">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269498">f</span>&nbsp;<span class="op" id="6269500">*=</span>&nbsp;<span class="ident" id="6269503">rn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269508">x2</span>&nbsp;<span class="op" id="6269511">*=</span>&nbsp;<span class="ident" id="6269514">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269518">y2</span>&nbsp;<span class="op" id="6269521">*=</span>&nbsp;<span class="ident" id="6269524">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269528">t</span>&nbsp;<span class="op" id="6269530">:=</span>&nbsp;<span class="ident" id="6269533">y2</span>&nbsp;<span class="op" id="6269536">+</span>&nbsp;<span class="ident" id="6269538">x2</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269543">t</span>&nbsp;<span class="op" id="6269545">/=</span>&nbsp;<span class="ident" id="6269548">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269552">d</span>&nbsp;<span class="op" id="6269554">+=</span>&nbsp;<span class="ident" id="6269557">t</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269562">rn</span>&nbsp;<span class="op" id="6269565">+=</span>&nbsp;<span class="num" id="6269568">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269572">f</span>&nbsp;<span class="op" id="6269574">*=</span>&nbsp;<span class="ident" id="6269577">rn</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269582">rn</span>&nbsp;<span class="op" id="6269585">+=</span>&nbsp;<span class="num" id="6269588">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269592">f</span>&nbsp;<span class="op" id="6269594">*=</span>&nbsp;<span class="ident" id="6269597">rn</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269602">x2</span>&nbsp;<span class="op" id="6269605">*=</span>&nbsp;<span class="ident" id="6269608">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269612">y2</span>&nbsp;<span class="op" id="6269615">*=</span>&nbsp;<span class="ident" id="6269618">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269622">t</span>&nbsp;<span class="op" id="6269624">=</span>&nbsp;<span class="ident" id="6269626">y2</span>&nbsp;<span class="op" id="6269629">-</span>&nbsp;<span class="ident" id="6269631">x2</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269636">t</span>&nbsp;<span class="op" id="6269638">/=</span>&nbsp;<span class="ident" id="6269641">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6269645">d</span>&nbsp;<span class="op" id="6269647">+=</span>&nbsp;<span class="ident" id="6269650">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6269654">if</span>&nbsp;<span class="ident" id="6269657">math</span><span class="op" id="6269661">.</span><span class="ident" id="6269662">Abs</span><span class="op" id="6269665">(</span><span class="ident" id="6269666">t</span><span class="op" id="6269667">/</span><span class="ident" id="6269668">d</span><span class="op" id="6269669">)</span>&nbsp;<span class="op" id="6269671">&lt;=</span>&nbsp;<span class="ident" id="6269674">MACHEP</span>&nbsp;<span class="op" id="6269681">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6269686">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6269694">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6269697">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6269700">return</span>&nbsp;<span class="ident" id="6269707">d</span><br>
<span class="lineno"></span><span class="op" id="6269709">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6269712">//&nbsp;Complex&nbsp;circular&nbsp;cotangent</span><br>
<span class="lineno">150</span><span class="comment" id="6269742">//</span><br>
<span class="lineno"></span><span class="comment" id="6269745">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="6269761">//</span><br>
<span class="lineno"></span><span class="comment" id="6269764">//&nbsp;If</span><br>
<span class="lineno"></span><span class="comment" id="6269770">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;z&nbsp;=&nbsp;x&nbsp;+&nbsp;iy,</span><br>
<span class="lineno">155</span><span class="comment" id="6269789">//</span><br>
<span class="lineno"></span><span class="comment" id="6269792">//&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="6269800">//</span><br>
<span class="lineno"></span><span class="comment" id="6269803">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sin&nbsp;2x&nbsp;&nbsp;-&nbsp;&nbsp;i&nbsp;sinh&nbsp;2y</span><br>
<span class="lineno"></span><span class="comment" id="6269837">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;&nbsp;=&nbsp;&nbsp;--------------------.</span><br>
<span class="lineno">160</span><span class="comment" id="6269872">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;cosh&nbsp;2y&nbsp;&nbsp;-&nbsp;&nbsp;cos&nbsp;2x</span><br>
<span class="lineno"></span><span class="comment" id="6269905">//</span><br>
<span class="lineno"></span><span class="comment" id="6269908">//&nbsp;On&nbsp;the&nbsp;real&nbsp;axis,&nbsp;the&nbsp;denominator&nbsp;has&nbsp;zeros&nbsp;at&nbsp;even</span><br>
<span class="lineno"></span><span class="comment" id="6269963">//&nbsp;multiples&nbsp;of&nbsp;PI/2.&nbsp;&nbsp;Near&nbsp;these&nbsp;points&nbsp;it&nbsp;is&nbsp;evaluated</span><br>
<span class="lineno"></span><span class="comment" id="6270020">//&nbsp;by&nbsp;a&nbsp;Taylor&nbsp;series.</span><br>
<span class="lineno">165</span><span class="comment" id="6270043">//</span><br>
<span class="lineno"></span><span class="comment" id="6270046">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="6270059">//</span><br>
<span class="lineno"></span><span class="comment" id="6270062">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="6270102">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">170</span><span class="comment" id="6270160">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6.5e-17&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.6e-17</span><br>
<span class="lineno"></span><span class="comment" id="6270220">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-10,+10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;30000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.2e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="6270280">//&nbsp;Also&nbsp;tested&nbsp;by&nbsp;ctan&nbsp;*&nbsp;ccot&nbsp;=&nbsp;1&nbsp;+&nbsp;i0.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6270321">//&nbsp;Cot&nbsp;returns&nbsp;the&nbsp;cotangent&nbsp;of&nbsp;x.</span><br>
<span class="lineno">175</span><span class="keyword" id="6270356">func</span>&nbsp;<span class="ident" id="6270361">Cot</span><span class="op" id="6270364">(</span><span class="ident" id="6270365">x</span>&nbsp;<span class="builtintype" id="6270367">complex128</span><span class="op" id="6270377">)</span>&nbsp;<span class="builtintype" id="6270379">complex128</span>&nbsp;<span class="op" id="6270390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6270393">d</span>&nbsp;<span class="op" id="6270395">:=</span>&nbsp;<span class="ident" id="6270398">math</span><span class="op" id="6270402">.</span><span class="ident" id="6270403">Cosh</span><span class="op" id="6270407">(</span><span class="num" id="6270408">2</span><span class="op" id="6270409">*</span><span class="builtinfunc" id="6270410">imag</span><span class="op" id="6270414">(</span><span class="ident" id="6270415">x</span><span class="op" id="6270416">)</span><span class="op" id="6270417">)</span>&nbsp;<span class="op" id="6270419">-</span>&nbsp;<span class="ident" id="6270421">math</span><span class="op" id="6270425">.</span><span class="ident" id="6270426">Cos</span><span class="op" id="6270429">(</span><span class="num" id="6270430">2</span><span class="op" id="6270431">*</span><span class="builtinfunc" id="6270432">real</span><span class="op" id="6270436">(</span><span class="ident" id="6270437">x</span><span class="op" id="6270438">)</span><span class="op" id="6270439">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270442">if</span>&nbsp;<span class="ident" id="6270445">math</span><span class="op" id="6270449">.</span><span class="ident" id="6270450">Abs</span><span class="op" id="6270453">(</span><span class="ident" id="6270454">d</span><span class="op" id="6270455">)</span>&nbsp;<span class="op" id="6270457">&lt;</span>&nbsp;<span class="num" id="6270459">0.25</span>&nbsp;<span class="op" id="6270464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6270468">d</span>&nbsp;<span class="op" id="6270470">=</span>&nbsp;<span class="ident" id="6270472">tanSeries</span><span class="op" id="6270481">(</span><span class="ident" id="6270482">x</span><span class="op" id="6270483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6270486">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270489">if</span>&nbsp;<span class="ident" id="6270492">d</span>&nbsp;<span class="op" id="6270494">==</span>&nbsp;<span class="num" id="6270497">0</span>&nbsp;<span class="op" id="6270499">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270503">return</span>&nbsp;<span class="ident" id="6270510">Inf</span><span class="op" id="6270513">(</span><span class="op" id="6270514">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6270517">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6270520">return</span>&nbsp;<span class="builtinfunc" id="6270527">complex</span><span class="op" id="6270534">(</span><span class="ident" id="6270535">math</span><span class="op" id="6270539">.</span><span class="ident" id="6270540">Sin</span><span class="op" id="6270543">(</span><span class="num" id="6270544">2</span><span class="op" id="6270545">*</span><span class="builtinfunc" id="6270546">real</span><span class="op" id="6270550">(</span><span class="ident" id="6270551">x</span><span class="op" id="6270552">)</span><span class="op" id="6270553">)</span><span class="op" id="6270554">/</span><span class="ident" id="6270555">d</span><span class="op" id="6270556">,</span>&nbsp;<span class="op" id="6270558">-</span><span class="ident" id="6270559">math</span><span class="op" id="6270563">.</span><span class="ident" id="6270564">Sinh</span><span class="op" id="6270568">(</span><span class="num" id="6270569">2</span><span class="op" id="6270570">*</span><span class="builtinfunc" id="6270571">imag</span><span class="op" id="6270575">(</span><span class="ident" id="6270576">x</span><span class="op" id="6270577">)</span><span class="op" id="6270578">)</span><span class="op" id="6270579">/</span><span class="ident" id="6270580">d</span><span class="op" id="6270581">)</span><br>
<span class="lineno"></span><span class="op" id="6270583">}</span>
</div>
</body>
</html>
