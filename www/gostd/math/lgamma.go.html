<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html" class="current">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2232597">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2232652">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2232706">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2232757">package</span>&nbsp;<span class="ident" id="2232765">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2232771">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;Floating-point&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="2232827">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="2232881">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_lgamma_r.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2232938">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="2232993">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="2233023">//</span><br>
<span class="lineno"></span><span class="comment" id="2233026">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2233082">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2233151">//</span><br>
<span class="lineno"></span><span class="comment" id="2233154">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="2233213">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="2233269">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="2233326">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="2233343">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="2233399">//</span><br>
<span class="lineno">25</span><span class="comment" id="2233402">//&nbsp;__ieee754_lgamma_r(x,&nbsp;signgamp)</span><br>
<span class="lineno"></span><span class="comment" id="2233437">//&nbsp;Reentrant&nbsp;version&nbsp;of&nbsp;the&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2233497">//&nbsp;with&nbsp;user&nbsp;provided&nbsp;pointer&nbsp;for&nbsp;the&nbsp;sign&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2233553">//</span><br>
<span class="lineno"></span><span class="comment" id="2233556">//&nbsp;Method:</span><br>
<span class="lineno">30</span><span class="comment" id="2233567">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;Reduction&nbsp;for&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;=&nbsp;8</span><br>
<span class="lineno"></span><span class="comment" id="2233609">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Since&nbsp;gamma(1+s)=s*gamma(s),&nbsp;for&nbsp;x&nbsp;in&nbsp;[0,8],&nbsp;we&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="2233669">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reduce&nbsp;x&nbsp;to&nbsp;a&nbsp;number&nbsp;in&nbsp;[1.5,2.5]&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2233714">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1+s)&nbsp;=&nbsp;log(s)&nbsp;+&nbsp;lgamma(s)</span><br>
<span class="lineno"></span><span class="comment" id="2233763">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;example,</span><br>
<span class="lineno">35</span><span class="comment" id="2233784">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(7.3)&nbsp;=&nbsp;log(6.3)&nbsp;+&nbsp;lgamma(6.3)</span><br>
<span class="lineno"></span><span class="comment" id="2233837">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3)&nbsp;+&nbsp;lgamma(5.3)</span><br>
<span class="lineno"></span><span class="comment" id="2233894">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3*4.3*3.3*2.3)&nbsp;+&nbsp;lgamma(2.3)</span><br>
<span class="lineno"></span><span class="comment" id="2233963">//&nbsp;&nbsp;&nbsp;2.&nbsp;Polynomial&nbsp;approximation&nbsp;of&nbsp;lgamma&nbsp;around&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="2234017">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;(ymin=1.461632144968362245)&nbsp;to&nbsp;maintain&nbsp;monotonicity.</span><br>
<span class="lineno">40</span><span class="comment" id="2234087">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;[ymin-0.23,&nbsp;ymin+0.27]&nbsp;(i.e.,&nbsp;[1.23164,1.73163]),&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="2234152">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;x-ymin;</span><br>
<span class="lineno"></span><span class="comment" id="2234184">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;-1.214862905358496078218&nbsp;+&nbsp;z**2*poly(z)</span><br>
<span class="lineno"></span><span class="comment" id="2234252">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;poly(z)&nbsp;is&nbsp;a&nbsp;14&nbsp;degree&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="comment" id="2234303">//&nbsp;&nbsp;&nbsp;2.&nbsp;Rational&nbsp;approximation&nbsp;in&nbsp;the&nbsp;primary&nbsp;interval&nbsp;[2,3]</span><br>
<span class="lineno">45</span><span class="comment" id="2234364">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;the&nbsp;following&nbsp;approximation:</span><br>
<span class="lineno"></span><span class="comment" id="2234408">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;=&nbsp;x-2.0;</span><br>
<span class="lineno"></span><span class="comment" id="2234435">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;0.5*s&nbsp;+&nbsp;s*P(s)/Q(s)</span><br>
<span class="lineno"></span><span class="comment" id="2234483">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;accuracy</span><br>
<span class="lineno"></span><span class="comment" id="2234505">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P/Q&nbsp;-&nbsp;(lgamma(x)-0.5s)|&nbsp;&lt;&nbsp;2**-61.71</span><br>
<span class="lineno">50</span><span class="comment" id="2234558">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Our&nbsp;algorithms&nbsp;are&nbsp;based&nbsp;on&nbsp;the&nbsp;following&nbsp;observation</span><br>
<span class="lineno"></span><span class="comment" id="2234620">//</span><br>
<span class="lineno"></span><span class="comment" id="2234623">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeta(2)-1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;zeta(3)-1&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno"></span><span class="comment" id="2234687">//&nbsp;lgamma(2+s)&nbsp;=&nbsp;s*(1-Euler)&nbsp;+&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;-&nbsp;&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="2234757">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno">55</span><span class="comment" id="2234812">//</span><br>
<span class="lineno"></span><span class="comment" id="2234815">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;Euler&nbsp;=&nbsp;0.5772156649...&nbsp;is&nbsp;the&nbsp;Euler&nbsp;constant,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="2234882">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;very&nbsp;close&nbsp;to&nbsp;0.5.</span><br>
<span class="lineno"></span><span class="comment" id="2234912">//</span><br>
<span class="lineno"></span><span class="comment" id="2234915">//&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&gt;=8,&nbsp;we&nbsp;have</span><br>
<span class="lineno">60</span><span class="comment" id="2234941">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)log(x)-x+0.5*log(2pi)+1/(12x)-1/(360x**3)+....</span><br>
<span class="lineno"></span><span class="comment" id="2235013">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(better&nbsp;formula:</span><br>
<span class="lineno"></span><span class="comment" id="2235038">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)*(log(x)-1)-.5*(log(2pi)-1)&nbsp;+&nbsp;...)</span><br>
<span class="lineno"></span><span class="comment" id="2235101">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;1/x,&nbsp;then&nbsp;we&nbsp;approximation</span><br>
<span class="lineno"></span><span class="comment" id="2235144">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f(z)&nbsp;=&nbsp;lgamma(x)&nbsp;-&nbsp;(x-0.5)(log(x)-1)</span><br>
<span class="lineno">65</span><span class="comment" id="2235197">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="2235208">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11</span><br>
<span class="lineno"></span><span class="comment" id="2235269">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;=&nbsp;w0&nbsp;+&nbsp;w1*z&nbsp;+&nbsp;w2*z&nbsp;&nbsp;+&nbsp;w3*z&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;w6*z</span><br>
<span class="lineno"></span><span class="comment" id="2235328">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="2235342">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|w&nbsp;-&nbsp;f(z)|&nbsp;&lt;&nbsp;2**-58.74</span><br>
<span class="lineno">70</span><span class="comment" id="2235381">//</span><br>
<span class="lineno"></span><span class="comment" id="2235384">//&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;negative&nbsp;x,&nbsp;since&nbsp;(G&nbsp;is&nbsp;gamma&nbsp;function)</span><br>
<span class="lineno"></span><span class="comment" id="2235436">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*G(-x)*G(x)&nbsp;=&nbsp;pi/sin(pi*x),</span><br>
<span class="lineno"></span><span class="comment" id="2235482">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="2235498">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G(x)&nbsp;=&nbsp;pi/(sin(pi*x)*(-x)*G(-x))</span><br>
<span class="lineno">75</span><span class="comment" id="2235547">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;since&nbsp;G(-x)&nbsp;is&nbsp;positive,&nbsp;sign(G(x))&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;for&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="2235617">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hence,&nbsp;for&nbsp;x&lt;0,&nbsp;signgam&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2235671">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;log(|Gamma(x)|)</span><br>
<span class="lineno"></span><span class="comment" id="2235715">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(pi/(|x*sin(pi*x)|))&nbsp;-&nbsp;lgamma(-x);</span><br>
<span class="lineno"></span><span class="comment" id="2235781">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;one&nbsp;should&nbsp;avoid&nbsp;computing&nbsp;pi*(-x)&nbsp;directly&nbsp;in&nbsp;the</span><br>
<span class="lineno">80</span><span class="comment" id="2235846">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;computation&nbsp;of&nbsp;sin(pi*(-x)).</span><br>
<span class="lineno"></span><span class="comment" id="2235889">//</span><br>
<span class="lineno"></span><span class="comment" id="2235892">//&nbsp;&nbsp;&nbsp;5.&nbsp;Special&nbsp;Cases</span><br>
<span class="lineno"></span><span class="comment" id="2235914">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(2+s)&nbsp;~&nbsp;s*(1-Euler)&nbsp;for&nbsp;tiny&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="2235967">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1)=lgamma(2)=0</span><br>
<span class="lineno">85</span><span class="comment" id="2236005">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;~&nbsp;-log(x)&nbsp;for&nbsp;tiny&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="2236052">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(0)&nbsp;=&nbsp;lgamma(inf)&nbsp;=&nbsp;inf</span><br>
<span class="lineno"></span><span class="comment" id="2236098">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(-integer)&nbsp;=&nbsp;+-inf</span><br>
<span class="lineno"></span><span class="comment" id="2236139">//</span><br>
<span class="lineno"></span><span class="comment" id="2236142">//</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="2236146">var</span>&nbsp;<span class="ident" id="2236150">_lgamA</span>&nbsp;<span class="op" id="2236157">=</span>&nbsp;<span class="op" id="2236159">[</span><span class="op" id="2236160">...</span><span class="op" id="2236163">]</span><span class="builtintype" id="2236164">float64</span><span class="op" id="2236171">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2236174">7.72156649015328655494e-02</span><span class="op" id="2236200">,</span>&nbsp;<span class="comment" id="2236202">//&nbsp;0x3FB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2236225">3.22467033424113591611e-01</span><span class="op" id="2236251">,</span>&nbsp;<span class="comment" id="2236253">//&nbsp;0x3FD4A34CC4A60FAD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2236276">6.73523010531292681824e-02</span><span class="op" id="2236302">,</span>&nbsp;<span class="comment" id="2236304">//&nbsp;0x3FB13E001A5562A7</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2236327">2.05808084325167332806e-02</span><span class="op" id="2236353">,</span>&nbsp;<span class="comment" id="2236355">//&nbsp;0x3F951322AC92547B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2236378">7.38555086081402883957e-03</span><span class="op" id="2236404">,</span>&nbsp;<span class="comment" id="2236406">//&nbsp;0x3F7E404FB68FEFE8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2236429">2.89051383673415629091e-03</span><span class="op" id="2236455">,</span>&nbsp;<span class="comment" id="2236457">//&nbsp;0x3F67ADD8CCB7926B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2236480">1.19270763183362067845e-03</span><span class="op" id="2236506">,</span>&nbsp;<span class="comment" id="2236508">//&nbsp;0x3F538A94116F3F5D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2236531">5.10069792153511336608e-04</span><span class="op" id="2236557">,</span>&nbsp;<span class="comment" id="2236559">//&nbsp;0x3F40B6C689B99C00</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2236582">2.20862790713908385557e-04</span><span class="op" id="2236608">,</span>&nbsp;<span class="comment" id="2236610">//&nbsp;0x3F2CF2ECED10E54D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2236633">1.08011567247583939954e-04</span><span class="op" id="2236659">,</span>&nbsp;<span class="comment" id="2236661">//&nbsp;0x3F1C5088987DFB07</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2236684">2.52144565451257326939e-05</span><span class="op" id="2236710">,</span>&nbsp;<span class="comment" id="2236712">//&nbsp;0x3EFA7074428CFA52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2236735">4.48640949618915160150e-05</span><span class="op" id="2236761">,</span>&nbsp;<span class="comment" id="2236763">//&nbsp;0x3F07858E90A45837</span><br>
<span class="lineno"></span><span class="op" id="2236785">}</span><br>
<span class="lineno">105</span><span class="keyword" id="2236787">var</span>&nbsp;<span class="ident" id="2236791">_lgamR</span>&nbsp;<span class="op" id="2236798">=</span>&nbsp;<span class="op" id="2236800">[</span><span class="op" id="2236801">...</span><span class="op" id="2236804">]</span><span class="builtintype" id="2236805">float64</span><span class="op" id="2236812">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2236815">1.0</span><span class="op" id="2236818">,</span>&nbsp;<span class="comment" id="2236820">//&nbsp;placeholder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2236836">1.39200533467621045958e+00</span><span class="op" id="2236862">,</span>&nbsp;<span class="comment" id="2236864">//&nbsp;0x3FF645A762C4AB74</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2236887">7.21935547567138069525e-01</span><span class="op" id="2236913">,</span>&nbsp;<span class="comment" id="2236915">//&nbsp;0x3FE71A1893D3DCDC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2236938">1.71933865632803078993e-01</span><span class="op" id="2236964">,</span>&nbsp;<span class="comment" id="2236966">//&nbsp;0x3FC601EDCCFBDF27</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2236989">1.86459191715652901344e-02</span><span class="op" id="2237015">,</span>&nbsp;<span class="comment" id="2237017">//&nbsp;0x3F9317EA742ED475</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2237040">7.77942496381893596434e-04</span><span class="op" id="2237066">,</span>&nbsp;<span class="comment" id="2237068">//&nbsp;0x3F497DDACA41A95B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2237091">7.32668430744625636189e-06</span><span class="op" id="2237117">,</span>&nbsp;<span class="comment" id="2237119">//&nbsp;0x3EDEBAF7A5B38140</span><br>
<span class="lineno"></span><span class="op" id="2237141">}</span><br>
<span class="lineno"></span><span class="keyword" id="2237143">var</span>&nbsp;<span class="ident" id="2237147">_lgamS</span>&nbsp;<span class="op" id="2237154">=</span>&nbsp;<span class="op" id="2237156">[</span><span class="op" id="2237157">...</span><span class="op" id="2237160">]</span><span class="builtintype" id="2237161">float64</span><span class="op" id="2237168">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237171">-</span><span class="num" id="2237172">7.72156649015328655494e-02</span><span class="op" id="2237198">,</span>&nbsp;<span class="comment" id="2237200">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2237223">2.14982415960608852501e-01</span><span class="op" id="2237249">,</span>&nbsp;&nbsp;<span class="comment" id="2237252">//&nbsp;0x3FCB848B36E20878</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2237275">3.25778796408930981787e-01</span><span class="op" id="2237301">,</span>&nbsp;&nbsp;<span class="comment" id="2237304">//&nbsp;0x3FD4D98F4F139F59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2237327">1.46350472652464452805e-01</span><span class="op" id="2237353">,</span>&nbsp;&nbsp;<span class="comment" id="2237356">//&nbsp;0x3FC2BB9CBEE5F2F7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2237379">2.66422703033638609560e-02</span><span class="op" id="2237405">,</span>&nbsp;&nbsp;<span class="comment" id="2237408">//&nbsp;0x3F9B481C7E939961</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2237431">1.84028451407337715652e-03</span><span class="op" id="2237457">,</span>&nbsp;&nbsp;<span class="comment" id="2237460">//&nbsp;0x3F5E26B67368F239</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2237483">3.19475326584100867617e-05</span><span class="op" id="2237509">,</span>&nbsp;&nbsp;<span class="comment" id="2237512">//&nbsp;0x3F00BFECDD17E945</span><br>
<span class="lineno"></span><span class="op" id="2237534">}</span><br>
<span class="lineno"></span><span class="keyword" id="2237536">var</span>&nbsp;<span class="ident" id="2237540">_lgamT</span>&nbsp;<span class="op" id="2237547">=</span>&nbsp;<span class="op" id="2237549">[</span><span class="op" id="2237550">...</span><span class="op" id="2237553">]</span><span class="builtintype" id="2237554">float64</span><span class="op" id="2237561">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2237564">4.83836122723810047042e-01</span><span class="op" id="2237590">,</span>&nbsp;&nbsp;<span class="comment" id="2237593">//&nbsp;0x3FDEF72BC8EE38A2</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237616">-</span><span class="num" id="2237617">1.47587722994593911752e-01</span><span class="op" id="2237643">,</span>&nbsp;<span class="comment" id="2237645">//&nbsp;0xBFC2E4278DC6C509</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2237668">6.46249402391333854778e-02</span><span class="op" id="2237694">,</span>&nbsp;&nbsp;<span class="comment" id="2237697">//&nbsp;0x3FB08B4294D5419B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237720">-</span><span class="num" id="2237721">3.27885410759859649565e-02</span><span class="op" id="2237747">,</span>&nbsp;<span class="comment" id="2237749">//&nbsp;0xBFA0C9A8DF35B713</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2237772">1.79706750811820387126e-02</span><span class="op" id="2237798">,</span>&nbsp;&nbsp;<span class="comment" id="2237801">//&nbsp;0x3F9266E7970AF9EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237824">-</span><span class="num" id="2237825">1.03142241298341437450e-02</span><span class="op" id="2237851">,</span>&nbsp;<span class="comment" id="2237853">//&nbsp;0xBF851F9FBA91EC6A</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2237876">6.10053870246291332635e-03</span><span class="op" id="2237902">,</span>&nbsp;&nbsp;<span class="comment" id="2237905">//&nbsp;0x3F78FCE0E370E344</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2237928">-</span><span class="num" id="2237929">3.68452016781138256760e-03</span><span class="op" id="2237955">,</span>&nbsp;<span class="comment" id="2237957">//&nbsp;0xBF6E2EFFB3E914D7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2237980">2.25964780900612472250e-03</span><span class="op" id="2238006">,</span>&nbsp;&nbsp;<span class="comment" id="2238009">//&nbsp;0x3F6282D32E15C915</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238032">-</span><span class="num" id="2238033">1.40346469989232843813e-03</span><span class="op" id="2238059">,</span>&nbsp;<span class="comment" id="2238061">//&nbsp;0xBF56FE8EBF2D1AF1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2238084">8.81081882437654011382e-04</span><span class="op" id="2238110">,</span>&nbsp;&nbsp;<span class="comment" id="2238113">//&nbsp;0x3F4CDF0CEF61A8E9</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238136">-</span><span class="num" id="2238137">5.38595305356740546715e-04</span><span class="op" id="2238163">,</span>&nbsp;<span class="comment" id="2238165">//&nbsp;0xBF41A6109C73E0EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2238188">3.15632070903625950361e-04</span><span class="op" id="2238214">,</span>&nbsp;&nbsp;<span class="comment" id="2238217">//&nbsp;0x3F34AF6D6C0EBBF7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238240">-</span><span class="num" id="2238241">3.12754168375120860518e-04</span><span class="op" id="2238267">,</span>&nbsp;<span class="comment" id="2238269">//&nbsp;0xBF347F24ECC38C38</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2238292">3.35529192635519073543e-04</span><span class="op" id="2238318">,</span>&nbsp;&nbsp;<span class="comment" id="2238321">//&nbsp;0x3F35FD3EE8C2D3F4</span><br>
<span class="lineno"></span><span class="op" id="2238343">}</span><br>
<span class="lineno">140</span><span class="keyword" id="2238345">var</span>&nbsp;<span class="ident" id="2238349">_lgamU</span>&nbsp;<span class="op" id="2238356">=</span>&nbsp;<span class="op" id="2238358">[</span><span class="op" id="2238359">...</span><span class="op" id="2238362">]</span><span class="builtintype" id="2238363">float64</span><span class="op" id="2238370">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2238373">-</span><span class="num" id="2238374">7.72156649015328655494e-02</span><span class="op" id="2238400">,</span>&nbsp;<span class="comment" id="2238402">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2238425">6.32827064025093366517e-01</span><span class="op" id="2238451">,</span>&nbsp;&nbsp;<span class="comment" id="2238454">//&nbsp;0x3FE4401E8B005DFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2238477">1.45492250137234768737e+00</span><span class="op" id="2238503">,</span>&nbsp;&nbsp;<span class="comment" id="2238506">//&nbsp;0x3FF7475CD119BD6F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2238529">9.77717527963372745603e-01</span><span class="op" id="2238555">,</span>&nbsp;&nbsp;<span class="comment" id="2238558">//&nbsp;0x3FEF497644EA8450</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2238581">2.28963728064692451092e-01</span><span class="op" id="2238607">,</span>&nbsp;&nbsp;<span class="comment" id="2238610">//&nbsp;0x3FCD4EAEF6010924</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2238633">1.33810918536787660377e-02</span><span class="op" id="2238659">,</span>&nbsp;&nbsp;<span class="comment" id="2238662">//&nbsp;0x3F8B678BBF2BAB09</span><br>
<span class="lineno"></span><span class="op" id="2238684">}</span><br>
<span class="lineno"></span><span class="keyword" id="2238686">var</span>&nbsp;<span class="ident" id="2238690">_lgamV</span>&nbsp;<span class="op" id="2238697">=</span>&nbsp;<span class="op" id="2238699">[</span><span class="op" id="2238700">...</span><span class="op" id="2238703">]</span><span class="builtintype" id="2238704">float64</span><span class="op" id="2238711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2238714">1.0</span><span class="op" id="2238717">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2238720">2.45597793713041134822e+00</span><span class="op" id="2238746">,</span>&nbsp;<span class="comment" id="2238748">//&nbsp;0x4003A5D7C2BD619C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2238771">2.12848976379893395361e+00</span><span class="op" id="2238797">,</span>&nbsp;<span class="comment" id="2238799">//&nbsp;0x40010725A42B18F5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2238822">7.69285150456672783825e-01</span><span class="op" id="2238848">,</span>&nbsp;<span class="comment" id="2238850">//&nbsp;0x3FE89DFBE45050AF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2238873">1.04222645593369134254e-01</span><span class="op" id="2238899">,</span>&nbsp;<span class="comment" id="2238901">//&nbsp;0x3FBAAE55D6537C88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2238924">3.21709242282423911810e-03</span><span class="op" id="2238950">,</span>&nbsp;<span class="comment" id="2238952">//&nbsp;0x3F6A5ABB57D0CF61</span><br>
<span class="lineno">155</span><span class="op" id="2238974">}</span><br>
<span class="lineno"></span><span class="keyword" id="2238976">var</span>&nbsp;<span class="ident" id="2238980">_lgamW</span>&nbsp;<span class="op" id="2238987">=</span>&nbsp;<span class="op" id="2238989">[</span><span class="op" id="2238990">...</span><span class="op" id="2238993">]</span><span class="builtintype" id="2238994">float64</span><span class="op" id="2239001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2239004">4.18938533204672725052e-01</span><span class="op" id="2239030">,</span>&nbsp;&nbsp;<span class="comment" id="2239033">//&nbsp;0x3FDACFE390C97D69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2239056">8.33333333333329678849e-02</span><span class="op" id="2239082">,</span>&nbsp;&nbsp;<span class="comment" id="2239085">//&nbsp;0x3FB555555555553B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239108">-</span><span class="num" id="2239109">2.77777777728775536470e-03</span><span class="op" id="2239135">,</span>&nbsp;<span class="comment" id="2239137">//&nbsp;0xBF66C16C16B02E5C</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2239160">7.93650558643019558500e-04</span><span class="op" id="2239186">,</span>&nbsp;&nbsp;<span class="comment" id="2239189">//&nbsp;0x3F4A019F98CF38B6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239212">-</span><span class="num" id="2239213">5.95187557450339963135e-04</span><span class="op" id="2239239">,</span>&nbsp;<span class="comment" id="2239241">//&nbsp;0xBF4380CB8C0FE741</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2239264">8.36339918996282139126e-04</span><span class="op" id="2239290">,</span>&nbsp;&nbsp;<span class="comment" id="2239293">//&nbsp;0x3F4B67BA4CDAD5D1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239316">-</span><span class="num" id="2239317">1.63092934096575273989e-03</span><span class="op" id="2239343">,</span>&nbsp;<span class="comment" id="2239345">//&nbsp;0xBF5AB89D0B9E43E4</span><br>
<span class="lineno"></span><span class="op" id="2239367">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="2239370">//&nbsp;Lgamma&nbsp;returns&nbsp;the&nbsp;natural&nbsp;logarithm&nbsp;and&nbsp;sign&nbsp;(-1&nbsp;or&nbsp;+1)&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="2239443">//</span><br>
<span class="lineno"></span><span class="comment" id="2239446">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2239468">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno">170</span><span class="comment" id="2239491">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2239511">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(-integer)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2239538">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(-Inf)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2239561">//&nbsp;&nbsp;&nbsp;&nbsp;Lgamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2239582">func</span>&nbsp;<span class="ident" id="2239587">Lgamma</span><span class="op" id="2239593">(</span><span class="ident" id="2239594">x</span>&nbsp;<span class="builtintype" id="2239596">float64</span><span class="op" id="2239603">)</span>&nbsp;<span class="op" id="2239605">(</span><span class="ident" id="2239606">lgamma</span>&nbsp;<span class="builtintype" id="2239613">float64</span><span class="op" id="2239620">,</span>&nbsp;<span class="ident" id="2239622">sign</span>&nbsp;<span class="builtintype" id="2239627">int</span><span class="op" id="2239630">)</span>&nbsp;<span class="op" id="2239632">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2239635">const</span>&nbsp;<span class="op" id="2239641">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239645">Ymin</span>&nbsp;&nbsp;<span class="op" id="2239651">=</span>&nbsp;<span class="num" id="2239653">1.461632144968362245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239676">Two52</span>&nbsp;<span class="op" id="2239682">=</span>&nbsp;<span class="num" id="2239684">1</span>&nbsp;<span class="op" id="2239686">&lt;&lt;</span>&nbsp;<span class="num" id="2239689">52</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2239712">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239748">Two53</span>&nbsp;<span class="op" id="2239754">=</span>&nbsp;<span class="num" id="2239756">1</span>&nbsp;<span class="op" id="2239758">&lt;&lt;</span>&nbsp;<span class="num" id="2239761">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2239784">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239820">Two58</span>&nbsp;<span class="op" id="2239826">=</span>&nbsp;<span class="num" id="2239828">1</span>&nbsp;<span class="op" id="2239830">&lt;&lt;</span>&nbsp;<span class="num" id="2239833">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2239856">//&nbsp;0x4390000000000000&nbsp;~2.8823e+17</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239892">Tiny</span>&nbsp;&nbsp;<span class="op" id="2239898">=</span>&nbsp;<span class="num" id="2239900">1.0</span>&nbsp;<span class="op" id="2239904">/</span>&nbsp;<span class="op" id="2239906">(</span><span class="num" id="2239907">1</span>&nbsp;<span class="op" id="2239909">&lt;&lt;</span>&nbsp;<span class="num" id="2239912">70</span><span class="op" id="2239914">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2239928">//&nbsp;0x3b90000000000000&nbsp;~8.47033e-22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2239965">Tc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2239971">=</span>&nbsp;<span class="num" id="2239973">1.46163214496836224576e+00</span>&nbsp;&nbsp;<span class="comment" id="2240001">//&nbsp;0x3FF762D86356BE3F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240025">Tf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240031">=</span>&nbsp;<span class="op" id="2240033">-</span><span class="num" id="2240034">1.21486290535849611461e-01</span>&nbsp;<span class="comment" id="2240061">//&nbsp;0xBFBF19B9BCC38A42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2240085">//&nbsp;Tt&nbsp;=&nbsp;-(tail&nbsp;of&nbsp;Tf)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240109">Tt</span>&nbsp;<span class="op" id="2240112">=</span>&nbsp;<span class="op" id="2240114">-</span><span class="num" id="2240115">3.63867699703950536541e-18</span>&nbsp;<span class="comment" id="2240142">//&nbsp;0xBC50C7CAA48A971F</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2240168">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240186">sign</span>&nbsp;<span class="op" id="2240191">=</span>&nbsp;<span class="num" id="2240193">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240196">switch</span>&nbsp;<span class="op" id="2240203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240206">case</span>&nbsp;<span class="ident" id="2240211">IsNaN</span><span class="op" id="2240216">(</span><span class="ident" id="2240217">x</span><span class="op" id="2240218">)</span><span class="op" id="2240219">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240223">lgamma</span>&nbsp;<span class="op" id="2240230">=</span>&nbsp;<span class="ident" id="2240232">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240236">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240244">case</span>&nbsp;<span class="ident" id="2240249">IsInf</span><span class="op" id="2240254">(</span><span class="ident" id="2240255">x</span><span class="op" id="2240256">,</span>&nbsp;<span class="num" id="2240258">0</span><span class="op" id="2240259">)</span><span class="op" id="2240260">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240264">lgamma</span>&nbsp;<span class="op" id="2240271">=</span>&nbsp;<span class="ident" id="2240273">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240277">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240285">case</span>&nbsp;<span class="ident" id="2240290">x</span>&nbsp;<span class="op" id="2240292">==</span>&nbsp;<span class="num" id="2240295">0</span><span class="op" id="2240296">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240300">lgamma</span>&nbsp;<span class="op" id="2240307">=</span>&nbsp;<span class="ident" id="2240309">Inf</span><span class="op" id="2240312">(</span><span class="num" id="2240313">1</span><span class="op" id="2240314">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240318">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240326">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240330">neg</span>&nbsp;<span class="op" id="2240334">:=</span>&nbsp;<span class="builtintype" id="2240337">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240344">if</span>&nbsp;<span class="ident" id="2240347">x</span>&nbsp;<span class="op" id="2240349">&lt;</span>&nbsp;<span class="num" id="2240351">0</span>&nbsp;<span class="op" id="2240353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240357">x</span>&nbsp;<span class="op" id="2240359">=</span>&nbsp;<span class="op" id="2240361">-</span><span class="ident" id="2240362">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240366">neg</span>&nbsp;<span class="op" id="2240370">=</span>&nbsp;<span class="builtintype" id="2240372">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240378">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240382">if</span>&nbsp;<span class="ident" id="2240385">x</span>&nbsp;<span class="op" id="2240387">&lt;</span>&nbsp;<span class="ident" id="2240389">Tiny</span>&nbsp;<span class="op" id="2240394">{</span>&nbsp;<span class="comment" id="2240396">//&nbsp;if&nbsp;|x|&nbsp;&lt;&nbsp;2**-70,&nbsp;return&nbsp;-log(|x|)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240435">if</span>&nbsp;<span class="ident" id="2240438">neg</span>&nbsp;<span class="op" id="2240442">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240447">sign</span>&nbsp;<span class="op" id="2240452">=</span>&nbsp;<span class="op" id="2240454">-</span><span class="num" id="2240455">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240459">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240463">lgamma</span>&nbsp;<span class="op" id="2240470">=</span>&nbsp;<span class="op" id="2240472">-</span><span class="ident" id="2240473">Log</span><span class="op" id="2240476">(</span><span class="ident" id="2240477">x</span><span class="op" id="2240478">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240482">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240490">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240493">var</span>&nbsp;<span class="ident" id="2240497">nadj</span>&nbsp;<span class="builtintype" id="2240502">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240511">if</span>&nbsp;<span class="ident" id="2240514">neg</span>&nbsp;<span class="op" id="2240518">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240522">if</span>&nbsp;<span class="ident" id="2240525">x</span>&nbsp;<span class="op" id="2240527">&gt;=</span>&nbsp;<span class="ident" id="2240530">Two52</span>&nbsp;<span class="op" id="2240536">{</span>&nbsp;<span class="comment" id="2240538">//&nbsp;|x|&nbsp;&gt;=&nbsp;2**52,&nbsp;must&nbsp;be&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240575">lgamma</span>&nbsp;<span class="op" id="2240582">=</span>&nbsp;<span class="ident" id="2240584">Inf</span><span class="op" id="2240587">(</span><span class="num" id="2240588">1</span><span class="op" id="2240589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240594">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240607">t</span>&nbsp;<span class="op" id="2240609">:=</span>&nbsp;<span class="ident" id="2240612">sinPi</span><span class="op" id="2240617">(</span><span class="ident" id="2240618">x</span><span class="op" id="2240619">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240623">if</span>&nbsp;<span class="ident" id="2240626">t</span>&nbsp;<span class="op" id="2240628">==</span>&nbsp;<span class="num" id="2240631">0</span>&nbsp;<span class="op" id="2240633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240638">lgamma</span>&nbsp;<span class="op" id="2240645">=</span>&nbsp;<span class="ident" id="2240647">Inf</span><span class="op" id="2240650">(</span><span class="num" id="2240651">1</span><span class="op" id="2240652">)</span>&nbsp;<span class="comment" id="2240654">//&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240669">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240678">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240682">nadj</span>&nbsp;<span class="op" id="2240687">=</span>&nbsp;<span class="ident" id="2240689">Log</span><span class="op" id="2240692">(</span><span class="ident" id="2240693">Pi</span>&nbsp;<span class="op" id="2240696">/</span>&nbsp;<span class="ident" id="2240698">Abs</span><span class="op" id="2240701">(</span><span class="ident" id="2240702">t</span><span class="op" id="2240703">*</span><span class="ident" id="2240704">x</span><span class="op" id="2240705">)</span><span class="op" id="2240706">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240710">if</span>&nbsp;<span class="ident" id="2240713">t</span>&nbsp;<span class="op" id="2240715">&lt;</span>&nbsp;<span class="num" id="2240717">0</span>&nbsp;<span class="op" id="2240719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240724">sign</span>&nbsp;<span class="op" id="2240729">=</span>&nbsp;<span class="op" id="2240731">-</span><span class="num" id="2240732">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240736">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2240739">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240743">switch</span>&nbsp;<span class="op" id="2240750">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240753">case</span>&nbsp;<span class="ident" id="2240758">x</span>&nbsp;<span class="op" id="2240760">==</span>&nbsp;<span class="num" id="2240763">1</span>&nbsp;<span class="op" id="2240765">||</span>&nbsp;<span class="ident" id="2240768">x</span>&nbsp;<span class="op" id="2240770">==</span>&nbsp;<span class="num" id="2240773">2</span><span class="op" id="2240774">:</span>&nbsp;<span class="comment" id="2240776">//&nbsp;purge&nbsp;off&nbsp;1&nbsp;and&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240799">lgamma</span>&nbsp;<span class="op" id="2240806">=</span>&nbsp;<span class="num" id="2240808">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240812">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240820">case</span>&nbsp;<span class="ident" id="2240825">x</span>&nbsp;<span class="op" id="2240827">&lt;</span>&nbsp;<span class="num" id="2240829">2</span><span class="op" id="2240830">:</span>&nbsp;<span class="comment" id="2240832">//&nbsp;use&nbsp;lgamma(x)&nbsp;=&nbsp;lgamma(x+1)&nbsp;-&nbsp;log(x)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240874">var</span>&nbsp;<span class="ident" id="2240878">y</span>&nbsp;<span class="builtintype" id="2240880">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240890">var</span>&nbsp;<span class="ident" id="2240894">i</span>&nbsp;<span class="builtintype" id="2240896">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240902">if</span>&nbsp;<span class="ident" id="2240905">x</span>&nbsp;<span class="op" id="2240907">&lt;=</span>&nbsp;<span class="num" id="2240910">0.9</span>&nbsp;<span class="op" id="2240914">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2240919">lgamma</span>&nbsp;<span class="op" id="2240926">=</span>&nbsp;<span class="op" id="2240928">-</span><span class="ident" id="2240929">Log</span><span class="op" id="2240932">(</span><span class="ident" id="2240933">x</span><span class="op" id="2240934">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240939">switch</span>&nbsp;<span class="op" id="2240946">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2240951">case</span>&nbsp;<span class="ident" id="2240956">x</span>&nbsp;<span class="op" id="2240958">&gt;=</span>&nbsp;<span class="op" id="2240961">(</span><span class="ident" id="2240962">Ymin</span>&nbsp;<span class="op" id="2240967">-</span>&nbsp;<span class="num" id="2240969">1</span>&nbsp;<span class="op" id="2240971">+</span>&nbsp;<span class="num" id="2240973">0.27</span><span class="op" id="2240977">)</span><span class="op" id="2240978">:</span>&nbsp;<span class="comment" id="2240980">//&nbsp;0.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;&nbsp;0.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241007">y</span>&nbsp;<span class="op" id="2241009">=</span>&nbsp;<span class="num" id="2241011">1</span>&nbsp;<span class="op" id="2241013">-</span>&nbsp;<span class="ident" id="2241015">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241021">i</span>&nbsp;<span class="op" id="2241023">=</span>&nbsp;<span class="num" id="2241025">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2241030">case</span>&nbsp;<span class="ident" id="2241035">x</span>&nbsp;<span class="op" id="2241037">&gt;=</span>&nbsp;<span class="op" id="2241040">(</span><span class="ident" id="2241041">Ymin</span>&nbsp;<span class="op" id="2241046">-</span>&nbsp;<span class="num" id="2241048">1</span>&nbsp;<span class="op" id="2241050">-</span>&nbsp;<span class="num" id="2241052">0.27</span><span class="op" id="2241056">)</span><span class="op" id="2241057">:</span>&nbsp;<span class="comment" id="2241059">//&nbsp;0.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;0.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241087">y</span>&nbsp;<span class="op" id="2241089">=</span>&nbsp;<span class="ident" id="2241091">x</span>&nbsp;<span class="op" id="2241093">-</span>&nbsp;<span class="op" id="2241095">(</span><span class="ident" id="2241096">Tc</span>&nbsp;<span class="op" id="2241099">-</span>&nbsp;<span class="num" id="2241101">1</span><span class="op" id="2241102">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241108">i</span>&nbsp;<span class="op" id="2241110">=</span>&nbsp;<span class="num" id="2241112">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2241117">default</span><span class="op" id="2241124">:</span>&nbsp;<span class="comment" id="2241126">//&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;0.2316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241148">y</span>&nbsp;<span class="op" id="2241150">=</span>&nbsp;<span class="ident" id="2241152">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241158">i</span>&nbsp;<span class="op" id="2241160">=</span>&nbsp;<span class="num" id="2241162">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2241167">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2241171">}</span>&nbsp;<span class="keyword" id="2241173">else</span>&nbsp;<span class="op" id="2241178">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241183">lgamma</span>&nbsp;<span class="op" id="2241190">=</span>&nbsp;<span class="num" id="2241192">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2241197">switch</span>&nbsp;<span class="op" id="2241204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2241209">case</span>&nbsp;<span class="ident" id="2241214">x</span>&nbsp;<span class="op" id="2241216">&gt;=</span>&nbsp;<span class="op" id="2241219">(</span><span class="ident" id="2241220">Ymin</span>&nbsp;<span class="op" id="2241225">+</span>&nbsp;<span class="num" id="2241227">0.27</span><span class="op" id="2241231">)</span><span class="op" id="2241232">:</span>&nbsp;<span class="comment" id="2241234">//&nbsp;1.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241257">y</span>&nbsp;<span class="op" id="2241259">=</span>&nbsp;<span class="num" id="2241261">2</span>&nbsp;<span class="op" id="2241263">-</span>&nbsp;<span class="ident" id="2241265">x</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241271">i</span>&nbsp;<span class="op" id="2241273">=</span>&nbsp;<span class="num" id="2241275">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2241280">case</span>&nbsp;<span class="ident" id="2241285">x</span>&nbsp;<span class="op" id="2241287">&gt;=</span>&nbsp;<span class="op" id="2241290">(</span><span class="ident" id="2241291">Ymin</span>&nbsp;<span class="op" id="2241296">-</span>&nbsp;<span class="num" id="2241298">0.27</span><span class="op" id="2241302">)</span><span class="op" id="2241303">:</span>&nbsp;<span class="comment" id="2241305">//&nbsp;1.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;1.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241333">y</span>&nbsp;<span class="op" id="2241335">=</span>&nbsp;<span class="ident" id="2241337">x</span>&nbsp;<span class="op" id="2241339">-</span>&nbsp;<span class="ident" id="2241341">Tc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241348">i</span>&nbsp;<span class="op" id="2241350">=</span>&nbsp;<span class="num" id="2241352">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2241357">default</span><span class="op" id="2241364">:</span>&nbsp;<span class="comment" id="2241366">//&nbsp;0.9&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;1.2316</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241390">y</span>&nbsp;<span class="op" id="2241392">=</span>&nbsp;<span class="ident" id="2241394">x</span>&nbsp;<span class="op" id="2241396">-</span>&nbsp;<span class="num" id="2241398">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241404">i</span>&nbsp;<span class="op" id="2241406">=</span>&nbsp;<span class="num" id="2241408">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2241413">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2241417">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2241421">switch</span>&nbsp;<span class="ident" id="2241428">i</span>&nbsp;<span class="op" id="2241430">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2241434">case</span>&nbsp;<span class="num" id="2241439">0</span><span class="op" id="2241440">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241445">z</span>&nbsp;<span class="op" id="2241447">:=</span>&nbsp;<span class="ident" id="2241450">y</span>&nbsp;<span class="op" id="2241452">*</span>&nbsp;<span class="ident" id="2241454">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241459">p1</span>&nbsp;<span class="op" id="2241462">:=</span>&nbsp;<span class="ident" id="2241465">_lgamA</span><span class="op" id="2241471">[</span><span class="num" id="2241472">0</span><span class="op" id="2241473">]</span>&nbsp;<span class="op" id="2241475">+</span>&nbsp;<span class="ident" id="2241477">z</span><span class="op" id="2241478">*</span><span class="op" id="2241479">(</span><span class="ident" id="2241480">_lgamA</span><span class="op" id="2241486">[</span><span class="num" id="2241487">2</span><span class="op" id="2241488">]</span><span class="op" id="2241489">+</span><span class="ident" id="2241490">z</span><span class="op" id="2241491">*</span><span class="op" id="2241492">(</span><span class="ident" id="2241493">_lgamA</span><span class="op" id="2241499">[</span><span class="num" id="2241500">4</span><span class="op" id="2241501">]</span><span class="op" id="2241502">+</span><span class="ident" id="2241503">z</span><span class="op" id="2241504">*</span><span class="op" id="2241505">(</span><span class="ident" id="2241506">_lgamA</span><span class="op" id="2241512">[</span><span class="num" id="2241513">6</span><span class="op" id="2241514">]</span><span class="op" id="2241515">+</span><span class="ident" id="2241516">z</span><span class="op" id="2241517">*</span><span class="op" id="2241518">(</span><span class="ident" id="2241519">_lgamA</span><span class="op" id="2241525">[</span><span class="num" id="2241526">8</span><span class="op" id="2241527">]</span><span class="op" id="2241528">+</span><span class="ident" id="2241529">z</span><span class="op" id="2241530">*</span><span class="ident" id="2241531">_lgamA</span><span class="op" id="2241537">[</span><span class="num" id="2241538">10</span><span class="op" id="2241540">]</span><span class="op" id="2241541">)</span><span class="op" id="2241542">)</span><span class="op" id="2241543">)</span><span class="op" id="2241544">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241549">p2</span>&nbsp;<span class="op" id="2241552">:=</span>&nbsp;<span class="ident" id="2241555">z</span>&nbsp;<span class="op" id="2241557">*</span>&nbsp;<span class="op" id="2241559">(</span><span class="ident" id="2241560">_lgamA</span><span class="op" id="2241566">[</span><span class="num" id="2241567">1</span><span class="op" id="2241568">]</span>&nbsp;<span class="op" id="2241570">+</span>&nbsp;<span class="ident" id="2241572">z</span><span class="op" id="2241573">*</span><span class="op" id="2241574">(</span><span class="op" id="2241575">+</span><span class="ident" id="2241576">_lgamA</span><span class="op" id="2241582">[</span><span class="num" id="2241583">3</span><span class="op" id="2241584">]</span><span class="op" id="2241585">+</span><span class="ident" id="2241586">z</span><span class="op" id="2241587">*</span><span class="op" id="2241588">(</span><span class="ident" id="2241589">_lgamA</span><span class="op" id="2241595">[</span><span class="num" id="2241596">5</span><span class="op" id="2241597">]</span><span class="op" id="2241598">+</span><span class="ident" id="2241599">z</span><span class="op" id="2241600">*</span><span class="op" id="2241601">(</span><span class="ident" id="2241602">_lgamA</span><span class="op" id="2241608">[</span><span class="num" id="2241609">7</span><span class="op" id="2241610">]</span><span class="op" id="2241611">+</span><span class="ident" id="2241612">z</span><span class="op" id="2241613">*</span><span class="op" id="2241614">(</span><span class="ident" id="2241615">_lgamA</span><span class="op" id="2241621">[</span><span class="num" id="2241622">9</span><span class="op" id="2241623">]</span><span class="op" id="2241624">+</span><span class="ident" id="2241625">z</span><span class="op" id="2241626">*</span><span class="ident" id="2241627">_lgamA</span><span class="op" id="2241633">[</span><span class="num" id="2241634">11</span><span class="op" id="2241636">]</span><span class="op" id="2241637">)</span><span class="op" id="2241638">)</span><span class="op" id="2241639">)</span><span class="op" id="2241640">)</span><span class="op" id="2241641">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241646">p</span>&nbsp;<span class="op" id="2241648">:=</span>&nbsp;<span class="ident" id="2241651">y</span><span class="op" id="2241652">*</span><span class="ident" id="2241653">p1</span>&nbsp;<span class="op" id="2241656">+</span>&nbsp;<span class="ident" id="2241658">p2</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241664">lgamma</span>&nbsp;<span class="op" id="2241671">+=</span>&nbsp;<span class="op" id="2241674">(</span><span class="ident" id="2241675">p</span>&nbsp;<span class="op" id="2241677">-</span>&nbsp;<span class="num" id="2241679">0.5</span><span class="op" id="2241682">*</span><span class="ident" id="2241683">y</span><span class="op" id="2241684">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2241688">case</span>&nbsp;<span class="num" id="2241693">1</span><span class="op" id="2241694">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241699">z</span>&nbsp;<span class="op" id="2241701">:=</span>&nbsp;<span class="ident" id="2241704">y</span>&nbsp;<span class="op" id="2241706">*</span>&nbsp;<span class="ident" id="2241708">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241713">w</span>&nbsp;<span class="op" id="2241715">:=</span>&nbsp;<span class="ident" id="2241718">z</span>&nbsp;<span class="op" id="2241720">*</span>&nbsp;<span class="ident" id="2241722">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241727">p1</span>&nbsp;<span class="op" id="2241730">:=</span>&nbsp;<span class="ident" id="2241733">_lgamT</span><span class="op" id="2241739">[</span><span class="num" id="2241740">0</span><span class="op" id="2241741">]</span>&nbsp;<span class="op" id="2241743">+</span>&nbsp;<span class="ident" id="2241745">w</span><span class="op" id="2241746">*</span><span class="op" id="2241747">(</span><span class="ident" id="2241748">_lgamT</span><span class="op" id="2241754">[</span><span class="num" id="2241755">3</span><span class="op" id="2241756">]</span><span class="op" id="2241757">+</span><span class="ident" id="2241758">w</span><span class="op" id="2241759">*</span><span class="op" id="2241760">(</span><span class="ident" id="2241761">_lgamT</span><span class="op" id="2241767">[</span><span class="num" id="2241768">6</span><span class="op" id="2241769">]</span><span class="op" id="2241770">+</span><span class="ident" id="2241771">w</span><span class="op" id="2241772">*</span><span class="op" id="2241773">(</span><span class="ident" id="2241774">_lgamT</span><span class="op" id="2241780">[</span><span class="num" id="2241781">9</span><span class="op" id="2241782">]</span><span class="op" id="2241783">+</span><span class="ident" id="2241784">w</span><span class="op" id="2241785">*</span><span class="ident" id="2241786">_lgamT</span><span class="op" id="2241792">[</span><span class="num" id="2241793">12</span><span class="op" id="2241795">]</span><span class="op" id="2241796">)</span><span class="op" id="2241797">)</span><span class="op" id="2241798">)</span>&nbsp;<span class="comment" id="2241800">//&nbsp;parallel&nbsp;comp</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241820">p2</span>&nbsp;<span class="op" id="2241823">:=</span>&nbsp;<span class="ident" id="2241826">_lgamT</span><span class="op" id="2241832">[</span><span class="num" id="2241833">1</span><span class="op" id="2241834">]</span>&nbsp;<span class="op" id="2241836">+</span>&nbsp;<span class="ident" id="2241838">w</span><span class="op" id="2241839">*</span><span class="op" id="2241840">(</span><span class="ident" id="2241841">_lgamT</span><span class="op" id="2241847">[</span><span class="num" id="2241848">4</span><span class="op" id="2241849">]</span><span class="op" id="2241850">+</span><span class="ident" id="2241851">w</span><span class="op" id="2241852">*</span><span class="op" id="2241853">(</span><span class="ident" id="2241854">_lgamT</span><span class="op" id="2241860">[</span><span class="num" id="2241861">7</span><span class="op" id="2241862">]</span><span class="op" id="2241863">+</span><span class="ident" id="2241864">w</span><span class="op" id="2241865">*</span><span class="op" id="2241866">(</span><span class="ident" id="2241867">_lgamT</span><span class="op" id="2241873">[</span><span class="num" id="2241874">10</span><span class="op" id="2241876">]</span><span class="op" id="2241877">+</span><span class="ident" id="2241878">w</span><span class="op" id="2241879">*</span><span class="ident" id="2241880">_lgamT</span><span class="op" id="2241886">[</span><span class="num" id="2241887">13</span><span class="op" id="2241889">]</span><span class="op" id="2241890">)</span><span class="op" id="2241891">)</span><span class="op" id="2241892">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241897">p3</span>&nbsp;<span class="op" id="2241900">:=</span>&nbsp;<span class="ident" id="2241903">_lgamT</span><span class="op" id="2241909">[</span><span class="num" id="2241910">2</span><span class="op" id="2241911">]</span>&nbsp;<span class="op" id="2241913">+</span>&nbsp;<span class="ident" id="2241915">w</span><span class="op" id="2241916">*</span><span class="op" id="2241917">(</span><span class="ident" id="2241918">_lgamT</span><span class="op" id="2241924">[</span><span class="num" id="2241925">5</span><span class="op" id="2241926">]</span><span class="op" id="2241927">+</span><span class="ident" id="2241928">w</span><span class="op" id="2241929">*</span><span class="op" id="2241930">(</span><span class="ident" id="2241931">_lgamT</span><span class="op" id="2241937">[</span><span class="num" id="2241938">8</span><span class="op" id="2241939">]</span><span class="op" id="2241940">+</span><span class="ident" id="2241941">w</span><span class="op" id="2241942">*</span><span class="op" id="2241943">(</span><span class="ident" id="2241944">_lgamT</span><span class="op" id="2241950">[</span><span class="num" id="2241951">11</span><span class="op" id="2241953">]</span><span class="op" id="2241954">+</span><span class="ident" id="2241955">w</span><span class="op" id="2241956">*</span><span class="ident" id="2241957">_lgamT</span><span class="op" id="2241963">[</span><span class="num" id="2241964">14</span><span class="op" id="2241966">]</span><span class="op" id="2241967">)</span><span class="op" id="2241968">)</span><span class="op" id="2241969">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2241974">p</span>&nbsp;<span class="op" id="2241976">:=</span>&nbsp;<span class="ident" id="2241979">z</span><span class="op" id="2241980">*</span><span class="ident" id="2241981">p1</span>&nbsp;<span class="op" id="2241984">-</span>&nbsp;<span class="op" id="2241986">(</span><span class="ident" id="2241987">Tt</span>&nbsp;<span class="op" id="2241990">-</span>&nbsp;<span class="ident" id="2241992">w</span><span class="op" id="2241993">*</span><span class="op" id="2241994">(</span><span class="ident" id="2241995">p2</span><span class="op" id="2241997">+</span><span class="ident" id="2241998">y</span><span class="op" id="2241999">*</span><span class="ident" id="2242000">p3</span><span class="op" id="2242002">)</span><span class="op" id="2242003">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242008">lgamma</span>&nbsp;<span class="op" id="2242015">+=</span>&nbsp;<span class="op" id="2242018">(</span><span class="ident" id="2242019">Tf</span>&nbsp;<span class="op" id="2242022">+</span>&nbsp;<span class="ident" id="2242024">p</span><span class="op" id="2242025">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242029">case</span>&nbsp;<span class="num" id="2242034">2</span><span class="op" id="2242035">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242040">p1</span>&nbsp;<span class="op" id="2242043">:=</span>&nbsp;<span class="ident" id="2242046">y</span>&nbsp;<span class="op" id="2242048">*</span>&nbsp;<span class="op" id="2242050">(</span><span class="ident" id="2242051">_lgamU</span><span class="op" id="2242057">[</span><span class="num" id="2242058">0</span><span class="op" id="2242059">]</span>&nbsp;<span class="op" id="2242061">+</span>&nbsp;<span class="ident" id="2242063">y</span><span class="op" id="2242064">*</span><span class="op" id="2242065">(</span><span class="ident" id="2242066">_lgamU</span><span class="op" id="2242072">[</span><span class="num" id="2242073">1</span><span class="op" id="2242074">]</span><span class="op" id="2242075">+</span><span class="ident" id="2242076">y</span><span class="op" id="2242077">*</span><span class="op" id="2242078">(</span><span class="ident" id="2242079">_lgamU</span><span class="op" id="2242085">[</span><span class="num" id="2242086">2</span><span class="op" id="2242087">]</span><span class="op" id="2242088">+</span><span class="ident" id="2242089">y</span><span class="op" id="2242090">*</span><span class="op" id="2242091">(</span><span class="ident" id="2242092">_lgamU</span><span class="op" id="2242098">[</span><span class="num" id="2242099">3</span><span class="op" id="2242100">]</span><span class="op" id="2242101">+</span><span class="ident" id="2242102">y</span><span class="op" id="2242103">*</span><span class="op" id="2242104">(</span><span class="ident" id="2242105">_lgamU</span><span class="op" id="2242111">[</span><span class="num" id="2242112">4</span><span class="op" id="2242113">]</span><span class="op" id="2242114">+</span><span class="ident" id="2242115">y</span><span class="op" id="2242116">*</span><span class="ident" id="2242117">_lgamU</span><span class="op" id="2242123">[</span><span class="num" id="2242124">5</span><span class="op" id="2242125">]</span><span class="op" id="2242126">)</span><span class="op" id="2242127">)</span><span class="op" id="2242128">)</span><span class="op" id="2242129">)</span><span class="op" id="2242130">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242135">p2</span>&nbsp;<span class="op" id="2242138">:=</span>&nbsp;<span class="num" id="2242141">1</span>&nbsp;<span class="op" id="2242143">+</span>&nbsp;<span class="ident" id="2242145">y</span><span class="op" id="2242146">*</span><span class="op" id="2242147">(</span><span class="ident" id="2242148">_lgamV</span><span class="op" id="2242154">[</span><span class="num" id="2242155">1</span><span class="op" id="2242156">]</span><span class="op" id="2242157">+</span><span class="ident" id="2242158">y</span><span class="op" id="2242159">*</span><span class="op" id="2242160">(</span><span class="ident" id="2242161">_lgamV</span><span class="op" id="2242167">[</span><span class="num" id="2242168">2</span><span class="op" id="2242169">]</span><span class="op" id="2242170">+</span><span class="ident" id="2242171">y</span><span class="op" id="2242172">*</span><span class="op" id="2242173">(</span><span class="ident" id="2242174">_lgamV</span><span class="op" id="2242180">[</span><span class="num" id="2242181">3</span><span class="op" id="2242182">]</span><span class="op" id="2242183">+</span><span class="ident" id="2242184">y</span><span class="op" id="2242185">*</span><span class="op" id="2242186">(</span><span class="ident" id="2242187">_lgamV</span><span class="op" id="2242193">[</span><span class="num" id="2242194">4</span><span class="op" id="2242195">]</span><span class="op" id="2242196">+</span><span class="ident" id="2242197">y</span><span class="op" id="2242198">*</span><span class="ident" id="2242199">_lgamV</span><span class="op" id="2242205">[</span><span class="num" id="2242206">5</span><span class="op" id="2242207">]</span><span class="op" id="2242208">)</span><span class="op" id="2242209">)</span><span class="op" id="2242210">)</span><span class="op" id="2242211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242216">lgamma</span>&nbsp;<span class="op" id="2242223">+=</span>&nbsp;<span class="op" id="2242226">(</span><span class="op" id="2242227">-</span><span class="num" id="2242228">0.5</span><span class="op" id="2242231">*</span><span class="ident" id="2242232">y</span>&nbsp;<span class="op" id="2242234">+</span>&nbsp;<span class="ident" id="2242236">p1</span><span class="op" id="2242238">/</span><span class="ident" id="2242239">p2</span><span class="op" id="2242241">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2242245">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242248">case</span>&nbsp;<span class="ident" id="2242253">x</span>&nbsp;<span class="op" id="2242255">&lt;</span>&nbsp;<span class="num" id="2242257">8</span><span class="op" id="2242258">:</span>&nbsp;<span class="comment" id="2242260">//&nbsp;2&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;8</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242276">i</span>&nbsp;<span class="op" id="2242278">:=</span>&nbsp;<span class="builtintype" id="2242281">int</span><span class="op" id="2242284">(</span><span class="ident" id="2242285">x</span><span class="op" id="2242286">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242290">y</span>&nbsp;<span class="op" id="2242292">:=</span>&nbsp;<span class="ident" id="2242295">x</span>&nbsp;<span class="op" id="2242297">-</span>&nbsp;<span class="builtintype" id="2242299">float64</span><span class="op" id="2242306">(</span><span class="ident" id="2242307">i</span><span class="op" id="2242308">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242312">p</span>&nbsp;<span class="op" id="2242314">:=</span>&nbsp;<span class="ident" id="2242317">y</span>&nbsp;<span class="op" id="2242319">*</span>&nbsp;<span class="op" id="2242321">(</span><span class="ident" id="2242322">_lgamS</span><span class="op" id="2242328">[</span><span class="num" id="2242329">0</span><span class="op" id="2242330">]</span>&nbsp;<span class="op" id="2242332">+</span>&nbsp;<span class="ident" id="2242334">y</span><span class="op" id="2242335">*</span><span class="op" id="2242336">(</span><span class="ident" id="2242337">_lgamS</span><span class="op" id="2242343">[</span><span class="num" id="2242344">1</span><span class="op" id="2242345">]</span><span class="op" id="2242346">+</span><span class="ident" id="2242347">y</span><span class="op" id="2242348">*</span><span class="op" id="2242349">(</span><span class="ident" id="2242350">_lgamS</span><span class="op" id="2242356">[</span><span class="num" id="2242357">2</span><span class="op" id="2242358">]</span><span class="op" id="2242359">+</span><span class="ident" id="2242360">y</span><span class="op" id="2242361">*</span><span class="op" id="2242362">(</span><span class="ident" id="2242363">_lgamS</span><span class="op" id="2242369">[</span><span class="num" id="2242370">3</span><span class="op" id="2242371">]</span><span class="op" id="2242372">+</span><span class="ident" id="2242373">y</span><span class="op" id="2242374">*</span><span class="op" id="2242375">(</span><span class="ident" id="2242376">_lgamS</span><span class="op" id="2242382">[</span><span class="num" id="2242383">4</span><span class="op" id="2242384">]</span><span class="op" id="2242385">+</span><span class="ident" id="2242386">y</span><span class="op" id="2242387">*</span><span class="op" id="2242388">(</span><span class="ident" id="2242389">_lgamS</span><span class="op" id="2242395">[</span><span class="num" id="2242396">5</span><span class="op" id="2242397">]</span><span class="op" id="2242398">+</span><span class="ident" id="2242399">y</span><span class="op" id="2242400">*</span><span class="ident" id="2242401">_lgamS</span><span class="op" id="2242407">[</span><span class="num" id="2242408">6</span><span class="op" id="2242409">]</span><span class="op" id="2242410">)</span><span class="op" id="2242411">)</span><span class="op" id="2242412">)</span><span class="op" id="2242413">)</span><span class="op" id="2242414">)</span><span class="op" id="2242415">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242419">q</span>&nbsp;<span class="op" id="2242421">:=</span>&nbsp;<span class="num" id="2242424">1</span>&nbsp;<span class="op" id="2242426">+</span>&nbsp;<span class="ident" id="2242428">y</span><span class="op" id="2242429">*</span><span class="op" id="2242430">(</span><span class="ident" id="2242431">_lgamR</span><span class="op" id="2242437">[</span><span class="num" id="2242438">1</span><span class="op" id="2242439">]</span><span class="op" id="2242440">+</span><span class="ident" id="2242441">y</span><span class="op" id="2242442">*</span><span class="op" id="2242443">(</span><span class="ident" id="2242444">_lgamR</span><span class="op" id="2242450">[</span><span class="num" id="2242451">2</span><span class="op" id="2242452">]</span><span class="op" id="2242453">+</span><span class="ident" id="2242454">y</span><span class="op" id="2242455">*</span><span class="op" id="2242456">(</span><span class="ident" id="2242457">_lgamR</span><span class="op" id="2242463">[</span><span class="num" id="2242464">3</span><span class="op" id="2242465">]</span><span class="op" id="2242466">+</span><span class="ident" id="2242467">y</span><span class="op" id="2242468">*</span><span class="op" id="2242469">(</span><span class="ident" id="2242470">_lgamR</span><span class="op" id="2242476">[</span><span class="num" id="2242477">4</span><span class="op" id="2242478">]</span><span class="op" id="2242479">+</span><span class="ident" id="2242480">y</span><span class="op" id="2242481">*</span><span class="op" id="2242482">(</span><span class="ident" id="2242483">_lgamR</span><span class="op" id="2242489">[</span><span class="num" id="2242490">5</span><span class="op" id="2242491">]</span><span class="op" id="2242492">+</span><span class="ident" id="2242493">y</span><span class="op" id="2242494">*</span><span class="ident" id="2242495">_lgamR</span><span class="op" id="2242501">[</span><span class="num" id="2242502">6</span><span class="op" id="2242503">]</span><span class="op" id="2242504">)</span><span class="op" id="2242505">)</span><span class="op" id="2242506">)</span><span class="op" id="2242507">)</span><span class="op" id="2242508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242512">lgamma</span>&nbsp;<span class="op" id="2242519">=</span>&nbsp;<span class="num" id="2242521">0.5</span><span class="op" id="2242524">*</span><span class="ident" id="2242525">y</span>&nbsp;<span class="op" id="2242527">+</span>&nbsp;<span class="ident" id="2242529">p</span><span class="op" id="2242530">/</span><span class="ident" id="2242531">q</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242535">z</span>&nbsp;<span class="op" id="2242537">:=</span>&nbsp;<span class="num" id="2242540">1.0</span>&nbsp;<span class="comment" id="2242544">//&nbsp;Lgamma(1+s)&nbsp;=&nbsp;Log(s)&nbsp;+&nbsp;Lgamma(s)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242582">switch</span>&nbsp;<span class="ident" id="2242589">i</span>&nbsp;<span class="op" id="2242591">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242595">case</span>&nbsp;<span class="num" id="2242600">7</span><span class="op" id="2242601">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242606">z</span>&nbsp;<span class="op" id="2242608">*=</span>&nbsp;<span class="op" id="2242611">(</span><span class="ident" id="2242612">y</span>&nbsp;<span class="op" id="2242614">+</span>&nbsp;<span class="num" id="2242616">6</span><span class="op" id="2242617">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242622">fallthrough</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242636">case</span>&nbsp;<span class="num" id="2242641">6</span><span class="op" id="2242642">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242647">z</span>&nbsp;<span class="op" id="2242649">*=</span>&nbsp;<span class="op" id="2242652">(</span><span class="ident" id="2242653">y</span>&nbsp;<span class="op" id="2242655">+</span>&nbsp;<span class="num" id="2242657">5</span><span class="op" id="2242658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242663">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242677">case</span>&nbsp;<span class="num" id="2242682">5</span><span class="op" id="2242683">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242688">z</span>&nbsp;<span class="op" id="2242690">*=</span>&nbsp;<span class="op" id="2242693">(</span><span class="ident" id="2242694">y</span>&nbsp;<span class="op" id="2242696">+</span>&nbsp;<span class="num" id="2242698">4</span><span class="op" id="2242699">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242704">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242718">case</span>&nbsp;<span class="num" id="2242723">4</span><span class="op" id="2242724">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242729">z</span>&nbsp;<span class="op" id="2242731">*=</span>&nbsp;<span class="op" id="2242734">(</span><span class="ident" id="2242735">y</span>&nbsp;<span class="op" id="2242737">+</span>&nbsp;<span class="num" id="2242739">3</span><span class="op" id="2242740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242745">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242759">case</span>&nbsp;<span class="num" id="2242764">3</span><span class="op" id="2242765">:</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242770">z</span>&nbsp;<span class="op" id="2242772">*=</span>&nbsp;<span class="op" id="2242775">(</span><span class="ident" id="2242776">y</span>&nbsp;<span class="op" id="2242778">+</span>&nbsp;<span class="num" id="2242780">2</span><span class="op" id="2242781">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242786">lgamma</span>&nbsp;<span class="op" id="2242793">+=</span>&nbsp;<span class="ident" id="2242796">Log</span><span class="op" id="2242799">(</span><span class="ident" id="2242800">z</span><span class="op" id="2242801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2242805">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2242808">case</span>&nbsp;<span class="ident" id="2242813">x</span>&nbsp;<span class="op" id="2242815">&lt;</span>&nbsp;<span class="ident" id="2242817">Two58</span><span class="op" id="2242822">:</span>&nbsp;<span class="comment" id="2242824">//&nbsp;8&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2**58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242844">t</span>&nbsp;<span class="op" id="2242846">:=</span>&nbsp;<span class="ident" id="2242849">Log</span><span class="op" id="2242852">(</span><span class="ident" id="2242853">x</span><span class="op" id="2242854">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242858">z</span>&nbsp;<span class="op" id="2242860">:=</span>&nbsp;<span class="num" id="2242863">1</span>&nbsp;<span class="op" id="2242865">/</span>&nbsp;<span class="ident" id="2242867">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242871">y</span>&nbsp;<span class="op" id="2242873">:=</span>&nbsp;<span class="ident" id="2242876">z</span>&nbsp;<span class="op" id="2242878">*</span>&nbsp;<span class="ident" id="2242880">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242884">w</span>&nbsp;<span class="op" id="2242886">:=</span>&nbsp;<span class="ident" id="2242889">_lgamW</span><span class="op" id="2242895">[</span><span class="num" id="2242896">0</span><span class="op" id="2242897">]</span>&nbsp;<span class="op" id="2242899">+</span>&nbsp;<span class="ident" id="2242901">z</span><span class="op" id="2242902">*</span><span class="op" id="2242903">(</span><span class="ident" id="2242904">_lgamW</span><span class="op" id="2242910">[</span><span class="num" id="2242911">1</span><span class="op" id="2242912">]</span><span class="op" id="2242913">+</span><span class="ident" id="2242914">y</span><span class="op" id="2242915">*</span><span class="op" id="2242916">(</span><span class="ident" id="2242917">_lgamW</span><span class="op" id="2242923">[</span><span class="num" id="2242924">2</span><span class="op" id="2242925">]</span><span class="op" id="2242926">+</span><span class="ident" id="2242927">y</span><span class="op" id="2242928">*</span><span class="op" id="2242929">(</span><span class="ident" id="2242930">_lgamW</span><span class="op" id="2242936">[</span><span class="num" id="2242937">3</span><span class="op" id="2242938">]</span><span class="op" id="2242939">+</span><span class="ident" id="2242940">y</span><span class="op" id="2242941">*</span><span class="op" id="2242942">(</span><span class="ident" id="2242943">_lgamW</span><span class="op" id="2242949">[</span><span class="num" id="2242950">4</span><span class="op" id="2242951">]</span><span class="op" id="2242952">+</span><span class="ident" id="2242953">y</span><span class="op" id="2242954">*</span><span class="op" id="2242955">(</span><span class="ident" id="2242956">_lgamW</span><span class="op" id="2242962">[</span><span class="num" id="2242963">5</span><span class="op" id="2242964">]</span><span class="op" id="2242965">+</span><span class="ident" id="2242966">y</span><span class="op" id="2242967">*</span><span class="ident" id="2242968">_lgamW</span><span class="op" id="2242974">[</span><span class="num" id="2242975">6</span><span class="op" id="2242976">]</span><span class="op" id="2242977">)</span><span class="op" id="2242978">)</span><span class="op" id="2242979">)</span><span class="op" id="2242980">)</span><span class="op" id="2242981">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2242985">lgamma</span>&nbsp;<span class="op" id="2242992">=</span>&nbsp;<span class="op" id="2242994">(</span><span class="ident" id="2242995">x</span><span class="op" id="2242996">-</span><span class="num" id="2242997">0.5</span><span class="op" id="2243000">)</span><span class="op" id="2243001">*</span><span class="op" id="2243002">(</span><span class="ident" id="2243003">t</span><span class="op" id="2243004">-</span><span class="num" id="2243005">1</span><span class="op" id="2243006">)</span>&nbsp;<span class="op" id="2243008">+</span>&nbsp;<span class="ident" id="2243010">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243013">default</span><span class="op" id="2243020">:</span>&nbsp;<span class="comment" id="2243022">//&nbsp;2**58&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;Inf</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243045">lgamma</span>&nbsp;<span class="op" id="2243052">=</span>&nbsp;<span class="ident" id="2243054">x</span>&nbsp;<span class="op" id="2243056">*</span>&nbsp;<span class="op" id="2243058">(</span><span class="ident" id="2243059">Log</span><span class="op" id="2243062">(</span><span class="ident" id="2243063">x</span><span class="op" id="2243064">)</span>&nbsp;<span class="op" id="2243066">-</span>&nbsp;<span class="num" id="2243068">1</span><span class="op" id="2243069">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2243072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243075">if</span>&nbsp;<span class="ident" id="2243078">neg</span>&nbsp;<span class="op" id="2243082">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243086">lgamma</span>&nbsp;<span class="op" id="2243093">=</span>&nbsp;<span class="ident" id="2243095">nadj</span>&nbsp;<span class="op" id="2243100">-</span>&nbsp;<span class="ident" id="2243102">lgamma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2243110">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243113">return</span><br>
<span class="lineno"></span><span class="op" id="2243120">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2243123">//&nbsp;sinPi(x)&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;negative&nbsp;x</span><br>
<span class="lineno"></span><span class="keyword" id="2243171">func</span>&nbsp;<span class="ident" id="2243176">sinPi</span><span class="op" id="2243181">(</span><span class="ident" id="2243182">x</span>&nbsp;<span class="builtintype" id="2243184">float64</span><span class="op" id="2243191">)</span>&nbsp;<span class="builtintype" id="2243193">float64</span>&nbsp;<span class="op" id="2243201">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243204">const</span>&nbsp;<span class="op" id="2243210">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243214">Two52</span>&nbsp;<span class="op" id="2243220">=</span>&nbsp;<span class="num" id="2243222">1</span>&nbsp;<span class="op" id="2243224">&lt;&lt;</span>&nbsp;<span class="num" id="2243227">52</span>&nbsp;<span class="comment" id="2243230">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243266">Two53</span>&nbsp;<span class="op" id="2243272">=</span>&nbsp;<span class="num" id="2243274">1</span>&nbsp;<span class="op" id="2243276">&lt;&lt;</span>&nbsp;<span class="num" id="2243279">53</span>&nbsp;<span class="comment" id="2243282">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2243317">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243320">if</span>&nbsp;<span class="ident" id="2243323">x</span>&nbsp;<span class="op" id="2243325">&lt;</span>&nbsp;<span class="num" id="2243327">0.25</span>&nbsp;<span class="op" id="2243332">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243336">return</span>&nbsp;<span class="op" id="2243343">-</span><span class="ident" id="2243344">Sin</span><span class="op" id="2243347">(</span><span class="ident" id="2243348">Pi</span>&nbsp;<span class="op" id="2243351">*</span>&nbsp;<span class="ident" id="2243353">x</span><span class="op" id="2243354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2243357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2243361">//&nbsp;argument&nbsp;reduction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243384">z</span>&nbsp;<span class="op" id="2243386">:=</span>&nbsp;<span class="ident" id="2243389">Floor</span><span class="op" id="2243394">(</span><span class="ident" id="2243395">x</span><span class="op" id="2243396">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243399">var</span>&nbsp;<span class="ident" id="2243403">n</span>&nbsp;<span class="builtintype" id="2243405">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243410">if</span>&nbsp;<span class="ident" id="2243413">z</span>&nbsp;<span class="op" id="2243415">!=</span>&nbsp;<span class="ident" id="2243418">x</span>&nbsp;<span class="op" id="2243420">{</span>&nbsp;<span class="comment" id="2243422">//&nbsp;inexact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243435">x</span>&nbsp;<span class="op" id="2243437">=</span>&nbsp;<span class="ident" id="2243439">Mod</span><span class="op" id="2243442">(</span><span class="ident" id="2243443">x</span><span class="op" id="2243444">,</span>&nbsp;<span class="num" id="2243446">2</span><span class="op" id="2243447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243451">n</span>&nbsp;<span class="op" id="2243453">=</span>&nbsp;<span class="builtintype" id="2243455">int</span><span class="op" id="2243458">(</span><span class="ident" id="2243459">x</span>&nbsp;<span class="op" id="2243461">*</span>&nbsp;<span class="num" id="2243463">4</span><span class="op" id="2243464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2243467">}</span>&nbsp;<span class="keyword" id="2243469">else</span>&nbsp;<span class="op" id="2243474">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243478">if</span>&nbsp;<span class="ident" id="2243481">x</span>&nbsp;<span class="op" id="2243483">&gt;=</span>&nbsp;<span class="ident" id="2243486">Two53</span>&nbsp;<span class="op" id="2243492">{</span>&nbsp;<span class="comment" id="2243494">//&nbsp;x&nbsp;must&nbsp;be&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243515">x</span>&nbsp;<span class="op" id="2243517">=</span>&nbsp;<span class="num" id="2243519">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243524">n</span>&nbsp;<span class="op" id="2243526">=</span>&nbsp;<span class="num" id="2243528">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2243532">}</span>&nbsp;<span class="keyword" id="2243534">else</span>&nbsp;<span class="op" id="2243539">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243544">if</span>&nbsp;<span class="ident" id="2243547">x</span>&nbsp;<span class="op" id="2243549">&lt;</span>&nbsp;<span class="ident" id="2243551">Two52</span>&nbsp;<span class="op" id="2243557">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243563">z</span>&nbsp;<span class="op" id="2243565">=</span>&nbsp;<span class="ident" id="2243567">x</span>&nbsp;<span class="op" id="2243569">+</span>&nbsp;<span class="ident" id="2243571">Two52</span>&nbsp;<span class="comment" id="2243577">//&nbsp;exact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2243589">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243594">n</span>&nbsp;<span class="op" id="2243596">=</span>&nbsp;<span class="builtintype" id="2243598">int</span><span class="op" id="2243601">(</span><span class="num" id="2243602">1</span>&nbsp;<span class="op" id="2243604">&amp;</span>&nbsp;<span class="ident" id="2243606">Float64bits</span><span class="op" id="2243617">(</span><span class="ident" id="2243618">z</span><span class="op" id="2243619">)</span><span class="op" id="2243620">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243625">x</span>&nbsp;<span class="op" id="2243627">=</span>&nbsp;<span class="builtintype" id="2243629">float64</span><span class="op" id="2243636">(</span><span class="ident" id="2243637">n</span><span class="op" id="2243638">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243643">n</span>&nbsp;<span class="op" id="2243645">&lt;&lt;=</span>&nbsp;<span class="num" id="2243649">2</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2243653">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2243656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243659">switch</span>&nbsp;<span class="ident" id="2243666">n</span>&nbsp;<span class="op" id="2243668">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243671">case</span>&nbsp;<span class="num" id="2243676">0</span><span class="op" id="2243677">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243681">x</span>&nbsp;<span class="op" id="2243683">=</span>&nbsp;<span class="ident" id="2243685">Sin</span><span class="op" id="2243688">(</span><span class="ident" id="2243689">Pi</span>&nbsp;<span class="op" id="2243692">*</span>&nbsp;<span class="ident" id="2243694">x</span><span class="op" id="2243695">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243698">case</span>&nbsp;<span class="num" id="2243703">1</span><span class="op" id="2243704">,</span>&nbsp;<span class="num" id="2243706">2</span><span class="op" id="2243707">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243711">x</span>&nbsp;<span class="op" id="2243713">=</span>&nbsp;<span class="ident" id="2243715">Cos</span><span class="op" id="2243718">(</span><span class="ident" id="2243719">Pi</span>&nbsp;<span class="op" id="2243722">*</span>&nbsp;<span class="op" id="2243724">(</span><span class="num" id="2243725">0.5</span>&nbsp;<span class="op" id="2243729">-</span>&nbsp;<span class="ident" id="2243731">x</span><span class="op" id="2243732">)</span><span class="op" id="2243733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243736">case</span>&nbsp;<span class="num" id="2243741">3</span><span class="op" id="2243742">,</span>&nbsp;<span class="num" id="2243744">4</span><span class="op" id="2243745">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243749">x</span>&nbsp;<span class="op" id="2243751">=</span>&nbsp;<span class="ident" id="2243753">Sin</span><span class="op" id="2243756">(</span><span class="ident" id="2243757">Pi</span>&nbsp;<span class="op" id="2243760">*</span>&nbsp;<span class="op" id="2243762">(</span><span class="num" id="2243763">1</span>&nbsp;<span class="op" id="2243765">-</span>&nbsp;<span class="ident" id="2243767">x</span><span class="op" id="2243768">)</span><span class="op" id="2243769">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243772">case</span>&nbsp;<span class="num" id="2243777">5</span><span class="op" id="2243778">,</span>&nbsp;<span class="num" id="2243780">6</span><span class="op" id="2243781">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243785">x</span>&nbsp;<span class="op" id="2243787">=</span>&nbsp;<span class="op" id="2243789">-</span><span class="ident" id="2243790">Cos</span><span class="op" id="2243793">(</span><span class="ident" id="2243794">Pi</span>&nbsp;<span class="op" id="2243797">*</span>&nbsp;<span class="op" id="2243799">(</span><span class="ident" id="2243800">x</span>&nbsp;<span class="op" id="2243802">-</span>&nbsp;<span class="num" id="2243804">1.5</span><span class="op" id="2243807">)</span><span class="op" id="2243808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243811">default</span><span class="op" id="2243818">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2243822">x</span>&nbsp;<span class="op" id="2243824">=</span>&nbsp;<span class="ident" id="2243826">Sin</span><span class="op" id="2243829">(</span><span class="ident" id="2243830">Pi</span>&nbsp;<span class="op" id="2243833">*</span>&nbsp;<span class="op" id="2243835">(</span><span class="ident" id="2243836">x</span>&nbsp;<span class="op" id="2243838">-</span>&nbsp;<span class="num" id="2243840">2</span><span class="op" id="2243841">)</span><span class="op" id="2243842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2243845">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2243848">return</span>&nbsp;<span class="op" id="2243855">-</span><span class="ident" id="2243856">x</span><br>
<span class="lineno">365</span><span class="op" id="2243858">}</span>
</div>
</body>
</html>
