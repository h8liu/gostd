<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>encoding/gob</h2>
<ul>
<li><a href="/gostd/encoding/gob/codec_test.go.html">codec_test.go</a></li>
<li><a href="/gostd/encoding/gob/dec_helpers.go.html">dec_helpers.go</a></li>
<li><a href="/gostd/encoding/gob/decode.go.html">decode.go</a></li>
<li><a href="/gostd/encoding/gob/decoder.go.html">decoder.go</a></li>
<li><a href="/gostd/encoding/gob/doc.go.html">doc.go</a></li>
<li><a href="/gostd/encoding/gob/enc_helpers.go.html">enc_helpers.go</a></li>
<li><a href="/gostd/encoding/gob/encode.go.html">encode.go</a></li>
<li><a href="/gostd/encoding/gob/encoder.go.html">encoder.go</a></li>
<li><a href="/gostd/encoding/gob/encoder_test.go.html">encoder_test.go</a></li>
<li><a href="/gostd/encoding/gob/error.go.html">error.go</a></li>
<li><a href="/gostd/encoding/gob/example_encdec_test.go.html">example_encdec_test.go</a></li>
<li><a href="/gostd/encoding/gob/example_interface_test.go.html">example_interface_test.go</a></li>
<li><a href="/gostd/encoding/gob/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/encoding/gob/gobencdec_test.go.html">gobencdec_test.go</a></li>
<li><a href="/gostd/encoding/gob/timing_test.go.html">timing_test.go</a></li>
<li><a href="/gostd/encoding/gob/type.go.html" class="current">type.go</a></li>
<li><a href="/gostd/encoding/gob/type_test.go.html">type_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5999428">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5999483">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5999537">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="5999588">package</span>&nbsp;<span class="ident" id="5999596">gob</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5999601">import</span>&nbsp;<span class="op" id="5999608">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5999611">&#34;encoding&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5999623">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5999633">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5999640">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5999646">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5999657">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5999665">&#34;sync/atomic&#34;</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5999680">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5999691">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="5999706">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5999709">//&nbsp;userTypeInfo&nbsp;stores&nbsp;the&nbsp;information&nbsp;associated&nbsp;with&nbsp;a&nbsp;type&nbsp;the&nbsp;user&nbsp;has&nbsp;handed</span><br>
<span class="lineno">20</span><span class="comment" id="5999791">//&nbsp;to&nbsp;the&nbsp;package.&nbsp;&nbsp;It&#39;s&nbsp;computed&nbsp;once&nbsp;and&nbsp;stored&nbsp;in&nbsp;a&nbsp;map&nbsp;keyed&nbsp;by&nbsp;reflection</span><br>
<span class="lineno"></span><span class="comment" id="5999870">//&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="5999879">type</span>&nbsp;<span class="ident" id="5999884">userTypeInfo</span>&nbsp;<span class="keyword" id="5999897">struct</span>&nbsp;<span class="op" id="5999904">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999907">user</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5999919">reflect</span><span class="op" id="5999926">.</span><span class="ident" id="5999927">Type</span>&nbsp;<span class="comment" id="5999932">//&nbsp;the&nbsp;type&nbsp;the&nbsp;user&nbsp;handed&nbsp;us</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5999964">base</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5999976">reflect</span><span class="op" id="5999983">.</span><span class="ident" id="5999984">Type</span>&nbsp;<span class="comment" id="5999989">//&nbsp;the&nbsp;base&nbsp;type&nbsp;after&nbsp;all&nbsp;indirections</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000030">indir</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6000042">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6000055">//&nbsp;number&nbsp;of&nbsp;indirections&nbsp;to&nbsp;reach&nbsp;the&nbsp;base&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000105">externalEnc</span>&nbsp;<span class="builtintype" id="6000117">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6000130">//&nbsp;xGob,&nbsp;xBinary,&nbsp;or&nbsp;xText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000158">externalDec</span>&nbsp;<span class="builtintype" id="6000170">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6000183">//&nbsp;xGob,&nbsp;xBinary&nbsp;or&nbsp;xText</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000210">encIndir</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6000222">int8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6000235">//&nbsp;number&nbsp;of&nbsp;indirections&nbsp;to&nbsp;reach&nbsp;the&nbsp;receiver&nbsp;type;&nbsp;may&nbsp;be&nbsp;negative</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000306">decIndir</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="6000318">int8</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6000331">//&nbsp;number&nbsp;of&nbsp;indirections&nbsp;to&nbsp;reach&nbsp;the&nbsp;receiver&nbsp;type;&nbsp;may&nbsp;be&nbsp;negative</span><br>
<span class="lineno">30</span><span class="op" id="6000401">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6000404">//&nbsp;externalEncoding&nbsp;bits</span><br>
<span class="lineno"></span><span class="keyword" id="6000429">const</span>&nbsp;<span class="op" id="6000435">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000438">xGob</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6000446">=</span>&nbsp;<span class="num" id="6000448">1</span>&nbsp;<span class="op" id="6000450">+</span>&nbsp;<span class="ident" id="6000452">iota</span>&nbsp;<span class="comment" id="6000457">//&nbsp;GobEncoder&nbsp;or&nbsp;GobDecoder</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000486">xBinary</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6000505">//&nbsp;encoding.BinaryMarshaler&nbsp;or&nbsp;encoding.BinaryUnmarshaler</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000564">xText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6000583">//&nbsp;encoding.TextMarshaler&nbsp;or&nbsp;encoding.TextUnmarshaler</span><br>
<span class="lineno"></span><span class="op" id="6000637">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6000640">var</span>&nbsp;<span class="op" id="6000644">(</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6000647">//&nbsp;Protected&nbsp;by&nbsp;an&nbsp;RWMutex&nbsp;because&nbsp;we&nbsp;read&nbsp;it&nbsp;a&nbsp;lot&nbsp;and&nbsp;write</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6000710">//&nbsp;it&nbsp;only&nbsp;when&nbsp;we&nbsp;see&nbsp;a&nbsp;new&nbsp;type,&nbsp;typically&nbsp;when&nbsp;compiling.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000772">userTypeLock</span>&nbsp;&nbsp;<span class="ident" id="6000786">sync</span><span class="op" id="6000790">.</span><span class="ident" id="6000791">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6000800">userTypeCache</span>&nbsp;<span class="op" id="6000814">=</span>&nbsp;<span class="builtinfunc" id="6000816">make</span><span class="op" id="6000820">(</span><span class="keyword" id="6000821">map</span><span class="op" id="6000824">[</span><span class="ident" id="6000825">reflect</span><span class="op" id="6000832">.</span><span class="ident" id="6000833">Type</span><span class="op" id="6000837">]</span><span class="op" id="6000838">*</span><span class="ident" id="6000839">userTypeInfo</span><span class="op" id="6000851">)</span><br>
<span class="lineno"></span><span class="op" id="6000853">)</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="6000856">//&nbsp;validType&nbsp;returns,&nbsp;and&nbsp;saves,&nbsp;the&nbsp;information&nbsp;associated&nbsp;with&nbsp;user-provided&nbsp;type&nbsp;rt.</span><br>
<span class="lineno"></span><span class="comment" id="6000944">//&nbsp;If&nbsp;the&nbsp;user&nbsp;type&nbsp;is&nbsp;not&nbsp;valid,&nbsp;err&nbsp;will&nbsp;be&nbsp;non-nil.&nbsp;&nbsp;To&nbsp;be&nbsp;used&nbsp;when&nbsp;the&nbsp;error&nbsp;handler</span><br>
<span class="lineno"></span><span class="comment" id="6001034">//&nbsp;is&nbsp;not&nbsp;set&nbsp;up.</span><br>
<span class="lineno"></span><span class="keyword" id="6001052">func</span>&nbsp;<span class="ident" id="6001057">validUserType</span><span class="op" id="6001070">(</span><span class="ident" id="6001071">rt</span>&nbsp;<span class="ident" id="6001074">reflect</span><span class="op" id="6001081">.</span><span class="ident" id="6001082">Type</span><span class="op" id="6001086">)</span>&nbsp;<span class="op" id="6001088">(</span><span class="ident" id="6001089">ut</span>&nbsp;<span class="op" id="6001092">*</span><span class="ident" id="6001093">userTypeInfo</span><span class="op" id="6001105">,</span>&nbsp;<span class="ident" id="6001107">err</span>&nbsp;<span class="builtintype" id="6001111">error</span><span class="op" id="6001116">)</span>&nbsp;<span class="op" id="6001118">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001121">userTypeLock</span><span class="op" id="6001133">.</span><span class="ident" id="6001134">RLock</span><span class="op" id="6001139">(</span><span class="op" id="6001140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001143">ut</span>&nbsp;<span class="op" id="6001146">=</span>&nbsp;<span class="ident" id="6001148">userTypeCache</span><span class="op" id="6001161">[</span><span class="ident" id="6001162">rt</span><span class="op" id="6001164">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001167">userTypeLock</span><span class="op" id="6001179">.</span><span class="ident" id="6001180">RUnlock</span><span class="op" id="6001187">(</span><span class="op" id="6001188">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001191">if</span>&nbsp;<span class="ident" id="6001194">ut</span>&nbsp;<span class="op" id="6001197">!=</span>&nbsp;<span class="ident" id="6001200">nil</span>&nbsp;<span class="op" id="6001204">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001208">return</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6001216">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6001219">//&nbsp;Now&nbsp;set&nbsp;the&nbsp;value&nbsp;under&nbsp;the&nbsp;write&nbsp;lock.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001263">userTypeLock</span><span class="op" id="6001275">.</span><span class="ident" id="6001276">Lock</span><span class="op" id="6001280">(</span><span class="op" id="6001281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001284">defer</span>&nbsp;<span class="ident" id="6001290">userTypeLock</span><span class="op" id="6001302">.</span><span class="ident" id="6001303">Unlock</span><span class="op" id="6001309">(</span><span class="op" id="6001310">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001313">if</span>&nbsp;<span class="ident" id="6001316">ut</span>&nbsp;<span class="op" id="6001319">=</span>&nbsp;<span class="ident" id="6001321">userTypeCache</span><span class="op" id="6001334">[</span><span class="ident" id="6001335">rt</span><span class="op" id="6001337">]</span><span class="op" id="6001338">;</span>&nbsp;<span class="ident" id="6001340">ut</span>&nbsp;<span class="op" id="6001343">!=</span>&nbsp;<span class="ident" id="6001346">nil</span>&nbsp;<span class="op" id="6001350">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6001354">//&nbsp;Lost&nbsp;the&nbsp;race;&nbsp;not&nbsp;a&nbsp;problem.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001389">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6001397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001400">ut</span>&nbsp;<span class="op" id="6001403">=</span>&nbsp;<span class="builtinfunc" id="6001405">new</span><span class="op" id="6001408">(</span><span class="ident" id="6001409">userTypeInfo</span><span class="op" id="6001421">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001424">ut</span><span class="op" id="6001426">.</span><span class="ident" id="6001427">base</span>&nbsp;<span class="op" id="6001432">=</span>&nbsp;<span class="ident" id="6001434">rt</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001438">ut</span><span class="op" id="6001440">.</span><span class="ident" id="6001441">user</span>&nbsp;<span class="op" id="6001446">=</span>&nbsp;<span class="ident" id="6001448">rt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6001452">//&nbsp;A&nbsp;type&nbsp;that&nbsp;is&nbsp;just&nbsp;a&nbsp;cycle&nbsp;of&nbsp;pointers&nbsp;(such&nbsp;as&nbsp;type&nbsp;T&nbsp;*T)&nbsp;cannot</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6001523">//&nbsp;be&nbsp;represented&nbsp;in&nbsp;gobs,&nbsp;which&nbsp;need&nbsp;some&nbsp;concrete&nbsp;data.&nbsp;&nbsp;We&nbsp;use&nbsp;a</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6001592">//&nbsp;cycle&nbsp;detection&nbsp;algorithm&nbsp;from&nbsp;Knuth,&nbsp;Vol&nbsp;2,&nbsp;Section&nbsp;3.1,&nbsp;Ex&nbsp;6,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6001660">//&nbsp;pp&nbsp;539-540.&nbsp;&nbsp;As&nbsp;we&nbsp;step&nbsp;through&nbsp;indirections,&nbsp;run&nbsp;another&nbsp;type&nbsp;at</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6001730">//&nbsp;half&nbsp;speed.&nbsp;If&nbsp;they&nbsp;meet&nbsp;up,&nbsp;there&#39;s&nbsp;a&nbsp;cycle.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001780">slowpoke</span>&nbsp;<span class="op" id="6001789">:=</span>&nbsp;<span class="ident" id="6001792">ut</span><span class="op" id="6001794">.</span><span class="ident" id="6001795">base</span>&nbsp;<span class="comment" id="6001800">//&nbsp;walks&nbsp;half&nbsp;as&nbsp;fast&nbsp;as&nbsp;ut.base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001834">for</span>&nbsp;<span class="op" id="6001838">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001842">pt</span>&nbsp;<span class="op" id="6001845">:=</span>&nbsp;<span class="ident" id="6001848">ut</span><span class="op" id="6001850">.</span><span class="ident" id="6001851">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001858">if</span>&nbsp;<span class="ident" id="6001861">pt</span><span class="op" id="6001863">.</span><span class="ident" id="6001864">Kind</span><span class="op" id="6001868">(</span><span class="op" id="6001869">)</span>&nbsp;<span class="op" id="6001871">!=</span>&nbsp;<span class="ident" id="6001874">reflect</span><span class="op" id="6001881">.</span><span class="ident" id="6001882">Ptr</span>&nbsp;<span class="op" id="6001886">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001891">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6001899">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6001903">ut</span><span class="op" id="6001905">.</span><span class="ident" id="6001906">base</span>&nbsp;<span class="op" id="6001911">=</span>&nbsp;<span class="ident" id="6001913">pt</span><span class="op" id="6001915">.</span><span class="ident" id="6001916">Elem</span><span class="op" id="6001920">(</span><span class="op" id="6001921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6001925">if</span>&nbsp;<span class="ident" id="6001928">ut</span><span class="op" id="6001930">.</span><span class="ident" id="6001931">base</span>&nbsp;<span class="op" id="6001936">==</span>&nbsp;<span class="ident" id="6001939">slowpoke</span>&nbsp;<span class="op" id="6001948">{</span>&nbsp;<span class="comment" id="6001950">//&nbsp;ut.base&nbsp;lapped&nbsp;slowpoke</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6001980">//&nbsp;recursive&nbsp;pointer&nbsp;type.</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6002010">return</span>&nbsp;<span class="ident" id="6002017">nil</span><span class="op" id="6002020">,</span>&nbsp;<span class="ident" id="6002022">errors</span><span class="op" id="6002028">.</span><span class="ident" id="6002029">New</span><span class="op" id="6002032">(</span><span class="string" id="6002033">&#34;can&#39;t&nbsp;represent&nbsp;recursive&nbsp;pointer&nbsp;type&nbsp;&#34;</span>&nbsp;<span class="op" id="6002075">+</span>&nbsp;<span class="ident" id="6002077">ut</span><span class="op" id="6002079">.</span><span class="ident" id="6002080">base</span><span class="op" id="6002084">.</span><span class="ident" id="6002085">String</span><span class="op" id="6002091">(</span><span class="op" id="6002092">)</span><span class="op" id="6002093">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6002097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6002101">if</span>&nbsp;<span class="ident" id="6002104">ut</span><span class="op" id="6002106">.</span><span class="ident" id="6002107">indir</span><span class="op" id="6002112">%</span><span class="num" id="6002113">2</span>&nbsp;<span class="op" id="6002115">==</span>&nbsp;<span class="num" id="6002118">0</span>&nbsp;<span class="op" id="6002120">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002125">slowpoke</span>&nbsp;<span class="op" id="6002134">=</span>&nbsp;<span class="ident" id="6002136">slowpoke</span><span class="op" id="6002144">.</span><span class="ident" id="6002145">Elem</span><span class="op" id="6002149">(</span><span class="op" id="6002150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6002154">}</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002158">ut</span><span class="op" id="6002160">.</span><span class="ident" id="6002161">indir</span><span class="op" id="6002166">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6002170">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6002174">if</span>&nbsp;<span class="ident" id="6002177">ok</span><span class="op" id="6002179">,</span>&nbsp;<span class="ident" id="6002181">indir</span>&nbsp;<span class="op" id="6002187">:=</span>&nbsp;<span class="ident" id="6002190">implementsInterface</span><span class="op" id="6002209">(</span><span class="ident" id="6002210">ut</span><span class="op" id="6002212">.</span><span class="ident" id="6002213">user</span><span class="op" id="6002217">,</span>&nbsp;<span class="ident" id="6002219">gobEncoderInterfaceType</span><span class="op" id="6002242">)</span><span class="op" id="6002243">;</span>&nbsp;<span class="ident" id="6002245">ok</span>&nbsp;<span class="op" id="6002248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002252">ut</span><span class="op" id="6002254">.</span><span class="ident" id="6002255">externalEnc</span><span class="op" id="6002266">,</span>&nbsp;<span class="ident" id="6002268">ut</span><span class="op" id="6002270">.</span><span class="ident" id="6002271">encIndir</span>&nbsp;<span class="op" id="6002280">=</span>&nbsp;<span class="ident" id="6002282">xGob</span><span class="op" id="6002286">,</span>&nbsp;<span class="ident" id="6002288">indir</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6002295">}</span>&nbsp;<span class="keyword" id="6002297">else</span>&nbsp;<span class="keyword" id="6002302">if</span>&nbsp;<span class="ident" id="6002305">ok</span><span class="op" id="6002307">,</span>&nbsp;<span class="ident" id="6002309">indir</span>&nbsp;<span class="op" id="6002315">:=</span>&nbsp;<span class="ident" id="6002318">implementsInterface</span><span class="op" id="6002337">(</span><span class="ident" id="6002338">ut</span><span class="op" id="6002340">.</span><span class="ident" id="6002341">user</span><span class="op" id="6002345">,</span>&nbsp;<span class="ident" id="6002347">binaryMarshalerInterfaceType</span><span class="op" id="6002375">)</span><span class="op" id="6002376">;</span>&nbsp;<span class="ident" id="6002378">ok</span>&nbsp;<span class="op" id="6002381">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002385">ut</span><span class="op" id="6002387">.</span><span class="ident" id="6002388">externalEnc</span><span class="op" id="6002399">,</span>&nbsp;<span class="ident" id="6002401">ut</span><span class="op" id="6002403">.</span><span class="ident" id="6002404">encIndir</span>&nbsp;<span class="op" id="6002413">=</span>&nbsp;<span class="ident" id="6002415">xBinary</span><span class="op" id="6002422">,</span>&nbsp;<span class="ident" id="6002424">indir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6002431">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6002435">//&nbsp;NOTE(rsc):&nbsp;Would&nbsp;like&nbsp;to&nbsp;allow&nbsp;MarshalText&nbsp;here,&nbsp;but&nbsp;results&nbsp;in&nbsp;incompatibility</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6002519">//&nbsp;with&nbsp;older&nbsp;encodings&nbsp;for&nbsp;net.IP.&nbsp;See&nbsp;golang.org/issue/6760.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6002583">//&nbsp;}&nbsp;else&nbsp;if&nbsp;ok,&nbsp;indir&nbsp;:=&nbsp;implementsInterface(ut.user,&nbsp;textMarshalerInterfaceType);&nbsp;ok&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6002673">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsput.externalEnc,&nbsp;ut.encIndir&nbsp;=&nbsp;xText,&nbsp;indir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6002721">//&nbsp;}</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6002728">if</span>&nbsp;<span class="ident" id="6002731">ok</span><span class="op" id="6002733">,</span>&nbsp;<span class="ident" id="6002735">indir</span>&nbsp;<span class="op" id="6002741">:=</span>&nbsp;<span class="ident" id="6002744">implementsInterface</span><span class="op" id="6002763">(</span><span class="ident" id="6002764">ut</span><span class="op" id="6002766">.</span><span class="ident" id="6002767">user</span><span class="op" id="6002771">,</span>&nbsp;<span class="ident" id="6002773">gobDecoderInterfaceType</span><span class="op" id="6002796">)</span><span class="op" id="6002797">;</span>&nbsp;<span class="ident" id="6002799">ok</span>&nbsp;<span class="op" id="6002802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002806">ut</span><span class="op" id="6002808">.</span><span class="ident" id="6002809">externalDec</span><span class="op" id="6002820">,</span>&nbsp;<span class="ident" id="6002822">ut</span><span class="op" id="6002824">.</span><span class="ident" id="6002825">decIndir</span>&nbsp;<span class="op" id="6002834">=</span>&nbsp;<span class="ident" id="6002836">xGob</span><span class="op" id="6002840">,</span>&nbsp;<span class="ident" id="6002842">indir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6002849">}</span>&nbsp;<span class="keyword" id="6002851">else</span>&nbsp;<span class="keyword" id="6002856">if</span>&nbsp;<span class="ident" id="6002859">ok</span><span class="op" id="6002861">,</span>&nbsp;<span class="ident" id="6002863">indir</span>&nbsp;<span class="op" id="6002869">:=</span>&nbsp;<span class="ident" id="6002872">implementsInterface</span><span class="op" id="6002891">(</span><span class="ident" id="6002892">ut</span><span class="op" id="6002894">.</span><span class="ident" id="6002895">user</span><span class="op" id="6002899">,</span>&nbsp;<span class="ident" id="6002901">binaryUnmarshalerInterfaceType</span><span class="op" id="6002931">)</span><span class="op" id="6002932">;</span>&nbsp;<span class="ident" id="6002934">ok</span>&nbsp;<span class="op" id="6002937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6002941">ut</span><span class="op" id="6002943">.</span><span class="ident" id="6002944">externalDec</span><span class="op" id="6002955">,</span>&nbsp;<span class="ident" id="6002957">ut</span><span class="op" id="6002959">.</span><span class="ident" id="6002960">decIndir</span>&nbsp;<span class="op" id="6002969">=</span>&nbsp;<span class="ident" id="6002971">xBinary</span><span class="op" id="6002978">,</span>&nbsp;<span class="ident" id="6002980">indir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6002987">}</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6002991">//&nbsp;See&nbsp;note&nbsp;above.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6003011">//&nbsp;}&nbsp;else&nbsp;if&nbsp;ok,&nbsp;indir&nbsp;:=&nbsp;implementsInterface(ut.user,&nbsp;textUnmarshalerInterfaceType);&nbsp;ok&nbsp;{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6003103">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsput.externalDec,&nbsp;ut.decIndir&nbsp;=&nbsp;xText,&nbsp;indir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6003151">//&nbsp;}</span><br>
<span class="lineno">110</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003158">userTypeCache</span><span class="op" id="6003171">[</span><span class="ident" id="6003172">rt</span><span class="op" id="6003174">]</span>&nbsp;<span class="op" id="6003176">=</span>&nbsp;<span class="ident" id="6003178">ut</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6003182">return</span><br>
<span class="lineno"></span><span class="op" id="6003189">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="6003192">var</span>&nbsp;<span class="op" id="6003196">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003199">gobEncoderInterfaceType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6003230">=</span>&nbsp;<span class="ident" id="6003232">reflect</span><span class="op" id="6003239">.</span><span class="ident" id="6003240">TypeOf</span><span class="op" id="6003246">(</span><span class="op" id="6003247">(</span><span class="op" id="6003248">*</span><span class="ident" id="6003249">GobEncoder</span><span class="op" id="6003259">)</span><span class="op" id="6003260">(</span><span class="ident" id="6003261">nil</span><span class="op" id="6003264">)</span><span class="op" id="6003265">)</span><span class="op" id="6003266">.</span><span class="ident" id="6003267">Elem</span><span class="op" id="6003271">(</span><span class="op" id="6003272">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003275">gobDecoderInterfaceType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6003306">=</span>&nbsp;<span class="ident" id="6003308">reflect</span><span class="op" id="6003315">.</span><span class="ident" id="6003316">TypeOf</span><span class="op" id="6003322">(</span><span class="op" id="6003323">(</span><span class="op" id="6003324">*</span><span class="ident" id="6003325">GobDecoder</span><span class="op" id="6003335">)</span><span class="op" id="6003336">(</span><span class="ident" id="6003337">nil</span><span class="op" id="6003340">)</span><span class="op" id="6003341">)</span><span class="op" id="6003342">.</span><span class="ident" id="6003343">Elem</span><span class="op" id="6003347">(</span><span class="op" id="6003348">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003351">binaryMarshalerInterfaceType</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6003382">=</span>&nbsp;<span class="ident" id="6003384">reflect</span><span class="op" id="6003391">.</span><span class="ident" id="6003392">TypeOf</span><span class="op" id="6003398">(</span><span class="op" id="6003399">(</span><span class="op" id="6003400">*</span><span class="ident" id="6003401">encoding</span><span class="op" id="6003409">.</span><span class="ident" id="6003410">BinaryMarshaler</span><span class="op" id="6003425">)</span><span class="op" id="6003426">(</span><span class="ident" id="6003427">nil</span><span class="op" id="6003430">)</span><span class="op" id="6003431">)</span><span class="op" id="6003432">.</span><span class="ident" id="6003433">Elem</span><span class="op" id="6003437">(</span><span class="op" id="6003438">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003441">binaryUnmarshalerInterfaceType</span>&nbsp;<span class="op" id="6003472">=</span>&nbsp;<span class="ident" id="6003474">reflect</span><span class="op" id="6003481">.</span><span class="ident" id="6003482">TypeOf</span><span class="op" id="6003488">(</span><span class="op" id="6003489">(</span><span class="op" id="6003490">*</span><span class="ident" id="6003491">encoding</span><span class="op" id="6003499">.</span><span class="ident" id="6003500">BinaryUnmarshaler</span><span class="op" id="6003517">)</span><span class="op" id="6003518">(</span><span class="ident" id="6003519">nil</span><span class="op" id="6003522">)</span><span class="op" id="6003523">)</span><span class="op" id="6003524">.</span><span class="ident" id="6003525">Elem</span><span class="op" id="6003529">(</span><span class="op" id="6003530">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003533">textMarshalerInterfaceType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6003564">=</span>&nbsp;<span class="ident" id="6003566">reflect</span><span class="op" id="6003573">.</span><span class="ident" id="6003574">TypeOf</span><span class="op" id="6003580">(</span><span class="op" id="6003581">(</span><span class="op" id="6003582">*</span><span class="ident" id="6003583">encoding</span><span class="op" id="6003591">.</span><span class="ident" id="6003592">TextMarshaler</span><span class="op" id="6003605">)</span><span class="op" id="6003606">(</span><span class="ident" id="6003607">nil</span><span class="op" id="6003610">)</span><span class="op" id="6003611">)</span><span class="op" id="6003612">.</span><span class="ident" id="6003613">Elem</span><span class="op" id="6003617">(</span><span class="op" id="6003618">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6003621">textUnmarshalerInterfaceType</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6003652">=</span>&nbsp;<span class="ident" id="6003654">reflect</span><span class="op" id="6003661">.</span><span class="ident" id="6003662">TypeOf</span><span class="op" id="6003668">(</span><span class="op" id="6003669">(</span><span class="op" id="6003670">*</span><span class="ident" id="6003671">encoding</span><span class="op" id="6003679">.</span><span class="ident" id="6003680">TextUnmarshaler</span><span class="op" id="6003695">)</span><span class="op" id="6003696">(</span><span class="ident" id="6003697">nil</span><span class="op" id="6003700">)</span><span class="op" id="6003701">)</span><span class="op" id="6003702">.</span><span class="ident" id="6003703">Elem</span><span class="op" id="6003707">(</span><span class="op" id="6003708">)</span><br>
<span class="lineno"></span><span class="op" id="6003710">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6003713">//&nbsp;implementsInterface&nbsp;reports&nbsp;whether&nbsp;the&nbsp;type&nbsp;implements&nbsp;the</span><br>
<span class="lineno">125</span><span class="comment" id="6003776">//&nbsp;gobEncoder/gobDecoder&nbsp;interface.</span><br>
<span class="lineno"></span><span class="comment" id="6003812">//&nbsp;It&nbsp;also&nbsp;returns&nbsp;the&nbsp;number&nbsp;of&nbsp;indirections&nbsp;required&nbsp;to&nbsp;get&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6003881">//&nbsp;implementation.</span><br>
<span class="lineno"></span><span class="keyword" id="6003900">func</span>&nbsp;<span class="ident" id="6003905">implementsInterface</span><span class="op" id="6003924">(</span><span class="ident" id="6003925">typ</span><span class="op" id="6003928">,</span>&nbsp;<span class="ident" id="6003930">gobEncDecType</span>&nbsp;<span class="ident" id="6003944">reflect</span><span class="op" id="6003951">.</span><span class="ident" id="6003952">Type</span><span class="op" id="6003956">)</span>&nbsp;<span class="op" id="6003958">(</span><span class="ident" id="6003959">success</span>&nbsp;<span class="builtintype" id="6003967">bool</span><span class="op" id="6003971">,</span>&nbsp;<span class="ident" id="6003973">indir</span>&nbsp;<span class="builtintype" id="6003979">int8</span><span class="op" id="6003983">)</span>&nbsp;<span class="op" id="6003985">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6003988">if</span>&nbsp;<span class="ident" id="6003991">typ</span>&nbsp;<span class="op" id="6003995">==</span>&nbsp;<span class="ident" id="6003998">nil</span>&nbsp;<span class="op" id="6004002">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6004006">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6004014">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004017">rt</span>&nbsp;<span class="op" id="6004020">:=</span>&nbsp;<span class="ident" id="6004023">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6004028">//&nbsp;The&nbsp;type&nbsp;might&nbsp;be&nbsp;a&nbsp;pointer&nbsp;and&nbsp;we&nbsp;need&nbsp;to&nbsp;keep</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6004080">//&nbsp;dereferencing&nbsp;to&nbsp;the&nbsp;base&nbsp;type&nbsp;until&nbsp;we&nbsp;find&nbsp;an&nbsp;implementation.</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6004148">for</span>&nbsp;<span class="op" id="6004152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6004156">if</span>&nbsp;<span class="ident" id="6004159">rt</span><span class="op" id="6004161">.</span><span class="ident" id="6004162">Implements</span><span class="op" id="6004172">(</span><span class="ident" id="6004173">gobEncDecType</span><span class="op" id="6004186">)</span>&nbsp;<span class="op" id="6004188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6004193">return</span>&nbsp;<span class="builtintype" id="6004200">true</span><span class="op" id="6004204">,</span>&nbsp;<span class="ident" id="6004206">indir</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6004214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6004218">if</span>&nbsp;<span class="ident" id="6004221">p</span>&nbsp;<span class="op" id="6004223">:=</span>&nbsp;<span class="ident" id="6004226">rt</span><span class="op" id="6004228">;</span>&nbsp;<span class="ident" id="6004230">p</span><span class="op" id="6004231">.</span><span class="ident" id="6004232">Kind</span><span class="op" id="6004236">(</span><span class="op" id="6004237">)</span>&nbsp;<span class="op" id="6004239">==</span>&nbsp;<span class="ident" id="6004242">reflect</span><span class="op" id="6004249">.</span><span class="ident" id="6004250">Ptr</span>&nbsp;<span class="op" id="6004254">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004259">indir</span><span class="op" id="6004264">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6004270">if</span>&nbsp;<span class="ident" id="6004273">indir</span>&nbsp;<span class="op" id="6004279">&gt;</span>&nbsp;<span class="num" id="6004281">100</span>&nbsp;<span class="op" id="6004285">{</span>&nbsp;<span class="comment" id="6004287">//&nbsp;insane&nbsp;number&nbsp;of&nbsp;indirections</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6004324">return</span>&nbsp;<span class="builtintype" id="6004331">false</span><span class="op" id="6004336">,</span>&nbsp;<span class="num" id="6004338">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6004343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004348">rt</span>&nbsp;<span class="op" id="6004351">=</span>&nbsp;<span class="ident" id="6004353">p</span><span class="op" id="6004354">.</span><span class="ident" id="6004355">Elem</span><span class="op" id="6004359">(</span><span class="op" id="6004360">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6004365">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6004376">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6004380">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6004387">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6004390">//&nbsp;No&nbsp;luck&nbsp;yet,&nbsp;but&nbsp;if&nbsp;this&nbsp;is&nbsp;a&nbsp;base&nbsp;type&nbsp;(non-pointer),&nbsp;the&nbsp;pointer&nbsp;might&nbsp;satisfy.</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6004476">if</span>&nbsp;<span class="ident" id="6004479">typ</span><span class="op" id="6004482">.</span><span class="ident" id="6004483">Kind</span><span class="op" id="6004487">(</span><span class="op" id="6004488">)</span>&nbsp;<span class="op" id="6004490">!=</span>&nbsp;<span class="ident" id="6004493">reflect</span><span class="op" id="6004500">.</span><span class="ident" id="6004501">Ptr</span>&nbsp;<span class="op" id="6004505">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6004509">//&nbsp;Not&nbsp;a&nbsp;pointer,&nbsp;but&nbsp;does&nbsp;the&nbsp;pointer&nbsp;work?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6004556">if</span>&nbsp;<span class="ident" id="6004559">reflect</span><span class="op" id="6004566">.</span><span class="ident" id="6004567">PtrTo</span><span class="op" id="6004572">(</span><span class="ident" id="6004573">typ</span><span class="op" id="6004576">)</span><span class="op" id="6004577">.</span><span class="ident" id="6004578">Implements</span><span class="op" id="6004588">(</span><span class="ident" id="6004589">gobEncDecType</span><span class="op" id="6004602">)</span>&nbsp;<span class="op" id="6004604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6004609">return</span>&nbsp;<span class="builtintype" id="6004616">true</span><span class="op" id="6004620">,</span>&nbsp;<span class="op" id="6004622">-</span><span class="num" id="6004623">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6004627">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6004630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6004633">return</span>&nbsp;<span class="builtintype" id="6004640">false</span><span class="op" id="6004645">,</span>&nbsp;<span class="num" id="6004647">0</span><br>
<span class="lineno"></span><span class="op" id="6004649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6004652">//&nbsp;userType&nbsp;returns,&nbsp;and&nbsp;saves,&nbsp;the&nbsp;information&nbsp;associated&nbsp;with&nbsp;user-provided&nbsp;type&nbsp;rt.</span><br>
<span class="lineno">160</span><span class="comment" id="6004739">//&nbsp;If&nbsp;the&nbsp;user&nbsp;type&nbsp;is&nbsp;not&nbsp;valid,&nbsp;it&nbsp;calls&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="6004789">func</span>&nbsp;<span class="ident" id="6004794">userType</span><span class="op" id="6004802">(</span><span class="ident" id="6004803">rt</span>&nbsp;<span class="ident" id="6004806">reflect</span><span class="op" id="6004813">.</span><span class="ident" id="6004814">Type</span><span class="op" id="6004818">)</span>&nbsp;<span class="op" id="6004820">*</span><span class="ident" id="6004821">userTypeInfo</span>&nbsp;<span class="op" id="6004834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004837">ut</span><span class="op" id="6004839">,</span>&nbsp;<span class="ident" id="6004841">err</span>&nbsp;<span class="op" id="6004845">:=</span>&nbsp;<span class="ident" id="6004848">validUserType</span><span class="op" id="6004861">(</span><span class="ident" id="6004862">rt</span><span class="op" id="6004864">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6004867">if</span>&nbsp;<span class="ident" id="6004870">err</span>&nbsp;<span class="op" id="6004874">!=</span>&nbsp;<span class="ident" id="6004877">nil</span>&nbsp;<span class="op" id="6004881">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6004885">error_</span><span class="op" id="6004891">(</span><span class="ident" id="6004892">err</span><span class="op" id="6004895">)</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6004898">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6004901">return</span>&nbsp;<span class="ident" id="6004908">ut</span><br>
<span class="lineno"></span><span class="op" id="6004911">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6004914">//&nbsp;A&nbsp;typeId&nbsp;represents&nbsp;a&nbsp;gob&nbsp;Type&nbsp;as&nbsp;an&nbsp;integer&nbsp;that&nbsp;can&nbsp;be&nbsp;passed&nbsp;on&nbsp;the&nbsp;wire.</span><br>
<span class="lineno">170</span><span class="comment" id="6004994">//&nbsp;Internally,&nbsp;typeIds&nbsp;are&nbsp;used&nbsp;as&nbsp;keys&nbsp;to&nbsp;a&nbsp;map&nbsp;to&nbsp;recover&nbsp;the&nbsp;underlying&nbsp;type&nbsp;info.</span><br>
<span class="lineno"></span><span class="keyword" id="6005080">type</span>&nbsp;<span class="ident" id="6005085">typeId</span>&nbsp;<span class="builtintype" id="6005092">int32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6005099">var</span>&nbsp;<span class="ident" id="6005103">nextId</span>&nbsp;<span class="ident" id="6005110">typeId</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="6005123">//&nbsp;incremented&nbsp;for&nbsp;each&nbsp;new&nbsp;type&nbsp;we&nbsp;build</span><br>
<span class="lineno"></span><span class="keyword" id="6005165">var</span>&nbsp;<span class="ident" id="6005169">typeLock</span>&nbsp;<span class="ident" id="6005178">sync</span><span class="op" id="6005182">.</span><span class="ident" id="6005183">Mutex</span>&nbsp;<span class="comment" id="6005189">//&nbsp;set&nbsp;while&nbsp;building&nbsp;a&nbsp;type</span><br>
<span class="lineno">175</span><span class="keyword" id="6005218">const</span>&nbsp;<span class="ident" id="6005224">firstUserId</span>&nbsp;<span class="op" id="6005236">=</span>&nbsp;<span class="num" id="6005238">64</span>&nbsp;&nbsp;<span class="comment" id="6005242">//&nbsp;lowest&nbsp;id&nbsp;number&nbsp;granted&nbsp;to&nbsp;user</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6005279">type</span>&nbsp;<span class="ident" id="6005284">gobType</span>&nbsp;<span class="keyword" id="6005292">interface</span>&nbsp;<span class="op" id="6005302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005305">id</span><span class="op" id="6005307">(</span><span class="op" id="6005308">)</span>&nbsp;<span class="ident" id="6005310">typeId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005318">setId</span><span class="op" id="6005323">(</span><span class="ident" id="6005324">id</span>&nbsp;<span class="ident" id="6005327">typeId</span><span class="op" id="6005333">)</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005336">name</span><span class="op" id="6005340">(</span><span class="op" id="6005341">)</span>&nbsp;<span class="builtintype" id="6005343">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="6005351">string</span><span class="op" id="6005357">(</span><span class="op" id="6005358">)</span>&nbsp;<span class="builtintype" id="6005360">string</span>&nbsp;<span class="comment" id="6005367">//&nbsp;not&nbsp;public;&nbsp;only&nbsp;for&nbsp;debugging</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005402">safeString</span><span class="op" id="6005412">(</span><span class="ident" id="6005413">seen</span>&nbsp;<span class="keyword" id="6005418">map</span><span class="op" id="6005421">[</span><span class="ident" id="6005422">typeId</span><span class="op" id="6005428">]</span><span class="builtintype" id="6005429">bool</span><span class="op" id="6005433">)</span>&nbsp;<span class="builtintype" id="6005435">string</span><br>
<span class="lineno"></span><span class="op" id="6005442">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">185</span><span class="keyword" id="6005445">var</span>&nbsp;<span class="ident" id="6005449">types</span>&nbsp;<span class="op" id="6005455">=</span>&nbsp;<span class="builtinfunc" id="6005457">make</span><span class="op" id="6005461">(</span><span class="keyword" id="6005462">map</span><span class="op" id="6005465">[</span><span class="ident" id="6005466">reflect</span><span class="op" id="6005473">.</span><span class="ident" id="6005474">Type</span><span class="op" id="6005478">]</span><span class="ident" id="6005479">gobType</span><span class="op" id="6005486">)</span><br>
<span class="lineno"></span><span class="keyword" id="6005488">var</span>&nbsp;<span class="ident" id="6005492">idToType</span>&nbsp;<span class="op" id="6005501">=</span>&nbsp;<span class="builtinfunc" id="6005503">make</span><span class="op" id="6005507">(</span><span class="keyword" id="6005508">map</span><span class="op" id="6005511">[</span><span class="ident" id="6005512">typeId</span><span class="op" id="6005518">]</span><span class="ident" id="6005519">gobType</span><span class="op" id="6005526">)</span><br>
<span class="lineno"></span><span class="keyword" id="6005528">var</span>&nbsp;<span class="ident" id="6005532">builtinIdToType</span>&nbsp;<span class="keyword" id="6005548">map</span><span class="op" id="6005551">[</span><span class="ident" id="6005552">typeId</span><span class="op" id="6005558">]</span><span class="ident" id="6005559">gobType</span>&nbsp;<span class="comment" id="6005567">//&nbsp;set&nbsp;in&nbsp;init()&nbsp;after&nbsp;builtins&nbsp;are&nbsp;established</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6005616">func</span>&nbsp;<span class="ident" id="6005621">setTypeId</span><span class="op" id="6005630">(</span><span class="ident" id="6005631">typ</span>&nbsp;<span class="ident" id="6005635">gobType</span><span class="op" id="6005642">)</span>&nbsp;<span class="op" id="6005644">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6005647">//&nbsp;When&nbsp;building&nbsp;recursive&nbsp;types,&nbsp;someone&nbsp;may&nbsp;get&nbsp;there&nbsp;before&nbsp;us.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6005715">if</span>&nbsp;<span class="ident" id="6005718">typ</span><span class="op" id="6005721">.</span><span class="ident" id="6005722">id</span><span class="op" id="6005724">(</span><span class="op" id="6005725">)</span>&nbsp;<span class="op" id="6005727">!=</span>&nbsp;<span class="num" id="6005730">0</span>&nbsp;<span class="op" id="6005732">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6005736">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6005744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005747">nextId</span><span class="op" id="6005753">++</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005757">typ</span><span class="op" id="6005760">.</span><span class="ident" id="6005761">setId</span><span class="op" id="6005766">(</span><span class="ident" id="6005767">nextId</span><span class="op" id="6005773">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6005776">idToType</span><span class="op" id="6005784">[</span><span class="ident" id="6005785">nextId</span><span class="op" id="6005791">]</span>&nbsp;<span class="op" id="6005793">=</span>&nbsp;<span class="ident" id="6005795">typ</span><br>
<span class="lineno"></span><span class="op" id="6005799">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6005802">func</span>&nbsp;<span class="op" id="6005807">(</span><span class="ident" id="6005808">t</span>&nbsp;<span class="ident" id="6005810">typeId</span><span class="op" id="6005816">)</span>&nbsp;<span class="ident" id="6005818">gobType</span><span class="op" id="6005825">(</span><span class="op" id="6005826">)</span>&nbsp;<span class="ident" id="6005828">gobType</span>&nbsp;<span class="op" id="6005836">{</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6005839">if</span>&nbsp;<span class="ident" id="6005842">t</span>&nbsp;<span class="op" id="6005844">==</span>&nbsp;<span class="num" id="6005847">0</span>&nbsp;<span class="op" id="6005849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6005853">return</span>&nbsp;<span class="ident" id="6005860">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6005865">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6005868">return</span>&nbsp;<span class="ident" id="6005875">idToType</span><span class="op" id="6005883">[</span><span class="ident" id="6005884">t</span><span class="op" id="6005885">]</span><br>
<span class="lineno"></span><span class="op" id="6005887">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span><span class="comment" id="6005890">//&nbsp;string&nbsp;returns&nbsp;the&nbsp;string&nbsp;representation&nbsp;of&nbsp;the&nbsp;type&nbsp;associated&nbsp;with&nbsp;the&nbsp;typeId.</span><br>
<span class="lineno"></span><span class="keyword" id="6005974">func</span>&nbsp;<span class="op" id="6005979">(</span><span class="ident" id="6005980">t</span>&nbsp;<span class="ident" id="6005982">typeId</span><span class="op" id="6005988">)</span>&nbsp;<span class="builtintype" id="6005990">string</span><span class="op" id="6005996">(</span><span class="op" id="6005997">)</span>&nbsp;<span class="builtintype" id="6005999">string</span>&nbsp;<span class="op" id="6006006">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6006009">if</span>&nbsp;<span class="ident" id="6006012">t</span><span class="op" id="6006013">.</span><span class="ident" id="6006014">gobType</span><span class="op" id="6006021">(</span><span class="op" id="6006022">)</span>&nbsp;<span class="op" id="6006024">==</span>&nbsp;<span class="ident" id="6006027">nil</span>&nbsp;<span class="op" id="6006031">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6006035">return</span>&nbsp;<span class="string" id="6006042">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6006051">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6006054">return</span>&nbsp;<span class="ident" id="6006061">t</span><span class="op" id="6006062">.</span><span class="ident" id="6006063">gobType</span><span class="op" id="6006070">(</span><span class="op" id="6006071">)</span><span class="op" id="6006072">.</span><span class="builtintype" id="6006073">string</span><span class="op" id="6006079">(</span><span class="op" id="6006080">)</span><br>
<span class="lineno"></span><span class="op" id="6006082">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6006085">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;type&nbsp;associated&nbsp;with&nbsp;the&nbsp;typeId.</span><br>
<span class="lineno">215</span><span class="keyword" id="6006150">func</span>&nbsp;<span class="op" id="6006155">(</span><span class="ident" id="6006156">t</span>&nbsp;<span class="ident" id="6006158">typeId</span><span class="op" id="6006164">)</span>&nbsp;<span class="ident" id="6006166">name</span><span class="op" id="6006170">(</span><span class="op" id="6006171">)</span>&nbsp;<span class="builtintype" id="6006173">string</span>&nbsp;<span class="op" id="6006180">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6006183">if</span>&nbsp;<span class="ident" id="6006186">t</span><span class="op" id="6006187">.</span><span class="ident" id="6006188">gobType</span><span class="op" id="6006195">(</span><span class="op" id="6006196">)</span>&nbsp;<span class="op" id="6006198">==</span>&nbsp;<span class="ident" id="6006201">nil</span>&nbsp;<span class="op" id="6006205">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6006209">return</span>&nbsp;<span class="string" id="6006216">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6006225">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6006228">return</span>&nbsp;<span class="ident" id="6006235">t</span><span class="op" id="6006236">.</span><span class="ident" id="6006237">gobType</span><span class="op" id="6006244">(</span><span class="op" id="6006245">)</span><span class="op" id="6006246">.</span><span class="ident" id="6006247">name</span><span class="op" id="6006251">(</span><span class="op" id="6006252">)</span><br>
<span class="lineno">220</span><span class="op" id="6006254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6006257">//&nbsp;CommonType&nbsp;holds&nbsp;elements&nbsp;of&nbsp;all&nbsp;types.</span><br>
<span class="lineno"></span><span class="comment" id="6006300">//&nbsp;It&nbsp;is&nbsp;a&nbsp;historical&nbsp;artifact,&nbsp;kept&nbsp;for&nbsp;binary&nbsp;compatibility&nbsp;and&nbsp;exported</span><br>
<span class="lineno"></span><span class="comment" id="6006375">//&nbsp;only&nbsp;for&nbsp;the&nbsp;benefit&nbsp;of&nbsp;the&nbsp;package&#39;s&nbsp;encoding&nbsp;of&nbsp;type&nbsp;descriptors.&nbsp;It&nbsp;is</span><br>
<span class="lineno">225</span><span class="comment" id="6006452">//&nbsp;not&nbsp;intended&nbsp;for&nbsp;direct&nbsp;use&nbsp;by&nbsp;clients.</span><br>
<span class="lineno"></span><span class="keyword" id="6006495">type</span>&nbsp;<span class="ident" id="6006500">CommonType</span>&nbsp;<span class="keyword" id="6006511">struct</span>&nbsp;<span class="op" id="6006518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6006521">Name</span>&nbsp;<span class="builtintype" id="6006526">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6006534">Id</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6006539">typeId</span><br>
<span class="lineno"></span><span class="op" id="6006546">}</span><br>
<span class="lineno">230</span><br>
<span class="lineno"></span><span class="keyword" id="6006549">func</span>&nbsp;<span class="op" id="6006554">(</span><span class="ident" id="6006555">t</span>&nbsp;<span class="op" id="6006557">*</span><span class="ident" id="6006558">CommonType</span><span class="op" id="6006568">)</span>&nbsp;<span class="ident" id="6006570">id</span><span class="op" id="6006572">(</span><span class="op" id="6006573">)</span>&nbsp;<span class="ident" id="6006575">typeId</span>&nbsp;<span class="op" id="6006582">{</span>&nbsp;<span class="keyword" id="6006584">return</span>&nbsp;<span class="ident" id="6006591">t</span><span class="op" id="6006592">.</span><span class="ident" id="6006593">Id</span>&nbsp;<span class="op" id="6006596">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6006599">func</span>&nbsp;<span class="op" id="6006604">(</span><span class="ident" id="6006605">t</span>&nbsp;<span class="op" id="6006607">*</span><span class="ident" id="6006608">CommonType</span><span class="op" id="6006618">)</span>&nbsp;<span class="ident" id="6006620">setId</span><span class="op" id="6006625">(</span><span class="ident" id="6006626">id</span>&nbsp;<span class="ident" id="6006629">typeId</span><span class="op" id="6006635">)</span>&nbsp;<span class="op" id="6006637">{</span>&nbsp;<span class="ident" id="6006639">t</span><span class="op" id="6006640">.</span><span class="ident" id="6006641">Id</span>&nbsp;<span class="op" id="6006644">=</span>&nbsp;<span class="ident" id="6006646">id</span>&nbsp;<span class="op" id="6006649">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="keyword" id="6006652">func</span>&nbsp;<span class="op" id="6006657">(</span><span class="ident" id="6006658">t</span>&nbsp;<span class="op" id="6006660">*</span><span class="ident" id="6006661">CommonType</span><span class="op" id="6006671">)</span>&nbsp;<span class="builtintype" id="6006673">string</span><span class="op" id="6006679">(</span><span class="op" id="6006680">)</span>&nbsp;<span class="builtintype" id="6006682">string</span>&nbsp;<span class="op" id="6006689">{</span>&nbsp;<span class="keyword" id="6006691">return</span>&nbsp;<span class="ident" id="6006698">t</span><span class="op" id="6006699">.</span><span class="ident" id="6006700">Name</span>&nbsp;<span class="op" id="6006705">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6006708">func</span>&nbsp;<span class="op" id="6006713">(</span><span class="ident" id="6006714">t</span>&nbsp;<span class="op" id="6006716">*</span><span class="ident" id="6006717">CommonType</span><span class="op" id="6006727">)</span>&nbsp;<span class="ident" id="6006729">safeString</span><span class="op" id="6006739">(</span><span class="ident" id="6006740">seen</span>&nbsp;<span class="keyword" id="6006745">map</span><span class="op" id="6006748">[</span><span class="ident" id="6006749">typeId</span><span class="op" id="6006755">]</span><span class="builtintype" id="6006756">bool</span><span class="op" id="6006760">)</span>&nbsp;<span class="builtintype" id="6006762">string</span>&nbsp;<span class="op" id="6006769">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6006772">return</span>&nbsp;<span class="ident" id="6006779">t</span><span class="op" id="6006780">.</span><span class="ident" id="6006781">Name</span><br>
<span class="lineno"></span><span class="op" id="6006786">}</span><br>
<span class="lineno">240</span><br>
<span class="lineno"></span><span class="keyword" id="6006789">func</span>&nbsp;<span class="op" id="6006794">(</span><span class="ident" id="6006795">t</span>&nbsp;<span class="op" id="6006797">*</span><span class="ident" id="6006798">CommonType</span><span class="op" id="6006808">)</span>&nbsp;<span class="ident" id="6006810">name</span><span class="op" id="6006814">(</span><span class="op" id="6006815">)</span>&nbsp;<span class="builtintype" id="6006817">string</span>&nbsp;<span class="op" id="6006824">{</span>&nbsp;<span class="keyword" id="6006826">return</span>&nbsp;<span class="ident" id="6006833">t</span><span class="op" id="6006834">.</span><span class="ident" id="6006835">Name</span>&nbsp;<span class="op" id="6006840">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6006843">//&nbsp;Create&nbsp;and&nbsp;check&nbsp;predefined&nbsp;types</span><br>
<span class="lineno"></span><span class="comment" id="6006880">//&nbsp;The&nbsp;string&nbsp;for&nbsp;tBytes&nbsp;is&nbsp;&#34;bytes&#34;&nbsp;not&nbsp;&#34;[]byte&#34;&nbsp;to&nbsp;signify&nbsp;its&nbsp;specialness.</span><br>
<span class="lineno">245</span><br>
<span class="lineno"></span><span class="keyword" id="6006958">var</span>&nbsp;<span class="op" id="6006962">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6006965">//&nbsp;Primordial&nbsp;types,&nbsp;needed&nbsp;during&nbsp;initialization.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6007017">//&nbsp;Always&nbsp;passed&nbsp;as&nbsp;pointers&nbsp;so&nbsp;the&nbsp;interface{}&nbsp;type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6007071">//&nbsp;goes&nbsp;through&nbsp;without&nbsp;losing&nbsp;its&nbsp;interfaceness.</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007122">tBool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6007133">=</span>&nbsp;<span class="ident" id="6007135">bootstrapType</span><span class="op" id="6007148">(</span><span class="string" id="6007149">&#34;bool&#34;</span><span class="op" id="6007155">,</span>&nbsp;<span class="op" id="6007157">(</span><span class="op" id="6007158">*</span><span class="builtintype" id="6007159">bool</span><span class="op" id="6007163">)</span><span class="op" id="6007164">(</span><span class="ident" id="6007165">nil</span><span class="op" id="6007168">)</span><span class="op" id="6007169">,</span>&nbsp;<span class="num" id="6007171">1</span><span class="op" id="6007172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007175">tInt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6007186">=</span>&nbsp;<span class="ident" id="6007188">bootstrapType</span><span class="op" id="6007201">(</span><span class="string" id="6007202">&#34;int&#34;</span><span class="op" id="6007207">,</span>&nbsp;<span class="op" id="6007209">(</span><span class="op" id="6007210">*</span><span class="builtintype" id="6007211">int</span><span class="op" id="6007214">)</span><span class="op" id="6007215">(</span><span class="ident" id="6007216">nil</span><span class="op" id="6007219">)</span><span class="op" id="6007220">,</span>&nbsp;<span class="num" id="6007222">2</span><span class="op" id="6007223">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007226">tUint</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6007237">=</span>&nbsp;<span class="ident" id="6007239">bootstrapType</span><span class="op" id="6007252">(</span><span class="string" id="6007253">&#34;uint&#34;</span><span class="op" id="6007259">,</span>&nbsp;<span class="op" id="6007261">(</span><span class="op" id="6007262">*</span><span class="builtintype" id="6007263">uint</span><span class="op" id="6007267">)</span><span class="op" id="6007268">(</span><span class="ident" id="6007269">nil</span><span class="op" id="6007272">)</span><span class="op" id="6007273">,</span>&nbsp;<span class="num" id="6007275">3</span><span class="op" id="6007276">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007279">tFloat</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6007290">=</span>&nbsp;<span class="ident" id="6007292">bootstrapType</span><span class="op" id="6007305">(</span><span class="string" id="6007306">&#34;float&#34;</span><span class="op" id="6007313">,</span>&nbsp;<span class="op" id="6007315">(</span><span class="op" id="6007316">*</span><span class="builtintype" id="6007317">float64</span><span class="op" id="6007324">)</span><span class="op" id="6007325">(</span><span class="ident" id="6007326">nil</span><span class="op" id="6007329">)</span><span class="op" id="6007330">,</span>&nbsp;<span class="num" id="6007332">4</span><span class="op" id="6007333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007336">tBytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6007347">=</span>&nbsp;<span class="ident" id="6007349">bootstrapType</span><span class="op" id="6007362">(</span><span class="string" id="6007363">&#34;bytes&#34;</span><span class="op" id="6007370">,</span>&nbsp;<span class="op" id="6007372">(</span><span class="op" id="6007373">*</span><span class="op" id="6007374">[</span><span class="op" id="6007375">]</span><span class="builtintype" id="6007376">byte</span><span class="op" id="6007380">)</span><span class="op" id="6007381">(</span><span class="ident" id="6007382">nil</span><span class="op" id="6007385">)</span><span class="op" id="6007386">,</span>&nbsp;<span class="num" id="6007388">5</span><span class="op" id="6007389">)</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007392">tString</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6007403">=</span>&nbsp;<span class="ident" id="6007405">bootstrapType</span><span class="op" id="6007418">(</span><span class="string" id="6007419">&#34;string&#34;</span><span class="op" id="6007427">,</span>&nbsp;<span class="op" id="6007429">(</span><span class="op" id="6007430">*</span><span class="builtintype" id="6007431">string</span><span class="op" id="6007437">)</span><span class="op" id="6007438">(</span><span class="ident" id="6007439">nil</span><span class="op" id="6007442">)</span><span class="op" id="6007443">,</span>&nbsp;<span class="num" id="6007445">6</span><span class="op" id="6007446">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007449">tComplex</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6007460">=</span>&nbsp;<span class="ident" id="6007462">bootstrapType</span><span class="op" id="6007475">(</span><span class="string" id="6007476">&#34;complex&#34;</span><span class="op" id="6007485">,</span>&nbsp;<span class="op" id="6007487">(</span><span class="op" id="6007488">*</span><span class="builtintype" id="6007489">complex128</span><span class="op" id="6007499">)</span><span class="op" id="6007500">(</span><span class="ident" id="6007501">nil</span><span class="op" id="6007504">)</span><span class="op" id="6007505">,</span>&nbsp;<span class="num" id="6007507">7</span><span class="op" id="6007508">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007511">tInterface</span>&nbsp;<span class="op" id="6007522">=</span>&nbsp;<span class="ident" id="6007524">bootstrapType</span><span class="op" id="6007537">(</span><span class="string" id="6007538">&#34;interface&#34;</span><span class="op" id="6007549">,</span>&nbsp;<span class="op" id="6007551">(</span><span class="op" id="6007552">*</span><span class="keyword" id="6007553">interface</span><span class="op" id="6007562">{</span><span class="op" id="6007563">}</span><span class="op" id="6007564">)</span><span class="op" id="6007565">(</span><span class="ident" id="6007566">nil</span><span class="op" id="6007569">)</span><span class="op" id="6007570">,</span>&nbsp;<span class="num" id="6007572">8</span><span class="op" id="6007573">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6007576">//&nbsp;Reserve&nbsp;some&nbsp;Ids&nbsp;for&nbsp;compatible&nbsp;expansion</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007622">tReserved7</span>&nbsp;<span class="op" id="6007633">=</span>&nbsp;<span class="ident" id="6007635">bootstrapType</span><span class="op" id="6007648">(</span><span class="string" id="6007649">&#34;_reserved1&#34;</span><span class="op" id="6007661">,</span>&nbsp;<span class="op" id="6007663">(</span><span class="op" id="6007664">*</span><span class="keyword" id="6007665">struct</span><span class="op" id="6007671">{</span>&nbsp;<span class="ident" id="6007673">r7</span>&nbsp;<span class="builtintype" id="6007676">int</span>&nbsp;<span class="op" id="6007680">}</span><span class="op" id="6007681">)</span><span class="op" id="6007682">(</span><span class="ident" id="6007683">nil</span><span class="op" id="6007686">)</span><span class="op" id="6007687">,</span>&nbsp;<span class="num" id="6007689">9</span><span class="op" id="6007690">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007693">tReserved6</span>&nbsp;<span class="op" id="6007704">=</span>&nbsp;<span class="ident" id="6007706">bootstrapType</span><span class="op" id="6007719">(</span><span class="string" id="6007720">&#34;_reserved1&#34;</span><span class="op" id="6007732">,</span>&nbsp;<span class="op" id="6007734">(</span><span class="op" id="6007735">*</span><span class="keyword" id="6007736">struct</span><span class="op" id="6007742">{</span>&nbsp;<span class="ident" id="6007744">r6</span>&nbsp;<span class="builtintype" id="6007747">int</span>&nbsp;<span class="op" id="6007751">}</span><span class="op" id="6007752">)</span><span class="op" id="6007753">(</span><span class="ident" id="6007754">nil</span><span class="op" id="6007757">)</span><span class="op" id="6007758">,</span>&nbsp;<span class="num" id="6007760">10</span><span class="op" id="6007762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007765">tReserved5</span>&nbsp;<span class="op" id="6007776">=</span>&nbsp;<span class="ident" id="6007778">bootstrapType</span><span class="op" id="6007791">(</span><span class="string" id="6007792">&#34;_reserved1&#34;</span><span class="op" id="6007804">,</span>&nbsp;<span class="op" id="6007806">(</span><span class="op" id="6007807">*</span><span class="keyword" id="6007808">struct</span><span class="op" id="6007814">{</span>&nbsp;<span class="ident" id="6007816">r5</span>&nbsp;<span class="builtintype" id="6007819">int</span>&nbsp;<span class="op" id="6007823">}</span><span class="op" id="6007824">)</span><span class="op" id="6007825">(</span><span class="ident" id="6007826">nil</span><span class="op" id="6007829">)</span><span class="op" id="6007830">,</span>&nbsp;<span class="num" id="6007832">11</span><span class="op" id="6007834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007837">tReserved4</span>&nbsp;<span class="op" id="6007848">=</span>&nbsp;<span class="ident" id="6007850">bootstrapType</span><span class="op" id="6007863">(</span><span class="string" id="6007864">&#34;_reserved1&#34;</span><span class="op" id="6007876">,</span>&nbsp;<span class="op" id="6007878">(</span><span class="op" id="6007879">*</span><span class="keyword" id="6007880">struct</span><span class="op" id="6007886">{</span>&nbsp;<span class="ident" id="6007888">r4</span>&nbsp;<span class="builtintype" id="6007891">int</span>&nbsp;<span class="op" id="6007895">}</span><span class="op" id="6007896">)</span><span class="op" id="6007897">(</span><span class="ident" id="6007898">nil</span><span class="op" id="6007901">)</span><span class="op" id="6007902">,</span>&nbsp;<span class="num" id="6007904">12</span><span class="op" id="6007906">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007909">tReserved3</span>&nbsp;<span class="op" id="6007920">=</span>&nbsp;<span class="ident" id="6007922">bootstrapType</span><span class="op" id="6007935">(</span><span class="string" id="6007936">&#34;_reserved1&#34;</span><span class="op" id="6007948">,</span>&nbsp;<span class="op" id="6007950">(</span><span class="op" id="6007951">*</span><span class="keyword" id="6007952">struct</span><span class="op" id="6007958">{</span>&nbsp;<span class="ident" id="6007960">r3</span>&nbsp;<span class="builtintype" id="6007963">int</span>&nbsp;<span class="op" id="6007967">}</span><span class="op" id="6007968">)</span><span class="op" id="6007969">(</span><span class="ident" id="6007970">nil</span><span class="op" id="6007973">)</span><span class="op" id="6007974">,</span>&nbsp;<span class="num" id="6007976">13</span><span class="op" id="6007978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6007981">tReserved2</span>&nbsp;<span class="op" id="6007992">=</span>&nbsp;<span class="ident" id="6007994">bootstrapType</span><span class="op" id="6008007">(</span><span class="string" id="6008008">&#34;_reserved1&#34;</span><span class="op" id="6008020">,</span>&nbsp;<span class="op" id="6008022">(</span><span class="op" id="6008023">*</span><span class="keyword" id="6008024">struct</span><span class="op" id="6008030">{</span>&nbsp;<span class="ident" id="6008032">r2</span>&nbsp;<span class="builtintype" id="6008035">int</span>&nbsp;<span class="op" id="6008039">}</span><span class="op" id="6008040">)</span><span class="op" id="6008041">(</span><span class="ident" id="6008042">nil</span><span class="op" id="6008045">)</span><span class="op" id="6008046">,</span>&nbsp;<span class="num" id="6008048">14</span><span class="op" id="6008050">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008053">tReserved1</span>&nbsp;<span class="op" id="6008064">=</span>&nbsp;<span class="ident" id="6008066">bootstrapType</span><span class="op" id="6008079">(</span><span class="string" id="6008080">&#34;_reserved1&#34;</span><span class="op" id="6008092">,</span>&nbsp;<span class="op" id="6008094">(</span><span class="op" id="6008095">*</span><span class="keyword" id="6008096">struct</span><span class="op" id="6008102">{</span>&nbsp;<span class="ident" id="6008104">r1</span>&nbsp;<span class="builtintype" id="6008107">int</span>&nbsp;<span class="op" id="6008111">}</span><span class="op" id="6008112">)</span><span class="op" id="6008113">(</span><span class="ident" id="6008114">nil</span><span class="op" id="6008117">)</span><span class="op" id="6008118">,</span>&nbsp;<span class="num" id="6008120">15</span><span class="op" id="6008122">)</span><br>
<span class="lineno"></span><span class="op" id="6008124">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6008127">//&nbsp;Predefined&nbsp;because&nbsp;it&#39;s&nbsp;needed&nbsp;by&nbsp;the&nbsp;Decoder</span><br>
<span class="lineno"></span><span class="keyword" id="6008176">var</span>&nbsp;<span class="ident" id="6008180">tWireType</span>&nbsp;<span class="op" id="6008190">=</span>&nbsp;<span class="ident" id="6008192">mustGetTypeInfo</span><span class="op" id="6008207">(</span><span class="ident" id="6008208">reflect</span><span class="op" id="6008215">.</span><span class="ident" id="6008216">TypeOf</span><span class="op" id="6008222">(</span><span class="ident" id="6008223">wireType</span><span class="op" id="6008231">{</span><span class="op" id="6008232">}</span><span class="op" id="6008233">)</span><span class="op" id="6008234">)</span><span class="op" id="6008235">.</span><span class="ident" id="6008236">id</span><br>
<span class="lineno">270</span><span class="keyword" id="6008239">var</span>&nbsp;<span class="ident" id="6008243">wireTypeUserInfo</span>&nbsp;<span class="op" id="6008260">*</span><span class="ident" id="6008261">userTypeInfo</span>&nbsp;<span class="comment" id="6008274">//&nbsp;userTypeInfo&nbsp;of&nbsp;(*wireType)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6008306">func</span>&nbsp;<span class="ident" id="6008311">init</span><span class="op" id="6008315">(</span><span class="op" id="6008316">)</span>&nbsp;<span class="op" id="6008318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6008321">//&nbsp;Some&nbsp;magic&nbsp;numbers&nbsp;to&nbsp;make&nbsp;sure&nbsp;there&nbsp;are&nbsp;no&nbsp;surprises.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008381">checkId</span><span class="op" id="6008388">(</span><span class="num" id="6008389">16</span><span class="op" id="6008391">,</span>&nbsp;<span class="ident" id="6008393">tWireType</span><span class="op" id="6008402">)</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008405">checkId</span><span class="op" id="6008412">(</span><span class="num" id="6008413">17</span><span class="op" id="6008415">,</span>&nbsp;<span class="ident" id="6008417">mustGetTypeInfo</span><span class="op" id="6008432">(</span><span class="ident" id="6008433">reflect</span><span class="op" id="6008440">.</span><span class="ident" id="6008441">TypeOf</span><span class="op" id="6008447">(</span><span class="ident" id="6008448">arrayType</span><span class="op" id="6008457">{</span><span class="op" id="6008458">}</span><span class="op" id="6008459">)</span><span class="op" id="6008460">)</span><span class="op" id="6008461">.</span><span class="ident" id="6008462">id</span><span class="op" id="6008464">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008467">checkId</span><span class="op" id="6008474">(</span><span class="num" id="6008475">18</span><span class="op" id="6008477">,</span>&nbsp;<span class="ident" id="6008479">mustGetTypeInfo</span><span class="op" id="6008494">(</span><span class="ident" id="6008495">reflect</span><span class="op" id="6008502">.</span><span class="ident" id="6008503">TypeOf</span><span class="op" id="6008509">(</span><span class="ident" id="6008510">CommonType</span><span class="op" id="6008520">{</span><span class="op" id="6008521">}</span><span class="op" id="6008522">)</span><span class="op" id="6008523">)</span><span class="op" id="6008524">.</span><span class="ident" id="6008525">id</span><span class="op" id="6008527">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008530">checkId</span><span class="op" id="6008537">(</span><span class="num" id="6008538">19</span><span class="op" id="6008540">,</span>&nbsp;<span class="ident" id="6008542">mustGetTypeInfo</span><span class="op" id="6008557">(</span><span class="ident" id="6008558">reflect</span><span class="op" id="6008565">.</span><span class="ident" id="6008566">TypeOf</span><span class="op" id="6008572">(</span><span class="ident" id="6008573">sliceType</span><span class="op" id="6008582">{</span><span class="op" id="6008583">}</span><span class="op" id="6008584">)</span><span class="op" id="6008585">)</span><span class="op" id="6008586">.</span><span class="ident" id="6008587">id</span><span class="op" id="6008589">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008592">checkId</span><span class="op" id="6008599">(</span><span class="num" id="6008600">20</span><span class="op" id="6008602">,</span>&nbsp;<span class="ident" id="6008604">mustGetTypeInfo</span><span class="op" id="6008619">(</span><span class="ident" id="6008620">reflect</span><span class="op" id="6008627">.</span><span class="ident" id="6008628">TypeOf</span><span class="op" id="6008634">(</span><span class="ident" id="6008635">structType</span><span class="op" id="6008645">{</span><span class="op" id="6008646">}</span><span class="op" id="6008647">)</span><span class="op" id="6008648">)</span><span class="op" id="6008649">.</span><span class="ident" id="6008650">id</span><span class="op" id="6008652">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008655">checkId</span><span class="op" id="6008662">(</span><span class="num" id="6008663">21</span><span class="op" id="6008665">,</span>&nbsp;<span class="ident" id="6008667">mustGetTypeInfo</span><span class="op" id="6008682">(</span><span class="ident" id="6008683">reflect</span><span class="op" id="6008690">.</span><span class="ident" id="6008691">TypeOf</span><span class="op" id="6008697">(</span><span class="ident" id="6008698">fieldType</span><span class="op" id="6008707">{</span><span class="op" id="6008708">}</span><span class="op" id="6008709">)</span><span class="op" id="6008710">)</span><span class="op" id="6008711">.</span><span class="ident" id="6008712">id</span><span class="op" id="6008714">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008717">checkId</span><span class="op" id="6008724">(</span><span class="num" id="6008725">23</span><span class="op" id="6008727">,</span>&nbsp;<span class="ident" id="6008729">mustGetTypeInfo</span><span class="op" id="6008744">(</span><span class="ident" id="6008745">reflect</span><span class="op" id="6008752">.</span><span class="ident" id="6008753">TypeOf</span><span class="op" id="6008759">(</span><span class="ident" id="6008760">mapType</span><span class="op" id="6008767">{</span><span class="op" id="6008768">}</span><span class="op" id="6008769">)</span><span class="op" id="6008770">)</span><span class="op" id="6008771">.</span><span class="ident" id="6008772">id</span><span class="op" id="6008774">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008778">builtinIdToType</span>&nbsp;<span class="op" id="6008794">=</span>&nbsp;<span class="builtinfunc" id="6008796">make</span><span class="op" id="6008800">(</span><span class="keyword" id="6008801">map</span><span class="op" id="6008804">[</span><span class="ident" id="6008805">typeId</span><span class="op" id="6008811">]</span><span class="ident" id="6008812">gobType</span><span class="op" id="6008819">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6008822">for</span>&nbsp;<span class="ident" id="6008826">k</span><span class="op" id="6008827">,</span>&nbsp;<span class="ident" id="6008829">v</span>&nbsp;<span class="op" id="6008831">:=</span>&nbsp;<span class="keyword" id="6008834">range</span>&nbsp;<span class="ident" id="6008840">idToType</span>&nbsp;<span class="op" id="6008849">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6008853">builtinIdToType</span><span class="op" id="6008868">[</span><span class="ident" id="6008869">k</span><span class="op" id="6008870">]</span>&nbsp;<span class="op" id="6008872">=</span>&nbsp;<span class="ident" id="6008874">v</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6008877">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6008881">//&nbsp;Move&nbsp;the&nbsp;id&nbsp;space&nbsp;upwards&nbsp;to&nbsp;allow&nbsp;for&nbsp;growth&nbsp;in&nbsp;the&nbsp;predefined&nbsp;world</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6008955">//&nbsp;without&nbsp;breaking&nbsp;existing&nbsp;files.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6008992">if</span>&nbsp;<span class="ident" id="6008995">nextId</span>&nbsp;<span class="op" id="6009002">&gt;</span>&nbsp;<span class="ident" id="6009004">firstUserId</span>&nbsp;<span class="op" id="6009016">{</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6009020">panic</span><span class="op" id="6009025">(</span><span class="ident" id="6009026">fmt</span><span class="op" id="6009029">.</span><span class="ident" id="6009030">Sprintln</span><span class="op" id="6009038">(</span><span class="string" id="6009039">&#34;nextId&nbsp;too&nbsp;large:&#34;</span><span class="op" id="6009058">,</span>&nbsp;<span class="ident" id="6009060">nextId</span><span class="op" id="6009066">)</span><span class="op" id="6009067">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6009070">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009073">nextId</span>&nbsp;<span class="op" id="6009080">=</span>&nbsp;<span class="ident" id="6009082">firstUserId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009095">registerBasics</span><span class="op" id="6009109">(</span><span class="op" id="6009110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009113">wireTypeUserInfo</span>&nbsp;<span class="op" id="6009130">=</span>&nbsp;<span class="ident" id="6009132">userType</span><span class="op" id="6009140">(</span><span class="ident" id="6009141">reflect</span><span class="op" id="6009148">.</span><span class="ident" id="6009149">TypeOf</span><span class="op" id="6009155">(</span><span class="op" id="6009156">(</span><span class="op" id="6009157">*</span><span class="ident" id="6009158">wireType</span><span class="op" id="6009166">)</span><span class="op" id="6009167">(</span><span class="ident" id="6009168">nil</span><span class="op" id="6009171">)</span><span class="op" id="6009172">)</span><span class="op" id="6009173">)</span><br>
<span class="lineno">295</span><span class="op" id="6009175">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6009178">//&nbsp;Array&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="6009192">type</span>&nbsp;<span class="ident" id="6009197">arrayType</span>&nbsp;<span class="keyword" id="6009207">struct</span>&nbsp;<span class="op" id="6009214">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009217">CommonType</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009229">Elem</span>&nbsp;<span class="ident" id="6009234">typeId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009242">Len</span>&nbsp;&nbsp;<span class="builtintype" id="6009247">int</span><br>
<span class="lineno"></span><span class="op" id="6009251">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6009254">func</span>&nbsp;<span class="ident" id="6009259">newArrayType</span><span class="op" id="6009271">(</span><span class="ident" id="6009272">name</span>&nbsp;<span class="builtintype" id="6009277">string</span><span class="op" id="6009283">)</span>&nbsp;<span class="op" id="6009285">*</span><span class="ident" id="6009286">arrayType</span>&nbsp;<span class="op" id="6009296">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009299">a</span>&nbsp;<span class="op" id="6009301">:=</span>&nbsp;<span class="op" id="6009304">&amp;</span><span class="ident" id="6009305">arrayType</span><span class="op" id="6009314">{</span><span class="ident" id="6009315">CommonType</span><span class="op" id="6009325">{</span><span class="ident" id="6009326">Name</span><span class="op" id="6009330">:</span>&nbsp;<span class="ident" id="6009332">name</span><span class="op" id="6009336">}</span><span class="op" id="6009337">,</span>&nbsp;<span class="num" id="6009339">0</span><span class="op" id="6009340">,</span>&nbsp;<span class="num" id="6009342">0</span><span class="op" id="6009343">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6009346">return</span>&nbsp;<span class="ident" id="6009353">a</span><br>
<span class="lineno"></span><span class="op" id="6009355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6009358">func</span>&nbsp;<span class="op" id="6009363">(</span><span class="ident" id="6009364">a</span>&nbsp;<span class="op" id="6009366">*</span><span class="ident" id="6009367">arrayType</span><span class="op" id="6009376">)</span>&nbsp;<span class="ident" id="6009378">init</span><span class="op" id="6009382">(</span><span class="ident" id="6009383">elem</span>&nbsp;<span class="ident" id="6009388">gobType</span><span class="op" id="6009395">,</span>&nbsp;<span class="builtinfunc" id="6009397">len</span>&nbsp;<span class="builtintype" id="6009401">int</span><span class="op" id="6009404">)</span>&nbsp;<span class="op" id="6009406">{</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6009409">//&nbsp;Set&nbsp;our&nbsp;type&nbsp;id&nbsp;before&nbsp;evaluating&nbsp;the&nbsp;element&#39;s,&nbsp;in&nbsp;case&nbsp;it&#39;s&nbsp;our&nbsp;own.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009484">setTypeId</span><span class="op" id="6009493">(</span><span class="ident" id="6009494">a</span><span class="op" id="6009495">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009498">a</span><span class="op" id="6009499">.</span><span class="ident" id="6009500">Elem</span>&nbsp;<span class="op" id="6009505">=</span>&nbsp;<span class="ident" id="6009507">elem</span><span class="op" id="6009511">.</span><span class="ident" id="6009512">id</span><span class="op" id="6009514">(</span><span class="op" id="6009515">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009518">a</span><span class="op" id="6009519">.</span><span class="ident" id="6009520">Len</span>&nbsp;<span class="op" id="6009524">=</span>&nbsp;<span class="builtinfunc" id="6009526">len</span><br>
<span class="lineno"></span><span class="op" id="6009530">}</span><br>
<span class="lineno">315</span><br>
<span class="lineno"></span><span class="keyword" id="6009533">func</span>&nbsp;<span class="op" id="6009538">(</span><span class="ident" id="6009539">a</span>&nbsp;<span class="op" id="6009541">*</span><span class="ident" id="6009542">arrayType</span><span class="op" id="6009551">)</span>&nbsp;<span class="ident" id="6009553">safeString</span><span class="op" id="6009563">(</span><span class="ident" id="6009564">seen</span>&nbsp;<span class="keyword" id="6009569">map</span><span class="op" id="6009572">[</span><span class="ident" id="6009573">typeId</span><span class="op" id="6009579">]</span><span class="builtintype" id="6009580">bool</span><span class="op" id="6009584">)</span>&nbsp;<span class="builtintype" id="6009586">string</span>&nbsp;<span class="op" id="6009593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6009596">if</span>&nbsp;<span class="ident" id="6009599">seen</span><span class="op" id="6009603">[</span><span class="ident" id="6009604">a</span><span class="op" id="6009605">.</span><span class="ident" id="6009606">Id</span><span class="op" id="6009608">]</span>&nbsp;<span class="op" id="6009610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6009614">return</span>&nbsp;<span class="ident" id="6009621">a</span><span class="op" id="6009622">.</span><span class="ident" id="6009623">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6009629">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009632">seen</span><span class="op" id="6009636">[</span><span class="ident" id="6009637">a</span><span class="op" id="6009638">.</span><span class="ident" id="6009639">Id</span><span class="op" id="6009641">]</span>&nbsp;<span class="op" id="6009643">=</span>&nbsp;<span class="builtintype" id="6009645">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6009651">return</span>&nbsp;<span class="ident" id="6009658">fmt</span><span class="op" id="6009661">.</span><span class="ident" id="6009662">Sprintf</span><span class="op" id="6009669">(</span><span class="string" id="6009670">&#34;[%d]%s&#34;</span><span class="op" id="6009678">,</span>&nbsp;<span class="ident" id="6009680">a</span><span class="op" id="6009681">.</span><span class="ident" id="6009682">Len</span><span class="op" id="6009685">,</span>&nbsp;<span class="ident" id="6009687">a</span><span class="op" id="6009688">.</span><span class="ident" id="6009689">Elem</span><span class="op" id="6009693">.</span><span class="ident" id="6009694">gobType</span><span class="op" id="6009701">(</span><span class="op" id="6009702">)</span><span class="op" id="6009703">.</span><span class="ident" id="6009704">safeString</span><span class="op" id="6009714">(</span><span class="ident" id="6009715">seen</span><span class="op" id="6009719">)</span><span class="op" id="6009720">)</span><br>
<span class="lineno"></span><span class="op" id="6009722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6009725">func</span>&nbsp;<span class="op" id="6009730">(</span><span class="ident" id="6009731">a</span>&nbsp;<span class="op" id="6009733">*</span><span class="ident" id="6009734">arrayType</span><span class="op" id="6009743">)</span>&nbsp;<span class="builtintype" id="6009745">string</span><span class="op" id="6009751">(</span><span class="op" id="6009752">)</span>&nbsp;<span class="builtintype" id="6009754">string</span>&nbsp;<span class="op" id="6009761">{</span>&nbsp;<span class="keyword" id="6009763">return</span>&nbsp;<span class="ident" id="6009770">a</span><span class="op" id="6009771">.</span><span class="ident" id="6009772">safeString</span><span class="op" id="6009782">(</span><span class="builtinfunc" id="6009783">make</span><span class="op" id="6009787">(</span><span class="keyword" id="6009788">map</span><span class="op" id="6009791">[</span><span class="ident" id="6009792">typeId</span><span class="op" id="6009798">]</span><span class="builtintype" id="6009799">bool</span><span class="op" id="6009803">)</span><span class="op" id="6009804">)</span>&nbsp;<span class="op" id="6009806">}</span><br>
<span class="lineno">325</span><br>
<span class="lineno"></span><span class="comment" id="6009809">//&nbsp;GobEncoder&nbsp;type&nbsp;(something&nbsp;that&nbsp;implements&nbsp;the&nbsp;GobEncoder&nbsp;interface)</span><br>
<span class="lineno"></span><span class="keyword" id="6009881">type</span>&nbsp;<span class="ident" id="6009886">gobEncoderType</span>&nbsp;<span class="keyword" id="6009901">struct</span>&nbsp;<span class="op" id="6009908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009911">CommonType</span><br>
<span class="lineno"></span><span class="op" id="6009922">}</span><br>
<span class="lineno">330</span><br>
<span class="lineno"></span><span class="keyword" id="6009925">func</span>&nbsp;<span class="ident" id="6009930">newGobEncoderType</span><span class="op" id="6009947">(</span><span class="ident" id="6009948">name</span>&nbsp;<span class="builtintype" id="6009953">string</span><span class="op" id="6009959">)</span>&nbsp;<span class="op" id="6009961">*</span><span class="ident" id="6009962">gobEncoderType</span>&nbsp;<span class="op" id="6009977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6009980">g</span>&nbsp;<span class="op" id="6009982">:=</span>&nbsp;<span class="op" id="6009985">&amp;</span><span class="ident" id="6009986">gobEncoderType</span><span class="op" id="6010000">{</span><span class="ident" id="6010001">CommonType</span><span class="op" id="6010011">{</span><span class="ident" id="6010012">Name</span><span class="op" id="6010016">:</span>&nbsp;<span class="ident" id="6010018">name</span><span class="op" id="6010022">}</span><span class="op" id="6010023">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010026">setTypeId</span><span class="op" id="6010035">(</span><span class="ident" id="6010036">g</span><span class="op" id="6010037">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6010040">return</span>&nbsp;<span class="ident" id="6010047">g</span><br>
<span class="lineno">335</span><span class="op" id="6010049">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6010052">func</span>&nbsp;<span class="op" id="6010057">(</span><span class="ident" id="6010058">g</span>&nbsp;<span class="op" id="6010060">*</span><span class="ident" id="6010061">gobEncoderType</span><span class="op" id="6010075">)</span>&nbsp;<span class="ident" id="6010077">safeString</span><span class="op" id="6010087">(</span><span class="ident" id="6010088">seen</span>&nbsp;<span class="keyword" id="6010093">map</span><span class="op" id="6010096">[</span><span class="ident" id="6010097">typeId</span><span class="op" id="6010103">]</span><span class="builtintype" id="6010104">bool</span><span class="op" id="6010108">)</span>&nbsp;<span class="builtintype" id="6010110">string</span>&nbsp;<span class="op" id="6010117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6010120">return</span>&nbsp;<span class="ident" id="6010127">g</span><span class="op" id="6010128">.</span><span class="ident" id="6010129">Name</span><br>
<span class="lineno"></span><span class="op" id="6010134">}</span><br>
<span class="lineno">340</span><br>
<span class="lineno"></span><span class="keyword" id="6010137">func</span>&nbsp;<span class="op" id="6010142">(</span><span class="ident" id="6010143">g</span>&nbsp;<span class="op" id="6010145">*</span><span class="ident" id="6010146">gobEncoderType</span><span class="op" id="6010160">)</span>&nbsp;<span class="builtintype" id="6010162">string</span><span class="op" id="6010168">(</span><span class="op" id="6010169">)</span>&nbsp;<span class="builtintype" id="6010171">string</span>&nbsp;<span class="op" id="6010178">{</span>&nbsp;<span class="keyword" id="6010180">return</span>&nbsp;<span class="ident" id="6010187">g</span><span class="op" id="6010188">.</span><span class="ident" id="6010189">Name</span>&nbsp;<span class="op" id="6010194">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6010197">//&nbsp;Map&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="6010209">type</span>&nbsp;<span class="ident" id="6010214">mapType</span>&nbsp;<span class="keyword" id="6010222">struct</span>&nbsp;<span class="op" id="6010229">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010232">CommonType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010244">Key</span>&nbsp;&nbsp;<span class="ident" id="6010249">typeId</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010257">Elem</span>&nbsp;<span class="ident" id="6010262">typeId</span><br>
<span class="lineno"></span><span class="op" id="6010269">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">350</span><span class="keyword" id="6010272">func</span>&nbsp;<span class="ident" id="6010277">newMapType</span><span class="op" id="6010287">(</span><span class="ident" id="6010288">name</span>&nbsp;<span class="builtintype" id="6010293">string</span><span class="op" id="6010299">)</span>&nbsp;<span class="op" id="6010301">*</span><span class="ident" id="6010302">mapType</span>&nbsp;<span class="op" id="6010310">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010313">m</span>&nbsp;<span class="op" id="6010315">:=</span>&nbsp;<span class="op" id="6010318">&amp;</span><span class="ident" id="6010319">mapType</span><span class="op" id="6010326">{</span><span class="ident" id="6010327">CommonType</span><span class="op" id="6010337">{</span><span class="ident" id="6010338">Name</span><span class="op" id="6010342">:</span>&nbsp;<span class="ident" id="6010344">name</span><span class="op" id="6010348">}</span><span class="op" id="6010349">,</span>&nbsp;<span class="num" id="6010351">0</span><span class="op" id="6010352">,</span>&nbsp;<span class="num" id="6010354">0</span><span class="op" id="6010355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6010358">return</span>&nbsp;<span class="ident" id="6010365">m</span><br>
<span class="lineno"></span><span class="op" id="6010367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="keyword" id="6010370">func</span>&nbsp;<span class="op" id="6010375">(</span><span class="ident" id="6010376">m</span>&nbsp;<span class="op" id="6010378">*</span><span class="ident" id="6010379">mapType</span><span class="op" id="6010386">)</span>&nbsp;<span class="ident" id="6010388">init</span><span class="op" id="6010392">(</span><span class="ident" id="6010393">key</span><span class="op" id="6010396">,</span>&nbsp;<span class="ident" id="6010398">elem</span>&nbsp;<span class="ident" id="6010403">gobType</span><span class="op" id="6010410">)</span>&nbsp;<span class="op" id="6010412">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6010415">//&nbsp;Set&nbsp;our&nbsp;type&nbsp;id&nbsp;before&nbsp;evaluating&nbsp;the&nbsp;element&#39;s,&nbsp;in&nbsp;case&nbsp;it&#39;s&nbsp;our&nbsp;own.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010490">setTypeId</span><span class="op" id="6010499">(</span><span class="ident" id="6010500">m</span><span class="op" id="6010501">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010504">m</span><span class="op" id="6010505">.</span><span class="ident" id="6010506">Key</span>&nbsp;<span class="op" id="6010510">=</span>&nbsp;<span class="ident" id="6010512">key</span><span class="op" id="6010515">.</span><span class="ident" id="6010516">id</span><span class="op" id="6010518">(</span><span class="op" id="6010519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010522">m</span><span class="op" id="6010523">.</span><span class="ident" id="6010524">Elem</span>&nbsp;<span class="op" id="6010529">=</span>&nbsp;<span class="ident" id="6010531">elem</span><span class="op" id="6010535">.</span><span class="ident" id="6010536">id</span><span class="op" id="6010538">(</span><span class="op" id="6010539">)</span><br>
<span class="lineno">360</span><span class="op" id="6010541">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6010544">func</span>&nbsp;<span class="op" id="6010549">(</span><span class="ident" id="6010550">m</span>&nbsp;<span class="op" id="6010552">*</span><span class="ident" id="6010553">mapType</span><span class="op" id="6010560">)</span>&nbsp;<span class="ident" id="6010562">safeString</span><span class="op" id="6010572">(</span><span class="ident" id="6010573">seen</span>&nbsp;<span class="keyword" id="6010578">map</span><span class="op" id="6010581">[</span><span class="ident" id="6010582">typeId</span><span class="op" id="6010588">]</span><span class="builtintype" id="6010589">bool</span><span class="op" id="6010593">)</span>&nbsp;<span class="builtintype" id="6010595">string</span>&nbsp;<span class="op" id="6010602">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6010605">if</span>&nbsp;<span class="ident" id="6010608">seen</span><span class="op" id="6010612">[</span><span class="ident" id="6010613">m</span><span class="op" id="6010614">.</span><span class="ident" id="6010615">Id</span><span class="op" id="6010617">]</span>&nbsp;<span class="op" id="6010619">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6010623">return</span>&nbsp;<span class="ident" id="6010630">m</span><span class="op" id="6010631">.</span><span class="ident" id="6010632">Name</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6010638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010641">seen</span><span class="op" id="6010645">[</span><span class="ident" id="6010646">m</span><span class="op" id="6010647">.</span><span class="ident" id="6010648">Id</span><span class="op" id="6010650">]</span>&nbsp;<span class="op" id="6010652">=</span>&nbsp;<span class="builtintype" id="6010654">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010660">key</span>&nbsp;<span class="op" id="6010664">:=</span>&nbsp;<span class="ident" id="6010667">m</span><span class="op" id="6010668">.</span><span class="ident" id="6010669">Key</span><span class="op" id="6010672">.</span><span class="ident" id="6010673">gobType</span><span class="op" id="6010680">(</span><span class="op" id="6010681">)</span><span class="op" id="6010682">.</span><span class="ident" id="6010683">safeString</span><span class="op" id="6010693">(</span><span class="ident" id="6010694">seen</span><span class="op" id="6010698">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010701">elem</span>&nbsp;<span class="op" id="6010706">:=</span>&nbsp;<span class="ident" id="6010709">m</span><span class="op" id="6010710">.</span><span class="ident" id="6010711">Elem</span><span class="op" id="6010715">.</span><span class="ident" id="6010716">gobType</span><span class="op" id="6010723">(</span><span class="op" id="6010724">)</span><span class="op" id="6010725">.</span><span class="ident" id="6010726">safeString</span><span class="op" id="6010736">(</span><span class="ident" id="6010737">seen</span><span class="op" id="6010741">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6010744">return</span>&nbsp;<span class="ident" id="6010751">fmt</span><span class="op" id="6010754">.</span><span class="ident" id="6010755">Sprintf</span><span class="op" id="6010762">(</span><span class="string" id="6010763">&#34;map[%s]%s&#34;</span><span class="op" id="6010774">,</span>&nbsp;<span class="ident" id="6010776">key</span><span class="op" id="6010779">,</span>&nbsp;<span class="ident" id="6010781">elem</span><span class="op" id="6010785">)</span><br>
<span class="lineno">370</span><span class="op" id="6010787">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6010790">func</span>&nbsp;<span class="op" id="6010795">(</span><span class="ident" id="6010796">m</span>&nbsp;<span class="op" id="6010798">*</span><span class="ident" id="6010799">mapType</span><span class="op" id="6010806">)</span>&nbsp;<span class="builtintype" id="6010808">string</span><span class="op" id="6010814">(</span><span class="op" id="6010815">)</span>&nbsp;<span class="builtintype" id="6010817">string</span>&nbsp;<span class="op" id="6010824">{</span>&nbsp;<span class="keyword" id="6010826">return</span>&nbsp;<span class="ident" id="6010833">m</span><span class="op" id="6010834">.</span><span class="ident" id="6010835">safeString</span><span class="op" id="6010845">(</span><span class="builtinfunc" id="6010846">make</span><span class="op" id="6010850">(</span><span class="keyword" id="6010851">map</span><span class="op" id="6010854">[</span><span class="ident" id="6010855">typeId</span><span class="op" id="6010861">]</span><span class="builtintype" id="6010862">bool</span><span class="op" id="6010866">)</span><span class="op" id="6010867">)</span>&nbsp;<span class="op" id="6010869">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6010872">//&nbsp;Slice&nbsp;type</span><br>
<span class="lineno">375</span><span class="keyword" id="6010886">type</span>&nbsp;<span class="ident" id="6010891">sliceType</span>&nbsp;<span class="keyword" id="6010901">struct</span>&nbsp;<span class="op" id="6010908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010911">CommonType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010923">Elem</span>&nbsp;<span class="ident" id="6010928">typeId</span><br>
<span class="lineno"></span><span class="op" id="6010935">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">380</span><span class="keyword" id="6010938">func</span>&nbsp;<span class="ident" id="6010943">newSliceType</span><span class="op" id="6010955">(</span><span class="ident" id="6010956">name</span>&nbsp;<span class="builtintype" id="6010961">string</span><span class="op" id="6010967">)</span>&nbsp;<span class="op" id="6010969">*</span><span class="ident" id="6010970">sliceType</span>&nbsp;<span class="op" id="6010980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6010983">s</span>&nbsp;<span class="op" id="6010985">:=</span>&nbsp;<span class="op" id="6010988">&amp;</span><span class="ident" id="6010989">sliceType</span><span class="op" id="6010998">{</span><span class="ident" id="6010999">CommonType</span><span class="op" id="6011009">{</span><span class="ident" id="6011010">Name</span><span class="op" id="6011014">:</span>&nbsp;<span class="ident" id="6011016">name</span><span class="op" id="6011020">}</span><span class="op" id="6011021">,</span>&nbsp;<span class="num" id="6011023">0</span><span class="op" id="6011024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6011027">return</span>&nbsp;<span class="ident" id="6011034">s</span><br>
<span class="lineno"></span><span class="op" id="6011036">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">385</span><span class="keyword" id="6011039">func</span>&nbsp;<span class="op" id="6011044">(</span><span class="ident" id="6011045">s</span>&nbsp;<span class="op" id="6011047">*</span><span class="ident" id="6011048">sliceType</span><span class="op" id="6011057">)</span>&nbsp;<span class="ident" id="6011059">init</span><span class="op" id="6011063">(</span><span class="ident" id="6011064">elem</span>&nbsp;<span class="ident" id="6011069">gobType</span><span class="op" id="6011076">)</span>&nbsp;<span class="op" id="6011078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6011081">//&nbsp;Set&nbsp;our&nbsp;type&nbsp;id&nbsp;before&nbsp;evaluating&nbsp;the&nbsp;element&#39;s,&nbsp;in&nbsp;case&nbsp;it&#39;s&nbsp;our&nbsp;own.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6011156">setTypeId</span><span class="op" id="6011165">(</span><span class="ident" id="6011166">s</span><span class="op" id="6011167">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6011170">//&nbsp;See&nbsp;the&nbsp;comments&nbsp;about&nbsp;ids&nbsp;in&nbsp;newTypeObject.&nbsp;Only&nbsp;slices&nbsp;and</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6011235">//&nbsp;structs&nbsp;have&nbsp;mutual&nbsp;recursion.</span><br>
<span class="lineno">390</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6011270">if</span>&nbsp;<span class="ident" id="6011273">elem</span><span class="op" id="6011277">.</span><span class="ident" id="6011278">id</span><span class="op" id="6011280">(</span><span class="op" id="6011281">)</span>&nbsp;<span class="op" id="6011283">==</span>&nbsp;<span class="num" id="6011286">0</span>&nbsp;<span class="op" id="6011288">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6011292">setTypeId</span><span class="op" id="6011301">(</span><span class="ident" id="6011302">elem</span><span class="op" id="6011306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6011309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6011312">s</span><span class="op" id="6011313">.</span><span class="ident" id="6011314">Elem</span>&nbsp;<span class="op" id="6011319">=</span>&nbsp;<span class="ident" id="6011321">elem</span><span class="op" id="6011325">.</span><span class="ident" id="6011326">id</span><span class="op" id="6011328">(</span><span class="op" id="6011329">)</span><br>
<span class="lineno"></span><span class="op" id="6011331">}</span><br>
<span class="lineno">395</span><br>
<span class="lineno"></span><span class="keyword" id="6011334">func</span>&nbsp;<span class="op" id="6011339">(</span><span class="ident" id="6011340">s</span>&nbsp;<span class="op" id="6011342">*</span><span class="ident" id="6011343">sliceType</span><span class="op" id="6011352">)</span>&nbsp;<span class="ident" id="6011354">safeString</span><span class="op" id="6011364">(</span><span class="ident" id="6011365">seen</span>&nbsp;<span class="keyword" id="6011370">map</span><span class="op" id="6011373">[</span><span class="ident" id="6011374">typeId</span><span class="op" id="6011380">]</span><span class="builtintype" id="6011381">bool</span><span class="op" id="6011385">)</span>&nbsp;<span class="builtintype" id="6011387">string</span>&nbsp;<span class="op" id="6011394">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6011397">if</span>&nbsp;<span class="ident" id="6011400">seen</span><span class="op" id="6011404">[</span><span class="ident" id="6011405">s</span><span class="op" id="6011406">.</span><span class="ident" id="6011407">Id</span><span class="op" id="6011409">]</span>&nbsp;<span class="op" id="6011411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6011415">return</span>&nbsp;<span class="ident" id="6011422">s</span><span class="op" id="6011423">.</span><span class="ident" id="6011424">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6011430">}</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6011433">seen</span><span class="op" id="6011437">[</span><span class="ident" id="6011438">s</span><span class="op" id="6011439">.</span><span class="ident" id="6011440">Id</span><span class="op" id="6011442">]</span>&nbsp;<span class="op" id="6011444">=</span>&nbsp;<span class="builtintype" id="6011446">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6011452">return</span>&nbsp;<span class="ident" id="6011459">fmt</span><span class="op" id="6011462">.</span><span class="ident" id="6011463">Sprintf</span><span class="op" id="6011470">(</span><span class="string" id="6011471">&#34;[]%s&#34;</span><span class="op" id="6011477">,</span>&nbsp;<span class="ident" id="6011479">s</span><span class="op" id="6011480">.</span><span class="ident" id="6011481">Elem</span><span class="op" id="6011485">.</span><span class="ident" id="6011486">gobType</span><span class="op" id="6011493">(</span><span class="op" id="6011494">)</span><span class="op" id="6011495">.</span><span class="ident" id="6011496">safeString</span><span class="op" id="6011506">(</span><span class="ident" id="6011507">seen</span><span class="op" id="6011511">)</span><span class="op" id="6011512">)</span><br>
<span class="lineno"></span><span class="op" id="6011514">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6011517">func</span>&nbsp;<span class="op" id="6011522">(</span><span class="ident" id="6011523">s</span>&nbsp;<span class="op" id="6011525">*</span><span class="ident" id="6011526">sliceType</span><span class="op" id="6011535">)</span>&nbsp;<span class="builtintype" id="6011537">string</span><span class="op" id="6011543">(</span><span class="op" id="6011544">)</span>&nbsp;<span class="builtintype" id="6011546">string</span>&nbsp;<span class="op" id="6011553">{</span>&nbsp;<span class="keyword" id="6011555">return</span>&nbsp;<span class="ident" id="6011562">s</span><span class="op" id="6011563">.</span><span class="ident" id="6011564">safeString</span><span class="op" id="6011574">(</span><span class="builtinfunc" id="6011575">make</span><span class="op" id="6011579">(</span><span class="keyword" id="6011580">map</span><span class="op" id="6011583">[</span><span class="ident" id="6011584">typeId</span><span class="op" id="6011590">]</span><span class="builtintype" id="6011591">bool</span><span class="op" id="6011595">)</span><span class="op" id="6011596">)</span>&nbsp;<span class="op" id="6011598">}</span><br>
<span class="lineno">405</span><br>
<span class="lineno"></span><span class="comment" id="6011601">//&nbsp;Struct&nbsp;type</span><br>
<span class="lineno"></span><span class="keyword" id="6011616">type</span>&nbsp;<span class="ident" id="6011621">fieldType</span>&nbsp;<span class="keyword" id="6011631">struct</span>&nbsp;<span class="op" id="6011638">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6011641">Name</span>&nbsp;<span class="builtintype" id="6011646">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6011654">Id</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="6011659">typeId</span><br>
<span class="lineno">410</span><span class="op" id="6011666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6011669">type</span>&nbsp;<span class="ident" id="6011674">structType</span>&nbsp;<span class="keyword" id="6011685">struct</span>&nbsp;<span class="op" id="6011692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6011695">CommonType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6011707">Field</span>&nbsp;<span class="op" id="6011713">[</span><span class="op" id="6011714">]</span><span class="op" id="6011715">*</span><span class="ident" id="6011716">fieldType</span><br>
<span class="lineno">415</span><span class="op" id="6011726">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6011729">func</span>&nbsp;<span class="op" id="6011734">(</span><span class="ident" id="6011735">s</span>&nbsp;<span class="op" id="6011737">*</span><span class="ident" id="6011738">structType</span><span class="op" id="6011748">)</span>&nbsp;<span class="ident" id="6011750">safeString</span><span class="op" id="6011760">(</span><span class="ident" id="6011761">seen</span>&nbsp;<span class="keyword" id="6011766">map</span><span class="op" id="6011769">[</span><span class="ident" id="6011770">typeId</span><span class="op" id="6011776">]</span><span class="builtintype" id="6011777">bool</span><span class="op" id="6011781">)</span>&nbsp;<span class="builtintype" id="6011783">string</span>&nbsp;<span class="op" id="6011790">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6011793">if</span>&nbsp;<span class="ident" id="6011796">s</span>&nbsp;<span class="op" id="6011798">==</span>&nbsp;<span class="ident" id="6011801">nil</span>&nbsp;<span class="op" id="6011805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6011809">return</span>&nbsp;<span class="string" id="6011816">&#34;&lt;nil&gt;&#34;</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6011825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6011828">if</span>&nbsp;<span class="ident" id="6011831">_</span><span class="op" id="6011832">,</span>&nbsp;<span class="ident" id="6011834">ok</span>&nbsp;<span class="op" id="6011837">:=</span>&nbsp;<span class="ident" id="6011840">seen</span><span class="op" id="6011844">[</span><span class="ident" id="6011845">s</span><span class="op" id="6011846">.</span><span class="ident" id="6011847">Id</span><span class="op" id="6011849">]</span><span class="op" id="6011850">;</span>&nbsp;<span class="ident" id="6011852">ok</span>&nbsp;<span class="op" id="6011855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6011859">return</span>&nbsp;<span class="ident" id="6011866">s</span><span class="op" id="6011867">.</span><span class="ident" id="6011868">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6011874">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6011877">seen</span><span class="op" id="6011881">[</span><span class="ident" id="6011882">s</span><span class="op" id="6011883">.</span><span class="ident" id="6011884">Id</span><span class="op" id="6011886">]</span>&nbsp;<span class="op" id="6011888">=</span>&nbsp;<span class="builtintype" id="6011890">true</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6011896">str</span>&nbsp;<span class="op" id="6011900">:=</span>&nbsp;<span class="ident" id="6011903">s</span><span class="op" id="6011904">.</span><span class="ident" id="6011905">Name</span>&nbsp;<span class="op" id="6011910">+</span>&nbsp;<span class="string" id="6011912">&#34;&nbsp;=&nbsp;struct&nbsp;{&nbsp;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6011928">for</span>&nbsp;<span class="ident" id="6011932">_</span><span class="op" id="6011933">,</span>&nbsp;<span class="ident" id="6011935">f</span>&nbsp;<span class="op" id="6011937">:=</span>&nbsp;<span class="keyword" id="6011940">range</span>&nbsp;<span class="ident" id="6011946">s</span><span class="op" id="6011947">.</span><span class="ident" id="6011948">Field</span>&nbsp;<span class="op" id="6011954">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6011958">str</span>&nbsp;<span class="op" id="6011962">+=</span>&nbsp;<span class="ident" id="6011965">fmt</span><span class="op" id="6011968">.</span><span class="ident" id="6011969">Sprintf</span><span class="op" id="6011976">(</span><span class="string" id="6011977">&#34;%s&nbsp;%s;&nbsp;&#34;</span><span class="op" id="6011986">,</span>&nbsp;<span class="ident" id="6011988">f</span><span class="op" id="6011989">.</span><span class="ident" id="6011990">Name</span><span class="op" id="6011994">,</span>&nbsp;<span class="ident" id="6011996">f</span><span class="op" id="6011997">.</span><span class="ident" id="6011998">Id</span><span class="op" id="6012000">.</span><span class="ident" id="6012001">gobType</span><span class="op" id="6012008">(</span><span class="op" id="6012009">)</span><span class="op" id="6012010">.</span><span class="ident" id="6012011">safeString</span><span class="op" id="6012021">(</span><span class="ident" id="6012022">seen</span><span class="op" id="6012026">)</span><span class="op" id="6012027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6012030">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6012033">str</span>&nbsp;<span class="op" id="6012037">+=</span>&nbsp;<span class="string" id="6012040">&#34;}&#34;</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6012045">return</span>&nbsp;<span class="ident" id="6012052">str</span><br>
<span class="lineno"></span><span class="op" id="6012056">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6012059">func</span>&nbsp;<span class="op" id="6012064">(</span><span class="ident" id="6012065">s</span>&nbsp;<span class="op" id="6012067">*</span><span class="ident" id="6012068">structType</span><span class="op" id="6012078">)</span>&nbsp;<span class="builtintype" id="6012080">string</span><span class="op" id="6012086">(</span><span class="op" id="6012087">)</span>&nbsp;<span class="builtintype" id="6012089">string</span>&nbsp;<span class="op" id="6012096">{</span>&nbsp;<span class="keyword" id="6012098">return</span>&nbsp;<span class="ident" id="6012105">s</span><span class="op" id="6012106">.</span><span class="ident" id="6012107">safeString</span><span class="op" id="6012117">(</span><span class="builtinfunc" id="6012118">make</span><span class="op" id="6012122">(</span><span class="keyword" id="6012123">map</span><span class="op" id="6012126">[</span><span class="ident" id="6012127">typeId</span><span class="op" id="6012133">]</span><span class="builtintype" id="6012134">bool</span><span class="op" id="6012138">)</span><span class="op" id="6012139">)</span>&nbsp;<span class="op" id="6012141">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">435</span><span class="keyword" id="6012144">func</span>&nbsp;<span class="ident" id="6012149">newStructType</span><span class="op" id="6012162">(</span><span class="ident" id="6012163">name</span>&nbsp;<span class="builtintype" id="6012168">string</span><span class="op" id="6012174">)</span>&nbsp;<span class="op" id="6012176">*</span><span class="ident" id="6012177">structType</span>&nbsp;<span class="op" id="6012188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6012191">s</span>&nbsp;<span class="op" id="6012193">:=</span>&nbsp;<span class="op" id="6012196">&amp;</span><span class="ident" id="6012197">structType</span><span class="op" id="6012207">{</span><span class="ident" id="6012208">CommonType</span><span class="op" id="6012218">{</span><span class="ident" id="6012219">Name</span><span class="op" id="6012223">:</span>&nbsp;<span class="ident" id="6012225">name</span><span class="op" id="6012229">}</span><span class="op" id="6012230">,</span>&nbsp;<span class="ident" id="6012232">nil</span><span class="op" id="6012235">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6012238">//&nbsp;For&nbsp;historical&nbsp;reasons&nbsp;we&nbsp;set&nbsp;the&nbsp;id&nbsp;here&nbsp;rather&nbsp;than&nbsp;init.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6012302">//&nbsp;See&nbsp;the&nbsp;comment&nbsp;in&nbsp;newTypeObject&nbsp;for&nbsp;details.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6012352">setTypeId</span><span class="op" id="6012361">(</span><span class="ident" id="6012362">s</span><span class="op" id="6012363">)</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6012366">return</span>&nbsp;<span class="ident" id="6012373">s</span><br>
<span class="lineno"></span><span class="op" id="6012375">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6012378">//&nbsp;newTypeObject&nbsp;allocates&nbsp;a&nbsp;gobType&nbsp;for&nbsp;the&nbsp;reflection&nbsp;type&nbsp;rt.</span><br>
<span class="lineno"></span><span class="comment" id="6012443">//&nbsp;Unless&nbsp;ut&nbsp;represents&nbsp;a&nbsp;GobEncoder,&nbsp;rt&nbsp;should&nbsp;be&nbsp;the&nbsp;base&nbsp;type</span><br>
<span class="lineno">445</span><span class="comment" id="6012508">//&nbsp;of&nbsp;ut.</span><br>
<span class="lineno"></span><span class="comment" id="6012518">//&nbsp;This&nbsp;is&nbsp;only&nbsp;called&nbsp;from&nbsp;the&nbsp;encoding&nbsp;side.&nbsp;The&nbsp;decoding&nbsp;side</span><br>
<span class="lineno"></span><span class="comment" id="6012583">//&nbsp;works&nbsp;through&nbsp;typeIds&nbsp;and&nbsp;userTypeInfos&nbsp;alone.</span><br>
<span class="lineno"></span><span class="keyword" id="6012633">func</span>&nbsp;<span class="ident" id="6012638">newTypeObject</span><span class="op" id="6012651">(</span><span class="ident" id="6012652">name</span>&nbsp;<span class="builtintype" id="6012657">string</span><span class="op" id="6012663">,</span>&nbsp;<span class="ident" id="6012665">ut</span>&nbsp;<span class="op" id="6012668">*</span><span class="ident" id="6012669">userTypeInfo</span><span class="op" id="6012681">,</span>&nbsp;<span class="ident" id="6012683">rt</span>&nbsp;<span class="ident" id="6012686">reflect</span><span class="op" id="6012693">.</span><span class="ident" id="6012694">Type</span><span class="op" id="6012698">)</span>&nbsp;<span class="op" id="6012700">(</span><span class="ident" id="6012701">gobType</span><span class="op" id="6012708">,</span>&nbsp;<span class="builtintype" id="6012710">error</span><span class="op" id="6012715">)</span>&nbsp;<span class="op" id="6012717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6012720">//&nbsp;Does&nbsp;this&nbsp;type&nbsp;implement&nbsp;GobEncoder?</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6012761">if</span>&nbsp;<span class="ident" id="6012764">ut</span><span class="op" id="6012766">.</span><span class="ident" id="6012767">externalEnc</span>&nbsp;<span class="op" id="6012779">!=</span>&nbsp;<span class="num" id="6012782">0</span>&nbsp;<span class="op" id="6012784">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6012788">return</span>&nbsp;<span class="ident" id="6012795">newGobEncoderType</span><span class="op" id="6012812">(</span><span class="ident" id="6012813">name</span><span class="op" id="6012817">)</span><span class="op" id="6012818">,</span>&nbsp;<span class="ident" id="6012820">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6012825">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6012828">var</span>&nbsp;<span class="ident" id="6012832">err</span>&nbsp;<span class="builtintype" id="6012836">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6012843">var</span>&nbsp;<span class="ident" id="6012847">type0</span><span class="op" id="6012852">,</span>&nbsp;<span class="ident" id="6012854">type1</span>&nbsp;<span class="ident" id="6012860">gobType</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6012869">defer</span>&nbsp;<span class="keyword" id="6012875">func</span><span class="op" id="6012879">(</span><span class="op" id="6012880">)</span>&nbsp;<span class="op" id="6012882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6012886">if</span>&nbsp;<span class="ident" id="6012889">err</span>&nbsp;<span class="op" id="6012893">!=</span>&nbsp;<span class="ident" id="6012896">nil</span>&nbsp;<span class="op" id="6012900">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6012905">delete</span><span class="op" id="6012911">(</span><span class="ident" id="6012912">types</span><span class="op" id="6012917">,</span>&nbsp;<span class="ident" id="6012919">rt</span><span class="op" id="6012921">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6012925">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6012928">}</span><span class="op" id="6012929">(</span><span class="op" id="6012930">)</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6012933">//&nbsp;Install&nbsp;the&nbsp;top-level&nbsp;type&nbsp;before&nbsp;the&nbsp;subtypes&nbsp;(e.g.&nbsp;struct&nbsp;before</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6013004">//&nbsp;fields)&nbsp;so&nbsp;recursive&nbsp;types&nbsp;can&nbsp;be&nbsp;constructed&nbsp;safely.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013062">switch</span>&nbsp;<span class="ident" id="6013069">t</span>&nbsp;<span class="op" id="6013071">:=</span>&nbsp;<span class="ident" id="6013074">rt</span><span class="op" id="6013076">;</span>&nbsp;<span class="ident" id="6013078">t</span><span class="op" id="6013079">.</span><span class="ident" id="6013080">Kind</span><span class="op" id="6013084">(</span><span class="op" id="6013085">)</span>&nbsp;<span class="op" id="6013087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6013090">//&nbsp;All&nbsp;basic&nbsp;types&nbsp;are&nbsp;easy:&nbsp;they&nbsp;are&nbsp;predefined.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013141">case</span>&nbsp;<span class="ident" id="6013146">reflect</span><span class="op" id="6013153">.</span><span class="ident" id="6013154">Bool</span><span class="op" id="6013158">:</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013162">return</span>&nbsp;<span class="ident" id="6013169">tBool</span><span class="op" id="6013174">.</span><span class="ident" id="6013175">gobType</span><span class="op" id="6013182">(</span><span class="op" id="6013183">)</span><span class="op" id="6013184">,</span>&nbsp;<span class="ident" id="6013186">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013192">case</span>&nbsp;<span class="ident" id="6013197">reflect</span><span class="op" id="6013204">.</span><span class="ident" id="6013205">Int</span><span class="op" id="6013208">,</span>&nbsp;<span class="ident" id="6013210">reflect</span><span class="op" id="6013217">.</span><span class="ident" id="6013218">Int8</span><span class="op" id="6013222">,</span>&nbsp;<span class="ident" id="6013224">reflect</span><span class="op" id="6013231">.</span><span class="ident" id="6013232">Int16</span><span class="op" id="6013237">,</span>&nbsp;<span class="ident" id="6013239">reflect</span><span class="op" id="6013246">.</span><span class="ident" id="6013247">Int32</span><span class="op" id="6013252">,</span>&nbsp;<span class="ident" id="6013254">reflect</span><span class="op" id="6013261">.</span><span class="ident" id="6013262">Int64</span><span class="op" id="6013267">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013271">return</span>&nbsp;<span class="ident" id="6013278">tInt</span><span class="op" id="6013282">.</span><span class="ident" id="6013283">gobType</span><span class="op" id="6013290">(</span><span class="op" id="6013291">)</span><span class="op" id="6013292">,</span>&nbsp;<span class="ident" id="6013294">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013300">case</span>&nbsp;<span class="ident" id="6013305">reflect</span><span class="op" id="6013312">.</span><span class="ident" id="6013313">Uint</span><span class="op" id="6013317">,</span>&nbsp;<span class="ident" id="6013319">reflect</span><span class="op" id="6013326">.</span><span class="ident" id="6013327">Uint8</span><span class="op" id="6013332">,</span>&nbsp;<span class="ident" id="6013334">reflect</span><span class="op" id="6013341">.</span><span class="ident" id="6013342">Uint16</span><span class="op" id="6013348">,</span>&nbsp;<span class="ident" id="6013350">reflect</span><span class="op" id="6013357">.</span><span class="ident" id="6013358">Uint32</span><span class="op" id="6013364">,</span>&nbsp;<span class="ident" id="6013366">reflect</span><span class="op" id="6013373">.</span><span class="ident" id="6013374">Uint64</span><span class="op" id="6013380">,</span>&nbsp;<span class="ident" id="6013382">reflect</span><span class="op" id="6013389">.</span><span class="ident" id="6013390">Uintptr</span><span class="op" id="6013397">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013401">return</span>&nbsp;<span class="ident" id="6013408">tUint</span><span class="op" id="6013413">.</span><span class="ident" id="6013414">gobType</span><span class="op" id="6013421">(</span><span class="op" id="6013422">)</span><span class="op" id="6013423">,</span>&nbsp;<span class="ident" id="6013425">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013431">case</span>&nbsp;<span class="ident" id="6013436">reflect</span><span class="op" id="6013443">.</span><span class="ident" id="6013444">Float32</span><span class="op" id="6013451">,</span>&nbsp;<span class="ident" id="6013453">reflect</span><span class="op" id="6013460">.</span><span class="ident" id="6013461">Float64</span><span class="op" id="6013468">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013472">return</span>&nbsp;<span class="ident" id="6013479">tFloat</span><span class="op" id="6013485">.</span><span class="ident" id="6013486">gobType</span><span class="op" id="6013493">(</span><span class="op" id="6013494">)</span><span class="op" id="6013495">,</span>&nbsp;<span class="ident" id="6013497">nil</span><br>
<span class="lineno">475</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013503">case</span>&nbsp;<span class="ident" id="6013508">reflect</span><span class="op" id="6013515">.</span><span class="ident" id="6013516">Complex64</span><span class="op" id="6013525">,</span>&nbsp;<span class="ident" id="6013527">reflect</span><span class="op" id="6013534">.</span><span class="ident" id="6013535">Complex128</span><span class="op" id="6013545">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013549">return</span>&nbsp;<span class="ident" id="6013556">tComplex</span><span class="op" id="6013564">.</span><span class="ident" id="6013565">gobType</span><span class="op" id="6013572">(</span><span class="op" id="6013573">)</span><span class="op" id="6013574">,</span>&nbsp;<span class="ident" id="6013576">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013582">case</span>&nbsp;<span class="ident" id="6013587">reflect</span><span class="op" id="6013594">.</span><span class="ident" id="6013595">String</span><span class="op" id="6013601">:</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013605">return</span>&nbsp;<span class="ident" id="6013612">tString</span><span class="op" id="6013619">.</span><span class="ident" id="6013620">gobType</span><span class="op" id="6013627">(</span><span class="op" id="6013628">)</span><span class="op" id="6013629">,</span>&nbsp;<span class="ident" id="6013631">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013637">case</span>&nbsp;<span class="ident" id="6013642">reflect</span><span class="op" id="6013649">.</span><span class="ident" id="6013650">Interface</span><span class="op" id="6013659">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013663">return</span>&nbsp;<span class="ident" id="6013670">tInterface</span><span class="op" id="6013680">.</span><span class="ident" id="6013681">gobType</span><span class="op" id="6013688">(</span><span class="op" id="6013689">)</span><span class="op" id="6013690">,</span>&nbsp;<span class="ident" id="6013692">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013698">case</span>&nbsp;<span class="ident" id="6013703">reflect</span><span class="op" id="6013710">.</span><span class="ident" id="6013711">Array</span><span class="op" id="6013716">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013720">at</span>&nbsp;<span class="op" id="6013723">:=</span>&nbsp;<span class="ident" id="6013726">newArrayType</span><span class="op" id="6013738">(</span><span class="ident" id="6013739">name</span><span class="op" id="6013743">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013747">types</span><span class="op" id="6013752">[</span><span class="ident" id="6013753">rt</span><span class="op" id="6013755">]</span>&nbsp;<span class="op" id="6013757">=</span>&nbsp;<span class="ident" id="6013759">at</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6013764">type0</span><span class="op" id="6013769">,</span>&nbsp;<span class="ident" id="6013771">err</span>&nbsp;<span class="op" id="6013775">=</span>&nbsp;<span class="ident" id="6013777">getBaseType</span><span class="op" id="6013788">(</span><span class="string" id="6013789">&#34;&#34;</span><span class="op" id="6013791">,</span>&nbsp;<span class="ident" id="6013793">t</span><span class="op" id="6013794">.</span><span class="ident" id="6013795">Elem</span><span class="op" id="6013799">(</span><span class="op" id="6013800">)</span><span class="op" id="6013801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013805">if</span>&nbsp;<span class="ident" id="6013808">err</span>&nbsp;<span class="op" id="6013812">!=</span>&nbsp;<span class="ident" id="6013815">nil</span>&nbsp;<span class="op" id="6013819">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6013824">return</span>&nbsp;<span class="ident" id="6013831">nil</span><span class="op" id="6013834">,</span>&nbsp;<span class="ident" id="6013836">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6013842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6013846">//&nbsp;Historical&nbsp;aside:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6013869">//&nbsp;For&nbsp;arrays,&nbsp;maps,&nbsp;and&nbsp;slices,&nbsp;we&nbsp;set&nbsp;the&nbsp;type&nbsp;id&nbsp;after&nbsp;the&nbsp;elements</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6013942">//&nbsp;are&nbsp;constructed.&nbsp;This&nbsp;is&nbsp;to&nbsp;retain&nbsp;the&nbsp;order&nbsp;of&nbsp;type&nbsp;id&nbsp;allocation&nbsp;after</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6014020">//&nbsp;a&nbsp;fix&nbsp;made&nbsp;to&nbsp;handle&nbsp;recursive&nbsp;types,&nbsp;which&nbsp;changed&nbsp;the&nbsp;order&nbsp;in</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6014090">//&nbsp;which&nbsp;types&nbsp;are&nbsp;built.&nbsp;&nbsp;Delaying&nbsp;the&nbsp;setting&nbsp;in&nbsp;this&nbsp;way&nbsp;preserves</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6014162">//&nbsp;type&nbsp;ids&nbsp;while&nbsp;allowing&nbsp;recursive&nbsp;types&nbsp;to&nbsp;be&nbsp;described.&nbsp;Structs,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6014233">//&nbsp;done&nbsp;below,&nbsp;were&nbsp;already&nbsp;handling&nbsp;recursion&nbsp;correctly&nbsp;so&nbsp;they</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6014300">//&nbsp;assign&nbsp;the&nbsp;top-level&nbsp;id&nbsp;before&nbsp;those&nbsp;of&nbsp;the&nbsp;field.</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014356">at</span><span class="op" id="6014358">.</span><span class="ident" id="6014359">init</span><span class="op" id="6014363">(</span><span class="ident" id="6014364">type0</span><span class="op" id="6014369">,</span>&nbsp;<span class="ident" id="6014371">t</span><span class="op" id="6014372">.</span><span class="ident" id="6014373">Len</span><span class="op" id="6014376">(</span><span class="op" id="6014377">)</span><span class="op" id="6014378">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014382">return</span>&nbsp;<span class="ident" id="6014389">at</span><span class="op" id="6014391">,</span>&nbsp;<span class="ident" id="6014393">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014399">case</span>&nbsp;<span class="ident" id="6014404">reflect</span><span class="op" id="6014411">.</span><span class="ident" id="6014412">Map</span><span class="op" id="6014415">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014419">mt</span>&nbsp;<span class="op" id="6014422">:=</span>&nbsp;<span class="ident" id="6014425">newMapType</span><span class="op" id="6014435">(</span><span class="ident" id="6014436">name</span><span class="op" id="6014440">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014444">types</span><span class="op" id="6014449">[</span><span class="ident" id="6014450">rt</span><span class="op" id="6014452">]</span>&nbsp;<span class="op" id="6014454">=</span>&nbsp;<span class="ident" id="6014456">mt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014461">type0</span><span class="op" id="6014466">,</span>&nbsp;<span class="ident" id="6014468">err</span>&nbsp;<span class="op" id="6014472">=</span>&nbsp;<span class="ident" id="6014474">getBaseType</span><span class="op" id="6014485">(</span><span class="string" id="6014486">&#34;&#34;</span><span class="op" id="6014488">,</span>&nbsp;<span class="ident" id="6014490">t</span><span class="op" id="6014491">.</span><span class="ident" id="6014492">Key</span><span class="op" id="6014495">(</span><span class="op" id="6014496">)</span><span class="op" id="6014497">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014501">if</span>&nbsp;<span class="ident" id="6014504">err</span>&nbsp;<span class="op" id="6014508">!=</span>&nbsp;<span class="ident" id="6014511">nil</span>&nbsp;<span class="op" id="6014515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014520">return</span>&nbsp;<span class="ident" id="6014527">nil</span><span class="op" id="6014530">,</span>&nbsp;<span class="ident" id="6014532">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6014538">}</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014542">type1</span><span class="op" id="6014547">,</span>&nbsp;<span class="ident" id="6014549">err</span>&nbsp;<span class="op" id="6014553">=</span>&nbsp;<span class="ident" id="6014555">getBaseType</span><span class="op" id="6014566">(</span><span class="string" id="6014567">&#34;&#34;</span><span class="op" id="6014569">,</span>&nbsp;<span class="ident" id="6014571">t</span><span class="op" id="6014572">.</span><span class="ident" id="6014573">Elem</span><span class="op" id="6014577">(</span><span class="op" id="6014578">)</span><span class="op" id="6014579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014583">if</span>&nbsp;<span class="ident" id="6014586">err</span>&nbsp;<span class="op" id="6014590">!=</span>&nbsp;<span class="ident" id="6014593">nil</span>&nbsp;<span class="op" id="6014597">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014602">return</span>&nbsp;<span class="ident" id="6014609">nil</span><span class="op" id="6014612">,</span>&nbsp;<span class="ident" id="6014614">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6014620">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014624">mt</span><span class="op" id="6014626">.</span><span class="ident" id="6014627">init</span><span class="op" id="6014631">(</span><span class="ident" id="6014632">type0</span><span class="op" id="6014637">,</span>&nbsp;<span class="ident" id="6014639">type1</span><span class="op" id="6014644">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014648">return</span>&nbsp;<span class="ident" id="6014655">mt</span><span class="op" id="6014657">,</span>&nbsp;<span class="ident" id="6014659">nil</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014665">case</span>&nbsp;<span class="ident" id="6014670">reflect</span><span class="op" id="6014677">.</span><span class="ident" id="6014678">Slice</span><span class="op" id="6014683">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6014687">//&nbsp;[]byte&nbsp;==&nbsp;[]uint8&nbsp;is&nbsp;a&nbsp;special&nbsp;case</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014728">if</span>&nbsp;<span class="ident" id="6014731">t</span><span class="op" id="6014732">.</span><span class="ident" id="6014733">Elem</span><span class="op" id="6014737">(</span><span class="op" id="6014738">)</span><span class="op" id="6014739">.</span><span class="ident" id="6014740">Kind</span><span class="op" id="6014744">(</span><span class="op" id="6014745">)</span>&nbsp;<span class="op" id="6014747">==</span>&nbsp;<span class="ident" id="6014750">reflect</span><span class="op" id="6014757">.</span><span class="ident" id="6014758">Uint8</span>&nbsp;<span class="op" id="6014764">{</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014769">return</span>&nbsp;<span class="ident" id="6014776">tBytes</span><span class="op" id="6014782">.</span><span class="ident" id="6014783">gobType</span><span class="op" id="6014790">(</span><span class="op" id="6014791">)</span><span class="op" id="6014792">,</span>&nbsp;<span class="ident" id="6014794">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6014800">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014804">st</span>&nbsp;<span class="op" id="6014807">:=</span>&nbsp;<span class="ident" id="6014810">newSliceType</span><span class="op" id="6014822">(</span><span class="ident" id="6014823">name</span><span class="op" id="6014827">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014831">types</span><span class="op" id="6014836">[</span><span class="ident" id="6014837">rt</span><span class="op" id="6014839">]</span>&nbsp;<span class="op" id="6014841">=</span>&nbsp;<span class="ident" id="6014843">st</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014848">type0</span><span class="op" id="6014853">,</span>&nbsp;<span class="ident" id="6014855">err</span>&nbsp;<span class="op" id="6014859">=</span>&nbsp;<span class="ident" id="6014861">getBaseType</span><span class="op" id="6014872">(</span><span class="ident" id="6014873">t</span><span class="op" id="6014874">.</span><span class="ident" id="6014875">Elem</span><span class="op" id="6014879">(</span><span class="op" id="6014880">)</span><span class="op" id="6014881">.</span><span class="ident" id="6014882">Name</span><span class="op" id="6014886">(</span><span class="op" id="6014887">)</span><span class="op" id="6014888">,</span>&nbsp;<span class="ident" id="6014890">t</span><span class="op" id="6014891">.</span><span class="ident" id="6014892">Elem</span><span class="op" id="6014896">(</span><span class="op" id="6014897">)</span><span class="op" id="6014898">)</span><br>
<span class="lineno">525</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014902">if</span>&nbsp;<span class="ident" id="6014905">err</span>&nbsp;<span class="op" id="6014909">!=</span>&nbsp;<span class="ident" id="6014912">nil</span>&nbsp;<span class="op" id="6014916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014921">return</span>&nbsp;<span class="ident" id="6014928">nil</span><span class="op" id="6014931">,</span>&nbsp;<span class="ident" id="6014933">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6014939">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6014943">st</span><span class="op" id="6014945">.</span><span class="ident" id="6014946">init</span><span class="op" id="6014950">(</span><span class="ident" id="6014951">type0</span><span class="op" id="6014956">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014960">return</span>&nbsp;<span class="ident" id="6014967">st</span><span class="op" id="6014969">,</span>&nbsp;<span class="ident" id="6014971">nil</span><br>
<span class="lineno">530</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6014977">case</span>&nbsp;<span class="ident" id="6014982">reflect</span><span class="op" id="6014989">.</span><span class="ident" id="6014990">Struct</span><span class="op" id="6014996">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015000">st</span>&nbsp;<span class="op" id="6015003">:=</span>&nbsp;<span class="ident" id="6015006">newStructType</span><span class="op" id="6015019">(</span><span class="ident" id="6015020">name</span><span class="op" id="6015024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015028">types</span><span class="op" id="6015033">[</span><span class="ident" id="6015034">rt</span><span class="op" id="6015036">]</span>&nbsp;<span class="op" id="6015038">=</span>&nbsp;<span class="ident" id="6015040">st</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015045">idToType</span><span class="op" id="6015053">[</span><span class="ident" id="6015054">st</span><span class="op" id="6015056">.</span><span class="ident" id="6015057">id</span><span class="op" id="6015059">(</span><span class="op" id="6015060">)</span><span class="op" id="6015061">]</span>&nbsp;<span class="op" id="6015063">=</span>&nbsp;<span class="ident" id="6015065">st</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015070">for</span>&nbsp;<span class="ident" id="6015074">i</span>&nbsp;<span class="op" id="6015076">:=</span>&nbsp;<span class="num" id="6015079">0</span><span class="op" id="6015080">;</span>&nbsp;<span class="ident" id="6015082">i</span>&nbsp;<span class="op" id="6015084">&lt;</span>&nbsp;<span class="ident" id="6015086">t</span><span class="op" id="6015087">.</span><span class="ident" id="6015088">NumField</span><span class="op" id="6015096">(</span><span class="op" id="6015097">)</span><span class="op" id="6015098">;</span>&nbsp;<span class="ident" id="6015100">i</span><span class="op" id="6015101">++</span>&nbsp;<span class="op" id="6015104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015109">f</span>&nbsp;<span class="op" id="6015111">:=</span>&nbsp;<span class="ident" id="6015114">t</span><span class="op" id="6015115">.</span><span class="ident" id="6015116">Field</span><span class="op" id="6015121">(</span><span class="ident" id="6015122">i</span><span class="op" id="6015123">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015128">if</span>&nbsp;<span class="op" id="6015131">!</span><span class="ident" id="6015132">isSent</span><span class="op" id="6015138">(</span><span class="op" id="6015139">&amp;</span><span class="ident" id="6015140">f</span><span class="op" id="6015141">)</span>&nbsp;<span class="op" id="6015143">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015149">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6015161">}</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015166">typ</span>&nbsp;<span class="op" id="6015170">:=</span>&nbsp;<span class="ident" id="6015173">userType</span><span class="op" id="6015181">(</span><span class="ident" id="6015182">f</span><span class="op" id="6015183">.</span><span class="ident" id="6015184">Type</span><span class="op" id="6015188">)</span><span class="op" id="6015189">.</span><span class="ident" id="6015190">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015198">tname</span>&nbsp;<span class="op" id="6015204">:=</span>&nbsp;<span class="ident" id="6015207">typ</span><span class="op" id="6015210">.</span><span class="ident" id="6015211">Name</span><span class="op" id="6015215">(</span><span class="op" id="6015216">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015221">if</span>&nbsp;<span class="ident" id="6015224">tname</span>&nbsp;<span class="op" id="6015230">==</span>&nbsp;<span class="string" id="6015233">&#34;&#34;</span>&nbsp;<span class="op" id="6015236">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015242">t</span>&nbsp;<span class="op" id="6015244">:=</span>&nbsp;<span class="ident" id="6015247">userType</span><span class="op" id="6015255">(</span><span class="ident" id="6015256">f</span><span class="op" id="6015257">.</span><span class="ident" id="6015258">Type</span><span class="op" id="6015262">)</span><span class="op" id="6015263">.</span><span class="ident" id="6015264">base</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015273">tname</span>&nbsp;<span class="op" id="6015279">=</span>&nbsp;<span class="ident" id="6015281">t</span><span class="op" id="6015282">.</span><span class="ident" id="6015283">String</span><span class="op" id="6015289">(</span><span class="op" id="6015290">)</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6015295">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015300">gt</span><span class="op" id="6015302">,</span>&nbsp;<span class="ident" id="6015304">err</span>&nbsp;<span class="op" id="6015308">:=</span>&nbsp;<span class="ident" id="6015311">getBaseType</span><span class="op" id="6015322">(</span><span class="ident" id="6015323">tname</span><span class="op" id="6015328">,</span>&nbsp;<span class="ident" id="6015330">f</span><span class="op" id="6015331">.</span><span class="ident" id="6015332">Type</span><span class="op" id="6015336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015341">if</span>&nbsp;<span class="ident" id="6015344">err</span>&nbsp;<span class="op" id="6015348">!=</span>&nbsp;<span class="ident" id="6015351">nil</span>&nbsp;<span class="op" id="6015355">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015361">return</span>&nbsp;<span class="ident" id="6015368">nil</span><span class="op" id="6015371">,</span>&nbsp;<span class="ident" id="6015373">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6015380">}</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6015385">//&nbsp;Some&nbsp;mutually&nbsp;recursive&nbsp;types&nbsp;can&nbsp;cause&nbsp;us&nbsp;to&nbsp;be&nbsp;here&nbsp;while</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6015451">//&nbsp;still&nbsp;defining&nbsp;the&nbsp;element.&nbsp;Fix&nbsp;the&nbsp;element&nbsp;type&nbsp;id&nbsp;here.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6015515">//&nbsp;We&nbsp;could&nbsp;do&nbsp;this&nbsp;more&nbsp;neatly&nbsp;by&nbsp;setting&nbsp;the&nbsp;id&nbsp;at&nbsp;the&nbsp;start&nbsp;of</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6015584">//&nbsp;building&nbsp;every&nbsp;type,&nbsp;but&nbsp;that&nbsp;would&nbsp;break&nbsp;binary&nbsp;compatibility.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015654">if</span>&nbsp;<span class="ident" id="6015657">gt</span><span class="op" id="6015659">.</span><span class="ident" id="6015660">id</span><span class="op" id="6015662">(</span><span class="op" id="6015663">)</span>&nbsp;<span class="op" id="6015665">==</span>&nbsp;<span class="num" id="6015668">0</span>&nbsp;<span class="op" id="6015670">{</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015676">setTypeId</span><span class="op" id="6015685">(</span><span class="ident" id="6015686">gt</span><span class="op" id="6015688">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6015693">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6015698">st</span><span class="op" id="6015700">.</span><span class="ident" id="6015701">Field</span>&nbsp;<span class="op" id="6015707">=</span>&nbsp;<span class="builtinfunc" id="6015709">append</span><span class="op" id="6015715">(</span><span class="ident" id="6015716">st</span><span class="op" id="6015718">.</span><span class="ident" id="6015719">Field</span><span class="op" id="6015724">,</span>&nbsp;<span class="op" id="6015726">&amp;</span><span class="ident" id="6015727">fieldType</span><span class="op" id="6015736">{</span><span class="ident" id="6015737">f</span><span class="op" id="6015738">.</span><span class="ident" id="6015739">Name</span><span class="op" id="6015743">,</span>&nbsp;<span class="ident" id="6015745">gt</span><span class="op" id="6015747">.</span><span class="ident" id="6015748">id</span><span class="op" id="6015750">(</span><span class="op" id="6015751">)</span><span class="op" id="6015752">}</span><span class="op" id="6015753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6015757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015761">return</span>&nbsp;<span class="ident" id="6015768">st</span><span class="op" id="6015770">,</span>&nbsp;<span class="ident" id="6015772">nil</span><br>
<span class="lineno">560</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015778">default</span><span class="op" id="6015785">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6015789">return</span>&nbsp;<span class="ident" id="6015796">nil</span><span class="op" id="6015799">,</span>&nbsp;<span class="ident" id="6015801">errors</span><span class="op" id="6015807">.</span><span class="ident" id="6015808">New</span><span class="op" id="6015811">(</span><span class="string" id="6015812">&#34;gob&nbsp;NewTypeObject&nbsp;can&#39;t&nbsp;handle&nbsp;type:&nbsp;&#34;</span>&nbsp;<span class="op" id="6015852">+</span>&nbsp;<span class="ident" id="6015854">rt</span><span class="op" id="6015856">.</span><span class="ident" id="6015857">String</span><span class="op" id="6015863">(</span><span class="op" id="6015864">)</span><span class="op" id="6015865">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6015868">}</span><br>
<span class="lineno"></span><span class="op" id="6015870">}</span><br>
<span class="lineno">565</span><br>
<span class="lineno"></span><span class="comment" id="6015873">//&nbsp;isExported&nbsp;reports&nbsp;whether&nbsp;this&nbsp;is&nbsp;an&nbsp;exported&nbsp;-&nbsp;upper&nbsp;case&nbsp;-&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="6015944">func</span>&nbsp;<span class="ident" id="6015949">isExported</span><span class="op" id="6015959">(</span><span class="ident" id="6015960">name</span>&nbsp;<span class="builtintype" id="6015965">string</span><span class="op" id="6015971">)</span>&nbsp;<span class="builtintype" id="6015973">bool</span>&nbsp;<span class="op" id="6015978">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtintype" id="6015981">rune</span><span class="op" id="6015985">,</span>&nbsp;<span class="ident" id="6015987">_</span>&nbsp;<span class="op" id="6015989">:=</span>&nbsp;<span class="ident" id="6015992">utf8</span><span class="op" id="6015996">.</span><span class="ident" id="6015997">DecodeRuneInString</span><span class="op" id="6016015">(</span><span class="ident" id="6016016">name</span><span class="op" id="6016020">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6016023">return</span>&nbsp;<span class="ident" id="6016030">unicode</span><span class="op" id="6016037">.</span><span class="ident" id="6016038">IsUpper</span><span class="op" id="6016045">(</span><span class="builtintype" id="6016046">rune</span><span class="op" id="6016050">)</span><br>
<span class="lineno">570</span><span class="op" id="6016052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6016055">//&nbsp;isSent&nbsp;reports&nbsp;whether&nbsp;this&nbsp;struct&nbsp;field&nbsp;is&nbsp;to&nbsp;be&nbsp;transmitted.</span><br>
<span class="lineno"></span><span class="comment" id="6016121">//&nbsp;It&nbsp;will&nbsp;be&nbsp;transmitted&nbsp;only&nbsp;if&nbsp;it&nbsp;is&nbsp;exported&nbsp;and&nbsp;not&nbsp;a&nbsp;chan&nbsp;or&nbsp;func&nbsp;field</span><br>
<span class="lineno"></span><span class="comment" id="6016199">//&nbsp;or&nbsp;pointer&nbsp;to&nbsp;chan&nbsp;or&nbsp;func.</span><br>
<span class="lineno">575</span><span class="keyword" id="6016230">func</span>&nbsp;<span class="ident" id="6016235">isSent</span><span class="op" id="6016241">(</span><span class="ident" id="6016242">field</span>&nbsp;<span class="op" id="6016248">*</span><span class="ident" id="6016249">reflect</span><span class="op" id="6016256">.</span><span class="ident" id="6016257">StructField</span><span class="op" id="6016268">)</span>&nbsp;<span class="builtintype" id="6016270">bool</span>&nbsp;<span class="op" id="6016275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6016278">if</span>&nbsp;<span class="op" id="6016281">!</span><span class="ident" id="6016282">isExported</span><span class="op" id="6016292">(</span><span class="ident" id="6016293">field</span><span class="op" id="6016298">.</span><span class="ident" id="6016299">Name</span><span class="op" id="6016303">)</span>&nbsp;<span class="op" id="6016305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6016309">return</span>&nbsp;<span class="builtintype" id="6016316">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6016323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6016326">//&nbsp;If&nbsp;the&nbsp;field&nbsp;is&nbsp;a&nbsp;chan&nbsp;or&nbsp;func&nbsp;or&nbsp;pointer&nbsp;thereto,&nbsp;don&#39;t&nbsp;send&nbsp;it.</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6016396">//&nbsp;That&nbsp;is,&nbsp;treat&nbsp;it&nbsp;like&nbsp;an&nbsp;unexported&nbsp;field.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6016444">typ</span>&nbsp;<span class="op" id="6016448">:=</span>&nbsp;<span class="ident" id="6016451">field</span><span class="op" id="6016456">.</span><span class="ident" id="6016457">Type</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6016463">for</span>&nbsp;<span class="ident" id="6016467">typ</span><span class="op" id="6016470">.</span><span class="ident" id="6016471">Kind</span><span class="op" id="6016475">(</span><span class="op" id="6016476">)</span>&nbsp;<span class="op" id="6016478">==</span>&nbsp;<span class="ident" id="6016481">reflect</span><span class="op" id="6016488">.</span><span class="ident" id="6016489">Ptr</span>&nbsp;<span class="op" id="6016493">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6016497">typ</span>&nbsp;<span class="op" id="6016501">=</span>&nbsp;<span class="ident" id="6016503">typ</span><span class="op" id="6016506">.</span><span class="ident" id="6016507">Elem</span><span class="op" id="6016511">(</span><span class="op" id="6016512">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6016515">}</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6016518">if</span>&nbsp;<span class="ident" id="6016521">typ</span><span class="op" id="6016524">.</span><span class="ident" id="6016525">Kind</span><span class="op" id="6016529">(</span><span class="op" id="6016530">)</span>&nbsp;<span class="op" id="6016532">==</span>&nbsp;<span class="ident" id="6016535">reflect</span><span class="op" id="6016542">.</span><span class="ident" id="6016543">Chan</span>&nbsp;<span class="op" id="6016548">||</span>&nbsp;<span class="ident" id="6016551">typ</span><span class="op" id="6016554">.</span><span class="ident" id="6016555">Kind</span><span class="op" id="6016559">(</span><span class="op" id="6016560">)</span>&nbsp;<span class="op" id="6016562">==</span>&nbsp;<span class="ident" id="6016565">reflect</span><span class="op" id="6016572">.</span><span class="ident" id="6016573">Func</span>&nbsp;<span class="op" id="6016578">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6016582">return</span>&nbsp;<span class="builtintype" id="6016589">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6016596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6016599">return</span>&nbsp;<span class="builtintype" id="6016606">true</span><br>
<span class="lineno"></span><span class="op" id="6016611">}</span><br>
<span class="lineno">590</span><br>
<span class="lineno"></span><span class="comment" id="6016614">//&nbsp;getBaseType&nbsp;returns&nbsp;the&nbsp;Gob&nbsp;type&nbsp;describing&nbsp;the&nbsp;given&nbsp;reflect.Type&#39;s&nbsp;base&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="6016697">//&nbsp;typeLock&nbsp;must&nbsp;be&nbsp;held.</span><br>
<span class="lineno"></span><span class="keyword" id="6016723">func</span>&nbsp;<span class="ident" id="6016728">getBaseType</span><span class="op" id="6016739">(</span><span class="ident" id="6016740">name</span>&nbsp;<span class="builtintype" id="6016745">string</span><span class="op" id="6016751">,</span>&nbsp;<span class="ident" id="6016753">rt</span>&nbsp;<span class="ident" id="6016756">reflect</span><span class="op" id="6016763">.</span><span class="ident" id="6016764">Type</span><span class="op" id="6016768">)</span>&nbsp;<span class="op" id="6016770">(</span><span class="ident" id="6016771">gobType</span><span class="op" id="6016778">,</span>&nbsp;<span class="builtintype" id="6016780">error</span><span class="op" id="6016785">)</span>&nbsp;<span class="op" id="6016787">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6016790">ut</span>&nbsp;<span class="op" id="6016793">:=</span>&nbsp;<span class="ident" id="6016796">userType</span><span class="op" id="6016804">(</span><span class="ident" id="6016805">rt</span><span class="op" id="6016807">)</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6016810">return</span>&nbsp;<span class="ident" id="6016817">getType</span><span class="op" id="6016824">(</span><span class="ident" id="6016825">name</span><span class="op" id="6016829">,</span>&nbsp;<span class="ident" id="6016831">ut</span><span class="op" id="6016833">,</span>&nbsp;<span class="ident" id="6016835">ut</span><span class="op" id="6016837">.</span><span class="ident" id="6016838">base</span><span class="op" id="6016842">)</span><br>
<span class="lineno"></span><span class="op" id="6016844">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6016847">//&nbsp;getType&nbsp;returns&nbsp;the&nbsp;Gob&nbsp;type&nbsp;describing&nbsp;the&nbsp;given&nbsp;reflect.Type.</span><br>
<span class="lineno"></span><span class="comment" id="6016914">//&nbsp;Should&nbsp;be&nbsp;called&nbsp;only&nbsp;when&nbsp;handling&nbsp;GobEncoders/Decoders,</span><br>
<span class="lineno">600</span><span class="comment" id="6016975">//&nbsp;which&nbsp;may&nbsp;be&nbsp;pointers.&nbsp;&nbsp;All&nbsp;other&nbsp;types&nbsp;are&nbsp;handled&nbsp;through&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6017042">//&nbsp;base&nbsp;type,&nbsp;never&nbsp;a&nbsp;pointer.</span><br>
<span class="lineno"></span><span class="comment" id="6017073">//&nbsp;typeLock&nbsp;must&nbsp;be&nbsp;held.</span><br>
<span class="lineno"></span><span class="keyword" id="6017099">func</span>&nbsp;<span class="ident" id="6017104">getType</span><span class="op" id="6017111">(</span><span class="ident" id="6017112">name</span>&nbsp;<span class="builtintype" id="6017117">string</span><span class="op" id="6017123">,</span>&nbsp;<span class="ident" id="6017125">ut</span>&nbsp;<span class="op" id="6017128">*</span><span class="ident" id="6017129">userTypeInfo</span><span class="op" id="6017141">,</span>&nbsp;<span class="ident" id="6017143">rt</span>&nbsp;<span class="ident" id="6017146">reflect</span><span class="op" id="6017153">.</span><span class="ident" id="6017154">Type</span><span class="op" id="6017158">)</span>&nbsp;<span class="op" id="6017160">(</span><span class="ident" id="6017161">gobType</span><span class="op" id="6017168">,</span>&nbsp;<span class="builtintype" id="6017170">error</span><span class="op" id="6017175">)</span>&nbsp;<span class="op" id="6017177">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017180">typ</span><span class="op" id="6017183">,</span>&nbsp;<span class="ident" id="6017185">present</span>&nbsp;<span class="op" id="6017193">:=</span>&nbsp;<span class="ident" id="6017196">types</span><span class="op" id="6017201">[</span><span class="ident" id="6017202">rt</span><span class="op" id="6017204">]</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6017207">if</span>&nbsp;<span class="ident" id="6017210">present</span>&nbsp;<span class="op" id="6017218">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6017222">return</span>&nbsp;<span class="ident" id="6017229">typ</span><span class="op" id="6017232">,</span>&nbsp;<span class="ident" id="6017234">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6017239">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017242">typ</span><span class="op" id="6017245">,</span>&nbsp;<span class="ident" id="6017247">err</span>&nbsp;<span class="op" id="6017251">:=</span>&nbsp;<span class="ident" id="6017254">newTypeObject</span><span class="op" id="6017267">(</span><span class="ident" id="6017268">name</span><span class="op" id="6017272">,</span>&nbsp;<span class="ident" id="6017274">ut</span><span class="op" id="6017276">,</span>&nbsp;<span class="ident" id="6017278">rt</span><span class="op" id="6017280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6017283">if</span>&nbsp;<span class="ident" id="6017286">err</span>&nbsp;<span class="op" id="6017290">==</span>&nbsp;<span class="ident" id="6017293">nil</span>&nbsp;<span class="op" id="6017297">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017301">types</span><span class="op" id="6017306">[</span><span class="ident" id="6017307">rt</span><span class="op" id="6017309">]</span>&nbsp;<span class="op" id="6017311">=</span>&nbsp;<span class="ident" id="6017313">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6017318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6017321">return</span>&nbsp;<span class="ident" id="6017328">typ</span><span class="op" id="6017331">,</span>&nbsp;<span class="ident" id="6017333">err</span><br>
<span class="lineno"></span><span class="op" id="6017337">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">615</span><span class="keyword" id="6017340">func</span>&nbsp;<span class="ident" id="6017345">checkId</span><span class="op" id="6017352">(</span><span class="ident" id="6017353">want</span><span class="op" id="6017357">,</span>&nbsp;<span class="ident" id="6017359">got</span>&nbsp;<span class="ident" id="6017363">typeId</span><span class="op" id="6017369">)</span>&nbsp;<span class="op" id="6017371">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6017374">if</span>&nbsp;<span class="ident" id="6017377">want</span>&nbsp;<span class="op" id="6017382">!=</span>&nbsp;<span class="ident" id="6017385">got</span>&nbsp;<span class="op" id="6017389">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017393">fmt</span><span class="op" id="6017396">.</span><span class="ident" id="6017397">Fprintf</span><span class="op" id="6017404">(</span><span class="ident" id="6017405">os</span><span class="op" id="6017407">.</span><span class="ident" id="6017408">Stderr</span><span class="op" id="6017414">,</span>&nbsp;<span class="string" id="6017416">&#34;checkId:&nbsp;%d&nbsp;should&nbsp;be&nbsp;%d\n&#34;</span><span class="op" id="6017444">,</span>&nbsp;<span class="builtintype" id="6017446">int</span><span class="op" id="6017449">(</span><span class="ident" id="6017450">got</span><span class="op" id="6017453">)</span><span class="op" id="6017454">,</span>&nbsp;<span class="builtintype" id="6017456">int</span><span class="op" id="6017459">(</span><span class="ident" id="6017460">want</span><span class="op" id="6017464">)</span><span class="op" id="6017465">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6017469">panic</span><span class="op" id="6017474">(</span><span class="string" id="6017475">&#34;bootstrap&nbsp;type&nbsp;wrong&nbsp;id:&nbsp;&#34;</span>&nbsp;<span class="op" id="6017503">+</span>&nbsp;<span class="ident" id="6017505">got</span><span class="op" id="6017508">.</span><span class="ident" id="6017509">name</span><span class="op" id="6017513">(</span><span class="op" id="6017514">)</span>&nbsp;<span class="op" id="6017516">+</span>&nbsp;<span class="string" id="6017518">&#34;&nbsp;&#34;</span>&nbsp;<span class="op" id="6017522">+</span>&nbsp;<span class="ident" id="6017524">got</span><span class="op" id="6017527">.</span><span class="builtintype" id="6017528">string</span><span class="op" id="6017534">(</span><span class="op" id="6017535">)</span>&nbsp;<span class="op" id="6017537">+</span>&nbsp;<span class="string" id="6017539">&#34;&nbsp;not&nbsp;&#34;</span>&nbsp;<span class="op" id="6017547">+</span>&nbsp;<span class="ident" id="6017549">want</span><span class="op" id="6017553">.</span><span class="builtintype" id="6017554">string</span><span class="op" id="6017560">(</span><span class="op" id="6017561">)</span><span class="op" id="6017562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6017565">}</span><br>
<span class="lineno">620</span><span class="op" id="6017567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6017570">//&nbsp;used&nbsp;for&nbsp;building&nbsp;the&nbsp;basic&nbsp;types;&nbsp;called&nbsp;only&nbsp;from&nbsp;init().&nbsp;&nbsp;the&nbsp;incoming</span><br>
<span class="lineno"></span><span class="comment" id="6017647">//&nbsp;interface&nbsp;always&nbsp;refers&nbsp;to&nbsp;a&nbsp;pointer.</span><br>
<span class="lineno"></span><span class="keyword" id="6017688">func</span>&nbsp;<span class="ident" id="6017693">bootstrapType</span><span class="op" id="6017706">(</span><span class="ident" id="6017707">name</span>&nbsp;<span class="builtintype" id="6017712">string</span><span class="op" id="6017718">,</span>&nbsp;<span class="ident" id="6017720">e</span>&nbsp;<span class="keyword" id="6017722">interface</span><span class="op" id="6017731">{</span><span class="op" id="6017732">}</span><span class="op" id="6017733">,</span>&nbsp;<span class="ident" id="6017735">expect</span>&nbsp;<span class="ident" id="6017742">typeId</span><span class="op" id="6017748">)</span>&nbsp;<span class="ident" id="6017750">typeId</span>&nbsp;<span class="op" id="6017757">{</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017760">rt</span>&nbsp;<span class="op" id="6017763">:=</span>&nbsp;<span class="ident" id="6017766">reflect</span><span class="op" id="6017773">.</span><span class="ident" id="6017774">TypeOf</span><span class="op" id="6017780">(</span><span class="ident" id="6017781">e</span><span class="op" id="6017782">)</span><span class="op" id="6017783">.</span><span class="ident" id="6017784">Elem</span><span class="op" id="6017788">(</span><span class="op" id="6017789">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017792">_</span><span class="op" id="6017793">,</span>&nbsp;<span class="ident" id="6017795">present</span>&nbsp;<span class="op" id="6017803">:=</span>&nbsp;<span class="ident" id="6017806">types</span><span class="op" id="6017811">[</span><span class="ident" id="6017812">rt</span><span class="op" id="6017814">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6017817">if</span>&nbsp;<span class="ident" id="6017820">present</span>&nbsp;<span class="op" id="6017828">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6017832">panic</span><span class="op" id="6017837">(</span><span class="string" id="6017838">&#34;bootstrap&nbsp;type&nbsp;already&nbsp;present:&nbsp;&#34;</span>&nbsp;<span class="op" id="6017873">+</span>&nbsp;<span class="ident" id="6017875">name</span>&nbsp;<span class="op" id="6017880">+</span>&nbsp;<span class="string" id="6017882">&#34;,&nbsp;&#34;</span>&nbsp;<span class="op" id="6017887">+</span>&nbsp;<span class="ident" id="6017889">rt</span><span class="op" id="6017891">.</span><span class="ident" id="6017892">String</span><span class="op" id="6017898">(</span><span class="op" id="6017899">)</span><span class="op" id="6017900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6017903">}</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017906">typ</span>&nbsp;<span class="op" id="6017910">:=</span>&nbsp;<span class="op" id="6017913">&amp;</span><span class="ident" id="6017914">CommonType</span><span class="op" id="6017924">{</span><span class="ident" id="6017925">Name</span><span class="op" id="6017929">:</span>&nbsp;<span class="ident" id="6017931">name</span><span class="op" id="6017935">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017938">types</span><span class="op" id="6017943">[</span><span class="ident" id="6017944">rt</span><span class="op" id="6017946">]</span>&nbsp;<span class="op" id="6017948">=</span>&nbsp;<span class="ident" id="6017950">typ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017955">setTypeId</span><span class="op" id="6017964">(</span><span class="ident" id="6017965">typ</span><span class="op" id="6017968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017971">checkId</span><span class="op" id="6017978">(</span><span class="ident" id="6017979">expect</span><span class="op" id="6017985">,</span>&nbsp;<span class="ident" id="6017987">nextId</span><span class="op" id="6017993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6017996">userType</span><span class="op" id="6018004">(</span><span class="ident" id="6018005">rt</span><span class="op" id="6018007">)</span>&nbsp;<span class="comment" id="6018009">//&nbsp;might&nbsp;as&nbsp;well&nbsp;cache&nbsp;it&nbsp;now</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6018040">return</span>&nbsp;<span class="ident" id="6018047">nextId</span><br>
<span class="lineno"></span><span class="op" id="6018054">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6018057">//&nbsp;Representation&nbsp;of&nbsp;the&nbsp;information&nbsp;we&nbsp;send&nbsp;and&nbsp;receive&nbsp;about&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="6018131">//&nbsp;Each&nbsp;value&nbsp;we&nbsp;send&nbsp;is&nbsp;preceded&nbsp;by&nbsp;its&nbsp;type&nbsp;definition:&nbsp;an&nbsp;encoded&nbsp;int.</span><br>
<span class="lineno">640</span><span class="comment" id="6018205">//&nbsp;However,&nbsp;the&nbsp;very&nbsp;first&nbsp;time&nbsp;we&nbsp;send&nbsp;the&nbsp;value,&nbsp;we&nbsp;first&nbsp;send&nbsp;the&nbsp;pair</span><br>
<span class="lineno"></span><span class="comment" id="6018279">//&nbsp;(-id,&nbsp;wireType).</span><br>
<span class="lineno"></span><span class="comment" id="6018299">//&nbsp;For&nbsp;bootstrapping&nbsp;purposes,&nbsp;we&nbsp;assume&nbsp;that&nbsp;the&nbsp;recipient&nbsp;knows&nbsp;how</span><br>
<span class="lineno"></span><span class="comment" id="6018369">//&nbsp;to&nbsp;decode&nbsp;a&nbsp;wireType;&nbsp;it&nbsp;is&nbsp;exactly&nbsp;the&nbsp;wireType&nbsp;struct&nbsp;here,&nbsp;interpreted</span><br>
<span class="lineno"></span><span class="comment" id="6018446">//&nbsp;using&nbsp;the&nbsp;gob&nbsp;rules&nbsp;for&nbsp;sending&nbsp;a&nbsp;structure,&nbsp;except&nbsp;that&nbsp;we&nbsp;assume&nbsp;the</span><br>
<span class="lineno">645</span><span class="comment" id="6018520">//&nbsp;ids&nbsp;for&nbsp;wireType&nbsp;and&nbsp;structType&nbsp;etc.&nbsp;are&nbsp;known.&nbsp;&nbsp;The&nbsp;relevant&nbsp;pieces</span><br>
<span class="lineno"></span><span class="comment" id="6018592">//&nbsp;are&nbsp;built&nbsp;in&nbsp;encode.go&#39;s&nbsp;init()&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="6018637">//&nbsp;To&nbsp;maintain&nbsp;binary&nbsp;compatibility,&nbsp;if&nbsp;you&nbsp;extend&nbsp;this&nbsp;type,&nbsp;always&nbsp;put</span><br>
<span class="lineno"></span><span class="comment" id="6018710">//&nbsp;the&nbsp;new&nbsp;fields&nbsp;last.</span><br>
<span class="lineno"></span><span class="keyword" id="6018734">type</span>&nbsp;<span class="ident" id="6018739">wireType</span>&nbsp;<span class="keyword" id="6018748">struct</span>&nbsp;<span class="op" id="6018755">{</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6018758">ArrayT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6018775">*</span><span class="ident" id="6018776">arrayType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6018787">SliceT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6018804">*</span><span class="ident" id="6018805">sliceType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6018816">StructT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6018833">*</span><span class="ident" id="6018834">structType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6018846">MapT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6018863">*</span><span class="ident" id="6018864">mapType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6018873">GobEncoderT</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6018890">*</span><span class="ident" id="6018891">gobEncoderType</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6018907">BinaryMarshalerT</span>&nbsp;<span class="op" id="6018924">*</span><span class="ident" id="6018925">gobEncoderType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6018941">TextMarshalerT</span>&nbsp;&nbsp;&nbsp;<span class="op" id="6018958">*</span><span class="ident" id="6018959">gobEncoderType</span><br>
<span class="lineno"></span><span class="op" id="6018974">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6018977">func</span>&nbsp;<span class="op" id="6018982">(</span><span class="ident" id="6018983">w</span>&nbsp;<span class="op" id="6018985">*</span><span class="ident" id="6018986">wireType</span><span class="op" id="6018994">)</span>&nbsp;<span class="builtintype" id="6018996">string</span><span class="op" id="6019002">(</span><span class="op" id="6019003">)</span>&nbsp;<span class="builtintype" id="6019005">string</span>&nbsp;<span class="op" id="6019012">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019015">const</span>&nbsp;<span class="ident" id="6019021">unknown</span>&nbsp;<span class="op" id="6019029">=</span>&nbsp;<span class="string" id="6019031">&#34;unknown&nbsp;type&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019047">if</span>&nbsp;<span class="ident" id="6019050">w</span>&nbsp;<span class="op" id="6019052">==</span>&nbsp;<span class="ident" id="6019055">nil</span>&nbsp;<span class="op" id="6019059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019063">return</span>&nbsp;<span class="ident" id="6019070">unknown</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6019079">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019082">switch</span>&nbsp;<span class="op" id="6019089">{</span><br>
<span class="lineno">665</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019092">case</span>&nbsp;<span class="ident" id="6019097">w</span><span class="op" id="6019098">.</span><span class="ident" id="6019099">ArrayT</span>&nbsp;<span class="op" id="6019106">!=</span>&nbsp;<span class="ident" id="6019109">nil</span><span class="op" id="6019112">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019116">return</span>&nbsp;<span class="ident" id="6019123">w</span><span class="op" id="6019124">.</span><span class="ident" id="6019125">ArrayT</span><span class="op" id="6019131">.</span><span class="ident" id="6019132">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019138">case</span>&nbsp;<span class="ident" id="6019143">w</span><span class="op" id="6019144">.</span><span class="ident" id="6019145">SliceT</span>&nbsp;<span class="op" id="6019152">!=</span>&nbsp;<span class="ident" id="6019155">nil</span><span class="op" id="6019158">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019162">return</span>&nbsp;<span class="ident" id="6019169">w</span><span class="op" id="6019170">.</span><span class="ident" id="6019171">SliceT</span><span class="op" id="6019177">.</span><span class="ident" id="6019178">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019184">case</span>&nbsp;<span class="ident" id="6019189">w</span><span class="op" id="6019190">.</span><span class="ident" id="6019191">StructT</span>&nbsp;<span class="op" id="6019199">!=</span>&nbsp;<span class="ident" id="6019202">nil</span><span class="op" id="6019205">:</span><br>
<span class="lineno">670</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019209">return</span>&nbsp;<span class="ident" id="6019216">w</span><span class="op" id="6019217">.</span><span class="ident" id="6019218">StructT</span><span class="op" id="6019225">.</span><span class="ident" id="6019226">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019232">case</span>&nbsp;<span class="ident" id="6019237">w</span><span class="op" id="6019238">.</span><span class="ident" id="6019239">MapT</span>&nbsp;<span class="op" id="6019244">!=</span>&nbsp;<span class="ident" id="6019247">nil</span><span class="op" id="6019250">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019254">return</span>&nbsp;<span class="ident" id="6019261">w</span><span class="op" id="6019262">.</span><span class="ident" id="6019263">MapT</span><span class="op" id="6019267">.</span><span class="ident" id="6019268">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019274">case</span>&nbsp;<span class="ident" id="6019279">w</span><span class="op" id="6019280">.</span><span class="ident" id="6019281">GobEncoderT</span>&nbsp;<span class="op" id="6019293">!=</span>&nbsp;<span class="ident" id="6019296">nil</span><span class="op" id="6019299">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019303">return</span>&nbsp;<span class="ident" id="6019310">w</span><span class="op" id="6019311">.</span><span class="ident" id="6019312">GobEncoderT</span><span class="op" id="6019323">.</span><span class="ident" id="6019324">Name</span><br>
<span class="lineno">675</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019330">case</span>&nbsp;<span class="ident" id="6019335">w</span><span class="op" id="6019336">.</span><span class="ident" id="6019337">BinaryMarshalerT</span>&nbsp;<span class="op" id="6019354">!=</span>&nbsp;<span class="ident" id="6019357">nil</span><span class="op" id="6019360">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019364">return</span>&nbsp;<span class="ident" id="6019371">w</span><span class="op" id="6019372">.</span><span class="ident" id="6019373">BinaryMarshalerT</span><span class="op" id="6019389">.</span><span class="ident" id="6019390">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019396">case</span>&nbsp;<span class="ident" id="6019401">w</span><span class="op" id="6019402">.</span><span class="ident" id="6019403">TextMarshalerT</span>&nbsp;<span class="op" id="6019418">!=</span>&nbsp;<span class="ident" id="6019421">nil</span><span class="op" id="6019424">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019428">return</span>&nbsp;<span class="ident" id="6019435">w</span><span class="op" id="6019436">.</span><span class="ident" id="6019437">TextMarshalerT</span><span class="op" id="6019451">.</span><span class="ident" id="6019452">Name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6019458">}</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6019461">return</span>&nbsp;<span class="ident" id="6019468">unknown</span><br>
<span class="lineno"></span><span class="op" id="6019476">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6019479">type</span>&nbsp;<span class="ident" id="6019484">typeInfo</span>&nbsp;<span class="keyword" id="6019493">struct</span>&nbsp;<span class="op" id="6019500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6019503">id</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6019511">typeId</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6019519">encInit</span>&nbsp;<span class="ident" id="6019527">sync</span><span class="op" id="6019531">.</span><span class="ident" id="6019532">Mutex</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="6019540">//&nbsp;protects&nbsp;creation&nbsp;of&nbsp;encoder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6019573">encoder</span>&nbsp;<span class="ident" id="6019581">atomic</span><span class="op" id="6019587">.</span><span class="ident" id="6019588">Value</span>&nbsp;<span class="comment" id="6019594">//&nbsp;*encEngine</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6019609">wire</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6019617">*</span><span class="ident" id="6019618">wireType</span><br>
<span class="lineno"></span><span class="op" id="6019627">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">690</span><span class="comment" id="6019630">//&nbsp;typeInfoMap&nbsp;is&nbsp;an&nbsp;atomic&nbsp;pointer&nbsp;to&nbsp;map[reflect.Type]*typeInfo.</span><br>
<span class="lineno"></span><span class="comment" id="6019697">//&nbsp;It&#39;s&nbsp;updated&nbsp;copy-on-write.&nbsp;Readers&nbsp;just&nbsp;do&nbsp;an&nbsp;atomic&nbsp;load</span><br>
<span class="lineno"></span><span class="comment" id="6019759">//&nbsp;to&nbsp;get&nbsp;the&nbsp;current&nbsp;version&nbsp;of&nbsp;the&nbsp;map.&nbsp;Writers&nbsp;make&nbsp;a&nbsp;full&nbsp;copy&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="6019829">//&nbsp;the&nbsp;map&nbsp;and&nbsp;atomically&nbsp;update&nbsp;the&nbsp;pointer&nbsp;to&nbsp;point&nbsp;to&nbsp;the&nbsp;new&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="6019899">//&nbsp;Under&nbsp;heavy&nbsp;read&nbsp;contention,&nbsp;this&nbsp;is&nbsp;significantly&nbsp;faster&nbsp;than&nbsp;a&nbsp;map</span><br>
<span class="lineno">695</span><span class="comment" id="6019971">//&nbsp;protected&nbsp;by&nbsp;a&nbsp;mutex.</span><br>
<span class="lineno"></span><span class="keyword" id="6019996">var</span>&nbsp;<span class="ident" id="6020000">typeInfoMap</span>&nbsp;<span class="ident" id="6020012">atomic</span><span class="op" id="6020018">.</span><span class="ident" id="6020019">Value</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6020026">func</span>&nbsp;<span class="ident" id="6020031">lookupTypeInfo</span><span class="op" id="6020045">(</span><span class="ident" id="6020046">rt</span>&nbsp;<span class="ident" id="6020049">reflect</span><span class="op" id="6020056">.</span><span class="ident" id="6020057">Type</span><span class="op" id="6020061">)</span>&nbsp;<span class="op" id="6020063">*</span><span class="ident" id="6020064">typeInfo</span>&nbsp;<span class="op" id="6020073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6020076">m</span><span class="op" id="6020077">,</span>&nbsp;<span class="ident" id="6020079">_</span>&nbsp;<span class="op" id="6020081">:=</span>&nbsp;<span class="ident" id="6020084">typeInfoMap</span><span class="op" id="6020095">.</span><span class="ident" id="6020096">Load</span><span class="op" id="6020100">(</span><span class="op" id="6020101">)</span><span class="op" id="6020102">.</span><span class="op" id="6020103">(</span><span class="keyword" id="6020104">map</span><span class="op" id="6020107">[</span><span class="ident" id="6020108">reflect</span><span class="op" id="6020115">.</span><span class="ident" id="6020116">Type</span><span class="op" id="6020120">]</span><span class="op" id="6020121">*</span><span class="ident" id="6020122">typeInfo</span><span class="op" id="6020130">)</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020133">return</span>&nbsp;<span class="ident" id="6020140">m</span><span class="op" id="6020141">[</span><span class="ident" id="6020142">rt</span><span class="op" id="6020144">]</span><br>
<span class="lineno"></span><span class="op" id="6020146">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6020149">func</span>&nbsp;<span class="ident" id="6020154">getTypeInfo</span><span class="op" id="6020165">(</span><span class="ident" id="6020166">ut</span>&nbsp;<span class="op" id="6020169">*</span><span class="ident" id="6020170">userTypeInfo</span><span class="op" id="6020182">)</span>&nbsp;<span class="op" id="6020184">(</span><span class="op" id="6020185">*</span><span class="ident" id="6020186">typeInfo</span><span class="op" id="6020194">,</span>&nbsp;<span class="builtintype" id="6020196">error</span><span class="op" id="6020201">)</span>&nbsp;<span class="op" id="6020203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6020206">rt</span>&nbsp;<span class="op" id="6020209">:=</span>&nbsp;<span class="ident" id="6020212">ut</span><span class="op" id="6020214">.</span><span class="ident" id="6020215">base</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020221">if</span>&nbsp;<span class="ident" id="6020224">ut</span><span class="op" id="6020226">.</span><span class="ident" id="6020227">externalEnc</span>&nbsp;<span class="op" id="6020239">!=</span>&nbsp;<span class="num" id="6020242">0</span>&nbsp;<span class="op" id="6020244">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6020248">//&nbsp;We&nbsp;want&nbsp;the&nbsp;user&nbsp;type,&nbsp;not&nbsp;the&nbsp;base&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6020295">rt</span>&nbsp;<span class="op" id="6020298">=</span>&nbsp;<span class="ident" id="6020300">ut</span><span class="op" id="6020302">.</span><span class="ident" id="6020303">user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6020309">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020312">if</span>&nbsp;<span class="ident" id="6020315">info</span>&nbsp;<span class="op" id="6020320">:=</span>&nbsp;<span class="ident" id="6020323">lookupTypeInfo</span><span class="op" id="6020337">(</span><span class="ident" id="6020338">rt</span><span class="op" id="6020340">)</span><span class="op" id="6020341">;</span>&nbsp;<span class="ident" id="6020343">info</span>&nbsp;<span class="op" id="6020348">!=</span>&nbsp;<span class="ident" id="6020351">nil</span>&nbsp;<span class="op" id="6020355">{</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020359">return</span>&nbsp;<span class="ident" id="6020366">info</span><span class="op" id="6020370">,</span>&nbsp;<span class="ident" id="6020372">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6020377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020380">return</span>&nbsp;<span class="ident" id="6020387">buildTypeInfo</span><span class="op" id="6020400">(</span><span class="ident" id="6020401">ut</span><span class="op" id="6020403">,</span>&nbsp;<span class="ident" id="6020405">rt</span><span class="op" id="6020407">)</span><br>
<span class="lineno"></span><span class="op" id="6020409">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">715</span><span class="comment" id="6020412">//&nbsp;buildTypeInfo&nbsp;constructs&nbsp;the&nbsp;type&nbsp;information&nbsp;for&nbsp;the&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="6020474">//&nbsp;and&nbsp;stores&nbsp;it&nbsp;in&nbsp;the&nbsp;type&nbsp;info&nbsp;map.</span><br>
<span class="lineno"></span><span class="keyword" id="6020513">func</span>&nbsp;<span class="ident" id="6020518">buildTypeInfo</span><span class="op" id="6020531">(</span><span class="ident" id="6020532">ut</span>&nbsp;<span class="op" id="6020535">*</span><span class="ident" id="6020536">userTypeInfo</span><span class="op" id="6020548">,</span>&nbsp;<span class="ident" id="6020550">rt</span>&nbsp;<span class="ident" id="6020553">reflect</span><span class="op" id="6020560">.</span><span class="ident" id="6020561">Type</span><span class="op" id="6020565">)</span>&nbsp;<span class="op" id="6020567">(</span><span class="op" id="6020568">*</span><span class="ident" id="6020569">typeInfo</span><span class="op" id="6020577">,</span>&nbsp;<span class="builtintype" id="6020579">error</span><span class="op" id="6020584">)</span>&nbsp;<span class="op" id="6020586">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6020589">typeLock</span><span class="op" id="6020597">.</span><span class="ident" id="6020598">Lock</span><span class="op" id="6020602">(</span><span class="op" id="6020603">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020606">defer</span>&nbsp;<span class="ident" id="6020612">typeLock</span><span class="op" id="6020620">.</span><span class="ident" id="6020621">Unlock</span><span class="op" id="6020627">(</span><span class="op" id="6020628">)</span><br>
<span class="lineno">720</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020632">if</span>&nbsp;<span class="ident" id="6020635">info</span>&nbsp;<span class="op" id="6020640">:=</span>&nbsp;<span class="ident" id="6020643">lookupTypeInfo</span><span class="op" id="6020657">(</span><span class="ident" id="6020658">rt</span><span class="op" id="6020660">)</span><span class="op" id="6020661">;</span>&nbsp;<span class="ident" id="6020663">info</span>&nbsp;<span class="op" id="6020668">!=</span>&nbsp;<span class="ident" id="6020671">nil</span>&nbsp;<span class="op" id="6020675">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020679">return</span>&nbsp;<span class="ident" id="6020686">info</span><span class="op" id="6020690">,</span>&nbsp;<span class="ident" id="6020692">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6020697">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6020701">gt</span><span class="op" id="6020703">,</span>&nbsp;<span class="ident" id="6020705">err</span>&nbsp;<span class="op" id="6020709">:=</span>&nbsp;<span class="ident" id="6020712">getBaseType</span><span class="op" id="6020723">(</span><span class="ident" id="6020724">rt</span><span class="op" id="6020726">.</span><span class="ident" id="6020727">Name</span><span class="op" id="6020731">(</span><span class="op" id="6020732">)</span><span class="op" id="6020733">,</span>&nbsp;<span class="ident" id="6020735">rt</span><span class="op" id="6020737">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020740">if</span>&nbsp;<span class="ident" id="6020743">err</span>&nbsp;<span class="op" id="6020747">!=</span>&nbsp;<span class="ident" id="6020750">nil</span>&nbsp;<span class="op" id="6020754">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020758">return</span>&nbsp;<span class="ident" id="6020765">nil</span><span class="op" id="6020768">,</span>&nbsp;<span class="ident" id="6020770">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6020775">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6020778">info</span>&nbsp;<span class="op" id="6020783">:=</span>&nbsp;<span class="op" id="6020786">&amp;</span><span class="ident" id="6020787">typeInfo</span><span class="op" id="6020795">{</span><span class="ident" id="6020796">id</span><span class="op" id="6020798">:</span>&nbsp;<span class="ident" id="6020800">gt</span><span class="op" id="6020802">.</span><span class="ident" id="6020803">id</span><span class="op" id="6020805">(</span><span class="op" id="6020806">)</span><span class="op" id="6020807">}</span><br>
<span class="lineno">730</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020811">if</span>&nbsp;<span class="ident" id="6020814">ut</span><span class="op" id="6020816">.</span><span class="ident" id="6020817">externalEnc</span>&nbsp;<span class="op" id="6020829">!=</span>&nbsp;<span class="num" id="6020832">0</span>&nbsp;<span class="op" id="6020834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6020838">userType</span><span class="op" id="6020846">,</span>&nbsp;<span class="ident" id="6020848">err</span>&nbsp;<span class="op" id="6020852">:=</span>&nbsp;<span class="ident" id="6020855">getType</span><span class="op" id="6020862">(</span><span class="ident" id="6020863">rt</span><span class="op" id="6020865">.</span><span class="ident" id="6020866">Name</span><span class="op" id="6020870">(</span><span class="op" id="6020871">)</span><span class="op" id="6020872">,</span>&nbsp;<span class="ident" id="6020874">ut</span><span class="op" id="6020876">,</span>&nbsp;<span class="ident" id="6020878">rt</span><span class="op" id="6020880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020884">if</span>&nbsp;<span class="ident" id="6020887">err</span>&nbsp;<span class="op" id="6020891">!=</span>&nbsp;<span class="ident" id="6020894">nil</span>&nbsp;<span class="op" id="6020898">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020903">return</span>&nbsp;<span class="ident" id="6020910">nil</span><span class="op" id="6020913">,</span>&nbsp;<span class="ident" id="6020915">err</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6020921">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6020925">gt</span>&nbsp;<span class="op" id="6020928">:=</span>&nbsp;<span class="ident" id="6020931">userType</span><span class="op" id="6020939">.</span><span class="ident" id="6020940">id</span><span class="op" id="6020942">(</span><span class="op" id="6020943">)</span><span class="op" id="6020944">.</span><span class="ident" id="6020945">gobType</span><span class="op" id="6020952">(</span><span class="op" id="6020953">)</span><span class="op" id="6020954">.</span><span class="op" id="6020955">(</span><span class="op" id="6020956">*</span><span class="ident" id="6020957">gobEncoderType</span><span class="op" id="6020971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6020975">switch</span>&nbsp;<span class="ident" id="6020982">ut</span><span class="op" id="6020984">.</span><span class="ident" id="6020985">externalEnc</span>&nbsp;<span class="op" id="6020997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021001">case</span>&nbsp;<span class="ident" id="6021006">xGob</span><span class="op" id="6021010">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021015">info</span><span class="op" id="6021019">.</span><span class="ident" id="6021020">wire</span>&nbsp;<span class="op" id="6021025">=</span>&nbsp;<span class="op" id="6021027">&amp;</span><span class="ident" id="6021028">wireType</span><span class="op" id="6021036">{</span><span class="ident" id="6021037">GobEncoderT</span><span class="op" id="6021048">:</span>&nbsp;<span class="ident" id="6021050">gt</span><span class="op" id="6021052">}</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021056">case</span>&nbsp;<span class="ident" id="6021061">xBinary</span><span class="op" id="6021068">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021073">info</span><span class="op" id="6021077">.</span><span class="ident" id="6021078">wire</span>&nbsp;<span class="op" id="6021083">=</span>&nbsp;<span class="op" id="6021085">&amp;</span><span class="ident" id="6021086">wireType</span><span class="op" id="6021094">{</span><span class="ident" id="6021095">BinaryMarshalerT</span><span class="op" id="6021111">:</span>&nbsp;<span class="ident" id="6021113">gt</span><span class="op" id="6021115">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021119">case</span>&nbsp;<span class="ident" id="6021124">xText</span><span class="op" id="6021129">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021134">info</span><span class="op" id="6021138">.</span><span class="ident" id="6021139">wire</span>&nbsp;<span class="op" id="6021144">=</span>&nbsp;<span class="op" id="6021146">&amp;</span><span class="ident" id="6021147">wireType</span><span class="op" id="6021155">{</span><span class="ident" id="6021156">TextMarshalerT</span><span class="op" id="6021170">:</span>&nbsp;<span class="ident" id="6021172">gt</span><span class="op" id="6021174">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6021178">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021182">rt</span>&nbsp;<span class="op" id="6021185">=</span>&nbsp;<span class="ident" id="6021187">ut</span><span class="op" id="6021189">.</span><span class="ident" id="6021190">user</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6021196">}</span>&nbsp;<span class="keyword" id="6021198">else</span>&nbsp;<span class="op" id="6021203">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021207">t</span>&nbsp;<span class="op" id="6021209">:=</span>&nbsp;<span class="ident" id="6021212">info</span><span class="op" id="6021216">.</span><span class="ident" id="6021217">id</span><span class="op" id="6021219">.</span><span class="ident" id="6021220">gobType</span><span class="op" id="6021227">(</span><span class="op" id="6021228">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021232">switch</span>&nbsp;<span class="ident" id="6021239">typ</span>&nbsp;<span class="op" id="6021243">:=</span>&nbsp;<span class="ident" id="6021246">rt</span><span class="op" id="6021248">;</span>&nbsp;<span class="ident" id="6021250">typ</span><span class="op" id="6021253">.</span><span class="ident" id="6021254">Kind</span><span class="op" id="6021258">(</span><span class="op" id="6021259">)</span>&nbsp;<span class="op" id="6021261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021265">case</span>&nbsp;<span class="ident" id="6021270">reflect</span><span class="op" id="6021277">.</span><span class="ident" id="6021278">Array</span><span class="op" id="6021283">:</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021288">info</span><span class="op" id="6021292">.</span><span class="ident" id="6021293">wire</span>&nbsp;<span class="op" id="6021298">=</span>&nbsp;<span class="op" id="6021300">&amp;</span><span class="ident" id="6021301">wireType</span><span class="op" id="6021309">{</span><span class="ident" id="6021310">ArrayT</span><span class="op" id="6021316">:</span>&nbsp;<span class="ident" id="6021318">t</span><span class="op" id="6021319">.</span><span class="op" id="6021320">(</span><span class="op" id="6021321">*</span><span class="ident" id="6021322">arrayType</span><span class="op" id="6021331">)</span><span class="op" id="6021332">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021336">case</span>&nbsp;<span class="ident" id="6021341">reflect</span><span class="op" id="6021348">.</span><span class="ident" id="6021349">Map</span><span class="op" id="6021352">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021357">info</span><span class="op" id="6021361">.</span><span class="ident" id="6021362">wire</span>&nbsp;<span class="op" id="6021367">=</span>&nbsp;<span class="op" id="6021369">&amp;</span><span class="ident" id="6021370">wireType</span><span class="op" id="6021378">{</span><span class="ident" id="6021379">MapT</span><span class="op" id="6021383">:</span>&nbsp;<span class="ident" id="6021385">t</span><span class="op" id="6021386">.</span><span class="op" id="6021387">(</span><span class="op" id="6021388">*</span><span class="ident" id="6021389">mapType</span><span class="op" id="6021396">)</span><span class="op" id="6021397">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021401">case</span>&nbsp;<span class="ident" id="6021406">reflect</span><span class="op" id="6021413">.</span><span class="ident" id="6021414">Slice</span><span class="op" id="6021419">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6021424">//&nbsp;[]byte&nbsp;==&nbsp;[]uint8&nbsp;is&nbsp;a&nbsp;special&nbsp;case&nbsp;handled&nbsp;separately</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021485">if</span>&nbsp;<span class="ident" id="6021488">typ</span><span class="op" id="6021491">.</span><span class="ident" id="6021492">Elem</span><span class="op" id="6021496">(</span><span class="op" id="6021497">)</span><span class="op" id="6021498">.</span><span class="ident" id="6021499">Kind</span><span class="op" id="6021503">(</span><span class="op" id="6021504">)</span>&nbsp;<span class="op" id="6021506">!=</span>&nbsp;<span class="ident" id="6021509">reflect</span><span class="op" id="6021516">.</span><span class="ident" id="6021517">Uint8</span>&nbsp;<span class="op" id="6021523">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021529">info</span><span class="op" id="6021533">.</span><span class="ident" id="6021534">wire</span>&nbsp;<span class="op" id="6021539">=</span>&nbsp;<span class="op" id="6021541">&amp;</span><span class="ident" id="6021542">wireType</span><span class="op" id="6021550">{</span><span class="ident" id="6021551">SliceT</span><span class="op" id="6021557">:</span>&nbsp;<span class="ident" id="6021559">t</span><span class="op" id="6021560">.</span><span class="op" id="6021561">(</span><span class="op" id="6021562">*</span><span class="ident" id="6021563">sliceType</span><span class="op" id="6021572">)</span><span class="op" id="6021573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6021578">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021582">case</span>&nbsp;<span class="ident" id="6021587">reflect</span><span class="op" id="6021594">.</span><span class="ident" id="6021595">Struct</span><span class="op" id="6021601">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021606">info</span><span class="op" id="6021610">.</span><span class="ident" id="6021611">wire</span>&nbsp;<span class="op" id="6021616">=</span>&nbsp;<span class="op" id="6021618">&amp;</span><span class="ident" id="6021619">wireType</span><span class="op" id="6021627">{</span><span class="ident" id="6021628">StructT</span><span class="op" id="6021635">:</span>&nbsp;<span class="ident" id="6021637">t</span><span class="op" id="6021638">.</span><span class="op" id="6021639">(</span><span class="op" id="6021640">*</span><span class="ident" id="6021641">structType</span><span class="op" id="6021651">)</span><span class="op" id="6021652">}</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6021656">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6021659">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6021663">//&nbsp;Create&nbsp;new&nbsp;map&nbsp;with&nbsp;old&nbsp;contents&nbsp;plus&nbsp;new&nbsp;entry.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021716">newm</span>&nbsp;<span class="op" id="6021721">:=</span>&nbsp;<span class="builtinfunc" id="6021724">make</span><span class="op" id="6021728">(</span><span class="keyword" id="6021729">map</span><span class="op" id="6021732">[</span><span class="ident" id="6021733">reflect</span><span class="op" id="6021740">.</span><span class="ident" id="6021741">Type</span><span class="op" id="6021745">]</span><span class="op" id="6021746">*</span><span class="ident" id="6021747">typeInfo</span><span class="op" id="6021755">)</span><br>
<span class="lineno">765</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021758">m</span><span class="op" id="6021759">,</span>&nbsp;<span class="ident" id="6021761">_</span>&nbsp;<span class="op" id="6021763">:=</span>&nbsp;<span class="ident" id="6021766">typeInfoMap</span><span class="op" id="6021777">.</span><span class="ident" id="6021778">Load</span><span class="op" id="6021782">(</span><span class="op" id="6021783">)</span><span class="op" id="6021784">.</span><span class="op" id="6021785">(</span><span class="keyword" id="6021786">map</span><span class="op" id="6021789">[</span><span class="ident" id="6021790">reflect</span><span class="op" id="6021797">.</span><span class="ident" id="6021798">Type</span><span class="op" id="6021802">]</span><span class="op" id="6021803">*</span><span class="ident" id="6021804">typeInfo</span><span class="op" id="6021812">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021815">for</span>&nbsp;<span class="ident" id="6021819">k</span><span class="op" id="6021820">,</span>&nbsp;<span class="ident" id="6021822">v</span>&nbsp;<span class="op" id="6021824">:=</span>&nbsp;<span class="keyword" id="6021827">range</span>&nbsp;<span class="ident" id="6021833">m</span>&nbsp;<span class="op" id="6021835">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021839">newm</span><span class="op" id="6021843">[</span><span class="ident" id="6021844">k</span><span class="op" id="6021845">]</span>&nbsp;<span class="op" id="6021847">=</span>&nbsp;<span class="ident" id="6021849">v</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6021852">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021855">newm</span><span class="op" id="6021859">[</span><span class="ident" id="6021860">rt</span><span class="op" id="6021862">]</span>&nbsp;<span class="op" id="6021864">=</span>&nbsp;<span class="ident" id="6021866">info</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6021872">typeInfoMap</span><span class="op" id="6021883">.</span><span class="ident" id="6021884">Store</span><span class="op" id="6021889">(</span><span class="ident" id="6021890">newm</span><span class="op" id="6021894">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6021897">return</span>&nbsp;<span class="ident" id="6021904">info</span><span class="op" id="6021908">,</span>&nbsp;<span class="ident" id="6021910">nil</span><br>
<span class="lineno"></span><span class="op" id="6021914">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6021917">//&nbsp;Called&nbsp;only&nbsp;when&nbsp;a&nbsp;panic&nbsp;is&nbsp;acceptable&nbsp;and&nbsp;unexpected.</span><br>
<span class="lineno">775</span><span class="keyword" id="6021975">func</span>&nbsp;<span class="ident" id="6021980">mustGetTypeInfo</span><span class="op" id="6021995">(</span><span class="ident" id="6021996">rt</span>&nbsp;<span class="ident" id="6021999">reflect</span><span class="op" id="6022006">.</span><span class="ident" id="6022007">Type</span><span class="op" id="6022011">)</span>&nbsp;<span class="op" id="6022013">*</span><span class="ident" id="6022014">typeInfo</span>&nbsp;<span class="op" id="6022023">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6022026">t</span><span class="op" id="6022027">,</span>&nbsp;<span class="ident" id="6022029">err</span>&nbsp;<span class="op" id="6022033">:=</span>&nbsp;<span class="ident" id="6022036">getTypeInfo</span><span class="op" id="6022047">(</span><span class="ident" id="6022048">userType</span><span class="op" id="6022056">(</span><span class="ident" id="6022057">rt</span><span class="op" id="6022059">)</span><span class="op" id="6022060">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022063">if</span>&nbsp;<span class="ident" id="6022066">err</span>&nbsp;<span class="op" id="6022070">!=</span>&nbsp;<span class="ident" id="6022073">nil</span>&nbsp;<span class="op" id="6022077">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6022081">panic</span><span class="op" id="6022086">(</span><span class="string" id="6022087">&#34;getTypeInfo:&nbsp;&#34;</span>&nbsp;<span class="op" id="6022103">+</span>&nbsp;<span class="ident" id="6022105">err</span><span class="op" id="6022108">.</span><span class="ident" id="6022109">Error</span><span class="op" id="6022114">(</span><span class="op" id="6022115">)</span><span class="op" id="6022116">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6022119">}</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6022122">return</span>&nbsp;<span class="ident" id="6022129">t</span><br>
<span class="lineno"></span><span class="op" id="6022131">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="6022134">//&nbsp;GobEncoder&nbsp;is&nbsp;the&nbsp;interface&nbsp;describing&nbsp;data&nbsp;that&nbsp;provides&nbsp;its&nbsp;own</span><br>
<span class="lineno"></span><span class="comment" id="6022203">//&nbsp;representation&nbsp;for&nbsp;encoding&nbsp;values&nbsp;for&nbsp;transmission&nbsp;to&nbsp;a&nbsp;GobDecoder.</span><br>
<span class="lineno">785</span><span class="comment" id="6022275">//&nbsp;A&nbsp;type&nbsp;that&nbsp;implements&nbsp;GobEncoder&nbsp;and&nbsp;GobDecoder&nbsp;has&nbsp;complete</span><br>
<span class="lineno"></span><span class="comment" id="6022340">//&nbsp;control&nbsp;over&nbsp;the&nbsp;representation&nbsp;of&nbsp;its&nbsp;data&nbsp;and&nbsp;may&nbsp;therefore</span><br>
<span class="lineno"></span><span class="comment" id="6022405">//&nbsp;contain&nbsp;things&nbsp;such&nbsp;as&nbsp;private&nbsp;fields,&nbsp;channels,&nbsp;and&nbsp;functions,</span><br>
<span class="lineno"></span><span class="comment" id="6022472">//&nbsp;which&nbsp;are&nbsp;not&nbsp;usually&nbsp;transmissible&nbsp;in&nbsp;gob&nbsp;streams.</span><br>
<span class="lineno"></span><span class="comment" id="6022527">//</span><br>
<span class="lineno">790</span><span class="comment" id="6022530">//&nbsp;Note:&nbsp;Since&nbsp;gobs&nbsp;can&nbsp;be&nbsp;stored&nbsp;permanently,&nbsp;It&nbsp;is&nbsp;good&nbsp;design</span><br>
<span class="lineno"></span><span class="comment" id="6022595">//&nbsp;to&nbsp;guarantee&nbsp;the&nbsp;encoding&nbsp;used&nbsp;by&nbsp;a&nbsp;GobEncoder&nbsp;is&nbsp;stable&nbsp;as&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6022662">//&nbsp;software&nbsp;evolves.&nbsp;&nbsp;For&nbsp;instance,&nbsp;it&nbsp;might&nbsp;make&nbsp;sense&nbsp;for&nbsp;GobEncode</span><br>
<span class="lineno"></span><span class="comment" id="6022732">//&nbsp;to&nbsp;include&nbsp;a&nbsp;version&nbsp;number&nbsp;in&nbsp;the&nbsp;encoding.</span><br>
<span class="lineno"></span><span class="keyword" id="6022780">type</span>&nbsp;<span class="ident" id="6022785">GobEncoder</span>&nbsp;<span class="keyword" id="6022796">interface</span>&nbsp;<span class="op" id="6022806">{</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6022809">//&nbsp;GobEncode&nbsp;returns&nbsp;a&nbsp;byte&nbsp;slice&nbsp;representing&nbsp;the&nbsp;encoding&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6022877">//&nbsp;receiver&nbsp;for&nbsp;transmission&nbsp;to&nbsp;a&nbsp;GobDecoder,&nbsp;usually&nbsp;of&nbsp;the&nbsp;same</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6022944">//&nbsp;concrete&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6022963">GobEncode</span><span class="op" id="6022972">(</span><span class="op" id="6022973">)</span>&nbsp;<span class="op" id="6022975">(</span><span class="op" id="6022976">[</span><span class="op" id="6022977">]</span><span class="builtintype" id="6022978">byte</span><span class="op" id="6022982">,</span>&nbsp;<span class="builtintype" id="6022984">error</span><span class="op" id="6022989">)</span><br>
<span class="lineno"></span><span class="op" id="6022991">}</span><br>
<span class="lineno">800</span><br>
<span class="lineno"></span><span class="comment" id="6022994">//&nbsp;GobDecoder&nbsp;is&nbsp;the&nbsp;interface&nbsp;describing&nbsp;data&nbsp;that&nbsp;provides&nbsp;its&nbsp;own</span><br>
<span class="lineno"></span><span class="comment" id="6023063">//&nbsp;routine&nbsp;for&nbsp;decoding&nbsp;transmitted&nbsp;values&nbsp;sent&nbsp;by&nbsp;a&nbsp;GobEncoder.</span><br>
<span class="lineno"></span><span class="keyword" id="6023128">type</span>&nbsp;<span class="ident" id="6023133">GobDecoder</span>&nbsp;<span class="keyword" id="6023144">interface</span>&nbsp;<span class="op" id="6023154">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6023157">//&nbsp;GobDecode&nbsp;overwrites&nbsp;the&nbsp;receiver,&nbsp;which&nbsp;must&nbsp;be&nbsp;a&nbsp;pointer,</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6023221">//&nbsp;with&nbsp;the&nbsp;value&nbsp;represented&nbsp;by&nbsp;the&nbsp;byte&nbsp;slice,&nbsp;which&nbsp;was&nbsp;written</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6023289">//&nbsp;by&nbsp;GobEncode,&nbsp;usually&nbsp;for&nbsp;the&nbsp;same&nbsp;concrete&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6023343">GobDecode</span><span class="op" id="6023352">(</span><span class="op" id="6023353">[</span><span class="op" id="6023354">]</span><span class="builtintype" id="6023355">byte</span><span class="op" id="6023359">)</span>&nbsp;<span class="builtintype" id="6023361">error</span><br>
<span class="lineno"></span><span class="op" id="6023367">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">810</span><span class="keyword" id="6023370">var</span>&nbsp;<span class="op" id="6023374">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6023377">registerLock</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="6023396">sync</span><span class="op" id="6023400">.</span><span class="ident" id="6023401">RWMutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6023410">nameToConcreteType</span>&nbsp;<span class="op" id="6023429">=</span>&nbsp;<span class="builtinfunc" id="6023431">make</span><span class="op" id="6023435">(</span><span class="keyword" id="6023436">map</span><span class="op" id="6023439">[</span><span class="builtintype" id="6023440">string</span><span class="op" id="6023446">]</span><span class="ident" id="6023447">reflect</span><span class="op" id="6023454">.</span><span class="ident" id="6023455">Type</span><span class="op" id="6023459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6023462">concreteTypeToName</span>&nbsp;<span class="op" id="6023481">=</span>&nbsp;<span class="builtinfunc" id="6023483">make</span><span class="op" id="6023487">(</span><span class="keyword" id="6023488">map</span><span class="op" id="6023491">[</span><span class="ident" id="6023492">reflect</span><span class="op" id="6023499">.</span><span class="ident" id="6023500">Type</span><span class="op" id="6023504">]</span><span class="builtintype" id="6023505">string</span><span class="op" id="6023511">)</span><br>
<span class="lineno"></span><span class="op" id="6023513">)</span><br>
<span class="lineno">815</span><br>
<span class="lineno"></span><span class="comment" id="6023516">//&nbsp;RegisterName&nbsp;is&nbsp;like&nbsp;Register&nbsp;but&nbsp;uses&nbsp;the&nbsp;provided&nbsp;name&nbsp;rather&nbsp;than&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="6023592">//&nbsp;type&#39;s&nbsp;default.</span><br>
<span class="lineno"></span><span class="keyword" id="6023611">func</span>&nbsp;<span class="ident" id="6023616">RegisterName</span><span class="op" id="6023628">(</span><span class="ident" id="6023629">name</span>&nbsp;<span class="builtintype" id="6023634">string</span><span class="op" id="6023640">,</span>&nbsp;<span class="ident" id="6023642">value</span>&nbsp;<span class="keyword" id="6023648">interface</span><span class="op" id="6023657">{</span><span class="op" id="6023658">}</span><span class="op" id="6023659">)</span>&nbsp;<span class="op" id="6023661">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023664">if</span>&nbsp;<span class="ident" id="6023667">name</span>&nbsp;<span class="op" id="6023672">==</span>&nbsp;<span class="string" id="6023675">&#34;&#34;</span>&nbsp;<span class="op" id="6023678">{</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6023682">//&nbsp;reserved&nbsp;for&nbsp;nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6023704">panic</span><span class="op" id="6023709">(</span><span class="string" id="6023710">&#34;attempt&nbsp;to&nbsp;register&nbsp;empty&nbsp;name&#34;</span><span class="op" id="6023742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6023745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6023748">registerLock</span><span class="op" id="6023760">.</span><span class="ident" id="6023761">Lock</span><span class="op" id="6023765">(</span><span class="op" id="6023766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023769">defer</span>&nbsp;<span class="ident" id="6023775">registerLock</span><span class="op" id="6023787">.</span><span class="ident" id="6023788">Unlock</span><span class="op" id="6023794">(</span><span class="op" id="6023795">)</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6023798">ut</span>&nbsp;<span class="op" id="6023801">:=</span>&nbsp;<span class="ident" id="6023804">userType</span><span class="op" id="6023812">(</span><span class="ident" id="6023813">reflect</span><span class="op" id="6023820">.</span><span class="ident" id="6023821">TypeOf</span><span class="op" id="6023827">(</span><span class="ident" id="6023828">value</span><span class="op" id="6023833">)</span><span class="op" id="6023834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6023837">//&nbsp;Check&nbsp;for&nbsp;incompatible&nbsp;duplicates.&nbsp;The&nbsp;name&nbsp;must&nbsp;refer&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6023903">//&nbsp;same&nbsp;user&nbsp;type,&nbsp;and&nbsp;vice&nbsp;versa.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6023939">if</span>&nbsp;<span class="ident" id="6023942">t</span><span class="op" id="6023943">,</span>&nbsp;<span class="ident" id="6023945">ok</span>&nbsp;<span class="op" id="6023948">:=</span>&nbsp;<span class="ident" id="6023951">nameToConcreteType</span><span class="op" id="6023969">[</span><span class="ident" id="6023970">name</span><span class="op" id="6023974">]</span><span class="op" id="6023975">;</span>&nbsp;<span class="ident" id="6023977">ok</span>&nbsp;<span class="op" id="6023980">&amp;&amp;</span>&nbsp;<span class="ident" id="6023983">t</span>&nbsp;<span class="op" id="6023985">!=</span>&nbsp;<span class="ident" id="6023988">ut</span><span class="op" id="6023990">.</span><span class="ident" id="6023991">user</span>&nbsp;<span class="op" id="6023996">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6024000">panic</span><span class="op" id="6024005">(</span><span class="ident" id="6024006">fmt</span><span class="op" id="6024009">.</span><span class="ident" id="6024010">Sprintf</span><span class="op" id="6024017">(</span><span class="string" id="6024018">&#34;gob:&nbsp;registering&nbsp;duplicate&nbsp;types&nbsp;for&nbsp;%q:&nbsp;%s&nbsp;!=&nbsp;%s&#34;</span><span class="op" id="6024069">,</span>&nbsp;<span class="ident" id="6024071">name</span><span class="op" id="6024075">,</span>&nbsp;<span class="ident" id="6024077">t</span><span class="op" id="6024078">,</span>&nbsp;<span class="ident" id="6024080">ut</span><span class="op" id="6024082">.</span><span class="ident" id="6024083">user</span><span class="op" id="6024087">)</span><span class="op" id="6024088">)</span><br>
<span class="lineno">830</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6024091">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6024094">if</span>&nbsp;<span class="ident" id="6024097">n</span><span class="op" id="6024098">,</span>&nbsp;<span class="ident" id="6024100">ok</span>&nbsp;<span class="op" id="6024103">:=</span>&nbsp;<span class="ident" id="6024106">concreteTypeToName</span><span class="op" id="6024124">[</span><span class="ident" id="6024125">ut</span><span class="op" id="6024127">.</span><span class="ident" id="6024128">base</span><span class="op" id="6024132">]</span><span class="op" id="6024133">;</span>&nbsp;<span class="ident" id="6024135">ok</span>&nbsp;<span class="op" id="6024138">&amp;&amp;</span>&nbsp;<span class="ident" id="6024141">n</span>&nbsp;<span class="op" id="6024143">!=</span>&nbsp;<span class="ident" id="6024146">name</span>&nbsp;<span class="op" id="6024151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="6024155">panic</span><span class="op" id="6024160">(</span><span class="ident" id="6024161">fmt</span><span class="op" id="6024164">.</span><span class="ident" id="6024165">Sprintf</span><span class="op" id="6024172">(</span><span class="string" id="6024173">&#34;gob:&nbsp;registering&nbsp;duplicate&nbsp;names&nbsp;for&nbsp;%s:&nbsp;%q&nbsp;!=&nbsp;%q&#34;</span><span class="op" id="6024224">,</span>&nbsp;<span class="ident" id="6024226">ut</span><span class="op" id="6024228">.</span><span class="ident" id="6024229">user</span><span class="op" id="6024233">,</span>&nbsp;<span class="ident" id="6024235">n</span><span class="op" id="6024236">,</span>&nbsp;<span class="ident" id="6024238">name</span><span class="op" id="6024242">)</span><span class="op" id="6024243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6024246">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6024249">//&nbsp;Store&nbsp;the&nbsp;name&nbsp;and&nbsp;type&nbsp;provided&nbsp;by&nbsp;the&nbsp;user....</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6024302">nameToConcreteType</span><span class="op" id="6024320">[</span><span class="ident" id="6024321">name</span><span class="op" id="6024325">]</span>&nbsp;<span class="op" id="6024327">=</span>&nbsp;<span class="ident" id="6024329">reflect</span><span class="op" id="6024336">.</span><span class="ident" id="6024337">TypeOf</span><span class="op" id="6024343">(</span><span class="ident" id="6024344">value</span><span class="op" id="6024349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6024352">//&nbsp;but&nbsp;the&nbsp;flattened&nbsp;type&nbsp;in&nbsp;the&nbsp;type&nbsp;table,&nbsp;since&nbsp;that&#39;s&nbsp;what&nbsp;decode&nbsp;needs.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6024430">concreteTypeToName</span><span class="op" id="6024448">[</span><span class="ident" id="6024449">ut</span><span class="op" id="6024451">.</span><span class="ident" id="6024452">base</span><span class="op" id="6024456">]</span>&nbsp;<span class="op" id="6024458">=</span>&nbsp;<span class="ident" id="6024460">name</span><br>
<span class="lineno"></span><span class="op" id="6024465">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="6024468">//&nbsp;Register&nbsp;records&nbsp;a&nbsp;type,&nbsp;identified&nbsp;by&nbsp;a&nbsp;value&nbsp;for&nbsp;that&nbsp;type,&nbsp;under&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="6024543">//&nbsp;internal&nbsp;type&nbsp;name.&nbsp;&nbsp;That&nbsp;name&nbsp;will&nbsp;identify&nbsp;the&nbsp;concrete&nbsp;type&nbsp;of&nbsp;a&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="6024620">//&nbsp;sent&nbsp;or&nbsp;received&nbsp;as&nbsp;an&nbsp;interface&nbsp;variable.&nbsp;&nbsp;Only&nbsp;types&nbsp;that&nbsp;will&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="6024691">//&nbsp;transferred&nbsp;as&nbsp;implementations&nbsp;of&nbsp;interface&nbsp;values&nbsp;need&nbsp;to&nbsp;be&nbsp;registered.</span><br>
<span class="lineno"></span><span class="comment" id="6024768">//&nbsp;Expecting&nbsp;to&nbsp;be&nbsp;used&nbsp;only&nbsp;during&nbsp;initialization,&nbsp;it&nbsp;panics&nbsp;if&nbsp;the&nbsp;mapping</span><br>
<span class="lineno">845</span><span class="comment" id="6024845">//&nbsp;between&nbsp;types&nbsp;and&nbsp;names&nbsp;is&nbsp;not&nbsp;a&nbsp;bijection.</span><br>
<span class="lineno"></span><span class="keyword" id="6024892">func</span>&nbsp;<span class="ident" id="6024897">Register</span><span class="op" id="6024905">(</span><span class="ident" id="6024906">value</span>&nbsp;<span class="keyword" id="6024912">interface</span><span class="op" id="6024921">{</span><span class="op" id="6024922">}</span><span class="op" id="6024923">)</span>&nbsp;<span class="op" id="6024925">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6024928">//&nbsp;Default&nbsp;to&nbsp;printed&nbsp;representation&nbsp;for&nbsp;unnamed&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6024984">rt</span>&nbsp;<span class="op" id="6024987">:=</span>&nbsp;<span class="ident" id="6024990">reflect</span><span class="op" id="6024997">.</span><span class="ident" id="6024998">TypeOf</span><span class="op" id="6025004">(</span><span class="ident" id="6025005">value</span><span class="op" id="6025010">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6025013">name</span>&nbsp;<span class="op" id="6025018">:=</span>&nbsp;<span class="ident" id="6025021">rt</span><span class="op" id="6025023">.</span><span class="ident" id="6025024">String</span><span class="op" id="6025030">(</span><span class="op" id="6025031">)</span><br>
<span class="lineno">850</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025035">//&nbsp;But&nbsp;for&nbsp;named&nbsp;types&nbsp;(or&nbsp;pointers&nbsp;to&nbsp;them),&nbsp;qualify&nbsp;with&nbsp;import&nbsp;path&nbsp;(but&nbsp;see&nbsp;inner&nbsp;comment).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025132">//&nbsp;Dereference&nbsp;one&nbsp;pointer&nbsp;looking&nbsp;for&nbsp;a&nbsp;named&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6025186">star</span>&nbsp;<span class="op" id="6025191">:=</span>&nbsp;<span class="string" id="6025194">&#34;&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6025198">if</span>&nbsp;<span class="ident" id="6025201">rt</span><span class="op" id="6025203">.</span><span class="ident" id="6025204">Name</span><span class="op" id="6025208">(</span><span class="op" id="6025209">)</span>&nbsp;<span class="op" id="6025211">==</span>&nbsp;<span class="string" id="6025214">&#34;&#34;</span>&nbsp;<span class="op" id="6025217">{</span><br>
<span class="lineno">855</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6025221">if</span>&nbsp;<span class="ident" id="6025224">pt</span>&nbsp;<span class="op" id="6025227">:=</span>&nbsp;<span class="ident" id="6025230">rt</span><span class="op" id="6025232">;</span>&nbsp;<span class="ident" id="6025234">pt</span><span class="op" id="6025236">.</span><span class="ident" id="6025237">Kind</span><span class="op" id="6025241">(</span><span class="op" id="6025242">)</span>&nbsp;<span class="op" id="6025244">==</span>&nbsp;<span class="ident" id="6025247">reflect</span><span class="op" id="6025254">.</span><span class="ident" id="6025255">Ptr</span>&nbsp;<span class="op" id="6025259">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6025264">star</span>&nbsp;<span class="op" id="6025269">=</span>&nbsp;<span class="string" id="6025271">&#34;*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025278">//&nbsp;NOTE:&nbsp;The&nbsp;following&nbsp;line&nbsp;should&nbsp;be&nbsp;rt&nbsp;=&nbsp;pt.Elem()&nbsp;to&nbsp;implement</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025347">//&nbsp;what&nbsp;the&nbsp;comment&nbsp;above&nbsp;claims,&nbsp;but&nbsp;fixing&nbsp;it&nbsp;would&nbsp;break&nbsp;compatibility</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025424">//&nbsp;with&nbsp;existing&nbsp;gobs.</span><br>
<span class="lineno">860</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025450">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025456">//&nbsp;Given&nbsp;package&nbsp;p&nbsp;imported&nbsp;as&nbsp;&#34;full/p&#34;&nbsp;with&nbsp;these&nbsp;definitions:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025523">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;package&nbsp;p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025543">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;type&nbsp;T1&nbsp;struct&nbsp;{&nbsp;...&nbsp;}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025576">//&nbsp;this&nbsp;table&nbsp;shows&nbsp;the&nbsp;intended&nbsp;and&nbsp;actual&nbsp;strings&nbsp;used&nbsp;by&nbsp;gob&nbsp;to</span><br>
<span class="lineno">865</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025646">//&nbsp;name&nbsp;the&nbsp;types:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025668">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025674">//&nbsp;Type&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Correct&nbsp;string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Actual&nbsp;string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025723">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025729">//&nbsp;T1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;full/p.T1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;full/p.T1</span><br>
<span class="lineno">870</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025774">//&nbsp;*T1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*full/p.T1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*p.T1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025815">//</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="6025821">//&nbsp;The&nbsp;missing&nbsp;full&nbsp;path&nbsp;cannot&nbsp;be&nbsp;fixed&nbsp;without&nbsp;breaking&nbsp;existing&nbsp;gob&nbsp;decoders.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6025905">rt</span>&nbsp;<span class="op" id="6025908">=</span>&nbsp;<span class="ident" id="6025910">pt</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6025915">}</span><br>
<span class="lineno">875</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6025918">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6025921">if</span>&nbsp;<span class="ident" id="6025924">rt</span><span class="op" id="6025926">.</span><span class="ident" id="6025927">Name</span><span class="op" id="6025931">(</span><span class="op" id="6025932">)</span>&nbsp;<span class="op" id="6025934">!=</span>&nbsp;<span class="string" id="6025937">&#34;&#34;</span>&nbsp;<span class="op" id="6025940">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6025944">if</span>&nbsp;<span class="ident" id="6025947">rt</span><span class="op" id="6025949">.</span><span class="ident" id="6025950">PkgPath</span><span class="op" id="6025957">(</span><span class="op" id="6025958">)</span>&nbsp;<span class="op" id="6025960">==</span>&nbsp;<span class="string" id="6025963">&#34;&#34;</span>&nbsp;<span class="op" id="6025966">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6025971">name</span>&nbsp;<span class="op" id="6025976">=</span>&nbsp;<span class="ident" id="6025978">star</span>&nbsp;<span class="op" id="6025983">+</span>&nbsp;<span class="ident" id="6025985">rt</span><span class="op" id="6025987">.</span><span class="ident" id="6025988">Name</span><span class="op" id="6025992">(</span><span class="op" id="6025993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6025997">}</span>&nbsp;<span class="keyword" id="6025999">else</span>&nbsp;<span class="op" id="6026004">{</span><br>
<span class="lineno">880</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026009">name</span>&nbsp;<span class="op" id="6026014">=</span>&nbsp;<span class="ident" id="6026016">star</span>&nbsp;<span class="op" id="6026021">+</span>&nbsp;<span class="ident" id="6026023">rt</span><span class="op" id="6026025">.</span><span class="ident" id="6026026">PkgPath</span><span class="op" id="6026033">(</span><span class="op" id="6026034">)</span>&nbsp;<span class="op" id="6026036">+</span>&nbsp;<span class="string" id="6026038">&#34;.&#34;</span>&nbsp;<span class="op" id="6026042">+</span>&nbsp;<span class="ident" id="6026044">rt</span><span class="op" id="6026046">.</span><span class="ident" id="6026047">Name</span><span class="op" id="6026051">(</span><span class="op" id="6026052">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6026056">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6026059">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026063">RegisterName</span><span class="op" id="6026075">(</span><span class="ident" id="6026076">name</span><span class="op" id="6026080">,</span>&nbsp;<span class="ident" id="6026082">value</span><span class="op" id="6026087">)</span><br>
<span class="lineno">885</span><span class="op" id="6026089">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6026092">func</span>&nbsp;<span class="ident" id="6026097">registerBasics</span><span class="op" id="6026111">(</span><span class="op" id="6026112">)</span>&nbsp;<span class="op" id="6026114">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026117">Register</span><span class="op" id="6026125">(</span><span class="builtintype" id="6026126">int</span><span class="op" id="6026129">(</span><span class="num" id="6026130">0</span><span class="op" id="6026131">)</span><span class="op" id="6026132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026135">Register</span><span class="op" id="6026143">(</span><span class="builtintype" id="6026144">int8</span><span class="op" id="6026148">(</span><span class="num" id="6026149">0</span><span class="op" id="6026150">)</span><span class="op" id="6026151">)</span><br>
<span class="lineno">890</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026154">Register</span><span class="op" id="6026162">(</span><span class="builtintype" id="6026163">int16</span><span class="op" id="6026168">(</span><span class="num" id="6026169">0</span><span class="op" id="6026170">)</span><span class="op" id="6026171">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026174">Register</span><span class="op" id="6026182">(</span><span class="builtintype" id="6026183">int32</span><span class="op" id="6026188">(</span><span class="num" id="6026189">0</span><span class="op" id="6026190">)</span><span class="op" id="6026191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026194">Register</span><span class="op" id="6026202">(</span><span class="ident" id="6026203">int64</span><span class="op" id="6026208">(</span><span class="num" id="6026209">0</span><span class="op" id="6026210">)</span><span class="op" id="6026211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026214">Register</span><span class="op" id="6026222">(</span><span class="builtintype" id="6026223">uint</span><span class="op" id="6026227">(</span><span class="num" id="6026228">0</span><span class="op" id="6026229">)</span><span class="op" id="6026230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026233">Register</span><span class="op" id="6026241">(</span><span class="builtintype" id="6026242">uint8</span><span class="op" id="6026247">(</span><span class="num" id="6026248">0</span><span class="op" id="6026249">)</span><span class="op" id="6026250">)</span><br>
<span class="lineno">895</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026253">Register</span><span class="op" id="6026261">(</span><span class="builtintype" id="6026262">uint16</span><span class="op" id="6026268">(</span><span class="num" id="6026269">0</span><span class="op" id="6026270">)</span><span class="op" id="6026271">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026274">Register</span><span class="op" id="6026282">(</span><span class="builtintype" id="6026283">uint32</span><span class="op" id="6026289">(</span><span class="num" id="6026290">0</span><span class="op" id="6026291">)</span><span class="op" id="6026292">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026295">Register</span><span class="op" id="6026303">(</span><span class="ident" id="6026304">uint64</span><span class="op" id="6026310">(</span><span class="num" id="6026311">0</span><span class="op" id="6026312">)</span><span class="op" id="6026313">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026316">Register</span><span class="op" id="6026324">(</span><span class="builtintype" id="6026325">float32</span><span class="op" id="6026332">(</span><span class="num" id="6026333">0</span><span class="op" id="6026334">)</span><span class="op" id="6026335">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026338">Register</span><span class="op" id="6026346">(</span><span class="builtintype" id="6026347">float64</span><span class="op" id="6026354">(</span><span class="num" id="6026355">0</span><span class="op" id="6026356">)</span><span class="op" id="6026357">)</span><br>
<span class="lineno">900</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026360">Register</span><span class="op" id="6026368">(</span><span class="builtintype" id="6026369">complex64</span><span class="op" id="6026378">(</span><span class="num" id="6026379">0i</span><span class="op" id="6026381">)</span><span class="op" id="6026382">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026385">Register</span><span class="op" id="6026393">(</span><span class="builtintype" id="6026394">complex128</span><span class="op" id="6026404">(</span><span class="num" id="6026405">0i</span><span class="op" id="6026407">)</span><span class="op" id="6026408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026411">Register</span><span class="op" id="6026419">(</span><span class="builtintype" id="6026420">uintptr</span><span class="op" id="6026427">(</span><span class="num" id="6026428">0</span><span class="op" id="6026429">)</span><span class="op" id="6026430">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026433">Register</span><span class="op" id="6026441">(</span><span class="builtintype" id="6026442">false</span><span class="op" id="6026447">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026450">Register</span><span class="op" id="6026458">(</span><span class="string" id="6026459">&#34;&#34;</span><span class="op" id="6026461">)</span><br>
<span class="lineno">905</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026464">Register</span><span class="op" id="6026472">(</span><span class="op" id="6026473">[</span><span class="op" id="6026474">]</span><span class="builtintype" id="6026475">byte</span><span class="op" id="6026479">(</span><span class="ident" id="6026480">nil</span><span class="op" id="6026483">)</span><span class="op" id="6026484">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026487">Register</span><span class="op" id="6026495">(</span><span class="op" id="6026496">[</span><span class="op" id="6026497">]</span><span class="builtintype" id="6026498">int</span><span class="op" id="6026501">(</span><span class="ident" id="6026502">nil</span><span class="op" id="6026505">)</span><span class="op" id="6026506">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026509">Register</span><span class="op" id="6026517">(</span><span class="op" id="6026518">[</span><span class="op" id="6026519">]</span><span class="builtintype" id="6026520">int8</span><span class="op" id="6026524">(</span><span class="ident" id="6026525">nil</span><span class="op" id="6026528">)</span><span class="op" id="6026529">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026532">Register</span><span class="op" id="6026540">(</span><span class="op" id="6026541">[</span><span class="op" id="6026542">]</span><span class="builtintype" id="6026543">int16</span><span class="op" id="6026548">(</span><span class="ident" id="6026549">nil</span><span class="op" id="6026552">)</span><span class="op" id="6026553">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026556">Register</span><span class="op" id="6026564">(</span><span class="op" id="6026565">[</span><span class="op" id="6026566">]</span><span class="builtintype" id="6026567">int32</span><span class="op" id="6026572">(</span><span class="ident" id="6026573">nil</span><span class="op" id="6026576">)</span><span class="op" id="6026577">)</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026580">Register</span><span class="op" id="6026588">(</span><span class="op" id="6026589">[</span><span class="op" id="6026590">]</span><span class="ident" id="6026591">int64</span><span class="op" id="6026596">(</span><span class="ident" id="6026597">nil</span><span class="op" id="6026600">)</span><span class="op" id="6026601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026604">Register</span><span class="op" id="6026612">(</span><span class="op" id="6026613">[</span><span class="op" id="6026614">]</span><span class="builtintype" id="6026615">uint</span><span class="op" id="6026619">(</span><span class="ident" id="6026620">nil</span><span class="op" id="6026623">)</span><span class="op" id="6026624">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026627">Register</span><span class="op" id="6026635">(</span><span class="op" id="6026636">[</span><span class="op" id="6026637">]</span><span class="builtintype" id="6026638">uint8</span><span class="op" id="6026643">(</span><span class="ident" id="6026644">nil</span><span class="op" id="6026647">)</span><span class="op" id="6026648">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026651">Register</span><span class="op" id="6026659">(</span><span class="op" id="6026660">[</span><span class="op" id="6026661">]</span><span class="builtintype" id="6026662">uint16</span><span class="op" id="6026668">(</span><span class="ident" id="6026669">nil</span><span class="op" id="6026672">)</span><span class="op" id="6026673">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026676">Register</span><span class="op" id="6026684">(</span><span class="op" id="6026685">[</span><span class="op" id="6026686">]</span><span class="builtintype" id="6026687">uint32</span><span class="op" id="6026693">(</span><span class="ident" id="6026694">nil</span><span class="op" id="6026697">)</span><span class="op" id="6026698">)</span><br>
<span class="lineno">915</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026701">Register</span><span class="op" id="6026709">(</span><span class="op" id="6026710">[</span><span class="op" id="6026711">]</span><span class="ident" id="6026712">uint64</span><span class="op" id="6026718">(</span><span class="ident" id="6026719">nil</span><span class="op" id="6026722">)</span><span class="op" id="6026723">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026726">Register</span><span class="op" id="6026734">(</span><span class="op" id="6026735">[</span><span class="op" id="6026736">]</span><span class="builtintype" id="6026737">float32</span><span class="op" id="6026744">(</span><span class="ident" id="6026745">nil</span><span class="op" id="6026748">)</span><span class="op" id="6026749">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026752">Register</span><span class="op" id="6026760">(</span><span class="op" id="6026761">[</span><span class="op" id="6026762">]</span><span class="builtintype" id="6026763">float64</span><span class="op" id="6026770">(</span><span class="ident" id="6026771">nil</span><span class="op" id="6026774">)</span><span class="op" id="6026775">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026778">Register</span><span class="op" id="6026786">(</span><span class="op" id="6026787">[</span><span class="op" id="6026788">]</span><span class="builtintype" id="6026789">complex64</span><span class="op" id="6026798">(</span><span class="ident" id="6026799">nil</span><span class="op" id="6026802">)</span><span class="op" id="6026803">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026806">Register</span><span class="op" id="6026814">(</span><span class="op" id="6026815">[</span><span class="op" id="6026816">]</span><span class="builtintype" id="6026817">complex128</span><span class="op" id="6026827">(</span><span class="ident" id="6026828">nil</span><span class="op" id="6026831">)</span><span class="op" id="6026832">)</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026835">Register</span><span class="op" id="6026843">(</span><span class="op" id="6026844">[</span><span class="op" id="6026845">]</span><span class="builtintype" id="6026846">uintptr</span><span class="op" id="6026853">(</span><span class="ident" id="6026854">nil</span><span class="op" id="6026857">)</span><span class="op" id="6026858">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026861">Register</span><span class="op" id="6026869">(</span><span class="op" id="6026870">[</span><span class="op" id="6026871">]</span><span class="builtintype" id="6026872">bool</span><span class="op" id="6026876">(</span><span class="ident" id="6026877">nil</span><span class="op" id="6026880">)</span><span class="op" id="6026881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6026884">Register</span><span class="op" id="6026892">(</span><span class="op" id="6026893">[</span><span class="op" id="6026894">]</span><span class="builtintype" id="6026895">string</span><span class="op" id="6026901">(</span><span class="ident" id="6026902">nil</span><span class="op" id="6026905">)</span><span class="op" id="6026906">)</span><br>
<span class="lineno"></span><span class="op" id="6026908">}</span>
</div>
</body>
</html>
