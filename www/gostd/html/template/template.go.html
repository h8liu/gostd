<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4613867">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4613922">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4613976">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="4614027">package</span>&nbsp;<span class="ident" id="4614035">template</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4614045">import</span>&nbsp;<span class="op" id="4614052">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4614055">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4614062">&#34;io&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4614068">&#34;io/ioutil&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4614081">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4614098">&#34;sync&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4614106">&#34;text/template&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4614123">&#34;text/template/parse&#34;</span><br>
<span class="lineno">15</span><span class="op" id="4614145">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4614148">//&nbsp;Template&nbsp;is&nbsp;a&nbsp;specialized&nbsp;Template&nbsp;from&nbsp;&#34;text/template&#34;&nbsp;that&nbsp;produces&nbsp;a&nbsp;safe</span><br>
<span class="lineno"></span><span class="comment" id="4614228">//&nbsp;HTML&nbsp;document&nbsp;fragment.</span><br>
<span class="lineno"></span><span class="keyword" id="4614255">type</span>&nbsp;<span class="ident" id="4614260">Template</span>&nbsp;<span class="keyword" id="4614269">struct</span>&nbsp;<span class="op" id="4614276">{</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4614279">//&nbsp;Sticky&nbsp;error&nbsp;if&nbsp;escaping&nbsp;fails.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4614315">escapeErr</span>&nbsp;<span class="builtintype" id="4614325">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4614332">//&nbsp;We&nbsp;could&nbsp;embed&nbsp;the&nbsp;text/template&nbsp;field,&nbsp;but&nbsp;it&#39;s&nbsp;safer&nbsp;not&nbsp;to&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4614406">//&nbsp;we&nbsp;need&nbsp;to&nbsp;keep&nbsp;our&nbsp;version&nbsp;of&nbsp;the&nbsp;name&nbsp;space&nbsp;and&nbsp;the&nbsp;underlying</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4614475">//&nbsp;template&#39;s&nbsp;in&nbsp;sync.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4614499">text</span>&nbsp;<span class="op" id="4614504">*</span><span class="ident" id="4614505">template</span><span class="op" id="4614513">.</span><span class="ident" id="4614514">Template</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4614524">//&nbsp;The&nbsp;underlying&nbsp;template&#39;s&nbsp;parse&nbsp;tree,&nbsp;updated&nbsp;to&nbsp;be&nbsp;HTML-safe.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4614591">Tree</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4614602">*</span><span class="ident" id="4614603">parse</span><span class="op" id="4614608">.</span><span class="ident" id="4614609">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4614615">*</span><span class="ident" id="4614616">nameSpace</span>&nbsp;<span class="comment" id="4614626">//&nbsp;common&nbsp;to&nbsp;all&nbsp;associated&nbsp;templates</span><br>
<span class="lineno"></span><span class="op" id="4614664">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="comment" id="4614667">//&nbsp;escapeOK&nbsp;is&nbsp;a&nbsp;sentinel&nbsp;value&nbsp;used&nbsp;to&nbsp;indicate&nbsp;valid&nbsp;escaping.</span><br>
<span class="lineno"></span><span class="keyword" id="4614732">var</span>&nbsp;<span class="ident" id="4614736">escapeOK</span>&nbsp;<span class="op" id="4614745">=</span>&nbsp;<span class="ident" id="4614747">fmt</span><span class="op" id="4614750">.</span><span class="ident" id="4614751">Errorf</span><span class="op" id="4614757">(</span><span class="string" id="4614758">&#34;template&nbsp;escaped&nbsp;correctly&#34;</span><span class="op" id="4614786">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4614789">//&nbsp;nameSpace&nbsp;is&nbsp;the&nbsp;data&nbsp;structure&nbsp;shared&nbsp;by&nbsp;all&nbsp;templates&nbsp;in&nbsp;an&nbsp;association.</span><br>
<span class="lineno">35</span><span class="keyword" id="4614867">type</span>&nbsp;<span class="ident" id="4614872">nameSpace</span>&nbsp;<span class="keyword" id="4614882">struct</span>&nbsp;<span class="op" id="4614889">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4614892">mu</span>&nbsp;&nbsp;<span class="ident" id="4614896">sync</span><span class="op" id="4614900">.</span><span class="ident" id="4614901">Mutex</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4614908">set</span>&nbsp;<span class="keyword" id="4614912">map</span><span class="op" id="4614915">[</span><span class="builtintype" id="4614916">string</span><span class="op" id="4614922">]</span><span class="op" id="4614923">*</span><span class="ident" id="4614924">Template</span><br>
<span class="lineno"></span><span class="op" id="4614933">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="4614936">//&nbsp;Templates&nbsp;returns&nbsp;a&nbsp;slice&nbsp;of&nbsp;the&nbsp;templates&nbsp;associated&nbsp;with&nbsp;t,&nbsp;including&nbsp;t</span><br>
<span class="lineno"></span><span class="comment" id="4615013">//&nbsp;itself.</span><br>
<span class="lineno"></span><span class="keyword" id="4615024">func</span>&nbsp;<span class="op" id="4615029">(</span><span class="ident" id="4615030">t</span>&nbsp;<span class="op" id="4615032">*</span><span class="ident" id="4615033">Template</span><span class="op" id="4615041">)</span>&nbsp;<span class="ident" id="4615043">Templates</span><span class="op" id="4615052">(</span><span class="op" id="4615053">)</span>&nbsp;<span class="op" id="4615055">[</span><span class="op" id="4615056">]</span><span class="op" id="4615057">*</span><span class="ident" id="4615058">Template</span>&nbsp;<span class="op" id="4615067">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4615070">ns</span>&nbsp;<span class="op" id="4615073">:=</span>&nbsp;<span class="ident" id="4615076">t</span><span class="op" id="4615077">.</span><span class="ident" id="4615078">nameSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4615089">ns</span><span class="op" id="4615091">.</span><span class="ident" id="4615092">mu</span><span class="op" id="4615094">.</span><span class="ident" id="4615095">Lock</span><span class="op" id="4615099">(</span><span class="op" id="4615100">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4615103">defer</span>&nbsp;<span class="ident" id="4615109">ns</span><span class="op" id="4615111">.</span><span class="ident" id="4615112">mu</span><span class="op" id="4615114">.</span><span class="ident" id="4615115">Unlock</span><span class="op" id="4615121">(</span><span class="op" id="4615122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4615125">//&nbsp;Return&nbsp;a&nbsp;slice&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;expose&nbsp;the&nbsp;map.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4615172">m</span>&nbsp;<span class="op" id="4615174">:=</span>&nbsp;<span class="builtinfunc" id="4615177">make</span><span class="op" id="4615181">(</span><span class="op" id="4615182">[</span><span class="op" id="4615183">]</span><span class="op" id="4615184">*</span><span class="ident" id="4615185">Template</span><span class="op" id="4615193">,</span>&nbsp;<span class="num" id="4615195">0</span><span class="op" id="4615196">,</span>&nbsp;<span class="builtinfunc" id="4615198">len</span><span class="op" id="4615201">(</span><span class="ident" id="4615202">ns</span><span class="op" id="4615204">.</span><span class="ident" id="4615205">set</span><span class="op" id="4615208">)</span><span class="op" id="4615209">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4615212">for</span>&nbsp;<span class="ident" id="4615216">_</span><span class="op" id="4615217">,</span>&nbsp;<span class="ident" id="4615219">v</span>&nbsp;<span class="op" id="4615221">:=</span>&nbsp;<span class="keyword" id="4615224">range</span>&nbsp;<span class="ident" id="4615230">ns</span><span class="op" id="4615232">.</span><span class="ident" id="4615233">set</span>&nbsp;<span class="op" id="4615237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4615241">m</span>&nbsp;<span class="op" id="4615243">=</span>&nbsp;<span class="builtinfunc" id="4615245">append</span><span class="op" id="4615251">(</span><span class="ident" id="4615252">m</span><span class="op" id="4615253">,</span>&nbsp;<span class="ident" id="4615255">v</span><span class="op" id="4615256">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4615259">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4615262">return</span>&nbsp;<span class="ident" id="4615269">m</span><br>
<span class="lineno"></span><span class="op" id="4615271">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4615274">//&nbsp;escape&nbsp;escapes&nbsp;all&nbsp;associated&nbsp;templates.</span><br>
<span class="lineno">55</span><span class="keyword" id="4615318">func</span>&nbsp;<span class="op" id="4615323">(</span><span class="ident" id="4615324">t</span>&nbsp;<span class="op" id="4615326">*</span><span class="ident" id="4615327">Template</span><span class="op" id="4615335">)</span>&nbsp;<span class="ident" id="4615337">escape</span><span class="op" id="4615343">(</span><span class="op" id="4615344">)</span>&nbsp;<span class="builtintype" id="4615346">error</span>&nbsp;<span class="op" id="4615352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4615355">t</span><span class="op" id="4615356">.</span><span class="ident" id="4615357">nameSpace</span><span class="op" id="4615366">.</span><span class="ident" id="4615367">mu</span><span class="op" id="4615369">.</span><span class="ident" id="4615370">Lock</span><span class="op" id="4615374">(</span><span class="op" id="4615375">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4615378">defer</span>&nbsp;<span class="ident" id="4615384">t</span><span class="op" id="4615385">.</span><span class="ident" id="4615386">nameSpace</span><span class="op" id="4615395">.</span><span class="ident" id="4615396">mu</span><span class="op" id="4615398">.</span><span class="ident" id="4615399">Unlock</span><span class="op" id="4615405">(</span><span class="op" id="4615406">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4615409">if</span>&nbsp;<span class="ident" id="4615412">t</span><span class="op" id="4615413">.</span><span class="ident" id="4615414">escapeErr</span>&nbsp;<span class="op" id="4615424">==</span>&nbsp;<span class="ident" id="4615427">nil</span>&nbsp;<span class="op" id="4615431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4615435">if</span>&nbsp;<span class="ident" id="4615438">err</span>&nbsp;<span class="op" id="4615442">:=</span>&nbsp;<span class="ident" id="4615445">escapeTemplate</span><span class="op" id="4615459">(</span><span class="ident" id="4615460">t</span><span class="op" id="4615461">,</span>&nbsp;<span class="ident" id="4615463">t</span><span class="op" id="4615464">.</span><span class="ident" id="4615465">text</span><span class="op" id="4615469">.</span><span class="ident" id="4615470">Root</span><span class="op" id="4615474">,</span>&nbsp;<span class="ident" id="4615476">t</span><span class="op" id="4615477">.</span><span class="ident" id="4615478">Name</span><span class="op" id="4615482">(</span><span class="op" id="4615483">)</span><span class="op" id="4615484">)</span><span class="op" id="4615485">;</span>&nbsp;<span class="ident" id="4615487">err</span>&nbsp;<span class="op" id="4615491">!=</span>&nbsp;<span class="ident" id="4615494">nil</span>&nbsp;<span class="op" id="4615498">{</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4615503">return</span>&nbsp;<span class="ident" id="4615510">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4615516">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4615519">}</span>&nbsp;<span class="keyword" id="4615521">else</span>&nbsp;<span class="keyword" id="4615526">if</span>&nbsp;<span class="ident" id="4615529">t</span><span class="op" id="4615530">.</span><span class="ident" id="4615531">escapeErr</span>&nbsp;<span class="op" id="4615541">!=</span>&nbsp;<span class="ident" id="4615544">escapeOK</span>&nbsp;<span class="op" id="4615553">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4615557">return</span>&nbsp;<span class="ident" id="4615564">t</span><span class="op" id="4615565">.</span><span class="ident" id="4615566">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4615577">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4615580">return</span>&nbsp;<span class="ident" id="4615587">nil</span><br>
<span class="lineno"></span><span class="op" id="4615591">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4615594">//&nbsp;Execute&nbsp;applies&nbsp;a&nbsp;parsed&nbsp;template&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object,</span><br>
<span class="lineno"></span><span class="comment" id="4615661">//&nbsp;writing&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno">70</span><span class="comment" id="4615690">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="4615758">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4615831">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="4615853">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="4615903">func</span>&nbsp;<span class="op" id="4615908">(</span><span class="ident" id="4615909">t</span>&nbsp;<span class="op" id="4615911">*</span><span class="ident" id="4615912">Template</span><span class="op" id="4615920">)</span>&nbsp;<span class="ident" id="4615922">Execute</span><span class="op" id="4615929">(</span><span class="ident" id="4615930">wr</span>&nbsp;<span class="ident" id="4615933">io</span><span class="op" id="4615935">.</span><span class="ident" id="4615936">Writer</span><span class="op" id="4615942">,</span>&nbsp;<span class="ident" id="4615944">data</span>&nbsp;<span class="keyword" id="4615949">interface</span><span class="op" id="4615958">{</span><span class="op" id="4615959">}</span><span class="op" id="4615960">)</span>&nbsp;<span class="builtintype" id="4615962">error</span>&nbsp;<span class="op" id="4615968">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4615971">if</span>&nbsp;<span class="ident" id="4615974">err</span>&nbsp;<span class="op" id="4615978">:=</span>&nbsp;<span class="ident" id="4615981">t</span><span class="op" id="4615982">.</span><span class="ident" id="4615983">escape</span><span class="op" id="4615989">(</span><span class="op" id="4615990">)</span><span class="op" id="4615991">;</span>&nbsp;<span class="ident" id="4615993">err</span>&nbsp;<span class="op" id="4615997">!=</span>&nbsp;<span class="ident" id="4616000">nil</span>&nbsp;<span class="op" id="4616004">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4616008">return</span>&nbsp;<span class="ident" id="4616015">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4616020">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4616023">return</span>&nbsp;<span class="ident" id="4616030">t</span><span class="op" id="4616031">.</span><span class="ident" id="4616032">text</span><span class="op" id="4616036">.</span><span class="ident" id="4616037">Execute</span><span class="op" id="4616044">(</span><span class="ident" id="4616045">wr</span><span class="op" id="4616047">,</span>&nbsp;<span class="ident" id="4616049">data</span><span class="op" id="4616053">)</span><br>
<span class="lineno"></span><span class="op" id="4616055">}</span><br>
<span class="lineno">80</span><br>
<span class="lineno"></span><span class="comment" id="4616058">//&nbsp;ExecuteTemplate&nbsp;applies&nbsp;the&nbsp;template&nbsp;associated&nbsp;with&nbsp;t&nbsp;that&nbsp;has&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4616135">//&nbsp;name&nbsp;to&nbsp;the&nbsp;specified&nbsp;data&nbsp;object&nbsp;and&nbsp;writes&nbsp;the&nbsp;output&nbsp;to&nbsp;wr.</span><br>
<span class="lineno"></span><span class="comment" id="4616201">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs&nbsp;executing&nbsp;the&nbsp;template&nbsp;or&nbsp;writing&nbsp;its&nbsp;output,</span><br>
<span class="lineno"></span><span class="comment" id="4616269">//&nbsp;execution&nbsp;stops,&nbsp;but&nbsp;partial&nbsp;results&nbsp;may&nbsp;already&nbsp;have&nbsp;been&nbsp;written&nbsp;to</span><br>
<span class="lineno">85</span><span class="comment" id="4616342">//&nbsp;the&nbsp;output&nbsp;writer.</span><br>
<span class="lineno"></span><span class="comment" id="4616364">//&nbsp;A&nbsp;template&nbsp;may&nbsp;be&nbsp;executed&nbsp;safely&nbsp;in&nbsp;parallel.</span><br>
<span class="lineno"></span><span class="keyword" id="4616414">func</span>&nbsp;<span class="op" id="4616419">(</span><span class="ident" id="4616420">t</span>&nbsp;<span class="op" id="4616422">*</span><span class="ident" id="4616423">Template</span><span class="op" id="4616431">)</span>&nbsp;<span class="ident" id="4616433">ExecuteTemplate</span><span class="op" id="4616448">(</span><span class="ident" id="4616449">wr</span>&nbsp;<span class="ident" id="4616452">io</span><span class="op" id="4616454">.</span><span class="ident" id="4616455">Writer</span><span class="op" id="4616461">,</span>&nbsp;<span class="ident" id="4616463">name</span>&nbsp;<span class="builtintype" id="4616468">string</span><span class="op" id="4616474">,</span>&nbsp;<span class="ident" id="4616476">data</span>&nbsp;<span class="keyword" id="4616481">interface</span><span class="op" id="4616490">{</span><span class="op" id="4616491">}</span><span class="op" id="4616492">)</span>&nbsp;<span class="builtintype" id="4616494">error</span>&nbsp;<span class="op" id="4616500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4616503">tmpl</span><span class="op" id="4616507">,</span>&nbsp;<span class="ident" id="4616509">err</span>&nbsp;<span class="op" id="4616513">:=</span>&nbsp;<span class="ident" id="4616516">t</span><span class="op" id="4616517">.</span><span class="ident" id="4616518">lookupAndEscapeTemplate</span><span class="op" id="4616541">(</span><span class="ident" id="4616542">name</span><span class="op" id="4616546">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4616549">if</span>&nbsp;<span class="ident" id="4616552">err</span>&nbsp;<span class="op" id="4616556">!=</span>&nbsp;<span class="ident" id="4616559">nil</span>&nbsp;<span class="op" id="4616563">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4616567">return</span>&nbsp;<span class="ident" id="4616574">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4616579">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4616582">return</span>&nbsp;<span class="ident" id="4616589">tmpl</span><span class="op" id="4616593">.</span><span class="ident" id="4616594">text</span><span class="op" id="4616598">.</span><span class="ident" id="4616599">Execute</span><span class="op" id="4616606">(</span><span class="ident" id="4616607">wr</span><span class="op" id="4616609">,</span>&nbsp;<span class="ident" id="4616611">data</span><span class="op" id="4616615">)</span><br>
<span class="lineno"></span><span class="op" id="4616617">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="comment" id="4616620">//&nbsp;lookupAndEscapeTemplate&nbsp;guarantees&nbsp;that&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name</span><br>
<span class="lineno"></span><span class="comment" id="4616696">//&nbsp;is&nbsp;escaped,&nbsp;or&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;it&nbsp;cannot&nbsp;be.&nbsp;It&nbsp;returns&nbsp;the&nbsp;named</span><br>
<span class="lineno"></span><span class="comment" id="4616769">//&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="4616782">func</span>&nbsp;<span class="op" id="4616787">(</span><span class="ident" id="4616788">t</span>&nbsp;<span class="op" id="4616790">*</span><span class="ident" id="4616791">Template</span><span class="op" id="4616799">)</span>&nbsp;<span class="ident" id="4616801">lookupAndEscapeTemplate</span><span class="op" id="4616824">(</span><span class="ident" id="4616825">name</span>&nbsp;<span class="builtintype" id="4616830">string</span><span class="op" id="4616836">)</span>&nbsp;<span class="op" id="4616838">(</span><span class="ident" id="4616839">tmpl</span>&nbsp;<span class="op" id="4616844">*</span><span class="ident" id="4616845">Template</span><span class="op" id="4616853">,</span>&nbsp;<span class="ident" id="4616855">err</span>&nbsp;<span class="builtintype" id="4616859">error</span><span class="op" id="4616864">)</span>&nbsp;<span class="op" id="4616866">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4616869">t</span><span class="op" id="4616870">.</span><span class="ident" id="4616871">nameSpace</span><span class="op" id="4616880">.</span><span class="ident" id="4616881">mu</span><span class="op" id="4616883">.</span><span class="ident" id="4616884">Lock</span><span class="op" id="4616888">(</span><span class="op" id="4616889">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4616892">defer</span>&nbsp;<span class="ident" id="4616898">t</span><span class="op" id="4616899">.</span><span class="ident" id="4616900">nameSpace</span><span class="op" id="4616909">.</span><span class="ident" id="4616910">mu</span><span class="op" id="4616912">.</span><span class="ident" id="4616913">Unlock</span><span class="op" id="4616919">(</span><span class="op" id="4616920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4616923">tmpl</span>&nbsp;<span class="op" id="4616928">=</span>&nbsp;<span class="ident" id="4616930">t</span><span class="op" id="4616931">.</span><span class="ident" id="4616932">set</span><span class="op" id="4616935">[</span><span class="ident" id="4616936">name</span><span class="op" id="4616940">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4616943">if</span>&nbsp;<span class="ident" id="4616946">tmpl</span>&nbsp;<span class="op" id="4616951">==</span>&nbsp;<span class="ident" id="4616954">nil</span>&nbsp;<span class="op" id="4616958">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4616962">return</span>&nbsp;<span class="ident" id="4616969">nil</span><span class="op" id="4616972">,</span>&nbsp;<span class="ident" id="4616974">fmt</span><span class="op" id="4616977">.</span><span class="ident" id="4616978">Errorf</span><span class="op" id="4616984">(</span><span class="string" id="4616985">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;undefined&#34;</span><span class="op" id="4617017">,</span>&nbsp;<span class="ident" id="4617019">name</span><span class="op" id="4617023">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4617026">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4617029">if</span>&nbsp;<span class="ident" id="4617032">tmpl</span><span class="op" id="4617036">.</span><span class="ident" id="4617037">escapeErr</span>&nbsp;<span class="op" id="4617047">!=</span>&nbsp;<span class="ident" id="4617050">nil</span>&nbsp;<span class="op" id="4617054">&amp;&amp;</span>&nbsp;<span class="ident" id="4617057">tmpl</span><span class="op" id="4617061">.</span><span class="ident" id="4617062">escapeErr</span>&nbsp;<span class="op" id="4617072">!=</span>&nbsp;<span class="ident" id="4617075">escapeOK</span>&nbsp;<span class="op" id="4617084">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4617088">return</span>&nbsp;<span class="ident" id="4617095">nil</span><span class="op" id="4617098">,</span>&nbsp;<span class="ident" id="4617100">tmpl</span><span class="op" id="4617104">.</span><span class="ident" id="4617105">escapeErr</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4617116">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4617119">if</span>&nbsp;<span class="ident" id="4617122">tmpl</span><span class="op" id="4617126">.</span><span class="ident" id="4617127">text</span><span class="op" id="4617131">.</span><span class="ident" id="4617132">Tree</span>&nbsp;<span class="op" id="4617137">==</span>&nbsp;<span class="ident" id="4617140">nil</span>&nbsp;<span class="op" id="4617144">||</span>&nbsp;<span class="ident" id="4617147">tmpl</span><span class="op" id="4617151">.</span><span class="ident" id="4617152">text</span><span class="op" id="4617156">.</span><span class="ident" id="4617157">Root</span>&nbsp;<span class="op" id="4617162">==</span>&nbsp;<span class="ident" id="4617165">nil</span>&nbsp;<span class="op" id="4617169">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4617173">return</span>&nbsp;<span class="ident" id="4617180">nil</span><span class="op" id="4617183">,</span>&nbsp;<span class="ident" id="4617185">fmt</span><span class="op" id="4617188">.</span><span class="ident" id="4617189">Errorf</span><span class="op" id="4617195">(</span><span class="string" id="4617196">&#34;html/template:&nbsp;%q&nbsp;is&nbsp;an&nbsp;incomplete&nbsp;template&#34;</span><span class="op" id="4617241">,</span>&nbsp;<span class="ident" id="4617243">name</span><span class="op" id="4617247">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4617250">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4617253">if</span>&nbsp;<span class="ident" id="4617256">t</span><span class="op" id="4617257">.</span><span class="ident" id="4617258">text</span><span class="op" id="4617262">.</span><span class="ident" id="4617263">Lookup</span><span class="op" id="4617269">(</span><span class="ident" id="4617270">name</span><span class="op" id="4617274">)</span>&nbsp;<span class="op" id="4617276">==</span>&nbsp;<span class="ident" id="4617279">nil</span>&nbsp;<span class="op" id="4617283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4617287">panic</span><span class="op" id="4617292">(</span><span class="string" id="4617293">&#34;html/template&nbsp;internal&nbsp;error:&nbsp;template&nbsp;escaping&nbsp;out&nbsp;of&nbsp;sync&#34;</span><span class="op" id="4617354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4617357">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4617360">if</span>&nbsp;<span class="ident" id="4617363">tmpl</span><span class="op" id="4617367">.</span><span class="ident" id="4617368">escapeErr</span>&nbsp;<span class="op" id="4617378">==</span>&nbsp;<span class="ident" id="4617381">nil</span>&nbsp;<span class="op" id="4617385">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4617389">err</span>&nbsp;<span class="op" id="4617393">=</span>&nbsp;<span class="ident" id="4617395">escapeTemplate</span><span class="op" id="4617409">(</span><span class="ident" id="4617410">tmpl</span><span class="op" id="4617414">,</span>&nbsp;<span class="ident" id="4617416">tmpl</span><span class="op" id="4617420">.</span><span class="ident" id="4617421">text</span><span class="op" id="4617425">.</span><span class="ident" id="4617426">Root</span><span class="op" id="4617430">,</span>&nbsp;<span class="ident" id="4617432">name</span><span class="op" id="4617436">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4617439">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4617442">return</span>&nbsp;<span class="ident" id="4617449">tmpl</span><span class="op" id="4617453">,</span>&nbsp;<span class="ident" id="4617455">err</span><br>
<span class="lineno"></span><span class="op" id="4617459">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="comment" id="4617462">//&nbsp;Parse&nbsp;parses&nbsp;a&nbsp;string&nbsp;into&nbsp;a&nbsp;template.&nbsp;Nested&nbsp;template&nbsp;definitions</span><br>
<span class="lineno"></span><span class="comment" id="4617532">//&nbsp;will&nbsp;be&nbsp;associated&nbsp;with&nbsp;the&nbsp;top-level&nbsp;template&nbsp;t.&nbsp;Parse&nbsp;may&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4617598">//&nbsp;called&nbsp;multiple&nbsp;times&nbsp;to&nbsp;parse&nbsp;definitions&nbsp;of&nbsp;templates&nbsp;to&nbsp;associate</span><br>
<span class="lineno"></span><span class="comment" id="4617670">//&nbsp;with&nbsp;t.&nbsp;It&nbsp;is&nbsp;an&nbsp;error&nbsp;if&nbsp;a&nbsp;resulting&nbsp;template&nbsp;is&nbsp;non-empty&nbsp;(contains</span><br>
<span class="lineno"></span><span class="comment" id="4617743">//&nbsp;content&nbsp;other&nbsp;than&nbsp;template&nbsp;definitions)&nbsp;and&nbsp;would&nbsp;replace&nbsp;a</span><br>
<span class="lineno">125</span><span class="comment" id="4617807">//&nbsp;non-empty&nbsp;template&nbsp;with&nbsp;the&nbsp;same&nbsp;name.&nbsp;&nbsp;(In&nbsp;multiple&nbsp;calls&nbsp;to&nbsp;Parse</span><br>
<span class="lineno"></span><span class="comment" id="4617878">//&nbsp;with&nbsp;the&nbsp;same&nbsp;receiver&nbsp;template,&nbsp;only&nbsp;one&nbsp;call&nbsp;can&nbsp;contain&nbsp;text</span><br>
<span class="lineno"></span><span class="comment" id="4617945">//&nbsp;other&nbsp;than&nbsp;space,&nbsp;comments,&nbsp;and&nbsp;template&nbsp;definitions.)</span><br>
<span class="lineno"></span><span class="keyword" id="4618003">func</span>&nbsp;<span class="op" id="4618008">(</span><span class="ident" id="4618009">t</span>&nbsp;<span class="op" id="4618011">*</span><span class="ident" id="4618012">Template</span><span class="op" id="4618020">)</span>&nbsp;<span class="ident" id="4618022">Parse</span><span class="op" id="4618027">(</span><span class="ident" id="4618028">src</span>&nbsp;<span class="builtintype" id="4618032">string</span><span class="op" id="4618038">)</span>&nbsp;<span class="op" id="4618040">(</span><span class="op" id="4618041">*</span><span class="ident" id="4618042">Template</span><span class="op" id="4618050">,</span>&nbsp;<span class="builtintype" id="4618052">error</span><span class="op" id="4618057">)</span>&nbsp;<span class="op" id="4618059">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618062">t</span><span class="op" id="4618063">.</span><span class="ident" id="4618064">nameSpace</span><span class="op" id="4618073">.</span><span class="ident" id="4618074">mu</span><span class="op" id="4618076">.</span><span class="ident" id="4618077">Lock</span><span class="op" id="4618081">(</span><span class="op" id="4618082">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618085">t</span><span class="op" id="4618086">.</span><span class="ident" id="4618087">escapeErr</span>&nbsp;<span class="op" id="4618097">=</span>&nbsp;<span class="ident" id="4618099">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618104">t</span><span class="op" id="4618105">.</span><span class="ident" id="4618106">nameSpace</span><span class="op" id="4618115">.</span><span class="ident" id="4618116">mu</span><span class="op" id="4618118">.</span><span class="ident" id="4618119">Unlock</span><span class="op" id="4618125">(</span><span class="op" id="4618126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618129">ret</span><span class="op" id="4618132">,</span>&nbsp;<span class="ident" id="4618134">err</span>&nbsp;<span class="op" id="4618138">:=</span>&nbsp;<span class="ident" id="4618141">t</span><span class="op" id="4618142">.</span><span class="ident" id="4618143">text</span><span class="op" id="4618147">.</span><span class="ident" id="4618148">Parse</span><span class="op" id="4618153">(</span><span class="ident" id="4618154">src</span><span class="op" id="4618157">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4618160">if</span>&nbsp;<span class="ident" id="4618163">err</span>&nbsp;<span class="op" id="4618167">!=</span>&nbsp;<span class="ident" id="4618170">nil</span>&nbsp;<span class="op" id="4618174">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4618178">return</span>&nbsp;<span class="ident" id="4618185">nil</span><span class="op" id="4618188">,</span>&nbsp;<span class="ident" id="4618190">err</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4618195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4618198">//&nbsp;In&nbsp;general,&nbsp;all&nbsp;the&nbsp;named&nbsp;templates&nbsp;might&nbsp;have&nbsp;changed&nbsp;underfoot.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4618268">//&nbsp;Regardless,&nbsp;some&nbsp;new&nbsp;ones&nbsp;may&nbsp;have&nbsp;been&nbsp;defined.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4618321">//&nbsp;The&nbsp;template.Template&nbsp;set&nbsp;has&nbsp;been&nbsp;updated;&nbsp;update&nbsp;ours.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618382">t</span><span class="op" id="4618383">.</span><span class="ident" id="4618384">nameSpace</span><span class="op" id="4618393">.</span><span class="ident" id="4618394">mu</span><span class="op" id="4618396">.</span><span class="ident" id="4618397">Lock</span><span class="op" id="4618401">(</span><span class="op" id="4618402">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4618405">defer</span>&nbsp;<span class="ident" id="4618411">t</span><span class="op" id="4618412">.</span><span class="ident" id="4618413">nameSpace</span><span class="op" id="4618422">.</span><span class="ident" id="4618423">mu</span><span class="op" id="4618425">.</span><span class="ident" id="4618426">Unlock</span><span class="op" id="4618432">(</span><span class="op" id="4618433">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4618436">for</span>&nbsp;<span class="ident" id="4618440">_</span><span class="op" id="4618441">,</span>&nbsp;<span class="ident" id="4618443">v</span>&nbsp;<span class="op" id="4618445">:=</span>&nbsp;<span class="keyword" id="4618448">range</span>&nbsp;<span class="ident" id="4618454">ret</span><span class="op" id="4618457">.</span><span class="ident" id="4618458">Templates</span><span class="op" id="4618467">(</span><span class="op" id="4618468">)</span>&nbsp;<span class="op" id="4618470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618474">name</span>&nbsp;<span class="op" id="4618479">:=</span>&nbsp;<span class="ident" id="4618482">v</span><span class="op" id="4618483">.</span><span class="ident" id="4618484">Name</span><span class="op" id="4618488">(</span><span class="op" id="4618489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618493">tmpl</span>&nbsp;<span class="op" id="4618498">:=</span>&nbsp;<span class="ident" id="4618501">t</span><span class="op" id="4618502">.</span><span class="ident" id="4618503">set</span><span class="op" id="4618506">[</span><span class="ident" id="4618507">name</span><span class="op" id="4618511">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4618515">if</span>&nbsp;<span class="ident" id="4618518">tmpl</span>&nbsp;<span class="op" id="4618523">==</span>&nbsp;<span class="ident" id="4618526">nil</span>&nbsp;<span class="op" id="4618530">{</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618535">tmpl</span>&nbsp;<span class="op" id="4618540">=</span>&nbsp;<span class="ident" id="4618542">t</span><span class="op" id="4618543">.</span><span class="builtinfunc" id="4618544">new</span><span class="op" id="4618547">(</span><span class="ident" id="4618548">name</span><span class="op" id="4618552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4618556">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4618560">//&nbsp;Restore&nbsp;our&nbsp;record&nbsp;of&nbsp;this&nbsp;text/template&nbsp;to&nbsp;its&nbsp;unescaped&nbsp;original&nbsp;state.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618639">tmpl</span><span class="op" id="4618643">.</span><span class="ident" id="4618644">escapeErr</span>&nbsp;<span class="op" id="4618654">=</span>&nbsp;<span class="ident" id="4618656">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618662">tmpl</span><span class="op" id="4618666">.</span><span class="ident" id="4618667">text</span>&nbsp;<span class="op" id="4618672">=</span>&nbsp;<span class="ident" id="4618674">v</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618678">tmpl</span><span class="op" id="4618682">.</span><span class="ident" id="4618683">Tree</span>&nbsp;<span class="op" id="4618688">=</span>&nbsp;<span class="ident" id="4618690">v</span><span class="op" id="4618691">.</span><span class="ident" id="4618692">Tree</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4618698">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4618701">return</span>&nbsp;<span class="ident" id="4618708">t</span><span class="op" id="4618709">,</span>&nbsp;<span class="ident" id="4618711">nil</span><br>
<span class="lineno"></span><span class="op" id="4618715">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="4618718">//&nbsp;AddParseTree&nbsp;creates&nbsp;a&nbsp;new&nbsp;template&nbsp;with&nbsp;the&nbsp;name&nbsp;and&nbsp;parse&nbsp;tree</span><br>
<span class="lineno"></span><span class="comment" id="4618786">//&nbsp;and&nbsp;associates&nbsp;it&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span><span class="comment" id="4618815">//</span><br>
<span class="lineno"></span><span class="comment" id="4618818">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="4618873">func</span>&nbsp;<span class="op" id="4618878">(</span><span class="ident" id="4618879">t</span>&nbsp;<span class="op" id="4618881">*</span><span class="ident" id="4618882">Template</span><span class="op" id="4618890">)</span>&nbsp;<span class="ident" id="4618892">AddParseTree</span><span class="op" id="4618904">(</span><span class="ident" id="4618905">name</span>&nbsp;<span class="builtintype" id="4618910">string</span><span class="op" id="4618916">,</span>&nbsp;<span class="ident" id="4618918">tree</span>&nbsp;<span class="op" id="4618923">*</span><span class="ident" id="4618924">parse</span><span class="op" id="4618929">.</span><span class="ident" id="4618930">Tree</span><span class="op" id="4618934">)</span>&nbsp;<span class="op" id="4618936">(</span><span class="op" id="4618937">*</span><span class="ident" id="4618938">Template</span><span class="op" id="4618946">,</span>&nbsp;<span class="builtintype" id="4618948">error</span><span class="op" id="4618953">)</span>&nbsp;<span class="op" id="4618955">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4618958">t</span><span class="op" id="4618959">.</span><span class="ident" id="4618960">nameSpace</span><span class="op" id="4618969">.</span><span class="ident" id="4618970">mu</span><span class="op" id="4618972">.</span><span class="ident" id="4618973">Lock</span><span class="op" id="4618977">(</span><span class="op" id="4618978">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4618981">defer</span>&nbsp;<span class="ident" id="4618987">t</span><span class="op" id="4618988">.</span><span class="ident" id="4618989">nameSpace</span><span class="op" id="4618998">.</span><span class="ident" id="4618999">mu</span><span class="op" id="4619001">.</span><span class="ident" id="4619002">Unlock</span><span class="op" id="4619008">(</span><span class="op" id="4619009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619012">if</span>&nbsp;<span class="ident" id="4619015">t</span><span class="op" id="4619016">.</span><span class="ident" id="4619017">escapeErr</span>&nbsp;<span class="op" id="4619027">!=</span>&nbsp;<span class="ident" id="4619030">nil</span>&nbsp;<span class="op" id="4619034">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619038">return</span>&nbsp;<span class="ident" id="4619045">nil</span><span class="op" id="4619048">,</span>&nbsp;<span class="ident" id="4619050">fmt</span><span class="op" id="4619053">.</span><span class="ident" id="4619054">Errorf</span><span class="op" id="4619060">(</span><span class="string" id="4619061">&#34;html/template:&nbsp;cannot&nbsp;AddParseTree&nbsp;to&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="4619125">,</span>&nbsp;<span class="ident" id="4619127">t</span><span class="op" id="4619128">.</span><span class="ident" id="4619129">Name</span><span class="op" id="4619133">(</span><span class="op" id="4619134">)</span><span class="op" id="4619135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4619138">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619141">text</span><span class="op" id="4619145">,</span>&nbsp;<span class="ident" id="4619147">err</span>&nbsp;<span class="op" id="4619151">:=</span>&nbsp;<span class="ident" id="4619154">t</span><span class="op" id="4619155">.</span><span class="ident" id="4619156">text</span><span class="op" id="4619160">.</span><span class="ident" id="4619161">AddParseTree</span><span class="op" id="4619173">(</span><span class="ident" id="4619174">name</span><span class="op" id="4619178">,</span>&nbsp;<span class="ident" id="4619180">tree</span><span class="op" id="4619184">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619187">if</span>&nbsp;<span class="ident" id="4619190">err</span>&nbsp;<span class="op" id="4619194">!=</span>&nbsp;<span class="ident" id="4619197">nil</span>&nbsp;<span class="op" id="4619201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619205">return</span>&nbsp;<span class="ident" id="4619212">nil</span><span class="op" id="4619215">,</span>&nbsp;<span class="ident" id="4619217">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4619222">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619225">ret</span>&nbsp;<span class="op" id="4619229">:=</span>&nbsp;<span class="op" id="4619232">&amp;</span><span class="ident" id="4619233">Template</span><span class="op" id="4619241">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619245">nil</span><span class="op" id="4619248">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619252">text</span><span class="op" id="4619256">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619260">text</span><span class="op" id="4619264">.</span><span class="ident" id="4619265">Tree</span><span class="op" id="4619269">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619273">t</span><span class="op" id="4619274">.</span><span class="ident" id="4619275">nameSpace</span><span class="op" id="4619284">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4619287">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619290">t</span><span class="op" id="4619291">.</span><span class="ident" id="4619292">set</span><span class="op" id="4619295">[</span><span class="ident" id="4619296">name</span><span class="op" id="4619300">]</span>&nbsp;<span class="op" id="4619302">=</span>&nbsp;<span class="ident" id="4619304">ret</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619309">return</span>&nbsp;<span class="ident" id="4619316">ret</span><span class="op" id="4619319">,</span>&nbsp;<span class="ident" id="4619321">nil</span><br>
<span class="lineno"></span><span class="op" id="4619325">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4619328">//&nbsp;Clone&nbsp;returns&nbsp;a&nbsp;duplicate&nbsp;of&nbsp;the&nbsp;template,&nbsp;including&nbsp;all&nbsp;associated</span><br>
<span class="lineno">180</span><span class="comment" id="4619399">//&nbsp;templates.&nbsp;The&nbsp;actual&nbsp;representation&nbsp;is&nbsp;not&nbsp;copied,&nbsp;but&nbsp;the&nbsp;name&nbsp;space&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4619476">//&nbsp;associated&nbsp;templates&nbsp;is,&nbsp;so&nbsp;further&nbsp;calls&nbsp;to&nbsp;Parse&nbsp;in&nbsp;the&nbsp;copy&nbsp;will&nbsp;add</span><br>
<span class="lineno"></span><span class="comment" id="4619551">//&nbsp;templates&nbsp;to&nbsp;the&nbsp;copy&nbsp;but&nbsp;not&nbsp;to&nbsp;the&nbsp;original.&nbsp;Clone&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;prepare</span><br>
<span class="lineno"></span><span class="comment" id="4619630">//&nbsp;common&nbsp;templates&nbsp;and&nbsp;use&nbsp;them&nbsp;with&nbsp;variant&nbsp;definitions&nbsp;for&nbsp;other&nbsp;templates</span><br>
<span class="lineno"></span><span class="comment" id="4619708">//&nbsp;by&nbsp;adding&nbsp;the&nbsp;variants&nbsp;after&nbsp;the&nbsp;clone&nbsp;is&nbsp;made.</span><br>
<span class="lineno">185</span><span class="comment" id="4619759">//</span><br>
<span class="lineno"></span><span class="comment" id="4619762">//&nbsp;It&nbsp;returns&nbsp;an&nbsp;error&nbsp;if&nbsp;t&nbsp;has&nbsp;already&nbsp;been&nbsp;executed.</span><br>
<span class="lineno"></span><span class="keyword" id="4619817">func</span>&nbsp;<span class="op" id="4619822">(</span><span class="ident" id="4619823">t</span>&nbsp;<span class="op" id="4619825">*</span><span class="ident" id="4619826">Template</span><span class="op" id="4619834">)</span>&nbsp;<span class="ident" id="4619836">Clone</span><span class="op" id="4619841">(</span><span class="op" id="4619842">)</span>&nbsp;<span class="op" id="4619844">(</span><span class="op" id="4619845">*</span><span class="ident" id="4619846">Template</span><span class="op" id="4619854">,</span>&nbsp;<span class="builtintype" id="4619856">error</span><span class="op" id="4619861">)</span>&nbsp;<span class="op" id="4619863">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4619866">t</span><span class="op" id="4619867">.</span><span class="ident" id="4619868">nameSpace</span><span class="op" id="4619877">.</span><span class="ident" id="4619878">mu</span><span class="op" id="4619880">.</span><span class="ident" id="4619881">Lock</span><span class="op" id="4619885">(</span><span class="op" id="4619886">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619889">defer</span>&nbsp;<span class="ident" id="4619895">t</span><span class="op" id="4619896">.</span><span class="ident" id="4619897">nameSpace</span><span class="op" id="4619906">.</span><span class="ident" id="4619907">mu</span><span class="op" id="4619909">.</span><span class="ident" id="4619910">Unlock</span><span class="op" id="4619916">(</span><span class="op" id="4619917">)</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619920">if</span>&nbsp;<span class="ident" id="4619923">t</span><span class="op" id="4619924">.</span><span class="ident" id="4619925">escapeErr</span>&nbsp;<span class="op" id="4619935">!=</span>&nbsp;<span class="ident" id="4619938">nil</span>&nbsp;<span class="op" id="4619942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4619946">return</span>&nbsp;<span class="ident" id="4619953">nil</span><span class="op" id="4619956">,</span>&nbsp;<span class="ident" id="4619958">fmt</span><span class="op" id="4619961">.</span><span class="ident" id="4619962">Errorf</span><span class="op" id="4619968">(</span><span class="string" id="4619969">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="4620023">,</span>&nbsp;<span class="ident" id="4620025">t</span><span class="op" id="4620026">.</span><span class="ident" id="4620027">Name</span><span class="op" id="4620031">(</span><span class="op" id="4620032">)</span><span class="op" id="4620033">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4620036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620039">textClone</span><span class="op" id="4620048">,</span>&nbsp;<span class="ident" id="4620050">err</span>&nbsp;<span class="op" id="4620054">:=</span>&nbsp;<span class="ident" id="4620057">t</span><span class="op" id="4620058">.</span><span class="ident" id="4620059">text</span><span class="op" id="4620063">.</span><span class="ident" id="4620064">Clone</span><span class="op" id="4620069">(</span><span class="op" id="4620070">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4620073">if</span>&nbsp;<span class="ident" id="4620076">err</span>&nbsp;<span class="op" id="4620080">!=</span>&nbsp;<span class="ident" id="4620083">nil</span>&nbsp;<span class="op" id="4620087">{</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4620091">return</span>&nbsp;<span class="ident" id="4620098">nil</span><span class="op" id="4620101">,</span>&nbsp;<span class="ident" id="4620103">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4620108">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620111">ret</span>&nbsp;<span class="op" id="4620115">:=</span>&nbsp;<span class="op" id="4620118">&amp;</span><span class="ident" id="4620119">Template</span><span class="op" id="4620127">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620131">nil</span><span class="op" id="4620134">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620138">textClone</span><span class="op" id="4620147">,</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620151">textClone</span><span class="op" id="4620160">.</span><span class="ident" id="4620161">Tree</span><span class="op" id="4620165">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4620169">&amp;</span><span class="ident" id="4620170">nameSpace</span><span class="op" id="4620179">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620184">set</span><span class="op" id="4620187">:</span>&nbsp;<span class="builtinfunc" id="4620189">make</span><span class="op" id="4620193">(</span><span class="keyword" id="4620194">map</span><span class="op" id="4620197">[</span><span class="builtintype" id="4620198">string</span><span class="op" id="4620204">]</span><span class="op" id="4620205">*</span><span class="ident" id="4620206">Template</span><span class="op" id="4620214">)</span><span class="op" id="4620215">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4620219">}</span><span class="op" id="4620220">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4620223">}</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4620226">for</span>&nbsp;<span class="ident" id="4620230">_</span><span class="op" id="4620231">,</span>&nbsp;<span class="ident" id="4620233">x</span>&nbsp;<span class="op" id="4620235">:=</span>&nbsp;<span class="keyword" id="4620238">range</span>&nbsp;<span class="ident" id="4620244">textClone</span><span class="op" id="4620253">.</span><span class="ident" id="4620254">Templates</span><span class="op" id="4620263">(</span><span class="op" id="4620264">)</span>&nbsp;<span class="op" id="4620266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620270">name</span>&nbsp;<span class="op" id="4620275">:=</span>&nbsp;<span class="ident" id="4620278">x</span><span class="op" id="4620279">.</span><span class="ident" id="4620280">Name</span><span class="op" id="4620284">(</span><span class="op" id="4620285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620289">src</span>&nbsp;<span class="op" id="4620293">:=</span>&nbsp;<span class="ident" id="4620296">t</span><span class="op" id="4620297">.</span><span class="ident" id="4620298">set</span><span class="op" id="4620301">[</span><span class="ident" id="4620302">name</span><span class="op" id="4620306">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4620310">if</span>&nbsp;<span class="ident" id="4620313">src</span>&nbsp;<span class="op" id="4620317">==</span>&nbsp;<span class="ident" id="4620320">nil</span>&nbsp;<span class="op" id="4620324">||</span>&nbsp;<span class="ident" id="4620327">src</span><span class="op" id="4620330">.</span><span class="ident" id="4620331">escapeErr</span>&nbsp;<span class="op" id="4620341">!=</span>&nbsp;<span class="ident" id="4620344">nil</span>&nbsp;<span class="op" id="4620348">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4620353">return</span>&nbsp;<span class="ident" id="4620360">nil</span><span class="op" id="4620363">,</span>&nbsp;<span class="ident" id="4620365">fmt</span><span class="op" id="4620368">.</span><span class="ident" id="4620369">Errorf</span><span class="op" id="4620375">(</span><span class="string" id="4620376">&#34;html/template:&nbsp;cannot&nbsp;Clone&nbsp;%q&nbsp;after&nbsp;it&nbsp;has&nbsp;executed&#34;</span><span class="op" id="4620430">,</span>&nbsp;<span class="ident" id="4620432">t</span><span class="op" id="4620433">.</span><span class="ident" id="4620434">Name</span><span class="op" id="4620438">(</span><span class="op" id="4620439">)</span><span class="op" id="4620440">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4620444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620448">x</span><span class="op" id="4620449">.</span><span class="ident" id="4620450">Tree</span>&nbsp;<span class="op" id="4620455">=</span>&nbsp;<span class="ident" id="4620457">x</span><span class="op" id="4620458">.</span><span class="ident" id="4620459">Tree</span><span class="op" id="4620463">.</span><span class="ident" id="4620464">Copy</span><span class="op" id="4620468">(</span><span class="op" id="4620469">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620473">ret</span><span class="op" id="4620476">.</span><span class="ident" id="4620477">set</span><span class="op" id="4620480">[</span><span class="ident" id="4620481">name</span><span class="op" id="4620485">]</span>&nbsp;<span class="op" id="4620487">=</span>&nbsp;<span class="op" id="4620489">&amp;</span><span class="ident" id="4620490">Template</span><span class="op" id="4620498">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620503">nil</span><span class="op" id="4620506">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620511">x</span><span class="op" id="4620512">,</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620517">x</span><span class="op" id="4620518">.</span><span class="ident" id="4620519">Tree</span><span class="op" id="4620523">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620528">ret</span><span class="op" id="4620531">.</span><span class="ident" id="4620532">nameSpace</span><span class="op" id="4620541">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4620545">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4620548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4620551">return</span>&nbsp;<span class="ident" id="4620558">ret</span><span class="op" id="4620561">,</span>&nbsp;<span class="ident" id="4620563">nil</span><br>
<span class="lineno">220</span><span class="op" id="4620567">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4620570">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name.</span><br>
<span class="lineno"></span><span class="keyword" id="4620628">func</span>&nbsp;<span class="ident" id="4620633">New</span><span class="op" id="4620636">(</span><span class="ident" id="4620637">name</span>&nbsp;<span class="builtintype" id="4620642">string</span><span class="op" id="4620648">)</span>&nbsp;<span class="op" id="4620650">*</span><span class="ident" id="4620651">Template</span>&nbsp;<span class="op" id="4620660">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620663">tmpl</span>&nbsp;<span class="op" id="4620668">:=</span>&nbsp;<span class="op" id="4620671">&amp;</span><span class="ident" id="4620672">Template</span><span class="op" id="4620680">{</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620684">nil</span><span class="op" id="4620687">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620691">template</span><span class="op" id="4620699">.</span><span class="ident" id="4620700">New</span><span class="op" id="4620703">(</span><span class="ident" id="4620704">name</span><span class="op" id="4620708">)</span><span class="op" id="4620709">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620713">nil</span><span class="op" id="4620716">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4620720">&amp;</span><span class="ident" id="4620721">nameSpace</span><span class="op" id="4620730">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620735">set</span><span class="op" id="4620738">:</span>&nbsp;<span class="builtinfunc" id="4620740">make</span><span class="op" id="4620744">(</span><span class="keyword" id="4620745">map</span><span class="op" id="4620748">[</span><span class="builtintype" id="4620749">string</span><span class="op" id="4620755">]</span><span class="op" id="4620756">*</span><span class="ident" id="4620757">Template</span><span class="op" id="4620765">)</span><span class="op" id="4620766">,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4620770">}</span><span class="op" id="4620771">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4620774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4620777">tmpl</span><span class="op" id="4620781">.</span><span class="ident" id="4620782">set</span><span class="op" id="4620785">[</span><span class="ident" id="4620786">name</span><span class="op" id="4620790">]</span>&nbsp;<span class="op" id="4620792">=</span>&nbsp;<span class="ident" id="4620794">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4620800">return</span>&nbsp;<span class="ident" id="4620807">tmpl</span><br>
<span class="lineno"></span><span class="op" id="4620812">}</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="comment" id="4620815">//&nbsp;New&nbsp;allocates&nbsp;a&nbsp;new&nbsp;HTML&nbsp;template&nbsp;associated&nbsp;with&nbsp;the&nbsp;given&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="4620882">//&nbsp;and&nbsp;with&nbsp;the&nbsp;same&nbsp;delimiters.&nbsp;The&nbsp;association,&nbsp;which&nbsp;is&nbsp;transitive,</span><br>
<span class="lineno"></span><span class="comment" id="4620953">//&nbsp;allows&nbsp;one&nbsp;template&nbsp;to&nbsp;invoke&nbsp;another&nbsp;with&nbsp;a&nbsp;{{template}}&nbsp;action.</span><br>
<span class="lineno"></span><span class="keyword" id="4621022">func</span>&nbsp;<span class="op" id="4621027">(</span><span class="ident" id="4621028">t</span>&nbsp;<span class="op" id="4621030">*</span><span class="ident" id="4621031">Template</span><span class="op" id="4621039">)</span>&nbsp;<span class="ident" id="4621041">New</span><span class="op" id="4621044">(</span><span class="ident" id="4621045">name</span>&nbsp;<span class="builtintype" id="4621050">string</span><span class="op" id="4621056">)</span>&nbsp;<span class="op" id="4621058">*</span><span class="ident" id="4621059">Template</span>&nbsp;<span class="op" id="4621068">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621071">t</span><span class="op" id="4621072">.</span><span class="ident" id="4621073">nameSpace</span><span class="op" id="4621082">.</span><span class="ident" id="4621083">mu</span><span class="op" id="4621085">.</span><span class="ident" id="4621086">Lock</span><span class="op" id="4621090">(</span><span class="op" id="4621091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621094">defer</span>&nbsp;<span class="ident" id="4621100">t</span><span class="op" id="4621101">.</span><span class="ident" id="4621102">nameSpace</span><span class="op" id="4621111">.</span><span class="ident" id="4621112">mu</span><span class="op" id="4621114">.</span><span class="ident" id="4621115">Unlock</span><span class="op" id="4621121">(</span><span class="op" id="4621122">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621125">return</span>&nbsp;<span class="ident" id="4621132">t</span><span class="op" id="4621133">.</span><span class="builtinfunc" id="4621134">new</span><span class="op" id="4621137">(</span><span class="ident" id="4621138">name</span><span class="op" id="4621142">)</span><br>
<span class="lineno"></span><span class="op" id="4621144">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">245</span><span class="comment" id="4621147">//&nbsp;new&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;New,&nbsp;without&nbsp;the&nbsp;lock.</span><br>
<span class="lineno"></span><span class="keyword" id="4621202">func</span>&nbsp;<span class="op" id="4621207">(</span><span class="ident" id="4621208">t</span>&nbsp;<span class="op" id="4621210">*</span><span class="ident" id="4621211">Template</span><span class="op" id="4621219">)</span>&nbsp;<span class="builtinfunc" id="4621221">new</span><span class="op" id="4621224">(</span><span class="ident" id="4621225">name</span>&nbsp;<span class="builtintype" id="4621230">string</span><span class="op" id="4621236">)</span>&nbsp;<span class="op" id="4621238">*</span><span class="ident" id="4621239">Template</span>&nbsp;<span class="op" id="4621248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621251">tmpl</span>&nbsp;<span class="op" id="4621256">:=</span>&nbsp;<span class="op" id="4621259">&amp;</span><span class="ident" id="4621260">Template</span><span class="op" id="4621268">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621272">nil</span><span class="op" id="4621275">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621279">t</span><span class="op" id="4621280">.</span><span class="ident" id="4621281">text</span><span class="op" id="4621285">.</span><span class="ident" id="4621286">New</span><span class="op" id="4621289">(</span><span class="ident" id="4621290">name</span><span class="op" id="4621294">)</span><span class="op" id="4621295">,</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621299">nil</span><span class="op" id="4621302">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621306">t</span><span class="op" id="4621307">.</span><span class="ident" id="4621308">nameSpace</span><span class="op" id="4621317">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4621320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4621323">tmpl</span><span class="op" id="4621327">.</span><span class="ident" id="4621328">set</span><span class="op" id="4621331">[</span><span class="ident" id="4621332">name</span><span class="op" id="4621336">]</span>&nbsp;<span class="op" id="4621338">=</span>&nbsp;<span class="ident" id="4621340">tmpl</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621346">return</span>&nbsp;<span class="ident" id="4621353">tmpl</span><br>
<span class="lineno">255</span><span class="op" id="4621358">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4621361">//&nbsp;Name&nbsp;returns&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="4621403">func</span>&nbsp;<span class="op" id="4621408">(</span><span class="ident" id="4621409">t</span>&nbsp;<span class="op" id="4621411">*</span><span class="ident" id="4621412">Template</span><span class="op" id="4621420">)</span>&nbsp;<span class="ident" id="4621422">Name</span><span class="op" id="4621426">(</span><span class="op" id="4621427">)</span>&nbsp;<span class="builtintype" id="4621429">string</span>&nbsp;<span class="op" id="4621436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4621439">return</span>&nbsp;<span class="ident" id="4621446">t</span><span class="op" id="4621447">.</span><span class="ident" id="4621448">text</span><span class="op" id="4621452">.</span><span class="ident" id="4621453">Name</span><span class="op" id="4621457">(</span><span class="op" id="4621458">)</span><br>
<span class="lineno">260</span><span class="op" id="4621460">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4621463">//&nbsp;FuncMap&nbsp;is&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;map&nbsp;defining&nbsp;the&nbsp;mapping&nbsp;from&nbsp;names&nbsp;to</span><br>
<span class="lineno"></span><span class="comment" id="4621532">//&nbsp;functions.&nbsp;Each&nbsp;function&nbsp;must&nbsp;have&nbsp;either&nbsp;a&nbsp;single&nbsp;return&nbsp;value,&nbsp;or&nbsp;two</span><br>
<span class="lineno"></span><span class="comment" id="4621607">//&nbsp;return&nbsp;values&nbsp;of&nbsp;which&nbsp;the&nbsp;second&nbsp;has&nbsp;type&nbsp;error.&nbsp;In&nbsp;that&nbsp;case,&nbsp;if&nbsp;the</span><br>
<span class="lineno">265</span><span class="comment" id="4621681">//&nbsp;second&nbsp;(error)&nbsp;argument&nbsp;evaluates&nbsp;to&nbsp;non-nil&nbsp;during&nbsp;execution,&nbsp;execution</span><br>
<span class="lineno"></span><span class="comment" id="4621757">//&nbsp;terminates&nbsp;and&nbsp;Execute&nbsp;returns&nbsp;that&nbsp;error.&nbsp;FuncMap&nbsp;has&nbsp;the&nbsp;same&nbsp;base&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="4621834">//&nbsp;as&nbsp;FuncMap&nbsp;in&nbsp;&#34;text/template&#34;,&nbsp;copied&nbsp;here&nbsp;so&nbsp;clients&nbsp;need&nbsp;not&nbsp;import</span><br>
<span class="lineno"></span><span class="comment" id="4621907">//&nbsp;&#34;text/template&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="4621927">type</span>&nbsp;<span class="ident" id="4621932">FuncMap</span>&nbsp;<span class="keyword" id="4621940">map</span><span class="op" id="4621943">[</span><span class="builtintype" id="4621944">string</span><span class="op" id="4621950">]</span><span class="keyword" id="4621951">interface</span><span class="op" id="4621960">{</span><span class="op" id="4621961">}</span><br>
<span class="lineno">270</span><br>
<span class="lineno"></span><span class="comment" id="4621964">//&nbsp;Funcs&nbsp;adds&nbsp;the&nbsp;elements&nbsp;of&nbsp;the&nbsp;argument&nbsp;map&nbsp;to&nbsp;the&nbsp;template&#39;s&nbsp;function&nbsp;map.</span><br>
<span class="lineno"></span><span class="comment" id="4622043">//&nbsp;It&nbsp;panics&nbsp;if&nbsp;a&nbsp;value&nbsp;in&nbsp;the&nbsp;map&nbsp;is&nbsp;not&nbsp;a&nbsp;function&nbsp;with&nbsp;appropriate&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="4622120">//&nbsp;type.&nbsp;However,&nbsp;it&nbsp;is&nbsp;legal&nbsp;to&nbsp;overwrite&nbsp;elements&nbsp;of&nbsp;the&nbsp;map.&nbsp;The&nbsp;return</span><br>
<span class="lineno"></span><span class="comment" id="4622195">//&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">275</span><span class="keyword" id="4622246">func</span>&nbsp;<span class="op" id="4622251">(</span><span class="ident" id="4622252">t</span>&nbsp;<span class="op" id="4622254">*</span><span class="ident" id="4622255">Template</span><span class="op" id="4622263">)</span>&nbsp;<span class="ident" id="4622265">Funcs</span><span class="op" id="4622270">(</span><span class="ident" id="4622271">funcMap</span>&nbsp;<span class="ident" id="4622279">FuncMap</span><span class="op" id="4622286">)</span>&nbsp;<span class="op" id="4622288">*</span><span class="ident" id="4622289">Template</span>&nbsp;<span class="op" id="4622298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4622301">t</span><span class="op" id="4622302">.</span><span class="ident" id="4622303">text</span><span class="op" id="4622307">.</span><span class="ident" id="4622308">Funcs</span><span class="op" id="4622313">(</span><span class="ident" id="4622314">template</span><span class="op" id="4622322">.</span><span class="ident" id="4622323">FuncMap</span><span class="op" id="4622330">(</span><span class="ident" id="4622331">funcMap</span><span class="op" id="4622338">)</span><span class="op" id="4622339">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4622342">return</span>&nbsp;<span class="ident" id="4622349">t</span><br>
<span class="lineno"></span><span class="op" id="4622351">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">280</span><span class="comment" id="4622354">//&nbsp;Delims&nbsp;sets&nbsp;the&nbsp;action&nbsp;delimiters&nbsp;to&nbsp;the&nbsp;specified&nbsp;strings,&nbsp;to&nbsp;be&nbsp;used&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="4622431">//&nbsp;subsequent&nbsp;calls&nbsp;to&nbsp;Parse,&nbsp;ParseFiles,&nbsp;or&nbsp;ParseGlob.&nbsp;Nested&nbsp;template</span><br>
<span class="lineno"></span><span class="comment" id="4622503">//&nbsp;definitions&nbsp;will&nbsp;inherit&nbsp;the&nbsp;settings.&nbsp;An&nbsp;empty&nbsp;delimiter&nbsp;stands&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4622579">//&nbsp;corresponding&nbsp;default:&nbsp;{{&nbsp;or&nbsp;}}.</span><br>
<span class="lineno"></span><span class="comment" id="4622615">//&nbsp;The&nbsp;return&nbsp;value&nbsp;is&nbsp;the&nbsp;template,&nbsp;so&nbsp;calls&nbsp;can&nbsp;be&nbsp;chained.</span><br>
<span class="lineno">285</span><span class="keyword" id="4622677">func</span>&nbsp;<span class="op" id="4622682">(</span><span class="ident" id="4622683">t</span>&nbsp;<span class="op" id="4622685">*</span><span class="ident" id="4622686">Template</span><span class="op" id="4622694">)</span>&nbsp;<span class="ident" id="4622696">Delims</span><span class="op" id="4622702">(</span><span class="ident" id="4622703">left</span><span class="op" id="4622707">,</span>&nbsp;<span class="ident" id="4622709">right</span>&nbsp;<span class="builtintype" id="4622715">string</span><span class="op" id="4622721">)</span>&nbsp;<span class="op" id="4622723">*</span><span class="ident" id="4622724">Template</span>&nbsp;<span class="op" id="4622733">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4622736">t</span><span class="op" id="4622737">.</span><span class="ident" id="4622738">text</span><span class="op" id="4622742">.</span><span class="ident" id="4622743">Delims</span><span class="op" id="4622749">(</span><span class="ident" id="4622750">left</span><span class="op" id="4622754">,</span>&nbsp;<span class="ident" id="4622756">right</span><span class="op" id="4622761">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4622764">return</span>&nbsp;<span class="ident" id="4622771">t</span><br>
<span class="lineno"></span><span class="op" id="4622773">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">290</span><span class="comment" id="4622776">//&nbsp;Lookup&nbsp;returns&nbsp;the&nbsp;template&nbsp;with&nbsp;the&nbsp;given&nbsp;name&nbsp;that&nbsp;is&nbsp;associated&nbsp;with&nbsp;t,</span><br>
<span class="lineno"></span><span class="comment" id="4622854">//&nbsp;or&nbsp;nil&nbsp;if&nbsp;there&nbsp;is&nbsp;no&nbsp;such&nbsp;template.</span><br>
<span class="lineno"></span><span class="keyword" id="4622894">func</span>&nbsp;<span class="op" id="4622899">(</span><span class="ident" id="4622900">t</span>&nbsp;<span class="op" id="4622902">*</span><span class="ident" id="4622903">Template</span><span class="op" id="4622911">)</span>&nbsp;<span class="ident" id="4622913">Lookup</span><span class="op" id="4622919">(</span><span class="ident" id="4622920">name</span>&nbsp;<span class="builtintype" id="4622925">string</span><span class="op" id="4622931">)</span>&nbsp;<span class="op" id="4622933">*</span><span class="ident" id="4622934">Template</span>&nbsp;<span class="op" id="4622943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4622946">t</span><span class="op" id="4622947">.</span><span class="ident" id="4622948">nameSpace</span><span class="op" id="4622957">.</span><span class="ident" id="4622958">mu</span><span class="op" id="4622960">.</span><span class="ident" id="4622961">Lock</span><span class="op" id="4622965">(</span><span class="op" id="4622966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4622969">defer</span>&nbsp;<span class="ident" id="4622975">t</span><span class="op" id="4622976">.</span><span class="ident" id="4622977">nameSpace</span><span class="op" id="4622986">.</span><span class="ident" id="4622987">mu</span><span class="op" id="4622989">.</span><span class="ident" id="4622990">Unlock</span><span class="op" id="4622996">(</span><span class="op" id="4622997">)</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4623000">return</span>&nbsp;<span class="ident" id="4623007">t</span><span class="op" id="4623008">.</span><span class="ident" id="4623009">set</span><span class="op" id="4623012">[</span><span class="ident" id="4623013">name</span><span class="op" id="4623017">]</span><br>
<span class="lineno"></span><span class="op" id="4623019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4623022">//&nbsp;Must&nbsp;is&nbsp;a&nbsp;helper&nbsp;that&nbsp;wraps&nbsp;a&nbsp;call&nbsp;to&nbsp;a&nbsp;function&nbsp;returning&nbsp;(*Template,&nbsp;error)</span><br>
<span class="lineno"></span><span class="comment" id="4623103">//&nbsp;and&nbsp;panics&nbsp;if&nbsp;the&nbsp;error&nbsp;is&nbsp;non-nil.&nbsp;It&nbsp;is&nbsp;intended&nbsp;for&nbsp;use&nbsp;in&nbsp;variable&nbsp;initializations</span><br>
<span class="lineno">300</span><span class="comment" id="4623193">//&nbsp;such&nbsp;as</span><br>
<span class="lineno"></span><span class="comment" id="4623204">//&nbsp;&nbsp;&nbsp;&nbspvar&nbsp;t&nbsp;=&nbsp;template.Must(template.New(&#34;name&#34;).Parse(&#34;html&#34;))</span><br>
<span class="lineno"></span><span class="keyword" id="4623265">func</span>&nbsp;<span class="ident" id="4623270">Must</span><span class="op" id="4623274">(</span><span class="ident" id="4623275">t</span>&nbsp;<span class="op" id="4623277">*</span><span class="ident" id="4623278">Template</span><span class="op" id="4623286">,</span>&nbsp;<span class="ident" id="4623288">err</span>&nbsp;<span class="builtintype" id="4623292">error</span><span class="op" id="4623297">)</span>&nbsp;<span class="op" id="4623299">*</span><span class="ident" id="4623300">Template</span>&nbsp;<span class="op" id="4623309">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4623312">if</span>&nbsp;<span class="ident" id="4623315">err</span>&nbsp;<span class="op" id="4623319">!=</span>&nbsp;<span class="ident" id="4623322">nil</span>&nbsp;<span class="op" id="4623326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4623330">panic</span><span class="op" id="4623335">(</span><span class="ident" id="4623336">err</span><span class="op" id="4623339">)</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4623342">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4623345">return</span>&nbsp;<span class="ident" id="4623352">t</span><br>
<span class="lineno"></span><span class="op" id="4623354">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4623357">//&nbsp;ParseFiles&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from</span><br>
<span class="lineno">310</span><span class="comment" id="4623435">//&nbsp;the&nbsp;named&nbsp;files.&nbsp;The&nbsp;returned&nbsp;template&#39;s&nbsp;name&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4623514">//&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the&nbsp;first&nbsp;file.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno"></span><span class="comment" id="4623587">//&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;*Template&nbsp;is&nbsp;nil.</span><br>
<span class="lineno"></span><span class="keyword" id="4623659">func</span>&nbsp;<span class="ident" id="4623664">ParseFiles</span><span class="op" id="4623674">(</span><span class="ident" id="4623675">filenames</span>&nbsp;<span class="op" id="4623685">...</span><span class="builtintype" id="4623688">string</span><span class="op" id="4623694">)</span>&nbsp;<span class="op" id="4623696">(</span><span class="op" id="4623697">*</span><span class="ident" id="4623698">Template</span><span class="op" id="4623706">,</span>&nbsp;<span class="builtintype" id="4623708">error</span><span class="op" id="4623713">)</span>&nbsp;<span class="op" id="4623715">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4623718">return</span>&nbsp;<span class="ident" id="4623725">parseFiles</span><span class="op" id="4623735">(</span><span class="ident" id="4623736">nil</span><span class="op" id="4623739">,</span>&nbsp;<span class="ident" id="4623741">filenames</span><span class="op" id="4623750">...</span><span class="op" id="4623753">)</span><br>
<span class="lineno">315</span><span class="op" id="4623755">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4623758">//&nbsp;ParseFiles&nbsp;parses&nbsp;the&nbsp;named&nbsp;files&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with</span><br>
<span class="lineno"></span><span class="comment" id="4623839">//&nbsp;t.&nbsp;If&nbsp;an&nbsp;error&nbsp;occurs,&nbsp;parsing&nbsp;stops&nbsp;and&nbsp;the&nbsp;returned&nbsp;template&nbsp;is&nbsp;nil;</span><br>
<span class="lineno"></span><span class="comment" id="4623913">//&nbsp;otherwise&nbsp;it&nbsp;is&nbsp;t.&nbsp;There&nbsp;must&nbsp;be&nbsp;at&nbsp;least&nbsp;one&nbsp;file.</span><br>
<span class="lineno">320</span><span class="keyword" id="4623968">func</span>&nbsp;<span class="op" id="4623973">(</span><span class="ident" id="4623974">t</span>&nbsp;<span class="op" id="4623976">*</span><span class="ident" id="4623977">Template</span><span class="op" id="4623985">)</span>&nbsp;<span class="ident" id="4623987">ParseFiles</span><span class="op" id="4623997">(</span><span class="ident" id="4623998">filenames</span>&nbsp;<span class="op" id="4624008">...</span><span class="builtintype" id="4624011">string</span><span class="op" id="4624017">)</span>&nbsp;<span class="op" id="4624019">(</span><span class="op" id="4624020">*</span><span class="ident" id="4624021">Template</span><span class="op" id="4624029">,</span>&nbsp;<span class="builtintype" id="4624031">error</span><span class="op" id="4624036">)</span>&nbsp;<span class="op" id="4624038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624041">return</span>&nbsp;<span class="ident" id="4624048">parseFiles</span><span class="op" id="4624058">(</span><span class="ident" id="4624059">t</span><span class="op" id="4624060">,</span>&nbsp;<span class="ident" id="4624062">filenames</span><span class="op" id="4624071">...</span><span class="op" id="4624074">)</span><br>
<span class="lineno"></span><span class="op" id="4624076">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4624079">//&nbsp;parseFiles&nbsp;is&nbsp;the&nbsp;helper&nbsp;for&nbsp;the&nbsp;method&nbsp;and&nbsp;function.&nbsp;If&nbsp;the&nbsp;argument</span><br>
<span class="lineno">325</span><span class="comment" id="4624152">//&nbsp;template&nbsp;is&nbsp;nil,&nbsp;it&nbsp;is&nbsp;created&nbsp;from&nbsp;the&nbsp;first&nbsp;file.</span><br>
<span class="lineno"></span><span class="keyword" id="4624207">func</span>&nbsp;<span class="ident" id="4624212">parseFiles</span><span class="op" id="4624222">(</span><span class="ident" id="4624223">t</span>&nbsp;<span class="op" id="4624225">*</span><span class="ident" id="4624226">Template</span><span class="op" id="4624234">,</span>&nbsp;<span class="ident" id="4624236">filenames</span>&nbsp;<span class="op" id="4624246">...</span><span class="builtintype" id="4624249">string</span><span class="op" id="4624255">)</span>&nbsp;<span class="op" id="4624257">(</span><span class="op" id="4624258">*</span><span class="ident" id="4624259">Template</span><span class="op" id="4624267">,</span>&nbsp;<span class="builtintype" id="4624269">error</span><span class="op" id="4624274">)</span>&nbsp;<span class="op" id="4624276">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624279">if</span>&nbsp;<span class="builtinfunc" id="4624282">len</span><span class="op" id="4624285">(</span><span class="ident" id="4624286">filenames</span><span class="op" id="4624295">)</span>&nbsp;<span class="op" id="4624297">==</span>&nbsp;<span class="num" id="4624300">0</span>&nbsp;<span class="op" id="4624302">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4624306">//&nbsp;Not&nbsp;really&nbsp;a&nbsp;problem,&nbsp;but&nbsp;be&nbsp;consistent.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624352">return</span>&nbsp;<span class="ident" id="4624359">nil</span><span class="op" id="4624362">,</span>&nbsp;<span class="ident" id="4624364">fmt</span><span class="op" id="4624367">.</span><span class="ident" id="4624368">Errorf</span><span class="op" id="4624374">(</span><span class="string" id="4624375">&#34;html/template:&nbsp;no&nbsp;files&nbsp;named&nbsp;in&nbsp;call&nbsp;to&nbsp;ParseFiles&#34;</span><span class="op" id="4624428">)</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4624431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624434">for</span>&nbsp;<span class="ident" id="4624438">_</span><span class="op" id="4624439">,</span>&nbsp;<span class="ident" id="4624441">filename</span>&nbsp;<span class="op" id="4624450">:=</span>&nbsp;<span class="keyword" id="4624453">range</span>&nbsp;<span class="ident" id="4624459">filenames</span>&nbsp;<span class="op" id="4624469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624473">b</span><span class="op" id="4624474">,</span>&nbsp;<span class="ident" id="4624476">err</span>&nbsp;<span class="op" id="4624480">:=</span>&nbsp;<span class="ident" id="4624483">ioutil</span><span class="op" id="4624489">.</span><span class="ident" id="4624490">ReadFile</span><span class="op" id="4624498">(</span><span class="ident" id="4624499">filename</span><span class="op" id="4624507">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624511">if</span>&nbsp;<span class="ident" id="4624514">err</span>&nbsp;<span class="op" id="4624518">!=</span>&nbsp;<span class="ident" id="4624521">nil</span>&nbsp;<span class="op" id="4624525">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624530">return</span>&nbsp;<span class="ident" id="4624537">nil</span><span class="op" id="4624540">,</span>&nbsp;<span class="ident" id="4624542">err</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4624548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624552">s</span>&nbsp;<span class="op" id="4624554">:=</span>&nbsp;<span class="builtintype" id="4624557">string</span><span class="op" id="4624563">(</span><span class="ident" id="4624564">b</span><span class="op" id="4624565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4624569">name</span>&nbsp;<span class="op" id="4624574">:=</span>&nbsp;<span class="ident" id="4624577">filepath</span><span class="op" id="4624585">.</span><span class="ident" id="4624586">Base</span><span class="op" id="4624590">(</span><span class="ident" id="4624591">filename</span><span class="op" id="4624599">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4624603">//&nbsp;First&nbsp;template&nbsp;becomes&nbsp;return&nbsp;value&nbsp;if&nbsp;not&nbsp;already&nbsp;defined,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4624668">//&nbsp;and&nbsp;we&nbsp;use&nbsp;that&nbsp;one&nbsp;for&nbsp;subsequent&nbsp;New&nbsp;calls&nbsp;to&nbsp;associate</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4624731">//&nbsp;all&nbsp;the&nbsp;templates&nbsp;together.&nbsp;Also,&nbsp;if&nbsp;this&nbsp;file&nbsp;has&nbsp;the&nbsp;same&nbsp;name</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4624801">//&nbsp;as&nbsp;t,&nbsp;this&nbsp;file&nbsp;becomes&nbsp;the&nbsp;contents&nbsp;of&nbsp;t,&nbsp;so</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4624852">//&nbsp;&nbsp;t,&nbsp;err&nbsp;:=&nbsp;New(name).Funcs(xxx).ParseFiles(name)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4624906">//&nbsp;works.&nbsp;Otherwise&nbsp;we&nbsp;create&nbsp;a&nbsp;new&nbsp;template&nbsp;associated&nbsp;with&nbsp;t.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624972">var</span>&nbsp;<span class="ident" id="4624976">tmpl</span>&nbsp;<span class="op" id="4624981">*</span><span class="ident" id="4624982">Template</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4624993">if</span>&nbsp;<span class="ident" id="4624996">t</span>&nbsp;<span class="op" id="4624998">==</span>&nbsp;<span class="ident" id="4625001">nil</span>&nbsp;<span class="op" id="4625005">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625010">t</span>&nbsp;<span class="op" id="4625012">=</span>&nbsp;<span class="ident" id="4625014">New</span><span class="op" id="4625017">(</span><span class="ident" id="4625018">name</span><span class="op" id="4625022">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4625026">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625030">if</span>&nbsp;<span class="ident" id="4625033">name</span>&nbsp;<span class="op" id="4625038">==</span>&nbsp;<span class="ident" id="4625041">t</span><span class="op" id="4625042">.</span><span class="ident" id="4625043">Name</span><span class="op" id="4625047">(</span><span class="op" id="4625048">)</span>&nbsp;<span class="op" id="4625050">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625055">tmpl</span>&nbsp;<span class="op" id="4625060">=</span>&nbsp;<span class="ident" id="4625062">t</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4625066">}</span>&nbsp;<span class="keyword" id="4625068">else</span>&nbsp;<span class="op" id="4625073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625078">tmpl</span>&nbsp;<span class="op" id="4625083">=</span>&nbsp;<span class="ident" id="4625085">t</span><span class="op" id="4625086">.</span><span class="ident" id="4625087">New</span><span class="op" id="4625090">(</span><span class="ident" id="4625091">name</span><span class="op" id="4625095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4625099">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4625103">_</span><span class="op" id="4625104">,</span>&nbsp;<span class="ident" id="4625106">err</span>&nbsp;<span class="op" id="4625110">=</span>&nbsp;<span class="ident" id="4625112">tmpl</span><span class="op" id="4625116">.</span><span class="ident" id="4625117">Parse</span><span class="op" id="4625122">(</span><span class="ident" id="4625123">s</span><span class="op" id="4625124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625128">if</span>&nbsp;<span class="ident" id="4625131">err</span>&nbsp;<span class="op" id="4625135">!=</span>&nbsp;<span class="ident" id="4625138">nil</span>&nbsp;<span class="op" id="4625142">{</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625147">return</span>&nbsp;<span class="ident" id="4625154">nil</span><span class="op" id="4625157">,</span>&nbsp;<span class="ident" id="4625159">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4625165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4625168">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625171">return</span>&nbsp;<span class="ident" id="4625178">t</span><span class="op" id="4625179">,</span>&nbsp;<span class="ident" id="4625181">nil</span><br>
<span class="lineno"></span><span class="op" id="4625185">}</span><br>
<span class="lineno">360</span><br>
<span class="lineno"></span><span class="comment" id="4625188">//&nbsp;ParseGlob&nbsp;creates&nbsp;a&nbsp;new&nbsp;Template&nbsp;and&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;from&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4625269">//&nbsp;files&nbsp;identified&nbsp;by&nbsp;the&nbsp;pattern,&nbsp;which&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4625345">//&nbsp;returned&nbsp;template&nbsp;will&nbsp;have&nbsp;the&nbsp;(base)&nbsp;name&nbsp;and&nbsp;(parsed)&nbsp;contents&nbsp;of&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4625421">//&nbsp;first&nbsp;file&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.&nbsp;ParseGlob&nbsp;is&nbsp;equivalent&nbsp;to&nbsp;calling</span><br>
<span class="lineno">365</span><span class="comment" id="4625494">//&nbsp;ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the&nbsp;pattern.</span><br>
<span class="lineno"></span><span class="keyword" id="4625555">func</span>&nbsp;<span class="ident" id="4625560">ParseGlob</span><span class="op" id="4625569">(</span><span class="ident" id="4625570">pattern</span>&nbsp;<span class="builtintype" id="4625578">string</span><span class="op" id="4625584">)</span>&nbsp;<span class="op" id="4625586">(</span><span class="op" id="4625587">*</span><span class="ident" id="4625588">Template</span><span class="op" id="4625596">,</span>&nbsp;<span class="builtintype" id="4625598">error</span><span class="op" id="4625603">)</span>&nbsp;<span class="op" id="4625605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4625608">return</span>&nbsp;<span class="ident" id="4625615">parseGlob</span><span class="op" id="4625624">(</span><span class="ident" id="4625625">nil</span><span class="op" id="4625628">,</span>&nbsp;<span class="ident" id="4625630">pattern</span><span class="op" id="4625637">)</span><br>
<span class="lineno"></span><span class="op" id="4625639">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">370</span><span class="comment" id="4625642">//&nbsp;ParseGlob&nbsp;parses&nbsp;the&nbsp;template&nbsp;definitions&nbsp;in&nbsp;the&nbsp;files&nbsp;identified&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4625718">//&nbsp;pattern&nbsp;and&nbsp;associates&nbsp;the&nbsp;resulting&nbsp;templates&nbsp;with&nbsp;t.&nbsp;The&nbsp;pattern&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4625791">//&nbsp;processed&nbsp;by&nbsp;filepath.Glob&nbsp;and&nbsp;must&nbsp;match&nbsp;at&nbsp;least&nbsp;one&nbsp;file.&nbsp;ParseGlob&nbsp;is</span><br>
<span class="lineno"></span><span class="comment" id="4625868">//&nbsp;equivalent&nbsp;to&nbsp;calling&nbsp;t.ParseFiles&nbsp;with&nbsp;the&nbsp;list&nbsp;of&nbsp;files&nbsp;matched&nbsp;by&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4625944">//&nbsp;pattern.</span><br>
<span class="lineno">375</span><span class="keyword" id="4625956">func</span>&nbsp;<span class="op" id="4625961">(</span><span class="ident" id="4625962">t</span>&nbsp;<span class="op" id="4625964">*</span><span class="ident" id="4625965">Template</span><span class="op" id="4625973">)</span>&nbsp;<span class="ident" id="4625975">ParseGlob</span><span class="op" id="4625984">(</span><span class="ident" id="4625985">pattern</span>&nbsp;<span class="builtintype" id="4625993">string</span><span class="op" id="4625999">)</span>&nbsp;<span class="op" id="4626001">(</span><span class="op" id="4626002">*</span><span class="ident" id="4626003">Template</span><span class="op" id="4626011">,</span>&nbsp;<span class="builtintype" id="4626013">error</span><span class="op" id="4626018">)</span>&nbsp;<span class="op" id="4626020">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626023">return</span>&nbsp;<span class="ident" id="4626030">parseGlob</span><span class="op" id="4626039">(</span><span class="ident" id="4626040">t</span><span class="op" id="4626041">,</span>&nbsp;<span class="ident" id="4626043">pattern</span><span class="op" id="4626050">)</span><br>
<span class="lineno"></span><span class="op" id="4626052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4626055">//&nbsp;parseGlob&nbsp;is&nbsp;the&nbsp;implementation&nbsp;of&nbsp;the&nbsp;function&nbsp;and&nbsp;method&nbsp;ParseGlob.</span><br>
<span class="lineno">380</span><span class="keyword" id="4626128">func</span>&nbsp;<span class="ident" id="4626133">parseGlob</span><span class="op" id="4626142">(</span><span class="ident" id="4626143">t</span>&nbsp;<span class="op" id="4626145">*</span><span class="ident" id="4626146">Template</span><span class="op" id="4626154">,</span>&nbsp;<span class="ident" id="4626156">pattern</span>&nbsp;<span class="builtintype" id="4626164">string</span><span class="op" id="4626170">)</span>&nbsp;<span class="op" id="4626172">(</span><span class="op" id="4626173">*</span><span class="ident" id="4626174">Template</span><span class="op" id="4626182">,</span>&nbsp;<span class="builtintype" id="4626184">error</span><span class="op" id="4626189">)</span>&nbsp;<span class="op" id="4626191">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4626194">filenames</span><span class="op" id="4626203">,</span>&nbsp;<span class="ident" id="4626205">err</span>&nbsp;<span class="op" id="4626209">:=</span>&nbsp;<span class="ident" id="4626212">filepath</span><span class="op" id="4626220">.</span><span class="ident" id="4626221">Glob</span><span class="op" id="4626225">(</span><span class="ident" id="4626226">pattern</span><span class="op" id="4626233">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626236">if</span>&nbsp;<span class="ident" id="4626239">err</span>&nbsp;<span class="op" id="4626243">!=</span>&nbsp;<span class="ident" id="4626246">nil</span>&nbsp;<span class="op" id="4626250">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626254">return</span>&nbsp;<span class="ident" id="4626261">nil</span><span class="op" id="4626264">,</span>&nbsp;<span class="ident" id="4626266">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4626271">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626274">if</span>&nbsp;<span class="builtinfunc" id="4626277">len</span><span class="op" id="4626280">(</span><span class="ident" id="4626281">filenames</span><span class="op" id="4626290">)</span>&nbsp;<span class="op" id="4626292">==</span>&nbsp;<span class="num" id="4626295">0</span>&nbsp;<span class="op" id="4626297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626301">return</span>&nbsp;<span class="ident" id="4626308">nil</span><span class="op" id="4626311">,</span>&nbsp;<span class="ident" id="4626313">fmt</span><span class="op" id="4626316">.</span><span class="ident" id="4626317">Errorf</span><span class="op" id="4626323">(</span><span class="string" id="4626324">&#34;html/template:&nbsp;pattern&nbsp;matches&nbsp;no&nbsp;files:&nbsp;%#q&#34;</span><span class="op" id="4626370">,</span>&nbsp;<span class="ident" id="4626372">pattern</span><span class="op" id="4626379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4626382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4626385">return</span>&nbsp;<span class="ident" id="4626392">parseFiles</span><span class="op" id="4626402">(</span><span class="ident" id="4626403">t</span><span class="op" id="4626404">,</span>&nbsp;<span class="ident" id="4626406">filenames</span><span class="op" id="4626415">...</span><span class="op" id="4626418">)</span><br>
<span class="lineno"></span><span class="op" id="4626420">}</span>
</div>
</body>
</html>
