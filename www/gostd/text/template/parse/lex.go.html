<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>text/template/parse</h2>
<ul>
<li><a href="/gostd/text/template/parse/lex.go.html" class="current">lex.go</a></li>
<li><a href="/gostd/text/template/parse/lex_test.go.html">lex_test.go</a></li>
<li><a href="/gostd/text/template/parse/node.go.html">node.go</a></li>
<li><a href="/gostd/text/template/parse/parse.go.html">parse.go</a></li>
<li><a href="/gostd/text/template/parse/parse_test.go.html">parse_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3077218">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3077273">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3077327">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3077378">package</span>&nbsp;<span class="ident" id="3077386">parse</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3077393">import</span>&nbsp;<span class="op" id="3077400">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3077403">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3077410">&#34;strings&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3077421">&#34;unicode&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3077432">&#34;unicode/utf8&#34;</span><br>
<span class="lineno"></span><span class="op" id="3077447">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3077450">//&nbsp;item&nbsp;represents&nbsp;a&nbsp;token&nbsp;or&nbsp;text&nbsp;string&nbsp;returned&nbsp;from&nbsp;the&nbsp;scanner.</span><br>
<span class="lineno">15</span><span class="keyword" id="3077519">type</span>&nbsp;<span class="ident" id="3077524">item</span>&nbsp;<span class="keyword" id="3077529">struct</span>&nbsp;<span class="op" id="3077536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3077539">typ</span>&nbsp;<span class="ident" id="3077543">itemType</span>&nbsp;<span class="comment" id="3077552">//&nbsp;The&nbsp;type&nbsp;of&nbsp;this&nbsp;item.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3077579">pos</span>&nbsp;<span class="ident" id="3077583">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3077592">//&nbsp;The&nbsp;starting&nbsp;position,&nbsp;in&nbsp;bytes,&nbsp;of&nbsp;this&nbsp;item&nbsp;in&nbsp;the&nbsp;input&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3077663">val</span>&nbsp;<span class="builtintype" id="3077667">string</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3077676">//&nbsp;The&nbsp;value&nbsp;of&nbsp;this&nbsp;item.</span><br>
<span class="lineno"></span><span class="op" id="3077703">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="3077706">func</span>&nbsp;<span class="op" id="3077711">(</span><span class="ident" id="3077712">i</span>&nbsp;<span class="ident" id="3077714">item</span><span class="op" id="3077718">)</span>&nbsp;<span class="ident" id="3077720">String</span><span class="op" id="3077726">(</span><span class="op" id="3077727">)</span>&nbsp;<span class="builtintype" id="3077729">string</span>&nbsp;<span class="op" id="3077736">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077739">switch</span>&nbsp;<span class="op" id="3077746">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077749">case</span>&nbsp;<span class="ident" id="3077754">i</span><span class="op" id="3077755">.</span><span class="ident" id="3077756">typ</span>&nbsp;<span class="op" id="3077760">==</span>&nbsp;<span class="ident" id="3077763">itemEOF</span><span class="op" id="3077770">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077774">return</span>&nbsp;<span class="string" id="3077781">&#34;EOF&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077788">case</span>&nbsp;<span class="ident" id="3077793">i</span><span class="op" id="3077794">.</span><span class="ident" id="3077795">typ</span>&nbsp;<span class="op" id="3077799">==</span>&nbsp;<span class="ident" id="3077802">itemError</span><span class="op" id="3077811">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077815">return</span>&nbsp;<span class="ident" id="3077822">i</span><span class="op" id="3077823">.</span><span class="ident" id="3077824">val</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077829">case</span>&nbsp;<span class="ident" id="3077834">i</span><span class="op" id="3077835">.</span><span class="ident" id="3077836">typ</span>&nbsp;<span class="op" id="3077840">&gt;</span>&nbsp;<span class="ident" id="3077842">itemKeyword</span><span class="op" id="3077853">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077857">return</span>&nbsp;<span class="ident" id="3077864">fmt</span><span class="op" id="3077867">.</span><span class="ident" id="3077868">Sprintf</span><span class="op" id="3077875">(</span><span class="string" id="3077876">&#34;&lt;%s&gt;&#34;</span><span class="op" id="3077882">,</span>&nbsp;<span class="ident" id="3077884">i</span><span class="op" id="3077885">.</span><span class="ident" id="3077886">val</span><span class="op" id="3077889">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077892">case</span>&nbsp;<span class="builtinfunc" id="3077897">len</span><span class="op" id="3077900">(</span><span class="ident" id="3077901">i</span><span class="op" id="3077902">.</span><span class="ident" id="3077903">val</span><span class="op" id="3077906">)</span>&nbsp;<span class="op" id="3077908">&gt;</span>&nbsp;<span class="num" id="3077910">10</span><span class="op" id="3077912">:</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077916">return</span>&nbsp;<span class="ident" id="3077923">fmt</span><span class="op" id="3077926">.</span><span class="ident" id="3077927">Sprintf</span><span class="op" id="3077934">(</span><span class="string" id="3077935">&#34;%.10q...&#34;</span><span class="op" id="3077945">,</span>&nbsp;<span class="ident" id="3077947">i</span><span class="op" id="3077948">.</span><span class="ident" id="3077949">val</span><span class="op" id="3077952">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3077955">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3077958">return</span>&nbsp;<span class="ident" id="3077965">fmt</span><span class="op" id="3077968">.</span><span class="ident" id="3077969">Sprintf</span><span class="op" id="3077976">(</span><span class="string" id="3077977">&#34;%q&#34;</span><span class="op" id="3077981">,</span>&nbsp;<span class="ident" id="3077983">i</span><span class="op" id="3077984">.</span><span class="ident" id="3077985">val</span><span class="op" id="3077988">)</span><br>
<span class="lineno"></span><span class="op" id="3077990">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="3077993">//&nbsp;itemType&nbsp;identifies&nbsp;the&nbsp;type&nbsp;of&nbsp;lex&nbsp;items.</span><br>
<span class="lineno"></span><span class="keyword" id="3078039">type</span>&nbsp;<span class="ident" id="3078044">itemType</span>&nbsp;<span class="builtintype" id="3078053">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3078058">const</span>&nbsp;<span class="op" id="3078064">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078067">itemError</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078084">itemType</span>&nbsp;<span class="op" id="3078093">=</span>&nbsp;<span class="ident" id="3078095">iota</span>&nbsp;<span class="comment" id="3078100">//&nbsp;error&nbsp;occurred;&nbsp;value&nbsp;is&nbsp;text&nbsp;of&nbsp;error</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078143">itemBool</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3078176">//&nbsp;boolean&nbsp;constant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078197">itemChar</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3078230">//&nbsp;printable&nbsp;ASCII&nbsp;character;&nbsp;grab&nbsp;bag&nbsp;for&nbsp;comma&nbsp;etc.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078285">itemCharConstant</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3078318">//&nbsp;character&nbsp;constant</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078341">itemComplex</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3078374">//&nbsp;complex&nbsp;constant&nbsp;(1+2i);&nbsp;imaginary&nbsp;is&nbsp;just&nbsp;a&nbsp;number</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078430">itemColonEquals</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3078463">//&nbsp;colon-equals&nbsp;(&#39;:=&#39;)&nbsp;introducing&nbsp;a&nbsp;declaration</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078513">itemEOF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078522">itemField</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3078537">//&nbsp;alphanumeric&nbsp;identifier&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078583">itemIdentifier</span>&nbsp;<span class="comment" id="3078598">//&nbsp;alphanumeric&nbsp;identifier&nbsp;not&nbsp;starting&nbsp;with&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078648">itemLeftDelim</span>&nbsp;&nbsp;<span class="comment" id="3078663">//&nbsp;left&nbsp;action&nbsp;delimiter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078689">itemLeftParen</span>&nbsp;&nbsp;<span class="comment" id="3078704">//&nbsp;&#39;(&#39;&nbsp;inside&nbsp;action</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078726">itemNumber</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3078741">//&nbsp;simple&nbsp;number,&nbsp;including&nbsp;imaginary</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078780">itemPipe</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3078795">//&nbsp;pipe&nbsp;symbol</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078811">itemRawString</span>&nbsp;&nbsp;<span class="comment" id="3078826">//&nbsp;raw&nbsp;quoted&nbsp;string&nbsp;(includes&nbsp;quotes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078866">itemRightDelim</span>&nbsp;<span class="comment" id="3078881">//&nbsp;right&nbsp;action&nbsp;delimiter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078908">itemRightParen</span>&nbsp;<span class="comment" id="3078923">//&nbsp;&#39;)&#39;&nbsp;inside&nbsp;action</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078945">itemSpace</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3078960">//&nbsp;run&nbsp;of&nbsp;spaces&nbsp;separating&nbsp;arguments</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3078999">itemString</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3079014">//&nbsp;quoted&nbsp;string&nbsp;(includes&nbsp;quotes)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079050">itemText</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3079065">//&nbsp;plain&nbsp;text</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079080">itemVariable</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3079095">//&nbsp;variable&nbsp;starting&nbsp;with&nbsp;&#39;$&#39;,&nbsp;such&nbsp;as&nbsp;&#39;$&#39;&nbsp;or&nbsp;&nbsp;&#39;$1&#39;&nbsp;or&nbsp;&#39;$hello&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3079160">//&nbsp;Keywords&nbsp;appear&nbsp;after&nbsp;all&nbsp;the&nbsp;rest.</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079200">itemKeyword</span>&nbsp;&nbsp;<span class="comment" id="3079213">//&nbsp;used&nbsp;only&nbsp;to&nbsp;delimit&nbsp;the&nbsp;keywords</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079251">itemDot</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3079264">//&nbsp;the&nbsp;cursor,&nbsp;spelled&nbsp;&#39;.&#39;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079292">itemDefine</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3079305">//&nbsp;define&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079324">itemElse</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3079337">//&nbsp;else&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079354">itemEnd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3079367">//&nbsp;end&nbsp;keyword</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079383">itemIf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3079396">//&nbsp;if&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079411">itemNil</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3079424">//&nbsp;the&nbsp;untyped&nbsp;nil&nbsp;constant,&nbsp;easiest&nbsp;to&nbsp;treat&nbsp;as&nbsp;a&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079484">itemRange</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3079497">//&nbsp;range&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079515">itemTemplate</span>&nbsp;<span class="comment" id="3079528">//&nbsp;template&nbsp;keyword</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079549">itemWith</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3079562">//&nbsp;with&nbsp;keyword</span><br>
<span class="lineno">70</span><span class="op" id="3079578">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3079581">var</span>&nbsp;<span class="ident" id="3079585">key</span>&nbsp;<span class="op" id="3079589">=</span>&nbsp;<span class="keyword" id="3079591">map</span><span class="op" id="3079594">[</span><span class="builtintype" id="3079595">string</span><span class="op" id="3079601">]</span><span class="ident" id="3079602">itemType</span><span class="op" id="3079610">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3079613">&#34;.&#34;</span><span class="op" id="3079616">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079625">itemDot</span><span class="op" id="3079632">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3079635">&#34;define&#34;</span><span class="op" id="3079643">:</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="3079647">itemDefine</span><span class="op" id="3079657">,</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3079660">&#34;else&#34;</span><span class="op" id="3079666">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079672">itemElse</span><span class="op" id="3079680">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3079683">&#34;end&#34;</span><span class="op" id="3079688">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079695">itemEnd</span><span class="op" id="3079702">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3079705">&#34;if&#34;</span><span class="op" id="3079709">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079717">itemIf</span><span class="op" id="3079723">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3079726">&#34;range&#34;</span><span class="op" id="3079733">:</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079738">itemRange</span><span class="op" id="3079747">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3079750">&#34;nil&#34;</span><span class="op" id="3079755">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079762">itemNil</span><span class="op" id="3079769">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3079772">&#34;template&#34;</span><span class="op" id="3079782">:</span>&nbsp;<span class="ident" id="3079784">itemTemplate</span><span class="op" id="3079796">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="3079799">&#34;with&#34;</span><span class="op" id="3079805">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3079811">itemWith</span><span class="op" id="3079819">,</span><br>
<span class="lineno"></span><span class="op" id="3079821">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3079824">const</span>&nbsp;<span class="ident" id="3079830">eof</span>&nbsp;<span class="op" id="3079834">=</span>&nbsp;<span class="op" id="3079836">-</span><span class="num" id="3079837">1</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="3079840">//&nbsp;stateFn&nbsp;represents&nbsp;the&nbsp;state&nbsp;of&nbsp;the&nbsp;scanner&nbsp;as&nbsp;a&nbsp;function&nbsp;that&nbsp;returns&nbsp;the&nbsp;next&nbsp;state.</span><br>
<span class="lineno"></span><span class="keyword" id="3079930">type</span>&nbsp;<span class="ident" id="3079935">stateFn</span>&nbsp;<span class="keyword" id="3079943">func</span><span class="op" id="3079947">(</span><span class="op" id="3079948">*</span><span class="ident" id="3079949">lexer</span><span class="op" id="3079954">)</span>&nbsp;<span class="ident" id="3079956">stateFn</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3079965">//&nbsp;lexer&nbsp;holds&nbsp;the&nbsp;state&nbsp;of&nbsp;the&nbsp;scanner.</span><br>
<span class="lineno">90</span><span class="keyword" id="3080006">type</span>&nbsp;<span class="ident" id="3080011">lexer</span>&nbsp;<span class="keyword" id="3080017">struct</span>&nbsp;<span class="op" id="3080024">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080027">name</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3080038">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3080048">//&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;input;&nbsp;used&nbsp;only&nbsp;for&nbsp;error&nbsp;reports</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080103">input</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="3080114">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3080124">//&nbsp;the&nbsp;string&nbsp;being&nbsp;scanned</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080153">leftDelim</span>&nbsp;&nbsp;<span class="builtintype" id="3080164">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3080174">//&nbsp;start&nbsp;of&nbsp;action</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080194">rightDelim</span>&nbsp;<span class="builtintype" id="3080205">string</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3080215">//&nbsp;end&nbsp;of&nbsp;action</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080233">state</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080244">stateFn</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="3080254">//&nbsp;the&nbsp;next&nbsp;lexing&nbsp;function&nbsp;to&nbsp;enter</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080292">pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080303">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3080313">//&nbsp;current&nbsp;position&nbsp;in&nbsp;the&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080347">start</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080358">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3080368">//&nbsp;start&nbsp;position&nbsp;of&nbsp;this&nbsp;item</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080400">width</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080411">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3080421">//&nbsp;width&nbsp;of&nbsp;last&nbsp;rune&nbsp;read&nbsp;from&nbsp;input</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080460">lastPos</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080471">Pos</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3080481">//&nbsp;position&nbsp;of&nbsp;most&nbsp;recent&nbsp;item&nbsp;returned&nbsp;by&nbsp;nextItem</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080535">items</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3080546">chan</span>&nbsp;<span class="ident" id="3080551">item</span>&nbsp;<span class="comment" id="3080556">//&nbsp;channel&nbsp;of&nbsp;scanned&nbsp;items</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080585">parenDepth</span>&nbsp;<span class="builtintype" id="3080596">int</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3080606">//&nbsp;nesting&nbsp;depth&nbsp;of&nbsp;(&nbsp;)&nbsp;exprs</span><br>
<span class="lineno"></span><span class="op" id="3080636">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3080639">//&nbsp;next&nbsp;returns&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno">105</span><span class="keyword" id="3080683">func</span>&nbsp;<span class="op" id="3080688">(</span><span class="ident" id="3080689">l</span>&nbsp;<span class="op" id="3080691">*</span><span class="ident" id="3080692">lexer</span><span class="op" id="3080697">)</span>&nbsp;<span class="ident" id="3080699">next</span><span class="op" id="3080703">(</span><span class="op" id="3080704">)</span>&nbsp;<span class="builtintype" id="3080706">rune</span>&nbsp;<span class="op" id="3080711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3080714">if</span>&nbsp;<span class="builtintype" id="3080717">int</span><span class="op" id="3080720">(</span><span class="ident" id="3080721">l</span><span class="op" id="3080722">.</span><span class="ident" id="3080723">pos</span><span class="op" id="3080726">)</span>&nbsp;<span class="op" id="3080728">&gt;=</span>&nbsp;<span class="builtinfunc" id="3080731">len</span><span class="op" id="3080734">(</span><span class="ident" id="3080735">l</span><span class="op" id="3080736">.</span><span class="ident" id="3080737">input</span><span class="op" id="3080742">)</span>&nbsp;<span class="op" id="3080744">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080748">l</span><span class="op" id="3080749">.</span><span class="ident" id="3080750">width</span>&nbsp;<span class="op" id="3080756">=</span>&nbsp;<span class="num" id="3080758">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3080762">return</span>&nbsp;<span class="ident" id="3080769">eof</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3080774">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080777">r</span><span class="op" id="3080778">,</span>&nbsp;<span class="ident" id="3080780">w</span>&nbsp;<span class="op" id="3080782">:=</span>&nbsp;<span class="ident" id="3080785">utf8</span><span class="op" id="3080789">.</span><span class="ident" id="3080790">DecodeRuneInString</span><span class="op" id="3080808">(</span><span class="ident" id="3080809">l</span><span class="op" id="3080810">.</span><span class="ident" id="3080811">input</span><span class="op" id="3080816">[</span><span class="ident" id="3080817">l</span><span class="op" id="3080818">.</span><span class="ident" id="3080819">pos</span><span class="op" id="3080822">:</span><span class="op" id="3080823">]</span><span class="op" id="3080824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080827">l</span><span class="op" id="3080828">.</span><span class="ident" id="3080829">width</span>&nbsp;<span class="op" id="3080835">=</span>&nbsp;<span class="ident" id="3080837">Pos</span><span class="op" id="3080840">(</span><span class="ident" id="3080841">w</span><span class="op" id="3080842">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080845">l</span><span class="op" id="3080846">.</span><span class="ident" id="3080847">pos</span>&nbsp;<span class="op" id="3080851">+=</span>&nbsp;<span class="ident" id="3080854">l</span><span class="op" id="3080855">.</span><span class="ident" id="3080856">width</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3080863">return</span>&nbsp;<span class="ident" id="3080870">r</span><br>
<span class="lineno"></span><span class="op" id="3080872">}</span><br>
<span class="lineno">115</span><br>
<span class="lineno"></span><span class="comment" id="3080875">//&nbsp;peek&nbsp;returns&nbsp;but&nbsp;does&nbsp;not&nbsp;consume&nbsp;the&nbsp;next&nbsp;rune&nbsp;in&nbsp;the&nbsp;input.</span><br>
<span class="lineno"></span><span class="keyword" id="3080940">func</span>&nbsp;<span class="op" id="3080945">(</span><span class="ident" id="3080946">l</span>&nbsp;<span class="op" id="3080948">*</span><span class="ident" id="3080949">lexer</span><span class="op" id="3080954">)</span>&nbsp;<span class="ident" id="3080956">peek</span><span class="op" id="3080960">(</span><span class="op" id="3080961">)</span>&nbsp;<span class="builtintype" id="3080963">rune</span>&nbsp;<span class="op" id="3080968">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080971">r</span>&nbsp;<span class="op" id="3080973">:=</span>&nbsp;<span class="ident" id="3080976">l</span><span class="op" id="3080977">.</span><span class="ident" id="3080978">next</span><span class="op" id="3080982">(</span><span class="op" id="3080983">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3080986">l</span><span class="op" id="3080987">.</span><span class="ident" id="3080988">backup</span><span class="op" id="3080994">(</span><span class="op" id="3080995">)</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3080998">return</span>&nbsp;<span class="ident" id="3081005">r</span><br>
<span class="lineno"></span><span class="op" id="3081007">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3081010">//&nbsp;backup&nbsp;steps&nbsp;back&nbsp;one&nbsp;rune.&nbsp;Can&nbsp;only&nbsp;be&nbsp;called&nbsp;once&nbsp;per&nbsp;call&nbsp;of&nbsp;next.</span><br>
<span class="lineno"></span><span class="keyword" id="3081083">func</span>&nbsp;<span class="op" id="3081088">(</span><span class="ident" id="3081089">l</span>&nbsp;<span class="op" id="3081091">*</span><span class="ident" id="3081092">lexer</span><span class="op" id="3081097">)</span>&nbsp;<span class="ident" id="3081099">backup</span><span class="op" id="3081105">(</span><span class="op" id="3081106">)</span>&nbsp;<span class="op" id="3081108">{</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081111">l</span><span class="op" id="3081112">.</span><span class="ident" id="3081113">pos</span>&nbsp;<span class="op" id="3081117">-=</span>&nbsp;<span class="ident" id="3081120">l</span><span class="op" id="3081121">.</span><span class="ident" id="3081122">width</span><br>
<span class="lineno"></span><span class="op" id="3081128">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3081131">//&nbsp;emit&nbsp;passes&nbsp;an&nbsp;item&nbsp;back&nbsp;to&nbsp;the&nbsp;client.</span><br>
<span class="lineno"></span><span class="keyword" id="3081174">func</span>&nbsp;<span class="op" id="3081179">(</span><span class="ident" id="3081180">l</span>&nbsp;<span class="op" id="3081182">*</span><span class="ident" id="3081183">lexer</span><span class="op" id="3081188">)</span>&nbsp;<span class="ident" id="3081190">emit</span><span class="op" id="3081194">(</span><span class="ident" id="3081195">t</span>&nbsp;<span class="ident" id="3081197">itemType</span><span class="op" id="3081205">)</span>&nbsp;<span class="op" id="3081207">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081210">l</span><span class="op" id="3081211">.</span><span class="ident" id="3081212">items</span>&nbsp;<span class="op" id="3081218">&lt;-</span>&nbsp;<span class="ident" id="3081221">item</span><span class="op" id="3081225">{</span><span class="ident" id="3081226">t</span><span class="op" id="3081227">,</span>&nbsp;<span class="ident" id="3081229">l</span><span class="op" id="3081230">.</span><span class="ident" id="3081231">start</span><span class="op" id="3081236">,</span>&nbsp;<span class="ident" id="3081238">l</span><span class="op" id="3081239">.</span><span class="ident" id="3081240">input</span><span class="op" id="3081245">[</span><span class="ident" id="3081246">l</span><span class="op" id="3081247">.</span><span class="ident" id="3081248">start</span><span class="op" id="3081253">:</span><span class="ident" id="3081254">l</span><span class="op" id="3081255">.</span><span class="ident" id="3081256">pos</span><span class="op" id="3081259">]</span><span class="op" id="3081260">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081263">l</span><span class="op" id="3081264">.</span><span class="ident" id="3081265">start</span>&nbsp;<span class="op" id="3081271">=</span>&nbsp;<span class="ident" id="3081273">l</span><span class="op" id="3081274">.</span><span class="ident" id="3081275">pos</span><br>
<span class="lineno"></span><span class="op" id="3081279">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3081282">//&nbsp;ignore&nbsp;skips&nbsp;over&nbsp;the&nbsp;pending&nbsp;input&nbsp;before&nbsp;this&nbsp;point.</span><br>
<span class="lineno">135</span><span class="keyword" id="3081340">func</span>&nbsp;<span class="op" id="3081345">(</span><span class="ident" id="3081346">l</span>&nbsp;<span class="op" id="3081348">*</span><span class="ident" id="3081349">lexer</span><span class="op" id="3081354">)</span>&nbsp;<span class="ident" id="3081356">ignore</span><span class="op" id="3081362">(</span><span class="op" id="3081363">)</span>&nbsp;<span class="op" id="3081365">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081368">l</span><span class="op" id="3081369">.</span><span class="ident" id="3081370">start</span>&nbsp;<span class="op" id="3081376">=</span>&nbsp;<span class="ident" id="3081378">l</span><span class="op" id="3081379">.</span><span class="ident" id="3081380">pos</span><br>
<span class="lineno"></span><span class="op" id="3081384">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3081387">//&nbsp;accept&nbsp;consumes&nbsp;the&nbsp;next&nbsp;rune&nbsp;if&nbsp;it&#39;s&nbsp;from&nbsp;the&nbsp;valid&nbsp;set.</span><br>
<span class="lineno">140</span><span class="keyword" id="3081448">func</span>&nbsp;<span class="op" id="3081453">(</span><span class="ident" id="3081454">l</span>&nbsp;<span class="op" id="3081456">*</span><span class="ident" id="3081457">lexer</span><span class="op" id="3081462">)</span>&nbsp;<span class="ident" id="3081464">accept</span><span class="op" id="3081470">(</span><span class="ident" id="3081471">valid</span>&nbsp;<span class="builtintype" id="3081477">string</span><span class="op" id="3081483">)</span>&nbsp;<span class="builtintype" id="3081485">bool</span>&nbsp;<span class="op" id="3081490">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3081493">if</span>&nbsp;<span class="ident" id="3081496">strings</span><span class="op" id="3081503">.</span><span class="ident" id="3081504">IndexRune</span><span class="op" id="3081513">(</span><span class="ident" id="3081514">valid</span><span class="op" id="3081519">,</span>&nbsp;<span class="ident" id="3081521">l</span><span class="op" id="3081522">.</span><span class="ident" id="3081523">next</span><span class="op" id="3081527">(</span><span class="op" id="3081528">)</span><span class="op" id="3081529">)</span>&nbsp;<span class="op" id="3081531">&gt;=</span>&nbsp;<span class="num" id="3081534">0</span>&nbsp;<span class="op" id="3081536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3081540">return</span>&nbsp;<span class="builtintype" id="3081547">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3081553">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081556">l</span><span class="op" id="3081557">.</span><span class="ident" id="3081558">backup</span><span class="op" id="3081564">(</span><span class="op" id="3081565">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3081568">return</span>&nbsp;<span class="builtintype" id="3081575">false</span><br>
<span class="lineno"></span><span class="op" id="3081581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3081584">//&nbsp;acceptRun&nbsp;consumes&nbsp;a&nbsp;run&nbsp;of&nbsp;runes&nbsp;from&nbsp;the&nbsp;valid&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="3081641">func</span>&nbsp;<span class="op" id="3081646">(</span><span class="ident" id="3081647">l</span>&nbsp;<span class="op" id="3081649">*</span><span class="ident" id="3081650">lexer</span><span class="op" id="3081655">)</span>&nbsp;<span class="ident" id="3081657">acceptRun</span><span class="op" id="3081666">(</span><span class="ident" id="3081667">valid</span>&nbsp;<span class="builtintype" id="3081673">string</span><span class="op" id="3081679">)</span>&nbsp;<span class="op" id="3081681">{</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3081684">for</span>&nbsp;<span class="ident" id="3081688">strings</span><span class="op" id="3081695">.</span><span class="ident" id="3081696">IndexRune</span><span class="op" id="3081705">(</span><span class="ident" id="3081706">valid</span><span class="op" id="3081711">,</span>&nbsp;<span class="ident" id="3081713">l</span><span class="op" id="3081714">.</span><span class="ident" id="3081715">next</span><span class="op" id="3081719">(</span><span class="op" id="3081720">)</span><span class="op" id="3081721">)</span>&nbsp;<span class="op" id="3081723">&gt;=</span>&nbsp;<span class="num" id="3081726">0</span>&nbsp;<span class="op" id="3081728">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3081731">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3081734">l</span><span class="op" id="3081735">.</span><span class="ident" id="3081736">backup</span><span class="op" id="3081742">(</span><span class="op" id="3081743">)</span><br>
<span class="lineno"></span><span class="op" id="3081745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">155</span><span class="comment" id="3081748">//&nbsp;lineNumber&nbsp;reports&nbsp;which&nbsp;line&nbsp;we&#39;re&nbsp;on,&nbsp;based&nbsp;on&nbsp;the&nbsp;position&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="3081816">//&nbsp;the&nbsp;previous&nbsp;item&nbsp;returned&nbsp;by&nbsp;nextItem.&nbsp;Doing&nbsp;it&nbsp;this&nbsp;way</span><br>
<span class="lineno"></span><span class="comment" id="3081877">//&nbsp;means&nbsp;we&nbsp;don&#39;t&nbsp;have&nbsp;to&nbsp;worry&nbsp;about&nbsp;peek&nbsp;double&nbsp;counting.</span><br>
<span class="lineno"></span><span class="keyword" id="3081937">func</span>&nbsp;<span class="op" id="3081942">(</span><span class="ident" id="3081943">l</span>&nbsp;<span class="op" id="3081945">*</span><span class="ident" id="3081946">lexer</span><span class="op" id="3081951">)</span>&nbsp;<span class="ident" id="3081953">lineNumber</span><span class="op" id="3081963">(</span><span class="op" id="3081964">)</span>&nbsp;<span class="builtintype" id="3081966">int</span>&nbsp;<span class="op" id="3081970">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3081973">return</span>&nbsp;<span class="num" id="3081980">1</span>&nbsp;<span class="op" id="3081982">+</span>&nbsp;<span class="ident" id="3081984">strings</span><span class="op" id="3081991">.</span><span class="ident" id="3081992">Count</span><span class="op" id="3081997">(</span><span class="ident" id="3081998">l</span><span class="op" id="3081999">.</span><span class="ident" id="3082000">input</span><span class="op" id="3082005">[</span><span class="op" id="3082006">:</span><span class="ident" id="3082007">l</span><span class="op" id="3082008">.</span><span class="ident" id="3082009">lastPos</span><span class="op" id="3082016">]</span><span class="op" id="3082017">,</span>&nbsp;<span class="string" id="3082019">&#34;\n&#34;</span><span class="op" id="3082023">)</span><br>
<span class="lineno">160</span><span class="op" id="3082025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3082028">//&nbsp;errorf&nbsp;returns&nbsp;an&nbsp;error&nbsp;token&nbsp;and&nbsp;terminates&nbsp;the&nbsp;scan&nbsp;by&nbsp;passing</span><br>
<span class="lineno"></span><span class="comment" id="3082096">//&nbsp;back&nbsp;a&nbsp;nil&nbsp;pointer&nbsp;that&nbsp;will&nbsp;be&nbsp;the&nbsp;next&nbsp;state,&nbsp;terminating&nbsp;l.nextItem.</span><br>
<span class="lineno"></span><span class="keyword" id="3082171">func</span>&nbsp;<span class="op" id="3082176">(</span><span class="ident" id="3082177">l</span>&nbsp;<span class="op" id="3082179">*</span><span class="ident" id="3082180">lexer</span><span class="op" id="3082185">)</span>&nbsp;<span class="ident" id="3082187">errorf</span><span class="op" id="3082193">(</span><span class="ident" id="3082194">format</span>&nbsp;<span class="builtintype" id="3082201">string</span><span class="op" id="3082207">,</span>&nbsp;<span class="ident" id="3082209">args</span>&nbsp;<span class="op" id="3082214">...</span><span class="keyword" id="3082217">interface</span><span class="op" id="3082226">{</span><span class="op" id="3082227">}</span><span class="op" id="3082228">)</span>&nbsp;<span class="ident" id="3082230">stateFn</span>&nbsp;<span class="op" id="3082238">{</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082241">l</span><span class="op" id="3082242">.</span><span class="ident" id="3082243">items</span>&nbsp;<span class="op" id="3082249">&lt;-</span>&nbsp;<span class="ident" id="3082252">item</span><span class="op" id="3082256">{</span><span class="ident" id="3082257">itemError</span><span class="op" id="3082266">,</span>&nbsp;<span class="ident" id="3082268">l</span><span class="op" id="3082269">.</span><span class="ident" id="3082270">start</span><span class="op" id="3082275">,</span>&nbsp;<span class="ident" id="3082277">fmt</span><span class="op" id="3082280">.</span><span class="ident" id="3082281">Sprintf</span><span class="op" id="3082288">(</span><span class="ident" id="3082289">format</span><span class="op" id="3082295">,</span>&nbsp;<span class="ident" id="3082297">args</span><span class="op" id="3082301">...</span><span class="op" id="3082304">)</span><span class="op" id="3082305">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3082308">return</span>&nbsp;<span class="builtintype" id="3082315">nil</span><br>
<span class="lineno"></span><span class="op" id="3082319">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3082322">//&nbsp;nextItem&nbsp;returns&nbsp;the&nbsp;next&nbsp;item&nbsp;from&nbsp;the&nbsp;input.</span><br>
<span class="lineno">170</span><span class="keyword" id="3082372">func</span>&nbsp;<span class="op" id="3082377">(</span><span class="ident" id="3082378">l</span>&nbsp;<span class="op" id="3082380">*</span><span class="ident" id="3082381">lexer</span><span class="op" id="3082386">)</span>&nbsp;<span class="ident" id="3082388">nextItem</span><span class="op" id="3082396">(</span><span class="op" id="3082397">)</span>&nbsp;<span class="ident" id="3082399">item</span>&nbsp;<span class="op" id="3082404">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082407">item</span>&nbsp;<span class="op" id="3082412">:=</span>&nbsp;<span class="op" id="3082415">&lt;-</span><span class="ident" id="3082417">l</span><span class="op" id="3082418">.</span><span class="ident" id="3082419">items</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082426">l</span><span class="op" id="3082427">.</span><span class="ident" id="3082428">lastPos</span>&nbsp;<span class="op" id="3082436">=</span>&nbsp;<span class="ident" id="3082438">item</span><span class="op" id="3082442">.</span><span class="ident" id="3082443">pos</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3082448">return</span>&nbsp;<span class="ident" id="3082455">item</span><br>
<span class="lineno"></span><span class="op" id="3082460">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="3082463">//&nbsp;lex&nbsp;creates&nbsp;a&nbsp;new&nbsp;scanner&nbsp;for&nbsp;the&nbsp;input&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3082514">func</span>&nbsp;<span class="ident" id="3082519">lex</span><span class="op" id="3082522">(</span><span class="ident" id="3082523">name</span><span class="op" id="3082527">,</span>&nbsp;<span class="ident" id="3082529">input</span><span class="op" id="3082534">,</span>&nbsp;<span class="ident" id="3082536">left</span><span class="op" id="3082540">,</span>&nbsp;<span class="ident" id="3082542">right</span>&nbsp;<span class="builtintype" id="3082548">string</span><span class="op" id="3082554">)</span>&nbsp;<span class="op" id="3082556">*</span><span class="ident" id="3082557">lexer</span>&nbsp;<span class="op" id="3082563">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3082566">if</span>&nbsp;<span class="ident" id="3082569">left</span>&nbsp;<span class="op" id="3082574">==</span>&nbsp;<span class="string" id="3082577">&#34;&#34;</span>&nbsp;<span class="op" id="3082580">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082584">left</span>&nbsp;<span class="op" id="3082589">=</span>&nbsp;<span class="ident" id="3082591">leftDelim</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3082602">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3082605">if</span>&nbsp;<span class="ident" id="3082608">right</span>&nbsp;<span class="op" id="3082614">==</span>&nbsp;<span class="string" id="3082617">&#34;&#34;</span>&nbsp;<span class="op" id="3082620">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082624">right</span>&nbsp;<span class="op" id="3082630">=</span>&nbsp;<span class="ident" id="3082632">rightDelim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3082644">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082647">l</span>&nbsp;<span class="op" id="3082649">:=</span>&nbsp;<span class="op" id="3082652">&amp;</span><span class="ident" id="3082653">lexer</span><span class="op" id="3082658">{</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082662">name</span><span class="op" id="3082666">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082674">name</span><span class="op" id="3082678">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082682">input</span><span class="op" id="3082687">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082694">input</span><span class="op" id="3082699">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082703">leftDelim</span><span class="op" id="3082712">:</span>&nbsp;&nbsp;<span class="ident" id="3082715">left</span><span class="op" id="3082719">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082723">rightDelim</span><span class="op" id="3082733">:</span>&nbsp;<span class="ident" id="3082735">right</span><span class="op" id="3082740">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082744">items</span><span class="op" id="3082749">:</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="3082756">make</span><span class="op" id="3082760">(</span><span class="keyword" id="3082761">chan</span>&nbsp;<span class="ident" id="3082766">item</span><span class="op" id="3082770">)</span><span class="op" id="3082771">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3082774">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3082777">go</span>&nbsp;<span class="ident" id="3082780">l</span><span class="op" id="3082781">.</span><span class="ident" id="3082782">run</span><span class="op" id="3082785">(</span><span class="op" id="3082786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3082789">return</span>&nbsp;<span class="ident" id="3082796">l</span><br>
<span class="lineno"></span><span class="op" id="3082798">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">195</span><span class="comment" id="3082801">//&nbsp;run&nbsp;runs&nbsp;the&nbsp;state&nbsp;machine&nbsp;for&nbsp;the&nbsp;lexer.</span><br>
<span class="lineno"></span><span class="keyword" id="3082846">func</span>&nbsp;<span class="op" id="3082851">(</span><span class="ident" id="3082852">l</span>&nbsp;<span class="op" id="3082854">*</span><span class="ident" id="3082855">lexer</span><span class="op" id="3082860">)</span>&nbsp;<span class="ident" id="3082862">run</span><span class="op" id="3082865">(</span><span class="op" id="3082866">)</span>&nbsp;<span class="op" id="3082868">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3082871">for</span>&nbsp;<span class="ident" id="3082875">l</span><span class="op" id="3082876">.</span><span class="ident" id="3082877">state</span>&nbsp;<span class="op" id="3082883">=</span>&nbsp;<span class="ident" id="3082885">lexText</span><span class="op" id="3082892">;</span>&nbsp;<span class="ident" id="3082894">l</span><span class="op" id="3082895">.</span><span class="ident" id="3082896">state</span>&nbsp;<span class="op" id="3082902">!=</span>&nbsp;<span class="builtintype" id="3082905">nil</span><span class="op" id="3082908">;</span>&nbsp;<span class="op" id="3082910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082914">l</span><span class="op" id="3082915">.</span><span class="ident" id="3082916">state</span>&nbsp;<span class="op" id="3082922">=</span>&nbsp;<span class="ident" id="3082924">l</span><span class="op" id="3082925">.</span><span class="ident" id="3082926">state</span><span class="op" id="3082931">(</span><span class="ident" id="3082932">l</span><span class="op" id="3082933">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3082936">}</span><br>
<span class="lineno">200</span><span class="op" id="3082938">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3082941">//&nbsp;state&nbsp;functions</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3082961">const</span>&nbsp;<span class="op" id="3082967">(</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082970">leftDelim</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3082983">=</span>&nbsp;<span class="string" id="3082985">&#34;{{&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3082991">rightDelim</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3083004">=</span>&nbsp;<span class="string" id="3083006">&#34;}}&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083012">leftComment</span>&nbsp;&nbsp;<span class="op" id="3083025">=</span>&nbsp;<span class="string" id="3083027">&#34;/*&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083033">rightComment</span>&nbsp;<span class="op" id="3083046">=</span>&nbsp;<span class="string" id="3083048">&#34;*/&#34;</span><br>
<span class="lineno"></span><span class="op" id="3083053">)</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="comment" id="3083056">//&nbsp;lexText&nbsp;scans&nbsp;until&nbsp;an&nbsp;opening&nbsp;action&nbsp;delimiter,&nbsp;&#34;{{&#34;.</span><br>
<span class="lineno"></span><span class="keyword" id="3083114">func</span>&nbsp;<span class="ident" id="3083119">lexText</span><span class="op" id="3083126">(</span><span class="ident" id="3083127">l</span>&nbsp;<span class="op" id="3083129">*</span><span class="ident" id="3083130">lexer</span><span class="op" id="3083135">)</span>&nbsp;<span class="ident" id="3083137">stateFn</span>&nbsp;<span class="op" id="3083145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083148">for</span>&nbsp;<span class="op" id="3083152">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083156">if</span>&nbsp;<span class="ident" id="3083159">strings</span><span class="op" id="3083166">.</span><span class="ident" id="3083167">HasPrefix</span><span class="op" id="3083176">(</span><span class="ident" id="3083177">l</span><span class="op" id="3083178">.</span><span class="ident" id="3083179">input</span><span class="op" id="3083184">[</span><span class="ident" id="3083185">l</span><span class="op" id="3083186">.</span><span class="ident" id="3083187">pos</span><span class="op" id="3083190">:</span><span class="op" id="3083191">]</span><span class="op" id="3083192">,</span>&nbsp;<span class="ident" id="3083194">l</span><span class="op" id="3083195">.</span><span class="ident" id="3083196">leftDelim</span><span class="op" id="3083205">)</span>&nbsp;<span class="op" id="3083207">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083212">if</span>&nbsp;<span class="ident" id="3083215">l</span><span class="op" id="3083216">.</span><span class="ident" id="3083217">pos</span>&nbsp;<span class="op" id="3083221">&gt;</span>&nbsp;<span class="ident" id="3083223">l</span><span class="op" id="3083224">.</span><span class="ident" id="3083225">start</span>&nbsp;<span class="op" id="3083231">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083237">l</span><span class="op" id="3083238">.</span><span class="ident" id="3083239">emit</span><span class="op" id="3083243">(</span><span class="ident" id="3083244">itemText</span><span class="op" id="3083252">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3083257">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083262">return</span>&nbsp;<span class="ident" id="3083269">lexLeftDelim</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3083284">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083288">if</span>&nbsp;<span class="ident" id="3083291">l</span><span class="op" id="3083292">.</span><span class="ident" id="3083293">next</span><span class="op" id="3083297">(</span><span class="op" id="3083298">)</span>&nbsp;<span class="op" id="3083300">==</span>&nbsp;<span class="ident" id="3083303">eof</span>&nbsp;<span class="op" id="3083307">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083312">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3083320">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3083323">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3083326">//&nbsp;Correctly&nbsp;reached&nbsp;EOF.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083353">if</span>&nbsp;<span class="ident" id="3083356">l</span><span class="op" id="3083357">.</span><span class="ident" id="3083358">pos</span>&nbsp;<span class="op" id="3083362">&gt;</span>&nbsp;<span class="ident" id="3083364">l</span><span class="op" id="3083365">.</span><span class="ident" id="3083366">start</span>&nbsp;<span class="op" id="3083372">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083376">l</span><span class="op" id="3083377">.</span><span class="ident" id="3083378">emit</span><span class="op" id="3083382">(</span><span class="ident" id="3083383">itemText</span><span class="op" id="3083391">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3083394">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083397">l</span><span class="op" id="3083398">.</span><span class="ident" id="3083399">emit</span><span class="op" id="3083403">(</span><span class="ident" id="3083404">itemEOF</span><span class="op" id="3083411">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083414">return</span>&nbsp;<span class="builtintype" id="3083421">nil</span><br>
<span class="lineno">230</span><span class="op" id="3083425">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3083428">//&nbsp;lexLeftDelim&nbsp;scans&nbsp;the&nbsp;left&nbsp;delimiter,&nbsp;which&nbsp;is&nbsp;known&nbsp;to&nbsp;be&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="3083500">func</span>&nbsp;<span class="ident" id="3083505">lexLeftDelim</span><span class="op" id="3083517">(</span><span class="ident" id="3083518">l</span>&nbsp;<span class="op" id="3083520">*</span><span class="ident" id="3083521">lexer</span><span class="op" id="3083526">)</span>&nbsp;<span class="ident" id="3083528">stateFn</span>&nbsp;<span class="op" id="3083536">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083539">l</span><span class="op" id="3083540">.</span><span class="ident" id="3083541">pos</span>&nbsp;<span class="op" id="3083545">+=</span>&nbsp;<span class="ident" id="3083548">Pos</span><span class="op" id="3083551">(</span><span class="builtinfunc" id="3083552">len</span><span class="op" id="3083555">(</span><span class="ident" id="3083556">l</span><span class="op" id="3083557">.</span><span class="ident" id="3083558">leftDelim</span><span class="op" id="3083567">)</span><span class="op" id="3083568">)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083571">if</span>&nbsp;<span class="ident" id="3083574">strings</span><span class="op" id="3083581">.</span><span class="ident" id="3083582">HasPrefix</span><span class="op" id="3083591">(</span><span class="ident" id="3083592">l</span><span class="op" id="3083593">.</span><span class="ident" id="3083594">input</span><span class="op" id="3083599">[</span><span class="ident" id="3083600">l</span><span class="op" id="3083601">.</span><span class="ident" id="3083602">pos</span><span class="op" id="3083605">:</span><span class="op" id="3083606">]</span><span class="op" id="3083607">,</span>&nbsp;<span class="ident" id="3083609">leftComment</span><span class="op" id="3083620">)</span>&nbsp;<span class="op" id="3083622">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083626">return</span>&nbsp;<span class="ident" id="3083633">lexComment</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3083645">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083648">l</span><span class="op" id="3083649">.</span><span class="ident" id="3083650">emit</span><span class="op" id="3083654">(</span><span class="ident" id="3083655">itemLeftDelim</span><span class="op" id="3083668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083671">l</span><span class="op" id="3083672">.</span><span class="ident" id="3083673">parenDepth</span>&nbsp;<span class="op" id="3083684">=</span>&nbsp;<span class="num" id="3083686">0</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083689">return</span>&nbsp;<span class="ident" id="3083696">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="3083712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3083715">//&nbsp;lexComment&nbsp;scans&nbsp;a&nbsp;comment.&nbsp;The&nbsp;left&nbsp;comment&nbsp;marker&nbsp;is&nbsp;known&nbsp;to&nbsp;be&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="3083794">func</span>&nbsp;<span class="ident" id="3083799">lexComment</span><span class="op" id="3083809">(</span><span class="ident" id="3083810">l</span>&nbsp;<span class="op" id="3083812">*</span><span class="ident" id="3083813">lexer</span><span class="op" id="3083818">)</span>&nbsp;<span class="ident" id="3083820">stateFn</span>&nbsp;<span class="op" id="3083828">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083831">l</span><span class="op" id="3083832">.</span><span class="ident" id="3083833">pos</span>&nbsp;<span class="op" id="3083837">+=</span>&nbsp;<span class="ident" id="3083840">Pos</span><span class="op" id="3083843">(</span><span class="builtinfunc" id="3083844">len</span><span class="op" id="3083847">(</span><span class="ident" id="3083848">leftComment</span><span class="op" id="3083859">)</span><span class="op" id="3083860">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083863">i</span>&nbsp;<span class="op" id="3083865">:=</span>&nbsp;<span class="ident" id="3083868">strings</span><span class="op" id="3083875">.</span><span class="ident" id="3083876">Index</span><span class="op" id="3083881">(</span><span class="ident" id="3083882">l</span><span class="op" id="3083883">.</span><span class="ident" id="3083884">input</span><span class="op" id="3083889">[</span><span class="ident" id="3083890">l</span><span class="op" id="3083891">.</span><span class="ident" id="3083892">pos</span><span class="op" id="3083895">:</span><span class="op" id="3083896">]</span><span class="op" id="3083897">,</span>&nbsp;<span class="ident" id="3083899">rightComment</span><span class="op" id="3083911">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083914">if</span>&nbsp;<span class="ident" id="3083917">i</span>&nbsp;<span class="op" id="3083919">&lt;</span>&nbsp;<span class="num" id="3083921">0</span>&nbsp;<span class="op" id="3083923">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3083927">return</span>&nbsp;<span class="ident" id="3083934">l</span><span class="op" id="3083935">.</span><span class="ident" id="3083936">errorf</span><span class="op" id="3083942">(</span><span class="string" id="3083943">&#34;unclosed&nbsp;comment&#34;</span><span class="op" id="3083961">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3083964">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3083967">l</span><span class="op" id="3083968">.</span><span class="ident" id="3083969">pos</span>&nbsp;<span class="op" id="3083973">+=</span>&nbsp;<span class="ident" id="3083976">Pos</span><span class="op" id="3083979">(</span><span class="ident" id="3083980">i</span>&nbsp;<span class="op" id="3083982">+</span>&nbsp;<span class="builtinfunc" id="3083984">len</span><span class="op" id="3083987">(</span><span class="ident" id="3083988">rightComment</span><span class="op" id="3084000">)</span><span class="op" id="3084001">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084004">if</span>&nbsp;<span class="op" id="3084007">!</span><span class="ident" id="3084008">strings</span><span class="op" id="3084015">.</span><span class="ident" id="3084016">HasPrefix</span><span class="op" id="3084025">(</span><span class="ident" id="3084026">l</span><span class="op" id="3084027">.</span><span class="ident" id="3084028">input</span><span class="op" id="3084033">[</span><span class="ident" id="3084034">l</span><span class="op" id="3084035">.</span><span class="ident" id="3084036">pos</span><span class="op" id="3084039">:</span><span class="op" id="3084040">]</span><span class="op" id="3084041">,</span>&nbsp;<span class="ident" id="3084043">l</span><span class="op" id="3084044">.</span><span class="ident" id="3084045">rightDelim</span><span class="op" id="3084055">)</span>&nbsp;<span class="op" id="3084057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084061">return</span>&nbsp;<span class="ident" id="3084068">l</span><span class="op" id="3084069">.</span><span class="ident" id="3084070">errorf</span><span class="op" id="3084076">(</span><span class="string" id="3084077">&#34;comment&nbsp;ends&nbsp;before&nbsp;closing&nbsp;delimiter&#34;</span><span class="op" id="3084116">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3084120">}</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3084123">l</span><span class="op" id="3084124">.</span><span class="ident" id="3084125">pos</span>&nbsp;<span class="op" id="3084129">+=</span>&nbsp;<span class="ident" id="3084132">Pos</span><span class="op" id="3084135">(</span><span class="builtinfunc" id="3084136">len</span><span class="op" id="3084139">(</span><span class="ident" id="3084140">l</span><span class="op" id="3084141">.</span><span class="ident" id="3084142">rightDelim</span><span class="op" id="3084152">)</span><span class="op" id="3084153">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3084156">l</span><span class="op" id="3084157">.</span><span class="ident" id="3084158">ignore</span><span class="op" id="3084164">(</span><span class="op" id="3084165">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084168">return</span>&nbsp;<span class="ident" id="3084175">lexText</span><br>
<span class="lineno"></span><span class="op" id="3084183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="3084186">//&nbsp;lexRightDelim&nbsp;scans&nbsp;the&nbsp;right&nbsp;delimiter,&nbsp;which&nbsp;is&nbsp;known&nbsp;to&nbsp;be&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="3084260">func</span>&nbsp;<span class="ident" id="3084265">lexRightDelim</span><span class="op" id="3084278">(</span><span class="ident" id="3084279">l</span>&nbsp;<span class="op" id="3084281">*</span><span class="ident" id="3084282">lexer</span><span class="op" id="3084287">)</span>&nbsp;<span class="ident" id="3084289">stateFn</span>&nbsp;<span class="op" id="3084297">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3084300">l</span><span class="op" id="3084301">.</span><span class="ident" id="3084302">pos</span>&nbsp;<span class="op" id="3084306">+=</span>&nbsp;<span class="ident" id="3084309">Pos</span><span class="op" id="3084312">(</span><span class="builtinfunc" id="3084313">len</span><span class="op" id="3084316">(</span><span class="ident" id="3084317">l</span><span class="op" id="3084318">.</span><span class="ident" id="3084319">rightDelim</span><span class="op" id="3084329">)</span><span class="op" id="3084330">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3084333">l</span><span class="op" id="3084334">.</span><span class="ident" id="3084335">emit</span><span class="op" id="3084339">(</span><span class="ident" id="3084340">itemRightDelim</span><span class="op" id="3084354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084357">return</span>&nbsp;<span class="ident" id="3084364">lexText</span><br>
<span class="lineno">265</span><span class="op" id="3084372">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3084375">//&nbsp;lexInsideAction&nbsp;scans&nbsp;the&nbsp;elements&nbsp;inside&nbsp;action&nbsp;delimiters.</span><br>
<span class="lineno"></span><span class="keyword" id="3084439">func</span>&nbsp;<span class="ident" id="3084444">lexInsideAction</span><span class="op" id="3084459">(</span><span class="ident" id="3084460">l</span>&nbsp;<span class="op" id="3084462">*</span><span class="ident" id="3084463">lexer</span><span class="op" id="3084468">)</span>&nbsp;<span class="ident" id="3084470">stateFn</span>&nbsp;<span class="op" id="3084478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3084481">//&nbsp;Either&nbsp;number,&nbsp;quoted&nbsp;string,&nbsp;or&nbsp;identifier.</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3084530">//&nbsp;Spaces&nbsp;separate&nbsp;arguments;&nbsp;runs&nbsp;of&nbsp;spaces&nbsp;turn&nbsp;into&nbsp;itemSpace.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3084597">//&nbsp;Pipe&nbsp;symbols&nbsp;separate&nbsp;and&nbsp;are&nbsp;emitted.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084640">if</span>&nbsp;<span class="ident" id="3084643">strings</span><span class="op" id="3084650">.</span><span class="ident" id="3084651">HasPrefix</span><span class="op" id="3084660">(</span><span class="ident" id="3084661">l</span><span class="op" id="3084662">.</span><span class="ident" id="3084663">input</span><span class="op" id="3084668">[</span><span class="ident" id="3084669">l</span><span class="op" id="3084670">.</span><span class="ident" id="3084671">pos</span><span class="op" id="3084674">:</span><span class="op" id="3084675">]</span><span class="op" id="3084676">,</span>&nbsp;<span class="ident" id="3084678">l</span><span class="op" id="3084679">.</span><span class="ident" id="3084680">rightDelim</span><span class="op" id="3084690">)</span>&nbsp;<span class="op" id="3084692">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084696">if</span>&nbsp;<span class="ident" id="3084699">l</span><span class="op" id="3084700">.</span><span class="ident" id="3084701">parenDepth</span>&nbsp;<span class="op" id="3084712">==</span>&nbsp;<span class="num" id="3084715">0</span>&nbsp;<span class="op" id="3084717">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084722">return</span>&nbsp;<span class="ident" id="3084729">lexRightDelim</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3084745">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084749">return</span>&nbsp;<span class="ident" id="3084756">l</span><span class="op" id="3084757">.</span><span class="ident" id="3084758">errorf</span><span class="op" id="3084764">(</span><span class="string" id="3084765">&#34;unclosed&nbsp;left&nbsp;paren&#34;</span><span class="op" id="3084786">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3084789">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084792">switch</span>&nbsp;<span class="ident" id="3084799">r</span>&nbsp;<span class="op" id="3084801">:=</span>&nbsp;<span class="ident" id="3084804">l</span><span class="op" id="3084805">.</span><span class="ident" id="3084806">next</span><span class="op" id="3084810">(</span><span class="op" id="3084811">)</span><span class="op" id="3084812">;</span>&nbsp;<span class="op" id="3084814">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084817">case</span>&nbsp;<span class="ident" id="3084822">r</span>&nbsp;<span class="op" id="3084824">==</span>&nbsp;<span class="ident" id="3084827">eof</span>&nbsp;<span class="op" id="3084831">||</span>&nbsp;<span class="ident" id="3084834">isEndOfLine</span><span class="op" id="3084845">(</span><span class="ident" id="3084846">r</span><span class="op" id="3084847">)</span><span class="op" id="3084848">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084852">return</span>&nbsp;<span class="ident" id="3084859">l</span><span class="op" id="3084860">.</span><span class="ident" id="3084861">errorf</span><span class="op" id="3084867">(</span><span class="string" id="3084868">&#34;unclosed&nbsp;action&#34;</span><span class="op" id="3084885">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084888">case</span>&nbsp;<span class="ident" id="3084893">isSpace</span><span class="op" id="3084900">(</span><span class="ident" id="3084901">r</span><span class="op" id="3084902">)</span><span class="op" id="3084903">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084907">return</span>&nbsp;<span class="ident" id="3084914">lexSpace</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084924">case</span>&nbsp;<span class="ident" id="3084929">r</span>&nbsp;<span class="op" id="3084931">==</span>&nbsp;<span class="string" id="3084934">&#39;:&#39;</span><span class="op" id="3084937">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084941">if</span>&nbsp;<span class="ident" id="3084944">l</span><span class="op" id="3084945">.</span><span class="ident" id="3084946">next</span><span class="op" id="3084950">(</span><span class="op" id="3084951">)</span>&nbsp;<span class="op" id="3084953">!=</span>&nbsp;<span class="string" id="3084956">&#39;=&#39;</span>&nbsp;<span class="op" id="3084960">{</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3084965">return</span>&nbsp;<span class="ident" id="3084972">l</span><span class="op" id="3084973">.</span><span class="ident" id="3084974">errorf</span><span class="op" id="3084980">(</span><span class="string" id="3084981">&#34;expected&nbsp;:=&#34;</span><span class="op" id="3084994">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3084998">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085002">l</span><span class="op" id="3085003">.</span><span class="ident" id="3085004">emit</span><span class="op" id="3085008">(</span><span class="ident" id="3085009">itemColonEquals</span><span class="op" id="3085024">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085027">case</span>&nbsp;<span class="ident" id="3085032">r</span>&nbsp;<span class="op" id="3085034">==</span>&nbsp;<span class="string" id="3085037">&#39;|&#39;</span><span class="op" id="3085040">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085044">l</span><span class="op" id="3085045">.</span><span class="ident" id="3085046">emit</span><span class="op" id="3085050">(</span><span class="ident" id="3085051">itemPipe</span><span class="op" id="3085059">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085062">case</span>&nbsp;<span class="ident" id="3085067">r</span>&nbsp;<span class="op" id="3085069">==</span>&nbsp;<span class="string" id="3085072">&#39;&#34;&#39;</span><span class="op" id="3085075">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085079">return</span>&nbsp;<span class="ident" id="3085086">lexQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085096">case</span>&nbsp;<span class="ident" id="3085101">r</span>&nbsp;<span class="op" id="3085103">==</span>&nbsp;<span class="string" id="3085106">&#39;`&#39;</span><span class="op" id="3085109">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085113">return</span>&nbsp;<span class="ident" id="3085120">lexRawQuote</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085133">case</span>&nbsp;<span class="ident" id="3085138">r</span>&nbsp;<span class="op" id="3085140">==</span>&nbsp;<span class="string" id="3085143">&#39;$&#39;</span><span class="op" id="3085146">:</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085150">return</span>&nbsp;<span class="ident" id="3085157">lexVariable</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085170">case</span>&nbsp;<span class="ident" id="3085175">r</span>&nbsp;<span class="op" id="3085177">==</span>&nbsp;<span class="string" id="3085180">&#39;\&#39;&#39;</span><span class="op" id="3085184">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085188">return</span>&nbsp;<span class="ident" id="3085195">lexChar</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085204">case</span>&nbsp;<span class="ident" id="3085209">r</span>&nbsp;<span class="op" id="3085211">==</span>&nbsp;<span class="string" id="3085214">&#39;.&#39;</span><span class="op" id="3085217">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3085221">//&nbsp;special&nbsp;look-ahead&nbsp;for&nbsp;&#34;.field&#34;&nbsp;so&nbsp;we&nbsp;don&#39;t&nbsp;break&nbsp;l.backup().</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085288">if</span>&nbsp;<span class="ident" id="3085291">l</span><span class="op" id="3085292">.</span><span class="ident" id="3085293">pos</span>&nbsp;<span class="op" id="3085297">&lt;</span>&nbsp;<span class="ident" id="3085299">Pos</span><span class="op" id="3085302">(</span><span class="builtinfunc" id="3085303">len</span><span class="op" id="3085306">(</span><span class="ident" id="3085307">l</span><span class="op" id="3085308">.</span><span class="ident" id="3085309">input</span><span class="op" id="3085314">)</span><span class="op" id="3085315">)</span>&nbsp;<span class="op" id="3085317">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085322">r</span>&nbsp;<span class="op" id="3085324">:=</span>&nbsp;<span class="ident" id="3085327">l</span><span class="op" id="3085328">.</span><span class="ident" id="3085329">input</span><span class="op" id="3085334">[</span><span class="ident" id="3085335">l</span><span class="op" id="3085336">.</span><span class="ident" id="3085337">pos</span><span class="op" id="3085340">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085345">if</span>&nbsp;<span class="ident" id="3085348">r</span>&nbsp;<span class="op" id="3085350">&lt;</span>&nbsp;<span class="string" id="3085352">&#39;0&#39;</span>&nbsp;<span class="op" id="3085356">||</span>&nbsp;<span class="string" id="3085359">&#39;9&#39;</span>&nbsp;<span class="op" id="3085363">&lt;</span>&nbsp;<span class="ident" id="3085365">r</span>&nbsp;<span class="op" id="3085367">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085373">return</span>&nbsp;<span class="ident" id="3085380">lexField</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3085392">}</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3085396">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085400">fallthrough</span>&nbsp;<span class="comment" id="3085412">//&nbsp;&#39;.&#39;&nbsp;can&nbsp;start&nbsp;a&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085440">case</span>&nbsp;<span class="ident" id="3085445">r</span>&nbsp;<span class="op" id="3085447">==</span>&nbsp;<span class="string" id="3085450">&#39;+&#39;</span>&nbsp;<span class="op" id="3085454">||</span>&nbsp;<span class="ident" id="3085457">r</span>&nbsp;<span class="op" id="3085459">==</span>&nbsp;<span class="string" id="3085462">&#39;-&#39;</span>&nbsp;<span class="op" id="3085466">||</span>&nbsp;<span class="op" id="3085469">(</span><span class="string" id="3085470">&#39;0&#39;</span>&nbsp;<span class="op" id="3085474">&lt;=</span>&nbsp;<span class="ident" id="3085477">r</span>&nbsp;<span class="op" id="3085479">&amp;&amp;</span>&nbsp;<span class="ident" id="3085482">r</span>&nbsp;<span class="op" id="3085484">&lt;=</span>&nbsp;<span class="string" id="3085487">&#39;9&#39;</span><span class="op" id="3085490">)</span><span class="op" id="3085491">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085495">l</span><span class="op" id="3085496">.</span><span class="ident" id="3085497">backup</span><span class="op" id="3085503">(</span><span class="op" id="3085504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085508">return</span>&nbsp;<span class="ident" id="3085515">lexNumber</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085526">case</span>&nbsp;<span class="ident" id="3085531">isAlphaNumeric</span><span class="op" id="3085545">(</span><span class="ident" id="3085546">r</span><span class="op" id="3085547">)</span><span class="op" id="3085548">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085552">l</span><span class="op" id="3085553">.</span><span class="ident" id="3085554">backup</span><span class="op" id="3085560">(</span><span class="op" id="3085561">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085565">return</span>&nbsp;<span class="ident" id="3085572">lexIdentifier</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085587">case</span>&nbsp;<span class="ident" id="3085592">r</span>&nbsp;<span class="op" id="3085594">==</span>&nbsp;<span class="string" id="3085597">&#39;(&#39;</span><span class="op" id="3085600">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085604">l</span><span class="op" id="3085605">.</span><span class="ident" id="3085606">emit</span><span class="op" id="3085610">(</span><span class="ident" id="3085611">itemLeftParen</span><span class="op" id="3085624">)</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085628">l</span><span class="op" id="3085629">.</span><span class="ident" id="3085630">parenDepth</span><span class="op" id="3085640">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085645">return</span>&nbsp;<span class="ident" id="3085652">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085669">case</span>&nbsp;<span class="ident" id="3085674">r</span>&nbsp;<span class="op" id="3085676">==</span>&nbsp;<span class="string" id="3085679">&#39;)&#39;</span><span class="op" id="3085682">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085686">l</span><span class="op" id="3085687">.</span><span class="ident" id="3085688">emit</span><span class="op" id="3085692">(</span><span class="ident" id="3085693">itemRightParen</span><span class="op" id="3085707">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085711">l</span><span class="op" id="3085712">.</span><span class="ident" id="3085713">parenDepth</span><span class="op" id="3085723">--</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085728">if</span>&nbsp;<span class="ident" id="3085731">l</span><span class="op" id="3085732">.</span><span class="ident" id="3085733">parenDepth</span>&nbsp;<span class="op" id="3085744">&lt;</span>&nbsp;<span class="num" id="3085746">0</span>&nbsp;<span class="op" id="3085748">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085753">return</span>&nbsp;<span class="ident" id="3085760">l</span><span class="op" id="3085761">.</span><span class="ident" id="3085762">errorf</span><span class="op" id="3085768">(</span><span class="string" id="3085769">&#34;unexpected&nbsp;right&nbsp;paren&nbsp;%#U&#34;</span><span class="op" id="3085797">,</span>&nbsp;<span class="ident" id="3085799">r</span><span class="op" id="3085800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3085804">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085808">return</span>&nbsp;<span class="ident" id="3085815">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085832">case</span>&nbsp;<span class="ident" id="3085837">r</span>&nbsp;<span class="op" id="3085839">&lt;=</span>&nbsp;<span class="ident" id="3085842">unicode</span><span class="op" id="3085849">.</span><span class="ident" id="3085850">MaxASCII</span>&nbsp;<span class="op" id="3085859">&amp;&amp;</span>&nbsp;<span class="ident" id="3085862">unicode</span><span class="op" id="3085869">.</span><span class="ident" id="3085870">IsPrint</span><span class="op" id="3085877">(</span><span class="ident" id="3085878">r</span><span class="op" id="3085879">)</span><span class="op" id="3085880">:</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3085884">l</span><span class="op" id="3085885">.</span><span class="ident" id="3085886">emit</span><span class="op" id="3085890">(</span><span class="ident" id="3085891">itemChar</span><span class="op" id="3085899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085903">return</span>&nbsp;<span class="ident" id="3085910">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085927">default</span><span class="op" id="3085934">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3085938">return</span>&nbsp;<span class="ident" id="3085945">l</span><span class="op" id="3085946">.</span><span class="ident" id="3085947">errorf</span><span class="op" id="3085953">(</span><span class="string" id="3085954">&#34;unrecognized&nbsp;character&nbsp;in&nbsp;action:&nbsp;%#U&#34;</span><span class="op" id="3085993">,</span>&nbsp;<span class="ident" id="3085995">r</span><span class="op" id="3085996">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3085999">}</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086002">return</span>&nbsp;<span class="ident" id="3086009">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="3086025">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3086028">//&nbsp;lexSpace&nbsp;scans&nbsp;a&nbsp;run&nbsp;of&nbsp;space&nbsp;characters.</span><br>
<span class="lineno"></span><span class="comment" id="3086073">//&nbsp;One&nbsp;space&nbsp;has&nbsp;already&nbsp;been&nbsp;seen.</span><br>
<span class="lineno">335</span><span class="keyword" id="3086109">func</span>&nbsp;<span class="ident" id="3086114">lexSpace</span><span class="op" id="3086122">(</span><span class="ident" id="3086123">l</span>&nbsp;<span class="op" id="3086125">*</span><span class="ident" id="3086126">lexer</span><span class="op" id="3086131">)</span>&nbsp;<span class="ident" id="3086133">stateFn</span>&nbsp;<span class="op" id="3086141">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086144">for</span>&nbsp;<span class="ident" id="3086148">isSpace</span><span class="op" id="3086155">(</span><span class="ident" id="3086156">l</span><span class="op" id="3086157">.</span><span class="ident" id="3086158">peek</span><span class="op" id="3086162">(</span><span class="op" id="3086163">)</span><span class="op" id="3086164">)</span>&nbsp;<span class="op" id="3086166">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086170">l</span><span class="op" id="3086171">.</span><span class="ident" id="3086172">next</span><span class="op" id="3086176">(</span><span class="op" id="3086177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086180">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086183">l</span><span class="op" id="3086184">.</span><span class="ident" id="3086185">emit</span><span class="op" id="3086189">(</span><span class="ident" id="3086190">itemSpace</span><span class="op" id="3086199">)</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086202">return</span>&nbsp;<span class="ident" id="3086209">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="3086225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3086228">//&nbsp;lexIdentifier&nbsp;scans&nbsp;an&nbsp;alphanumeric.</span><br>
<span class="lineno"></span><span class="keyword" id="3086268">func</span>&nbsp;<span class="ident" id="3086273">lexIdentifier</span><span class="op" id="3086286">(</span><span class="ident" id="3086287">l</span>&nbsp;<span class="op" id="3086289">*</span><span class="ident" id="3086290">lexer</span><span class="op" id="3086295">)</span>&nbsp;<span class="ident" id="3086297">stateFn</span>&nbsp;<span class="op" id="3086305">{</span><br>
<span class="lineno">345</span><span class="ident" id="3086307">Loop</span><span class="op" id="3086311">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086314">for</span>&nbsp;<span class="op" id="3086318">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086322">switch</span>&nbsp;<span class="ident" id="3086329">r</span>&nbsp;<span class="op" id="3086331">:=</span>&nbsp;<span class="ident" id="3086334">l</span><span class="op" id="3086335">.</span><span class="ident" id="3086336">next</span><span class="op" id="3086340">(</span><span class="op" id="3086341">)</span><span class="op" id="3086342">;</span>&nbsp;<span class="op" id="3086344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086348">case</span>&nbsp;<span class="ident" id="3086353">isAlphaNumeric</span><span class="op" id="3086367">(</span><span class="ident" id="3086368">r</span><span class="op" id="3086369">)</span><span class="op" id="3086370">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3086375">//&nbsp;absorb.</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086388">default</span><span class="op" id="3086395">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086400">l</span><span class="op" id="3086401">.</span><span class="ident" id="3086402">backup</span><span class="op" id="3086408">(</span><span class="op" id="3086409">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086414">word</span>&nbsp;<span class="op" id="3086419">:=</span>&nbsp;<span class="ident" id="3086422">l</span><span class="op" id="3086423">.</span><span class="ident" id="3086424">input</span><span class="op" id="3086429">[</span><span class="ident" id="3086430">l</span><span class="op" id="3086431">.</span><span class="ident" id="3086432">start</span><span class="op" id="3086437">:</span><span class="ident" id="3086438">l</span><span class="op" id="3086439">.</span><span class="ident" id="3086440">pos</span><span class="op" id="3086443">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086448">if</span>&nbsp;<span class="op" id="3086451">!</span><span class="ident" id="3086452">l</span><span class="op" id="3086453">.</span><span class="ident" id="3086454">atTerminator</span><span class="op" id="3086466">(</span><span class="op" id="3086467">)</span>&nbsp;<span class="op" id="3086469">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086475">return</span>&nbsp;<span class="ident" id="3086482">l</span><span class="op" id="3086483">.</span><span class="ident" id="3086484">errorf</span><span class="op" id="3086490">(</span><span class="string" id="3086491">&#34;bad&nbsp;character&nbsp;%#U&#34;</span><span class="op" id="3086510">,</span>&nbsp;<span class="ident" id="3086512">r</span><span class="op" id="3086513">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086518">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086523">switch</span>&nbsp;<span class="op" id="3086530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086535">case</span>&nbsp;<span class="ident" id="3086540">key</span><span class="op" id="3086543">[</span><span class="ident" id="3086544">word</span><span class="op" id="3086548">]</span>&nbsp;<span class="op" id="3086550">&gt;</span>&nbsp;<span class="ident" id="3086552">itemKeyword</span><span class="op" id="3086563">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086569">l</span><span class="op" id="3086570">.</span><span class="ident" id="3086571">emit</span><span class="op" id="3086575">(</span><span class="ident" id="3086576">key</span><span class="op" id="3086579">[</span><span class="ident" id="3086580">word</span><span class="op" id="3086584">]</span><span class="op" id="3086585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086590">case</span>&nbsp;<span class="ident" id="3086595">word</span><span class="op" id="3086599">[</span><span class="num" id="3086600">0</span><span class="op" id="3086601">]</span>&nbsp;<span class="op" id="3086603">==</span>&nbsp;<span class="string" id="3086606">&#39;.&#39;</span><span class="op" id="3086609">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086615">l</span><span class="op" id="3086616">.</span><span class="ident" id="3086617">emit</span><span class="op" id="3086621">(</span><span class="ident" id="3086622">itemField</span><span class="op" id="3086631">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086636">case</span>&nbsp;<span class="ident" id="3086641">word</span>&nbsp;<span class="op" id="3086646">==</span>&nbsp;<span class="string" id="3086649">&#34;true&#34;</span><span class="op" id="3086655">,</span>&nbsp;<span class="ident" id="3086657">word</span>&nbsp;<span class="op" id="3086662">==</span>&nbsp;<span class="string" id="3086665">&#34;false&#34;</span><span class="op" id="3086672">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086678">l</span><span class="op" id="3086679">.</span><span class="ident" id="3086680">emit</span><span class="op" id="3086684">(</span><span class="ident" id="3086685">itemBool</span><span class="op" id="3086693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086698">default</span><span class="op" id="3086705">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3086711">l</span><span class="op" id="3086712">.</span><span class="ident" id="3086713">emit</span><span class="op" id="3086717">(</span><span class="ident" id="3086718">itemIdentifier</span><span class="op" id="3086732">)</span><br>
<span class="lineno">365</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086737">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086742">break</span>&nbsp;<span class="ident" id="3086748">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3086758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086761">return</span>&nbsp;<span class="ident" id="3086768">lexInsideAction</span><br>
<span class="lineno">370</span><span class="op" id="3086784">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3086787">//&nbsp;lexField&nbsp;scans&nbsp;a&nbsp;field:&nbsp;.Alphanumeric.</span><br>
<span class="lineno"></span><span class="comment" id="3086829">//&nbsp;The&nbsp;.&nbsp;has&nbsp;been&nbsp;scanned.</span><br>
<span class="lineno"></span><span class="keyword" id="3086856">func</span>&nbsp;<span class="ident" id="3086861">lexField</span><span class="op" id="3086869">(</span><span class="ident" id="3086870">l</span>&nbsp;<span class="op" id="3086872">*</span><span class="ident" id="3086873">lexer</span><span class="op" id="3086878">)</span>&nbsp;<span class="ident" id="3086880">stateFn</span>&nbsp;<span class="op" id="3086888">{</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3086891">return</span>&nbsp;<span class="ident" id="3086898">lexFieldOrVariable</span><span class="op" id="3086916">(</span><span class="ident" id="3086917">l</span><span class="op" id="3086918">,</span>&nbsp;<span class="ident" id="3086920">itemField</span><span class="op" id="3086929">)</span><br>
<span class="lineno"></span><span class="op" id="3086931">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3086934">//&nbsp;lexVariable&nbsp;scans&nbsp;a&nbsp;Variable:&nbsp;$Alphanumeric.</span><br>
<span class="lineno"></span><span class="comment" id="3086982">//&nbsp;The&nbsp;$&nbsp;has&nbsp;been&nbsp;scanned.</span><br>
<span class="lineno">380</span><span class="keyword" id="3087009">func</span>&nbsp;<span class="ident" id="3087014">lexVariable</span><span class="op" id="3087025">(</span><span class="ident" id="3087026">l</span>&nbsp;<span class="op" id="3087028">*</span><span class="ident" id="3087029">lexer</span><span class="op" id="3087034">)</span>&nbsp;<span class="ident" id="3087036">stateFn</span>&nbsp;<span class="op" id="3087044">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087047">if</span>&nbsp;<span class="ident" id="3087050">l</span><span class="op" id="3087051">.</span><span class="ident" id="3087052">atTerminator</span><span class="op" id="3087064">(</span><span class="op" id="3087065">)</span>&nbsp;<span class="op" id="3087067">{</span>&nbsp;<span class="comment" id="3087069">//&nbsp;Nothing&nbsp;interesting&nbsp;follows&nbsp;-&gt;&nbsp;&#34;$&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3087110">l</span><span class="op" id="3087111">.</span><span class="ident" id="3087112">emit</span><span class="op" id="3087116">(</span><span class="ident" id="3087117">itemVariable</span><span class="op" id="3087129">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087133">return</span>&nbsp;<span class="ident" id="3087140">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3087157">}</span><br>
<span class="lineno">385</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087160">return</span>&nbsp;<span class="ident" id="3087167">lexFieldOrVariable</span><span class="op" id="3087185">(</span><span class="ident" id="3087186">l</span><span class="op" id="3087187">,</span>&nbsp;<span class="ident" id="3087189">itemVariable</span><span class="op" id="3087201">)</span><br>
<span class="lineno"></span><span class="op" id="3087203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3087206">//&nbsp;lexVariable&nbsp;scans&nbsp;a&nbsp;field&nbsp;or&nbsp;variable:&nbsp;[.$]Alphanumeric.</span><br>
<span class="lineno"></span><span class="comment" id="3087266">//&nbsp;The&nbsp;.&nbsp;or&nbsp;$&nbsp;has&nbsp;been&nbsp;scanned.</span><br>
<span class="lineno">390</span><span class="keyword" id="3087298">func</span>&nbsp;<span class="ident" id="3087303">lexFieldOrVariable</span><span class="op" id="3087321">(</span><span class="ident" id="3087322">l</span>&nbsp;<span class="op" id="3087324">*</span><span class="ident" id="3087325">lexer</span><span class="op" id="3087330">,</span>&nbsp;<span class="ident" id="3087332">typ</span>&nbsp;<span class="ident" id="3087336">itemType</span><span class="op" id="3087344">)</span>&nbsp;<span class="ident" id="3087346">stateFn</span>&nbsp;<span class="op" id="3087354">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087357">if</span>&nbsp;<span class="ident" id="3087360">l</span><span class="op" id="3087361">.</span><span class="ident" id="3087362">atTerminator</span><span class="op" id="3087374">(</span><span class="op" id="3087375">)</span>&nbsp;<span class="op" id="3087377">{</span>&nbsp;<span class="comment" id="3087379">//&nbsp;Nothing&nbsp;interesting&nbsp;follows&nbsp;-&gt;&nbsp;&#34;.&#34;&nbsp;or&nbsp;&#34;$&#34;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087427">if</span>&nbsp;<span class="ident" id="3087430">typ</span>&nbsp;<span class="op" id="3087434">==</span>&nbsp;<span class="ident" id="3087437">itemVariable</span>&nbsp;<span class="op" id="3087450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3087455">l</span><span class="op" id="3087456">.</span><span class="ident" id="3087457">emit</span><span class="op" id="3087461">(</span><span class="ident" id="3087462">itemVariable</span><span class="op" id="3087474">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3087478">}</span>&nbsp;<span class="keyword" id="3087480">else</span>&nbsp;<span class="op" id="3087485">{</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3087490">l</span><span class="op" id="3087491">.</span><span class="ident" id="3087492">emit</span><span class="op" id="3087496">(</span><span class="ident" id="3087497">itemDot</span><span class="op" id="3087504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3087508">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087512">return</span>&nbsp;<span class="ident" id="3087519">lexInsideAction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3087536">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087539">var</span>&nbsp;<span class="ident" id="3087543">r</span>&nbsp;<span class="builtintype" id="3087545">rune</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087551">for</span>&nbsp;<span class="op" id="3087555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3087559">r</span>&nbsp;<span class="op" id="3087561">=</span>&nbsp;<span class="ident" id="3087563">l</span><span class="op" id="3087564">.</span><span class="ident" id="3087565">next</span><span class="op" id="3087569">(</span><span class="op" id="3087570">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087574">if</span>&nbsp;<span class="op" id="3087577">!</span><span class="ident" id="3087578">isAlphaNumeric</span><span class="op" id="3087592">(</span><span class="ident" id="3087593">r</span><span class="op" id="3087594">)</span>&nbsp;<span class="op" id="3087596">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3087601">l</span><span class="op" id="3087602">.</span><span class="ident" id="3087603">backup</span><span class="op" id="3087609">(</span><span class="op" id="3087610">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087615">break</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3087623">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3087626">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087629">if</span>&nbsp;<span class="op" id="3087632">!</span><span class="ident" id="3087633">l</span><span class="op" id="3087634">.</span><span class="ident" id="3087635">atTerminator</span><span class="op" id="3087647">(</span><span class="op" id="3087648">)</span>&nbsp;<span class="op" id="3087650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087654">return</span>&nbsp;<span class="ident" id="3087661">l</span><span class="op" id="3087662">.</span><span class="ident" id="3087663">errorf</span><span class="op" id="3087669">(</span><span class="string" id="3087670">&#34;bad&nbsp;character&nbsp;%#U&#34;</span><span class="op" id="3087689">,</span>&nbsp;<span class="ident" id="3087691">r</span><span class="op" id="3087692">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3087695">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3087698">l</span><span class="op" id="3087699">.</span><span class="ident" id="3087700">emit</span><span class="op" id="3087704">(</span><span class="ident" id="3087705">typ</span><span class="op" id="3087708">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3087711">return</span>&nbsp;<span class="ident" id="3087718">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="3087734">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3087737">//&nbsp;atTerminator&nbsp;reports&nbsp;whether&nbsp;the&nbsp;input&nbsp;is&nbsp;at&nbsp;valid&nbsp;termination&nbsp;character&nbsp;to</span><br>
<span class="lineno">415</span><span class="comment" id="3087816">//&nbsp;appear&nbsp;after&nbsp;an&nbsp;identifier.&nbsp;Breaks&nbsp;.X.Y&nbsp;into&nbsp;two&nbsp;pieces.&nbsp;Also&nbsp;catches&nbsp;cases</span><br>
<span class="lineno"></span><span class="comment" id="3087895">//&nbsp;like&nbsp;&#34;$x+2&#34;&nbsp;not&nbsp;being&nbsp;acceptable&nbsp;without&nbsp;a&nbsp;space,&nbsp;in&nbsp;case&nbsp;we&nbsp;decide&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="3087970">//&nbsp;day&nbsp;to&nbsp;implement&nbsp;arithmetic.</span><br>
<span class="lineno"></span><span class="keyword" id="3088002">func</span>&nbsp;<span class="op" id="3088007">(</span><span class="ident" id="3088008">l</span>&nbsp;<span class="op" id="3088010">*</span><span class="ident" id="3088011">lexer</span><span class="op" id="3088016">)</span>&nbsp;<span class="ident" id="3088018">atTerminator</span><span class="op" id="3088030">(</span><span class="op" id="3088031">)</span>&nbsp;<span class="builtintype" id="3088033">bool</span>&nbsp;<span class="op" id="3088038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3088041">r</span>&nbsp;<span class="op" id="3088043">:=</span>&nbsp;<span class="ident" id="3088046">l</span><span class="op" id="3088047">.</span><span class="ident" id="3088048">peek</span><span class="op" id="3088052">(</span><span class="op" id="3088053">)</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088056">if</span>&nbsp;<span class="ident" id="3088059">isSpace</span><span class="op" id="3088066">(</span><span class="ident" id="3088067">r</span><span class="op" id="3088068">)</span>&nbsp;<span class="op" id="3088070">||</span>&nbsp;<span class="ident" id="3088073">isEndOfLine</span><span class="op" id="3088084">(</span><span class="ident" id="3088085">r</span><span class="op" id="3088086">)</span>&nbsp;<span class="op" id="3088088">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088092">return</span>&nbsp;<span class="builtintype" id="3088099">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3088105">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088108">switch</span>&nbsp;<span class="ident" id="3088115">r</span>&nbsp;<span class="op" id="3088117">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088120">case</span>&nbsp;<span class="ident" id="3088125">eof</span><span class="op" id="3088128">,</span>&nbsp;<span class="string" id="3088130">&#39;.&#39;</span><span class="op" id="3088133">,</span>&nbsp;<span class="string" id="3088135">&#39;,&#39;</span><span class="op" id="3088138">,</span>&nbsp;<span class="string" id="3088140">&#39;|&#39;</span><span class="op" id="3088143">,</span>&nbsp;<span class="string" id="3088145">&#39;:&#39;</span><span class="op" id="3088148">,</span>&nbsp;<span class="string" id="3088150">&#39;)&#39;</span><span class="op" id="3088153">,</span>&nbsp;<span class="string" id="3088155">&#39;(&#39;</span><span class="op" id="3088158">:</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088162">return</span>&nbsp;<span class="builtintype" id="3088169">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3088175">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3088178">//&nbsp;Does&nbsp;r&nbsp;start&nbsp;the&nbsp;delimiter?&nbsp;This&nbsp;can&nbsp;be&nbsp;ambiguous&nbsp;(with&nbsp;delim==&#34;//&#34;,&nbsp;$x/2&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3088261">//&nbsp;succeed&nbsp;but&nbsp;should&nbsp;fail)&nbsp;but&nbsp;only&nbsp;in&nbsp;extremely&nbsp;rare&nbsp;cases&nbsp;caused&nbsp;by&nbsp;willfully</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3088343">//&nbsp;bad&nbsp;choice&nbsp;of&nbsp;delimiter.</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088372">if</span>&nbsp;<span class="ident" id="3088375">rd</span><span class="op" id="3088377">,</span>&nbsp;<span class="ident" id="3088379">_</span>&nbsp;<span class="op" id="3088381">:=</span>&nbsp;<span class="ident" id="3088384">utf8</span><span class="op" id="3088388">.</span><span class="ident" id="3088389">DecodeRuneInString</span><span class="op" id="3088407">(</span><span class="ident" id="3088408">l</span><span class="op" id="3088409">.</span><span class="ident" id="3088410">rightDelim</span><span class="op" id="3088420">)</span><span class="op" id="3088421">;</span>&nbsp;<span class="ident" id="3088423">rd</span>&nbsp;<span class="op" id="3088426">==</span>&nbsp;<span class="ident" id="3088429">r</span>&nbsp;<span class="op" id="3088431">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088435">return</span>&nbsp;<span class="builtintype" id="3088442">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3088448">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088451">return</span>&nbsp;<span class="builtintype" id="3088458">false</span><br>
<span class="lineno"></span><span class="op" id="3088464">}</span><br>
<span class="lineno">435</span><br>
<span class="lineno"></span><span class="comment" id="3088467">//&nbsp;lexChar&nbsp;scans&nbsp;a&nbsp;character&nbsp;constant.&nbsp;The&nbsp;initial&nbsp;quote&nbsp;is&nbsp;already</span><br>
<span class="lineno"></span><span class="comment" id="3088535">//&nbsp;scanned.&nbsp;Syntax&nbsp;checking&nbsp;is&nbsp;done&nbsp;by&nbsp;the&nbsp;parser.</span><br>
<span class="lineno"></span><span class="keyword" id="3088586">func</span>&nbsp;<span class="ident" id="3088591">lexChar</span><span class="op" id="3088598">(</span><span class="ident" id="3088599">l</span>&nbsp;<span class="op" id="3088601">*</span><span class="ident" id="3088602">lexer</span><span class="op" id="3088607">)</span>&nbsp;<span class="ident" id="3088609">stateFn</span>&nbsp;<span class="op" id="3088617">{</span><br>
<span class="lineno"></span><span class="ident" id="3088619">Loop</span><span class="op" id="3088623">:</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088626">for</span>&nbsp;<span class="op" id="3088630">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088634">switch</span>&nbsp;<span class="ident" id="3088641">l</span><span class="op" id="3088642">.</span><span class="ident" id="3088643">next</span><span class="op" id="3088647">(</span><span class="op" id="3088648">)</span>&nbsp;<span class="op" id="3088650">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088654">case</span>&nbsp;<span class="string" id="3088659">&#39;\\&#39;</span><span class="op" id="3088663">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088668">if</span>&nbsp;<span class="ident" id="3088671">r</span>&nbsp;<span class="op" id="3088673">:=</span>&nbsp;<span class="ident" id="3088676">l</span><span class="op" id="3088677">.</span><span class="ident" id="3088678">next</span><span class="op" id="3088682">(</span><span class="op" id="3088683">)</span><span class="op" id="3088684">;</span>&nbsp;<span class="ident" id="3088686">r</span>&nbsp;<span class="op" id="3088688">!=</span>&nbsp;<span class="ident" id="3088691">eof</span>&nbsp;<span class="op" id="3088695">&amp;&amp;</span>&nbsp;<span class="ident" id="3088698">r</span>&nbsp;<span class="op" id="3088700">!=</span>&nbsp;<span class="string" id="3088703">&#39;\n&#39;</span>&nbsp;<span class="op" id="3088708">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088714">break</span><br>
<span class="lineno">445</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3088723">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088728">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088742">case</span>&nbsp;<span class="ident" id="3088747">eof</span><span class="op" id="3088750">,</span>&nbsp;<span class="string" id="3088752">&#39;\n&#39;</span><span class="op" id="3088756">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088761">return</span>&nbsp;<span class="ident" id="3088768">l</span><span class="op" id="3088769">.</span><span class="ident" id="3088770">errorf</span><span class="op" id="3088776">(</span><span class="string" id="3088777">&#34;unterminated&nbsp;character&nbsp;constant&#34;</span><span class="op" id="3088810">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088814">case</span>&nbsp;<span class="string" id="3088819">&#39;\&#39;&#39;</span><span class="op" id="3088823">:</span><br>
<span class="lineno">450</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088828">break</span>&nbsp;<span class="ident" id="3088834">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3088841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3088844">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3088847">l</span><span class="op" id="3088848">.</span><span class="ident" id="3088849">emit</span><span class="op" id="3088853">(</span><span class="ident" id="3088854">itemCharConstant</span><span class="op" id="3088870">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3088873">return</span>&nbsp;<span class="ident" id="3088880">lexInsideAction</span><br>
<span class="lineno">455</span><span class="op" id="3088896">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3088899">//&nbsp;lexNumber&nbsp;scans&nbsp;a&nbsp;number:&nbsp;decimal,&nbsp;octal,&nbsp;hex,&nbsp;float,&nbsp;or&nbsp;imaginary.&nbsp;This</span><br>
<span class="lineno"></span><span class="comment" id="3088975">//&nbsp;isn&#39;t&nbsp;a&nbsp;perfect&nbsp;number&nbsp;scanner&nbsp;-&nbsp;for&nbsp;instance&nbsp;it&nbsp;accepts&nbsp;&#34;.&#34;&nbsp;and&nbsp;&#34;0x0.2&#34;</span><br>
<span class="lineno"></span><span class="comment" id="3089051">//&nbsp;and&nbsp;&#34;089&#34;&nbsp;-&nbsp;but&nbsp;when&nbsp;it&#39;s&nbsp;wrong&nbsp;the&nbsp;input&nbsp;is&nbsp;invalid&nbsp;and&nbsp;the&nbsp;parser&nbsp;(via</span><br>
<span class="lineno">460</span><span class="comment" id="3089127">//&nbsp;strconv)&nbsp;will&nbsp;notice.</span><br>
<span class="lineno"></span><span class="keyword" id="3089152">func</span>&nbsp;<span class="ident" id="3089157">lexNumber</span><span class="op" id="3089166">(</span><span class="ident" id="3089167">l</span>&nbsp;<span class="op" id="3089169">*</span><span class="ident" id="3089170">lexer</span><span class="op" id="3089175">)</span>&nbsp;<span class="ident" id="3089177">stateFn</span>&nbsp;<span class="op" id="3089185">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089188">if</span>&nbsp;<span class="op" id="3089191">!</span><span class="ident" id="3089192">l</span><span class="op" id="3089193">.</span><span class="ident" id="3089194">scanNumber</span><span class="op" id="3089204">(</span><span class="op" id="3089205">)</span>&nbsp;<span class="op" id="3089207">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089211">return</span>&nbsp;<span class="ident" id="3089218">l</span><span class="op" id="3089219">.</span><span class="ident" id="3089220">errorf</span><span class="op" id="3089226">(</span><span class="string" id="3089227">&#34;bad&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="3089250">,</span>&nbsp;<span class="ident" id="3089252">l</span><span class="op" id="3089253">.</span><span class="ident" id="3089254">input</span><span class="op" id="3089259">[</span><span class="ident" id="3089260">l</span><span class="op" id="3089261">.</span><span class="ident" id="3089262">start</span><span class="op" id="3089267">:</span><span class="ident" id="3089268">l</span><span class="op" id="3089269">.</span><span class="ident" id="3089270">pos</span><span class="op" id="3089273">]</span><span class="op" id="3089274">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3089277">}</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089280">if</span>&nbsp;<span class="ident" id="3089283">sign</span>&nbsp;<span class="op" id="3089288">:=</span>&nbsp;<span class="ident" id="3089291">l</span><span class="op" id="3089292">.</span><span class="ident" id="3089293">peek</span><span class="op" id="3089297">(</span><span class="op" id="3089298">)</span><span class="op" id="3089299">;</span>&nbsp;<span class="ident" id="3089301">sign</span>&nbsp;<span class="op" id="3089306">==</span>&nbsp;<span class="string" id="3089309">&#39;+&#39;</span>&nbsp;<span class="op" id="3089313">||</span>&nbsp;<span class="ident" id="3089316">sign</span>&nbsp;<span class="op" id="3089321">==</span>&nbsp;<span class="string" id="3089324">&#39;-&#39;</span>&nbsp;<span class="op" id="3089328">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3089332">//&nbsp;Complex:&nbsp;1+2i.&nbsp;No&nbsp;spaces,&nbsp;must&nbsp;end&nbsp;in&nbsp;&#39;i&#39;.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089380">if</span>&nbsp;<span class="op" id="3089383">!</span><span class="ident" id="3089384">l</span><span class="op" id="3089385">.</span><span class="ident" id="3089386">scanNumber</span><span class="op" id="3089396">(</span><span class="op" id="3089397">)</span>&nbsp;<span class="op" id="3089399">||</span>&nbsp;<span class="ident" id="3089402">l</span><span class="op" id="3089403">.</span><span class="ident" id="3089404">input</span><span class="op" id="3089409">[</span><span class="ident" id="3089410">l</span><span class="op" id="3089411">.</span><span class="ident" id="3089412">pos</span><span class="op" id="3089415">-</span><span class="num" id="3089416">1</span><span class="op" id="3089417">]</span>&nbsp;<span class="op" id="3089419">!=</span>&nbsp;<span class="string" id="3089422">&#39;i&#39;</span>&nbsp;<span class="op" id="3089426">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089431">return</span>&nbsp;<span class="ident" id="3089438">l</span><span class="op" id="3089439">.</span><span class="ident" id="3089440">errorf</span><span class="op" id="3089446">(</span><span class="string" id="3089447">&#34;bad&nbsp;number&nbsp;syntax:&nbsp;%q&#34;</span><span class="op" id="3089470">,</span>&nbsp;<span class="ident" id="3089472">l</span><span class="op" id="3089473">.</span><span class="ident" id="3089474">input</span><span class="op" id="3089479">[</span><span class="ident" id="3089480">l</span><span class="op" id="3089481">.</span><span class="ident" id="3089482">start</span><span class="op" id="3089487">:</span><span class="ident" id="3089488">l</span><span class="op" id="3089489">.</span><span class="ident" id="3089490">pos</span><span class="op" id="3089493">]</span><span class="op" id="3089494">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3089498">}</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089502">l</span><span class="op" id="3089503">.</span><span class="ident" id="3089504">emit</span><span class="op" id="3089508">(</span><span class="ident" id="3089509">itemComplex</span><span class="op" id="3089520">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3089523">}</span>&nbsp;<span class="keyword" id="3089525">else</span>&nbsp;<span class="op" id="3089530">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089534">l</span><span class="op" id="3089535">.</span><span class="ident" id="3089536">emit</span><span class="op" id="3089540">(</span><span class="ident" id="3089541">itemNumber</span><span class="op" id="3089551">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3089554">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089557">return</span>&nbsp;<span class="ident" id="3089564">lexInsideAction</span><br>
<span class="lineno">475</span><span class="op" id="3089580">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3089583">func</span>&nbsp;<span class="op" id="3089588">(</span><span class="ident" id="3089589">l</span>&nbsp;<span class="op" id="3089591">*</span><span class="ident" id="3089592">lexer</span><span class="op" id="3089597">)</span>&nbsp;<span class="ident" id="3089599">scanNumber</span><span class="op" id="3089609">(</span><span class="op" id="3089610">)</span>&nbsp;<span class="builtintype" id="3089612">bool</span>&nbsp;<span class="op" id="3089617">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3089620">//&nbsp;Optional&nbsp;leading&nbsp;sign.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089647">l</span><span class="op" id="3089648">.</span><span class="ident" id="3089649">accept</span><span class="op" id="3089655">(</span><span class="string" id="3089656">&#34;+-&#34;</span><span class="op" id="3089660">)</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3089663">//&nbsp;Is&nbsp;it&nbsp;hex?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089678">digits</span>&nbsp;<span class="op" id="3089685">:=</span>&nbsp;<span class="string" id="3089688">&#34;0123456789&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089702">if</span>&nbsp;<span class="ident" id="3089705">l</span><span class="op" id="3089706">.</span><span class="ident" id="3089707">accept</span><span class="op" id="3089713">(</span><span class="string" id="3089714">&#34;0&#34;</span><span class="op" id="3089717">)</span>&nbsp;<span class="op" id="3089719">&amp;&amp;</span>&nbsp;<span class="ident" id="3089722">l</span><span class="op" id="3089723">.</span><span class="ident" id="3089724">accept</span><span class="op" id="3089730">(</span><span class="string" id="3089731">&#34;xX&#34;</span><span class="op" id="3089735">)</span>&nbsp;<span class="op" id="3089737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089741">digits</span>&nbsp;<span class="op" id="3089748">=</span>&nbsp;<span class="string" id="3089750">&#34;0123456789abcdefABCDEF&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3089776">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089779">l</span><span class="op" id="3089780">.</span><span class="ident" id="3089781">acceptRun</span><span class="op" id="3089790">(</span><span class="ident" id="3089791">digits</span><span class="op" id="3089797">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089800">if</span>&nbsp;<span class="ident" id="3089803">l</span><span class="op" id="3089804">.</span><span class="ident" id="3089805">accept</span><span class="op" id="3089811">(</span><span class="string" id="3089812">&#34;.&#34;</span><span class="op" id="3089815">)</span>&nbsp;<span class="op" id="3089817">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089821">l</span><span class="op" id="3089822">.</span><span class="ident" id="3089823">acceptRun</span><span class="op" id="3089832">(</span><span class="ident" id="3089833">digits</span><span class="op" id="3089839">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3089842">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089845">if</span>&nbsp;<span class="ident" id="3089848">l</span><span class="op" id="3089849">.</span><span class="ident" id="3089850">accept</span><span class="op" id="3089856">(</span><span class="string" id="3089857">&#34;eE&#34;</span><span class="op" id="3089861">)</span>&nbsp;<span class="op" id="3089863">{</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089867">l</span><span class="op" id="3089868">.</span><span class="ident" id="3089869">accept</span><span class="op" id="3089875">(</span><span class="string" id="3089876">&#34;+-&#34;</span><span class="op" id="3089880">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089884">l</span><span class="op" id="3089885">.</span><span class="ident" id="3089886">acceptRun</span><span class="op" id="3089895">(</span><span class="string" id="3089896">&#34;0123456789&#34;</span><span class="op" id="3089908">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3089911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3089914">//&nbsp;Is&nbsp;it&nbsp;imaginary?</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3089935">l</span><span class="op" id="3089936">.</span><span class="ident" id="3089937">accept</span><span class="op" id="3089943">(</span><span class="string" id="3089944">&#34;i&#34;</span><span class="op" id="3089947">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="3089950">//&nbsp;Next&nbsp;thing&nbsp;mustn&#39;t&nbsp;be&nbsp;alphanumeric.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3089990">if</span>&nbsp;<span class="ident" id="3089993">isAlphaNumeric</span><span class="op" id="3090007">(</span><span class="ident" id="3090008">l</span><span class="op" id="3090009">.</span><span class="ident" id="3090010">peek</span><span class="op" id="3090014">(</span><span class="op" id="3090015">)</span><span class="op" id="3090016">)</span>&nbsp;<span class="op" id="3090018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090022">l</span><span class="op" id="3090023">.</span><span class="ident" id="3090024">next</span><span class="op" id="3090028">(</span><span class="op" id="3090029">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090033">return</span>&nbsp;<span class="builtintype" id="3090040">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3090047">}</span><br>
<span class="lineno">500</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090050">return</span>&nbsp;<span class="builtintype" id="3090057">true</span><br>
<span class="lineno"></span><span class="op" id="3090062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3090065">//&nbsp;lexQuote&nbsp;scans&nbsp;a&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3090100">func</span>&nbsp;<span class="ident" id="3090105">lexQuote</span><span class="op" id="3090113">(</span><span class="ident" id="3090114">l</span>&nbsp;<span class="op" id="3090116">*</span><span class="ident" id="3090117">lexer</span><span class="op" id="3090122">)</span>&nbsp;<span class="ident" id="3090124">stateFn</span>&nbsp;<span class="op" id="3090132">{</span><br>
<span class="lineno">505</span><span class="ident" id="3090134">Loop</span><span class="op" id="3090138">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090141">for</span>&nbsp;<span class="op" id="3090145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090149">switch</span>&nbsp;<span class="ident" id="3090156">l</span><span class="op" id="3090157">.</span><span class="ident" id="3090158">next</span><span class="op" id="3090162">(</span><span class="op" id="3090163">)</span>&nbsp;<span class="op" id="3090165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090169">case</span>&nbsp;<span class="string" id="3090174">&#39;\\&#39;</span><span class="op" id="3090178">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090183">if</span>&nbsp;<span class="ident" id="3090186">r</span>&nbsp;<span class="op" id="3090188">:=</span>&nbsp;<span class="ident" id="3090191">l</span><span class="op" id="3090192">.</span><span class="ident" id="3090193">next</span><span class="op" id="3090197">(</span><span class="op" id="3090198">)</span><span class="op" id="3090199">;</span>&nbsp;<span class="ident" id="3090201">r</span>&nbsp;<span class="op" id="3090203">!=</span>&nbsp;<span class="ident" id="3090206">eof</span>&nbsp;<span class="op" id="3090210">&amp;&amp;</span>&nbsp;<span class="ident" id="3090213">r</span>&nbsp;<span class="op" id="3090215">!=</span>&nbsp;<span class="string" id="3090218">&#39;\n&#39;</span>&nbsp;<span class="op" id="3090223">{</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090229">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3090238">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090243">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090257">case</span>&nbsp;<span class="ident" id="3090262">eof</span><span class="op" id="3090265">,</span>&nbsp;<span class="string" id="3090267">&#39;\n&#39;</span><span class="op" id="3090271">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090276">return</span>&nbsp;<span class="ident" id="3090283">l</span><span class="op" id="3090284">.</span><span class="ident" id="3090285">errorf</span><span class="op" id="3090291">(</span><span class="string" id="3090292">&#34;unterminated&nbsp;quoted&nbsp;string&#34;</span><span class="op" id="3090320">)</span><br>
<span class="lineno">515</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090324">case</span>&nbsp;<span class="string" id="3090329">&#39;&#34;&#39;</span><span class="op" id="3090332">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090337">break</span>&nbsp;<span class="ident" id="3090343">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3090350">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3090353">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090356">l</span><span class="op" id="3090357">.</span><span class="ident" id="3090358">emit</span><span class="op" id="3090362">(</span><span class="ident" id="3090363">itemString</span><span class="op" id="3090373">)</span><br>
<span class="lineno">520</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090376">return</span>&nbsp;<span class="ident" id="3090383">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="3090399">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3090402">//&nbsp;lexRawQuote&nbsp;scans&nbsp;a&nbsp;raw&nbsp;quoted&nbsp;string.</span><br>
<span class="lineno"></span><span class="keyword" id="3090444">func</span>&nbsp;<span class="ident" id="3090449">lexRawQuote</span><span class="op" id="3090460">(</span><span class="ident" id="3090461">l</span>&nbsp;<span class="op" id="3090463">*</span><span class="ident" id="3090464">lexer</span><span class="op" id="3090469">)</span>&nbsp;<span class="ident" id="3090471">stateFn</span>&nbsp;<span class="op" id="3090479">{</span><br>
<span class="lineno">525</span><span class="ident" id="3090481">Loop</span><span class="op" id="3090485">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090488">for</span>&nbsp;<span class="op" id="3090492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090496">switch</span>&nbsp;<span class="ident" id="3090503">l</span><span class="op" id="3090504">.</span><span class="ident" id="3090505">next</span><span class="op" id="3090509">(</span><span class="op" id="3090510">)</span>&nbsp;<span class="op" id="3090512">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090516">case</span>&nbsp;<span class="ident" id="3090521">eof</span><span class="op" id="3090524">,</span>&nbsp;<span class="string" id="3090526">&#39;\n&#39;</span><span class="op" id="3090530">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090535">return</span>&nbsp;<span class="ident" id="3090542">l</span><span class="op" id="3090543">.</span><span class="ident" id="3090544">errorf</span><span class="op" id="3090550">(</span><span class="string" id="3090551">&#34;unterminated&nbsp;raw&nbsp;quoted&nbsp;string&#34;</span><span class="op" id="3090583">)</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090587">case</span>&nbsp;<span class="string" id="3090592">&#39;`&#39;</span><span class="op" id="3090595">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090600">break</span>&nbsp;<span class="ident" id="3090606">Loop</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3090613">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3090616">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="3090619">l</span><span class="op" id="3090620">.</span><span class="ident" id="3090621">emit</span><span class="op" id="3090625">(</span><span class="ident" id="3090626">itemRawString</span><span class="op" id="3090639">)</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090642">return</span>&nbsp;<span class="ident" id="3090649">lexInsideAction</span><br>
<span class="lineno"></span><span class="op" id="3090665">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3090668">//&nbsp;isSpace&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;a&nbsp;space&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="3090719">func</span>&nbsp;<span class="ident" id="3090724">isSpace</span><span class="op" id="3090731">(</span><span class="ident" id="3090732">r</span>&nbsp;<span class="builtintype" id="3090734">rune</span><span class="op" id="3090738">)</span>&nbsp;<span class="builtintype" id="3090740">bool</span>&nbsp;<span class="op" id="3090745">{</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090748">return</span>&nbsp;<span class="ident" id="3090755">r</span>&nbsp;<span class="op" id="3090757">==</span>&nbsp;<span class="string" id="3090760">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="3090764">||</span>&nbsp;<span class="ident" id="3090767">r</span>&nbsp;<span class="op" id="3090769">==</span>&nbsp;<span class="string" id="3090772">&#39;\t&#39;</span><br>
<span class="lineno"></span><span class="op" id="3090777">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3090780">//&nbsp;isEndOfLine&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;an&nbsp;end-of-line&nbsp;character.</span><br>
<span class="lineno"></span><span class="keyword" id="3090842">func</span>&nbsp;<span class="ident" id="3090847">isEndOfLine</span><span class="op" id="3090858">(</span><span class="ident" id="3090859">r</span>&nbsp;<span class="builtintype" id="3090861">rune</span><span class="op" id="3090865">)</span>&nbsp;<span class="builtintype" id="3090867">bool</span>&nbsp;<span class="op" id="3090872">{</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3090875">return</span>&nbsp;<span class="ident" id="3090882">r</span>&nbsp;<span class="op" id="3090884">==</span>&nbsp;<span class="string" id="3090887">&#39;\r&#39;</span>&nbsp;<span class="op" id="3090892">||</span>&nbsp;<span class="ident" id="3090895">r</span>&nbsp;<span class="op" id="3090897">==</span>&nbsp;<span class="string" id="3090900">&#39;\n&#39;</span><br>
<span class="lineno"></span><span class="op" id="3090905">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3090908">//&nbsp;isAlphaNumeric&nbsp;reports&nbsp;whether&nbsp;r&nbsp;is&nbsp;an&nbsp;alphabetic,&nbsp;digit,&nbsp;or&nbsp;underscore.</span><br>
<span class="lineno"></span><span class="keyword" id="3090984">func</span>&nbsp;<span class="ident" id="3090989">isAlphaNumeric</span><span class="op" id="3091003">(</span><span class="ident" id="3091004">r</span>&nbsp;<span class="builtintype" id="3091006">rune</span><span class="op" id="3091010">)</span>&nbsp;<span class="builtintype" id="3091012">bool</span>&nbsp;<span class="op" id="3091017">{</span><br>
<span class="lineno">550</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="3091020">return</span>&nbsp;<span class="ident" id="3091027">r</span>&nbsp;<span class="op" id="3091029">==</span>&nbsp;<span class="string" id="3091032">&#39;_&#39;</span>&nbsp;<span class="op" id="3091036">||</span>&nbsp;<span class="ident" id="3091039">unicode</span><span class="op" id="3091046">.</span><span class="ident" id="3091047">IsLetter</span><span class="op" id="3091055">(</span><span class="ident" id="3091056">r</span><span class="op" id="3091057">)</span>&nbsp;<span class="op" id="3091059">||</span>&nbsp;<span class="ident" id="3091062">unicode</span><span class="op" id="3091069">.</span><span class="ident" id="3091070">IsDigit</span><span class="op" id="3091077">(</span><span class="ident" id="3091078">r</span><span class="op" id="3091079">)</span><br>
<span class="lineno"></span><span class="op" id="3091081">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
