<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>runtime</h2>
<ul>
<li><a href="/gostd/runtime/alg.go.html">alg.go</a></li>
<li><a href="/gostd/runtime/append_test.go.html">append_test.go</a></li>
<li><a href="/gostd/runtime/arch_amd64.go.html">arch_amd64.go</a></li>
<li><a href="/gostd/runtime/atomic.go.html">atomic.go</a></li>
<li><a href="/gostd/runtime/cgocall.go.html">cgocall.go</a></li>
<li><a href="/gostd/runtime/cgocallback.go.html">cgocallback.go</a></li>
<li><a href="/gostd/runtime/chan.go.html">chan.go</a></li>
<li><a href="/gostd/runtime/chan_test.go.html">chan_test.go</a></li>
<li><a href="/gostd/runtime/closure_test.go.html">closure_test.go</a></li>
<li><a href="/gostd/runtime/compiler.go.html">compiler.go</a></li>
<li><a href="/gostd/runtime/complex.go.html">complex.go</a></li>
<li><a href="/gostd/runtime/complex_test.go.html">complex_test.go</a></li>
<li><a href="/gostd/runtime/cpuprof.go.html">cpuprof.go</a></li>
<li><a href="/gostd/runtime/crash_test.go.html">crash_test.go</a></li>
<li><a href="/gostd/runtime/debug.go.html">debug.go</a></li>
<li><a href="/gostd/runtime/env_posix.go.html">env_posix.go</a></li>
<li><a href="/gostd/runtime/error.go.html">error.go</a></li>
<li><a href="/gostd/runtime/export_futex_test.go.html">export_futex_test.go</a></li>
<li><a href="/gostd/runtime/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/runtime/extern.go.html">extern.go</a></li>
<li><a href="/gostd/runtime/futex_test.go.html">futex_test.go</a></li>
<li><a href="/gostd/runtime/gc_test.go.html">gc_test.go</a></li>
<li><a href="/gostd/runtime/gcinfo_test.go.html">gcinfo_test.go</a></li>
<li><a href="/gostd/runtime/hash_test.go.html">hash_test.go</a></li>
<li><a href="/gostd/runtime/hashmap.go.html">hashmap.go</a></li>
<li><a href="/gostd/runtime/hashmap_fast.go.html">hashmap_fast.go</a></li>
<li><a href="/gostd/runtime/iface.go.html">iface.go</a></li>
<li><a href="/gostd/runtime/iface_test.go.html">iface_test.go</a></li>
<li><a href="/gostd/runtime/lfstack_test.go.html">lfstack_test.go</a></li>
<li><a href="/gostd/runtime/lock_futex.go.html">lock_futex.go</a></li>
<li><a href="/gostd/runtime/malloc.go.html">malloc.go</a></li>
<li><a href="/gostd/runtime/malloc_test.go.html">malloc_test.go</a></li>
<li><a href="/gostd/runtime/map_test.go.html">map_test.go</a></li>
<li><a href="/gostd/runtime/mapspeed_test.go.html">mapspeed_test.go</a></li>
<li><a href="/gostd/runtime/mem.go.html">mem.go</a></li>
<li><a href="/gostd/runtime/memmove_linux_amd64_test.go.html">memmove_linux_amd64_test.go</a></li>
<li><a href="/gostd/runtime/memmove_test.go.html">memmove_test.go</a></li>
<li><a href="/gostd/runtime/mfinal_test.go.html">mfinal_test.go</a></li>
<li><a href="/gostd/runtime/mgc0.go.html">mgc0.go</a></li>
<li><a href="/gostd/runtime/mprof.go.html">mprof.go</a></li>
<li><a href="/gostd/runtime/netpoll.go.html">netpoll.go</a></li>
<li><a href="/gostd/runtime/netpoll_epoll.go.html">netpoll_epoll.go</a></li>
<li><a href="/gostd/runtime/norace_test.go.html">norace_test.go</a></li>
<li><a href="/gostd/runtime/os_linux.go.html">os_linux.go</a></li>
<li><a href="/gostd/runtime/panic.go.html">panic.go</a></li>
<li><a href="/gostd/runtime/parfor_test.go.html">parfor_test.go</a></li>
<li><a href="/gostd/runtime/print1.go.html">print1.go</a></li>
<li><a href="/gostd/runtime/proc.go.html">proc.go</a></li>
<li><a href="/gostd/runtime/proc_test.go.html">proc_test.go</a></li>
<li><a href="/gostd/runtime/race0.go.html">race0.go</a></li>
<li><a href="/gostd/runtime/rdebug.go.html">rdebug.go</a></li>
<li><a href="/gostd/runtime/rune.go.html">rune.go</a></li>
<li><a href="/gostd/runtime/runtime.go.html">runtime.go</a></li>
<li><a href="/gostd/runtime/runtime_linux_test.go.html">runtime_linux_test.go</a></li>
<li><a href="/gostd/runtime/runtime_test.go.html">runtime_test.go</a></li>
<li><a href="/gostd/runtime/runtime_unix_test.go.html">runtime_unix_test.go</a></li>
<li><a href="/gostd/runtime/select.go.html">select.go</a></li>
<li><a href="/gostd/runtime/sema.go.html">sema.go</a></li>
<li><a href="/gostd/runtime/signal_unix.go.html">signal_unix.go</a></li>
<li><a href="/gostd/runtime/sigpanic_unix.go.html">sigpanic_unix.go</a></li>
<li><a href="/gostd/runtime/sigqueue.go.html">sigqueue.go</a></li>
<li><a href="/gostd/runtime/slice.go.html">slice.go</a></li>
<li><a href="/gostd/runtime/softfloat64.go.html">softfloat64.go</a></li>
<li><a href="/gostd/runtime/softfloat64_test.go.html">softfloat64_test.go</a></li>
<li><a href="/gostd/runtime/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/runtime/stack.go.html">stack.go</a></li>
<li><a href="/gostd/runtime/stack_test.go.html">stack_test.go</a></li>
<li><a href="/gostd/runtime/string.go.html">string.go</a></li>
<li><a href="/gostd/runtime/string_test.go.html">string_test.go</a></li>
<li><a href="/gostd/runtime/stubs.go.html">stubs.go</a></li>
<li><a href="/gostd/runtime/symtab.go.html">symtab.go</a></li>
<li><a href="/gostd/runtime/symtab_test.go.html">symtab_test.go</a></li>
<li><a href="/gostd/runtime/time.go.html">time.go</a></li>
<li><a href="/gostd/runtime/traceback.go.html">traceback.go</a></li>
<li><a href="/gostd/runtime/typekind.go.html">typekind.go</a></li>
<li><a href="/gostd/runtime/zgoarch_amd64.go.html">zgoarch_amd64.go</a></li>
<li><a href="/gostd/runtime/zgoos_linux.go.html">zgoos_linux.go</a></li>
<li><a href="/gostd/runtime/zruntime_defs_linux_amd64.go.html">zruntime_defs_linux_amd64.go</a></li>
<li><a href="/gostd/runtime/zversion.go.html">zversion.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1712736">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1712791">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1712845">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="1712896">//&nbsp;Time-related&nbsp;runtime&nbsp;and&nbsp;pieces&nbsp;of&nbsp;package&nbsp;time.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1712949">package</span>&nbsp;<span class="ident" id="1712957">runtime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1712966">import</span>&nbsp;<span class="string" id="1712973">&#34;unsafe&#34;</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1712983">//&nbsp;Package&nbsp;time&nbsp;knows&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1713035">//&nbsp;If&nbsp;this&nbsp;struct&nbsp;changes,&nbsp;adjust&nbsp;../time/sleep.go:/runtimeTimer.</span><br>
<span class="lineno"></span><span class="comment" id="1713101">//&nbsp;For&nbsp;GOOS=nacl,&nbsp;package&nbsp;syscall&nbsp;knows&nbsp;the&nbsp;layout&nbsp;of&nbsp;this&nbsp;structure.</span><br>
<span class="lineno"></span><span class="comment" id="1713171">//&nbsp;If&nbsp;this&nbsp;struct&nbsp;changes,&nbsp;adjust&nbsp;../syscall/net_nacl.go:/runtimeTimer.</span><br>
<span class="lineno">15</span><span class="keyword" id="1713243">type</span>&nbsp;<span class="ident" id="1713248">timer</span>&nbsp;<span class="keyword" id="1713254">struct</span>&nbsp;<span class="op" id="1713261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1713264">i</span>&nbsp;<span class="builtintype" id="1713266">int</span>&nbsp;<span class="comment" id="1713270">//&nbsp;heap&nbsp;index</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1713286">//&nbsp;Timer&nbsp;wakes&nbsp;up&nbsp;at&nbsp;when,&nbsp;and&nbsp;then&nbsp;at&nbsp;when+period,&nbsp;...&nbsp;(period&nbsp;&gt;&nbsp;0&nbsp;only)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1713361">//&nbsp;each&nbsp;time&nbsp;calling&nbsp;f(now,&nbsp;arg)&nbsp;in&nbsp;the&nbsp;timer&nbsp;goroutine,&nbsp;so&nbsp;f&nbsp;must&nbsp;be</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1713432">//&nbsp;a&nbsp;well-behaved&nbsp;function&nbsp;and&nbsp;not&nbsp;block.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1713475">when</span>&nbsp;&nbsp;&nbsp;<span class="ident" id="1713482">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1713489">period</span>&nbsp;<span class="ident" id="1713496">int64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1713503">f</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1713510">func</span><span class="op" id="1713514">(</span><span class="keyword" id="1713515">interface</span><span class="op" id="1713524">{</span><span class="op" id="1713525">}</span><span class="op" id="1713526">,</span>&nbsp;<span class="builtintype" id="1713528">uintptr</span><span class="op" id="1713535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1713538">arg</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="1713545">interface</span><span class="op" id="1713554">{</span><span class="op" id="1713555">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1713558">seq</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1713565">uintptr</span><br>
<span class="lineno"></span><span class="op" id="1713573">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1713576">var</span>&nbsp;<span class="ident" id="1713580">timers</span>&nbsp;<span class="keyword" id="1713587">struct</span>&nbsp;<span class="op" id="1713594">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1713597">lock</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1713610">mutex</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1713617">gp</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1713630">*</span><span class="ident" id="1713631">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1713634">created</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1713647">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1713653">sleeping</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="1713666">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1713672">rescheduling</span>&nbsp;<span class="builtintype" id="1713685">bool</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1713691">waitnote</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="1713704">note</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1713710">t</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1713723">[</span><span class="op" id="1713724">]</span><span class="op" id="1713725">*</span><span class="ident" id="1713726">timer</span><br>
<span class="lineno"></span><span class="op" id="1713732">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1713735">//&nbsp;nacl&nbsp;fake&nbsp;time&nbsp;support&nbsp;-&nbsp;time&nbsp;in&nbsp;nanoseconds&nbsp;since&nbsp;1970</span><br>
<span class="lineno"></span><span class="keyword" id="1713794">var</span>&nbsp;<span class="ident" id="1713798">faketime</span>&nbsp;<span class="ident" id="1713807">int64</span><br>
<span class="lineno">40</span><br>
<span class="lineno"></span><span class="comment" id="1713814">//&nbsp;Package&nbsp;time&nbsp;APIs.</span><br>
<span class="lineno"></span><span class="comment" id="1713836">//&nbsp;Godoc&nbsp;uses&nbsp;the&nbsp;comments&nbsp;in&nbsp;package&nbsp;time,&nbsp;not&nbsp;these.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1713892">//&nbsp;time.now&nbsp;is&nbsp;implemented&nbsp;in&nbsp;assembly.</span><br>
<span class="lineno">45</span><br>
<span class="lineno"></span><span class="comment" id="1713933">//&nbsp;Sleep&nbsp;puts&nbsp;the&nbsp;current&nbsp;goroutine&nbsp;to&nbsp;sleep&nbsp;for&nbsp;at&nbsp;least&nbsp;ns&nbsp;nanoseconds.</span><br>
<span class="lineno"></span><span class="keyword" id="1714007">func</span>&nbsp;<span class="ident" id="1714012">timeSleep</span><span class="op" id="1714021">(</span><span class="ident" id="1714022">ns</span>&nbsp;<span class="ident" id="1714025">int64</span><span class="op" id="1714030">)</span>&nbsp;<span class="op" id="1714032">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1714035">if</span>&nbsp;<span class="ident" id="1714038">ns</span>&nbsp;<span class="op" id="1714041">&lt;=</span>&nbsp;<span class="num" id="1714044">0</span>&nbsp;<span class="op" id="1714046">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1714050">return</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1714058">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1714062">t</span>&nbsp;<span class="op" id="1714064">:=</span>&nbsp;<span class="builtinfunc" id="1714067">new</span><span class="op" id="1714070">(</span><span class="ident" id="1714071">timer</span><span class="op" id="1714076">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1714079">t</span><span class="op" id="1714080">.</span><span class="ident" id="1714081">when</span>&nbsp;<span class="op" id="1714086">=</span>&nbsp;<span class="ident" id="1714088">nanotime</span><span class="op" id="1714096">(</span><span class="op" id="1714097">)</span>&nbsp;<span class="op" id="1714099">+</span>&nbsp;<span class="ident" id="1714101">ns</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1714105">t</span><span class="op" id="1714106">.</span><span class="ident" id="1714107">f</span>&nbsp;<span class="op" id="1714109">=</span>&nbsp;<span class="ident" id="1714111">goroutineReady</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1714127">t</span><span class="op" id="1714128">.</span><span class="ident" id="1714129">arg</span>&nbsp;<span class="op" id="1714133">=</span>&nbsp;<span class="ident" id="1714135">getg</span><span class="op" id="1714139">(</span><span class="op" id="1714140">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1714143">lock</span><span class="op" id="1714147">(</span><span class="op" id="1714148">&amp;</span><span class="ident" id="1714149">timers</span><span class="op" id="1714155">.</span><span class="ident" id="1714156">lock</span><span class="op" id="1714160">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1714163">addtimerLocked</span><span class="op" id="1714177">(</span><span class="ident" id="1714178">t</span><span class="op" id="1714179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1714182">goparkunlock</span><span class="op" id="1714194">(</span><span class="op" id="1714195">&amp;</span><span class="ident" id="1714196">timers</span><span class="op" id="1714202">.</span><span class="ident" id="1714203">lock</span><span class="op" id="1714207">,</span>&nbsp;<span class="string" id="1714209">&#34;sleep&#34;</span><span class="op" id="1714216">)</span><br>
<span class="lineno"></span><span class="op" id="1714218">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="comment" id="1714221">//&nbsp;startTimer&nbsp;adds&nbsp;t&nbsp;to&nbsp;the&nbsp;timer&nbsp;heap.</span><br>
<span class="lineno"></span><span class="keyword" id="1714261">func</span>&nbsp;<span class="ident" id="1714266">startTimer</span><span class="op" id="1714276">(</span><span class="ident" id="1714277">t</span>&nbsp;<span class="op" id="1714279">*</span><span class="ident" id="1714280">timer</span><span class="op" id="1714285">)</span>&nbsp;<span class="op" id="1714287">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1714290">if</span>&nbsp;<span class="ident" id="1714293">raceenabled</span>&nbsp;<span class="op" id="1714305">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1714309">racerelease</span><span class="op" id="1714320">(</span><span class="ident" id="1714321">unsafe</span><span class="op" id="1714327">.</span><span class="ident" id="1714328">Pointer</span><span class="op" id="1714335">(</span><span class="ident" id="1714336">t</span><span class="op" id="1714337">)</span><span class="op" id="1714338">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1714341">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1714344">addtimer</span><span class="op" id="1714352">(</span><span class="ident" id="1714353">t</span><span class="op" id="1714354">)</span><br>
<span class="lineno"></span><span class="op" id="1714356">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1714359">//&nbsp;stopTimer&nbsp;removes&nbsp;t&nbsp;from&nbsp;the&nbsp;timer&nbsp;heap&nbsp;if&nbsp;it&nbsp;is&nbsp;there.</span><br>
<span class="lineno">70</span><span class="comment" id="1714418">//&nbsp;It&nbsp;returns&nbsp;true&nbsp;if&nbsp;t&nbsp;was&nbsp;removed,&nbsp;false&nbsp;if&nbsp;t&nbsp;wasn&#39;t&nbsp;even&nbsp;there.</span><br>
<span class="lineno"></span><span class="keyword" id="1714485">func</span>&nbsp;<span class="ident" id="1714490">stopTimer</span><span class="op" id="1714499">(</span><span class="ident" id="1714500">t</span>&nbsp;<span class="op" id="1714502">*</span><span class="ident" id="1714503">timer</span><span class="op" id="1714508">)</span>&nbsp;<span class="builtintype" id="1714510">bool</span>&nbsp;<span class="op" id="1714515">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1714518">return</span>&nbsp;<span class="ident" id="1714525">deltimer</span><span class="op" id="1714533">(</span><span class="ident" id="1714534">t</span><span class="op" id="1714535">)</span><br>
<span class="lineno"></span><span class="op" id="1714537">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="comment" id="1714540">//&nbsp;Go&nbsp;runtime.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1714556">//&nbsp;Ready&nbsp;the&nbsp;goroutine&nbsp;arg.</span><br>
<span class="lineno"></span><span class="keyword" id="1714584">func</span>&nbsp;<span class="ident" id="1714589">goroutineReady</span><span class="op" id="1714603">(</span><span class="ident" id="1714604">arg</span>&nbsp;<span class="keyword" id="1714608">interface</span><span class="op" id="1714617">{</span><span class="op" id="1714618">}</span><span class="op" id="1714619">,</span>&nbsp;<span class="ident" id="1714621">seq</span>&nbsp;<span class="builtintype" id="1714625">uintptr</span><span class="op" id="1714632">)</span>&nbsp;<span class="op" id="1714634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1714637">goready</span><span class="op" id="1714644">(</span><span class="ident" id="1714645">arg</span><span class="op" id="1714648">.</span><span class="op" id="1714649">(</span><span class="op" id="1714650">*</span><span class="ident" id="1714651">g</span><span class="op" id="1714652">)</span><span class="op" id="1714653">)</span><br>
<span class="lineno">80</span><span class="op" id="1714655">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1714658">func</span>&nbsp;<span class="ident" id="1714663">addtimer</span><span class="op" id="1714671">(</span><span class="ident" id="1714672">t</span>&nbsp;<span class="op" id="1714674">*</span><span class="ident" id="1714675">timer</span><span class="op" id="1714680">)</span>&nbsp;<span class="op" id="1714682">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1714685">lock</span><span class="op" id="1714689">(</span><span class="op" id="1714690">&amp;</span><span class="ident" id="1714691">timers</span><span class="op" id="1714697">.</span><span class="ident" id="1714698">lock</span><span class="op" id="1714702">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1714705">addtimerLocked</span><span class="op" id="1714719">(</span><span class="ident" id="1714720">t</span><span class="op" id="1714721">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1714724">unlock</span><span class="op" id="1714730">(</span><span class="op" id="1714731">&amp;</span><span class="ident" id="1714732">timers</span><span class="op" id="1714738">.</span><span class="ident" id="1714739">lock</span><span class="op" id="1714743">)</span><br>
<span class="lineno"></span><span class="op" id="1714745">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1714748">//&nbsp;Add&nbsp;a&nbsp;timer&nbsp;to&nbsp;the&nbsp;heap&nbsp;and&nbsp;start&nbsp;or&nbsp;kick&nbsp;the&nbsp;timer&nbsp;proc.</span><br>
<span class="lineno"></span><span class="comment" id="1714809">//&nbsp;If&nbsp;the&nbsp;new&nbsp;timer&nbsp;is&nbsp;earlier&nbsp;than&nbsp;any&nbsp;of&nbsp;the&nbsp;others.</span><br>
<span class="lineno">90</span><span class="comment" id="1714864">//&nbsp;Timers&nbsp;are&nbsp;locked.</span><br>
<span class="lineno"></span><span class="keyword" id="1714886">func</span>&nbsp;<span class="ident" id="1714891">addtimerLocked</span><span class="op" id="1714905">(</span><span class="ident" id="1714906">t</span>&nbsp;<span class="op" id="1714908">*</span><span class="ident" id="1714909">timer</span><span class="op" id="1714914">)</span>&nbsp;<span class="op" id="1714916">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1714919">//&nbsp;when&nbsp;must&nbsp;never&nbsp;be&nbsp;negative;&nbsp;otherwise&nbsp;timerproc&nbsp;will&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1714986">//&nbsp;during&nbsp;its&nbsp;delta&nbsp;calculation&nbsp;and&nbsp;never&nbsp;expire&nbsp;other&nbsp;runtimeÂ·timers.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1715059">if</span>&nbsp;<span class="ident" id="1715062">t</span><span class="op" id="1715063">.</span><span class="ident" id="1715064">when</span>&nbsp;<span class="op" id="1715069">&lt;</span>&nbsp;<span class="num" id="1715071">0</span>&nbsp;<span class="op" id="1715073">{</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1715077">t</span><span class="op" id="1715078">.</span><span class="ident" id="1715079">when</span>&nbsp;<span class="op" id="1715084">=</span>&nbsp;<span class="num" id="1715086">1</span><span class="op" id="1715087">&lt;&lt;</span><span class="num" id="1715089">63</span>&nbsp;<span class="op" id="1715092">-</span>&nbsp;<span class="num" id="1715094">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1715097">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1715100">t</span><span class="op" id="1715101">.</span><span class="ident" id="1715102">i</span>&nbsp;<span class="op" id="1715104">=</span>&nbsp;<span class="builtinfunc" id="1715106">len</span><span class="op" id="1715109">(</span><span class="ident" id="1715110">timers</span><span class="op" id="1715116">.</span><span class="ident" id="1715117">t</span><span class="op" id="1715118">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1715121">timers</span><span class="op" id="1715127">.</span><span class="ident" id="1715128">t</span>&nbsp;<span class="op" id="1715130">=</span>&nbsp;<span class="builtinfunc" id="1715132">append</span><span class="op" id="1715138">(</span><span class="ident" id="1715139">timers</span><span class="op" id="1715145">.</span><span class="ident" id="1715146">t</span><span class="op" id="1715147">,</span>&nbsp;<span class="ident" id="1715149">t</span><span class="op" id="1715150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1715153">siftupTimer</span><span class="op" id="1715164">(</span><span class="ident" id="1715165">t</span><span class="op" id="1715166">.</span><span class="ident" id="1715167">i</span><span class="op" id="1715168">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1715171">if</span>&nbsp;<span class="ident" id="1715174">t</span><span class="op" id="1715175">.</span><span class="ident" id="1715176">i</span>&nbsp;<span class="op" id="1715178">==</span>&nbsp;<span class="num" id="1715181">0</span>&nbsp;<span class="op" id="1715183">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1715187">//&nbsp;siftup&nbsp;moved&nbsp;to&nbsp;top:&nbsp;new&nbsp;earliest&nbsp;deadline.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1715236">if</span>&nbsp;<span class="ident" id="1715239">timers</span><span class="op" id="1715245">.</span><span class="ident" id="1715246">sleeping</span>&nbsp;<span class="op" id="1715255">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1715260">timers</span><span class="op" id="1715266">.</span><span class="ident" id="1715267">sleeping</span>&nbsp;<span class="op" id="1715276">=</span>&nbsp;<span class="builtintype" id="1715278">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1715287">notewakeup</span><span class="op" id="1715297">(</span><span class="op" id="1715298">&amp;</span><span class="ident" id="1715299">timers</span><span class="op" id="1715305">.</span><span class="ident" id="1715306">waitnote</span><span class="op" id="1715314">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1715318">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1715322">if</span>&nbsp;<span class="ident" id="1715325">timers</span><span class="op" id="1715331">.</span><span class="ident" id="1715332">rescheduling</span>&nbsp;<span class="op" id="1715345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1715350">timers</span><span class="op" id="1715356">.</span><span class="ident" id="1715357">rescheduling</span>&nbsp;<span class="op" id="1715370">=</span>&nbsp;<span class="builtintype" id="1715372">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1715381">goready</span><span class="op" id="1715388">(</span><span class="ident" id="1715389">timers</span><span class="op" id="1715395">.</span><span class="ident" id="1715396">gp</span><span class="op" id="1715398">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1715402">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1715405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1715408">if</span>&nbsp;<span class="op" id="1715411">!</span><span class="ident" id="1715412">timers</span><span class="op" id="1715418">.</span><span class="ident" id="1715419">created</span>&nbsp;<span class="op" id="1715427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1715431">timers</span><span class="op" id="1715437">.</span><span class="ident" id="1715438">created</span>&nbsp;<span class="op" id="1715446">=</span>&nbsp;<span class="builtintype" id="1715448">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1715455">go</span>&nbsp;<span class="ident" id="1715458">timerproc</span><span class="op" id="1715467">(</span><span class="op" id="1715468">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1715471">}</span><br>
<span class="lineno">115</span><span class="op" id="1715473">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1715476">//&nbsp;Delete&nbsp;timer&nbsp;t&nbsp;from&nbsp;the&nbsp;heap.</span><br>
<span class="lineno"></span><span class="comment" id="1715509">//&nbsp;Do&nbsp;not&nbsp;need&nbsp;to&nbsp;update&nbsp;the&nbsp;timerproc:&nbsp;if&nbsp;it&nbsp;wakes&nbsp;up&nbsp;early,&nbsp;no&nbsp;big&nbsp;deal.</span><br>
<span class="lineno"></span><span class="keyword" id="1715584">func</span>&nbsp;<span class="ident" id="1715589">deltimer</span><span class="op" id="1715597">(</span><span class="ident" id="1715598">t</span>&nbsp;<span class="op" id="1715600">*</span><span class="ident" id="1715601">timer</span><span class="op" id="1715606">)</span>&nbsp;<span class="builtintype" id="1715608">bool</span>&nbsp;<span class="op" id="1715613">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1715616">//&nbsp;Dereference&nbsp;t&nbsp;so&nbsp;that&nbsp;any&nbsp;panic&nbsp;happens&nbsp;before&nbsp;the&nbsp;lock&nbsp;is&nbsp;held.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1715685">//&nbsp;Discard&nbsp;result,&nbsp;because&nbsp;t&nbsp;might&nbsp;be&nbsp;moving&nbsp;in&nbsp;the&nbsp;heap.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1715744">_</span>&nbsp;<span class="op" id="1715746">=</span>&nbsp;<span class="ident" id="1715748">t</span><span class="op" id="1715749">.</span><span class="ident" id="1715750">i</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1715754">lock</span><span class="op" id="1715758">(</span><span class="op" id="1715759">&amp;</span><span class="ident" id="1715760">timers</span><span class="op" id="1715766">.</span><span class="ident" id="1715767">lock</span><span class="op" id="1715771">)</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1715774">//&nbsp;t&nbsp;may&nbsp;not&nbsp;be&nbsp;registered&nbsp;anymore&nbsp;and&nbsp;may&nbsp;have</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1715823">//&nbsp;a&nbsp;bogus&nbsp;i&nbsp;(typically&nbsp;0,&nbsp;if&nbsp;generated&nbsp;by&nbsp;Go).</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1715872">//&nbsp;Verify&nbsp;it&nbsp;before&nbsp;proceeding.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1715905">i</span>&nbsp;<span class="op" id="1715907">:=</span>&nbsp;<span class="ident" id="1715910">t</span><span class="op" id="1715911">.</span><span class="ident" id="1715912">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1715915">last</span>&nbsp;<span class="op" id="1715920">:=</span>&nbsp;<span class="builtinfunc" id="1715923">len</span><span class="op" id="1715926">(</span><span class="ident" id="1715927">timers</span><span class="op" id="1715933">.</span><span class="ident" id="1715934">t</span><span class="op" id="1715935">)</span>&nbsp;<span class="op" id="1715937">-</span>&nbsp;<span class="num" id="1715939">1</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1715942">if</span>&nbsp;<span class="ident" id="1715945">i</span>&nbsp;<span class="op" id="1715947">&lt;</span>&nbsp;<span class="num" id="1715949">0</span>&nbsp;<span class="op" id="1715951">||</span>&nbsp;<span class="ident" id="1715954">i</span>&nbsp;<span class="op" id="1715956">&gt;</span>&nbsp;<span class="ident" id="1715958">last</span>&nbsp;<span class="op" id="1715963">||</span>&nbsp;<span class="ident" id="1715966">timers</span><span class="op" id="1715972">.</span><span class="ident" id="1715973">t</span><span class="op" id="1715974">[</span><span class="ident" id="1715975">i</span><span class="op" id="1715976">]</span>&nbsp;<span class="op" id="1715978">!=</span>&nbsp;<span class="ident" id="1715981">t</span>&nbsp;<span class="op" id="1715983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1715987">unlock</span><span class="op" id="1715993">(</span><span class="op" id="1715994">&amp;</span><span class="ident" id="1715995">timers</span><span class="op" id="1716001">.</span><span class="ident" id="1716002">lock</span><span class="op" id="1716006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1716010">return</span>&nbsp;<span class="builtintype" id="1716017">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1716024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1716027">if</span>&nbsp;<span class="ident" id="1716030">i</span>&nbsp;<span class="op" id="1716032">!=</span>&nbsp;<span class="ident" id="1716035">last</span>&nbsp;<span class="op" id="1716040">{</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716044">timers</span><span class="op" id="1716050">.</span><span class="ident" id="1716051">t</span><span class="op" id="1716052">[</span><span class="ident" id="1716053">i</span><span class="op" id="1716054">]</span>&nbsp;<span class="op" id="1716056">=</span>&nbsp;<span class="ident" id="1716058">timers</span><span class="op" id="1716064">.</span><span class="ident" id="1716065">t</span><span class="op" id="1716066">[</span><span class="ident" id="1716067">last</span><span class="op" id="1716071">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716075">timers</span><span class="op" id="1716081">.</span><span class="ident" id="1716082">t</span><span class="op" id="1716083">[</span><span class="ident" id="1716084">i</span><span class="op" id="1716085">]</span><span class="op" id="1716086">.</span><span class="ident" id="1716087">i</span>&nbsp;<span class="op" id="1716089">=</span>&nbsp;<span class="ident" id="1716091">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1716094">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716097">timers</span><span class="op" id="1716103">.</span><span class="ident" id="1716104">t</span><span class="op" id="1716105">[</span><span class="ident" id="1716106">last</span><span class="op" id="1716110">]</span>&nbsp;<span class="op" id="1716112">=</span>&nbsp;<span class="ident" id="1716114">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716119">timers</span><span class="op" id="1716125">.</span><span class="ident" id="1716126">t</span>&nbsp;<span class="op" id="1716128">=</span>&nbsp;<span class="ident" id="1716130">timers</span><span class="op" id="1716136">.</span><span class="ident" id="1716137">t</span><span class="op" id="1716138">[</span><span class="op" id="1716139">:</span><span class="ident" id="1716140">last</span><span class="op" id="1716144">]</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1716147">if</span>&nbsp;<span class="ident" id="1716150">i</span>&nbsp;<span class="op" id="1716152">!=</span>&nbsp;<span class="ident" id="1716155">last</span>&nbsp;<span class="op" id="1716160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716164">siftupTimer</span><span class="op" id="1716175">(</span><span class="ident" id="1716176">i</span><span class="op" id="1716177">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716181">siftdownTimer</span><span class="op" id="1716194">(</span><span class="ident" id="1716195">i</span><span class="op" id="1716196">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1716199">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716202">unlock</span><span class="op" id="1716208">(</span><span class="op" id="1716209">&amp;</span><span class="ident" id="1716210">timers</span><span class="op" id="1716216">.</span><span class="ident" id="1716217">lock</span><span class="op" id="1716221">)</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1716224">return</span>&nbsp;<span class="builtintype" id="1716231">true</span><br>
<span class="lineno"></span><span class="op" id="1716236">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1716239">//&nbsp;Timerproc&nbsp;runs&nbsp;the&nbsp;time-driven&nbsp;events.</span><br>
<span class="lineno"></span><span class="comment" id="1716281">//&nbsp;It&nbsp;sleeps&nbsp;until&nbsp;the&nbsp;next&nbsp;event&nbsp;in&nbsp;the&nbsp;timers&nbsp;heap.</span><br>
<span class="lineno">150</span><span class="comment" id="1716335">//&nbsp;If&nbsp;addtimer&nbsp;inserts&nbsp;a&nbsp;new&nbsp;earlier&nbsp;event,&nbsp;addtimer1&nbsp;wakes&nbsp;timerproc&nbsp;early.</span><br>
<span class="lineno"></span><span class="keyword" id="1716412">func</span>&nbsp;<span class="ident" id="1716417">timerproc</span><span class="op" id="1716426">(</span><span class="op" id="1716427">)</span>&nbsp;<span class="op" id="1716429">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716432">timers</span><span class="op" id="1716438">.</span><span class="ident" id="1716439">gp</span>&nbsp;<span class="op" id="1716442">=</span>&nbsp;<span class="ident" id="1716444">getg</span><span class="op" id="1716448">(</span><span class="op" id="1716449">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716452">timers</span><span class="op" id="1716458">.</span><span class="ident" id="1716459">gp</span><span class="op" id="1716461">.</span><span class="ident" id="1716462">issystem</span>&nbsp;<span class="op" id="1716471">=</span>&nbsp;<span class="builtintype" id="1716473">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1716479">for</span>&nbsp;<span class="op" id="1716483">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716487">lock</span><span class="op" id="1716491">(</span><span class="op" id="1716492">&amp;</span><span class="ident" id="1716493">timers</span><span class="op" id="1716499">.</span><span class="ident" id="1716500">lock</span><span class="op" id="1716504">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716508">timers</span><span class="op" id="1716514">.</span><span class="ident" id="1716515">sleeping</span>&nbsp;<span class="op" id="1716524">=</span>&nbsp;<span class="builtintype" id="1716526">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716534">now</span>&nbsp;<span class="op" id="1716538">:=</span>&nbsp;<span class="ident" id="1716541">nanotime</span><span class="op" id="1716549">(</span><span class="op" id="1716550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716554">delta</span>&nbsp;<span class="op" id="1716560">:=</span>&nbsp;<span class="ident" id="1716563">int64</span><span class="op" id="1716568">(</span><span class="op" id="1716569">-</span><span class="num" id="1716570">1</span><span class="op" id="1716571">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1716575">for</span>&nbsp;<span class="op" id="1716579">{</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1716584">if</span>&nbsp;<span class="builtinfunc" id="1716587">len</span><span class="op" id="1716590">(</span><span class="ident" id="1716591">timers</span><span class="op" id="1716597">.</span><span class="ident" id="1716598">t</span><span class="op" id="1716599">)</span>&nbsp;<span class="op" id="1716601">==</span>&nbsp;<span class="num" id="1716604">0</span>&nbsp;<span class="op" id="1716606">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716612">delta</span>&nbsp;<span class="op" id="1716618">=</span>&nbsp;<span class="op" id="1716620">-</span><span class="num" id="1716621">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1716627">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1716636">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716641">t</span>&nbsp;<span class="op" id="1716643">:=</span>&nbsp;<span class="ident" id="1716646">timers</span><span class="op" id="1716652">.</span><span class="ident" id="1716653">t</span><span class="op" id="1716654">[</span><span class="num" id="1716655">0</span><span class="op" id="1716656">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716661">delta</span>&nbsp;<span class="op" id="1716667">=</span>&nbsp;<span class="ident" id="1716669">t</span><span class="op" id="1716670">.</span><span class="ident" id="1716671">when</span>&nbsp;<span class="op" id="1716676">-</span>&nbsp;<span class="ident" id="1716678">now</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1716685">if</span>&nbsp;<span class="ident" id="1716688">delta</span>&nbsp;<span class="op" id="1716694">&gt;</span>&nbsp;<span class="num" id="1716696">0</span>&nbsp;<span class="op" id="1716698">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1716704">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1716713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1716718">if</span>&nbsp;<span class="ident" id="1716721">t</span><span class="op" id="1716722">.</span><span class="ident" id="1716723">period</span>&nbsp;<span class="op" id="1716730">&gt;</span>&nbsp;<span class="num" id="1716732">0</span>&nbsp;<span class="op" id="1716734">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1716740">//&nbsp;leave&nbsp;in&nbsp;heap&nbsp;but&nbsp;adjust&nbsp;next&nbsp;time&nbsp;to&nbsp;fire</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716790">t</span><span class="op" id="1716791">.</span><span class="ident" id="1716792">when</span>&nbsp;<span class="op" id="1716797">+=</span>&nbsp;<span class="ident" id="1716800">t</span><span class="op" id="1716801">.</span><span class="ident" id="1716802">period</span>&nbsp;<span class="op" id="1716809">*</span>&nbsp;<span class="op" id="1716811">(</span><span class="num" id="1716812">1</span>&nbsp;<span class="op" id="1716814">+</span>&nbsp;<span class="op" id="1716816">-</span><span class="ident" id="1716817">delta</span><span class="op" id="1716822">/</span><span class="ident" id="1716823">t</span><span class="op" id="1716824">.</span><span class="ident" id="1716825">period</span><span class="op" id="1716831">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716837">siftdownTimer</span><span class="op" id="1716850">(</span><span class="num" id="1716851">0</span><span class="op" id="1716852">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1716857">}</span>&nbsp;<span class="keyword" id="1716859">else</span>&nbsp;<span class="op" id="1716864">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1716870">//&nbsp;remove&nbsp;from&nbsp;heap</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716894">last</span>&nbsp;<span class="op" id="1716899">:=</span>&nbsp;<span class="builtinfunc" id="1716902">len</span><span class="op" id="1716905">(</span><span class="ident" id="1716906">timers</span><span class="op" id="1716912">.</span><span class="ident" id="1716913">t</span><span class="op" id="1716914">)</span>&nbsp;<span class="op" id="1716916">-</span>&nbsp;<span class="num" id="1716918">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1716924">if</span>&nbsp;<span class="ident" id="1716927">last</span>&nbsp;<span class="op" id="1716932">&gt;</span>&nbsp;<span class="num" id="1716934">0</span>&nbsp;<span class="op" id="1716936">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716943">timers</span><span class="op" id="1716949">.</span><span class="ident" id="1716950">t</span><span class="op" id="1716951">[</span><span class="num" id="1716952">0</span><span class="op" id="1716953">]</span>&nbsp;<span class="op" id="1716955">=</span>&nbsp;<span class="ident" id="1716957">timers</span><span class="op" id="1716963">.</span><span class="ident" id="1716964">t</span><span class="op" id="1716965">[</span><span class="ident" id="1716966">last</span><span class="op" id="1716970">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1716977">timers</span><span class="op" id="1716983">.</span><span class="ident" id="1716984">t</span><span class="op" id="1716985">[</span><span class="num" id="1716986">0</span><span class="op" id="1716987">]</span><span class="op" id="1716988">.</span><span class="ident" id="1716989">i</span>&nbsp;<span class="op" id="1716991">=</span>&nbsp;<span class="num" id="1716993">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1716999">}</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717005">timers</span><span class="op" id="1717011">.</span><span class="ident" id="1717012">t</span><span class="op" id="1717013">[</span><span class="ident" id="1717014">last</span><span class="op" id="1717018">]</span>&nbsp;<span class="op" id="1717020">=</span>&nbsp;<span class="ident" id="1717022">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717030">timers</span><span class="op" id="1717036">.</span><span class="ident" id="1717037">t</span>&nbsp;<span class="op" id="1717039">=</span>&nbsp;<span class="ident" id="1717041">timers</span><span class="op" id="1717047">.</span><span class="ident" id="1717048">t</span><span class="op" id="1717049">[</span><span class="op" id="1717050">:</span><span class="ident" id="1717051">last</span><span class="op" id="1717055">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1717061">if</span>&nbsp;<span class="ident" id="1717064">last</span>&nbsp;<span class="op" id="1717069">&gt;</span>&nbsp;<span class="num" id="1717071">0</span>&nbsp;<span class="op" id="1717073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717080">siftdownTimer</span><span class="op" id="1717093">(</span><span class="num" id="1717094">0</span><span class="op" id="1717095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1717101">}</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717107">t</span><span class="op" id="1717108">.</span><span class="ident" id="1717109">i</span>&nbsp;<span class="op" id="1717111">=</span>&nbsp;<span class="op" id="1717113">-</span><span class="num" id="1717114">1</span>&nbsp;<span class="comment" id="1717116">//&nbsp;mark&nbsp;as&nbsp;removed</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1717138">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717143">f</span>&nbsp;<span class="op" id="1717145">:=</span>&nbsp;<span class="ident" id="1717148">t</span><span class="op" id="1717149">.</span><span class="ident" id="1717150">f</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717155">arg</span>&nbsp;<span class="op" id="1717159">:=</span>&nbsp;<span class="ident" id="1717162">t</span><span class="op" id="1717163">.</span><span class="ident" id="1717164">arg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717171">seq</span>&nbsp;<span class="op" id="1717175">:=</span>&nbsp;<span class="ident" id="1717178">t</span><span class="op" id="1717179">.</span><span class="ident" id="1717180">seq</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717187">unlock</span><span class="op" id="1717193">(</span><span class="op" id="1717194">&amp;</span><span class="ident" id="1717195">timers</span><span class="op" id="1717201">.</span><span class="ident" id="1717202">lock</span><span class="op" id="1717206">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1717211">if</span>&nbsp;<span class="ident" id="1717214">raceenabled</span>&nbsp;<span class="op" id="1717226">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717232">raceacquire</span><span class="op" id="1717243">(</span><span class="ident" id="1717244">unsafe</span><span class="op" id="1717250">.</span><span class="ident" id="1717251">Pointer</span><span class="op" id="1717258">(</span><span class="ident" id="1717259">t</span><span class="op" id="1717260">)</span><span class="op" id="1717261">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1717266">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717271">f</span><span class="op" id="1717272">(</span><span class="ident" id="1717273">arg</span><span class="op" id="1717276">,</span>&nbsp;<span class="ident" id="1717278">seq</span><span class="op" id="1717281">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717286">lock</span><span class="op" id="1717290">(</span><span class="op" id="1717291">&amp;</span><span class="ident" id="1717292">timers</span><span class="op" id="1717298">.</span><span class="ident" id="1717299">lock</span><span class="op" id="1717303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1717307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1717311">if</span>&nbsp;<span class="ident" id="1717314">delta</span>&nbsp;<span class="op" id="1717320">&lt;</span>&nbsp;<span class="num" id="1717322">0</span>&nbsp;<span class="op" id="1717324">||</span>&nbsp;<span class="ident" id="1717327">faketime</span>&nbsp;<span class="op" id="1717336">&gt;</span>&nbsp;<span class="num" id="1717338">0</span>&nbsp;<span class="op" id="1717340">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1717345">//&nbsp;No&nbsp;timers&nbsp;left&nbsp;-&nbsp;put&nbsp;goroutine&nbsp;to&nbsp;sleep.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717392">timers</span><span class="op" id="1717398">.</span><span class="ident" id="1717399">rescheduling</span>&nbsp;<span class="op" id="1717412">=</span>&nbsp;<span class="builtintype" id="1717414">true</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717422">goparkunlock</span><span class="op" id="1717434">(</span><span class="op" id="1717435">&amp;</span><span class="ident" id="1717436">timers</span><span class="op" id="1717442">.</span><span class="ident" id="1717443">lock</span><span class="op" id="1717447">,</span>&nbsp;<span class="string" id="1717449">&#34;timer&nbsp;goroutine&nbsp;(idle)&#34;</span><span class="op" id="1717473">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1717478">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1717489">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1717493">//&nbsp;At&nbsp;least&nbsp;one&nbsp;timer&nbsp;pending.&nbsp;&nbsp;Sleep&nbsp;until&nbsp;then.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717545">timers</span><span class="op" id="1717551">.</span><span class="ident" id="1717552">sleeping</span>&nbsp;<span class="op" id="1717561">=</span>&nbsp;<span class="builtintype" id="1717563">true</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717570">noteclear</span><span class="op" id="1717579">(</span><span class="op" id="1717580">&amp;</span><span class="ident" id="1717581">timers</span><span class="op" id="1717587">.</span><span class="ident" id="1717588">waitnote</span><span class="op" id="1717596">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717600">unlock</span><span class="op" id="1717606">(</span><span class="op" id="1717607">&amp;</span><span class="ident" id="1717608">timers</span><span class="op" id="1717614">.</span><span class="ident" id="1717615">lock</span><span class="op" id="1717619">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717623">notetsleepg</span><span class="op" id="1717634">(</span><span class="op" id="1717635">&amp;</span><span class="ident" id="1717636">timers</span><span class="op" id="1717642">.</span><span class="ident" id="1717643">waitnote</span><span class="op" id="1717651">,</span>&nbsp;<span class="ident" id="1717653">delta</span><span class="op" id="1717658">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1717661">}</span><br>
<span class="lineno"></span><span class="op" id="1717663">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span><span class="keyword" id="1717666">func</span>&nbsp;<span class="ident" id="1717671">timejump</span><span class="op" id="1717679">(</span><span class="op" id="1717680">)</span>&nbsp;<span class="op" id="1717682">*</span><span class="ident" id="1717683">g</span>&nbsp;<span class="op" id="1717685">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1717688">if</span>&nbsp;<span class="ident" id="1717691">faketime</span>&nbsp;<span class="op" id="1717700">==</span>&nbsp;<span class="num" id="1717703">0</span>&nbsp;<span class="op" id="1717705">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1717709">return</span>&nbsp;<span class="ident" id="1717716">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1717721">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717725">lock</span><span class="op" id="1717729">(</span><span class="op" id="1717730">&amp;</span><span class="ident" id="1717731">timers</span><span class="op" id="1717737">.</span><span class="ident" id="1717738">lock</span><span class="op" id="1717742">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1717745">if</span>&nbsp;<span class="op" id="1717748">!</span><span class="ident" id="1717749">timers</span><span class="op" id="1717755">.</span><span class="ident" id="1717756">created</span>&nbsp;<span class="op" id="1717764">||</span>&nbsp;<span class="builtinfunc" id="1717767">len</span><span class="op" id="1717770">(</span><span class="ident" id="1717771">timers</span><span class="op" id="1717777">.</span><span class="ident" id="1717778">t</span><span class="op" id="1717779">)</span>&nbsp;<span class="op" id="1717781">==</span>&nbsp;<span class="num" id="1717784">0</span>&nbsp;<span class="op" id="1717786">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717790">unlock</span><span class="op" id="1717796">(</span><span class="op" id="1717797">&amp;</span><span class="ident" id="1717798">timers</span><span class="op" id="1717804">.</span><span class="ident" id="1717805">lock</span><span class="op" id="1717809">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1717813">return</span>&nbsp;<span class="ident" id="1717820">nil</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1717825">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1717829">var</span>&nbsp;<span class="ident" id="1717833">gp</span>&nbsp;<span class="op" id="1717836">*</span><span class="ident" id="1717837">g</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1717840">if</span>&nbsp;<span class="ident" id="1717843">faketime</span>&nbsp;<span class="op" id="1717852">&lt;</span>&nbsp;<span class="ident" id="1717854">timers</span><span class="op" id="1717860">.</span><span class="ident" id="1717861">t</span><span class="op" id="1717862">[</span><span class="num" id="1717863">0</span><span class="op" id="1717864">]</span><span class="op" id="1717865">.</span><span class="ident" id="1717866">when</span>&nbsp;<span class="op" id="1717871">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717875">faketime</span>&nbsp;<span class="op" id="1717884">=</span>&nbsp;<span class="ident" id="1717886">timers</span><span class="op" id="1717892">.</span><span class="ident" id="1717893">t</span><span class="op" id="1717894">[</span><span class="num" id="1717895">0</span><span class="op" id="1717896">]</span><span class="op" id="1717897">.</span><span class="ident" id="1717898">when</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1717905">if</span>&nbsp;<span class="ident" id="1717908">timers</span><span class="op" id="1717914">.</span><span class="ident" id="1717915">rescheduling</span>&nbsp;<span class="op" id="1717928">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717933">timers</span><span class="op" id="1717939">.</span><span class="ident" id="1717940">rescheduling</span>&nbsp;<span class="op" id="1717953">=</span>&nbsp;<span class="builtintype" id="1717955">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717964">gp</span>&nbsp;<span class="op" id="1717967">=</span>&nbsp;<span class="ident" id="1717969">timers</span><span class="op" id="1717975">.</span><span class="ident" id="1717976">gp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1717981">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1717984">}</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1717987">unlock</span><span class="op" id="1717993">(</span><span class="op" id="1717994">&amp;</span><span class="ident" id="1717995">timers</span><span class="op" id="1718001">.</span><span class="ident" id="1718002">lock</span><span class="op" id="1718006">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1718009">return</span>&nbsp;<span class="ident" id="1718016">gp</span><br>
<span class="lineno"></span><span class="op" id="1718019">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1718022">//&nbsp;Heap&nbsp;maintenance&nbsp;algorithms.</span><br>
<span class="lineno">235</span><br>
<span class="lineno"></span><span class="keyword" id="1718055">func</span>&nbsp;<span class="ident" id="1718060">siftupTimer</span><span class="op" id="1718071">(</span><span class="ident" id="1718072">i</span>&nbsp;<span class="builtintype" id="1718074">int</span><span class="op" id="1718077">)</span>&nbsp;<span class="op" id="1718079">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718082">t</span>&nbsp;<span class="op" id="1718084">:=</span>&nbsp;<span class="ident" id="1718087">timers</span><span class="op" id="1718093">.</span><span class="ident" id="1718094">t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718097">when</span>&nbsp;<span class="op" id="1718102">:=</span>&nbsp;<span class="ident" id="1718105">t</span><span class="op" id="1718106">[</span><span class="ident" id="1718107">i</span><span class="op" id="1718108">]</span><span class="op" id="1718109">.</span><span class="ident" id="1718110">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718116">tmp</span>&nbsp;<span class="op" id="1718120">:=</span>&nbsp;<span class="ident" id="1718123">t</span><span class="op" id="1718124">[</span><span class="ident" id="1718125">i</span><span class="op" id="1718126">]</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1718129">for</span>&nbsp;<span class="ident" id="1718133">i</span>&nbsp;<span class="op" id="1718135">&gt;</span>&nbsp;<span class="num" id="1718137">0</span>&nbsp;<span class="op" id="1718139">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718143">p</span>&nbsp;<span class="op" id="1718145">:=</span>&nbsp;<span class="op" id="1718148">(</span><span class="ident" id="1718149">i</span>&nbsp;<span class="op" id="1718151">-</span>&nbsp;<span class="num" id="1718153">1</span><span class="op" id="1718154">)</span>&nbsp;<span class="op" id="1718156">/</span>&nbsp;<span class="num" id="1718158">4</span>&nbsp;<span class="comment" id="1718160">//&nbsp;parent</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1718172">if</span>&nbsp;<span class="ident" id="1718175">when</span>&nbsp;<span class="op" id="1718180">&gt;=</span>&nbsp;<span class="ident" id="1718183">t</span><span class="op" id="1718184">[</span><span class="ident" id="1718185">p</span><span class="op" id="1718186">]</span><span class="op" id="1718187">.</span><span class="ident" id="1718188">when</span>&nbsp;<span class="op" id="1718193">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1718198">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1718206">}</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718210">t</span><span class="op" id="1718211">[</span><span class="ident" id="1718212">i</span><span class="op" id="1718213">]</span>&nbsp;<span class="op" id="1718215">=</span>&nbsp;<span class="ident" id="1718217">t</span><span class="op" id="1718218">[</span><span class="ident" id="1718219">p</span><span class="op" id="1718220">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718224">t</span><span class="op" id="1718225">[</span><span class="ident" id="1718226">i</span><span class="op" id="1718227">]</span><span class="op" id="1718228">.</span><span class="ident" id="1718229">i</span>&nbsp;<span class="op" id="1718231">=</span>&nbsp;<span class="ident" id="1718233">i</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718237">t</span><span class="op" id="1718238">[</span><span class="ident" id="1718239">p</span><span class="op" id="1718240">]</span>&nbsp;<span class="op" id="1718242">=</span>&nbsp;<span class="ident" id="1718244">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718250">t</span><span class="op" id="1718251">[</span><span class="ident" id="1718252">p</span><span class="op" id="1718253">]</span><span class="op" id="1718254">.</span><span class="ident" id="1718255">i</span>&nbsp;<span class="op" id="1718257">=</span>&nbsp;<span class="ident" id="1718259">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718263">i</span>&nbsp;<span class="op" id="1718265">=</span>&nbsp;<span class="ident" id="1718267">p</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1718270">}</span><br>
<span class="lineno"></span><span class="op" id="1718272">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1718275">func</span>&nbsp;<span class="ident" id="1718280">siftdownTimer</span><span class="op" id="1718293">(</span><span class="ident" id="1718294">i</span>&nbsp;<span class="builtintype" id="1718296">int</span><span class="op" id="1718299">)</span>&nbsp;<span class="op" id="1718301">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718304">t</span>&nbsp;<span class="op" id="1718306">:=</span>&nbsp;<span class="ident" id="1718309">timers</span><span class="op" id="1718315">.</span><span class="ident" id="1718316">t</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718319">n</span>&nbsp;<span class="op" id="1718321">:=</span>&nbsp;<span class="builtinfunc" id="1718324">len</span><span class="op" id="1718327">(</span><span class="ident" id="1718328">t</span><span class="op" id="1718329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718332">when</span>&nbsp;<span class="op" id="1718337">:=</span>&nbsp;<span class="ident" id="1718340">t</span><span class="op" id="1718341">[</span><span class="ident" id="1718342">i</span><span class="op" id="1718343">]</span><span class="op" id="1718344">.</span><span class="ident" id="1718345">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718351">tmp</span>&nbsp;<span class="op" id="1718355">:=</span>&nbsp;<span class="ident" id="1718358">t</span><span class="op" id="1718359">[</span><span class="ident" id="1718360">i</span><span class="op" id="1718361">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1718364">for</span>&nbsp;<span class="op" id="1718368">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718372">c</span>&nbsp;<span class="op" id="1718374">:=</span>&nbsp;<span class="ident" id="1718377">i</span><span class="op" id="1718378">*</span><span class="num" id="1718379">4</span>&nbsp;<span class="op" id="1718381">+</span>&nbsp;<span class="num" id="1718383">1</span>&nbsp;<span class="comment" id="1718385">//&nbsp;left&nbsp;child</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718401">c3</span>&nbsp;<span class="op" id="1718404">:=</span>&nbsp;<span class="ident" id="1718407">c</span>&nbsp;<span class="op" id="1718409">+</span>&nbsp;<span class="num" id="1718411">2</span>&nbsp;&nbsp;<span class="comment" id="1718414">//&nbsp;mid&nbsp;child</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1718429">if</span>&nbsp;<span class="ident" id="1718432">c</span>&nbsp;<span class="op" id="1718434">&gt;=</span>&nbsp;<span class="ident" id="1718437">n</span>&nbsp;<span class="op" id="1718439">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1718444">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1718452">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718456">w</span>&nbsp;<span class="op" id="1718458">:=</span>&nbsp;<span class="ident" id="1718461">t</span><span class="op" id="1718462">[</span><span class="ident" id="1718463">c</span><span class="op" id="1718464">]</span><span class="op" id="1718465">.</span><span class="ident" id="1718466">when</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1718473">if</span>&nbsp;<span class="ident" id="1718476">c</span><span class="op" id="1718477">+</span><span class="num" id="1718478">1</span>&nbsp;<span class="op" id="1718480">&lt;</span>&nbsp;<span class="ident" id="1718482">n</span>&nbsp;<span class="op" id="1718484">&amp;&amp;</span>&nbsp;<span class="ident" id="1718487">t</span><span class="op" id="1718488">[</span><span class="ident" id="1718489">c</span><span class="op" id="1718490">+</span><span class="num" id="1718491">1</span><span class="op" id="1718492">]</span><span class="op" id="1718493">.</span><span class="ident" id="1718494">when</span>&nbsp;<span class="op" id="1718499">&lt;</span>&nbsp;<span class="ident" id="1718501">w</span>&nbsp;<span class="op" id="1718503">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718508">w</span>&nbsp;<span class="op" id="1718510">=</span>&nbsp;<span class="ident" id="1718512">t</span><span class="op" id="1718513">[</span><span class="ident" id="1718514">c</span><span class="op" id="1718515">+</span><span class="num" id="1718516">1</span><span class="op" id="1718517">]</span><span class="op" id="1718518">.</span><span class="ident" id="1718519">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718527">c</span><span class="op" id="1718528">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1718533">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1718537">if</span>&nbsp;<span class="ident" id="1718540">c3</span>&nbsp;<span class="op" id="1718543">&lt;</span>&nbsp;<span class="ident" id="1718545">n</span>&nbsp;<span class="op" id="1718547">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718552">w3</span>&nbsp;<span class="op" id="1718555">:=</span>&nbsp;<span class="ident" id="1718558">t</span><span class="op" id="1718559">[</span><span class="ident" id="1718560">c3</span><span class="op" id="1718562">]</span><span class="op" id="1718563">.</span><span class="ident" id="1718564">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1718572">if</span>&nbsp;<span class="ident" id="1718575">c3</span><span class="op" id="1718577">+</span><span class="num" id="1718578">1</span>&nbsp;<span class="op" id="1718580">&lt;</span>&nbsp;<span class="ident" id="1718582">n</span>&nbsp;<span class="op" id="1718584">&amp;&amp;</span>&nbsp;<span class="ident" id="1718587">t</span><span class="op" id="1718588">[</span><span class="ident" id="1718589">c3</span><span class="op" id="1718591">+</span><span class="num" id="1718592">1</span><span class="op" id="1718593">]</span><span class="op" id="1718594">.</span><span class="ident" id="1718595">when</span>&nbsp;<span class="op" id="1718600">&lt;</span>&nbsp;<span class="ident" id="1718602">w3</span>&nbsp;<span class="op" id="1718605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718611">w3</span>&nbsp;<span class="op" id="1718614">=</span>&nbsp;<span class="ident" id="1718616">t</span><span class="op" id="1718617">[</span><span class="ident" id="1718618">c3</span><span class="op" id="1718620">+</span><span class="num" id="1718621">1</span><span class="op" id="1718622">]</span><span class="op" id="1718623">.</span><span class="ident" id="1718624">when</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718633">c3</span><span class="op" id="1718635">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1718641">}</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1718646">if</span>&nbsp;<span class="ident" id="1718649">w3</span>&nbsp;<span class="op" id="1718652">&lt;</span>&nbsp;<span class="ident" id="1718654">w</span>&nbsp;<span class="op" id="1718656">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718662">w</span>&nbsp;<span class="op" id="1718664">=</span>&nbsp;<span class="ident" id="1718666">w3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718673">c</span>&nbsp;<span class="op" id="1718675">=</span>&nbsp;<span class="ident" id="1718677">c3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1718683">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1718687">}</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1718691">if</span>&nbsp;<span class="ident" id="1718694">w</span>&nbsp;<span class="op" id="1718696">&gt;=</span>&nbsp;<span class="ident" id="1718699">when</span>&nbsp;<span class="op" id="1718704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1718709">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1718717">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718721">t</span><span class="op" id="1718722">[</span><span class="ident" id="1718723">i</span><span class="op" id="1718724">]</span>&nbsp;<span class="op" id="1718726">=</span>&nbsp;<span class="ident" id="1718728">t</span><span class="op" id="1718729">[</span><span class="ident" id="1718730">c</span><span class="op" id="1718731">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718735">t</span><span class="op" id="1718736">[</span><span class="ident" id="1718737">i</span><span class="op" id="1718738">]</span><span class="op" id="1718739">.</span><span class="ident" id="1718740">i</span>&nbsp;<span class="op" id="1718742">=</span>&nbsp;<span class="ident" id="1718744">i</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718748">t</span><span class="op" id="1718749">[</span><span class="ident" id="1718750">c</span><span class="op" id="1718751">]</span>&nbsp;<span class="op" id="1718753">=</span>&nbsp;<span class="ident" id="1718755">tmp</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718761">t</span><span class="op" id="1718762">[</span><span class="ident" id="1718763">c</span><span class="op" id="1718764">]</span><span class="op" id="1718765">.</span><span class="ident" id="1718766">i</span>&nbsp;<span class="op" id="1718768">=</span>&nbsp;<span class="ident" id="1718770">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1718774">i</span>&nbsp;<span class="op" id="1718776">=</span>&nbsp;<span class="ident" id="1718778">c</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1718781">}</span><br>
<span class="lineno"></span><span class="op" id="1718783">}</span>
</div>
</body>
</html>
