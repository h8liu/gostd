<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>crypto/sha1</h2>
<ul>
<li><a href="/gostd/crypto/sha1/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/crypto/sha1/sha1.go.html" class="current">sha1.go</a></li>
<li><a href="/gostd/crypto/sha1/sha1_test.go.html">sha1_test.go</a></li>
<li><a href="/gostd/crypto/sha1/sha1block.go.html">sha1block.go</a></li>
<li><a href="/gostd/crypto/sha1/sha1block_decl.go.html">sha1block_decl.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4338346">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4338401">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4338455">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4338506">//&nbsp;Package&nbsp;sha1&nbsp;implements&nbsp;the&nbsp;SHA1&nbsp;hash&nbsp;algorithm&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;3174.</span><br>
<span class="lineno"></span><span class="keyword" id="4338581">package</span>&nbsp;<span class="ident" id="4338589">sha1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4338595">import</span>&nbsp;<span class="op" id="4338602">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4338605">&#34;crypto&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="string" id="4338615">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="4338622">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4338625">func</span>&nbsp;<span class="ident" id="4338630">init</span><span class="op" id="4338634">(</span><span class="op" id="4338635">)</span>&nbsp;<span class="op" id="4338637">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4338640">crypto</span><span class="op" id="4338646">.</span><span class="ident" id="4338647">RegisterHash</span><span class="op" id="4338659">(</span><span class="ident" id="4338660">crypto</span><span class="op" id="4338666">.</span><span class="ident" id="4338667">SHA1</span><span class="op" id="4338671">,</span>&nbsp;<span class="ident" id="4338673">New</span><span class="op" id="4338676">)</span><br>
<span class="lineno">15</span><span class="op" id="4338678">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4338681">//&nbsp;The&nbsp;size&nbsp;of&nbsp;a&nbsp;SHA1&nbsp;checksum&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4338722">const</span>&nbsp;<span class="ident" id="4338728">Size</span>&nbsp;<span class="op" id="4338733">=</span>&nbsp;<span class="num" id="4338735">20</span><br>
<span class="lineno"></span><br>
<span class="lineno">20</span><span class="comment" id="4338739">//&nbsp;The&nbsp;blocksize&nbsp;of&nbsp;SHA1&nbsp;in&nbsp;bytes.</span><br>
<span class="lineno"></span><span class="keyword" id="4338774">const</span>&nbsp;<span class="ident" id="4338780">BlockSize</span>&nbsp;<span class="op" id="4338790">=</span>&nbsp;<span class="num" id="4338792">64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4338796">const</span>&nbsp;<span class="op" id="4338802">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4338805">chunk</span>&nbsp;<span class="op" id="4338811">=</span>&nbsp;<span class="num" id="4338813">64</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4338817">init0</span>&nbsp;<span class="op" id="4338823">=</span>&nbsp;<span class="num" id="4338825">0x67452301</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4338837">init1</span>&nbsp;<span class="op" id="4338843">=</span>&nbsp;<span class="num" id="4338845">0xEFCDAB89</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4338857">init2</span>&nbsp;<span class="op" id="4338863">=</span>&nbsp;<span class="num" id="4338865">0x98BADCFE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4338877">init3</span>&nbsp;<span class="op" id="4338883">=</span>&nbsp;<span class="num" id="4338885">0x10325476</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4338897">init4</span>&nbsp;<span class="op" id="4338903">=</span>&nbsp;<span class="num" id="4338905">0xC3D2E1F0</span><br>
<span class="lineno">30</span><span class="op" id="4338916">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4338919">//&nbsp;digest&nbsp;represents&nbsp;the&nbsp;partial&nbsp;evaluation&nbsp;of&nbsp;a&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4338978">type</span>&nbsp;<span class="ident" id="4338983">digest</span>&nbsp;<span class="keyword" id="4338990">struct</span>&nbsp;<span class="op" id="4338997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339000">h</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4339004">[</span><span class="num" id="4339005">5</span><span class="op" id="4339006">]</span><span class="builtintype" id="4339007">uint32</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339015">x</span>&nbsp;&nbsp;&nbsp;<span class="op" id="4339019">[</span><span class="ident" id="4339020">chunk</span><span class="op" id="4339025">]</span><span class="builtintype" id="4339026">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339032">nx</span>&nbsp;&nbsp;<span class="builtintype" id="4339036">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4339041">len</span>&nbsp;<span class="builtintype" id="4339045">uint64</span><br>
<span class="lineno"></span><span class="op" id="4339052">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="keyword" id="4339055">func</span>&nbsp;<span class="op" id="4339060">(</span><span class="ident" id="4339061">d</span>&nbsp;<span class="op" id="4339063">*</span><span class="ident" id="4339064">digest</span><span class="op" id="4339070">)</span>&nbsp;<span class="ident" id="4339072">Reset</span><span class="op" id="4339077">(</span><span class="op" id="4339078">)</span>&nbsp;<span class="op" id="4339080">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339083">d</span><span class="op" id="4339084">.</span><span class="ident" id="4339085">h</span><span class="op" id="4339086">[</span><span class="num" id="4339087">0</span><span class="op" id="4339088">]</span>&nbsp;<span class="op" id="4339090">=</span>&nbsp;<span class="ident" id="4339092">init0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339099">d</span><span class="op" id="4339100">.</span><span class="ident" id="4339101">h</span><span class="op" id="4339102">[</span><span class="num" id="4339103">1</span><span class="op" id="4339104">]</span>&nbsp;<span class="op" id="4339106">=</span>&nbsp;<span class="ident" id="4339108">init1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339115">d</span><span class="op" id="4339116">.</span><span class="ident" id="4339117">h</span><span class="op" id="4339118">[</span><span class="num" id="4339119">2</span><span class="op" id="4339120">]</span>&nbsp;<span class="op" id="4339122">=</span>&nbsp;<span class="ident" id="4339124">init2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339131">d</span><span class="op" id="4339132">.</span><span class="ident" id="4339133">h</span><span class="op" id="4339134">[</span><span class="num" id="4339135">3</span><span class="op" id="4339136">]</span>&nbsp;<span class="op" id="4339138">=</span>&nbsp;<span class="ident" id="4339140">init3</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339147">d</span><span class="op" id="4339148">.</span><span class="ident" id="4339149">h</span><span class="op" id="4339150">[</span><span class="num" id="4339151">4</span><span class="op" id="4339152">]</span>&nbsp;<span class="op" id="4339154">=</span>&nbsp;<span class="ident" id="4339156">init4</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339163">d</span><span class="op" id="4339164">.</span><span class="ident" id="4339165">nx</span>&nbsp;<span class="op" id="4339168">=</span>&nbsp;<span class="num" id="4339170">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339173">d</span><span class="op" id="4339174">.</span><span class="builtinfunc" id="4339175">len</span>&nbsp;<span class="op" id="4339179">=</span>&nbsp;<span class="num" id="4339181">0</span><br>
<span class="lineno"></span><span class="op" id="4339183">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">50</span><span class="comment" id="4339186">//&nbsp;New&nbsp;returns&nbsp;a&nbsp;new&nbsp;hash.Hash&nbsp;computing&nbsp;the&nbsp;SHA1&nbsp;checksum.</span><br>
<span class="lineno"></span><span class="keyword" id="4339246">func</span>&nbsp;<span class="ident" id="4339251">New</span><span class="op" id="4339254">(</span><span class="op" id="4339255">)</span>&nbsp;<span class="ident" id="4339257">hash</span><span class="op" id="4339261">.</span><span class="ident" id="4339262">Hash</span>&nbsp;<span class="op" id="4339267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339270">d</span>&nbsp;<span class="op" id="4339272">:=</span>&nbsp;<span class="builtinfunc" id="4339275">new</span><span class="op" id="4339278">(</span><span class="ident" id="4339279">digest</span><span class="op" id="4339285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339288">d</span><span class="op" id="4339289">.</span><span class="ident" id="4339290">Reset</span><span class="op" id="4339295">(</span><span class="op" id="4339296">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4339299">return</span>&nbsp;<span class="ident" id="4339306">d</span><br>
<span class="lineno">55</span><span class="op" id="4339308">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4339311">func</span>&nbsp;<span class="op" id="4339316">(</span><span class="ident" id="4339317">d</span>&nbsp;<span class="op" id="4339319">*</span><span class="ident" id="4339320">digest</span><span class="op" id="4339326">)</span>&nbsp;<span class="ident" id="4339328">Size</span><span class="op" id="4339332">(</span><span class="op" id="4339333">)</span>&nbsp;<span class="builtintype" id="4339335">int</span>&nbsp;<span class="op" id="4339339">{</span>&nbsp;<span class="keyword" id="4339341">return</span>&nbsp;<span class="ident" id="4339348">Size</span>&nbsp;<span class="op" id="4339353">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4339356">func</span>&nbsp;<span class="op" id="4339361">(</span><span class="ident" id="4339362">d</span>&nbsp;<span class="op" id="4339364">*</span><span class="ident" id="4339365">digest</span><span class="op" id="4339371">)</span>&nbsp;<span class="ident" id="4339373">BlockSize</span><span class="op" id="4339382">(</span><span class="op" id="4339383">)</span>&nbsp;<span class="builtintype" id="4339385">int</span>&nbsp;<span class="op" id="4339389">{</span>&nbsp;<span class="keyword" id="4339391">return</span>&nbsp;<span class="ident" id="4339398">BlockSize</span>&nbsp;<span class="op" id="4339408">}</span><br>
<span class="lineno">60</span><br>
<span class="lineno"></span><span class="keyword" id="4339411">func</span>&nbsp;<span class="op" id="4339416">(</span><span class="ident" id="4339417">d</span>&nbsp;<span class="op" id="4339419">*</span><span class="ident" id="4339420">digest</span><span class="op" id="4339426">)</span>&nbsp;<span class="ident" id="4339428">Write</span><span class="op" id="4339433">(</span><span class="ident" id="4339434">p</span>&nbsp;<span class="op" id="4339436">[</span><span class="op" id="4339437">]</span><span class="builtintype" id="4339438">byte</span><span class="op" id="4339442">)</span>&nbsp;<span class="op" id="4339444">(</span><span class="ident" id="4339445">nn</span>&nbsp;<span class="builtintype" id="4339448">int</span><span class="op" id="4339451">,</span>&nbsp;<span class="ident" id="4339453">err</span>&nbsp;<span class="builtintype" id="4339457">error</span><span class="op" id="4339462">)</span>&nbsp;<span class="op" id="4339464">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339467">nn</span>&nbsp;<span class="op" id="4339470">=</span>&nbsp;<span class="builtinfunc" id="4339472">len</span><span class="op" id="4339475">(</span><span class="ident" id="4339476">p</span><span class="op" id="4339477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339480">d</span><span class="op" id="4339481">.</span><span class="builtinfunc" id="4339482">len</span>&nbsp;<span class="op" id="4339486">+=</span>&nbsp;<span class="builtintype" id="4339489">uint64</span><span class="op" id="4339495">(</span><span class="ident" id="4339496">nn</span><span class="op" id="4339498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4339501">if</span>&nbsp;<span class="ident" id="4339504">d</span><span class="op" id="4339505">.</span><span class="ident" id="4339506">nx</span>&nbsp;<span class="op" id="4339509">&gt;</span>&nbsp;<span class="num" id="4339511">0</span>&nbsp;<span class="op" id="4339513">{</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339517">n</span>&nbsp;<span class="op" id="4339519">:=</span>&nbsp;<span class="builtinfunc" id="4339522">copy</span><span class="op" id="4339526">(</span><span class="ident" id="4339527">d</span><span class="op" id="4339528">.</span><span class="ident" id="4339529">x</span><span class="op" id="4339530">[</span><span class="ident" id="4339531">d</span><span class="op" id="4339532">.</span><span class="ident" id="4339533">nx</span><span class="op" id="4339535">:</span><span class="op" id="4339536">]</span><span class="op" id="4339537">,</span>&nbsp;<span class="ident" id="4339539">p</span><span class="op" id="4339540">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339544">d</span><span class="op" id="4339545">.</span><span class="ident" id="4339546">nx</span>&nbsp;<span class="op" id="4339549">+=</span>&nbsp;<span class="ident" id="4339552">n</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4339556">if</span>&nbsp;<span class="ident" id="4339559">d</span><span class="op" id="4339560">.</span><span class="ident" id="4339561">nx</span>&nbsp;<span class="op" id="4339564">==</span>&nbsp;<span class="ident" id="4339567">chunk</span>&nbsp;<span class="op" id="4339573">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339578">block</span><span class="op" id="4339583">(</span><span class="ident" id="4339584">d</span><span class="op" id="4339585">,</span>&nbsp;<span class="ident" id="4339587">d</span><span class="op" id="4339588">.</span><span class="ident" id="4339589">x</span><span class="op" id="4339590">[</span><span class="op" id="4339591">:</span><span class="op" id="4339592">]</span><span class="op" id="4339593">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339598">d</span><span class="op" id="4339599">.</span><span class="ident" id="4339600">nx</span>&nbsp;<span class="op" id="4339603">=</span>&nbsp;<span class="num" id="4339605">0</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4339609">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339613">p</span>&nbsp;<span class="op" id="4339615">=</span>&nbsp;<span class="ident" id="4339617">p</span><span class="op" id="4339618">[</span><span class="ident" id="4339619">n</span><span class="op" id="4339620">:</span><span class="op" id="4339621">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4339624">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4339627">if</span>&nbsp;<span class="builtinfunc" id="4339630">len</span><span class="op" id="4339633">(</span><span class="ident" id="4339634">p</span><span class="op" id="4339635">)</span>&nbsp;<span class="op" id="4339637">&gt;=</span>&nbsp;<span class="ident" id="4339640">chunk</span>&nbsp;<span class="op" id="4339646">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339650">n</span>&nbsp;<span class="op" id="4339652">:=</span>&nbsp;<span class="builtinfunc" id="4339655">len</span><span class="op" id="4339658">(</span><span class="ident" id="4339659">p</span><span class="op" id="4339660">)</span>&nbsp;<span class="op" id="4339662">&amp;^</span>&nbsp;<span class="op" id="4339665">(</span><span class="ident" id="4339666">chunk</span>&nbsp;<span class="op" id="4339672">-</span>&nbsp;<span class="num" id="4339674">1</span><span class="op" id="4339675">)</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339679">block</span><span class="op" id="4339684">(</span><span class="ident" id="4339685">d</span><span class="op" id="4339686">,</span>&nbsp;<span class="ident" id="4339688">p</span><span class="op" id="4339689">[</span><span class="op" id="4339690">:</span><span class="ident" id="4339691">n</span><span class="op" id="4339692">]</span><span class="op" id="4339693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339697">p</span>&nbsp;<span class="op" id="4339699">=</span>&nbsp;<span class="ident" id="4339701">p</span><span class="op" id="4339702">[</span><span class="ident" id="4339703">n</span><span class="op" id="4339704">:</span><span class="op" id="4339705">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4339708">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4339711">if</span>&nbsp;<span class="builtinfunc" id="4339714">len</span><span class="op" id="4339717">(</span><span class="ident" id="4339718">p</span><span class="op" id="4339719">)</span>&nbsp;<span class="op" id="4339721">&gt;</span>&nbsp;<span class="num" id="4339723">0</span>&nbsp;<span class="op" id="4339725">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339729">d</span><span class="op" id="4339730">.</span><span class="ident" id="4339731">nx</span>&nbsp;<span class="op" id="4339734">=</span>&nbsp;<span class="builtinfunc" id="4339736">copy</span><span class="op" id="4339740">(</span><span class="ident" id="4339741">d</span><span class="op" id="4339742">.</span><span class="ident" id="4339743">x</span><span class="op" id="4339744">[</span><span class="op" id="4339745">:</span><span class="op" id="4339746">]</span><span class="op" id="4339747">,</span>&nbsp;<span class="ident" id="4339749">p</span><span class="op" id="4339750">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4339753">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4339756">return</span><br>
<span class="lineno"></span><span class="op" id="4339763">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4339766">func</span>&nbsp;<span class="op" id="4339771">(</span><span class="ident" id="4339772">d0</span>&nbsp;<span class="op" id="4339775">*</span><span class="ident" id="4339776">digest</span><span class="op" id="4339782">)</span>&nbsp;<span class="ident" id="4339784">Sum</span><span class="op" id="4339787">(</span><span class="ident" id="4339788">in</span>&nbsp;<span class="op" id="4339791">[</span><span class="op" id="4339792">]</span><span class="builtintype" id="4339793">byte</span><span class="op" id="4339797">)</span>&nbsp;<span class="op" id="4339799">[</span><span class="op" id="4339800">]</span><span class="builtintype" id="4339801">byte</span>&nbsp;<span class="op" id="4339806">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4339809">//&nbsp;Make&nbsp;a&nbsp;copy&nbsp;of&nbsp;d0&nbsp;so&nbsp;that&nbsp;caller&nbsp;can&nbsp;keep&nbsp;writing&nbsp;and&nbsp;summing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339876">d</span>&nbsp;<span class="op" id="4339878">:=</span>&nbsp;<span class="op" id="4339881">*</span><span class="ident" id="4339882">d0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4339886">hash</span>&nbsp;<span class="op" id="4339891">:=</span>&nbsp;<span class="ident" id="4339894">d</span><span class="op" id="4339895">.</span><span class="ident" id="4339896">checkSum</span><span class="op" id="4339904">(</span><span class="op" id="4339905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4339908">return</span>&nbsp;<span class="builtinfunc" id="4339915">append</span><span class="op" id="4339921">(</span><span class="ident" id="4339922">in</span><span class="op" id="4339924">,</span>&nbsp;<span class="ident" id="4339926">hash</span><span class="op" id="4339930">[</span><span class="op" id="4339931">:</span><span class="op" id="4339932">]</span><span class="op" id="4339933">...</span><span class="op" id="4339936">)</span><br>
<span class="lineno"></span><span class="op" id="4339938">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="4339941">func</span>&nbsp;<span class="op" id="4339946">(</span><span class="ident" id="4339947">d</span>&nbsp;<span class="op" id="4339949">*</span><span class="ident" id="4339950">digest</span><span class="op" id="4339956">)</span>&nbsp;<span class="ident" id="4339958">checkSum</span><span class="op" id="4339966">(</span><span class="op" id="4339967">)</span>&nbsp;<span class="op" id="4339969">[</span><span class="ident" id="4339970">Size</span><span class="op" id="4339974">]</span><span class="builtintype" id="4339975">byte</span>&nbsp;<span class="op" id="4339980">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4339983">len</span>&nbsp;<span class="op" id="4339987">:=</span>&nbsp;<span class="ident" id="4339990">d</span><span class="op" id="4339991">.</span><span class="builtinfunc" id="4339992">len</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4339997">//&nbsp;Padding.&nbsp;&nbsp;Add&nbsp;a&nbsp;1&nbsp;bit&nbsp;and&nbsp;0&nbsp;bits&nbsp;until&nbsp;56&nbsp;bytes&nbsp;mod&nbsp;64.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4340057">var</span>&nbsp;<span class="ident" id="4340061">tmp</span>&nbsp;<span class="op" id="4340065">[</span><span class="num" id="4340066">64</span><span class="op" id="4340068">]</span><span class="builtintype" id="4340069">byte</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340075">tmp</span><span class="op" id="4340078">[</span><span class="num" id="4340079">0</span><span class="op" id="4340080">]</span>&nbsp;<span class="op" id="4340082">=</span>&nbsp;<span class="num" id="4340084">0x80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4340090">if</span>&nbsp;<span class="builtinfunc" id="4340093">len</span><span class="op" id="4340096">%</span><span class="num" id="4340097">64</span>&nbsp;<span class="op" id="4340100">&lt;</span>&nbsp;<span class="num" id="4340102">56</span>&nbsp;<span class="op" id="4340105">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340109">d</span><span class="op" id="4340110">.</span><span class="ident" id="4340111">Write</span><span class="op" id="4340116">(</span><span class="ident" id="4340117">tmp</span><span class="op" id="4340120">[</span><span class="num" id="4340121">0</span>&nbsp;<span class="op" id="4340123">:</span>&nbsp;<span class="num" id="4340125">56</span><span class="op" id="4340127">-</span><span class="builtinfunc" id="4340128">len</span><span class="op" id="4340131">%</span><span class="num" id="4340132">64</span><span class="op" id="4340134">]</span><span class="op" id="4340135">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4340138">}</span>&nbsp;<span class="keyword" id="4340140">else</span>&nbsp;<span class="op" id="4340145">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340149">d</span><span class="op" id="4340150">.</span><span class="ident" id="4340151">Write</span><span class="op" id="4340156">(</span><span class="ident" id="4340157">tmp</span><span class="op" id="4340160">[</span><span class="num" id="4340161">0</span>&nbsp;<span class="op" id="4340163">:</span>&nbsp;<span class="num" id="4340165">64</span><span class="op" id="4340167">+</span><span class="num" id="4340168">56</span><span class="op" id="4340170">-</span><span class="builtinfunc" id="4340171">len</span><span class="op" id="4340174">%</span><span class="num" id="4340175">64</span><span class="op" id="4340177">]</span><span class="op" id="4340178">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4340181">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4340185">//&nbsp;Length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4340205">len</span>&nbsp;<span class="op" id="4340209">&lt;&lt;=</span>&nbsp;<span class="num" id="4340213">3</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4340216">for</span>&nbsp;<span class="ident" id="4340220">i</span>&nbsp;<span class="op" id="4340222">:=</span>&nbsp;<span class="builtintype" id="4340225">uint</span><span class="op" id="4340229">(</span><span class="num" id="4340230">0</span><span class="op" id="4340231">)</span><span class="op" id="4340232">;</span>&nbsp;<span class="ident" id="4340234">i</span>&nbsp;<span class="op" id="4340236">&lt;</span>&nbsp;<span class="num" id="4340238">8</span><span class="op" id="4340239">;</span>&nbsp;<span class="ident" id="4340241">i</span><span class="op" id="4340242">++</span>&nbsp;<span class="op" id="4340245">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340249">tmp</span><span class="op" id="4340252">[</span><span class="ident" id="4340253">i</span><span class="op" id="4340254">]</span>&nbsp;<span class="op" id="4340256">=</span>&nbsp;<span class="builtintype" id="4340258">byte</span><span class="op" id="4340262">(</span><span class="builtinfunc" id="4340263">len</span>&nbsp;<span class="op" id="4340267">&gt;&gt;</span>&nbsp;<span class="op" id="4340270">(</span><span class="num" id="4340271">56</span>&nbsp;<span class="op" id="4340274">-</span>&nbsp;<span class="num" id="4340276">8</span><span class="op" id="4340277">*</span><span class="ident" id="4340278">i</span><span class="op" id="4340279">)</span><span class="op" id="4340280">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4340283">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340286">d</span><span class="op" id="4340287">.</span><span class="ident" id="4340288">Write</span><span class="op" id="4340293">(</span><span class="ident" id="4340294">tmp</span><span class="op" id="4340297">[</span><span class="num" id="4340298">0</span><span class="op" id="4340299">:</span><span class="num" id="4340300">8</span><span class="op" id="4340301">]</span><span class="op" id="4340302">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4340306">if</span>&nbsp;<span class="ident" id="4340309">d</span><span class="op" id="4340310">.</span><span class="ident" id="4340311">nx</span>&nbsp;<span class="op" id="4340314">!=</span>&nbsp;<span class="num" id="4340317">0</span>&nbsp;<span class="op" id="4340319">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtinfunc" id="4340323">panic</span><span class="op" id="4340328">(</span><span class="string" id="4340329">&#34;d.nx&nbsp;!=&nbsp;0&#34;</span><span class="op" id="4340340">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4340343">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4340347">var</span>&nbsp;<span class="ident" id="4340351">digest</span>&nbsp;<span class="op" id="4340358">[</span><span class="ident" id="4340359">Size</span><span class="op" id="4340363">]</span><span class="builtintype" id="4340364">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4340370">for</span>&nbsp;<span class="ident" id="4340374">i</span><span class="op" id="4340375">,</span>&nbsp;<span class="ident" id="4340377">s</span>&nbsp;<span class="op" id="4340379">:=</span>&nbsp;<span class="keyword" id="4340382">range</span>&nbsp;<span class="ident" id="4340388">d</span><span class="op" id="4340389">.</span><span class="ident" id="4340390">h</span>&nbsp;<span class="op" id="4340392">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340396">digest</span><span class="op" id="4340402">[</span><span class="ident" id="4340403">i</span><span class="op" id="4340404">*</span><span class="num" id="4340405">4</span><span class="op" id="4340406">]</span>&nbsp;<span class="op" id="4340408">=</span>&nbsp;<span class="builtintype" id="4340410">byte</span><span class="op" id="4340414">(</span><span class="ident" id="4340415">s</span>&nbsp;<span class="op" id="4340417">&gt;&gt;</span>&nbsp;<span class="num" id="4340420">24</span><span class="op" id="4340422">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340426">digest</span><span class="op" id="4340432">[</span><span class="ident" id="4340433">i</span><span class="op" id="4340434">*</span><span class="num" id="4340435">4</span><span class="op" id="4340436">+</span><span class="num" id="4340437">1</span><span class="op" id="4340438">]</span>&nbsp;<span class="op" id="4340440">=</span>&nbsp;<span class="builtintype" id="4340442">byte</span><span class="op" id="4340446">(</span><span class="ident" id="4340447">s</span>&nbsp;<span class="op" id="4340449">&gt;&gt;</span>&nbsp;<span class="num" id="4340452">16</span><span class="op" id="4340454">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340458">digest</span><span class="op" id="4340464">[</span><span class="ident" id="4340465">i</span><span class="op" id="4340466">*</span><span class="num" id="4340467">4</span><span class="op" id="4340468">+</span><span class="num" id="4340469">2</span><span class="op" id="4340470">]</span>&nbsp;<span class="op" id="4340472">=</span>&nbsp;<span class="builtintype" id="4340474">byte</span><span class="op" id="4340478">(</span><span class="ident" id="4340479">s</span>&nbsp;<span class="op" id="4340481">&gt;&gt;</span>&nbsp;<span class="num" id="4340484">8</span><span class="op" id="4340485">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340489">digest</span><span class="op" id="4340495">[</span><span class="ident" id="4340496">i</span><span class="op" id="4340497">*</span><span class="num" id="4340498">4</span><span class="op" id="4340499">+</span><span class="num" id="4340500">3</span><span class="op" id="4340501">]</span>&nbsp;<span class="op" id="4340503">=</span>&nbsp;<span class="builtintype" id="4340505">byte</span><span class="op" id="4340509">(</span><span class="ident" id="4340510">s</span><span class="op" id="4340511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4340514">}</span><br>
<span class="lineno">120</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4340518">return</span>&nbsp;<span class="ident" id="4340525">digest</span><br>
<span class="lineno"></span><span class="op" id="4340532">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4340535">//&nbsp;Sum&nbsp;returns&nbsp;the&nbsp;SHA1&nbsp;checksum&nbsp;of&nbsp;the&nbsp;data.</span><br>
<span class="lineno">125</span><span class="keyword" id="4340581">func</span>&nbsp;<span class="ident" id="4340586">Sum</span><span class="op" id="4340589">(</span><span class="ident" id="4340590">data</span>&nbsp;<span class="op" id="4340595">[</span><span class="op" id="4340596">]</span><span class="builtintype" id="4340597">byte</span><span class="op" id="4340601">)</span>&nbsp;<span class="op" id="4340603">[</span><span class="ident" id="4340604">Size</span><span class="op" id="4340608">]</span><span class="builtintype" id="4340609">byte</span>&nbsp;<span class="op" id="4340614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4340617">var</span>&nbsp;<span class="ident" id="4340621">d</span>&nbsp;<span class="ident" id="4340623">digest</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340631">d</span><span class="op" id="4340632">.</span><span class="ident" id="4340633">Reset</span><span class="op" id="4340638">(</span><span class="op" id="4340639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="4340642">d</span><span class="op" id="4340643">.</span><span class="ident" id="4340644">Write</span><span class="op" id="4340649">(</span><span class="ident" id="4340650">data</span><span class="op" id="4340654">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="4340657">return</span>&nbsp;<span class="ident" id="4340664">d</span><span class="op" id="4340665">.</span><span class="ident" id="4340666">checkSum</span><span class="op" id="4340674">(</span><span class="op" id="4340675">)</span><br>
<span class="lineno">130</span><span class="op" id="4340677">}</span>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-19116218-3', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
