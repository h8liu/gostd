<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>net</h2>
<ul>
<li><a href="/gostd/net/cgo_stub.go.html">cgo_stub.go</a></li>
<li><a href="/gostd/net/conn_test.go.html">conn_test.go</a></li>
<li><a href="/gostd/net/dial.go.html">dial.go</a></li>
<li><a href="/gostd/net/dial_test.go.html">dial_test.go</a></li>
<li><a href="/gostd/net/dialgoogle_test.go.html">dialgoogle_test.go</a></li>
<li><a href="/gostd/net/dnsclient.go.html">dnsclient.go</a></li>
<li><a href="/gostd/net/dnsclient_test.go.html">dnsclient_test.go</a></li>
<li><a href="/gostd/net/dnsclient_unix.go.html">dnsclient_unix.go</a></li>
<li><a href="/gostd/net/dnsclient_unix_test.go.html">dnsclient_unix_test.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix.go.html">dnsconfig_unix.go</a></li>
<li><a href="/gostd/net/dnsconfig_unix_test.go.html">dnsconfig_unix_test.go</a></li>
<li><a href="/gostd/net/dnsmsg.go.html">dnsmsg.go</a></li>
<li><a href="/gostd/net/dnsmsg_test.go.html">dnsmsg_test.go</a></li>
<li><a href="/gostd/net/dnsname_test.go.html">dnsname_test.go</a></li>
<li><a href="/gostd/net/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/net/fd_mutex.go.html">fd_mutex.go</a></li>
<li><a href="/gostd/net/fd_mutex_test.go.html">fd_mutex_test.go</a></li>
<li><a href="/gostd/net/fd_poll_runtime.go.html">fd_poll_runtime.go</a></li>
<li><a href="/gostd/net/fd_unix.go.html">fd_unix.go</a></li>
<li><a href="/gostd/net/fd_unix_test.go.html">fd_unix_test.go</a></li>
<li><a href="/gostd/net/file_test.go.html">file_test.go</a></li>
<li><a href="/gostd/net/file_unix.go.html">file_unix.go</a></li>
<li><a href="/gostd/net/hosts.go.html">hosts.go</a></li>
<li><a href="/gostd/net/hosts_test.go.html">hosts_test.go</a></li>
<li><a href="/gostd/net/interface.go.html">interface.go</a></li>
<li><a href="/gostd/net/interface_linux.go.html">interface_linux.go</a></li>
<li><a href="/gostd/net/interface_linux_test.go.html">interface_linux_test.go</a></li>
<li><a href="/gostd/net/interface_test.go.html">interface_test.go</a></li>
<li><a href="/gostd/net/interface_unix_test.go.html">interface_unix_test.go</a></li>
<li><a href="/gostd/net/ip.go.html">ip.go</a></li>
<li><a href="/gostd/net/ip_test.go.html">ip_test.go</a></li>
<li><a href="/gostd/net/ipraw_test.go.html">ipraw_test.go</a></li>
<li><a href="/gostd/net/iprawsock.go.html">iprawsock.go</a></li>
<li><a href="/gostd/net/iprawsock_posix.go.html">iprawsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock.go.html">ipsock.go</a></li>
<li><a href="/gostd/net/ipsock_posix.go.html">ipsock_posix.go</a></li>
<li><a href="/gostd/net/ipsock_test.go.html">ipsock_test.go</a></li>
<li><a href="/gostd/net/lookup.go.html">lookup.go</a></li>
<li><a href="/gostd/net/lookup_test.go.html">lookup_test.go</a></li>
<li><a href="/gostd/net/lookup_unix.go.html">lookup_unix.go</a></li>
<li><a href="/gostd/net/mac.go.html">mac.go</a></li>
<li><a href="/gostd/net/mac_test.go.html">mac_test.go</a></li>
<li><a href="/gostd/net/mockicmp_test.go.html">mockicmp_test.go</a></li>
<li><a href="/gostd/net/mockserver_test.go.html">mockserver_test.go</a></li>
<li><a href="/gostd/net/multicast_test.go.html">multicast_test.go</a></li>
<li><a href="/gostd/net/net.go.html">net.go</a></li>
<li><a href="/gostd/net/net_test.go.html">net_test.go</a></li>
<li><a href="/gostd/net/netgo_unix_test.go.html">netgo_unix_test.go</a></li>
<li><a href="/gostd/net/packetconn_test.go.html">packetconn_test.go</a></li>
<li><a href="/gostd/net/parse.go.html">parse.go</a></li>
<li><a href="/gostd/net/parse_test.go.html">parse_test.go</a></li>
<li><a href="/gostd/net/pipe.go.html">pipe.go</a></li>
<li><a href="/gostd/net/pipe_test.go.html">pipe_test.go</a></li>
<li><a href="/gostd/net/port.go.html">port.go</a></li>
<li><a href="/gostd/net/port_test.go.html">port_test.go</a></li>
<li><a href="/gostd/net/port_unix.go.html">port_unix.go</a></li>
<li><a href="/gostd/net/protoconn_test.go.html">protoconn_test.go</a></li>
<li><a href="/gostd/net/sendfile_linux.go.html">sendfile_linux.go</a></li>
<li><a href="/gostd/net/server_test.go.html">server_test.go</a></li>
<li><a href="/gostd/net/singleflight.go.html">singleflight.go</a></li>
<li><a href="/gostd/net/sock_cloexec.go.html">sock_cloexec.go</a></li>
<li><a href="/gostd/net/sock_linux.go.html">sock_linux.go</a></li>
<li><a href="/gostd/net/sock_posix.go.html">sock_posix.go</a></li>
<li><a href="/gostd/net/sockopt_linux.go.html">sockopt_linux.go</a></li>
<li><a href="/gostd/net/sockopt_posix.go.html">sockopt_posix.go</a></li>
<li><a href="/gostd/net/sockoptip_linux.go.html">sockoptip_linux.go</a></li>
<li><a href="/gostd/net/sockoptip_posix.go.html">sockoptip_posix.go</a></li>
<li><a href="/gostd/net/tcp_test.go.html">tcp_test.go</a></li>
<li><a href="/gostd/net/tcpsock.go.html">tcpsock.go</a></li>
<li><a href="/gostd/net/tcpsock_posix.go.html">tcpsock_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_posix.go.html">tcpsockopt_posix.go</a></li>
<li><a href="/gostd/net/tcpsockopt_unix.go.html">tcpsockopt_unix.go</a></li>
<li><a href="/gostd/net/timeout_test.go.html">timeout_test.go</a></li>
<li><a href="/gostd/net/udp_test.go.html">udp_test.go</a></li>
<li><a href="/gostd/net/udpsock.go.html">udpsock.go</a></li>
<li><a href="/gostd/net/udpsock_posix.go.html">udpsock_posix.go</a></li>
<li><a href="/gostd/net/unicast_posix_test.go.html">unicast_posix_test.go</a></li>
<li><a href="/gostd/net/unix_test.go.html">unix_test.go</a></li>
<li><a href="/gostd/net/unixsock.go.html">unixsock.go</a></li>
<li><a href="/gostd/net/unixsock_posix.go.html">unixsock_posix.go</a></li>
<li><a href="/gostd/net/z_last_test.go.html">z_last_test.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="3726792">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3726848">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3726902">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3726953">package</span>&nbsp;<span class="ident" id="3726961">net</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3726966">import</span>&nbsp;<span class="op" id="3726973">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3726976">&#34;os&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3726982">&#34;syscall&#34;</span><br>
<span class="lineno">10</span><span class="op" id="3726992">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3726995">func</span>&nbsp;<span class="ident" id="3727000">setDefaultSockopts</span><span class="op" id="3727018">(</span><span class="ident" id="3727019">s</span><span class="op" id="3727020">,</span>&nbsp;<span class="ident" id="3727022">family</span><span class="op" id="3727028">,</span>&nbsp;<span class="ident" id="3727030">sotype</span>&nbsp;<span class="builtintype" id="3727037">int</span><span class="op" id="3727040">,</span>&nbsp;<span class="ident" id="3727042">ipv6only</span>&nbsp;<span class="builtintype" id="3727051">bool</span><span class="op" id="3727055">)</span>&nbsp;<span class="builtintype" id="3727057">error</span>&nbsp;<span class="op" id="3727063">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3727066">if</span>&nbsp;<span class="ident" id="3727069">family</span>&nbsp;<span class="op" id="3727076">==</span>&nbsp;<span class="ident" id="3727079">syscall</span><span class="op" id="3727086">.</span><span class="ident" id="3727087">AF_INET6</span>&nbsp;<span class="op" id="3727096">&amp;&amp;</span>&nbsp;<span class="ident" id="3727099">sotype</span>&nbsp;<span class="op" id="3727106">!=</span>&nbsp;<span class="ident" id="3727109">syscall</span><span class="op" id="3727116">.</span><span class="ident" id="3727117">SOCK_RAW</span>&nbsp;<span class="op" id="3727126">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3727130">//&nbsp;Allow&nbsp;both&nbsp;IP&nbsp;versions&nbsp;even&nbsp;if&nbsp;the&nbsp;OS&nbsp;default</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3727181">//&nbsp;is&nbsp;otherwise.&nbsp;&nbsp;Note&nbsp;that&nbsp;some&nbsp;operating&nbsp;systems</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3727234">//&nbsp;never&nbsp;admit&nbsp;this&nbsp;option.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3727264">syscall</span><span class="op" id="3727271">.</span><span class="ident" id="3727272">SetsockoptInt</span><span class="op" id="3727285">(</span><span class="ident" id="3727286">s</span><span class="op" id="3727287">,</span>&nbsp;<span class="ident" id="3727289">syscall</span><span class="op" id="3727296">.</span><span class="ident" id="3727297">IPPROTO_IPV6</span><span class="op" id="3727309">,</span>&nbsp;<span class="ident" id="3727311">syscall</span><span class="op" id="3727318">.</span><span class="ident" id="3727319">IPV6_V6ONLY</span><span class="op" id="3727330">,</span>&nbsp;<span class="ident" id="3727332">boolint</span><span class="op" id="3727339">(</span><span class="ident" id="3727340">ipv6only</span><span class="op" id="3727348">)</span><span class="op" id="3727349">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3727352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3727355">//&nbsp;Allow&nbsp;broadcast.</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3727376">return</span>&nbsp;<span class="ident" id="3727383">os</span><span class="op" id="3727385">.</span><span class="ident" id="3727386">NewSyscallError</span><span class="op" id="3727401">(</span><span class="string" id="3727402">&#34;setsockopt&#34;</span><span class="op" id="3727414">,</span>&nbsp;<span class="ident" id="3727416">syscall</span><span class="op" id="3727423">.</span><span class="ident" id="3727424">SetsockoptInt</span><span class="op" id="3727437">(</span><span class="ident" id="3727438">s</span><span class="op" id="3727439">,</span>&nbsp;<span class="ident" id="3727441">syscall</span><span class="op" id="3727448">.</span><span class="ident" id="3727449">SOL_SOCKET</span><span class="op" id="3727459">,</span>&nbsp;<span class="ident" id="3727461">syscall</span><span class="op" id="3727468">.</span><span class="ident" id="3727469">SO_BROADCAST</span><span class="op" id="3727481">,</span>&nbsp;<span class="num" id="3727483">1</span><span class="op" id="3727484">)</span><span class="op" id="3727485">)</span><br>
<span class="lineno"></span><span class="op" id="3727487">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3727490">func</span>&nbsp;<span class="ident" id="3727495">setDefaultListenerSockopts</span><span class="op" id="3727521">(</span><span class="ident" id="3727522">s</span>&nbsp;<span class="builtintype" id="3727524">int</span><span class="op" id="3727527">)</span>&nbsp;<span class="builtintype" id="3727529">error</span>&nbsp;<span class="op" id="3727535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3727538">//&nbsp;Allow&nbsp;reuse&nbsp;of&nbsp;recently-used&nbsp;addresses.</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3727582">return</span>&nbsp;<span class="ident" id="3727589">os</span><span class="op" id="3727591">.</span><span class="ident" id="3727592">NewSyscallError</span><span class="op" id="3727607">(</span><span class="string" id="3727608">&#34;setsockopt&#34;</span><span class="op" id="3727620">,</span>&nbsp;<span class="ident" id="3727622">syscall</span><span class="op" id="3727629">.</span><span class="ident" id="3727630">SetsockoptInt</span><span class="op" id="3727643">(</span><span class="ident" id="3727644">s</span><span class="op" id="3727645">,</span>&nbsp;<span class="ident" id="3727647">syscall</span><span class="op" id="3727654">.</span><span class="ident" id="3727655">SOL_SOCKET</span><span class="op" id="3727665">,</span>&nbsp;<span class="ident" id="3727667">syscall</span><span class="op" id="3727674">.</span><span class="ident" id="3727675">SO_REUSEADDR</span><span class="op" id="3727687">,</span>&nbsp;<span class="num" id="3727689">1</span><span class="op" id="3727690">)</span><span class="op" id="3727691">)</span><br>
<span class="lineno"></span><span class="op" id="3727693">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3727696">func</span>&nbsp;<span class="ident" id="3727701">setDefaultMulticastSockopts</span><span class="op" id="3727728">(</span><span class="ident" id="3727729">s</span>&nbsp;<span class="builtintype" id="3727731">int</span><span class="op" id="3727734">)</span>&nbsp;<span class="builtintype" id="3727736">error</span>&nbsp;<span class="op" id="3727742">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3727745">//&nbsp;Allow&nbsp;multicast&nbsp;UDP&nbsp;and&nbsp;raw&nbsp;IP&nbsp;datagram&nbsp;sockets&nbsp;to&nbsp;listen</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3727807">//&nbsp;concurrently&nbsp;across&nbsp;multiple&nbsp;listeners.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3727851">return</span>&nbsp;<span class="ident" id="3727858">os</span><span class="op" id="3727860">.</span><span class="ident" id="3727861">NewSyscallError</span><span class="op" id="3727876">(</span><span class="string" id="3727877">&#34;setsockopt&#34;</span><span class="op" id="3727889">,</span>&nbsp;<span class="ident" id="3727891">syscall</span><span class="op" id="3727898">.</span><span class="ident" id="3727899">SetsockoptInt</span><span class="op" id="3727912">(</span><span class="ident" id="3727913">s</span><span class="op" id="3727914">,</span>&nbsp;<span class="ident" id="3727916">syscall</span><span class="op" id="3727923">.</span><span class="ident" id="3727924">SOL_SOCKET</span><span class="op" id="3727934">,</span>&nbsp;<span class="ident" id="3727936">syscall</span><span class="op" id="3727943">.</span><span class="ident" id="3727944">SO_REUSEADDR</span><span class="op" id="3727956">,</span>&nbsp;<span class="num" id="3727958">1</span><span class="op" id="3727959">)</span><span class="op" id="3727960">)</span><br>
<span class="lineno"></span><span class="op" id="3727962">}</span>
</div>
</body>
</html>
