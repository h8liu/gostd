<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="3950911">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="3950966">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="3951020">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="3951071">package</span>&nbsp;<span class="ident" id="3951079">tls</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3951084">import</span>&nbsp;<span class="op" id="3951091">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3951094">&#34;crypto&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3951104">&#34;crypto/hmac&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3951119">&#34;crypto/md5&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3951133">&#34;crypto/sha1&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3951148">&#34;crypto/sha256&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="3951165">&#34;hash&#34;</span><br>
<span class="lineno"></span><span class="op" id="3951172">)</span><br>
<span class="lineno">15</span><br>
<span class="lineno"></span><span class="comment" id="3951175">//&nbsp;Split&nbsp;a&nbsp;premaster&nbsp;secret&nbsp;in&nbsp;two&nbsp;as&nbsp;specified&nbsp;in&nbsp;RFC&nbsp;4346,&nbsp;section&nbsp;5.</span><br>
<span class="lineno"></span><span class="keyword" id="3951247">func</span>&nbsp;<span class="ident" id="3951252">splitPreMasterSecret</span><span class="op" id="3951272">(</span><span class="ident" id="3951273">secret</span>&nbsp;<span class="op" id="3951280">[</span><span class="op" id="3951281">]</span><span class="builtintype" id="3951282">byte</span><span class="op" id="3951286">)</span>&nbsp;<span class="op" id="3951288">(</span><span class="ident" id="3951289">s1</span><span class="op" id="3951291">,</span>&nbsp;<span class="ident" id="3951293">s2</span>&nbsp;<span class="op" id="3951296">[</span><span class="op" id="3951297">]</span><span class="builtintype" id="3951298">byte</span><span class="op" id="3951302">)</span>&nbsp;<span class="op" id="3951304">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951307"><a href="/crypto/tls/prf.go.html#3951289">s1</a></span>&nbsp;<span class="op" id="3951310">=</span>&nbsp;<span class="ident" id="3951312"><a href="/crypto/tls/prf.go.html#3951273">secret</a></span><span class="op" id="3951318">[</span><span class="num" id="3951319">0</span>&nbsp;<span class="op" id="3951321">:</span>&nbsp;<span class="op" id="3951323">(</span><span class="builtinfunc" id="3951324">len</span><span class="op" id="3951327">(</span><span class="ident" id="3951328"><a href="/crypto/tls/prf.go.html#3951273">secret</a></span><span class="op" id="3951334">)</span><span class="op" id="3951335">+</span><span class="num" id="3951336">1</span><span class="op" id="3951337">)</span><span class="op" id="3951338">/</span><span class="num" id="3951339">2</span><span class="op" id="3951340">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951343"><a href="/crypto/tls/prf.go.html#3951293">s2</a></span>&nbsp;<span class="op" id="3951346">=</span>&nbsp;<span class="ident" id="3951348"><a href="/crypto/tls/prf.go.html#3951273">secret</a></span><span class="op" id="3951354">[</span><span class="builtinfunc" id="3951355">len</span><span class="op" id="3951358">(</span><span class="ident" id="3951359"><a href="/crypto/tls/prf.go.html#3951273">secret</a></span><span class="op" id="3951365">)</span><span class="op" id="3951366">/</span><span class="num" id="3951367">2</span><span class="op" id="3951368">:</span><span class="op" id="3951369">]</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951372">return</span><br>
<span class="lineno"></span><span class="op" id="3951379">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3951382">//&nbsp;pHash&nbsp;implements&nbsp;the&nbsp;P_hash&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;4346,&nbsp;section&nbsp;5.</span><br>
<span class="lineno"></span><span class="keyword" id="3951458">func</span>&nbsp;<span class="ident" id="3951463">pHash</span><span class="op" id="3951468">(</span><span class="ident" id="3951469">result</span><span class="op" id="3951475">,</span>&nbsp;<span class="ident" id="3951477">secret</span><span class="op" id="3951483">,</span>&nbsp;<span class="ident" id="3951485">seed</span>&nbsp;<span class="op" id="3951490">[</span><span class="op" id="3951491">]</span><span class="builtintype" id="3951492">byte</span><span class="op" id="3951496">,</span>&nbsp;<span class="ident" id="3951498">hash</span>&nbsp;<span class="keyword" id="3951503">func</span><span class="op" id="3951507">(</span><span class="op" id="3951508">)</span>&nbsp;<span class="ident" id="3951510"><a href="/crypto/tls/prf.go.html#3951165">hash</a></span><span class="op" id="3951514">.</span><span class="ident" id="3951515">Hash</span><span class="op" id="3951519">)</span>&nbsp;<span class="op" id="3951521">{</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951524">h</span>&nbsp;<span class="op" id="3951526">:=</span>&nbsp;<span class="ident" id="3951529"><a href="/crypto/tls/prf.go.html#3951104">hmac</a></span><span class="op" id="3951533">.</span><span class="ident" id="3951534">New</span><span class="op" id="3951537">(</span><span class="ident" id="3951538"><a href="/crypto/tls/prf.go.html#3951498">hash</a></span><span class="op" id="3951542">,</span>&nbsp;<span class="ident" id="3951544"><a href="/crypto/tls/prf.go.html#3951477">secret</a></span><span class="op" id="3951550">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951553"><a href="/crypto/tls/prf.go.html#3951524">h</a></span><span class="op" id="3951554">.</span><span class="ident" id="3951555">Write</span><span class="op" id="3951560">(</span><span class="ident" id="3951561"><a href="/crypto/tls/prf.go.html#3951485">seed</a></span><span class="op" id="3951565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951568">a</span>&nbsp;<span class="op" id="3951570">:=</span>&nbsp;<span class="ident" id="3951573"><a href="/crypto/tls/prf.go.html#3951524">h</a></span><span class="op" id="3951574">.</span><span class="ident" id="3951575">Sum</span><span class="op" id="3951578">(</span><span class="ident" id="3951579">nil</span><span class="op" id="3951582">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951586">j</span>&nbsp;<span class="op" id="3951588">:=</span>&nbsp;<span class="num" id="3951591">0</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951594">for</span>&nbsp;<span class="ident" id="3951598"><a href="/crypto/tls/prf.go.html#3951586">j</a></span>&nbsp;<span class="op" id="3951600">&lt;</span>&nbsp;<span class="builtinfunc" id="3951602">len</span><span class="op" id="3951605">(</span><span class="ident" id="3951606"><a href="/crypto/tls/prf.go.html#3951469">result</a></span><span class="op" id="3951612">)</span>&nbsp;<span class="op" id="3951614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951618"><a href="/crypto/tls/prf.go.html#3951524">h</a></span><span class="op" id="3951619">.</span><span class="ident" id="3951620">Reset</span><span class="op" id="3951625">(</span><span class="op" id="3951626">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951630"><a href="/crypto/tls/prf.go.html#3951524">h</a></span><span class="op" id="3951631">.</span><span class="ident" id="3951632">Write</span><span class="op" id="3951637">(</span><span class="ident" id="3951638"><a href="/crypto/tls/prf.go.html#3951568">a</a></span><span class="op" id="3951639">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951643"><a href="/crypto/tls/prf.go.html#3951524">h</a></span><span class="op" id="3951644">.</span><span class="ident" id="3951645">Write</span><span class="op" id="3951650">(</span><span class="ident" id="3951651"><a href="/crypto/tls/prf.go.html#3951485">seed</a></span><span class="op" id="3951655">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951659">b</span>&nbsp;<span class="op" id="3951661">:=</span>&nbsp;<span class="ident" id="3951664"><a href="/crypto/tls/prf.go.html#3951524">h</a></span><span class="op" id="3951665">.</span><span class="ident" id="3951666">Sum</span><span class="op" id="3951669">(</span><span class="ident" id="3951670">nil</span><span class="op" id="3951673">)</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951677">todo</span>&nbsp;<span class="op" id="3951682">:=</span>&nbsp;<span class="builtinfunc" id="3951685">len</span><span class="op" id="3951688">(</span><span class="ident" id="3951689"><a href="/crypto/tls/prf.go.html#3951659">b</a></span><span class="op" id="3951690">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3951694">if</span>&nbsp;<span class="ident" id="3951697"><a href="/crypto/tls/prf.go.html#3951586">j</a></span><span class="op" id="3951698">+</span><span class="ident" id="3951699"><a href="/crypto/tls/prf.go.html#3951677">todo</a></span>&nbsp;<span class="op" id="3951704">&gt;</span>&nbsp;<span class="builtinfunc" id="3951706">len</span><span class="op" id="3951709">(</span><span class="ident" id="3951710"><a href="/crypto/tls/prf.go.html#3951469">result</a></span><span class="op" id="3951716">)</span>&nbsp;<span class="op" id="3951718">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951723"><a href="/crypto/tls/prf.go.html#3951677">todo</a></span>&nbsp;<span class="op" id="3951728">=</span>&nbsp;<span class="builtinfunc" id="3951730">len</span><span class="op" id="3951733">(</span><span class="ident" id="3951734"><a href="/crypto/tls/prf.go.html#3951469">result</a></span><span class="op" id="3951740">)</span>&nbsp;<span class="op" id="3951742">-</span>&nbsp;<span class="ident" id="3951744"><a href="/crypto/tls/prf.go.html#3951586">j</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951748">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3951752">copy</span><span class="op" id="3951756">(</span><span class="ident" id="3951757"><a href="/crypto/tls/prf.go.html#3951469">result</a></span><span class="op" id="3951763">[</span><span class="ident" id="3951764"><a href="/crypto/tls/prf.go.html#3951586">j</a></span><span class="op" id="3951765">:</span><span class="ident" id="3951766"><a href="/crypto/tls/prf.go.html#3951586">j</a></span><span class="op" id="3951767">+</span><span class="ident" id="3951768"><a href="/crypto/tls/prf.go.html#3951677">todo</a></span><span class="op" id="3951772">]</span><span class="op" id="3951773">,</span>&nbsp;<span class="ident" id="3951775"><a href="/crypto/tls/prf.go.html#3951659">b</a></span><span class="op" id="3951776">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951780"><a href="/crypto/tls/prf.go.html#3951586">j</a></span>&nbsp;<span class="op" id="3951782">+=</span>&nbsp;<span class="ident" id="3951785"><a href="/crypto/tls/prf.go.html#3951677">todo</a></span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951793"><a href="/crypto/tls/prf.go.html#3951524">h</a></span><span class="op" id="3951794">.</span><span class="ident" id="3951795">Reset</span><span class="op" id="3951800">(</span><span class="op" id="3951801">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951805"><a href="/crypto/tls/prf.go.html#3951524">h</a></span><span class="op" id="3951806">.</span><span class="ident" id="3951807">Write</span><span class="op" id="3951812">(</span><span class="ident" id="3951813"><a href="/crypto/tls/prf.go.html#3951568">a</a></span><span class="op" id="3951814">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951818"><a href="/crypto/tls/prf.go.html#3951568">a</a></span>&nbsp;<span class="op" id="3951820">=</span>&nbsp;<span class="ident" id="3951822"><a href="/crypto/tls/prf.go.html#3951524">h</a></span><span class="op" id="3951823">.</span><span class="ident" id="3951824">Sum</span><span class="op" id="3951827">(</span><span class="ident" id="3951828">nil</span><span class="op" id="3951831">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3951834">}</span><br>
<span class="lineno"></span><span class="op" id="3951836">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3951839">//&nbsp;prf10&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.0&nbsp;pseudo-random&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;5.</span><br>
<span class="lineno"></span><span class="keyword" id="3951930">func</span>&nbsp;<span class="ident" id="3951935">prf10</span><span class="op" id="3951940">(</span><span class="ident" id="3951941">result</span><span class="op" id="3951947">,</span>&nbsp;<span class="ident" id="3951949">secret</span><span class="op" id="3951955">,</span>&nbsp;<span class="ident" id="3951957">label</span><span class="op" id="3951962">,</span>&nbsp;<span class="ident" id="3951964">seed</span>&nbsp;<span class="op" id="3951969">[</span><span class="op" id="3951970">]</span><span class="builtintype" id="3951971">byte</span><span class="op" id="3951975">)</span>&nbsp;<span class="op" id="3951977">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3951980">hashSHA1</span>&nbsp;<span class="op" id="3951989">:=</span>&nbsp;<span class="ident" id="3951992"><a href="/crypto/tls/prf.go.html#3951133">sha1</a></span><span class="op" id="3951996">.</span><span class="ident" id="3951997">New</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952002">hashMD5</span>&nbsp;<span class="op" id="3952010">:=</span>&nbsp;<span class="ident" id="3952013"><a href="/crypto/tls/prf.go.html#3951119">md5</a></span><span class="op" id="3952016">.</span><span class="ident" id="3952017">New</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952023">labelAndSeed</span>&nbsp;<span class="op" id="3952036">:=</span>&nbsp;<span class="builtinfunc" id="3952039">make</span><span class="op" id="3952043">(</span><span class="op" id="3952044">[</span><span class="op" id="3952045">]</span><span class="builtintype" id="3952046">byte</span><span class="op" id="3952050">,</span>&nbsp;<span class="builtinfunc" id="3952052">len</span><span class="op" id="3952055">(</span><span class="ident" id="3952056"><a href="/crypto/tls/prf.go.html#3951957">label</a></span><span class="op" id="3952061">)</span><span class="op" id="3952062">+</span><span class="builtinfunc" id="3952063">len</span><span class="op" id="3952066">(</span><span class="ident" id="3952067"><a href="/crypto/tls/prf.go.html#3951964">seed</a></span><span class="op" id="3952071">)</span><span class="op" id="3952072">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3952075">copy</span><span class="op" id="3952079">(</span><span class="ident" id="3952080"><a href="/crypto/tls/prf.go.html#3952023">labelAndSeed</a></span><span class="op" id="3952092">,</span>&nbsp;<span class="ident" id="3952094"><a href="/crypto/tls/prf.go.html#3951957">label</a></span><span class="op" id="3952099">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3952102">copy</span><span class="op" id="3952106">(</span><span class="ident" id="3952107"><a href="/crypto/tls/prf.go.html#3952023">labelAndSeed</a></span><span class="op" id="3952119">[</span><span class="builtinfunc" id="3952120">len</span><span class="op" id="3952123">(</span><span class="ident" id="3952124"><a href="/crypto/tls/prf.go.html#3951957">label</a></span><span class="op" id="3952129">)</span><span class="op" id="3952130">:</span><span class="op" id="3952131">]</span><span class="op" id="3952132">,</span>&nbsp;<span class="ident" id="3952134"><a href="/crypto/tls/prf.go.html#3951964">seed</a></span><span class="op" id="3952138">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952142">s1</span><span class="op" id="3952144">,</span>&nbsp;<span class="ident" id="3952146">s2</span>&nbsp;<span class="op" id="3952149">:=</span>&nbsp;<span class="ident" id="3952152"><a href="/crypto/tls/prf.go.html#3951252">splitPreMasterSecret</a></span><span class="op" id="3952172">(</span><span class="ident" id="3952173"><a href="/crypto/tls/prf.go.html#3951949">secret</a></span><span class="op" id="3952179">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952182"><a href="/crypto/tls/prf.go.html#3951463">pHash</a></span><span class="op" id="3952187">(</span><span class="ident" id="3952188"><a href="/crypto/tls/prf.go.html#3951941">result</a></span><span class="op" id="3952194">,</span>&nbsp;<span class="ident" id="3952196"><a href="/crypto/tls/prf.go.html#3952142">s1</a></span><span class="op" id="3952198">,</span>&nbsp;<span class="ident" id="3952200"><a href="/crypto/tls/prf.go.html#3952023">labelAndSeed</a></span><span class="op" id="3952212">,</span>&nbsp;<span class="ident" id="3952214"><a href="/crypto/tls/prf.go.html#3952002">hashMD5</a></span><span class="op" id="3952221">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952224">result2</span>&nbsp;<span class="op" id="3952232">:=</span>&nbsp;<span class="builtinfunc" id="3952235">make</span><span class="op" id="3952239">(</span><span class="op" id="3952240">[</span><span class="op" id="3952241">]</span><span class="builtintype" id="3952242">byte</span><span class="op" id="3952246">,</span>&nbsp;<span class="builtinfunc" id="3952248">len</span><span class="op" id="3952251">(</span><span class="ident" id="3952252"><a href="/crypto/tls/prf.go.html#3951941">result</a></span><span class="op" id="3952258">)</span><span class="op" id="3952259">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952262"><a href="/crypto/tls/prf.go.html#3951463">pHash</a></span><span class="op" id="3952267">(</span><span class="ident" id="3952268"><a href="/crypto/tls/prf.go.html#3952224">result2</a></span><span class="op" id="3952275">,</span>&nbsp;<span class="ident" id="3952277"><a href="/crypto/tls/prf.go.html#3952146">s2</a></span><span class="op" id="3952279">,</span>&nbsp;<span class="ident" id="3952281"><a href="/crypto/tls/prf.go.html#3952023">labelAndSeed</a></span><span class="op" id="3952293">,</span>&nbsp;<span class="ident" id="3952295"><a href="/crypto/tls/prf.go.html#3951980">hashSHA1</a></span><span class="op" id="3952303">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3952307">for</span>&nbsp;<span class="ident" id="3952311">i</span><span class="op" id="3952312">,</span>&nbsp;<span class="ident" id="3952314">b</span>&nbsp;<span class="op" id="3952316">:=</span>&nbsp;<span class="keyword" id="3952319">range</span>&nbsp;<span class="ident" id="3952325"><a href="/crypto/tls/prf.go.html#3952224">result2</a></span>&nbsp;<span class="op" id="3952333">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952337"><a href="/crypto/tls/prf.go.html#3951941">result</a></span><span class="op" id="3952343">[</span><span class="ident" id="3952344"><a href="/crypto/tls/prf.go.html#3952311">i</a></span><span class="op" id="3952345">]</span>&nbsp;<span class="op" id="3952347">^=</span>&nbsp;<span class="ident" id="3952350"><a href="/crypto/tls/prf.go.html#3952314">b</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3952353">}</span><br>
<span class="lineno">65</span><span class="op" id="3952355">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3952358">//&nbsp;prf12&nbsp;implements&nbsp;the&nbsp;TLS&nbsp;1.2&nbsp;pseudo-random&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in&nbsp;RFC&nbsp;5246,&nbsp;section&nbsp;5.</span><br>
<span class="lineno"></span><span class="keyword" id="3952449">func</span>&nbsp;<span class="ident" id="3952454">prf12</span><span class="op" id="3952459">(</span><span class="ident" id="3952460">result</span><span class="op" id="3952466">,</span>&nbsp;<span class="ident" id="3952468">secret</span><span class="op" id="3952474">,</span>&nbsp;<span class="ident" id="3952476">label</span><span class="op" id="3952481">,</span>&nbsp;<span class="ident" id="3952483">seed</span>&nbsp;<span class="op" id="3952488">[</span><span class="op" id="3952489">]</span><span class="builtintype" id="3952490">byte</span><span class="op" id="3952494">)</span>&nbsp;<span class="op" id="3952496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952499">labelAndSeed</span>&nbsp;<span class="op" id="3952512">:=</span>&nbsp;<span class="builtinfunc" id="3952515">make</span><span class="op" id="3952519">(</span><span class="op" id="3952520">[</span><span class="op" id="3952521">]</span><span class="builtintype" id="3952522">byte</span><span class="op" id="3952526">,</span>&nbsp;<span class="builtinfunc" id="3952528">len</span><span class="op" id="3952531">(</span><span class="ident" id="3952532"><a href="/crypto/tls/prf.go.html#3952476">label</a></span><span class="op" id="3952537">)</span><span class="op" id="3952538">+</span><span class="builtinfunc" id="3952539">len</span><span class="op" id="3952542">(</span><span class="ident" id="3952543"><a href="/crypto/tls/prf.go.html#3952483">seed</a></span><span class="op" id="3952547">)</span><span class="op" id="3952548">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3952551">copy</span><span class="op" id="3952555">(</span><span class="ident" id="3952556"><a href="/crypto/tls/prf.go.html#3952499">labelAndSeed</a></span><span class="op" id="3952568">,</span>&nbsp;<span class="ident" id="3952570"><a href="/crypto/tls/prf.go.html#3952476">label</a></span><span class="op" id="3952575">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3952578">copy</span><span class="op" id="3952582">(</span><span class="ident" id="3952583"><a href="/crypto/tls/prf.go.html#3952499">labelAndSeed</a></span><span class="op" id="3952595">[</span><span class="builtinfunc" id="3952596">len</span><span class="op" id="3952599">(</span><span class="ident" id="3952600"><a href="/crypto/tls/prf.go.html#3952476">label</a></span><span class="op" id="3952605">)</span><span class="op" id="3952606">:</span><span class="op" id="3952607">]</span><span class="op" id="3952608">,</span>&nbsp;<span class="ident" id="3952610"><a href="/crypto/tls/prf.go.html#3952483">seed</a></span><span class="op" id="3952614">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952618"><a href="/crypto/tls/prf.go.html#3951463">pHash</a></span><span class="op" id="3952623">(</span><span class="ident" id="3952624"><a href="/crypto/tls/prf.go.html#3952460">result</a></span><span class="op" id="3952630">,</span>&nbsp;<span class="ident" id="3952632"><a href="/crypto/tls/prf.go.html#3952468">secret</a></span><span class="op" id="3952638">,</span>&nbsp;<span class="ident" id="3952640"><a href="/crypto/tls/prf.go.html#3952499">labelAndSeed</a></span><span class="op" id="3952652">,</span>&nbsp;<span class="ident" id="3952654"><a href="/crypto/tls/prf.go.html#3951148">sha256</a></span><span class="op" id="3952660">.</span><span class="ident" id="3952661">New</span><span class="op" id="3952664">)</span><br>
<span class="lineno"></span><span class="op" id="3952666">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="comment" id="3952669">//&nbsp;prf30&nbsp;implements&nbsp;the&nbsp;SSL&nbsp;3.0&nbsp;pseudo-random&nbsp;function,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3952739">//&nbsp;www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt&nbsp;section&nbsp;6.</span><br>
<span class="lineno"></span><span class="keyword" id="3952812">func</span>&nbsp;<span class="ident" id="3952817">prf30</span><span class="op" id="3952822">(</span><span class="ident" id="3952823">result</span><span class="op" id="3952829">,</span>&nbsp;<span class="ident" id="3952831">secret</span><span class="op" id="3952837">,</span>&nbsp;<span class="ident" id="3952839">label</span><span class="op" id="3952844">,</span>&nbsp;<span class="ident" id="3952846">seed</span>&nbsp;<span class="op" id="3952851">[</span><span class="op" id="3952852">]</span><span class="builtintype" id="3952853">byte</span><span class="op" id="3952857">)</span>&nbsp;<span class="op" id="3952859">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952862">hashSHA1</span>&nbsp;<span class="op" id="3952871">:=</span>&nbsp;<span class="ident" id="3952874"><a href="/crypto/tls/prf.go.html#3951133">sha1</a></span><span class="op" id="3952878">.</span><span class="ident" id="3952879">New</span><span class="op" id="3952882">(</span><span class="op" id="3952883">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952886">hashMD5</span>&nbsp;<span class="op" id="3952894">:=</span>&nbsp;<span class="ident" id="3952897"><a href="/crypto/tls/prf.go.html#3951119">md5</a></span><span class="op" id="3952900">.</span><span class="ident" id="3952901">New</span><span class="op" id="3952904">(</span><span class="op" id="3952905">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952909">done</span>&nbsp;<span class="op" id="3952914">:=</span>&nbsp;<span class="num" id="3952917">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3952920">i</span>&nbsp;<span class="op" id="3952922">:=</span>&nbsp;<span class="num" id="3952925">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952928">//&nbsp;RFC5246&nbsp;section&nbsp;6.3&nbsp;says&nbsp;that&nbsp;the&nbsp;largest&nbsp;PRF&nbsp;output&nbsp;needed&nbsp;is&nbsp;128</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3952999">//&nbsp;bytes.&nbsp;Since&nbsp;no&nbsp;more&nbsp;ciphersuites&nbsp;will&nbsp;be&nbsp;added&nbsp;to&nbsp;SSLv3,&nbsp;this&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3953071">//&nbsp;remain&nbsp;true.&nbsp;Each&nbsp;iteration&nbsp;gives&nbsp;us&nbsp;16&nbsp;bytes&nbsp;so&nbsp;10&nbsp;iterations&nbsp;will</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3953143">//&nbsp;be&nbsp;sufficient.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953162">var</span>&nbsp;<span class="ident" id="3953166">b</span>&nbsp;<span class="op" id="3953168">[</span><span class="num" id="3953169">11</span><span class="op" id="3953171">]</span><span class="builtintype" id="3953172">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953178">for</span>&nbsp;<span class="ident" id="3953182"><a href="/crypto/tls/prf.go.html#3952909">done</a></span>&nbsp;<span class="op" id="3953187">&lt;</span>&nbsp;<span class="builtinfunc" id="3953189">len</span><span class="op" id="3953192">(</span><span class="ident" id="3953193"><a href="/crypto/tls/prf.go.html#3952823">result</a></span><span class="op" id="3953199">)</span>&nbsp;<span class="op" id="3953201">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3953205">for</span>&nbsp;<span class="ident" id="3953209">j</span>&nbsp;<span class="op" id="3953211">:=</span>&nbsp;<span class="num" id="3953214">0</span><span class="op" id="3953215">;</span>&nbsp;<span class="ident" id="3953217"><a href="/crypto/tls/prf.go.html#3953209">j</a></span>&nbsp;<span class="op" id="3953219">&lt;=</span>&nbsp;<span class="ident" id="3953222"><a href="/crypto/tls/prf.go.html#3952920">i</a></span><span class="op" id="3953223">;</span>&nbsp;<span class="ident" id="3953225"><a href="/crypto/tls/prf.go.html#3953209">j</a></span><span class="op" id="3953226">++</span>&nbsp;<span class="op" id="3953229">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953234"><a href="/crypto/tls/prf.go.html#3953166">b</a></span><span class="op" id="3953235">[</span><span class="ident" id="3953236"><a href="/crypto/tls/prf.go.html#3953209">j</a></span><span class="op" id="3953237">]</span>&nbsp;<span class="op" id="3953239">=</span>&nbsp;<span class="string" id="3953241">&#39;A&#39;</span>&nbsp;<span class="op" id="3953245">+</span>&nbsp;<span class="builtintype" id="3953247">byte</span><span class="op" id="3953251">(</span><span class="ident" id="3953252"><a href="/crypto/tls/prf.go.html#3952920">i</a></span><span class="op" id="3953253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3953257">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953262"><a href="/crypto/tls/prf.go.html#3952862">hashSHA1</a></span><span class="op" id="3953270">.</span><span class="ident" id="3953271">Reset</span><span class="op" id="3953276">(</span><span class="op" id="3953277">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953281"><a href="/crypto/tls/prf.go.html#3952862">hashSHA1</a></span><span class="op" id="3953289">.</span><span class="ident" id="3953290">Write</span><span class="op" id="3953295">(</span><span class="ident" id="3953296"><a href="/crypto/tls/prf.go.html#3953166">b</a></span><span class="op" id="3953297">[</span><span class="op" id="3953298">:</span><span class="ident" id="3953299"><a href="/crypto/tls/prf.go.html#3952920">i</a></span><span class="op" id="3953300">+</span><span class="num" id="3953301">1</span><span class="op" id="3953302">]</span><span class="op" id="3953303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953307"><a href="/crypto/tls/prf.go.html#3952862">hashSHA1</a></span><span class="op" id="3953315">.</span><span class="ident" id="3953316">Write</span><span class="op" id="3953321">(</span><span class="ident" id="3953322"><a href="/crypto/tls/prf.go.html#3952831">secret</a></span><span class="op" id="3953328">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953332"><a href="/crypto/tls/prf.go.html#3952862">hashSHA1</a></span><span class="op" id="3953340">.</span><span class="ident" id="3953341">Write</span><span class="op" id="3953346">(</span><span class="ident" id="3953347"><a href="/crypto/tls/prf.go.html#3952846">seed</a></span><span class="op" id="3953351">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953355">digest</span>&nbsp;<span class="op" id="3953362">:=</span>&nbsp;<span class="ident" id="3953365"><a href="/crypto/tls/prf.go.html#3952862">hashSHA1</a></span><span class="op" id="3953373">.</span><span class="ident" id="3953374">Sum</span><span class="op" id="3953377">(</span><span class="ident" id="3953378">nil</span><span class="op" id="3953381">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953386"><a href="/crypto/tls/prf.go.html#3952886">hashMD5</a></span><span class="op" id="3953393">.</span><span class="ident" id="3953394">Reset</span><span class="op" id="3953399">(</span><span class="op" id="3953400">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953404"><a href="/crypto/tls/prf.go.html#3952886">hashMD5</a></span><span class="op" id="3953411">.</span><span class="ident" id="3953412">Write</span><span class="op" id="3953417">(</span><span class="ident" id="3953418"><a href="/crypto/tls/prf.go.html#3952831">secret</a></span><span class="op" id="3953424">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953428"><a href="/crypto/tls/prf.go.html#3952886">hashMD5</a></span><span class="op" id="3953435">.</span><span class="ident" id="3953436">Write</span><span class="op" id="3953441">(</span><span class="ident" id="3953442"><a href="/crypto/tls/prf.go.html#3953355">digest</a></span><span class="op" id="3953448">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953453"><a href="/crypto/tls/prf.go.html#3952909">done</a></span>&nbsp;<span class="op" id="3953458">+=</span>&nbsp;<span class="builtinfunc" id="3953461">copy</span><span class="op" id="3953465">(</span><span class="ident" id="3953466"><a href="/crypto/tls/prf.go.html#3952823">result</a></span><span class="op" id="3953472">[</span><span class="ident" id="3953473"><a href="/crypto/tls/prf.go.html#3952909">done</a></span><span class="op" id="3953477">:</span><span class="op" id="3953478">]</span><span class="op" id="3953479">,</span>&nbsp;<span class="ident" id="3953481"><a href="/crypto/tls/prf.go.html#3952886">hashMD5</a></span><span class="op" id="3953488">.</span><span class="ident" id="3953489">Sum</span><span class="op" id="3953492">(</span><span class="ident" id="3953493">nil</span><span class="op" id="3953496">)</span><span class="op" id="3953497">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953501"><a href="/crypto/tls/prf.go.html#3952920">i</a></span><span class="op" id="3953502">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3953506">}</span><br>
<span class="lineno"></span><span class="op" id="3953508">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3953511">const</span>&nbsp;<span class="op" id="3953517">(</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953520">tlsRandomLength</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="3953541">=</span>&nbsp;<span class="num" id="3953543">32</span>&nbsp;<span class="comment" id="3953546">//&nbsp;Length&nbsp;of&nbsp;a&nbsp;random&nbsp;nonce&nbsp;in&nbsp;TLS&nbsp;1.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953587">masterSecretLength</span>&nbsp;&nbsp;&nbsp;<span class="op" id="3953608">=</span>&nbsp;<span class="num" id="3953610">48</span>&nbsp;<span class="comment" id="3953613">//&nbsp;Length&nbsp;of&nbsp;a&nbsp;master&nbsp;secret&nbsp;in&nbsp;TLS&nbsp;1.1.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3953655">finishedVerifyLength</span>&nbsp;<span class="op" id="3953676">=</span>&nbsp;<span class="num" id="3953678">12</span>&nbsp;<span class="comment" id="3953681">//&nbsp;Length&nbsp;of&nbsp;verify_data&nbsp;in&nbsp;a&nbsp;Finished&nbsp;message.</span><br>
<span class="lineno"></span><span class="op" id="3953729">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span><span class="keyword" id="3953732">var</span>&nbsp;<span class="ident" id="3953736">masterSecretLabel</span>&nbsp;<span class="op" id="3953754">=</span>&nbsp;<span class="op" id="3953756">[</span><span class="op" id="3953757">]</span><span class="builtintype" id="3953758">byte</span><span class="op" id="3953762">(</span><span class="string" id="3953763">&#34;master&nbsp;secret&#34;</span><span class="op" id="3953778">)</span><br>
<span class="lineno"></span><span class="keyword" id="3953780">var</span>&nbsp;<span class="ident" id="3953784">keyExpansionLabel</span>&nbsp;<span class="op" id="3953802">=</span>&nbsp;<span class="op" id="3953804">[</span><span class="op" id="3953805">]</span><span class="builtintype" id="3953806">byte</span><span class="op" id="3953810">(</span><span class="string" id="3953811">&#34;key&nbsp;expansion&#34;</span><span class="op" id="3953826">)</span><br>
<span class="lineno"></span><span class="keyword" id="3953828">var</span>&nbsp;<span class="ident" id="3953832">clientFinishedLabel</span>&nbsp;<span class="op" id="3953852">=</span>&nbsp;<span class="op" id="3953854">[</span><span class="op" id="3953855">]</span><span class="builtintype" id="3953856">byte</span><span class="op" id="3953860">(</span><span class="string" id="3953861">&#34;client&nbsp;finished&#34;</span><span class="op" id="3953878">)</span><br>
<span class="lineno"></span><span class="keyword" id="3953880">var</span>&nbsp;<span class="ident" id="3953884">serverFinishedLabel</span>&nbsp;<span class="op" id="3953904">=</span>&nbsp;<span class="op" id="3953906">[</span><span class="op" id="3953907">]</span><span class="builtintype" id="3953908">byte</span><span class="op" id="3953912">(</span><span class="string" id="3953913">&#34;server&nbsp;finished&#34;</span><span class="op" id="3953930">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">120</span><span class="keyword" id="3953933">func</span>&nbsp;<span class="ident" id="3953938">prfForVersion</span><span class="op" id="3953951">(</span><span class="ident" id="3953952">version</span>&nbsp;<span class="builtintype" id="3953960">uint16</span><span class="op" id="3953966">)</span>&nbsp;<span class="keyword" id="3953968">func</span><span class="op" id="3953972">(</span><span class="ident" id="3953973">result</span><span class="op" id="3953979">,</span>&nbsp;<span class="ident" id="3953981">secret</span><span class="op" id="3953987">,</span>&nbsp;<span class="ident" id="3953989">label</span><span class="op" id="3953994">,</span>&nbsp;<span class="ident" id="3953996">seed</span>&nbsp;<span class="op" id="3954001">[</span><span class="op" id="3954002">]</span><span class="builtintype" id="3954003">byte</span><span class="op" id="3954007">)</span>&nbsp;<span class="op" id="3954009">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954012">switch</span>&nbsp;<span class="ident" id="3954019"><a href="/crypto/tls/prf.go.html#3953952">version</a></span>&nbsp;<span class="op" id="3954027">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954030">case</span>&nbsp;<span class="ident" id="3954035"><a href="/crypto/tls/common.go.html#3822772">VersionSSL30</a></span><span class="op" id="3954047">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954051">return</span>&nbsp;<span class="ident" id="3954058"><a href="/crypto/tls/prf.go.html#3952817">prf30</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954065">case</span>&nbsp;<span class="ident" id="3954070"><a href="/crypto/tls/common.go.html#3822795">VersionTLS10</a></span><span class="op" id="3954082">,</span>&nbsp;<span class="ident" id="3954084"><a href="/crypto/tls/common.go.html#3822818">VersionTLS11</a></span><span class="op" id="3954096">:</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954100">return</span>&nbsp;<span class="ident" id="3954107"><a href="/crypto/tls/prf.go.html#3951935">prf10</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954114">case</span>&nbsp;<span class="ident" id="3954119"><a href="/crypto/tls/common.go.html#3822841">VersionTLS12</a></span><span class="op" id="3954131">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954135">return</span>&nbsp;<span class="ident" id="3954142"><a href="/crypto/tls/prf.go.html#3952454">prf12</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954149">default</span><span class="op" id="3954156">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3954160">panic</span><span class="op" id="3954165">(</span><span class="string" id="3954166">&#34;unknown&nbsp;version&#34;</span><span class="op" id="3954183">)</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3954186">}</span><br>
<span class="lineno"></span><span class="op" id="3954188">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3954191">//&nbsp;masterFromPreMasterSecret&nbsp;generates&nbsp;the&nbsp;master&nbsp;secret&nbsp;from&nbsp;the&nbsp;pre-master</span><br>
<span class="lineno"></span><span class="comment" id="3954268">//&nbsp;secret.&nbsp;See&nbsp;http://tools.ietf.org/html/rfc5246#section-8.1</span><br>
<span class="lineno">135</span><span class="keyword" id="3954330">func</span>&nbsp;<span class="ident" id="3954335">masterFromPreMasterSecret</span><span class="op" id="3954360">(</span><span class="ident" id="3954361">version</span>&nbsp;<span class="builtintype" id="3954369">uint16</span><span class="op" id="3954375">,</span>&nbsp;<span class="ident" id="3954377">preMasterSecret</span><span class="op" id="3954392">,</span>&nbsp;<span class="ident" id="3954394">clientRandom</span><span class="op" id="3954406">,</span>&nbsp;<span class="ident" id="3954408">serverRandom</span>&nbsp;<span class="op" id="3954421">[</span><span class="op" id="3954422">]</span><span class="builtintype" id="3954423">byte</span><span class="op" id="3954427">)</span>&nbsp;<span class="op" id="3954429">[</span><span class="op" id="3954430">]</span><span class="builtintype" id="3954431">byte</span>&nbsp;<span class="op" id="3954436">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954439">var</span>&nbsp;<span class="ident" id="3954443">seed</span>&nbsp;<span class="op" id="3954448">[</span><span class="ident" id="3954449"><a href="/crypto/tls/prf.go.html#3953520">tlsRandomLength</a></span>&nbsp;<span class="op" id="3954465">*</span>&nbsp;<span class="num" id="3954467">2</span><span class="op" id="3954468">]</span><span class="builtintype" id="3954469">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3954475">copy</span><span class="op" id="3954479">(</span><span class="ident" id="3954480"><a href="/crypto/tls/prf.go.html#3954443">seed</a></span><span class="op" id="3954484">[</span><span class="num" id="3954485">0</span><span class="op" id="3954486">:</span><span class="builtinfunc" id="3954487">len</span><span class="op" id="3954490">(</span><span class="ident" id="3954491"><a href="/crypto/tls/prf.go.html#3954394">clientRandom</a></span><span class="op" id="3954503">)</span><span class="op" id="3954504">]</span><span class="op" id="3954505">,</span>&nbsp;<span class="ident" id="3954507"><a href="/crypto/tls/prf.go.html#3954394">clientRandom</a></span><span class="op" id="3954519">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3954522">copy</span><span class="op" id="3954526">(</span><span class="ident" id="3954527"><a href="/crypto/tls/prf.go.html#3954443">seed</a></span><span class="op" id="3954531">[</span><span class="builtinfunc" id="3954532">len</span><span class="op" id="3954535">(</span><span class="ident" id="3954536"><a href="/crypto/tls/prf.go.html#3954394">clientRandom</a></span><span class="op" id="3954548">)</span><span class="op" id="3954549">:</span><span class="op" id="3954550">]</span><span class="op" id="3954551">,</span>&nbsp;<span class="ident" id="3954553"><a href="/crypto/tls/prf.go.html#3954408">serverRandom</a></span><span class="op" id="3954565">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954568">masterSecret</span>&nbsp;<span class="op" id="3954581">:=</span>&nbsp;<span class="builtinfunc" id="3954584">make</span><span class="op" id="3954588">(</span><span class="op" id="3954589">[</span><span class="op" id="3954590">]</span><span class="builtintype" id="3954591">byte</span><span class="op" id="3954595">,</span>&nbsp;<span class="ident" id="3954597"><a href="/crypto/tls/prf.go.html#3953587">masterSecretLength</a></span><span class="op" id="3954615">)</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3954618"><a href="/crypto/tls/prf.go.html#3953938">prfForVersion</a></span><span class="op" id="3954631">(</span><span class="ident" id="3954632"><a href="/crypto/tls/prf.go.html#3954361">version</a></span><span class="op" id="3954639">)</span><span class="op" id="3954640">(</span><span class="ident" id="3954641"><a href="/crypto/tls/prf.go.html#3954568">masterSecret</a></span><span class="op" id="3954653">,</span>&nbsp;<span class="ident" id="3954655"><a href="/crypto/tls/prf.go.html#3954377">preMasterSecret</a></span><span class="op" id="3954670">,</span>&nbsp;<span class="ident" id="3954672"><a href="/crypto/tls/prf.go.html#3953736">masterSecretLabel</a></span><span class="op" id="3954689">,</span>&nbsp;<span class="ident" id="3954691"><a href="/crypto/tls/prf.go.html#3954443">seed</a></span><span class="op" id="3954695">[</span><span class="num" id="3954696">0</span><span class="op" id="3954697">:</span><span class="op" id="3954698">]</span><span class="op" id="3954699">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3954702">return</span>&nbsp;<span class="ident" id="3954709"><a href="/crypto/tls/prf.go.html#3954568">masterSecret</a></span><br>
<span class="lineno"></span><span class="op" id="3954722">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="3954725">//&nbsp;keysFromMasterSecret&nbsp;generates&nbsp;the&nbsp;connection&nbsp;keys&nbsp;from&nbsp;the&nbsp;master</span><br>
<span class="lineno">145</span><span class="comment" id="3954795">//&nbsp;secret,&nbsp;given&nbsp;the&nbsp;lengths&nbsp;of&nbsp;the&nbsp;MAC&nbsp;key,&nbsp;cipher&nbsp;key&nbsp;and&nbsp;IV,&nbsp;as&nbsp;defined&nbsp;in</span><br>
<span class="lineno"></span><span class="comment" id="3954873">//&nbsp;RFC&nbsp;2246,&nbsp;section&nbsp;6.3.</span><br>
<span class="lineno"></span><span class="keyword" id="3954899">func</span>&nbsp;<span class="ident" id="3954904">keysFromMasterSecret</span><span class="op" id="3954924">(</span><span class="ident" id="3954925">version</span>&nbsp;<span class="builtintype" id="3954933">uint16</span><span class="op" id="3954939">,</span>&nbsp;<span class="ident" id="3954941">masterSecret</span><span class="op" id="3954953">,</span>&nbsp;<span class="ident" id="3954955">clientRandom</span><span class="op" id="3954967">,</span>&nbsp;<span class="ident" id="3954969">serverRandom</span>&nbsp;<span class="op" id="3954982">[</span><span class="op" id="3954983">]</span><span class="builtintype" id="3954984">byte</span><span class="op" id="3954988">,</span>&nbsp;<span class="ident" id="3954990">macLen</span><span class="op" id="3954996">,</span>&nbsp;<span class="ident" id="3954998">keyLen</span><span class="op" id="3955004">,</span>&nbsp;<span class="ident" id="3955006">ivLen</span>&nbsp;<span class="builtintype" id="3955012">int</span><span class="op" id="3955015">)</span>&nbsp;<span class="op" id="3955017">(</span><span class="ident" id="3955018">clientMAC</span><span class="op" id="3955027">,</span>&nbsp;<span class="ident" id="3955029">serverMAC</span><span class="op" id="3955038">,</span>&nbsp;<span class="ident" id="3955040">clientKey</span><span class="op" id="3955049">,</span>&nbsp;<span class="ident" id="3955051">serverKey</span><span class="op" id="3955060">,</span>&nbsp;<span class="ident" id="3955062">clientIV</span><span class="op" id="3955070">,</span>&nbsp;<span class="ident" id="3955072">serverIV</span>&nbsp;<span class="op" id="3955081">[</span><span class="op" id="3955082">]</span><span class="builtintype" id="3955083">byte</span><span class="op" id="3955087">)</span>&nbsp;<span class="op" id="3955089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955092">var</span>&nbsp;<span class="ident" id="3955096">seed</span>&nbsp;<span class="op" id="3955101">[</span><span class="ident" id="3955102"><a href="/crypto/tls/prf.go.html#3953520">tlsRandomLength</a></span>&nbsp;<span class="op" id="3955118">*</span>&nbsp;<span class="num" id="3955120">2</span><span class="op" id="3955121">]</span><span class="builtintype" id="3955122">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3955128">copy</span><span class="op" id="3955132">(</span><span class="ident" id="3955133"><a href="/crypto/tls/prf.go.html#3955096">seed</a></span><span class="op" id="3955137">[</span><span class="num" id="3955138">0</span><span class="op" id="3955139">:</span><span class="builtinfunc" id="3955140">len</span><span class="op" id="3955143">(</span><span class="ident" id="3955144"><a href="/crypto/tls/prf.go.html#3954955">clientRandom</a></span><span class="op" id="3955156">)</span><span class="op" id="3955157">]</span><span class="op" id="3955158">,</span>&nbsp;<span class="ident" id="3955160"><a href="/crypto/tls/prf.go.html#3954969">serverRandom</a></span><span class="op" id="3955172">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3955175">copy</span><span class="op" id="3955179">(</span><span class="ident" id="3955180"><a href="/crypto/tls/prf.go.html#3955096">seed</a></span><span class="op" id="3955184">[</span><span class="builtinfunc" id="3955185">len</span><span class="op" id="3955188">(</span><span class="ident" id="3955189"><a href="/crypto/tls/prf.go.html#3954969">serverRandom</a></span><span class="op" id="3955201">)</span><span class="op" id="3955202">:</span><span class="op" id="3955203">]</span><span class="op" id="3955204">,</span>&nbsp;<span class="ident" id="3955206"><a href="/crypto/tls/prf.go.html#3954955">clientRandom</a></span><span class="op" id="3955218">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955222">n</span>&nbsp;<span class="op" id="3955224">:=</span>&nbsp;<span class="num" id="3955227">2</span><span class="op" id="3955228">*</span><span class="ident" id="3955229"><a href="/crypto/tls/prf.go.html#3954990">macLen</a></span>&nbsp;<span class="op" id="3955236">+</span>&nbsp;<span class="num" id="3955238">2</span><span class="op" id="3955239">*</span><span class="ident" id="3955240"><a href="/crypto/tls/prf.go.html#3954998">keyLen</a></span>&nbsp;<span class="op" id="3955247">+</span>&nbsp;<span class="num" id="3955249">2</span><span class="op" id="3955250">*</span><span class="ident" id="3955251"><a href="/crypto/tls/prf.go.html#3955006">ivLen</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955258">keyMaterial</span>&nbsp;<span class="op" id="3955270">:=</span>&nbsp;<span class="builtinfunc" id="3955273">make</span><span class="op" id="3955277">(</span><span class="op" id="3955278">[</span><span class="op" id="3955279">]</span><span class="builtintype" id="3955280">byte</span><span class="op" id="3955284">,</span>&nbsp;<span class="ident" id="3955286"><a href="/crypto/tls/prf.go.html#3955222">n</a></span><span class="op" id="3955287">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955290"><a href="/crypto/tls/prf.go.html#3953938">prfForVersion</a></span><span class="op" id="3955303">(</span><span class="ident" id="3955304"><a href="/crypto/tls/prf.go.html#3954925">version</a></span><span class="op" id="3955311">)</span><span class="op" id="3955312">(</span><span class="ident" id="3955313"><a href="/crypto/tls/prf.go.html#3955258">keyMaterial</a></span><span class="op" id="3955324">,</span>&nbsp;<span class="ident" id="3955326"><a href="/crypto/tls/prf.go.html#3954941">masterSecret</a></span><span class="op" id="3955338">,</span>&nbsp;<span class="ident" id="3955340"><a href="/crypto/tls/prf.go.html#3953784">keyExpansionLabel</a></span><span class="op" id="3955357">,</span>&nbsp;<span class="ident" id="3955359"><a href="/crypto/tls/prf.go.html#3955096">seed</a></span><span class="op" id="3955363">[</span><span class="num" id="3955364">0</span><span class="op" id="3955365">:</span><span class="op" id="3955366">]</span><span class="op" id="3955367">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955370"><a href="/crypto/tls/prf.go.html#3955018">clientMAC</a></span>&nbsp;<span class="op" id="3955380">=</span>&nbsp;<span class="ident" id="3955382"><a href="/crypto/tls/prf.go.html#3955258">keyMaterial</a></span><span class="op" id="3955393">[</span><span class="op" id="3955394">:</span><span class="ident" id="3955395"><a href="/crypto/tls/prf.go.html#3954990">macLen</a></span><span class="op" id="3955401">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955404"><a href="/crypto/tls/prf.go.html#3955258">keyMaterial</a></span>&nbsp;<span class="op" id="3955416">=</span>&nbsp;<span class="ident" id="3955418"><a href="/crypto/tls/prf.go.html#3955258">keyMaterial</a></span><span class="op" id="3955429">[</span><span class="ident" id="3955430"><a href="/crypto/tls/prf.go.html#3954990">macLen</a></span><span class="op" id="3955436">:</span><span class="op" id="3955437">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955440"><a href="/crypto/tls/prf.go.html#3955029">serverMAC</a></span>&nbsp;<span class="op" id="3955450">=</span>&nbsp;<span class="ident" id="3955452"><a href="/crypto/tls/prf.go.html#3955258">keyMaterial</a></span><span class="op" id="3955463">[</span><span class="op" id="3955464">:</span><span class="ident" id="3955465"><a href="/crypto/tls/prf.go.html#3954990">macLen</a></span><span class="op" id="3955471">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955474"><a href="/crypto/tls/prf.go.html#3955258">keyMaterial</a></span>&nbsp;<span class="op" id="3955486">=</span>&nbsp;<span class="ident" id="3955488"><a href="/crypto/tls/prf.go.html#3955258">keyMaterial</a></span><span class="op" id="3955499">[</span><span class="ident" id="3955500"><a href="/crypto/tls/prf.go.html#3954990">macLen</a></span><span class="op" id="3955506">:</span><span class="op" id="3955507">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955510"><a href="/crypto/tls/prf.go.html#3955040">clientKey</a></span>&nbsp;<span class="op" id="3955520">=</span>&nbsp;<span class="ident" id="3955522"><a href="/crypto/tls/prf.go.html#3955258">keyMaterial</a></span><span class="op" id="3955533">[</span><span class="op" id="3955534">:</span><span class="ident" id="3955535"><a href="/crypto/tls/prf.go.html#3954998">keyLen</a></span><span class="op" id="3955541">]</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955544"><a href="/crypto/tls/prf.go.html#3955258">keyMaterial</a></span>&nbsp;<span class="op" id="3955556">=</span>&nbsp;<span class="ident" id="3955558"><a href="/crypto/tls/prf.go.html#3955258">keyMaterial</a></span><span class="op" id="3955569">[</span><span class="ident" id="3955570"><a href="/crypto/tls/prf.go.html#3954998">keyLen</a></span><span class="op" id="3955576">:</span><span class="op" id="3955577">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955580"><a href="/crypto/tls/prf.go.html#3955051">serverKey</a></span>&nbsp;<span class="op" id="3955590">=</span>&nbsp;<span class="ident" id="3955592"><a href="/crypto/tls/prf.go.html#3955258">keyMaterial</a></span><span class="op" id="3955603">[</span><span class="op" id="3955604">:</span><span class="ident" id="3955605"><a href="/crypto/tls/prf.go.html#3954998">keyLen</a></span><span class="op" id="3955611">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955614"><a href="/crypto/tls/prf.go.html#3955258">keyMaterial</a></span>&nbsp;<span class="op" id="3955626">=</span>&nbsp;<span class="ident" id="3955628"><a href="/crypto/tls/prf.go.html#3955258">keyMaterial</a></span><span class="op" id="3955639">[</span><span class="ident" id="3955640"><a href="/crypto/tls/prf.go.html#3954998">keyLen</a></span><span class="op" id="3955646">:</span><span class="op" id="3955647">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955650"><a href="/crypto/tls/prf.go.html#3955062">clientIV</a></span>&nbsp;<span class="op" id="3955659">=</span>&nbsp;<span class="ident" id="3955661"><a href="/crypto/tls/prf.go.html#3955258">keyMaterial</a></span><span class="op" id="3955672">[</span><span class="op" id="3955673">:</span><span class="ident" id="3955674"><a href="/crypto/tls/prf.go.html#3955006">ivLen</a></span><span class="op" id="3955679">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955682"><a href="/crypto/tls/prf.go.html#3955258">keyMaterial</a></span>&nbsp;<span class="op" id="3955694">=</span>&nbsp;<span class="ident" id="3955696"><a href="/crypto/tls/prf.go.html#3955258">keyMaterial</a></span><span class="op" id="3955707">[</span><span class="ident" id="3955708"><a href="/crypto/tls/prf.go.html#3955006">ivLen</a></span><span class="op" id="3955713">:</span><span class="op" id="3955714">]</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3955717"><a href="/crypto/tls/prf.go.html#3955072">serverIV</a></span>&nbsp;<span class="op" id="3955726">=</span>&nbsp;<span class="ident" id="3955728"><a href="/crypto/tls/prf.go.html#3955258">keyMaterial</a></span><span class="op" id="3955739">[</span><span class="op" id="3955740">:</span><span class="ident" id="3955741"><a href="/crypto/tls/prf.go.html#3955006">ivLen</a></span><span class="op" id="3955746">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955749">return</span><br>
<span class="lineno"></span><span class="op" id="3955756">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3955759">func</span>&nbsp;<span class="ident" id="3955764">newFinishedHash</span><span class="op" id="3955779">(</span><span class="ident" id="3955780">version</span>&nbsp;<span class="builtintype" id="3955788">uint16</span><span class="op" id="3955794">)</span>&nbsp;<span class="ident" id="3955796"><a href="/crypto/tls/prf.go.html#3956115">finishedHash</a></span>&nbsp;<span class="op" id="3955809">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955812">if</span>&nbsp;<span class="ident" id="3955815"><a href="/crypto/tls/prf.go.html#3955780">version</a></span>&nbsp;<span class="op" id="3955823">&gt;=</span>&nbsp;<span class="ident" id="3955826"><a href="/crypto/tls/common.go.html#3822841">VersionTLS12</a></span>&nbsp;<span class="op" id="3955839">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955843">return</span>&nbsp;<span class="ident" id="3955850"><a href="/crypto/tls/prf.go.html#3956115">finishedHash</a></span><span class="op" id="3955862">{</span><span class="ident" id="3955863"><a href="/crypto/tls/prf.go.html#3951148">sha256</a></span><span class="op" id="3955869">.</span><span class="ident" id="3955870">New</span><span class="op" id="3955873">(</span><span class="op" id="3955874">)</span><span class="op" id="3955875">,</span>&nbsp;<span class="ident" id="3955877"><a href="/crypto/tls/prf.go.html#3951148">sha256</a></span><span class="op" id="3955883">.</span><span class="ident" id="3955884">New</span><span class="op" id="3955887">(</span><span class="op" id="3955888">)</span><span class="op" id="3955889">,</span>&nbsp;<span class="ident" id="3955891">nil</span><span class="op" id="3955894">,</span>&nbsp;<span class="ident" id="3955896">nil</span><span class="op" id="3955899">,</span>&nbsp;<span class="ident" id="3955901"><a href="/crypto/tls/prf.go.html#3955780">version</a></span><span class="op" id="3955908">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3955911">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3955914">return</span>&nbsp;<span class="ident" id="3955921"><a href="/crypto/tls/prf.go.html#3956115">finishedHash</a></span><span class="op" id="3955933">{</span><span class="ident" id="3955934"><a href="/crypto/tls/prf.go.html#3951133">sha1</a></span><span class="op" id="3955938">.</span><span class="ident" id="3955939">New</span><span class="op" id="3955942">(</span><span class="op" id="3955943">)</span><span class="op" id="3955944">,</span>&nbsp;<span class="ident" id="3955946"><a href="/crypto/tls/prf.go.html#3951133">sha1</a></span><span class="op" id="3955950">.</span><span class="ident" id="3955951">New</span><span class="op" id="3955954">(</span><span class="op" id="3955955">)</span><span class="op" id="3955956">,</span>&nbsp;<span class="ident" id="3955958"><a href="/crypto/tls/prf.go.html#3951119">md5</a></span><span class="op" id="3955961">.</span><span class="ident" id="3955962">New</span><span class="op" id="3955965">(</span><span class="op" id="3955966">)</span><span class="op" id="3955967">,</span>&nbsp;<span class="ident" id="3955969"><a href="/crypto/tls/prf.go.html#3951119">md5</a></span><span class="op" id="3955972">.</span><span class="ident" id="3955973">New</span><span class="op" id="3955976">(</span><span class="op" id="3955977">)</span><span class="op" id="3955978">,</span>&nbsp;<span class="ident" id="3955980"><a href="/crypto/tls/prf.go.html#3955780">version</a></span><span class="op" id="3955987">}</span><br>
<span class="lineno"></span><span class="op" id="3955989">}</span><br>
<span class="lineno">175</span><br>
<span class="lineno"></span><span class="comment" id="3955992">//&nbsp;A&nbsp;finishedHash&nbsp;calculates&nbsp;the&nbsp;hash&nbsp;of&nbsp;a&nbsp;set&nbsp;of&nbsp;handshake&nbsp;messages&nbsp;suitable</span><br>
<span class="lineno"></span><span class="comment" id="3956070">//&nbsp;for&nbsp;including&nbsp;in&nbsp;a&nbsp;Finished&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="3956110">type</span>&nbsp;<span class="ident" id="3956115">finishedHash</span>&nbsp;<span class="keyword" id="3956128">struct</span>&nbsp;<span class="op" id="3956135">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956138">client</span>&nbsp;<span class="ident" id="3956145"><a href="/crypto/tls/prf.go.html#3951165">hash</a></span><span class="op" id="3956149">.</span><span class="ident" id="3956150">Hash</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956156">server</span>&nbsp;<span class="ident" id="3956163"><a href="/crypto/tls/prf.go.html#3951165">hash</a></span><span class="op" id="3956167">.</span><span class="ident" id="3956168">Hash</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="3956175">//&nbsp;Prior&nbsp;to&nbsp;TLS&nbsp;1.2,&nbsp;an&nbsp;additional&nbsp;MD5&nbsp;hash&nbsp;is&nbsp;required.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956233">clientMD5</span>&nbsp;<span class="ident" id="3956243"><a href="/crypto/tls/prf.go.html#3951165">hash</a></span><span class="op" id="3956247">.</span><span class="ident" id="3956248">Hash</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956254">serverMD5</span>&nbsp;<span class="ident" id="3956264"><a href="/crypto/tls/prf.go.html#3951165">hash</a></span><span class="op" id="3956268">.</span><span class="ident" id="3956269">Hash</span><br>
<span class="lineno">185</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956276">version</span>&nbsp;<span class="builtintype" id="3956284">uint16</span><br>
<span class="lineno"></span><span class="op" id="3956291">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3956294">func</span>&nbsp;<span class="op" id="3956299">(</span><span class="ident" id="3956300">h</span>&nbsp;<span class="ident" id="3956302"><a href="/crypto/tls/prf.go.html#3956115">finishedHash</a></span><span class="op" id="3956314">)</span>&nbsp;<span class="ident" id="3956316">Write</span><span class="op" id="3956321">(</span><span class="ident" id="3956322">msg</span>&nbsp;<span class="op" id="3956326">[</span><span class="op" id="3956327">]</span><span class="builtintype" id="3956328">byte</span><span class="op" id="3956332">)</span>&nbsp;<span class="op" id="3956334">(</span><span class="ident" id="3956335">n</span>&nbsp;<span class="builtintype" id="3956337">int</span><span class="op" id="3956340">,</span>&nbsp;<span class="ident" id="3956342">err</span>&nbsp;<span class="builtintype" id="3956346">error</span><span class="op" id="3956351">)</span>&nbsp;<span class="op" id="3956353">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956356"><a href="/crypto/tls/prf.go.html#3956300">h</a></span><span class="op" id="3956357">.</span><span class="ident" id="3956358">client</span><span class="op" id="3956364">.</span><span class="ident" id="3956365">Write</span><span class="op" id="3956370">(</span><span class="ident" id="3956371"><a href="/crypto/tls/prf.go.html#3956322">msg</a></span><span class="op" id="3956374">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956377"><a href="/crypto/tls/prf.go.html#3956300">h</a></span><span class="op" id="3956378">.</span><span class="ident" id="3956379">server</span><span class="op" id="3956385">.</span><span class="ident" id="3956386">Write</span><span class="op" id="3956391">(</span><span class="ident" id="3956392"><a href="/crypto/tls/prf.go.html#3956322">msg</a></span><span class="op" id="3956395">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956399">if</span>&nbsp;<span class="ident" id="3956402"><a href="/crypto/tls/prf.go.html#3956300">h</a></span><span class="op" id="3956403">.</span><span class="ident" id="3956404">version</span>&nbsp;<span class="op" id="3956412">&lt;</span>&nbsp;<span class="ident" id="3956414"><a href="/crypto/tls/common.go.html#3822841">VersionTLS12</a></span>&nbsp;<span class="op" id="3956427">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956431"><a href="/crypto/tls/prf.go.html#3956300">h</a></span><span class="op" id="3956432">.</span><span class="ident" id="3956433">clientMD5</span><span class="op" id="3956442">.</span><span class="ident" id="3956443">Write</span><span class="op" id="3956448">(</span><span class="ident" id="3956449"><a href="/crypto/tls/prf.go.html#3956322">msg</a></span><span class="op" id="3956452">)</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956456"><a href="/crypto/tls/prf.go.html#3956300">h</a></span><span class="op" id="3956457">.</span><span class="ident" id="3956458">serverMD5</span><span class="op" id="3956467">.</span><span class="ident" id="3956468">Write</span><span class="op" id="3956473">(</span><span class="ident" id="3956474"><a href="/crypto/tls/prf.go.html#3956322">msg</a></span><span class="op" id="3956477">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3956480">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3956483">return</span>&nbsp;<span class="builtinfunc" id="3956490">len</span><span class="op" id="3956493">(</span><span class="ident" id="3956494"><a href="/crypto/tls/prf.go.html#3956322">msg</a></span><span class="op" id="3956497">)</span><span class="op" id="3956498">,</span>&nbsp;<span class="ident" id="3956500">nil</span><br>
<span class="lineno"></span><span class="op" id="3956504">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span><span class="comment" id="3956507">//&nbsp;finishedSum30&nbsp;calculates&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;verify_data&nbsp;member&nbsp;of&nbsp;a&nbsp;SSLv3</span><br>
<span class="lineno"></span><span class="comment" id="3956585">//&nbsp;Finished&nbsp;message&nbsp;given&nbsp;the&nbsp;MD5&nbsp;and&nbsp;SHA1&nbsp;hashes&nbsp;of&nbsp;a&nbsp;set&nbsp;of&nbsp;handshake</span><br>
<span class="lineno"></span><span class="comment" id="3956657">//&nbsp;messages.</span><br>
<span class="lineno"></span><span class="keyword" id="3956670">func</span>&nbsp;<span class="ident" id="3956675">finishedSum30</span><span class="op" id="3956688">(</span><span class="ident" id="3956689">md5</span><span class="op" id="3956692">,</span>&nbsp;<span class="ident" id="3956694">sha1</span>&nbsp;<span class="ident" id="3956699"><a href="/crypto/tls/prf.go.html#3951165">hash</a></span><span class="op" id="3956703">.</span><span class="ident" id="3956704">Hash</span><span class="op" id="3956708">,</span>&nbsp;<span class="ident" id="3956710">masterSecret</span>&nbsp;<span class="op" id="3956723">[</span><span class="op" id="3956724">]</span><span class="builtintype" id="3956725">byte</span><span class="op" id="3956729">,</span>&nbsp;<span class="ident" id="3956731">magic</span>&nbsp;<span class="op" id="3956737">[</span><span class="num" id="3956738">4</span><span class="op" id="3956739">]</span><span class="builtintype" id="3956740">byte</span><span class="op" id="3956744">)</span>&nbsp;<span class="op" id="3956746">[</span><span class="op" id="3956747">]</span><span class="builtintype" id="3956748">byte</span>&nbsp;<span class="op" id="3956753">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956756"><a href="/crypto/tls/prf.go.html#3956689">md5</a></span><span class="op" id="3956759">.</span><span class="ident" id="3956760">Write</span><span class="op" id="3956765">(</span><span class="ident" id="3956766"><a href="/crypto/tls/prf.go.html#3956731">magic</a></span><span class="op" id="3956771">[</span><span class="op" id="3956772">:</span><span class="op" id="3956773">]</span><span class="op" id="3956774">)</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956777"><a href="/crypto/tls/prf.go.html#3956689">md5</a></span><span class="op" id="3956780">.</span><span class="ident" id="3956781">Write</span><span class="op" id="3956786">(</span><span class="ident" id="3956787"><a href="/crypto/tls/prf.go.html#3956710">masterSecret</a></span><span class="op" id="3956799">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956802"><a href="/crypto/tls/prf.go.html#3956689">md5</a></span><span class="op" id="3956805">.</span><span class="ident" id="3956806">Write</span><span class="op" id="3956811">(</span><span class="ident" id="3956812"><a href="/crypto/tls/cipher_suites.go.html#3819293">ssl30Pad1</a></span><span class="op" id="3956821">[</span><span class="op" id="3956822">:</span><span class="op" id="3956823">]</span><span class="op" id="3956824">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956827">md5Digest</span>&nbsp;<span class="op" id="3956837">:=</span>&nbsp;<span class="ident" id="3956840"><a href="/crypto/tls/prf.go.html#3956689">md5</a></span><span class="op" id="3956843">.</span><span class="ident" id="3956844">Sum</span><span class="op" id="3956847">(</span><span class="ident" id="3956848">nil</span><span class="op" id="3956851">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956855"><a href="/crypto/tls/prf.go.html#3956689">md5</a></span><span class="op" id="3956858">.</span><span class="ident" id="3956859">Reset</span><span class="op" id="3956864">(</span><span class="op" id="3956865">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956868"><a href="/crypto/tls/prf.go.html#3956689">md5</a></span><span class="op" id="3956871">.</span><span class="ident" id="3956872">Write</span><span class="op" id="3956877">(</span><span class="ident" id="3956878"><a href="/crypto/tls/prf.go.html#3956710">masterSecret</a></span><span class="op" id="3956890">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956893"><a href="/crypto/tls/prf.go.html#3956689">md5</a></span><span class="op" id="3956896">.</span><span class="ident" id="3956897">Write</span><span class="op" id="3956902">(</span><span class="ident" id="3956903"><a href="/crypto/tls/cipher_suites.go.html#3819607">ssl30Pad2</a></span><span class="op" id="3956912">[</span><span class="op" id="3956913">:</span><span class="op" id="3956914">]</span><span class="op" id="3956915">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956918"><a href="/crypto/tls/prf.go.html#3956689">md5</a></span><span class="op" id="3956921">.</span><span class="ident" id="3956922">Write</span><span class="op" id="3956927">(</span><span class="ident" id="3956928"><a href="/crypto/tls/prf.go.html#3956827">md5Digest</a></span><span class="op" id="3956937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956940"><a href="/crypto/tls/prf.go.html#3956827">md5Digest</a></span>&nbsp;<span class="op" id="3956950">=</span>&nbsp;<span class="ident" id="3956952"><a href="/crypto/tls/prf.go.html#3956689">md5</a></span><span class="op" id="3956955">.</span><span class="ident" id="3956956">Sum</span><span class="op" id="3956959">(</span><span class="ident" id="3956960">nil</span><span class="op" id="3956963">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956967"><a href="/crypto/tls/prf.go.html#3956694">sha1</a></span><span class="op" id="3956971">.</span><span class="ident" id="3956972">Write</span><span class="op" id="3956977">(</span><span class="ident" id="3956978"><a href="/crypto/tls/prf.go.html#3956731">magic</a></span><span class="op" id="3956983">[</span><span class="op" id="3956984">:</span><span class="op" id="3956985">]</span><span class="op" id="3956986">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3956989"><a href="/crypto/tls/prf.go.html#3956694">sha1</a></span><span class="op" id="3956993">.</span><span class="ident" id="3956994">Write</span><span class="op" id="3956999">(</span><span class="ident" id="3957000"><a href="/crypto/tls/prf.go.html#3956710">masterSecret</a></span><span class="op" id="3957012">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957015"><a href="/crypto/tls/prf.go.html#3956694">sha1</a></span><span class="op" id="3957019">.</span><span class="ident" id="3957020">Write</span><span class="op" id="3957025">(</span><span class="ident" id="3957026"><a href="/crypto/tls/cipher_suites.go.html#3819293">ssl30Pad1</a></span><span class="op" id="3957035">[</span><span class="op" id="3957036">:</span><span class="num" id="3957037">40</span><span class="op" id="3957039">]</span><span class="op" id="3957040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957043">sha1Digest</span>&nbsp;<span class="op" id="3957054">:=</span>&nbsp;<span class="ident" id="3957057"><a href="/crypto/tls/prf.go.html#3956694">sha1</a></span><span class="op" id="3957061">.</span><span class="ident" id="3957062">Sum</span><span class="op" id="3957065">(</span><span class="ident" id="3957066">nil</span><span class="op" id="3957069">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957073"><a href="/crypto/tls/prf.go.html#3956694">sha1</a></span><span class="op" id="3957077">.</span><span class="ident" id="3957078">Reset</span><span class="op" id="3957083">(</span><span class="op" id="3957084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957087"><a href="/crypto/tls/prf.go.html#3956694">sha1</a></span><span class="op" id="3957091">.</span><span class="ident" id="3957092">Write</span><span class="op" id="3957097">(</span><span class="ident" id="3957098"><a href="/crypto/tls/prf.go.html#3956710">masterSecret</a></span><span class="op" id="3957110">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957113"><a href="/crypto/tls/prf.go.html#3956694">sha1</a></span><span class="op" id="3957117">.</span><span class="ident" id="3957118">Write</span><span class="op" id="3957123">(</span><span class="ident" id="3957124"><a href="/crypto/tls/cipher_suites.go.html#3819607">ssl30Pad2</a></span><span class="op" id="3957133">[</span><span class="op" id="3957134">:</span><span class="num" id="3957135">40</span><span class="op" id="3957137">]</span><span class="op" id="3957138">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957141"><a href="/crypto/tls/prf.go.html#3956694">sha1</a></span><span class="op" id="3957145">.</span><span class="ident" id="3957146">Write</span><span class="op" id="3957151">(</span><span class="ident" id="3957152"><a href="/crypto/tls/prf.go.html#3957043">sha1Digest</a></span><span class="op" id="3957162">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957165"><a href="/crypto/tls/prf.go.html#3957043">sha1Digest</a></span>&nbsp;<span class="op" id="3957176">=</span>&nbsp;<span class="ident" id="3957178"><a href="/crypto/tls/prf.go.html#3956694">sha1</a></span><span class="op" id="3957182">.</span><span class="ident" id="3957183">Sum</span><span class="op" id="3957186">(</span><span class="ident" id="3957187">nil</span><span class="op" id="3957190">)</span><br>
<span class="lineno">225</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957194">ret</span>&nbsp;<span class="op" id="3957198">:=</span>&nbsp;<span class="builtinfunc" id="3957201">make</span><span class="op" id="3957205">(</span><span class="op" id="3957206">[</span><span class="op" id="3957207">]</span><span class="builtintype" id="3957208">byte</span><span class="op" id="3957212">,</span>&nbsp;<span class="builtinfunc" id="3957214">len</span><span class="op" id="3957217">(</span><span class="ident" id="3957218"><a href="/crypto/tls/prf.go.html#3956827">md5Digest</a></span><span class="op" id="3957227">)</span><span class="op" id="3957228">+</span><span class="builtinfunc" id="3957229">len</span><span class="op" id="3957232">(</span><span class="ident" id="3957233"><a href="/crypto/tls/prf.go.html#3957043">sha1Digest</a></span><span class="op" id="3957243">)</span><span class="op" id="3957244">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3957247">copy</span><span class="op" id="3957251">(</span><span class="ident" id="3957252"><a href="/crypto/tls/prf.go.html#3957194">ret</a></span><span class="op" id="3957255">,</span>&nbsp;<span class="ident" id="3957257"><a href="/crypto/tls/prf.go.html#3956827">md5Digest</a></span><span class="op" id="3957266">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="3957269">copy</span><span class="op" id="3957273">(</span><span class="ident" id="3957274"><a href="/crypto/tls/prf.go.html#3957194">ret</a></span><span class="op" id="3957277">[</span><span class="builtinfunc" id="3957278">len</span><span class="op" id="3957281">(</span><span class="ident" id="3957282"><a href="/crypto/tls/prf.go.html#3956827">md5Digest</a></span><span class="op" id="3957291">)</span><span class="op" id="3957292">:</span><span class="op" id="3957293">]</span><span class="op" id="3957294">,</span>&nbsp;<span class="ident" id="3957296"><a href="/crypto/tls/prf.go.html#3957043">sha1Digest</a></span><span class="op" id="3957306">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957309">return</span>&nbsp;<span class="ident" id="3957316"><a href="/crypto/tls/prf.go.html#3957194">ret</a></span><br>
<span class="lineno">230</span><span class="op" id="3957320">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="3957323">var</span>&nbsp;<span class="ident" id="3957327">ssl3ClientFinishedMagic</span>&nbsp;<span class="op" id="3957351">=</span>&nbsp;<span class="op" id="3957353">[</span><span class="num" id="3957354">4</span><span class="op" id="3957355">]</span><span class="builtintype" id="3957356">byte</span><span class="op" id="3957360">{</span><span class="num" id="3957361">0x43</span><span class="op" id="3957365">,</span>&nbsp;<span class="num" id="3957367">0x4c</span><span class="op" id="3957371">,</span>&nbsp;<span class="num" id="3957373">0x4e</span><span class="op" id="3957377">,</span>&nbsp;<span class="num" id="3957379">0x54</span><span class="op" id="3957383">}</span><br>
<span class="lineno"></span><span class="keyword" id="3957385">var</span>&nbsp;<span class="ident" id="3957389">ssl3ServerFinishedMagic</span>&nbsp;<span class="op" id="3957413">=</span>&nbsp;<span class="op" id="3957415">[</span><span class="num" id="3957416">4</span><span class="op" id="3957417">]</span><span class="builtintype" id="3957418">byte</span><span class="op" id="3957422">{</span><span class="num" id="3957423">0x53</span><span class="op" id="3957427">,</span>&nbsp;<span class="num" id="3957429">0x52</span><span class="op" id="3957433">,</span>&nbsp;<span class="num" id="3957435">0x56</span><span class="op" id="3957439">,</span>&nbsp;<span class="num" id="3957441">0x52</span><span class="op" id="3957445">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">235</span><span class="comment" id="3957448">//&nbsp;clientSum&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;verify_data&nbsp;member&nbsp;of&nbsp;a&nbsp;client&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3957522">//&nbsp;Finished&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="3957543">func</span>&nbsp;<span class="op" id="3957548">(</span><span class="ident" id="3957549">h</span>&nbsp;<span class="ident" id="3957551"><a href="/crypto/tls/prf.go.html#3956115">finishedHash</a></span><span class="op" id="3957563">)</span>&nbsp;<span class="ident" id="3957565">clientSum</span><span class="op" id="3957574">(</span><span class="ident" id="3957575">masterSecret</span>&nbsp;<span class="op" id="3957588">[</span><span class="op" id="3957589">]</span><span class="builtintype" id="3957590">byte</span><span class="op" id="3957594">)</span>&nbsp;<span class="op" id="3957596">[</span><span class="op" id="3957597">]</span><span class="builtintype" id="3957598">byte</span>&nbsp;<span class="op" id="3957603">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957606">if</span>&nbsp;<span class="ident" id="3957609"><a href="/crypto/tls/prf.go.html#3957549">h</a></span><span class="op" id="3957610">.</span><span class="ident" id="3957611">version</span>&nbsp;<span class="op" id="3957619">==</span>&nbsp;<span class="ident" id="3957622"><a href="/crypto/tls/common.go.html#3822772">VersionSSL30</a></span>&nbsp;<span class="op" id="3957635">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957639">return</span>&nbsp;<span class="ident" id="3957646"><a href="/crypto/tls/prf.go.html#3956675">finishedSum30</a></span><span class="op" id="3957659">(</span><span class="ident" id="3957660"><a href="/crypto/tls/prf.go.html#3957549">h</a></span><span class="op" id="3957661">.</span><span class="ident" id="3957662">clientMD5</span><span class="op" id="3957671">,</span>&nbsp;<span class="ident" id="3957673"><a href="/crypto/tls/prf.go.html#3957549">h</a></span><span class="op" id="3957674">.</span><span class="ident" id="3957675">client</span><span class="op" id="3957681">,</span>&nbsp;<span class="ident" id="3957683"><a href="/crypto/tls/prf.go.html#3957575">masterSecret</a></span><span class="op" id="3957695">,</span>&nbsp;<span class="ident" id="3957697"><a href="/crypto/tls/prf.go.html#3957327">ssl3ClientFinishedMagic</a></span><span class="op" id="3957720">)</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957723">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957727">out</span>&nbsp;<span class="op" id="3957731">:=</span>&nbsp;<span class="builtinfunc" id="3957734">make</span><span class="op" id="3957738">(</span><span class="op" id="3957739">[</span><span class="op" id="3957740">]</span><span class="builtintype" id="3957741">byte</span><span class="op" id="3957745">,</span>&nbsp;<span class="ident" id="3957747"><a href="/crypto/tls/prf.go.html#3953655">finishedVerifyLength</a></span><span class="op" id="3957767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3957770">if</span>&nbsp;<span class="ident" id="3957773"><a href="/crypto/tls/prf.go.html#3957549">h</a></span><span class="op" id="3957774">.</span><span class="ident" id="3957775">version</span>&nbsp;<span class="op" id="3957783">&gt;=</span>&nbsp;<span class="ident" id="3957786"><a href="/crypto/tls/common.go.html#3822841">VersionTLS12</a></span>&nbsp;<span class="op" id="3957799">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957803">seed</span>&nbsp;<span class="op" id="3957808">:=</span>&nbsp;<span class="ident" id="3957811"><a href="/crypto/tls/prf.go.html#3957549">h</a></span><span class="op" id="3957812">.</span><span class="ident" id="3957813">client</span><span class="op" id="3957819">.</span><span class="ident" id="3957820">Sum</span><span class="op" id="3957823">(</span><span class="ident" id="3957824">nil</span><span class="op" id="3957827">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957831"><a href="/crypto/tls/prf.go.html#3952454">prf12</a></span><span class="op" id="3957836">(</span><span class="ident" id="3957837"><a href="/crypto/tls/prf.go.html#3957727">out</a></span><span class="op" id="3957840">,</span>&nbsp;<span class="ident" id="3957842"><a href="/crypto/tls/prf.go.html#3957575">masterSecret</a></span><span class="op" id="3957854">,</span>&nbsp;<span class="ident" id="3957856"><a href="/crypto/tls/prf.go.html#3953832">clientFinishedLabel</a></span><span class="op" id="3957875">,</span>&nbsp;<span class="ident" id="3957877"><a href="/crypto/tls/prf.go.html#3957803">seed</a></span><span class="op" id="3957881">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3957884">}</span>&nbsp;<span class="keyword" id="3957886">else</span>&nbsp;<span class="op" id="3957891">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957895">seed</span>&nbsp;<span class="op" id="3957900">:=</span>&nbsp;<span class="builtinfunc" id="3957903">make</span><span class="op" id="3957907">(</span><span class="op" id="3957908">[</span><span class="op" id="3957909">]</span><span class="builtintype" id="3957910">byte</span><span class="op" id="3957914">,</span>&nbsp;<span class="num" id="3957916">0</span><span class="op" id="3957917">,</span>&nbsp;<span class="ident" id="3957919"><a href="/crypto/tls/prf.go.html#3951119">md5</a></span><span class="op" id="3957922">.</span><span class="ident" id="3957923">Size</span><span class="op" id="3957927">+</span><span class="ident" id="3957928"><a href="/crypto/tls/prf.go.html#3951133">sha1</a></span><span class="op" id="3957932">.</span><span class="ident" id="3957933">Size</span><span class="op" id="3957937">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957941"><a href="/crypto/tls/prf.go.html#3957895">seed</a></span>&nbsp;<span class="op" id="3957946">=</span>&nbsp;<span class="ident" id="3957948"><a href="/crypto/tls/prf.go.html#3957549">h</a></span><span class="op" id="3957949">.</span><span class="ident" id="3957950">clientMD5</span><span class="op" id="3957959">.</span><span class="ident" id="3957960">Sum</span><span class="op" id="3957963">(</span><span class="ident" id="3957964"><a href="/crypto/tls/prf.go.html#3957895">seed</a></span><span class="op" id="3957968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3957972"><a href="/crypto/tls/prf.go.html#3957895">seed</a></span>&nbsp;<span class="op" id="3957977">=</span>&nbsp;<span class="ident" id="3957979"><a href="/crypto/tls/prf.go.html#3957549">h</a></span><span class="op" id="3957980">.</span><span class="ident" id="3957981">client</span><span class="op" id="3957987">.</span><span class="ident" id="3957988">Sum</span><span class="op" id="3957991">(</span><span class="ident" id="3957992"><a href="/crypto/tls/prf.go.html#3957895">seed</a></span><span class="op" id="3957996">)</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958000"><a href="/crypto/tls/prf.go.html#3951935">prf10</a></span><span class="op" id="3958005">(</span><span class="ident" id="3958006"><a href="/crypto/tls/prf.go.html#3957727">out</a></span><span class="op" id="3958009">,</span>&nbsp;<span class="ident" id="3958011"><a href="/crypto/tls/prf.go.html#3957575">masterSecret</a></span><span class="op" id="3958023">,</span>&nbsp;<span class="ident" id="3958025"><a href="/crypto/tls/prf.go.html#3953832">clientFinishedLabel</a></span><span class="op" id="3958044">,</span>&nbsp;<span class="ident" id="3958046"><a href="/crypto/tls/prf.go.html#3957895">seed</a></span><span class="op" id="3958050">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3958053">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958056">return</span>&nbsp;<span class="ident" id="3958063"><a href="/crypto/tls/prf.go.html#3957727">out</a></span><br>
<span class="lineno"></span><span class="op" id="3958067">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="3958070">//&nbsp;serverSum&nbsp;returns&nbsp;the&nbsp;contents&nbsp;of&nbsp;the&nbsp;verify_data&nbsp;member&nbsp;of&nbsp;a&nbsp;server&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="3958144">//&nbsp;Finished&nbsp;message.</span><br>
<span class="lineno"></span><span class="keyword" id="3958165">func</span>&nbsp;<span class="op" id="3958170">(</span><span class="ident" id="3958171">h</span>&nbsp;<span class="ident" id="3958173"><a href="/crypto/tls/prf.go.html#3956115">finishedHash</a></span><span class="op" id="3958185">)</span>&nbsp;<span class="ident" id="3958187">serverSum</span><span class="op" id="3958196">(</span><span class="ident" id="3958197">masterSecret</span>&nbsp;<span class="op" id="3958210">[</span><span class="op" id="3958211">]</span><span class="builtintype" id="3958212">byte</span><span class="op" id="3958216">)</span>&nbsp;<span class="op" id="3958218">[</span><span class="op" id="3958219">]</span><span class="builtintype" id="3958220">byte</span>&nbsp;<span class="op" id="3958225">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958228">if</span>&nbsp;<span class="ident" id="3958231"><a href="/crypto/tls/prf.go.html#3958171">h</a></span><span class="op" id="3958232">.</span><span class="ident" id="3958233">version</span>&nbsp;<span class="op" id="3958241">==</span>&nbsp;<span class="ident" id="3958244"><a href="/crypto/tls/common.go.html#3822772">VersionSSL30</a></span>&nbsp;<span class="op" id="3958257">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958261">return</span>&nbsp;<span class="ident" id="3958268"><a href="/crypto/tls/prf.go.html#3956675">finishedSum30</a></span><span class="op" id="3958281">(</span><span class="ident" id="3958282"><a href="/crypto/tls/prf.go.html#3958171">h</a></span><span class="op" id="3958283">.</span><span class="ident" id="3958284">serverMD5</span><span class="op" id="3958293">,</span>&nbsp;<span class="ident" id="3958295"><a href="/crypto/tls/prf.go.html#3958171">h</a></span><span class="op" id="3958296">.</span><span class="ident" id="3958297">server</span><span class="op" id="3958303">,</span>&nbsp;<span class="ident" id="3958305"><a href="/crypto/tls/prf.go.html#3958197">masterSecret</a></span><span class="op" id="3958317">,</span>&nbsp;<span class="ident" id="3958319"><a href="/crypto/tls/prf.go.html#3957389">ssl3ServerFinishedMagic</a></span><span class="op" id="3958342">)</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3958345">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958349">out</span>&nbsp;<span class="op" id="3958353">:=</span>&nbsp;<span class="builtinfunc" id="3958356">make</span><span class="op" id="3958360">(</span><span class="op" id="3958361">[</span><span class="op" id="3958362">]</span><span class="builtintype" id="3958363">byte</span><span class="op" id="3958367">,</span>&nbsp;<span class="ident" id="3958369"><a href="/crypto/tls/prf.go.html#3953655">finishedVerifyLength</a></span><span class="op" id="3958389">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958392">if</span>&nbsp;<span class="ident" id="3958395"><a href="/crypto/tls/prf.go.html#3958171">h</a></span><span class="op" id="3958396">.</span><span class="ident" id="3958397">version</span>&nbsp;<span class="op" id="3958405">&gt;=</span>&nbsp;<span class="ident" id="3958408"><a href="/crypto/tls/common.go.html#3822841">VersionTLS12</a></span>&nbsp;<span class="op" id="3958421">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958425">seed</span>&nbsp;<span class="op" id="3958430">:=</span>&nbsp;<span class="ident" id="3958433"><a href="/crypto/tls/prf.go.html#3958171">h</a></span><span class="op" id="3958434">.</span><span class="ident" id="3958435">server</span><span class="op" id="3958441">.</span><span class="ident" id="3958442">Sum</span><span class="op" id="3958445">(</span><span class="ident" id="3958446">nil</span><span class="op" id="3958449">)</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958453"><a href="/crypto/tls/prf.go.html#3952454">prf12</a></span><span class="op" id="3958458">(</span><span class="ident" id="3958459"><a href="/crypto/tls/prf.go.html#3958349">out</a></span><span class="op" id="3958462">,</span>&nbsp;<span class="ident" id="3958464"><a href="/crypto/tls/prf.go.html#3958197">masterSecret</a></span><span class="op" id="3958476">,</span>&nbsp;<span class="ident" id="3958478"><a href="/crypto/tls/prf.go.html#3953884">serverFinishedLabel</a></span><span class="op" id="3958497">,</span>&nbsp;<span class="ident" id="3958499"><a href="/crypto/tls/prf.go.html#3958425">seed</a></span><span class="op" id="3958503">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3958506">}</span>&nbsp;<span class="keyword" id="3958508">else</span>&nbsp;<span class="op" id="3958513">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958517">seed</span>&nbsp;<span class="op" id="3958522">:=</span>&nbsp;<span class="builtinfunc" id="3958525">make</span><span class="op" id="3958529">(</span><span class="op" id="3958530">[</span><span class="op" id="3958531">]</span><span class="builtintype" id="3958532">byte</span><span class="op" id="3958536">,</span>&nbsp;<span class="num" id="3958538">0</span><span class="op" id="3958539">,</span>&nbsp;<span class="ident" id="3958541"><a href="/crypto/tls/prf.go.html#3951119">md5</a></span><span class="op" id="3958544">.</span><span class="ident" id="3958545">Size</span><span class="op" id="3958549">+</span><span class="ident" id="3958550"><a href="/crypto/tls/prf.go.html#3951133">sha1</a></span><span class="op" id="3958554">.</span><span class="ident" id="3958555">Size</span><span class="op" id="3958559">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958563"><a href="/crypto/tls/prf.go.html#3958517">seed</a></span>&nbsp;<span class="op" id="3958568">=</span>&nbsp;<span class="ident" id="3958570"><a href="/crypto/tls/prf.go.html#3958171">h</a></span><span class="op" id="3958571">.</span><span class="ident" id="3958572">serverMD5</span><span class="op" id="3958581">.</span><span class="ident" id="3958582">Sum</span><span class="op" id="3958585">(</span><span class="ident" id="3958586"><a href="/crypto/tls/prf.go.html#3958517">seed</a></span><span class="op" id="3958590">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958594"><a href="/crypto/tls/prf.go.html#3958517">seed</a></span>&nbsp;<span class="op" id="3958599">=</span>&nbsp;<span class="ident" id="3958601"><a href="/crypto/tls/prf.go.html#3958171">h</a></span><span class="op" id="3958602">.</span><span class="ident" id="3958603">server</span><span class="op" id="3958609">.</span><span class="ident" id="3958610">Sum</span><span class="op" id="3958613">(</span><span class="ident" id="3958614"><a href="/crypto/tls/prf.go.html#3958517">seed</a></span><span class="op" id="3958618">)</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958622"><a href="/crypto/tls/prf.go.html#3951935">prf10</a></span><span class="op" id="3958627">(</span><span class="ident" id="3958628"><a href="/crypto/tls/prf.go.html#3958349">out</a></span><span class="op" id="3958631">,</span>&nbsp;<span class="ident" id="3958633"><a href="/crypto/tls/prf.go.html#3958197">masterSecret</a></span><span class="op" id="3958645">,</span>&nbsp;<span class="ident" id="3958647"><a href="/crypto/tls/prf.go.html#3953884">serverFinishedLabel</a></span><span class="op" id="3958666">,</span>&nbsp;<span class="ident" id="3958668"><a href="/crypto/tls/prf.go.html#3958517">seed</a></span><span class="op" id="3958672">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3958675">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958678">return</span>&nbsp;<span class="ident" id="3958685"><a href="/crypto/tls/prf.go.html#3958349">out</a></span><br>
<span class="lineno"></span><span class="op" id="3958689">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">275</span><span class="comment" id="3958692">//&nbsp;hashForClientCertificate&nbsp;returns&nbsp;a&nbsp;digest,&nbsp;hash&nbsp;function,&nbsp;and&nbsp;TLS&nbsp;1.2&nbsp;hash</span><br>
<span class="lineno"></span><span class="comment" id="3958770">//&nbsp;id&nbsp;suitable&nbsp;for&nbsp;signing&nbsp;by&nbsp;a&nbsp;TLS&nbsp;client&nbsp;certificate.</span><br>
<span class="lineno"></span><span class="keyword" id="3958826">func</span>&nbsp;<span class="op" id="3958831">(</span><span class="ident" id="3958832">h</span>&nbsp;<span class="ident" id="3958834"><a href="/crypto/tls/prf.go.html#3956115">finishedHash</a></span><span class="op" id="3958846">)</span>&nbsp;<span class="ident" id="3958848">hashForClientCertificate</span><span class="op" id="3958872">(</span><span class="ident" id="3958873">sigType</span>&nbsp;<span class="builtintype" id="3958881">uint8</span><span class="op" id="3958886">)</span>&nbsp;<span class="op" id="3958888">(</span><span class="op" id="3958889">[</span><span class="op" id="3958890">]</span><span class="builtintype" id="3958891">byte</span><span class="op" id="3958895">,</span>&nbsp;<span class="ident" id="3958897"><a href="/crypto/tls/prf.go.html#3951094">crypto</a></span><span class="op" id="3958903">.</span><span class="ident" id="3958904">Hash</span><span class="op" id="3958908">,</span>&nbsp;<span class="builtintype" id="3958910">uint8</span><span class="op" id="3958915">)</span>&nbsp;<span class="op" id="3958917">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958920">if</span>&nbsp;<span class="ident" id="3958923"><a href="/crypto/tls/prf.go.html#3958832">h</a></span><span class="op" id="3958924">.</span><span class="ident" id="3958925">version</span>&nbsp;<span class="op" id="3958933">&gt;=</span>&nbsp;<span class="ident" id="3958936"><a href="/crypto/tls/common.go.html#3822841">VersionTLS12</a></span>&nbsp;<span class="op" id="3958949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3958953">digest</span>&nbsp;<span class="op" id="3958960">:=</span>&nbsp;<span class="ident" id="3958963"><a href="/crypto/tls/prf.go.html#3958832">h</a></span><span class="op" id="3958964">.</span><span class="ident" id="3958965">server</span><span class="op" id="3958971">.</span><span class="ident" id="3958972">Sum</span><span class="op" id="3958975">(</span><span class="ident" id="3958976">nil</span><span class="op" id="3958979">)</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3958983">return</span>&nbsp;<span class="ident" id="3958990"><a href="/crypto/tls/prf.go.html#3958953">digest</a></span><span class="op" id="3958996">,</span>&nbsp;<span class="ident" id="3958998"><a href="/crypto/tls/prf.go.html#3951094">crypto</a></span><span class="op" id="3959004">.</span><span class="ident" id="3959005">SHA256</span><span class="op" id="3959011">,</span>&nbsp;<span class="ident" id="3959013"><a href="/crypto/tls/common.go.html#3825825">hashSHA256</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959028">if</span>&nbsp;<span class="ident" id="3959031"><a href="/crypto/tls/prf.go.html#3958873">sigType</a></span>&nbsp;<span class="op" id="3959039">==</span>&nbsp;<span class="ident" id="3959042"><a href="/crypto/tls/common.go.html#3825950">signatureECDSA</a></span>&nbsp;<span class="op" id="3959057">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959061">digest</span>&nbsp;<span class="op" id="3959068">:=</span>&nbsp;<span class="ident" id="3959071"><a href="/crypto/tls/prf.go.html#3958832">h</a></span><span class="op" id="3959072">.</span><span class="ident" id="3959073">server</span><span class="op" id="3959079">.</span><span class="ident" id="3959080">Sum</span><span class="op" id="3959083">(</span><span class="ident" id="3959084">nil</span><span class="op" id="3959087">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959091">return</span>&nbsp;<span class="ident" id="3959098"><a href="/crypto/tls/prf.go.html#3959061">digest</a></span><span class="op" id="3959104">,</span>&nbsp;<span class="ident" id="3959106"><a href="/crypto/tls/prf.go.html#3951094">crypto</a></span><span class="op" id="3959112">.</span><span class="ident" id="3959113">SHA1</span><span class="op" id="3959117">,</span>&nbsp;<span class="ident" id="3959119"><a href="/crypto/tls/common.go.html#3825803">hashSHA1</a></span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="3959129">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959133">digest</span>&nbsp;<span class="op" id="3959140">:=</span>&nbsp;<span class="builtinfunc" id="3959143">make</span><span class="op" id="3959147">(</span><span class="op" id="3959148">[</span><span class="op" id="3959149">]</span><span class="builtintype" id="3959150">byte</span><span class="op" id="3959154">,</span>&nbsp;<span class="num" id="3959156">0</span><span class="op" id="3959157">,</span>&nbsp;<span class="num" id="3959159">36</span><span class="op" id="3959161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959164"><a href="/crypto/tls/prf.go.html#3959133">digest</a></span>&nbsp;<span class="op" id="3959171">=</span>&nbsp;<span class="ident" id="3959173"><a href="/crypto/tls/prf.go.html#3958832">h</a></span><span class="op" id="3959174">.</span><span class="ident" id="3959175">serverMD5</span><span class="op" id="3959184">.</span><span class="ident" id="3959185">Sum</span><span class="op" id="3959188">(</span><span class="ident" id="3959189"><a href="/crypto/tls/prf.go.html#3959133">digest</a></span><span class="op" id="3959195">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="3959198"><a href="/crypto/tls/prf.go.html#3959133">digest</a></span>&nbsp;<span class="op" id="3959205">=</span>&nbsp;<span class="ident" id="3959207"><a href="/crypto/tls/prf.go.html#3958832">h</a></span><span class="op" id="3959208">.</span><span class="ident" id="3959209">server</span><span class="op" id="3959215">.</span><span class="ident" id="3959216">Sum</span><span class="op" id="3959219">(</span><span class="ident" id="3959220"><a href="/crypto/tls/prf.go.html#3959133">digest</a></span><span class="op" id="3959226">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="3959229">return</span>&nbsp;<span class="ident" id="3959236"><a href="/crypto/tls/prf.go.html#3959133">digest</a></span><span class="op" id="3959242">,</span>&nbsp;<span class="ident" id="3959244"><a href="/crypto/tls/prf.go.html#3951094">crypto</a></span><span class="op" id="3959250">.</span><span class="ident" id="3959251">MD5SHA1</span><span class="op" id="3959258">,</span>&nbsp;<span class="num" id="3959260">0</span>&nbsp;<span class="comment" id="3959262">/*&nbsp;not&nbsp;specified&nbsp;in&nbsp;TLS&nbsp;1.2.&nbsp;*/</span><br>
<span class="lineno"></span><span class="op" id="3959294">}</span>
</div>
</body>
</html>
