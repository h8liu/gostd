<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="1894948">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1895003">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1895057">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1895108">package</span>&nbsp;<span class="ident" id="1895116">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1895122">/*<br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbspFloating-point&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function.<br>
<span class="lineno"></span>*/</span><br>
<span class="lineno">10</span><br>
<span class="lineno"></span><span class="comment" id="1895178">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code&nbsp;and&nbsp;the&nbsp;long&nbsp;comment&nbsp;below&nbsp;are</span><br>
<span class="lineno"></span><span class="comment" id="1895232">//&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/e_lgamma_r.c&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1895289">//&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno"></span><span class="comment" id="1895344">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">15</span><span class="comment" id="1895374">//</span><br>
<span class="lineno"></span><span class="comment" id="1895377">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1895433">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1895502">//</span><br>
<span class="lineno"></span><span class="comment" id="1895505">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno">20</span><span class="comment" id="1895564">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="1895620">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1895677">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1895694">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1895750">//</span><br>
<span class="lineno">25</span><span class="comment" id="1895753">//&nbsp;__ieee754_lgamma_r(x,&nbsp;signgamp)</span><br>
<span class="lineno"></span><span class="comment" id="1895788">//&nbsp;Reentrant&nbsp;version&nbsp;of&nbsp;the&nbsp;logarithm&nbsp;of&nbsp;the&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="1895848">//&nbsp;with&nbsp;user&nbsp;provided&nbsp;pointer&nbsp;for&nbsp;the&nbsp;sign&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="1895904">//</span><br>
<span class="lineno"></span><span class="comment" id="1895907">//&nbsp;Method:</span><br>
<span class="lineno">30</span><span class="comment" id="1895918">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;Reduction&nbsp;for&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;=&nbsp;8</span><br>
<span class="lineno"></span><span class="comment" id="1895960">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Since&nbsp;gamma(1+s)=s*gamma(s),&nbsp;for&nbsp;x&nbsp;in&nbsp;[0,8],&nbsp;we&nbsp;may</span><br>
<span class="lineno"></span><span class="comment" id="1896020">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;reduce&nbsp;x&nbsp;to&nbsp;a&nbsp;number&nbsp;in&nbsp;[1.5,2.5]&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1896065">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1+s)&nbsp;=&nbsp;log(s)&nbsp;+&nbsp;lgamma(s)</span><br>
<span class="lineno"></span><span class="comment" id="1896114">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;example,</span><br>
<span class="lineno">35</span><span class="comment" id="1896135">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(7.3)&nbsp;=&nbsp;log(6.3)&nbsp;+&nbsp;lgamma(6.3)</span><br>
<span class="lineno"></span><span class="comment" id="1896188">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3)&nbsp;+&nbsp;lgamma(5.3)</span><br>
<span class="lineno"></span><span class="comment" id="1896245">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(6.3*5.3*4.3*3.3*2.3)&nbsp;+&nbsp;lgamma(2.3)</span><br>
<span class="lineno"></span><span class="comment" id="1896314">//&nbsp;&nbsp;&nbsp;2.&nbsp;Polynomial&nbsp;approximation&nbsp;of&nbsp;lgamma&nbsp;around&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="1896368">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;minimum&nbsp;(ymin=1.461632144968362245)&nbsp;to&nbsp;maintain&nbsp;monotonicity.</span><br>
<span class="lineno">40</span><span class="comment" id="1896438">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;On&nbsp;[ymin-0.23,&nbsp;ymin+0.27]&nbsp;(i.e.,&nbsp;[1.23164,1.73163]),&nbsp;use</span><br>
<span class="lineno"></span><span class="comment" id="1896503">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;x-ymin;</span><br>
<span class="lineno"></span><span class="comment" id="1896535">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;-1.214862905358496078218&nbsp;+&nbsp;z**2*poly(z)</span><br>
<span class="lineno"></span><span class="comment" id="1896603">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;poly(z)&nbsp;is&nbsp;a&nbsp;14&nbsp;degree&nbsp;polynomial.</span><br>
<span class="lineno"></span><span class="comment" id="1896654">//&nbsp;&nbsp;&nbsp;2.&nbsp;Rational&nbsp;approximation&nbsp;in&nbsp;the&nbsp;primary&nbsp;interval&nbsp;[2,3]</span><br>
<span class="lineno">45</span><span class="comment" id="1896715">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;the&nbsp;following&nbsp;approximation:</span><br>
<span class="lineno"></span><span class="comment" id="1896759">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s&nbsp;=&nbsp;x-2.0;</span><br>
<span class="lineno"></span><span class="comment" id="1896786">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;0.5*s&nbsp;+&nbsp;s*P(s)/Q(s)</span><br>
<span class="lineno"></span><span class="comment" id="1896834">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;accuracy</span><br>
<span class="lineno"></span><span class="comment" id="1896856">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|P/Q&nbsp;-&nbsp;(lgamma(x)-0.5s)|&nbsp;&lt;&nbsp;2**-61.71</span><br>
<span class="lineno">50</span><span class="comment" id="1896909">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Our&nbsp;algorithms&nbsp;are&nbsp;based&nbsp;on&nbsp;the&nbsp;following&nbsp;observation</span><br>
<span class="lineno"></span><span class="comment" id="1896971">//</span><br>
<span class="lineno"></span><span class="comment" id="1896974">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zeta(2)-1&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;zeta(3)-1&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno"></span><span class="comment" id="1897038">//&nbsp;lgamma(2+s)&nbsp;=&nbsp;s*(1-Euler)&nbsp;+&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;-&nbsp;&nbsp;---------&nbsp;*&nbsp;s&nbsp;&nbsp;+&nbsp;...</span><br>
<span class="lineno"></span><span class="comment" id="1897108">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3</span><br>
<span class="lineno">55</span><span class="comment" id="1897163">//</span><br>
<span class="lineno"></span><span class="comment" id="1897166">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;Euler&nbsp;=&nbsp;0.5772156649...&nbsp;is&nbsp;the&nbsp;Euler&nbsp;constant,&nbsp;which</span><br>
<span class="lineno"></span><span class="comment" id="1897233">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;is&nbsp;very&nbsp;close&nbsp;to&nbsp;0.5.</span><br>
<span class="lineno"></span><span class="comment" id="1897263">//</span><br>
<span class="lineno"></span><span class="comment" id="1897266">//&nbsp;&nbsp;&nbsp;3.&nbsp;For&nbsp;x&gt;=8,&nbsp;we&nbsp;have</span><br>
<span class="lineno">60</span><span class="comment" id="1897292">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)log(x)-x+0.5*log(2pi)+1/(12x)-1/(360x**3)+....</span><br>
<span class="lineno"></span><span class="comment" id="1897364">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(better&nbsp;formula:</span><br>
<span class="lineno"></span><span class="comment" id="1897389">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)~(x-0.5)*(log(x)-1)-.5*(log(2pi)-1)&nbsp;+&nbsp;...)</span><br>
<span class="lineno"></span><span class="comment" id="1897452">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;z&nbsp;=&nbsp;1/x,&nbsp;then&nbsp;we&nbsp;approximation</span><br>
<span class="lineno"></span><span class="comment" id="1897495">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;f(z)&nbsp;=&nbsp;lgamma(x)&nbsp;-&nbsp;(x-0.5)(log(x)-1)</span><br>
<span class="lineno">65</span><span class="comment" id="1897548">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1897559">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;11</span><br>
<span class="lineno"></span><span class="comment" id="1897620">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;w&nbsp;=&nbsp;w0&nbsp;+&nbsp;w1*z&nbsp;+&nbsp;w2*z&nbsp;&nbsp;+&nbsp;w3*z&nbsp;&nbsp;+&nbsp;...&nbsp;+&nbsp;w6*z</span><br>
<span class="lineno"></span><span class="comment" id="1897679">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where</span><br>
<span class="lineno"></span><span class="comment" id="1897693">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|w&nbsp;-&nbsp;f(z)|&nbsp;&lt;&nbsp;2**-58.74</span><br>
<span class="lineno">70</span><span class="comment" id="1897732">//</span><br>
<span class="lineno"></span><span class="comment" id="1897735">//&nbsp;&nbsp;&nbsp;4.&nbsp;For&nbsp;negative&nbsp;x,&nbsp;since&nbsp;(G&nbsp;is&nbsp;gamma&nbsp;function)</span><br>
<span class="lineno"></span><span class="comment" id="1897787">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-x*G(-x)*G(x)&nbsp;=&nbsp;pi/sin(pi*x),</span><br>
<span class="lineno"></span><span class="comment" id="1897833">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;we&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="1897849">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;G(x)&nbsp;=&nbsp;pi/(sin(pi*x)*(-x)*G(-x))</span><br>
<span class="lineno">75</span><span class="comment" id="1897898">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;since&nbsp;G(-x)&nbsp;is&nbsp;positive,&nbsp;sign(G(x))&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;for&nbsp;x&lt;0</span><br>
<span class="lineno"></span><span class="comment" id="1897968">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hence,&nbsp;for&nbsp;x&lt;0,&nbsp;signgam&nbsp;=&nbsp;sign(sin(pi*x))&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1898022">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;=&nbsp;log(|Gamma(x)|)</span><br>
<span class="lineno"></span><span class="comment" id="1898066">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;log(pi/(|x*sin(pi*x)|))&nbsp;-&nbsp;lgamma(-x);</span><br>
<span class="lineno"></span><span class="comment" id="1898132">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;one&nbsp;should&nbsp;avoid&nbsp;computing&nbsp;pi*(-x)&nbsp;directly&nbsp;in&nbsp;the</span><br>
<span class="lineno">80</span><span class="comment" id="1898197">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;computation&nbsp;of&nbsp;sin(pi*(-x)).</span><br>
<span class="lineno"></span><span class="comment" id="1898240">//</span><br>
<span class="lineno"></span><span class="comment" id="1898243">//&nbsp;&nbsp;&nbsp;5.&nbsp;Special&nbsp;Cases</span><br>
<span class="lineno"></span><span class="comment" id="1898265">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(2+s)&nbsp;~&nbsp;s*(1-Euler)&nbsp;for&nbsp;tiny&nbsp;s</span><br>
<span class="lineno"></span><span class="comment" id="1898318">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(1)=lgamma(2)=0</span><br>
<span class="lineno">85</span><span class="comment" id="1898356">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(x)&nbsp;~&nbsp;-log(x)&nbsp;for&nbsp;tiny&nbsp;x</span><br>
<span class="lineno"></span><span class="comment" id="1898403">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(0)&nbsp;=&nbsp;lgamma(inf)&nbsp;=&nbsp;inf</span><br>
<span class="lineno"></span><span class="comment" id="1898449">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lgamma(-integer)&nbsp;=&nbsp;+-inf</span><br>
<span class="lineno"></span><span class="comment" id="1898490">//</span><br>
<span class="lineno"></span><span class="comment" id="1898493">//</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="keyword" id="1898497">var</span>&nbsp;<span class="ident" id="1898501">_lgamA</span>&nbsp;<span class="op" id="1898508">=</span>&nbsp;<span class="op" id="1898510">[</span><span class="op" id="1898511">...</span><span class="op" id="1898514">]</span><span class="builtintype" id="1898515">float64</span><span class="op" id="1898522">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1898525">7.72156649015328655494e-02</span><span class="op" id="1898551">,</span>&nbsp;<span class="comment" id="1898553">//&nbsp;0x3FB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1898576">3.22467033424113591611e-01</span><span class="op" id="1898602">,</span>&nbsp;<span class="comment" id="1898604">//&nbsp;0x3FD4A34CC4A60FAD</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1898627">6.73523010531292681824e-02</span><span class="op" id="1898653">,</span>&nbsp;<span class="comment" id="1898655">//&nbsp;0x3FB13E001A5562A7</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1898678">2.05808084325167332806e-02</span><span class="op" id="1898704">,</span>&nbsp;<span class="comment" id="1898706">//&nbsp;0x3F951322AC92547B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1898729">7.38555086081402883957e-03</span><span class="op" id="1898755">,</span>&nbsp;<span class="comment" id="1898757">//&nbsp;0x3F7E404FB68FEFE8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1898780">2.89051383673415629091e-03</span><span class="op" id="1898806">,</span>&nbsp;<span class="comment" id="1898808">//&nbsp;0x3F67ADD8CCB7926B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1898831">1.19270763183362067845e-03</span><span class="op" id="1898857">,</span>&nbsp;<span class="comment" id="1898859">//&nbsp;0x3F538A94116F3F5D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1898882">5.10069792153511336608e-04</span><span class="op" id="1898908">,</span>&nbsp;<span class="comment" id="1898910">//&nbsp;0x3F40B6C689B99C00</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1898933">2.20862790713908385557e-04</span><span class="op" id="1898959">,</span>&nbsp;<span class="comment" id="1898961">//&nbsp;0x3F2CF2ECED10E54D</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1898984">1.08011567247583939954e-04</span><span class="op" id="1899010">,</span>&nbsp;<span class="comment" id="1899012">//&nbsp;0x3F1C5088987DFB07</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1899035">2.52144565451257326939e-05</span><span class="op" id="1899061">,</span>&nbsp;<span class="comment" id="1899063">//&nbsp;0x3EFA7074428CFA52</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1899086">4.48640949618915160150e-05</span><span class="op" id="1899112">,</span>&nbsp;<span class="comment" id="1899114">//&nbsp;0x3F07858E90A45837</span><br>
<span class="lineno"></span><span class="op" id="1899136">}</span><br>
<span class="lineno">105</span><span class="keyword" id="1899138">var</span>&nbsp;<span class="ident" id="1899142">_lgamR</span>&nbsp;<span class="op" id="1899149">=</span>&nbsp;<span class="op" id="1899151">[</span><span class="op" id="1899152">...</span><span class="op" id="1899155">]</span><span class="builtintype" id="1899156">float64</span><span class="op" id="1899163">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1899166">1.0</span><span class="op" id="1899169">,</span>&nbsp;<span class="comment" id="1899171">//&nbsp;placeholder</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1899187">1.39200533467621045958e+00</span><span class="op" id="1899213">,</span>&nbsp;<span class="comment" id="1899215">//&nbsp;0x3FF645A762C4AB74</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1899238">7.21935547567138069525e-01</span><span class="op" id="1899264">,</span>&nbsp;<span class="comment" id="1899266">//&nbsp;0x3FE71A1893D3DCDC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1899289">1.71933865632803078993e-01</span><span class="op" id="1899315">,</span>&nbsp;<span class="comment" id="1899317">//&nbsp;0x3FC601EDCCFBDF27</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1899340">1.86459191715652901344e-02</span><span class="op" id="1899366">,</span>&nbsp;<span class="comment" id="1899368">//&nbsp;0x3F9317EA742ED475</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1899391">7.77942496381893596434e-04</span><span class="op" id="1899417">,</span>&nbsp;<span class="comment" id="1899419">//&nbsp;0x3F497DDACA41A95B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1899442">7.32668430744625636189e-06</span><span class="op" id="1899468">,</span>&nbsp;<span class="comment" id="1899470">//&nbsp;0x3EDEBAF7A5B38140</span><br>
<span class="lineno"></span><span class="op" id="1899492">}</span><br>
<span class="lineno"></span><span class="keyword" id="1899494">var</span>&nbsp;<span class="ident" id="1899498">_lgamS</span>&nbsp;<span class="op" id="1899505">=</span>&nbsp;<span class="op" id="1899507">[</span><span class="op" id="1899508">...</span><span class="op" id="1899511">]</span><span class="builtintype" id="1899512">float64</span><span class="op" id="1899519">{</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1899522">-</span><span class="num" id="1899523">7.72156649015328655494e-02</span><span class="op" id="1899549">,</span>&nbsp;<span class="comment" id="1899551">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1899574">2.14982415960608852501e-01</span><span class="op" id="1899600">,</span>&nbsp;&nbsp;<span class="comment" id="1899603">//&nbsp;0x3FCB848B36E20878</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1899626">3.25778796408930981787e-01</span><span class="op" id="1899652">,</span>&nbsp;&nbsp;<span class="comment" id="1899655">//&nbsp;0x3FD4D98F4F139F59</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1899678">1.46350472652464452805e-01</span><span class="op" id="1899704">,</span>&nbsp;&nbsp;<span class="comment" id="1899707">//&nbsp;0x3FC2BB9CBEE5F2F7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1899730">2.66422703033638609560e-02</span><span class="op" id="1899756">,</span>&nbsp;&nbsp;<span class="comment" id="1899759">//&nbsp;0x3F9B481C7E939961</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1899782">1.84028451407337715652e-03</span><span class="op" id="1899808">,</span>&nbsp;&nbsp;<span class="comment" id="1899811">//&nbsp;0x3F5E26B67368F239</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1899834">3.19475326584100867617e-05</span><span class="op" id="1899860">,</span>&nbsp;&nbsp;<span class="comment" id="1899863">//&nbsp;0x3F00BFECDD17E945</span><br>
<span class="lineno"></span><span class="op" id="1899885">}</span><br>
<span class="lineno"></span><span class="keyword" id="1899887">var</span>&nbsp;<span class="ident" id="1899891">_lgamT</span>&nbsp;<span class="op" id="1899898">=</span>&nbsp;<span class="op" id="1899900">[</span><span class="op" id="1899901">...</span><span class="op" id="1899904">]</span><span class="builtintype" id="1899905">float64</span><span class="op" id="1899912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1899915">4.83836122723810047042e-01</span><span class="op" id="1899941">,</span>&nbsp;&nbsp;<span class="comment" id="1899944">//&nbsp;0x3FDEF72BC8EE38A2</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1899967">-</span><span class="num" id="1899968">1.47587722994593911752e-01</span><span class="op" id="1899994">,</span>&nbsp;<span class="comment" id="1899996">//&nbsp;0xBFC2E4278DC6C509</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1900019">6.46249402391333854778e-02</span><span class="op" id="1900045">,</span>&nbsp;&nbsp;<span class="comment" id="1900048">//&nbsp;0x3FB08B4294D5419B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1900071">-</span><span class="num" id="1900072">3.27885410759859649565e-02</span><span class="op" id="1900098">,</span>&nbsp;<span class="comment" id="1900100">//&nbsp;0xBFA0C9A8DF35B713</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1900123">1.79706750811820387126e-02</span><span class="op" id="1900149">,</span>&nbsp;&nbsp;<span class="comment" id="1900152">//&nbsp;0x3F9266E7970AF9EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1900175">-</span><span class="num" id="1900176">1.03142241298341437450e-02</span><span class="op" id="1900202">,</span>&nbsp;<span class="comment" id="1900204">//&nbsp;0xBF851F9FBA91EC6A</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1900227">6.10053870246291332635e-03</span><span class="op" id="1900253">,</span>&nbsp;&nbsp;<span class="comment" id="1900256">//&nbsp;0x3F78FCE0E370E344</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1900279">-</span><span class="num" id="1900280">3.68452016781138256760e-03</span><span class="op" id="1900306">,</span>&nbsp;<span class="comment" id="1900308">//&nbsp;0xBF6E2EFFB3E914D7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1900331">2.25964780900612472250e-03</span><span class="op" id="1900357">,</span>&nbsp;&nbsp;<span class="comment" id="1900360">//&nbsp;0x3F6282D32E15C915</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1900383">-</span><span class="num" id="1900384">1.40346469989232843813e-03</span><span class="op" id="1900410">,</span>&nbsp;<span class="comment" id="1900412">//&nbsp;0xBF56FE8EBF2D1AF1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1900435">8.81081882437654011382e-04</span><span class="op" id="1900461">,</span>&nbsp;&nbsp;<span class="comment" id="1900464">//&nbsp;0x3F4CDF0CEF61A8E9</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1900487">-</span><span class="num" id="1900488">5.38595305356740546715e-04</span><span class="op" id="1900514">,</span>&nbsp;<span class="comment" id="1900516">//&nbsp;0xBF41A6109C73E0EC</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1900539">3.15632070903625950361e-04</span><span class="op" id="1900565">,</span>&nbsp;&nbsp;<span class="comment" id="1900568">//&nbsp;0x3F34AF6D6C0EBBF7</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1900591">-</span><span class="num" id="1900592">3.12754168375120860518e-04</span><span class="op" id="1900618">,</span>&nbsp;<span class="comment" id="1900620">//&nbsp;0xBF347F24ECC38C38</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1900643">3.35529192635519073543e-04</span><span class="op" id="1900669">,</span>&nbsp;&nbsp;<span class="comment" id="1900672">//&nbsp;0x3F35FD3EE8C2D3F4</span><br>
<span class="lineno"></span><span class="op" id="1900694">}</span><br>
<span class="lineno">140</span><span class="keyword" id="1900696">var</span>&nbsp;<span class="ident" id="1900700">_lgamU</span>&nbsp;<span class="op" id="1900707">=</span>&nbsp;<span class="op" id="1900709">[</span><span class="op" id="1900710">...</span><span class="op" id="1900713">]</span><span class="builtintype" id="1900714">float64</span><span class="op" id="1900721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1900724">-</span><span class="num" id="1900725">7.72156649015328655494e-02</span><span class="op" id="1900751">,</span>&nbsp;<span class="comment" id="1900753">//&nbsp;0xBFB3C467E37DB0C8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1900776">6.32827064025093366517e-01</span><span class="op" id="1900802">,</span>&nbsp;&nbsp;<span class="comment" id="1900805">//&nbsp;0x3FE4401E8B005DFF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1900828">1.45492250137234768737e+00</span><span class="op" id="1900854">,</span>&nbsp;&nbsp;<span class="comment" id="1900857">//&nbsp;0x3FF7475CD119BD6F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1900880">9.77717527963372745603e-01</span><span class="op" id="1900906">,</span>&nbsp;&nbsp;<span class="comment" id="1900909">//&nbsp;0x3FEF497644EA8450</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1900932">2.28963728064692451092e-01</span><span class="op" id="1900958">,</span>&nbsp;&nbsp;<span class="comment" id="1900961">//&nbsp;0x3FCD4EAEF6010924</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1900984">1.33810918536787660377e-02</span><span class="op" id="1901010">,</span>&nbsp;&nbsp;<span class="comment" id="1901013">//&nbsp;0x3F8B678BBF2BAB09</span><br>
<span class="lineno"></span><span class="op" id="1901035">}</span><br>
<span class="lineno"></span><span class="keyword" id="1901037">var</span>&nbsp;<span class="ident" id="1901041">_lgamV</span>&nbsp;<span class="op" id="1901048">=</span>&nbsp;<span class="op" id="1901050">[</span><span class="op" id="1901051">...</span><span class="op" id="1901054">]</span><span class="builtintype" id="1901055">float64</span><span class="op" id="1901062">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1901065">1.0</span><span class="op" id="1901068">,</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1901071">2.45597793713041134822e+00</span><span class="op" id="1901097">,</span>&nbsp;<span class="comment" id="1901099">//&nbsp;0x4003A5D7C2BD619C</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1901122">2.12848976379893395361e+00</span><span class="op" id="1901148">,</span>&nbsp;<span class="comment" id="1901150">//&nbsp;0x40010725A42B18F5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1901173">7.69285150456672783825e-01</span><span class="op" id="1901199">,</span>&nbsp;<span class="comment" id="1901201">//&nbsp;0x3FE89DFBE45050AF</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1901224">1.04222645593369134254e-01</span><span class="op" id="1901250">,</span>&nbsp;<span class="comment" id="1901252">//&nbsp;0x3FBAAE55D6537C88</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1901275">3.21709242282423911810e-03</span><span class="op" id="1901301">,</span>&nbsp;<span class="comment" id="1901303">//&nbsp;0x3F6A5ABB57D0CF61</span><br>
<span class="lineno">155</span><span class="op" id="1901325">}</span><br>
<span class="lineno"></span><span class="keyword" id="1901327">var</span>&nbsp;<span class="ident" id="1901331">_lgamW</span>&nbsp;<span class="op" id="1901338">=</span>&nbsp;<span class="op" id="1901340">[</span><span class="op" id="1901341">...</span><span class="op" id="1901344">]</span><span class="builtintype" id="1901345">float64</span><span class="op" id="1901352">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1901355">4.18938533204672725052e-01</span><span class="op" id="1901381">,</span>&nbsp;&nbsp;<span class="comment" id="1901384">//&nbsp;0x3FDACFE390C97D69</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1901407">8.33333333333329678849e-02</span><span class="op" id="1901433">,</span>&nbsp;&nbsp;<span class="comment" id="1901436">//&nbsp;0x3FB555555555553B</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1901459">-</span><span class="num" id="1901460">2.77777777728775536470e-03</span><span class="op" id="1901486">,</span>&nbsp;<span class="comment" id="1901488">//&nbsp;0xBF66C16C16B02E5C</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1901511">7.93650558643019558500e-04</span><span class="op" id="1901537">,</span>&nbsp;&nbsp;<span class="comment" id="1901540">//&nbsp;0x3F4A019F98CF38B6</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1901563">-</span><span class="num" id="1901564">5.95187557450339963135e-04</span><span class="op" id="1901590">,</span>&nbsp;<span class="comment" id="1901592">//&nbsp;0xBF4380CB8C0FE741</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="num" id="1901615">8.36339918996282139126e-04</span><span class="op" id="1901641">,</span>&nbsp;&nbsp;<span class="comment" id="1901644">//&nbsp;0x3F4B67BA4CDAD5D1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1901667">-</span><span class="num" id="1901668">1.63092934096575273989e-03</span><span class="op" id="1901694">,</span>&nbsp;<span class="comment" id="1901696">//&nbsp;0xBF5AB89D0B9E43E4</span><br>
<span class="lineno"></span><span class="op" id="1901718">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="comment" id="1901721">//&nbsp;Lgamma&nbsp;returns&nbsp;the&nbsp;natural&nbsp;logarithm&nbsp;and&nbsp;sign&nbsp;(-1&nbsp;or&nbsp;+1)&nbsp;of&nbsp;Gamma(x).</span><br>
<span class="lineno"></span><span class="comment" id="1901794">//</span><br>
<span class="lineno"></span><span class="comment" id="1901797">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="1901819">//&nbsp;&nbsp;&nbsp;&nbspLgamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno">170</span><span class="comment" id="1901842">//&nbsp;&nbsp;&nbsp;&nbspLgamma(0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="1901862">//&nbsp;&nbsp;&nbsp;&nbspLgamma(-integer)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="1901889">//&nbsp;&nbsp;&nbsp;&nbspLgamma(-Inf)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="1901912">//&nbsp;&nbsp;&nbsp;&nbspLgamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="1901933">func</span>&nbsp;<span class="ident" id="1901938">Lgamma</span><span class="op" id="1901944">(</span><span class="ident" id="1901945">x</span>&nbsp;<span class="builtintype" id="1901947">float64</span><span class="op" id="1901954">)</span>&nbsp;<span class="op" id="1901956">(</span><span class="ident" id="1901957">lgamma</span>&nbsp;<span class="builtintype" id="1901964">float64</span><span class="op" id="1901971">,</span>&nbsp;<span class="ident" id="1901973">sign</span>&nbsp;<span class="builtintype" id="1901978">int</span><span class="op" id="1901981">)</span>&nbsp;<span class="op" id="1901983">{</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1901986">const</span>&nbsp;<span class="op" id="1901992">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1901996">Ymin</span>&nbsp;&nbsp;<span class="op" id="1902002">=</span>&nbsp;<span class="num" id="1902004">1.461632144968362245</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1902027">Two52</span>&nbsp;<span class="op" id="1902033">=</span>&nbsp;<span class="num" id="1902035">1</span>&nbsp;<span class="op" id="1902037">&lt;&lt;</span>&nbsp;<span class="num" id="1902040">52</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1902063">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1902099">Two53</span>&nbsp;<span class="op" id="1902105">=</span>&nbsp;<span class="num" id="1902107">1</span>&nbsp;<span class="op" id="1902109">&lt;&lt;</span>&nbsp;<span class="num" id="1902112">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1902135">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1902171">Two58</span>&nbsp;<span class="op" id="1902177">=</span>&nbsp;<span class="num" id="1902179">1</span>&nbsp;<span class="op" id="1902181">&lt;&lt;</span>&nbsp;<span class="num" id="1902184">58</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1902207">//&nbsp;0x4390000000000000&nbsp;~2.8823e+17</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1902243">Tiny</span>&nbsp;&nbsp;<span class="op" id="1902249">=</span>&nbsp;<span class="num" id="1902251">1.0</span>&nbsp;<span class="op" id="1902255">/</span>&nbsp;<span class="op" id="1902257">(</span><span class="num" id="1902258">1</span>&nbsp;<span class="op" id="1902260">&lt;&lt;</span>&nbsp;<span class="num" id="1902263">70</span><span class="op" id="1902265">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1902279">//&nbsp;0x3b90000000000000&nbsp;~8.47033e-22</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1902316">Tc</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1902322">=</span>&nbsp;<span class="num" id="1902324">1.46163214496836224576e+00</span>&nbsp;&nbsp;<span class="comment" id="1902352">//&nbsp;0x3FF762D86356BE3F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1902376">Tf</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1902382">=</span>&nbsp;<span class="op" id="1902384">-</span><span class="num" id="1902385">1.21486290535849611461e-01</span>&nbsp;<span class="comment" id="1902412">//&nbsp;0xBFBF19B9BCC38A42</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1902436">//&nbsp;Tt&nbsp;=&nbsp;-(tail&nbsp;of&nbsp;Tf)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1902460">Tt</span>&nbsp;<span class="op" id="1902463">=</span>&nbsp;<span class="op" id="1902465">-</span><span class="num" id="1902466">3.63867699703950536541e-18</span>&nbsp;<span class="comment" id="1902493">//&nbsp;0xBC50C7CAA48A971F</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1902516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1902519">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1902537">sign</span>&nbsp;<span class="op" id="1902542">=</span>&nbsp;<span class="num" id="1902544">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1902547">switch</span>&nbsp;<span class="op" id="1902554">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1902557">case</span>&nbsp;<span class="ident" id="1902562">IsNaN</span><span class="op" id="1902567">(</span><span class="ident" id="1902568">x</span><span class="op" id="1902569">)</span><span class="op" id="1902570">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1902574">lgamma</span>&nbsp;<span class="op" id="1902581">=</span>&nbsp;<span class="ident" id="1902583">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1902587">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1902595">case</span>&nbsp;<span class="ident" id="1902600">IsInf</span><span class="op" id="1902605">(</span><span class="ident" id="1902606">x</span><span class="op" id="1902607">,</span>&nbsp;<span class="num" id="1902609">0</span><span class="op" id="1902610">)</span><span class="op" id="1902611">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1902615">lgamma</span>&nbsp;<span class="op" id="1902622">=</span>&nbsp;<span class="ident" id="1902624">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1902628">return</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1902636">case</span>&nbsp;<span class="ident" id="1902641">x</span>&nbsp;<span class="op" id="1902643">==</span>&nbsp;<span class="num" id="1902646">0</span><span class="op" id="1902647">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1902651">lgamma</span>&nbsp;<span class="op" id="1902658">=</span>&nbsp;<span class="ident" id="1902660">Inf</span><span class="op" id="1902663">(</span><span class="num" id="1902664">1</span><span class="op" id="1902665">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1902669">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1902677">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1902681">neg</span>&nbsp;<span class="op" id="1902685">:=</span>&nbsp;<span class="builtintype" id="1902688">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1902695">if</span>&nbsp;<span class="ident" id="1902698">x</span>&nbsp;<span class="op" id="1902700">&lt;</span>&nbsp;<span class="num" id="1902702">0</span>&nbsp;<span class="op" id="1902704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1902708">x</span>&nbsp;<span class="op" id="1902710">=</span>&nbsp;<span class="op" id="1902712">-</span><span class="ident" id="1902713">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1902717">neg</span>&nbsp;<span class="op" id="1902721">=</span>&nbsp;<span class="builtintype" id="1902723">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1902729">}</span><br>
<span class="lineno">205</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1902733">if</span>&nbsp;<span class="ident" id="1902736">x</span>&nbsp;<span class="op" id="1902738">&lt;</span>&nbsp;<span class="ident" id="1902740">Tiny</span>&nbsp;<span class="op" id="1902745">{</span>&nbsp;<span class="comment" id="1902747">//&nbsp;if&nbsp;|x|&nbsp;&lt;&nbsp;2**-70,&nbsp;return&nbsp;-log(|x|)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1902786">if</span>&nbsp;<span class="ident" id="1902789">neg</span>&nbsp;<span class="op" id="1902793">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1902798">sign</span>&nbsp;<span class="op" id="1902803">=</span>&nbsp;<span class="op" id="1902805">-</span><span class="num" id="1902806">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1902810">}</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1902814">lgamma</span>&nbsp;<span class="op" id="1902821">=</span>&nbsp;<span class="op" id="1902823">-</span><span class="ident" id="1902824">Log</span><span class="op" id="1902827">(</span><span class="ident" id="1902828">x</span><span class="op" id="1902829">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1902833">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1902841">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1902844">var</span>&nbsp;<span class="ident" id="1902848">nadj</span>&nbsp;<span class="builtintype" id="1902853">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1902862">if</span>&nbsp;<span class="ident" id="1902865">neg</span>&nbsp;<span class="op" id="1902869">{</span><br>
<span class="lineno">215</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1902873">if</span>&nbsp;<span class="ident" id="1902876">x</span>&nbsp;<span class="op" id="1902878">&gt;=</span>&nbsp;<span class="ident" id="1902881">Two52</span>&nbsp;<span class="op" id="1902887">{</span>&nbsp;<span class="comment" id="1902889">//&nbsp;|x|&nbsp;&gt;=&nbsp;2**52,&nbsp;must&nbsp;be&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1902926">lgamma</span>&nbsp;<span class="op" id="1902933">=</span>&nbsp;<span class="ident" id="1902935">Inf</span><span class="op" id="1902938">(</span><span class="num" id="1902939">1</span><span class="op" id="1902940">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1902945">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1902954">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1902958">t</span>&nbsp;<span class="op" id="1902960">:=</span>&nbsp;<span class="ident" id="1902963">sinPi</span><span class="op" id="1902968">(</span><span class="ident" id="1902969">x</span><span class="op" id="1902970">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1902974">if</span>&nbsp;<span class="ident" id="1902977">t</span>&nbsp;<span class="op" id="1902979">==</span>&nbsp;<span class="num" id="1902982">0</span>&nbsp;<span class="op" id="1902984">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1902989">lgamma</span>&nbsp;<span class="op" id="1902996">=</span>&nbsp;<span class="ident" id="1902998">Inf</span><span class="op" id="1903001">(</span><span class="num" id="1903002">1</span><span class="op" id="1903003">)</span>&nbsp;<span class="comment" id="1903005">//&nbsp;-integer</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1903020">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1903029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903033">nadj</span>&nbsp;<span class="op" id="1903038">=</span>&nbsp;<span class="ident" id="1903040">Log</span><span class="op" id="1903043">(</span><span class="ident" id="1903044">Pi</span>&nbsp;<span class="op" id="1903047">/</span>&nbsp;<span class="ident" id="1903049">Abs</span><span class="op" id="1903052">(</span><span class="ident" id="1903053">t</span><span class="op" id="1903054">*</span><span class="ident" id="1903055">x</span><span class="op" id="1903056">)</span><span class="op" id="1903057">)</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1903061">if</span>&nbsp;<span class="ident" id="1903064">t</span>&nbsp;<span class="op" id="1903066">&lt;</span>&nbsp;<span class="num" id="1903068">0</span>&nbsp;<span class="op" id="1903070">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903075">sign</span>&nbsp;<span class="op" id="1903080">=</span>&nbsp;<span class="op" id="1903082">-</span><span class="num" id="1903083">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1903087">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1903090">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1903094">switch</span>&nbsp;<span class="op" id="1903101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1903104">case</span>&nbsp;<span class="ident" id="1903109">x</span>&nbsp;<span class="op" id="1903111">==</span>&nbsp;<span class="num" id="1903114">1</span>&nbsp;<span class="op" id="1903116">||</span>&nbsp;<span class="ident" id="1903119">x</span>&nbsp;<span class="op" id="1903121">==</span>&nbsp;<span class="num" id="1903124">2</span><span class="op" id="1903125">:</span>&nbsp;<span class="comment" id="1903127">//&nbsp;purge&nbsp;off&nbsp;1&nbsp;and&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903150">lgamma</span>&nbsp;<span class="op" id="1903157">=</span>&nbsp;<span class="num" id="1903159">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1903163">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1903171">case</span>&nbsp;<span class="ident" id="1903176">x</span>&nbsp;<span class="op" id="1903178">&lt;</span>&nbsp;<span class="num" id="1903180">2</span><span class="op" id="1903181">:</span>&nbsp;<span class="comment" id="1903183">//&nbsp;use&nbsp;lgamma(x)&nbsp;=&nbsp;lgamma(x+1)&nbsp;-&nbsp;log(x)</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1903225">var</span>&nbsp;<span class="ident" id="1903229">y</span>&nbsp;<span class="builtintype" id="1903231">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1903241">var</span>&nbsp;<span class="ident" id="1903245">i</span>&nbsp;<span class="builtintype" id="1903247">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1903253">if</span>&nbsp;<span class="ident" id="1903256">x</span>&nbsp;<span class="op" id="1903258">&lt;=</span>&nbsp;<span class="num" id="1903261">0.9</span>&nbsp;<span class="op" id="1903265">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903270">lgamma</span>&nbsp;<span class="op" id="1903277">=</span>&nbsp;<span class="op" id="1903279">-</span><span class="ident" id="1903280">Log</span><span class="op" id="1903283">(</span><span class="ident" id="1903284">x</span><span class="op" id="1903285">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1903290">switch</span>&nbsp;<span class="op" id="1903297">{</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1903302">case</span>&nbsp;<span class="ident" id="1903307">x</span>&nbsp;<span class="op" id="1903309">&gt;=</span>&nbsp;<span class="op" id="1903312">(</span><span class="ident" id="1903313">Ymin</span>&nbsp;<span class="op" id="1903318">-</span>&nbsp;<span class="num" id="1903320">1</span>&nbsp;<span class="op" id="1903322">+</span>&nbsp;<span class="num" id="1903324">0.27</span><span class="op" id="1903328">)</span><span class="op" id="1903329">:</span>&nbsp;<span class="comment" id="1903331">//&nbsp;0.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;&nbsp;0.9</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903358">y</span>&nbsp;<span class="op" id="1903360">=</span>&nbsp;<span class="num" id="1903362">1</span>&nbsp;<span class="op" id="1903364">-</span>&nbsp;<span class="ident" id="1903366">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903372">i</span>&nbsp;<span class="op" id="1903374">=</span>&nbsp;<span class="num" id="1903376">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1903381">case</span>&nbsp;<span class="ident" id="1903386">x</span>&nbsp;<span class="op" id="1903388">&gt;=</span>&nbsp;<span class="op" id="1903391">(</span><span class="ident" id="1903392">Ymin</span>&nbsp;<span class="op" id="1903397">-</span>&nbsp;<span class="num" id="1903399">1</span>&nbsp;<span class="op" id="1903401">-</span>&nbsp;<span class="num" id="1903403">0.27</span><span class="op" id="1903407">)</span><span class="op" id="1903408">:</span>&nbsp;<span class="comment" id="1903410">//&nbsp;0.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;0.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903438">y</span>&nbsp;<span class="op" id="1903440">=</span>&nbsp;<span class="ident" id="1903442">x</span>&nbsp;<span class="op" id="1903444">-</span>&nbsp;<span class="op" id="1903446">(</span><span class="ident" id="1903447">Tc</span>&nbsp;<span class="op" id="1903450">-</span>&nbsp;<span class="num" id="1903452">1</span><span class="op" id="1903453">)</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903459">i</span>&nbsp;<span class="op" id="1903461">=</span>&nbsp;<span class="num" id="1903463">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1903468">default</span><span class="op" id="1903475">:</span>&nbsp;<span class="comment" id="1903477">//&nbsp;0&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;0.2316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903499">y</span>&nbsp;<span class="op" id="1903501">=</span>&nbsp;<span class="ident" id="1903503">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903509">i</span>&nbsp;<span class="op" id="1903511">=</span>&nbsp;<span class="num" id="1903513">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1903518">}</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1903522">}</span>&nbsp;<span class="keyword" id="1903524">else</span>&nbsp;<span class="op" id="1903529">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903534">lgamma</span>&nbsp;<span class="op" id="1903541">=</span>&nbsp;<span class="num" id="1903543">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1903548">switch</span>&nbsp;<span class="op" id="1903555">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1903560">case</span>&nbsp;<span class="ident" id="1903565">x</span>&nbsp;<span class="op" id="1903567">&gt;=</span>&nbsp;<span class="op" id="1903570">(</span><span class="ident" id="1903571">Ymin</span>&nbsp;<span class="op" id="1903576">+</span>&nbsp;<span class="num" id="1903578">0.27</span><span class="op" id="1903582">)</span><span class="op" id="1903583">:</span>&nbsp;<span class="comment" id="1903585">//&nbsp;1.7316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903608">y</span>&nbsp;<span class="op" id="1903610">=</span>&nbsp;<span class="num" id="1903612">2</span>&nbsp;<span class="op" id="1903614">-</span>&nbsp;<span class="ident" id="1903616">x</span><br>
<span class="lineno">255</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903622">i</span>&nbsp;<span class="op" id="1903624">=</span>&nbsp;<span class="num" id="1903626">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1903631">case</span>&nbsp;<span class="ident" id="1903636">x</span>&nbsp;<span class="op" id="1903638">&gt;=</span>&nbsp;<span class="op" id="1903641">(</span><span class="ident" id="1903642">Ymin</span>&nbsp;<span class="op" id="1903647">-</span>&nbsp;<span class="num" id="1903649">0.27</span><span class="op" id="1903653">)</span><span class="op" id="1903654">:</span>&nbsp;<span class="comment" id="1903656">//&nbsp;1.2316&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;1.7316</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903684">y</span>&nbsp;<span class="op" id="1903686">=</span>&nbsp;<span class="ident" id="1903688">x</span>&nbsp;<span class="op" id="1903690">-</span>&nbsp;<span class="ident" id="1903692">Tc</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903699">i</span>&nbsp;<span class="op" id="1903701">=</span>&nbsp;<span class="num" id="1903703">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1903708">default</span><span class="op" id="1903715">:</span>&nbsp;<span class="comment" id="1903717">//&nbsp;0.9&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;1.2316</span><br>
<span class="lineno">260</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903741">y</span>&nbsp;<span class="op" id="1903743">=</span>&nbsp;<span class="ident" id="1903745">x</span>&nbsp;<span class="op" id="1903747">-</span>&nbsp;<span class="num" id="1903749">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903755">i</span>&nbsp;<span class="op" id="1903757">=</span>&nbsp;<span class="num" id="1903759">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1903764">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1903768">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1903772">switch</span>&nbsp;<span class="ident" id="1903779">i</span>&nbsp;<span class="op" id="1903781">{</span><br>
<span class="lineno">265</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1903785">case</span>&nbsp;<span class="num" id="1903790">0</span><span class="op" id="1903791">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903796">z</span>&nbsp;<span class="op" id="1903798">:=</span>&nbsp;<span class="ident" id="1903801">y</span>&nbsp;<span class="op" id="1903803">*</span>&nbsp;<span class="ident" id="1903805">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903810">p1</span>&nbsp;<span class="op" id="1903813">:=</span>&nbsp;<span class="ident" id="1903816">_lgamA</span><span class="op" id="1903822">[</span><span class="num" id="1903823">0</span><span class="op" id="1903824">]</span>&nbsp;<span class="op" id="1903826">+</span>&nbsp;<span class="ident" id="1903828">z</span><span class="op" id="1903829">*</span><span class="op" id="1903830">(</span><span class="ident" id="1903831">_lgamA</span><span class="op" id="1903837">[</span><span class="num" id="1903838">2</span><span class="op" id="1903839">]</span><span class="op" id="1903840">+</span><span class="ident" id="1903841">z</span><span class="op" id="1903842">*</span><span class="op" id="1903843">(</span><span class="ident" id="1903844">_lgamA</span><span class="op" id="1903850">[</span><span class="num" id="1903851">4</span><span class="op" id="1903852">]</span><span class="op" id="1903853">+</span><span class="ident" id="1903854">z</span><span class="op" id="1903855">*</span><span class="op" id="1903856">(</span><span class="ident" id="1903857">_lgamA</span><span class="op" id="1903863">[</span><span class="num" id="1903864">6</span><span class="op" id="1903865">]</span><span class="op" id="1903866">+</span><span class="ident" id="1903867">z</span><span class="op" id="1903868">*</span><span class="op" id="1903869">(</span><span class="ident" id="1903870">_lgamA</span><span class="op" id="1903876">[</span><span class="num" id="1903877">8</span><span class="op" id="1903878">]</span><span class="op" id="1903879">+</span><span class="ident" id="1903880">z</span><span class="op" id="1903881">*</span><span class="ident" id="1903882">_lgamA</span><span class="op" id="1903888">[</span><span class="num" id="1903889">10</span><span class="op" id="1903891">]</span><span class="op" id="1903892">)</span><span class="op" id="1903893">)</span><span class="op" id="1903894">)</span><span class="op" id="1903895">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903900">p2</span>&nbsp;<span class="op" id="1903903">:=</span>&nbsp;<span class="ident" id="1903906">z</span>&nbsp;<span class="op" id="1903908">*</span>&nbsp;<span class="op" id="1903910">(</span><span class="ident" id="1903911">_lgamA</span><span class="op" id="1903917">[</span><span class="num" id="1903918">1</span><span class="op" id="1903919">]</span>&nbsp;<span class="op" id="1903921">+</span>&nbsp;<span class="ident" id="1903923">z</span><span class="op" id="1903924">*</span><span class="op" id="1903925">(</span><span class="op" id="1903926">+</span><span class="ident" id="1903927">_lgamA</span><span class="op" id="1903933">[</span><span class="num" id="1903934">3</span><span class="op" id="1903935">]</span><span class="op" id="1903936">+</span><span class="ident" id="1903937">z</span><span class="op" id="1903938">*</span><span class="op" id="1903939">(</span><span class="ident" id="1903940">_lgamA</span><span class="op" id="1903946">[</span><span class="num" id="1903947">5</span><span class="op" id="1903948">]</span><span class="op" id="1903949">+</span><span class="ident" id="1903950">z</span><span class="op" id="1903951">*</span><span class="op" id="1903952">(</span><span class="ident" id="1903953">_lgamA</span><span class="op" id="1903959">[</span><span class="num" id="1903960">7</span><span class="op" id="1903961">]</span><span class="op" id="1903962">+</span><span class="ident" id="1903963">z</span><span class="op" id="1903964">*</span><span class="op" id="1903965">(</span><span class="ident" id="1903966">_lgamA</span><span class="op" id="1903972">[</span><span class="num" id="1903973">9</span><span class="op" id="1903974">]</span><span class="op" id="1903975">+</span><span class="ident" id="1903976">z</span><span class="op" id="1903977">*</span><span class="ident" id="1903978">_lgamA</span><span class="op" id="1903984">[</span><span class="num" id="1903985">11</span><span class="op" id="1903987">]</span><span class="op" id="1903988">)</span><span class="op" id="1903989">)</span><span class="op" id="1903990">)</span><span class="op" id="1903991">)</span><span class="op" id="1903992">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1903997">p</span>&nbsp;<span class="op" id="1903999">:=</span>&nbsp;<span class="ident" id="1904002">y</span><span class="op" id="1904003">*</span><span class="ident" id="1904004">p1</span>&nbsp;<span class="op" id="1904007">+</span>&nbsp;<span class="ident" id="1904009">p2</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1904015">lgamma</span>&nbsp;<span class="op" id="1904022">+=</span>&nbsp;<span class="op" id="1904025">(</span><span class="ident" id="1904026">p</span>&nbsp;<span class="op" id="1904028">-</span>&nbsp;<span class="num" id="1904030">0.5</span><span class="op" id="1904033">*</span><span class="ident" id="1904034">y</span><span class="op" id="1904035">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1904039">case</span>&nbsp;<span class="num" id="1904044">1</span><span class="op" id="1904045">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1904050">z</span>&nbsp;<span class="op" id="1904052">:=</span>&nbsp;<span class="ident" id="1904055">y</span>&nbsp;<span class="op" id="1904057">*</span>&nbsp;<span class="ident" id="1904059">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1904064">w</span>&nbsp;<span class="op" id="1904066">:=</span>&nbsp;<span class="ident" id="1904069">z</span>&nbsp;<span class="op" id="1904071">*</span>&nbsp;<span class="ident" id="1904073">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1904078">p1</span>&nbsp;<span class="op" id="1904081">:=</span>&nbsp;<span class="ident" id="1904084">_lgamT</span><span class="op" id="1904090">[</span><span class="num" id="1904091">0</span><span class="op" id="1904092">]</span>&nbsp;<span class="op" id="1904094">+</span>&nbsp;<span class="ident" id="1904096">w</span><span class="op" id="1904097">*</span><span class="op" id="1904098">(</span><span class="ident" id="1904099">_lgamT</span><span class="op" id="1904105">[</span><span class="num" id="1904106">3</span><span class="op" id="1904107">]</span><span class="op" id="1904108">+</span><span class="ident" id="1904109">w</span><span class="op" id="1904110">*</span><span class="op" id="1904111">(</span><span class="ident" id="1904112">_lgamT</span><span class="op" id="1904118">[</span><span class="num" id="1904119">6</span><span class="op" id="1904120">]</span><span class="op" id="1904121">+</span><span class="ident" id="1904122">w</span><span class="op" id="1904123">*</span><span class="op" id="1904124">(</span><span class="ident" id="1904125">_lgamT</span><span class="op" id="1904131">[</span><span class="num" id="1904132">9</span><span class="op" id="1904133">]</span><span class="op" id="1904134">+</span><span class="ident" id="1904135">w</span><span class="op" id="1904136">*</span><span class="ident" id="1904137">_lgamT</span><span class="op" id="1904143">[</span><span class="num" id="1904144">12</span><span class="op" id="1904146">]</span><span class="op" id="1904147">)</span><span class="op" id="1904148">)</span><span class="op" id="1904149">)</span>&nbsp;<span class="comment" id="1904151">//&nbsp;parallel&nbsp;comp</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1904171">p2</span>&nbsp;<span class="op" id="1904174">:=</span>&nbsp;<span class="ident" id="1904177">_lgamT</span><span class="op" id="1904183">[</span><span class="num" id="1904184">1</span><span class="op" id="1904185">]</span>&nbsp;<span class="op" id="1904187">+</span>&nbsp;<span class="ident" id="1904189">w</span><span class="op" id="1904190">*</span><span class="op" id="1904191">(</span><span class="ident" id="1904192">_lgamT</span><span class="op" id="1904198">[</span><span class="num" id="1904199">4</span><span class="op" id="1904200">]</span><span class="op" id="1904201">+</span><span class="ident" id="1904202">w</span><span class="op" id="1904203">*</span><span class="op" id="1904204">(</span><span class="ident" id="1904205">_lgamT</span><span class="op" id="1904211">[</span><span class="num" id="1904212">7</span><span class="op" id="1904213">]</span><span class="op" id="1904214">+</span><span class="ident" id="1904215">w</span><span class="op" id="1904216">*</span><span class="op" id="1904217">(</span><span class="ident" id="1904218">_lgamT</span><span class="op" id="1904224">[</span><span class="num" id="1904225">10</span><span class="op" id="1904227">]</span><span class="op" id="1904228">+</span><span class="ident" id="1904229">w</span><span class="op" id="1904230">*</span><span class="ident" id="1904231">_lgamT</span><span class="op" id="1904237">[</span><span class="num" id="1904238">13</span><span class="op" id="1904240">]</span><span class="op" id="1904241">)</span><span class="op" id="1904242">)</span><span class="op" id="1904243">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1904248">p3</span>&nbsp;<span class="op" id="1904251">:=</span>&nbsp;<span class="ident" id="1904254">_lgamT</span><span class="op" id="1904260">[</span><span class="num" id="1904261">2</span><span class="op" id="1904262">]</span>&nbsp;<span class="op" id="1904264">+</span>&nbsp;<span class="ident" id="1904266">w</span><span class="op" id="1904267">*</span><span class="op" id="1904268">(</span><span class="ident" id="1904269">_lgamT</span><span class="op" id="1904275">[</span><span class="num" id="1904276">5</span><span class="op" id="1904277">]</span><span class="op" id="1904278">+</span><span class="ident" id="1904279">w</span><span class="op" id="1904280">*</span><span class="op" id="1904281">(</span><span class="ident" id="1904282">_lgamT</span><span class="op" id="1904288">[</span><span class="num" id="1904289">8</span><span class="op" id="1904290">]</span><span class="op" id="1904291">+</span><span class="ident" id="1904292">w</span><span class="op" id="1904293">*</span><span class="op" id="1904294">(</span><span class="ident" id="1904295">_lgamT</span><span class="op" id="1904301">[</span><span class="num" id="1904302">11</span><span class="op" id="1904304">]</span><span class="op" id="1904305">+</span><span class="ident" id="1904306">w</span><span class="op" id="1904307">*</span><span class="ident" id="1904308">_lgamT</span><span class="op" id="1904314">[</span><span class="num" id="1904315">14</span><span class="op" id="1904317">]</span><span class="op" id="1904318">)</span><span class="op" id="1904319">)</span><span class="op" id="1904320">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1904325">p</span>&nbsp;<span class="op" id="1904327">:=</span>&nbsp;<span class="ident" id="1904330">z</span><span class="op" id="1904331">*</span><span class="ident" id="1904332">p1</span>&nbsp;<span class="op" id="1904335">-</span>&nbsp;<span class="op" id="1904337">(</span><span class="ident" id="1904338">Tt</span>&nbsp;<span class="op" id="1904341">-</span>&nbsp;<span class="ident" id="1904343">w</span><span class="op" id="1904344">*</span><span class="op" id="1904345">(</span><span class="ident" id="1904346">p2</span><span class="op" id="1904348">+</span><span class="ident" id="1904349">y</span><span class="op" id="1904350">*</span><span class="ident" id="1904351">p3</span><span class="op" id="1904353">)</span><span class="op" id="1904354">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1904359">lgamma</span>&nbsp;<span class="op" id="1904366">+=</span>&nbsp;<span class="op" id="1904369">(</span><span class="ident" id="1904370">Tf</span>&nbsp;<span class="op" id="1904373">+</span>&nbsp;<span class="ident" id="1904375">p</span><span class="op" id="1904376">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1904380">case</span>&nbsp;<span class="num" id="1904385">2</span><span class="op" id="1904386">:</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1904391">p1</span>&nbsp;<span class="op" id="1904394">:=</span>&nbsp;<span class="ident" id="1904397">y</span>&nbsp;<span class="op" id="1904399">*</span>&nbsp;<span class="op" id="1904401">(</span><span class="ident" id="1904402">_lgamU</span><span class="op" id="1904408">[</span><span class="num" id="1904409">0</span><span class="op" id="1904410">]</span>&nbsp;<span class="op" id="1904412">+</span>&nbsp;<span class="ident" id="1904414">y</span><span class="op" id="1904415">*</span><span class="op" id="1904416">(</span><span class="ident" id="1904417">_lgamU</span><span class="op" id="1904423">[</span><span class="num" id="1904424">1</span><span class="op" id="1904425">]</span><span class="op" id="1904426">+</span><span class="ident" id="1904427">y</span><span class="op" id="1904428">*</span><span class="op" id="1904429">(</span><span class="ident" id="1904430">_lgamU</span><span class="op" id="1904436">[</span><span class="num" id="1904437">2</span><span class="op" id="1904438">]</span><span class="op" id="1904439">+</span><span class="ident" id="1904440">y</span><span class="op" id="1904441">*</span><span class="op" id="1904442">(</span><span class="ident" id="1904443">_lgamU</span><span class="op" id="1904449">[</span><span class="num" id="1904450">3</span><span class="op" id="1904451">]</span><span class="op" id="1904452">+</span><span class="ident" id="1904453">y</span><span class="op" id="1904454">*</span><span class="op" id="1904455">(</span><span class="ident" id="1904456">_lgamU</span><span class="op" id="1904462">[</span><span class="num" id="1904463">4</span><span class="op" id="1904464">]</span><span class="op" id="1904465">+</span><span class="ident" id="1904466">y</span><span class="op" id="1904467">*</span><span class="ident" id="1904468">_lgamU</span><span class="op" id="1904474">[</span><span class="num" id="1904475">5</span><span class="op" id="1904476">]</span><span class="op" id="1904477">)</span><span class="op" id="1904478">)</span><span class="op" id="1904479">)</span><span class="op" id="1904480">)</span><span class="op" id="1904481">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1904486">p2</span>&nbsp;<span class="op" id="1904489">:=</span>&nbsp;<span class="num" id="1904492">1</span>&nbsp;<span class="op" id="1904494">+</span>&nbsp;<span class="ident" id="1904496">y</span><span class="op" id="1904497">*</span><span class="op" id="1904498">(</span><span class="ident" id="1904499">_lgamV</span><span class="op" id="1904505">[</span><span class="num" id="1904506">1</span><span class="op" id="1904507">]</span><span class="op" id="1904508">+</span><span class="ident" id="1904509">y</span><span class="op" id="1904510">*</span><span class="op" id="1904511">(</span><span class="ident" id="1904512">_lgamV</span><span class="op" id="1904518">[</span><span class="num" id="1904519">2</span><span class="op" id="1904520">]</span><span class="op" id="1904521">+</span><span class="ident" id="1904522">y</span><span class="op" id="1904523">*</span><span class="op" id="1904524">(</span><span class="ident" id="1904525">_lgamV</span><span class="op" id="1904531">[</span><span class="num" id="1904532">3</span><span class="op" id="1904533">]</span><span class="op" id="1904534">+</span><span class="ident" id="1904535">y</span><span class="op" id="1904536">*</span><span class="op" id="1904537">(</span><span class="ident" id="1904538">_lgamV</span><span class="op" id="1904544">[</span><span class="num" id="1904545">4</span><span class="op" id="1904546">]</span><span class="op" id="1904547">+</span><span class="ident" id="1904548">y</span><span class="op" id="1904549">*</span><span class="ident" id="1904550">_lgamV</span><span class="op" id="1904556">[</span><span class="num" id="1904557">5</span><span class="op" id="1904558">]</span><span class="op" id="1904559">)</span><span class="op" id="1904560">)</span><span class="op" id="1904561">)</span><span class="op" id="1904562">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1904567">lgamma</span>&nbsp;<span class="op" id="1904574">+=</span>&nbsp;<span class="op" id="1904577">(</span><span class="op" id="1904578">-</span><span class="num" id="1904579">0.5</span><span class="op" id="1904582">*</span><span class="ident" id="1904583">y</span>&nbsp;<span class="op" id="1904585">+</span>&nbsp;<span class="ident" id="1904587">p1</span><span class="op" id="1904589">/</span><span class="ident" id="1904590">p2</span><span class="op" id="1904592">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1904596">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1904599">case</span>&nbsp;<span class="ident" id="1904604">x</span>&nbsp;<span class="op" id="1904606">&lt;</span>&nbsp;<span class="num" id="1904608">8</span><span class="op" id="1904609">:</span>&nbsp;<span class="comment" id="1904611">//&nbsp;2&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;8</span><br>
<span class="lineno">285</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1904627">i</span>&nbsp;<span class="op" id="1904629">:=</span>&nbsp;<span class="builtintype" id="1904632">int</span><span class="op" id="1904635">(</span><span class="ident" id="1904636">x</span><span class="op" id="1904637">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1904641">y</span>&nbsp;<span class="op" id="1904643">:=</span>&nbsp;<span class="ident" id="1904646">x</span>&nbsp;<span class="op" id="1904648">-</span>&nbsp;<span class="builtintype" id="1904650">float64</span><span class="op" id="1904657">(</span><span class="ident" id="1904658">i</span><span class="op" id="1904659">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1904663">p</span>&nbsp;<span class="op" id="1904665">:=</span>&nbsp;<span class="ident" id="1904668">y</span>&nbsp;<span class="op" id="1904670">*</span>&nbsp;<span class="op" id="1904672">(</span><span class="ident" id="1904673">_lgamS</span><span class="op" id="1904679">[</span><span class="num" id="1904680">0</span><span class="op" id="1904681">]</span>&nbsp;<span class="op" id="1904683">+</span>&nbsp;<span class="ident" id="1904685">y</span><span class="op" id="1904686">*</span><span class="op" id="1904687">(</span><span class="ident" id="1904688">_lgamS</span><span class="op" id="1904694">[</span><span class="num" id="1904695">1</span><span class="op" id="1904696">]</span><span class="op" id="1904697">+</span><span class="ident" id="1904698">y</span><span class="op" id="1904699">*</span><span class="op" id="1904700">(</span><span class="ident" id="1904701">_lgamS</span><span class="op" id="1904707">[</span><span class="num" id="1904708">2</span><span class="op" id="1904709">]</span><span class="op" id="1904710">+</span><span class="ident" id="1904711">y</span><span class="op" id="1904712">*</span><span class="op" id="1904713">(</span><span class="ident" id="1904714">_lgamS</span><span class="op" id="1904720">[</span><span class="num" id="1904721">3</span><span class="op" id="1904722">]</span><span class="op" id="1904723">+</span><span class="ident" id="1904724">y</span><span class="op" id="1904725">*</span><span class="op" id="1904726">(</span><span class="ident" id="1904727">_lgamS</span><span class="op" id="1904733">[</span><span class="num" id="1904734">4</span><span class="op" id="1904735">]</span><span class="op" id="1904736">+</span><span class="ident" id="1904737">y</span><span class="op" id="1904738">*</span><span class="op" id="1904739">(</span><span class="ident" id="1904740">_lgamS</span><span class="op" id="1904746">[</span><span class="num" id="1904747">5</span><span class="op" id="1904748">]</span><span class="op" id="1904749">+</span><span class="ident" id="1904750">y</span><span class="op" id="1904751">*</span><span class="ident" id="1904752">_lgamS</span><span class="op" id="1904758">[</span><span class="num" id="1904759">6</span><span class="op" id="1904760">]</span><span class="op" id="1904761">)</span><span class="op" id="1904762">)</span><span class="op" id="1904763">)</span><span class="op" id="1904764">)</span><span class="op" id="1904765">)</span><span class="op" id="1904766">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1904770">q</span>&nbsp;<span class="op" id="1904772">:=</span>&nbsp;<span class="num" id="1904775">1</span>&nbsp;<span class="op" id="1904777">+</span>&nbsp;<span class="ident" id="1904779">y</span><span class="op" id="1904780">*</span><span class="op" id="1904781">(</span><span class="ident" id="1904782">_lgamR</span><span class="op" id="1904788">[</span><span class="num" id="1904789">1</span><span class="op" id="1904790">]</span><span class="op" id="1904791">+</span><span class="ident" id="1904792">y</span><span class="op" id="1904793">*</span><span class="op" id="1904794">(</span><span class="ident" id="1904795">_lgamR</span><span class="op" id="1904801">[</span><span class="num" id="1904802">2</span><span class="op" id="1904803">]</span><span class="op" id="1904804">+</span><span class="ident" id="1904805">y</span><span class="op" id="1904806">*</span><span class="op" id="1904807">(</span><span class="ident" id="1904808">_lgamR</span><span class="op" id="1904814">[</span><span class="num" id="1904815">3</span><span class="op" id="1904816">]</span><span class="op" id="1904817">+</span><span class="ident" id="1904818">y</span><span class="op" id="1904819">*</span><span class="op" id="1904820">(</span><span class="ident" id="1904821">_lgamR</span><span class="op" id="1904827">[</span><span class="num" id="1904828">4</span><span class="op" id="1904829">]</span><span class="op" id="1904830">+</span><span class="ident" id="1904831">y</span><span class="op" id="1904832">*</span><span class="op" id="1904833">(</span><span class="ident" id="1904834">_lgamR</span><span class="op" id="1904840">[</span><span class="num" id="1904841">5</span><span class="op" id="1904842">]</span><span class="op" id="1904843">+</span><span class="ident" id="1904844">y</span><span class="op" id="1904845">*</span><span class="ident" id="1904846">_lgamR</span><span class="op" id="1904852">[</span><span class="num" id="1904853">6</span><span class="op" id="1904854">]</span><span class="op" id="1904855">)</span><span class="op" id="1904856">)</span><span class="op" id="1904857">)</span><span class="op" id="1904858">)</span><span class="op" id="1904859">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1904863">lgamma</span>&nbsp;<span class="op" id="1904870">=</span>&nbsp;<span class="num" id="1904872">0.5</span><span class="op" id="1904875">*</span><span class="ident" id="1904876">y</span>&nbsp;<span class="op" id="1904878">+</span>&nbsp;<span class="ident" id="1904880">p</span><span class="op" id="1904881">/</span><span class="ident" id="1904882">q</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1904886">z</span>&nbsp;<span class="op" id="1904888">:=</span>&nbsp;<span class="num" id="1904891">1.0</span>&nbsp;<span class="comment" id="1904895">//&nbsp;Lgamma(1+s)&nbsp;=&nbsp;Log(s)&nbsp;+&nbsp;Lgamma(s)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1904933">switch</span>&nbsp;<span class="ident" id="1904940">i</span>&nbsp;<span class="op" id="1904942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1904946">case</span>&nbsp;<span class="num" id="1904951">7</span><span class="op" id="1904952">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1904957">z</span>&nbsp;<span class="op" id="1904959">*=</span>&nbsp;<span class="op" id="1904962">(</span><span class="ident" id="1904963">y</span>&nbsp;<span class="op" id="1904965">+</span>&nbsp;<span class="num" id="1904967">6</span><span class="op" id="1904968">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1904973">fallthrough</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1904987">case</span>&nbsp;<span class="num" id="1904992">6</span><span class="op" id="1904993">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1904998">z</span>&nbsp;<span class="op" id="1905000">*=</span>&nbsp;<span class="op" id="1905003">(</span><span class="ident" id="1905004">y</span>&nbsp;<span class="op" id="1905006">+</span>&nbsp;<span class="num" id="1905008">5</span><span class="op" id="1905009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1905014">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1905028">case</span>&nbsp;<span class="num" id="1905033">5</span><span class="op" id="1905034">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905039">z</span>&nbsp;<span class="op" id="1905041">*=</span>&nbsp;<span class="op" id="1905044">(</span><span class="ident" id="1905045">y</span>&nbsp;<span class="op" id="1905047">+</span>&nbsp;<span class="num" id="1905049">4</span><span class="op" id="1905050">)</span><br>
<span class="lineno">300</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1905055">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1905069">case</span>&nbsp;<span class="num" id="1905074">4</span><span class="op" id="1905075">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905080">z</span>&nbsp;<span class="op" id="1905082">*=</span>&nbsp;<span class="op" id="1905085">(</span><span class="ident" id="1905086">y</span>&nbsp;<span class="op" id="1905088">+</span>&nbsp;<span class="num" id="1905090">3</span><span class="op" id="1905091">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1905096">fallthrough</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1905110">case</span>&nbsp;<span class="num" id="1905115">3</span><span class="op" id="1905116">:</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905121">z</span>&nbsp;<span class="op" id="1905123">*=</span>&nbsp;<span class="op" id="1905126">(</span><span class="ident" id="1905127">y</span>&nbsp;<span class="op" id="1905129">+</span>&nbsp;<span class="num" id="1905131">2</span><span class="op" id="1905132">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905137">lgamma</span>&nbsp;<span class="op" id="1905144">+=</span>&nbsp;<span class="ident" id="1905147">Log</span><span class="op" id="1905150">(</span><span class="ident" id="1905151">z</span><span class="op" id="1905152">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1905156">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1905159">case</span>&nbsp;<span class="ident" id="1905164">x</span>&nbsp;<span class="op" id="1905166">&lt;</span>&nbsp;<span class="ident" id="1905168">Two58</span><span class="op" id="1905173">:</span>&nbsp;<span class="comment" id="1905175">//&nbsp;8&nbsp;&lt;=&nbsp;x&nbsp;&lt;&nbsp;2**58</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905195">t</span>&nbsp;<span class="op" id="1905197">:=</span>&nbsp;<span class="ident" id="1905200">Log</span><span class="op" id="1905203">(</span><span class="ident" id="1905204">x</span><span class="op" id="1905205">)</span><br>
<span class="lineno">310</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905209">z</span>&nbsp;<span class="op" id="1905211">:=</span>&nbsp;<span class="num" id="1905214">1</span>&nbsp;<span class="op" id="1905216">/</span>&nbsp;<span class="ident" id="1905218">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905222">y</span>&nbsp;<span class="op" id="1905224">:=</span>&nbsp;<span class="ident" id="1905227">z</span>&nbsp;<span class="op" id="1905229">*</span>&nbsp;<span class="ident" id="1905231">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905235">w</span>&nbsp;<span class="op" id="1905237">:=</span>&nbsp;<span class="ident" id="1905240">_lgamW</span><span class="op" id="1905246">[</span><span class="num" id="1905247">0</span><span class="op" id="1905248">]</span>&nbsp;<span class="op" id="1905250">+</span>&nbsp;<span class="ident" id="1905252">z</span><span class="op" id="1905253">*</span><span class="op" id="1905254">(</span><span class="ident" id="1905255">_lgamW</span><span class="op" id="1905261">[</span><span class="num" id="1905262">1</span><span class="op" id="1905263">]</span><span class="op" id="1905264">+</span><span class="ident" id="1905265">y</span><span class="op" id="1905266">*</span><span class="op" id="1905267">(</span><span class="ident" id="1905268">_lgamW</span><span class="op" id="1905274">[</span><span class="num" id="1905275">2</span><span class="op" id="1905276">]</span><span class="op" id="1905277">+</span><span class="ident" id="1905278">y</span><span class="op" id="1905279">*</span><span class="op" id="1905280">(</span><span class="ident" id="1905281">_lgamW</span><span class="op" id="1905287">[</span><span class="num" id="1905288">3</span><span class="op" id="1905289">]</span><span class="op" id="1905290">+</span><span class="ident" id="1905291">y</span><span class="op" id="1905292">*</span><span class="op" id="1905293">(</span><span class="ident" id="1905294">_lgamW</span><span class="op" id="1905300">[</span><span class="num" id="1905301">4</span><span class="op" id="1905302">]</span><span class="op" id="1905303">+</span><span class="ident" id="1905304">y</span><span class="op" id="1905305">*</span><span class="op" id="1905306">(</span><span class="ident" id="1905307">_lgamW</span><span class="op" id="1905313">[</span><span class="num" id="1905314">5</span><span class="op" id="1905315">]</span><span class="op" id="1905316">+</span><span class="ident" id="1905317">y</span><span class="op" id="1905318">*</span><span class="ident" id="1905319">_lgamW</span><span class="op" id="1905325">[</span><span class="num" id="1905326">6</span><span class="op" id="1905327">]</span><span class="op" id="1905328">)</span><span class="op" id="1905329">)</span><span class="op" id="1905330">)</span><span class="op" id="1905331">)</span><span class="op" id="1905332">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905336">lgamma</span>&nbsp;<span class="op" id="1905343">=</span>&nbsp;<span class="op" id="1905345">(</span><span class="ident" id="1905346">x</span><span class="op" id="1905347">-</span><span class="num" id="1905348">0.5</span><span class="op" id="1905351">)</span><span class="op" id="1905352">*</span><span class="op" id="1905353">(</span><span class="ident" id="1905354">t</span><span class="op" id="1905355">-</span><span class="num" id="1905356">1</span><span class="op" id="1905357">)</span>&nbsp;<span class="op" id="1905359">+</span>&nbsp;<span class="ident" id="1905361">w</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1905364">default</span><span class="op" id="1905371">:</span>&nbsp;<span class="comment" id="1905373">//&nbsp;2**58&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;Inf</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905396">lgamma</span>&nbsp;<span class="op" id="1905403">=</span>&nbsp;<span class="ident" id="1905405">x</span>&nbsp;<span class="op" id="1905407">*</span>&nbsp;<span class="op" id="1905409">(</span><span class="ident" id="1905410">Log</span><span class="op" id="1905413">(</span><span class="ident" id="1905414">x</span><span class="op" id="1905415">)</span>&nbsp;<span class="op" id="1905417">-</span>&nbsp;<span class="num" id="1905419">1</span><span class="op" id="1905420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1905423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1905426">if</span>&nbsp;<span class="ident" id="1905429">neg</span>&nbsp;<span class="op" id="1905433">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905437">lgamma</span>&nbsp;<span class="op" id="1905444">=</span>&nbsp;<span class="ident" id="1905446">nadj</span>&nbsp;<span class="op" id="1905451">-</span>&nbsp;<span class="ident" id="1905453">lgamma</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1905461">}</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1905464">return</span><br>
<span class="lineno"></span><span class="op" id="1905471">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1905474">//&nbsp;sinPi(x)&nbsp;is&nbsp;a&nbsp;helper&nbsp;function&nbsp;for&nbsp;negative&nbsp;x</span><br>
<span class="lineno"></span><span class="keyword" id="1905522">func</span>&nbsp;<span class="ident" id="1905527">sinPi</span><span class="op" id="1905532">(</span><span class="ident" id="1905533">x</span>&nbsp;<span class="builtintype" id="1905535">float64</span><span class="op" id="1905542">)</span>&nbsp;<span class="builtintype" id="1905544">float64</span>&nbsp;<span class="op" id="1905552">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1905555">const</span>&nbsp;<span class="op" id="1905561">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905565">Two52</span>&nbsp;<span class="op" id="1905571">=</span>&nbsp;<span class="num" id="1905573">1</span>&nbsp;<span class="op" id="1905575">&lt;&lt;</span>&nbsp;<span class="num" id="1905578">52</span>&nbsp;<span class="comment" id="1905581">//&nbsp;0x4330000000000000&nbsp;~4.5036e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905617">Two53</span>&nbsp;<span class="op" id="1905623">=</span>&nbsp;<span class="num" id="1905625">1</span>&nbsp;<span class="op" id="1905627">&lt;&lt;</span>&nbsp;<span class="num" id="1905630">53</span>&nbsp;<span class="comment" id="1905633">//&nbsp;0x4340000000000000&nbsp;~9.0072e+15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1905668">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1905671">if</span>&nbsp;<span class="ident" id="1905674">x</span>&nbsp;<span class="op" id="1905676">&lt;</span>&nbsp;<span class="num" id="1905678">0.25</span>&nbsp;<span class="op" id="1905683">{</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1905687">return</span>&nbsp;<span class="op" id="1905694">-</span><span class="ident" id="1905695">Sin</span><span class="op" id="1905698">(</span><span class="ident" id="1905699">Pi</span>&nbsp;<span class="op" id="1905702">*</span>&nbsp;<span class="ident" id="1905704">x</span><span class="op" id="1905705">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1905708">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1905712">//&nbsp;argument&nbsp;reduction</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905735">z</span>&nbsp;<span class="op" id="1905737">:=</span>&nbsp;<span class="ident" id="1905740">Floor</span><span class="op" id="1905745">(</span><span class="ident" id="1905746">x</span><span class="op" id="1905747">)</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1905750">var</span>&nbsp;<span class="ident" id="1905754">n</span>&nbsp;<span class="builtintype" id="1905756">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1905761">if</span>&nbsp;<span class="ident" id="1905764">z</span>&nbsp;<span class="op" id="1905766">!=</span>&nbsp;<span class="ident" id="1905769">x</span>&nbsp;<span class="op" id="1905771">{</span>&nbsp;<span class="comment" id="1905773">//&nbsp;inexact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905786">x</span>&nbsp;<span class="op" id="1905788">=</span>&nbsp;<span class="ident" id="1905790">Mod</span><span class="op" id="1905793">(</span><span class="ident" id="1905794">x</span><span class="op" id="1905795">,</span>&nbsp;<span class="num" id="1905797">2</span><span class="op" id="1905798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905802">n</span>&nbsp;<span class="op" id="1905804">=</span>&nbsp;<span class="builtintype" id="1905806">int</span><span class="op" id="1905809">(</span><span class="ident" id="1905810">x</span>&nbsp;<span class="op" id="1905812">*</span>&nbsp;<span class="num" id="1905814">4</span><span class="op" id="1905815">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1905818">}</span>&nbsp;<span class="keyword" id="1905820">else</span>&nbsp;<span class="op" id="1905825">{</span><br>
<span class="lineno">340</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1905829">if</span>&nbsp;<span class="ident" id="1905832">x</span>&nbsp;<span class="op" id="1905834">&gt;=</span>&nbsp;<span class="ident" id="1905837">Two53</span>&nbsp;<span class="op" id="1905843">{</span>&nbsp;<span class="comment" id="1905845">//&nbsp;x&nbsp;must&nbsp;be&nbsp;even</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905866">x</span>&nbsp;<span class="op" id="1905868">=</span>&nbsp;<span class="num" id="1905870">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905875">n</span>&nbsp;<span class="op" id="1905877">=</span>&nbsp;<span class="num" id="1905879">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1905883">}</span>&nbsp;<span class="keyword" id="1905885">else</span>&nbsp;<span class="op" id="1905890">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1905895">if</span>&nbsp;<span class="ident" id="1905898">x</span>&nbsp;<span class="op" id="1905900">&lt;</span>&nbsp;<span class="ident" id="1905902">Two52</span>&nbsp;<span class="op" id="1905908">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905914">z</span>&nbsp;<span class="op" id="1905916">=</span>&nbsp;<span class="ident" id="1905918">x</span>&nbsp;<span class="op" id="1905920">+</span>&nbsp;<span class="ident" id="1905922">Two52</span>&nbsp;<span class="comment" id="1905928">//&nbsp;exact</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1905940">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905945">n</span>&nbsp;<span class="op" id="1905947">=</span>&nbsp;<span class="builtintype" id="1905949">int</span><span class="op" id="1905952">(</span><span class="num" id="1905953">1</span>&nbsp;<span class="op" id="1905955">&amp;</span>&nbsp;<span class="ident" id="1905957">Float64bits</span><span class="op" id="1905968">(</span><span class="ident" id="1905969">z</span><span class="op" id="1905970">)</span><span class="op" id="1905971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905976">x</span>&nbsp;<span class="op" id="1905978">=</span>&nbsp;<span class="builtintype" id="1905980">float64</span><span class="op" id="1905987">(</span><span class="ident" id="1905988">n</span><span class="op" id="1905989">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1905994">n</span>&nbsp;<span class="op" id="1905996">&lt;&lt;=</span>&nbsp;<span class="num" id="1906000">2</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1906004">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1906007">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1906010">switch</span>&nbsp;<span class="ident" id="1906017">n</span>&nbsp;<span class="op" id="1906019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1906022">case</span>&nbsp;<span class="num" id="1906027">0</span><span class="op" id="1906028">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1906032">x</span>&nbsp;<span class="op" id="1906034">=</span>&nbsp;<span class="ident" id="1906036">Sin</span><span class="op" id="1906039">(</span><span class="ident" id="1906040">Pi</span>&nbsp;<span class="op" id="1906043">*</span>&nbsp;<span class="ident" id="1906045">x</span><span class="op" id="1906046">)</span><br>
<span class="lineno">355</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1906049">case</span>&nbsp;<span class="num" id="1906054">1</span><span class="op" id="1906055">,</span>&nbsp;<span class="num" id="1906057">2</span><span class="op" id="1906058">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1906062">x</span>&nbsp;<span class="op" id="1906064">=</span>&nbsp;<span class="ident" id="1906066">Cos</span><span class="op" id="1906069">(</span><span class="ident" id="1906070">Pi</span>&nbsp;<span class="op" id="1906073">*</span>&nbsp;<span class="op" id="1906075">(</span><span class="num" id="1906076">0.5</span>&nbsp;<span class="op" id="1906080">-</span>&nbsp;<span class="ident" id="1906082">x</span><span class="op" id="1906083">)</span><span class="op" id="1906084">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1906087">case</span>&nbsp;<span class="num" id="1906092">3</span><span class="op" id="1906093">,</span>&nbsp;<span class="num" id="1906095">4</span><span class="op" id="1906096">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1906100">x</span>&nbsp;<span class="op" id="1906102">=</span>&nbsp;<span class="ident" id="1906104">Sin</span><span class="op" id="1906107">(</span><span class="ident" id="1906108">Pi</span>&nbsp;<span class="op" id="1906111">*</span>&nbsp;<span class="op" id="1906113">(</span><span class="num" id="1906114">1</span>&nbsp;<span class="op" id="1906116">-</span>&nbsp;<span class="ident" id="1906118">x</span><span class="op" id="1906119">)</span><span class="op" id="1906120">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1906123">case</span>&nbsp;<span class="num" id="1906128">5</span><span class="op" id="1906129">,</span>&nbsp;<span class="num" id="1906131">6</span><span class="op" id="1906132">:</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1906136">x</span>&nbsp;<span class="op" id="1906138">=</span>&nbsp;<span class="op" id="1906140">-</span><span class="ident" id="1906141">Cos</span><span class="op" id="1906144">(</span><span class="ident" id="1906145">Pi</span>&nbsp;<span class="op" id="1906148">*</span>&nbsp;<span class="op" id="1906150">(</span><span class="ident" id="1906151">x</span>&nbsp;<span class="op" id="1906153">-</span>&nbsp;<span class="num" id="1906155">1.5</span><span class="op" id="1906158">)</span><span class="op" id="1906159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1906162">default</span><span class="op" id="1906169">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1906173">x</span>&nbsp;<span class="op" id="1906175">=</span>&nbsp;<span class="ident" id="1906177">Sin</span><span class="op" id="1906180">(</span><span class="ident" id="1906181">Pi</span>&nbsp;<span class="op" id="1906184">*</span>&nbsp;<span class="op" id="1906186">(</span><span class="ident" id="1906187">x</span>&nbsp;<span class="op" id="1906189">-</span>&nbsp;<span class="num" id="1906191">2</span><span class="op" id="1906192">)</span><span class="op" id="1906193">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1906196">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1906199">return</span>&nbsp;<span class="op" id="1906206">-</span><span class="ident" id="1906207">x</span><br>
<span class="lineno">365</span><span class="op" id="1906209">}</span>
</div>
</body>
</html>
