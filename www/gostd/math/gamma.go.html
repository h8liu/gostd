<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math</h2>
<ul>
<li><a href="/gostd/math/abs.go.html">abs.go</a></li>
<li><a href="/gostd/math/acosh.go.html">acosh.go</a></li>
<li><a href="/gostd/math/all_test.go.html">all_test.go</a></li>
<li><a href="/gostd/math/asin.go.html">asin.go</a></li>
<li><a href="/gostd/math/asinh.go.html">asinh.go</a></li>
<li><a href="/gostd/math/atan.go.html">atan.go</a></li>
<li><a href="/gostd/math/atan2.go.html">atan2.go</a></li>
<li><a href="/gostd/math/atanh.go.html">atanh.go</a></li>
<li><a href="/gostd/math/bits.go.html">bits.go</a></li>
<li><a href="/gostd/math/cbrt.go.html">cbrt.go</a></li>
<li><a href="/gostd/math/const.go.html">const.go</a></li>
<li><a href="/gostd/math/copysign.go.html">copysign.go</a></li>
<li><a href="/gostd/math/dim.go.html">dim.go</a></li>
<li><a href="/gostd/math/erf.go.html">erf.go</a></li>
<li><a href="/gostd/math/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/expm1.go.html">expm1.go</a></li>
<li><a href="/gostd/math/export_test.go.html">export_test.go</a></li>
<li><a href="/gostd/math/floor.go.html">floor.go</a></li>
<li><a href="/gostd/math/frexp.go.html">frexp.go</a></li>
<li><a href="/gostd/math/gamma.go.html" class="current">gamma.go</a></li>
<li><a href="/gostd/math/hypot.go.html">hypot.go</a></li>
<li><a href="/gostd/math/j0.go.html">j0.go</a></li>
<li><a href="/gostd/math/j1.go.html">j1.go</a></li>
<li><a href="/gostd/math/jn.go.html">jn.go</a></li>
<li><a href="/gostd/math/ldexp.go.html">ldexp.go</a></li>
<li><a href="/gostd/math/lgamma.go.html">lgamma.go</a></li>
<li><a href="/gostd/math/log.go.html">log.go</a></li>
<li><a href="/gostd/math/log10.go.html">log10.go</a></li>
<li><a href="/gostd/math/log1p.go.html">log1p.go</a></li>
<li><a href="/gostd/math/logb.go.html">logb.go</a></li>
<li><a href="/gostd/math/mod.go.html">mod.go</a></li>
<li><a href="/gostd/math/modf.go.html">modf.go</a></li>
<li><a href="/gostd/math/nextafter.go.html">nextafter.go</a></li>
<li><a href="/gostd/math/pow.go.html">pow.go</a></li>
<li><a href="/gostd/math/pow10.go.html">pow10.go</a></li>
<li><a href="/gostd/math/remainder.go.html">remainder.go</a></li>
<li><a href="/gostd/math/signbit.go.html">signbit.go</a></li>
<li><a href="/gostd/math/sin.go.html">sin.go</a></li>
<li><a href="/gostd/math/sincos.go.html">sincos.go</a></li>
<li><a href="/gostd/math/sinh.go.html">sinh.go</a></li>
<li><a href="/gostd/math/sqrt.go.html">sqrt.go</a></li>
<li><a href="/gostd/math/tan.go.html">tan.go</a></li>
<li><a href="/gostd/math/tanh.go.html">tanh.go</a></li>
<li><a href="/gostd/math/unsafe.go.html">unsafe.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="2085256">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="2085311">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="2085365">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="2085416">package</span>&nbsp;<span class="ident" id="2085424">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2085430">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="2085490">//&nbsp;below&nbsp;are&nbsp;from&nbsp;http://netlib.sandia.gov/cephes/cprob/gamma.c.</span><br>
<span class="lineno"></span><span class="comment" id="2085555">//&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno">10</span><span class="comment" id="2085613">//</span><br>
<span class="lineno"></span><span class="comment" id="2085616">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tgamma.c</span><br>
<span class="lineno"></span><span class="comment" id="2085633">//</span><br>
<span class="lineno"></span><span class="comment" id="2085636">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gamma&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2085659">//</span><br>
<span class="lineno">15</span><span class="comment" id="2085662">//&nbsp;SYNOPSIS:</span><br>
<span class="lineno"></span><span class="comment" id="2085675">//</span><br>
<span class="lineno"></span><span class="comment" id="2085678">//&nbsp;double&nbsp;x,&nbsp;y,&nbsp;tgamma();</span><br>
<span class="lineno"></span><span class="comment" id="2085704">//&nbsp;extern&nbsp;int&nbsp;signgam;</span><br>
<span class="lineno"></span><span class="comment" id="2085727">//</span><br>
<span class="lineno">20</span><span class="comment" id="2085730">//&nbsp;y&nbsp;=&nbsp;tgamma(&nbsp;x&nbsp;);</span><br>
<span class="lineno"></span><span class="comment" id="2085750">//</span><br>
<span class="lineno"></span><span class="comment" id="2085753">//&nbsp;DESCRIPTION:</span><br>
<span class="lineno"></span><span class="comment" id="2085769">//</span><br>
<span class="lineno"></span><span class="comment" id="2085772">//&nbsp;Returns&nbsp;gamma&nbsp;function&nbsp;of&nbsp;the&nbsp;argument.&nbsp;&nbsp;The&nbsp;result&nbsp;is</span><br>
<span class="lineno">25</span><span class="comment" id="2085830">//&nbsp;correctly&nbsp;signed,&nbsp;and&nbsp;the&nbsp;sign&nbsp;(+1&nbsp;or&nbsp;-1)&nbsp;is&nbsp;also</span><br>
<span class="lineno"></span><span class="comment" id="2085883">//&nbsp;returned&nbsp;in&nbsp;a&nbsp;global&nbsp;(extern)&nbsp;variable&nbsp;named&nbsp;signgam.</span><br>
<span class="lineno"></span><span class="comment" id="2085940">//&nbsp;This&nbsp;variable&nbsp;is&nbsp;also&nbsp;filled&nbsp;in&nbsp;by&nbsp;the&nbsp;logarithmic&nbsp;gamma</span><br>
<span class="lineno"></span><span class="comment" id="2086000">//&nbsp;function&nbsp;lgamma().</span><br>
<span class="lineno"></span><span class="comment" id="2086022">//</span><br>
<span class="lineno">30</span><span class="comment" id="2086025">//&nbsp;Arguments&nbsp;|x|&nbsp;&lt;=&nbsp;34&nbsp;are&nbsp;reduced&nbsp;by&nbsp;recurrence&nbsp;and&nbsp;the&nbsp;function</span><br>
<span class="lineno"></span><span class="comment" id="2086091">//&nbsp;approximated&nbsp;by&nbsp;a&nbsp;rational&nbsp;function&nbsp;of&nbsp;degree&nbsp;6/7&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="2086151">//&nbsp;interval&nbsp;(2,3).&nbsp;&nbsp;Large&nbsp;arguments&nbsp;are&nbsp;handled&nbsp;by&nbsp;Stirling&#39;s</span><br>
<span class="lineno"></span><span class="comment" id="2086213">//&nbsp;formula.&nbsp;Large&nbsp;negative&nbsp;arguments&nbsp;are&nbsp;made&nbsp;positive&nbsp;using</span><br>
<span class="lineno"></span><span class="comment" id="2086274">//&nbsp;a&nbsp;reflection&nbsp;formula.</span><br>
<span class="lineno">35</span><span class="comment" id="2086299">//</span><br>
<span class="lineno"></span><span class="comment" id="2086302">//&nbsp;ACCURACY:</span><br>
<span class="lineno"></span><span class="comment" id="2086315">//</span><br>
<span class="lineno"></span><span class="comment" id="2086318">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Relative&nbsp;error:</span><br>
<span class="lineno"></span><span class="comment" id="2086358">//&nbsp;arithmetic&nbsp;&nbsp;&nbsp;domain&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#&nbsp;trials&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;peak&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rms</span><br>
<span class="lineno">40</span><span class="comment" id="2086416">//&nbsp;&nbsp;&nbsp;&nbsp;DEC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-34,&nbsp;34&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1.3e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.5e-17</span><br>
<span class="lineno"></span><span class="comment" id="2086476">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;-170,-33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.3e-16</span><br>
<span class="lineno"></span><span class="comment" id="2086536">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-33,&nbsp;&nbsp;33&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9.4e-16&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2086596">//&nbsp;&nbsp;&nbsp;&nbsp;IEEE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;33,&nbsp;171.6&nbsp;&nbsp;&nbsp;20000&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2.3e-15&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3.2e-16</span><br>
<span class="lineno"></span><span class="comment" id="2086656">//</span><br>
<span class="lineno">45</span><span class="comment" id="2086659">//&nbsp;Error&nbsp;for&nbsp;arguments&nbsp;outside&nbsp;the&nbsp;test&nbsp;range&nbsp;will&nbsp;be&nbsp;larger</span><br>
<span class="lineno"></span><span class="comment" id="2086720">//&nbsp;owing&nbsp;to&nbsp;error&nbsp;amplification&nbsp;by&nbsp;the&nbsp;exponential&nbsp;function.</span><br>
<span class="lineno"></span><span class="comment" id="2086781">//</span><br>
<span class="lineno"></span><span class="comment" id="2086784">//&nbsp;Cephes&nbsp;Math&nbsp;Library&nbsp;Release&nbsp;2.8:&nbsp;&nbsp;June,&nbsp;2000</span><br>
<span class="lineno"></span><span class="comment" id="2086832">//&nbsp;Copyright&nbsp;1984,&nbsp;1987,&nbsp;1989,&nbsp;1992,&nbsp;2000&nbsp;by&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno">50</span><span class="comment" id="2086896">//</span><br>
<span class="lineno"></span><span class="comment" id="2086899">//&nbsp;The&nbsp;readme&nbsp;file&nbsp;at&nbsp;http://netlib.sandia.gov/cephes/&nbsp;says:</span><br>
<span class="lineno"></span><span class="comment" id="2086960">//&nbsp;&nbsp;&nbsp;&nbsp;Some&nbsp;software&nbsp;in&nbsp;this&nbsp;archive&nbsp;may&nbsp;be&nbsp;from&nbsp;the&nbsp;book&nbsp;_Methods&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="2087030">//&nbsp;Programs&nbsp;for&nbsp;Mathematical&nbsp;Functions_&nbsp;(Prentice-Hall&nbsp;or&nbsp;Simon&nbsp;&amp;&nbsp;Schuster</span><br>
<span class="lineno"></span><span class="comment" id="2087105">//&nbsp;International,&nbsp;1989)&nbsp;or&nbsp;from&nbsp;the&nbsp;Cephes&nbsp;Mathematical&nbsp;Library,&nbsp;a</span><br>
<span class="lineno">55</span><span class="comment" id="2087172">//&nbsp;commercial&nbsp;product.&nbsp;In&nbsp;either&nbsp;event,&nbsp;it&nbsp;is&nbsp;copyrighted&nbsp;by&nbsp;the&nbsp;author.</span><br>
<span class="lineno"></span><span class="comment" id="2087245">//&nbsp;What&nbsp;you&nbsp;see&nbsp;here&nbsp;may&nbsp;be&nbsp;used&nbsp;freely&nbsp;but&nbsp;it&nbsp;comes&nbsp;with&nbsp;no&nbsp;support&nbsp;or</span><br>
<span class="lineno"></span><span class="comment" id="2087317">//&nbsp;guarantee.</span><br>
<span class="lineno"></span><span class="comment" id="2087331">//</span><br>
<span class="lineno"></span><span class="comment" id="2087334">//&nbsp;&nbsp;&nbsp;The&nbsp;two&nbsp;known&nbsp;misprints&nbsp;in&nbsp;the&nbsp;book&nbsp;are&nbsp;repaired&nbsp;here&nbsp;in&nbsp;the</span><br>
<span class="lineno">60</span><span class="comment" id="2087400">//&nbsp;source&nbsp;listings&nbsp;for&nbsp;the&nbsp;gamma&nbsp;function&nbsp;and&nbsp;the&nbsp;incomplete&nbsp;beta</span><br>
<span class="lineno"></span><span class="comment" id="2087466">//&nbsp;integral.</span><br>
<span class="lineno"></span><span class="comment" id="2087479">//</span><br>
<span class="lineno"></span><span class="comment" id="2087482">//&nbsp;&nbsp;&nbsp;Stephen&nbsp;L.&nbsp;Moshier</span><br>
<span class="lineno"></span><span class="comment" id="2087506">//&nbsp;&nbsp;&nbsp;moshier@na-net.ornl.gov</span><br>
<span class="lineno">65</span><br>
<span class="lineno"></span><span class="keyword" id="2087536">var</span>&nbsp;<span class="ident" id="2087540">_gamP</span>&nbsp;<span class="op" id="2087546">=</span>&nbsp;<span class="op" id="2087548">[</span><span class="op" id="2087549">...</span><span class="op" id="2087552">]</span><span class="builtintype" id="2087553">float64</span><span class="op" id="2087560">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2087563">1.60119522476751861407e-04</span><span class="op" id="2087589">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2087592">1.19135147006586384913e-03</span><span class="op" id="2087618">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2087621">1.04213797561761569935e-02</span><span class="op" id="2087647">,</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2087650">4.76367800457137231464e-02</span><span class="op" id="2087676">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2087679">2.07448227648435975150e-01</span><span class="op" id="2087705">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2087708">4.94214826801497100753e-01</span><span class="op" id="2087734">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2087737">9.99999999999999996796e-01</span><span class="op" id="2087763">,</span><br>
<span class="lineno"></span><span class="op" id="2087765">}</span><br>
<span class="lineno">75</span><span class="keyword" id="2087767">var</span>&nbsp;<span class="ident" id="2087771">_gamQ</span>&nbsp;<span class="op" id="2087777">=</span>&nbsp;<span class="op" id="2087779">[</span><span class="op" id="2087780">...</span><span class="op" id="2087783">]</span><span class="builtintype" id="2087784">float64</span><span class="op" id="2087791">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2087794">-</span><span class="num" id="2087795">2.31581873324120129819e-05</span><span class="op" id="2087821">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2087824">5.39605580493303397842e-04</span><span class="op" id="2087850">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2087853">-</span><span class="num" id="2087854">4.45641913851797240494e-03</span><span class="op" id="2087880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2087883">1.18139785222060435552e-02</span><span class="op" id="2087909">,</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2087912">3.58236398605498653373e-02</span><span class="op" id="2087938">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2087941">-</span><span class="num" id="2087942">2.34591795718243348568e-01</span><span class="op" id="2087968">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2087971">7.14304917030273074085e-02</span><span class="op" id="2087997">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2088000">1.00000000000000000320e+00</span><span class="op" id="2088026">,</span><br>
<span class="lineno"></span><span class="op" id="2088028">}</span><br>
<span class="lineno">85</span><span class="keyword" id="2088030">var</span>&nbsp;<span class="ident" id="2088034">_gamS</span>&nbsp;<span class="op" id="2088040">=</span>&nbsp;<span class="op" id="2088042">[</span><span class="op" id="2088043">...</span><span class="op" id="2088046">]</span><span class="builtintype" id="2088047">float64</span><span class="op" id="2088054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2088057">7.87311395793093628397e-04</span><span class="op" id="2088083">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088086">-</span><span class="num" id="2088087">2.29549961613378126380e-04</span><span class="op" id="2088113">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088116">-</span><span class="num" id="2088117">2.68132617805781232825e-03</span><span class="op" id="2088143">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2088146">3.47222221605458667310e-03</span><span class="op" id="2088172">,</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="num" id="2088175">8.33333333333482257126e-02</span><span class="op" id="2088201">,</span><br>
<span class="lineno"></span><span class="op" id="2088203">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2088206">//&nbsp;Gamma&nbsp;function&nbsp;computed&nbsp;by&nbsp;Stirling&#39;s&nbsp;formula.</span><br>
<span class="lineno"></span><span class="comment" id="2088256">//&nbsp;The&nbsp;polynomial&nbsp;is&nbsp;valid&nbsp;for&nbsp;33&nbsp;&lt;=&nbsp;x&nbsp;&lt;=&nbsp;172.</span><br>
<span class="lineno">95</span><span class="keyword" id="2088303">func</span>&nbsp;<span class="ident" id="2088308">stirling</span><span class="op" id="2088316">(</span><span class="ident" id="2088317">x</span>&nbsp;<span class="builtintype" id="2088319">float64</span><span class="op" id="2088326">)</span>&nbsp;<span class="builtintype" id="2088328">float64</span>&nbsp;<span class="op" id="2088336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088339">const</span>&nbsp;<span class="op" id="2088345">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088349">SqrtTwoPi</span>&nbsp;&nbsp;&nbsp;<span class="op" id="2088361">=</span>&nbsp;<span class="num" id="2088363">2.506628274631000502417</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088389">MaxStirling</span>&nbsp;<span class="op" id="2088401">=</span>&nbsp;<span class="num" id="2088403">143.01608</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088414">)</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088417">w</span>&nbsp;<span class="op" id="2088419">:=</span>&nbsp;<span class="num" id="2088422">1</span>&nbsp;<span class="op" id="2088424">/</span>&nbsp;<span class="ident" id="2088426">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088429">w</span>&nbsp;<span class="op" id="2088431">=</span>&nbsp;<span class="num" id="2088433">1</span>&nbsp;<span class="op" id="2088435">+</span>&nbsp;<span class="ident" id="2088437">w</span><span class="op" id="2088438">*</span><span class="op" id="2088439">(</span><span class="op" id="2088440">(</span><span class="op" id="2088441">(</span><span class="op" id="2088442">(</span><span class="ident" id="2088443">_gamS</span><span class="op" id="2088448">[</span><span class="num" id="2088449">0</span><span class="op" id="2088450">]</span><span class="op" id="2088451">*</span><span class="ident" id="2088452">w</span><span class="op" id="2088453">+</span><span class="ident" id="2088454">_gamS</span><span class="op" id="2088459">[</span><span class="num" id="2088460">1</span><span class="op" id="2088461">]</span><span class="op" id="2088462">)</span><span class="op" id="2088463">*</span><span class="ident" id="2088464">w</span><span class="op" id="2088465">+</span><span class="ident" id="2088466">_gamS</span><span class="op" id="2088471">[</span><span class="num" id="2088472">2</span><span class="op" id="2088473">]</span><span class="op" id="2088474">)</span><span class="op" id="2088475">*</span><span class="ident" id="2088476">w</span><span class="op" id="2088477">+</span><span class="ident" id="2088478">_gamS</span><span class="op" id="2088483">[</span><span class="num" id="2088484">3</span><span class="op" id="2088485">]</span><span class="op" id="2088486">)</span><span class="op" id="2088487">*</span><span class="ident" id="2088488">w</span><span class="op" id="2088489">+</span><span class="ident" id="2088490">_gamS</span><span class="op" id="2088495">[</span><span class="num" id="2088496">4</span><span class="op" id="2088497">]</span><span class="op" id="2088498">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088501">y</span>&nbsp;<span class="op" id="2088503">:=</span>&nbsp;<span class="ident" id="2088506">Exp</span><span class="op" id="2088509">(</span><span class="ident" id="2088510">x</span><span class="op" id="2088511">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088514">if</span>&nbsp;<span class="ident" id="2088517">x</span>&nbsp;<span class="op" id="2088519">&gt;</span>&nbsp;<span class="ident" id="2088521">MaxStirling</span>&nbsp;<span class="op" id="2088533">{</span>&nbsp;<span class="comment" id="2088535">//&nbsp;avoid&nbsp;Pow()&nbsp;overflow</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088561">v</span>&nbsp;<span class="op" id="2088563">:=</span>&nbsp;<span class="ident" id="2088566">Pow</span><span class="op" id="2088569">(</span><span class="ident" id="2088570">x</span><span class="op" id="2088571">,</span>&nbsp;<span class="num" id="2088573">0.5</span><span class="op" id="2088576">*</span><span class="ident" id="2088577">x</span><span class="op" id="2088578">-</span><span class="num" id="2088579">0.25</span><span class="op" id="2088583">)</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088587">y</span>&nbsp;<span class="op" id="2088589">=</span>&nbsp;<span class="ident" id="2088591">v</span>&nbsp;<span class="op" id="2088593">*</span>&nbsp;<span class="op" id="2088595">(</span><span class="ident" id="2088596">v</span>&nbsp;<span class="op" id="2088598">/</span>&nbsp;<span class="ident" id="2088600">y</span><span class="op" id="2088601">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088604">}</span>&nbsp;<span class="keyword" id="2088606">else</span>&nbsp;<span class="op" id="2088611">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088615">y</span>&nbsp;<span class="op" id="2088617">=</span>&nbsp;<span class="ident" id="2088619">Pow</span><span class="op" id="2088622">(</span><span class="ident" id="2088623">x</span><span class="op" id="2088624">,</span>&nbsp;<span class="ident" id="2088626">x</span><span class="op" id="2088627">-</span><span class="num" id="2088628">0.5</span><span class="op" id="2088631">)</span>&nbsp;<span class="op" id="2088633">/</span>&nbsp;<span class="ident" id="2088635">y</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2088638">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2088641">y</span>&nbsp;<span class="op" id="2088643">=</span>&nbsp;<span class="ident" id="2088645">SqrtTwoPi</span>&nbsp;<span class="op" id="2088655">*</span>&nbsp;<span class="ident" id="2088657">y</span>&nbsp;<span class="op" id="2088659">*</span>&nbsp;<span class="ident" id="2088661">w</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088664">return</span>&nbsp;<span class="ident" id="2088671">y</span><br>
<span class="lineno"></span><span class="op" id="2088673">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="2088676">//&nbsp;Gamma&nbsp;returns&nbsp;the&nbsp;Gamma&nbsp;function&nbsp;of&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="2088718">//</span><br>
<span class="lineno">115</span><span class="comment" id="2088721">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno"></span><span class="comment" id="2088743">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2088765">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(+0)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="2088785">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(-0)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="2088805">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(x)&nbsp;=&nbsp;NaN&nbsp;for&nbsp;integer&nbsp;x&nbsp;&lt;&nbsp;0</span><br>
<span class="lineno">120</span><span class="comment" id="2088841">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(-Inf)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="2088862">//&nbsp;&nbsp;&nbsp;&nbsp;Gamma(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="keyword" id="2088882">func</span>&nbsp;<span class="ident" id="2088887">Gamma</span><span class="op" id="2088892">(</span><span class="ident" id="2088893">x</span>&nbsp;<span class="builtintype" id="2088895">float64</span><span class="op" id="2088902">)</span>&nbsp;<span class="builtintype" id="2088904">float64</span>&nbsp;<span class="op" id="2088912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2088915">const</span>&nbsp;<span class="ident" id="2088921">Euler</span>&nbsp;<span class="op" id="2088927">=</span>&nbsp;<span class="num" id="2088929">0.57721566490153286060651209008240243104215933593992</span>&nbsp;<span class="comment" id="2088982">//&nbsp;A001620</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2088994">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089012">switch</span>&nbsp;<span class="op" id="2089019">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089022">case</span>&nbsp;<span class="ident" id="2089027">isNegInt</span><span class="op" id="2089035">(</span><span class="ident" id="2089036">x</span><span class="op" id="2089037">)</span>&nbsp;<span class="op" id="2089039">||</span>&nbsp;<span class="ident" id="2089042">IsInf</span><span class="op" id="2089047">(</span><span class="ident" id="2089048">x</span><span class="op" id="2089049">,</span>&nbsp;<span class="op" id="2089051">-</span><span class="num" id="2089052">1</span><span class="op" id="2089053">)</span>&nbsp;<span class="op" id="2089055">||</span>&nbsp;<span class="ident" id="2089058">IsNaN</span><span class="op" id="2089063">(</span><span class="ident" id="2089064">x</span><span class="op" id="2089065">)</span><span class="op" id="2089066">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089070">return</span>&nbsp;<span class="ident" id="2089077">NaN</span><span class="op" id="2089080">(</span><span class="op" id="2089081">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089084">case</span>&nbsp;<span class="ident" id="2089089">x</span>&nbsp;<span class="op" id="2089091">==</span>&nbsp;<span class="num" id="2089094">0</span><span class="op" id="2089095">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089099">if</span>&nbsp;<span class="ident" id="2089102">Signbit</span><span class="op" id="2089109">(</span><span class="ident" id="2089110">x</span><span class="op" id="2089111">)</span>&nbsp;<span class="op" id="2089113">{</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089118">return</span>&nbsp;<span class="ident" id="2089125">Inf</span><span class="op" id="2089128">(</span><span class="op" id="2089129">-</span><span class="num" id="2089130">1</span><span class="op" id="2089131">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089135">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089139">return</span>&nbsp;<span class="ident" id="2089146">Inf</span><span class="op" id="2089149">(</span><span class="num" id="2089150">1</span><span class="op" id="2089151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089154">case</span>&nbsp;<span class="ident" id="2089159">x</span>&nbsp;<span class="op" id="2089161">&lt;</span>&nbsp;<span class="op" id="2089163">-</span><span class="num" id="2089164">170.5674972726612</span>&nbsp;<span class="op" id="2089182">||</span>&nbsp;<span class="ident" id="2089185">x</span>&nbsp;<span class="op" id="2089187">&gt;</span>&nbsp;<span class="num" id="2089189">171.61447887182298</span><span class="op" id="2089207">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089211">return</span>&nbsp;<span class="ident" id="2089218">Inf</span><span class="op" id="2089221">(</span><span class="num" id="2089222">1</span><span class="op" id="2089223">)</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089226">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089229">q</span>&nbsp;<span class="op" id="2089231">:=</span>&nbsp;<span class="ident" id="2089234">Abs</span><span class="op" id="2089237">(</span><span class="ident" id="2089238">x</span><span class="op" id="2089239">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089242">p</span>&nbsp;<span class="op" id="2089244">:=</span>&nbsp;<span class="ident" id="2089247">Floor</span><span class="op" id="2089252">(</span><span class="ident" id="2089253">q</span><span class="op" id="2089254">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089257">if</span>&nbsp;<span class="ident" id="2089260">q</span>&nbsp;<span class="op" id="2089262">&gt;</span>&nbsp;<span class="num" id="2089264">33</span>&nbsp;<span class="op" id="2089267">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089271">if</span>&nbsp;<span class="ident" id="2089274">x</span>&nbsp;<span class="op" id="2089276">&gt;=</span>&nbsp;<span class="num" id="2089279">0</span>&nbsp;<span class="op" id="2089281">{</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089286">return</span>&nbsp;<span class="ident" id="2089293">stirling</span><span class="op" id="2089301">(</span><span class="ident" id="2089302">x</span><span class="op" id="2089303">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089307">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089311">signgam</span>&nbsp;<span class="op" id="2089319">:=</span>&nbsp;<span class="num" id="2089322">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089326">if</span>&nbsp;<span class="ident" id="2089329">ip</span>&nbsp;<span class="op" id="2089332">:=</span>&nbsp;<span class="builtintype" id="2089335">int</span><span class="op" id="2089338">(</span><span class="ident" id="2089339">p</span><span class="op" id="2089340">)</span><span class="op" id="2089341">;</span>&nbsp;<span class="ident" id="2089343">ip</span><span class="op" id="2089345">&amp;</span><span class="num" id="2089346">1</span>&nbsp;<span class="op" id="2089348">==</span>&nbsp;<span class="num" id="2089351">0</span>&nbsp;<span class="op" id="2089353">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089358">signgam</span>&nbsp;<span class="op" id="2089366">=</span>&nbsp;<span class="op" id="2089368">-</span><span class="num" id="2089369">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089373">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089377">z</span>&nbsp;<span class="op" id="2089379">:=</span>&nbsp;<span class="ident" id="2089382">q</span>&nbsp;<span class="op" id="2089384">-</span>&nbsp;<span class="ident" id="2089386">p</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089390">if</span>&nbsp;<span class="ident" id="2089393">z</span>&nbsp;<span class="op" id="2089395">&gt;</span>&nbsp;<span class="num" id="2089397">0.5</span>&nbsp;<span class="op" id="2089401">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089406">p</span>&nbsp;<span class="op" id="2089408">=</span>&nbsp;<span class="ident" id="2089410">p</span>&nbsp;<span class="op" id="2089412">+</span>&nbsp;<span class="num" id="2089414">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089419">z</span>&nbsp;<span class="op" id="2089421">=</span>&nbsp;<span class="ident" id="2089423">q</span>&nbsp;<span class="op" id="2089425">-</span>&nbsp;<span class="ident" id="2089427">p</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089435">z</span>&nbsp;<span class="op" id="2089437">=</span>&nbsp;<span class="ident" id="2089439">q</span>&nbsp;<span class="op" id="2089441">*</span>&nbsp;<span class="ident" id="2089443">Sin</span><span class="op" id="2089446">(</span><span class="ident" id="2089447">Pi</span><span class="op" id="2089449">*</span><span class="ident" id="2089450">z</span><span class="op" id="2089451">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089455">if</span>&nbsp;<span class="ident" id="2089458">z</span>&nbsp;<span class="op" id="2089460">==</span>&nbsp;<span class="num" id="2089463">0</span>&nbsp;<span class="op" id="2089465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089470">return</span>&nbsp;<span class="ident" id="2089477">Inf</span><span class="op" id="2089480">(</span><span class="ident" id="2089481">signgam</span><span class="op" id="2089488">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089492">}</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089496">z</span>&nbsp;<span class="op" id="2089498">=</span>&nbsp;<span class="ident" id="2089500">Pi</span>&nbsp;<span class="op" id="2089503">/</span>&nbsp;<span class="op" id="2089505">(</span><span class="ident" id="2089506">Abs</span><span class="op" id="2089509">(</span><span class="ident" id="2089510">z</span><span class="op" id="2089511">)</span>&nbsp;<span class="op" id="2089513">*</span>&nbsp;<span class="ident" id="2089515">stirling</span><span class="op" id="2089523">(</span><span class="ident" id="2089524">q</span><span class="op" id="2089525">)</span><span class="op" id="2089526">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089530">return</span>&nbsp;<span class="builtintype" id="2089537">float64</span><span class="op" id="2089544">(</span><span class="ident" id="2089545">signgam</span><span class="op" id="2089552">)</span>&nbsp;<span class="op" id="2089554">*</span>&nbsp;<span class="ident" id="2089556">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089559">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="2089563">//&nbsp;Reduce&nbsp;argument</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089583">z</span>&nbsp;<span class="op" id="2089585">:=</span>&nbsp;<span class="num" id="2089588">1.0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089593">for</span>&nbsp;<span class="ident" id="2089597">x</span>&nbsp;<span class="op" id="2089599">&gt;=</span>&nbsp;<span class="num" id="2089602">3</span>&nbsp;<span class="op" id="2089604">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089608">x</span>&nbsp;<span class="op" id="2089610">=</span>&nbsp;<span class="ident" id="2089612">x</span>&nbsp;<span class="op" id="2089614">-</span>&nbsp;<span class="num" id="2089616">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089620">z</span>&nbsp;<span class="op" id="2089622">=</span>&nbsp;<span class="ident" id="2089624">z</span>&nbsp;<span class="op" id="2089626">*</span>&nbsp;<span class="ident" id="2089628">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089631">}</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089634">for</span>&nbsp;<span class="ident" id="2089638">x</span>&nbsp;<span class="op" id="2089640">&lt;</span>&nbsp;<span class="num" id="2089642">0</span>&nbsp;<span class="op" id="2089644">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089648">if</span>&nbsp;<span class="ident" id="2089651">x</span>&nbsp;<span class="op" id="2089653">&gt;</span>&nbsp;<span class="op" id="2089655">-</span><span class="num" id="2089656">1e-09</span>&nbsp;<span class="op" id="2089662">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089667">goto</span>&nbsp;<span class="ident" id="2089672">small</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089684">z</span>&nbsp;<span class="op" id="2089686">=</span>&nbsp;<span class="ident" id="2089688">z</span>&nbsp;<span class="op" id="2089690">/</span>&nbsp;<span class="ident" id="2089692">x</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089696">x</span>&nbsp;<span class="op" id="2089698">=</span>&nbsp;<span class="ident" id="2089700">x</span>&nbsp;<span class="op" id="2089702">+</span>&nbsp;<span class="num" id="2089704">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089707">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089710">for</span>&nbsp;<span class="ident" id="2089714">x</span>&nbsp;<span class="op" id="2089716">&lt;</span>&nbsp;<span class="num" id="2089718">2</span>&nbsp;<span class="op" id="2089720">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089724">if</span>&nbsp;<span class="ident" id="2089727">x</span>&nbsp;<span class="op" id="2089729">&lt;</span>&nbsp;<span class="num" id="2089731">1e-09</span>&nbsp;<span class="op" id="2089737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089742">goto</span>&nbsp;<span class="ident" id="2089747">small</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089759">z</span>&nbsp;<span class="op" id="2089761">=</span>&nbsp;<span class="ident" id="2089763">z</span>&nbsp;<span class="op" id="2089765">/</span>&nbsp;<span class="ident" id="2089767">x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089771">x</span>&nbsp;<span class="op" id="2089773">=</span>&nbsp;<span class="ident" id="2089775">x</span>&nbsp;<span class="op" id="2089777">+</span>&nbsp;<span class="num" id="2089779">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089786">if</span>&nbsp;<span class="ident" id="2089789">x</span>&nbsp;<span class="op" id="2089791">==</span>&nbsp;<span class="num" id="2089794">2</span>&nbsp;<span class="op" id="2089796">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2089800">return</span>&nbsp;<span class="ident" id="2089807">z</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2089810">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089814">x</span>&nbsp;<span class="op" id="2089816">=</span>&nbsp;<span class="ident" id="2089818">x</span>&nbsp;<span class="op" id="2089820">-</span>&nbsp;<span class="num" id="2089822">2</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089825">p</span>&nbsp;<span class="op" id="2089827">=</span>&nbsp;<span class="op" id="2089829">(</span><span class="op" id="2089830">(</span><span class="op" id="2089831">(</span><span class="op" id="2089832">(</span><span class="op" id="2089833">(</span><span class="ident" id="2089834">x</span><span class="op" id="2089835">*</span><span class="ident" id="2089836">_gamP</span><span class="op" id="2089841">[</span><span class="num" id="2089842">0</span><span class="op" id="2089843">]</span><span class="op" id="2089844">+</span><span class="ident" id="2089845">_gamP</span><span class="op" id="2089850">[</span><span class="num" id="2089851">1</span><span class="op" id="2089852">]</span><span class="op" id="2089853">)</span><span class="op" id="2089854">*</span><span class="ident" id="2089855">x</span><span class="op" id="2089856">+</span><span class="ident" id="2089857">_gamP</span><span class="op" id="2089862">[</span><span class="num" id="2089863">2</span><span class="op" id="2089864">]</span><span class="op" id="2089865">)</span><span class="op" id="2089866">*</span><span class="ident" id="2089867">x</span><span class="op" id="2089868">+</span><span class="ident" id="2089869">_gamP</span><span class="op" id="2089874">[</span><span class="num" id="2089875">3</span><span class="op" id="2089876">]</span><span class="op" id="2089877">)</span><span class="op" id="2089878">*</span><span class="ident" id="2089879">x</span><span class="op" id="2089880">+</span><span class="ident" id="2089881">_gamP</span><span class="op" id="2089886">[</span><span class="num" id="2089887">4</span><span class="op" id="2089888">]</span><span class="op" id="2089889">)</span><span class="op" id="2089890">*</span><span class="ident" id="2089891">x</span><span class="op" id="2089892">+</span><span class="ident" id="2089893">_gamP</span><span class="op" id="2089898">[</span><span class="num" id="2089899">5</span><span class="op" id="2089900">]</span><span class="op" id="2089901">)</span><span class="op" id="2089902">*</span><span class="ident" id="2089903">x</span>&nbsp;<span class="op" id="2089905">+</span>&nbsp;<span class="ident" id="2089907">_gamP</span><span class="op" id="2089912">[</span><span class="num" id="2089913">6</span><span class="op" id="2089914">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2089917">q</span>&nbsp;<span class="op" id="2089919">=</span>&nbsp;<span class="op" id="2089921">(</span><span class="op" id="2089922">(</span><span class="op" id="2089923">(</span><span class="op" id="2089924">(</span><span class="op" id="2089925">(</span><span class="op" id="2089926">(</span><span class="ident" id="2089927">x</span><span class="op" id="2089928">*</span><span class="ident" id="2089929">_gamQ</span><span class="op" id="2089934">[</span><span class="num" id="2089935">0</span><span class="op" id="2089936">]</span><span class="op" id="2089937">+</span><span class="ident" id="2089938">_gamQ</span><span class="op" id="2089943">[</span><span class="num" id="2089944">1</span><span class="op" id="2089945">]</span><span class="op" id="2089946">)</span><span class="op" id="2089947">*</span><span class="ident" id="2089948">x</span><span class="op" id="2089949">+</span><span class="ident" id="2089950">_gamQ</span><span class="op" id="2089955">[</span><span class="num" id="2089956">2</span><span class="op" id="2089957">]</span><span class="op" id="2089958">)</span><span class="op" id="2089959">*</span><span class="ident" id="2089960">x</span><span class="op" id="2089961">+</span><span class="ident" id="2089962">_gamQ</span><span class="op" id="2089967">[</span><span class="num" id="2089968">3</span><span class="op" id="2089969">]</span><span class="op" id="2089970">)</span><span class="op" id="2089971">*</span><span class="ident" id="2089972">x</span><span class="op" id="2089973">+</span><span class="ident" id="2089974">_gamQ</span><span class="op" id="2089979">[</span><span class="num" id="2089980">4</span><span class="op" id="2089981">]</span><span class="op" id="2089982">)</span><span class="op" id="2089983">*</span><span class="ident" id="2089984">x</span><span class="op" id="2089985">+</span><span class="ident" id="2089986">_gamQ</span><span class="op" id="2089991">[</span><span class="num" id="2089992">5</span><span class="op" id="2089993">]</span><span class="op" id="2089994">)</span><span class="op" id="2089995">*</span><span class="ident" id="2089996">x</span><span class="op" id="2089997">+</span><span class="ident" id="2089998">_gamQ</span><span class="op" id="2090003">[</span><span class="num" id="2090004">6</span><span class="op" id="2090005">]</span><span class="op" id="2090006">)</span><span class="op" id="2090007">*</span><span class="ident" id="2090008">x</span>&nbsp;<span class="op" id="2090010">+</span>&nbsp;<span class="ident" id="2090012">_gamQ</span><span class="op" id="2090017">[</span><span class="num" id="2090018">7</span><span class="op" id="2090019">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090022">return</span>&nbsp;<span class="ident" id="2090029">z</span>&nbsp;<span class="op" id="2090031">*</span>&nbsp;<span class="ident" id="2090033">p</span>&nbsp;<span class="op" id="2090035">/</span>&nbsp;<span class="ident" id="2090037">q</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="ident" id="2090040">small</span><span class="op" id="2090045">:</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090048">if</span>&nbsp;<span class="ident" id="2090051">x</span>&nbsp;<span class="op" id="2090053">==</span>&nbsp;<span class="num" id="2090056">0</span>&nbsp;<span class="op" id="2090058">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090062">return</span>&nbsp;<span class="ident" id="2090069">Inf</span><span class="op" id="2090072">(</span><span class="num" id="2090073">1</span><span class="op" id="2090074">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090077">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090080">return</span>&nbsp;<span class="ident" id="2090087">z</span>&nbsp;<span class="op" id="2090089">/</span>&nbsp;<span class="op" id="2090091">(</span><span class="op" id="2090092">(</span><span class="num" id="2090093">1</span>&nbsp;<span class="op" id="2090095">+</span>&nbsp;<span class="ident" id="2090097">Euler</span><span class="op" id="2090102">*</span><span class="ident" id="2090103">x</span><span class="op" id="2090104">)</span>&nbsp;<span class="op" id="2090106">*</span>&nbsp;<span class="ident" id="2090108">x</span><span class="op" id="2090109">)</span><br>
<span class="lineno"></span><span class="op" id="2090111">}</span><br>
<span class="lineno">195</span><br>
<span class="lineno"></span><span class="keyword" id="2090114">func</span>&nbsp;<span class="ident" id="2090119">isNegInt</span><span class="op" id="2090127">(</span><span class="ident" id="2090128">x</span>&nbsp;<span class="builtintype" id="2090130">float64</span><span class="op" id="2090137">)</span>&nbsp;<span class="builtintype" id="2090139">bool</span>&nbsp;<span class="op" id="2090144">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090147">if</span>&nbsp;<span class="ident" id="2090150">x</span>&nbsp;<span class="op" id="2090152">&lt;</span>&nbsp;<span class="num" id="2090154">0</span>&nbsp;<span class="op" id="2090156">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="2090160">_</span><span class="op" id="2090161">,</span>&nbsp;<span class="ident" id="2090163">xf</span>&nbsp;<span class="op" id="2090166">:=</span>&nbsp;<span class="ident" id="2090169">Modf</span><span class="op" id="2090173">(</span><span class="ident" id="2090174">x</span><span class="op" id="2090175">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090179">return</span>&nbsp;<span class="ident" id="2090186">xf</span>&nbsp;<span class="op" id="2090189">==</span>&nbsp;<span class="num" id="2090192">0</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="2090195">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="keyword" id="2090198">return</span>&nbsp;<span class="builtintype" id="2090205">false</span><br>
<span class="lineno"></span><span class="op" id="2090211">}</span>
</div>
</body>
</html>
