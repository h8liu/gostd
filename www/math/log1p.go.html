<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="1518346">//&nbsp;Copyright&nbsp;2010&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1518401">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="1518455">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="1518506">package</span>&nbsp;<span class="ident" id="1518514">math</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="1518520">//&nbsp;The&nbsp;original&nbsp;C&nbsp;code,&nbsp;the&nbsp;long&nbsp;comment,&nbsp;and&nbsp;the&nbsp;constants</span><br>
<span class="lineno"></span><span class="comment" id="1518580">//&nbsp;below&nbsp;are&nbsp;from&nbsp;FreeBSD&#39;s&nbsp;/usr/src/lib/msun/src/s_log1p.c</span><br>
<span class="lineno"></span><span class="comment" id="1518640">//&nbsp;and&nbsp;came&nbsp;with&nbsp;this&nbsp;notice.&nbsp;&nbsp;The&nbsp;go&nbsp;code&nbsp;is&nbsp;a&nbsp;simplified</span><br>
<span class="lineno">10</span><span class="comment" id="1518699">//&nbsp;version&nbsp;of&nbsp;the&nbsp;original&nbsp;C.</span><br>
<span class="lineno"></span><span class="comment" id="1518729">//</span><br>
<span class="lineno"></span><span class="comment" id="1518732">//&nbsp;====================================================</span><br>
<span class="lineno"></span><span class="comment" id="1518788">//&nbsp;Copyright&nbsp;(C)&nbsp;1993&nbsp;by&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="1518857">//</span><br>
<span class="lineno">15</span><span class="comment" id="1518860">//&nbsp;Developed&nbsp;at&nbsp;SunPro,&nbsp;a&nbsp;Sun&nbsp;Microsystems,&nbsp;Inc.&nbsp;business.</span><br>
<span class="lineno"></span><span class="comment" id="1518919">//&nbsp;Permission&nbsp;to&nbsp;use,&nbsp;copy,&nbsp;modify,&nbsp;and&nbsp;distribute&nbsp;this</span><br>
<span class="lineno"></span><span class="comment" id="1518975">//&nbsp;software&nbsp;is&nbsp;freely&nbsp;granted,&nbsp;provided&nbsp;that&nbsp;this&nbsp;notice</span><br>
<span class="lineno"></span><span class="comment" id="1519032">//&nbsp;is&nbsp;preserved.</span><br>
<span class="lineno"></span><span class="comment" id="1519049">//&nbsp;====================================================</span><br>
<span class="lineno">20</span><span class="comment" id="1519105">//</span><br>
<span class="lineno"></span><span class="comment" id="1519108">//</span><br>
<span class="lineno"></span><span class="comment" id="1519111">//&nbsp;double&nbsp;log1p(double&nbsp;x)</span><br>
<span class="lineno"></span><span class="comment" id="1519137">//</span><br>
<span class="lineno"></span><span class="comment" id="1519140">//&nbsp;Method&nbsp;:</span><br>
<span class="lineno">25</span><span class="comment" id="1519152">//&nbsp;&nbsp;&nbsp;1.&nbsp;Argument&nbsp;Reduction:&nbsp;find&nbsp;k&nbsp;and&nbsp;f&nbsp;such&nbsp;that</span><br>
<span class="lineno"></span><span class="comment" id="1519203">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1+x&nbsp;=&nbsp;2**k&nbsp;*&nbsp;(1+f),</span><br>
<span class="lineno"></span><span class="comment" id="1519247">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;&nbsp;sqrt(2)/2&nbsp;&lt;&nbsp;1+f&nbsp;&lt;&nbsp;sqrt(2)&nbsp;.</span><br>
<span class="lineno"></span><span class="comment" id="1519293">//</span><br>
<span class="lineno"></span><span class="comment" id="1519296">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note.&nbsp;If&nbsp;k=0,&nbsp;then&nbsp;f=x&nbsp;is&nbsp;exact.&nbsp;However,&nbsp;if&nbsp;k!=0,&nbsp;then&nbsp;f</span><br>
<span class="lineno">30</span><span class="comment" id="1519362">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;may&nbsp;not&nbsp;be&nbsp;representable&nbsp;exactly.&nbsp;In&nbsp;that&nbsp;case,&nbsp;a&nbsp;correction</span><br>
<span class="lineno"></span><span class="comment" id="1519431">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;term&nbsp;is&nbsp;need.&nbsp;Let&nbsp;u=1+x&nbsp;rounded.&nbsp;Let&nbsp;c&nbsp;=&nbsp;(1+x)-u,&nbsp;then</span><br>
<span class="lineno"></span><span class="comment" id="1519494">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log(1+x)&nbsp;-&nbsp;log(u)&nbsp;~&nbsp;c/u.&nbsp;Thus,&nbsp;we&nbsp;proceed&nbsp;to&nbsp;compute&nbsp;log(u),</span><br>
<span class="lineno"></span><span class="comment" id="1519563">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;add&nbsp;back&nbsp;the&nbsp;correction&nbsp;term&nbsp;c/u.</span><br>
<span class="lineno"></span><span class="comment" id="1519609">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(Note:&nbsp;when&nbsp;x&nbsp;&gt;&nbsp;2**53,&nbsp;one&nbsp;can&nbsp;simply&nbsp;return&nbsp;log(x))</span><br>
<span class="lineno">35</span><span class="comment" id="1519670">//</span><br>
<span class="lineno"></span><span class="comment" id="1519673">//&nbsp;&nbsp;&nbsp;2.&nbsp;Approximation&nbsp;of&nbsp;log1p(f).</span><br>
<span class="lineno"></span><span class="comment" id="1519708">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Let&nbsp;s&nbsp;=&nbsp;f/(2+f)&nbsp;;&nbsp;based&nbsp;on&nbsp;log(1+f)&nbsp;=&nbsp;log(1+s)&nbsp;-&nbsp;log(1-s)</span><br>
<span class="lineno"></span><span class="comment" id="1519774">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2s&nbsp;+&nbsp;2/3&nbsp;s**3&nbsp;+&nbsp;2/5&nbsp;s**5&nbsp;+&nbsp;.....,</span><br>
<span class="lineno"></span><span class="comment" id="1519827">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2s&nbsp;+&nbsp;s*R</span><br>
<span class="lineno">40</span><span class="comment" id="1519855">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;We&nbsp;use&nbsp;a&nbsp;special&nbsp;Reme&nbsp;algorithm&nbsp;on&nbsp;[0,0.1716]&nbsp;to&nbsp;generate</span><br>
<span class="lineno"></span><span class="comment" id="1519921">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a&nbsp;polynomial&nbsp;of&nbsp;degree&nbsp;14&nbsp;to&nbsp;approximate&nbsp;R&nbsp;The&nbsp;maximum&nbsp;error</span><br>
<span class="lineno"></span><span class="comment" id="1519990">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;of&nbsp;this&nbsp;polynomial&nbsp;approximation&nbsp;is&nbsp;bounded&nbsp;by&nbsp;2**-58.45.&nbsp;In</span><br>
<span class="lineno"></span><span class="comment" id="1520059">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;other&nbsp;words,</span><br>
<span class="lineno"></span><span class="comment" id="1520080">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14</span><br>
<span class="lineno">45</span><span class="comment" id="1520151">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R(z)&nbsp;~&nbsp;Lp1*s&nbsp;+Lp2*s&nbsp;+Lp3*s&nbsp;+Lp4*s&nbsp;+Lp5*s&nbsp;&nbsp;+Lp6*s&nbsp;&nbsp;+Lp7*s</span><br>
<span class="lineno"></span><span class="comment" id="1520220">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(the&nbsp;values&nbsp;of&nbsp;Lp1&nbsp;to&nbsp;Lp7&nbsp;are&nbsp;listed&nbsp;in&nbsp;the&nbsp;program)</span><br>
<span class="lineno"></span><span class="comment" id="1520281">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="1520293">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;14&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-58.45</span><br>
<span class="lineno"></span><span class="comment" id="1520348">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;Lp1*s&nbsp;+...+Lp7*s&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;R(z)&nbsp;|&nbsp;&lt;=&nbsp;2</span><br>
<span class="lineno">50</span><span class="comment" id="1520397">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|</span><br>
<span class="lineno"></span><span class="comment" id="1520441">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note&nbsp;that&nbsp;2s&nbsp;=&nbsp;f&nbsp;-&nbsp;s*f&nbsp;=&nbsp;f&nbsp;-&nbsp;hfsq&nbsp;+&nbsp;s*hfsq,&nbsp;where&nbsp;hfsq&nbsp;=&nbsp;f*f/2.</span><br>
<span class="lineno"></span><span class="comment" id="1520513">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In&nbsp;order&nbsp;to&nbsp;guarantee&nbsp;error&nbsp;in&nbsp;log&nbsp;below&nbsp;1ulp,&nbsp;we&nbsp;compute&nbsp;log</span><br>
<span class="lineno"></span><span class="comment" id="1520583">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by</span><br>
<span class="lineno"></span><span class="comment" id="1520594">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log1p(f)&nbsp;=&nbsp;f&nbsp;-&nbsp;(hfsq&nbsp;-&nbsp;s*(hfsq+R)).</span><br>
<span class="lineno">55</span><span class="comment" id="1520646">//</span><br>
<span class="lineno"></span><span class="comment" id="1520649">//&nbsp;&nbsp;&nbsp;3.&nbsp;Finally,&nbsp;log1p(x)&nbsp;=&nbsp;k*ln2&nbsp;+&nbsp;log1p(f).</span><br>
<span class="lineno"></span><span class="comment" id="1520695">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;k*ln2_hi+(f-(hfsq-(s*(hfsq+R)+k*ln2_lo)))</span><br>
<span class="lineno"></span><span class="comment" id="1520765">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Here&nbsp;ln2&nbsp;is&nbsp;split&nbsp;into&nbsp;two&nbsp;floating&nbsp;point&nbsp;number:</span><br>
<span class="lineno"></span><span class="comment" id="1520823">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ln2_hi&nbsp;+&nbsp;ln2_lo,</span><br>
<span class="lineno">60</span><span class="comment" id="1520861">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;where&nbsp;n*ln2_hi&nbsp;is&nbsp;always&nbsp;exact&nbsp;for&nbsp;|n|&nbsp;&lt;&nbsp;2000.</span><br>
<span class="lineno"></span><span class="comment" id="1520916">//</span><br>
<span class="lineno"></span><span class="comment" id="1520919">//&nbsp;Special&nbsp;cases:</span><br>
<span class="lineno"></span><span class="comment" id="1520937">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log1p(x)&nbsp;is&nbsp;NaN&nbsp;with&nbsp;signal&nbsp;if&nbsp;x&nbsp;&lt;&nbsp;-1&nbsp;(including&nbsp;-INF)&nbsp;;</span><br>
<span class="lineno"></span><span class="comment" id="1521002">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log1p(+INF)&nbsp;is&nbsp;+INF;&nbsp;log1p(-1)&nbsp;is&nbsp;-INF&nbsp;with&nbsp;signal;</span><br>
<span class="lineno">65</span><span class="comment" id="1521062">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;log1p(NaN)&nbsp;is&nbsp;that&nbsp;NaN&nbsp;with&nbsp;no&nbsp;signal.</span><br>
<span class="lineno"></span><span class="comment" id="1521109">//</span><br>
<span class="lineno"></span><span class="comment" id="1521112">//&nbsp;Accuracy:</span><br>
<span class="lineno"></span><span class="comment" id="1521125">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;according&nbsp;to&nbsp;an&nbsp;error&nbsp;analysis,&nbsp;the&nbsp;error&nbsp;is&nbsp;always&nbsp;less&nbsp;than</span><br>
<span class="lineno"></span><span class="comment" id="1521195">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1&nbsp;ulp&nbsp;(unit&nbsp;in&nbsp;the&nbsp;last&nbsp;place).</span><br>
<span class="lineno">70</span><span class="comment" id="1521235">//</span><br>
<span class="lineno"></span><span class="comment" id="1521238">//&nbsp;Constants:</span><br>
<span class="lineno"></span><span class="comment" id="1521252">//&nbsp;The&nbsp;hexadecimal&nbsp;values&nbsp;are&nbsp;the&nbsp;intended&nbsp;ones&nbsp;for&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="1521318">//&nbsp;constants.&nbsp;The&nbsp;decimal&nbsp;values&nbsp;may&nbsp;be&nbsp;used,&nbsp;provided&nbsp;that&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="1521382">//&nbsp;compiler&nbsp;will&nbsp;convert&nbsp;from&nbsp;decimal&nbsp;to&nbsp;binary&nbsp;accurately&nbsp;enough</span><br>
<span class="lineno">75</span><span class="comment" id="1521448">//&nbsp;to&nbsp;produce&nbsp;the&nbsp;hexadecimal&nbsp;values&nbsp;shown.</span><br>
<span class="lineno"></span><span class="comment" id="1521492">//</span><br>
<span class="lineno"></span><span class="comment" id="1521495">//&nbsp;Note:&nbsp;Assuming&nbsp;log()&nbsp;return&nbsp;accurate&nbsp;answer,&nbsp;the&nbsp;following</span><br>
<span class="lineno"></span><span class="comment" id="1521557">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;algorithm&nbsp;can&nbsp;be&nbsp;used&nbsp;to&nbsp;compute&nbsp;log1p(x)&nbsp;to&nbsp;within&nbsp;a&nbsp;few&nbsp;ULP:</span><br>
<span class="lineno"></span><span class="comment" id="1521629">//</span><br>
<span class="lineno">80</span><span class="comment" id="1521632">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;u&nbsp;=&nbsp;1+x;</span><br>
<span class="lineno"></span><span class="comment" id="1521657">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(u==1.0)&nbsp;return&nbsp;x&nbsp;;&nbsp;else</span><br>
<span class="lineno"></span><span class="comment" id="1521700">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;log(u)*(x/(u-1.0));</span><br>
<span class="lineno"></span><span class="comment" id="1521754">//</span><br>
<span class="lineno"></span><span class="comment" id="1521757">//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;See&nbsp;HP-15C&nbsp;Advanced&nbsp;Functions&nbsp;Handbook,&nbsp;p.193.</span><br>
<span class="lineno">85</span><br>
<span class="lineno"></span><span class="comment" id="1521814">//&nbsp;Log1p&nbsp;returns&nbsp;the&nbsp;natural&nbsp;logarithm&nbsp;of&nbsp;1&nbsp;plus&nbsp;its&nbsp;argument&nbsp;x.</span><br>
<span class="lineno"></span><span class="comment" id="1521879">//&nbsp;It&nbsp;is&nbsp;more&nbsp;accurate&nbsp;than&nbsp;Log(1&nbsp;+&nbsp;x)&nbsp;when&nbsp;x&nbsp;is&nbsp;near&nbsp;zero.</span><br>
<span class="lineno"></span><span class="comment" id="1521939">//</span><br>
<span class="lineno"></span><span class="comment" id="1521942">//&nbsp;Special&nbsp;cases&nbsp;are:</span><br>
<span class="lineno">90</span><span class="comment" id="1521964">//&nbsp;&nbsp;&nbsp;&nbspLog1p(+Inf)&nbsp;=&nbsp;+Inf</span><br>
<span class="lineno"></span><span class="comment" id="1521986">//&nbsp;&nbsp;&nbsp;&nbspLog1p(±0)&nbsp;=&nbsp;±0</span><br>
<span class="lineno"></span><span class="comment" id="1522006">//&nbsp;&nbsp;&nbsp;&nbspLog1p(-1)&nbsp;=&nbsp;-Inf</span><br>
<span class="lineno"></span><span class="comment" id="1522026">//&nbsp;&nbsp;&nbsp;&nbspLog1p(x&nbsp;&lt;&nbsp;-1)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno"></span><span class="comment" id="1522049">//&nbsp;&nbsp;&nbsp;&nbspLog1p(NaN)&nbsp;=&nbsp;NaN</span><br>
<span class="lineno">95</span><span class="keyword" id="1522069">func</span>&nbsp;<span class="ident" id="1522074">Log1p</span><span class="op" id="1522079">(</span><span class="ident" id="1522080">x</span>&nbsp;<span class="builtintype" id="1522082">float64</span><span class="op" id="1522089">)</span>&nbsp;<span class="builtintype" id="1522091">float64</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="1522100">func</span>&nbsp;<span class="ident" id="1522105">log1p</span><span class="op" id="1522110">(</span><span class="ident" id="1522111">x</span>&nbsp;<span class="builtintype" id="1522113">float64</span><span class="op" id="1522120">)</span>&nbsp;<span class="builtintype" id="1522122">float64</span>&nbsp;<span class="op" id="1522130">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1522133">const</span>&nbsp;<span class="op" id="1522139">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522143">Sqrt2M1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1522155">=</span>&nbsp;<span class="num" id="1522157">4.142135623730950488017e-01</span>&nbsp;&nbsp;<span class="comment" id="1522186">//&nbsp;Sqrt(2)-1&nbsp;=&nbsp;0x3fda827999fcef34</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522222">Sqrt2HalfM1</span>&nbsp;<span class="op" id="1522234">=</span>&nbsp;<span class="op" id="1522236">-</span><span class="num" id="1522237">2.928932188134524755992e-01</span>&nbsp;<span class="comment" id="1522265">//&nbsp;Sqrt(2)/2-1&nbsp;=&nbsp;0xbfd2bec333018866</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522303">Small</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1522315">=</span>&nbsp;<span class="num" id="1522317">1.0</span>&nbsp;<span class="op" id="1522321">/</span>&nbsp;<span class="op" id="1522323">(</span><span class="num" id="1522324">1</span>&nbsp;<span class="op" id="1522326">&lt;&lt;</span>&nbsp;<span class="num" id="1522329">29</span><span class="op" id="1522331">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1522346">//&nbsp;2**-29&nbsp;=&nbsp;0x3e20000000000000</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522379">Tiny</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1522391">=</span>&nbsp;<span class="num" id="1522393">1.0</span>&nbsp;<span class="op" id="1522397">/</span>&nbsp;<span class="op" id="1522399">(</span><span class="num" id="1522400">1</span>&nbsp;<span class="op" id="1522402">&lt;&lt;</span>&nbsp;<span class="num" id="1522405">54</span><span class="op" id="1522407">)</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1522422">//&nbsp;2**-54</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522434">Two53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1522446">=</span>&nbsp;<span class="num" id="1522448">1</span>&nbsp;<span class="op" id="1522450">&lt;&lt;</span>&nbsp;<span class="num" id="1522453">53</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1522477">//&nbsp;2**53</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522488">Ln2Hi</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1522500">=</span>&nbsp;<span class="num" id="1522502">6.93147180369123816490e-01</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1522531">//&nbsp;3fe62e42fee00000</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522553">Ln2Lo</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1522565">=</span>&nbsp;<span class="num" id="1522567">1.90821492927058770002e-10</span>&nbsp;&nbsp;&nbsp;<span class="comment" id="1522596">//&nbsp;3dea39ef35793c76</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522618">Lp1</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1522630">=</span>&nbsp;<span class="num" id="1522632">6.666666666666735130e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1522661">//&nbsp;3FE5555555555593</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522683">Lp2</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1522695">=</span>&nbsp;<span class="num" id="1522697">3.999999999940941908e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1522726">//&nbsp;3FD999999997FA04</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522748">Lp3</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1522760">=</span>&nbsp;<span class="num" id="1522762">2.857142874366239149e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1522791">//&nbsp;3FD2492494229359</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522813">Lp4</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1522825">=</span>&nbsp;<span class="num" id="1522827">2.222219843214978396e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1522856">//&nbsp;3FCC71C51D8E78AF</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522878">Lp5</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1522890">=</span>&nbsp;<span class="num" id="1522892">1.818357216161805012e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1522921">//&nbsp;3FC7466496CB03DE</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1522943">Lp6</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1522955">=</span>&nbsp;<span class="num" id="1522957">1.531383769920937332e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1522986">//&nbsp;3FC39A09D078C69F</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1523008">Lp7</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="1523020">=</span>&nbsp;<span class="num" id="1523022">1.479819860511658591e-01</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="1523051">//&nbsp;3FC2F112DF3E5244</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1523072">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1523076">//&nbsp;special&nbsp;cases</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523094">switch</span>&nbsp;<span class="op" id="1523101">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523104">case</span>&nbsp;<span class="ident" id="1523109"><a href="/math/log1p.go.html#1522111">x</a></span>&nbsp;<span class="op" id="1523111">&lt;</span>&nbsp;<span class="op" id="1523113">-</span><span class="num" id="1523114">1</span>&nbsp;<span class="op" id="1523116">||</span>&nbsp;<span class="ident" id="1523119"><a href="/math/bits.go.html#1427394">IsNaN</a></span><span class="op" id="1523124">(</span><span class="ident" id="1523125"><a href="/math/log1p.go.html#1522111">x</a></span><span class="op" id="1523126">)</span><span class="op" id="1523127">:</span>&nbsp;<span class="comment" id="1523129">//&nbsp;includes&nbsp;-Inf</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523148">return</span>&nbsp;<span class="ident" id="1523155"><a href="/math/bits.go.html#1427274">NaN</a></span><span class="op" id="1523158">(</span><span class="op" id="1523159">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523162">case</span>&nbsp;<span class="ident" id="1523167"><a href="/math/log1p.go.html#1522111">x</a></span>&nbsp;<span class="op" id="1523169">==</span>&nbsp;<span class="op" id="1523172">-</span><span class="num" id="1523173">1</span><span class="op" id="1523174">:</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523178">return</span>&nbsp;<span class="ident" id="1523185"><a href="/math/bits.go.html#1427094">Inf</a></span><span class="op" id="1523188">(</span><span class="op" id="1523189">-</span><span class="num" id="1523190">1</span><span class="op" id="1523191">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523194">case</span>&nbsp;<span class="ident" id="1523199"><a href="/math/bits.go.html#1427892">IsInf</a></span><span class="op" id="1523204">(</span><span class="ident" id="1523205"><a href="/math/log1p.go.html#1522111">x</a></span><span class="op" id="1523206">,</span>&nbsp;<span class="num" id="1523208">1</span><span class="op" id="1523209">)</span><span class="op" id="1523210">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523214">return</span>&nbsp;<span class="ident" id="1523221"><a href="/math/bits.go.html#1427094">Inf</a></span><span class="op" id="1523224">(</span><span class="num" id="1523225">1</span><span class="op" id="1523226">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1523229">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1523233">absx</span>&nbsp;<span class="op" id="1523238">:=</span>&nbsp;<span class="ident" id="1523241"><a href="/math/log1p.go.html#1522111">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523244">if</span>&nbsp;<span class="ident" id="1523247"><a href="/math/log1p.go.html#1523233">absx</a></span>&nbsp;<span class="op" id="1523252">&lt;</span>&nbsp;<span class="num" id="1523254">0</span>&nbsp;<span class="op" id="1523256">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1523260"><a href="/math/log1p.go.html#1523233">absx</a></span>&nbsp;<span class="op" id="1523265">=</span>&nbsp;<span class="op" id="1523267">-</span><span class="ident" id="1523268"><a href="/math/log1p.go.html#1523233">absx</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1523274">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523278">var</span>&nbsp;<span class="ident" id="1523282">f</span>&nbsp;<span class="builtintype" id="1523284">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523293">var</span>&nbsp;<span class="ident" id="1523297">iu</span>&nbsp;<span class="ident" id="1523300">uint64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1523308">k</span>&nbsp;<span class="op" id="1523310">:=</span>&nbsp;<span class="num" id="1523313">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523316">if</span>&nbsp;<span class="ident" id="1523319"><a href="/math/log1p.go.html#1523233">absx</a></span>&nbsp;<span class="op" id="1523324">&lt;</span>&nbsp;<span class="ident" id="1523326"><a href="/math/log1p.go.html#1522143">Sqrt2M1</a></span>&nbsp;<span class="op" id="1523334">{</span>&nbsp;<span class="comment" id="1523336">//&nbsp;&nbsp;|x|&nbsp;&lt;&nbsp;Sqrt(2)-1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523358">if</span>&nbsp;<span class="ident" id="1523361"><a href="/math/log1p.go.html#1523233">absx</a></span>&nbsp;<span class="op" id="1523366">&lt;</span>&nbsp;<span class="ident" id="1523368"><a href="/math/log1p.go.html#1522303">Small</a></span>&nbsp;<span class="op" id="1523374">{</span>&nbsp;<span class="comment" id="1523376">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-29</span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523395">if</span>&nbsp;<span class="ident" id="1523398"><a href="/math/log1p.go.html#1523233">absx</a></span>&nbsp;<span class="op" id="1523403">&lt;</span>&nbsp;<span class="ident" id="1523405"><a href="/math/log1p.go.html#1522379">Tiny</a></span>&nbsp;<span class="op" id="1523410">{</span>&nbsp;<span class="comment" id="1523412">//&nbsp;|x|&nbsp;&lt;&nbsp;2**-54</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523432">return</span>&nbsp;<span class="ident" id="1523439"><a href="/math/log1p.go.html#1522111">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1523444">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523449">return</span>&nbsp;<span class="ident" id="1523456"><a href="/math/log1p.go.html#1522111">x</a></span>&nbsp;<span class="op" id="1523458">-</span>&nbsp;<span class="ident" id="1523460"><a href="/math/log1p.go.html#1522111">x</a></span><span class="op" id="1523461">*</span><span class="ident" id="1523462"><a href="/math/log1p.go.html#1522111">x</a></span><span class="op" id="1523463">*</span><span class="num" id="1523464">0.5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1523470">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523474">if</span>&nbsp;<span class="ident" id="1523477"><a href="/math/log1p.go.html#1522111">x</a></span>&nbsp;<span class="op" id="1523479">&gt;</span>&nbsp;<span class="ident" id="1523481"><a href="/math/log1p.go.html#1522222">Sqrt2HalfM1</a></span>&nbsp;<span class="op" id="1523493">{</span>&nbsp;<span class="comment" id="1523495">//&nbsp;Sqrt(2)/2-1&nbsp;&lt;&nbsp;x</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="1523517">//&nbsp;(Sqrt(2)/2-1)&nbsp;&lt;&nbsp;x&nbsp;&lt;&nbsp;(Sqrt(2)-1)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1523555"><a href="/math/log1p.go.html#1523308">k</a></span>&nbsp;<span class="op" id="1523557">=</span>&nbsp;<span class="num" id="1523559">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1523564"><a href="/math/log1p.go.html#1523282">f</a></span>&nbsp;<span class="op" id="1523566">=</span>&nbsp;<span class="ident" id="1523568"><a href="/math/log1p.go.html#1522111">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1523573"><a href="/math/log1p.go.html#1523297">iu</a></span>&nbsp;<span class="op" id="1523576">=</span>&nbsp;<span class="num" id="1523578">1</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1523582">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1523585">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523588">var</span>&nbsp;<span class="ident" id="1523592">c</span>&nbsp;<span class="builtintype" id="1523594">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523603">if</span>&nbsp;<span class="ident" id="1523606"><a href="/math/log1p.go.html#1523308">k</a></span>&nbsp;<span class="op" id="1523608">!=</span>&nbsp;<span class="num" id="1523611">0</span>&nbsp;<span class="op" id="1523613">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523617">var</span>&nbsp;<span class="ident" id="1523621">u</span>&nbsp;<span class="builtintype" id="1523623">float64</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523633">if</span>&nbsp;<span class="ident" id="1523636"><a href="/math/log1p.go.html#1523233">absx</a></span>&nbsp;<span class="op" id="1523641">&lt;</span>&nbsp;<span class="ident" id="1523643"><a href="/math/log1p.go.html#1522434">Two53</a></span>&nbsp;<span class="op" id="1523649">{</span>&nbsp;<span class="comment" id="1523651">//&nbsp;1&lt;&lt;53</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1523663"><a href="/math/log1p.go.html#1523621">u</a></span>&nbsp;<span class="op" id="1523665">=</span>&nbsp;<span class="num" id="1523667">1.0</span>&nbsp;<span class="op" id="1523671">+</span>&nbsp;<span class="ident" id="1523673"><a href="/math/log1p.go.html#1522111">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1523678"><a href="/math/log1p.go.html#1523297">iu</a></span>&nbsp;<span class="op" id="1523681">=</span>&nbsp;<span class="ident" id="1523683"><a href="/math/unsafe.go.html#1556032">Float64bits</a></span><span class="op" id="1523694">(</span><span class="ident" id="1523695"><a href="/math/log1p.go.html#1523621">u</a></span><span class="op" id="1523696">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1523701"><a href="/math/log1p.go.html#1523308">k</a></span>&nbsp;<span class="op" id="1523703">=</span>&nbsp;<span class="builtintype" id="1523705">int</span><span class="op" id="1523708">(</span><span class="op" id="1523709">(</span><span class="ident" id="1523710"><a href="/math/log1p.go.html#1523297">iu</a></span>&nbsp;<span class="op" id="1523713">&gt;&gt;</span>&nbsp;<span class="num" id="1523716">52</span><span class="op" id="1523718">)</span>&nbsp;<span class="op" id="1523720">-</span>&nbsp;<span class="num" id="1523722">1023</span><span class="op" id="1523726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523731">if</span>&nbsp;<span class="ident" id="1523734"><a href="/math/log1p.go.html#1523308">k</a></span>&nbsp;<span class="op" id="1523736">&gt;</span>&nbsp;<span class="num" id="1523738">0</span>&nbsp;<span class="op" id="1523740">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1523746"><a href="/math/log1p.go.html#1523592">c</a></span>&nbsp;<span class="op" id="1523748">=</span>&nbsp;<span class="num" id="1523750">1.0</span>&nbsp;<span class="op" id="1523754">-</span>&nbsp;<span class="op" id="1523756">(</span><span class="ident" id="1523757"><a href="/math/log1p.go.html#1523621">u</a></span>&nbsp;<span class="op" id="1523759">-</span>&nbsp;<span class="ident" id="1523761"><a href="/math/log1p.go.html#1522111">x</a></span><span class="op" id="1523762">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1523767">}</span>&nbsp;<span class="keyword" id="1523769">else</span>&nbsp;<span class="op" id="1523774">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1523780"><a href="/math/log1p.go.html#1523592">c</a></span>&nbsp;<span class="op" id="1523782">=</span>&nbsp;<span class="ident" id="1523784"><a href="/math/log1p.go.html#1522111">x</a></span>&nbsp;<span class="op" id="1523786">-</span>&nbsp;<span class="op" id="1523788">(</span><span class="ident" id="1523789"><a href="/math/log1p.go.html#1523621">u</a></span>&nbsp;<span class="op" id="1523791">-</span>&nbsp;<span class="num" id="1523793">1.0</span><span class="op" id="1523796">)</span>&nbsp;<span class="comment" id="1523798">//&nbsp;correction&nbsp;term</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1523821"><a href="/math/log1p.go.html#1523592">c</a></span>&nbsp;<span class="op" id="1523823">/=</span>&nbsp;<span class="ident" id="1523826"><a href="/math/log1p.go.html#1523621">u</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1523831">}</span><br>
<span class="lineno">160</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1523835">}</span>&nbsp;<span class="keyword" id="1523837">else</span>&nbsp;<span class="op" id="1523842">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1523847"><a href="/math/log1p.go.html#1523621">u</a></span>&nbsp;<span class="op" id="1523849">=</span>&nbsp;<span class="ident" id="1523851"><a href="/math/log1p.go.html#1522111">x</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1523856"><a href="/math/log1p.go.html#1523297">iu</a></span>&nbsp;<span class="op" id="1523859">=</span>&nbsp;<span class="ident" id="1523861"><a href="/math/unsafe.go.html#1556032">Float64bits</a></span><span class="op" id="1523872">(</span><span class="ident" id="1523873"><a href="/math/log1p.go.html#1523621">u</a></span><span class="op" id="1523874">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1523879"><a href="/math/log1p.go.html#1523308">k</a></span>&nbsp;<span class="op" id="1523881">=</span>&nbsp;<span class="builtintype" id="1523883">int</span><span class="op" id="1523886">(</span><span class="op" id="1523887">(</span><span class="ident" id="1523888"><a href="/math/log1p.go.html#1523297">iu</a></span>&nbsp;<span class="op" id="1523891">&gt;&gt;</span>&nbsp;<span class="num" id="1523894">52</span><span class="op" id="1523896">)</span>&nbsp;<span class="op" id="1523898">-</span>&nbsp;<span class="num" id="1523900">1023</span><span class="op" id="1523904">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1523909"><a href="/math/log1p.go.html#1523592">c</a></span>&nbsp;<span class="op" id="1523911">=</span>&nbsp;<span class="num" id="1523913">0</span><br>
<span class="lineno">165</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1523917">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1523921"><a href="/math/log1p.go.html#1523297">iu</a></span>&nbsp;<span class="op" id="1523924">&amp;=</span>&nbsp;<span class="num" id="1523927">0x000fffffffffffff</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1523948">if</span>&nbsp;<span class="ident" id="1523951"><a href="/math/log1p.go.html#1523297">iu</a></span>&nbsp;<span class="op" id="1523954">&lt;</span>&nbsp;<span class="num" id="1523956">0x0006a09e667f3bcd</span>&nbsp;<span class="op" id="1523975">{</span>&nbsp;<span class="comment" id="1523977">//&nbsp;mantissa&nbsp;of&nbsp;Sqrt(2)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1524003"><a href="/math/log1p.go.html#1523621">u</a></span>&nbsp;<span class="op" id="1524005">=</span>&nbsp;<span class="ident" id="1524007"><a href="/math/unsafe.go.html#1556218">Float64frombits</a></span><span class="op" id="1524022">(</span><span class="ident" id="1524023"><a href="/math/log1p.go.html#1523297">iu</a></span>&nbsp;<span class="op" id="1524026">|</span>&nbsp;<span class="num" id="1524028">0x3ff0000000000000</span><span class="op" id="1524046">)</span>&nbsp;<span class="comment" id="1524048">//&nbsp;normalize&nbsp;u</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1524065">}</span>&nbsp;<span class="keyword" id="1524067">else</span>&nbsp;<span class="op" id="1524072">{</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1524077"><a href="/math/log1p.go.html#1523308">k</a></span>&nbsp;<span class="op" id="1524079">+=</span>&nbsp;<span class="num" id="1524082">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1524087"><a href="/math/log1p.go.html#1523621">u</a></span>&nbsp;<span class="op" id="1524089">=</span>&nbsp;<span class="ident" id="1524091"><a href="/math/unsafe.go.html#1556218">Float64frombits</a></span><span class="op" id="1524106">(</span><span class="ident" id="1524107"><a href="/math/log1p.go.html#1523297">iu</a></span>&nbsp;<span class="op" id="1524110">|</span>&nbsp;<span class="num" id="1524112">0x3fe0000000000000</span><span class="op" id="1524130">)</span>&nbsp;<span class="comment" id="1524132">//&nbsp;normalize&nbsp;u/2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1524152"><a href="/math/log1p.go.html#1523297">iu</a></span>&nbsp;<span class="op" id="1524155">=</span>&nbsp;<span class="op" id="1524157">(</span><span class="num" id="1524158">0x0010000000000000</span>&nbsp;<span class="op" id="1524177">-</span>&nbsp;<span class="ident" id="1524179"><a href="/math/log1p.go.html#1523297">iu</a></span><span class="op" id="1524181">)</span>&nbsp;<span class="op" id="1524183">&gt;&gt;</span>&nbsp;<span class="num" id="1524186">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1524190">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1524194"><a href="/math/log1p.go.html#1523282">f</a></span>&nbsp;<span class="op" id="1524196">=</span>&nbsp;<span class="ident" id="1524198"><a href="/math/log1p.go.html#1523621">u</a></span>&nbsp;<span class="op" id="1524200">-</span>&nbsp;<span class="num" id="1524202">1.0</span>&nbsp;<span class="comment" id="1524206">//&nbsp;Sqrt(2)/2&nbsp;&lt;&nbsp;u&nbsp;&lt;&nbsp;Sqrt(2)</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1524234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1524237">hfsq</span>&nbsp;<span class="op" id="1524242">:=</span>&nbsp;<span class="num" id="1524245">0.5</span>&nbsp;<span class="op" id="1524249">*</span>&nbsp;<span class="ident" id="1524251"><a href="/math/log1p.go.html#1523282">f</a></span>&nbsp;<span class="op" id="1524253">*</span>&nbsp;<span class="ident" id="1524255"><a href="/math/log1p.go.html#1523282">f</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1524258">var</span>&nbsp;<span class="ident" id="1524262">s</span><span class="op" id="1524263">,</span>&nbsp;<span class="ident" id="1524265">R</span><span class="op" id="1524266">,</span>&nbsp;<span class="ident" id="1524268">z</span>&nbsp;<span class="builtintype" id="1524270">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1524279">if</span>&nbsp;<span class="ident" id="1524282"><a href="/math/log1p.go.html#1523297">iu</a></span>&nbsp;<span class="op" id="1524285">==</span>&nbsp;<span class="num" id="1524288">0</span>&nbsp;<span class="op" id="1524290">{</span>&nbsp;<span class="comment" id="1524292">//&nbsp;|f|&nbsp;&lt;&nbsp;2**-20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1524310">if</span>&nbsp;<span class="ident" id="1524313"><a href="/math/log1p.go.html#1523282">f</a></span>&nbsp;<span class="op" id="1524315">==</span>&nbsp;<span class="num" id="1524318">0</span>&nbsp;<span class="op" id="1524320">{</span><br>
<span class="lineno">180</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1524325">if</span>&nbsp;<span class="ident" id="1524328"><a href="/math/log1p.go.html#1523308">k</a></span>&nbsp;<span class="op" id="1524330">==</span>&nbsp;<span class="num" id="1524333">0</span>&nbsp;<span class="op" id="1524335">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1524341">return</span>&nbsp;<span class="num" id="1524348">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1524353">}</span>&nbsp;<span class="keyword" id="1524355">else</span>&nbsp;<span class="op" id="1524360">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1524366"><a href="/math/log1p.go.html#1523592">c</a></span>&nbsp;<span class="op" id="1524368">+=</span>&nbsp;<span class="builtintype" id="1524371">float64</span><span class="op" id="1524378">(</span><span class="ident" id="1524379"><a href="/math/log1p.go.html#1523308">k</a></span><span class="op" id="1524380">)</span>&nbsp;<span class="op" id="1524382">*</span>&nbsp;<span class="ident" id="1524384"><a href="/math/log1p.go.html#1522553">Ln2Lo</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1524394">return</span>&nbsp;<span class="builtintype" id="1524401">float64</span><span class="op" id="1524408">(</span><span class="ident" id="1524409"><a href="/math/log1p.go.html#1523308">k</a></span><span class="op" id="1524410">)</span><span class="op" id="1524411">*</span><span class="ident" id="1524412"><a href="/math/log1p.go.html#1522488">Ln2Hi</a></span>&nbsp;<span class="op" id="1524418">+</span>&nbsp;<span class="ident" id="1524420"><a href="/math/log1p.go.html#1523592">c</a></span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1524425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1524429">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1524433"><a href="/math/log1p.go.html#1524265">R</a></span>&nbsp;<span class="op" id="1524435">=</span>&nbsp;<span class="ident" id="1524437"><a href="/math/log1p.go.html#1524237">hfsq</a></span>&nbsp;<span class="op" id="1524442">*</span>&nbsp;<span class="op" id="1524444">(</span><span class="num" id="1524445">1.0</span>&nbsp;<span class="op" id="1524449">-</span>&nbsp;<span class="num" id="1524451">0.66666666666666666</span><span class="op" id="1524470">*</span><span class="ident" id="1524471"><a href="/math/log1p.go.html#1523282">f</a></span><span class="op" id="1524472">)</span>&nbsp;<span class="comment" id="1524474">//&nbsp;avoid&nbsp;division</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1524494">if</span>&nbsp;<span class="ident" id="1524497"><a href="/math/log1p.go.html#1523308">k</a></span>&nbsp;<span class="op" id="1524499">==</span>&nbsp;<span class="num" id="1524502">0</span>&nbsp;<span class="op" id="1524504">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1524509">return</span>&nbsp;<span class="ident" id="1524516"><a href="/math/log1p.go.html#1523282">f</a></span>&nbsp;<span class="op" id="1524518">-</span>&nbsp;<span class="ident" id="1524520"><a href="/math/log1p.go.html#1524265">R</a></span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1524524">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1524528">return</span>&nbsp;<span class="builtintype" id="1524535">float64</span><span class="op" id="1524542">(</span><span class="ident" id="1524543"><a href="/math/log1p.go.html#1523308">k</a></span><span class="op" id="1524544">)</span><span class="op" id="1524545">*</span><span class="ident" id="1524546"><a href="/math/log1p.go.html#1522488">Ln2Hi</a></span>&nbsp;<span class="op" id="1524552">-</span>&nbsp;<span class="op" id="1524554">(</span><span class="op" id="1524555">(</span><span class="ident" id="1524556"><a href="/math/log1p.go.html#1524265">R</a></span>&nbsp;<span class="op" id="1524558">-</span>&nbsp;<span class="op" id="1524560">(</span><span class="builtintype" id="1524561">float64</span><span class="op" id="1524568">(</span><span class="ident" id="1524569"><a href="/math/log1p.go.html#1523308">k</a></span><span class="op" id="1524570">)</span><span class="op" id="1524571">*</span><span class="ident" id="1524572"><a href="/math/log1p.go.html#1522553">Ln2Lo</a></span>&nbsp;<span class="op" id="1524578">+</span>&nbsp;<span class="ident" id="1524580"><a href="/math/log1p.go.html#1523592">c</a></span><span class="op" id="1524581">)</span><span class="op" id="1524582">)</span>&nbsp;<span class="op" id="1524584">-</span>&nbsp;<span class="ident" id="1524586"><a href="/math/log1p.go.html#1523282">f</a></span><span class="op" id="1524587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1524590">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1524593"><a href="/math/log1p.go.html#1524262">s</a></span>&nbsp;<span class="op" id="1524595">=</span>&nbsp;<span class="ident" id="1524597"><a href="/math/log1p.go.html#1523282">f</a></span>&nbsp;<span class="op" id="1524599">/</span>&nbsp;<span class="op" id="1524601">(</span><span class="num" id="1524602">2.0</span>&nbsp;<span class="op" id="1524606">+</span>&nbsp;<span class="ident" id="1524608"><a href="/math/log1p.go.html#1523282">f</a></span><span class="op" id="1524609">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1524612"><a href="/math/log1p.go.html#1524268">z</a></span>&nbsp;<span class="op" id="1524614">=</span>&nbsp;<span class="ident" id="1524616"><a href="/math/log1p.go.html#1524262">s</a></span>&nbsp;<span class="op" id="1524618">*</span>&nbsp;<span class="ident" id="1524620"><a href="/math/log1p.go.html#1524262">s</a></span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="1524623"><a href="/math/log1p.go.html#1524265">R</a></span>&nbsp;<span class="op" id="1524625">=</span>&nbsp;<span class="ident" id="1524627"><a href="/math/log1p.go.html#1524268">z</a></span>&nbsp;<span class="op" id="1524629">*</span>&nbsp;<span class="op" id="1524631">(</span><span class="ident" id="1524632"><a href="/math/log1p.go.html#1522618">Lp1</a></span>&nbsp;<span class="op" id="1524636">+</span>&nbsp;<span class="ident" id="1524638"><a href="/math/log1p.go.html#1524268">z</a></span><span class="op" id="1524639">*</span><span class="op" id="1524640">(</span><span class="ident" id="1524641"><a href="/math/log1p.go.html#1522683">Lp2</a></span><span class="op" id="1524644">+</span><span class="ident" id="1524645"><a href="/math/log1p.go.html#1524268">z</a></span><span class="op" id="1524646">*</span><span class="op" id="1524647">(</span><span class="ident" id="1524648"><a href="/math/log1p.go.html#1522748">Lp3</a></span><span class="op" id="1524651">+</span><span class="ident" id="1524652"><a href="/math/log1p.go.html#1524268">z</a></span><span class="op" id="1524653">*</span><span class="op" id="1524654">(</span><span class="ident" id="1524655"><a href="/math/log1p.go.html#1522813">Lp4</a></span><span class="op" id="1524658">+</span><span class="ident" id="1524659"><a href="/math/log1p.go.html#1524268">z</a></span><span class="op" id="1524660">*</span><span class="op" id="1524661">(</span><span class="ident" id="1524662"><a href="/math/log1p.go.html#1522878">Lp5</a></span><span class="op" id="1524665">+</span><span class="ident" id="1524666"><a href="/math/log1p.go.html#1524268">z</a></span><span class="op" id="1524667">*</span><span class="op" id="1524668">(</span><span class="ident" id="1524669"><a href="/math/log1p.go.html#1522943">Lp6</a></span><span class="op" id="1524672">+</span><span class="ident" id="1524673"><a href="/math/log1p.go.html#1524268">z</a></span><span class="op" id="1524674">*</span><span class="ident" id="1524675"><a href="/math/log1p.go.html#1523008">Lp7</a></span><span class="op" id="1524678">)</span><span class="op" id="1524679">)</span><span class="op" id="1524680">)</span><span class="op" id="1524681">)</span><span class="op" id="1524682">)</span><span class="op" id="1524683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1524686">if</span>&nbsp;<span class="ident" id="1524689"><a href="/math/log1p.go.html#1523308">k</a></span>&nbsp;<span class="op" id="1524691">==</span>&nbsp;<span class="num" id="1524694">0</span>&nbsp;<span class="op" id="1524696">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1524700">return</span>&nbsp;<span class="ident" id="1524707"><a href="/math/log1p.go.html#1523282">f</a></span>&nbsp;<span class="op" id="1524709">-</span>&nbsp;<span class="op" id="1524711">(</span><span class="ident" id="1524712"><a href="/math/log1p.go.html#1524237">hfsq</a></span>&nbsp;<span class="op" id="1524717">-</span>&nbsp;<span class="ident" id="1524719"><a href="/math/log1p.go.html#1524262">s</a></span><span class="op" id="1524720">*</span><span class="op" id="1524721">(</span><span class="ident" id="1524722"><a href="/math/log1p.go.html#1524237">hfsq</a></span><span class="op" id="1524726">+</span><span class="ident" id="1524727"><a href="/math/log1p.go.html#1524265">R</a></span><span class="op" id="1524728">)</span><span class="op" id="1524729">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="1524732">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="1524735">return</span>&nbsp;<span class="builtintype" id="1524742">float64</span><span class="op" id="1524749">(</span><span class="ident" id="1524750"><a href="/math/log1p.go.html#1523308">k</a></span><span class="op" id="1524751">)</span><span class="op" id="1524752">*</span><span class="ident" id="1524753"><a href="/math/log1p.go.html#1522488">Ln2Hi</a></span>&nbsp;<span class="op" id="1524759">-</span>&nbsp;<span class="op" id="1524761">(</span><span class="op" id="1524762">(</span><span class="ident" id="1524763"><a href="/math/log1p.go.html#1524237">hfsq</a></span>&nbsp;<span class="op" id="1524768">-</span>&nbsp;<span class="op" id="1524770">(</span><span class="ident" id="1524771"><a href="/math/log1p.go.html#1524262">s</a></span><span class="op" id="1524772">*</span><span class="op" id="1524773">(</span><span class="ident" id="1524774"><a href="/math/log1p.go.html#1524237">hfsq</a></span><span class="op" id="1524778">+</span><span class="ident" id="1524779"><a href="/math/log1p.go.html#1524265">R</a></span><span class="op" id="1524780">)</span>&nbsp;<span class="op" id="1524782">+</span>&nbsp;<span class="op" id="1524784">(</span><span class="builtintype" id="1524785">float64</span><span class="op" id="1524792">(</span><span class="ident" id="1524793"><a href="/math/log1p.go.html#1523308">k</a></span><span class="op" id="1524794">)</span><span class="op" id="1524795">*</span><span class="ident" id="1524796"><a href="/math/log1p.go.html#1522553">Ln2Lo</a></span>&nbsp;<span class="op" id="1524802">+</span>&nbsp;<span class="ident" id="1524804"><a href="/math/log1p.go.html#1523592">c</a></span><span class="op" id="1524805">)</span><span class="op" id="1524806">)</span><span class="op" id="1524807">)</span>&nbsp;<span class="op" id="1524809">-</span>&nbsp;<span class="ident" id="1524811"><a href="/math/log1p.go.html#1523282">f</a></span><span class="op" id="1524812">)</span><br>
<span class="lineno">200</span><span class="op" id="1524814">}</span>
</div>
</body>
</html>
