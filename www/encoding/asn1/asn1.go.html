<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="4204212">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4204267">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4204321">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4204372">//&nbsp;Package&nbsp;asn1&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structures,</span><br>
<span class="lineno"></span><span class="comment" id="4204445">//&nbsp;as&nbsp;defined&nbsp;in&nbsp;ITU-T&nbsp;Rec&nbsp;X.690.</span><br>
<span class="lineno"></span><span class="comment" id="4204479">//</span><br>
<span class="lineno"></span><span class="comment" id="4204482">//&nbsp;See&nbsp;also&nbsp;``A&nbsp;Layman&#39;s&nbsp;Guide&nbsp;to&nbsp;a&nbsp;Subset&nbsp;of&nbsp;ASN.1,&nbsp;BER,&nbsp;and&nbsp;DER,&#39;&#39;</span><br>
<span class="lineno"></span><span class="comment" id="4204551">//&nbsp;http://luca.ntop.org/Teaching/Appunti/asn1.html.</span><br>
<span class="lineno">10</span><span class="keyword" id="4204603">package</span>&nbsp;<span class="ident" id="4204611">asn1</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4204617">//&nbsp;ASN.1&nbsp;is&nbsp;a&nbsp;syntax&nbsp;for&nbsp;specifying&nbsp;abstract&nbsp;objects&nbsp;and&nbsp;BER,&nbsp;DER,&nbsp;PER,&nbsp;XER&nbsp;etc</span><br>
<span class="lineno"></span><span class="comment" id="4204697">//&nbsp;are&nbsp;different&nbsp;encoding&nbsp;formats&nbsp;for&nbsp;those&nbsp;objects.&nbsp;Here,&nbsp;we&#39;ll&nbsp;be&nbsp;dealing</span><br>
<span class="lineno"></span><span class="comment" id="4204773">//&nbsp;with&nbsp;DER,&nbsp;the&nbsp;Distinguished&nbsp;Encoding&nbsp;Rules.&nbsp;DER&nbsp;is&nbsp;used&nbsp;in&nbsp;X.509&nbsp;because</span><br>
<span class="lineno">15</span><span class="comment" id="4204849">//&nbsp;it&#39;s&nbsp;fast&nbsp;to&nbsp;parse&nbsp;and,&nbsp;unlike&nbsp;BER,&nbsp;has&nbsp;a&nbsp;unique&nbsp;encoding&nbsp;for&nbsp;every&nbsp;object.</span><br>
<span class="lineno"></span><span class="comment" id="4204928">//&nbsp;When&nbsp;calculating&nbsp;hashes&nbsp;over&nbsp;objects,&nbsp;it&#39;s&nbsp;important&nbsp;that&nbsp;the&nbsp;resulting</span><br>
<span class="lineno"></span><span class="comment" id="4205003">//&nbsp;bytes&nbsp;be&nbsp;the&nbsp;same&nbsp;at&nbsp;both&nbsp;ends&nbsp;and&nbsp;DER&nbsp;removes&nbsp;this&nbsp;margin&nbsp;of&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4205075">//</span><br>
<span class="lineno"></span><span class="comment" id="4205078">//&nbsp;ASN.1&nbsp;is&nbsp;very&nbsp;complex&nbsp;and&nbsp;this&nbsp;package&nbsp;doesn&#39;t&nbsp;attempt&nbsp;to&nbsp;implement</span><br>
<span class="lineno">20</span><span class="comment" id="4205149">//&nbsp;everything&nbsp;by&nbsp;any&nbsp;means.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4205178">import</span>&nbsp;<span class="op" id="4205185">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4205188">&#34;fmt&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4205195">&#34;math/big&#34;</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4205207">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4205218">&#34;strconv&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4205229">&#34;time&#34;</span><br>
<span class="lineno"></span><span class="op" id="4205236">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span><span class="comment" id="4205239">//&nbsp;A&nbsp;StructuralError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;valid,&nbsp;but&nbsp;the&nbsp;Go&nbsp;type</span><br>
<span class="lineno"></span><span class="comment" id="4205315">//&nbsp;which&nbsp;is&nbsp;receiving&nbsp;it&nbsp;doesn&#39;t&nbsp;match.</span><br>
<span class="lineno"></span><span class="keyword" id="4205355">type</span>&nbsp;<span class="ident" id="4205360">StructuralError</span>&nbsp;<span class="keyword" id="4205376">struct</span>&nbsp;<span class="op" id="4205383">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205386">Msg</span>&nbsp;<span class="builtintype" id="4205390">string</span><br>
<span class="lineno"></span><span class="op" id="4205397">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="4205400">func</span>&nbsp;<span class="op" id="4205405">(</span><span class="ident" id="4205406">e</span>&nbsp;<span class="ident" id="4205408">StructuralError</span><span class="op" id="4205423">)</span>&nbsp;<span class="ident" id="4205425">Error</span><span class="op" id="4205430">(</span><span class="op" id="4205431">)</span>&nbsp;<span class="builtintype" id="4205433">string</span>&nbsp;<span class="op" id="4205440">{</span>&nbsp;<span class="keyword" id="4205442">return</span>&nbsp;<span class="string" id="4205449">&#34;asn1:&nbsp;structure&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4205475">+</span>&nbsp;<span class="ident" id="4205477">e</span><span class="op" id="4205478">.</span><span class="ident" id="4205479">Msg</span>&nbsp;<span class="op" id="4205483">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4205486">//&nbsp;A&nbsp;SyntaxError&nbsp;suggests&nbsp;that&nbsp;the&nbsp;ASN.1&nbsp;data&nbsp;is&nbsp;invalid.</span><br>
<span class="lineno"></span><span class="keyword" id="4205544">type</span>&nbsp;<span class="ident" id="4205549">SyntaxError</span>&nbsp;<span class="keyword" id="4205561">struct</span>&nbsp;<span class="op" id="4205568">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205571">Msg</span>&nbsp;<span class="builtintype" id="4205575">string</span><br>
<span class="lineno"></span><span class="op" id="4205582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4205585">func</span>&nbsp;<span class="op" id="4205590">(</span><span class="ident" id="4205591">e</span>&nbsp;<span class="ident" id="4205593">SyntaxError</span><span class="op" id="4205604">)</span>&nbsp;<span class="ident" id="4205606">Error</span><span class="op" id="4205611">(</span><span class="op" id="4205612">)</span>&nbsp;<span class="builtintype" id="4205614">string</span>&nbsp;<span class="op" id="4205621">{</span>&nbsp;<span class="keyword" id="4205623">return</span>&nbsp;<span class="string" id="4205630">&#34;asn1:&nbsp;syntax&nbsp;error:&nbsp;&#34;</span>&nbsp;<span class="op" id="4205653">+</span>&nbsp;<span class="ident" id="4205655">e</span><span class="op" id="4205656">.</span><span class="ident" id="4205657">Msg</span>&nbsp;<span class="op" id="4205661">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">45</span><span class="comment" id="4205664">//&nbsp;We&nbsp;start&nbsp;by&nbsp;dealing&nbsp;with&nbsp;each&nbsp;of&nbsp;the&nbsp;primitive&nbsp;types&nbsp;in&nbsp;turn.</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4205730">//&nbsp;BOOLEAN</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4205742">func</span>&nbsp;<span class="ident" id="4205747">parseBool</span><span class="op" id="4205756">(</span><span class="ident" id="4205757">bytes</span>&nbsp;<span class="op" id="4205763">[</span><span class="op" id="4205764">]</span><span class="builtintype" id="4205765">byte</span><span class="op" id="4205769">)</span>&nbsp;<span class="op" id="4205771">(</span><span class="ident" id="4205772">ret</span>&nbsp;<span class="builtintype" id="4205776">bool</span><span class="op" id="4205780">,</span>&nbsp;<span class="ident" id="4205782">err</span>&nbsp;<span class="builtintype" id="4205786">error</span><span class="op" id="4205791">)</span>&nbsp;<span class="op" id="4205793">{</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4205796">if</span>&nbsp;<span class="builtinfunc" id="4205799">len</span><span class="op" id="4205802">(</span><span class="ident" id="4205803">bytes</span><span class="op" id="4205808">)</span>&nbsp;<span class="op" id="4205810">!=</span>&nbsp;<span class="num" id="4205813">1</span>&nbsp;<span class="op" id="4205815">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4205819">err</span>&nbsp;<span class="op" id="4205823">=</span>&nbsp;<span class="ident" id="4205825">SyntaxError</span><span class="op" id="4205836">{</span><span class="string" id="4205837">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4205854">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4205858">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4205866">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4205870">//&nbsp;DER&nbsp;demands&nbsp;that&nbsp;&#34;If&nbsp;the&nbsp;encoding&nbsp;represents&nbsp;the&nbsp;boolean&nbsp;value&nbsp;TRUE,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4205943">//&nbsp;its&nbsp;single&nbsp;contents&nbsp;octet&nbsp;shall&nbsp;have&nbsp;all&nbsp;eight&nbsp;bits&nbsp;set&nbsp;to&nbsp;one.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4206012">//&nbsp;Thus&nbsp;only&nbsp;0&nbsp;and&nbsp;255&nbsp;are&nbsp;valid&nbsp;encoded&nbsp;values.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206062">switch</span>&nbsp;<span class="ident" id="4206069">bytes</span><span class="op" id="4206074">[</span><span class="num" id="4206075">0</span><span class="op" id="4206076">]</span>&nbsp;<span class="op" id="4206078">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206081">case</span>&nbsp;<span class="num" id="4206086">0</span><span class="op" id="4206087">:</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206091">ret</span>&nbsp;<span class="op" id="4206095">=</span>&nbsp;<span class="ident" id="4206097">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206104">case</span>&nbsp;<span class="num" id="4206109">0xff</span><span class="op" id="4206113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206117">ret</span>&nbsp;<span class="op" id="4206121">=</span>&nbsp;<span class="ident" id="4206123">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206129">default</span><span class="op" id="4206136">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206140">err</span>&nbsp;<span class="op" id="4206144">=</span>&nbsp;<span class="ident" id="4206146">SyntaxError</span><span class="op" id="4206157">{</span><span class="string" id="4206158">&#34;invalid&nbsp;boolean&#34;</span><span class="op" id="4206175">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4206178">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206182">return</span><br>
<span class="lineno"></span><span class="op" id="4206189">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span><span class="comment" id="4206192">//&nbsp;INTEGER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4206204">//&nbsp;parseInt64&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4206277">//&nbsp;returns&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4206300">func</span>&nbsp;<span class="ident" id="4206305">parseInt64</span><span class="op" id="4206315">(</span><span class="ident" id="4206316">bytes</span>&nbsp;<span class="op" id="4206322">[</span><span class="op" id="4206323">]</span><span class="builtintype" id="4206324">byte</span><span class="op" id="4206328">)</span>&nbsp;<span class="op" id="4206330">(</span><span class="ident" id="4206331">ret</span>&nbsp;<span class="ident" id="4206335">int64</span><span class="op" id="4206340">,</span>&nbsp;<span class="ident" id="4206342">err</span>&nbsp;<span class="builtintype" id="4206346">error</span><span class="op" id="4206351">)</span>&nbsp;<span class="op" id="4206353">{</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206356">if</span>&nbsp;<span class="builtinfunc" id="4206359">len</span><span class="op" id="4206362">(</span><span class="ident" id="4206363">bytes</span><span class="op" id="4206368">)</span>&nbsp;<span class="op" id="4206370">&gt;</span>&nbsp;<span class="num" id="4206372">8</span>&nbsp;<span class="op" id="4206374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4206378">//&nbsp;We&#39;ll&nbsp;overflow&nbsp;an&nbsp;int64&nbsp;in&nbsp;this&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206421">err</span>&nbsp;<span class="op" id="4206425">=</span>&nbsp;<span class="ident" id="4206427">StructuralError</span><span class="op" id="4206442">{</span><span class="string" id="4206443">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4206462">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206466">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4206474">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206477">for</span>&nbsp;<span class="ident" id="4206481">bytesRead</span>&nbsp;<span class="op" id="4206491">:=</span>&nbsp;<span class="num" id="4206494">0</span><span class="op" id="4206495">;</span>&nbsp;<span class="ident" id="4206497">bytesRead</span>&nbsp;<span class="op" id="4206507">&lt;</span>&nbsp;<span class="builtinfunc" id="4206509">len</span><span class="op" id="4206512">(</span><span class="ident" id="4206513">bytes</span><span class="op" id="4206518">)</span><span class="op" id="4206519">;</span>&nbsp;<span class="ident" id="4206521">bytesRead</span><span class="op" id="4206530">++</span>&nbsp;<span class="op" id="4206533">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206537">ret</span>&nbsp;<span class="op" id="4206541">&lt;&lt;=</span>&nbsp;<span class="num" id="4206545">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206549">ret</span>&nbsp;<span class="op" id="4206553">|=</span>&nbsp;<span class="ident" id="4206556">int64</span><span class="op" id="4206561">(</span><span class="ident" id="4206562">bytes</span><span class="op" id="4206567">[</span><span class="ident" id="4206568">bytesRead</span><span class="op" id="4206577">]</span><span class="op" id="4206578">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4206581">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4206585">//&nbsp;Shift&nbsp;up&nbsp;and&nbsp;down&nbsp;in&nbsp;order&nbsp;to&nbsp;sign&nbsp;extend&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206643">ret</span>&nbsp;<span class="op" id="4206647">&lt;&lt;=</span>&nbsp;<span class="num" id="4206651">64</span>&nbsp;<span class="op" id="4206654">-</span>&nbsp;<span class="builtintype" id="4206656">uint8</span><span class="op" id="4206661">(</span><span class="builtinfunc" id="4206662">len</span><span class="op" id="4206665">(</span><span class="ident" id="4206666">bytes</span><span class="op" id="4206671">)</span><span class="op" id="4206672">)</span><span class="op" id="4206673">*</span><span class="num" id="4206674">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206677">ret</span>&nbsp;<span class="op" id="4206681">&gt;&gt;=</span>&nbsp;<span class="num" id="4206685">64</span>&nbsp;<span class="op" id="4206688">-</span>&nbsp;<span class="builtintype" id="4206690">uint8</span><span class="op" id="4206695">(</span><span class="builtinfunc" id="4206696">len</span><span class="op" id="4206699">(</span><span class="ident" id="4206700">bytes</span><span class="op" id="4206705">)</span><span class="op" id="4206706">)</span><span class="op" id="4206707">*</span><span class="num" id="4206708">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206711">return</span><br>
<span class="lineno"></span><span class="op" id="4206718">}</span><br>
<span class="lineno">90</span><br>
<span class="lineno"></span><span class="comment" id="4206721">//&nbsp;parseInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4206800">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4206815">func</span>&nbsp;<span class="ident" id="4206820">parseInt32</span><span class="op" id="4206830">(</span><span class="ident" id="4206831">bytes</span>&nbsp;<span class="op" id="4206837">[</span><span class="op" id="4206838">]</span><span class="builtintype" id="4206839">byte</span><span class="op" id="4206843">)</span>&nbsp;<span class="op" id="4206845">(</span><span class="builtintype" id="4206846">int32</span><span class="op" id="4206851">,</span>&nbsp;<span class="builtintype" id="4206853">error</span><span class="op" id="4206858">)</span>&nbsp;<span class="op" id="4206860">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4206863">ret64</span><span class="op" id="4206868">,</span>&nbsp;<span class="ident" id="4206870">err</span>&nbsp;<span class="op" id="4206874">:=</span>&nbsp;<span class="ident" id="4206877">parseInt64</span><span class="op" id="4206887">(</span><span class="ident" id="4206888">bytes</span><span class="op" id="4206893">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206896">if</span>&nbsp;<span class="ident" id="4206899">err</span>&nbsp;<span class="op" id="4206903">!=</span>&nbsp;<span class="ident" id="4206906">nil</span>&nbsp;<span class="op" id="4206910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206914">return</span>&nbsp;<span class="num" id="4206921">0</span><span class="op" id="4206922">,</span>&nbsp;<span class="ident" id="4206924">err</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4206929">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206932">if</span>&nbsp;<span class="ident" id="4206935">ret64</span>&nbsp;<span class="op" id="4206941">!=</span>&nbsp;<span class="ident" id="4206944">int64</span><span class="op" id="4206949">(</span><span class="builtintype" id="4206950">int32</span><span class="op" id="4206955">(</span><span class="ident" id="4206956">ret64</span><span class="op" id="4206961">)</span><span class="op" id="4206962">)</span>&nbsp;<span class="op" id="4206964">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4206968">return</span>&nbsp;<span class="num" id="4206975">0</span><span class="op" id="4206976">,</span>&nbsp;<span class="ident" id="4206978">StructuralError</span><span class="op" id="4206993">{</span><span class="string" id="4206994">&#34;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4207013">}</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4207016">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207019">return</span>&nbsp;<span class="builtintype" id="4207026">int32</span><span class="op" id="4207031">(</span><span class="ident" id="4207032">ret64</span><span class="op" id="4207037">)</span><span class="op" id="4207038">,</span>&nbsp;<span class="ident" id="4207040">nil</span><br>
<span class="lineno"></span><span class="op" id="4207044">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4207047">var</span>&nbsp;<span class="ident" id="4207051">bigOne</span>&nbsp;<span class="op" id="4207058">=</span>&nbsp;<span class="ident" id="4207060">big</span><span class="op" id="4207063">.</span><span class="ident" id="4207064">NewInt</span><span class="op" id="4207070">(</span><span class="num" id="4207071">1</span><span class="op" id="4207072">)</span><br>
<span class="lineno">105</span><br>
<span class="lineno"></span><span class="comment" id="4207075">//&nbsp;parseBigInt&nbsp;treats&nbsp;the&nbsp;given&nbsp;bytes&nbsp;as&nbsp;a&nbsp;big-endian,&nbsp;signed&nbsp;integer&nbsp;and&nbsp;returns</span><br>
<span class="lineno"></span><span class="comment" id="4207157">//&nbsp;the&nbsp;result.</span><br>
<span class="lineno"></span><span class="keyword" id="4207172">func</span>&nbsp;<span class="ident" id="4207177">parseBigInt</span><span class="op" id="4207188">(</span><span class="ident" id="4207189">bytes</span>&nbsp;<span class="op" id="4207195">[</span><span class="op" id="4207196">]</span><span class="builtintype" id="4207197">byte</span><span class="op" id="4207201">)</span>&nbsp;<span class="op" id="4207203">*</span><span class="ident" id="4207204">big</span><span class="op" id="4207207">.</span><span class="ident" id="4207208">Int</span>&nbsp;<span class="op" id="4207212">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207215">ret</span>&nbsp;<span class="op" id="4207219">:=</span>&nbsp;<span class="builtinfunc" id="4207222">new</span><span class="op" id="4207225">(</span><span class="ident" id="4207226">big</span><span class="op" id="4207229">.</span><span class="ident" id="4207230">Int</span><span class="op" id="4207233">)</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207236">if</span>&nbsp;<span class="builtinfunc" id="4207239">len</span><span class="op" id="4207242">(</span><span class="ident" id="4207243">bytes</span><span class="op" id="4207248">)</span>&nbsp;<span class="op" id="4207250">&gt;</span>&nbsp;<span class="num" id="4207252">0</span>&nbsp;<span class="op" id="4207254">&amp;&amp;</span>&nbsp;<span class="ident" id="4207257">bytes</span><span class="op" id="4207262">[</span><span class="num" id="4207263">0</span><span class="op" id="4207264">]</span><span class="op" id="4207265">&amp;</span><span class="num" id="4207266">0x80</span>&nbsp;<span class="op" id="4207271">==</span>&nbsp;<span class="num" id="4207274">0x80</span>&nbsp;<span class="op" id="4207279">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4207283">//&nbsp;This&nbsp;is&nbsp;a&nbsp;negative&nbsp;number.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207315">notBytes</span>&nbsp;<span class="op" id="4207324">:=</span>&nbsp;<span class="builtinfunc" id="4207327">make</span><span class="op" id="4207331">(</span><span class="op" id="4207332">[</span><span class="op" id="4207333">]</span><span class="builtintype" id="4207334">byte</span><span class="op" id="4207338">,</span>&nbsp;<span class="builtinfunc" id="4207340">len</span><span class="op" id="4207343">(</span><span class="ident" id="4207344">bytes</span><span class="op" id="4207349">)</span><span class="op" id="4207350">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207354">for</span>&nbsp;<span class="ident" id="4207358">i</span>&nbsp;<span class="op" id="4207360">:=</span>&nbsp;<span class="keyword" id="4207363">range</span>&nbsp;<span class="ident" id="4207369">notBytes</span>&nbsp;<span class="op" id="4207378">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207383">notBytes</span><span class="op" id="4207391">[</span><span class="ident" id="4207392">i</span><span class="op" id="4207393">]</span>&nbsp;<span class="op" id="4207395">=</span>&nbsp;<span class="op" id="4207397">^</span><span class="ident" id="4207398">bytes</span><span class="op" id="4207403">[</span><span class="ident" id="4207404">i</span><span class="op" id="4207405">]</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4207409">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207413">ret</span><span class="op" id="4207416">.</span><span class="ident" id="4207417">SetBytes</span><span class="op" id="4207425">(</span><span class="ident" id="4207426">notBytes</span><span class="op" id="4207434">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207438">ret</span><span class="op" id="4207441">.</span><span class="ident" id="4207442">Add</span><span class="op" id="4207445">(</span><span class="ident" id="4207446">ret</span><span class="op" id="4207449">,</span>&nbsp;<span class="ident" id="4207451">bigOne</span><span class="op" id="4207457">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207461">ret</span><span class="op" id="4207464">.</span><span class="ident" id="4207465">Neg</span><span class="op" id="4207468">(</span><span class="ident" id="4207469">ret</span><span class="op" id="4207472">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207476">return</span>&nbsp;<span class="ident" id="4207483">ret</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4207488">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207491">ret</span><span class="op" id="4207494">.</span><span class="ident" id="4207495">SetBytes</span><span class="op" id="4207503">(</span><span class="ident" id="4207504">bytes</span><span class="op" id="4207509">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207512">return</span>&nbsp;<span class="ident" id="4207519">ret</span><br>
<span class="lineno"></span><span class="op" id="4207523">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">125</span><span class="comment" id="4207526">//&nbsp;BIT&nbsp;STRING</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4207541">//&nbsp;BitString&nbsp;is&nbsp;the&nbsp;structure&nbsp;to&nbsp;use&nbsp;when&nbsp;you&nbsp;want&nbsp;an&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;type.&nbsp;A</span><br>
<span class="lineno"></span><span class="comment" id="4207620">//&nbsp;bit&nbsp;string&nbsp;is&nbsp;padded&nbsp;up&nbsp;to&nbsp;the&nbsp;nearest&nbsp;byte&nbsp;in&nbsp;memory&nbsp;and&nbsp;the&nbsp;number&nbsp;of</span><br>
<span class="lineno"></span><span class="comment" id="4207695">//&nbsp;valid&nbsp;bits&nbsp;is&nbsp;recorded.&nbsp;Padding&nbsp;bits&nbsp;will&nbsp;be&nbsp;zero.</span><br>
<span class="lineno">130</span><span class="keyword" id="4207749">type</span>&nbsp;<span class="ident" id="4207754">BitString</span>&nbsp;<span class="keyword" id="4207764">struct</span>&nbsp;<span class="op" id="4207771">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207774">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4207784">[</span><span class="op" id="4207785">]</span><span class="builtintype" id="4207786">byte</span>&nbsp;<span class="comment" id="4207791">//&nbsp;bits&nbsp;packed&nbsp;into&nbsp;bytes.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4207819">BitLength</span>&nbsp;<span class="builtintype" id="4207829">int</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment" id="4207836">//&nbsp;length&nbsp;in&nbsp;bits.</span><br>
<span class="lineno"></span><span class="op" id="4207855">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span><span class="comment" id="4207858">//&nbsp;At&nbsp;returns&nbsp;the&nbsp;bit&nbsp;at&nbsp;the&nbsp;given&nbsp;index.&nbsp;If&nbsp;the&nbsp;index&nbsp;is&nbsp;out&nbsp;of&nbsp;range&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4207932">//&nbsp;returns&nbsp;false.</span><br>
<span class="lineno"></span><span class="keyword" id="4207950">func</span>&nbsp;<span class="op" id="4207955">(</span><span class="ident" id="4207956">b</span>&nbsp;<span class="ident" id="4207958">BitString</span><span class="op" id="4207967">)</span>&nbsp;<span class="ident" id="4207969">At</span><span class="op" id="4207971">(</span><span class="ident" id="4207972">i</span>&nbsp;<span class="builtintype" id="4207974">int</span><span class="op" id="4207977">)</span>&nbsp;<span class="builtintype" id="4207979">int</span>&nbsp;<span class="op" id="4207983">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4207986">if</span>&nbsp;<span class="ident" id="4207989">i</span>&nbsp;<span class="op" id="4207991">&lt;</span>&nbsp;<span class="num" id="4207993">0</span>&nbsp;<span class="op" id="4207995">||</span>&nbsp;<span class="ident" id="4207998">i</span>&nbsp;<span class="op" id="4208000">&gt;=</span>&nbsp;<span class="ident" id="4208003">b</span><span class="op" id="4208004">.</span><span class="ident" id="4208005">BitLength</span>&nbsp;<span class="op" id="4208015">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208019">return</span>&nbsp;<span class="num" id="4208026">0</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4208029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208032">x</span>&nbsp;<span class="op" id="4208034">:=</span>&nbsp;<span class="ident" id="4208037">i</span>&nbsp;<span class="op" id="4208039">/</span>&nbsp;<span class="num" id="4208041">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208044">y</span>&nbsp;<span class="op" id="4208046">:=</span>&nbsp;<span class="num" id="4208049">7</span>&nbsp;<span class="op" id="4208051">-</span>&nbsp;<span class="builtintype" id="4208053">uint</span><span class="op" id="4208057">(</span><span class="ident" id="4208058">i</span><span class="op" id="4208059">%</span><span class="num" id="4208060">8</span><span class="op" id="4208061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208064">return</span>&nbsp;<span class="builtintype" id="4208071">int</span><span class="op" id="4208074">(</span><span class="ident" id="4208075">b</span><span class="op" id="4208076">.</span><span class="ident" id="4208077">Bytes</span><span class="op" id="4208082">[</span><span class="ident" id="4208083">x</span><span class="op" id="4208084">]</span><span class="op" id="4208085">&gt;&gt;</span><span class="ident" id="4208087">y</span><span class="op" id="4208088">)</span>&nbsp;<span class="op" id="4208090">&amp;</span>&nbsp;<span class="num" id="4208092">1</span><br>
<span class="lineno"></span><span class="op" id="4208094">}</span><br>
<span class="lineno">145</span><br>
<span class="lineno"></span><span class="comment" id="4208097">//&nbsp;RightAlign&nbsp;returns&nbsp;a&nbsp;slice&nbsp;where&nbsp;the&nbsp;padding&nbsp;bits&nbsp;are&nbsp;at&nbsp;the&nbsp;beginning.&nbsp;The</span><br>
<span class="lineno"></span><span class="comment" id="4208176">//&nbsp;slice&nbsp;may&nbsp;share&nbsp;memory&nbsp;with&nbsp;the&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="keyword" id="4208222">func</span>&nbsp;<span class="op" id="4208227">(</span><span class="ident" id="4208228">b</span>&nbsp;<span class="ident" id="4208230">BitString</span><span class="op" id="4208239">)</span>&nbsp;<span class="ident" id="4208241">RightAlign</span><span class="op" id="4208251">(</span><span class="op" id="4208252">)</span>&nbsp;<span class="op" id="4208254">[</span><span class="op" id="4208255">]</span><span class="builtintype" id="4208256">byte</span>&nbsp;<span class="op" id="4208261">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208264">shift</span>&nbsp;<span class="op" id="4208270">:=</span>&nbsp;<span class="builtintype" id="4208273">uint</span><span class="op" id="4208277">(</span><span class="num" id="4208278">8</span>&nbsp;<span class="op" id="4208280">-</span>&nbsp;<span class="op" id="4208282">(</span><span class="ident" id="4208283">b</span><span class="op" id="4208284">.</span><span class="ident" id="4208285">BitLength</span>&nbsp;<span class="op" id="4208295">%</span>&nbsp;<span class="num" id="4208297">8</span><span class="op" id="4208298">)</span><span class="op" id="4208299">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208302">if</span>&nbsp;<span class="ident" id="4208305">shift</span>&nbsp;<span class="op" id="4208311">==</span>&nbsp;<span class="num" id="4208314">8</span>&nbsp;<span class="op" id="4208316">||</span>&nbsp;<span class="builtinfunc" id="4208319">len</span><span class="op" id="4208322">(</span><span class="ident" id="4208323">b</span><span class="op" id="4208324">.</span><span class="ident" id="4208325">Bytes</span><span class="op" id="4208330">)</span>&nbsp;<span class="op" id="4208332">==</span>&nbsp;<span class="num" id="4208335">0</span>&nbsp;<span class="op" id="4208337">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208341">return</span>&nbsp;<span class="ident" id="4208348">b</span><span class="op" id="4208349">.</span><span class="ident" id="4208350">Bytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4208357">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208361">a</span>&nbsp;<span class="op" id="4208363">:=</span>&nbsp;<span class="builtinfunc" id="4208366">make</span><span class="op" id="4208370">(</span><span class="op" id="4208371">[</span><span class="op" id="4208372">]</span><span class="builtintype" id="4208373">byte</span><span class="op" id="4208377">,</span>&nbsp;<span class="builtinfunc" id="4208379">len</span><span class="op" id="4208382">(</span><span class="ident" id="4208383">b</span><span class="op" id="4208384">.</span><span class="ident" id="4208385">Bytes</span><span class="op" id="4208390">)</span><span class="op" id="4208391">)</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208394">a</span><span class="op" id="4208395">[</span><span class="num" id="4208396">0</span><span class="op" id="4208397">]</span>&nbsp;<span class="op" id="4208399">=</span>&nbsp;<span class="ident" id="4208401">b</span><span class="op" id="4208402">.</span><span class="ident" id="4208403">Bytes</span><span class="op" id="4208408">[</span><span class="num" id="4208409">0</span><span class="op" id="4208410">]</span>&nbsp;<span class="op" id="4208412">&gt;&gt;</span>&nbsp;<span class="ident" id="4208415">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208422">for</span>&nbsp;<span class="ident" id="4208426">i</span>&nbsp;<span class="op" id="4208428">:=</span>&nbsp;<span class="num" id="4208431">1</span><span class="op" id="4208432">;</span>&nbsp;<span class="ident" id="4208434">i</span>&nbsp;<span class="op" id="4208436">&lt;</span>&nbsp;<span class="builtinfunc" id="4208438">len</span><span class="op" id="4208441">(</span><span class="ident" id="4208442">b</span><span class="op" id="4208443">.</span><span class="ident" id="4208444">Bytes</span><span class="op" id="4208449">)</span><span class="op" id="4208450">;</span>&nbsp;<span class="ident" id="4208452">i</span><span class="op" id="4208453">++</span>&nbsp;<span class="op" id="4208456">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208460">a</span><span class="op" id="4208461">[</span><span class="ident" id="4208462">i</span><span class="op" id="4208463">]</span>&nbsp;<span class="op" id="4208465">=</span>&nbsp;<span class="ident" id="4208467">b</span><span class="op" id="4208468">.</span><span class="ident" id="4208469">Bytes</span><span class="op" id="4208474">[</span><span class="ident" id="4208475">i</span><span class="op" id="4208476">-</span><span class="num" id="4208477">1</span><span class="op" id="4208478">]</span>&nbsp;<span class="op" id="4208480">&lt;&lt;</span>&nbsp;<span class="op" id="4208483">(</span><span class="num" id="4208484">8</span>&nbsp;<span class="op" id="4208486">-</span>&nbsp;<span class="ident" id="4208488">shift</span><span class="op" id="4208493">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208497">a</span><span class="op" id="4208498">[</span><span class="ident" id="4208499">i</span><span class="op" id="4208500">]</span>&nbsp;<span class="op" id="4208502">|=</span>&nbsp;<span class="ident" id="4208505">b</span><span class="op" id="4208506">.</span><span class="ident" id="4208507">Bytes</span><span class="op" id="4208512">[</span><span class="ident" id="4208513">i</span><span class="op" id="4208514">]</span>&nbsp;<span class="op" id="4208516">&gt;&gt;</span>&nbsp;<span class="ident" id="4208519">shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4208526">}</span><br>
<span class="lineno">160</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208530">return</span>&nbsp;<span class="ident" id="4208537">a</span><br>
<span class="lineno"></span><span class="op" id="4208539">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4208542">//&nbsp;parseBitString&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;bit&nbsp;string&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno">165</span><span class="keyword" id="4208629">func</span>&nbsp;<span class="ident" id="4208634">parseBitString</span><span class="op" id="4208648">(</span><span class="ident" id="4208649">bytes</span>&nbsp;<span class="op" id="4208655">[</span><span class="op" id="4208656">]</span><span class="builtintype" id="4208657">byte</span><span class="op" id="4208661">)</span>&nbsp;<span class="op" id="4208663">(</span><span class="ident" id="4208664">ret</span>&nbsp;<span class="ident" id="4208668">BitString</span><span class="op" id="4208677">,</span>&nbsp;<span class="ident" id="4208679">err</span>&nbsp;<span class="builtintype" id="4208683">error</span><span class="op" id="4208688">)</span>&nbsp;<span class="op" id="4208690">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208693">if</span>&nbsp;<span class="builtinfunc" id="4208696">len</span><span class="op" id="4208699">(</span><span class="ident" id="4208700">bytes</span><span class="op" id="4208705">)</span>&nbsp;<span class="op" id="4208707">==</span>&nbsp;<span class="num" id="4208710">0</span>&nbsp;<span class="op" id="4208712">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208716">err</span>&nbsp;<span class="op" id="4208720">=</span>&nbsp;<span class="ident" id="4208722">SyntaxError</span><span class="op" id="4208733">{</span><span class="string" id="4208734">&#34;zero&nbsp;length&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4208758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208762">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4208770">}</span><br>
<span class="lineno">170</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208773">paddingBits</span>&nbsp;<span class="op" id="4208785">:=</span>&nbsp;<span class="builtintype" id="4208788">int</span><span class="op" id="4208791">(</span><span class="ident" id="4208792">bytes</span><span class="op" id="4208797">[</span><span class="num" id="4208798">0</span><span class="op" id="4208799">]</span><span class="op" id="4208800">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208803">if</span>&nbsp;<span class="ident" id="4208806">paddingBits</span>&nbsp;<span class="op" id="4208818">&gt;</span>&nbsp;<span class="num" id="4208820">7</span>&nbsp;<span class="op" id="4208822">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4208827">len</span><span class="op" id="4208830">(</span><span class="ident" id="4208831">bytes</span><span class="op" id="4208836">)</span>&nbsp;<span class="op" id="4208838">==</span>&nbsp;<span class="num" id="4208841">1</span>&nbsp;<span class="op" id="4208843">&amp;&amp;</span>&nbsp;<span class="ident" id="4208846">paddingBits</span>&nbsp;<span class="op" id="4208858">&gt;</span>&nbsp;<span class="num" id="4208860">0</span>&nbsp;<span class="op" id="4208862">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208867">bytes</span><span class="op" id="4208872">[</span><span class="builtinfunc" id="4208873">len</span><span class="op" id="4208876">(</span><span class="ident" id="4208877">bytes</span><span class="op" id="4208882">)</span><span class="op" id="4208883">-</span><span class="num" id="4208884">1</span><span class="op" id="4208885">]</span><span class="op" id="4208886">&amp;</span><span class="op" id="4208887">(</span><span class="op" id="4208888">(</span><span class="num" id="4208889">1</span><span class="op" id="4208890">&lt;&lt;</span><span class="ident" id="4208892">bytes</span><span class="op" id="4208897">[</span><span class="num" id="4208898">0</span><span class="op" id="4208899">]</span><span class="op" id="4208900">)</span><span class="op" id="4208901">-</span><span class="num" id="4208902">1</span><span class="op" id="4208903">)</span>&nbsp;<span class="op" id="4208905">!=</span>&nbsp;<span class="num" id="4208908">0</span>&nbsp;<span class="op" id="4208910">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208914">err</span>&nbsp;<span class="op" id="4208918">=</span>&nbsp;<span class="ident" id="4208920">SyntaxError</span><span class="op" id="4208931">{</span><span class="string" id="4208932">&#34;invalid&nbsp;padding&nbsp;bits&nbsp;in&nbsp;BIT&nbsp;STRING&#34;</span><span class="op" id="4208968">}</span><br>
<span class="lineno">175</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4208972">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4208980">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4208983">ret</span><span class="op" id="4208986">.</span><span class="ident" id="4208987">BitLength</span>&nbsp;<span class="op" id="4208997">=</span>&nbsp;<span class="op" id="4208999">(</span><span class="builtinfunc" id="4209000">len</span><span class="op" id="4209003">(</span><span class="ident" id="4209004">bytes</span><span class="op" id="4209009">)</span><span class="op" id="4209010">-</span><span class="num" id="4209011">1</span><span class="op" id="4209012">)</span><span class="op" id="4209013">*</span><span class="num" id="4209014">8</span>&nbsp;<span class="op" id="4209016">-</span>&nbsp;<span class="ident" id="4209018">paddingBits</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209031">ret</span><span class="op" id="4209034">.</span><span class="ident" id="4209035">Bytes</span>&nbsp;<span class="op" id="4209041">=</span>&nbsp;<span class="ident" id="4209043">bytes</span><span class="op" id="4209048">[</span><span class="num" id="4209049">1</span><span class="op" id="4209050">:</span><span class="op" id="4209051">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209054">return</span><br>
<span class="lineno">180</span><span class="op" id="4209061">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4209064">//&nbsp;OBJECT&nbsp;IDENTIFIER</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4209086">//&nbsp;An&nbsp;ObjectIdentifier&nbsp;represents&nbsp;an&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER.</span><br>
<span class="lineno">185</span><span class="keyword" id="4209148">type</span>&nbsp;<span class="ident" id="4209153">ObjectIdentifier</span>&nbsp;<span class="op" id="4209170">[</span><span class="op" id="4209171">]</span><span class="builtintype" id="4209172">int</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4209177">//&nbsp;Equal&nbsp;reports&nbsp;whether&nbsp;oi&nbsp;and&nbsp;other&nbsp;represent&nbsp;the&nbsp;same&nbsp;identifier.</span><br>
<span class="lineno"></span><span class="keyword" id="4209246">func</span>&nbsp;<span class="op" id="4209251">(</span><span class="ident" id="4209252">oi</span>&nbsp;<span class="ident" id="4209255">ObjectIdentifier</span><span class="op" id="4209271">)</span>&nbsp;<span class="ident" id="4209273">Equal</span><span class="op" id="4209278">(</span><span class="ident" id="4209279">other</span>&nbsp;<span class="ident" id="4209285">ObjectIdentifier</span><span class="op" id="4209301">)</span>&nbsp;<span class="builtintype" id="4209303">bool</span>&nbsp;<span class="op" id="4209308">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209311">if</span>&nbsp;<span class="builtinfunc" id="4209314">len</span><span class="op" id="4209317">(</span><span class="ident" id="4209318">oi</span><span class="op" id="4209320">)</span>&nbsp;<span class="op" id="4209322">!=</span>&nbsp;<span class="builtinfunc" id="4209325">len</span><span class="op" id="4209328">(</span><span class="ident" id="4209329">other</span><span class="op" id="4209334">)</span>&nbsp;<span class="op" id="4209336">{</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209340">return</span>&nbsp;<span class="ident" id="4209347">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4209354">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209357">for</span>&nbsp;<span class="ident" id="4209361">i</span>&nbsp;<span class="op" id="4209363">:=</span>&nbsp;<span class="num" id="4209366">0</span><span class="op" id="4209367">;</span>&nbsp;<span class="ident" id="4209369">i</span>&nbsp;<span class="op" id="4209371">&lt;</span>&nbsp;<span class="builtinfunc" id="4209373">len</span><span class="op" id="4209376">(</span><span class="ident" id="4209377">oi</span><span class="op" id="4209379">)</span><span class="op" id="4209380">;</span>&nbsp;<span class="ident" id="4209382">i</span><span class="op" id="4209383">++</span>&nbsp;<span class="op" id="4209386">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209390">if</span>&nbsp;<span class="ident" id="4209393">oi</span><span class="op" id="4209395">[</span><span class="ident" id="4209396">i</span><span class="op" id="4209397">]</span>&nbsp;<span class="op" id="4209399">!=</span>&nbsp;<span class="ident" id="4209402">other</span><span class="op" id="4209407">[</span><span class="ident" id="4209408">i</span><span class="op" id="4209409">]</span>&nbsp;<span class="op" id="4209411">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209416">return</span>&nbsp;<span class="ident" id="4209423">false</span><br>
<span class="lineno">195</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4209431">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4209434">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209438">return</span>&nbsp;<span class="ident" id="4209445">true</span><br>
<span class="lineno"></span><span class="op" id="4209450">}</span><br>
<span class="lineno">200</span><br>
<span class="lineno"></span><span class="keyword" id="4209453">func</span>&nbsp;<span class="op" id="4209458">(</span><span class="ident" id="4209459">oi</span>&nbsp;<span class="ident" id="4209462">ObjectIdentifier</span><span class="op" id="4209478">)</span>&nbsp;<span class="ident" id="4209480">String</span><span class="op" id="4209486">(</span><span class="op" id="4209487">)</span>&nbsp;<span class="builtintype" id="4209489">string</span>&nbsp;<span class="op" id="4209496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209499">var</span>&nbsp;<span class="ident" id="4209503">s</span>&nbsp;<span class="builtintype" id="4209505">string</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209514">for</span>&nbsp;<span class="ident" id="4209518">i</span><span class="op" id="4209519">,</span>&nbsp;<span class="ident" id="4209521">v</span>&nbsp;<span class="op" id="4209523">:=</span>&nbsp;<span class="keyword" id="4209526">range</span>&nbsp;<span class="ident" id="4209532">oi</span>&nbsp;<span class="op" id="4209535">{</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209539">if</span>&nbsp;<span class="ident" id="4209542">i</span>&nbsp;<span class="op" id="4209544">&gt;</span>&nbsp;<span class="num" id="4209546">0</span>&nbsp;<span class="op" id="4209548">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209553">s</span>&nbsp;<span class="op" id="4209555">+=</span>&nbsp;<span class="string" id="4209558">&#34;.&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4209564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209568">s</span>&nbsp;<span class="op" id="4209570">+=</span>&nbsp;<span class="ident" id="4209573">strconv</span><span class="op" id="4209580">.</span><span class="ident" id="4209581">Itoa</span><span class="op" id="4209585">(</span><span class="ident" id="4209586">v</span><span class="op" id="4209587">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4209590">}</span><br>
<span class="lineno">210</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209594">return</span>&nbsp;<span class="ident" id="4209601">s</span><br>
<span class="lineno"></span><span class="op" id="4209603">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4209606">//&nbsp;parseObjectIdentifier&nbsp;parses&nbsp;an&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;from&nbsp;the&nbsp;given&nbsp;bytes&nbsp;and</span><br>
<span class="lineno">215</span><span class="comment" id="4209684">//&nbsp;returns&nbsp;it.&nbsp;An&nbsp;object&nbsp;identifier&nbsp;is&nbsp;a&nbsp;sequence&nbsp;of&nbsp;variable&nbsp;length&nbsp;integers</span><br>
<span class="lineno"></span><span class="comment" id="4209762">//&nbsp;that&nbsp;are&nbsp;assigned&nbsp;in&nbsp;a&nbsp;hierarchy.</span><br>
<span class="lineno"></span><span class="keyword" id="4209799">func</span>&nbsp;<span class="ident" id="4209804">parseObjectIdentifier</span><span class="op" id="4209825">(</span><span class="ident" id="4209826">bytes</span>&nbsp;<span class="op" id="4209832">[</span><span class="op" id="4209833">]</span><span class="builtintype" id="4209834">byte</span><span class="op" id="4209838">)</span>&nbsp;<span class="op" id="4209840">(</span><span class="ident" id="4209841">s</span>&nbsp;<span class="op" id="4209843">[</span><span class="op" id="4209844">]</span><span class="builtintype" id="4209845">int</span><span class="op" id="4209848">,</span>&nbsp;<span class="ident" id="4209850">err</span>&nbsp;<span class="builtintype" id="4209854">error</span><span class="op" id="4209859">)</span>&nbsp;<span class="op" id="4209861">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209864">if</span>&nbsp;<span class="builtinfunc" id="4209867">len</span><span class="op" id="4209870">(</span><span class="ident" id="4209871">bytes</span><span class="op" id="4209876">)</span>&nbsp;<span class="op" id="4209878">==</span>&nbsp;<span class="num" id="4209881">0</span>&nbsp;<span class="op" id="4209883">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4209887">err</span>&nbsp;<span class="op" id="4209891">=</span>&nbsp;<span class="ident" id="4209893">SyntaxError</span><span class="op" id="4209904">{</span><span class="string" id="4209905">&#34;zero&nbsp;length&nbsp;OBJECT&nbsp;IDENTIFIER&#34;</span><span class="op" id="4209936">}</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4209940">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4209948">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4209952">//&nbsp;In&nbsp;the&nbsp;worst&nbsp;case,&nbsp;we&nbsp;get&nbsp;two&nbsp;elements&nbsp;from&nbsp;the&nbsp;first&nbsp;byte&nbsp;(which&nbsp;is</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4210025">//&nbsp;encoded&nbsp;differently)&nbsp;and&nbsp;then&nbsp;every&nbsp;varint&nbsp;is&nbsp;a&nbsp;single&nbsp;byte&nbsp;long.</span><br>
<span class="lineno">225</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210095">s</span>&nbsp;<span class="op" id="4210097">=</span>&nbsp;<span class="builtinfunc" id="4210099">make</span><span class="op" id="4210103">(</span><span class="op" id="4210104">[</span><span class="op" id="4210105">]</span><span class="builtintype" id="4210106">int</span><span class="op" id="4210109">,</span>&nbsp;<span class="builtinfunc" id="4210111">len</span><span class="op" id="4210114">(</span><span class="ident" id="4210115">bytes</span><span class="op" id="4210120">)</span><span class="op" id="4210121">+</span><span class="num" id="4210122">1</span><span class="op" id="4210123">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4210127">//&nbsp;The&nbsp;first&nbsp;varint&nbsp;is&nbsp;40*value1&nbsp;+&nbsp;value2:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4210171">//&nbsp;According&nbsp;to&nbsp;this&nbsp;packing,&nbsp;value1&nbsp;can&nbsp;take&nbsp;the&nbsp;values&nbsp;0,&nbsp;1&nbsp;and&nbsp;2&nbsp;only.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4210246">//&nbsp;When&nbsp;value1&nbsp;=&nbsp;0&nbsp;or&nbsp;value1&nbsp;=&nbsp;1,&nbsp;then&nbsp;value2&nbsp;is&nbsp;&lt;=&nbsp;39.&nbsp;When&nbsp;value1&nbsp;=&nbsp;2,</span><br>
<span class="lineno">230</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4210320">//&nbsp;then&nbsp;there&nbsp;are&nbsp;no&nbsp;restrictions&nbsp;on&nbsp;value2.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210366">v</span><span class="op" id="4210367">,</span>&nbsp;<span class="ident" id="4210369">offset</span><span class="op" id="4210375">,</span>&nbsp;<span class="ident" id="4210377">err</span>&nbsp;<span class="op" id="4210381">:=</span>&nbsp;<span class="ident" id="4210384">parseBase128Int</span><span class="op" id="4210399">(</span><span class="ident" id="4210400">bytes</span><span class="op" id="4210405">,</span>&nbsp;<span class="num" id="4210407">0</span><span class="op" id="4210408">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210411">if</span>&nbsp;<span class="ident" id="4210414">err</span>&nbsp;<span class="op" id="4210418">!=</span>&nbsp;<span class="ident" id="4210421">nil</span>&nbsp;<span class="op" id="4210425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210429">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4210437">}</span><br>
<span class="lineno">235</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210440">if</span>&nbsp;<span class="ident" id="4210443">v</span>&nbsp;<span class="op" id="4210445">&lt;</span>&nbsp;<span class="num" id="4210447">80</span>&nbsp;<span class="op" id="4210450">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210454">s</span><span class="op" id="4210455">[</span><span class="num" id="4210456">0</span><span class="op" id="4210457">]</span>&nbsp;<span class="op" id="4210459">=</span>&nbsp;<span class="ident" id="4210461">v</span>&nbsp;<span class="op" id="4210463">/</span>&nbsp;<span class="num" id="4210465">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210470">s</span><span class="op" id="4210471">[</span><span class="num" id="4210472">1</span><span class="op" id="4210473">]</span>&nbsp;<span class="op" id="4210475">=</span>&nbsp;<span class="ident" id="4210477">v</span>&nbsp;<span class="op" id="4210479">%</span>&nbsp;<span class="num" id="4210481">40</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4210485">}</span>&nbsp;<span class="keyword" id="4210487">else</span>&nbsp;<span class="op" id="4210492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210496">s</span><span class="op" id="4210497">[</span><span class="num" id="4210498">0</span><span class="op" id="4210499">]</span>&nbsp;<span class="op" id="4210501">=</span>&nbsp;<span class="num" id="4210503">2</span><br>
<span class="lineno">240</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210507">s</span><span class="op" id="4210508">[</span><span class="num" id="4210509">1</span><span class="op" id="4210510">]</span>&nbsp;<span class="op" id="4210512">=</span>&nbsp;<span class="ident" id="4210514">v</span>&nbsp;<span class="op" id="4210516">-</span>&nbsp;<span class="num" id="4210518">80</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4210522">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210526">i</span>&nbsp;<span class="op" id="4210528">:=</span>&nbsp;<span class="num" id="4210531">2</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210534">for</span>&nbsp;<span class="op" id="4210538">;</span>&nbsp;<span class="ident" id="4210540">offset</span>&nbsp;<span class="op" id="4210547">&lt;</span>&nbsp;<span class="builtinfunc" id="4210549">len</span><span class="op" id="4210552">(</span><span class="ident" id="4210553">bytes</span><span class="op" id="4210558">)</span><span class="op" id="4210559">;</span>&nbsp;<span class="ident" id="4210561">i</span><span class="op" id="4210562">++</span>&nbsp;<span class="op" id="4210565">{</span><br>
<span class="lineno">245</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210569">v</span><span class="op" id="4210570">,</span>&nbsp;<span class="ident" id="4210572">offset</span><span class="op" id="4210578">,</span>&nbsp;<span class="ident" id="4210580">err</span>&nbsp;<span class="op" id="4210584">=</span>&nbsp;<span class="ident" id="4210586">parseBase128Int</span><span class="op" id="4210601">(</span><span class="ident" id="4210602">bytes</span><span class="op" id="4210607">,</span>&nbsp;<span class="ident" id="4210609">offset</span><span class="op" id="4210615">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210619">if</span>&nbsp;<span class="ident" id="4210622">err</span>&nbsp;<span class="op" id="4210626">!=</span>&nbsp;<span class="ident" id="4210629">nil</span>&nbsp;<span class="op" id="4210633">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210638">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4210647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210651">s</span><span class="op" id="4210652">[</span><span class="ident" id="4210653">i</span><span class="op" id="4210654">]</span>&nbsp;<span class="op" id="4210656">=</span>&nbsp;<span class="ident" id="4210658">v</span><br>
<span class="lineno">250</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4210661">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4210664">s</span>&nbsp;<span class="op" id="4210666">=</span>&nbsp;<span class="ident" id="4210668">s</span><span class="op" id="4210669">[</span><span class="num" id="4210670">0</span><span class="op" id="4210671">:</span><span class="ident" id="4210672">i</span><span class="op" id="4210673">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4210676">return</span><br>
<span class="lineno"></span><span class="op" id="4210683">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">255</span><span class="comment" id="4210686">//&nbsp;ENUMERATED</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4210701">//&nbsp;An&nbsp;Enumerated&nbsp;is&nbsp;represented&nbsp;as&nbsp;a&nbsp;plain&nbsp;int.</span><br>
<span class="lineno"></span><span class="keyword" id="4210749">type</span>&nbsp;<span class="ident" id="4210754">Enumerated</span>&nbsp;<span class="builtintype" id="4210765">int</span><br>
<span class="lineno"></span><br>
<span class="lineno">260</span><span class="comment" id="4210770">//&nbsp;FLAG</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4210779">//&nbsp;A&nbsp;Flag&nbsp;accepts&nbsp;any&nbsp;data&nbsp;and&nbsp;is&nbsp;set&nbsp;to&nbsp;true&nbsp;if&nbsp;present.</span><br>
<span class="lineno"></span><span class="keyword" id="4210837">type</span>&nbsp;<span class="ident" id="4210842">Flag</span>&nbsp;<span class="builtintype" id="4210847">bool</span><br>
<span class="lineno"></span><br>
<span class="lineno">265</span><span class="comment" id="4210853">//&nbsp;parseBase128Int&nbsp;parses&nbsp;a&nbsp;base-128&nbsp;encoded&nbsp;int&nbsp;from&nbsp;the&nbsp;given&nbsp;offset&nbsp;in&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4210931">//&nbsp;given&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;value&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.</span><br>
<span class="lineno"></span><span class="keyword" id="4210993">func</span>&nbsp;<span class="ident" id="4210998">parseBase128Int</span><span class="op" id="4211013">(</span><span class="ident" id="4211014">bytes</span>&nbsp;<span class="op" id="4211020">[</span><span class="op" id="4211021">]</span><span class="builtintype" id="4211022">byte</span><span class="op" id="4211026">,</span>&nbsp;<span class="ident" id="4211028">initOffset</span>&nbsp;<span class="builtintype" id="4211039">int</span><span class="op" id="4211042">)</span>&nbsp;<span class="op" id="4211044">(</span><span class="ident" id="4211045">ret</span><span class="op" id="4211048">,</span>&nbsp;<span class="ident" id="4211050">offset</span>&nbsp;<span class="builtintype" id="4211057">int</span><span class="op" id="4211060">,</span>&nbsp;<span class="ident" id="4211062">err</span>&nbsp;<span class="builtintype" id="4211066">error</span><span class="op" id="4211071">)</span>&nbsp;<span class="op" id="4211073">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211076">offset</span>&nbsp;<span class="op" id="4211083">=</span>&nbsp;<span class="ident" id="4211085">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211097">for</span>&nbsp;<span class="ident" id="4211101">shifted</span>&nbsp;<span class="op" id="4211109">:=</span>&nbsp;<span class="num" id="4211112">0</span><span class="op" id="4211113">;</span>&nbsp;<span class="ident" id="4211115">offset</span>&nbsp;<span class="op" id="4211122">&lt;</span>&nbsp;<span class="builtinfunc" id="4211124">len</span><span class="op" id="4211127">(</span><span class="ident" id="4211128">bytes</span><span class="op" id="4211133">)</span><span class="op" id="4211134">;</span>&nbsp;<span class="ident" id="4211136">shifted</span><span class="op" id="4211143">++</span>&nbsp;<span class="op" id="4211146">{</span><br>
<span class="lineno">270</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211150">if</span>&nbsp;<span class="ident" id="4211153">shifted</span>&nbsp;<span class="op" id="4211161">&gt;</span>&nbsp;<span class="num" id="4211163">4</span>&nbsp;<span class="op" id="4211165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211170">err</span>&nbsp;<span class="op" id="4211174">=</span>&nbsp;<span class="ident" id="4211176">StructuralError</span><span class="op" id="4211191">{</span><span class="string" id="4211192">&#34;base&nbsp;128&nbsp;integer&nbsp;too&nbsp;large&#34;</span><span class="op" id="4211220">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211225">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211238">ret</span>&nbsp;<span class="op" id="4211242">&lt;&lt;=</span>&nbsp;<span class="num" id="4211246">7</span><br>
<span class="lineno">275</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211250">b</span>&nbsp;<span class="op" id="4211252">:=</span>&nbsp;<span class="ident" id="4211255">bytes</span><span class="op" id="4211260">[</span><span class="ident" id="4211261">offset</span><span class="op" id="4211267">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211271">ret</span>&nbsp;<span class="op" id="4211275">|=</span>&nbsp;<span class="builtintype" id="4211278">int</span><span class="op" id="4211281">(</span><span class="ident" id="4211282">b</span>&nbsp;<span class="op" id="4211284">&amp;</span>&nbsp;<span class="num" id="4211286">0x7f</span><span class="op" id="4211290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211294">offset</span><span class="op" id="4211300">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211305">if</span>&nbsp;<span class="ident" id="4211308">b</span><span class="op" id="4211309">&amp;</span><span class="num" id="4211310">0x80</span>&nbsp;<span class="op" id="4211315">==</span>&nbsp;<span class="num" id="4211318">0</span>&nbsp;<span class="op" id="4211320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211325">return</span><br>
<span class="lineno">280</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211334">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211337">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211340">err</span>&nbsp;<span class="op" id="4211344">=</span>&nbsp;<span class="ident" id="4211346">SyntaxError</span><span class="op" id="4211357">{</span><span class="string" id="4211358">&#34;truncated&nbsp;base&nbsp;128&nbsp;integer&#34;</span><span class="op" id="4211386">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211389">return</span><br>
<span class="lineno"></span><span class="op" id="4211396">}</span><br>
<span class="lineno">285</span><br>
<span class="lineno"></span><span class="comment" id="4211399">//&nbsp;UTCTime</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4211411">func</span>&nbsp;<span class="ident" id="4211416">parseUTCTime</span><span class="op" id="4211428">(</span><span class="ident" id="4211429">bytes</span>&nbsp;<span class="op" id="4211435">[</span><span class="op" id="4211436">]</span><span class="builtintype" id="4211437">byte</span><span class="op" id="4211441">)</span>&nbsp;<span class="op" id="4211443">(</span><span class="ident" id="4211444">ret</span>&nbsp;<span class="ident" id="4211448">time</span><span class="op" id="4211452">.</span><span class="ident" id="4211453">Time</span><span class="op" id="4211457">,</span>&nbsp;<span class="ident" id="4211459">err</span>&nbsp;<span class="builtintype" id="4211463">error</span><span class="op" id="4211468">)</span>&nbsp;<span class="op" id="4211470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211473">s</span>&nbsp;<span class="op" id="4211475">:=</span>&nbsp;<span class="builtintype" id="4211478">string</span><span class="op" id="4211484">(</span><span class="ident" id="4211485">bytes</span><span class="op" id="4211490">)</span><br>
<span class="lineno">290</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211493">ret</span><span class="op" id="4211496">,</span>&nbsp;<span class="ident" id="4211498">err</span>&nbsp;<span class="op" id="4211502">=</span>&nbsp;<span class="ident" id="4211504">time</span><span class="op" id="4211508">.</span><span class="ident" id="4211509">Parse</span><span class="op" id="4211514">(</span><span class="string" id="4211515">&#34;0601021504Z0700&#34;</span><span class="op" id="4211532">,</span>&nbsp;<span class="ident" id="4211534">s</span><span class="op" id="4211535">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211538">if</span>&nbsp;<span class="ident" id="4211541">err</span>&nbsp;<span class="op" id="4211545">!=</span>&nbsp;<span class="ident" id="4211548">nil</span>&nbsp;<span class="op" id="4211552">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211556">ret</span><span class="op" id="4211559">,</span>&nbsp;<span class="ident" id="4211561">err</span>&nbsp;<span class="op" id="4211565">=</span>&nbsp;<span class="ident" id="4211567">time</span><span class="op" id="4211571">.</span><span class="ident" id="4211572">Parse</span><span class="op" id="4211577">(</span><span class="string" id="4211578">&#34;060102150405Z0700&#34;</span><span class="op" id="4211597">,</span>&nbsp;<span class="ident" id="4211599">s</span><span class="op" id="4211600">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211603">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211606">if</span>&nbsp;<span class="ident" id="4211609">err</span>&nbsp;<span class="op" id="4211613">==</span>&nbsp;<span class="ident" id="4211616">nil</span>&nbsp;<span class="op" id="4211620">&amp;&amp;</span>&nbsp;<span class="ident" id="4211623">ret</span><span class="op" id="4211626">.</span><span class="ident" id="4211627">Year</span><span class="op" id="4211631">(</span><span class="op" id="4211632">)</span>&nbsp;<span class="op" id="4211634">&gt;=</span>&nbsp;<span class="num" id="4211637">2050</span>&nbsp;<span class="op" id="4211642">{</span><br>
<span class="lineno">295</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4211646">//&nbsp;UTCTime&nbsp;only&nbsp;encodes&nbsp;times&nbsp;prior&nbsp;to&nbsp;2050.&nbsp;See&nbsp;https://tools.ietf.org/html/rfc5280#section-4.1.2.5.1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4211751">ret</span>&nbsp;<span class="op" id="4211755">=</span>&nbsp;<span class="ident" id="4211757">ret</span><span class="op" id="4211760">.</span><span class="ident" id="4211761">AddDate</span><span class="op" id="4211768">(</span><span class="op" id="4211769">-</span><span class="num" id="4211770">100</span><span class="op" id="4211773">,</span>&nbsp;<span class="num" id="4211775">0</span><span class="op" id="4211776">,</span>&nbsp;<span class="num" id="4211778">0</span><span class="op" id="4211779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4211782">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211786">return</span><br>
<span class="lineno">300</span><span class="op" id="4211793">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4211796">//&nbsp;parseGeneralizedTime&nbsp;parses&nbsp;the&nbsp;GeneralizedTime&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice</span><br>
<span class="lineno"></span><span class="comment" id="4211873">//&nbsp;and&nbsp;returns&nbsp;the&nbsp;resulting&nbsp;time.</span><br>
<span class="lineno"></span><span class="keyword" id="4211908">func</span>&nbsp;<span class="ident" id="4211913">parseGeneralizedTime</span><span class="op" id="4211933">(</span><span class="ident" id="4211934">bytes</span>&nbsp;<span class="op" id="4211940">[</span><span class="op" id="4211941">]</span><span class="builtintype" id="4211942">byte</span><span class="op" id="4211946">)</span>&nbsp;<span class="op" id="4211948">(</span><span class="ident" id="4211949">ret</span>&nbsp;<span class="ident" id="4211953">time</span><span class="op" id="4211957">.</span><span class="ident" id="4211958">Time</span><span class="op" id="4211962">,</span>&nbsp;<span class="ident" id="4211964">err</span>&nbsp;<span class="builtintype" id="4211968">error</span><span class="op" id="4211973">)</span>&nbsp;<span class="op" id="4211975">{</span><br>
<span class="lineno">305</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4211978">return</span>&nbsp;<span class="ident" id="4211985">time</span><span class="op" id="4211989">.</span><span class="ident" id="4211990">Parse</span><span class="op" id="4211995">(</span><span class="string" id="4211996">&#34;20060102150405Z0700&#34;</span><span class="op" id="4212017">,</span>&nbsp;<span class="builtintype" id="4212019">string</span><span class="op" id="4212025">(</span><span class="ident" id="4212026">bytes</span><span class="op" id="4212031">)</span><span class="op" id="4212032">)</span><br>
<span class="lineno"></span><span class="op" id="4212034">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4212037">//&nbsp;PrintableString</span><br>
<span class="lineno"></span><br>
<span class="lineno">310</span><span class="comment" id="4212057">//&nbsp;parsePrintableString&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;PrintableString&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4212132">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4212157">func</span>&nbsp;<span class="ident" id="4212162">parsePrintableString</span><span class="op" id="4212182">(</span><span class="ident" id="4212183">bytes</span>&nbsp;<span class="op" id="4212189">[</span><span class="op" id="4212190">]</span><span class="builtintype" id="4212191">byte</span><span class="op" id="4212195">)</span>&nbsp;<span class="op" id="4212197">(</span><span class="ident" id="4212198">ret</span>&nbsp;<span class="builtintype" id="4212202">string</span><span class="op" id="4212208">,</span>&nbsp;<span class="ident" id="4212210">err</span>&nbsp;<span class="builtintype" id="4212214">error</span><span class="op" id="4212219">)</span>&nbsp;<span class="op" id="4212221">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4212224">for</span>&nbsp;<span class="ident" id="4212228">_</span><span class="op" id="4212229">,</span>&nbsp;<span class="ident" id="4212231">b</span>&nbsp;<span class="op" id="4212233">:=</span>&nbsp;<span class="keyword" id="4212236">range</span>&nbsp;<span class="ident" id="4212242">bytes</span>&nbsp;<span class="op" id="4212248">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4212252">if</span>&nbsp;<span class="op" id="4212255">!</span><span class="ident" id="4212256">isPrintable</span><span class="op" id="4212267">(</span><span class="ident" id="4212268">b</span><span class="op" id="4212269">)</span>&nbsp;<span class="op" id="4212271">{</span><br>
<span class="lineno">315</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212276">err</span>&nbsp;<span class="op" id="4212280">=</span>&nbsp;<span class="ident" id="4212282">SyntaxError</span><span class="op" id="4212293">{</span><span class="string" id="4212294">&#34;PrintableString&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4212338">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4212343">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4212352">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4212355">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212358">ret</span>&nbsp;<span class="op" id="4212362">=</span>&nbsp;<span class="builtintype" id="4212364">string</span><span class="op" id="4212370">(</span><span class="ident" id="4212371">bytes</span><span class="op" id="4212376">)</span><br>
<span class="lineno">320</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4212379">return</span><br>
<span class="lineno"></span><span class="op" id="4212386">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4212389">//&nbsp;isPrintable&nbsp;returns&nbsp;true&nbsp;iff&nbsp;the&nbsp;given&nbsp;b&nbsp;is&nbsp;in&nbsp;the&nbsp;ASN.1&nbsp;PrintableString&nbsp;set.</span><br>
<span class="lineno"></span><span class="keyword" id="4212470">func</span>&nbsp;<span class="ident" id="4212475">isPrintable</span><span class="op" id="4212486">(</span><span class="ident" id="4212487">b</span>&nbsp;<span class="builtintype" id="4212489">byte</span><span class="op" id="4212493">)</span>&nbsp;<span class="builtintype" id="4212495">bool</span>&nbsp;<span class="op" id="4212500">{</span><br>
<span class="lineno">325</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4212503">return</span>&nbsp;<span class="string" id="4212510">&#39;a&#39;</span>&nbsp;<span class="op" id="4212514">&lt;=</span>&nbsp;<span class="ident" id="4212517">b</span>&nbsp;<span class="op" id="4212519">&amp;&amp;</span>&nbsp;<span class="ident" id="4212522">b</span>&nbsp;<span class="op" id="4212524">&lt;=</span>&nbsp;<span class="string" id="4212527">&#39;z&#39;</span>&nbsp;<span class="op" id="4212531">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4212536">&#39;A&#39;</span>&nbsp;<span class="op" id="4212540">&lt;=</span>&nbsp;<span class="ident" id="4212543">b</span>&nbsp;<span class="op" id="4212545">&amp;&amp;</span>&nbsp;<span class="ident" id="4212548">b</span>&nbsp;<span class="op" id="4212550">&lt;=</span>&nbsp;<span class="string" id="4212553">&#39;Z&#39;</span>&nbsp;<span class="op" id="4212557">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4212562">&#39;0&#39;</span>&nbsp;<span class="op" id="4212566">&lt;=</span>&nbsp;<span class="ident" id="4212569">b</span>&nbsp;<span class="op" id="4212571">&amp;&amp;</span>&nbsp;<span class="ident" id="4212574">b</span>&nbsp;<span class="op" id="4212576">&lt;=</span>&nbsp;<span class="string" id="4212579">&#39;9&#39;</span>&nbsp;<span class="op" id="4212583">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4212588">&#39;\&#39;&#39;</span>&nbsp;<span class="op" id="4212593">&lt;=</span>&nbsp;<span class="ident" id="4212596">b</span>&nbsp;<span class="op" id="4212598">&amp;&amp;</span>&nbsp;<span class="ident" id="4212601">b</span>&nbsp;<span class="op" id="4212603">&lt;=</span>&nbsp;<span class="string" id="4212606">&#39;)&#39;</span>&nbsp;<span class="op" id="4212610">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4212615">&#39;+&#39;</span>&nbsp;<span class="op" id="4212619">&lt;=</span>&nbsp;<span class="ident" id="4212622">b</span>&nbsp;<span class="op" id="4212624">&amp;&amp;</span>&nbsp;<span class="ident" id="4212627">b</span>&nbsp;<span class="op" id="4212629">&lt;=</span>&nbsp;<span class="string" id="4212632">&#39;/&#39;</span>&nbsp;<span class="op" id="4212636">||</span><br>
<span class="lineno">330</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212641">b</span>&nbsp;<span class="op" id="4212643">==</span>&nbsp;<span class="string" id="4212646">&#39;&nbsp;&#39;</span>&nbsp;<span class="op" id="4212650">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212655">b</span>&nbsp;<span class="op" id="4212657">==</span>&nbsp;<span class="string" id="4212660">&#39;:&#39;</span>&nbsp;<span class="op" id="4212664">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212669">b</span>&nbsp;<span class="op" id="4212671">==</span>&nbsp;<span class="string" id="4212674">&#39;=&#39;</span>&nbsp;<span class="op" id="4212678">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212683">b</span>&nbsp;<span class="op" id="4212685">==</span>&nbsp;<span class="string" id="4212688">&#39;?&#39;</span>&nbsp;<span class="op" id="4212692">||</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4212697">//&nbsp;This&nbsp;is&nbsp;technically&nbsp;not&nbsp;allowed&nbsp;in&nbsp;a&nbsp;PrintableString.</span><br>
<span class="lineno">335</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4212756">//&nbsp;However,&nbsp;x509&nbsp;certificates&nbsp;with&nbsp;wildcard&nbsp;strings&nbsp;don&#39;t</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4212816">//&nbsp;always&nbsp;use&nbsp;the&nbsp;correct&nbsp;string&nbsp;type&nbsp;so&nbsp;we&nbsp;permit&nbsp;it.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4212873">b</span>&nbsp;<span class="op" id="4212875">==</span>&nbsp;<span class="string" id="4212878">&#39;*&#39;</span><br>
<span class="lineno"></span><span class="op" id="4212882">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">340</span><span class="comment" id="4212885">//&nbsp;IA5String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4212899">//&nbsp;parseIA5String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;IA5String&nbsp;(ASCII&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4212972">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4213002">func</span>&nbsp;<span class="ident" id="4213007">parseIA5String</span><span class="op" id="4213021">(</span><span class="ident" id="4213022">bytes</span>&nbsp;<span class="op" id="4213028">[</span><span class="op" id="4213029">]</span><span class="builtintype" id="4213030">byte</span><span class="op" id="4213034">)</span>&nbsp;<span class="op" id="4213036">(</span><span class="ident" id="4213037">ret</span>&nbsp;<span class="builtintype" id="4213041">string</span><span class="op" id="4213047">,</span>&nbsp;<span class="ident" id="4213049">err</span>&nbsp;<span class="builtintype" id="4213053">error</span><span class="op" id="4213058">)</span>&nbsp;<span class="op" id="4213060">{</span><br>
<span class="lineno">345</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4213063">for</span>&nbsp;<span class="ident" id="4213067">_</span><span class="op" id="4213068">,</span>&nbsp;<span class="ident" id="4213070">b</span>&nbsp;<span class="op" id="4213072">:=</span>&nbsp;<span class="keyword" id="4213075">range</span>&nbsp;<span class="ident" id="4213081">bytes</span>&nbsp;<span class="op" id="4213087">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4213091">if</span>&nbsp;<span class="ident" id="4213094">b</span>&nbsp;<span class="op" id="4213096">&gt;=</span>&nbsp;<span class="num" id="4213099">0x80</span>&nbsp;<span class="op" id="4213104">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213109">err</span>&nbsp;<span class="op" id="4213113">=</span>&nbsp;<span class="ident" id="4213115">SyntaxError</span><span class="op" id="4213126">{</span><span class="string" id="4213127">&#34;IA5String&nbsp;contains&nbsp;invalid&nbsp;character&#34;</span><span class="op" id="4213165">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4213170">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4213179">}</span><br>
<span class="lineno">350</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4213182">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213185">ret</span>&nbsp;<span class="op" id="4213189">=</span>&nbsp;<span class="builtintype" id="4213191">string</span><span class="op" id="4213197">(</span><span class="ident" id="4213198">bytes</span><span class="op" id="4213203">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4213206">return</span><br>
<span class="lineno"></span><span class="op" id="4213213">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">355</span><span class="comment" id="4213216">//&nbsp;T61String</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4213230">//&nbsp;parseT61String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;T61String&nbsp;(8-bit&nbsp;clean&nbsp;string)&nbsp;from&nbsp;the&nbsp;given</span><br>
<span class="lineno"></span><span class="comment" id="4213309">//&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4213339">func</span>&nbsp;<span class="ident" id="4213344">parseT61String</span><span class="op" id="4213358">(</span><span class="ident" id="4213359">bytes</span>&nbsp;<span class="op" id="4213365">[</span><span class="op" id="4213366">]</span><span class="builtintype" id="4213367">byte</span><span class="op" id="4213371">)</span>&nbsp;<span class="op" id="4213373">(</span><span class="ident" id="4213374">ret</span>&nbsp;<span class="builtintype" id="4213378">string</span><span class="op" id="4213384">,</span>&nbsp;<span class="ident" id="4213386">err</span>&nbsp;<span class="builtintype" id="4213390">error</span><span class="op" id="4213395">)</span>&nbsp;<span class="op" id="4213397">{</span><br>
<span class="lineno">360</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4213400">return</span>&nbsp;<span class="builtintype" id="4213407">string</span><span class="op" id="4213413">(</span><span class="ident" id="4213414">bytes</span><span class="op" id="4213419">)</span><span class="op" id="4213420">,</span>&nbsp;<span class="ident" id="4213422">nil</span><br>
<span class="lineno"></span><span class="op" id="4213426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4213429">//&nbsp;UTF8String</span><br>
<span class="lineno"></span><br>
<span class="lineno">365</span><span class="comment" id="4213444">//&nbsp;parseUTF8String&nbsp;parses&nbsp;a&nbsp;ASN.1&nbsp;UTF8String&nbsp;(raw&nbsp;UTF-8)&nbsp;from&nbsp;the&nbsp;given&nbsp;byte</span><br>
<span class="lineno"></span><span class="comment" id="4213521">//&nbsp;array&nbsp;and&nbsp;returns&nbsp;it.</span><br>
<span class="lineno"></span><span class="keyword" id="4213546">func</span>&nbsp;<span class="ident" id="4213551">parseUTF8String</span><span class="op" id="4213566">(</span><span class="ident" id="4213567">bytes</span>&nbsp;<span class="op" id="4213573">[</span><span class="op" id="4213574">]</span><span class="builtintype" id="4213575">byte</span><span class="op" id="4213579">)</span>&nbsp;<span class="op" id="4213581">(</span><span class="ident" id="4213582">ret</span>&nbsp;<span class="builtintype" id="4213586">string</span><span class="op" id="4213592">,</span>&nbsp;<span class="ident" id="4213594">err</span>&nbsp;<span class="builtintype" id="4213598">error</span><span class="op" id="4213603">)</span>&nbsp;<span class="op" id="4213605">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4213608">return</span>&nbsp;<span class="builtintype" id="4213615">string</span><span class="op" id="4213621">(</span><span class="ident" id="4213622">bytes</span><span class="op" id="4213627">)</span><span class="op" id="4213628">,</span>&nbsp;<span class="ident" id="4213630">nil</span><br>
<span class="lineno"></span><span class="op" id="4213634">}</span><br>
<span class="lineno">370</span><br>
<span class="lineno"></span><span class="comment" id="4213637">//&nbsp;A&nbsp;RawValue&nbsp;represents&nbsp;an&nbsp;undecoded&nbsp;ASN.1&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="4213689">type</span>&nbsp;<span class="ident" id="4213694">RawValue</span>&nbsp;<span class="keyword" id="4213703">struct</span>&nbsp;<span class="op" id="4213710">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213713">Class</span><span class="op" id="4213718">,</span>&nbsp;<span class="ident" id="4213720">Tag</span>&nbsp;<span class="builtintype" id="4213724">int</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213729">IsCompound</span>&nbsp;<span class="builtintype" id="4213740">bool</span><br>
<span class="lineno">375</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213746">Bytes</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4213757">[</span><span class="op" id="4213758">]</span><span class="builtintype" id="4213759">byte</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4213765">FullBytes</span>&nbsp;&nbsp;<span class="op" id="4213776">[</span><span class="op" id="4213777">]</span><span class="builtintype" id="4213778">byte</span>&nbsp;<span class="comment" id="4213783">//&nbsp;includes&nbsp;the&nbsp;tag&nbsp;and&nbsp;length</span><br>
<span class="lineno"></span><span class="op" id="4213814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4213817">//&nbsp;RawContent&nbsp;is&nbsp;used&nbsp;to&nbsp;signal&nbsp;that&nbsp;the&nbsp;undecoded,&nbsp;DER&nbsp;data&nbsp;needs&nbsp;to&nbsp;be</span><br>
<span class="lineno">380</span><span class="comment" id="4213890">//&nbsp;preserved&nbsp;for&nbsp;a&nbsp;struct.&nbsp;To&nbsp;use&nbsp;it,&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;the&nbsp;struct&nbsp;must&nbsp;have</span><br>
<span class="lineno"></span><span class="comment" id="4213968">//&nbsp;this&nbsp;type.&nbsp;It&#39;s&nbsp;an&nbsp;error&nbsp;for&nbsp;any&nbsp;of&nbsp;the&nbsp;other&nbsp;fields&nbsp;to&nbsp;have&nbsp;this&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4214043">type</span>&nbsp;<span class="ident" id="4214048">RawContent</span>&nbsp;<span class="op" id="4214059">[</span><span class="op" id="4214060">]</span><span class="builtintype" id="4214061">byte</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4214067">//&nbsp;Tagging</span><br>
<span class="lineno">385</span><br>
<span class="lineno"></span><span class="comment" id="4214079">//&nbsp;parseTagAndLength&nbsp;parses&nbsp;an&nbsp;ASN.1&nbsp;tag&nbsp;and&nbsp;length&nbsp;pair&nbsp;from&nbsp;the&nbsp;given&nbsp;offset</span><br>
<span class="lineno"></span><span class="comment" id="4214158">//&nbsp;into&nbsp;a&nbsp;byte&nbsp;slice.&nbsp;It&nbsp;returns&nbsp;the&nbsp;parsed&nbsp;data&nbsp;and&nbsp;the&nbsp;new&nbsp;offset.&nbsp;SET&nbsp;and</span><br>
<span class="lineno"></span><span class="comment" id="4214235">//&nbsp;SET&nbsp;OF&nbsp;(tag&nbsp;17)&nbsp;are&nbsp;mapped&nbsp;to&nbsp;SEQUENCE&nbsp;and&nbsp;SEQUENCE&nbsp;OF&nbsp;(tag&nbsp;16)&nbsp;since&nbsp;we</span><br>
<span class="lineno"></span><span class="comment" id="4214311">//&nbsp;don&#39;t&nbsp;distinguish&nbsp;between&nbsp;ordered&nbsp;and&nbsp;unordered&nbsp;objects&nbsp;in&nbsp;this&nbsp;code.</span><br>
<span class="lineno">390</span><span class="keyword" id="4214384">func</span>&nbsp;<span class="ident" id="4214389">parseTagAndLength</span><span class="op" id="4214406">(</span><span class="ident" id="4214407">bytes</span>&nbsp;<span class="op" id="4214413">[</span><span class="op" id="4214414">]</span><span class="builtintype" id="4214415">byte</span><span class="op" id="4214419">,</span>&nbsp;<span class="ident" id="4214421">initOffset</span>&nbsp;<span class="builtintype" id="4214432">int</span><span class="op" id="4214435">)</span>&nbsp;<span class="op" id="4214437">(</span><span class="ident" id="4214438">ret</span>&nbsp;<span class="ident" id="4214442">tagAndLength</span><span class="op" id="4214454">,</span>&nbsp;<span class="ident" id="4214456">offset</span>&nbsp;<span class="builtintype" id="4214463">int</span><span class="op" id="4214466">,</span>&nbsp;<span class="ident" id="4214468">err</span>&nbsp;<span class="builtintype" id="4214472">error</span><span class="op" id="4214477">)</span>&nbsp;<span class="op" id="4214479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214482">offset</span>&nbsp;<span class="op" id="4214489">=</span>&nbsp;<span class="ident" id="4214491">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214503">b</span>&nbsp;<span class="op" id="4214505">:=</span>&nbsp;<span class="ident" id="4214508">bytes</span><span class="op" id="4214513">[</span><span class="ident" id="4214514">offset</span><span class="op" id="4214520">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214523">offset</span><span class="op" id="4214529">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214533">ret</span><span class="op" id="4214536">.</span><span class="ident" id="4214537">class</span>&nbsp;<span class="op" id="4214543">=</span>&nbsp;<span class="builtintype" id="4214545">int</span><span class="op" id="4214548">(</span><span class="ident" id="4214549">b</span>&nbsp;<span class="op" id="4214551">&gt;&gt;</span>&nbsp;<span class="num" id="4214554">6</span><span class="op" id="4214555">)</span><br>
<span class="lineno">395</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214558">ret</span><span class="op" id="4214561">.</span><span class="ident" id="4214562">isCompound</span>&nbsp;<span class="op" id="4214573">=</span>&nbsp;<span class="ident" id="4214575">b</span><span class="op" id="4214576">&amp;</span><span class="num" id="4214577">0x20</span>&nbsp;<span class="op" id="4214582">==</span>&nbsp;<span class="num" id="4214585">0x20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214591">ret</span><span class="op" id="4214594">.</span><span class="ident" id="4214595">tag</span>&nbsp;<span class="op" id="4214599">=</span>&nbsp;<span class="builtintype" id="4214601">int</span><span class="op" id="4214604">(</span><span class="ident" id="4214605">b</span>&nbsp;<span class="op" id="4214607">&amp;</span>&nbsp;<span class="num" id="4214609">0x1f</span><span class="op" id="4214613">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4214617">//&nbsp;If&nbsp;the&nbsp;bottom&nbsp;five&nbsp;bits&nbsp;are&nbsp;set,&nbsp;then&nbsp;the&nbsp;tag&nbsp;number&nbsp;is&nbsp;actually&nbsp;base&nbsp;128</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4214695">//&nbsp;encoded&nbsp;afterwards</span><br>
<span class="lineno">400</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214718">if</span>&nbsp;<span class="ident" id="4214721">ret</span><span class="op" id="4214724">.</span><span class="ident" id="4214725">tag</span>&nbsp;<span class="op" id="4214729">==</span>&nbsp;<span class="num" id="4214732">0x1f</span>&nbsp;<span class="op" id="4214737">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214741">ret</span><span class="op" id="4214744">.</span><span class="ident" id="4214745">tag</span><span class="op" id="4214748">,</span>&nbsp;<span class="ident" id="4214750">offset</span><span class="op" id="4214756">,</span>&nbsp;<span class="ident" id="4214758">err</span>&nbsp;<span class="op" id="4214762">=</span>&nbsp;<span class="ident" id="4214764">parseBase128Int</span><span class="op" id="4214779">(</span><span class="ident" id="4214780">bytes</span><span class="op" id="4214785">,</span>&nbsp;<span class="ident" id="4214787">offset</span><span class="op" id="4214793">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214797">if</span>&nbsp;<span class="ident" id="4214800">err</span>&nbsp;<span class="op" id="4214804">!=</span>&nbsp;<span class="ident" id="4214807">nil</span>&nbsp;<span class="op" id="4214811">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214816">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4214825">}</span><br>
<span class="lineno">405</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4214828">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214831">if</span>&nbsp;<span class="ident" id="4214834">offset</span>&nbsp;<span class="op" id="4214841">&gt;=</span>&nbsp;<span class="builtinfunc" id="4214844">len</span><span class="op" id="4214847">(</span><span class="ident" id="4214848">bytes</span><span class="op" id="4214853">)</span>&nbsp;<span class="op" id="4214855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214859">err</span>&nbsp;<span class="op" id="4214863">=</span>&nbsp;<span class="ident" id="4214865">SyntaxError</span><span class="op" id="4214876">{</span><span class="string" id="4214877">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4214902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214906">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4214914">}</span><br>
<span class="lineno">410</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214917">b</span>&nbsp;<span class="op" id="4214919">=</span>&nbsp;<span class="ident" id="4214921">bytes</span><span class="op" id="4214926">[</span><span class="ident" id="4214927">offset</span><span class="op" id="4214933">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4214936">offset</span><span class="op" id="4214942">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4214946">if</span>&nbsp;<span class="ident" id="4214949">b</span><span class="op" id="4214950">&amp;</span><span class="num" id="4214951">0x80</span>&nbsp;<span class="op" id="4214956">==</span>&nbsp;<span class="num" id="4214959">0</span>&nbsp;<span class="op" id="4214961">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4214965">//&nbsp;The&nbsp;length&nbsp;is&nbsp;encoded&nbsp;in&nbsp;the&nbsp;bottom&nbsp;7&nbsp;bits.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215014">ret</span><span class="op" id="4215017">.</span><span class="ident" id="4215018">length</span>&nbsp;<span class="op" id="4215025">=</span>&nbsp;<span class="builtintype" id="4215027">int</span><span class="op" id="4215030">(</span><span class="ident" id="4215031">b</span>&nbsp;<span class="op" id="4215033">&amp;</span>&nbsp;<span class="num" id="4215035">0x7f</span><span class="op" id="4215039">)</span><br>
<span class="lineno">415</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4215042">}</span>&nbsp;<span class="keyword" id="4215044">else</span>&nbsp;<span class="op" id="4215049">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4215053">//&nbsp;Bottom&nbsp;7&nbsp;bits&nbsp;give&nbsp;the&nbsp;number&nbsp;of&nbsp;length&nbsp;bytes&nbsp;to&nbsp;follow.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215115">numBytes</span>&nbsp;<span class="op" id="4215124">:=</span>&nbsp;<span class="builtintype" id="4215127">int</span><span class="op" id="4215130">(</span><span class="ident" id="4215131">b</span>&nbsp;<span class="op" id="4215133">&amp;</span>&nbsp;<span class="num" id="4215135">0x7f</span><span class="op" id="4215139">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215143">if</span>&nbsp;<span class="ident" id="4215146">numBytes</span>&nbsp;<span class="op" id="4215155">==</span>&nbsp;<span class="num" id="4215158">0</span>&nbsp;<span class="op" id="4215160">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215165">err</span>&nbsp;<span class="op" id="4215169">=</span>&nbsp;<span class="ident" id="4215171">SyntaxError</span><span class="op" id="4215182">{</span><span class="string" id="4215183">&#34;indefinite&nbsp;length&nbsp;found&nbsp;(not&nbsp;DER)&#34;</span><span class="op" id="4215218">}</span><br>
<span class="lineno">420</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215223">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4215232">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215236">ret</span><span class="op" id="4215239">.</span><span class="ident" id="4215240">length</span>&nbsp;<span class="op" id="4215247">=</span>&nbsp;<span class="num" id="4215249">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215253">for</span>&nbsp;<span class="ident" id="4215257">i</span>&nbsp;<span class="op" id="4215259">:=</span>&nbsp;<span class="num" id="4215262">0</span><span class="op" id="4215263">;</span>&nbsp;<span class="ident" id="4215265">i</span>&nbsp;<span class="op" id="4215267">&lt;</span>&nbsp;<span class="ident" id="4215269">numBytes</span><span class="op" id="4215277">;</span>&nbsp;<span class="ident" id="4215279">i</span><span class="op" id="4215280">++</span>&nbsp;<span class="op" id="4215283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215288">if</span>&nbsp;<span class="ident" id="4215291">offset</span>&nbsp;<span class="op" id="4215298">&gt;=</span>&nbsp;<span class="builtinfunc" id="4215301">len</span><span class="op" id="4215304">(</span><span class="ident" id="4215305">bytes</span><span class="op" id="4215310">)</span>&nbsp;<span class="op" id="4215312">{</span><br>
<span class="lineno">425</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215318">err</span>&nbsp;<span class="op" id="4215322">=</span>&nbsp;<span class="ident" id="4215324">SyntaxError</span><span class="op" id="4215335">{</span><span class="string" id="4215336">&#34;truncated&nbsp;tag&nbsp;or&nbsp;length&#34;</span><span class="op" id="4215361">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215367">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4215377">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215382">b</span>&nbsp;<span class="op" id="4215384">=</span>&nbsp;<span class="ident" id="4215386">bytes</span><span class="op" id="4215391">[</span><span class="ident" id="4215392">offset</span><span class="op" id="4215398">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215403">offset</span><span class="op" id="4215409">++</span><br>
<span class="lineno">430</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215415">if</span>&nbsp;<span class="ident" id="4215418">ret</span><span class="op" id="4215421">.</span><span class="ident" id="4215422">length</span>&nbsp;<span class="op" id="4215429">&gt;=</span>&nbsp;<span class="num" id="4215432">1</span><span class="op" id="4215433">&lt;&lt;</span><span class="num" id="4215435">23</span>&nbsp;<span class="op" id="4215438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4215444">//&nbsp;We&nbsp;can&#39;t&nbsp;shift&nbsp;ret.length&nbsp;up&nbsp;without</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4215488">//&nbsp;overflowing.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215508">err</span>&nbsp;<span class="op" id="4215512">=</span>&nbsp;<span class="ident" id="4215514">StructuralError</span><span class="op" id="4215529">{</span><span class="string" id="4215530">&#34;length&nbsp;too&nbsp;large&#34;</span><span class="op" id="4215548">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215554">return</span><br>
<span class="lineno">435</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4215564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215569">ret</span><span class="op" id="4215572">.</span><span class="ident" id="4215573">length</span>&nbsp;<span class="op" id="4215580">&lt;&lt;=</span>&nbsp;<span class="num" id="4215584">8</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215589">ret</span><span class="op" id="4215592">.</span><span class="ident" id="4215593">length</span>&nbsp;<span class="op" id="4215600">|=</span>&nbsp;<span class="builtintype" id="4215603">int</span><span class="op" id="4215606">(</span><span class="ident" id="4215607">b</span><span class="op" id="4215608">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215613">if</span>&nbsp;<span class="ident" id="4215616">ret</span><span class="op" id="4215619">.</span><span class="ident" id="4215620">length</span>&nbsp;<span class="op" id="4215627">==</span>&nbsp;<span class="num" id="4215630">0</span>&nbsp;<span class="op" id="4215632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4215638">//&nbsp;DER&nbsp;requires&nbsp;that&nbsp;lengths&nbsp;be&nbsp;minimal.</span><br>
<span class="lineno">440</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4215683">err</span>&nbsp;<span class="op" id="4215687">=</span>&nbsp;<span class="ident" id="4215689">StructuralError</span><span class="op" id="4215704">{</span><span class="string" id="4215705">&#34;superfluous&nbsp;leading&nbsp;zeros&nbsp;in&nbsp;length&#34;</span><span class="op" id="4215742">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215748">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4215758">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4215762">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4215765">}</span><br>
<span class="lineno">445</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4215769">return</span><br>
<span class="lineno"></span><span class="op" id="4215776">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4215779">//&nbsp;parseSequenceOf&nbsp;is&nbsp;used&nbsp;for&nbsp;SEQUENCE&nbsp;OF&nbsp;and&nbsp;SET&nbsp;OF&nbsp;values.&nbsp;It&nbsp;tries&nbsp;to&nbsp;parse</span><br>
<span class="lineno">450</span><span class="comment" id="4215859">//&nbsp;a&nbsp;number&nbsp;of&nbsp;ASN.1&nbsp;values&nbsp;from&nbsp;the&nbsp;given&nbsp;byte&nbsp;slice&nbsp;and&nbsp;returns&nbsp;them&nbsp;as&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="4215935">//&nbsp;slice&nbsp;of&nbsp;Go&nbsp;values&nbsp;of&nbsp;the&nbsp;given&nbsp;type.</span><br>
<span class="lineno"></span><span class="keyword" id="4215976">func</span>&nbsp;<span class="ident" id="4215981">parseSequenceOf</span><span class="op" id="4215996">(</span><span class="ident" id="4215997">bytes</span>&nbsp;<span class="op" id="4216003">[</span><span class="op" id="4216004">]</span><span class="builtintype" id="4216005">byte</span><span class="op" id="4216009">,</span>&nbsp;<span class="ident" id="4216011">sliceType</span>&nbsp;<span class="ident" id="4216021">reflect</span><span class="op" id="4216028">.</span><span class="ident" id="4216029">Type</span><span class="op" id="4216033">,</span>&nbsp;<span class="ident" id="4216035">elemType</span>&nbsp;<span class="ident" id="4216044">reflect</span><span class="op" id="4216051">.</span><span class="ident" id="4216052">Type</span><span class="op" id="4216056">)</span>&nbsp;<span class="op" id="4216058">(</span><span class="ident" id="4216059">ret</span>&nbsp;<span class="ident" id="4216063">reflect</span><span class="op" id="4216070">.</span><span class="ident" id="4216071">Value</span><span class="op" id="4216076">,</span>&nbsp;<span class="ident" id="4216078">err</span>&nbsp;<span class="builtintype" id="4216082">error</span><span class="op" id="4216087">)</span>&nbsp;<span class="op" id="4216089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216092">expectedTag</span><span class="op" id="4216103">,</span>&nbsp;<span class="ident" id="4216105">compoundType</span><span class="op" id="4216117">,</span>&nbsp;<span class="ident" id="4216119">ok</span>&nbsp;<span class="op" id="4216122">:=</span>&nbsp;<span class="ident" id="4216125">getUniversalType</span><span class="op" id="4216141">(</span><span class="ident" id="4216142">elemType</span><span class="op" id="4216150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216153">if</span>&nbsp;<span class="op" id="4216156">!</span><span class="ident" id="4216157">ok</span>&nbsp;<span class="op" id="4216160">{</span><br>
<span class="lineno">455</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216164">err</span>&nbsp;<span class="op" id="4216168">=</span>&nbsp;<span class="ident" id="4216170">StructuralError</span><span class="op" id="4216185">{</span><span class="string" id="4216186">&#34;unknown&nbsp;Go&nbsp;type&nbsp;for&nbsp;slice&#34;</span><span class="op" id="4216213">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216217">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4216225">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4216229">//&nbsp;First&nbsp;we&nbsp;iterate&nbsp;over&nbsp;the&nbsp;input&nbsp;and&nbsp;count&nbsp;the&nbsp;number&nbsp;of&nbsp;elements,</span><br>
<span class="lineno">460</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4216299">//&nbsp;checking&nbsp;that&nbsp;the&nbsp;types&nbsp;are&nbsp;correct&nbsp;in&nbsp;each&nbsp;case.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216353">numElements</span>&nbsp;<span class="op" id="4216365">:=</span>&nbsp;<span class="num" id="4216368">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216371">for</span>&nbsp;<span class="ident" id="4216375">offset</span>&nbsp;<span class="op" id="4216382">:=</span>&nbsp;<span class="num" id="4216385">0</span><span class="op" id="4216386">;</span>&nbsp;<span class="ident" id="4216388">offset</span>&nbsp;<span class="op" id="4216395">&lt;</span>&nbsp;<span class="builtinfunc" id="4216397">len</span><span class="op" id="4216400">(</span><span class="ident" id="4216401">bytes</span><span class="op" id="4216406">)</span><span class="op" id="4216407">;</span>&nbsp;<span class="op" id="4216409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216413">var</span>&nbsp;<span class="ident" id="4216417">t</span>&nbsp;<span class="ident" id="4216419">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216434">t</span><span class="op" id="4216435">,</span>&nbsp;<span class="ident" id="4216437">offset</span><span class="op" id="4216443">,</span>&nbsp;<span class="ident" id="4216445">err</span>&nbsp;<span class="op" id="4216449">=</span>&nbsp;<span class="ident" id="4216451">parseTagAndLength</span><span class="op" id="4216468">(</span><span class="ident" id="4216469">bytes</span><span class="op" id="4216474">,</span>&nbsp;<span class="ident" id="4216476">offset</span><span class="op" id="4216482">)</span><br>
<span class="lineno">465</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216486">if</span>&nbsp;<span class="ident" id="4216489">err</span>&nbsp;<span class="op" id="4216493">!=</span>&nbsp;<span class="ident" id="4216496">nil</span>&nbsp;<span class="op" id="4216500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216505">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4216514">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216518">switch</span>&nbsp;<span class="ident" id="4216525">t</span><span class="op" id="4216526">.</span><span class="ident" id="4216527">tag</span>&nbsp;<span class="op" id="4216531">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216535">case</span>&nbsp;<span class="ident" id="4216540">tagIA5String</span><span class="op" id="4216552">,</span>&nbsp;<span class="ident" id="4216554">tagGeneralString</span><span class="op" id="4216570">,</span>&nbsp;<span class="ident" id="4216572">tagT61String</span><span class="op" id="4216584">,</span>&nbsp;<span class="ident" id="4216586">tagUTF8String</span><span class="op" id="4216599">:</span><br>
<span class="lineno">470</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4216604">//&nbsp;We&nbsp;pretend&nbsp;that&nbsp;various&nbsp;other&nbsp;string&nbsp;types&nbsp;are</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4216657">//&nbsp;PRINTABLE&nbsp;STRINGs&nbsp;so&nbsp;that&nbsp;a&nbsp;sequence&nbsp;of&nbsp;them&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4216715">//&nbsp;parsed&nbsp;into&nbsp;a&nbsp;[]string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216745">t</span><span class="op" id="4216746">.</span><span class="ident" id="4216747">tag</span>&nbsp;<span class="op" id="4216751">=</span>&nbsp;<span class="ident" id="4216753">tagPrintableString</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216774">case</span>&nbsp;<span class="ident" id="4216779">tagGeneralizedTime</span><span class="op" id="4216797">,</span>&nbsp;<span class="ident" id="4216799">tagUTCTime</span><span class="op" id="4216809">:</span><br>
<span class="lineno">475</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4216814">//&nbsp;Likewise,&nbsp;both&nbsp;time&nbsp;types&nbsp;are&nbsp;treated&nbsp;the&nbsp;same.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216868">t</span><span class="op" id="4216869">.</span><span class="ident" id="4216870">tag</span>&nbsp;<span class="op" id="4216874">=</span>&nbsp;<span class="ident" id="4216876">tagUTCTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4216889">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4216894">if</span>&nbsp;<span class="ident" id="4216897">t</span><span class="op" id="4216898">.</span><span class="ident" id="4216899">class</span>&nbsp;<span class="op" id="4216905">!=</span>&nbsp;<span class="ident" id="4216908">classUniversal</span>&nbsp;<span class="op" id="4216923">||</span>&nbsp;<span class="ident" id="4216926">t</span><span class="op" id="4216927">.</span><span class="ident" id="4216928">isCompound</span>&nbsp;<span class="op" id="4216939">!=</span>&nbsp;<span class="ident" id="4216942">compoundType</span>&nbsp;<span class="op" id="4216955">||</span>&nbsp;<span class="ident" id="4216958">t</span><span class="op" id="4216959">.</span><span class="ident" id="4216960">tag</span>&nbsp;<span class="op" id="4216964">!=</span>&nbsp;<span class="ident" id="4216967">expectedTag</span>&nbsp;<span class="op" id="4216979">{</span><br>
<span class="lineno">480</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4216984">err</span>&nbsp;<span class="op" id="4216988">=</span>&nbsp;<span class="ident" id="4216990">StructuralError</span><span class="op" id="4217005">{</span><span class="string" id="4217006">&#34;sequence&nbsp;tag&nbsp;mismatch&#34;</span><span class="op" id="4217029">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4217034">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4217043">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4217047">if</span>&nbsp;<span class="ident" id="4217050">invalidLength</span><span class="op" id="4217063">(</span><span class="ident" id="4217064">offset</span><span class="op" id="4217070">,</span>&nbsp;<span class="ident" id="4217072">t</span><span class="op" id="4217073">.</span><span class="ident" id="4217074">length</span><span class="op" id="4217080">,</span>&nbsp;<span class="builtinfunc" id="4217082">len</span><span class="op" id="4217085">(</span><span class="ident" id="4217086">bytes</span><span class="op" id="4217091">)</span><span class="op" id="4217092">)</span>&nbsp;<span class="op" id="4217094">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217099">err</span>&nbsp;<span class="op" id="4217103">=</span>&nbsp;<span class="ident" id="4217105">SyntaxError</span><span class="op" id="4217116">{</span><span class="string" id="4217117">&#34;truncated&nbsp;sequence&#34;</span><span class="op" id="4217137">}</span><br>
<span class="lineno">485</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4217142">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4217151">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217155">offset</span>&nbsp;<span class="op" id="4217162">+=</span>&nbsp;<span class="ident" id="4217165">t</span><span class="op" id="4217166">.</span><span class="ident" id="4217167">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217176">numElements</span><span class="op" id="4217187">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4217191">}</span><br>
<span class="lineno">490</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217194">ret</span>&nbsp;<span class="op" id="4217198">=</span>&nbsp;<span class="ident" id="4217200">reflect</span><span class="op" id="4217207">.</span><span class="ident" id="4217208">MakeSlice</span><span class="op" id="4217217">(</span><span class="ident" id="4217218">sliceType</span><span class="op" id="4217227">,</span>&nbsp;<span class="ident" id="4217229">numElements</span><span class="op" id="4217240">,</span>&nbsp;<span class="ident" id="4217242">numElements</span><span class="op" id="4217253">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217256">params</span>&nbsp;<span class="op" id="4217263">:=</span>&nbsp;<span class="ident" id="4217266">fieldParameters</span><span class="op" id="4217281">{</span><span class="op" id="4217282">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217285">offset</span>&nbsp;<span class="op" id="4217292">:=</span>&nbsp;<span class="num" id="4217295">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4217298">for</span>&nbsp;<span class="ident" id="4217302">i</span>&nbsp;<span class="op" id="4217304">:=</span>&nbsp;<span class="num" id="4217307">0</span><span class="op" id="4217308">;</span>&nbsp;<span class="ident" id="4217310">i</span>&nbsp;<span class="op" id="4217312">&lt;</span>&nbsp;<span class="ident" id="4217314">numElements</span><span class="op" id="4217325">;</span>&nbsp;<span class="ident" id="4217327">i</span><span class="op" id="4217328">++</span>&nbsp;<span class="op" id="4217331">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217335">offset</span><span class="op" id="4217341">,</span>&nbsp;<span class="ident" id="4217343">err</span>&nbsp;<span class="op" id="4217347">=</span>&nbsp;<span class="ident" id="4217349">parseField</span><span class="op" id="4217359">(</span><span class="ident" id="4217360">ret</span><span class="op" id="4217363">.</span><span class="ident" id="4217364">Index</span><span class="op" id="4217369">(</span><span class="ident" id="4217370">i</span><span class="op" id="4217371">)</span><span class="op" id="4217372">,</span>&nbsp;<span class="ident" id="4217374">bytes</span><span class="op" id="4217379">,</span>&nbsp;<span class="ident" id="4217381">offset</span><span class="op" id="4217387">,</span>&nbsp;<span class="ident" id="4217389">params</span><span class="op" id="4217395">)</span><br>
<span class="lineno">495</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4217399">if</span>&nbsp;<span class="ident" id="4217402">err</span>&nbsp;<span class="op" id="4217406">!=</span>&nbsp;<span class="ident" id="4217409">nil</span>&nbsp;<span class="op" id="4217413">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4217418">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4217427">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4217430">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4217433">return</span><br>
<span class="lineno">500</span><span class="op" id="4217440">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4217443">var</span>&nbsp;<span class="op" id="4217447">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217450">bitStringType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4217471">=</span>&nbsp;<span class="ident" id="4217473">reflect</span><span class="op" id="4217480">.</span><span class="ident" id="4217481">TypeOf</span><span class="op" id="4217487">(</span><span class="ident" id="4217488">BitString</span><span class="op" id="4217497">{</span><span class="op" id="4217498">}</span><span class="op" id="4217499">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217502">objectIdentifierType</span>&nbsp;<span class="op" id="4217523">=</span>&nbsp;<span class="ident" id="4217525">reflect</span><span class="op" id="4217532">.</span><span class="ident" id="4217533">TypeOf</span><span class="op" id="4217539">(</span><span class="ident" id="4217540">ObjectIdentifier</span><span class="op" id="4217556">{</span><span class="op" id="4217557">}</span><span class="op" id="4217558">)</span><br>
<span class="lineno">505</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217561">enumeratedType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4217582">=</span>&nbsp;<span class="ident" id="4217584">reflect</span><span class="op" id="4217591">.</span><span class="ident" id="4217592">TypeOf</span><span class="op" id="4217598">(</span><span class="ident" id="4217599">Enumerated</span><span class="op" id="4217609">(</span><span class="num" id="4217610">0</span><span class="op" id="4217611">)</span><span class="op" id="4217612">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217615">flagType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4217636">=</span>&nbsp;<span class="ident" id="4217638">reflect</span><span class="op" id="4217645">.</span><span class="ident" id="4217646">TypeOf</span><span class="op" id="4217652">(</span><span class="ident" id="4217653">Flag</span><span class="op" id="4217657">(</span><span class="ident" id="4217658">false</span><span class="op" id="4217663">)</span><span class="op" id="4217664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217667">timeType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4217688">=</span>&nbsp;<span class="ident" id="4217690">reflect</span><span class="op" id="4217697">.</span><span class="ident" id="4217698">TypeOf</span><span class="op" id="4217704">(</span><span class="ident" id="4217705">time</span><span class="op" id="4217709">.</span><span class="ident" id="4217710">Time</span><span class="op" id="4217714">{</span><span class="op" id="4217715">}</span><span class="op" id="4217716">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217719">rawValueType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4217740">=</span>&nbsp;<span class="ident" id="4217742">reflect</span><span class="op" id="4217749">.</span><span class="ident" id="4217750">TypeOf</span><span class="op" id="4217756">(</span><span class="ident" id="4217757">RawValue</span><span class="op" id="4217765">{</span><span class="op" id="4217766">}</span><span class="op" id="4217767">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217770">rawContentsType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4217791">=</span>&nbsp;<span class="ident" id="4217793">reflect</span><span class="op" id="4217800">.</span><span class="ident" id="4217801">TypeOf</span><span class="op" id="4217807">(</span><span class="ident" id="4217808">RawContent</span><span class="op" id="4217818">(</span><span class="ident" id="4217819">nil</span><span class="op" id="4217822">)</span><span class="op" id="4217823">)</span><br>
<span class="lineno">510</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4217826">bigIntType</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4217847">=</span>&nbsp;<span class="ident" id="4217849">reflect</span><span class="op" id="4217856">.</span><span class="ident" id="4217857">TypeOf</span><span class="op" id="4217863">(</span><span class="builtinfunc" id="4217864">new</span><span class="op" id="4217867">(</span><span class="ident" id="4217868">big</span><span class="op" id="4217871">.</span><span class="ident" id="4217872">Int</span><span class="op" id="4217875">)</span><span class="op" id="4217876">)</span><br>
<span class="lineno"></span><span class="op" id="4217878">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4217881">//&nbsp;invalidLength&nbsp;returns&nbsp;true&nbsp;iff&nbsp;offset&nbsp;+&nbsp;length&nbsp;&gt;&nbsp;sliceLength,&nbsp;or&nbsp;if&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4217956">//&nbsp;addition&nbsp;would&nbsp;overflow.</span><br>
<span class="lineno">515</span><span class="keyword" id="4217984">func</span>&nbsp;<span class="ident" id="4217989">invalidLength</span><span class="op" id="4218002">(</span><span class="ident" id="4218003">offset</span><span class="op" id="4218009">,</span>&nbsp;<span class="ident" id="4218011">length</span><span class="op" id="4218017">,</span>&nbsp;<span class="ident" id="4218019">sliceLength</span>&nbsp;<span class="builtintype" id="4218031">int</span><span class="op" id="4218034">)</span>&nbsp;<span class="builtintype" id="4218036">bool</span>&nbsp;<span class="op" id="4218041">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218044">return</span>&nbsp;<span class="ident" id="4218051">offset</span><span class="op" id="4218057">+</span><span class="ident" id="4218058">length</span>&nbsp;<span class="op" id="4218065">&lt;</span>&nbsp;<span class="ident" id="4218067">offset</span>&nbsp;<span class="op" id="4218074">||</span>&nbsp;<span class="ident" id="4218077">offset</span><span class="op" id="4218083">+</span><span class="ident" id="4218084">length</span>&nbsp;<span class="op" id="4218091">&gt;</span>&nbsp;<span class="ident" id="4218093">sliceLength</span><br>
<span class="lineno"></span><span class="op" id="4218105">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4218108">//&nbsp;parseField&nbsp;is&nbsp;the&nbsp;main&nbsp;parsing&nbsp;function.&nbsp;Given&nbsp;a&nbsp;byte&nbsp;slice&nbsp;and&nbsp;an&nbsp;offset</span><br>
<span class="lineno">520</span><span class="comment" id="4218185">//&nbsp;into&nbsp;the&nbsp;array,&nbsp;it&nbsp;will&nbsp;try&nbsp;to&nbsp;parse&nbsp;a&nbsp;suitable&nbsp;ASN.1&nbsp;value&nbsp;out&nbsp;and&nbsp;store&nbsp;it</span><br>
<span class="lineno"></span><span class="comment" id="4218265">//&nbsp;in&nbsp;the&nbsp;given&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4218288">func</span>&nbsp;<span class="ident" id="4218293">parseField</span><span class="op" id="4218303">(</span><span class="ident" id="4218304">v</span>&nbsp;<span class="ident" id="4218306">reflect</span><span class="op" id="4218313">.</span><span class="ident" id="4218314">Value</span><span class="op" id="4218319">,</span>&nbsp;<span class="ident" id="4218321">bytes</span>&nbsp;<span class="op" id="4218327">[</span><span class="op" id="4218328">]</span><span class="builtintype" id="4218329">byte</span><span class="op" id="4218333">,</span>&nbsp;<span class="ident" id="4218335">initOffset</span>&nbsp;<span class="builtintype" id="4218346">int</span><span class="op" id="4218349">,</span>&nbsp;<span class="ident" id="4218351">params</span>&nbsp;<span class="ident" id="4218358">fieldParameters</span><span class="op" id="4218373">)</span>&nbsp;<span class="op" id="4218375">(</span><span class="ident" id="4218376">offset</span>&nbsp;<span class="builtintype" id="4218383">int</span><span class="op" id="4218386">,</span>&nbsp;<span class="ident" id="4218388">err</span>&nbsp;<span class="builtintype" id="4218392">error</span><span class="op" id="4218397">)</span>&nbsp;<span class="op" id="4218399">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218402">offset</span>&nbsp;<span class="op" id="4218409">=</span>&nbsp;<span class="ident" id="4218411">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218423">fieldType</span>&nbsp;<span class="op" id="4218433">:=</span>&nbsp;<span class="ident" id="4218436">v</span><span class="op" id="4218437">.</span><span class="ident" id="4218438">Type</span><span class="op" id="4218442">(</span><span class="op" id="4218443">)</span><br>
<span class="lineno">525</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4218447">//&nbsp;If&nbsp;we&nbsp;have&nbsp;run&nbsp;out&nbsp;of&nbsp;data,&nbsp;it&nbsp;may&nbsp;be&nbsp;that&nbsp;there&nbsp;are&nbsp;optional&nbsp;elements&nbsp;at&nbsp;the&nbsp;end.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218534">if</span>&nbsp;<span class="ident" id="4218537">offset</span>&nbsp;<span class="op" id="4218544">==</span>&nbsp;<span class="builtinfunc" id="4218547">len</span><span class="op" id="4218550">(</span><span class="ident" id="4218551">bytes</span><span class="op" id="4218556">)</span>&nbsp;<span class="op" id="4218558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218562">if</span>&nbsp;<span class="op" id="4218565">!</span><span class="ident" id="4218566">setDefaultValue</span><span class="op" id="4218581">(</span><span class="ident" id="4218582">v</span><span class="op" id="4218583">,</span>&nbsp;<span class="ident" id="4218585">params</span><span class="op" id="4218591">)</span>&nbsp;<span class="op" id="4218593">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218598">err</span>&nbsp;<span class="op" id="4218602">=</span>&nbsp;<span class="ident" id="4218604">SyntaxError</span><span class="op" id="4218615">{</span><span class="string" id="4218616">&#34;sequence&nbsp;truncated&#34;</span><span class="op" id="4218636">}</span><br>
<span class="lineno">530</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4218640">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218644">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4218652">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4218656">//&nbsp;Deal&nbsp;with&nbsp;raw&nbsp;values.</span><br>
<span class="lineno">535</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218682">if</span>&nbsp;<span class="ident" id="4218685">fieldType</span>&nbsp;<span class="op" id="4218695">==</span>&nbsp;<span class="ident" id="4218698">rawValueType</span>&nbsp;<span class="op" id="4218711">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218715">var</span>&nbsp;<span class="ident" id="4218719">t</span>&nbsp;<span class="ident" id="4218721">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218736">t</span><span class="op" id="4218737">,</span>&nbsp;<span class="ident" id="4218739">offset</span><span class="op" id="4218745">,</span>&nbsp;<span class="ident" id="4218747">err</span>&nbsp;<span class="op" id="4218751">=</span>&nbsp;<span class="ident" id="4218753">parseTagAndLength</span><span class="op" id="4218770">(</span><span class="ident" id="4218771">bytes</span><span class="op" id="4218776">,</span>&nbsp;<span class="ident" id="4218778">offset</span><span class="op" id="4218784">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218788">if</span>&nbsp;<span class="ident" id="4218791">err</span>&nbsp;<span class="op" id="4218795">!=</span>&nbsp;<span class="ident" id="4218798">nil</span>&nbsp;<span class="op" id="4218802">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218807">return</span><br>
<span class="lineno">540</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4218816">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218820">if</span>&nbsp;<span class="ident" id="4218823">invalidLength</span><span class="op" id="4218836">(</span><span class="ident" id="4218837">offset</span><span class="op" id="4218843">,</span>&nbsp;<span class="ident" id="4218845">t</span><span class="op" id="4218846">.</span><span class="ident" id="4218847">length</span><span class="op" id="4218853">,</span>&nbsp;<span class="builtinfunc" id="4218855">len</span><span class="op" id="4218858">(</span><span class="ident" id="4218859">bytes</span><span class="op" id="4218864">)</span><span class="op" id="4218865">)</span>&nbsp;<span class="op" id="4218867">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218872">err</span>&nbsp;<span class="op" id="4218876">=</span>&nbsp;<span class="ident" id="4218878">SyntaxError</span><span class="op" id="4218889">{</span><span class="string" id="4218890">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4218906">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4218911">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4218920">}</span><br>
<span class="lineno">545</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4218924">result</span>&nbsp;<span class="op" id="4218931">:=</span>&nbsp;<span class="ident" id="4218934">RawValue</span><span class="op" id="4218942">{</span><span class="ident" id="4218943">t</span><span class="op" id="4218944">.</span><span class="ident" id="4218945">class</span><span class="op" id="4218950">,</span>&nbsp;<span class="ident" id="4218952">t</span><span class="op" id="4218953">.</span><span class="ident" id="4218954">tag</span><span class="op" id="4218957">,</span>&nbsp;<span class="ident" id="4218959">t</span><span class="op" id="4218960">.</span><span class="ident" id="4218961">isCompound</span><span class="op" id="4218971">,</span>&nbsp;<span class="ident" id="4218973">bytes</span><span class="op" id="4218978">[</span><span class="ident" id="4218979">offset</span>&nbsp;<span class="op" id="4218986">:</span>&nbsp;<span class="ident" id="4218988">offset</span><span class="op" id="4218994">+</span><span class="ident" id="4218995">t</span><span class="op" id="4218996">.</span><span class="ident" id="4218997">length</span><span class="op" id="4219003">]</span><span class="op" id="4219004">,</span>&nbsp;<span class="ident" id="4219006">bytes</span><span class="op" id="4219011">[</span><span class="ident" id="4219012">initOffset</span>&nbsp;<span class="op" id="4219023">:</span>&nbsp;<span class="ident" id="4219025">offset</span><span class="op" id="4219031">+</span><span class="ident" id="4219032">t</span><span class="op" id="4219033">.</span><span class="ident" id="4219034">length</span><span class="op" id="4219040">]</span><span class="op" id="4219041">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219045">offset</span>&nbsp;<span class="op" id="4219052">+=</span>&nbsp;<span class="ident" id="4219055">t</span><span class="op" id="4219056">.</span><span class="ident" id="4219057">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219066">v</span><span class="op" id="4219067">.</span><span class="ident" id="4219068">Set</span><span class="op" id="4219071">(</span><span class="ident" id="4219072">reflect</span><span class="op" id="4219079">.</span><span class="ident" id="4219080">ValueOf</span><span class="op" id="4219087">(</span><span class="ident" id="4219088">result</span><span class="op" id="4219094">)</span><span class="op" id="4219095">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219099">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4219107">}</span><br>
<span class="lineno">550</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4219111">//&nbsp;Deal&nbsp;with&nbsp;the&nbsp;ANY&nbsp;type.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219139">if</span>&nbsp;<span class="ident" id="4219142">ifaceType</span>&nbsp;<span class="op" id="4219152">:=</span>&nbsp;<span class="ident" id="4219155">fieldType</span><span class="op" id="4219164">;</span>&nbsp;<span class="ident" id="4219166">ifaceType</span><span class="op" id="4219175">.</span><span class="ident" id="4219176">Kind</span><span class="op" id="4219180">(</span><span class="op" id="4219181">)</span>&nbsp;<span class="op" id="4219183">==</span>&nbsp;<span class="ident" id="4219186">reflect</span><span class="op" id="4219193">.</span><span class="ident" id="4219194">Interface</span>&nbsp;<span class="op" id="4219204">&amp;&amp;</span>&nbsp;<span class="ident" id="4219207">ifaceType</span><span class="op" id="4219216">.</span><span class="ident" id="4219217">NumMethod</span><span class="op" id="4219226">(</span><span class="op" id="4219227">)</span>&nbsp;<span class="op" id="4219229">==</span>&nbsp;<span class="num" id="4219232">0</span>&nbsp;<span class="op" id="4219234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219238">var</span>&nbsp;<span class="ident" id="4219242">t</span>&nbsp;<span class="ident" id="4219244">tagAndLength</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219259">t</span><span class="op" id="4219260">,</span>&nbsp;<span class="ident" id="4219262">offset</span><span class="op" id="4219268">,</span>&nbsp;<span class="ident" id="4219270">err</span>&nbsp;<span class="op" id="4219274">=</span>&nbsp;<span class="ident" id="4219276">parseTagAndLength</span><span class="op" id="4219293">(</span><span class="ident" id="4219294">bytes</span><span class="op" id="4219299">,</span>&nbsp;<span class="ident" id="4219301">offset</span><span class="op" id="4219307">)</span><br>
<span class="lineno">555</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219311">if</span>&nbsp;<span class="ident" id="4219314">err</span>&nbsp;<span class="op" id="4219318">!=</span>&nbsp;<span class="ident" id="4219321">nil</span>&nbsp;<span class="op" id="4219325">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219330">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4219339">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219343">if</span>&nbsp;<span class="ident" id="4219346">invalidLength</span><span class="op" id="4219359">(</span><span class="ident" id="4219360">offset</span><span class="op" id="4219366">,</span>&nbsp;<span class="ident" id="4219368">t</span><span class="op" id="4219369">.</span><span class="ident" id="4219370">length</span><span class="op" id="4219376">,</span>&nbsp;<span class="builtinfunc" id="4219378">len</span><span class="op" id="4219381">(</span><span class="ident" id="4219382">bytes</span><span class="op" id="4219387">)</span><span class="op" id="4219388">)</span>&nbsp;<span class="op" id="4219390">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219395">err</span>&nbsp;<span class="op" id="4219399">=</span>&nbsp;<span class="ident" id="4219401">SyntaxError</span><span class="op" id="4219412">{</span><span class="string" id="4219413">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4219429">}</span><br>
<span class="lineno">560</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219434">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4219443">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219447">var</span>&nbsp;<span class="ident" id="4219451">result</span>&nbsp;<span class="keyword" id="4219458">interface</span><span class="op" id="4219467">{</span><span class="op" id="4219468">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219472">if</span>&nbsp;<span class="op" id="4219475">!</span><span class="ident" id="4219476">t</span><span class="op" id="4219477">.</span><span class="ident" id="4219478">isCompound</span>&nbsp;<span class="op" id="4219489">&amp;&amp;</span>&nbsp;<span class="ident" id="4219492">t</span><span class="op" id="4219493">.</span><span class="ident" id="4219494">class</span>&nbsp;<span class="op" id="4219500">==</span>&nbsp;<span class="ident" id="4219503">classUniversal</span>&nbsp;<span class="op" id="4219518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219523">innerBytes</span>&nbsp;<span class="op" id="4219534">:=</span>&nbsp;<span class="ident" id="4219537">bytes</span><span class="op" id="4219542">[</span><span class="ident" id="4219543">offset</span>&nbsp;<span class="op" id="4219550">:</span>&nbsp;<span class="ident" id="4219552">offset</span><span class="op" id="4219558">+</span><span class="ident" id="4219559">t</span><span class="op" id="4219560">.</span><span class="ident" id="4219561">length</span><span class="op" id="4219567">]</span><br>
<span class="lineno">565</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219572">switch</span>&nbsp;<span class="ident" id="4219579">t</span><span class="op" id="4219580">.</span><span class="ident" id="4219581">tag</span>&nbsp;<span class="op" id="4219585">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219590">case</span>&nbsp;<span class="ident" id="4219595">tagPrintableString</span><span class="op" id="4219613">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219619">result</span><span class="op" id="4219625">,</span>&nbsp;<span class="ident" id="4219627">err</span>&nbsp;<span class="op" id="4219631">=</span>&nbsp;<span class="ident" id="4219633">parsePrintableString</span><span class="op" id="4219653">(</span><span class="ident" id="4219654">innerBytes</span><span class="op" id="4219664">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219669">case</span>&nbsp;<span class="ident" id="4219674">tagIA5String</span><span class="op" id="4219686">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219692">result</span><span class="op" id="4219698">,</span>&nbsp;<span class="ident" id="4219700">err</span>&nbsp;<span class="op" id="4219704">=</span>&nbsp;<span class="ident" id="4219706">parseIA5String</span><span class="op" id="4219720">(</span><span class="ident" id="4219721">innerBytes</span><span class="op" id="4219731">)</span><br>
<span class="lineno">570</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219736">case</span>&nbsp;<span class="ident" id="4219741">tagT61String</span><span class="op" id="4219753">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219759">result</span><span class="op" id="4219765">,</span>&nbsp;<span class="ident" id="4219767">err</span>&nbsp;<span class="op" id="4219771">=</span>&nbsp;<span class="ident" id="4219773">parseT61String</span><span class="op" id="4219787">(</span><span class="ident" id="4219788">innerBytes</span><span class="op" id="4219798">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219803">case</span>&nbsp;<span class="ident" id="4219808">tagUTF8String</span><span class="op" id="4219821">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219827">result</span><span class="op" id="4219833">,</span>&nbsp;<span class="ident" id="4219835">err</span>&nbsp;<span class="op" id="4219839">=</span>&nbsp;<span class="ident" id="4219841">parseUTF8String</span><span class="op" id="4219856">(</span><span class="ident" id="4219857">innerBytes</span><span class="op" id="4219867">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219872">case</span>&nbsp;<span class="ident" id="4219877">tagInteger</span><span class="op" id="4219887">:</span><br>
<span class="lineno">575</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219893">result</span><span class="op" id="4219899">,</span>&nbsp;<span class="ident" id="4219901">err</span>&nbsp;<span class="op" id="4219905">=</span>&nbsp;<span class="ident" id="4219907">parseInt64</span><span class="op" id="4219917">(</span><span class="ident" id="4219918">innerBytes</span><span class="op" id="4219928">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4219933">case</span>&nbsp;<span class="ident" id="4219938">tagBitString</span><span class="op" id="4219950">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4219956">result</span><span class="op" id="4219962">,</span>&nbsp;<span class="ident" id="4219964">err</span>&nbsp;<span class="op" id="4219968">=</span>&nbsp;<span class="ident" id="4219970">parseBitString</span><span class="op" id="4219984">(</span><span class="ident" id="4219985">innerBytes</span><span class="op" id="4219995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220000">case</span>&nbsp;<span class="ident" id="4220005">tagOID</span><span class="op" id="4220011">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220017">result</span><span class="op" id="4220023">,</span>&nbsp;<span class="ident" id="4220025">err</span>&nbsp;<span class="op" id="4220029">=</span>&nbsp;<span class="ident" id="4220031">parseObjectIdentifier</span><span class="op" id="4220052">(</span><span class="ident" id="4220053">innerBytes</span><span class="op" id="4220063">)</span><br>
<span class="lineno">580</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220068">case</span>&nbsp;<span class="ident" id="4220073">tagUTCTime</span><span class="op" id="4220083">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220089">result</span><span class="op" id="4220095">,</span>&nbsp;<span class="ident" id="4220097">err</span>&nbsp;<span class="op" id="4220101">=</span>&nbsp;<span class="ident" id="4220103">parseUTCTime</span><span class="op" id="4220115">(</span><span class="ident" id="4220116">innerBytes</span><span class="op" id="4220126">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220131">case</span>&nbsp;<span class="ident" id="4220136">tagOctetString</span><span class="op" id="4220150">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220156">result</span>&nbsp;<span class="op" id="4220163">=</span>&nbsp;<span class="ident" id="4220165">innerBytes</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220179">default</span><span class="op" id="4220186">:</span><br>
<span class="lineno">585</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4220192">//&nbsp;If&nbsp;we&nbsp;don&#39;t&nbsp;know&nbsp;how&nbsp;to&nbsp;handle&nbsp;the&nbsp;type,&nbsp;we&nbsp;just&nbsp;leave&nbsp;Value&nbsp;as&nbsp;nil.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220267">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220271">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220275">offset</span>&nbsp;<span class="op" id="4220282">+=</span>&nbsp;<span class="ident" id="4220285">t</span><span class="op" id="4220286">.</span><span class="ident" id="4220287">length</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220296">if</span>&nbsp;<span class="ident" id="4220299">err</span>&nbsp;<span class="op" id="4220303">!=</span>&nbsp;<span class="ident" id="4220306">nil</span>&nbsp;<span class="op" id="4220310">{</span><br>
<span class="lineno">590</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220315">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220324">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220328">if</span>&nbsp;<span class="ident" id="4220331">result</span>&nbsp;<span class="op" id="4220338">!=</span>&nbsp;<span class="ident" id="4220341">nil</span>&nbsp;<span class="op" id="4220345">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220350">v</span><span class="op" id="4220351">.</span><span class="ident" id="4220352">Set</span><span class="op" id="4220355">(</span><span class="ident" id="4220356">reflect</span><span class="op" id="4220363">.</span><span class="ident" id="4220364">ValueOf</span><span class="op" id="4220371">(</span><span class="ident" id="4220372">result</span><span class="op" id="4220378">)</span><span class="op" id="4220379">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220383">}</span><br>
<span class="lineno">595</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220387">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220395">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220398">universalTag</span><span class="op" id="4220410">,</span>&nbsp;<span class="ident" id="4220412">compoundType</span><span class="op" id="4220424">,</span>&nbsp;<span class="ident" id="4220426">ok1</span>&nbsp;<span class="op" id="4220430">:=</span>&nbsp;<span class="ident" id="4220433">getUniversalType</span><span class="op" id="4220449">(</span><span class="ident" id="4220450">fieldType</span><span class="op" id="4220459">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220462">if</span>&nbsp;<span class="op" id="4220465">!</span><span class="ident" id="4220466">ok1</span>&nbsp;<span class="op" id="4220470">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220474">err</span>&nbsp;<span class="op" id="4220478">=</span>&nbsp;<span class="ident" id="4220480">StructuralError</span><span class="op" id="4220495">{</span><span class="ident" id="4220496">fmt</span><span class="op" id="4220499">.</span><span class="ident" id="4220500">Sprintf</span><span class="op" id="4220507">(</span><span class="string" id="4220508">&#34;unknown&nbsp;Go&nbsp;type:&nbsp;%v&#34;</span><span class="op" id="4220529">,</span>&nbsp;<span class="ident" id="4220531">fieldType</span><span class="op" id="4220540">)</span><span class="op" id="4220541">}</span><br>
<span class="lineno">600</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220545">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220553">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220557">t</span><span class="op" id="4220558">,</span>&nbsp;<span class="ident" id="4220560">offset</span><span class="op" id="4220566">,</span>&nbsp;<span class="ident" id="4220568">err</span>&nbsp;<span class="op" id="4220572">:=</span>&nbsp;<span class="ident" id="4220575">parseTagAndLength</span><span class="op" id="4220592">(</span><span class="ident" id="4220593">bytes</span><span class="op" id="4220598">,</span>&nbsp;<span class="ident" id="4220600">offset</span><span class="op" id="4220606">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220609">if</span>&nbsp;<span class="ident" id="4220612">err</span>&nbsp;<span class="op" id="4220616">!=</span>&nbsp;<span class="ident" id="4220619">nil</span>&nbsp;<span class="op" id="4220623">{</span><br>
<span class="lineno">605</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220627">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220635">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220638">if</span>&nbsp;<span class="ident" id="4220641">params</span><span class="op" id="4220647">.</span><span class="ident" id="4220648">explicit</span>&nbsp;<span class="op" id="4220657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220661">expectedClass</span>&nbsp;<span class="op" id="4220675">:=</span>&nbsp;<span class="ident" id="4220678">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220701">if</span>&nbsp;<span class="ident" id="4220704">params</span><span class="op" id="4220710">.</span><span class="ident" id="4220711">application</span>&nbsp;<span class="op" id="4220723">{</span><br>
<span class="lineno">610</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220728">expectedClass</span>&nbsp;<span class="op" id="4220742">=</span>&nbsp;<span class="ident" id="4220744">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220763">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220767">if</span>&nbsp;<span class="ident" id="4220770">t</span><span class="op" id="4220771">.</span><span class="ident" id="4220772">class</span>&nbsp;<span class="op" id="4220778">==</span>&nbsp;<span class="ident" id="4220781">expectedClass</span>&nbsp;<span class="op" id="4220795">&amp;&amp;</span>&nbsp;<span class="ident" id="4220798">t</span><span class="op" id="4220799">.</span><span class="ident" id="4220800">tag</span>&nbsp;<span class="op" id="4220804">==</span>&nbsp;<span class="op" id="4220807">*</span><span class="ident" id="4220808">params</span><span class="op" id="4220814">.</span><span class="ident" id="4220815">tag</span>&nbsp;<span class="op" id="4220819">&amp;&amp;</span>&nbsp;<span class="op" id="4220822">(</span><span class="ident" id="4220823">t</span><span class="op" id="4220824">.</span><span class="ident" id="4220825">length</span>&nbsp;<span class="op" id="4220832">==</span>&nbsp;<span class="num" id="4220835">0</span>&nbsp;<span class="op" id="4220837">||</span>&nbsp;<span class="ident" id="4220840">t</span><span class="op" id="4220841">.</span><span class="ident" id="4220842">isCompound</span><span class="op" id="4220852">)</span>&nbsp;<span class="op" id="4220854">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220859">if</span>&nbsp;<span class="ident" id="4220862">t</span><span class="op" id="4220863">.</span><span class="ident" id="4220864">length</span>&nbsp;<span class="op" id="4220871">&gt;</span>&nbsp;<span class="num" id="4220873">0</span>&nbsp;<span class="op" id="4220875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4220881">t</span><span class="op" id="4220882">,</span>&nbsp;<span class="ident" id="4220884">offset</span><span class="op" id="4220890">,</span>&nbsp;<span class="ident" id="4220892">err</span>&nbsp;<span class="op" id="4220896">=</span>&nbsp;<span class="ident" id="4220898">parseTagAndLength</span><span class="op" id="4220915">(</span><span class="ident" id="4220916">bytes</span><span class="op" id="4220921">,</span>&nbsp;<span class="ident" id="4220923">offset</span><span class="op" id="4220929">)</span><br>
<span class="lineno">615</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220935">if</span>&nbsp;<span class="ident" id="4220938">err</span>&nbsp;<span class="op" id="4220942">!=</span>&nbsp;<span class="ident" id="4220945">nil</span>&nbsp;<span class="op" id="4220949">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220956">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220967">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4220972">}</span>&nbsp;<span class="keyword" id="4220974">else</span>&nbsp;<span class="op" id="4220979">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4220985">if</span>&nbsp;<span class="ident" id="4220988">fieldType</span>&nbsp;<span class="op" id="4220998">!=</span>&nbsp;<span class="ident" id="4221001">flagType</span>&nbsp;<span class="op" id="4221010">{</span><br>
<span class="lineno">620</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221017">err</span>&nbsp;<span class="op" id="4221021">=</span>&nbsp;<span class="ident" id="4221023">StructuralError</span><span class="op" id="4221038">{</span><span class="string" id="4221039">&#34;zero&nbsp;length&nbsp;explicit&nbsp;tag&nbsp;was&nbsp;not&nbsp;an&nbsp;asn1.Flag&#34;</span><span class="op" id="4221086">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221093">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4221104">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221110">v</span><span class="op" id="4221111">.</span><span class="ident" id="4221112">SetBool</span><span class="op" id="4221119">(</span><span class="ident" id="4221120">true</span><span class="op" id="4221124">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221130">return</span><br>
<span class="lineno">625</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4221140">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4221144">}</span>&nbsp;<span class="keyword" id="4221146">else</span>&nbsp;<span class="op" id="4221151">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4221156">//&nbsp;The&nbsp;tags&nbsp;didn&#39;t&nbsp;match,&nbsp;it&nbsp;might&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221218">ok</span>&nbsp;<span class="op" id="4221221">:=</span>&nbsp;<span class="ident" id="4221224">setDefaultValue</span><span class="op" id="4221239">(</span><span class="ident" id="4221240">v</span><span class="op" id="4221241">,</span>&nbsp;<span class="ident" id="4221243">params</span><span class="op" id="4221249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221254">if</span>&nbsp;<span class="ident" id="4221257">ok</span>&nbsp;<span class="op" id="4221260">{</span><br>
<span class="lineno">630</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221266">offset</span>&nbsp;<span class="op" id="4221273">=</span>&nbsp;<span class="ident" id="4221275">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4221289">}</span>&nbsp;<span class="keyword" id="4221291">else</span>&nbsp;<span class="op" id="4221296">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221302">err</span>&nbsp;<span class="op" id="4221306">=</span>&nbsp;<span class="ident" id="4221308">StructuralError</span><span class="op" id="4221323">{</span><span class="string" id="4221324">&#34;explicitly&nbsp;tagged&nbsp;member&nbsp;didn&#39;t&nbsp;match&#34;</span><span class="op" id="4221363">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4221368">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221373">return</span><br>
<span class="lineno">635</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4221382">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4221385">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4221389">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;strings:&nbsp;all&nbsp;the&nbsp;ASN.1&nbsp;string&nbsp;types&nbsp;map&nbsp;to&nbsp;the&nbsp;Go</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4221460">//&nbsp;type&nbsp;string.&nbsp;getUniversalType&nbsp;returns&nbsp;the&nbsp;tag&nbsp;for&nbsp;PrintableString</span><br>
<span class="lineno">640</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4221530">//&nbsp;when&nbsp;it&nbsp;sees&nbsp;a&nbsp;string,&nbsp;so&nbsp;if&nbsp;we&nbsp;see&nbsp;a&nbsp;different&nbsp;string&nbsp;type&nbsp;on&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4221601">//&nbsp;wire,&nbsp;we&nbsp;change&nbsp;the&nbsp;universal&nbsp;type&nbsp;to&nbsp;match.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221650">if</span>&nbsp;<span class="ident" id="4221653">universalTag</span>&nbsp;<span class="op" id="4221666">==</span>&nbsp;<span class="ident" id="4221669">tagPrintableString</span>&nbsp;<span class="op" id="4221688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221692">if</span>&nbsp;<span class="ident" id="4221695">t</span><span class="op" id="4221696">.</span><span class="ident" id="4221697">class</span>&nbsp;<span class="op" id="4221703">==</span>&nbsp;<span class="ident" id="4221706">classUniversal</span>&nbsp;<span class="op" id="4221721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221726">switch</span>&nbsp;<span class="ident" id="4221733">t</span><span class="op" id="4221734">.</span><span class="ident" id="4221735">tag</span>&nbsp;<span class="op" id="4221739">{</span><br>
<span class="lineno">645</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4221744">case</span>&nbsp;<span class="ident" id="4221749">tagIA5String</span><span class="op" id="4221761">,</span>&nbsp;<span class="ident" id="4221763">tagGeneralString</span><span class="op" id="4221779">,</span>&nbsp;<span class="ident" id="4221781">tagT61String</span><span class="op" id="4221793">,</span>&nbsp;<span class="ident" id="4221795">tagUTF8String</span><span class="op" id="4221808">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221814">universalTag</span>&nbsp;<span class="op" id="4221827">=</span>&nbsp;<span class="ident" id="4221829">t</span><span class="op" id="4221830">.</span><span class="ident" id="4221831">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4221838">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4221842">}</span>&nbsp;<span class="keyword" id="4221844">else</span>&nbsp;<span class="keyword" id="4221849">if</span>&nbsp;<span class="ident" id="4221852">params</span><span class="op" id="4221858">.</span><span class="ident" id="4221859">stringType</span>&nbsp;<span class="op" id="4221870">!=</span>&nbsp;<span class="num" id="4221873">0</span>&nbsp;<span class="op" id="4221875">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4221880">universalTag</span>&nbsp;<span class="op" id="4221893">=</span>&nbsp;<span class="ident" id="4221895">params</span><span class="op" id="4221901">.</span><span class="ident" id="4221902">stringType</span><br>
<span class="lineno">650</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4221915">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4221918">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4221922">//&nbsp;Special&nbsp;case&nbsp;for&nbsp;time:&nbsp;UTCTime&nbsp;and&nbsp;GeneralizedTime&nbsp;both&nbsp;map&nbsp;to&nbsp;the</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4221993">//&nbsp;Go&nbsp;type&nbsp;time.Time.</span><br>
<span class="lineno">655</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4222016">if</span>&nbsp;<span class="ident" id="4222019">universalTag</span>&nbsp;<span class="op" id="4222032">==</span>&nbsp;<span class="ident" id="4222035">tagUTCTime</span>&nbsp;<span class="op" id="4222046">&amp;&amp;</span>&nbsp;<span class="ident" id="4222049">t</span><span class="op" id="4222050">.</span><span class="ident" id="4222051">tag</span>&nbsp;<span class="op" id="4222055">==</span>&nbsp;<span class="ident" id="4222058">tagGeneralizedTime</span>&nbsp;<span class="op" id="4222077">&amp;&amp;</span>&nbsp;<span class="ident" id="4222080">t</span><span class="op" id="4222081">.</span><span class="ident" id="4222082">class</span>&nbsp;<span class="op" id="4222088">==</span>&nbsp;<span class="ident" id="4222091">classUniversal</span>&nbsp;<span class="op" id="4222106">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222110">universalTag</span>&nbsp;<span class="op" id="4222123">=</span>&nbsp;<span class="ident" id="4222125">tagGeneralizedTime</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4222145">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4222149">if</span>&nbsp;<span class="ident" id="4222152">params</span><span class="op" id="4222158">.</span><span class="ident" id="4222159">set</span>&nbsp;<span class="op" id="4222163">{</span><br>
<span class="lineno">660</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222167">universalTag</span>&nbsp;<span class="op" id="4222180">=</span>&nbsp;<span class="ident" id="4222182">tagSet</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4222190">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222194">expectedClass</span>&nbsp;<span class="op" id="4222208">:=</span>&nbsp;<span class="ident" id="4222211">classUniversal</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222227">expectedTag</span>&nbsp;<span class="op" id="4222239">:=</span>&nbsp;<span class="ident" id="4222242">universalTag</span><br>
<span class="lineno">665</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4222257">if</span>&nbsp;<span class="op" id="4222260">!</span><span class="ident" id="4222261">params</span><span class="op" id="4222267">.</span><span class="ident" id="4222268">explicit</span>&nbsp;<span class="op" id="4222277">&amp;&amp;</span>&nbsp;<span class="ident" id="4222280">params</span><span class="op" id="4222286">.</span><span class="ident" id="4222287">tag</span>&nbsp;<span class="op" id="4222291">!=</span>&nbsp;<span class="ident" id="4222294">nil</span>&nbsp;<span class="op" id="4222298">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222302">expectedClass</span>&nbsp;<span class="op" id="4222316">=</span>&nbsp;<span class="ident" id="4222318">classContextSpecific</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222341">expectedTag</span>&nbsp;<span class="op" id="4222353">=</span>&nbsp;<span class="op" id="4222355">*</span><span class="ident" id="4222356">params</span><span class="op" id="4222362">.</span><span class="ident" id="4222363">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4222368">}</span><br>
<span class="lineno">670</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4222372">if</span>&nbsp;<span class="op" id="4222375">!</span><span class="ident" id="4222376">params</span><span class="op" id="4222382">.</span><span class="ident" id="4222383">explicit</span>&nbsp;<span class="op" id="4222392">&amp;&amp;</span>&nbsp;<span class="ident" id="4222395">params</span><span class="op" id="4222401">.</span><span class="ident" id="4222402">application</span>&nbsp;<span class="op" id="4222414">&amp;&amp;</span>&nbsp;<span class="ident" id="4222417">params</span><span class="op" id="4222423">.</span><span class="ident" id="4222424">tag</span>&nbsp;<span class="op" id="4222428">!=</span>&nbsp;<span class="ident" id="4222431">nil</span>&nbsp;<span class="op" id="4222435">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222439">expectedClass</span>&nbsp;<span class="op" id="4222453">=</span>&nbsp;<span class="ident" id="4222455">classApplication</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222474">expectedTag</span>&nbsp;<span class="op" id="4222486">=</span>&nbsp;<span class="op" id="4222488">*</span><span class="ident" id="4222489">params</span><span class="op" id="4222495">.</span><span class="ident" id="4222496">tag</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4222501">}</span><br>
<span class="lineno">675</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4222505">//&nbsp;We&nbsp;have&nbsp;unwrapped&nbsp;any&nbsp;explicit&nbsp;tagging&nbsp;at&nbsp;this&nbsp;point.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4222563">if</span>&nbsp;<span class="ident" id="4222566">t</span><span class="op" id="4222567">.</span><span class="ident" id="4222568">class</span>&nbsp;<span class="op" id="4222574">!=</span>&nbsp;<span class="ident" id="4222577">expectedClass</span>&nbsp;<span class="op" id="4222591">||</span>&nbsp;<span class="ident" id="4222594">t</span><span class="op" id="4222595">.</span><span class="ident" id="4222596">tag</span>&nbsp;<span class="op" id="4222600">!=</span>&nbsp;<span class="ident" id="4222603">expectedTag</span>&nbsp;<span class="op" id="4222615">||</span>&nbsp;<span class="ident" id="4222618">t</span><span class="op" id="4222619">.</span><span class="ident" id="4222620">isCompound</span>&nbsp;<span class="op" id="4222631">!=</span>&nbsp;<span class="ident" id="4222634">compoundType</span>&nbsp;<span class="op" id="4222647">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4222651">//&nbsp;Tags&nbsp;don&#39;t&nbsp;match.&nbsp;Again,&nbsp;it&nbsp;could&nbsp;be&nbsp;an&nbsp;optional&nbsp;element.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222714">ok</span>&nbsp;<span class="op" id="4222717">:=</span>&nbsp;<span class="ident" id="4222720">setDefaultValue</span><span class="op" id="4222735">(</span><span class="ident" id="4222736">v</span><span class="op" id="4222737">,</span>&nbsp;<span class="ident" id="4222739">params</span><span class="op" id="4222745">)</span><br>
<span class="lineno">680</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4222749">if</span>&nbsp;<span class="ident" id="4222752">ok</span>&nbsp;<span class="op" id="4222755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222760">offset</span>&nbsp;<span class="op" id="4222767">=</span>&nbsp;<span class="ident" id="4222769">initOffset</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4222782">}</span>&nbsp;<span class="keyword" id="4222784">else</span>&nbsp;<span class="op" id="4222789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222794">err</span>&nbsp;<span class="op" id="4222798">=</span>&nbsp;<span class="ident" id="4222800">StructuralError</span><span class="op" id="4222815">{</span><span class="ident" id="4222816">fmt</span><span class="op" id="4222819">.</span><span class="ident" id="4222820">Sprintf</span><span class="op" id="4222827">(</span><span class="string" id="4222828">&#34;tags&nbsp;don&#39;t&nbsp;match&nbsp;(%d&nbsp;vs&nbsp;%+v)&nbsp;%+v&nbsp;%s&nbsp;@%d&#34;</span><span class="op" id="4222869">,</span>&nbsp;<span class="ident" id="4222871">expectedTag</span><span class="op" id="4222882">,</span>&nbsp;<span class="ident" id="4222884">t</span><span class="op" id="4222885">,</span>&nbsp;<span class="ident" id="4222887">params</span><span class="op" id="4222893">,</span>&nbsp;<span class="ident" id="4222895">fieldType</span><span class="op" id="4222904">.</span><span class="ident" id="4222905">Name</span><span class="op" id="4222909">(</span><span class="op" id="4222910">)</span><span class="op" id="4222911">,</span>&nbsp;<span class="ident" id="4222913">offset</span><span class="op" id="4222919">)</span><span class="op" id="4222920">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4222924">}</span><br>
<span class="lineno">685</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4222928">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4222936">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4222939">if</span>&nbsp;<span class="ident" id="4222942">invalidLength</span><span class="op" id="4222955">(</span><span class="ident" id="4222956">offset</span><span class="op" id="4222962">,</span>&nbsp;<span class="ident" id="4222964">t</span><span class="op" id="4222965">.</span><span class="ident" id="4222966">length</span><span class="op" id="4222972">,</span>&nbsp;<span class="builtinfunc" id="4222974">len</span><span class="op" id="4222977">(</span><span class="ident" id="4222978">bytes</span><span class="op" id="4222983">)</span><span class="op" id="4222984">)</span>&nbsp;<span class="op" id="4222986">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4222990">err</span>&nbsp;<span class="op" id="4222994">=</span>&nbsp;<span class="ident" id="4222996">SyntaxError</span><span class="op" id="4223007">{</span><span class="string" id="4223008">&#34;data&nbsp;truncated&#34;</span><span class="op" id="4223024">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223028">return</span><br>
<span class="lineno">690</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4223036">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223039">innerBytes</span>&nbsp;<span class="op" id="4223050">:=</span>&nbsp;<span class="ident" id="4223053">bytes</span><span class="op" id="4223058">[</span><span class="ident" id="4223059">offset</span>&nbsp;<span class="op" id="4223066">:</span>&nbsp;<span class="ident" id="4223068">offset</span><span class="op" id="4223074">+</span><span class="ident" id="4223075">t</span><span class="op" id="4223076">.</span><span class="ident" id="4223077">length</span><span class="op" id="4223083">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223086">offset</span>&nbsp;<span class="op" id="4223093">+=</span>&nbsp;<span class="ident" id="4223096">t</span><span class="op" id="4223097">.</span><span class="ident" id="4223098">length</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4223107">//&nbsp;We&nbsp;deal&nbsp;with&nbsp;the&nbsp;structures&nbsp;defined&nbsp;in&nbsp;this&nbsp;package&nbsp;first.</span><br>
<span class="lineno">695</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223170">switch</span>&nbsp;<span class="ident" id="4223177">fieldType</span>&nbsp;<span class="op" id="4223187">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223190">case</span>&nbsp;<span class="ident" id="4223195">objectIdentifierType</span><span class="op" id="4223215">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223219">newSlice</span><span class="op" id="4223227">,</span>&nbsp;<span class="ident" id="4223229">err1</span>&nbsp;<span class="op" id="4223234">:=</span>&nbsp;<span class="ident" id="4223237">parseObjectIdentifier</span><span class="op" id="4223258">(</span><span class="ident" id="4223259">innerBytes</span><span class="op" id="4223269">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223273">v</span><span class="op" id="4223274">.</span><span class="ident" id="4223275">Set</span><span class="op" id="4223278">(</span><span class="ident" id="4223279">reflect</span><span class="op" id="4223286">.</span><span class="ident" id="4223287">MakeSlice</span><span class="op" id="4223296">(</span><span class="ident" id="4223297">v</span><span class="op" id="4223298">.</span><span class="ident" id="4223299">Type</span><span class="op" id="4223303">(</span><span class="op" id="4223304">)</span><span class="op" id="4223305">,</span>&nbsp;<span class="builtinfunc" id="4223307">len</span><span class="op" id="4223310">(</span><span class="ident" id="4223311">newSlice</span><span class="op" id="4223319">)</span><span class="op" id="4223320">,</span>&nbsp;<span class="builtinfunc" id="4223322">len</span><span class="op" id="4223325">(</span><span class="ident" id="4223326">newSlice</span><span class="op" id="4223334">)</span><span class="op" id="4223335">)</span><span class="op" id="4223336">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223340">if</span>&nbsp;<span class="ident" id="4223343">err1</span>&nbsp;<span class="op" id="4223348">==</span>&nbsp;<span class="ident" id="4223351">nil</span>&nbsp;<span class="op" id="4223355">{</span><br>
<span class="lineno">700</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223360">reflect</span><span class="op" id="4223367">.</span><span class="ident" id="4223368">Copy</span><span class="op" id="4223372">(</span><span class="ident" id="4223373">v</span><span class="op" id="4223374">,</span>&nbsp;<span class="ident" id="4223376">reflect</span><span class="op" id="4223383">.</span><span class="ident" id="4223384">ValueOf</span><span class="op" id="4223391">(</span><span class="ident" id="4223392">newSlice</span><span class="op" id="4223400">)</span><span class="op" id="4223401">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4223405">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223409">err</span>&nbsp;<span class="op" id="4223413">=</span>&nbsp;<span class="ident" id="4223415">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223422">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223430">case</span>&nbsp;<span class="ident" id="4223435">bitStringType</span><span class="op" id="4223448">:</span><br>
<span class="lineno">705</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223452">bs</span><span class="op" id="4223454">,</span>&nbsp;<span class="ident" id="4223456">err1</span>&nbsp;<span class="op" id="4223461">:=</span>&nbsp;<span class="ident" id="4223464">parseBitString</span><span class="op" id="4223478">(</span><span class="ident" id="4223479">innerBytes</span><span class="op" id="4223489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223493">if</span>&nbsp;<span class="ident" id="4223496">err1</span>&nbsp;<span class="op" id="4223501">==</span>&nbsp;<span class="ident" id="4223504">nil</span>&nbsp;<span class="op" id="4223508">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223513">v</span><span class="op" id="4223514">.</span><span class="ident" id="4223515">Set</span><span class="op" id="4223518">(</span><span class="ident" id="4223519">reflect</span><span class="op" id="4223526">.</span><span class="ident" id="4223527">ValueOf</span><span class="op" id="4223534">(</span><span class="ident" id="4223535">bs</span><span class="op" id="4223537">)</span><span class="op" id="4223538">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4223542">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223546">err</span>&nbsp;<span class="op" id="4223550">=</span>&nbsp;<span class="ident" id="4223552">err1</span><br>
<span class="lineno">710</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223559">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223567">case</span>&nbsp;<span class="ident" id="4223572">timeType</span><span class="op" id="4223580">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223584">var</span>&nbsp;<span class="ident" id="4223588">time</span>&nbsp;<span class="ident" id="4223593">time</span><span class="op" id="4223597">.</span><span class="ident" id="4223598">Time</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223605">var</span>&nbsp;<span class="ident" id="4223609">err1</span>&nbsp;<span class="builtintype" id="4223614">error</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223622">if</span>&nbsp;<span class="ident" id="4223625">universalTag</span>&nbsp;<span class="op" id="4223638">==</span>&nbsp;<span class="ident" id="4223641">tagUTCTime</span>&nbsp;<span class="op" id="4223652">{</span><br>
<span class="lineno">715</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223657">time</span><span class="op" id="4223661">,</span>&nbsp;<span class="ident" id="4223663">err1</span>&nbsp;<span class="op" id="4223668">=</span>&nbsp;<span class="ident" id="4223670">parseUTCTime</span><span class="op" id="4223682">(</span><span class="ident" id="4223683">innerBytes</span><span class="op" id="4223693">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4223697">}</span>&nbsp;<span class="keyword" id="4223699">else</span>&nbsp;<span class="op" id="4223704">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223709">time</span><span class="op" id="4223713">,</span>&nbsp;<span class="ident" id="4223715">err1</span>&nbsp;<span class="op" id="4223720">=</span>&nbsp;<span class="ident" id="4223722">parseGeneralizedTime</span><span class="op" id="4223742">(</span><span class="ident" id="4223743">innerBytes</span><span class="op" id="4223753">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4223757">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223761">if</span>&nbsp;<span class="ident" id="4223764">err1</span>&nbsp;<span class="op" id="4223769">==</span>&nbsp;<span class="ident" id="4223772">nil</span>&nbsp;<span class="op" id="4223776">{</span><br>
<span class="lineno">720</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223781">v</span><span class="op" id="4223782">.</span><span class="ident" id="4223783">Set</span><span class="op" id="4223786">(</span><span class="ident" id="4223787">reflect</span><span class="op" id="4223794">.</span><span class="ident" id="4223795">ValueOf</span><span class="op" id="4223802">(</span><span class="ident" id="4223803">time</span><span class="op" id="4223807">)</span><span class="op" id="4223808">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4223812">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223816">err</span>&nbsp;<span class="op" id="4223820">=</span>&nbsp;<span class="ident" id="4223822">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223829">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223837">case</span>&nbsp;<span class="ident" id="4223842">enumeratedType</span><span class="op" id="4223856">:</span><br>
<span class="lineno">725</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223860">parsedInt</span><span class="op" id="4223869">,</span>&nbsp;<span class="ident" id="4223871">err1</span>&nbsp;<span class="op" id="4223876">:=</span>&nbsp;<span class="ident" id="4223879">parseInt32</span><span class="op" id="4223889">(</span><span class="ident" id="4223890">innerBytes</span><span class="op" id="4223900">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223904">if</span>&nbsp;<span class="ident" id="4223907">err1</span>&nbsp;<span class="op" id="4223912">==</span>&nbsp;<span class="ident" id="4223915">nil</span>&nbsp;<span class="op" id="4223919">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223924">v</span><span class="op" id="4223925">.</span><span class="ident" id="4223926">SetInt</span><span class="op" id="4223932">(</span><span class="ident" id="4223933">int64</span><span class="op" id="4223938">(</span><span class="ident" id="4223939">parsedInt</span><span class="op" id="4223948">)</span><span class="op" id="4223949">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4223953">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223957">err</span>&nbsp;<span class="op" id="4223961">=</span>&nbsp;<span class="ident" id="4223963">err1</span><br>
<span class="lineno">730</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223970">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4223978">case</span>&nbsp;<span class="ident" id="4223983">flagType</span><span class="op" id="4223991">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4223995">v</span><span class="op" id="4223996">.</span><span class="ident" id="4223997">SetBool</span><span class="op" id="4224004">(</span><span class="ident" id="4224005">true</span><span class="op" id="4224009">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224013">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224021">case</span>&nbsp;<span class="ident" id="4224026">bigIntType</span><span class="op" id="4224036">:</span><br>
<span class="lineno">735</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224040">parsedInt</span>&nbsp;<span class="op" id="4224050">:=</span>&nbsp;<span class="ident" id="4224053">parseBigInt</span><span class="op" id="4224064">(</span><span class="ident" id="4224065">innerBytes</span><span class="op" id="4224075">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224079">v</span><span class="op" id="4224080">.</span><span class="ident" id="4224081">Set</span><span class="op" id="4224084">(</span><span class="ident" id="4224085">reflect</span><span class="op" id="4224092">.</span><span class="ident" id="4224093">ValueOf</span><span class="op" id="4224100">(</span><span class="ident" id="4224101">parsedInt</span><span class="op" id="4224110">)</span><span class="op" id="4224111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224115">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224123">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224126">switch</span>&nbsp;<span class="ident" id="4224133">val</span>&nbsp;<span class="op" id="4224137">:=</span>&nbsp;<span class="ident" id="4224140">v</span><span class="op" id="4224141">;</span>&nbsp;<span class="ident" id="4224143">val</span><span class="op" id="4224146">.</span><span class="ident" id="4224147">Kind</span><span class="op" id="4224151">(</span><span class="op" id="4224152">)</span>&nbsp;<span class="op" id="4224154">{</span><br>
<span class="lineno">740</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224157">case</span>&nbsp;<span class="ident" id="4224162">reflect</span><span class="op" id="4224169">.</span><span class="ident" id="4224170">Bool</span><span class="op" id="4224174">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224178">parsedBool</span><span class="op" id="4224188">,</span>&nbsp;<span class="ident" id="4224190">err1</span>&nbsp;<span class="op" id="4224195">:=</span>&nbsp;<span class="ident" id="4224198">parseBool</span><span class="op" id="4224207">(</span><span class="ident" id="4224208">innerBytes</span><span class="op" id="4224218">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224222">if</span>&nbsp;<span class="ident" id="4224225">err1</span>&nbsp;<span class="op" id="4224230">==</span>&nbsp;<span class="ident" id="4224233">nil</span>&nbsp;<span class="op" id="4224237">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224242">val</span><span class="op" id="4224245">.</span><span class="ident" id="4224246">SetBool</span><span class="op" id="4224253">(</span><span class="ident" id="4224254">parsedBool</span><span class="op" id="4224264">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224268">}</span><br>
<span class="lineno">745</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224272">err</span>&nbsp;<span class="op" id="4224276">=</span>&nbsp;<span class="ident" id="4224278">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224285">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224293">case</span>&nbsp;<span class="ident" id="4224298">reflect</span><span class="op" id="4224305">.</span><span class="ident" id="4224306">Int</span><span class="op" id="4224309">,</span>&nbsp;<span class="ident" id="4224311">reflect</span><span class="op" id="4224318">.</span><span class="ident" id="4224319">Int32</span><span class="op" id="4224324">,</span>&nbsp;<span class="ident" id="4224326">reflect</span><span class="op" id="4224333">.</span><span class="ident" id="4224334">Int64</span><span class="op" id="4224339">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224343">if</span>&nbsp;<span class="ident" id="4224346">val</span><span class="op" id="4224349">.</span><span class="ident" id="4224350">Type</span><span class="op" id="4224354">(</span><span class="op" id="4224355">)</span><span class="op" id="4224356">.</span><span class="ident" id="4224357">Size</span><span class="op" id="4224361">(</span><span class="op" id="4224362">)</span>&nbsp;<span class="op" id="4224364">==</span>&nbsp;<span class="num" id="4224367">4</span>&nbsp;<span class="op" id="4224369">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224374">parsedInt</span><span class="op" id="4224383">,</span>&nbsp;<span class="ident" id="4224385">err1</span>&nbsp;<span class="op" id="4224390">:=</span>&nbsp;<span class="ident" id="4224393">parseInt32</span><span class="op" id="4224403">(</span><span class="ident" id="4224404">innerBytes</span><span class="op" id="4224414">)</span><br>
<span class="lineno">750</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224419">if</span>&nbsp;<span class="ident" id="4224422">err1</span>&nbsp;<span class="op" id="4224427">==</span>&nbsp;<span class="ident" id="4224430">nil</span>&nbsp;<span class="op" id="4224434">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224440">val</span><span class="op" id="4224443">.</span><span class="ident" id="4224444">SetInt</span><span class="op" id="4224450">(</span><span class="ident" id="4224451">int64</span><span class="op" id="4224456">(</span><span class="ident" id="4224457">parsedInt</span><span class="op" id="4224466">)</span><span class="op" id="4224467">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224472">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224477">err</span>&nbsp;<span class="op" id="4224481">=</span>&nbsp;<span class="ident" id="4224483">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224490">}</span>&nbsp;<span class="keyword" id="4224492">else</span>&nbsp;<span class="op" id="4224497">{</span><br>
<span class="lineno">755</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224502">parsedInt</span><span class="op" id="4224511">,</span>&nbsp;<span class="ident" id="4224513">err1</span>&nbsp;<span class="op" id="4224518">:=</span>&nbsp;<span class="ident" id="4224521">parseInt64</span><span class="op" id="4224531">(</span><span class="ident" id="4224532">innerBytes</span><span class="op" id="4224542">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224547">if</span>&nbsp;<span class="ident" id="4224550">err1</span>&nbsp;<span class="op" id="4224555">==</span>&nbsp;<span class="ident" id="4224558">nil</span>&nbsp;<span class="op" id="4224562">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224568">val</span><span class="op" id="4224571">.</span><span class="ident" id="4224572">SetInt</span><span class="op" id="4224578">(</span><span class="ident" id="4224579">parsedInt</span><span class="op" id="4224588">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224593">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224598">err</span>&nbsp;<span class="op" id="4224602">=</span>&nbsp;<span class="ident" id="4224604">err1</span><br>
<span class="lineno">760</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224611">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224615">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4224623">//&nbsp;TODO(dfc)&nbsp;Add&nbsp;support&nbsp;for&nbsp;the&nbsp;remaining&nbsp;integer&nbsp;types</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224681">case</span>&nbsp;<span class="ident" id="4224686">reflect</span><span class="op" id="4224693">.</span><span class="ident" id="4224694">Struct</span><span class="op" id="4224700">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224704">structType</span>&nbsp;<span class="op" id="4224715">:=</span>&nbsp;<span class="ident" id="4224718">fieldType</span><br>
<span class="lineno">765</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224731">if</span>&nbsp;<span class="ident" id="4224734">structType</span><span class="op" id="4224744">.</span><span class="ident" id="4224745">NumField</span><span class="op" id="4224753">(</span><span class="op" id="4224754">)</span>&nbsp;<span class="op" id="4224756">&gt;</span>&nbsp;<span class="num" id="4224758">0</span>&nbsp;<span class="op" id="4224760">&amp;&amp;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224766">structType</span><span class="op" id="4224776">.</span><span class="ident" id="4224777">Field</span><span class="op" id="4224782">(</span><span class="num" id="4224783">0</span><span class="op" id="4224784">)</span><span class="op" id="4224785">.</span><span class="ident" id="4224786">Type</span>&nbsp;<span class="op" id="4224791">==</span>&nbsp;<span class="ident" id="4224794">rawContentsType</span>&nbsp;<span class="op" id="4224810">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224815">bytes</span>&nbsp;<span class="op" id="4224821">:=</span>&nbsp;<span class="ident" id="4224824">bytes</span><span class="op" id="4224829">[</span><span class="ident" id="4224830">initOffset</span><span class="op" id="4224840">:</span><span class="ident" id="4224841">offset</span><span class="op" id="4224847">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224852">val</span><span class="op" id="4224855">.</span><span class="ident" id="4224856">Field</span><span class="op" id="4224861">(</span><span class="num" id="4224862">0</span><span class="op" id="4224863">)</span><span class="op" id="4224864">.</span><span class="ident" id="4224865">Set</span><span class="op" id="4224868">(</span><span class="ident" id="4224869">reflect</span><span class="op" id="4224876">.</span><span class="ident" id="4224877">ValueOf</span><span class="op" id="4224884">(</span><span class="ident" id="4224885">RawContent</span><span class="op" id="4224895">(</span><span class="ident" id="4224896">bytes</span><span class="op" id="4224901">)</span><span class="op" id="4224902">)</span><span class="op" id="4224903">)</span><br>
<span class="lineno">770</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4224907">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224912">innerOffset</span>&nbsp;<span class="op" id="4224924">:=</span>&nbsp;<span class="num" id="4224927">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4224931">for</span>&nbsp;<span class="ident" id="4224935">i</span>&nbsp;<span class="op" id="4224937">:=</span>&nbsp;<span class="num" id="4224940">0</span><span class="op" id="4224941">;</span>&nbsp;<span class="ident" id="4224943">i</span>&nbsp;<span class="op" id="4224945">&lt;</span>&nbsp;<span class="ident" id="4224947">structType</span><span class="op" id="4224957">.</span><span class="ident" id="4224958">NumField</span><span class="op" id="4224966">(</span><span class="op" id="4224967">)</span><span class="op" id="4224968">;</span>&nbsp;<span class="ident" id="4224970">i</span><span class="op" id="4224971">++</span>&nbsp;<span class="op" id="4224974">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4224979">field</span>&nbsp;<span class="op" id="4224985">:=</span>&nbsp;<span class="ident" id="4224988">structType</span><span class="op" id="4224998">.</span><span class="ident" id="4224999">Field</span><span class="op" id="4225004">(</span><span class="ident" id="4225005">i</span><span class="op" id="4225006">)</span><br>
<span class="lineno">775</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225011">if</span>&nbsp;<span class="ident" id="4225014">i</span>&nbsp;<span class="op" id="4225016">==</span>&nbsp;<span class="num" id="4225019">0</span>&nbsp;<span class="op" id="4225021">&amp;&amp;</span>&nbsp;<span class="ident" id="4225024">field</span><span class="op" id="4225029">.</span><span class="ident" id="4225030">Type</span>&nbsp;<span class="op" id="4225035">==</span>&nbsp;<span class="ident" id="4225038">rawContentsType</span>&nbsp;<span class="op" id="4225054">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225060">continue</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4225072">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225077">innerOffset</span><span class="op" id="4225088">,</span>&nbsp;<span class="ident" id="4225090">err</span>&nbsp;<span class="op" id="4225094">=</span>&nbsp;<span class="ident" id="4225096">parseField</span><span class="op" id="4225106">(</span><span class="ident" id="4225107">val</span><span class="op" id="4225110">.</span><span class="ident" id="4225111">Field</span><span class="op" id="4225116">(</span><span class="ident" id="4225117">i</span><span class="op" id="4225118">)</span><span class="op" id="4225119">,</span>&nbsp;<span class="ident" id="4225121">innerBytes</span><span class="op" id="4225131">,</span>&nbsp;<span class="ident" id="4225133">innerOffset</span><span class="op" id="4225144">,</span>&nbsp;<span class="ident" id="4225146">parseFieldParameters</span><span class="op" id="4225166">(</span><span class="ident" id="4225167">field</span><span class="op" id="4225172">.</span><span class="ident" id="4225173">Tag</span><span class="op" id="4225176">.</span><span class="ident" id="4225177">Get</span><span class="op" id="4225180">(</span><span class="string" id="4225181">&#34;asn1&#34;</span><span class="op" id="4225187">)</span><span class="op" id="4225188">)</span><span class="op" id="4225189">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225194">if</span>&nbsp;<span class="ident" id="4225197">err</span>&nbsp;<span class="op" id="4225201">!=</span>&nbsp;<span class="ident" id="4225204">nil</span>&nbsp;<span class="op" id="4225208">{</span><br>
<span class="lineno">780</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225214">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4225224">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4225228">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4225232">//&nbsp;We&nbsp;allow&nbsp;extra&nbsp;bytes&nbsp;at&nbsp;the&nbsp;end&nbsp;of&nbsp;the&nbsp;SEQUENCE&nbsp;because</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4225293">//&nbsp;adding&nbsp;elements&nbsp;to&nbsp;the&nbsp;end&nbsp;has&nbsp;been&nbsp;used&nbsp;in&nbsp;X.509&nbsp;as&nbsp;the</span><br>
<span class="lineno">785</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4225355">//&nbsp;version&nbsp;numbers&nbsp;have&nbsp;increased.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225392">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225400">case</span>&nbsp;<span class="ident" id="4225405">reflect</span><span class="op" id="4225412">.</span><span class="ident" id="4225413">Slice</span><span class="op" id="4225418">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225422">sliceType</span>&nbsp;<span class="op" id="4225432">:=</span>&nbsp;<span class="ident" id="4225435">fieldType</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225447">if</span>&nbsp;<span class="ident" id="4225450">sliceType</span><span class="op" id="4225459">.</span><span class="ident" id="4225460">Elem</span><span class="op" id="4225464">(</span><span class="op" id="4225465">)</span><span class="op" id="4225466">.</span><span class="ident" id="4225467">Kind</span><span class="op" id="4225471">(</span><span class="op" id="4225472">)</span>&nbsp;<span class="op" id="4225474">==</span>&nbsp;<span class="ident" id="4225477">reflect</span><span class="op" id="4225484">.</span><span class="ident" id="4225485">Uint8</span>&nbsp;<span class="op" id="4225491">{</span><br>
<span class="lineno">790</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225496">val</span><span class="op" id="4225499">.</span><span class="ident" id="4225500">Set</span><span class="op" id="4225503">(</span><span class="ident" id="4225504">reflect</span><span class="op" id="4225511">.</span><span class="ident" id="4225512">MakeSlice</span><span class="op" id="4225521">(</span><span class="ident" id="4225522">sliceType</span><span class="op" id="4225531">,</span>&nbsp;<span class="builtinfunc" id="4225533">len</span><span class="op" id="4225536">(</span><span class="ident" id="4225537">innerBytes</span><span class="op" id="4225547">)</span><span class="op" id="4225548">,</span>&nbsp;<span class="builtinfunc" id="4225550">len</span><span class="op" id="4225553">(</span><span class="ident" id="4225554">innerBytes</span><span class="op" id="4225564">)</span><span class="op" id="4225565">)</span><span class="op" id="4225566">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225571">reflect</span><span class="op" id="4225578">.</span><span class="ident" id="4225579">Copy</span><span class="op" id="4225583">(</span><span class="ident" id="4225584">val</span><span class="op" id="4225587">,</span>&nbsp;<span class="ident" id="4225589">reflect</span><span class="op" id="4225596">.</span><span class="ident" id="4225597">ValueOf</span><span class="op" id="4225604">(</span><span class="ident" id="4225605">innerBytes</span><span class="op" id="4225615">)</span><span class="op" id="4225616">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225621">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4225630">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225634">newSlice</span><span class="op" id="4225642">,</span>&nbsp;<span class="ident" id="4225644">err1</span>&nbsp;<span class="op" id="4225649">:=</span>&nbsp;<span class="ident" id="4225652">parseSequenceOf</span><span class="op" id="4225667">(</span><span class="ident" id="4225668">innerBytes</span><span class="op" id="4225678">,</span>&nbsp;<span class="ident" id="4225680">sliceType</span><span class="op" id="4225689">,</span>&nbsp;<span class="ident" id="4225691">sliceType</span><span class="op" id="4225700">.</span><span class="ident" id="4225701">Elem</span><span class="op" id="4225705">(</span><span class="op" id="4225706">)</span><span class="op" id="4225707">)</span><br>
<span class="lineno">795</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225711">if</span>&nbsp;<span class="ident" id="4225714">err1</span>&nbsp;<span class="op" id="4225719">==</span>&nbsp;<span class="ident" id="4225722">nil</span>&nbsp;<span class="op" id="4225726">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225731">val</span><span class="op" id="4225734">.</span><span class="ident" id="4225735">Set</span><span class="op" id="4225738">(</span><span class="ident" id="4225739">newSlice</span><span class="op" id="4225747">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4225751">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225755">err</span>&nbsp;<span class="op" id="4225759">=</span>&nbsp;<span class="ident" id="4225761">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225768">return</span><br>
<span class="lineno">800</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225776">case</span>&nbsp;<span class="ident" id="4225781">reflect</span><span class="op" id="4225788">.</span><span class="ident" id="4225789">String</span><span class="op" id="4225795">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225799">var</span>&nbsp;<span class="ident" id="4225803">v</span>&nbsp;<span class="builtintype" id="4225805">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225814">switch</span>&nbsp;<span class="ident" id="4225821">universalTag</span>&nbsp;<span class="op" id="4225834">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225838">case</span>&nbsp;<span class="ident" id="4225843">tagPrintableString</span><span class="op" id="4225861">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225866">v</span><span class="op" id="4225867">,</span>&nbsp;<span class="ident" id="4225869">err</span>&nbsp;<span class="op" id="4225873">=</span>&nbsp;<span class="ident" id="4225875">parsePrintableString</span><span class="op" id="4225895">(</span><span class="ident" id="4225896">innerBytes</span><span class="op" id="4225906">)</span><br>
<span class="lineno">805</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225910">case</span>&nbsp;<span class="ident" id="4225915">tagIA5String</span><span class="op" id="4225927">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225932">v</span><span class="op" id="4225933">,</span>&nbsp;<span class="ident" id="4225935">err</span>&nbsp;<span class="op" id="4225939">=</span>&nbsp;<span class="ident" id="4225941">parseIA5String</span><span class="op" id="4225955">(</span><span class="ident" id="4225956">innerBytes</span><span class="op" id="4225966">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4225970">case</span>&nbsp;<span class="ident" id="4225975">tagT61String</span><span class="op" id="4225987">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4225992">v</span><span class="op" id="4225993">,</span>&nbsp;<span class="ident" id="4225995">err</span>&nbsp;<span class="op" id="4225999">=</span>&nbsp;<span class="ident" id="4226001">parseT61String</span><span class="op" id="4226015">(</span><span class="ident" id="4226016">innerBytes</span><span class="op" id="4226026">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226030">case</span>&nbsp;<span class="ident" id="4226035">tagUTF8String</span><span class="op" id="4226048">:</span><br>
<span class="lineno">810</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226053">v</span><span class="op" id="4226054">,</span>&nbsp;<span class="ident" id="4226056">err</span>&nbsp;<span class="op" id="4226060">=</span>&nbsp;<span class="ident" id="4226062">parseUTF8String</span><span class="op" id="4226077">(</span><span class="ident" id="4226078">innerBytes</span><span class="op" id="4226088">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226092">case</span>&nbsp;<span class="ident" id="4226097">tagGeneralString</span><span class="op" id="4226113">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4226118">//&nbsp;GeneralString&nbsp;is&nbsp;specified&nbsp;in&nbsp;ISO-2022/ECMA-35,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4226172">//&nbsp;A&nbsp;brief&nbsp;review&nbsp;suggests&nbsp;that&nbsp;it&nbsp;includes&nbsp;structures</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4226230">//&nbsp;that&nbsp;allow&nbsp;the&nbsp;encoding&nbsp;to&nbsp;change&nbsp;midstring&nbsp;and</span><br>
<span class="lineno">815</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4226284">//&nbsp;such.&nbsp;We&nbsp;give&nbsp;up&nbsp;and&nbsp;pass&nbsp;it&nbsp;as&nbsp;an&nbsp;8-bit&nbsp;string.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226339">v</span><span class="op" id="4226340">,</span>&nbsp;<span class="ident" id="4226342">err</span>&nbsp;<span class="op" id="4226346">=</span>&nbsp;<span class="ident" id="4226348">parseT61String</span><span class="op" id="4226362">(</span><span class="ident" id="4226363">innerBytes</span><span class="op" id="4226373">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226377">default</span><span class="op" id="4226384">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226389">err</span>&nbsp;<span class="op" id="4226393">=</span>&nbsp;<span class="ident" id="4226395">SyntaxError</span><span class="op" id="4226406">{</span><span class="ident" id="4226407">fmt</span><span class="op" id="4226410">.</span><span class="ident" id="4226411">Sprintf</span><span class="op" id="4226418">(</span><span class="string" id="4226419">&#34;internal&nbsp;error:&nbsp;unknown&nbsp;string&nbsp;type&nbsp;%d&#34;</span><span class="op" id="4226459">,</span>&nbsp;<span class="ident" id="4226461">universalTag</span><span class="op" id="4226473">)</span><span class="op" id="4226474">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4226478">}</span><br>
<span class="lineno">820</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226482">if</span>&nbsp;<span class="ident" id="4226485">err</span>&nbsp;<span class="op" id="4226489">==</span>&nbsp;<span class="ident" id="4226492">nil</span>&nbsp;<span class="op" id="4226496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226501">val</span><span class="op" id="4226504">.</span><span class="ident" id="4226505">SetString</span><span class="op" id="4226514">(</span><span class="ident" id="4226515">v</span><span class="op" id="4226516">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4226520">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226524">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4226532">}</span><br>
<span class="lineno">825</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4226535">err</span>&nbsp;<span class="op" id="4226539">=</span>&nbsp;<span class="ident" id="4226541">StructuralError</span><span class="op" id="4226556">{</span><span class="string" id="4226557">&#34;unsupported:&nbsp;&#34;</span>&nbsp;<span class="op" id="4226573">+</span>&nbsp;<span class="ident" id="4226575">v</span><span class="op" id="4226576">.</span><span class="ident" id="4226577">Type</span><span class="op" id="4226581">(</span><span class="op" id="4226582">)</span><span class="op" id="4226583">.</span><span class="ident" id="4226584">String</span><span class="op" id="4226590">(</span><span class="op" id="4226591">)</span><span class="op" id="4226592">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226595">return</span><br>
<span class="lineno"></span><span class="op" id="4226602">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4226605">//&nbsp;canHaveDefaultValue&nbsp;reports&nbsp;whether&nbsp;k&nbsp;is&nbsp;a&nbsp;Kind&nbsp;that&nbsp;we&nbsp;will&nbsp;set&nbsp;a&nbsp;default</span><br>
<span class="lineno">830</span><span class="comment" id="4226683">//&nbsp;value&nbsp;for.&nbsp;(A&nbsp;signed&nbsp;integer,&nbsp;essentially.)</span><br>
<span class="lineno"></span><span class="keyword" id="4226730">func</span>&nbsp;<span class="ident" id="4226735">canHaveDefaultValue</span><span class="op" id="4226754">(</span><span class="ident" id="4226755">k</span>&nbsp;<span class="ident" id="4226757">reflect</span><span class="op" id="4226764">.</span><span class="ident" id="4226765">Kind</span><span class="op" id="4226769">)</span>&nbsp;<span class="builtintype" id="4226771">bool</span>&nbsp;<span class="op" id="4226776">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226779">switch</span>&nbsp;<span class="ident" id="4226786">k</span>&nbsp;<span class="op" id="4226788">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226791">case</span>&nbsp;<span class="ident" id="4226796">reflect</span><span class="op" id="4226803">.</span><span class="ident" id="4226804">Int</span><span class="op" id="4226807">,</span>&nbsp;<span class="ident" id="4226809">reflect</span><span class="op" id="4226816">.</span><span class="ident" id="4226817">Int8</span><span class="op" id="4226821">,</span>&nbsp;<span class="ident" id="4226823">reflect</span><span class="op" id="4226830">.</span><span class="ident" id="4226831">Int16</span><span class="op" id="4226836">,</span>&nbsp;<span class="ident" id="4226838">reflect</span><span class="op" id="4226845">.</span><span class="ident" id="4226846">Int32</span><span class="op" id="4226851">,</span>&nbsp;<span class="ident" id="4226853">reflect</span><span class="op" id="4226860">.</span><span class="ident" id="4226861">Int64</span><span class="op" id="4226866">:</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226870">return</span>&nbsp;<span class="ident" id="4226877">true</span><br>
<span class="lineno">835</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4226883">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4226887">return</span>&nbsp;<span class="ident" id="4226894">false</span><br>
<span class="lineno"></span><span class="op" id="4226900">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">840</span><span class="comment" id="4226903">//&nbsp;setDefaultValue&nbsp;is&nbsp;used&nbsp;to&nbsp;install&nbsp;a&nbsp;default&nbsp;value,&nbsp;from&nbsp;a&nbsp;tag&nbsp;string,&nbsp;into</span><br>
<span class="lineno"></span><span class="comment" id="4226982">//&nbsp;a&nbsp;Value.&nbsp;It&nbsp;is&nbsp;successful&nbsp;if&nbsp;the&nbsp;field&nbsp;was&nbsp;optional,&nbsp;even&nbsp;if&nbsp;a&nbsp;default&nbsp;value</span><br>
<span class="lineno"></span><span class="comment" id="4227062">//&nbsp;wasn&#39;t&nbsp;provided&nbsp;or&nbsp;it&nbsp;failed&nbsp;to&nbsp;install&nbsp;it&nbsp;into&nbsp;the&nbsp;Value.</span><br>
<span class="lineno"></span><span class="keyword" id="4227124">func</span>&nbsp;<span class="ident" id="4227129">setDefaultValue</span><span class="op" id="4227144">(</span><span class="ident" id="4227145">v</span>&nbsp;<span class="ident" id="4227147">reflect</span><span class="op" id="4227154">.</span><span class="ident" id="4227155">Value</span><span class="op" id="4227160">,</span>&nbsp;<span class="ident" id="4227162">params</span>&nbsp;<span class="ident" id="4227169">fieldParameters</span><span class="op" id="4227184">)</span>&nbsp;<span class="op" id="4227186">(</span><span class="ident" id="4227187">ok</span>&nbsp;<span class="builtintype" id="4227190">bool</span><span class="op" id="4227194">)</span>&nbsp;<span class="op" id="4227196">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4227199">if</span>&nbsp;<span class="op" id="4227202">!</span><span class="ident" id="4227203">params</span><span class="op" id="4227209">.</span><span class="ident" id="4227210">optional</span>&nbsp;<span class="op" id="4227219">{</span><br>
<span class="lineno">845</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4227223">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4227231">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227234">ok</span>&nbsp;<span class="op" id="4227237">=</span>&nbsp;<span class="ident" id="4227239">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4227245">if</span>&nbsp;<span class="ident" id="4227248">params</span><span class="op" id="4227254">.</span><span class="ident" id="4227255">defaultValue</span>&nbsp;<span class="op" id="4227268">==</span>&nbsp;<span class="ident" id="4227271">nil</span>&nbsp;<span class="op" id="4227275">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4227279">return</span><br>
<span class="lineno">850</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4227287">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4227290">if</span>&nbsp;<span class="ident" id="4227293">canHaveDefaultValue</span><span class="op" id="4227312">(</span><span class="ident" id="4227313">v</span><span class="op" id="4227314">.</span><span class="ident" id="4227315">Kind</span><span class="op" id="4227319">(</span><span class="op" id="4227320">)</span><span class="op" id="4227321">)</span>&nbsp;<span class="op" id="4227323">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4227327">v</span><span class="op" id="4227328">.</span><span class="ident" id="4227329">SetInt</span><span class="op" id="4227335">(</span><span class="op" id="4227336">*</span><span class="ident" id="4227337">params</span><span class="op" id="4227343">.</span><span class="ident" id="4227344">defaultValue</span><span class="op" id="4227356">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4227359">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4227362">return</span><br>
<span class="lineno">855</span><span class="op" id="4227369">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4227372">//&nbsp;Unmarshal&nbsp;parses&nbsp;the&nbsp;DER-encoded&nbsp;ASN.1&nbsp;data&nbsp;structure&nbsp;b</span><br>
<span class="lineno"></span><span class="comment" id="4227431">//&nbsp;and&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package&nbsp;to&nbsp;fill&nbsp;in&nbsp;an&nbsp;arbitrary&nbsp;value&nbsp;pointed&nbsp;at&nbsp;by&nbsp;val.</span><br>
<span class="lineno"></span><span class="comment" id="4227512">//&nbsp;Because&nbsp;Unmarshal&nbsp;uses&nbsp;the&nbsp;reflect&nbsp;package,&nbsp;the&nbsp;structs</span><br>
<span class="lineno">860</span><span class="comment" id="4227571">//&nbsp;being&nbsp;written&nbsp;to&nbsp;must&nbsp;use&nbsp;upper&nbsp;case&nbsp;field&nbsp;names.</span><br>
<span class="lineno"></span><span class="comment" id="4227624">//</span><br>
<span class="lineno"></span><span class="comment" id="4227627">//&nbsp;An&nbsp;ASN.1&nbsp;INTEGER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;int,&nbsp;int32,&nbsp;int64,</span><br>
<span class="lineno"></span><span class="comment" id="4227687">//&nbsp;or&nbsp;*big.Int&nbsp;(from&nbsp;the&nbsp;math/big&nbsp;package).</span><br>
<span class="lineno"></span><span class="comment" id="4227731">//&nbsp;If&nbsp;the&nbsp;encoded&nbsp;value&nbsp;does&nbsp;not&nbsp;fit&nbsp;in&nbsp;the&nbsp;Go&nbsp;type,</span><br>
<span class="lineno">865</span><span class="comment" id="4227784">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="comment" id="4227820">//</span><br>
<span class="lineno"></span><span class="comment" id="4227823">//&nbsp;An&nbsp;ASN.1&nbsp;BIT&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;BitString.</span><br>
<span class="lineno"></span><span class="comment" id="4227877">//</span><br>
<span class="lineno"></span><span class="comment" id="4227880">//&nbsp;An&nbsp;ASN.1&nbsp;OCTET&nbsp;STRING&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;[]byte.</span><br>
<span class="lineno">870</span><span class="comment" id="4227933">//</span><br>
<span class="lineno"></span><span class="comment" id="4227936">//&nbsp;An&nbsp;ASN.1&nbsp;OBJECT&nbsp;IDENTIFIER&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an</span><br>
<span class="lineno"></span><span class="comment" id="4227987">//&nbsp;ObjectIdentifier.</span><br>
<span class="lineno"></span><span class="comment" id="4228008">//</span><br>
<span class="lineno"></span><span class="comment" id="4228011">//&nbsp;An&nbsp;ASN.1&nbsp;ENUMERATED&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;Enumerated.</span><br>
<span class="lineno">875</span><span class="comment" id="4228067">//</span><br>
<span class="lineno"></span><span class="comment" id="4228070">//&nbsp;An&nbsp;ASN.1&nbsp;UTCTIME&nbsp;or&nbsp;GENERALIZEDTIME&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;time.Time.</span><br>
<span class="lineno"></span><span class="comment" id="4228140">//</span><br>
<span class="lineno"></span><span class="comment" id="4228143">//&nbsp;An&nbsp;ASN.1&nbsp;PrintableString&nbsp;or&nbsp;IA5String&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;string.</span><br>
<span class="lineno"></span><span class="comment" id="4228212">//</span><br>
<span class="lineno">880</span><span class="comment" id="4228215">//&nbsp;Any&nbsp;of&nbsp;the&nbsp;above&nbsp;ASN.1&nbsp;values&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;an&nbsp;interface{}.</span><br>
<span class="lineno"></span><span class="comment" id="4228282">//&nbsp;The&nbsp;value&nbsp;stored&nbsp;in&nbsp;the&nbsp;interface&nbsp;has&nbsp;the&nbsp;corresponding&nbsp;Go&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4228350">//&nbsp;For&nbsp;integers,&nbsp;that&nbsp;type&nbsp;is&nbsp;int64.</span><br>
<span class="lineno"></span><span class="comment" id="4228387">//</span><br>
<span class="lineno"></span><span class="comment" id="4228390">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;OF&nbsp;x&nbsp;or&nbsp;SET&nbsp;OF&nbsp;x&nbsp;can&nbsp;be&nbsp;written</span><br>
<span class="lineno">885</span><span class="comment" id="4228443">//&nbsp;to&nbsp;a&nbsp;slice&nbsp;if&nbsp;an&nbsp;x&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;the&nbsp;slice&#39;s&nbsp;element&nbsp;type.</span><br>
<span class="lineno"></span><span class="comment" id="4228509">//</span><br>
<span class="lineno"></span><span class="comment" id="4228512">//&nbsp;An&nbsp;ASN.1&nbsp;SEQUENCE&nbsp;or&nbsp;SET&nbsp;can&nbsp;be&nbsp;written&nbsp;to&nbsp;a&nbsp;struct</span><br>
<span class="lineno"></span><span class="comment" id="4228567">//&nbsp;if&nbsp;each&nbsp;of&nbsp;the&nbsp;elements&nbsp;in&nbsp;the&nbsp;sequence&nbsp;can&nbsp;be</span><br>
<span class="lineno"></span><span class="comment" id="4228617">//&nbsp;written&nbsp;to&nbsp;the&nbsp;corresponding&nbsp;element&nbsp;in&nbsp;the&nbsp;struct.</span><br>
<span class="lineno">890</span><span class="comment" id="4228672">//</span><br>
<span class="lineno"></span><span class="comment" id="4228675">//&nbsp;The&nbsp;following&nbsp;tags&nbsp;on&nbsp;struct&nbsp;fields&nbsp;have&nbsp;special&nbsp;meaning&nbsp;to&nbsp;Unmarshal:</span><br>
<span class="lineno"></span><span class="comment" id="4228749">//</span><br>
<span class="lineno"></span><span class="comment" id="4228752">//&nbsp;&nbsp;&nbsp;&nbspapplication&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;a&nbsp;APPLICATION&nbsp;tag&nbsp;is&nbsp;used</span><br>
<span class="lineno"></span><span class="comment" id="4228808">//&nbsp;&nbsp;&nbsp;&nbspdefault:x&nbsp;&nbsp;&nbsp;&nbspsets&nbsp;the&nbsp;default&nbsp;value&nbsp;for&nbsp;optional&nbsp;integer&nbsp;fields</span><br>
<span class="lineno">895</span><span class="comment" id="4228872">//&nbsp;&nbsp;&nbsp;&nbspexplicit&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;that&nbsp;an&nbsp;additional,&nbsp;explicit&nbsp;tag&nbsp;wraps&nbsp;the&nbsp;implicit&nbsp;one</span><br>
<span class="lineno"></span><span class="comment" id="4228950">//&nbsp;&nbsp;&nbsp;&nbspoptional&nbsp;&nbsp;&nbsp;&nbspmarks&nbsp;the&nbsp;field&nbsp;as&nbsp;ASN.1&nbsp;OPTIONAL</span><br>
<span class="lineno"></span><span class="comment" id="4228996">//&nbsp;&nbsp;&nbsp;&nbspset&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspcauses&nbsp;a&nbsp;SET,&nbsp;rather&nbsp;than&nbsp;a&nbsp;SEQUENCE&nbsp;type&nbsp;to&nbsp;be&nbsp;expected</span><br>
<span class="lineno"></span><span class="comment" id="4229061">//&nbsp;&nbsp;&nbsp;&nbsptag:x&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbspspecifies&nbsp;the&nbsp;ASN.1&nbsp;tag&nbsp;number;&nbsp;implies&nbsp;ASN.1&nbsp;CONTEXT&nbsp;SPECIFIC</span><br>
<span class="lineno"></span><span class="comment" id="4229134">//</span><br>
<span class="lineno">900</span><span class="comment" id="4229137">//&nbsp;If&nbsp;the&nbsp;type&nbsp;of&nbsp;the&nbsp;first&nbsp;field&nbsp;of&nbsp;a&nbsp;structure&nbsp;is&nbsp;RawContent&nbsp;then&nbsp;the&nbsp;raw</span><br>
<span class="lineno"></span><span class="comment" id="4229213">//&nbsp;ASN1&nbsp;contents&nbsp;of&nbsp;the&nbsp;struct&nbsp;will&nbsp;be&nbsp;stored&nbsp;in&nbsp;it.</span><br>
<span class="lineno"></span><span class="comment" id="4229266">//</span><br>
<span class="lineno"></span><span class="comment" id="4229269">//&nbsp;If&nbsp;the&nbsp;type&nbsp;name&nbsp;of&nbsp;a&nbsp;slice&nbsp;element&nbsp;ends&nbsp;with&nbsp;&#34;SET&#34;&nbsp;then&nbsp;it&#39;s&nbsp;treated&nbsp;as&nbsp;if</span><br>
<span class="lineno"></span><span class="comment" id="4229348">//&nbsp;the&nbsp;&#34;set&#34;&nbsp;tag&nbsp;was&nbsp;set&nbsp;on&nbsp;it.&nbsp;This&nbsp;can&nbsp;be&nbsp;used&nbsp;with&nbsp;nested&nbsp;slices&nbsp;where&nbsp;a</span><br>
<span class="lineno">905</span><span class="comment" id="4229424">//&nbsp;struct&nbsp;tag&nbsp;cannot&nbsp;be&nbsp;given.</span><br>
<span class="lineno"></span><span class="comment" id="4229455">//</span><br>
<span class="lineno"></span><span class="comment" id="4229458">//&nbsp;Other&nbsp;ASN.1&nbsp;types&nbsp;are&nbsp;not&nbsp;supported;&nbsp;if&nbsp;it&nbsp;encounters&nbsp;them,</span><br>
<span class="lineno"></span><span class="comment" id="4229521">//&nbsp;Unmarshal&nbsp;returns&nbsp;a&nbsp;parse&nbsp;error.</span><br>
<span class="lineno"></span><span class="keyword" id="4229557">func</span>&nbsp;<span class="ident" id="4229562">Unmarshal</span><span class="op" id="4229571">(</span><span class="ident" id="4229572">b</span>&nbsp;<span class="op" id="4229574">[</span><span class="op" id="4229575">]</span><span class="builtintype" id="4229576">byte</span><span class="op" id="4229580">,</span>&nbsp;<span class="ident" id="4229582">val</span>&nbsp;<span class="keyword" id="4229586">interface</span><span class="op" id="4229595">{</span><span class="op" id="4229596">}</span><span class="op" id="4229597">)</span>&nbsp;<span class="op" id="4229599">(</span><span class="ident" id="4229600">rest</span>&nbsp;<span class="op" id="4229605">[</span><span class="op" id="4229606">]</span><span class="builtintype" id="4229607">byte</span><span class="op" id="4229611">,</span>&nbsp;<span class="ident" id="4229613">err</span>&nbsp;<span class="builtintype" id="4229617">error</span><span class="op" id="4229622">)</span>&nbsp;<span class="op" id="4229624">{</span><br>
<span class="lineno">910</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4229627">return</span>&nbsp;<span class="ident" id="4229634">UnmarshalWithParams</span><span class="op" id="4229653">(</span><span class="ident" id="4229654">b</span><span class="op" id="4229655">,</span>&nbsp;<span class="ident" id="4229657">val</span><span class="op" id="4229660">,</span>&nbsp;<span class="string" id="4229662">&#34;&#34;</span><span class="op" id="4229664">)</span><br>
<span class="lineno"></span><span class="op" id="4229666">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4229669">//&nbsp;UnmarshalWithParams&nbsp;allows&nbsp;field&nbsp;parameters&nbsp;to&nbsp;be&nbsp;specified&nbsp;for&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="4229740">//&nbsp;top-level&nbsp;element.&nbsp;The&nbsp;form&nbsp;of&nbsp;the&nbsp;params&nbsp;is&nbsp;the&nbsp;same&nbsp;as&nbsp;the&nbsp;field&nbsp;tags.</span><br>
<span class="lineno">915</span><span class="keyword" id="4229816">func</span>&nbsp;<span class="ident" id="4229821">UnmarshalWithParams</span><span class="op" id="4229840">(</span><span class="ident" id="4229841">b</span>&nbsp;<span class="op" id="4229843">[</span><span class="op" id="4229844">]</span><span class="builtintype" id="4229845">byte</span><span class="op" id="4229849">,</span>&nbsp;<span class="ident" id="4229851">val</span>&nbsp;<span class="keyword" id="4229855">interface</span><span class="op" id="4229864">{</span><span class="op" id="4229865">}</span><span class="op" id="4229866">,</span>&nbsp;<span class="ident" id="4229868">params</span>&nbsp;<span class="builtintype" id="4229875">string</span><span class="op" id="4229881">)</span>&nbsp;<span class="op" id="4229883">(</span><span class="ident" id="4229884">rest</span>&nbsp;<span class="op" id="4229889">[</span><span class="op" id="4229890">]</span><span class="builtintype" id="4229891">byte</span><span class="op" id="4229895">,</span>&nbsp;<span class="ident" id="4229897">err</span>&nbsp;<span class="builtintype" id="4229901">error</span><span class="op" id="4229906">)</span>&nbsp;<span class="op" id="4229908">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4229911">v</span>&nbsp;<span class="op" id="4229913">:=</span>&nbsp;<span class="ident" id="4229916">reflect</span><span class="op" id="4229923">.</span><span class="ident" id="4229924">ValueOf</span><span class="op" id="4229931">(</span><span class="ident" id="4229932">val</span><span class="op" id="4229935">)</span><span class="op" id="4229936">.</span><span class="ident" id="4229937">Elem</span><span class="op" id="4229941">(</span><span class="op" id="4229942">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4229945">offset</span><span class="op" id="4229951">,</span>&nbsp;<span class="ident" id="4229953">err</span>&nbsp;<span class="op" id="4229957">:=</span>&nbsp;<span class="ident" id="4229960">parseField</span><span class="op" id="4229970">(</span><span class="ident" id="4229971">v</span><span class="op" id="4229972">,</span>&nbsp;<span class="ident" id="4229974">b</span><span class="op" id="4229975">,</span>&nbsp;<span class="num" id="4229977">0</span><span class="op" id="4229978">,</span>&nbsp;<span class="ident" id="4229980">parseFieldParameters</span><span class="op" id="4230000">(</span><span class="ident" id="4230001">params</span><span class="op" id="4230007">)</span><span class="op" id="4230008">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4230011">if</span>&nbsp;<span class="ident" id="4230014">err</span>&nbsp;<span class="op" id="4230018">!=</span>&nbsp;<span class="ident" id="4230021">nil</span>&nbsp;<span class="op" id="4230025">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4230029">return</span>&nbsp;<span class="ident" id="4230036">nil</span><span class="op" id="4230039">,</span>&nbsp;<span class="ident" id="4230041">err</span><br>
<span class="lineno">920</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4230046">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4230049">return</span>&nbsp;<span class="ident" id="4230056">b</span><span class="op" id="4230057">[</span><span class="ident" id="4230058">offset</span><span class="op" id="4230064">:</span><span class="op" id="4230065">]</span><span class="op" id="4230066">,</span>&nbsp;<span class="ident" id="4230068">nil</span><br>
<span class="lineno"></span><span class="op" id="4230072">}</span>
</div>
</body>
</html>
