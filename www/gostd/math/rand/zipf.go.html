<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/gostd.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>math/rand</h2>
<ul>
<li><a href="/gostd/math/rand/example_test.go.html">example_test.go</a></li>
<li><a href="/gostd/math/rand/exp.go.html">exp.go</a></li>
<li><a href="/gostd/math/rand/normal.go.html">normal.go</a></li>
<li><a href="/gostd/math/rand/rand.go.html">rand.go</a></li>
<li><a href="/gostd/math/rand/rand_test.go.html">rand_test.go</a></li>
<li><a href="/gostd/math/rand/regress_test.go.html">regress_test.go</a></li>
<li><a href="/gostd/math/rand/rng.go.html">rng.go</a></li>
<li><a href="/gostd/math/rand/zipf.go.html" class="current">zipf.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="4249949">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="4250004">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="4250058">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="4250109">//&nbsp;W.Hormann,&nbsp;G.Derflinger:</span><br>
<span class="lineno"></span><span class="comment" id="4250137">//&nbsp;&#34;Rejection-Inversion&nbsp;to&nbsp;Generate&nbsp;Variates</span><br>
<span class="lineno"></span><span class="comment" id="4250182">//&nbsp;from&nbsp;Monotone&nbsp;Discrete&nbsp;Distributions&#34;</span><br>
<span class="lineno"></span><span class="comment" id="4250223">//&nbsp;http://eeyore.wu-wien.ac.at/papers/96-04-04.wh-der.ps.gz</span><br>
<span class="lineno"></span><br>
<span class="lineno">10</span><span class="keyword" id="4250284">package</span>&nbsp;<span class="ident" id="4250292">rand</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4250298">import</span>&nbsp;<span class="string" id="4250305">&#34;math&#34;</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4250313">//&nbsp;A&nbsp;Zipf&nbsp;generates&nbsp;Zipf&nbsp;distributed&nbsp;variates.</span><br>
<span class="lineno">15</span><span class="keyword" id="4250360">type</span>&nbsp;<span class="ident" id="4250365">Zipf</span>&nbsp;<span class="keyword" id="4250370">struct</span>&nbsp;<span class="op" id="4250377">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250380">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="4250393">*</span><span class="ident" id="4250394">Rand</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250400">imax</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4250413">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250422">v</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4250435">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250444">q</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4250457">float64</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250466">s</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4250479">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250488">oneminusQ</span>&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4250501">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250510">oneminusQinv</span>&nbsp;<span class="builtintype" id="4250523">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250532">hxm</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="builtintype" id="4250545">float64</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250554">hx0minusHxm</span>&nbsp;&nbsp;<span class="builtintype" id="4250567">float64</span><br>
<span class="lineno">25</span><span class="op" id="4250575">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4250578">func</span>&nbsp;<span class="op" id="4250583">(</span><span class="ident" id="4250584">z</span>&nbsp;<span class="op" id="4250586">*</span><span class="ident" id="4250587">Zipf</span><span class="op" id="4250591">)</span>&nbsp;<span class="ident" id="4250593">h</span><span class="op" id="4250594">(</span><span class="ident" id="4250595">x</span>&nbsp;<span class="builtintype" id="4250597">float64</span><span class="op" id="4250604">)</span>&nbsp;<span class="builtintype" id="4250606">float64</span>&nbsp;<span class="op" id="4250614">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4250617">return</span>&nbsp;<span class="ident" id="4250624">math</span><span class="op" id="4250628">.</span><span class="ident" id="4250629">Exp</span><span class="op" id="4250632">(</span><span class="ident" id="4250633">z</span><span class="op" id="4250634">.</span><span class="ident" id="4250635">oneminusQ</span><span class="op" id="4250644">*</span><span class="ident" id="4250645">math</span><span class="op" id="4250649">.</span><span class="ident" id="4250650">Log</span><span class="op" id="4250653">(</span><span class="ident" id="4250654">z</span><span class="op" id="4250655">.</span><span class="ident" id="4250656">v</span><span class="op" id="4250657">+</span><span class="ident" id="4250658">x</span><span class="op" id="4250659">)</span><span class="op" id="4250660">)</span>&nbsp;<span class="op" id="4250662">*</span>&nbsp;<span class="ident" id="4250664">z</span><span class="op" id="4250665">.</span><span class="ident" id="4250666">oneminusQinv</span><br>
<span class="lineno"></span><span class="op" id="4250679">}</span><br>
<span class="lineno">30</span><br>
<span class="lineno"></span><span class="keyword" id="4250682">func</span>&nbsp;<span class="op" id="4250687">(</span><span class="ident" id="4250688">z</span>&nbsp;<span class="op" id="4250690">*</span><span class="ident" id="4250691">Zipf</span><span class="op" id="4250695">)</span>&nbsp;<span class="ident" id="4250697">hinv</span><span class="op" id="4250701">(</span><span class="ident" id="4250702">x</span>&nbsp;<span class="builtintype" id="4250704">float64</span><span class="op" id="4250711">)</span>&nbsp;<span class="builtintype" id="4250713">float64</span>&nbsp;<span class="op" id="4250721">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4250724">return</span>&nbsp;<span class="ident" id="4250731">math</span><span class="op" id="4250735">.</span><span class="ident" id="4250736">Exp</span><span class="op" id="4250739">(</span><span class="ident" id="4250740">z</span><span class="op" id="4250741">.</span><span class="ident" id="4250742">oneminusQinv</span><span class="op" id="4250754">*</span><span class="ident" id="4250755">math</span><span class="op" id="4250759">.</span><span class="ident" id="4250760">Log</span><span class="op" id="4250763">(</span><span class="ident" id="4250764">z</span><span class="op" id="4250765">.</span><span class="ident" id="4250766">oneminusQ</span><span class="op" id="4250775">*</span><span class="ident" id="4250776">x</span><span class="op" id="4250777">)</span><span class="op" id="4250778">)</span>&nbsp;<span class="op" id="4250780">-</span>&nbsp;<span class="ident" id="4250782">z</span><span class="op" id="4250783">.</span><span class="ident" id="4250784">v</span><br>
<span class="lineno"></span><span class="op" id="4250786">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">35</span><span class="comment" id="4250789">//&nbsp;NewZipf&nbsp;returns&nbsp;a&nbsp;Zipf&nbsp;generating&nbsp;variates&nbsp;p(k)&nbsp;on&nbsp;[0,&nbsp;imax]</span><br>
<span class="lineno"></span><span class="comment" id="4250853">//&nbsp;proportional&nbsp;to&nbsp;(v+k)**(-s)&nbsp;where&nbsp;s&gt;1&nbsp;and&nbsp;k&gt;=0,&nbsp;and&nbsp;v&gt;=1.</span><br>
<span class="lineno"></span><span class="keyword" id="4250914">func</span>&nbsp;<span class="ident" id="4250919">NewZipf</span><span class="op" id="4250926">(</span><span class="ident" id="4250927">r</span>&nbsp;<span class="op" id="4250929">*</span><span class="ident" id="4250930">Rand</span><span class="op" id="4250934">,</span>&nbsp;<span class="ident" id="4250936">s</span>&nbsp;<span class="builtintype" id="4250938">float64</span><span class="op" id="4250945">,</span>&nbsp;<span class="ident" id="4250947">v</span>&nbsp;<span class="builtintype" id="4250949">float64</span><span class="op" id="4250956">,</span>&nbsp;<span class="ident" id="4250958">imax</span>&nbsp;<span class="ident" id="4250963">uint64</span><span class="op" id="4250969">)</span>&nbsp;<span class="op" id="4250971">*</span><span class="ident" id="4250972">Zipf</span>&nbsp;<span class="op" id="4250977">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4250980">z</span>&nbsp;<span class="op" id="4250982">:=</span>&nbsp;<span class="builtinfunc" id="4250985">new</span><span class="op" id="4250988">(</span><span class="ident" id="4250989">Zipf</span><span class="op" id="4250993">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4250996">if</span>&nbsp;<span class="ident" id="4250999">s</span>&nbsp;<span class="op" id="4251001">&lt;=</span>&nbsp;<span class="num" id="4251004">1.0</span>&nbsp;<span class="op" id="4251008">||</span>&nbsp;<span class="ident" id="4251011">v</span>&nbsp;<span class="op" id="4251013">&lt;</span>&nbsp;<span class="num" id="4251015">1</span>&nbsp;<span class="op" id="4251017">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4251021">return</span>&nbsp;<span class="ident" id="4251028">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4251033">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251036">z</span><span class="op" id="4251037">.</span><span class="ident" id="4251038">r</span>&nbsp;<span class="op" id="4251040">=</span>&nbsp;<span class="ident" id="4251042">r</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251045">z</span><span class="op" id="4251046">.</span><span class="ident" id="4251047">imax</span>&nbsp;<span class="op" id="4251052">=</span>&nbsp;<span class="builtintype" id="4251054">float64</span><span class="op" id="4251061">(</span><span class="ident" id="4251062">imax</span><span class="op" id="4251066">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251069">z</span><span class="op" id="4251070">.</span><span class="ident" id="4251071">v</span>&nbsp;<span class="op" id="4251073">=</span>&nbsp;<span class="ident" id="4251075">v</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251078">z</span><span class="op" id="4251079">.</span><span class="ident" id="4251080">q</span>&nbsp;<span class="op" id="4251082">=</span>&nbsp;<span class="ident" id="4251084">s</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251087">z</span><span class="op" id="4251088">.</span><span class="ident" id="4251089">oneminusQ</span>&nbsp;<span class="op" id="4251099">=</span>&nbsp;<span class="num" id="4251101">1.0</span>&nbsp;<span class="op" id="4251105">-</span>&nbsp;<span class="ident" id="4251107">z</span><span class="op" id="4251108">.</span><span class="ident" id="4251109">q</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251112">z</span><span class="op" id="4251113">.</span><span class="ident" id="4251114">oneminusQinv</span>&nbsp;<span class="op" id="4251127">=</span>&nbsp;<span class="num" id="4251129">1.0</span>&nbsp;<span class="op" id="4251133">/</span>&nbsp;<span class="ident" id="4251135">z</span><span class="op" id="4251136">.</span><span class="ident" id="4251137">oneminusQ</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251148">z</span><span class="op" id="4251149">.</span><span class="ident" id="4251150">hxm</span>&nbsp;<span class="op" id="4251154">=</span>&nbsp;<span class="ident" id="4251156">z</span><span class="op" id="4251157">.</span><span class="ident" id="4251158">h</span><span class="op" id="4251159">(</span><span class="ident" id="4251160">z</span><span class="op" id="4251161">.</span><span class="ident" id="4251162">imax</span>&nbsp;<span class="op" id="4251167">+</span>&nbsp;<span class="num" id="4251169">0.5</span><span class="op" id="4251172">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251175">z</span><span class="op" id="4251176">.</span><span class="ident" id="4251177">hx0minusHxm</span>&nbsp;<span class="op" id="4251189">=</span>&nbsp;<span class="ident" id="4251191">z</span><span class="op" id="4251192">.</span><span class="ident" id="4251193">h</span><span class="op" id="4251194">(</span><span class="num" id="4251195">0.5</span><span class="op" id="4251198">)</span>&nbsp;<span class="op" id="4251200">-</span>&nbsp;<span class="ident" id="4251202">math</span><span class="op" id="4251206">.</span><span class="ident" id="4251207">Exp</span><span class="op" id="4251210">(</span><span class="ident" id="4251211">math</span><span class="op" id="4251215">.</span><span class="ident" id="4251216">Log</span><span class="op" id="4251219">(</span><span class="ident" id="4251220">z</span><span class="op" id="4251221">.</span><span class="ident" id="4251222">v</span><span class="op" id="4251223">)</span><span class="op" id="4251224">*</span><span class="op" id="4251225">(</span><span class="op" id="4251226">-</span><span class="ident" id="4251227">z</span><span class="op" id="4251228">.</span><span class="ident" id="4251229">q</span><span class="op" id="4251230">)</span><span class="op" id="4251231">)</span>&nbsp;<span class="op" id="4251233">-</span>&nbsp;<span class="ident" id="4251235">z</span><span class="op" id="4251236">.</span><span class="ident" id="4251237">hxm</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251242">z</span><span class="op" id="4251243">.</span><span class="ident" id="4251244">s</span>&nbsp;<span class="op" id="4251246">=</span>&nbsp;<span class="num" id="4251248">1</span>&nbsp;<span class="op" id="4251250">-</span>&nbsp;<span class="ident" id="4251252">z</span><span class="op" id="4251253">.</span><span class="ident" id="4251254">hinv</span><span class="op" id="4251258">(</span><span class="ident" id="4251259">z</span><span class="op" id="4251260">.</span><span class="ident" id="4251261">h</span><span class="op" id="4251262">(</span><span class="num" id="4251263">1.5</span><span class="op" id="4251266">)</span><span class="op" id="4251267">-</span><span class="ident" id="4251268">math</span><span class="op" id="4251272">.</span><span class="ident" id="4251273">Exp</span><span class="op" id="4251276">(</span><span class="op" id="4251277">-</span><span class="ident" id="4251278">z</span><span class="op" id="4251279">.</span><span class="ident" id="4251280">q</span><span class="op" id="4251281">*</span><span class="ident" id="4251282">math</span><span class="op" id="4251286">.</span><span class="ident" id="4251287">Log</span><span class="op" id="4251290">(</span><span class="ident" id="4251291">z</span><span class="op" id="4251292">.</span><span class="ident" id="4251293">v</span><span class="op" id="4251294">+</span><span class="num" id="4251295">1.0</span><span class="op" id="4251298">)</span><span class="op" id="4251299">)</span><span class="op" id="4251300">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4251303">return</span>&nbsp;<span class="ident" id="4251310">z</span><br>
<span class="lineno"></span><span class="op" id="4251312">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="4251315">//&nbsp;Uint64&nbsp;returns&nbsp;a&nbsp;value&nbsp;drawn&nbsp;from&nbsp;the&nbsp;Zipf&nbsp;distribution&nbsp;described</span><br>
<span class="lineno">55</span><span class="comment" id="4251384">//&nbsp;by&nbsp;the&nbsp;Zipf&nbsp;object.</span><br>
<span class="lineno"></span><span class="keyword" id="4251407">func</span>&nbsp;<span class="op" id="4251412">(</span><span class="ident" id="4251413">z</span>&nbsp;<span class="op" id="4251415">*</span><span class="ident" id="4251416">Zipf</span><span class="op" id="4251420">)</span>&nbsp;<span class="ident" id="4251422">Uint64</span><span class="op" id="4251428">(</span><span class="op" id="4251429">)</span>&nbsp;<span class="ident" id="4251431">uint64</span>&nbsp;<span class="op" id="4251438">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4251441">if</span>&nbsp;<span class="ident" id="4251444">z</span>&nbsp;<span class="op" id="4251446">==</span>&nbsp;<span class="ident" id="4251449">nil</span>&nbsp;<span class="op" id="4251453">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="builtinfunc" id="4251457">panic</span><span class="op" id="4251462">(</span><span class="string" id="4251463">&#34;rand:&nbsp;nil&nbsp;Zipf&#34;</span><span class="op" id="4251479">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4251482">}</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251485">k</span>&nbsp;<span class="op" id="4251487">:=</span>&nbsp;<span class="num" id="4251490">0.0</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4251496">for</span>&nbsp;<span class="op" id="4251500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251504">r</span>&nbsp;<span class="op" id="4251506">:=</span>&nbsp;<span class="ident" id="4251509">z</span><span class="op" id="4251510">.</span><span class="ident" id="4251511">r</span><span class="op" id="4251512">.</span><span class="ident" id="4251513">Float64</span><span class="op" id="4251520">(</span><span class="op" id="4251521">)</span>&nbsp;<span class="comment" id="4251523">//&nbsp;r&nbsp;on&nbsp;[0,1]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251539">ur</span>&nbsp;<span class="op" id="4251542">:=</span>&nbsp;<span class="ident" id="4251545">z</span><span class="op" id="4251546">.</span><span class="ident" id="4251547">hxm</span>&nbsp;<span class="op" id="4251551">+</span>&nbsp;<span class="ident" id="4251553">r</span><span class="op" id="4251554">*</span><span class="ident" id="4251555">z</span><span class="op" id="4251556">.</span><span class="ident" id="4251557">hx0minusHxm</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251571">x</span>&nbsp;<span class="op" id="4251573">:=</span>&nbsp;<span class="ident" id="4251576">z</span><span class="op" id="4251577">.</span><span class="ident" id="4251578">hinv</span><span class="op" id="4251582">(</span><span class="ident" id="4251583">ur</span><span class="op" id="4251585">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4251589">k</span>&nbsp;<span class="op" id="4251591">=</span>&nbsp;<span class="ident" id="4251593">math</span><span class="op" id="4251597">.</span><span class="ident" id="4251598">Floor</span><span class="op" id="4251603">(</span><span class="ident" id="4251604">x</span>&nbsp;<span class="op" id="4251606">+</span>&nbsp;<span class="num" id="4251608">0.5</span><span class="op" id="4251611">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4251615">if</span>&nbsp;<span class="ident" id="4251618">k</span><span class="op" id="4251619">-</span><span class="ident" id="4251620">x</span>&nbsp;<span class="op" id="4251622">&lt;=</span>&nbsp;<span class="ident" id="4251625">z</span><span class="op" id="4251626">.</span><span class="ident" id="4251627">s</span>&nbsp;<span class="op" id="4251629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4251634">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4251642">}</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4251646">if</span>&nbsp;<span class="ident" id="4251649">ur</span>&nbsp;<span class="op" id="4251652">&gt;=</span>&nbsp;<span class="ident" id="4251655">z</span><span class="op" id="4251656">.</span><span class="ident" id="4251657">h</span><span class="op" id="4251658">(</span><span class="ident" id="4251659">k</span><span class="op" id="4251660">+</span><span class="num" id="4251661">0.5</span><span class="op" id="4251664">)</span><span class="op" id="4251665">-</span><span class="ident" id="4251666">math</span><span class="op" id="4251670">.</span><span class="ident" id="4251671">Exp</span><span class="op" id="4251674">(</span><span class="op" id="4251675">-</span><span class="ident" id="4251676">math</span><span class="op" id="4251680">.</span><span class="ident" id="4251681">Log</span><span class="op" id="4251684">(</span><span class="ident" id="4251685">k</span><span class="op" id="4251686">+</span><span class="ident" id="4251687">z</span><span class="op" id="4251688">.</span><span class="ident" id="4251689">v</span><span class="op" id="4251690">)</span><span class="op" id="4251691">*</span><span class="ident" id="4251692">z</span><span class="op" id="4251693">.</span><span class="ident" id="4251694">q</span><span class="op" id="4251695">)</span>&nbsp;<span class="op" id="4251697">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4251702">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4251710">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4251713">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4251716">return</span>&nbsp;<span class="ident" id="4251723">uint64</span><span class="op" id="4251729">(</span><span class="ident" id="4251730">k</span><span class="op" id="4251731">)</span><br>
<span class="lineno">75</span><span class="op" id="4251733">}</span>
</div>
</body>
</html>
