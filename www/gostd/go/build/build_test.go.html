<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="6937565">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="6937621">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="6937675">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="6937726">package</span>&nbsp;<span class="ident" id="6937734">build</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6937741">import</span>&nbsp;<span class="op" id="6937748">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6937751">&#34;io&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6937757">&#34;os&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6937763">&#34;path/filepath&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6937780">&#34;reflect&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6937791">&#34;runtime&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6937802">&#34;strings&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6937813">&#34;testing&#34;</span><br>
<span class="lineno">15</span><span class="op" id="6937823">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6937826">func</span>&nbsp;<span class="ident" id="6937831">TestMatch</span><span class="op" id="6937840">(</span><span class="ident" id="6937841">t</span>&nbsp;<span class="op" id="6937843">*</span><span class="ident" id="6937844">testing</span><span class="op" id="6937851">.</span><span class="ident" id="6937852">T</span><span class="op" id="6937853">)</span>&nbsp;<span class="op" id="6937855">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937858">ctxt</span>&nbsp;<span class="op" id="6937863">:=</span>&nbsp;<span class="ident" id="6937866">Default</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937875">what</span>&nbsp;<span class="op" id="6937880">:=</span>&nbsp;<span class="string" id="6937883">&#34;default&#34;</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937894">match</span>&nbsp;<span class="op" id="6937900">:=</span>&nbsp;<span class="keyword" id="6937903">func</span><span class="op" id="6937907">(</span><span class="ident" id="6937908">tag</span>&nbsp;<span class="builtintype" id="6937912">string</span><span class="op" id="6937918">,</span>&nbsp;<span class="ident" id="6937920">want</span>&nbsp;<span class="keyword" id="6937925">map</span><span class="op" id="6937928">[</span><span class="builtintype" id="6937929">string</span><span class="op" id="6937935">]</span><span class="builtintype" id="6937936">bool</span><span class="op" id="6937940">)</span>&nbsp;<span class="op" id="6937942">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6937946">m</span>&nbsp;<span class="op" id="6937948">:=</span>&nbsp;<span class="builtinfunc" id="6937951">make</span><span class="op" id="6937955">(</span><span class="keyword" id="6937956">map</span><span class="op" id="6937959">[</span><span class="builtintype" id="6937960">string</span><span class="op" id="6937966">]</span><span class="builtintype" id="6937967">bool</span><span class="op" id="6937971">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6937975">if</span>&nbsp;<span class="op" id="6937978">!</span><span class="ident" id="6937979">ctxt</span><span class="op" id="6937983">.</span><span class="ident" id="6937984">match</span><span class="op" id="6937989">(</span><span class="ident" id="6937990">tag</span><span class="op" id="6937993">,</span>&nbsp;<span class="ident" id="6937995">m</span><span class="op" id="6937996">)</span>&nbsp;<span class="op" id="6937998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938003">t</span><span class="op" id="6938004">.</span><span class="ident" id="6938005">Errorf</span><span class="op" id="6938011">(</span><span class="string" id="6938012">&#34;%s&nbsp;context&nbsp;should&nbsp;match&nbsp;%s,&nbsp;does&nbsp;not&#34;</span><span class="op" id="6938050">,</span>&nbsp;<span class="ident" id="6938052">what</span><span class="op" id="6938056">,</span>&nbsp;<span class="ident" id="6938058">tag</span><span class="op" id="6938061">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6938065">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6938069">if</span>&nbsp;<span class="op" id="6938072">!</span><span class="ident" id="6938073">reflect</span><span class="op" id="6938080">.</span><span class="ident" id="6938081">DeepEqual</span><span class="op" id="6938090">(</span><span class="ident" id="6938091">m</span><span class="op" id="6938092">,</span>&nbsp;<span class="ident" id="6938094">want</span><span class="op" id="6938098">)</span>&nbsp;<span class="op" id="6938100">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938105">t</span><span class="op" id="6938106">.</span><span class="ident" id="6938107">Errorf</span><span class="op" id="6938113">(</span><span class="string" id="6938114">&#34;%s&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6938137">,</span>&nbsp;<span class="ident" id="6938139">tag</span><span class="op" id="6938142">,</span>&nbsp;<span class="ident" id="6938144">m</span><span class="op" id="6938145">,</span>&nbsp;<span class="ident" id="6938147">want</span><span class="op" id="6938151">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6938155">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6938158">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938161">nomatch</span>&nbsp;<span class="op" id="6938169">:=</span>&nbsp;<span class="keyword" id="6938172">func</span><span class="op" id="6938176">(</span><span class="ident" id="6938177">tag</span>&nbsp;<span class="builtintype" id="6938181">string</span><span class="op" id="6938187">,</span>&nbsp;<span class="ident" id="6938189">want</span>&nbsp;<span class="keyword" id="6938194">map</span><span class="op" id="6938197">[</span><span class="builtintype" id="6938198">string</span><span class="op" id="6938204">]</span><span class="builtintype" id="6938205">bool</span><span class="op" id="6938209">)</span>&nbsp;<span class="op" id="6938211">{</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938215">m</span>&nbsp;<span class="op" id="6938217">:=</span>&nbsp;<span class="builtinfunc" id="6938220">make</span><span class="op" id="6938224">(</span><span class="keyword" id="6938225">map</span><span class="op" id="6938228">[</span><span class="builtintype" id="6938229">string</span><span class="op" id="6938235">]</span><span class="builtintype" id="6938236">bool</span><span class="op" id="6938240">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6938244">if</span>&nbsp;<span class="ident" id="6938247">ctxt</span><span class="op" id="6938251">.</span><span class="ident" id="6938252">match</span><span class="op" id="6938257">(</span><span class="ident" id="6938258">tag</span><span class="op" id="6938261">,</span>&nbsp;<span class="ident" id="6938263">m</span><span class="op" id="6938264">)</span>&nbsp;<span class="op" id="6938266">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938271">t</span><span class="op" id="6938272">.</span><span class="ident" id="6938273">Errorf</span><span class="op" id="6938279">(</span><span class="string" id="6938280">&#34;%s&nbsp;context&nbsp;should&nbsp;NOT&nbsp;match&nbsp;%s,&nbsp;does&#34;</span><span class="op" id="6938318">,</span>&nbsp;<span class="ident" id="6938320">what</span><span class="op" id="6938324">,</span>&nbsp;<span class="ident" id="6938326">tag</span><span class="op" id="6938329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6938333">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6938337">if</span>&nbsp;<span class="op" id="6938340">!</span><span class="ident" id="6938341">reflect</span><span class="op" id="6938348">.</span><span class="ident" id="6938349">DeepEqual</span><span class="op" id="6938358">(</span><span class="ident" id="6938359">m</span><span class="op" id="6938360">,</span>&nbsp;<span class="ident" id="6938362">want</span><span class="op" id="6938366">)</span>&nbsp;<span class="op" id="6938368">{</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938373">t</span><span class="op" id="6938374">.</span><span class="ident" id="6938375">Errorf</span><span class="op" id="6938381">(</span><span class="string" id="6938382">&#34;%s&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6938405">,</span>&nbsp;<span class="ident" id="6938407">tag</span><span class="op" id="6938410">,</span>&nbsp;<span class="ident" id="6938412">m</span><span class="op" id="6938413">,</span>&nbsp;<span class="ident" id="6938415">want</span><span class="op" id="6938419">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6938423">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6938426">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938430">match</span><span class="op" id="6938435">(</span><span class="ident" id="6938436">runtime</span><span class="op" id="6938443">.</span><span class="ident" id="6938444">GOOS</span><span class="op" id="6938448">+</span><span class="string" id="6938449">&#34;,&#34;</span><span class="op" id="6938452">+</span><span class="ident" id="6938453">runtime</span><span class="op" id="6938460">.</span><span class="ident" id="6938461">GOARCH</span><span class="op" id="6938467">,</span>&nbsp;<span class="keyword" id="6938469">map</span><span class="op" id="6938472">[</span><span class="builtintype" id="6938473">string</span><span class="op" id="6938479">]</span><span class="builtintype" id="6938480">bool</span><span class="op" id="6938484">{</span><span class="ident" id="6938485">runtime</span><span class="op" id="6938492">.</span><span class="ident" id="6938493">GOOS</span><span class="op" id="6938497">:</span>&nbsp;<span class="builtintype" id="6938499">true</span><span class="op" id="6938503">,</span>&nbsp;<span class="ident" id="6938505">runtime</span><span class="op" id="6938512">.</span><span class="ident" id="6938513">GOARCH</span><span class="op" id="6938519">:</span>&nbsp;<span class="builtintype" id="6938521">true</span><span class="op" id="6938525">}</span><span class="op" id="6938526">)</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938529">match</span><span class="op" id="6938534">(</span><span class="ident" id="6938535">runtime</span><span class="op" id="6938542">.</span><span class="ident" id="6938543">GOOS</span><span class="op" id="6938547">+</span><span class="string" id="6938548">&#34;,&#34;</span><span class="op" id="6938551">+</span><span class="ident" id="6938552">runtime</span><span class="op" id="6938559">.</span><span class="ident" id="6938560">GOARCH</span><span class="op" id="6938566">+</span><span class="string" id="6938567">&#34;,!foo&#34;</span><span class="op" id="6938574">,</span>&nbsp;<span class="keyword" id="6938576">map</span><span class="op" id="6938579">[</span><span class="builtintype" id="6938580">string</span><span class="op" id="6938586">]</span><span class="builtintype" id="6938587">bool</span><span class="op" id="6938591">{</span><span class="ident" id="6938592">runtime</span><span class="op" id="6938599">.</span><span class="ident" id="6938600">GOOS</span><span class="op" id="6938604">:</span>&nbsp;<span class="builtintype" id="6938606">true</span><span class="op" id="6938610">,</span>&nbsp;<span class="ident" id="6938612">runtime</span><span class="op" id="6938619">.</span><span class="ident" id="6938620">GOARCH</span><span class="op" id="6938626">:</span>&nbsp;<span class="builtintype" id="6938628">true</span><span class="op" id="6938632">,</span>&nbsp;<span class="string" id="6938634">&#34;foo&#34;</span><span class="op" id="6938639">:</span>&nbsp;<span class="builtintype" id="6938641">true</span><span class="op" id="6938645">}</span><span class="op" id="6938646">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938649">nomatch</span><span class="op" id="6938656">(</span><span class="ident" id="6938657">runtime</span><span class="op" id="6938664">.</span><span class="ident" id="6938665">GOOS</span><span class="op" id="6938669">+</span><span class="string" id="6938670">&#34;,&#34;</span><span class="op" id="6938673">+</span><span class="ident" id="6938674">runtime</span><span class="op" id="6938681">.</span><span class="ident" id="6938682">GOARCH</span><span class="op" id="6938688">+</span><span class="string" id="6938689">&#34;,foo&#34;</span><span class="op" id="6938695">,</span>&nbsp;<span class="keyword" id="6938697">map</span><span class="op" id="6938700">[</span><span class="builtintype" id="6938701">string</span><span class="op" id="6938707">]</span><span class="builtintype" id="6938708">bool</span><span class="op" id="6938712">{</span><span class="ident" id="6938713">runtime</span><span class="op" id="6938720">.</span><span class="ident" id="6938721">GOOS</span><span class="op" id="6938725">:</span>&nbsp;<span class="builtintype" id="6938727">true</span><span class="op" id="6938731">,</span>&nbsp;<span class="ident" id="6938733">runtime</span><span class="op" id="6938740">.</span><span class="ident" id="6938741">GOARCH</span><span class="op" id="6938747">:</span>&nbsp;<span class="builtintype" id="6938749">true</span><span class="op" id="6938753">,</span>&nbsp;<span class="string" id="6938755">&#34;foo&#34;</span><span class="op" id="6938760">:</span>&nbsp;<span class="builtintype" id="6938762">true</span><span class="op" id="6938766">}</span><span class="op" id="6938767">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938771">what</span>&nbsp;<span class="op" id="6938776">=</span>&nbsp;<span class="string" id="6938778">&#34;modified&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938790">ctxt</span><span class="op" id="6938794">.</span><span class="ident" id="6938795">BuildTags</span>&nbsp;<span class="op" id="6938805">=</span>&nbsp;<span class="op" id="6938807">[</span><span class="op" id="6938808">]</span><span class="builtintype" id="6938809">string</span><span class="op" id="6938815">{</span><span class="string" id="6938816">&#34;foo&#34;</span><span class="op" id="6938821">}</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938824">match</span><span class="op" id="6938829">(</span><span class="ident" id="6938830">runtime</span><span class="op" id="6938837">.</span><span class="ident" id="6938838">GOOS</span><span class="op" id="6938842">+</span><span class="string" id="6938843">&#34;,&#34;</span><span class="op" id="6938846">+</span><span class="ident" id="6938847">runtime</span><span class="op" id="6938854">.</span><span class="ident" id="6938855">GOARCH</span><span class="op" id="6938861">,</span>&nbsp;<span class="keyword" id="6938863">map</span><span class="op" id="6938866">[</span><span class="builtintype" id="6938867">string</span><span class="op" id="6938873">]</span><span class="builtintype" id="6938874">bool</span><span class="op" id="6938878">{</span><span class="ident" id="6938879">runtime</span><span class="op" id="6938886">.</span><span class="ident" id="6938887">GOOS</span><span class="op" id="6938891">:</span>&nbsp;<span class="builtintype" id="6938893">true</span><span class="op" id="6938897">,</span>&nbsp;<span class="ident" id="6938899">runtime</span><span class="op" id="6938906">.</span><span class="ident" id="6938907">GOARCH</span><span class="op" id="6938913">:</span>&nbsp;<span class="builtintype" id="6938915">true</span><span class="op" id="6938919">}</span><span class="op" id="6938920">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6938923">match</span><span class="op" id="6938928">(</span><span class="ident" id="6938929">runtime</span><span class="op" id="6938936">.</span><span class="ident" id="6938937">GOOS</span><span class="op" id="6938941">+</span><span class="string" id="6938942">&#34;,&#34;</span><span class="op" id="6938945">+</span><span class="ident" id="6938946">runtime</span><span class="op" id="6938953">.</span><span class="ident" id="6938954">GOARCH</span><span class="op" id="6938960">+</span><span class="string" id="6938961">&#34;,foo&#34;</span><span class="op" id="6938967">,</span>&nbsp;<span class="keyword" id="6938969">map</span><span class="op" id="6938972">[</span><span class="builtintype" id="6938973">string</span><span class="op" id="6938979">]</span><span class="builtintype" id="6938980">bool</span><span class="op" id="6938984">{</span><span class="ident" id="6938985">runtime</span><span class="op" id="6938992">.</span><span class="ident" id="6938993">GOOS</span><span class="op" id="6938997">:</span>&nbsp;<span class="builtintype" id="6938999">true</span><span class="op" id="6939003">,</span>&nbsp;<span class="ident" id="6939005">runtime</span><span class="op" id="6939012">.</span><span class="ident" id="6939013">GOARCH</span><span class="op" id="6939019">:</span>&nbsp;<span class="builtintype" id="6939021">true</span><span class="op" id="6939025">,</span>&nbsp;<span class="string" id="6939027">&#34;foo&#34;</span><span class="op" id="6939032">:</span>&nbsp;<span class="builtintype" id="6939034">true</span><span class="op" id="6939038">}</span><span class="op" id="6939039">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939042">nomatch</span><span class="op" id="6939049">(</span><span class="ident" id="6939050">runtime</span><span class="op" id="6939057">.</span><span class="ident" id="6939058">GOOS</span><span class="op" id="6939062">+</span><span class="string" id="6939063">&#34;,&#34;</span><span class="op" id="6939066">+</span><span class="ident" id="6939067">runtime</span><span class="op" id="6939074">.</span><span class="ident" id="6939075">GOARCH</span><span class="op" id="6939081">+</span><span class="string" id="6939082">&#34;,!foo&#34;</span><span class="op" id="6939089">,</span>&nbsp;<span class="keyword" id="6939091">map</span><span class="op" id="6939094">[</span><span class="builtintype" id="6939095">string</span><span class="op" id="6939101">]</span><span class="builtintype" id="6939102">bool</span><span class="op" id="6939106">{</span><span class="ident" id="6939107">runtime</span><span class="op" id="6939114">.</span><span class="ident" id="6939115">GOOS</span><span class="op" id="6939119">:</span>&nbsp;<span class="builtintype" id="6939121">true</span><span class="op" id="6939125">,</span>&nbsp;<span class="ident" id="6939127">runtime</span><span class="op" id="6939134">.</span><span class="ident" id="6939135">GOARCH</span><span class="op" id="6939141">:</span>&nbsp;<span class="builtintype" id="6939143">true</span><span class="op" id="6939147">,</span>&nbsp;<span class="string" id="6939149">&#34;foo&#34;</span><span class="op" id="6939154">:</span>&nbsp;<span class="builtintype" id="6939156">true</span><span class="op" id="6939160">}</span><span class="op" id="6939161">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939164">match</span><span class="op" id="6939169">(</span><span class="ident" id="6939170">runtime</span><span class="op" id="6939177">.</span><span class="ident" id="6939178">GOOS</span><span class="op" id="6939182">+</span><span class="string" id="6939183">&#34;,&#34;</span><span class="op" id="6939186">+</span><span class="ident" id="6939187">runtime</span><span class="op" id="6939194">.</span><span class="ident" id="6939195">GOARCH</span><span class="op" id="6939201">+</span><span class="string" id="6939202">&#34;,!bar&#34;</span><span class="op" id="6939209">,</span>&nbsp;<span class="keyword" id="6939211">map</span><span class="op" id="6939214">[</span><span class="builtintype" id="6939215">string</span><span class="op" id="6939221">]</span><span class="builtintype" id="6939222">bool</span><span class="op" id="6939226">{</span><span class="ident" id="6939227">runtime</span><span class="op" id="6939234">.</span><span class="ident" id="6939235">GOOS</span><span class="op" id="6939239">:</span>&nbsp;<span class="builtintype" id="6939241">true</span><span class="op" id="6939245">,</span>&nbsp;<span class="ident" id="6939247">runtime</span><span class="op" id="6939254">.</span><span class="ident" id="6939255">GOARCH</span><span class="op" id="6939261">:</span>&nbsp;<span class="builtintype" id="6939263">true</span><span class="op" id="6939267">,</span>&nbsp;<span class="string" id="6939269">&#34;bar&#34;</span><span class="op" id="6939274">:</span>&nbsp;<span class="builtintype" id="6939276">true</span><span class="op" id="6939280">}</span><span class="op" id="6939281">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939284">nomatch</span><span class="op" id="6939291">(</span><span class="ident" id="6939292">runtime</span><span class="op" id="6939299">.</span><span class="ident" id="6939300">GOOS</span><span class="op" id="6939304">+</span><span class="string" id="6939305">&#34;,&#34;</span><span class="op" id="6939308">+</span><span class="ident" id="6939309">runtime</span><span class="op" id="6939316">.</span><span class="ident" id="6939317">GOARCH</span><span class="op" id="6939323">+</span><span class="string" id="6939324">&#34;,bar&#34;</span><span class="op" id="6939330">,</span>&nbsp;<span class="keyword" id="6939332">map</span><span class="op" id="6939335">[</span><span class="builtintype" id="6939336">string</span><span class="op" id="6939342">]</span><span class="builtintype" id="6939343">bool</span><span class="op" id="6939347">{</span><span class="ident" id="6939348">runtime</span><span class="op" id="6939355">.</span><span class="ident" id="6939356">GOOS</span><span class="op" id="6939360">:</span>&nbsp;<span class="builtintype" id="6939362">true</span><span class="op" id="6939366">,</span>&nbsp;<span class="ident" id="6939368">runtime</span><span class="op" id="6939375">.</span><span class="ident" id="6939376">GOARCH</span><span class="op" id="6939382">:</span>&nbsp;<span class="builtintype" id="6939384">true</span><span class="op" id="6939388">,</span>&nbsp;<span class="string" id="6939390">&#34;bar&#34;</span><span class="op" id="6939395">:</span>&nbsp;<span class="builtintype" id="6939397">true</span><span class="op" id="6939401">}</span><span class="op" id="6939402">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939405">nomatch</span><span class="op" id="6939412">(</span><span class="string" id="6939413">&#34;!&#34;</span><span class="op" id="6939416">,</span>&nbsp;<span class="keyword" id="6939418">map</span><span class="op" id="6939421">[</span><span class="builtintype" id="6939422">string</span><span class="op" id="6939428">]</span><span class="builtintype" id="6939429">bool</span><span class="op" id="6939433">{</span><span class="op" id="6939434">}</span><span class="op" id="6939435">)</span><br>
<span class="lineno"></span><span class="op" id="6939437">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6939440">func</span>&nbsp;<span class="ident" id="6939445">TestDotSlashImport</span><span class="op" id="6939463">(</span><span class="ident" id="6939464">t</span>&nbsp;<span class="op" id="6939466">*</span><span class="ident" id="6939467">testing</span><span class="op" id="6939474">.</span><span class="ident" id="6939475">T</span><span class="op" id="6939476">)</span>&nbsp;<span class="op" id="6939478">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939481">p</span><span class="op" id="6939482">,</span>&nbsp;<span class="ident" id="6939484">err</span>&nbsp;<span class="op" id="6939488">:=</span>&nbsp;<span class="ident" id="6939491">ImportDir</span><span class="op" id="6939500">(</span><span class="string" id="6939501">&#34;testdata/other&#34;</span><span class="op" id="6939517">,</span>&nbsp;<span class="num" id="6939519">0</span><span class="op" id="6939520">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6939523">if</span>&nbsp;<span class="ident" id="6939526">err</span>&nbsp;<span class="op" id="6939530">!=</span>&nbsp;<span class="ident" id="6939533">nil</span>&nbsp;<span class="op" id="6939537">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939541">t</span><span class="op" id="6939542">.</span><span class="ident" id="6939543">Fatal</span><span class="op" id="6939548">(</span><span class="ident" id="6939549">err</span><span class="op" id="6939552">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6939555">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6939558">if</span>&nbsp;<span class="builtinfunc" id="6939561">len</span><span class="op" id="6939564">(</span><span class="ident" id="6939565">p</span><span class="op" id="6939566">.</span><span class="ident" id="6939567">Imports</span><span class="op" id="6939574">)</span>&nbsp;<span class="op" id="6939576">!=</span>&nbsp;<span class="num" id="6939579">1</span>&nbsp;<span class="op" id="6939581">||</span>&nbsp;<span class="ident" id="6939584">p</span><span class="op" id="6939585">.</span><span class="ident" id="6939586">Imports</span><span class="op" id="6939593">[</span><span class="num" id="6939594">0</span><span class="op" id="6939595">]</span>&nbsp;<span class="op" id="6939597">!=</span>&nbsp;<span class="string" id="6939600">&#34;./file&#34;</span>&nbsp;<span class="op" id="6939609">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939613">t</span><span class="op" id="6939614">.</span><span class="ident" id="6939615">Fatalf</span><span class="op" id="6939621">(</span><span class="string" id="6939622">&#34;testdata/other:&nbsp;Imports=%v,&nbsp;want&nbsp;[./file]&#34;</span><span class="op" id="6939665">,</span>&nbsp;<span class="ident" id="6939667">p</span><span class="op" id="6939668">.</span><span class="ident" id="6939669">Imports</span><span class="op" id="6939676">)</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6939679">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939683">p1</span><span class="op" id="6939685">,</span>&nbsp;<span class="ident" id="6939687">err</span>&nbsp;<span class="op" id="6939691">:=</span>&nbsp;<span class="ident" id="6939694">Import</span><span class="op" id="6939700">(</span><span class="string" id="6939701">&#34;./file&#34;</span><span class="op" id="6939709">,</span>&nbsp;<span class="string" id="6939711">&#34;testdata/other&#34;</span><span class="op" id="6939727">,</span>&nbsp;<span class="num" id="6939729">0</span><span class="op" id="6939730">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6939733">if</span>&nbsp;<span class="ident" id="6939736">err</span>&nbsp;<span class="op" id="6939740">!=</span>&nbsp;<span class="ident" id="6939743">nil</span>&nbsp;<span class="op" id="6939747">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939751">t</span><span class="op" id="6939752">.</span><span class="ident" id="6939753">Fatal</span><span class="op" id="6939758">(</span><span class="ident" id="6939759">err</span><span class="op" id="6939762">)</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6939765">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6939768">if</span>&nbsp;<span class="ident" id="6939771">p1</span><span class="op" id="6939773">.</span><span class="ident" id="6939774">Name</span>&nbsp;<span class="op" id="6939779">!=</span>&nbsp;<span class="string" id="6939782">&#34;file&#34;</span>&nbsp;<span class="op" id="6939789">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939793">t</span><span class="op" id="6939794">.</span><span class="ident" id="6939795">Fatalf</span><span class="op" id="6939801">(</span><span class="string" id="6939802">&#34;./file:&nbsp;Name=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6939828">,</span>&nbsp;<span class="ident" id="6939830">p1</span><span class="op" id="6939832">.</span><span class="ident" id="6939833">Name</span><span class="op" id="6939837">,</span>&nbsp;<span class="string" id="6939839">&#34;file&#34;</span><span class="op" id="6939845">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6939848">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939851">dir</span>&nbsp;<span class="op" id="6939855">:=</span>&nbsp;<span class="ident" id="6939858">filepath</span><span class="op" id="6939866">.</span><span class="ident" id="6939867">Clean</span><span class="op" id="6939872">(</span><span class="string" id="6939873">&#34;testdata/other/file&#34;</span><span class="op" id="6939894">)</span>&nbsp;<span class="comment" id="6939896">//&nbsp;Clean&nbsp;to&nbsp;use&nbsp;\&nbsp;on&nbsp;Windows</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6939926">if</span>&nbsp;<span class="ident" id="6939929">p1</span><span class="op" id="6939931">.</span><span class="ident" id="6939932">Dir</span>&nbsp;<span class="op" id="6939936">!=</span>&nbsp;<span class="ident" id="6939939">dir</span>&nbsp;<span class="op" id="6939943">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6939947">t</span><span class="op" id="6939948">.</span><span class="ident" id="6939949">Fatalf</span><span class="op" id="6939955">(</span><span class="string" id="6939956">&#34;./file:&nbsp;Dir=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6939981">,</span>&nbsp;<span class="ident" id="6939983">p1</span><span class="op" id="6939985">.</span><span class="ident" id="6939986">Name</span><span class="op" id="6939990">,</span>&nbsp;<span class="ident" id="6939992">dir</span><span class="op" id="6939995">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6939998">}</span><br>
<span class="lineno"></span><span class="op" id="6940000">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">75</span><span class="keyword" id="6940003">func</span>&nbsp;<span class="ident" id="6940008">TestEmptyImport</span><span class="op" id="6940023">(</span><span class="ident" id="6940024">t</span>&nbsp;<span class="op" id="6940026">*</span><span class="ident" id="6940027">testing</span><span class="op" id="6940034">.</span><span class="ident" id="6940035">T</span><span class="op" id="6940036">)</span>&nbsp;<span class="op" id="6940038">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940041">p</span><span class="op" id="6940042">,</span>&nbsp;<span class="ident" id="6940044">err</span>&nbsp;<span class="op" id="6940048">:=</span>&nbsp;<span class="ident" id="6940051">Import</span><span class="op" id="6940057">(</span><span class="string" id="6940058">&#34;&#34;</span><span class="op" id="6940060">,</span>&nbsp;<span class="ident" id="6940062">Default</span><span class="op" id="6940069">.</span><span class="ident" id="6940070">GOROOT</span><span class="op" id="6940076">,</span>&nbsp;<span class="ident" id="6940078">FindOnly</span><span class="op" id="6940086">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940089">if</span>&nbsp;<span class="ident" id="6940092">err</span>&nbsp;<span class="op" id="6940096">==</span>&nbsp;<span class="ident" id="6940099">nil</span>&nbsp;<span class="op" id="6940103">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940107">t</span><span class="op" id="6940108">.</span><span class="ident" id="6940109">Fatal</span><span class="op" id="6940114">(</span><span class="string" id="6940115">`Import(&#34;&#34;)&nbsp;returned&nbsp;nil&nbsp;error.`</span><span class="op" id="6940147">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6940150">}</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940153">if</span>&nbsp;<span class="ident" id="6940156">p</span>&nbsp;<span class="op" id="6940158">==</span>&nbsp;<span class="ident" id="6940161">nil</span>&nbsp;<span class="op" id="6940165">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940169">t</span><span class="op" id="6940170">.</span><span class="ident" id="6940171">Fatal</span><span class="op" id="6940176">(</span><span class="string" id="6940177">`Import(&#34;&#34;)&nbsp;returned&nbsp;nil&nbsp;package.`</span><span class="op" id="6940211">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6940214">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940217">if</span>&nbsp;<span class="ident" id="6940220">p</span><span class="op" id="6940221">.</span><span class="ident" id="6940222">ImportPath</span>&nbsp;<span class="op" id="6940233">!=</span>&nbsp;<span class="string" id="6940236">&#34;&#34;</span>&nbsp;<span class="op" id="6940239">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940243">t</span><span class="op" id="6940244">.</span><span class="ident" id="6940245">Fatalf</span><span class="op" id="6940251">(</span><span class="string" id="6940252">&#34;ImportPath=%q,&nbsp;want&nbsp;%q.&#34;</span><span class="op" id="6940277">,</span>&nbsp;<span class="ident" id="6940279">p</span><span class="op" id="6940280">.</span><span class="ident" id="6940281">ImportPath</span><span class="op" id="6940291">,</span>&nbsp;<span class="string" id="6940293">&#34;&#34;</span><span class="op" id="6940295">)</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6940298">}</span><br>
<span class="lineno"></span><span class="op" id="6940300">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6940303">func</span>&nbsp;<span class="ident" id="6940308">TestEmptyFolderImport</span><span class="op" id="6940329">(</span><span class="ident" id="6940330">t</span>&nbsp;<span class="op" id="6940332">*</span><span class="ident" id="6940333">testing</span><span class="op" id="6940340">.</span><span class="ident" id="6940341">T</span><span class="op" id="6940342">)</span>&nbsp;<span class="op" id="6940344">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940347">_</span><span class="op" id="6940348">,</span>&nbsp;<span class="ident" id="6940350">err</span>&nbsp;<span class="op" id="6940354">:=</span>&nbsp;<span class="ident" id="6940357">Import</span><span class="op" id="6940363">(</span><span class="string" id="6940364">&#34;.&#34;</span><span class="op" id="6940367">,</span>&nbsp;<span class="string" id="6940369">&#34;testdata/empty&#34;</span><span class="op" id="6940385">,</span>&nbsp;<span class="num" id="6940387">0</span><span class="op" id="6940388">)</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940391">if</span>&nbsp;<span class="ident" id="6940394">_</span><span class="op" id="6940395">,</span>&nbsp;<span class="ident" id="6940397">ok</span>&nbsp;<span class="op" id="6940400">:=</span>&nbsp;<span class="ident" id="6940403">err</span><span class="op" id="6940406">.</span><span class="op" id="6940407">(</span><span class="op" id="6940408">*</span><span class="ident" id="6940409">NoGoError</span><span class="op" id="6940418">)</span><span class="op" id="6940419">;</span>&nbsp;<span class="op" id="6940421">!</span><span class="ident" id="6940422">ok</span>&nbsp;<span class="op" id="6940425">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940429">t</span><span class="op" id="6940430">.</span><span class="ident" id="6940431">Fatal</span><span class="op" id="6940436">(</span><span class="string" id="6940437">`Import(&#34;testdata/empty&#34;)&nbsp;did&nbsp;not&nbsp;return&nbsp;NoGoError.`</span><span class="op" id="6940489">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6940492">}</span><br>
<span class="lineno"></span><span class="op" id="6940494">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">95</span><span class="keyword" id="6940497">func</span>&nbsp;<span class="ident" id="6940502">TestMultiplePackageImport</span><span class="op" id="6940527">(</span><span class="ident" id="6940528">t</span>&nbsp;<span class="op" id="6940530">*</span><span class="ident" id="6940531">testing</span><span class="op" id="6940538">.</span><span class="ident" id="6940539">T</span><span class="op" id="6940540">)</span>&nbsp;<span class="op" id="6940542">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940545">_</span><span class="op" id="6940546">,</span>&nbsp;<span class="ident" id="6940548">err</span>&nbsp;<span class="op" id="6940552">:=</span>&nbsp;<span class="ident" id="6940555">Import</span><span class="op" id="6940561">(</span><span class="string" id="6940562">&#34;.&#34;</span><span class="op" id="6940565">,</span>&nbsp;<span class="string" id="6940567">&#34;testdata/multi&#34;</span><span class="op" id="6940583">,</span>&nbsp;<span class="num" id="6940585">0</span><span class="op" id="6940586">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940589">if</span>&nbsp;<span class="ident" id="6940592">_</span><span class="op" id="6940593">,</span>&nbsp;<span class="ident" id="6940595">ok</span>&nbsp;<span class="op" id="6940598">:=</span>&nbsp;<span class="ident" id="6940601">err</span><span class="op" id="6940604">.</span><span class="op" id="6940605">(</span><span class="op" id="6940606">*</span><span class="ident" id="6940607">MultiplePackageError</span><span class="op" id="6940627">)</span><span class="op" id="6940628">;</span>&nbsp;<span class="op" id="6940630">!</span><span class="ident" id="6940631">ok</span>&nbsp;<span class="op" id="6940634">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940638">t</span><span class="op" id="6940639">.</span><span class="ident" id="6940640">Fatal</span><span class="op" id="6940645">(</span><span class="string" id="6940646">`Import(&#34;testdata/multi&#34;)&nbsp;did&nbsp;not&nbsp;return&nbsp;MultiplePackageError.`</span><span class="op" id="6940709">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6940712">}</span><br>
<span class="lineno">100</span><span class="op" id="6940714">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6940717">func</span>&nbsp;<span class="ident" id="6940722">TestLocalDirectory</span><span class="op" id="6940740">(</span><span class="ident" id="6940741">t</span>&nbsp;<span class="op" id="6940743">*</span><span class="ident" id="6940744">testing</span><span class="op" id="6940751">.</span><span class="ident" id="6940752">T</span><span class="op" id="6940753">)</span>&nbsp;<span class="op" id="6940755">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940758">cwd</span><span class="op" id="6940761">,</span>&nbsp;<span class="ident" id="6940763">err</span>&nbsp;<span class="op" id="6940767">:=</span>&nbsp;<span class="ident" id="6940770">os</span><span class="op" id="6940772">.</span><span class="ident" id="6940773">Getwd</span><span class="op" id="6940778">(</span><span class="op" id="6940779">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940782">if</span>&nbsp;<span class="ident" id="6940785">err</span>&nbsp;<span class="op" id="6940789">!=</span>&nbsp;<span class="ident" id="6940792">nil</span>&nbsp;<span class="op" id="6940796">{</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940800">t</span><span class="op" id="6940801">.</span><span class="ident" id="6940802">Fatal</span><span class="op" id="6940807">(</span><span class="ident" id="6940808">err</span><span class="op" id="6940811">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6940814">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940818">p</span><span class="op" id="6940819">,</span>&nbsp;<span class="ident" id="6940821">err</span>&nbsp;<span class="op" id="6940825">:=</span>&nbsp;<span class="ident" id="6940828">ImportDir</span><span class="op" id="6940837">(</span><span class="ident" id="6940838">cwd</span><span class="op" id="6940841">,</span>&nbsp;<span class="num" id="6940843">0</span><span class="op" id="6940844">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940847">if</span>&nbsp;<span class="ident" id="6940850">err</span>&nbsp;<span class="op" id="6940854">!=</span>&nbsp;<span class="ident" id="6940857">nil</span>&nbsp;<span class="op" id="6940861">{</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940865">t</span><span class="op" id="6940866">.</span><span class="ident" id="6940867">Fatal</span><span class="op" id="6940872">(</span><span class="ident" id="6940873">err</span><span class="op" id="6940876">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6940879">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6940882">if</span>&nbsp;<span class="ident" id="6940885">p</span><span class="op" id="6940886">.</span><span class="ident" id="6940887">ImportPath</span>&nbsp;<span class="op" id="6940898">!=</span>&nbsp;<span class="string" id="6940901">&#34;go/build&#34;</span>&nbsp;<span class="op" id="6940912">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6940916">t</span><span class="op" id="6940917">.</span><span class="ident" id="6940918">Fatalf</span><span class="op" id="6940924">(</span><span class="string" id="6940925">&#34;ImportPath=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6940949">,</span>&nbsp;<span class="ident" id="6940951">p</span><span class="op" id="6940952">.</span><span class="ident" id="6940953">ImportPath</span><span class="op" id="6940963">,</span>&nbsp;<span class="string" id="6940965">&#34;go/build&#34;</span><span class="op" id="6940975">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6940978">}</span><br>
<span class="lineno">115</span><span class="op" id="6940980">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6940983">func</span>&nbsp;<span class="ident" id="6940988">TestShouldBuild</span><span class="op" id="6941003">(</span><span class="ident" id="6941004">t</span>&nbsp;<span class="op" id="6941006">*</span><span class="ident" id="6941007">testing</span><span class="op" id="6941014">.</span><span class="ident" id="6941015">T</span><span class="op" id="6941016">)</span>&nbsp;<span class="op" id="6941018">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941021">const</span>&nbsp;<span class="ident" id="6941027">file1</span>&nbsp;<span class="op" id="6941033">=</span>&nbsp;<span class="string" id="6941035">&#34;//&nbsp;+build&nbsp;tag1\n\n&#34;</span>&nbsp;<span class="op" id="6941056">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6941060">&#34;package&nbsp;main\n&#34;</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941078">want1</span>&nbsp;<span class="op" id="6941084">:=</span>&nbsp;<span class="keyword" id="6941087">map</span><span class="op" id="6941090">[</span><span class="builtintype" id="6941091">string</span><span class="op" id="6941097">]</span><span class="builtintype" id="6941098">bool</span><span class="op" id="6941102">{</span><span class="string" id="6941103">&#34;tag1&#34;</span><span class="op" id="6941109">:</span>&nbsp;<span class="builtintype" id="6941111">true</span><span class="op" id="6941115">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941119">const</span>&nbsp;<span class="ident" id="6941125">file2</span>&nbsp;<span class="op" id="6941131">=</span>&nbsp;<span class="string" id="6941133">&#34;//&nbsp;+build&nbsp;cgo\n\n&#34;</span>&nbsp;<span class="op" id="6941153">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6941157">&#34;//&nbsp;This&nbsp;package&nbsp;implements&nbsp;parsing&nbsp;of&nbsp;tags&nbsp;like\n&#34;</span>&nbsp;<span class="op" id="6941209">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6941213">&#34;//&nbsp;+build&nbsp;tag1\n&#34;</span>&nbsp;<span class="op" id="6941232">+</span><br>
<span class="lineno">125</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6941236">&#34;package&nbsp;build&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941253">want2</span>&nbsp;<span class="op" id="6941259">:=</span>&nbsp;<span class="keyword" id="6941262">map</span><span class="op" id="6941265">[</span><span class="builtintype" id="6941266">string</span><span class="op" id="6941272">]</span><span class="builtintype" id="6941273">bool</span><span class="op" id="6941277">{</span><span class="string" id="6941278">&#34;cgo&#34;</span><span class="op" id="6941283">:</span>&nbsp;<span class="builtintype" id="6941285">true</span><span class="op" id="6941289">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941293">const</span>&nbsp;<span class="ident" id="6941299">file3</span>&nbsp;<span class="op" id="6941305">=</span>&nbsp;<span class="string" id="6941307">&#34;//&nbsp;Copyright&nbsp;The&nbsp;Go&nbsp;Authors.\n\n&#34;</span>&nbsp;<span class="op" id="6941342">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6941346">&#34;package&nbsp;build\n\n&#34;</span>&nbsp;<span class="op" id="6941366">+</span><br>
<span class="lineno">130</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6941370">&#34;//&nbsp;shouldBuild&nbsp;checks&nbsp;tags&nbsp;given&nbsp;by&nbsp;lines&nbsp;of&nbsp;the&nbsp;form\n&#34;</span>&nbsp;<span class="op" id="6941428">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6941432">&#34;//&nbsp;+build&nbsp;tag\n&#34;</span>&nbsp;<span class="op" id="6941450">+</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="6941454">&#34;func&nbsp;shouldBuild(content&nbsp;[]byte)\n&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941492">want3</span>&nbsp;<span class="op" id="6941498">:=</span>&nbsp;<span class="keyword" id="6941501">map</span><span class="op" id="6941504">[</span><span class="builtintype" id="6941505">string</span><span class="op" id="6941511">]</span><span class="builtintype" id="6941512">bool</span><span class="op" id="6941516">{</span><span class="op" id="6941517">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">135</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941521">ctx</span>&nbsp;<span class="op" id="6941525">:=</span>&nbsp;<span class="op" id="6941528">&amp;</span><span class="ident" id="6941529">Context</span><span class="op" id="6941536">{</span><span class="ident" id="6941537">BuildTags</span><span class="op" id="6941546">:</span>&nbsp;<span class="op" id="6941548">[</span><span class="op" id="6941549">]</span><span class="builtintype" id="6941550">string</span><span class="op" id="6941556">{</span><span class="string" id="6941557">&#34;tag1&#34;</span><span class="op" id="6941563">}</span><span class="op" id="6941564">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941567">m</span>&nbsp;<span class="op" id="6941569">:=</span>&nbsp;<span class="keyword" id="6941572">map</span><span class="op" id="6941575">[</span><span class="builtintype" id="6941576">string</span><span class="op" id="6941582">]</span><span class="builtintype" id="6941583">bool</span><span class="op" id="6941587">{</span><span class="op" id="6941588">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941591">if</span>&nbsp;<span class="op" id="6941594">!</span><span class="ident" id="6941595">ctx</span><span class="op" id="6941598">.</span><span class="ident" id="6941599">shouldBuild</span><span class="op" id="6941610">(</span><span class="op" id="6941611">[</span><span class="op" id="6941612">]</span><span class="builtintype" id="6941613">byte</span><span class="op" id="6941617">(</span><span class="ident" id="6941618">file1</span><span class="op" id="6941623">)</span><span class="op" id="6941624">,</span>&nbsp;<span class="ident" id="6941626">m</span><span class="op" id="6941627">)</span>&nbsp;<span class="op" id="6941629">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941633">t</span><span class="op" id="6941634">.</span><span class="ident" id="6941635">Errorf</span><span class="op" id="6941641">(</span><span class="string" id="6941642">&#34;shouldBuild(file1)&nbsp;=&nbsp;false,&nbsp;want&nbsp;true&#34;</span><span class="op" id="6941681">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6941684">}</span><br>
<span class="lineno">140</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941687">if</span>&nbsp;<span class="op" id="6941690">!</span><span class="ident" id="6941691">reflect</span><span class="op" id="6941698">.</span><span class="ident" id="6941699">DeepEqual</span><span class="op" id="6941708">(</span><span class="ident" id="6941709">m</span><span class="op" id="6941710">,</span>&nbsp;<span class="ident" id="6941712">want1</span><span class="op" id="6941717">)</span>&nbsp;<span class="op" id="6941719">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941723">t</span><span class="op" id="6941724">.</span><span class="ident" id="6941725">Errorf</span><span class="op" id="6941731">(</span><span class="string" id="6941732">&#34;shoudBuild(file1)&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6941770">,</span>&nbsp;<span class="ident" id="6941772">m</span><span class="op" id="6941773">,</span>&nbsp;<span class="ident" id="6941775">want1</span><span class="op" id="6941780">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6941783">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941787">m</span>&nbsp;<span class="op" id="6941789">=</span>&nbsp;<span class="keyword" id="6941791">map</span><span class="op" id="6941794">[</span><span class="builtintype" id="6941795">string</span><span class="op" id="6941801">]</span><span class="builtintype" id="6941802">bool</span><span class="op" id="6941806">{</span><span class="op" id="6941807">}</span><br>
<span class="lineno">145</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941810">if</span>&nbsp;<span class="ident" id="6941813">ctx</span><span class="op" id="6941816">.</span><span class="ident" id="6941817">shouldBuild</span><span class="op" id="6941828">(</span><span class="op" id="6941829">[</span><span class="op" id="6941830">]</span><span class="builtintype" id="6941831">byte</span><span class="op" id="6941835">(</span><span class="ident" id="6941836">file2</span><span class="op" id="6941841">)</span><span class="op" id="6941842">,</span>&nbsp;<span class="ident" id="6941844">m</span><span class="op" id="6941845">)</span>&nbsp;<span class="op" id="6941847">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941851">t</span><span class="op" id="6941852">.</span><span class="ident" id="6941853">Errorf</span><span class="op" id="6941859">(</span><span class="string" id="6941860">&#34;shouldBuild(file2)&nbsp;=&nbsp;true,&nbsp;want&nbsp;fakse&#34;</span><span class="op" id="6941899">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6941902">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6941905">if</span>&nbsp;<span class="op" id="6941908">!</span><span class="ident" id="6941909">reflect</span><span class="op" id="6941916">.</span><span class="ident" id="6941917">DeepEqual</span><span class="op" id="6941926">(</span><span class="ident" id="6941927">m</span><span class="op" id="6941928">,</span>&nbsp;<span class="ident" id="6941930">want2</span><span class="op" id="6941935">)</span>&nbsp;<span class="op" id="6941937">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6941941">t</span><span class="op" id="6941942">.</span><span class="ident" id="6941943">Errorf</span><span class="op" id="6941949">(</span><span class="string" id="6941950">&#34;shoudBuild(file2)&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6941988">,</span>&nbsp;<span class="ident" id="6941990">m</span><span class="op" id="6941991">,</span>&nbsp;<span class="ident" id="6941993">want2</span><span class="op" id="6941998">)</span><br>
<span class="lineno">150</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942001">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942005">m</span>&nbsp;<span class="op" id="6942007">=</span>&nbsp;<span class="keyword" id="6942009">map</span><span class="op" id="6942012">[</span><span class="builtintype" id="6942013">string</span><span class="op" id="6942019">]</span><span class="builtintype" id="6942020">bool</span><span class="op" id="6942024">{</span><span class="op" id="6942025">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942028">ctx</span>&nbsp;<span class="op" id="6942032">=</span>&nbsp;<span class="op" id="6942034">&amp;</span><span class="ident" id="6942035">Context</span><span class="op" id="6942042">{</span><span class="ident" id="6942043">BuildTags</span><span class="op" id="6942052">:</span>&nbsp;<span class="ident" id="6942054">nil</span><span class="op" id="6942057">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942060">if</span>&nbsp;<span class="op" id="6942063">!</span><span class="ident" id="6942064">ctx</span><span class="op" id="6942067">.</span><span class="ident" id="6942068">shouldBuild</span><span class="op" id="6942079">(</span><span class="op" id="6942080">[</span><span class="op" id="6942081">]</span><span class="builtintype" id="6942082">byte</span><span class="op" id="6942086">(</span><span class="ident" id="6942087">file3</span><span class="op" id="6942092">)</span><span class="op" id="6942093">,</span>&nbsp;<span class="ident" id="6942095">m</span><span class="op" id="6942096">)</span>&nbsp;<span class="op" id="6942098">{</span><br>
<span class="lineno">155</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942102">t</span><span class="op" id="6942103">.</span><span class="ident" id="6942104">Errorf</span><span class="op" id="6942110">(</span><span class="string" id="6942111">&#34;shouldBuild(file3)&nbsp;=&nbsp;false,&nbsp;want&nbsp;true&#34;</span><span class="op" id="6942150">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942153">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942156">if</span>&nbsp;<span class="op" id="6942159">!</span><span class="ident" id="6942160">reflect</span><span class="op" id="6942167">.</span><span class="ident" id="6942168">DeepEqual</span><span class="op" id="6942177">(</span><span class="ident" id="6942178">m</span><span class="op" id="6942179">,</span>&nbsp;<span class="ident" id="6942181">want3</span><span class="op" id="6942186">)</span>&nbsp;<span class="op" id="6942188">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942192">t</span><span class="op" id="6942193">.</span><span class="ident" id="6942194">Errorf</span><span class="op" id="6942200">(</span><span class="string" id="6942201">&#34;shoudBuild(file3)&nbsp;tags&nbsp;=&nbsp;%v,&nbsp;want&nbsp;%v&#34;</span><span class="op" id="6942239">,</span>&nbsp;<span class="ident" id="6942241">m</span><span class="op" id="6942242">,</span>&nbsp;<span class="ident" id="6942244">want3</span><span class="op" id="6942249">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942252">}</span><br>
<span class="lineno">160</span><span class="op" id="6942254">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6942257">type</span>&nbsp;<span class="ident" id="6942262">readNopCloser</span>&nbsp;<span class="keyword" id="6942276">struct</span>&nbsp;<span class="op" id="6942283">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942286">io</span><span class="op" id="6942288">.</span><span class="ident" id="6942289">Reader</span><br>
<span class="lineno"></span><span class="op" id="6942296">}</span><br>
<span class="lineno">165</span><br>
<span class="lineno"></span><span class="keyword" id="6942299">func</span>&nbsp;<span class="op" id="6942304">(</span><span class="ident" id="6942305">r</span>&nbsp;<span class="ident" id="6942307">readNopCloser</span><span class="op" id="6942320">)</span>&nbsp;<span class="ident" id="6942322">Close</span><span class="op" id="6942327">(</span><span class="op" id="6942328">)</span>&nbsp;<span class="builtintype" id="6942330">error</span>&nbsp;<span class="op" id="6942336">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6942339">return</span>&nbsp;<span class="ident" id="6942346">nil</span><br>
<span class="lineno"></span><span class="op" id="6942350">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">170</span><span class="keyword" id="6942353">var</span>&nbsp;<span class="op" id="6942357">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942360">ctxtP9</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="op" id="6942372">=</span>&nbsp;<span class="ident" id="6942374">Context</span><span class="op" id="6942381">{</span><span class="ident" id="6942382">GOARCH</span><span class="op" id="6942388">:</span>&nbsp;<span class="string" id="6942390">&#34;arm&#34;</span><span class="op" id="6942395">,</span>&nbsp;<span class="ident" id="6942397">GOOS</span><span class="op" id="6942401">:</span>&nbsp;<span class="string" id="6942403">&#34;plan9&#34;</span><span class="op" id="6942410">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942413">ctxtAndroid</span>&nbsp;<span class="op" id="6942425">=</span>&nbsp;<span class="ident" id="6942427">Context</span><span class="op" id="6942434">{</span><span class="ident" id="6942435">GOARCH</span><span class="op" id="6942441">:</span>&nbsp;<span class="string" id="6942443">&#34;arm&#34;</span><span class="op" id="6942448">,</span>&nbsp;<span class="ident" id="6942450">GOOS</span><span class="op" id="6942454">:</span>&nbsp;<span class="string" id="6942456">&#34;android&#34;</span><span class="op" id="6942465">}</span><br>
<span class="lineno"></span><span class="op" id="6942467">)</span><br>
<span class="lineno"></span><br>
<span class="lineno">175</span><span class="keyword" id="6942470">var</span>&nbsp;<span class="ident" id="6942474">matchFileTests</span>&nbsp;<span class="op" id="6942489">=</span>&nbsp;<span class="op" id="6942491">[</span><span class="op" id="6942492">]</span><span class="keyword" id="6942493">struct</span>&nbsp;<span class="op" id="6942500">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942503">ctxt</span>&nbsp;&nbsp;<span class="ident" id="6942509">Context</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942518">name</span>&nbsp;&nbsp;<span class="builtintype" id="6942524">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942532">data</span>&nbsp;&nbsp;<span class="builtintype" id="6942538">string</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6942546">match</span>&nbsp;<span class="builtintype" id="6942552">bool</span><br>
<span class="lineno">180</span><span class="op" id="6942557">}</span><span class="op" id="6942558">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942561">{</span><span class="ident" id="6942562">ctxtP9</span><span class="op" id="6942568">,</span>&nbsp;<span class="string" id="6942570">&#34;foo_arm.go&#34;</span><span class="op" id="6942582">,</span>&nbsp;<span class="string" id="6942584">&#34;&#34;</span><span class="op" id="6942586">,</span>&nbsp;<span class="builtintype" id="6942588">true</span><span class="op" id="6942592">}</span><span class="op" id="6942593">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942596">{</span><span class="ident" id="6942597">ctxtP9</span><span class="op" id="6942603">,</span>&nbsp;<span class="string" id="6942605">&#34;foo1_arm.go&#34;</span><span class="op" id="6942618">,</span>&nbsp;<span class="string" id="6942620">&#34;//&nbsp;+build&nbsp;linux\n\npackage&nbsp;main\n&#34;</span><span class="op" id="6942655">,</span>&nbsp;<span class="builtintype" id="6942657">false</span><span class="op" id="6942662">}</span><span class="op" id="6942663">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942666">{</span><span class="ident" id="6942667">ctxtP9</span><span class="op" id="6942673">,</span>&nbsp;<span class="string" id="6942675">&#34;foo_darwin.go&#34;</span><span class="op" id="6942690">,</span>&nbsp;<span class="string" id="6942692">&#34;&#34;</span><span class="op" id="6942694">,</span>&nbsp;<span class="builtintype" id="6942696">false</span><span class="op" id="6942701">}</span><span class="op" id="6942702">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942705">{</span><span class="ident" id="6942706">ctxtP9</span><span class="op" id="6942712">,</span>&nbsp;<span class="string" id="6942714">&#34;foo.go&#34;</span><span class="op" id="6942722">,</span>&nbsp;<span class="string" id="6942724">&#34;&#34;</span><span class="op" id="6942726">,</span>&nbsp;<span class="builtintype" id="6942728">true</span><span class="op" id="6942732">}</span><span class="op" id="6942733">,</span><br>
<span class="lineno">185</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942736">{</span><span class="ident" id="6942737">ctxtP9</span><span class="op" id="6942743">,</span>&nbsp;<span class="string" id="6942745">&#34;foo1.go&#34;</span><span class="op" id="6942754">,</span>&nbsp;<span class="string" id="6942756">&#34;//&nbsp;+build&nbsp;linux\n\npackage&nbsp;main\n&#34;</span><span class="op" id="6942791">,</span>&nbsp;<span class="builtintype" id="6942793">false</span><span class="op" id="6942798">}</span><span class="op" id="6942799">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942802">{</span><span class="ident" id="6942803">ctxtP9</span><span class="op" id="6942809">,</span>&nbsp;<span class="string" id="6942811">&#34;foo.badsuffix&#34;</span><span class="op" id="6942826">,</span>&nbsp;<span class="string" id="6942828">&#34;&#34;</span><span class="op" id="6942830">,</span>&nbsp;<span class="builtintype" id="6942832">false</span><span class="op" id="6942837">}</span><span class="op" id="6942838">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942841">{</span><span class="ident" id="6942842">ctxtAndroid</span><span class="op" id="6942853">,</span>&nbsp;<span class="string" id="6942855">&#34;foo_linux.go&#34;</span><span class="op" id="6942869">,</span>&nbsp;<span class="string" id="6942871">&#34;&#34;</span><span class="op" id="6942873">,</span>&nbsp;<span class="builtintype" id="6942875">true</span><span class="op" id="6942879">}</span><span class="op" id="6942880">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942883">{</span><span class="ident" id="6942884">ctxtAndroid</span><span class="op" id="6942895">,</span>&nbsp;<span class="string" id="6942897">&#34;foo_android.go&#34;</span><span class="op" id="6942913">,</span>&nbsp;<span class="string" id="6942915">&#34;&#34;</span><span class="op" id="6942917">,</span>&nbsp;<span class="builtintype" id="6942919">true</span><span class="op" id="6942923">}</span><span class="op" id="6942924">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942927">{</span><span class="ident" id="6942928">ctxtAndroid</span><span class="op" id="6942939">,</span>&nbsp;<span class="string" id="6942941">&#34;foo_plan9.go&#34;</span><span class="op" id="6942955">,</span>&nbsp;<span class="string" id="6942957">&#34;&#34;</span><span class="op" id="6942959">,</span>&nbsp;<span class="builtintype" id="6942961">false</span><span class="op" id="6942966">}</span><span class="op" id="6942967">,</span><br>
<span class="lineno">190</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6942970">{</span><span class="ident" id="6942971">ctxtAndroid</span><span class="op" id="6942982">,</span>&nbsp;<span class="string" id="6942984">&#34;android.go&#34;</span><span class="op" id="6942996">,</span>&nbsp;<span class="string" id="6942998">&#34;&#34;</span><span class="op" id="6943000">,</span>&nbsp;<span class="builtintype" id="6943002">true</span><span class="op" id="6943006">}</span><span class="op" id="6943007">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6943010">{</span><span class="ident" id="6943011">ctxtAndroid</span><span class="op" id="6943022">,</span>&nbsp;<span class="string" id="6943024">&#34;plan9.go&#34;</span><span class="op" id="6943034">,</span>&nbsp;<span class="string" id="6943036">&#34;&#34;</span><span class="op" id="6943038">,</span>&nbsp;<span class="builtintype" id="6943040">true</span><span class="op" id="6943044">}</span><span class="op" id="6943045">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6943048">{</span><span class="ident" id="6943049">ctxtAndroid</span><span class="op" id="6943060">,</span>&nbsp;<span class="string" id="6943062">&#34;plan9_test.go&#34;</span><span class="op" id="6943077">,</span>&nbsp;<span class="string" id="6943079">&#34;&#34;</span><span class="op" id="6943081">,</span>&nbsp;<span class="builtintype" id="6943083">true</span><span class="op" id="6943087">}</span><span class="op" id="6943088">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6943091">{</span><span class="ident" id="6943092">ctxtAndroid</span><span class="op" id="6943103">,</span>&nbsp;<span class="string" id="6943105">&#34;arm.s&#34;</span><span class="op" id="6943112">,</span>&nbsp;<span class="string" id="6943114">&#34;&#34;</span><span class="op" id="6943116">,</span>&nbsp;<span class="builtintype" id="6943118">true</span><span class="op" id="6943122">}</span><span class="op" id="6943123">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6943126">{</span><span class="ident" id="6943127">ctxtAndroid</span><span class="op" id="6943138">,</span>&nbsp;<span class="string" id="6943140">&#34;amd64.s&#34;</span><span class="op" id="6943149">,</span>&nbsp;<span class="string" id="6943151">&#34;&#34;</span><span class="op" id="6943153">,</span>&nbsp;<span class="builtintype" id="6943155">true</span><span class="op" id="6943159">}</span><span class="op" id="6943160">,</span><br>
<span class="lineno">195</span><span class="op" id="6943162">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="6943165">func</span>&nbsp;<span class="ident" id="6943170">TestMatchFile</span><span class="op" id="6943183">(</span><span class="ident" id="6943184">t</span>&nbsp;<span class="op" id="6943186">*</span><span class="ident" id="6943187">testing</span><span class="op" id="6943194">.</span><span class="ident" id="6943195">T</span><span class="op" id="6943196">)</span>&nbsp;<span class="op" id="6943198">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6943201">for</span>&nbsp;<span class="ident" id="6943205">_</span><span class="op" id="6943206">,</span>&nbsp;<span class="ident" id="6943208">tt</span>&nbsp;<span class="op" id="6943211">:=</span>&nbsp;<span class="keyword" id="6943214">range</span>&nbsp;<span class="ident" id="6943220">matchFileTests</span>&nbsp;<span class="op" id="6943235">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6943239">ctxt</span>&nbsp;<span class="op" id="6943244">:=</span>&nbsp;<span class="ident" id="6943247">tt</span><span class="op" id="6943249">.</span><span class="ident" id="6943250">ctxt</span><br>
<span class="lineno">200</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6943257">ctxt</span><span class="op" id="6943261">.</span><span class="ident" id="6943262">OpenFile</span>&nbsp;<span class="op" id="6943271">=</span>&nbsp;<span class="keyword" id="6943273">func</span><span class="op" id="6943277">(</span><span class="ident" id="6943278">path</span>&nbsp;<span class="builtintype" id="6943283">string</span><span class="op" id="6943289">)</span>&nbsp;<span class="op" id="6943291">(</span><span class="ident" id="6943292">r</span>&nbsp;<span class="ident" id="6943294">io</span><span class="op" id="6943296">.</span><span class="ident" id="6943297">ReadCloser</span><span class="op" id="6943307">,</span>&nbsp;<span class="ident" id="6943309">err</span>&nbsp;<span class="builtintype" id="6943313">error</span><span class="op" id="6943318">)</span>&nbsp;<span class="op" id="6943320">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6943325">if</span>&nbsp;<span class="ident" id="6943328">path</span>&nbsp;<span class="op" id="6943333">!=</span>&nbsp;<span class="string" id="6943336">&#34;x+&#34;</span><span class="op" id="6943340">+</span><span class="ident" id="6943341">tt</span><span class="op" id="6943343">.</span><span class="ident" id="6943344">name</span>&nbsp;<span class="op" id="6943349">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6943355">t</span><span class="op" id="6943356">.</span><span class="ident" id="6943357">Fatalf</span><span class="op" id="6943363">(</span><span class="string" id="6943364">&#34;OpenFile&nbsp;asked&nbsp;for&nbsp;%q,&nbsp;expected&nbsp;%q&#34;</span><span class="op" id="6943400">,</span>&nbsp;<span class="ident" id="6943402">path</span><span class="op" id="6943406">,</span>&nbsp;<span class="string" id="6943408">&#34;x+&#34;</span><span class="op" id="6943412">+</span><span class="ident" id="6943413">tt</span><span class="op" id="6943415">.</span><span class="ident" id="6943416">name</span><span class="op" id="6943420">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6943425">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6943430">return</span>&nbsp;<span class="op" id="6943437">&amp;</span><span class="ident" id="6943438">readNopCloser</span><span class="op" id="6943451">{</span><span class="ident" id="6943452">strings</span><span class="op" id="6943459">.</span><span class="ident" id="6943460">NewReader</span><span class="op" id="6943469">(</span><span class="ident" id="6943470">tt</span><span class="op" id="6943472">.</span><span class="ident" id="6943473">data</span><span class="op" id="6943477">)</span><span class="op" id="6943478">}</span><span class="op" id="6943479">,</span>&nbsp;<span class="ident" id="6943481">nil</span><br>
<span class="lineno">205</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6943487">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6943491">ctxt</span><span class="op" id="6943495">.</span><span class="ident" id="6943496">JoinPath</span>&nbsp;<span class="op" id="6943505">=</span>&nbsp;<span class="keyword" id="6943507">func</span><span class="op" id="6943511">(</span><span class="ident" id="6943512">elem</span>&nbsp;<span class="op" id="6943517">...</span><span class="builtintype" id="6943520">string</span><span class="op" id="6943526">)</span>&nbsp;<span class="builtintype" id="6943528">string</span>&nbsp;<span class="op" id="6943535">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6943540">return</span>&nbsp;<span class="ident" id="6943547">strings</span><span class="op" id="6943554">.</span><span class="ident" id="6943555">Join</span><span class="op" id="6943559">(</span><span class="ident" id="6943560">elem</span><span class="op" id="6943564">,</span>&nbsp;<span class="string" id="6943566">&#34;+&#34;</span><span class="op" id="6943569">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6943573">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6943577">match</span><span class="op" id="6943582">,</span>&nbsp;<span class="ident" id="6943584">err</span>&nbsp;<span class="op" id="6943588">:=</span>&nbsp;<span class="ident" id="6943591">ctxt</span><span class="op" id="6943595">.</span><span class="ident" id="6943596">MatchFile</span><span class="op" id="6943605">(</span><span class="string" id="6943606">&#34;x&#34;</span><span class="op" id="6943609">,</span>&nbsp;<span class="ident" id="6943611">tt</span><span class="op" id="6943613">.</span><span class="ident" id="6943614">name</span><span class="op" id="6943618">)</span><br>
<span class="lineno">210</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6943622">if</span>&nbsp;<span class="ident" id="6943625">match</span>&nbsp;<span class="op" id="6943631">!=</span>&nbsp;<span class="ident" id="6943634">tt</span><span class="op" id="6943636">.</span><span class="ident" id="6943637">match</span>&nbsp;<span class="op" id="6943643">||</span>&nbsp;<span class="ident" id="6943646">err</span>&nbsp;<span class="op" id="6943650">!=</span>&nbsp;<span class="ident" id="6943653">nil</span>&nbsp;<span class="op" id="6943657">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6943662">t</span><span class="op" id="6943663">.</span><span class="ident" id="6943664">Fatalf</span><span class="op" id="6943670">(</span><span class="string" id="6943671">&#34;MatchFile(%q)&nbsp;=&nbsp;%v,&nbsp;%v,&nbsp;want&nbsp;%v,&nbsp;nil&#34;</span><span class="op" id="6943709">,</span>&nbsp;<span class="ident" id="6943711">tt</span><span class="op" id="6943713">.</span><span class="ident" id="6943714">name</span><span class="op" id="6943718">,</span>&nbsp;<span class="ident" id="6943720">match</span><span class="op" id="6943725">,</span>&nbsp;<span class="ident" id="6943727">err</span><span class="op" id="6943730">,</span>&nbsp;<span class="ident" id="6943732">tt</span><span class="op" id="6943734">.</span><span class="ident" id="6943735">match</span><span class="op" id="6943740">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6943744">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6943747">}</span><br>
<span class="lineno"></span><span class="op" id="6943749">}</span><br>
<span class="lineno">215</span><br>
<span class="lineno"></span><span class="keyword" id="6943752">func</span>&nbsp;<span class="ident" id="6943757">TestImportCmd</span><span class="op" id="6943770">(</span><span class="ident" id="6943771">t</span>&nbsp;<span class="op" id="6943773">*</span><span class="ident" id="6943774">testing</span><span class="op" id="6943781">.</span><span class="ident" id="6943782">T</span><span class="op" id="6943783">)</span>&nbsp;<span class="op" id="6943785">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6943788">p</span><span class="op" id="6943789">,</span>&nbsp;<span class="ident" id="6943791">err</span>&nbsp;<span class="op" id="6943795">:=</span>&nbsp;<span class="ident" id="6943798">Import</span><span class="op" id="6943804">(</span><span class="string" id="6943805">&#34;cmd/internal/objfile&#34;</span><span class="op" id="6943827">,</span>&nbsp;<span class="string" id="6943829">&#34;&#34;</span><span class="op" id="6943831">,</span>&nbsp;<span class="num" id="6943833">0</span><span class="op" id="6943834">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6943837">if</span>&nbsp;<span class="ident" id="6943840">err</span>&nbsp;<span class="op" id="6943844">!=</span>&nbsp;<span class="ident" id="6943847">nil</span>&nbsp;<span class="op" id="6943851">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6943855">t</span><span class="op" id="6943856">.</span><span class="ident" id="6943857">Fatal</span><span class="op" id="6943862">(</span><span class="ident" id="6943863">err</span><span class="op" id="6943866">)</span><br>
<span class="lineno">220</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6943869">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="6943872">if</span>&nbsp;<span class="op" id="6943875">!</span><span class="ident" id="6943876">strings</span><span class="op" id="6943883">.</span><span class="ident" id="6943884">HasSuffix</span><span class="op" id="6943893">(</span><span class="ident" id="6943894">filepath</span><span class="op" id="6943902">.</span><span class="ident" id="6943903">ToSlash</span><span class="op" id="6943910">(</span><span class="ident" id="6943911">p</span><span class="op" id="6943912">.</span><span class="ident" id="6943913">Dir</span><span class="op" id="6943916">)</span><span class="op" id="6943917">,</span>&nbsp;<span class="string" id="6943919">&#34;src/cmd/internal/objfile&#34;</span><span class="op" id="6943945">)</span>&nbsp;<span class="op" id="6943947">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="6943951">t</span><span class="op" id="6943952">.</span><span class="ident" id="6943953">Fatalf</span><span class="op" id="6943959">(</span><span class="string" id="6943960">&#34;Import&nbsp;cmd/internal/objfile&nbsp;returned&nbsp;Dir=%q,&nbsp;want&nbsp;%q&#34;</span><span class="op" id="6944014">,</span>&nbsp;<span class="ident" id="6944016">filepath</span><span class="op" id="6944024">.</span><span class="ident" id="6944025">ToSlash</span><span class="op" id="6944032">(</span><span class="ident" id="6944033">p</span><span class="op" id="6944034">.</span><span class="ident" id="6944035">Dir</span><span class="op" id="6944038">)</span><span class="op" id="6944039">,</span>&nbsp;<span class="string" id="6944041">&#34;.../src/cmd/internal/objfile&#34;</span><span class="op" id="6944071">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="6944074">}</span><br>
<span class="lineno"></span><span class="op" id="6944076">}</span>
</div>
</body>
</html>
