<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>testing/iotest</h2>
<ul>
<li><a href="/gostd/testing/iotest/logger.go.html">logger.go</a></li>
<li><a href="/gostd/testing/iotest/reader.go.html">reader.go</a></li>
<li><a href="/gostd/testing/iotest/writer.go.html">writer.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="comment" id="5869930">//&nbsp;Copyright&nbsp;2009&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="5869985">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="5870039">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="comment" id="5870090">//&nbsp;Package&nbsp;iotest&nbsp;implements&nbsp;Readers&nbsp;and&nbsp;Writers&nbsp;useful&nbsp;mainly&nbsp;for&nbsp;testing.</span><br>
<span class="lineno"></span><span class="keyword" id="5870166">package</span>&nbsp;<span class="ident" id="5870174">iotest</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5870182">import</span>&nbsp;<span class="op" id="5870189">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5870192">&#34;errors&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="5870202">&#34;io&#34;</span><br>
<span class="lineno"></span><span class="op" id="5870207">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5870210">//&nbsp;OneByteReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements</span><br>
<span class="lineno"></span><span class="comment" id="5870260">//&nbsp;each&nbsp;non-empty&nbsp;Read&nbsp;by&nbsp;reading&nbsp;one&nbsp;byte&nbsp;from&nbsp;r.</span><br>
<span class="lineno">15</span><span class="keyword" id="5870311">func</span>&nbsp;<span class="ident" id="5870316">OneByteReader</span><span class="op" id="5870329">(</span><span class="ident" id="5870330">r</span>&nbsp;<span class="ident" id="5870332">io</span><span class="op" id="5870334">.</span><span class="ident" id="5870335">Reader</span><span class="op" id="5870341">)</span>&nbsp;<span class="ident" id="5870343">io</span><span class="op" id="5870345">.</span><span class="ident" id="5870346">Reader</span>&nbsp;<span class="op" id="5870353">{</span>&nbsp;<span class="keyword" id="5870355">return</span>&nbsp;<span class="op" id="5870362">&amp;</span><span class="ident" id="5870363">oneByteReader</span><span class="op" id="5870376">{</span><span class="ident" id="5870377">r</span><span class="op" id="5870378">}</span>&nbsp;<span class="op" id="5870380">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5870383">type</span>&nbsp;<span class="ident" id="5870388">oneByteReader</span>&nbsp;<span class="keyword" id="5870402">struct</span>&nbsp;<span class="op" id="5870409">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870412">r</span>&nbsp;<span class="ident" id="5870414">io</span><span class="op" id="5870416">.</span><span class="ident" id="5870417">Reader</span><br>
<span class="lineno"></span><span class="op" id="5870424">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span><span class="keyword" id="5870427">func</span>&nbsp;<span class="op" id="5870432">(</span><span class="ident" id="5870433">r</span>&nbsp;<span class="op" id="5870435">*</span><span class="ident" id="5870436">oneByteReader</span><span class="op" id="5870449">)</span>&nbsp;<span class="ident" id="5870451">Read</span><span class="op" id="5870455">(</span><span class="ident" id="5870456">p</span>&nbsp;<span class="op" id="5870458">[</span><span class="op" id="5870459">]</span><span class="builtintype" id="5870460">byte</span><span class="op" id="5870464">)</span>&nbsp;<span class="op" id="5870466">(</span><span class="builtintype" id="5870467">int</span><span class="op" id="5870470">,</span>&nbsp;<span class="builtintype" id="5870472">error</span><span class="op" id="5870477">)</span>&nbsp;<span class="op" id="5870479">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870482">if</span>&nbsp;<span class="builtinfunc" id="5870485">len</span><span class="op" id="5870488">(</span><span class="ident" id="5870489">p</span><span class="op" id="5870490">)</span>&nbsp;<span class="op" id="5870492">==</span>&nbsp;<span class="num" id="5870495">0</span>&nbsp;<span class="op" id="5870497">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870501">return</span>&nbsp;<span class="num" id="5870508">0</span><span class="op" id="5870509">,</span>&nbsp;<span class="ident" id="5870511">nil</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5870516">}</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870519">return</span>&nbsp;<span class="ident" id="5870526">r</span><span class="op" id="5870527">.</span><span class="ident" id="5870528">r</span><span class="op" id="5870529">.</span><span class="ident" id="5870530">Read</span><span class="op" id="5870534">(</span><span class="ident" id="5870535">p</span><span class="op" id="5870536">[</span><span class="num" id="5870537">0</span><span class="op" id="5870538">:</span><span class="num" id="5870539">1</span><span class="op" id="5870540">]</span><span class="op" id="5870541">)</span><br>
<span class="lineno"></span><span class="op" id="5870543">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5870546">//&nbsp;HalfReader&nbsp;returns&nbsp;a&nbsp;Reader&nbsp;that&nbsp;implements&nbsp;Read</span><br>
<span class="lineno"></span><span class="comment" id="5870598">//&nbsp;by&nbsp;reading&nbsp;half&nbsp;as&nbsp;many&nbsp;requested&nbsp;bytes&nbsp;from&nbsp;r.</span><br>
<span class="lineno">30</span><span class="keyword" id="5870649">func</span>&nbsp;<span class="ident" id="5870654">HalfReader</span><span class="op" id="5870664">(</span><span class="ident" id="5870665">r</span>&nbsp;<span class="ident" id="5870667">io</span><span class="op" id="5870669">.</span><span class="ident" id="5870670">Reader</span><span class="op" id="5870676">)</span>&nbsp;<span class="ident" id="5870678">io</span><span class="op" id="5870680">.</span><span class="ident" id="5870681">Reader</span>&nbsp;<span class="op" id="5870688">{</span>&nbsp;<span class="keyword" id="5870690">return</span>&nbsp;<span class="op" id="5870697">&amp;</span><span class="ident" id="5870698">halfReader</span><span class="op" id="5870708">{</span><span class="ident" id="5870709">r</span><span class="op" id="5870710">}</span>&nbsp;<span class="op" id="5870712">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5870715">type</span>&nbsp;<span class="ident" id="5870720">halfReader</span>&nbsp;<span class="keyword" id="5870731">struct</span>&nbsp;<span class="op" id="5870738">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5870741">r</span>&nbsp;<span class="ident" id="5870743">io</span><span class="op" id="5870745">.</span><span class="ident" id="5870746">Reader</span><br>
<span class="lineno"></span><span class="op" id="5870753">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span><span class="keyword" id="5870756">func</span>&nbsp;<span class="op" id="5870761">(</span><span class="ident" id="5870762">r</span>&nbsp;<span class="op" id="5870764">*</span><span class="ident" id="5870765">halfReader</span><span class="op" id="5870775">)</span>&nbsp;<span class="ident" id="5870777">Read</span><span class="op" id="5870781">(</span><span class="ident" id="5870782">p</span>&nbsp;<span class="op" id="5870784">[</span><span class="op" id="5870785">]</span><span class="builtintype" id="5870786">byte</span><span class="op" id="5870790">)</span>&nbsp;<span class="op" id="5870792">(</span><span class="builtintype" id="5870793">int</span><span class="op" id="5870796">,</span>&nbsp;<span class="builtintype" id="5870798">error</span><span class="op" id="5870803">)</span>&nbsp;<span class="op" id="5870805">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5870808">return</span>&nbsp;<span class="ident" id="5870815">r</span><span class="op" id="5870816">.</span><span class="ident" id="5870817">r</span><span class="op" id="5870818">.</span><span class="ident" id="5870819">Read</span><span class="op" id="5870823">(</span><span class="ident" id="5870824">p</span><span class="op" id="5870825">[</span><span class="num" id="5870826">0</span>&nbsp;<span class="op" id="5870828">:</span>&nbsp;<span class="op" id="5870830">(</span><span class="builtinfunc" id="5870831">len</span><span class="op" id="5870834">(</span><span class="ident" id="5870835">p</span><span class="op" id="5870836">)</span><span class="op" id="5870837">+</span><span class="num" id="5870838">1</span><span class="op" id="5870839">)</span><span class="op" id="5870840">/</span><span class="num" id="5870841">2</span><span class="op" id="5870842">]</span><span class="op" id="5870843">)</span><br>
<span class="lineno"></span><span class="op" id="5870845">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span><span class="comment" id="5870848">//&nbsp;DataErrReader&nbsp;changes&nbsp;the&nbsp;way&nbsp;errors&nbsp;are&nbsp;handled&nbsp;by&nbsp;a&nbsp;Reader.&nbsp;Normally,&nbsp;a</span><br>
<span class="lineno"></span><span class="comment" id="5870925">//&nbsp;Reader&nbsp;returns&nbsp;an&nbsp;error&nbsp;(typically&nbsp;EOF)&nbsp;from&nbsp;the&nbsp;first&nbsp;Read&nbsp;call&nbsp;after&nbsp;the</span><br>
<span class="lineno"></span><span class="comment" id="5871003">//&nbsp;last&nbsp;piece&nbsp;of&nbsp;data&nbsp;is&nbsp;read.&nbsp;DataErrReader&nbsp;wraps&nbsp;a&nbsp;Reader&nbsp;and&nbsp;changes&nbsp;its</span><br>
<span class="lineno"></span><span class="comment" id="5871079">//&nbsp;behavior&nbsp;so&nbsp;the&nbsp;final&nbsp;error&nbsp;is&nbsp;returned&nbsp;along&nbsp;with&nbsp;the&nbsp;final&nbsp;data,&nbsp;instead</span><br>
<span class="lineno"></span><span class="comment" id="5871157">//&nbsp;of&nbsp;in&nbsp;the&nbsp;first&nbsp;call&nbsp;after&nbsp;the&nbsp;final&nbsp;data.</span><br>
<span class="lineno">45</span><span class="keyword" id="5871203">func</span>&nbsp;<span class="ident" id="5871208">DataErrReader</span><span class="op" id="5871221">(</span><span class="ident" id="5871222">r</span>&nbsp;<span class="ident" id="5871224">io</span><span class="op" id="5871226">.</span><span class="ident" id="5871227">Reader</span><span class="op" id="5871233">)</span>&nbsp;<span class="ident" id="5871235">io</span><span class="op" id="5871237">.</span><span class="ident" id="5871238">Reader</span>&nbsp;<span class="op" id="5871245">{</span>&nbsp;<span class="keyword" id="5871247">return</span>&nbsp;<span class="op" id="5871254">&amp;</span><span class="ident" id="5871255">dataErrReader</span><span class="op" id="5871268">{</span><span class="ident" id="5871269">r</span><span class="op" id="5871270">,</span>&nbsp;<span class="ident" id="5871272">nil</span><span class="op" id="5871275">,</span>&nbsp;<span class="builtinfunc" id="5871277">make</span><span class="op" id="5871281">(</span><span class="op" id="5871282">[</span><span class="op" id="5871283">]</span><span class="builtintype" id="5871284">byte</span><span class="op" id="5871288">,</span>&nbsp;<span class="num" id="5871290">1024</span><span class="op" id="5871294">)</span><span class="op" id="5871295">}</span>&nbsp;<span class="op" id="5871297">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5871300">type</span>&nbsp;<span class="ident" id="5871305">dataErrReader</span>&nbsp;<span class="keyword" id="5871319">struct</span>&nbsp;<span class="op" id="5871326">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871329">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5871336">io</span><span class="op" id="5871338">.</span><span class="ident" id="5871339">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871347">unread</span>&nbsp;<span class="op" id="5871354">[</span><span class="op" id="5871355">]</span><span class="builtintype" id="5871356">byte</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871362">data</span>&nbsp;&nbsp;&nbsp;<span class="op" id="5871369">[</span><span class="op" id="5871370">]</span><span class="builtintype" id="5871371">byte</span><br>
<span class="lineno"></span><span class="op" id="5871376">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5871379">func</span>&nbsp;<span class="op" id="5871384">(</span><span class="ident" id="5871385">r</span>&nbsp;<span class="op" id="5871387">*</span><span class="ident" id="5871388">dataErrReader</span><span class="op" id="5871401">)</span>&nbsp;<span class="ident" id="5871403">Read</span><span class="op" id="5871407">(</span><span class="ident" id="5871408">p</span>&nbsp;<span class="op" id="5871410">[</span><span class="op" id="5871411">]</span><span class="builtintype" id="5871412">byte</span><span class="op" id="5871416">)</span>&nbsp;<span class="op" id="5871418">(</span><span class="ident" id="5871419">n</span>&nbsp;<span class="builtintype" id="5871421">int</span><span class="op" id="5871424">,</span>&nbsp;<span class="ident" id="5871426">err</span>&nbsp;<span class="builtintype" id="5871430">error</span><span class="op" id="5871435">)</span>&nbsp;<span class="op" id="5871437">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5871440">//&nbsp;loop&nbsp;because&nbsp;first&nbsp;call&nbsp;needs&nbsp;two&nbsp;reads:</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="5871485">//&nbsp;one&nbsp;to&nbsp;get&nbsp;data&nbsp;and&nbsp;a&nbsp;second&nbsp;to&nbsp;look&nbsp;for&nbsp;an&nbsp;error.</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871540">for</span>&nbsp;<span class="op" id="5871544">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871548">if</span>&nbsp;<span class="builtinfunc" id="5871551">len</span><span class="op" id="5871554">(</span><span class="ident" id="5871555">r</span><span class="op" id="5871556">.</span><span class="ident" id="5871557">unread</span><span class="op" id="5871563">)</span>&nbsp;<span class="op" id="5871565">==</span>&nbsp;<span class="num" id="5871568">0</span>&nbsp;<span class="op" id="5871570">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871575">n1</span><span class="op" id="5871577">,</span>&nbsp;<span class="ident" id="5871579">err1</span>&nbsp;<span class="op" id="5871584">:=</span>&nbsp;<span class="ident" id="5871587">r</span><span class="op" id="5871588">.</span><span class="ident" id="5871589">r</span><span class="op" id="5871590">.</span><span class="ident" id="5871591">Read</span><span class="op" id="5871595">(</span><span class="ident" id="5871596">r</span><span class="op" id="5871597">.</span><span class="ident" id="5871598">data</span><span class="op" id="5871602">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871607">r</span><span class="op" id="5871608">.</span><span class="ident" id="5871609">unread</span>&nbsp;<span class="op" id="5871616">=</span>&nbsp;<span class="ident" id="5871618">r</span><span class="op" id="5871619">.</span><span class="ident" id="5871620">data</span><span class="op" id="5871624">[</span><span class="num" id="5871625">0</span><span class="op" id="5871626">:</span><span class="ident" id="5871627">n1</span><span class="op" id="5871629">]</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871634">err</span>&nbsp;<span class="op" id="5871638">=</span>&nbsp;<span class="ident" id="5871640">err1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871647">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871651">if</span>&nbsp;<span class="ident" id="5871654">n</span>&nbsp;<span class="op" id="5871656">&gt;</span>&nbsp;<span class="num" id="5871658">0</span>&nbsp;<span class="op" id="5871660">||</span>&nbsp;<span class="ident" id="5871663">err</span>&nbsp;<span class="op" id="5871667">!=</span>&nbsp;<span class="ident" id="5871670">nil</span>&nbsp;<span class="op" id="5871674">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871679">break</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871687">}</span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871691">n</span>&nbsp;<span class="op" id="5871693">=</span>&nbsp;<span class="builtinfunc" id="5871695">copy</span><span class="op" id="5871699">(</span><span class="ident" id="5871700">p</span><span class="op" id="5871701">,</span>&nbsp;<span class="ident" id="5871703">r</span><span class="op" id="5871704">.</span><span class="ident" id="5871705">unread</span><span class="op" id="5871711">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5871715">r</span><span class="op" id="5871716">.</span><span class="ident" id="5871717">unread</span>&nbsp;<span class="op" id="5871724">=</span>&nbsp;<span class="ident" id="5871726">r</span><span class="op" id="5871727">.</span><span class="ident" id="5871728">unread</span><span class="op" id="5871734">[</span><span class="ident" id="5871735">n</span><span class="op" id="5871736">:</span><span class="op" id="5871737">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5871740">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5871743">return</span><br>
<span class="lineno"></span><span class="op" id="5871750">}</span><br>
<span class="lineno">70</span><br>
<span class="lineno"></span><span class="keyword" id="5871753">var</span>&nbsp;<span class="ident" id="5871757">ErrTimeout</span>&nbsp;<span class="op" id="5871768">=</span>&nbsp;<span class="ident" id="5871770">errors</span><span class="op" id="5871776">.</span><span class="ident" id="5871777">New</span><span class="op" id="5871780">(</span><span class="string" id="5871781">&#34;timeout&#34;</span><span class="op" id="5871790">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="comment" id="5871793">//&nbsp;TimeoutReader&nbsp;returns&nbsp;ErrTimeout&nbsp;on&nbsp;the&nbsp;second&nbsp;read</span><br>
<span class="lineno"></span><span class="comment" id="5871848">//&nbsp;with&nbsp;no&nbsp;data.&nbsp;&nbsp;Subsequent&nbsp;calls&nbsp;to&nbsp;read&nbsp;succeed.</span><br>
<span class="lineno">75</span><span class="keyword" id="5871900">func</span>&nbsp;<span class="ident" id="5871905">TimeoutReader</span><span class="op" id="5871918">(</span><span class="ident" id="5871919">r</span>&nbsp;<span class="ident" id="5871921">io</span><span class="op" id="5871923">.</span><span class="ident" id="5871924">Reader</span><span class="op" id="5871930">)</span>&nbsp;<span class="ident" id="5871932">io</span><span class="op" id="5871934">.</span><span class="ident" id="5871935">Reader</span>&nbsp;<span class="op" id="5871942">{</span>&nbsp;<span class="keyword" id="5871944">return</span>&nbsp;<span class="op" id="5871951">&amp;</span><span class="ident" id="5871952">timeoutReader</span><span class="op" id="5871965">{</span><span class="ident" id="5871966">r</span><span class="op" id="5871967">,</span>&nbsp;<span class="num" id="5871969">0</span><span class="op" id="5871970">}</span>&nbsp;<span class="op" id="5871972">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5871975">type</span>&nbsp;<span class="ident" id="5871980">timeoutReader</span>&nbsp;<span class="keyword" id="5871994">struct</span>&nbsp;<span class="op" id="5872001">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872004">r</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="ident" id="5872010">io</span><span class="op" id="5872012">.</span><span class="ident" id="5872013">Reader</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872021">count</span>&nbsp;<span class="builtintype" id="5872027">int</span><br>
<span class="lineno">80</span><span class="op" id="5872031">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="5872034">func</span>&nbsp;<span class="op" id="5872039">(</span><span class="ident" id="5872040">r</span>&nbsp;<span class="op" id="5872042">*</span><span class="ident" id="5872043">timeoutReader</span><span class="op" id="5872056">)</span>&nbsp;<span class="ident" id="5872058">Read</span><span class="op" id="5872062">(</span><span class="ident" id="5872063">p</span>&nbsp;<span class="op" id="5872065">[</span><span class="op" id="5872066">]</span><span class="builtintype" id="5872067">byte</span><span class="op" id="5872071">)</span>&nbsp;<span class="op" id="5872073">(</span><span class="builtintype" id="5872074">int</span><span class="op" id="5872077">,</span>&nbsp;<span class="builtintype" id="5872079">error</span><span class="op" id="5872084">)</span>&nbsp;<span class="op" id="5872086">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="5872089">r</span><span class="op" id="5872090">.</span><span class="ident" id="5872091">count</span><span class="op" id="5872096">++</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872100">if</span>&nbsp;<span class="ident" id="5872103">r</span><span class="op" id="5872104">.</span><span class="ident" id="5872105">count</span>&nbsp;<span class="op" id="5872111">==</span>&nbsp;<span class="num" id="5872114">2</span>&nbsp;<span class="op" id="5872116">{</span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872120">return</span>&nbsp;<span class="num" id="5872127">0</span><span class="op" id="5872128">,</span>&nbsp;<span class="ident" id="5872130">ErrTimeout</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="5872142">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="5872145">return</span>&nbsp;<span class="ident" id="5872152">r</span><span class="op" id="5872153">.</span><span class="ident" id="5872154">r</span><span class="op" id="5872155">.</span><span class="ident" id="5872156">Read</span><span class="op" id="5872160">(</span><span class="ident" id="5872161">p</span><span class="op" id="5872162">)</span><br>
<span class="lineno"></span><span class="op" id="5872164">}</span>
</div>
</body>
</html>
