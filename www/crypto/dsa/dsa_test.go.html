<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="code">
<span class="lineno">1</span><span class="comment" id="8401969">//&nbsp;Copyright&nbsp;2011&nbsp;The&nbsp;Go&nbsp;Authors.&nbsp;All&nbsp;rights&nbsp;reserved.</span><br>
<span class="lineno"></span><span class="comment" id="8402024">//&nbsp;Use&nbsp;of&nbsp;this&nbsp;source&nbsp;code&nbsp;is&nbsp;governed&nbsp;by&nbsp;a&nbsp;BSD-style</span><br>
<span class="lineno"></span><span class="comment" id="8402078">//&nbsp;license&nbsp;that&nbsp;can&nbsp;be&nbsp;found&nbsp;in&nbsp;the&nbsp;LICENSE&nbsp;file.</span><br>
<span class="lineno"></span><br>
<span class="lineno">5</span><span class="keyword" id="8402129">package</span>&nbsp;<span class="ident" id="8402137">dsa</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8402142">import</span>&nbsp;<span class="op" id="8402149">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8402152">&#34;crypto/rand&#34;</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8402167">&#34;math/big&#34;</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="8402179">&#34;testing&#34;</span><br>
<span class="lineno"></span><span class="op" id="8402189">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="8402192">func</span>&nbsp;<span class="ident" id="8402197">testSignAndVerify</span><span class="op" id="8402214">(</span><span class="ident" id="8402215">t</span>&nbsp;<span class="op" id="8402217">*</span><span class="ident" id="8402218"><a href="/crypto/dsa/dsa_test.go.html#8402179">testing</a></span><span class="op" id="8402225">.</span><span class="ident" id="8402226">T</span><span class="op" id="8402227">,</span>&nbsp;<span class="ident" id="8402229">i</span>&nbsp;<span class="builtintype" id="8402231">int</span><span class="op" id="8402234">,</span>&nbsp;<span class="ident" id="8402236">priv</span>&nbsp;<span class="op" id="8402241">*</span><span class="ident" id="8402242"><a href="/crypto/dsa/dsa.go.html#4512819">PrivateKey</a></span><span class="op" id="8402252">)</span>&nbsp;<span class="op" id="8402254">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402257">hashed</span>&nbsp;<span class="op" id="8402264">:=</span>&nbsp;<span class="op" id="8402267">[</span><span class="op" id="8402268">]</span><span class="builtintype" id="8402269">byte</span><span class="op" id="8402273">(</span><span class="string" id="8402274">&#34;testing&#34;</span><span class="op" id="8402283">)</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402286">r</span><span class="op" id="8402287">,</span>&nbsp;<span class="ident" id="8402289">s</span><span class="op" id="8402290">,</span>&nbsp;<span class="ident" id="8402292">err</span>&nbsp;<span class="op" id="8402296">:=</span>&nbsp;<span class="ident" id="8402299"><a href="/crypto/dsa/dsa.go.html#4516824">Sign</a></span><span class="op" id="8402303">(</span><span class="ident" id="8402304"><a href="/crypto/dsa/dsa_test.go.html#8402152">rand</a></span><span class="op" id="8402308">.</span><span class="ident" id="8402309">Reader</span><span class="op" id="8402315">,</span>&nbsp;<span class="ident" id="8402317"><a href="/crypto/dsa/dsa_test.go.html#8402236">priv</a></span><span class="op" id="8402321">,</span>&nbsp;<span class="ident" id="8402323"><a href="/crypto/dsa/dsa_test.go.html#8402257">hashed</a></span><span class="op" id="8402329">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8402332">if</span>&nbsp;<span class="ident" id="8402335"><a href="/crypto/dsa/dsa_test.go.html#8402292">err</a></span>&nbsp;<span class="op" id="8402339">!=</span>&nbsp;<span class="ident" id="8402342">nil</span>&nbsp;<span class="op" id="8402346">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402350"><a href="/crypto/dsa/dsa_test.go.html#8402215">t</a></span><span class="op" id="8402351">.</span><span class="ident" id="8402352">Errorf</span><span class="op" id="8402358">(</span><span class="string" id="8402359">&#34;%d:&nbsp;error&nbsp;signing:&nbsp;%s&#34;</span><span class="op" id="8402382">,</span>&nbsp;<span class="ident" id="8402384"><a href="/crypto/dsa/dsa_test.go.html#8402229">i</a></span><span class="op" id="8402385">,</span>&nbsp;<span class="ident" id="8402387"><a href="/crypto/dsa/dsa_test.go.html#8402292">err</a></span><span class="op" id="8402390">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8402394">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8402402">}</span><br>
<span class="lineno">20</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8402406">if</span>&nbsp;<span class="op" id="8402409">!</span><span class="ident" id="8402410"><a href="/crypto/dsa/dsa.go.html#4517853">Verify</a></span><span class="op" id="8402416">(</span><span class="op" id="8402417">&amp;</span><span class="ident" id="8402418"><a href="/crypto/dsa/dsa_test.go.html#8402236">priv</a></span><span class="op" id="8402422">.</span><span class="ident" id="8402423">PublicKey</span><span class="op" id="8402432">,</span>&nbsp;<span class="ident" id="8402434"><a href="/crypto/dsa/dsa_test.go.html#8402257">hashed</a></span><span class="op" id="8402440">,</span>&nbsp;<span class="ident" id="8402442"><a href="/crypto/dsa/dsa_test.go.html#8402286">r</a></span><span class="op" id="8402443">,</span>&nbsp;<span class="ident" id="8402445"><a href="/crypto/dsa/dsa_test.go.html#8402289">s</a></span><span class="op" id="8402446">)</span>&nbsp;<span class="op" id="8402448">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402452"><a href="/crypto/dsa/dsa_test.go.html#8402215">t</a></span><span class="op" id="8402453">.</span><span class="ident" id="8402454">Errorf</span><span class="op" id="8402460">(</span><span class="string" id="8402461">&#34;%d:&nbsp;Verify&nbsp;failed&#34;</span><span class="op" id="8402480">,</span>&nbsp;<span class="ident" id="8402482"><a href="/crypto/dsa/dsa_test.go.html#8402229">i</a></span><span class="op" id="8402483">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8402486">}</span><br>
<span class="lineno"></span><span class="op" id="8402488">}</span><br>
<span class="lineno">25</span><br>
<span class="lineno"></span><span class="keyword" id="8402491">func</span>&nbsp;<span class="ident" id="8402496">testParameterGeneration</span><span class="op" id="8402519">(</span><span class="ident" id="8402520">t</span>&nbsp;<span class="op" id="8402522">*</span><span class="ident" id="8402523"><a href="/crypto/dsa/dsa_test.go.html#8402179">testing</a></span><span class="op" id="8402530">.</span><span class="ident" id="8402531">T</span><span class="op" id="8402532">,</span>&nbsp;<span class="ident" id="8402534">sizes</span>&nbsp;<span class="ident" id="8402540"><a href="/crypto/dsa/dsa.go.html#4513344">ParameterSizes</a></span><span class="op" id="8402554">,</span>&nbsp;<span class="ident" id="8402556">L</span><span class="op" id="8402557">,</span>&nbsp;<span class="ident" id="8402559">N</span>&nbsp;<span class="builtintype" id="8402561">int</span><span class="op" id="8402564">)</span>&nbsp;<span class="op" id="8402566">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8402569">var</span>&nbsp;<span class="ident" id="8402573">priv</span>&nbsp;<span class="ident" id="8402578"><a href="/crypto/dsa/dsa.go.html#4512819">PrivateKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402590">params</span>&nbsp;<span class="op" id="8402597">:=</span>&nbsp;<span class="op" id="8402600">&amp;</span><span class="ident" id="8402601"><a href="/crypto/dsa/dsa_test.go.html#8402573">priv</a></span><span class="op" id="8402605">.</span><span class="ident" id="8402606">Parameters</span><br>
<span class="lineno"></span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402619">err</span>&nbsp;<span class="op" id="8402623">:=</span>&nbsp;<span class="ident" id="8402626"><a href="/crypto/dsa/dsa.go.html#4513756">GenerateParameters</a></span><span class="op" id="8402644">(</span><span class="ident" id="8402645"><a href="/crypto/dsa/dsa_test.go.html#8402590">params</a></span><span class="op" id="8402651">,</span>&nbsp;<span class="ident" id="8402653"><a href="/crypto/dsa/dsa_test.go.html#8402152">rand</a></span><span class="op" id="8402657">.</span><span class="ident" id="8402658">Reader</span><span class="op" id="8402664">,</span>&nbsp;<span class="ident" id="8402666"><a href="/crypto/dsa/dsa_test.go.html#8402534">sizes</a></span><span class="op" id="8402671">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8402674">if</span>&nbsp;<span class="ident" id="8402677"><a href="/crypto/dsa/dsa_test.go.html#8402619">err</a></span>&nbsp;<span class="op" id="8402681">!=</span>&nbsp;<span class="ident" id="8402684">nil</span>&nbsp;<span class="op" id="8402688">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402692"><a href="/crypto/dsa/dsa_test.go.html#8402520">t</a></span><span class="op" id="8402693">.</span><span class="ident" id="8402694">Errorf</span><span class="op" id="8402700">(</span><span class="string" id="8402701">&#34;%d:&nbsp;%s&#34;</span><span class="op" id="8402709">,</span>&nbsp;<span class="builtintype" id="8402711">int</span><span class="op" id="8402714">(</span><span class="ident" id="8402715"><a href="/crypto/dsa/dsa_test.go.html#8402534">sizes</a></span><span class="op" id="8402720">)</span><span class="op" id="8402721">,</span>&nbsp;<span class="ident" id="8402723"><a href="/crypto/dsa/dsa_test.go.html#8402619">err</a></span><span class="op" id="8402726">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8402730">return</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8402738">}</span><br>
<span class="lineno">35</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8402742">if</span>&nbsp;<span class="ident" id="8402745"><a href="/crypto/dsa/dsa_test.go.html#8402590">params</a></span><span class="op" id="8402751">.</span><span class="ident" id="8402752">P</span><span class="op" id="8402753">.</span><span class="ident" id="8402754">BitLen</span><span class="op" id="8402760">(</span><span class="op" id="8402761">)</span>&nbsp;<span class="op" id="8402763">!=</span>&nbsp;<span class="ident" id="8402766"><a href="/crypto/dsa/dsa_test.go.html#8402556">L</a></span>&nbsp;<span class="op" id="8402768">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402772"><a href="/crypto/dsa/dsa_test.go.html#8402520">t</a></span><span class="op" id="8402773">.</span><span class="ident" id="8402774">Errorf</span><span class="op" id="8402780">(</span><span class="string" id="8402781">&#34;%d:&nbsp;params.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="8402815">,</span>&nbsp;<span class="builtintype" id="8402817">int</span><span class="op" id="8402820">(</span><span class="ident" id="8402821"><a href="/crypto/dsa/dsa_test.go.html#8402534">sizes</a></span><span class="op" id="8402826">)</span><span class="op" id="8402827">,</span>&nbsp;<span class="ident" id="8402829"><a href="/crypto/dsa/dsa_test.go.html#8402590">params</a></span><span class="op" id="8402835">.</span><span class="ident" id="8402836">P</span><span class="op" id="8402837">.</span><span class="ident" id="8402838">BitLen</span><span class="op" id="8402844">(</span><span class="op" id="8402845">)</span><span class="op" id="8402846">,</span>&nbsp;<span class="ident" id="8402848"><a href="/crypto/dsa/dsa_test.go.html#8402556">L</a></span><span class="op" id="8402849">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8402852">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8402856">if</span>&nbsp;<span class="ident" id="8402859"><a href="/crypto/dsa/dsa_test.go.html#8402590">params</a></span><span class="op" id="8402865">.</span><span class="ident" id="8402866">Q</span><span class="op" id="8402867">.</span><span class="ident" id="8402868">BitLen</span><span class="op" id="8402874">(</span><span class="op" id="8402875">)</span>&nbsp;<span class="op" id="8402877">!=</span>&nbsp;<span class="ident" id="8402880"><a href="/crypto/dsa/dsa_test.go.html#8402559">N</a></span>&nbsp;<span class="op" id="8402882">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402886"><a href="/crypto/dsa/dsa_test.go.html#8402520">t</a></span><span class="op" id="8402887">.</span><span class="ident" id="8402888">Errorf</span><span class="op" id="8402894">(</span><span class="string" id="8402895">&#34;%d:&nbsp;q.BitLen&nbsp;got:%d&nbsp;want:%d&#34;</span><span class="op" id="8402924">,</span>&nbsp;<span class="builtintype" id="8402926">int</span><span class="op" id="8402929">(</span><span class="ident" id="8402930"><a href="/crypto/dsa/dsa_test.go.html#8402534">sizes</a></span><span class="op" id="8402935">)</span><span class="op" id="8402936">,</span>&nbsp;<span class="ident" id="8402938"><a href="/crypto/dsa/dsa_test.go.html#8402590">params</a></span><span class="op" id="8402944">.</span><span class="ident" id="8402945">Q</span><span class="op" id="8402946">.</span><span class="ident" id="8402947">BitLen</span><span class="op" id="8402953">(</span><span class="op" id="8402954">)</span><span class="op" id="8402955">,</span>&nbsp;<span class="ident" id="8402957"><a href="/crypto/dsa/dsa_test.go.html#8402556">L</a></span><span class="op" id="8402958">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8402961">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402965">one</span>&nbsp;<span class="op" id="8402969">:=</span>&nbsp;<span class="builtinfunc" id="8402972">new</span><span class="op" id="8402975">(</span><span class="ident" id="8402976"><a href="/crypto/dsa/dsa_test.go.html#8402167">big</a></span><span class="op" id="8402979">.</span><span class="ident" id="8402980">Int</span><span class="op" id="8402983">)</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8402986"><a href="/crypto/dsa/dsa_test.go.html#8402965">one</a></span><span class="op" id="8402989">.</span><span class="ident" id="8402990">SetInt64</span><span class="op" id="8402998">(</span><span class="num" id="8402999">1</span><span class="op" id="8403000">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8403003">pm1</span>&nbsp;<span class="op" id="8403007">:=</span>&nbsp;<span class="builtinfunc" id="8403010">new</span><span class="op" id="8403013">(</span><span class="ident" id="8403014"><a href="/crypto/dsa/dsa_test.go.html#8402167">big</a></span><span class="op" id="8403017">.</span><span class="ident" id="8403018">Int</span><span class="op" id="8403021">)</span><span class="op" id="8403022">.</span><span class="ident" id="8403023">Sub</span><span class="op" id="8403026">(</span><span class="ident" id="8403027"><a href="/crypto/dsa/dsa_test.go.html#8402590">params</a></span><span class="op" id="8403033">.</span><span class="ident" id="8403034">P</span><span class="op" id="8403035">,</span>&nbsp;<span class="ident" id="8403037"><a href="/crypto/dsa/dsa_test.go.html#8402965">one</a></span><span class="op" id="8403040">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8403043">quo</span><span class="op" id="8403046">,</span>&nbsp;<span class="ident" id="8403048">rem</span>&nbsp;<span class="op" id="8403052">:=</span>&nbsp;<span class="builtinfunc" id="8403055">new</span><span class="op" id="8403058">(</span><span class="ident" id="8403059"><a href="/crypto/dsa/dsa_test.go.html#8402167">big</a></span><span class="op" id="8403062">.</span><span class="ident" id="8403063">Int</span><span class="op" id="8403066">)</span><span class="op" id="8403067">.</span><span class="ident" id="8403068">DivMod</span><span class="op" id="8403074">(</span><span class="ident" id="8403075"><a href="/crypto/dsa/dsa_test.go.html#8403003">pm1</a></span><span class="op" id="8403078">,</span>&nbsp;<span class="ident" id="8403080"><a href="/crypto/dsa/dsa_test.go.html#8402590">params</a></span><span class="op" id="8403086">.</span><span class="ident" id="8403087">Q</span><span class="op" id="8403088">,</span>&nbsp;<span class="builtinfunc" id="8403090">new</span><span class="op" id="8403093">(</span><span class="ident" id="8403094"><a href="/crypto/dsa/dsa_test.go.html#8402167">big</a></span><span class="op" id="8403097">.</span><span class="ident" id="8403098">Int</span><span class="op" id="8403101">)</span><span class="op" id="8403102">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8403105">if</span>&nbsp;<span class="ident" id="8403108"><a href="/crypto/dsa/dsa_test.go.html#8403048">rem</a></span><span class="op" id="8403111">.</span><span class="ident" id="8403112">Sign</span><span class="op" id="8403116">(</span><span class="op" id="8403117">)</span>&nbsp;<span class="op" id="8403119">!=</span>&nbsp;<span class="num" id="8403122">0</span>&nbsp;<span class="op" id="8403124">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8403128"><a href="/crypto/dsa/dsa_test.go.html#8402520">t</a></span><span class="op" id="8403129">.</span><span class="ident" id="8403130">Errorf</span><span class="op" id="8403136">(</span><span class="string" id="8403137">&#34;%d:&nbsp;p-1&nbsp;mod&nbsp;q&nbsp;!=&nbsp;0&#34;</span><span class="op" id="8403157">,</span>&nbsp;<span class="builtintype" id="8403159">int</span><span class="op" id="8403162">(</span><span class="ident" id="8403163"><a href="/crypto/dsa/dsa_test.go.html#8402534">sizes</a></span><span class="op" id="8403168">)</span><span class="op" id="8403169">)</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8403172">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8403175">x</span>&nbsp;<span class="op" id="8403177">:=</span>&nbsp;<span class="builtinfunc" id="8403180">new</span><span class="op" id="8403183">(</span><span class="ident" id="8403184"><a href="/crypto/dsa/dsa_test.go.html#8402167">big</a></span><span class="op" id="8403187">.</span><span class="ident" id="8403188">Int</span><span class="op" id="8403191">)</span><span class="op" id="8403192">.</span><span class="ident" id="8403193">Exp</span><span class="op" id="8403196">(</span><span class="ident" id="8403197"><a href="/crypto/dsa/dsa_test.go.html#8402590">params</a></span><span class="op" id="8403203">.</span><span class="ident" id="8403204">G</span><span class="op" id="8403205">,</span>&nbsp;<span class="ident" id="8403207"><a href="/crypto/dsa/dsa_test.go.html#8403043">quo</a></span><span class="op" id="8403210">,</span>&nbsp;<span class="ident" id="8403212"><a href="/crypto/dsa/dsa_test.go.html#8402590">params</a></span><span class="op" id="8403218">.</span><span class="ident" id="8403219">P</span><span class="op" id="8403220">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8403223">if</span>&nbsp;<span class="ident" id="8403226"><a href="/crypto/dsa/dsa_test.go.html#8403175">x</a></span><span class="op" id="8403227">.</span><span class="ident" id="8403228">Cmp</span><span class="op" id="8403231">(</span><span class="ident" id="8403232"><a href="/crypto/dsa/dsa_test.go.html#8402965">one</a></span><span class="op" id="8403235">)</span>&nbsp;<span class="op" id="8403237">==</span>&nbsp;<span class="num" id="8403240">0</span>&nbsp;<span class="op" id="8403242">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8403246"><a href="/crypto/dsa/dsa_test.go.html#8402520">t</a></span><span class="op" id="8403247">.</span><span class="ident" id="8403248">Errorf</span><span class="op" id="8403254">(</span><span class="string" id="8403255">&#34;%d:&nbsp;invalid&nbsp;generator&#34;</span><span class="op" id="8403278">,</span>&nbsp;<span class="builtintype" id="8403280">int</span><span class="op" id="8403283">(</span><span class="ident" id="8403284"><a href="/crypto/dsa/dsa_test.go.html#8402534">sizes</a></span><span class="op" id="8403289">)</span><span class="op" id="8403290">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8403293">}</span><br>
<span class="lineno">55</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8403297"><a href="/crypto/dsa/dsa_test.go.html#8402619">err</a></span>&nbsp;<span class="op" id="8403301">=</span>&nbsp;<span class="ident" id="8403303"><a href="/crypto/dsa/dsa.go.html#4515486">GenerateKey</a></span><span class="op" id="8403314">(</span><span class="op" id="8403315">&amp;</span><span class="ident" id="8403316"><a href="/crypto/dsa/dsa_test.go.html#8402573">priv</a></span><span class="op" id="8403320">,</span>&nbsp;<span class="ident" id="8403322"><a href="/crypto/dsa/dsa_test.go.html#8402152">rand</a></span><span class="op" id="8403326">.</span><span class="ident" id="8403327">Reader</span><span class="op" id="8403333">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8403336">if</span>&nbsp;<span class="ident" id="8403339"><a href="/crypto/dsa/dsa_test.go.html#8402619">err</a></span>&nbsp;<span class="op" id="8403343">!=</span>&nbsp;<span class="ident" id="8403346">nil</span>&nbsp;<span class="op" id="8403350">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8403354"><a href="/crypto/dsa/dsa_test.go.html#8402520">t</a></span><span class="op" id="8403355">.</span><span class="ident" id="8403356">Errorf</span><span class="op" id="8403362">(</span><span class="string" id="8403363">&#34;error&nbsp;generating&nbsp;key:&nbsp;%s&#34;</span><span class="op" id="8403389">,</span>&nbsp;<span class="ident" id="8403391"><a href="/crypto/dsa/dsa_test.go.html#8402619">err</a></span><span class="op" id="8403394">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8403398">return</span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8403406">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8403410"><a href="/crypto/dsa/dsa_test.go.html#8402197">testSignAndVerify</a></span><span class="op" id="8403427">(</span><span class="ident" id="8403428"><a href="/crypto/dsa/dsa_test.go.html#8402520">t</a></span><span class="op" id="8403429">,</span>&nbsp;<span class="builtintype" id="8403431">int</span><span class="op" id="8403434">(</span><span class="ident" id="8403435"><a href="/crypto/dsa/dsa_test.go.html#8402534">sizes</a></span><span class="op" id="8403440">)</span><span class="op" id="8403441">,</span>&nbsp;<span class="op" id="8403443">&amp;</span><span class="ident" id="8403444"><a href="/crypto/dsa/dsa_test.go.html#8402573">priv</a></span><span class="op" id="8403448">)</span><br>
<span class="lineno"></span><span class="op" id="8403450">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span><span class="keyword" id="8403453">func</span>&nbsp;<span class="ident" id="8403458">TestParameterGeneration</span><span class="op" id="8403481">(</span><span class="ident" id="8403482">t</span>&nbsp;<span class="op" id="8403484">*</span><span class="ident" id="8403485"><a href="/crypto/dsa/dsa_test.go.html#8402179">testing</a></span><span class="op" id="8403492">.</span><span class="ident" id="8403493">T</span><span class="op" id="8403494">)</span>&nbsp;<span class="op" id="8403496">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8403499">if</span>&nbsp;<span class="ident" id="8403502"><a href="/crypto/dsa/dsa_test.go.html#8402179">testing</a></span><span class="op" id="8403509">.</span><span class="ident" id="8403510">Short</span><span class="op" id="8403515">(</span><span class="op" id="8403516">)</span>&nbsp;<span class="op" id="8403518">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8403522"><a href="/crypto/dsa/dsa_test.go.html#8403482">t</a></span><span class="op" id="8403523">.</span><span class="ident" id="8403524">Skip</span><span class="op" id="8403528">(</span><span class="string" id="8403529">&#34;skipping&nbsp;parameter&nbsp;generation&nbsp;test&nbsp;in&nbsp;short&nbsp;mode&#34;</span><span class="op" id="8403579">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="8403582">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8403586"><a href="/crypto/dsa/dsa_test.go.html#8402496">testParameterGeneration</a></span><span class="op" id="8403609">(</span><span class="ident" id="8403610"><a href="/crypto/dsa/dsa_test.go.html#8403482">t</a></span><span class="op" id="8403611">,</span>&nbsp;<span class="ident" id="8403613"><a href="/crypto/dsa/dsa.go.html#4513373">L1024N160</a></span><span class="op" id="8403622">,</span>&nbsp;<span class="num" id="8403624">1024</span><span class="op" id="8403628">,</span>&nbsp;<span class="num" id="8403630">160</span><span class="op" id="8403633">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8403636"><a href="/crypto/dsa/dsa_test.go.html#8402496">testParameterGeneration</a></span><span class="op" id="8403659">(</span><span class="ident" id="8403660"><a href="/crypto/dsa/dsa_test.go.html#8403482">t</a></span><span class="op" id="8403661">,</span>&nbsp;<span class="ident" id="8403663"><a href="/crypto/dsa/dsa.go.html#4513406">L2048N224</a></span><span class="op" id="8403672">,</span>&nbsp;<span class="num" id="8403674">2048</span><span class="op" id="8403678">,</span>&nbsp;<span class="num" id="8403680">224</span><span class="op" id="8403683">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8403686"><a href="/crypto/dsa/dsa_test.go.html#8402496">testParameterGeneration</a></span><span class="op" id="8403709">(</span><span class="ident" id="8403710"><a href="/crypto/dsa/dsa_test.go.html#8403482">t</a></span><span class="op" id="8403711">,</span>&nbsp;<span class="ident" id="8403713"><a href="/crypto/dsa/dsa.go.html#4513417">L2048N256</a></span><span class="op" id="8403722">,</span>&nbsp;<span class="num" id="8403724">2048</span><span class="op" id="8403728">,</span>&nbsp;<span class="num" id="8403730">256</span><span class="op" id="8403733">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8403736"><a href="/crypto/dsa/dsa_test.go.html#8402496">testParameterGeneration</a></span><span class="op" id="8403759">(</span><span class="ident" id="8403760"><a href="/crypto/dsa/dsa_test.go.html#8403482">t</a></span><span class="op" id="8403761">,</span>&nbsp;<span class="ident" id="8403763"><a href="/crypto/dsa/dsa.go.html#4513428">L3072N256</a></span><span class="op" id="8403772">,</span>&nbsp;<span class="num" id="8403774">3072</span><span class="op" id="8403778">,</span>&nbsp;<span class="num" id="8403780">256</span><span class="op" id="8403783">)</span><br>
<span class="lineno"></span><span class="op" id="8403785">}</span><br>
<span class="lineno">75</span><br>
<span class="lineno"></span><span class="keyword" id="8403788">func</span>&nbsp;<span class="ident" id="8403793">TestSignAndVerify</span><span class="op" id="8403810">(</span><span class="ident" id="8403811">t</span>&nbsp;<span class="op" id="8403813">*</span><span class="ident" id="8403814"><a href="/crypto/dsa/dsa_test.go.html#8402179">testing</a></span><span class="op" id="8403821">.</span><span class="ident" id="8403822">T</span><span class="op" id="8403823">)</span>&nbsp;<span class="op" id="8403825">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="8403828">var</span>&nbsp;<span class="ident" id="8403832">priv</span>&nbsp;<span class="ident" id="8403837"><a href="/crypto/dsa/dsa.go.html#4512819">PrivateKey</a></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8403849"><a href="/crypto/dsa/dsa_test.go.html#8403832">priv</a></span><span class="op" id="8403853">.</span><span class="ident" id="8403854">P</span><span class="op" id="8403855">,</span>&nbsp;<span class="ident" id="8403857">_</span>&nbsp;<span class="op" id="8403859">=</span>&nbsp;<span class="builtinfunc" id="8403861">new</span><span class="op" id="8403864">(</span><span class="ident" id="8403865"><a href="/crypto/dsa/dsa_test.go.html#8402167">big</a></span><span class="op" id="8403868">.</span><span class="ident" id="8403869">Int</span><span class="op" id="8403872">)</span><span class="op" id="8403873">.</span><span class="ident" id="8403874">SetString</span><span class="op" id="8403883">(</span><span class="string" id="8403884">&#34;A9B5B793FB4785793D246BAE77E8FF63CA52F442DA763C440259919FE1BC1D6065A9350637A04F75A2F039401D49F08E066C4D275A5A65DA5684BC563C14289D7AB8A67163BFBF79D85972619AD2CFF55AB0EE77A9002B0EF96293BDD0F42685EBB2C66C327079F6C98000FBCB79AACDE1BC6F9D5C7B1A97E3D9D54ED7951FEF&#34;</span><span class="op" id="8404142">,</span>&nbsp;<span class="num" id="8404144">16</span><span class="op" id="8404146">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8404149"><a href="/crypto/dsa/dsa_test.go.html#8403832">priv</a></span><span class="op" id="8404153">.</span><span class="ident" id="8404154">Q</span><span class="op" id="8404155">,</span>&nbsp;<span class="ident" id="8404157">_</span>&nbsp;<span class="op" id="8404159">=</span>&nbsp;<span class="builtinfunc" id="8404161">new</span><span class="op" id="8404164">(</span><span class="ident" id="8404165"><a href="/crypto/dsa/dsa_test.go.html#8402167">big</a></span><span class="op" id="8404168">.</span><span class="ident" id="8404169">Int</span><span class="op" id="8404172">)</span><span class="op" id="8404173">.</span><span class="ident" id="8404174">SetString</span><span class="op" id="8404183">(</span><span class="string" id="8404184">&#34;E1D3391245933D68A0714ED34BBCB7A1F422B9C1&#34;</span><span class="op" id="8404226">,</span>&nbsp;<span class="num" id="8404228">16</span><span class="op" id="8404230">)</span><br>
<span class="lineno">80</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8404233"><a href="/crypto/dsa/dsa_test.go.html#8403832">priv</a></span><span class="op" id="8404237">.</span><span class="ident" id="8404238">G</span><span class="op" id="8404239">,</span>&nbsp;<span class="ident" id="8404241">_</span>&nbsp;<span class="op" id="8404243">=</span>&nbsp;<span class="builtinfunc" id="8404245">new</span><span class="op" id="8404248">(</span><span class="ident" id="8404249"><a href="/crypto/dsa/dsa_test.go.html#8402167">big</a></span><span class="op" id="8404252">.</span><span class="ident" id="8404253">Int</span><span class="op" id="8404256">)</span><span class="op" id="8404257">.</span><span class="ident" id="8404258">SetString</span><span class="op" id="8404267">(</span><span class="string" id="8404268">&#34;634364FC25248933D01D1993ECABD0657CC0CB2CEED7ED2E3E8AECDFCDC4A25C3B15E9E3B163ACA2984B5539181F3EFF1A5E8903D71D5B95DA4F27202B77D2C44B430BB53741A8D59A8F86887525C9F2A6A5980A195EAA7F2FF910064301DEF89D3AA213E1FAC7768D89365318E370AF54A112EFBA9246D9158386BA1B4EEFDA&#34;</span><span class="op" id="8404526">,</span>&nbsp;<span class="num" id="8404528">16</span><span class="op" id="8404530">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8404533"><a href="/crypto/dsa/dsa_test.go.html#8403832">priv</a></span><span class="op" id="8404537">.</span><span class="ident" id="8404538">Y</span><span class="op" id="8404539">,</span>&nbsp;<span class="ident" id="8404541">_</span>&nbsp;<span class="op" id="8404543">=</span>&nbsp;<span class="builtinfunc" id="8404545">new</span><span class="op" id="8404548">(</span><span class="ident" id="8404549"><a href="/crypto/dsa/dsa_test.go.html#8402167">big</a></span><span class="op" id="8404552">.</span><span class="ident" id="8404553">Int</span><span class="op" id="8404556">)</span><span class="op" id="8404557">.</span><span class="ident" id="8404558">SetString</span><span class="op" id="8404567">(</span><span class="string" id="8404568">&#34;32969E5780CFE1C849A1C276D7AEB4F38A23B591739AA2FE197349AEEBD31366AEE5EB7E6C6DDB7C57D02432B30DB5AA66D9884299FAA72568944E4EEDC92EA3FBC6F39F53412FBCC563208F7C15B737AC8910DBC2D9C9B8C001E72FDC40EB694AB1F06A5A2DBD18D9E36C66F31F566742F11EC0A52E9F7B89355C02FB5D32D2&#34;</span><span class="op" id="8404826">,</span>&nbsp;<span class="num" id="8404828">16</span><span class="op" id="8404830">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8404833"><a href="/crypto/dsa/dsa_test.go.html#8403832">priv</a></span><span class="op" id="8404837">.</span><span class="ident" id="8404838">X</span><span class="op" id="8404839">,</span>&nbsp;<span class="ident" id="8404841">_</span>&nbsp;<span class="op" id="8404843">=</span>&nbsp;<span class="builtinfunc" id="8404845">new</span><span class="op" id="8404848">(</span><span class="ident" id="8404849"><a href="/crypto/dsa/dsa_test.go.html#8402167">big</a></span><span class="op" id="8404852">.</span><span class="ident" id="8404853">Int</span><span class="op" id="8404856">)</span><span class="op" id="8404857">.</span><span class="ident" id="8404858">SetString</span><span class="op" id="8404867">(</span><span class="string" id="8404868">&#34;5078D4D29795CBE76D3AACFE48C9AF0BCDBEE91A&#34;</span><span class="op" id="8404910">,</span>&nbsp;<span class="num" id="8404912">16</span><span class="op" id="8404914">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="8404918"><a href="/crypto/dsa/dsa_test.go.html#8402197">testSignAndVerify</a></span><span class="op" id="8404935">(</span><span class="ident" id="8404936"><a href="/crypto/dsa/dsa_test.go.html#8403811">t</a></span><span class="op" id="8404937">,</span>&nbsp;<span class="num" id="8404939">0</span><span class="op" id="8404940">,</span>&nbsp;<span class="op" id="8404942">&amp;</span><span class="ident" id="8404943"><a href="/crypto/dsa/dsa_test.go.html#8403832">priv</a></span><span class="op" id="8404947">)</span><br>
<span class="lineno">85</span><span class="op" id="8404949">}</span>
</div>
</body>
</html>
