<!doctype html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Go standard library</title>
	<link rel="stylesheet" type="text/css" href="/style.css">
</head>

<body>

<div class="pkgnavi">
<h1><a href="/gostd/index.html">Go Standard Library</a></h1>
<h2>lonnie.io/e8vm/asm8</h2>
<ul>
<li><a href="/gostd/lonnie.io/e8vm/asm8/bare_func.go.html">bare_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_file.go.html">build_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_func.go.html">build_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_lib.go.html">build_lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/build_var.go.html">build_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/builder.go.html">builder.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/check_type.go.html">check_type.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_hex.go.html">data_hex.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_nums.go.html">data_nums.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/data_str.go.html">data_str.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/file.go.html">file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_decl.go.html">func_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/func_stmt.go.html">func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst.go.html">inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_all.go.html">inst_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_br.go.html">inst_br.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_imm.go.html">inst_imm.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_jmp.go.html">inst_jmp.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_reg.go.html">inst_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/inst_sys.go.html">inst_sys.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all.go.html">lex_all.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_all_test.go.html">lex_all_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_comment.go.html">lex_comment.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_operand.go.html">lex_operand.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lex_string.go.html">lex_string.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/lib.go.html">lib.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/package.go.html">package.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_arg.go.html">parse_arg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_file.go.html">parse_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func.go.html">parse_func.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_stmt.go.html">parse_func_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_func_test.go.html">parse_func_test.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_inst.go.html">parse_inst.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_label.go.html">parse_label.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_reg.go.html">parse_reg.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_sym.go.html">parse_sym.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var.go.html">parse_var.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parse_var_stmt.go.html">parse_var_stmt.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/parser.go.html">parser.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/single_file.go.html">single_file.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/stmt_lexer.go.html">stmt_lexer.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_scope.go.html">sym_scope.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/sym_table.go.html">sym_table.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/symbol.go.html">symbol.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/token.go.html">token.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_decl.go.html">var_decl.go</a></li>
<li><a href="/gostd/lonnie.io/e8vm/asm8/var_stmt.go.html">var_stmt.go</a></li>
</ul>
</div>
<div class="code">
<span class="lineno">1</span><span class="keyword" id="4870255">package</span>&nbsp;<span class="ident" id="4870263">asm8</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4870269">import</span>&nbsp;<span class="op" id="4870276">(</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870279">&#34;strconv&#34;</span><br>
<span class="lineno">5</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870291">&#34;lonnie.io/e8vm/lex8&#34;</span><br>
<span class="lineno"></span><span class="op" id="4870313">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4870316">var</span>&nbsp;<span class="op" id="4870320">(</span><br>
<span class="lineno">10</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4870323">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870344">opShiftMap</span>&nbsp;<span class="op" id="4870355">=</span>&nbsp;<span class="keyword" id="4870357">map</span><span class="op" id="4870360">[</span><span class="builtintype" id="4870361">string</span><span class="op" id="4870367">]</span><span class="builtintype" id="4870368">uint32</span><span class="op" id="4870374">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870378">&#34;sll&#34;</span><span class="op" id="4870383">:</span>&nbsp;<span class="num" id="4870385">0</span><span class="op" id="4870386">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870390">&#34;srl&#34;</span><span class="op" id="4870395">:</span>&nbsp;<span class="num" id="4870397">1</span><span class="op" id="4870398">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870402">&#34;sra&#34;</span><span class="op" id="4870407">:</span>&nbsp;<span class="num" id="4870409">2</span><span class="op" id="4870410">,</span><br>
<span class="lineno">15</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4870413">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4870417">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870436">opReg3Map</span>&nbsp;<span class="op" id="4870446">=</span>&nbsp;<span class="keyword" id="4870448">map</span><span class="op" id="4870451">[</span><span class="builtintype" id="4870452">string</span><span class="op" id="4870458">]</span><span class="builtintype" id="4870459">uint32</span><span class="op" id="4870465">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870469">&#34;sllv&#34;</span><span class="op" id="4870475">:</span>&nbsp;<span class="num" id="4870477">3</span><span class="op" id="4870478">,</span><br>
<span class="lineno">20</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870482">&#34;srlv&#34;</span><span class="op" id="4870488">:</span>&nbsp;<span class="num" id="4870490">4</span><span class="op" id="4870491">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870495">&#34;srla&#34;</span><span class="op" id="4870501">:</span>&nbsp;<span class="num" id="4870503">5</span><span class="op" id="4870504">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870508">&#34;add&#34;</span><span class="op" id="4870513">:</span>&nbsp;&nbsp;<span class="num" id="4870516">6</span><span class="op" id="4870517">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870521">&#34;sub&#34;</span><span class="op" id="4870526">:</span>&nbsp;&nbsp;<span class="num" id="4870529">7</span><span class="op" id="4870530">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870534">&#34;and&#34;</span><span class="op" id="4870539">:</span>&nbsp;&nbsp;<span class="num" id="4870542">8</span><span class="op" id="4870543">,</span><br>
<span class="lineno">25</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870547">&#34;or&#34;</span><span class="op" id="4870551">:</span>&nbsp;&nbsp;&nbsp;<span class="num" id="4870555">9</span><span class="op" id="4870556">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870560">&#34;xor&#34;</span><span class="op" id="4870565">:</span>&nbsp;&nbsp;<span class="num" id="4870568">10</span><span class="op" id="4870570">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870574">&#34;nor&#34;</span><span class="op" id="4870579">:</span>&nbsp;&nbsp;<span class="num" id="4870582">11</span><span class="op" id="4870584">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870588">&#34;slt&#34;</span><span class="op" id="4870593">:</span>&nbsp;&nbsp;<span class="num" id="4870596">12</span><span class="op" id="4870598">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870602">&#34;sltu&#34;</span><span class="op" id="4870608">:</span>&nbsp;<span class="num" id="4870610">13</span><span class="op" id="4870612">,</span><br>
<span class="lineno">30</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870616">&#34;mul&#34;</span><span class="op" id="4870621">:</span>&nbsp;&nbsp;<span class="num" id="4870624">14</span><span class="op" id="4870626">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870630">&#34;mulu&#34;</span><span class="op" id="4870636">:</span>&nbsp;<span class="num" id="4870638">15</span><span class="op" id="4870640">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870644">&#34;div&#34;</span><span class="op" id="4870649">:</span>&nbsp;&nbsp;<span class="num" id="4870652">16</span><span class="op" id="4870654">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870658">&#34;divu&#34;</span><span class="op" id="4870664">:</span>&nbsp;<span class="num" id="4870666">17</span><span class="op" id="4870668">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870672">&#34;mod&#34;</span><span class="op" id="4870677">:</span>&nbsp;&nbsp;<span class="num" id="4870680">18</span><span class="op" id="4870682">,</span><br>
<span class="lineno">35</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870686">&#34;modu&#34;</span><span class="op" id="4870692">:</span>&nbsp;<span class="num" id="4870694">19</span><span class="op" id="4870696">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4870699">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4870703">//&nbsp;op&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870718">opReg2Map</span>&nbsp;<span class="op" id="4870728">=</span>&nbsp;<span class="keyword" id="4870730">map</span><span class="op" id="4870733">[</span><span class="builtintype" id="4870734">string</span><span class="op" id="4870740">]</span><span class="builtintype" id="4870741">uint32</span><span class="op" id="4870747">{</span><br>
<span class="lineno">40</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870751">&#34;mov&#34;</span><span class="op" id="4870756">:</span>&nbsp;<span class="num" id="4870758">0</span><span class="op" id="4870759">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4870762">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4870766">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870785">opFloatMap</span>&nbsp;<span class="op" id="4870796">=</span>&nbsp;<span class="keyword" id="4870798">map</span><span class="op" id="4870801">[</span><span class="builtintype" id="4870802">string</span><span class="op" id="4870808">]</span><span class="builtintype" id="4870809">uint32</span><span class="op" id="4870815">{</span><br>
<span class="lineno">45</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870819">&#34;fadd&#34;</span><span class="op" id="4870825">:</span>&nbsp;<span class="num" id="4870827">0</span><span class="op" id="4870828">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870832">&#34;fsub&#34;</span><span class="op" id="4870838">:</span>&nbsp;<span class="num" id="4870840">1</span><span class="op" id="4870841">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870845">&#34;fmul&#34;</span><span class="op" id="4870851">:</span>&nbsp;<span class="num" id="4870853">2</span><span class="op" id="4870854">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870858">&#34;fdiv&#34;</span><span class="op" id="4870864">:</span>&nbsp;<span class="num" id="4870866">3</span><span class="op" id="4870867">,</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="string" id="4870871">&#34;fint&#34;</span><span class="op" id="4870877">:</span>&nbsp;<span class="num" id="4870879">4</span><span class="op" id="4870880">,</span><br>
<span class="lineno">50</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4870883">}</span><br>
<span class="lineno"></span><span class="op" id="4870885">)</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4870888">func</span>&nbsp;<span class="ident" id="4870893">parseShift</span><span class="op" id="4870903">(</span><span class="ident" id="4870904">p</span>&nbsp;<span class="op" id="4870906">*</span><span class="ident" id="4870907">parser</span><span class="op" id="4870913">,</span>&nbsp;<span class="ident" id="4870915">op</span>&nbsp;<span class="op" id="4870918">*</span><span class="ident" id="4870919">lex8</span><span class="op" id="4870923">.</span><span class="ident" id="4870924">Token</span><span class="op" id="4870929">)</span>&nbsp;<span class="builtintype" id="4870931">uint32</span>&nbsp;<span class="op" id="4870938">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4870941">ret</span><span class="op" id="4870944">,</span>&nbsp;<span class="ident" id="4870946">e</span>&nbsp;<span class="op" id="4870948">:=</span>&nbsp;<span class="ident" id="4870951">strconv</span><span class="op" id="4870958">.</span><span class="ident" id="4870959">ParseUint</span><span class="op" id="4870968">(</span><span class="ident" id="4870969">op</span><span class="op" id="4870971">.</span><span class="ident" id="4870972">Lit</span><span class="op" id="4870975">,</span>&nbsp;<span class="num" id="4870977">0</span><span class="op" id="4870978">,</span>&nbsp;<span class="num" id="4870980">32</span><span class="op" id="4870982">)</span><br>
<span class="lineno">55</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4870985">if</span>&nbsp;<span class="ident" id="4870988">e</span>&nbsp;<span class="op" id="4870990">!=</span>&nbsp;<span class="ident" id="4870993">nil</span>&nbsp;<span class="op" id="4870997">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871001">p</span><span class="op" id="4871002">.</span><span class="ident" id="4871003">err</span><span class="op" id="4871006">(</span><span class="ident" id="4871007">op</span><span class="op" id="4871009">.</span><span class="ident" id="4871010">Pos</span><span class="op" id="4871013">,</span>&nbsp;<span class="string" id="4871015">&#34;invalid&nbsp;shift&nbsp;%q:&nbsp;%s&#34;</span><span class="op" id="4871037">,</span>&nbsp;<span class="ident" id="4871039">op</span><span class="op" id="4871041">.</span><span class="ident" id="4871042">Lit</span><span class="op" id="4871045">,</span>&nbsp;<span class="ident" id="4871047">e</span><span class="op" id="4871048">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871052">return</span>&nbsp;<span class="num" id="4871059">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4871062">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">60</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871066">if</span>&nbsp;<span class="op" id="4871069">(</span><span class="ident" id="4871070">ret</span>&nbsp;<span class="op" id="4871074">&amp;</span>&nbsp;<span class="num" id="4871076">0x1f</span><span class="op" id="4871080">)</span>&nbsp;<span class="op" id="4871082">!=</span>&nbsp;<span class="ident" id="4871085">ret</span>&nbsp;<span class="op" id="4871089">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871093">p</span><span class="op" id="4871094">.</span><span class="ident" id="4871095">err</span><span class="op" id="4871098">(</span><span class="ident" id="4871099">op</span><span class="op" id="4871101">.</span><span class="ident" id="4871102">Pos</span><span class="op" id="4871105">,</span>&nbsp;<span class="string" id="4871107">&#34;shift&nbsp;too&nbsp;large:&nbsp;%s&#34;</span><span class="op" id="4871128">,</span>&nbsp;<span class="ident" id="4871130">op</span><span class="op" id="4871132">.</span><span class="ident" id="4871133">Lit</span><span class="op" id="4871136">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871140">return</span>&nbsp;<span class="num" id="4871147">0</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4871150">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">65</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871154">return</span>&nbsp;<span class="builtintype" id="4871161">uint32</span><span class="op" id="4871167">(</span><span class="ident" id="4871168">ret</span><span class="op" id="4871171">)</span><br>
<span class="lineno"></span><span class="op" id="4871173">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span><span class="keyword" id="4871176">func</span>&nbsp;<span class="ident" id="4871181">makeInstReg</span><span class="op" id="4871192">(</span><span class="ident" id="4871193">fn</span><span class="op" id="4871195">,</span>&nbsp;<span class="ident" id="4871197">d</span><span class="op" id="4871198">,</span>&nbsp;<span class="ident" id="4871200">s1</span><span class="op" id="4871202">,</span>&nbsp;<span class="ident" id="4871204">s2</span><span class="op" id="4871206">,</span>&nbsp;<span class="ident" id="4871208">sh</span><span class="op" id="4871210">,</span>&nbsp;<span class="ident" id="4871212">isFloat</span>&nbsp;<span class="builtintype" id="4871220">uint32</span><span class="op" id="4871226">)</span>&nbsp;<span class="op" id="4871228">*</span><span class="ident" id="4871229">inst</span>&nbsp;<span class="op" id="4871234">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871237">ret</span>&nbsp;<span class="op" id="4871241">:=</span>&nbsp;<span class="builtintype" id="4871244">uint32</span><span class="op" id="4871250">(</span><span class="num" id="4871251">0</span><span class="op" id="4871252">)</span><br>
<span class="lineno">70</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871255">ret</span>&nbsp;<span class="op" id="4871259">|=</span>&nbsp;<span class="op" id="4871262">(</span><span class="ident" id="4871263">d</span>&nbsp;<span class="op" id="4871265">&amp;</span>&nbsp;<span class="num" id="4871267">0x7</span><span class="op" id="4871270">)</span>&nbsp;<span class="op" id="4871272">&lt;&lt;</span>&nbsp;<span class="num" id="4871275">21</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871279">ret</span>&nbsp;<span class="op" id="4871283">|=</span>&nbsp;<span class="op" id="4871286">(</span><span class="ident" id="4871287">s1</span>&nbsp;<span class="op" id="4871290">&amp;</span>&nbsp;<span class="num" id="4871292">0x7</span><span class="op" id="4871295">)</span>&nbsp;<span class="op" id="4871297">&lt;&lt;</span>&nbsp;<span class="num" id="4871300">18</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871304">ret</span>&nbsp;<span class="op" id="4871308">|=</span>&nbsp;<span class="op" id="4871311">(</span><span class="ident" id="4871312">s2</span>&nbsp;<span class="op" id="4871315">&amp;</span>&nbsp;<span class="num" id="4871317">0x7</span><span class="op" id="4871320">)</span>&nbsp;<span class="op" id="4871322">&lt;&lt;</span>&nbsp;<span class="num" id="4871325">15</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871329">ret</span>&nbsp;<span class="op" id="4871333">|=</span>&nbsp;<span class="op" id="4871336">(</span><span class="ident" id="4871337">sh</span>&nbsp;<span class="op" id="4871340">&amp;</span>&nbsp;<span class="num" id="4871342">0x1f</span><span class="op" id="4871346">)</span>&nbsp;<span class="op" id="4871348">&lt;&lt;</span>&nbsp;<span class="num" id="4871351">10</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871355">ret</span>&nbsp;<span class="op" id="4871359">|=</span>&nbsp;<span class="op" id="4871362">(</span><span class="ident" id="4871363">isFloat</span>&nbsp;<span class="op" id="4871371">&amp;</span>&nbsp;<span class="num" id="4871373">0x1</span><span class="op" id="4871376">)</span>&nbsp;<span class="op" id="4871378">&lt;&lt;</span>&nbsp;<span class="num" id="4871381">8</span><br>
<span class="lineno">75</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871384">ret</span>&nbsp;<span class="op" id="4871388">|=</span>&nbsp;<span class="ident" id="4871391">fn</span>&nbsp;<span class="op" id="4871394">&amp;</span>&nbsp;<span class="num" id="4871396">0xff</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871403">return</span>&nbsp;<span class="op" id="4871410">&amp;</span><span class="ident" id="4871411">inst</span><span class="op" id="4871415">{</span><span class="ident" id="4871416">inst</span><span class="op" id="4871420">:</span>&nbsp;<span class="ident" id="4871422">ret</span><span class="op" id="4871425">}</span><br>
<span class="lineno"></span><span class="op" id="4871427">}</span><br>
<span class="lineno"></span><br>
<span class="lineno">80</span><span class="keyword" id="4871430">func</span>&nbsp;<span class="ident" id="4871435">parseInstReg</span><span class="op" id="4871447">(</span><span class="ident" id="4871448">p</span>&nbsp;<span class="op" id="4871450">*</span><span class="ident" id="4871451">parser</span><span class="op" id="4871457">,</span>&nbsp;<span class="ident" id="4871459">ops</span>&nbsp;<span class="op" id="4871463">[</span><span class="op" id="4871464">]</span><span class="op" id="4871465">*</span><span class="ident" id="4871466">lex8</span><span class="op" id="4871470">.</span><span class="ident" id="4871471">Token</span><span class="op" id="4871476">)</span>&nbsp;<span class="op" id="4871478">(</span><span class="op" id="4871479">*</span><span class="ident" id="4871480">inst</span><span class="op" id="4871484">,</span>&nbsp;<span class="builtintype" id="4871486">bool</span><span class="op" id="4871490">)</span>&nbsp;<span class="op" id="4871492">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871495">op0</span>&nbsp;<span class="op" id="4871499">:=</span>&nbsp;<span class="ident" id="4871502">ops</span><span class="op" id="4871505">[</span><span class="num" id="4871506">0</span><span class="op" id="4871507">]</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871510">opName</span>&nbsp;<span class="op" id="4871517">:=</span>&nbsp;<span class="ident" id="4871520">op0</span><span class="op" id="4871523">.</span><span class="ident" id="4871524">Lit</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871529">args</span>&nbsp;<span class="op" id="4871534">:=</span>&nbsp;<span class="ident" id="4871537">ops</span><span class="op" id="4871540">[</span><span class="num" id="4871541">1</span><span class="op" id="4871542">:</span><span class="op" id="4871543">]</span><br>
<span class="lineno"></span><br>
<span class="lineno">85</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4871547">//&nbsp;common&nbsp;args</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871563">var</span>&nbsp;<span class="ident" id="4871567">fn</span><span class="op" id="4871569">,</span>&nbsp;<span class="ident" id="4871571">d</span><span class="op" id="4871572">,</span>&nbsp;<span class="ident" id="4871574">s1</span><span class="op" id="4871576">,</span>&nbsp;<span class="ident" id="4871578">s2</span><span class="op" id="4871580">,</span>&nbsp;<span class="ident" id="4871582">sh</span><span class="op" id="4871584">,</span>&nbsp;<span class="ident" id="4871586">isFloat</span>&nbsp;<span class="builtintype" id="4871594">uint32</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871603">argCount</span>&nbsp;<span class="op" id="4871612">:=</span>&nbsp;<span class="keyword" id="4871615">func</span><span class="op" id="4871619">(</span><span class="ident" id="4871620">n</span>&nbsp;<span class="builtintype" id="4871622">int</span><span class="op" id="4871625">)</span>&nbsp;<span class="builtintype" id="4871627">bool</span>&nbsp;<span class="op" id="4871632">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871636">if</span>&nbsp;<span class="op" id="4871639">!</span><span class="ident" id="4871640">argCount</span><span class="op" id="4871648">(</span><span class="ident" id="4871649">p</span><span class="op" id="4871650">,</span>&nbsp;<span class="ident" id="4871652">ops</span><span class="op" id="4871655">,</span>&nbsp;<span class="ident" id="4871657">n</span><span class="op" id="4871658">)</span>&nbsp;<span class="op" id="4871660">{</span><br>
<span class="lineno">90</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871665">return</span>&nbsp;<span class="builtintype" id="4871672">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4871680">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871684">if</span>&nbsp;<span class="ident" id="4871687">n</span>&nbsp;<span class="op" id="4871689">&gt;=</span>&nbsp;<span class="num" id="4871692">2</span>&nbsp;<span class="op" id="4871694">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871699">d</span>&nbsp;<span class="op" id="4871701">=</span>&nbsp;<span class="ident" id="4871703">parseReg</span><span class="op" id="4871711">(</span><span class="ident" id="4871712">p</span><span class="op" id="4871713">,</span>&nbsp;<span class="ident" id="4871715">args</span><span class="op" id="4871719">[</span><span class="num" id="4871720">0</span><span class="op" id="4871721">]</span><span class="op" id="4871722">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871727">s1</span>&nbsp;<span class="op" id="4871730">=</span>&nbsp;<span class="ident" id="4871732">parseReg</span><span class="op" id="4871740">(</span><span class="ident" id="4871741">p</span><span class="op" id="4871742">,</span>&nbsp;<span class="ident" id="4871744">args</span><span class="op" id="4871748">[</span><span class="num" id="4871749">1</span><span class="op" id="4871750">]</span><span class="op" id="4871751">)</span><br>
<span class="lineno">95</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4871755">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871759">return</span>&nbsp;<span class="builtintype" id="4871766">true</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4871772">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871776">var</span>&nbsp;<span class="ident" id="4871780">found</span>&nbsp;<span class="builtintype" id="4871786">bool</span><br>
<span class="lineno">100</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871792">if</span>&nbsp;<span class="ident" id="4871795">fn</span><span class="op" id="4871797">,</span>&nbsp;<span class="ident" id="4871799">found</span>&nbsp;<span class="op" id="4871805">=</span>&nbsp;<span class="ident" id="4871807">opShiftMap</span><span class="op" id="4871817">[</span><span class="ident" id="4871818">opName</span><span class="op" id="4871824">]</span><span class="op" id="4871825">;</span>&nbsp;<span class="ident" id="4871827">found</span>&nbsp;<span class="op" id="4871833">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4871837">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;shift</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871859">if</span>&nbsp;<span class="ident" id="4871862">argCount</span><span class="op" id="4871870">(</span><span class="num" id="4871871">3</span><span class="op" id="4871872">)</span>&nbsp;<span class="op" id="4871874">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4871879">sh</span>&nbsp;<span class="op" id="4871882">=</span>&nbsp;<span class="ident" id="4871884">parseShift</span><span class="op" id="4871894">(</span><span class="ident" id="4871895">p</span><span class="op" id="4871896">,</span>&nbsp;<span class="ident" id="4871898">args</span><span class="op" id="4871902">[</span><span class="num" id="4871903">2</span><span class="op" id="4871904">]</span><span class="op" id="4871905">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4871909">}</span><br>
<span class="lineno">105</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4871912">}</span>&nbsp;<span class="keyword" id="4871914">else</span>&nbsp;<span class="keyword" id="4871919">if</span>&nbsp;<span class="ident" id="4871922">fn</span><span class="op" id="4871924">,</span>&nbsp;<span class="ident" id="4871926">found</span>&nbsp;<span class="op" id="4871932">=</span>&nbsp;<span class="ident" id="4871934">opReg3Map</span><span class="op" id="4871943">[</span><span class="ident" id="4871944">opName</span><span class="op" id="4871950">]</span><span class="op" id="4871951">;</span>&nbsp;<span class="ident" id="4871953">found</span>&nbsp;<span class="op" id="4871959">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4871963">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4871983">if</span>&nbsp;<span class="ident" id="4871986">argCount</span><span class="op" id="4871994">(</span><span class="num" id="4871995">3</span><span class="op" id="4871996">)</span>&nbsp;<span class="op" id="4871998">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872003">s2</span>&nbsp;<span class="op" id="4872006">=</span>&nbsp;<span class="ident" id="4872008">parseReg</span><span class="op" id="4872016">(</span><span class="ident" id="4872017">p</span><span class="op" id="4872018">,</span>&nbsp;<span class="ident" id="4872020">args</span><span class="op" id="4872024">[</span><span class="num" id="4872025">2</span><span class="op" id="4872026">]</span><span class="op" id="4872027">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872031">}</span><br>
<span class="lineno">110</span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872034">}</span>&nbsp;<span class="keyword" id="4872036">else</span>&nbsp;<span class="keyword" id="4872041">if</span>&nbsp;<span class="ident" id="4872044">fn</span><span class="op" id="4872046">,</span>&nbsp;<span class="ident" id="4872048">found</span>&nbsp;<span class="op" id="4872054">=</span>&nbsp;<span class="ident" id="4872056">opReg2Map</span><span class="op" id="4872065">[</span><span class="ident" id="4872066">opName</span><span class="op" id="4872072">]</span><span class="op" id="4872073">;</span>&nbsp;<span class="ident" id="4872075">found</span>&nbsp;<span class="op" id="4872081">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4872085">//&nbsp;op&nbsp;reg&nbsp;reg</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872101">argCount</span><span class="op" id="4872109">(</span><span class="num" id="4872110">2</span><span class="op" id="4872111">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872114">}</span>&nbsp;<span class="keyword" id="4872116">else</span>&nbsp;<span class="keyword" id="4872121">if</span>&nbsp;<span class="ident" id="4872124">fn</span><span class="op" id="4872126">,</span>&nbsp;<span class="ident" id="4872128">found</span>&nbsp;<span class="op" id="4872134">=</span>&nbsp;<span class="ident" id="4872136">opFloatMap</span><span class="op" id="4872146">[</span><span class="ident" id="4872147">opName</span><span class="op" id="4872153">]</span><span class="op" id="4872154">;</span>&nbsp;<span class="ident" id="4872156">found</span>&nbsp;<span class="op" id="4872162">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="comment" id="4872166">//&nbsp;op&nbsp;reg&nbsp;reg&nbsp;reg</span><br>
<span class="lineno">115</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872186">if</span>&nbsp;<span class="ident" id="4872189">argCount</span><span class="op" id="4872197">(</span><span class="num" id="4872198">3</span><span class="op" id="4872199">)</span>&nbsp;<span class="op" id="4872201">{</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872206">s2</span>&nbsp;<span class="op" id="4872209">=</span>&nbsp;<span class="ident" id="4872211">parseReg</span><span class="op" id="4872219">(</span><span class="ident" id="4872220">p</span><span class="op" id="4872221">,</span>&nbsp;<span class="ident" id="4872223">args</span><span class="op" id="4872227">[</span><span class="num" id="4872228">2</span><span class="op" id="4872229">]</span><span class="op" id="4872230">)</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872234">}</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="ident" id="4872238">isFloat</span>&nbsp;<span class="op" id="4872246">=</span>&nbsp;<span class="num" id="4872248">1</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872251">}</span>&nbsp;<span class="keyword" id="4872253">else</span>&nbsp;<span class="op" id="4872258">{</span><br>
<span class="lineno">120</span>&nbsp;&nbsp;&nbsp;&nbsp&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872262">return</span>&nbsp;<span class="ident" id="4872269">nil</span><span class="op" id="4872272">,</span>&nbsp;<span class="builtintype" id="4872274">false</span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="op" id="4872281">}</span><br>
<span class="lineno"></span><br>
<span class="lineno"></span>&nbsp;&nbsp;&nbsp;&nbsp<span class="keyword" id="4872285">return</span>&nbsp;<span class="ident" id="4872292">makeInstReg</span><span class="op" id="4872303">(</span><span class="ident" id="4872304">fn</span><span class="op" id="4872306">,</span>&nbsp;<span class="ident" id="4872308">d</span><span class="op" id="4872309">,</span>&nbsp;<span class="ident" id="4872311">s1</span><span class="op" id="4872313">,</span>&nbsp;<span class="ident" id="4872315">s2</span><span class="op" id="4872317">,</span>&nbsp;<span class="ident" id="4872319">sh</span><span class="op" id="4872321">,</span>&nbsp;<span class="ident" id="4872323">isFloat</span><span class="op" id="4872330">)</span><span class="op" id="4872331">,</span>&nbsp;<span class="builtintype" id="4872333">true</span><br>
<span class="lineno"></span><span class="op" id="4872338">}</span>
</div>
</body>
</html>
